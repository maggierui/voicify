(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[23],{1136:function(y,D,b){function a(n,l){n=k.call(this,n,l)||this;l!==c.a.s9&&n.TEa(l);n.gga(a.iterateNext);n.gga(a.Cwa);n.cSc(d.a.gTa);n.cSc(d.a.hTa);return n}b.d(D,"a",function(){return a});y=b(0);var d=b(170);D=b(1254);var c=b(889),k=D.a;vm(a,k);a.iterateNext="IterateNext";a.Cwa="IteratePrevious";a.vLb="ToggleShowChanges";a.setCurrentChangeCount="SetCurrentChangeCount";a.setTotalChangesCount="SetTotalChangesCount";a.gOa=
"OnVHDiffReady";Object(y.a)(a,"VersionHistoryMessenger",D.a,[])},1257:function(y,D,b){function a(O,ba,ca,S){var Y=this;this.authorColor=this.N1=this.Zda=null;this.a6a=!1;this.m6f=0;this.R_a=-1;this.o3c=0;this.BHa=100;this.wka=-1;this.VWd=null;this.Enb=u.a.UNj;this.EDe=u.a.VNj;this.Zh=function(na){(na=r.a(na)?null:na.Result)?na.OperationWaitingForFileDownload?20>Y.o3c?(Y.BHa*=2,Q.Task.delay(Y.BHa).continueWith(function(){Y.jUd()})):(Y.Fzc(),c.ULS.sendTraceTag(537150406,0,50,"VersionHistoryHighlightManager::OnWebMethodSuccess Next Operation enqueue failed")):
na.ActivityList?(Y.initialize(na.ActivityList,na.VersionAuthors),G.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")?Y.gOa():Y.Rvc(!0),Y.VWd.stop(),c.ULS.sendTraceTag(41743369,0,50,"VersionHistoryHighlightManager: Time taken For showing diffs in Ms:{0}",Y.VWd.Ac.toString())):(Y.Fzc(),c.ULS.sendTraceTag(537150407,0,50,"VersionHistoryHighlightManager::OnWebMethodSuccess no activity list found.")):(Y.BHa*=2,Q.Task.delay(Y.BHa).continueWith(function(){Y.jUd()}),
c.ULS.sendTraceTag(537150408,0,10,"VersionHistoryHighlightManager::OnWebMethodSuccess call returned null result."))};this.eya=function(){Y.Fzc();c.ULS.sendTraceTag(537150405,0,10,"VersionHistoryHighlightManager::OnWebMethodFailure service call failed.")};this.zpd=function(na){c.ULS.sendTraceTag(537150400,0,50,"VersionHistoryHighlightManager.IterateMessageHandler called with MessageID:{0}",na.MessageId);switch(na.MessageId){case W.a.iterateNext:Y.iterateNext();Y.wka=(Y.wka+1)%Y.LR.length;Y.VHb(W.a.setCurrentChangeCount,
Y.wka+1);break;case W.a.Cwa:Y.Cwa();Y.wka=0>Y.wka?0:Y.wka;Y.wka=(Y.wka+Y.LR.length-1)%Y.LR.length;Y.VHb(W.a.setCurrentChangeCount,Y.wka+1);break;case W.a.vLb:Y.Rvc(na.Values.ToggleValue)}};this.UWg=function(na,Z){return Y.z1b(na.zm,Z.zm)};this.TWg=function(na,Z){return Y.z1b(na.zm,Z)};this.kd=function(){Y.r4b()};this.Wo=function(){Y.r4b()};this.Mj=function(){Y.r4b()};c.ULS.sendTraceTag(537150411,0,50,"VersionHistoryHighlightManager::Constructor.");this.$=O;this.ariaLiveNotifier=S;this.gridView=P.g(this.$);
this.gridView.ha.jG(this.kd);this.gridView.DD(this.Wo);this.gridView.Kc.wm(this.Mj);this.QJj();ba&&(this.VWd=O.Ub.Fc("UserAction","VersionHistoryDiffManagerStopWatch"),this.jUd());if(this.Nr=ca)O=k.a.maa(this.$.ya.VersionHistoryActionUrl)||I.a.s9,O!==I.a.s9&&this.Nr.TEa(O),this.Nr.Qn(W.a.iterateNext),this.Nr.Qn(W.a.Cwa),this.Nr.Qn(W.a.vLb),this.Nr.Km(W.a.iterateNext,this.zpd),this.Nr.Km(W.a.Cwa,this.zpd),this.Nr.Km(W.a.vLb,this.zpd)}function d(O,ba,ca){this.QEa=O;this.zm=ba;this.mAc=ca}y=b(0);var c=
b(13),k=b(77),n=b(962),l=b(84),f=b(185),u=b(9),v=b(204),m=b(59),A=b(43),x=b(519),t=b(163),z=b(106),r=b(302),G=b(1),w=b(8),B=b(95),U=b(14),N=b(273);b(105);var P=b(20),ia=b(336);Object(y.a)(d,"UserActivityLocation",null,[]);var W=b(1136),R=b(81),I=b(889),Q=b(55);b.d(D,"a",function(){return a});a.prototype.dispose=function(){this.Zya();this.Zda=this.N1=null;this.gridView&&(this.gridView.ha&&this.gridView.ha.mF(this.kd),this.gridView.lF(this.Wo),this.gridView.Kc&&this.gridView.Kc.im(this.Mj),this.Nr&&
(this.Nr.Sna(W.a.Cwa),this.Nr.Sna(W.a.iterateNext),this.Nr.Sna(W.a.vLb)))};a.prototype.initialize=function(O,ba){O?(this.Zya(),this.R_a=-1,this.Zda=[],this.a6a=!1,this.N1={},this.authorColor={},this.Eqi(ba),this.V2c(O)):c.ULS.shipAssertTag(537150410,0,!1,"VersionHistoryHighlightManager.Initialize - userActivityList was Null")};a.prototype.jUd=function(){function O(ca,S,Y){var na=ba.$.qa.ta;ca=N.b(ca,ba.Zh);S=N.a(S,ba.eya);var Z=na.Oa(1,null);return R.i(na,"GetVersionHistoryHighlightActivitiesData",
Z,ca,S,Y,null,4)}var ba=this;c.ULS.sendTraceTag(537150409,0,50,"VersionHistoryHighlightManager: TryFetchUserActivityandTriggerDiff triggered: {0} --{1}",this.o3c.toString(),this.BHa.toString());this.o3c++;G.EwaSettings.tc()?this.$.userOperationManager.ic(new t.a(537,0,O,80),null):this.$.userOperationManager.ic(new x.a(537,0,O,16),null)};a.prototype.Rvc=function(O){var ba=this.N1,ca;for(ca in ba){var S=ca,Y=ba[ca];Y?Y.LJb(O):c.ULS.shipAssertTag(537150404,0,!1,"VersionHistoryHighlightManager.ShowOrHideAllHighlights -"+
S+"view was Null")}};a.prototype.Zya=function(){var O=this.N1,ba;for(ba in O){var ca=ba,S=O[ba];S?S.T2i():c.ULS.shipAssertTag(537150403,0,!1,"VersionHistoryHighlightManager.RemoveAllHighlights -"+ca+"view was Null")}this.Zda=this.N1=null};a.prototype.$Sf=function(O){var ba=this.iNh(O,this.R_a);var ca=ba.n7e;O=ba.Nag;ba.returnValue&&(c.ULS.shipAssertTag(537150402,0,!!O,"VersionHistoryHighlightManager.SelectNextOrPreviousChange - userActivityLocation is null"),this.r4b(),O.QEa.toString()in this.N1?
(this.N1[O.QEa.toString()].sej(O.zm),ba=A.D(O.zm),this.ariaLiveNotifier.setEnabled(!1),this.ariaLiveNotifier.setEnabled(!0),this.ariaLiveNotifier.readText(String.format(U.a.instance.Cb(157),ca+1,this.LR.length,ba.qE(!1),O.mAc.DisplayName)),this.R_a=ca):c.ULS.shipAssertTag(537150401,0,!1,String.format("VersionHistoryHighlightManager.SelectNextOrPreviousChange - {0} view not present in views dictionary",O.QEa.toString())))};a.prototype.VHb=function(O,ba){if(G.EwaSettings.la(328))if(this.Nr){var ca=
{};ca.count=ba;O=new n.a(O);O.Values=ca;this.Nr.send(O)}else c.ULS.sendTraceTag(537150370,0,10,"VersionHistoryHighlightManager.SendIteratorTextUpdateMessage hostPostmessenger is null");else c.ULS.sendTraceTag(537150371,0,50,"VersionHistoryHighlightManager.SendIteratorTextUpdateMessage VersionHistoryIterator BRS is turned off")};a.prototype.iNh=function(O,ba){var ca=!1;var S=null;for(var Y=0;!ca&&Y<this.LR.length;){ba=O?this.$Mh(ba):this.KOh(ba);S=this.LR[ba];var na=Object(l.a)(B.a,this.$.xa.getItemByName(S.zm.SheetName));
if(!na)return c.ULS.shipAssertTag(537150369,0,!1,String.format("VersionHistoryHighlightManager.GetNextorPreviousUserActivityLocationFromIndex - useractivitylocation contains sheetrange with null sheet")),{returnValue:!1,n7e:ba,Nag:S};na.visible&&(ca=!0);Y++}return{returnValue:ca,n7e:ba,Nag:S}};a.prototype.$Mh=function(O){return-1===O?this.uYe():(O+1)%this.LR.length};a.prototype.KOh=function(O){-1===O&&(O=this.uYe());return O=(O+this.LR.length-1)%this.LR.length};a.prototype.V2c=function(O){this.j6g(O);
this.A2c()};a.prototype.WTh=function(O,ba){var ca=[];if(!O.RangeList)return c.ULS.shipAssertTag(537150368,0,!1,"VersionHistoryHighlightManager.GetUserActivityLocationFromRangeActivityLocation - ActivityLocationType.Range RangeList Null "),ca;O=yl(O.RangeList);for(var S=O.next();!S.done;S=O.next())(S=S.value)&&this.$.xa.tj(S.SheetName)?(S=new d(0,S,ba),ca.push(S)):c.ULS.shipAssertTag(537150367,0,!1," Inavlid sheet name"+S.SheetName);return ca};a.prototype.j6g=function(O){O=yl(O);for(var ba=O.next();!ba.done;ba=
O.next())if(ba=ba.value,!ba||z.e(ba.LocationList))c.ULS.sendTraceTag(537150366,0,50,"Empty Location list");else for(var ca=yl(ba.LocationList),S=ca.next();!S.done;S=ca.next())if(S=S.value)switch(S.Type){case 0:this.Zda.push.apply(this.Zda,Fl(this.WTh(S,ba.Person)));break;default:c.ULS.sendTraceTag(537150364,0,50,"VersionHistoryHighlightManager.CreateViews Failed. Invalid ActivityLocationType")}else c.ULS.shipAssertTag(537150365,0,!1,"VersionHistoryHighlightManager.CreateUserActivityLocationList - LocationList contains Null")};
a.prototype.A2c=function(){for(var O={},ba=new f.a,ca=[],S=yl(this.Zda),Y=S.next();!Y.done;Y=S.next())if(Y=Y.value,ba.contains(Y.mAc)||ba.add(Y.mAc),!Y.QEa){var na=new ia.a(A.D(Y.zm),m.d(this.$.xa.getItemByName(Y.zm.SheetName))),Z=a.Ruc(na);Z in O||ca.push(na);O[Z]=this.lFh(Y.mAc)}c.ULS.sendTraceTag(42541534,0,15,"VersionHistoryHighlightManager.CreateRangeHighlightView. Total activities : {0}, Highlightable activities: {1},Total userlist in activities : {0}, Total userlist from pane: {1} ",this.Zda.length,
ca.length,ba.count,this.m6f);this.Fzc();0<ca.length&&(O=new (b(1347).RangeVersionHistoryHighlightView)(this.$,ca,O,this.Enb),this.N1["0"]=O)};a.prototype.Fzc=function(){var O=this.Zda?this.LR.length:0;this.VHb(W.a.setCurrentChangeCount,0);this.VHb(W.a.setTotalChangesCount,O)};a.prototype.gOa=function(){this.VHb(W.a.gOa,0)};a.prototype.Eqi=function(O){if(O){this.m6f=O.length;for(var ba=0;ba<O.length;++ba)if(G.EwaSettings.isChangeGateEnabled("OfficeVSO:5140301_HandleEmptyInitialsColor")&&!O[ba].InitialsColor)c.ULS.sendTraceTag(537150362,
0,15,"VersionHistoryHighlightManager.MapAuthorColorInfo: InitialsColor is null or empty for a version author");else{var ca=O[ba].EmailAddress;var S=O[ba].UserName;var Y=null;if(O[ba].LoginName){var na=O[ba].LoginName.split("|");3===na.length&&(Y=na[2])}Y?this.authorColor[Y]=O[ba].InitialsColor:ca?(c.ULS.sendTraceTag(537150361,0,15,String.format("VersionHistoryHighlightManager Map Author Color: LoginName is null")),this.authorColor[ca]=O[ba].InitialsColor):S?(c.ULS.sendTraceTag(537150360,0,15,String.format("VersionHistoryHighlightManager Map Author Color: Email Address is null")),
this.authorColor[S]=O[ba].InitialsColor):c.ULS.sendTraceTag(537150359,0,10,String.format("VersionHistoryHighlightManager Map Author Color: User name is null"))}}else c.ULS.sendTraceTag(537150363,0,15,"VersionHistoryHighlightManager.MapAuthorColorInfo: versionAuthors is null")};a.prototype.QJj=function(){if(this.$.ya.VersionHistoryHighlightsSettings)for(var O=Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(this.$.ya.VersionHistoryHighlightsSettings))?Sys.Serialization.JavaScriptSerializer.deserialize(this.$.ya.VersionHistoryHighlightsSettings):
null,ba=0;ba<O.length;ba++){var ca=O[ba],S=ca.key?ca.key:ca.Key?ca.Key:"";ca=ca.value?ca.value:ca.Value?ca.Value:"";"DefaultColor"===S?this.EDe=ca:"InitialTint"===S?this.Enb=ca:c.ULS.sendTraceTag(537150357,0,15,String.format("VersionHistoryHighlightManager.UpdateHighlightSettings Highlight Settings are incorrect"))}else c.ULS.sendTraceTag(537150358,0,15,String.format("VersionHistoryHighlightManager.UpdateHighlightSettings Highlight Settings are null"))};a.prototype.lFh=function(O){if(O.Email in this.authorColor)return this.authorColor[O.Email];
if(O.DisplayName in this.authorColor)return this.authorColor[O.DisplayName];c.ULS.sendTraceTag(537150356,0,15,String.format("VersionHistoryHighlightManager GetColorFromPerson - unable to associate corresponding author in dictionary"));return this.EDe};a.prototype.z1b=function(O,ba){var ca=Object(l.a)(B.a,this.$.xa.getItemByName(O.SheetName)),S=Object(l.a)(B.a,this.$.xa.getItemByName(ba.SheetName));return ca&&S?(ca=(ca=w.HelperMethods.xC(ca.index,S.index))||w.HelperMethods.xC(O.FirstRow,ba.FirstRow))||
w.HelperMethods.xC(O.FirstColumn,ba.FirstColumn):(c.ULS.sendTraceTag(537150355,0,10,"VersionHistoryHighlightManager.CompareSharedSheetRange - null sheet"),0)};a.prototype.uYe=function(){var O=A.m(this.gridView.ha.va.activeRange,this.$.xa.oa);if(!O)return c.ULS.sendTraceTag(537150354,0,10,"VersionHistoryHighlightManager.GetNearestLocationIndexFromCurrentSelection - SelectedSharedSheetRange is null "),0;O=w.HelperMethods.Tw(new v.a(this.LR),0,this.LR.length,O,this.TWg);0>O&&(O=~O);return O%this.LR.length};
a.prototype.r4b=function(){if(this.PHb){if(!(this.PHb.QEa.toString()in this.N1)){c.ULS.shipAssertTag(537150353,0,!1,String.format("VersionHistoryHighlightManager.DeselectCurrentlySelectedView - {0} view not present in views dictionary",this.PHb.QEa.toString()));return}this.N1[this.PHb.QEa.toString()].T9g(this.PHb.zm)}this.R_a=-1};a.prototype.iterateNext=function(){this.$Sf(!0)};a.prototype.Cwa=function(){this.$Sf(!1)};a.Ruc=function(O){return String.format("{0}{1}",O.range,O.sheetId)};tl.Object.defineProperties(a.prototype,
{ueb:{configurable:!0,enumerable:!0,get:function(){return this.N1}},PHb:{configurable:!0,enumerable:!0,get:function(){return-1===this.R_a?null:this.LR[this.R_a]}},LR:{configurable:!0,enumerable:!0,get:function(){this.a6a||(this.Zda.sort(this.UWg),this.a6a=!0);return this.Zda}}});Object(y.a)(a,"VersionHistoryHighlightManager",null,[311,3])},1347:function(y,D,b){function a(x,t,z,r){this.zhb=null;this.$=x;this.krg=t;this.aRa=z;this.bRa={};this.Enb=r;this.t5h()}function d(){}b.r(D);y=b(0);var c=b(13),
k=b(9);d.inh="ewa-vhr-rectinnerborder";Object(y.a)(d,"CssClassNames",null,[]);var n=b(59),l=b(43),f=b(217),u=b(105),v=b(20),m=b(336),A=b(1257);b.d(D,"RangeVersionHistoryHighlightView",function(){return a});a.prototype.LJb=function(x){x?this.Nb.Yr(this.PJ):this.Nb.kl(this.PJ)};a.prototype.T2i=function(){this.LJb(!1);this.Nb.CIb(new m.a(null,n.d(this.$.oa)),this.PJ)};a.prototype.sej=function(x){if(this.aRa){var t=new m.a(l.D(x),n.d(this.$.xa.getItemByName(x.SheetName))),z=A.a.Ruc(t);if(z in this.aRa)if(z in
this.bRa){t=f.a.Gp(this.aRa[z]);z=this.bRa[z];for(var r in z)z[r].style.backgroundColor=String.format("rgba({0},{1},{2},{3})",t.r,t.g,t.b,k.a.WNj);v.g(this.$).ha.Qa.wG(null);v.g(this.$).U1e(x,60,!0,u.a.cYi)}else c.ULS.sendTraceTag(537150426,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToDivMap doesn't contain entry for "+z);else c.ULS.sendTraceTag(537150427,0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToColorMap doesn't contain entry for "+z)}else c.ULS.sendTraceTag(537150428,
0,10,"RangeVersionHistoryHighlightView.SelectView sheetRangeToColorMap is null")};a.prototype.T9g=function(x){x=new m.a(l.D(x),n.d(this.$.xa.getItemByName(x.SheetName)));var t=A.a.Ruc(x);if(t in this.bRa)if(t in this.aRa){x=f.a.Gp(this.aRa[t]);t=this.bRa[t];for(var z in t)t[z].style.backgroundColor=String.format("rgba({0},{1},{2},{3})",x.r,x.g,x.b,this.Enb)}else c.ULS.sendTraceTag(537150424,0,10,"RangeVersionHistoryHighlightView.DeselectView sheetRangeToColorMap doesn't contain entry for "+t);else c.ULS.sendTraceTag(537150425,
0,10,"RangeVersionHistoryHighlightView.DeSelectView sheetRangeToDivMap doesn't contain entry for "+t)};a.prototype.t5h=function(){var x=this;this.Nb.uw(this.krg,[a.u4],!1,function(t,z){if(t&&t.range&&t.sheetId&&z){var r=new m.a(t.range,t.sheetId);r=A.a.Ruc(r);r in x.bRa||(x.bRa[r]={});x.bRa[r][t.paneType.toString()]=z;r in x.aRa?(t=x.aRa[r],r=f.a.Gp(t),z.style.borderColor=t,z.style.backgroundColor=String.format("rgba({0},{1},{2},{3})",r.r,r.g,r.b,x.Enb),t=document.createElement("div"),t.className=
d.inh,z.appendChild(t)):c.ULS.sendTraceTag(537150419,0,10,"RangeVersionHistoryHighlightView.InitializeSheetRangeList sheetRangeToColorMap doesn't contain entry for "+r)}else c.ULS.shipAssertTag(537150423,0,!!t,"RangeVersionHistoryHighlightView.AddSheetRangeList: state is null"),c.ULS.shipAssertTag(537150422,0,!t||!!t.range,"RangeVersionHistoryHighlightView.AddSheetRangeList: state.Range is null"),c.ULS.shipAssertTag(537150421,0,!t||!!t.sheetId,"RangeVersionHistoryHighlightView.AddSheetRangeList: state.SheetId is null"),
c.ULS.shipAssertTag(537150420,0,!!z,"RangeVersionHistoryHighlightView.AddSheetRangeList: div is null")})};tl.Object.defineProperties(a.prototype,{PJ:{configurable:!0,enumerable:!0,get:function(){return[a.u4]}},Nb:{configurable:!0,enumerable:!0,get:function(){return this.zhb||(this.zhb=v.g(this.$).Nb)}}});a.u4=23;Object(y.a)(a,"RangeVersionHistoryHighlightView",null,[341])},1385:function(y,D,b){function a(xc){var bd=Hf.call(this)||this;bd.$=xc;bd.dc();return bd}function d(xc,bd,Bd,Ld){var Od=this;
Bd=void 0===Bd?null:Bd;Ld=void 0===Ld?null:Ld;this.iGa=null;this.X3e=!1;this.pBf=function(ef){Od.uZa.Ngj();Od.uZa.Rvc(!0);Kd.a.yj(ef.wywaActivities)||2===ef.wywaActivities[0].type||Od.uZa.t0h(ef.wywaActivities[0])};this.$=xc;this.uZa=new N(this.$);this.i0d=new ca($a.AFrameworkApplication.Eb,Ce.EwaSettings.la(470));xc=tc.a.FCj(Cg.a.instance.mc("Common.App.CatchUpActivity.ICatchUpRequestHandler"));this.thf=Ld;this.tue=new v(this.$,this,xc,this.p5a());this.sue=new U(this.$,$a.AFrameworkApplication.Eb);
this.emptyCatchUpBehaviorManager=new u(this.$);this.Xki(function(ef){Od.Izi(ef)},bd);this.Pmi();bd=null;Bd||(bd=Cg.a.instance.resolve("Common.App.CatchUpActivity.FloodgateEventLogger"));this.flyoutRibbonButton=Bd||new n(bd);this.flyoutFocus=new l(this.$,this.flyoutRibbonButton)}function c(){this.emptyCatchUpBehaviorManager=this.ulsLogger=this.uiCulture=this.flyoutRibbonButton=this.flyoutFocus=this.dataCulture=this.changeSummariesDataProvider=this.appColorUpdateIsEnabled=this.activityRequestManager=
this.activityNavigationManager=this.activityContentManager=null}function k(){this.flyoutAnchorTarget=this.useCompactSummaryString=this.disableDismissOnClick=this.customDynamicEntryPointEnabled=this.dynamicEntryPointEnabled=this.activityFeedDataEnabled=this.includeRelevantAuthorsInSummaryString=this.summaryStringEnabled=this.flyoutEnabled=this.featuredActivityGroupsEnabled=null}function n(xc){this.buttonClickedCallback=null;this.Xhb=this.Dxb=!1;this.qxh=new Date;this.pRe=xc}function l(xc,bd){this.$=
xc;this.flyoutRibbonButton=void 0===bd?null:bd;wc.a(this.$).Tg(this);this.hasFocus=!1}function f(xc){window.performance&&"function"===typeof window.performance.mark&&window.performance.mark("CatchUpInit."+xc)}function u(xc){this.$=xc}function v(xc,bd,Bd,Ld){Ld=void 0===Ld?!1:Ld;this.$=xc;this.catchUpActivityManager=bd;this.uue=Bd;this.aEb=Cg.a.instance.resolve("Common.App.People.IPeopleColorUtils");this.Roc=Cg.a.instance.resolve("Common.App.People.IUserProfilePictureUtils");this.p5a=Ld}function m(){var xc=
r.call(this)||this;xc.relationship=0;return xc}function A(){this.color=this.imageUrl=this.email=this.givenName=this.displayName=this.provider=this.id=null}function x(){this.lowWaterline=this.highWaterline=this.wywaWaterline=this.actors=this.activities=null;this.hasMore=!1;this.isFirstDocumentOpen=null}function t(){this.activityFeedItems=null}function z(){this.collectionId=this.type=this.id=null;this.activityState=0;this.timestamp=this.activityFeedItemPayload=null}function r(){this.activityFeedItemId=
this.activityId=null;this.type=0;this.collectionId=this.state=this.navigationId=this.relevancy=this.displayTimestamp=this.location=this.actors=null}function G(xc,bd,Bd,Ld,Od,ef,ag){ag=xc.Oa(1,void 0===ag?null:ag);ag.getRelevantActivitiesDataRequest=bd;return cb.i(xc,"GetRelevantActivitiesData",ag,Bd,Ld,Od,ef,0)}function w(xc,bd,Bd,Ld,Od,ef){ef=xc.Oa(1,void 0===ef?null:ef);return cb.i(xc,"GetLineageWywaAuthors",ef,bd,Bd,Ld,Od,4)}function B(){}function U(xc,bd){this.$=xc;this.Di=bd}function N(xc){var bd=
this;this.pQa=this.j2b=this.rea=null;this.t4={};this.ICa=null;this.Mhd=!1;this.qCb=function(Bd,Ld){switch(Ld.state){case 0:case 1:3===Ld.DCd&&(bd.L_h(),bd.pQa=null);break;case 2:break;case 3:bd.D4c();bd.pQa=Ld.activityId;bd.Irj();break;default:dc.ULS.shipAssertTag(537168030,0,!1,"CatchUpActivityHighlightManager.OnHighlightStateChanged - Invalid CatchUpActivityHighlightState:"+Ld.state)}};this.Zk=function(){bd.Nqb()};this.kd=function(){bd.Nqb()};this.Wo=function(){bd.Nqb()};this.Mj=function(){bd.Nqb()};
this.RZf=function(Bd,Ld){bd.rea&&Ld.YG!==bd.Aja&&(Ld.isSticky&&bd.O4b(!0),(Bd=bd.oFj(Ld.YG))?(bd.rea.createActivityIndicatorTooltip(Object.assign(new W,{target:Ld.YG,container:Bd,activityIds:[Ld.activityId],isSticky:Ld.isSticky,dirHint:bd.gridView.rtl?12:9})),Ld.isSticky?(bd.Aja=Ld.YG,dc.ULS.sendTraceTag(51172352,0,50,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler: Activity Indicator Raising Selected/Unselected Event.")):(bd.scc=Ld.YG,dc.ULS.sendTraceTag(51172353,0,50,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler: Activity Indicator Raising Hover/Unhover Event.")),
bd.Nec||(bd.gridView.view.it(bd.jzc),bd.gridView.Nq(bd.jzc),bd.Nec=!0)):dc.ULS.shipAssertTag(537168027,0,!1,"CatchUpActivityHighlightManager::ShowActivityFlyoutHandler FlyoutContainer is null."))};this.xFe=function(Bd,Ld){bd.O4b(Ld.bbh)};this.jzc=function(){bd.rea?(bd.Aja&&bd.rea.updateActivityIndicatorTooltip(Object.assign(new P,{target:bd.Aja,isSticky:!0})),bd.scc&&bd.rea.updateActivityIndicatorTooltip(Object.assign(new P,{target:bd.Aja,isSticky:!1}))):dc.ULS.shipAssertTag(537168024,0,!1,"CatchUpActivityHighlightManager::UpdateActivityFlyouts ActivityIndicatorTooltipManager is null.")};
this.$=xc;this.gridView=Bc.g(this.$);this.ha=this.gridView.ha;this.qb=this.gridView.Kc;this.ha.DXb(this.Zk);this.ha.jG(this.kd);this.gridView.DD(this.Wo);this.qb.wm(this.Mj);this.Aja=this.scc=null;this.Nec=!1;this.t$c={}}function P(){this.target=null;this.isSticky=!1}function ia(){this.clearSticky=!1}function W(){this.activityIds=this.container=this.target=null;this.isSticky=!1;this.dirHint=0}function R(){this.i0c=[];this.bJb={};this.die={}}function I(xc,bd,Bd,Ld,Od){xc=Q.call(this,xc,bd,Bd,Ld)||
this;xc.ranges=Od;xc.a6a=!1;return xc}function Q(xc,bd,Bd,Ld){var Od=mf.call(this)||this;Od.$=xc;Od.xZd=bd;Od.Xfg=Bd;Od.AB=Ld;Od.state=0;return Od}function O(xc,bd,Bd){Bd=xf.call(this,xc,bd,Bd)||this;Bd.gridView=Bc.g(xc);Bd.Vla=bd;return Bd}function ba(xc){var bd=this;this.qCb=function(){switch(bd.Hu.model.state){case 1:bd.V_f(!0);break;case 0:bd.LJb(!1);break;case 2:case 3:bd.LJb(!0);break;default:dc.ULS.shipAssertTag(537167968,0,!1,"RangeCatchUpActivityView.OnHighlightStateChanged - Invalid CatchUpActivityHighlightState:"+
bd.Hu.model.state)}};this.ylg=xc;this.Hu.qke(this.qCb);this.zaa=[]}function ca(xc){this.Di=xc}function S(xc){return dd.call(this,xc)||this}function Y(xc,bd){this.$=xc;this.catchUpActivityManager=bd}function na(){this.rb=null}function Z(xc){this.NI=xc}function wa(xc){this.fpg=xc}function ma(xc){this.AWa=xc;this.P8d=new Zg.a}function pa(xc,bd,Bd){this.jog=xc;this.QTa=bd;this.dUa=Bd}function Ia(xc,bd,Bd){xc=Bg.call(this,xc,bd)||this;xc.DocumentId=null;xc.DocumentId=Bd;return xc}function Ma(xc,bd){this.Og=
xc;this.NI=bd}function ob(xc,bd,Bd,Ld,Od,ef,ag){this.C8=this.OLc=this.NLc=this.lfa=this.Djb=this.MDa=this.rPb=this.ZF=null;this.n$d=0;this.KTb=null;this.dib=!1;this.xMc=this.h_d=null;this.D4d=this.A4d=!1;this.O_d=null;this.X4d=!1;this.Vg=xc;this.hc=bd;this.TF=Bd;this.Ie=Ld;this.La=void 0===Od?null:Od;this.eCa=void 0===ef?null:ef;this.xD=void 0===ag?null:ag;this.La.$b(Rf.a.eie,be.a.frame,rg.ActionManager.$f)}function Cb(xc){var bd=dg.call(this)||this;bd.$=xc;bd.dc();return bd}function Xa(xc,bd){var Bd=
this;this.Qnd=!1;this.Kf=function(){Bd.R6f()};this.$=xc;Ce.EwaSettings.la(641)&&this.$.fa.P6a&&!Xa.Avb&&(bd&&!bd.ncb||this.MNj(),Xa.Z3e?dc.ULS.sendTraceTag(537155461,0,50,"LineageTeachingCalloutTriggerManager will not trigger WYWA waterline check as it was already checked in session"):bd&&!bd.ncb||this.SNj());dc.ULS.sendTraceTag(537155460,0,50,"LineageTeachingCalloutTriggerManager is initialized.")}function Sb(xc){var bd=og.call(this)||this;bd.ti=null;bd.$g=null;bd.$=xc;bd.dc();return bd}function Tb(xc,
bd,Bd){var Ld=gg.call(this,xc)||this;Ld.ke=null;Ld.Vwe=null;Ld.uCb=null;Ld.nnd=!0;Ld.nr=0;Ld.ep=!1;Ld.qd=function(Od,ef){ef.Qg||Ld.l_c()};Ld.Zj=function(){Ld.l_c();return!0};Ld.$=bd;Ld.taskPaneManager=Bd;Ld.$.Vl(Ld.qd);wc.a(Ld.$).Tg(Ld);rf.a.Gd(Ld.$)&&(Ld.isVisible=!1);return Ld}function da(xc){var bd=Sc.call(this)||this;bd.lineageTaskPane=null;bd.S6=null;bd.$=xc;bd.dc();return bd}function ya(xc,bd,Bd,Ld){var Od=this;this.rsb=this.QE=null;this.zD=this.krd=0;this.uCb=function(){Od.S6&&(Od.S6.stop(),
Od.S6=null);Od.BJb.start();Od.QE.createLineagePane(Od.frd,Od.rsb)};this.lineageOpenPaneOrChangeFilterRequest=function(ef,ag){function lg(Ec,md,Md){var Me=Od.$.qa.ta,Qe=Ob;Ec=se.b(Ec,Od.rdd("LineageOpenPaneOrChangeFilter"));md=se.a(md,$f);var sf=Me.Oa(1,null);sf.clientParams=Aa;sf.lineageFilter=Qe;return cb.i(Me,"LineageOpenPaneOrChangeFilter",sf,Ec,md,Md,null,0)}function $f(Ec){Ec=gc.a.yg(Ec.data);dc.ULS.sendTraceTag(537155481,0,50,"LineageManager::LineageOpenPaneOrChangeFilter service call failed. Errors: [{0}]",
Pd.a.Uc(Ec))}Od.BJb.stop();Ae.b(Od.$).ae(ue.a.vGi,{});Od.$tj();var Aa=Object.assign(new Lb,{ClientViewCapacity:ef.clientViewCapacity}),Ob=null;ag&&(Ob=Object.assign(new Ra,{FilterSheetMultiRange:Od.iEj(ag.filterSheetMultiRange)}));Ce.EwaSettings.tc()?Od.$.userOperationManager.ic(new ne.a(1010,0,lg,80),null):Od.$.userOperationManager.ic(new De.a(1010,0,lg,16),null)};this.lineageLoadMoreRequest=function(ef){function ag($f,Aa,Ob){var Ec=Od.$.qa.ta;$f=se.b($f,Od.rdd("LineageLoadMore"));Aa=se.a(Aa,lg);
var md=Ec.Oa(1,null);md.fetchFromBelow=ef;return cb.i(Ec,"LineageLoadMore",md,$f,Aa,Ob,null,0)}function lg($f){$f=gc.a.yg($f.data);dc.ULS.sendTraceTag(537155480,0,50,"LineageManager::LineageLoadMore service call failed. Errors: [{0}]",Pd.a.Uc($f))}Ae.b(Od.$).ae(ue.a.uGi,{});Ce.EwaSettings.tc()?Od.$.userOperationManager.ic(new ne.a(1011,0,ag,80),null):Od.$.userOperationManager.ic(new De.a(1011,0,ag,16),null)};this.lineageRefreshViewRequest=function(){function ef(lg,$f,Aa){var Ob=Od.$.qa.ta;lg=se.b(lg,
Od.rdd("LineageRefreshView"));$f=se.a($f,ag);var Ec=Ob.Oa(1,null);return cb.i(Ob,"LineageRefreshView",Ec,lg,$f,Aa,null,0)}function ag(lg){lg=gc.a.yg(lg.data);dc.ULS.sendTraceTag(537155479,0,50,"LineageManager::LineageRefreshView service call failed. Errors: [{0}]",Pd.a.Uc(lg))}Ae.b(Od.$).ae(ue.a.wGi,{});Ce.EwaSettings.tc()?Od.$.userOperationManager.ic(new ne.a(1012,0,ef,80),null):Od.$.userOperationManager.ic(new De.a(1012,0,ef,16),null)};this.lineageUpdateViewRequest=function(){Sa(Od.$.qa.ta,function(ef){if(ef=
vd.a(ef)?null:ef.Result){var ag={};ag=(ag.CountOfUpdatedActivities=ef.LineageActivitiesResponse.ActivityList.length,ag);Ae.b(Od.$).ae(ue.a.xGi,ag);ef=Object.assign(new lb,{activityList:Od.WCd(ef.LineageActivitiesResponse.ActivityList),latestActivityId:ef.LineageActivitiesResponse.LastSearchedActivityId,oldestActivityId:ef.LineageActivitiesResponse.FirstSearchedActivityId,serverMessageCode:ef.LineageActivitiesResponse.LineageResponseCode,lastSearchedActivityTimestamp:new Date(ef.LineageActivitiesResponse.EcmaLastSearchedDate),
hasNewActivities:ef.HasNewActivities,filterSheetMultiRange:Od.ZDj(ef.LineageActivitiesResponse.FilterSheetMultiRange),serverFirstActivityId:ef.LineageActivitiesResponse.ServerFirstActivityId,serverLastActivityId:ef.LineageActivitiesResponse.ServerLastActivityId,showLoadPrevious:ef.LineageActivitiesResponse.ShowLoadPrevious,eolCorrelationId:ef.LineageActivitiesResponse.EolCorrelationId,eolDateHideHistory:new Date(ef.LineageActivitiesResponse.EolDateHideHistory),eolPersonHideHistory:Od.xub(ef.LineageActivitiesResponse.EolPersonHideHistory)});
Od.QE.onLineageActivitiesUpdateResponse(ef)}else dc.ULS.shipAssertTag(537155475,0,!!ef,"LineageManager.LineageUpdateView returned null response.")},function(ef){ef=gc.a.yg(ef.data);dc.ULS.sendTraceTag(537155474,0,50,"LineageManager::LineageUpdateView service call failed. Errors: [{0}]",Pd.a.Uc(ef))},null,null)};this.onCardSelected=function(ef,ag){if(ef=ef.rangeHighlightLocation){if(ag){var lg=Ee.Z(ag,null);var $f=lg.range;if(lg.returnValue){Od.L5e(ef.sheetName,Od.Dub([Ee.j($f)]));return}dc.ULS.shipAssertTag(537155472,
0,!1,"The produced subCellLocation string "+ag+" is not valid.")}ef.rangeList.length?Od.L5e(ef.sheetName,ef.rangeList):Od.u0h(ef.sheetName)}};this.onLearnMoreLinkClicked=function(){if(Ce.EwaSettings.isChangeGateEnabled("OfficeVSO:4597686_LineageLearnMoreLinkEnabled")){var ef=new Ad.a(-859308420,ee.a.Wb,Od.$.ed,12,null),ag={};ag=(ag[ee.a.Kg]="HelpID=XLO_LineageTS",ag.InputMethod=ee.a.Wb,ag[ee.a.hd]=je.a.XU,ag.ShouldCanvasTakeFocus=!0,ag);Od.$.Ka.Zb(ef,ag)}};this.onVersionHistoryButtonClicked=function(ef){Od.$.Ka.Zb(new Ad.a(-1112508866,
ef,Od.$.ed,12,null))};this.isFeatureEnabled=function(){return!1};this.Kf=function(){var ef=Od.$.fa.zn.LineageVersion;ef!==Od.krd&&(dc.ULS.sendTraceTag(537155470,0,50,"LineageManager.OnWorkbookMetadataChanged: lineageVersion: {0}, this.lineageVersion: {1}",ef,Od.krd),Od.krd=ef,Od.S_i())};this.Zc=function(ef,ag){Od.QE&&!Od.lineageTaskPane.hfc&&ag.aH&&(dc.ULS.sendTraceTag(587220563,0,15,"LineageManager::SessionIdChanged detected."),Od.onStaleActivitiesDetected())};this.vq=function(){Od.QE&&!Od.lineageTaskPane.hfc&&
(dc.ULS.sendTraceTag(587220562,0,15,"LineageManager::LoadOnDemandOccurred detected."),Od.onStaleActivitiesDetected())};this.AC=function(){var ef=Od.f3a();Od.QE.onFilterableSheetListChange(ef)};this.aya=function(){var ef=Od.f3a();Od.QE.onFilterableSheetListChange(ef)};this.Emc=function(){var ef=Od.f3a();Od.QE.onFilterableSheetListChange(ef)};this.onPaneClosed=function(){Od.QE.onPaneClosed();Fa(Od.$.qa.ta,null,function(ef){ef=gc.a.yg(ef.data);dc.ULS.sendTraceTag(537155469,0,50,"LineageManager::OnLineageClosePaneFailed service call failed. Errors: [{0}]",
Pd.a.Uc(ef))},null,null)};this.onRangeFilterInputEnabled=function(ef){ef?Od.gridView.ha.k2(Od.kd):Od.gridView.ha.Nca(Od.kd)};this.kd=function(){var ef=Ee.q(Od.gridView.ha.va.activeRange,Od.$);ef=Object.assign(new Qb,{rangeList:Od.Dub(ef.Ranges),sheetName:ef.SheetName});Od.QE.onSelectedRangeUpdated(ef)};this.tryParseRangeInfo=function(ef){var ag=Ee.Z(ef,Od.$.xa);var lg=ag.sheetName;ef=ag.range;return ag.returnValue?(lg||(lg=Od.$.xa.oa.sheetName),ag=[],ag.push(ef),ef=Ee.u(lg,null,ag),Object.assign(new Qb,
{rangeList:Od.Dub(ef.Ranges),sheetName:ef.SheetName})):null};this.kz=function(){var ef=Od.zD!==Od.$.fa.rf;Od.QE&&Od.lineageTaskPane.isVisible&&ef&&(Od.zD=Od.$.fa.rf,Od.QE.onRefreshRequired())};this.$=xc;bd.Ha(366,this);this.gridView=Bc.g(this.$);this.lineageTaskPane=Bd;this.frd=this.lineageTaskPane.ZL();this.batchSize=50;this.S6=Ld;this.BJb=this.$.Ub.Xh("UserAction","LineagePaneLoadingShimmerStopWatch");this.Roc=Cg.a.instance.resolve("Common.App.People.IUserProfilePictureUtils");this.S4h();this.wwg()}
function hb(){this.hasOldValue=this.hasNewValue=!1;this.cellLocation=this.oldValue=this.newValue=null}function Gb(){this.activityId=0;this.displayTimestamp=this.author=this.activityGuid=null;this.activityType=0;this.rangeHighlightLocation=this.isBulkEditOverflow=this.valueChanges=this.gridLocation=this.sheetName=this.nestedActivityList=null;this.degradedCardTypeBits=0}function Qb(){this.sheetName=this.rangeList=null}function Fb(){this.lastCol=this.firstCol=this.lastRow=this.firstRow=0}function ta(){this.logger=
this.uiCulture=this.dataCulture=null;this.clientBatchSize=0;this.lineageAppCallbacks=this.filterableSheetList=null}function xa(){this.imageUrl=this.email=this.displayName=this.provider=this.id=null}function sa(){this.onLearnMoreLinkClicked=this.isFeatureEnabled=this.onRangeFilterInputEnabled=this.tryParseRangeInfo=this.onVersionHistoryButtonClicked=this.onCardSelected=this.lineageUpdateViewRequest=this.lineageRefreshViewRequest=this.lineageLoadMoreRequest=this.lineageOpenPaneOrChangeFilterRequest=
null}function lb(){var xc=Yb.call(this)||this;xc.hasNewActivities=!1;xc.filterSheetMultiRange=null;return xc}function Yb(){this.activityList=null;this.oldestActivityId=this.latestActivityId=0;this.lastSearchedActivityTimestamp=null;this.serverLastActivityId=this.serverFirstActivityId=this.serverMessageCode=0;this.docId=null;this.showLoadPrevious=!1;this.eolPersonHideHistory=this.eolDateHideHistory=this.eolCorrelationId=null}function Fa(xc,bd,Bd,Ld,Od,ef){ef=xc.Oa(1,void 0===ef?null:ef);return cb.i(xc,
"LineageClosePane",ef,bd,Bd,Ld,Od,0)}function Sa(xc,bd,Bd,Ld,Od,ef){ef=xc.Oa(1,void 0===ef?null:ef);return cb.i(xc,"LineageUpdateView",ef,bd,Bd,Ld,Od,0)}function Ra(){}function Lb(){}function Ja(xc){var bd=vg.call(this)||this;bd.$=xc;bd.dc();return bd}function xb(xc){this.ncb=!0;xb.W9e()?xb.b$e()?this.ncb=xc:this.ncb=!1:this.ncb=!0}function Kb(xc){return Yf.call(this,xc)||this}function Eb(xc,bd){this.$=xc;this.lineageManager=bd;xc=[new Lf.a(Zb.a.hrd,1038647878,0,0,2168),new Lf.a(Zb.a.idle,1038647878,
0,1)];Nb.a(this.$).iFd(new Of.a(Zb.a.grd,Zb.a.idle,xc),new Hc(Zb.a.hrd,Zb.a.idle,bd))}function Hc(xc,bd,Bd){xc=Uf.call(this,xc,bd)||this;xc.lineageManager=Bd;return xc}function Xc(xc){var bd=Yd.call(this)||this;bd.$=xc;bd.dc();return bd}function Pc(xc){return jd.call(this,xc)||this}function wd(xc){var bd=this;this.baseVersionInfo=this.c3=this.boa=this.nm=this.ewaAccessibilityManager=this.RLb=null;this.EFd=this.tof=!1;this.SCe=!0;this.dialog=this.jB=this.fRe=this.ZC=this.YWd=this.WWd=this.XWd=null;
this.myf=function(Bd){dc.ULS.sendTraceTag(42553885,0,50,"VersionHistoryPaneActor:OnRestoreVersionSelected - Restore is triggered");if(bd.Sqj()){var Ld=function(ef){Wa.c(2138207060,!1);bd.nm.setRestoreFailedAtServer(ef)};bd.ZC&&bd.ZC.startTimer(wd.w5f);var Od=function(){bd.ZC.endTimer(wd.w5f);bd.mue(bd.ZC)};bd.nm.setRestoreInProgress();Jf.a(bd.$).Rs(new oc.a(Zb.a.Qy,5,function(){var ef=Nb.a(bd.$).nd.activityState;ef[nc.a.Kq]=Zb.a.exe;ef[ib.a.XX]=!0;ef[ib.a.aT]=0;ef[Ha.Fbg]=Bd;ef[Ha.Zoc]=$a.AFrameworkApplication.hj;
ef[Ha.rsd]=Od;ef[bb.n0f]=Ld}))}else Wa.c(2138207060,!1)};this.YAf=function(Bd){bd.RLb.then(function(Ld){Ld.enterFocusTrapZone();return null});dc.ULS.sendTraceTag(537150349,0,50,"VersionHistoryPaneActor: OnVersionsReady called");bd.ZC.endTimer(wd.RSd);bd.ZC.incrementCounter(wd.g_g);dc.ULS.sendTraceTag(537150348,0,50,"VersionHistoryPaneActor: OnVersionsReady TimeTakenGetVersionsToOnVersionsReady Ms:{0}",bd.ZC.getTimerDuration(wd.RSd));bd.l9i(Bd.containerDiv);Bd.versions&&0<Bd.versions.length&&(bd.fRe=
wd.tE(Bd.versions[Bd.versions.length-1]));bd.c3&&bd.boa&&bd.HKd(bd.c3);dc.ULS.sendTraceTag(537150346,0,50,"VersionHistoryPaneActor:OnVersionsReady Exit")};this.onVersionSelected=function(Bd){dc.ULS.sendTraceTag(537150345,0,50,"VersionHistoryPaneActor:OnVersionSelected called. for Version:{0}, LastSelected:{1}",wd.tE(Bd.currentVersion),wd.tE(bd.c3));bd.ZC.incrementCounter(wd.f_g);bd.c3=Bd.currentVersion;bd.baseVersionInfo=Bd.baseVersion;bd.tof=Bd.noBaseToCompareTo;bd.boa&&bd.oNj()&&(bd.HKd(Bd.currentVersion),
dc.ULS.sendTraceTag(537150344,0,50,"VersionHistoryPaneActor:OnVersionSelected Exit"))};this.Usf=function(Bd){dc.ULS.sendTraceTag(537150337,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady called. for Version:{0} UpdatedVersionsCount{1}, LastSelected:{2}",(null===Bd||void 0===Bd?0:Bd.versionSelected)?wd.tE(Bd.versionSelected.currentVersion):null,(null===Bd||void 0===Bd?0:Bd.updatedVersions)?Bd.updatedVersions.length:0,wd.tE(bd.c3));bd.ZC.incrementCounter(wd.e_g);if(bd.baseVersionInfo){if((null===
Bd||void 0===Bd?0:Bd.updatedVersions)&&2<=Bd.updatedVersions.length){var Ld=null,Od=null,ef=wd.tE(bd.c3),ag=wd.tE(bd.baseVersionInfo);Bd=yl(Bd.updatedVersions);for(var lg=Bd.next();!lg.done;lg=Bd.next()){lg=lg.value;var $f=wd.tE(lg);ef===$f?Ld=lg:ag===$f&&(Od=lg);if(Ld&&Od)break}Ld&&Od?(bd.c3=Ld,bd.baseVersionInfo=Od,dc.ULS.sendTraceTag(537150307,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady -Calling versionsViewController:OnVersionSelected RevisionID[N]: {0}, RevisionID[N-1]: {1}.",wd.tE(bd.c3),
wd.tE(bd.baseVersionInfo)),bd.HKd(bd.c3)):dc.ULS.sendTraceTag(537150306,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady - does not find currentVersion or baseVersion from UpdatedVersions. RevisionID[N]: {0}, RevisionID[N-1]: {1}.",ef,ag)}else dc.ULS.sendTraceTag(537150305,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady - no diff call due to downloadTokenReadyObject or downloadTokenReadyObject.UpdatedVersions objects are null or not enough.");dc.ULS.sendTraceTag(537150304,0,50,"VersionHistoryPaneActor:OnDownloadTokenReady")}else dc.ULS.sendTraceTag(537150336,
0,50,"VersionHistoryPaneActor:OnDownloadTokenReady baseVersionInfo is null in OnDownloadTokenReady callback.")};this.Wrf=function(){dc.ULS.sendTraceTag(537150303,0,50,"VersionHistoryPaneActor:OnCloseVersionHistoryDialog Called");bd.cVg();var Bd=new Ad.a(1470556788,0,bd.$.ed,0,null);bd.$.Ka.Zb(Bd)};this.Dyf=function(Bd){dc.ULS.sendTraceTag(41739662,0,50,"VersionHistoryPaneActor:OnSaveACopy Called");var Ld=new Ad.a(-1244760097,0,bd.$.ed,0,null);bd.$.ig.get(51)&&(dc.ULS.sendTraceTag(537150301,0,50,"VersionHistoryPaneActor:OnSaveACopy for ODConsumer Called"),
Ld=new Ad.a(-309686558,0,bd.$.ed,0,null));Wa.c(1604651619,!0);var Od={};bd.$.Ka.Zb(Ld,(Od.FileDownloadUrl=Bd,Od))};this.Vsf=function(Bd){dc.ULS.sendTraceTag(537150300,0,50,"VersionHistoryPaneActor:OnDownloadVersion Called");Bd=new od.QueryStringBuilder(Bd);Bd.Ei("fn",$a.AFrameworkApplication.fileName);dc.ULS.sendTraceTag(537150299,0,50,"VersionHistoryPaneActor:OnDownloadVersion URL Length is "+Bd.toString().length);8===bd.$.frame.E7a(Bd.toString(),!0)?(dc.ULS.sendTraceTag(587830283,0,10,"VersionHistoryPaneActor:OnDownloadVersion failed"),
Wa.c(1316171850,!1)):Wa.c(1316171850,!0)};this.yqf=function(Bd){bd.nm.setFullAppErrorCode(Bd)};this.guf=function(Bd){switch(Bd){case 101:Bd="VHFailedToGetDownloadToken";break;case 100:Bd="VHFailedToLoadVersionList";break;case 104:Bd="VHVersioningNotEnabled";break;case 105:Bd="VHFileNotFound";break;case 106:Bd="VHVersionTooOld";break;default:Bd="None"}bd.ZC.addEvent("OnFullAppError",Bd);dc.ULS.sendTraceTag(537150291,0,10,"FullApp Error Event: {0}",Bd)};this.ozd=function(Bd){bd.SCe=Bd;dc.ULS.sendTraceTag(537150290,
0,50,"VersionHistoryPaneActor:Show Changes toggled to:{0}",Bd.toString());var Ld={};bd.dLd(ed.a.vLb,(Ld.ToggleValue=Bd,Ld))};this.xvf=function(Bd){dc.ULS.sendTraceTag(50405840,0,50,"VersionHistoryPaneActor:OnIteratorSelected next: {0}",Bd);Wa.c(1488635506,!0);var Ld={};Bd?bd.dLd(ed.a.iterateNext,Ld):bd.dLd(ed.a.Cwa,Ld)};this.nFb=function(Bd){switch(Bd.MessageId){case Je.a.gTa:dc.ULS.sendTraceTag(537150289,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession WacAppCompleted ");Ce.EwaSettings.la(436)&&
bd.nm.setVersionLoadComplete();break;case Je.a.hTa:dc.ULS.sendTraceTag(51128035,0,10,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession WacAppFailed");break;case ed.a.setCurrentChangeCount:Bd=Bd.Values.count;dc.ULS.sendTraceTag(537150288,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession SetCurrentChangeCount : {0}",Bd);bd.nm.setCurrentChangeCount(Bd);break;case ed.a.setTotalChangesCount:Bd=Bd.Values.count;dc.ULS.sendTraceTag(537150287,0,50,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession SetTotalChangesCount : {0}",
Bd);bd.nm.setTotalChangesCount(Bd);break;case ed.a.gOa:bd.ozd(bd.SCe);break;default:dc.ULS.sendTraceTag(537150286,0,15,"VersionHistoryPaneActor.ReceivePostMessageFromVHSession MessageID:{0}",Bd.MessageId)}};this.$=xc;this.b7b=this.$.Ib+wd.Jrh;this.DFd=!1;Ce.EwaSettings.la(396)&&this.n6g();this.zzb="";this.xqd=0;this.perfTelemetryInfos=[]}function Tc(){this.perfTelemetryInfos=this.appSettings=this.docId=this.latestStreamServiceBase=this.serviceBase=this.ulsLogger=null}function ub(){this.appName=0;
this.wdEnableDownloadTokens=!1;this.retryCount=0;this.wdEnableIterator=this.wdEnableRestore=this.wdEnableSaveACopy=!1;this.uiLocale=this.wacCluster=this.userSessionId=null;this.disableSaveACopy=this.wdEnableShowVersionChanges=this.wdEnableHiddenButtonsUntilVersionLoadComplete=this.viewerRootPositionRelative=this.useXhr=this.isRtl=!1;this.wdEnableDownloadVersion=this.disabledChangeGates=null;this.wdEnableDeleteVersions=this.wdEnableSaveACopyOverFlowMenu=!1;this.wdExperimentWithIteratorLocation=this.wdEnableAppColorUpdate=
null}function fb(){this.telemetryCollector=this.baseVersionInfo=this.selectedVersionInfo=null}function Ta(){this.rootDiv=this.appBootSettings=null}function eb(){this.actionUrl=this.ulsLogger=null;this.useFetch=this.hideEmbedFooter=!1}function tb(xc){this.jw=xc}function rc(xc){this.jw=xc}function wb(xc){this.jw=xc}function E(){}function Mb(xc,bd){this.$=xc;this.ZNj=bd}function ka(xc,bd){var Bd=uc.call(this)||this;Bd.activityName=xc;Bd.$L=bd;Bd.dc();return Bd}function bb(xc,bd){return Ic.call(this,
xc,bd)||this}function Ga(xc,bd,Bd){var Ld=Jb.call(this)||this;Ld.activityName=xc;Ld.$L=bd;Ld.vJ=Bd;Ld.dc();return Ld}function Ha(xc,bd,Bd,Ld,Od){var ef=db.call(this,xc,bd)||this;ef.vi=null;ef.retryCount=0;ef.iJi=function(ag){var lg=ef.qFj(ag);ag=lg.SId;lg.returnValue?ag.Success?(Wa.c(2138207060,!0),dc.ULS.sendTraceTag(42287318,0,15,"RestoreVersionActivity:onRestoreSuccessCallback Restore version is successful")):(Wa.c(2138207060,!1),dc.ULS.sendTraceTag(42287317,0,10,"RestoreVersionActivity:onRestoreSuccessCallback Restore version failed with message {0}",
ag.Output),ef.oh(ef.vJ)):(Wa.c(2138207060,!1),ef.oh(ef.vJ));(ag=ef.vi.activityState[Ha.rsd])&&ag();ef.Uo();ef.vi.kJ()};ef.gJi=function(){if(0<ef.retryCount)dc.ULS.sendTraceTag(537150418,0,15,"RestoreVersionActivity:onRestoreFailureCallback Retrying version restore, retry count : {0}",ef.retryCount),ef.retryCount--,ef.YPf();else{dc.ULS.sendTraceTag(42287320,0,10,"RestoreVersionActivity:onRestoreFailureCallback Restore version failed");Wa.c(2138207060,!1);ef.oh(ef.vJ);var ag=ef.vi.activityState[Ha.rsd];
ag&&ag();ef.Uo();ef.vi.kJ()}};ef.vJ=Bd;ef.I2=Ld;ef.baseUrl=Od;return ef}b.r(D);var Ua=b(10),kb=b(0),$a=b(5),Xb=b(216),dc=b(13),Za=b(111),Wa=b(176),Ba=b(38),db=Za.a;vm(Ha,db);Ha.prototype.execute=function(xc){this.vi=xc;this.retryCount=3;this.YPf();return 1};Ha.prototype.YPf=function(){var xc=this.vi.activityState[Ha.Zoc],bd=this.vi.activityState[Ha.Fbg],Bd=String.format("{0}{1}",this.baseUrl,"restoreversion.ashx");xc=Ba.c({VersionId:bd,QuerySignature:xc});this.I2.Ul(Bd,2,xc,{"Content-Type":"application/json; charset=utf-8"},
!1,2,this.iJi,this.gJi,null)};Ha.prototype.qFj=function(xc){var bd=null;xc=xc?xc.data?xc.data.fe:null:null;if(!xc||!xc.length)return dc.ULS.sendTraceTag(537150417,0,10,"RestoreVersionActivity:TryGetRestoreResult data returned from restoreversion call is null or empty"),{returnValue:!1,SId:bd};xc=Ba.d(xc);bd=xc.uu;return xc.returnValue?{returnValue:!0,SId:bd}:(dc.ULS.sendTraceTag(537150416,0,10,"RestoreVersionActivity:TryGetRestoreResult Failed in deserialization of returned data from restore version"),
{returnValue:!1,SId:bd})};Ha.Fbg="RVAvi";Ha.Zoc="RVAqs";Ha.rsd="RVlvrt";Object(kb.a)(Ha,"RestoreVersionActivity",Za.a,[]);var Zb=b(6),Jb=Xb.a;vm(Ga,Jb);Ga.prototype.create=function(){this.Fb(new Ha(this.activityName,this.$L,this.vJ,$a.AFrameworkApplication.Hd,$a.AFrameworkApplication.sa.Pa.h_))};Ga.ja=function(xc){xc.da.Ha(320,new Ga(Zb.a.VId,Zb.a.lj,Zb.a.WId))};Object(kb.a)(Ga,"RestoreVersionActivityFactory",Xb.a,[]);var Ic=Za.a;vm(bb,Ic);bb.prototype.execute=function(xc){var bd=this;(0,xc.activityState[bb.n0f])(function(){bd.Uo();
xc.kJ()});return 1};bb.n0f="RVEAssea";Object(kb.a)(bb,"RestoreVersionErrorActivity",Za.a,[]);var uc=Xb.a;vm(ka,uc);ka.prototype.create=function(){this.Fb(new bb(this.activityName,this.$L))};ka.ja=function(xc){xc.da.Ha(321,new ka(Zb.a.WId,Zb.a.lj))};Object(kb.a)(ka,"RestoreVersionErrorActivityFactory",Xb.a,[]);var za=b(77),pb=b(817),cc=b(56),Ac=b(35),ad=b(175),Jd=b(370),Xd=b(55);Mb.prototype.Xc=function(){return $a.AFrameworkApplication.ga.ra("IsAnonymousUser")?(dc.ULS.sendTraceTag(537150415,0,15,
"Verison History Command Handler: Anonymous user."),!0):!1};Mb.prototype.executeCommand=function(xc,bd){dc.ULS.sendTraceTag(537150414,0,50,"VersionHistoryCommandHandler:ExecuteCommand called.");xc=!1;switch(bd.command){case -1112508866:Jd.a(this.$)&&this.$.da.Aa(423).Svc(!1),xc=this.ZNj.nuj()}dc.ULS.sendTraceTag(537150413,0,50,"VersionHistoryCommandHandler:ExecuteCommand response{0}.",xc);return xc?Xd.Task.Ta(xc):ad.a(bd.command)};Mb.prototype.Gc=function(xc,bd){return-1112508866===bd.command&&this.$.isVersionHistoryEnabled()};
Mb.prototype.fd=function(){return!1};Object(kb.a)(Mb,"VersionHistoryCommandHandler",null,[237]);var od=b(277),Je=b(170),bc=b(384),Qd=b(23);E.addAppPLTEventToLog=function(xc){try{Microsoft.VersionHistory.VersionHistoryLogHelper.addAppPLTEventToLog(xc)}catch(bd){}};E.setIsPageLoadForFirstTime=function(xc){try{Microsoft.VersionHistory.VersionHistoryLogHelper.setIsPageLoadForFirstTime(xc)}catch(bd){}};Object(kb.a)(E,"VersionHistoryLogConnector",null,[]);var Vd=b(962),de=b(1254),pe=b(148),Ad=b(92),Pd=
b(27),Ce=b(1),Jf=b(39),oc=b(246),ed=b(1136),wc=b(256),gb=b(245),id=b(11);wb.prototype.Tg=function(){wc.a(this.jw.$).sM(this.Zd)||wc.a(this.jw.$).Tg(this)};wb.prototype.t7=function(){wc.a(this.jw.$).sM(this.Zd)&&wc.a(this.jw.$).XA(this)};wb.prototype.zh=function(xc){return id.DOMElementExtensions.Ye(this.Jb,xc)};wb.prototype.ji=function(){this.jw.$.frame.Re.dk(this.jw.$.frame.Re.cE)};wb.prototype.Vh=function(){};wb.prototype.Qe=function(xc,bd){bd||this.jw.RLb.then(function(Bd){Bd.enterHeaderFocusTrapZone();
return null});return!bd};tl.Object.defineProperties(wb.prototype,{Zd:{configurable:!0,enumerable:!0,get:function(){return gb.a.Cbg}},Jb:{configurable:!0,enumerable:!0,get:function(){return document.querySelector('[id="vhHeader"]')}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(kb.a)(wb,"VersionHistoryHeader",null,[100]);rc.prototype.Tg=function(){wc.a(this.jw.$).sM(this.Zd)||wc.a(this.jw.$).Tg(this)};rc.prototype.t7=function(){wc.a(this.jw.$).sM(this.Zd)&&wc.a(this.jw.$).XA(this)};
rc.prototype.zh=function(xc){return id.DOMElementExtensions.Ye(this.Jb,xc)};rc.prototype.ji=function(){this.jw.$.frame.Re.dk(this.jw.$.frame.Re.cE)};rc.prototype.Vh=function(){};rc.prototype.Qe=function(xc,bd){bd||this.jw.RLb.then(function(Bd){Bd.enterFocusTrapZone();return null});return!bd};tl.Object.defineProperties(rc.prototype,{Zd:{configurable:!0,enumerable:!0,get:function(){return gb.a.Dbg}},Jb:{configurable:!0,enumerable:!0,get:function(){return document.querySelector('[aria-describedby="versionHistoryPane"]')}},
canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(kb.a)(rc,"VersionHistoryPane",null,[100]);tb.prototype.Tg=function(){wc.a(this.jw.$).sM(this.Zd)||wc.a(this.jw.$).Tg(this)};tb.prototype.t7=function(){wc.a(this.jw.$).sM(this.Zd)&&wc.a(this.jw.$).XA(this)};tb.prototype.zh=function(xc){return id.DOMElementExtensions.Ye(this.Jb,xc)};tb.prototype.ji=function(){this.jw.$.frame.Re.dk(this.jw.$.frame.Re.cE)};tb.prototype.Vh=function(){};tb.prototype.Qe=function(xc,bd){bd||
this.jw.RLb.then(function(Bd){Bd.enterViewerFocusTrapZone();return null});return!bd};tl.Object.defineProperties(tb.prototype,{Zd:{configurable:!0,enumerable:!0,get:function(){return gb.a.Ebg}},Jb:{configurable:!0,enumerable:!0,get:function(){return document.querySelector('[id="vhViewer"]')}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(kb.a)(tb,"VersionHistoryViewer",null,[100]);var ib=b(133),nc=b(248),Nb=b(64),mb=b(414),Lc=b(889);Object(kb.a)(eb,"AppBootSettings",
null,[]);Object(kb.a)(Ta,"AppVersionControllerFactoryParameters",null,[]);Object(kb.a)(fb,"OnVersionSelectedParams",null,[]);Object(kb.a)(ub,"AppSettings",null,[]);Object(kb.a)(Tc,"ControllerFactoryParameters",null,[]);wd.prototype.dispose=function(){this.Vve()};wd.prototype.eSi=function(){var xc=this;this.$.da.Za(15,function(bd){xc.ewaAccessibilityManager=bd;xc.ewaAccessibilityManager.mode=2})};wd.prototype.n6g=function(){this.XWd=new rc(this);this.WWd=new wb(this);this.YWd=new tb(this)};wd.prototype.nuj=
function(){var xc=this;dc.ULS.sendTraceTag(41739649,0,15,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction called");$a.AFrameworkApplication.bK("Microsoft.Office.Excel.Server.Flighting.IDenyListExcelVersionHistoryEnableODCSaveACopy");$a.AFrameworkApplication.bK("Microsoft.Office.Excel.Server.Flighting.IDenyListVersionHistorySaveACopyOverFlowMenu");$a.AFrameworkApplication.bK("Microsoft.Office.Excel.Server.Flighting.IDenyListExcelVersionHistoryRestoreSkipCoauthCheck");this.ZC=excelVersionHistory.FactoryGlobal.getTelemetryCollector();
this.perfTelemetryInfos=[];this.ZC.startTimer(wd.v5f);if(!this.nm&&(mb.a(function(){xc.nm=versionHistory.FactoryGlobal.getVersionHistoryControllerInstance(Object.assign(new Tc,{ulsLogger:new bc.a,docId:$a.AFrameworkApplication.hj,appSettings:Object.assign(new ub,{appName:120,userSessionId:$a.AFrameworkApplication.userSessionId,wdEnableSaveACopy:Ce.EwaSettings.la(364),wdEnableDownloadTokens:Ce.EwaSettings.la(359),wacCluster:$a.AFrameworkApplication.Hd.cS,uiLocale:$a.AFrameworkApplication.uiCulture||
"en-us",wdEnableRestore:Ce.EwaSettings.la(330)&&xc.$.isEditMode,wdEnableIterator:Ce.EwaSettings.la(327)&&Ce.EwaSettings.la(328),useXhr:Qd.a.EM,wdEnableHiddenButtonsUntilVersionLoadComplete:Ce.EwaSettings.la(436),disableSaveACopy:xc.MYf(),wdEnableShowVersionChanges:Ce.EwaSettings.la(327)&&Ce.EwaSettings.la(329),disabledChangeGates:xc.$.ya.VHSDisabledChangeGates,wdEnableSaveACopyOverFlowMenu:Ce.EwaSettings.la(567),isRtl:$a.AFrameworkApplication.isRtl}),perfTelemetryInfos:xc.perfTelemetryInfos}))}),
!this.nm))return dc.ULS.sendTraceTag(537150352,0,10,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction - VersionHistoryController should not be null"),Wa.c(429638140,!1),!1;this.ouj();this.ZC.endTimer(wd.v5f);this.ZC.startTimer(wd.y5f);dc.ULS.sendTraceTag(537150351,0,50,"VersionHistoryPaneActor:ShowVersionHistoryDialogAction Returned Success");Wa.c(429638140,!0);return!0};wd.prototype.ouj=function(){this.ak();if(!document.getElementById(this.b7b)){var xc=document.createElement("div");xc.id=this.b7b;
xc.style.width="100%";xc.style.height="100%";xc.style.zIndex="998";xc.style.display="block";xc.style.position="absolute";this.$.Oq.insertBefore(xc,this.$.Oq.firstChild);this.RLb=this.nm.createVersionHistoryDialog(xc)}document.getElementById(this.b7b).style.display="block";this.vFd();this.ZC.startTimer(wd.RSd);this.nm.getVersions("")};wd.prototype.vFd=function(){Ce.EwaSettings.la(396)&&(this.XWd.Tg(),this.WWd.Tg(),this.YWd.Tg(),this.eSi())};wd.prototype.SUd=function(){Ce.EwaSettings.la(396)&&(this.XWd.t7(),
this.WWd.t7(),this.YWd.t7(),this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=0))};wd.prototype.ak=function(){this.nm.getVersionsReadyEvent().addListener(this.YAf);this.nm.getVersionSelectedEvent().addListener(this.onVersionSelected);this.nm.getCloseSelectedEvent().addListener(this.Wrf);this.nm.getFullAppErrorEvent().addListener(this.guf);this.nm.getIteratorSelectedEvent().addListener(this.xvf);this.nm.getShowVersionChangesToggledEvent().addListener(this.ozd);Ce.EwaSettings.la(359)&&
(this.nm.getDownloadTokenReadyEvent().addListener(this.Usf),this.DFd=!0);Ce.EwaSettings.la(364)&&(this.nm.getSaveACopySelectedEvent().addListener(this.Dyf),this.nm.getDownloadVersionSelectedEvent().addListener(this.Vsf));Ce.EwaSettings.la(330)&&this.$.isEditMode&&(this.nm.getRestoreVersionSelectedEvent().addListener(this.myf),this.EFd=!0);this.boa&&this.boa.getAppErrorEvent().addListener(this.yqf)};wd.prototype.mm=function(){this.nm.getVersionsReadyEvent().removeListener(this.YAf);this.nm.getVersionSelectedEvent().removeListener(this.onVersionSelected);
this.nm.getCloseSelectedEvent().removeListener(this.Wrf);this.nm.getFullAppErrorEvent().removeListener(this.guf);this.nm.getIteratorSelectedEvent().removeListener(this.xvf);this.nm.getShowVersionChangesToggledEvent().removeListener(this.ozd);Ce.EwaSettings.la(364)&&(this.nm.getSaveACopySelectedEvent().removeListener(this.Dyf),this.nm.getDownloadVersionSelectedEvent().removeListener(this.Vsf));this.DFd&&(this.nm.getDownloadTokenReadyEvent().removeListener(this.Usf),this.DFd=!1);this.EFd&&(this.nm.getRestoreVersionSelectedEvent().removeListener(this.myf),
this.EFd=!1);this.boa&&this.boa.getAppErrorEvent().removeListener(this.yqf)};wd.prototype.Sqj=function(){var xc=!0;if(Ce.EwaSettings.la(635)&&!this.$.uQ)return dc.ULS.sendTraceTag(537150350,0,15,"VersionHistoryPaneActor:ShouldTriggerRestore - Skipping coauth check with status "+this.$.fa.amIAlone.toString()),!0;if(!this.$.fa.amIAlone&&!Ce.EwaSettings.la(326)){this.nmi();this.nm.setCoauthRestoreError();xc=!1;var bd=new Ad.a(-729359593,0,this.$.ed,0,null);this.$.Ka.Zb(bd)}this.$.uQ&&(dc.ULS.sendTraceTag(42522439,
0,10,"VersionHistoryPaneActor:ShouldTriggerRestore - Restore failed, Unsaved changes present"),xc&&(xc=!1,this.juj()));return xc};wd.prototype.juj=function(){var xc=Pd.a.jd(1,0,1844,1843,0,-1603358883,"RestoreVersionUnsavedChangesError");xc=this.dialog||new pe.ErrorDialog(this.$,xc);xc.initialize();xc.mf()};wd.prototype.oNj=function(){dc.ULS.sendTraceTag(537150343,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters called for BaseVersion{0}",this.baseVersionInfo?wd.tE(this.baseVersionInfo):"");
if(wd.tE(this.c3)===this.fRe)return dc.ULS.sendTraceTag(537150342,0,15,"VersionHistoryPaneActor:ValidateDiffDiffParameters for last version"),!0;if(Ce.EwaSettings.isChangeGateEnabled("OfficeVSO:4381797_XLVHSkipBaseVersionValidateForGroupingUI")&&!this.baseVersionInfo&&this.tof)return dc.ULS.sendTraceTag(537150341,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters skipping diff last version"),!0;if(!this.baseVersionInfo)return dc.ULS.sendTraceTag(537150340,0,10,"VersionHistoryPaneActor:ValidateDiffDiffParameters for null BaseVersion"),
!1;var xc=wd.HHh(this.baseVersionInfo);dc.ULS.sendTraceTag(537150339,0,50,"downloadURL length {0}",xc?xc.length:0);return xc?!0:(dc.ULS.sendTraceTag(537150338,0,50,"VersionHistoryPaneActor:ValidateDiffDiffParameters downloadURL is null"),!1)};wd.prototype.MYf=function(){return!this.$.Yja};wd.prototype.cVg=function(){document.getElementById(this.b7b).style.display="none";var xc=new Ad.a(-1423792966,0,this.$.ed,0,null);this.$.Ka.Zb(xc);this.Vve()};wd.prototype.Vve=function(){this.ZC&&(this.ZC.endTimer(wd.y5f),
this.mue(this.ZC),this.ZC=null);this.mm();this.SUd();this.perfTelemetryInfos&&(dc.ULS.sendTraceTag(537150302,0,15,this.perfTelemetryInfos.toString()),this.perfTelemetryInfos=null);this.jB&&(this.jB.Sna(Je.a.gTa),this.jB.Sna(Je.a.hTa),this.jB.Sna(ed.a.setCurrentChangeCount),this.jB.Sna(ed.a.setTotalChangesCount),Ce.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&this.jB.Sna(ed.a.gOa),this.jB.dispose(),this.jB=null)};wd.prototype.l9i=function(xc){var bd=
this;try{this.boa?E.setIsPageLoadForFirstTime(!1):(E.setIsPageLoadForFirstTime(!0),mb.a(function(){var Bd=new eb;Bd.ulsLogger=new bc.a;Bd.actionUrl=bd.$.ya.VersionHistoryActionUrl;Bd.hideEmbedFooter=!0;Bd.useFetch=Ce.EwaSettings.la(428)&&!Qd.a.Ku;bd.boa=excelVersionHistory.FactoryGlobal.getAppVersionControllerInstance(Object.assign(new Ta,{appBootSettings:Bd,rootDiv:xc}))}))}catch(Bd){dc.ULS.sendTraceTag(41239239,0,10,"VersionHistoryPaneActor: ResetAppVersionController failed due to exception. {0}",
Bd)}};wd.prototype.HKd=function(xc){dc.ULS.sendTraceTag(537150298,0,50,"VersionHistoryPaneActor:SelectVersion called. for Version:{0}, LastSelected:{1}",wd.tE(xc),this.zzb);if(xc)if(wd.tE(xc).length){var bd=(new Date).getTime();if(wd.tE(xc)===this.zzb&&1E3>bd-this.xqd)dc.ULS.sendTraceTag(537150295,0,50,"VersionHistoryPaneActor:SelectVersion reattempt within 1 sec");else{wd.tE(xc)!==this.zzb&&(dc.ULS.sendTraceTag(537150294,0,50,"VersionHistoryPaneActor:Reset Iterator states if user clicks on different version"),
this.nm.setTotalChangesCount(-1),this.nm.setCurrentChangeCount(-1));var Bd=excelVersionHistory.FactoryGlobal.getTelemetryCollector();Bd.addEvent("SelectVersion",wd.tE(xc));try{this.WPj(Bd);this.xqd=bd;this.zzb=wd.tE(xc);var Ld=new fb;Ld.selectedVersionInfo=this.c3;Ld.baseVersionInfo=this.baseVersionInfo;Ld.telemetryCollector=Bd;this.boa.onVersionSelectedWithParams(Ld);this.nm&&Ce.EwaSettings.la(364)&&this.nm.setDisableSaveACopy(this.MYf());var Od=document.getElementById(wd.Irh);Od&&!this.jB&&(dc.ULS.sendTraceTag(537150293,
0,50,"VersionHistoryPaneActor: SelectVersion Lazy instantiate VersionHistoryMessenger"),this.jB=new ed.a(Od.contentWindow,za.a.maa(this.$.ya.VersionHistoryActionUrl)||Lc.a.s9),this.jB.Km(Je.a.gTa,this.nFb),this.jB.Km(Je.a.hTa,this.nFb),this.jB.Qn(ed.a.setCurrentChangeCount),this.jB.Qn(ed.a.setTotalChangesCount),Ce.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&this.jB.Qn(ed.a.gOa),this.jB.Km(ed.a.setCurrentChangeCount,this.nFb),this.jB.Km(ed.a.setTotalChangesCount,
this.nFb),Ce.EwaSettings.isChangeGateEnabled("OfficeVSO:4844740_ExcelVersionHistoryHighlightChangesFix")&&this.jB.Km(ed.a.gOa,this.nFb))}catch(ef){this.xqd=0,this.zzb="",Bd.addEvent("Exception",ef.toString()),dc.ULS.sendTraceTag(42016832,0,10,"VersionHistoryPaneActor: OnVersionSelected failed due to exception. {0}",ef)}finally{dc.ULS.sendTraceTag(537150292,0,50,Bd?Bd.getJsonForLogging():"")}}}else dc.ULS.sendTraceTag(537150296,0,50,"VersionHistoryPaneActor:SelectVersion selectedVersion RevisionId is null");
else dc.ULS.sendTraceTag(537150297,0,50,"VersionHistoryPaneActor:SelectVersion selectedVersion is null")};wd.prototype.WPj=function(xc){for(var bd=yl(this.perfTelemetryInfos),Bd=bd.next();!Bd.done;Bd=bd.next()){var Ld=Bd.value;Bd=Ld.TelemetryEventKey?Ld.TelemetryEventKey:Ld.telemetryEventKey?Ld.telemetryEventKey:"";Ld=Ld.TelemetryEventData?Ld.TelemetryEventData:Ld.telemetryEventData?Ld.telemetryEventData:"";Bd&&Ld&&xc.addEvent(Bd,Ld)}Array.clear(this.perfTelemetryInfos)};wd.prototype.mue=function(xc){dc.ULS.sendTraceTag(42553886,
0,15,"VersionHistoryPaneActor:CaptureSessionTelemetry - {0} ",xc?xc.getJsonForLogging():"")};wd.prototype.nmi=function(){for(var xc=this.$.fa.Em,bd={},Bd=null,Ld=yl(xc),Od=Ld.next();!Od.done;Od=Ld.next())Od=Od.value,Od.UserEmail&&(bd[Od.UserEmail]=Od.UserEmail in bd?bd[Od.UserEmail]+1:1),Od.User.UserID===this.$.fa.clientId&&(Bd=Od.UserEmail);dc.ULS.sendTraceTag(42522438,0,10,"VersionHistoryPaneActor:LogCoauthorsTelemetry Restore failed, TotalAuthors: {0}, TotalAuthorsAsYourself {1}",xc.length,Bd?
bd[Bd]:-1)};wd.prototype.dLd=function(xc,bd){dc.ULS.sendTraceTag(537150285,0,50,"VersionHistoryPaneActor.SendPostMessageToTheVHSession called with MessageID:{0}",xc);if(this.jB){xc=new Vd.a(xc);xc.Values[de.a.l3c]=this.$.ya.UserSessionId;if(bd)for(var Bd in bd)xc.Values[Bd]=bd[Bd];this.jB.send(xc)}else dc.ULS.sendTraceTag(537150284,0,10,"VersionHistoryPaneActor.SendPostMessageToTheVHSession versionHistoryMessenger is null")};wd.tE=function(xc){return xc?xc.RevisionID?xc.RevisionID:xc.revisionID?xc.revisionID:
"":""};wd.HHh=function(xc){return xc?xc.DownloadUrl?xc.DownloadUrl:xc.downloadUrl?xc.downloadUrl:"":""};wd.Jrh="_excelVersionHistoryOverlay";wd.Irh="vhs_frame";wd.v5f="TimeTakenShowVersionHistoryDialogAction";wd.y5f="TimeTillVersionHistoryDialogWasOpenMs";wd.RSd="TimeTakenGetVersionsToOnVersionsReady";wd.f_g="CountOnVersionSelectedCalledinOneVHSession";wd.g_g="CountOnVersionsReadyCalledinOneVHSession";wd.e_g="CountOnDownloadTokenReadyCalledinOneVHSession";wd.w5f="TimeTakenVersionRestore";Object(kb.a)(wd,
"VersionHistoryPaneActor",null,[3]);var zd=b(335),jd=pb.a;vm(Pc,jd);Pc.prototype.Md=function(){var xc=this,bd=this.Bli(),Bd=cc.GetServiceTaskFactory.Xa(this.$.da,21,137,this.tb);Ac.TaskExtensions.Ba(Ac.TaskExtensions.ve([bd,Bd],this.ma,3),function(){var Ld=Bd.result,Od=za.a.maa(xc.$.ya.VersionHistoryActionUrl);Od!==Lc.a.s9&&Ld.TEa(Od);Ld=new wd(xc.$);xc.Ed([new Mb(xc.$,Ld)])},this.ma,3)};Pc.prototype.Bli=function(){var xc=cc.GetServiceTaskFactory.iac(this.$.da,283,284,this.tb).then(function(bd){return bd.wo.loadScript("excelVersionHistory")},
function(bd){dc.ULS.sendTraceTag(537150412,0,10,"versionHistoryManagerFactory: Dynamic Script Loading failed due to exception. {0}",bd);return Promise.reject(bd)});return zd.c(xc)};Pc.ja=function(xc){pb.a.de(304,new Pc(xc))};Object(kb.a)(Pc,"VersionHistoryCommandHandlerFactory",pb.a,[]);var ge=b(1257),Yd=Xb.a;vm(Xc,Yd);Xc.prototype.create=function(){var xc=this,bd=cc.GetServiceTaskFactory.Xa(this.$.da,211,212,this.tb),Bd=cc.GetServiceTaskFactory.Xa(this.$.da,21,137,this.tb);Ac.TaskExtensions.Ba(Ac.TaskExtensions.ve([bd,
Bd],this.$.ma),function(){xc.Fb(xc.$.da.Aa(305)||new ge.a(xc.$,!0,Bd.result,bd.result))},this.$.ma,3)};Xc.ja=function(xc){xc.da.Ha(306,new Xc(xc))};Object(kb.a)(Xc,"VersionHistoryHighlightManagerFactory",Xb.a,[]);var rd=b(514),je=b(4),re=b(164),ae=b(14),Uf=Za.a;vm(Hc,Uf);Hc.prototype.execute=function(xc){this.lineageManager.lineageHidePreviousHistory();return Uf.prototype.execute.call(this,xc)};Object(kb.a)(Hc,"LineageClearHistoryConfirmedActivity",Za.a,[]);var Lf=b(15),Of=b(130);Eb.prototype.Xc=
function(){return!1};Eb.prototype.executeCommand=function(xc,bd,Bd){xc=!1;switch(bd.command){case 1834994092:9===bd.df&&this.Gzj();this.Erj(bd,Bd);xc=!0;break;case -409942531:this.Hrj(),xc=!0}return xc?Xd.Task.Ta(!0):ad.a(bd.command)};Eb.prototype.Gc=function(xc,bd){return 1834994092===bd.command||-409942531===bd.command};Eb.prototype.fd=function(){return!1};Eb.prototype.Erj=function(xc,bd){dc.ULS.sendTraceTag(537155483,0,50,"LineageActivityCommandHandler::ShowChangesCore command location: {0}",bd.MenuItemId||
xc.df);this.lineageManager.I_f(19===xc.df&&!!bd.MenuItemId,bd.MenuItemId,xc.df)};Eb.prototype.Gzj=function(){var xc=je.a.npc;xc!==re.a(this.$).Lm.qo&&re.a(this.$).Lm.activateRibbonTab(xc)};Eb.prototype.Hrj=function(){var xc=this;Jf.a(this.$).Rs(new oc.a(Zb.a.grd,5,function(){var bd=Nb.a(xc.$).nd,Bd=Pd.a.jd(3,1,2165,2166,2167,1038647878,"LineageConfirmClearHistory");Bd.HelpTopicId="a1493bf9-25c3-470a-b970-60eceb0136e5";Bd.HelpDescription=ae.a.instance.ea(1273);bd.ft([Bd])}))};Object(kb.a)(Eb,"LineageActivityCommandHandler",
null,[237]);var Yf=pb.a;vm(Kb,Yf);Kb.prototype.Md=function(){var xc=this;Ac.TaskExtensions.Ba(cc.GetServiceTaskFactory.Xa(this.$.da,366,367,this.tb),function(bd){xc.Ed([new Eb(xc.$,bd.result)])},this.ma,3)};Kb.ja=function(xc){pb.a.de(363,new Kb(xc))};Object(kb.a)(Kb,"LineageActivityCommandHandlerFactory",pb.a,[]);xb.prototype.p5a=function(){return!this.ncb};xb.b$e=function(){return xb.W9e()&&Ce.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationTeachingUXTreatmentToControl",
!1)};xb.W9e=function(){return Ce.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LineageCatchUpIntegrationSummaryStringTreatment",!1)};Object(kb.a)(xb,"LineageCatchUpExperimentManager",null,[390]);var vg=Xb.a;vm(Ja,vg);Ja.prototype.create=function(){var xc=this;xb.b$e()?Ac.TaskExtensions.Ba(cc.GetServiceTaskFactory.Xa(this.$.da,456,457,this.tb),function(bd){Ac.TaskExtensions.Ba(bd.result.jqj(),function(Bd){xc.TAe(Bd.result)},xc.$.ma,3)},this.$.ma,3):this.TAe(!0)};Ja.prototype.TAe=function(xc){this.Fb(this.$.da.Aa(458)||
this.$.da.Ha(458,new xb(xc)))};Ja.ja=function(xc){xc.da.Ha(459,new Ja(xc))};Object(kb.a)(Ja,"LineageCatchUpExperimentManagerFactory",Xb.a,[]);var Af=b(409),rf=b(41),Cg=b(86),sc=b(143),Rc=b(116);Object(kb.a)(Lb,"LineageClientParams",null,[]);Object(kb.a)(Ra,"LineageFilter",null,[]);var Qc=b(59),ee=b(78),ue=b(125),Ee=b(43),De=b(519),ne=b(163),gc=b(126),fd=b(106),vd=b(302),se=b(273),Jc=b(105),Bc=b(20),Ae=b(127),cb=b(81),mc=b(48),Oc=b(338);Object(kb.a)(Yb,"LineageActivitiesResponseDTO",null,[]);vm(lb,
Yb);Object(kb.a)(lb,"LineageActivitiesUpdateResponseDTO",Yb,[]);Object(kb.a)(sa,"LineageAppCallbacks",null,[]);Object(kb.a)(xa,"LineageAuthorDTO",null,[]);Object(kb.a)(ta,"LineageControllerFactoryParams",null,[]);Object(kb.a)(Fb,"LineageSharedRangeDTO",null,[]);Object(kb.a)(Qb,"LineageSheetMultiRangeDTO",null,[]);Object(kb.a)(Gb,"LineageUserActivityDTO",null,[]);Object(kb.a)(hb,"LineageValueChangeDTO",null,[]);ya.prototype.dispose=function(){this.I2i();this.$=null;this.lineageTaskPane&&(this.lineageTaskPane.xN(this.onPaneClosed),
this.lineageTaskPane.UC(this.kz),this.lineageTaskPane=null);this.BJb=this.Roc=this.rsb=this.frd=this.QE=null};ya.prototype.I_f=function(xc,bd,Bd){if(this.lineageTaskPane.isVisible){if(9===Bd){dc.ULS.sendTraceTag(560989858,0,50,"LineageManager::ShowLineageTaskPane open from callout was invoked with an opened pane");return}if(!xc&&16!==Bd&&18!==Bd){this.lineageTaskPane.l_c();return}}rf.a.Gd(this.$)||(this.BJb.start(),this.S6&&(mc.b().CB(this.BJb.id,this.S6.id,"actions","actions"),this.S6.stop(),this.S6=
null));this.lineageTaskPane.hfc||dc.ULS.sendTraceTag(537155482,0,50,"LineageManager::ShowLineageTaskPane pane reopened by user via {0}",xc?bd:Bd);this.zD=this.$.fa.rf;this.rsb=null;xc&&(xc=Ee.r(this.gridView.ha.va.selectedRanges,this.$),this.rsb=Object.assign(new Qb,{rangeList:bd.toString()===je.a.c_f?this.Dub(xc.Ranges):null,sheetName:xc.SheetName}));rf.a.Gd(this.$)&&this.lineageTaskPane.hfc?this.lineageTaskPane.Ajj(this.uCb):this.QE.createLineagePane(this.frd,this.rsb);this.lineageTaskPane.Lf(!0);
this.$.Ce(-71295319,-1,0,null)};ya.prototype.lineageHidePreviousHistory=function(){function xc(Ld,Od,ef){var ag=bd.$.qa.ta,lg=ag.Oa(1,null);return cb.i(ag,"LineageHidePreviousHistory",lg,Ld,Od,ef,null,0)}var bd=this,Bd={};Bd=(Bd.paneVisible=this.lineageTaskPane.isVisible,Bd);sc.a.sendTelemetryEvent(Object.assign(new Oc.a,{name:"Office.Excel.Online.Lineage.ClearHistoryConfirmed",dataFields:Rc.a.Fk(Bd)}));Ce.EwaSettings.tc()?this.$.userOperationManager.ic(new ne.a(1018,0,xc,64),null):this.$.userOperationManager.ic(new De.a(1018,
0,xc,0),null);this.lineageTaskPane.isVisible||this.I_f(!1,null,4)};ya.prototype.S4h=function(){var xc=this,bd=Object.assign(new sa,{tryParseRangeInfo:this.tryParseRangeInfo,isFeatureEnabled:this.isFeatureEnabled,onCardSelected:this.onCardSelected,onVersionHistoryButtonClicked:this.onVersionHistoryButtonClicked,onRangeFilterInputEnabled:this.onRangeFilterInputEnabled,onLearnMoreLinkClicked:this.onLearnMoreLinkClicked,lineageOpenPaneOrChangeFilterRequest:this.lineageOpenPaneOrChangeFilterRequest,lineageLoadMoreRequest:this.lineageLoadMoreRequest,
lineageRefreshViewRequest:this.lineageRefreshViewRequest,lineageUpdateViewRequest:this.lineageUpdateViewRequest});mb.a(function(){xc.QE=cellLineage.LineageActivityControllerFactoryGlobal.createLineageActivityController(Object.assign(new ta,{clientBatchSize:xc.batchSize,filterableSheetList:xc.f3a(),uiCulture:xc.$.ya.UICultureTag,dataCulture:xc.$.ya.DataCultureTag,logger:new bc.a,lineageAppCallbacks:bd}))})};ya.prototype.rdd=function(xc){var bd=this;return function(Bd){if(Bd=vd.a(Bd)?null:Bd.Result){var Ld=
{};Ld=(Ld.CountOfActivities=Bd.ActivityList.length,Ld);Ld.WebRequestName=xc;Ae.b(bd.$).ae(ue.a.YDi,Ld);Bd=Object.assign(new Yb,{activityList:bd.WCd(Bd.ActivityList),latestActivityId:Bd.LastSearchedActivityId,oldestActivityId:Bd.FirstSearchedActivityId,serverMessageCode:Bd.LineageResponseCode,lastSearchedActivityTimestamp:new Date(Bd.EcmaLastSearchedDate),serverFirstActivityId:Bd.ServerFirstActivityId,serverLastActivityId:Bd.ServerLastActivityId,showLoadPrevious:Bd.ShowLoadPrevious,eolCorrelationId:Bd.EolCorrelationId,
eolDateHideHistory:new Date(Bd.EolDateHideHistory),eolPersonHideHistory:bd.xub(Bd.EolPersonHideHistory)});bd.QE.onLineageActivitiesResponse(Bd)}else dc.ULS.shipAssertTag(537155477,0,!!Bd,"LineageManager."+xc+" returned null response.")}};ya.prototype.ZDj=function(xc){return fd.e(xc.Ranges)&&!xc.SheetName?null:Object.assign(new Qb,{rangeList:this.Dub(xc.Ranges),sheetName:xc.SheetName})};ya.prototype.Dub=function(xc){var bd=[];xc=yl(xc);for(var Bd=xc.next();!Bd.done;Bd=xc.next())Bd=Bd.value,Bd=Object.assign(new Fb,
{firstCol:Bd.FirstColumn,firstRow:Bd.FirstRow,lastRow:Bd.LastRow,lastCol:Bd.LastColumn}),bd.push(Bd);return bd};ya.prototype.iEj=function(xc){if(!xc)return null;var bd={};bd.Ranges=this.ped(xc.rangeList);bd.SheetName=xc.sheetName;return bd};ya.prototype.ped=function(xc){var bd=[];if(fd.e(xc))return bd;xc=yl(xc);for(var Bd=xc.next();!Bd.done;Bd=xc.next()){Bd=Bd.value;var Ld={};Ld.FirstColumn=Bd.firstCol;Ld.FirstRow=Bd.firstRow;Ld.LastRow=Bd.lastRow;Ld.LastColumn=Bd.lastCol;bd.push(Ld)}return bd};ya.prototype.u0h=
function(xc){(xc=this.$.xa.getItemByName(xc))&&xc.visible&&xc.activate(!0)};ya.prototype.L5e=function(xc,bd){var Bd=[];bd=yl(bd);for(var Ld=bd.next();!Ld.done;Ld=bd.next()){Ld=Ld.value;var Od={};Od.FirstColumn=Ld.firstCol;Od.FirstRow=Ld.firstRow;Od.LastRow=Ld.lastRow;Od.LastColumn=Ld.lastCol;Bd.push(Ee.D(Od))}bd=Bd.length-1;Ld=Bd[bd].topLeft;Bc.g(this.$).PU(Bd,bd,xc,null,Ld,null,null,3,Jc.a.Gki,void 0,void 0,void 0,!0)};ya.prototype.S_i=function(){this.QE&&this.lineageTaskPane.isVisible&&(this.zD=
this.$.fa.rf,this.QE.onRefreshRequired())};ya.prototype.wwg=function(){this.lineageTaskPane.CL(this.onPaneClosed);this.lineageTaskPane.EB(this.kz);this.$.fa.jt(this.Kf);this.$.fa.Sj(this.Zc);this.$.fa.aP(this.vq);var xc=this.$.xa;xc.ZX(this.AC);xc.pga(this.Emc);xc.bFa(this.aya);xc.EXa(this.Emc)};ya.prototype.I2i=function(){this.$.fa.mw(this.Kf);this.gridView.ha.Nca(this.kd);this.$.fa.kk(this.Zc);this.$.fa.mW(this.vq);var xc=this.$.xa;xc.x6(this.AC);xc.dma(this.Emc);xc.APa(this.aya);xc.hGb(this.Emc)};
ya.prototype.onStaleActivitiesDetected=function(){this.QE.onStaleActivitiesDetected()};ya.prototype.f3a=function(){for(var xc=[],bd=yl(this.$.xa.items),Bd=bd.next();!Bd.done;Bd=bd.next())Bd=Bd.value,Bd.visible&&!Qc.e(Bd)&&xc.push(Bd.sheetName);return xc};ya.prototype.$tj=function(){if(Ce.EwaSettings.la(641)){var xc=this.$.da.Aa(403);xc&&xc.disable();xc=new Ad.a(-847286761,ee.a.Wb,this.$.ed,0,je.a.dW);var bd={};bd=(bd.InputMethod=ee.a.Wb,bd);bd.CalloutName=5;this.$.Ka.Zb(xc,bd)}};ya.prototype.WCd=
function(xc){var bd=[];xc=yl(xc);for(var Bd=xc.next();!Bd.done;Bd=xc.next())Bd=Bd.value,Bd=Object.assign(new Gb,{activityId:Number.parseLocale(Bd.UserActivity.Id),activityGuid:Bd.Uid,activityType:Bd.UserActivity.Type,author:this.xub(Bd.UserActivity.Person),sheetName:Bd.SheetName,displayTimestamp:new Date(Bd.UserActivity.DisplayTimestamp),gridLocation:Bd.DisplayLocation,valueChanges:this.jVi(Bd.LineageValueChangeList),isBulkEditOverflow:Bd.IsBulkEditOverFlow,rangeHighlightLocation:this.YUi(Bd.UserActivity.LocationList,
Bd.UserActivity.Type),nestedActivityList:this.RUi(Bd.NestedActivityList),degradedCardTypeBits:Bd.DegradedCardTypeBits}),bd.push(Bd);return bd};ya.prototype.YUi=function(xc,bd){if(!xc)return dc.ULS.sendTraceTag(537155468,0,15,"LineageManager:: RangeHighlightLocation.ActivityLocationList is null"),null;if(!xc.length)return dc.ULS.sendTraceTag(537155467,0,50,"LineageManager:: RangeHighlightLocation.ActivityLocationList is empty"),null;var Bd=[],Ld=[],Od="";21===bd?Ld.push(xc[0]):Ld=xc;xc=yl(Ld);for(Ld=
xc.next();!Ld.done;Ld=xc.next())switch(Ld=Ld.value,Ld.Type){case 1:break;case 2:Od=Ld.SheetName;break;case 0:if(!Ld.RangeList){dc.ULS.sendTraceTag(537155465,0,50,"LineageManager:: RangeHighlightLocation.RangeActivityLocation is null");break}Od=Ld.RangeList[0].SheetName;var ef=[];21===bd?ef.push(Ld.RangeList[0]):ef=Ld.RangeList;Ld=yl(ef);for(ef=Ld.next();!ef.done;ef=Ld.next())ef=ef.value,ef=Object.assign(new Fb,{firstCol:ef.FirstColumn,firstRow:ef.FirstRow,lastRow:ef.LastRow,lastCol:ef.LastColumn}),
Bd.push(ef);break;default:dc.ULS.sendTraceTag(537155464,0,50,"LineageManager:: RangeHighlightLocation.ActivityLocationList is of type: ",Ld.Type)}return Object.assign(new Qb,{sheetName:Od,rangeList:Bd})};ya.prototype.jVi=function(xc){var bd=[];xc=yl(xc);for(var Bd=xc.next();!Bd.done;Bd=xc.next())Bd=Bd.value,Bd=Object.assign(new hb,{hasNewValue:Bd.HasNewValue,hasOldValue:Bd.HasOldValue,newValue:Bd.HasNewValue?Bd.NewValue:null,oldValue:Bd.HasOldValue?Bd.OldValue:null,cellLocation:Bd.CellLocation}),
bd.push(Bd);return bd};ya.prototype.RUi=function(xc){return xc?this.WCd(xc):null};ya.prototype.xub=function(xc){if(!xc)return null;var bd=null;Ce.EwaSettings.isChangeGateEnabled("OfficeVSO:4947893_ShowChangesUserProfilePictureSupportEnabled")&&$a.AFrameworkApplication.ga.ra("IsUserProfilePictureResolutionEnabled")&&(bd=this.Roc.dHa(xc.Email,xc.Provider,$a.AFrameworkApplication.hj,0));return Object.assign(new xa,{id:xc.Id,provider:xc.Provider,displayName:xc.DisplayName,email:xc.Email,imageUrl:bd})};
Object(kb.a)(ya,"LineageManager",null,[388,3]);var Sc=Xb.a;vm(da,Sc);da.prototype.lli=function(xc){var bd=this;Ac.TaskExtensions.Ba(xc,function(){bd.Fb(bd.$.da.Aa(366)||new ya(bd.$,bd.$.da,bd.lineageTaskPane,bd.S6))},this.$.ma,3)};da.prototype.create=function(){var xc=this;this.S6=this.$.Ub.Fc("UserAction","LineagePaneSeenStopwatch");this.S6.start();var bd=cc.GetServiceTaskFactory.Xa(this.$.da,365,364,this.tb),Bd=Af.a(this.$),Ld=cc.GetServiceTaskFactory.Xa(this.$.da,283,284,this.tb);Ac.TaskExtensions.Ba(Ac.TaskExtensions.ve([bd,
Bd,Ld],this.$.ma),function(){xc.lineageTaskPane=bd.result;rf.a.Gd(xc.$)||Bd.result.rQ(xc.lineageTaskPane);xc.lli(zd.c(Ld.result.wo.loadScript("cellLineage")))},this.$.ma,3)};da.ja=function(xc){xc.da.Ha(367,new da(xc))};Object(kb.a)(da,"LineageManagerFactory",Xb.a,[]);var $c=b(922),le=b(276),we=b(12),jc=b(117),Zc=b(275),ud=b(91),Fd=b(232),me=b(16),$e=b(826),Df=b(63),gg=Fd.a;vm(Tb,gg);Tb.prototype.hG=function(xc){this.get_events().addHandler("LineageTaskPaneRemove",xc)};Tb.prototype.MH=function(xc){this.get_events().removeHandler("LineageTaskPaneRemove",
xc)};Tb.prototype.EB=function(xc){this.addHandler("LineageTaskPaneVisibilityChanged",xc)};Tb.prototype.UC=function(xc){this.removeHandler("LineageTaskPaneVisibilityChanged",xc)};Tb.prototype.CL=function(xc){this.get_events().addHandler("LineageTaskPaneClose",xc)};Tb.prototype.xN=function(xc){this.get_events().removeHandler("LineageTaskPaneClose",xc)};Tb.prototype.Xv=function(){};Tb.prototype.$B=function(){};Tb.prototype.fn=function(){return this.ep};Tb.prototype.Jp=function(){return this.ep};Tb.prototype.bF=
function(){};Tb.prototype.VG=function(){return!1};Tb.prototype.ji=function(){};Tb.prototype.Vh=function(){};Tb.prototype.dispose=function(){this.$&&(this.$.Fn(this.qd),wc.a(this.$).XA(this));this.ke&&(le.a.instance.za(we.a.click,this.ke,this.Zj),jc.KeyInputManager.instance.jv(this.ke,this.Vwe));this.ke=this.taskPaneManager=this.$=null;gg.prototype.dispose.call(this)};Tb.prototype.Qe=function(xc,bd){if(!bd){xc=id.DOMElementExtensions.getElementById(this.domElement,"LineagePaneFilterButton");if(!xc)return!1;
id.DOMElementExtensions.setFocus(xc)}return!bd};Tb.prototype.zh=function(xc){return id.DOMElementExtensions.Ye(this.Jb,xc)};Tb.prototype.Lf=function(xc){this.ep=xc;var bd=this.taskPaneManager;if(this.isVisible=xc)this.$.frame.Re.Pj("LineagePane"),this.nnd=!1;if(rf.a.Gd(this.$))xc?bd.fR("LineageTaskPane",this.hI):bd.hideTaskPane("LineageTaskPane");else{this.taskPaneManager.ap();var Bd=!!this.taskPaneManager.xg&&15===this.taskPaneManager.xg.taskPane.tg;xc&&0<bd.zz.length&&(!Bd||bd.isCollapsed)&&bd.WC(this,
!0)}this.$.Gf()};Tb.prototype.ZL=function(){var xc=this.$.Ib;xc=rf.a.Gd(this.$)?this.domElement:document.getElementById(xc+je.a.jrd);var bd=this.sG();xc.appendChild(bd);bd=$e.b("div","LineagePaneBodyId","LineageActivityBody");xc.appendChild(bd);this.Bjj();return bd};Tb.prototype.l_c=function(){this.$.frame.Re.Pj(this.$.frame.Re.cE||Zc.AFrame.oT);this.nnd=!0;this.Lf(!1);this.raiseEvent("LineageTaskPaneClose")};Tb.prototype.Ajj=function(xc){this.uCb=xc};Tb.prototype.Bjj=function(){this.$.frame.Re.dk("LineagePane");
var xc=this.$.frame.Re.ii("LineagePane");xc.parent=Zc.AFrame.oT;xc.JQ=!0};Tb.prototype.sG=function(){var xc=$e.b("div","LineagePaneHeaderId","LineageActivityPaneHeader"),bd=$e.b("h1","LineagePaneTitleId","cui-taskpane cui-taskPaneTitle LineageActivityPaneTitle");bd.innerText=this.titleText;this.ke=$c.a.yb("LineagePaneCloseButtonId","StandardButton LineageActivityCloseButton",ae.a.instance.ea(10),"ClosePaneGlyph_16x16x32",!1);this.ke.classList.add($a.AFrameworkApplication.isRtl?je.a.X$:je.a.Y$);le.a.instance.pa(we.a.click,
this.ke,this.Zj);this.Vwe=jc.KeyInputManager.instance.Ur(this.ke,this.Zj,ud.a.$h);xc.appendChild(bd);xc.appendChild(this.ke);return xc};Tb.ja=function(xc,bd){var Bd=xc.Ib,Ld=document.getElementById(Bd+je.a.jrd);Ld||(Ld=document.createElement("div"),Ld.id=xc.Ib+je.a.jrd,Ld.classList.add("LineageActivityPane"),rf.a.Gd(xc)||document.getElementById(Bd+je.a.YQ).appendChild(Ld));return xc.da.Aa(365)||xc.da.Ha(365,new Tb(Ld,xc,bd))};tl.Object.defineProperties(Tb.prototype,{isVisible:{configurable:!0,enumerable:!0,
get:function(){return Object(Df.a)(Tb.prototype,this,"isVisible")},set:function(xc){Object(Df.a)(Tb.prototype,this,"isVisible")!==xc&&(Object(Df.b)(Tb.prototype,this,"isVisible",xc),this.raiseEvent("LineageTaskPaneVisibilityChanged"))}},hfc:{configurable:!0,enumerable:!0,get:function(){return this.nnd}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},tg:{configurable:!0,enumerable:!0,get:function(){return 15}},Zd:{configurable:!0,enumerable:!0,get:function(){return gb.a.Hki}},
Vj:{configurable:!0,enumerable:!0,get:function(){return me.a.$oh}},oC:{configurable:!0,enumerable:!0,get:function(){return ae.a.instance.ea(1027)}},El:{configurable:!0,enumerable:!0,get:function(){return 300}},isResizable:{configurable:!0,enumerable:!0,get:function(){return!1}},Jb:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},height:{configurable:!0,enumerable:!0,get:function(){return this.taskPaneManager.YK.offsetHeight}},titleText:{configurable:!0,enumerable:!0,get:function(){return ae.a.instance.ea(1248)}},
hI:{configurable:!0,enumerable:!0,get:function(){var xc=this;return this.taskPaneManager.lua(this.Jb,this.titleText,this.El,this.isResizable,function(){xc.isVisible=!0;xc.uCb?xc.uCb():dc.ULS.shipAssertTag(537155462,0,!1,"OnLineagePaneOpened callback not set.")},function(){xc.isVisible=!1},function(){xc.isVisible=!0},function(){xc.isVisible=!1},this.El)}}});Object(kb.a)(Tb,"LineageTaskPane",Fd.a,[340,3,257,100]);var og=Xb.a;vm(Sb,og);Sb.prototype.create=function(){var xc=this,bd=cc.GetServiceTaskFactory.create(this.$.da,
203,this.ma,this.tb),Bd=cc.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.tb);Ac.TaskExtensions.Ba(Ac.TaskExtensions.ts(Ac.TaskExtensions.ve([bd,Bd],this.ma),function(){return xc.GC},this.ma),function(){xc.Fb(xc.$g)},this.ma,3)};Sb.prototype.dispose=function(){this.$g=this.ti=this.$=null;og.prototype.dispose.call(this)};Sb.ja=function(xc){xc.da.Ha(364,new Sb(xc))};tl.Object.defineProperties(Sb.prototype,{GC:{configurable:!0,enumerable:!0,get:function(){var xc=this;this.ti||(this.ti=Ac.TaskExtensions.Ba(Af.a(this.$),
function(bd){xc.$g=Tb.ja(xc.$,bd.result)},this.ma,3));return this.ti}}});Object(kb.a)(Sb,"LineageTaskPaneFactory",Xb.a,[]);Xa.prototype.dispose=function(){this.fGd();this.$=null;dc.ULS.sendTraceTag(537155459,0,50,"LineageTeachingCalloutTriggerManager is disposed.")};Xa.prototype.disable=function(){Xa.Avb||(Xa.Avb=!0,dc.ULS.sendTraceTag(578557781,0,50,"LineageTeachingCalloutTriggerManager.Disable as the pane was opened."));this.fGd()};Xa.prototype.SNj=function(){var xc=this;Ce.EwaSettings.la(637)&&
!this.$.isAnonymousUser()&&cb.l(this.$.qa.ta,function(bd){xc.$?(bd=bd.Result,dc.ULS.sendTraceTag(578557780,0,50,"CheckLineageWywaChanges service call succeeded, hasnewchanges = {0}.",bd),Xa.Z3e=!0,bd&&xc.H6f(0)):dc.ULS.sendTraceTag(537155458,0,50,"LineageTeachingCalloutTriggerManager.VerifyWaterlineTrigger ignoring server response as class is disposed.")},function(){dc.ULS.sendTraceTag(537155457,0,10,"CheckLineageWywaChanges service call failed.")},null,null)};Xa.prototype.MNj=function(){Ce.EwaSettings.la(636)&&
!this.R6f()&&(this.$.fa.jt(this.Kf),this.Qnd=!0)};Xa.prototype.R6f=function(){return this.$.fa&&this.$.fa.zn&&this.$.fa.zn.ShouldTriggerLineageCalloutOnMerge?(dc.ULS.sendTraceTag(578557778,0,50,"LineageTeachingCalloutTriggerManager.TriggerLineageCalloutOnMerge"),this.H6f(1),!0):!1};Xa.prototype.H6f=function(xc){if(Xa.Avb)dc.ULS.sendTraceTag(537155456,0,50,"LineageTeachingCalloutTriggerManager.TriggerCallout Will not trigger dialog as it was already shown in session");else if(Xa.Avb=!0,dc.ULS.sendTraceTag(578557776,
0,50,"LineageTeachingCalloutTriggerManager.TriggerCallout triggering callout due to reason {0}.",xc),this.fGd(),Ce.EwaSettings.la(501)){xc=new Ad.a(-847286761,ee.a.Wb,this.$.ed,0,je.a.dW);var bd={};bd=(bd.CalloutName=4,bd);this.$.Ka.Zb(xc,bd)}};Xa.prototype.fGd=function(){this.Qnd&&(this.Qnd=!1,this.$.fa.mw(this.Kf))};Xa.Avb=!1;Xa.Z3e=!1;Object(kb.a)(Xa,"LineageTeachingCalloutTriggerManager",null,[339,3]);var dg=Xb.a;vm(Cb,dg);Cb.prototype.create=function(){var xc=this;Ac.TaskExtensions.Ba(cc.GetServiceTaskFactory.Xa(this.$.da,
458,459,this.tb),function(bd){bd=new Xa(xc.$,bd.result);xc.Fb(bd)},this.$.ma,3)};Cb.ja=function(xc){xc.da.Ha(402,new Cb(xc))};Object(kb.a)(Cb,"LineageTeachingCalloutTriggerManagerFactory",Xb.a,[]);var af=b(80),rg=b(171),cg=b(369),Ie=b(595),Ng=b(582),Zf=b(187),ng=b(89),Ff=b(87),be=b(108),Rf=b(29);ob.prototype.show=function(xc,bd,Bd,Ld,Od,ef,ag){var lg=this;this.dib||(this.h_d=void 0===xc?null:xc,this.xMc=void 0===bd?null:bd,this.A4d=void 0===Ld?!1:Ld,this.D4d=void 0===Od?!1:Od,this.O_d=void 0===ef?
null:ef,this.Djb=void 0===Bd?null:Bd,this.X4d=void 0===ag?!1:ag,$a.AFrameworkApplication.sa.Pa.nH?Zf.UISurfaces.pM().then(function($f){var Aa=Object.assign(new Ng.a,{onShow:function(){lg.ZCb()},expirationOptions:Object.assign(new Ie.a,{onExpire:function(){lg.dismiss()},displayTimeoutSeconds:10})}),Ob=$f.externalNotification();lg.KTb=$f.addNotification(Ob,Aa);return null},function($f){dc.ULS.sendTraceTag(593352347,383,15,"Failed to GetNotificationsAPIAsync: {0}",$f);return null}):this.eCa?this.eCa.yhh(this,
Object(af.a)(this,this.ZCb,"onShowApproved")):this.ZCb())};ob.prototype.ZCb=function(){if(!this.dib&&(this.MDa=this.xMc?this.xMc:document.getElementById("WACDocumentPanel"))){this.Ie.yEb();this.ZF=document.createElement("Div");this.ZF.className="CatchUpActivityNotificationContainer CatchUpActivityNotificationContainerBorder";this.ZF.id=Zc.AFrame.Cob;this.MDa.appendChild(this.ZF);this.A4d&&this.Djb&&(this.OLc=document.createElement("Div"),this.OLc.className="CatchUpActivityNotificationBeakBorder CatchUpActivityNotificationBeak",
this.ZF.appendChild(this.OLc),this.NLc=document.createElement("Div"),this.NLc.className="CatchUpActivityNotificationBeak",this.ZF.appendChild(this.NLc));this.w_a(this.h_d,this.D4d,this.O_d,this.X4d);this.ak();if(this.Djb){var xc=Sys.UI.DomElement.getBounds(this.Djb),bd=Sys.UI.DomElement.getBounds(this.MDa);this.ZF.style.top=xc.y-bd.y+this.Djb.clientHeight+12+"px"}else this.ZF.style.bottom="-"+(this.ZF.clientHeight+10)+"px";this.Vma();this.dib=!0;$a.AFrameworkApplication.sa.Pa.nH||(this.n$d=window.setTimeout(Object(af.a)(this,
this.dismiss,"dismiss"),1E4));this.FHi()}};ob.prototype.ak=function(){this.Vg.pa(we.a.click,this.ZF,Object(af.a)(this,this.rsf,"onContainerInput"));this.Vg.pa(we.a.click,this.rPb,Object(af.a)(this,this.Qrf,"onClickClose"));this.C8&&this.Vg.pa(we.a.click,this.C8,Object(af.a)(this,this.Prf,"onClickButton"))};ob.prototype.mm=function(){this.Vg.za(we.a.click,this.ZF,Object(af.a)(this,this.rsf,"onContainerInput"));this.Vg.za(we.a.click,this.rPb,Object(af.a)(this,this.Qrf,"onClickClose"));this.C8&&this.Vg.za(we.a.click,
this.C8,Object(af.a)(this,this.Prf,"onClickButton"))};ob.prototype.w_a=function(xc,bd,Bd,Ld){xc=void 0===xc?null:xc;bd=void 0===bd?!1:bd;Bd=void 0===Bd?null:Bd;Ld=void 0===Ld?!1:Ld;this.rPb=this.s0g();this.ZF.appendChild(this.rPb);this.lfa=document.createElement("Div");this.lfa.className="CatchUpActivityNotificationMessageContainer";this.lfa.setAttribute(ng.a.Cga,ng.a.FFa);this.lfa.setAttribute(ng.a.gpe,ng.a.rj);this.lfa.setAttribute(ng.a.Sd,ng.a.Bga);this.ZF.appendChild(this.lfa);this.lfa.appendChild(this.X2g());
this.lfa.appendChild(this.W2g(xc,Ld));bd&&(this.C8=document.createElement("button"),this.C8.className="CatchUpActvitiyNotificationButton",this.C8.innerText=Bd?Bd:CommonUIStrings.l_CatchUpChangeNotificationButtonLabel,this.lfa.appendChild(this.C8))};ob.prototype.X2g=function(){var xc=document.createElement("Div");xc.className="CatchUpActivityNotificationTitle";xc.innerText=CommonUIStrings.l_CatchUpChangeNotificationMessage;return xc};ob.prototype.W2g=function(xc,bd){xc=void 0===xc?null:xc;bd=void 0===
bd?!1:bd;var Bd=document.createElement("Div");Bd.className="CatchUpActivityNotificationMessage";if(!bd){bd=document.createElement("Div");bd.className="CatchUpActivityNotificationDotContainer";var Ld=document.createElement("Div");Ld.className="CatchUpActivityNotificationDot";bd.appendChild(Ld);Bd.appendChild(bd);bd=document.createElement("span");bd.className="CatchUpActivityNotificationNewText";bd.innerText=CommonUIStrings.l_CatchUpChangeNotificationNew;Bd.appendChild(bd)}bd=document.createElement("span");
bd.className="CatchUpActivityNotificationMessageText";if(!xc||1>xc.length)bd.innerText=CommonUIStrings.l_CatchUpChangeNotificationText;else{switch(xc.length){case 1:Ld=CommonUIStrings.l_CatchUpChangeNotificationTextOneName;break;case 2:Ld=CommonUIStrings.l_CatchUpChangeNotificationTextTwoNames;break;case 3:Ld=CommonUIStrings.l_CatchUpChangeNotificationTextThreeNames;break;case 4:Ld=CommonUIStrings.l_CatchUpChangeNotificationTextFourNames;break;default:Ld=CommonUIStrings.l_CatchUpChangeNotificationTextMoreNames}Ff.a.BVf(bd,
Ld,xc,function(Od){var ef=document.createElement("span");ef.setAttribute("dir","auto");ef.style.fontFamily="'Segoe UI Semibold', 'Segoe UI Web', Arial, Verdana, sans-serif";ef.setAttribute("unselectable","on");ef.innerText=Od;return ef})}bd.setAttribute("dir","auto");Bd.appendChild(bd);return Bd};ob.prototype.s0g=function(){var xc=document.createElement("a");xc.className="CatchUpActivityNotificationCloseAnchor";xc.href="#";var bd=cg.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","CatchUpActivityNotificationCloseIcon",
!0,CommonUIStrings.l_DialogClose);xc.appendChild(bd);return xc};ob.prototype.Qrf=function(){dc.ULS.sendTraceTag(50643481,207,50,"Close button was clicked on Catch-Up Activity Notification callout.");this.La.processAction(Rf.a.eie,2);this.dismiss();return!0};ob.prototype.dismiss=function(){var xc=this;this.dib&&($a.AFrameworkApplication.sa.Pa.nH?this.KTb&&Zf.UISurfaces.pM().then(function(bd){bd.removeNotification(xc.KTb);xc.KTb=null;xc.cC(!0);return null},function(bd){dc.ULS.sendTraceTag(593352346,
383,15,"Failed to GetNotificationsAPIAsync: {0}",bd);return null}):this.cC(!1))};ob.prototype.cC=function(xc){this.MDa&&this.ZF&&this.MDa.contains(this.ZF)&&(this.mm(),this.MDa.removeChild(this.ZF),xc||window.clearTimeout(this.n$d));this.dib=!1;!xc&&this.eCa&&this.eCa.ish(this)};ob.prototype.rsf=function(){return!0};ob.prototype.Prf=function(){dc.ULS.sendTraceTag(50643482,207,50,"Primary Button was clicked on Catch-Up Activity Notification callout.");Wa.c(Rf.a.UQg);this.La.processAction(Rf.a.qvg,
2);this.dismiss();return!0};ob.prototype.Vma=function(){var xc=this,bd=this.hc.ii(Zc.AFrame.Cob);bd.parent=Zc.AFrame.gxa;this.Vg.nXa(Zc.AFrame.Cob,this.ZF);bd.BSc(function(){xc.GQa()});this.TF.mXa(Zc.AFrame.Cob);this.TF.xlb(Zc.AFrame.Cob)};ob.prototype.GQa=function(){this.C8&&(dc.ULS.sendTraceTag(50643483,207,50,"Focus was set to the Button on the Activity Notification Callout."),this.C8.focus())};ob.prototype.FHi=function(){var xc=this;dc.ULS.sendTraceTag(37552158,207,50,"The Catch-Up Activity Notification callout was shown in the UI.");
this.xD?this.xD.continueWith(function(){window.setTimeout(function(){xc.xD.result.logActivity("CatchUpChangesFeedback",null)},2E4)}):dc.ULS.sendTraceTag(50656925,207,15,"CatchUpActivityNotification ISystemInitiatedFeedback was null")};Object(kb.a)(ob,"CatchUpActivityNotification",null,[304]);var Re=b(1023),Ze=b(72);Ma.prototype.zW=function(xc,bd,Bd,Ld){var Od=this;return this.zch(xc,void 0===Ld?null:Ld,function(ef){return Od.Og.rXb(ef,2,Bd,bd,void 0,void 0,void 0,void 0,void 0,"2")})};Ma.prototype.zch=
function(xc,bd,Bd){var Ld=this,Od=!!bd&&""!==bd,ef=xc;Od&&(ef=za.a.fT(xc,"perfTag",bd));var ag=new Date;return Re.a.then(Bd(ef),function(lg){var $f=+new Date-+ag;if(!lg||!lg.vh||!lg.vh.data)return lg;Od&&lg.vh.data.request&&Ld.Ffj(lg.vh.data.request.getResolvedUrl(),bd,$f);return lg})};Ma.prototype.Ffj=function(xc,bd,Bd){xc=this.NI.gQh(xc);if(xc.count&&(xc=Ze.last(xc))){var Ld={Message:"Request durations for activities calls."};Ld.PerfTag=bd;Ld.CustomDuration=Bd;Ld.PerformanceDuration=xc.duration;
dc.ULS.sendTraceTag(592189641,3012,50,JSON.stringify(Ld))}};Object(kb.a)(Ma,"CatchUpNetworkingWrapper",null,[164]);var hg=b(243),Bg=hg.a;vm(Ia,Bg);Ia.prototype.Mia=function(){return 6};Object(kb.a)(Ia,"GetActivityFeedRequest",hg.a,[]);var qh=b(385);pa.prototype.jCh=function(xc){var bd=this;return Re.a.then(this.dUa.execute(new Ia(this.QTa(),null,xc),function(Bd,Ld,Od){return bd.jog.zW(Bd,Ld,Od,"ActivityFeed")}),function(Bd){if(!Bd)return dc.ULS.sendTraceTag(572846937,3012,10,"GetActivityFeedEntries: Response is null"),
null;if(!Bd.vh)return dc.ULS.sendTraceTag(572846938,3012,10,"GetActivityFeedEntries: Response.Args is null"),null;if(!Bd.vh.data)return dc.ULS.sendTraceTag(572846939,3012,10,"GetActivityFeedEntries: Response.Args.Data is null"),null;if(!Bd.vh.data.fe)return dc.ULS.sendTraceTag(572846940,3012,10,"GetActivityFeedEntries: Response.Args.Data.ResponseData is null"),null;Bd=qh.a.DHa(Bd.vh.data.fe);return Bd?Bd:(dc.ULS.sendTraceTag(572846941,3012,10,"GetActivityFeedEntries: Deserialized response is null"),
null)})};Object(kb.a)(pa,"CatchUpRequestHandler",null,[165]);var Zg=b(473);ma.prototype.lmi=function(){this.Vmi()};ma.prototype.Vmi=function(){var xc=this;this.AWa?this.AWa.execute(function(bd){window.setTimeout(function(){xc.P8d.contains("CatchUpChangesFeedback")||(xc.P8d.add("CatchUpChangesFeedback"),bd.logActivity("CatchUpChangesFeedback",null))},2E4)}):dc.ULS.sendTraceTag(571586199,383,15,"FloodgateEventLogger: IFuture<ISystemInitiatedFeedback> was null")};Object(kb.a)(ma,"FloodgateEventLogger",
null,[]);var qf=b(185);tl.Object.defineProperties(wa.prototype,{duration:{configurable:!0,enumerable:!0,get:function(){return this.fpg.duration}}});Object(kb.a)(wa,"PerformanceResourceTimingWrapper",null,[]);Z.prototype.gQh=function(xc){var bd=new qf.a;if(!this.NI)return bd;xc=this.NI.getEntriesByName(xc,"resource");if(!xc)return bd;xc=yl(xc);for(var Bd=xc.next();!Bd.done;Bd=xc.next())bd.add(new wa(Bd.value));return bd};Object(kb.a)(Z,"PerformanceWrapper",null,[]);var mh=b(894),Pa=b(100),qb=b(274),
tc=b(524);na.prototype.di=function(xc){var bd=this;this.rb=xc;this.rb.register(304,"Common.App.CatchUpActivity.ICatchUpActivityNotification").zc().Ic(function(){return new ob(le.a.instance,Pa.FocusManager.instance(),mh.a.instance,$a.AFrameworkApplication.sa,$a.AFrameworkApplication.Eb,bd.rb.resolve("CommonUI.ICalloutManager"),tc.a.Fq(bd.rb.mc("Common.ISystemInitiatedFeedback")))});this.rb.register(Ma,"Common.App.CatchUpActivity.CatchUpNetworkingWrapper").as("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper").zc().Ic(function(){return new Ma($a.AFrameworkApplication.Hd,
new Z(window.performance))});this.rb.register(pa,"Common.App.CatchUpActivity.CatchUpRequestHandler").as("Common.App.CatchUpActivity.ICatchUpRequestHandler").zc().Ic(function(){return new pa(bd.rb.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper"),function(){return $a.AFrameworkApplication.hj},new qh.a)});this.rb.register(ma,"Common.App.CatchUpActivity.FloodgateEventLogger").zc().Ic(function(){return new ma(bd.rb.mc("Common.ISystemInitiatedFeedback"))})};na.prototype.init=function(){this.rb.resolve("Common.App.CatchUpActivity.ICatchUpNetworkingWrapper");
this.rb.resolve("Common.App.CatchUpActivity.ICatchUpRequestHandler")};na.prototype.dispose=function(){};na.main=function(){qb.a.instance.mj(new na)};tl.Object.defineProperties(na.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.CatchUpActivity"}}});Object(kb.a)(na,"CatchUpActivityPackage",null,[4,5]);Y.prototype.Xc=function(xc,bd){return this.catchUpActivityManager?-876699925===bd?!this.catchUpActivityManager.V9e:!1:!0};Y.prototype.executeCommand=function(xc,bd){xc=
!1;switch(bd.command){case -876699925:xc=this.catchUpActivityManager.RLi()}return xc?Xd.Task.Ta(!0):ad.a(bd.command)};Y.prototype.Gc=function(xc,bd){return Ce.EwaSettings.la(452)&&-876699925===bd.command?!0:!1};Y.prototype.fd=function(){return!1};Object(kb.a)(Y,"CatchUpActivityCommandHandler",null,[237]);var dd=pb.a;vm(S,dd);S.prototype.Md=function(){var xc=this;this.$.da.Za(286,function(bd){xc.Ed([new Y(xc.$,bd)])})};S.ja=function(xc){pb.a.de(285,new S(xc))};Object(kb.a)(S,"CatchUpActivityCommandHandlerFactory",
pb.a,[]);var Kd=b(308),yd=b(88),ze=b(84);ca.prototype.doesContentExist=function(xc){if(!xc)return dc.ULS.sendTraceTag(537168066,3012,10,"Null activity: DoesContentExist. Default to false."),!1;switch(xc.type){case 2:case 3:case 4:case 6:case 8:case 9:case 7:case 10:if(!xc.navigationId)return dc.ULS.sendTraceTag(537168065,3012,10,"Null activity.NavigationId: DoesContentExist. Default to false."),!1;var bd={};bd.NavigationId=atob(xc.navigationId);return 32===this.Di.ze(Rf.a.VHa,2,bd);default:return!1}};
Object(kb.a)(ca,"CatchUpActivityContentManager",null,[391]);var te=b(963),lf=b(1252);ba.prototype.dispose=function(){this.Hu.ZLf(this.qCb);this.zaa=null};ba.prototype.ajj=function(xc){this.zaa.push(xc)};ba.prototype.fUg=function(){Array.clear(this.zaa)};ba.prototype.V_f=function(xc){for(var bd=yl(this.zaa),Bd=bd.next();!Bd.done;Bd=bd.next())Bd=Bd.value,Bd.className=te.a.XQg,Bd=document.getElementById(String.format("{0}-{1}",Bd.id,je.a.rue)),id.DOMElementExtensions.setVisible(Bd,xc)};ba.prototype.LJb=
function(xc){for(var bd=yl(this.zaa),Bd=bd.next();!Bd.done;Bd=bd.next())if(Bd=Bd.value)xc?Bd.className=2===this.Hu.model.state?te.a.TXi:te.a.UXi:this.V_f(!1)};tl.Object.defineProperties(ba.prototype,{Hu:{configurable:!0,enumerable:!0,get:function(){return this.ylg}}});Object(kb.a)(ba,"RangeCatchUpActivityView",null,[516,3]);var bf=b(19),xf=lf.a;vm(O,xf);O.prototype.dispose=function(){this.gridView=null;xf.prototype.dispose.call(this)};O.prototype.Ryg=function(xc){var bd=this.ueb[0];bd?bd.ajj(xc):
dc.ULS.shipAssertTag(537168004,0,!1,"RangeCatchUpActivityHighlightController.AddViewElement - RangeCatchUpActivityView is null for activityId"+this.Vla.activityId)};O.prototype.Z9i=function(){var xc=this.ueb[0];xc&&xc.fUg()};O.prototype.gxg=function(xc){this.Vla.addRange(xc)};O.prototype.AFh=function(){if(3!==this.Vla.activityType)return null;dc.ULS.shipAssertTag(537168003,0,1===this.Vla.lKb.length,"RangeCatchUpActivityHighlightController::GetCommentActivityRange Range Information Length should be 1.");
return Ee.D(this.Vla.lKb[0])};O.prototype.LHb=function(xc){if(xc){if(!this.Vla)return;this.avd(this.daj())}xf.prototype.LHb.call(this,xc)};O.prototype.V2c=function(){var xc=this.A2c();Array.add(this.ueb,xc)};O.prototype.A2c=function(){return new ba(this)};O.prototype.avd=function(xc){xc?xc.SheetName?(this.gridView.ha.Qa.wG(null),this.gridView.focus(),this.gridView.U1e(xc,3,!1,Jc.a.SXi)):dc.ULS.shipAssertTag(537168E3,0,!1,"RangeCatchUpActivityHighlightController.NavigateToRange: SheetName in the range is null."):
dc.ULS.shipAssertTag(537168001,0,!1,"RangeCatchUpActivityHighlightController.NavigateToRange: Range is null. Either the location list is empty or sheet is hidden.")};O.prototype.daj=function(){if(fd.e(this.Vla.lKb))return dc.ULS.shipAssertTag(537167971,0,!1,"RangeCatchUpActivityHighlightController.RetrieveRangeInformationForNavigation : SortedRanges is either null or empty."),null;var xc=this.$.xa.oa;dc.ULS.shipAssertTag(537167970,0,!!xc,"RangeCatchUpActivityHighlightController.RetrieveRangeInformationForNavigation : currentSheet is null.");
xc=this.cFj(xc.sheetName,this.Vla.lKb);if(!xc&&(xc=this.AUh(this.Vla.lKb),!xc))return null;var bd={};bd.SheetName=xc.SheetName;bd.FirstColumn=xc.FirstColumn;bd.FirstRow=xc.FirstRow;bd.LastColumn=xc.FirstColumn;bd.LastRow=xc.FirstRow;return bd};O.prototype.AUh=function(xc){if(fd.e(xc))return null;for(var bd=null,Bd=0;Bd<xc.length;Bd++){var Ld=xc[Bd].SheetName;if(!bf.a.equals(Ld,bd,!1)&&(bd=Ld,Ld=this.$.xa.getItemByName(Ld),null===Ld||void 0===Ld?0:Ld.visible))return xc[Bd]}return null};O.prototype.cFj=
function(xc,bd){if(bd){bd=yl(bd);for(var Bd=bd.next();!Bd.done;Bd=bd.next())if(Bd=Bd.value,bf.a.equals(Bd.SheetName,xc,!1))return Bd}return null};Object(kb.a)(O,"RangeCatchUpActivityHighlightController",lf.a,[]);var Og=b(74),mf=Og.a;vm(Q,mf);Q.prototype.dispose=function(){this.xZd=null;mf.prototype.dispose.call(this)};tl.Object.defineProperties(Q.prototype,{type:{configurable:!0,enumerable:!0,get:function(){return this.AB}},activityId:{configurable:!0,enumerable:!0,get:function(){return this.xZd}},
activityType:{configurable:!0,enumerable:!0,get:function(){return this.Xfg}}});Object(kb.a)(Q,"CatchUpActivityHighlightModelBase",Og.a,[]);vm(I,Q);I.prototype.addRange=function(xc){xc=yl(xc);for(var bd=xc.next();!bd.done;bd=xc.next())this.ranges.push(bd.value)};I.prototype.dispose=function(){this.ranges=null;Q.prototype.dispose.call(this)};I.z1b=function(xc,bd){if(!xc.SheetName||!bd.SheetName)return dc.ULS.shipAssertTag(537167969,0,!1,"RangeCatchUpActivityHighlightModel.CompareSharedSheetRange : SheetName is null."),
0;var Bd=xc.SheetName.localeCompare(bd.SheetName);return Bd?Bd:xc.FirstColumn<bd.FirstColumn||xc.FirstColumn===bd.FirstColumn&&xc.FirstRow<bd.FirstRow?-1:xc.FirstColumn===bd.FirstColumn&&xc.FirstRow===bd.FirstRow?0:1};tl.Object.defineProperties(I.prototype,{lKb:{configurable:!0,enumerable:!0,get:function(){this.a6a||(this.ranges.sort(I.z1b),this.a6a=!0);return this.ranges}}});Object(kb.a)(I,"RangeCatchUpActivityHighlightModel",Q,[]);var bg=b(336);R.prototype.dispose=function(){this.die=this.bJb=this.i0c=
null};R.prototype.U6i=function(xc){Bc.g(xc).Nb.Yr([24])};R.prototype.P0g=function(xc,bd,Bd){var Ld={};bd=yl(bd);for(var Od=bd.next();!Od.done;Od=bd.next())if((Od=Od.value)&&!fd.e(Od.LocationList)){for(var ef=[],ag={},lg=[],$f=yl(Od.LocationList),Aa=$f.next();!Aa.done;Aa=$f.next()){Aa=Aa.value;if(!Aa){dc.ULS.shipAssertTag(537168013,0,!1,"CatchUpActivityHighlightManagerHelper.CreateControllersAndHighlights - Location is Null for activityId : "+Od.Id);break}switch(Aa.Type){case 0:var Ob=Aa;"0"in ag?
(Aa=ag["0"],Aa.gxg(Ob.RangeList)):(Aa=new O(xc,new I(xc,Od.Id,Od.Type,0,Ob.RangeList),Bd),ef.push(Aa),ag["0"]=Aa);Ob=yl(Ob.RangeList);for(var Ec=Ob.next();!Ec.done;Ec=Ob.next()){Ec=Ec.value;Ec=new bg.a(Ee.D(Ec),Qc.d(xc.xa.getItemByName(Ec.SheetName)));if(this.Quc(Ec)in this.bJb)this.bJb[this.Quc(Ec)].push(Aa);else{var md=[];md.push(Aa);this.bJb[this.Quc(Ec)]=md}lg.push(Ec);this.i0c.push(Ec)}break;default:dc.ULS.sendTraceTag(537168012,0,10,"CatchUpHighlightControllersCreator.CreateControllersAndHighlights(): Failed.Invalid ActivityLocationType")}}dc.ULS.shipAssertTag(537168011,
0,!(Od.Id in Ld),"CatchUpHighlightControllersCreator.CreateAndUpdateControllers - highlightControllers already has activity: "+Od.Id);this.die[Od.Id]=lg;Ld[Od.Id]=ef}this.l2g(xc,this.i0c,this.bJb);return Ld};R.prototype.ZTg=function(xc){for(var bd in xc)for(var Bd=yl(xc[bd]),Ld=Bd.next();!Ld.done;Ld=Bd.next())Ld.value.Z9i()};R.prototype.Quc=function(xc){return String.format("{0}-{1}",xc.range,xc.sheetId)};R.prototype.l2g=function(xc,bd,Bd){var Ld=this;this.ZTg(Bd);Bc.g(xc).Nb.uw(bd,[24],!0,function(Od,
ef){var ag=new bg.a(Od.range,Od.sheetId);ag=Ld.Quc(ag);var lg=Bd[ag];if(lg)for(ag=yl(lg),lg=ag.next();!lg.done;lg=ag.next())lg=lg.value,lg.Ryg(ef),Od.metadata=lg;else dc.ULS.shipAssertTag(537168010,0,!1,"CatchUpHighlightControllersCreator.CreateHighlightsAndUpdateControllers(), Missing Controller for SheetRangeKey "+ag)})};Object(kb.a)(R,"CatchUpHighlightControllersCreator",null,[]);Object(kb.a)(W,"CreateIndicatorTooltipParameters",null,[]);Object(kb.a)(ia,"DismissIndicatorTooltipParameters",null,
[]);Object(kb.a)(P,"UpdateIndicatorTooltipParameters",null,[]);N.prototype.dispose=function(){this.ha.zqc(this.Zk);this.ha.mF(this.kd);this.gridView.lF(this.Wo);this.qb.im(this.Mj);this.CEe();this.t$c=this.Aja=this.scc=this.pQa=this.qb=this.ha=this.gridView=null};N.prototype.Ngj=function(){var xc=[];this.CEe();if(!fd.e(xc)){dc.ULS.sendTraceTag(537168035,0,50,"In CatchUpActivityHighlightManager:ProcessActivityPayloadHighlights().");if(this.t4=this.i2b.P0g(this.$,xc,this)){xc=this.t4;for(var bd in xc)for(var Bd=
yl(xc[bd]),Ld=Bd.next();!Ld.done;Ld=Bd.next())this.vHg(Ld.value)}this.i2b.U6i(this.$)}};N.prototype.Rvc=function(xc){if(xc&&this.Mhd)dc.ULS.shipAssertTag(537168034,0,!1,"CatchUpActivityHighlightManager.ShowOrHideAllHighlights - Trying to show all highlights when marked as read");else if(xc||this.Nqb(),this.t4){var bd=this.t4,Bd;for(Bd in bd)for(var Ld=yl(bd[Bd]),Od=Ld.next();!Od.done;Od=Ld.next())Od.value.htj(xc)}};N.prototype.t0h=function(xc){this.Aja&&this.O4b(!0);this.D4c();if(xc=this.t4[xc.activityId]){xc=
yl(xc);for(var bd=xc.next();!bd.done;bd=xc.next())bd.value.LHb(!0)}else dc.ULS.sendTraceTag(537168032,0,50,"CatchUpActivityHighlightManager.OnSelectHighlight - Controllers not found during select")};N.prototype.CEe=function(){if(this.t4){var xc=this.t4,bd;for(bd in xc)for(var Bd=yl(xc[bd]),Ld=Bd.next();!Ld.done;Ld=Bd.next())Ld=Ld.value,this.J2i(Ld),Ld.dispose()}this.t4={};this.i2b.dispose();this.i2b=null};N.prototype.Irj=function(){if(this.excelCommentManager){var xc=this.t4[this.pQa];xc&&0<xc.length&&
3===xc[0].model.activityType&&((xc=xc[0])?this.excelCommentManager.jsj(xc.AFh()):dc.ULS.shipAssertTag(537168029,0,!1,"RangeCatchUpActivityHighlightController::ShowCommentFlyoutOnSelectedActivity RangeController is Null."))}};N.prototype.L_h=function(){this.excelCommentManager&&this.excelCommentManager.Mrb()};N.prototype.D4c=function(){if(this.pQa){var xc=this.t4[this.pQa];if(xc){xc=yl(xc);for(var bd=xc.next();!bd.done;bd=xc.next())bd.value.LHb(!1);this.pQa=null}else dc.ULS.sendTraceTag(537168028,
0,50,"CatchUpActivityHighlightManager.DeselectCurrentlySelected - Controllers not found for deselection")}};N.prototype.Nqb=function(){this.D4c();this.O4b(!0)};N.prototype.oFj=function(xc){if(!xc)return dc.ULS.shipAssertTag(537168026,0,!1,"CatchUpActivityHighlightManager::TryGetFlyoutContainer HighlightDot is null."),null;xc=String.format("{0}-{1}",xc.id,je.a.VQg);var bd=this.t$c[xc];if(!bd){if(!this.gridView.domElement)return dc.ULS.shipAssertTag(537168025,0,!1,"CatchUpActivityHighlightManager::TryGetFlyoutContainer gridView.DOMElement is null."),
null;bd=document.createElement("Div");bd.className=te.a.WQg;bd.id=xc;this.gridView.domElement.appendChild(bd);this.t$c[xc]=bd}return bd};N.prototype.O4b=function(xc){this.rea&&(this.rea.dismissActivityIndicatorTooltips(Object.assign(new ia,{clearSticky:xc})),this.scc=null,xc&&(this.Aja=null),this.Nec&&!this.Aja&&(this.gridView.view.Wr(this.jzc),this.gridView.Us(this.jzc),this.Nec=!1))};N.prototype.vHg=function(xc){xc.qke(this.qCb);xc.xzg(this.RZf);xc.wzg(this.xFe)};N.prototype.J2i=function(xc){xc.ZLf(this.qCb);
xc.R3i(this.RZf);xc.Q3i(this.xFe)};tl.Object.defineProperties(N.prototype,{pvg:{configurable:!0,enumerable:!0,get:function(){return this.rea},set:function(xc){this.rea=xc}},excelCommentManager:{configurable:!0,enumerable:!0,get:function(){this.ICa||(this.ICa=this.$.da.Aa(65));return this.ICa}},i2b:{configurable:!0,enumerable:!0,get:function(){this.j2b||(this.j2b=new R);return this.j2b},set:function(xc){this.j2b=xc}}});Object(kb.a)(N,"CatchUpActivityHighlightManager",null,[443,3]);U.prototype.navigateToActivity=
function(xc){if(xc.fromSummaryString){var bd=new Ad.a(1834994092,ee.a.Wb,this.$.ed,18,null);this.$.Ka.Zb(bd);return this.nTa(1)}xc=xc.activity;if(!this.w8h(xc))return this.nTa(4);if(!this.Tfi(xc))return this.nTa(7);var Bd={};try{bd=window.self.atob(xc.navigationId);if(!bd)return this.nTa(5);Bd.NavigationId=bd}catch(Ld){return dc.ULS.sendTraceTag(537168023,3012,10,"Exception thrown when trying to decode activity NavigationID: {0}",Ld),this.nTa(5)}if(8===this.Di.ze(Rf.a.VHa,2,Bd))return this.Di.processAction(Rf.a.Q7a,
2),this.nTa(2);bd=32===this.Di.ze(Rf.a.b_a,2,Bd)?1:6;return this.nTa(bd)};U.prototype.w8h=function(xc){return xc&&xc.navigationId?!0:!1};U.prototype.Tfi=function(xc){switch(xc.type){case 3:case 4:case 6:case 7:case 9:case 8:return!0;default:return!1}};U.prototype.nTa=function(xc){return Promise.resolve(xc)};Object(kb.a)(U,"CatchUpActivityNavigationManager",null,[392]);var Wf=b(441);Object(kb.a)(B,"GetRelevantActivitiesDataRequest",null,[]);Object(kb.a)(r,"Activity",null,[]);Object(kb.a)(z,"ActivityFeedItem",
null,[]);Object(kb.a)(t,"ActivityFeedPayload",null,[]);Object(kb.a)(x,"ActivityRequestPayload",null,[]);Object(kb.a)(A,"Person",null,[]);vm(m,r);Object(kb.a)(m,"TaskActivity",r,[]);v.prototype.requestWYWAActivities=function(){var xc=this;return this.p5a?new Promise(function(bd,Bd){w(xc.$.qa.ta,function(Ld){Ld=vd.a(Ld)?null:Ld.Result;Ld=Object.assign(new x,{activities:[],actors:Ld?xc.bed(Ld.WywaAuthors):null,hasMore:!1,highWaterline:v.b0a,lowWaterline:v.b0a,wywaWaterline:v.b0a});bd(Ld)},function(){dc.ULS.sendTraceTag(537168022,
0,10,"CatchUpActivityRequestManager::GetLineageWywaAuthors service call failed.");Bd(null)},null,null)}):Promise.resolve(v.d4b)};v.prototype.requestActivities=function(){return Promise.resolve(v.d4b)};v.prototype.requestRelevantActivities=function(){var xc=this;if(!this.$.fa.oc||this.$.fa.L3a)return dc.ULS.sendTraceTag(537168021,3012,15,"CatchUpActivityRequestManager.RequestRelevantActivities: RequestRelevantActivities skipped [IsSessionActive: {0}, HasRaisedSessionEnded: {1}]",this.$.fa.oc,this.$.fa.L3a),
Promise.resolve(v.d4b);var bd=Object.assign(new B,{SetDaysBack:$a.AFrameworkApplication.ga.zd("AppWaterlineOverrideDaysValue",0),SetTimestamp:$a.AFrameworkApplication.ga.zd("AppWaterlineOverrideTimestampValue",0)});return new Promise(function(Bd,Ld){G(xc.$.qa.ta,bd,function(Od){var ef=v.d4b;Od?vd.a(Od)?dc.ULS.sendTraceTag(578353159,3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call returned errors codes: {0}",Pd.a.Uc(Od.Errors)):ef=xc.QPh(Od.Result):dc.ULS.sendTraceTag(537168020,
3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call returned Null result.");Bd(ef)},function(Od){Od=gc.a.yg(Od.data);dc.ULS.sendTraceTag(537168019,3012,10,"CatchUpActivityRequestManager::GetRelevantActivitiesData call has failed - Errors: [{0}]",Pd.a.Uc(Od));Ld(null)},null,null)})};v.prototype.requestActivityFeed=function(){var xc=this;return zd.b(this.getActivityFeed()).then(function(bd){return Object.assign(new t,{activityFeedItems:xc.XDj(bd)})})};v.prototype.getActivityFeed=
function(){var xc=this;return this.uue?Re.a.MSd(this.uue,function(bd){return bd.jCh(xc.FHh())}):Xd.Task.Ta([])};v.prototype.FHh=function(){var xc=RegExp("^(([^:/?#]+):)?(\\\\/\\\\/([^/?#]*))?([^?#]*)(\\\\?([^#]*))?(#(.*))?").exec(decodeURIComponent(za.a.tA(window.location.href,"WOPISrc",!0)))[5].split("/");return xc[xc.length-1]};v.prototype.QPh=function(xc){if(!xc)return dc.ULS.sendTraceTag(537168018,3012,10,"CatchUpActivityRequestManager::GetRelevantActivityRequestPayload response is null."),Object.assign(new x,
{activities:[]});var bd=this.C6f(xc.NewActivities,2);xc=this.C6f(xc.OutstandingActivities,3);xc=yl(xc);for(var Bd=xc.next();!Bd.done;Bd=xc.next())bd.push(Bd.value);return Object.assign(new x,{activities:bd})};v.prototype.C6f=function(xc,bd){bd=void 0===bd?1:bd;var Bd=[];if(!xc||!xc.length)return Bd;xc=yl(xc);for(var Ld=xc.next();!Ld.done;Ld=xc.next())if(Ld=Ld.value){var Od=v.dEj(Ld.Type);6===Od||7===Od||9===Od||8===Od?Bd.push(Object.assign(new m,{activityId:Ld.Id,type:Od,displayTimestamp:new Date(Ld.DisplayTimestamp),
navigationId:Ld.NavigationId,actors:this.bed(Ld.People),relevancy:bd,relationship:this.cEj(Ld.Relationship)})):Bd.push(Object.assign(new r,{activityId:Ld.Id,type:Od,displayTimestamp:new Date(Ld.DisplayTimestamp),navigationId:Ld.NavigationId,actors:this.bed(Ld.People),relevancy:bd}))}else dc.ULS.shipAssertTag(537168017,3012,!1,"CatchUpActivityRequestManager.TranslateRelevantActivitiesToActivities: relevantActivity is null");return Bd};v.prototype.cEj=function(xc){switch(xc){case 1:return 1;case 2:return 2;
case 3:return 3}dc.ULS.sendTraceTag(537168016,0,10,"Unexpected Relationship.");return 1};v.prototype.XDj=function(xc){var bd=[];xc=yl(xc);for(var Bd=xc.next();!Bd.done;Bd=xc.next())Bd=Bd.value,Bd=Object.assign(new z,{id:Bd.id,type:Bd.type,collectionId:Bd.collectionId,activityState:Bd.activityState,activityFeedItemPayload:Bd.activityFeedItemPayload,timestamp:Bd.timestamp}),bd.push(Bd);return bd};v.prototype.bed=function(xc){var bd=[];if(!xc||!xc.length)return bd;xc=yl(xc);for(var Bd=xc.next();!Bd.done;Bd=
xc.next())(Bd=Bd.value)&&bd.push(this.xub(Bd));return bd};v.prototype.xub=function(xc){return Object.assign(new A,{id:xc.Id,provider:xc.Provider,displayName:xc.DisplayName,email:xc.Email,imageUrl:this.Roc.dHa(xc.Email,xc.Provider,$a.AFrameworkApplication.hj,0),color:this.aEb.Bfd(new Wf.a(null,void 0,xc.DisplayName),6)})};v.dEj=function(xc){switch(xc){case 1:return 3;case 2:return 4;case 3:return 6;case 4:return 7;case 6:return 8;case 5:return 9;case 7:return 10;default:return dc.ULS.shipAssertTag(537168015,
3012,!1,"CatchUpActivityRequestManager.TranslateRelevantActivityTypeToActivityType: unknown RelevantActivityType"),1}};v.d4b=Object.assign(new x,{activities:[],actors:[],hasMore:!1,highWaterline:v.b0a,lowWaterline:v.b0a,wywaWaterline:v.b0a});Object.assign(new x,{activities:[Object.assign(new r,{activityId:"activityId1",type:3,actors:[Object.assign(new A,{id:"personId1",provider:"provider",displayName:"Kat Larsson",email:"klarsson@contoso.net"})],displayTimestamp:new Date,relevancy:2,navigationId:"navigationId1"}),
Object.assign(new r,{activityId:"activityId2",type:4,actors:[Object.assign(new A,{id:"personId2",provider:"provider",displayName:"Frankie Smith",email:"fsmith@contoso.net"})],displayTimestamp:new Date,relevancy:2,navigationId:"navigationId2"})]});v.b0a="<WywaWaterline>DefaultWaterline</WywaWaterline>";Object(kb.a)(v,"CatchUpActivityRequestManager",null,[393]);u.prototype.shouldShowEmptyExperienceButton=function(){if(!this.$.fa.P6a)return!1;if(!Ce.EwaSettings.isChangeGateEnabled("OfficeVSO:5892442_CatchupEmptyExperienceNewContract")){var xc=
this.$.da.Aa(365);return!xc||!xc.isVisible}return!0};u.prototype.onButtonClick=function(){var xc={};xc=(xc.InputMethod=ee.a.Wb,xc);this.$.Ka.Zb(new Ad.a(1834994092,ee.a.Wb,this.$.ed,16,null),xc)};u.prototype.getExplanationText=function(){var xc=this.$.da.Aa(365);return ae.a.instance.Va(xc&&xc.isVisible?644:643)};u.prototype.getCommandName=function(){return ae.a.instance.ea(433)};Object(kb.a)(u,"CatchUpEmptyExperienceBehaviorManager",null,[394]);l.prototype.dispose=function(){wc.a(this.$).XA(this)};
l.prototype.Qe=function(xc,bd){if(bd)return!1;xc=document.getElementById("flyoutItem0");if(!xc)return dc.ULS.sendTraceTag(537168009,3012,10,"Could not find firstItem in flyout when setting up focus"),!1;xc.focus();this.gbh(xc);return!0};l.prototype.zh=function(xc){return this.Jb?id.DOMElementExtensions.Ye(this.Jb,xc):!1};l.prototype.ji=function(){this.hasFocus=!0};l.prototype.Vh=function(){this.hasFocus=!1};l.prototype.gbh=function(xc){if(Sys.Browser.agent===Sys.Browser.Firefox){var bd=document.createEvent("KeyboardEvent");
bd.initKeyEvent(we.a.Rb,!0,!0,window.self,!1,!1,!1,!1,ud.a.uAc,0);xc.dispatchEvent(bd)}else bd=document.createEvent("Events"),bd.initEvent(we.a.Rb,!0,!0),bd.keyCode=ud.a.uAc,bd.which=ud.a.uAc,xc.dispatchEvent(bd)};tl.Object.defineProperties(l.prototype,{Jb:{configurable:!0,enumerable:!0,get:function(){return document.getElementById("catchUpFlyoutContainer")}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.flyoutRibbonButton.yaf&&!this.hasFocus}},Zd:{configurable:!0,enumerable:!0,
get:function(){return gb.a.BYc}}});Object(kb.a)(l,"FlyoutFocus",null,[100,3]);var zf=b(374);n.prototype.dispose=function(){this.Xhb=this.Dxb=!1};n.prototype.registerButtonClickedEvent=function(xc){this.buttonClickedCallback&&dc.ULS.sendTraceTag(537168008,3012,15,"RegisterButtonClickedEvent: Button clicked callback should only be registered once.");this.buttonClickedCallback=xc.buttonClickedCallback};n.prototype.onFlyoutInitialized=function(){this.Dxb&&dc.ULS.sendTraceTag(537168007,3012,15,"OnFlyoutInitialized: Flyout should only be initialized once.");
var xc=(new Date).getTime()-this.qxh.getTime();dc.ULS.sendTraceTag(593601546,3012,50,"Time from retrieve activities to initialize Flyout: {0}",xc);Wa.c(Rf.a.ZQg,!0,Wa.e,0,0,xc);this.Dxb=!0;zf.a.sy&&zf.a.sy.updateCommandUI(!0)};n.prototype.logFlightTriggers=function(){};n.prototype.toggleCatchUpFlyout=function(){this.Dxb?this.buttonClickedCallback?this.buttonClickedCallback():dc.ULS.sendTraceTag(537168005,3012,10,"ToggleCatchUpFlyout: User clicked the button before the buttonClickedCallback was registered."):
dc.ULS.sendTraceTag(537168006,3012,10,"ToggleCatchUpFlyout: User clicked the button before the flyout was initialized.")};n.prototype.onFlyoutVisibilityChanged=function(xc){this.Xhb!==xc.flyoutIsVisible&&(this.Xhb=xc.flyoutIsVisible,zf.a.sy&&zf.a.sy.updateCommandUI(!0),this.Xhb||this.pRe&&this.pRe.lmi())};tl.Object.defineProperties(n.prototype,{yaf:{configurable:!0,enumerable:!0,get:function(){return this.Xhb}}});Object(kb.a)(n,"FlyoutRibbonButton",null,[423]);var tg=b(528);Object(kb.a)(k,"CatchUpConfiguration",
null,[]);Object(kb.a)(c,"SharedControllerFactoryParameters",null,[]);d.prototype.dispose=function(){this.iGa&&this.iGa.getWywaEvent().removeListener(this.pBf);this.iGa=this.$=null;yd.a.Fa(this.uZa);this.flyoutRibbonButton=this.flyoutFocus=this.i0d=this.sue=this.tue=this.uZa=null};d.prototype.RLi=function(){this.flyoutRibbonButton.toggleCatchUpFlyout();return!0};d.prototype.Pmi=function(){dc.ULS.sendTraceTag(589608192,3012,50,"Catch Up script is loaded and Flyout is enabled.");dc.ULS.sendTraceTag(594401288,
3012,50,"Tasks and outstanding data is enabled")};d.prototype.Xki=function(xc,bd){f("ScriptDownload");Ac.TaskExtensions.Ba(cc.GetServiceTaskFactory.Xa(this.$.da,283,284,bd),function(Bd){xc(zd.c(Bd.result.wo.loadScript("catchUpActivity")))},this.$.da.ma,3)};d.prototype.p5a=function(){return!!this.thf&&this.thf.p5a()&&this.$.fa.P6a};d.prototype.Izi=function(xc){var bd=this;Ac.TaskExtensions.Ba(xc,function(){mb.a(function(){bd.iGa=catchUpActivity.FactoryGlobal.getExcelCatchUpAppInstance(Object.assign(new c,
{activityContentManager:Object(ze.a)(391,bd.i0d),activityNavigationManager:Object(ze.a)(392,bd.sue),activityRequestManager:Object(ze.a)(393,bd.tue),dataCulture:bd.$.ya.DataCultureTag,flyoutFocus:null,flyoutRibbonButton:Object(ze.a)(n,bd.flyoutRibbonButton),uiCulture:bd.$.ya.UICultureTag,ulsLogger:new bc.a,emptyCatchUpBehaviorManager:Object(ze.a)(394,bd.emptyCatchUpBehaviorManager)}))});bd.uZa.pvg=bd.iGa.getActivityIndicatorTooltipManager();tg.a(bd.$);bd.iGa.getWywaEvent().addListener(bd.pBf);f("InitializeCatchUpApp");
bd.iGa.initialize(Object.assign(new k,{featuredActivityGroupsEnabled:!1,flyoutEnabled:!0,summaryStringEnabled:bd.p5a(),includeRelevantAuthorsInSummaryString:!1,useCompactSummaryString:Ce.EwaSettings.isChangeGateEnabled("OfficeVSO:5788078_useCompactStringOnExcel")}))},this.$.ma,3)};tl.Object.defineProperties(d.prototype,{V9e:{configurable:!0,enumerable:!0,get:function(){var xc=this.flyoutRibbonButton.Dxb;xc&&!this.X3e&&(dc.ULS.sendTraceTag(588129368,3012,50,"Catch Up Flyout is ready and button is enabled."),
this.X3e=!0);return xc}},z9h:{configurable:!0,enumerable:!0,get:function(){return this.flyoutRibbonButton.yaf}}});Object(kb.a)(d,"CatchUpActivityManager",null,[395,3]);var Hf=Xb.a;vm(a,Hf);a.prototype.create=function(){var xc=this;Ac.TaskExtensions.Ba(cc.GetServiceTaskFactory.Xa(this.$.da,458,459,this.tb),function(bd){bd=bd.result;xc.Fb(xc.$.da.Aa(286)||new d(xc.$,xc.tb,null,bd))},this.$.ma,3)};a.ja=function(xc){xc.da.Ha(287,new a(xc))};Object(kb.a)(a,"CatchUpActivityManagerFactory",Xb.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Lineage");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.VersionHistory");Type.registerNamespace("_Ewa");Ua.a.Ga(Pc.ja);Ua.a.Ga(Xc.ja);Ua.a.Ga(ka.ja);Ua.a.Ga(Ga.ja);rd.a.Yi('.LineageActivityPane{height:100%;display:flex;flex-direction:column;overflow:hidden;background-color:#edebe9}.LineageActivityPaneHeader{display:flex;flex-direction:row;position:relative;overflow:hidden;padding-right:16px;padding-left:16px;padding-top:16px;padding-bottom:11px;height:auto;background-color:#edebe9}.LineageActivityPaneTitle{max-width:240px;display:inline-flex;font-weight:bold;font-family:"Segoe UI Semi Bold","Segoe UI Web",Arial,Verdana,sans-serif;font-size:16px;line-height:16px;flex-grow:1;align-content:center;height:auto;text-overflow:ellipsis;overflow:hidden;background-color:#edebe9;margin:0}.LineageActivityCloseButton{display:inline-flex;align-self:center}.LineageActivityBody{height:100%;padding-left:16px;overflow:hidden;background-color:#edebe9}');
(function(){Ua.a.Ga(function(xc){Sb.ja(xc);da.ja(xc);Ja.ja(xc);Cb.ja(xc);Kb.ja(xc)})})();Type.registerNamespace("Common.App.CatchUpActivity");na.main();(function(){Ua.a.Ga(function(xc){f("Begin");a.ja(xc);S.ja(xc)})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.catchup.js.map/31fd8605bffce99cc414d558d9117b61/EwaDS.catchup.js.map