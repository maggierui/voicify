(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[18],{1215:function(y,D,b){function a(){}b.d(D,"a",function(){return a});y=b(0);a.RBc="b-ring_Apc_Trans";a.zdg="cdn_static_resource_ewa_image";Object(y.a)(a,"ResourceHosts",null,[])},1262:function(y,D,b){function a(){}function d(u,v,m,A,x){this.url="";this.r4a=!1;this.k7=-1;this.testIteration=0;this.baseUrl=m;this.gsf=A;this.Xhd=v;this.result=new c(v,x)}function c(u,v){this.testName=null;this.startTimeMs=0;this.isSuccess=!1;this.caller=
this.errorStatusCode=this.errorMessage=null;this.reqTotalDurationMs=0;this.browserResourceTiming=null;this.testIteration=0;this.testName=u;this.caller=v;this.reset()}y=b(0);var k=b(52),n=b(13),l=b(277);c.prototype.reset=function(){this.isSuccess=!1;this.startTimeMs=-1;this.errorStatusCode=this.errorMessage="";this.reqTotalDurationMs=-1;this.browserResourceTiming=null};Object(y.a)(c,"NetworkTestResult",null,[]);var f=b(599);d.prototype.HJd=function(){try{if(this.r4a)n.ULS.sendTraceTag(537155206,0,
50,"NetworkTestReq.RunTest: a test for the host {0} is already mid way, not starting a new one.",this.Xhd);else{this.reset();this.r4a=!0;this.result.startTimeMs=Date.now();var u=new l.QueryStringBuilder(this.baseUrl);u.f9("tid",this.result.startTimeMs.toString());this.url=u.toString();this.Zej();this.testIteration++;this.result.testIteration=this.testIteration}}catch(v){this.wsb("Exeption: "+v.message)}};d.prototype.reset=function(){this.url="";this.result.reset();this.r4a=!1;this.k7=-1};d.prototype.clearTimeout=
function(){-1!==this.k7&&(window.clearTimeout(this.k7),this.k7=-1)};d.prototype.Zej=function(){var u=this;try{var v=new XMLHttpRequest;v.onreadystatechange=function(){4===v.readyState&&(200===v.status?u.Xvh():u.wsb(String.format("Error when downloading resource. status code: {0}, status text: {1}",v.status,v.statusText),v.status.toString()))};v.onerror=function(){u.wsb(String.format("Client error when attempting to download resource. status code: {0}, response: {1}",v.status,v.statusText))};this.k7=
window.setTimeout(function(){u.k7=-1;u.wsb("Request timeout")},1E4);v.open("GET",this.url,!0);v.send(null)}catch(m){this.wsb("Exeption: "+m.message)}};d.prototype.Xvh=function(){this.r4a&&(this.result.reqTotalDurationMs=Date.now()-this.result.startTimeMs,this.clearTimeout(),this.result.browserResourceTiming=f.a(this.url),this.result.isSuccess=!0,this.A1b())};d.prototype.wsb=function(u,v){v=void 0===v?null:v;this.r4a&&(this.clearTimeout(),this.result.errorMessage=u,this.result.isSuccess=!1,this.result.errorStatusCode=
v,this.A1b())};d.prototype.A1b=function(){this.r4a=!1;this.gsf&&this.gsf(this.result,this.Xhd)};Object(y.a)(d,"NetworkTestReq",null,[]);b.d(D,"a",function(){return a});a.Iad=function(u,v,m,A){A=void 0===A?null:A;a.bkc||(a.bkc=Array.isArray(k.a.li(m.ya.NetworkMeasurementUrlList))?k.a.li(m.ya.NetworkMeasurementUrlList):null);for(var x=[],t=0;t<a.bkc.length;t++){var z=a.bkc[t],r=z.key;r||(r=z.Key);if(!A||Array.contains(A,r)){var G=z.value;G||(G=z.Value);r&&G&&x.push(new d(m,r,G,u,v))}}return x};a.bkc=
null;Object(y.a)(a,"NetworkConnectionHelpers",null,[])},1378:function(y,D,b){function a(T){var Oa=ni.call(this)||this;Oa.$=T;Oa.dc();return Oa}function d(T,Oa,Ib,hc){var nd=this;this.CK=null;this.I$f=function(){nd.CK&&(nd.oXd=Le.a.Ra.re.m,nd.hide(),qi.a.instance.create(function(){nd.OKj()},250,"RecoveryUI.UpdatePositionOnVisibleAreaChanged",void 0,!0))};this.DFe=function(Td){10===Td&&nd.NHa()};this.$ah=function(){if(nd.CK){var Td=document.getElementById("PasteRecoveryUI");Td&&ce.a.rj===Td.getAttribute(ce.a.cY)&&
Td.click();nd.NHa()}};this.EFe=function(){nd.NHa()};this.FFe=function(){nd.NHa()};this.onKeyUp=function(Td){if(nd.CK){if(nd.OZ)return!1;if(17===Td.Ea.keyCode&&nd.m7b){Td=document.getElementById("PasteRecoveryUI");if(!Td)return Bc.ULS.shipAssertTag(537154070,0,!1,"RecoveryUIController.OnKeyUp: recoveryUIElement is null."),!1;var Ed=Td.getAttribute(ce.a.cY)||"";if(ce.a.pp===Ed)return Td.click(),!0}}return!1};this.onKeyDown=function(Td){if(nd.CK){nd.m7b=!1;nd.OZ=Td.ctrlKey;Td=Td.Ea.keyCode;if(27===Td)return nd.NHa(),
!0;if(17===Td)return nd.m7b=!0}return!1};this.Jxa=function(Td,Ed){Td=Ed.ee;nd.A6a=Td;-1027730316!==Td.command&&-1059615499!==Td.command?nd.NHa():(Ed=Ed.properties)&&Ed.launcherId!==nd.BLh()&&nd.NHa()};this.$=T;this.mpc=Oa;this.Et=Ib;this.nk=hc;this.pqd=this.A6a=this.$pd=null;this.OZ=this.m7b=this.P4b=this.ecc=!1;this.oXd=0;this.$.da.Ha(406,this)}function c(T){var Oa=Ah.call(this)||this;Oa.$=T;Oa.dc();return Oa}function k(T,Oa,Ib){Ib=void 0===Ib?!0:Ib;var hc=hj.call(this)||this;hc.vRa=null;hc.ina=
null;hc.ANa=null;hc.N1b=null;hc.l0=null;hc.Xnf=0;hc.F$a=!1;hc.E$a=!1;hc.Upc=!1;hc.documentVisibilityObserver=null;hc.Ynf=null;hc.wuj=null;hc.afa=!1;hc.i7=0;hc.Zid=0;hc.lyb=!1;hc.O0f=0;hc.jOd=!1;hc.x0=null;hc.ECb=function(){Bc.ULS.sendTraceTag(537155219,0,50,"NetworkConnectionStateManager.OnNetworkDownEvent: Network down.");hc.Ejc(1,!1)};hc.Nxa=function(){hc.Zja||hc.iAb?window.setTimeout(function(){hc.nTd()},hc.Xnf):hc.nTd();hc.documentVisibilityObserver.cGb(hc.Nxa);hc.lyb=!1};hc.Rh=function(){Bc.ULS.sendTraceTag(537155218,
0,50,"NetworkConnectionStateManager.OnEditEnded: Edit ended. IsInOfflineMode:{0}, IsInDuringWorkSilentReopenMode:{1}",hc.iAb&&hc.fvc,hc.zic&&!hc.afa&&hc.kJb);hc.iAb&&hc.fvc&&hc.Ihe();hc.zic&&!hc.afa&&hc.kJb&&hc.Fhe();Hf.g(hc.$).rc.Rp(hc.Rh);hc.E$a=!1;hc.F$a=!1};hc.Hwf=function(){Bc.ULS.sendTraceTag(537155213,0,50,"NetworkConnectionStateManager.OnNetworkResumedEvent: network was resumed.");hc.Ejc(1,!0);hc.E$a&&!hc.F$a&&Hf.g(hc.$).rc.Rp(hc.Rh);hc.E$a=!1};hc.Uba=function(nd,Td){hc.Zid=hc.i7;hc.i7=Td.ayc};
hc.Lzf=function(){hc.$&&(hc.Upc||(ha.a(hc.$).gQ(K.a.kOa).gAg(hc.Swf),hc.$.Rk(hc.od),hc.Upc=!0),hc.afa=hc.Z8h(),hc.Ejc(2,!1))};hc.Swf=function(){var nd=ha.a(hc.$).ui,Td=nd.tGg();nd=ti.f(nd.es.nd.errors,function(Ed){return Ed.MessageIdName});Bc.ULS.sendTraceTag(545842889,0,50,"NetworkConnectionStateManager.OnOpenWebMethodErrorUserAlertExecuting: IsStateUnrecoverable:{0}, IsB2W:{1}, Errors: {2}",Td,hc.afa,Fg.a.Hc(nd));Td&&(hc.vRa?(hc.afa=!1,hc.uDe(),hc.azc()):hc.ina&&(hc.vDe(),hc.azc()))};hc.od=function(){hc.$?
(Bc.ULS.sendTraceTag(541193955,0,50,"NetworkConnectionStateManager.OnWorkbookOpened: Workbook opened."),hc.afa=!1,te.EwaSettings.isChangeGateEnabled("OfficeVSO:5543662_StopSilentReopenDuringWorkTimerMethodContextOnWorkbookOpened")&&hc.l0&&hc.l0.Qo&&(ah.a.Fa(hc.l0),hc.l0=null),te.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&hc.x0&&hc.x0.Qo&&(ah.a.Fa(hc.x0),hc.x0=null),hc.Ejc(2,!0),hc.azc()):Bc.ULS.sendTraceTag(537155212,0,10,"NetworkConnectionStateManager.OnWorkbookOpened: bug monitoring: EwaControl is null.")};
hc.msf=function(){hc.Smf(!0)};hc.nsf=function(){hc.Smf(!1)};hc.DUb=G.Rki;hc.t0c=G.connected;hc.$=T;hc.uf=T.qa.uf;hc.RYf=te.EwaSettings.isChangeGateEnabled("OfficeVSO:5618694_BackToWorkLoadingUIEnabled");hc.kJb=te.EwaSettings.isChangeGateEnabled("OfficeVSO:5798300_SilentReopenDuringWorkUIEnabled");hc.fvc=te.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled");Ib&&(hc.Ynf=new f(T,Oa));te.EwaSettings.isChangeGateEnabled("OfficeVSO:5589104_AlwaysInitDocumentVisibilityObserver")&&
hc.$.da.Za(291,function(nd){hc.documentVisibilityObserver=nd});hc.fvc&&(te.EwaSettings.isChangeGateEnabled("OfficeVSO:5589104_AlwaysInitDocumentVisibilityObserver")||hc.$.da.Za(291,function(nd){hc.documentVisibilityObserver=nd}),hc.Xnf=hc.$.ya.ExcelNetworkCheckAfterTabActivationDelayMs,hc.uf.nBg(hc.ECb),hc.uf.nmb(hc.Hwf),hc.uf.yke(hc.msf),hc.uf.Mzg(hc.nsf));if(hc.RYf||hc.kJb)hc.wuj=new n(hc.$,hc);hc.Hjf=hc.$.ya.LongInactivityTimePeriodSeconds;hc.$.fa.LTc(hc.Lzf);hc.$.fa.Df.dra(hc.Uba);hc.kJb&&(hc.O0f=
hc.$.ya.SilentReopenDuringWorkDelayMs);return hc}function n(T){var Oa=this;this.X6=null;this.Mzf=function(Ib,hc){Oa.Jzf(hc,3)};this.cwf=function(Ib,hc){Oa.Jzf(hc,2)};this.$=T;this.pg=nf.a(this.$).pg;this.pg.dle(this.cwf);this.pg.ACg(this.Mzf)}function l(T,Oa,Ib,hc){T=r.call(this,T,Oa,Ib)||this;T.wasInteruptedByOfflineMode=!1;T.type=hc;T.wasInteruptedByOfflineMode=!1;return T}function f(T,Oa){this.Xka=this.pvd=this.$pf=null;this.$=T;!te.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled")||
te.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&$e.a.zf||(this.$pf=new u(T,Oa));te.EwaSettings.la(212)&&(this.pvd=new A(this.$),this.pvd.U2h());!te.EwaSettings.la(588)||te.EwaSettings.isChangeGateEnabled("OfficeVSO:4956381_DisableNetworkLoggingInFirefox")&&$e.a.zf||(this.Xka=new Eg.NetworkConnectionHealthChecker(this.$));this.RXg=new x(this.$)}function u(T,Oa){var Ib=this;this.zNa=this.$T=null;this.yCd=-1;this.Jsb=null;this.Egf=hg.Task.delay(0);this.F8a=function(hc,
nd){nd.ZO?Ib.PHi(nd.wna):Ib.QHi()};this.Vba=function(hc,nd){5===nd.ICf&&Ib.H1a()};this.BRf=function(hc,nd){Ib.$T.qij(nd.sU)};this.H1a=function(){Ib.zNa.UIj();Ib.ucj(u.EAd,Sys.Serialization.JavaScriptSerializer.serialize(Ib.zNa))};this.u8i=function(hc){if(hc=hc.result)Ib.Xbg=!0,Bc.ULS.sendTraceTag(576811915,0,50,"OfflineModeTelemetryManager.ReportOfflinePartialInteractivityDataFromIDB: Previous session's offline partial interactivy data: {0}",hc)};this.B2i=function(){Ib.Xbg&&(Ib.$?$f.TaskExtensions.Ba(Ib.indexedDB.z4c(u.EAd),
function(){Bc.ULS.sendTraceTag(537155204,0,50,"OfflineModeTelemetryManager.RemoveDataFromIDB: Previous session's offline partial interactivy data successfuly removed from IDB.")},Ib.$.ma):Bc.ULS.sendTraceTag(537155203,0,10,"OfflineModeTelemetryManager.RemoveDataFromIDB: EwaControl is null when attempting to remove offline mode data stored in IDB."))};this.GNa=function(){if(Ib.zNa&&0<Ib.zNa.count){var hc=Sys.Serialization.JavaScriptSerializer.serialize(Ib.zNa);Bc.ULS.sendTraceTag(560791644,0,50,"OfflineModeTelemetryManager.OnBeforeUnload: This session's offline partial interactivy data: {0}",
hc)}};this.$=T;this.indexedDB=Oa;this.Xbg=!1;this.indexedDB.og()&&(this.indexedDB.initialize(u.fjd,u.gjd),this.O7i(),this.zNa=new m(this.$.ya.UserSessionId),nf.a(this.$).pg.rTc(this.F8a));this.nk=zb.a.instance.VD();this.nk.ja("beforeunload",this.GNa)}function v(T,Oa,Ib){T=r.call(this,T,Oa,Ib)||this;T.timeFromLastOffline=0;T._errorDataDuringOfflineMode=null;T.timeFromLastOffline=-1;T.type=5;return T}function m(T){this._count=0;this.sessionID=this.allOfflinePartialInteractivitiesDataInSession=null;
this.allOfflinePartialInteractivitiesDataInSession=[];this.sessionID=T}function A(T){var Oa=this;this.FQf=null;this.kqd=this.nud=this.zBb=this.ABb=0;this.qOd=!1;this.j0c=this.ARa=this.pwc=this.H7a=null;this.y0c=0;this.cfj=function(){if(12E4>Oa.$.fa.Df.bdb)for(var Ib=yl(Oa.pwc),hc=Ib.next();!hc.done;hc=Ib.next())hc.value.HJd();else Oa.$Qd("UserInactive")};this.D8i=function(Ib){Ib=Sys.Serialization.JavaScriptSerializer.serialize(Ib);Bc.ULS.sendTraceTag(388821830,0,50,Ib)};this.T7i=function(Ib){if(Ib){var hc=
Oa.j0c[Ib.testIteration.toString()];hc?hc.push(Ib):(hc=[Ib],Oa.j0c[Ib.testIteration.toString()]=hc);if(hc.length===Oa.FQf.length){hc=Sys.Serialization.JavaScriptSerializer.serialize(hc);if(Oa.$&&Oa.$.uf){if(Ib.EstimatedLatency=Oa.$.uf.zqe,Oa.$.uf.zqe>Oa.$.ku.ExcelRountripThresholdMs){Bc.ULS.sendTraceTag(570712144,0,50,"Periodic ping tests results when network is slow: {0}, consequtive slow ping iteration #: {1}",hc,Oa.y0c++);return}}else Bc.ULS.sendTraceTag(537155209,0,50,"EwaControl/ConnectivityObserver is null when conducting slow connection speed tests");
Bc.ULS.sendTraceTag(570712142,0,50,"Periodic ping tests results: {0}",hc);Oa.y0c=1}}};this.Zh=function(Ib,hc){Ib=hc.context.methodName;if(Ib===bf.a.Z2a||Ib===bf.a.Pua)Oa.zBb++,Ib=Date.now(),Oa.ypj(Ib)&&(Oa.zBb=0,Oa.kqd=Ib,Oa.xxj())};this.Uba=function(){Oa.IQd("OnThrottledUserActivity")};this.IV=function(){Oa.$Qd("OnDocumentHidden")};this.Nxa=function(){Oa.IQd("OnDocumentUnhidden")};this.$=T;if(this.rOd=te.EwaSettings.isChangeGateEnabled("OfficeVSO:5186511_SendSlowNetworkPingTests")&&this.zSg())this.FQf=
[Ti.a.RBc],this.y0c=1,this.j0c={},this.$.fa.Df.dra(this.Uba),this.$.da.Za(291,function(Ib){Ib.aFa(Oa.IV);Ib.hmb(Oa.Nxa)})}function x(T){var Oa=this;this.shc=this.data=null;this.c9c=0;this.Sye=null;this.osf=function(Ib,hc){hc.ZO?(Oa.data=new z(Le.a.Ra.Kb,Oa.$,5===hc.wna,!!hc.wna,Oa.$.uf.disconnectionSource,Oa.Sye),Oa.shc=Oa.$.uf.Kgf,Oa.c9c=1,Oa.$.qa.uf.bDg(Oa.Xo),Dh.a(Oa.$).bTc(Oa.ARf)):(Oa.data.OAi(Oa.$,5===hc.wna),Oa.$.qa.uf.lNf(Oa.Xo),Oa.data.lastFailedRequestToOnlineTimeGapSec=xh.getElapsedSeconds(Oa.shc,
Le.a.Ra.Kb),te.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_7pzab_ConnectivityIssues")?bg.b().aIb(557682689,0,50,t.connectivityIssues,Oa.data.durationMs,"ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: {0}",Fg.a.Hc(Oa.data)):Bc.ULS.sendTraceTag(557682689,0,50,"ConnectivityIssuesTelemetryManager.OnConnectivityIssuesEnded: this partial interactivity's info: {0}",Fg.a.Hc(Oa.data)),te.EwaSettings.isChangeGateEnabled("OfficeVSO:5508233_ReportNetworkDownVeto")&&
Oa.data&&Oa.data.isToastShown&&$c.Health.instance.recordQosError(sf.a.mUg,[Vf.a.Ohc],!0,!1,!1,!1,null),Dh.a(Oa.$).HGd(Oa.ARf),Oa.data=null)};this.ARf=function(Ib,hc){Oa.data.pij(hc.sU)};this.Xo=function(Ib,hc){Oa.data.c_i(hc.context.methodName);Ib=Le.a.Ra.Kb;hc=xh.getElapsedSeconds(Oa.shc,Ib);Oa.shc=Ib;hc>Oa.data.longestDurationBetweenFailedRequestsSec&&(Oa.data.longestDurationBetweenFailedRequestsSec=hc);Oa.c9c++;Oa.data.averageDurationBetweenFailedRequestsSec=Oa.UOg(hc)};this.lsf=function(Ib,hc){Oa.Sye=
hc.MEj};this.$=T;nf.a(this.$).pg.zke(this.osf);this.$.uf.yke(this.lsf)}function t(){}function z(T,Oa,Ib,hc,nd,Td){T=r.call(this,T,Oa,hc)||this;T.swappedByOffline=!1;T.swappedOffline=!1;T.averageDurationBetweenFailedRequestsSec=0;T.longestDurationBetweenFailedRequestsSec=0;T.lastFailedRequestToOnlineTimeGapSec=0;T.disconnectionSource=null;T.errorDataDuringConnectivityIssuesMode=null;T.failedRequests=[];T.triggeringRequest=null;T.type=4;T.swappedOffline=Ib;T.disconnectionSource=Enum.toString(dh.a,nd);
T.triggeringRequest=Td;return T}function r(T,Oa,Ib){var hc=this,nd;this.type=0;this.startTime=null;this.blockedOperationsCount=this.durationMs=0;this.blockedActions=null;this.blockedUserOperationsWhileToastShown=this.durationUntilToastShownMs=0;this.toastRaiser=null;this.wasUserActiveOnPIEnd=this.wasUserActiveOnPIStart=this.hasTabbedOut=this.isToastShown=!1;this.durationUntilUserInactive=-1;this.isTaskPaneCollapsed=this.isTaskPaneShown=this.isDialogShown=!1;this.crf=function(Td,Ed){hc.blockedOperationsCount++;
Td=String.format("{0}_{1}_{2})",Ed.componentName,Ed.actionName,Ed.details);hc.blockedActions[Td]=hc.blockedActions[Td]?hc.blockedActions[Td]+1:1;hc.isToastShown&&hc.blockedUserOperationsWhileToastShown++};this.Ezd=function(Td){hc.durationUntilUserInactive=xh.getElapsedSeconds(hc.startTime,Le.a.Ra.Kb);Td.kNf(hc.Ezd)};this.IV=function(){hc.hasTabbedOut=!0};this.Vba=function(Td,Ed){Ed.ICf!==hc.type||hc.isToastShown||(hc.durationUntilToastShownMs=vh.a(Le.a.Ra,hc.startTime),hc.toastRaiser=Ed.toastRaiser,
hc.isToastShown=!0)};this.startTime=T;this.durationUntilToastShownMs=0;this.blockedActions={};this.isToastShown=Ib;if(null===(nd=Oa.fa)||void 0===nd?0:nd.Df)this.wasUserActiveOnPIStart=Oa.fa.Df.Yq;this.ak(Oa);te.EwaSettings.isChangeGateEnabled("OfficeVSO:5340853_ImprovePIData")?(this.isDialogShown=0<Oa.Ab.eR,T=Oa.da.Aa(183),this.isTaskPaneShown=!!T&&T.isVisible&&!T.isCollapsed,this.isTaskPaneCollapsed=!!T&&T.isVisible&&T.isCollapsed):this.isTaskPaneCollapsed=this.isTaskPaneShown=this.isDialogShown=
!1}function G(){}function w(T){var Oa=$g.call(this)||this;Oa.Nc=T;Oa.dc();return Oa}function B(T,Oa,Ib){Ib=void 0===Ib?null:Ib;var hc=ih.call(this)||this;hc.wZa=null;hc.i4a=null;hc.ddc=null;hc.iCa=null;Bc.ULS.sendTraceTag(537155417,0,50,"MergeSuspensionManager.ctor started");hc.$=T;hc.xjb=new S(T);hc.q3h(T,Ib);Ib=te.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DPMOWaitsForMergeToEnd",!1);hc.jfa=new Y(hc.iCa,hc.xjb,!Ib);hc.$Hd=new U(T,hc.jfa,Oa,Ib);te.EwaSettings.la(255)&&(hc.ddc=new pa(T,
hc));Bc.ULS.sendTraceTag(588276810,0,50,"MergeSuspensionManager created");return hc}function U(T,Oa,Ib,hc,nd,Td){nd=void 0===nd?null:nd;Td=void 0===Td?null:Td;var Ed=ig.call(this)||this;Ed.gGe=null;Ed.Bma=null;Ed.brb=null;Ed.Yyb=0;Ed.u6a=null;Ed.Zyb=null;Ed.Uxf=function(he,Pe){Ed.hFe?Ed.gGe.pQi(Pe.Cba):Ed.brb&&Ed.wTf(Pe.Cba)};Ed.jDb=function(he,Pe){Pe.kwa?Ed.exj():Ed.Swc()};Ed.hwf=function(){Ed.Yyb=0};Ed.BTf=function(){var he=Ed.EV.Z$b();Q(Ed.ta,null!=he.SuspensionStartTimestamp?he.SuspensionStartTimestamp:
0,null,function(){Ed.aGi(he)},null,null,Ed.ta.Xb())};Ed.tBa=function(he,Pe){if(Pe){Pe.Fmb.MergeCount=Ed.EV.Z$b();var hf=Hf.g(Ed.$).Qsi();he=hf.min;hf=hf.max;te.EwaSettings.isChangeGateEnabled("OfficeVSO:5524817_LogOnMergeRaceCondition2")?Pe.Fmb.ClientRevisions=Object.assign(new ca,{Min:he,Max:hf,MaxFromBlockCache:Hf.g(Ed.$).Ca.Tlf}):Pe.Fmb.ClientRevisions=Object.assign(new ca,{Min:he,Max:hf})}};Ed.$=T;Ed.vra=Ib;Ed.zej=te.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SelectionAdjust",!1);
Ed.zej&&(Ed.Bma=new N(Ed.$));Ed.EV=Oa;Ed.EV.ZBg(Ed.Uxf);Ed.EV.XXb(Ed.jDb);Ed.EV.hBg(Ed.hwf);Ed.$.qa.fra(Ed.tBa);Ed.ta=Ed.$.qa.ta;Ed.GGb=Ed.$.ya.MergeSuspensionRequestThrottlingTimeInMs;Ed.yii=Ed.$.ya.KeepBlockingPendingMergesRequestIntervalMs;Ed.hFe=hc;Ed.hFe?(Ed.gGe=nd||new I(Ed.ta,Ed.$,null,null,Ed.Bma),Bc.ULS.sendTraceTag(588276807,0,50,"RequestController initialized")):Td?Ed.brb=Td:$f.TaskExtensions.Ba(ef.GetServiceTaskFactory.Xa(Ed.$.da,12,477,3),function(he){var Pe=new W(Ed.ta,Ed.$);Ed.brb=
he.result.Ppb(Pe,Pe,null,"RequestController");Bc.ULS.sendTraceTag(588276807,0,50,"RequestController initialized");2===Ed.EV.getState()&&Ed.wTf(Ed.EV.Z$b())},Ed.$.ma);return Ed}function N(T){var Oa=this;this.Nwc=0;this.cJ=this.Wv=null;this.kT=new ia;this.Hg=function(){Oa.aqe(!0)};this.e8a=function(){Oa.aqe(!1)};this.$=T;this.gridView=Hf.g(this.$);this.gridView.Ca.np(this.Hg);this.gridView.Ca.gq(this.e8a);this.gridView.Ca.pke(this.e8a);this.gridView.Ca.nga(this.e8a);this.Y7i=te.EwaSettings.isChangeGateEnabled("OfficeVSO:5712698_ReportDivergenceInSelectionAdjust");
this.E8i=te.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ReportSelections",!1);this.XEf=te.EwaSettings.isChangeGateEnabled("OfficeVSO:6022585_PreventBlocksCheckForNonContinuous");this.Yze=te.EwaSettings.isChangeGateEnabled("OfficeVSO:6022587_NoAdjustIsNotDivergence2");te.EwaSettings.isChangeGateEnabled("OfficeVSO:6005376_SelectionAdjustTelemetryUpdates")&&this.$.da.Za(276,function(){ug.a(Oa.$).g9(Oa.kT)})}function P(T,Oa,Ib,hc,nd){this.MF=Oa;this.U8=Ib;this.NUb=hc;this.Vfg=nd;this.JBa&&
(this.v_d=Hf.g(T).Ca.l2a(this.selectedRanges[0],nd))}function ia(){this.totalRequests=this.errors=this.nonContinuous=this.divergence=this.adjusted=this.adjustedDidntChange=0}function W(T,Oa,Ib){this.tMa=null;this.ta=T;this.GGb=Oa.ya.MergeSuspensionRequestThrottlingTimeInMs;var hc=Oa.ya.GetRangeContentPrefetchDelayForMergeInMs;this.Xu=function(){Oa.aKd(hc)};this.Pg=(void 0===Ib?null:Ib)||Le.a.Ra;this.MMb=0;return this}function R(){}function I(T,Oa,Ib,hc,nd){this.tMa=null;this.Jzd=0;this.ta=T;this.GGb=
Oa.ya.MergeSuspensionRequestThrottlingTimeInMs;var Td=Oa.ya.GetRangeContentPrefetchDelayForMergeInMs;this.Xu=function(){Oa.aKd(Td)};this.Pg=(void 0===Ib?null:Ib)||Le.a.Ra;this.MMb=0;this.aO=void 0===hc?null:hc;this.Bma=void 0===nd?null:nd}function Q(T,Oa,Ib,hc,nd,Td,Ed){Ed=T.Oa(1,void 0===Ed?null:Ed);Ed.suspensionStartTimestamp=Oa;return Rd.i(T,"KeepBlockingPendingMerges",Ed,Ib,hc,nd,Td,0)}function O(T,Oa,Ib,hc,nd,Td,Ed){Ed=T.Oa(1,void 0===Ed?null:Ed);Ed.viewportState=Oa;return Rd.i(T,"DoPendingMergeWithSelectionAdjust",
Ed,Ib,hc,nd,Td,0)}function ba(T,Oa,Ib,hc,nd,Td){Td=T.Oa(1,void 0===Td?null:Td);return Rd.i(T,"DoPendingMerge",Td,Oa,Ib,hc,nd,0)}function ca(){}function S(T){var Oa=Ge.call(this)||this;Oa.t1=null;Oa.vhc=0;Oa.sBa=function(Ib,hc){var nd;if(null===(nd=null===hc||void 0===hc?void 0:hc.yd)||void 0===nd?0:nd.MergeCount)Me.a.equals(hc.yd.SessionId,Oa.$.fa.sessionId,!1)?Oa.WNa(hc.yd.MergeCount,S.L5c):Bc.ULS.sendTraceTag(579737049,0,50,"Stale merge counter ({0}/{1})",hc.yd.MergeCount.Current,hc.yd.MergeCount.Pending)};
Oa.JAb=function(Ib,hc){(null===hc||void 0===hc?0:hc.Cba)&&Oa.WNa(hc.Cba,S.BXd)};Oa.Ftc=function(){Oa.rPf();Oa.vHf(Oa.t1)};Oa.l8a=function(Ib,hc){hc.eye&&Oa.t1.SuspensionStartTimestamp&&Bc.ULS.sendTraceTag(17318084,0,50,"PendingMergeMonitor.OnEditCellEnded: committed with counter {0}",ma(Oa.t1))};Oa.rPf();Oa.$=T;Oa.$.qa.us(Oa.sBa);Oa.$.fa.Sj(Oa.Ftc);Oa.$.fa.aP(Oa.Ftc);Hf.g(Oa.$).Kc.hq(Oa.l8a);Oa.$.da.Za(292,function(Ib){Ib.mmb(Oa.JAb);Bc.ULS.sendTraceTag(588276809,0,50,"PendingMergeMonitor initialized")});
return Oa}function Y(T,Oa,Ib){var hc=oe.call(this)||this;hc.xCb=function(nd,Td){nd=hc.getState();var Ed=hc.u5;hc.u5=Td.Cba;Td=hc.getState();hc.Nni(nd,Td,Ed);hc.raiseEvent(Y.bud);hc.NQe(nd,Td)};hc.ZNa=function(nd,Td){nd=hc.getState();hc.oH=Td.oH;Td=hc.getState();hc.NQe(nd,Td)};hc.jha=T;hc.jha.UXb(hc.ZNa);hc.s9a=Oa;hc.s9a.mmb(hc.xCb);hc.u5=Object.assign(new fc.a,{Pending:0,Current:0,SuspensionStartTimestamp:null});hc.oH=hc.p3h();hc.Wfh=Ib;hc.ywh=te.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FixMergeSuspensionCheck",
!1);return hc}function na(T){var Oa=Yc.call(this)||this;Oa.kwa=T;return Oa}function Z(T){return(null===T||void 0===T?void 0:T.SuspensionStartTimestamp)&&T.Pending>T.Current}function wa(T,Oa){return T||Oa?T&&Oa?T.Current===Oa.Current&&T.Pending===Oa.Pending&&T.SuspensionStartTimestamp===Oa.SuspensionStartTimestamp:!1:!0}function ma(T){return T?String.format("{0} / {1} @{2}",T.Current,T.Pending,T.SuspensionStartTimestamp):null}function pa(T,Oa){var Ib=Vb.call(this)||this;Ib.statusBarManager=null;Ib.Cvd=
!1;Ib.xCb=function(hc,nd){hc=String.format("{0}{1}",nd.Cba.Current===nd.Cba.Pending?"\u26ad":"\u26ae",nd.Cba.Current);Me.a.equals(Ib.ekc,hc,!1)||(Ib.ekc=hc,Ib.gz())};Ib.ZNa=function(hc,nd){hc=nd.oH;Ib.Cvd!==hc&&(Ib.Cvd=hc,Ib.gz())};Ib.mergeSuspensionManager=Oa;Ib.mergeSuspensionManager.s9a.mmb(Ib.xCb);Ib.ekc="";aa.a.a2(1905775613,ea.a.Jc,0,1);Ib.Ka=T.Ka;Ib.uLb=new Ia;T.da.Za(29,function(hc){Ib.mergeSuspensionManager&&(Ib.statusBarManager=hc,hc.$I(Ib),Ib.mergeSuspensionManager.jha.UXb(Ib.ZNa))});Ib.Ka.b2(Ib.uLb);
return Ib}function Ia(){return ab.call(this)||this}function Ma(T,Oa){Oa=void 0===Oa?null:Oa;var Ib=H.call(this)||this;Ib.zpa=!1;Ib.fN=function(){Ib.refresh()};Ib.zsf=function(){Ib.refresh()};Ib.$=T;Ib.l5d=Oa||ha.a(T).gQ(K.a.idle);ha.a(T).$Sc(Ib.zsf);Ib.h4a.iq(Ib.fN);Ib.refresh();return Ib}function ob(){var T=pc.call(this)||this;T.Cgf=null;T.eQa=new cg.a;return T}function Cb(T,Oa){this.handler=null;this.publisher=T;this.oH=Oa}function Xa(T){var Oa=lc.call(this)||this;Oa.zpa=!1;Oa.urf=function(){Oa.refresh()};
Oa.vrf=function(){Oa.refresh()};Oa.gridView=Hf.g(T);Oa.gridView.Kc.wm(Oa.vrf);Oa.gridView.Kc.hq(Oa.urf);Oa.refresh();return Oa}function Sb(T){return xe.call(this,T)||this}function Tb(T){this.$=T}function da(T,Oa,Ib,hc,nd,Td){var Ed=Lb.call(this,null,Ib,hc)||this;Ed.Qjf=0;Ed.iIi=function(he){ch.a(he)?Bc.ULS.sendTraceTag(537155799,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded with errors. Errors: {0}",Ec.a.Uc(he.Errors)):(Bc.ULS.sendTraceTag(537155801,0,50,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess: Operation succeeded."),
he.Result?jh.a(Ed.$).zma(1,he.Result):Bc.ULS.sendTraceTag(537155800,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadSuccess:Result.result is null"))};Ed.hIi=function(){Bc.ULS.sendTraceTag(537155798,0,10,"OnlinePictureUploaderWrapper.OnPictureUploadFailed: Operation failed")};Ed.$=T;Ed.ee=Oa;Ed.t0=Td;Ed.Bne=dg.a.instance.mc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");Ed.showDialog();return Ed}function ya(T,Oa,Ib,hc,nd,Td){var Ed=ic.call(this)||this;Ed.afc=!1;Ed.Gva=null;Ed.kR=
null;Ed.GMa=null;Ed.Ezi=function(){Ed.Lta(Ed.Tnb)};Ed.Tpd=function(he){he.keyCode===Sys.UI.Key.tab&&("KeepFocusDiv"!==he.target.id||he.shiftKey?"KeepFocusStartDiv"===he.target.id&&he.shiftKey&&(he.preventDefault(),document.getElementById("KeepFocusDiv").focus()):(he.preventDefault(),document.getElementById("KeepFocusStartDiv").focus()))};Ed.rGi=function(){Ed.Nmb&&(Ed.Nmb.launchUpsellExperience("stockimages"),Bc.ULS.sendTraceTag(537155807,0,50,"OnLaunchM365Upsell: Launched Dime Upsell flow"))};Ed.Xn=
Td;Ed.$=T;Ed.v8e=Oa;Ed.Nmb=Ib;Ed.Cza=[];Ed.kmf=hc;Ed.bah=nd;Ed.Wme=Ed.$.ya.InsertOnlinePictureMaxCountOfImagesToInsert;Ed.xf=Ed.x2g();return Ed}function hb(){}function Gb(T,Oa){return h.call(this,T,ye.a.maa(Oa))||this}function Qb(T,Oa,Ib,hc,nd,Td,Ed){T=Fb.call(this,T,Oa,Ib,hc,nd,!1)||this;T.lWd=!1;T.t0=Ed;T.Scc=Qb.fAh(Td);if(Td=T.LWd(T.Scc.name,T.Scc.size))return T.G_f(Td),T.t0.setException(Error.create("DataUrlUploaderWrapper: Invlid data url")),T.dispose(),T;T.Cj=new sa(T.$.domElement,Object(mc.a)(T,
T.mDb,"onUploadFrameInitialized"),Object(mc.a)(T,T.aoa,"uploadResponseReceived"),hc,!1,T.$);return T}function Fb(T,Oa,Ib,hc,nd,Td){Td=void 0===Td?!0:Td;var Ed=Lb.call(this,null,Ib,hc)||this;Ed.lr=null;Ed.M$=null;Ed.Fyb=!1;Ed.dBd=null;Ed.aoa=function(he){Ed.AXd.stop();Ed.sZb.cancel();if(sa.rai(he))Ed.fyc?Ed.H2e(4):(he=new fh.a(0,2,null,null,!1,null,null,null),he.status=8,Ed.XTd(new If.a(he),null,"InsertPictureWebMethod")),Bc.ULS.sendTraceTag(537155796,0,50,"Http Error occurred, isTimeoutError: {0}",
Ed.fyc);else{var Pe=Fb.uNj(he);Pe?(Bc.ULS.sendTraceTag(537155797,0,50,"Server returned error, response: {0}",he),Ed.H2e(Pe)):Ed.OYh(he)}Ed.Rmc();Ed.dispose()};Ed.FCi=function(he){Ed.jBa(he,Ed.Cj)&&Ed.finalizeUpload(Ed.Cj,null)};Ed.mDb=function(he){Bc.ULS.sendTraceTag(537155795,0,50,"Upload frame initialized");Ed.Cj=he;if(!Ed.m0a){if(Ed.lWd){if(Fb.xte()||Ed.C7a&&$e.a.ME){he.i5b(Ed.FCi);return}var Pe=he.i5b(null);if(!Ed.jBa(Pe,he))return}Ed.finalizeUpload(he,null)}};Ed.KLi=function(){Ed.fyc=!0};Ed.vb=
T;Ed.ee=Oa;Ed.AXd=T.Ub.Xh("WebServiceCall","InsertPictureOperation");Ed.sZb=qi.a.instance.create(Ed.KLi,1E5,Ch.a.MQi,!1);Ed.fyc=!1;Ed.Atd=Ed.$.ya.InsertPictureMaxFileSizeBytes;nd&&(Ed.Fyb="TestOnly"in nd);Td&&Ed.showDialog();return Ed}function ta(T,Oa){this.dataUri=this.sheetName=null;this.sheetName=T;this.dataUri=Oa}function xa(T,Oa,Ib){var hc=Fa.call(this,T,!1)||this;hc.tU=null;hc.qAa=!1;hc.ZQ=function(){hc.qVd("");hc.dzc();return!1};hc.$=Oa;hc.gAc=T;hc.Iu=ra.a.instance;hc.ga=Ib;hc.jXf();hc.bV();
hc.$.Ab.XJ=!0;return hc}function sa(T,Oa,Ib,hc,nd,Td,Ed){T=lb.call(this,T,Oa,Ib,hc,nd,"UploadFrame",Td.fa.sessionId,"image/*",!1,null,void 0===Ed?!1:Ed)||this;T.$=Td;T.Gag=!0;te.EwaSettings.isChangeGateEnabled("OfficeVSO:5329840_InsertPictureOpenFileBrowserDirectly")?T.j8e():T.Wne();return T}function lb(T,Oa,Ib,hc,nd,Td,Ed,he,Pe,hf,pg){Pe=void 0===Pe?!0:Pe;pg=void 0===pg?!1:pg;this.UPe="FileUpload.ashx";this.Ln=null;this._initialized=!1;this.Jg=this.ehb=this.jGc=this.Wfa=this.KQb=this.Iq=this.gs=
null;this.sm=!1;this.nD=this.LQb=this.HQc=null;this._parent=T;this.Vlg=Oa;this.rqg=Ib;this.m4d=nd;this.FOc=Ed;this.hZd=he;this.h0d=void 0===hf?null:hf;this.GQc=!1;this.mmg=hc.ra("CanaryRenewalForFileUploadIsEnabled");this.Gag=!1;(this.aqa=pg)||this.F_g(Td);Pe&&this.j8e()}function Yb(T,Oa,Ib){if(T){var hc=0;do{try{T();break}catch(nd){if(Bc.ULS.sendTraceTag(50946190,306,10,"RetryOnException: [Retries: {0}] [Caller: {1}] [Exception: {2}] [Callstack: {3}].",hc,Ib,nd.message,nd.stack),hc>=Oa)break}hc++}while(1)}}
function Fa(T,Oa){return Ra.call(this,T,void 0===Oa?!0:Oa)||this}function Sa(){}function Ra(T,Oa){Oa=void 0===Oa?!0:Oa;var Ib=Ca.call(this,!1,!1,Ra.gy)||this;Ib.$Va=null;Ib.I3d=!1;Ib.Vm=[];Ib.Cj=null;Ib.QVb=T;Ib.frg=Oa;Ib.qfe=!1;Ib.gu=!1;Ib.Wfa=null;Ib.kGc=!1;Ib.xf=Ib.aah;Ib.Me="InsertFileDialog";Ib.Cc(1,Ib.qWb);if(Ra.gy){T={};Oa={};var hc={};Ib.$Va=(hc.id=Ib.Me,hc.bodyControls=(Oa.uploadButtonProps=(T.label=CommonUIStrings.l_DialogChooseFile,T.onExecute=Object(mc.a)(Ib,Ib.oMi,"onUploadButtonClick"),
T),Oa),hc.uploadStatusLabel=CommonUIStrings.l_DialogNoFileChosen,hc.onFrameReady=Object(mc.a)(Ib,Ib.eDi,"onFrameReady"),hc);Ib.initializeAndShow(Ib.titleText,Object(mc.a)(Ib,Ib.vdc,"insertDialogHandler"),Ib.$Va);Ib.lQb=!0}else Ib.showDialog(Ib.titleText,Object(mc.a)(Ib,Ib.vdc,"insertDialogHandler")),Oa&&Ib.jXf(),(T=Ib.CU(1))&&Ib.Vm.push(T),(T=Ib.CU(0))&&Ib.Vm.push(T),Ib.s$f(),Ib.lQb=!1;return Ib}function Lb(T,Oa,Ib){T=Ja.call(this,T,Oa,Ib)||this;T.Oqa=null;T.tTb=null;return T}function Ja(T,Oa,Ib){this.Cj=
this.Bzd=null;this.iEa=this.sqa=0;this.MQb=null;this.nS=T;this.je=Oa;this.ub=Ib;this.m0a=!1;this.lWd=!0;this.L9i();this.C7a=this.ga.ra("NativeFileOpenDialogIsEnabled")}function xb(T,Oa){this.filename=T;this.blob=Oa}function Kb(T){var Oa=df.call(this)||this;Oa.Xid=null;Oa.$=T;Oa.dc();return Oa}function Eb(T){var Oa=ke.call(this)||this;Oa.$=T;Oa.dc();return Oa}function Hc(T,Oa){this.bRe=T;this.rwh=Oa}function Xc(T){this.$=T}function Pc(T){var Oa=hd.call(this)||this;Oa.$=T;Oa.dc();return Oa}function wd(T,
Oa,Ib){var hc=Dc.call(this)||this;hc.statusBarManager=null;hc.oFe=function(){hc.L4b()};hc.Iah=function(){hc.L4b()};hc.nFe=function(nd){10===nd&&hc.L4b()};hc.onKeyDown=function(nd){if(13===nd.Ea.keyCode){nd=new wf.a(237279923,1,2,6,null);var Td={};hc.$.Ka.Zb(nd,(Td[ce.a.skipClipboardAccess]=!0,Td[ce.a.lJe]=!0,Td));return!0}return!1};hc.$=T;hc.Et=Oa;hc.nk=Ib;hc.U6c=!1;hc.FZf=te.EwaSettings.getBooleanFeatureGate(Bd.a.QOa,!1);hc.FZf&&hc.$.da.Za(29,function(nd){hc.statusBarManager=nd;nd.$I(hc)});return hc}
function Tc(T){var Oa=ii.call(this)||this;Oa.$=T;Oa.Om=Og.a.instance;Oa.dc();return Oa}function ub(T){var Oa=this;this.B3b="";this.U1=this.Cr=null;this.voc=!1;this.m5e=function(Ib,hc){Oa.hide(void 0===Ib?null:Ib,void 0===hc?null:hc)};this.gridView=Hf.g(T);this.gridView.ha.jG(this.m5e)}function fb(){}function Ta(T,Oa){var Ib=Pg.call(this,T)||this;Ib.Jo=null;Ib.i6h=function(hc,nd){1===hc?(hc=Ta.zah[nd[Ta.yah]],Bc.ULS.sendTraceTag(537167683,0,50,"InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler OK button pressed with valid input, shift direction = {0}",
hc?"Vertical":"Horizontal"),Ib.Jo.setResult(hc)):(Bc.ULS.sendTraceTag(537167682,0,50,"InsertCopiedCutCellsDialog.InsertCopiedCutCellsDialogHandler cancel button pressed"),Ib.Jo.Qt())};Ib.Kh(Oa);return Ib}function eb(T){this.dDc=this.nNc=null;this.$=T}function tb(){}function rc(){}function wb(){}function E(){}function Mb(T){this.c1c=this.ssa=null;this.p9a=15;this.$=T}function ka(T,Oa){this.$=T;this.gnb=Oa}function bb(T,Oa,Ib,hc){T=pb.call(this,T)||this;T.isFromCurrentSession=!1;T.top=0;T.left=0;T.isFromCurrentSession=
Oa;T.top=Ib;T.left=hc;return T}function Ga(T,Oa,Ib,hc,nd){nd=void 0===nd?null:nd;var Td=Ba.call(this,T,"ArtCopyPasteHandler")||this;Td.EUg="XLO";Td.FUg="3";Td.fU=new dc(T);Td.U9=Oa;Td.oYa=Ib;Td.ha=Hf.g(T).ha;Td.e1c=nd||new Wa(Td.U9);Td.UPi=new Ha(Ib,T);Td.gnb=hc;return Td}function Ha(T,Oa){this.FGb=new rb.a;this.oYa=T;this.$=Oa;this.yVi=function(Ib){return Promise.resolve(Ib)};this.MCb=function(Ib){return Promise.reject(Ib)}}function Ua(T,Oa,Ib,hc,nd,Td,Ed,he,Pe){this.promise=null;this.ribbonCommandInfo=
T;this.destination=Oa;this.yEe=Ib;this.wWd=nd;this.h0=Td;this.item=Ed;this.pasteContext=he;this.YMa=Ib||Oa.FirstRow+"_"+Oa.FirstColumn;this.nbf=!0;this.Cwe=Pe}function kb(T,Oa,Ib,hc,nd,Td,Ed){this.floatingObjectId=T;this.commandParameters=Oa;this.lr=Ib;this.h7g=hc;this.J3=void 0===Td?null:Td;this.wWd=void 0===Ed?null:Ed;this.JZg=nd}function $a(T,Oa,Ib,hc){Oa=Za.call(this,T,Oa,Ib,"AcrossSessionRangeCopyPasteHandler",void 0===hc?null:hc)||this;Oa.fU=new dc(T);return Oa}function Xb(T,Oa){Oa=void 0===
Oa?null:Oa;var Ib=lh.call(this,oh[T])||this;Ib.copyErrorName=0;Ib.ewaErrors=null;Ib.copyErrorName=T;Ib.ewaErrors=Oa;if(null===Oa||void 0===Oa?0:Oa.length)Ib.innerError=new sg.a(Oa,null);return Ib}function dc(T){this.fU=new Jg.a(!0);this.$=T}function Za(T,Oa,Ib,hc,nd){nd=void 0===nd?null:nd;hc=Ba.call(this,T,hc)||this;hc.TZg=Oa;hc.U9=Ib;hc.f1c=nd||new Wa(hc.U9);hc.gridView=Hf.g(T);hc.ha=hc.gridView.ha;hc.clipboardRangeFactory=T.da.Aa(169);return hc}function Wa(T){this.clipboardItems=this.key=null;
this.U9=T}function Ba(T,Oa){this._name=Oa;this.$=T;this.Om=Og.a.instance;this.Er=new uc(T,Hf.g(T))}function db(T){return T.shadowWorkbookSizeExceedsLimit?!0:Zb(T)>bf.a.gjc}function Zb(T){return T?T.shadowWorkbookSizeExceedsLimit&&void 0!==T.shadowWorkbookBlockedSize&&null!==T.shadowWorkbookBlockedSize?T.shadowWorkbookBlockedSize:T.shadowWorkbookBase64?T.shadowWorkbookBase64.length:0:0}function Jb(){}function Ic(T){var Oa={};this.V2f=(Oa["SourceItemType.Range"]=0,Oa["SourceItemType.Art"]=1,Oa);this.mKb=
{};Oa={};this.R2f=(Oa["FloatingObjectType.Unknown"]=99,Oa["FloatingObjectType.CardView"]=6,Oa["FloatingObjectType.Chart"]=0,Oa["FloatingObjectType.Group"]=7,Oa["FloatingObjectType.Image"]=1,Oa["FloatingObjectType.Ink"]=8,Oa["FloatingObjectType.InteractiveReport"]=4,Oa["FloatingObjectType.ModernOfficeExtension"]=3,Oa["FloatingObjectType.Shape"]=5,Oa["FloatingObjectType.Slicer"]=2,Oa["FloatingObjectType.Unsupported"]=100,Oa);Oa={};this.mVc=(Oa["99"]="FloatingObjectType.Unknown",Oa["6"]="FloatingObjectType.CardView",
Oa["0"]="FloatingObjectType.Chart",Oa["7"]="FloatingObjectType.Group",Oa["1"]="FloatingObjectType.Image",Oa["8"]="FloatingObjectType.Ink",Oa["4"]="FloatingObjectType.InteractiveReport",Oa["3"]="FloatingObjectType.ModernOfficeExtension",Oa["5"]="FloatingObjectType.Shape",Oa["2"]="FloatingObjectType.Slicer",Oa["100"]="FloatingObjectType.Unsupported",Oa);Oa={};this.U2f=(Oa["RibbonCommand.Copy"]=-911352779,Oa["RibbonCommand.Cut"]=-1985798686,Oa);Oa={};this.hJd=(Oa["-911352779"]="RibbonCommand.Copy",Oa["-1985798686"]=
"RibbonCommand.Cut",Oa);Oa={};this.T2f=(Oa["InputManager.InputMethod.NotDefined"]=-1,Oa["InputManager.InputMethod.Unknown"]=0,Oa["InputManager.InputMethod.Keyboard"]=1,Oa["InputManager.InputMethod.Mouse"]=2,Oa["InputManager.InputMethod.Touch"]=3,Oa["InputManager.InputMethod.CrossSlide"]=9,Oa);this.Nja={};Oa={};this.S2f=(Oa["FrameMode.None"]=0,Oa["FrameMode.Reading"]=1,Oa["FrameMode.Edit"]=2,Oa);this.U1a={};Oa={};this.W2f=(Oa["UILocation.Unknown"]=0,Oa["UILocation.UpperRibbon"]=1,Oa["UILocation.Ribbon"]=
2,Oa["UILocation.QAT"]=3,Oa["UILocation.Jewel"]=4,Oa["UILocation.NavigationPane"]=5,Oa["UILocation.KeyboardShortcut"]=6,Oa["UILocation.StatusBar"]=7,Oa["UILocation.Dialog"]=8,Oa["UILocation.Floatie"]=9,Oa["UILocation.NotificationBar"]=10,Oa["UILocation.StandaloneCuiRoot"]=11,Oa["UILocation.TaskPane"]=12,Oa["UILocation.HeroDock"]=13,Oa["UILocation.SingleLineRibbon"]=14,Oa["UILocation.MultilineRibbon"]=15,Oa["UILocation.Overflow"]=16,Oa["UILocation.TellMe"]=17,Oa["UILocation.FarPeripheralControls"]=
18,Oa["UILocation.ContextMenu"]=19,Oa["UILocation.DialogMenu"]=20,Oa["UILocation.Header"]=21,Oa["UILocation.FileMenu"]=22,Oa["UILocation.Toolbar"]=26,Oa["UILocation.Canvas"]=30,Oa);this.rr={};this.$=T;this.Nja.notDefined="InputManager.InputMethod.NotDefined";this.Nja.unknown="InputManager.InputMethod.Unknown";this.Nja.keyboard="InputManager.InputMethod.Keyboard";this.Nja.mouse="InputManager.InputMethod.Mouse";this.Nja.touch="InputManager.InputMethod.Touch";this.Nja.crossSlide="InputManager.InputMethod.CrossSlide";
this.U1a.none="FrameMode.None";this.U1a.reading="FrameMode.Reading";this.U1a.edit="FrameMode.Edit";this.rr.unknown="UILocation.Unknown";this.rr.upperRibbon="UILocation.UpperRibbon";this.rr.ribbon="UILocation.Ribbon";this.rr.QAT="UILocation.QAT";this.rr.jewel="UILocation.Jewel";this.rr.navigationPane="UILocation.NavigationPane";this.rr.keyboardShortcut="UILocation.KeyboardShortcut";this.rr.statusBar="UILocation.StatusBar";this.rr.dialog="UILocation.Dialog";this.rr.floatie="UILocation.Floatie";this.rr.notificationBar=
"UILocation.NotificationBar";this.rr.standaloneCuiRoot="UILocation.StandaloneCuiRoot";this.rr.taskPane="UILocation.TaskPane";this.rr.heroDock="UILocation.HeroDock";this.rr.singleLineRibbon="UILocation.SingleLineRibbon";this.rr.multilineRibbon="UILocation.MultilineRibbon";this.rr.overflow="UILocation.Overflow";this.rr.tellMe="UILocation.TellMe";this.rr.farPeripheralControls="UILocation.FarPeripheralControls";this.rr.header="UILocation.Header";this.rr.fileMenu="UILocation.FileMenu";this.rr.contextMenu=
"UILocation.ContextMenu";this.rr.dialogMenu="UILocation.DialogMenu";this.rr.toolbar="UILocation.Toolbar";this.rr.canvas="UILocation.Canvas";this.mKb.range="SourceItemType.Range";this.mKb.art="SourceItemType.Art"}function uc(T,Oa){this.nhc=this.qMa=null;this.mec=te.EwaSettings.getBooleanFeatureGate(Bd.a.j3b,!1);this.tkd=te.EwaSettings.isChangeGateEnabled("OfficeVSO:6024798_AbortOutstandingCopyOperation");this.HLa=te.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CopyPasteWFEIncreasedLimits",
!1);this.$=T;this.gridView=Oa;this.Dfc=te.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeHideCutCopyHighlight",!1);this.tkd&&(this.$.userOperationManager.uy(Object(mc.a)(this,this.aF,"onQueueChanged")),this.Su=new cg.a)}function za(T){this.parameters=null;this.parameters=T}function pb(T){this.pasteParameters=null;this.pasteParameters=T}function cc(T,Oa){this.content=this.destinationRange=null;this.destinationRange=T;this.content=Oa}function Ac(T,Oa,Ib){this.destinationRange=this.sourceRange=
null;this.pasteFlags=0;this.sourceRange=T;this.destinationRange=Oa;this.pasteFlags=Ib}function ad(T,Oa,Ib,hc,nd,Td,Ed,he){he=void 0===he?null:he;Ed=T.Oa(1,void 0===Ed?null:Ed);Ed.pasteParameters=Oa;return Rd.i(T,"Paste",Ed,Ib,hc,nd,Td,64,he)}function Jd(T,Oa,Ib,hc,nd,Td,Ed,he){he=void 0===he?null:he;Ed=T.Oa(1,void 0===Ed?null:Ed);Ed.copyParameters=Oa;return Rd.i(T,"Copy",Ed,Ib,hc,nd,Td,0,he)}function Xd(T,Oa,Ib,hc,nd,Td,Ed,he,Pe){Pe=void 0===Pe?null:Pe;he=T.Oa(9,he);he.destinationRange=Oa;he.source=
Ib;return Rd.i(T,"PasteString",he,hc,nd,Td,Ed,64,Pe)}function od(T,Oa,Ib,hc,nd,Td,Ed,he){he=void 0===he?null:he;Ed=T.Oa(1,Ed);Ed.pasteHtmlParameters=Oa;return Rd.i(T,"PasteHtmlContent",Ed,Ib,hc,nd,Td,64,he)}function Je(){this.NZa=this.Fwe=null}function bc(T,Oa,Ib,hc,nd,Td,Ed,he,Pe){Pe=void 0===Pe?null:Pe;var hf=vc.call(this)||this;hf.pasteShortcutManager=null;hf.d$e=te.EwaSettings.gH();hf.HLa=te.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CopyPasteWFEIncreasedLimits",!1);hf.f5f=null;
hf.T5a=!1;hf.Kbf=te.EwaSettings.isChangeGateEnabled("OfficeVSO:6004791_MergedCellOverlapTelemetry");hf.Dyd=function(pg){hf.Aoj(pg)&&(hf.Er.Svb(),Bc.ULS.sendTraceTag(537167777,0,50,"CopyPasteInfrastructure.OnMetadataChanged: found that cut/copy operation was preformed in another session therefore removed the highlight in this session."))};hf.roi=function(pg,fg){Bc.ULS.sendTraceTag(537167768,0,50,"CopyPasteInfrastructure.LogShortcutDialogAndRestoreFocus: Got shortcut dialog, user pressed [{0}]. userPressedExtensionLink={1}",
pg,fg);hf.gridView.focus()};hf.od=function(pg,fg){fg.WJ||fg.Qg||hf.Hv("OnWorkbookOpened",!1).catch(function(){})};hf.Yh=function(pg,fg){pg=Jf(hf.fK);var Xg=hf.Er.Fub(pg);Xg&&(fg.oa&&fg.oa.sheetName===Xg.sheetName&&Xg.isFromCurrentSession(hf.$)?hf.Er.K5e(Xg.ranges,pg.commandParameters.commandType):hf.Er.Svb())};hf.Ilc=function(pg,fg){pg=Jf(hf.fK);(pg=hf.Er.Fub(pg))&&fg.item&&fg.item.sheetName===pg.sheetName&&pg.isFromCurrentSession(hf.$)&&hf.Hv("OnItemDeleting",!1).catch(function(){})};hf.dDb=function(pg,
fg){hf.d$e?hf.f5f(pg,fg):hf.Zzf()};hf.cR=function(pg,fg){1===fg.Wx&&fg.Sg.operation.flags&2&&hf.Hv("OnQueueItemChanged/ItemRemoved",!1).catch(function(){})};hf.$=T;hf.hi=Ib;hf.gridView=Hf.g(T);hf.Er=nd;hf.h6h=Td;hf.fK=Oa;hf.p2b=hc;hf.getStringifiedError=Pe||copyPasteInfra.getStringifiedError;hf.DZf=1===he;hf.ak();hf.copyPasteShortcutDialogFactory=hf.$.da.Aa(85);Bc.ULS.shipAssertTag(537167825,0,!!hf.copyPasteShortcutDialogFactory,"CopyPasteInfrastructure.ctor: this.copyPasteShortcutDialogFactory shouldn't be null.");
Ed||(Bc.ULS.sendTraceTag(537167824,0,50,"CopyPasteInfrastructure.ctor: userId is null, using default userId."),Ed=bc.$8g);hf.userHash=Ze.a.lu(Ed);hf.Bsi="CultureTag: "+Og.a.instance.Jqb+" HASH: ";hf.fK.addMetadataChangeListener(bc.Cmf,hf.Dyd);hf.Ctd=hf.$.ya.MaxCopyPasteLength;hf.dNa=hf.HLa?te.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.CopyPasteHtmlImportMaxLength",hf.$.ya.CopyPasteMaxPayloadLength):bf.a.dNa;hf.fo=te.EwaSettings.getBooleanFeatureGate(Bd.a.QOa,!1);hf.fo&&T.da.Za(478,function(pg){hf.pasteShortcutManager=
pg});hf.d$e&&(hf.f5f=md.a(function(){hf.Zzf()},1,hf.$.ma,"CopyPasteInfrastructure.OnStartEditInternal",!0));return hf}function Qd(T){if(!T)return"null";var Oa=[];T=yl(T.get());for(var Ib=T.next();!Ib.done;Ib=T.next())Ib=Ib.value,Ib=String.format("{0}({1})",Ib.clipboardDataFormat,Ib.data.length),Array.add(Oa,Ib);Oa.sort();return Oa.join(",")}function Vd(T){switch(T){case 0:return"None";case 2:return"Art";case 1:return"Range";default:return"Unknown"}}function de(T,Oa){return T?Oa&&Oa.ya?T.sessionId!==
Oa.ya.UserSessionId:(Bc.ULS.shipAssertTag(537166209,0,!1,"ewaControl shouldn't be null"),!1):(Bc.ULS.shipAssertTag(537166210,0,!1,"copyContext shouldn't be null"),!1)}function pe(){}function Ad(){}function Pd(){}function Ce(T,Oa,Ib,hc){this.$=T;this.originalDestinations=Oa;this.l7b=Ib;this.dgg=hc;this.Xpg=this.originalDestinations;this.Ujg=this.l7b;this.lng="PasteRecoveryUI"}function Jf(T){return T&&(T=T.getCachedMetadata(),null===T||void 0===T?0:T.lastCopy)?T.lastCopy:null}function oc(T){return T.clipboardItems&&
(T=T.clipboardItems.getItem(gb.Q9h))&&"1"===T?!0:!1}function ed(T){return wc(T)&&!(void 0===T.clipboardItems||null===T.clipboardItems)&&!!T.clipboardItems.getItem(gb.png)&&!T.clipboardItems.getItem(gb.VV)}function wc(T){return T.clipboardItems&&(T=T.clipboardItems.getItem(gb.hci))&&"1"===T?!0:!1}function gb(){}function id(){}function ib(T){return!!T&&Object.getType(T)===nc}function nc(T,Oa,Ib,hc,nd){hc=mb.call(this,hc,nd)||this;Bc.ULS.shipAssertTag(537167645,0,!!Oa&&0<Oa.length,"RangeSourceItem.ctor: ranges should not be null or empty");
hc.$=T;hc.ranges=Oa;hc.sheetName=Ib;return hc}function Nb(T,Oa,Ib,hc,nd){Ib=mb.call(this,Ib,hc)||this;Ib.activeFloatingObjectControlId=T;Ib.sheetName=Oa;Ib.type=nd;return Ib}function mb(T,Oa){var Ib=this;this.Uzh=function(){var hc={};hc.SourceItem=Ib.toString();return hc};this.sessionStateId=T;this.sessionId=Oa;this.toJSON=this.Uzh}function Lc(T,Oa,Ib,hc,nd){var Td=T.Stopwatch,Ed={};Ed.a=nd;Ed.e=Td.id;Ed.c="RearrangeRowColumn";Ed.b="mouse";Ed.d=T.OperationId.toString();Ed.f=Ib.toString();Ed.g=hc.toString();
Ed.h=Oa.toString();Ed.i=T.DragDropIsShiftKeyDown;Ed.j=!0;Ed.o=Td.Ac;Ed.q=!1;Ed.r=T.CopyPasteTargetType.toString();Ed.s=T.EncounteredDeploymentErrors;return Ed}function zd(T){T=mf.call(this,T)||this;T.DUg=function(){Bc.ULS.sendTraceTag(537167827,0,50,"ClipboardReadPermissionAskDialog OK button pressed")};Bc.ULS.sendTraceTag(537167828,0,50,"ClipboardReadPermissionAskDialog.ClipboardReadPermissionAskDialog");T.kc=0;T.Cc(1,Og.a.instance.ea(2184));var Oa=Og.a.instance.ea(2182),Ib=T.MU();T.initializeAndShow(Oa,
T.DUg,Ib);return T}function jd(){this.rb=null}function ge(){this.khb=this.RQb=this.vv=null}function Yd(T,Oa,Ib,hc,nd){this.vv=T;this.xhb=Oa;this.thb=Ib;this.gbe=void 0===hc?null:hc;this.Fjb=void 0===nd?null:nd}function rd(){this.rb=null}function je(T){this.hc=T}function re(){this.Zfe=0;this.BVa=Array(5);this.BVa[0]=10;this.BVa[1]=15;this.BVa[2]=50;this.BVa[3]=100;this.BVa[4]=200}function ae(T,Oa,Ib,hc,nd){this.Q8b=!1;this.Sqb=null;this.La=T;this.PWa=Oa;this.cUb=Ib;this.W0=hc;this.WCc=nd}function Uf(){this.LKf=
this.EPf=this.t4f=this.Ghc=this.instance=null}function Lf(T,Oa,Ib){this.La=T;this.Ie=Oa;this.sRb=Ib}function Of(){this.completed=this.g2i=!1}function Yf(){this.vee=this.J9d=this.i_d=!0;this.I7i=this.kRi=null;this.kui=!1;this.locale=null;this.Y7f={}}function vg(){}function Af(){this.ATb=this.QQb=null}function rf(T){return Re.call(this,T)||this}function Cg(){this.rb=null}function sc(T,Oa){if(void 0===T||null===T||void 0===Oa||null===Oa)throw Error.argumentNull("appSettingsManager/clientRequestManager");
this.ub=T;this.Og=Oa;this.IOc=this.xe=null}function Rc(){this.zGe=this.Pag=this.ot=0;this.AGe=this.Qag=this.QGa="";this.tPc=this.aea=2}function Qc(T,Oa){this.cEc=0;this.e1b=null;this.Jhb=new vd(T,Oa);this.ub=T;Oa=T.Ua("HostAuthType");this.ODa=T.ra("OcpsIsEnabled")&&T.ra("IsO365CommercialHost")&&!(void 0===Oa||null===Oa)&&"aad"===Oa.toLowerCase();this.H$d=ud.b(T.Ua("OcpsDefaultSettings")||"{}");this.zib=this.P$b();Oa=this.ub.Dy("ServicesControlsMicrosoftControllerServicesList")?this.ub.Tv("ServicesControlsMicrosoftControllerServicesList")||
[]:[];this.JPb=new Fd.a;for(var Ib=0;Ib<Oa.length;Ib++)this.JPb.add(Oa[Ib]);this.ODa&&!T.ra("IsAnonymousUser")&&T.ra("SideCarIsEnabled")?this.e1b=this.BFj():this.e1b=this.Nna(this.ODa,this.Aua("/afhs/CloudPolicySettings.ashx"),Object(mc.a)(this,this.nPi,"parseCloudPolicySettingsResponse"));this.e1b.then(function(){return null}).catch(function(hc){Bc.ULS.sendTraceTag(50622685,3004,10,JSON.stringify(hc))})}function ee(){this.ControllerConnectedServicesFeatureNames=this.PolicySettings=null}function ue(){}
function Ee(T,Oa){this.PolicySettings=null;this.ExpirationTime=0;this.PolicySettings=T.PolicySettings;T=new Date;T.setMinutes(T.getMinutes()+Oa);this.ExpirationTime=T.getTime()}function De(T,Oa,Ib,hc,nd){var Td=this;Ib=void 0===Ib?null:Ib;hc=void 0===hc?null:hc;nd=void 0===nd?null:nd;this.Pta=this.fUb=this.oce=this.Kpa=this.kVb=null;this.Jhb=new vd(T,Oa);this.ub=T;this.rng=T.zd("LicensingMaxRetryAttempts",0);this.gJc=T.ra("IsO365ConsumerHost");this.fJc=T.ra("IsO365CommercialHost");this.KRb=T.ra("PremiumUpsellIsEnabled");
this.G0d=Ib;this.Ege=hc;this.La=nd;this.Jpa=T.ra("LicensingIsEnabled");this.ODa=T.ra("OcpsIsEnabled")&&this.fJc;this.LQc=T.ra("ShowPrivacyDialog")&&!!hc;this.W5d=T.ra("IsAnonymousUser");this.f9c=new Promise(function(Ed){Ed(!1)});this.NAa=new Promise(function(Ed){Ed(!0)});this.Ota=new Ae.a(cb.a.Ik());this.XVb=this.ub.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SupportUserConsentBasedFeaturesInAFH",!1);this.w8d=this.KLh();this.dnd()&&!this.W5d?(void 0!==we.AFrameworkApplication.sa&&null!==
we.AFrameworkApplication.sa&&(this.kVb=we.AFrameworkApplication.sa.fD,void 0!==this.kVb&&null!==this.kVb&&(this.Kpa=this.kVb.Xh("WebServiceCall","ApplicationFeatureHelperService"))),this.Pta=this.pUd()):this.Pta=new Promise(function(Ed){Ed({})});this.Pta.catch(function(Ed){Bc.ULS.sendTraceTag(42513088,3004,10,JSON.stringify(Ed))});this.XVb&&(this.KRb=!1,this.isFeatureEnabled("FreemiumUpsell",!0).then(function(Ed){Td.KRb=Td.ub.ra("PremiumUpsellIsEnabled")&&Ed;return null}))}function ne(T,Oa,Ib){this.featureName=
null;this.isEnabled=!1;this.tierName=0;this.featureName=T;this.isEnabled=Oa;this.tierName=Ib}function gc(T,Oa){this.XCj=3E5;if(void 0===T||null===T||void 0===Oa||null===Oa)throw Error.argumentNull("appSettingsManager/clientRequestManager");this.ub=T;this.GOb=new Ae.a(cb.a.Ik());this.Jhb=new vd(T,Oa);void 0!==Zc.a.ysd&&null!==Zc.a.ysd&&void 0!==Zc.a.yic&&null!==Zc.a.yic&&0<Zc.a.yic&&(T=new fd,T.Token=Zc.a.ysd,T.ExpirationTime=Zc.a.yic,this.GOb.ia("loki",T))}function fd(){this.Token=null;this.ExpirationTime=
0}function vd(T,Oa){this.ub=T;this.Og=Oa}function se(){this.message=null;this.Gcc=0}b.r(D);var Jc=b(0),Bc=b(13),Ae=b(805),cb=b(574),mc=b(80),Oc=b(84),Sc;(function(T){T[T.applicationFeatureHelperHandler=0]="applicationFeatureHelperHandler";T[T.cloudPolicySettings=1]="cloudPolicySettings";T[T.alternateAuthToken=2]="alternateAuthToken"})(Sc||(Sc={}));Object(Jc.b)("ApplicationFeatureHelperRequestType",Sc);Object(Jc.a)(se,"HttpRequstToPromiseRejectData",null,[]);var $c=b(93),le=b(233);vd.prototype.g2c=
function(T,Oa,Ib,hc,nd,Td,Ed,he){var Pe=this;hc=void 0===hc?null:hc;nd=void 0===nd?null:nd;Td=void 0===Td?null:Td;Ed=void 0===Ed?null:Ed;he=void 0===he?null:he;var hf=Sc[Ib],pg=hf+"RequestFailure";$c.Health.instance.recordKpiUsage(pg,0,"jpittsdirects",null);return new Promise(function(fg,Xg){Bc.ULS.sendTraceTag(50622688,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Initializing HttpRequest {0}.",hf);var yg=null!=Ed?Ed:Pe.ub.zd("ApplicationFeatureHelperRequestQueueTimeout",15E3),
Rh=null!=he?he:Pe.ub.zd("ApplicationFeatureHelperRequestSentTimeout",3E4);Pe.Og.h9(T,1,null,Pe.qKh(Ib,hc),Td,!1,1,function(Kh){Bc.ULS.sendTraceTag(50622689,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} Succeeded.",hf);try{if(void 0===Kh||null===Kh||void 0===Kh.data||null===Kh.data||void 0===Kh.data.fe||null===Kh.data.fe){$c.Health.instance.recordKpiFailure(pg,"Invalid RequestSucceededEventArgs",!1,!0,null);var Yg=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data or args.Data.ResponseData is null or undefined request {0}",
hf);Xg(Pe.Gub(Yg,Kh))}else if(Kh.data.httpStatus!==le.a.sO){$c.Health.instance.recordKpiFailure(pg,"HttpStatusCode_"+Kh.data.httpStatus.toString(),!1,!0,null);var ji=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: ApplicationFeatureHelper Service token generation returned unexpected response code {0}, request {1}",Kh.data.httpStatus,hf);Xg(Pe.Gub(ji,Kh))}else{void 0!==nd&&null!==nd&&void 0!==Kh.data.responseHeaders&&null!==Kh.data.responseHeaders&&nd(Kh.data.responseHeaders);
var Di=Oa(Kh.data.fe);if(Di)Bc.ULS.sendTraceTag(50622690,3004,50,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: Successfully parsed response for request {0}",hf),fg(Di);else{$c.Health.instance.recordKpiFailure(pg,"Parse Failure",!1,!0,null);var Ei=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Failed to parse response for request {0}",hf);Xg(Pe.Gub(Ei,Kh))}}}catch(rh){$c.Health.instance.recordKpiFailure(pg,"Unexpected Failure",!1,!0,null),Yg=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Exception {0} for request {1}",
rh,hf),Xg(Pe.Gub(Yg,Kh))}},function(Kh){Bc.ULS.sendTraceTag(50622691,3004,10,"HttpRequestToPromiseUtility.CreateHttpResponsePromise: HttpRequest {0} failed.",hf);if(Kh.data){$c.Health.instance.recordKpiFailure(pg,"HttpStatusCode_"+Kh.data.httpStatus.toString(),!1,!0,null);var Yg=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: Request Failed: HttpStatus - {0}, ResponseData - {1} for Request - {2}",Kh.data.httpStatus,Kh.data.fe||"No Data",hf)}else $c.Health.instance.recordKpiFailure(pg,
"Invalid RequestFailedEventArgs",!1,!0,null),Yg=String.format("HttpRequestToPromiseUtility.CreateHttpResponsePromise: args or args.Data is null or undefined for request {0}",hf);Xg(Pe.Gub(Yg,Kh))},null,void 0,void 0,yg,Rh)})};vd.prototype.Gub=function(T,Oa){var Ib=new se;Ib.message=T;Ib.Gcc=Oa&&Oa.data?Oa.data.httpStatus:-1;return Ib};vd.prototype.qKh=function(T,Oa){var Ib={};Ib["x-UserDataSignature"]=this.ub.Ua("UserDataSignature");Ib["x-LicensingIsEnabled"]=this.ub.ra("LicensingIsEnabled").toString();
Ib["x-CacheIsEnabled"]=this.ub.ra("LicensingRedisIsEnabled").toString();Ib["x-OcpsIsEnabled"]=this.ub.ra("OcpsIsEnabled").toString();Ib["x-LicensingAADIdIsEnabled"]=this.ub.ra("LicensingAadIdIsEnabled").toString();T||(Ib["x-LicenseCheckOnTenantEnabled"]=this.ub.ra("LicensingForSafeLinksIsEnabled").toString(),Ib["x-SupportUserConsentDependentFeatures"]=this.ub.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SupportUserConsentBasedFeaturesInAFH",!1).toString(),Ib["x-AFHUserConsentGroupValue"]=
this.ub.getIntFeatureGate("Microsoft.Office.SharedOnline.AFHUserConsentGroupValue",0).toString(),Ib["x-UseShellServiceForUserConsentGroup"]=this.ub.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseShellServiceForUserConsentGroup",!1).toString(),Ib["x-UseSALForLicensing"]=this.ub.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseSALForLicensingAFHS",!1).toString(),Ib["x-SMBUserLicensingEnabled"]=this.ub.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SMBUserLicensingEnabled",!1).toString(),
Ib["x-UseSALForAadGraphToken"]=this.ub.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseSALForAadGraphAFHS",!1).toString());if(Oa){T=yl(Oa.keys);for(var hc=T.next();!hc.done;hc=T.next())hc=hc.value,Ib[hc]=Oa.na(hc)}return Ib};Object(Jc.a)(vd,"HttpRequestToPromiseUtility",null,[]);var we=b(5),jc;(function(T){T[T.loki=0]="loki";T[T.augloopACLP=1]="augloopACLP"})(jc||(jc={}));Object(Jc.b)("AlternateAuthSupportApp",jc);var Zc=b(857),ud=b(38);Object(Jc.a)(fd,"WacAlternateAuthToken",null,[]);gc.prototype.NCh=
function(){var T=null;this.GOb.wb(jc[0])&&(T=this.GOb.na(jc[0]));return void 0===T||null===T||this.Vod(T)?this.Dth():Promise.resolve(T.Token)};gc.prototype.Vod=function(T){return T.ExpirationTime-Date.now()<this.XCj};gc.prototype.Dth=function(){var T=this,Oa=new Ae.a(cb.a.Ik());Oa.ia("X-AlternateAuthApp",jc[0]);return this.Jhb.g2c(this.Aua("/afhs/AlternateAuthHelperHandler.ashx"),Object(mc.a)(this,this.jPi,"parseAlternateAuthTokenResponse"),2,Oa).then(function(Ib){Bc.ULS.sendTraceTag(545821456,3004,
50,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Retrieved WacAlternateAuthToken for {0}",jc[0]);T.GOb.ia(jc[0],Ib);return Ib.Token},function(Ib){Ib=Object(Oc.a)(se,Ib);Bc.ULS.sendTraceTag(545604827,3004,10,"AlternateAuthHelper:FetchNewUserDataSignatureToken: Error: {0}, status code: {1}",Ib.message,Ib.Gcc);return null})};gc.prototype.jPi=function(T){var Oa=ud.d(T).uu;Bc.ULS.sendTraceTag(545821457,3004,Oa?50:10,"ParseAlternateAuthTokenResponse: fetched WacAlternateAuthToken from {0}",T);return Oa};
gc.prototype.Aua=function(T){return String.format("{0}{1}?{2}",this.ub.Ua("WebServiceBase"),T,we.AFrameworkApplication.hj)};Object(Jc.a)(gc,"AlternateAuthHelper",null,[290]);var Fd=b(456);Object(Jc.a)(ne,"FeatureStateChangeArgs",null,[]);var me=b(277),$e=b(23),Df=b(110),gg=b(179),og;(function(T){T[T.Enabled=0]="Enabled";T[T.Disabled=1]="Disabled"})(og||(og={}));Object(Jc.b)("FeatureState",og);var dg=b(86),af=b(29),rg=b(178);De.prototype.KLh=function(){for(var T=this.ub.Dy("AllLicensedFeatures")?this.ub.Tv("AllLicensedFeatures"):
[],Oa=new Fd.a,Ib=0;Ib<T.length;Ib++)Oa.add(T[Ib]);return Oa};De.prototype.dnd=function(){return this.fJc||this.gJc};De.prototype.pUd=function(T,Oa){var Ib=this;T=void 0===T?0:T;Oa=void 0===Oa?!1:Oa;Bc.ULS.sendTraceTag(51185368,3004,50,"ApplicationFeatureHelper_TryInitializeLicensing: forceRefresh = {0}",Oa);var hc=this.S1c();hc&&(hc.set("retryAttempt",T.toString()),hc.set("forceRefresh",Oa.toString()),hc.set("isO365ConsumerHost",this.gJc.toString()),hc.set("isO365CommercialHost",this.fJc.toString()),
hc.set("isFreemiumUpsellEnabled",this.KRb.toString()));$c.Health.instance.recordKpiUsageForAlertableKpi("AFHSLicensingFailedRequest","waclicensing",hc);$c.Health.instance.recordKpiUsage("AFHSLicensingSuccessfulRequest",1,"waclicensing",hc);void 0!==this.Kpa&&null!==this.Kpa&&this.Kpa.start();var nd=null;Oa&&(nd=new Ae.a(cb.a.Ik()),nd.ia("x-LicensingForceRefresh","true"));this.oce=new Date;return(this.Jpa?this.Jhb.g2c(this.Aua("/afhs/ApplicationFeatureHelperHandler.ashx"),Object(mc.a)(this,this.mPi,
"parseApplicationFeatureHelperResponse"),0,nd,Object(mc.a)(this,this.zUi,"processApplicationFeatureHelperResponseHeaders"),["Date"]):Promise.resolve({})).then(function(Td){var Ed=Object.assign(new rg.a,{durationMs:Ib.o2f()});Ed.extendedProperties=hc;Ed.extendedProperties&&Td&&(Ed.extendedProperties.set("featureCount",Df.a.count(Td).toString()),Ed.extendedProperties.set("licensingTestFeatureEnabled",("LicensingTestFeature"in Td).toString()),Ed.extendedProperties.set("msoPremiumBadgeEnabled",("MsoPremiumBadge"in
Td).toString()),Ib.fUb&&Ed.extendedProperties.set("fromCache",(Ib.fUb<Ib.oce).toString()));$c.Health.instance.recordKpiSuccess("AFHSLicensingSuccessfulRequest",Ed);return Td},function(Td){var Ed=Object.assign(new rg.a,{durationMs:Ib.o2f()}),he=Object(Oc.a)(se,Td);if(!he)return Bc.ULS.sendTraceTag(51491471,3004,10,"ApplicationFeatureHelper_TryInitializeLicensing: Invalid cast to HttpRequestToPromiseRejectData"),$c.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","InvalidCastToHttpRequestToPromiseRejectData",
!1,!0,Ed),new Promise(function(Pe,hf){hf(Td)});Ed.extendedProperties=hc;Ed.extendedProperties&&Ed.extendedProperties.set("status",he.Gcc.toString());$c.Health.instance.recordKpiFailure("AFHSLicensingFailedRequest","RequestFailed",!1,!0,Ed);return 408===he.Gcc&&++T<=Ib.rng?Ib.pUd(T):new Promise(function(Pe,hf){hf(he)})})};De.prototype.mPi=function(T){(T=ud.b(T))?(Bc.ULS.sendTraceTag(50436170,3004,50,"ParseApplicationFeatureHelperResponse: Successfully fetched features"),Bc.ULS.sendTraceTag(50938594,
3004,50,"{0}",T)):Bc.ULS.sendTraceTag(50436171,3004,10,"ParseApplicationFeatureHelperResponse: ApplicationFeatureHelper Service returned a null feature set");return T.Features};De.prototype.Aua=function(T){var Oa=String.format("{0}{1}",this.ub.Ua("WebServiceBase"),T);this.ub.Dy("ApplicationFeatureHelperHttpCachingEnabled")&&this.ub.ra("ApplicationFeatureHelperHttpCachingEnabled")&&(T=De.P$b(this.ub))&&0<T.length&&(this.XVb&&(T+="ucbf"),Oa=new me.QueryStringBuilder(Oa),Oa.Ei("afhskey",T),Oa=Oa.toString());
return Oa};De.prototype.isFeatureEnabled=function(T,Oa){var Ib=this;if(!this.ODa&&!this.LQc&&!this.Jpa)return this.NAa;Bc.ULS.sendTraceTag(42513091,3004,50,"ApplicationFeatureHelper.IsFeatureEnabled: Call made to check if feature: {0} is enabled.",T);if("ConnectedServices"===T){var hc=this.ODa?this.G0d.AJ("ControllerConnectedServicesEnabled"):this.NAa,nd=this.LQc?this.Ege.getSettings().then(function(he){return 2!==he.ot},function(){return Oa}):this.NAa;return hc.then(function(he){return he?nd:Ib.f9c})}hc=
null;hc=this.ODa?this.G0d.isFeatureEnabled(T):this.NAa;var Td=null;Td=this.Jpa?this.tai(T,Oa):this.NAa;var Ed=null;Ed=this.LQc?this.Ege.isFeatureEnabled(T):this.NAa;return hc.then(function(he){return he?Ed.then(function(Pe){return Pe?Td:Ib.f9c}):Ib.f9c}).then(function(he){Ib.Kif(T,he);return he},function(he){Ib.Kif(T,Oa,he);return Oa})};De.prototype.Kif=function(T,Oa,Ib){Ib=void 0===Ib?null:Ib;var hc=this.S1c();hc&&(hc.set("FeatureName",T),hc.set("IsEnabled",Oa.toString()));Ib?(T=Object.assign(new rg.a,
{extendedProperties:hc}),$c.Health.instance.recordKpiFailure("AFHFeatureStatus","CanNotDetermineFeatureStatus",!1,!0,T)):$c.Health.instance.recordKpiUsage("AFHFeatureStatus",0,"jpittsdirects",hc)};De.prototype.getFeatureTier=function(T,Oa){var Ib=this;if(!this.Jpa)return new Promise(function(hc){hc(2)});Bc.ULS.sendTraceTag(42804871,3004,50,"ApplicationFeatureHelper.GetFeatureTier: Call made to get Feature's Tier.",T);return this.Pta.then(function(hc){return Ib.Lac(T,hc,Oa)},function(){return Oa})};
De.prototype.isFreemiumUpsellEnabled=function(){return this.KRb&&this.gJc&&!this.W5d};De.prototype.launchUpsellExperience=function(T,Oa){Oa=void 0===Oa?null:Oa;Bc.ULS.sendTraceTag(594564814,3004,50,String.format("ApplicationFeatureHelper_LaunchUpsellExperience: Launching upsell experience for experienceId: {0}",T));var Ib=this.S1c();Ib&&(Ib.set("experienceId",T),Oa&&Ib.set("campaignId",Oa));$c.Health.instance.recordKpiUsage("AFHCLaunchUpsellSuccess",1,"waclicensing",Ib);if(Ib=dg.a.instance.Hh("Common.IInProductMessagingUIManager")){var hc=
Object(mc.a)(this,this.OWh,"handleDimeTaskComplete");Ib.Wgf(T,hc,Oa)}else Bc.ULS.sendTraceTag(594367561,3004,15,"InProductMessaging was not initialized"),$c.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","InProductMessagingNotInitialized",!1,!0,null),Oa={},this.La.ze(af.a.R8b,2,(Oa.experience=T,Oa))};De.prototype.Vya=function(T,Oa){if(!this.Jpa)return null;if(!T||!Oa)return Bc.ULS.sendTraceTag(594564813,3004,10,"ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: Invalid input."),
null;var Ib=gg.a.create().toString();this.Ota.wb(T)||this.Ota.ia(T,new Ae.a(cb.a.Ik()));this.Ota.na(T).add(Ib,Oa);Bc.ULS.sendTraceTag(594564812,3004,50,String.format("ApplicationFeatureHelper_RegisterFeatureStateChangeCallback: registered callback {0} for feature {1}",Ib,T));return Ib};De.prototype.WFd=function(T,Oa){this.Jpa&&(T&&this.Ota.wb(T)?Oa&&gg.a.isValid(Oa)?this.Ota.na(T).wb(Oa)?(Bc.ULS.sendTraceTag(594564808,3004,50,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: Removing callback {0} for feature {1}",
Oa,T)),this.Ota.na(T).remove(Oa)):Bc.ULS.sendTraceTag(594564809,3004,15,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: callbackId {0} not registered for feature {1} ",Oa,T)):Bc.ULS.sendTraceTag(594564810,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid callbackId {0} for feature {1}",Oa,T)):Bc.ULS.sendTraceTag(594564811,3004,10,String.format("ApplicationFeatureHelper_RemoveFeatureStateChangeCallback: invalid or non registered featureName {0}",
T)))};De.prototype.Lac=function(T,Oa,Ib){return this.XVb?T in Oa?Oa[T].LicenseTier:Ib:T in Oa?this.KPi(Oa[T],Ib):Ib};De.prototype.KPi=function(T,Oa){switch(T.toLowerCase()){case "unknown":return 0;case "basic":return 1;case "premium":return 2;default:return Oa}};De.prototype.OWh=function(){var T=this;Bc.ULS.sendTraceTag(594367560,3004,50,"ApplicationFeatureHelper_HandleDimeTaskComplete");this.Pta.then(function(Oa){T.RJf(Oa)}).catch(function(){T.RJf({})})};De.prototype.RJf=function(T){var Oa=this;
Bc.ULS.sendTraceTag(594051087,3004,50,"ApplicationFeatureHelper_RefreshLicensingAndNotifyUpdatedFeatures");var Ib=this.pUd(0,!0);Ib.then(function(hc){Oa.Pta=Ib;Df.a.count(hc)>Df.a.count(T)?$c.Health.instance.recordKpiSuccess("AFHCLaunchUpsellSuccess",null):$c.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","FeatureCountNotIncreased",!1,!0,null);for(var nd=yl(Oa.Ota.keys),Td=nd.next();!Td.done;Td=nd.next())if(Td=Td.value,Td in hc){var Ed=Oa.Lac(Td,hc,0);Td in T?Oa.Lac(Td,T,0)!==Ed&&Oa.bwd(Td,
!0,Ed):Oa.bwd(Td,!0,Ed)}else Td in T&&Oa.bwd(Td,!1,Oa.Lac(Td,T,0))}).catch(function(hc){$c.Health.instance.recordKpiFailure("AFHCLaunchUpsellSuccess","LicensingRefreshFailed",!1,!0,null);Bc.ULS.sendTraceTag(594051086,3004,10,JSON.stringify(hc))})};De.prototype.bwd=function(T,Oa,Ib){Bc.ULS.sendTraceTag(594051085,3004,50,"ApplicationFeatureHelper_NotifyFeatureStateChanged: Notify feature state changed callbacks for feature {0}, {1}, {2}",T,Oa,Ib);Oa=new ne(T,Oa,Ib);Ib=this.Ota.na(T);Ib=yl(Ib);for(var hc=
Ib.next();!hc.done;hc=Ib.next()){hc=hc.value;try{hc.value(Oa)}catch(nd){Bc.ULS.sendTraceTag(594051084,3004,10,String.format("ApplicationFeatureHelper_NotifyFeatureStateChanged: Exception when calling registered callback: feature: {0} callbackId: {1}, exception {2}",T,hc.key,nd.message))}}};De.prototype.te=function(T,Oa){var Ib=this;if(this.Jpa){var hc=this.w8d.contains(T),nd=!0,Td="",Ed=!1;return this.Pta.then(function(he){T in he?(he=he[T],Td=og[he.FeatureState],nd=1!==he.FeatureState):nd=!hc;Ib.Sif(T,
hc,Td,Ed,Oa,nd);return nd},function(){Ed=!0;hc&&(nd=Oa);Ib.Sif(T,hc,Td,Ed,Oa,nd);return nd})}return this.NAa};De.prototype.Sif=function(T,Oa,Ib,hc,nd,Td){Bc.ULS.sendTraceTag(557389507,3004,50,"featureName : {0}, isLicenseControlledFeature={1}, encounteredError = {2}, featureData={3}, fallbackValue={4}, isAllowed={5}",T,Oa,hc,Ib,nd,Td)};De.prototype.tai=function(T,Oa){if(this.XVb)return this.te(T,Oa);if(this.Jpa){if(this.w8d.contains(T))return this.Pta.then(function(Ib){return T in Ib},function(){return Oa});
Bc.ULS.sendTraceTag(590385821,3004,50,"ApplicationFeatureHelper_IsFeatureAllowedByUserLicense: Feature '{0}' requested while not in the licensed features set.",T)}return this.NAa};De.prototype.zUi=function(T){try{T&&"Date"in T&&(this.fUb=new Date(T.Date),Bc.ULS.sendTraceTag(578863817,3004,50,"ProcessApplicationFeatureHelperResponseHeaders Date {0}",this.fUb.toString()))}catch(Oa){Bc.ULS.sendTraceTag(578863818,3004,10,"ProcessApplicationFeatureHelperResponseHeaders Exception {0}",Oa)}};De.prototype.S1c=
function(){try{return new Map}catch(T){return null}};De.prototype.o2f=function(){if(void 0!==this.Kpa&&null!==this.Kpa){var T=this.Kpa.Ac;this.Kpa.stop();return T}return null};De.P$b=function(T){try{if($e.a.szj){var Oa=T.Ua("UserDataSignature").split(".");if(1<Oa.length){var Ib=window.self.atob(Oa[1]),hc=JSON.parse(Ib).LocalStorageKey;if(void 0!==hc&&null!==hc&&0<hc.length)return hc}}}catch(nd){Bc.ULS.sendTraceTag(578863816,3004,10,"GetLocalStorageCacheKey exception {0}",nd.toString())}return null};
Object(Jc.a)(De,"ApplicationFeatureHelper",null,[291]);var cg=b(185);Object(Jc.a)(Ee,"CloudPolicySettingsCacheData",null,[]);var Ie=b(952),Ng=b(373),Zf=b(221);ue.F0f=function(){return we.AFrameworkApplication.ga.ra("SideCarIsEnabled")?ue.Isc&&ue.yld?new Promise(function(T){T(!0)}):new Promise(function(T,Oa){ue.Isc=Zf.a.create(we.AFrameworkApplication.ga.Ua("SideCarUrl"));Ng.a.bia(ue.Isc);ue.Isc.l9(function(Ib,hc){(ue.yld=hc.succeeded)?T(hc.succeeded):Oa(hc.succeeded)})}):new Promise(function(T){T(!1)})};
ue.yld=!1;ue.Isc=null;Object(Jc.a)(ue,"SideCarLoader",null,[]);Object(Jc.a)(ee,"CloudPolicySettingsData",null,[]);Qc.prototype.AJ=function(T,Oa){Oa=void 0===Oa?!0:Oa;if(!this.ODa){var Ib=this;return new Promise(function(Ed){Ed(Ib.uub(T))})}var hc=this,nd=this,Td=this.e1b.then(function(Ed){try{var he=null;Ed.PolicySettings&&"unknown"in Ed.PolicySettings&&(he=Ed.PolicySettings.unknown);if(he){if(T in he&&void 0!==he[T]&&null!==he[T])return new Promise(function(hf){hf("0"!==he[T])});var Pe=T.toLowerCase();
if(Pe in he&&void 0!==he[Pe]&&null!==he[Pe])return new Promise(function(hf){hf("0"!==he[Pe])});Bc.ULS.sendTraceTag(51512667,3004,50,"Policy"+T+" not found, using default");return new Promise(function(hf){hf(hc.uub(T))})}return new Promise(function(hf){hf(hc.uub(T))})}catch(hf){return Bc.ULS.sendTraceTag(50622686,3004,10,"Failed to get "+T+" policy value. Error Message: {0}",hf.message),hc.handleError(hf.toString(),Oa,hc.uub(T))}},function(Ed){return nd.handleError(Ed,Oa,nd.uub(T))});Td.then(function(Ed){Bc.ULS.sendTraceTag(50651667,
3004,50,"CloudPolicySettingsHelper.GetBooleanPolicySetting: policy: {0}, value: {1}",T,Ed);return null});return Td};Qc.prototype.isFeatureEnabled=function(T,Oa){Oa=void 0===Oa?!0:Oa;if(this.ub.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))return this.vai(T,Oa);var Ib=new Promise(function(nd){nd(!0)}),hc="";this.JPb.contains(T)&&(hc="ControllerConnectedServicesEnabled",Ib=this.AJ(hc,Oa));Ib.then(function(nd){Bc.ULS.sendTraceTag(50651668,
3004,50,"CloudPolicySettingsHelper.IsFeatureEnabled: Feature: {0}, enabled or not: {1}, by policy: {2}",T,nd,hc);return null});return Ib};Qc.prototype.vai=function(T,Oa){Oa=void 0===Oa?!0:Oa;var Ib=new Promise(function(nd){nd(!0)}),hc="";"mso_sendASmile"===T?hc="Enabled":"Survey"===T||"FloodgateSurvey"===T?hc="SurveyEnabled":this.JPb.contains(T)&&(hc="ControllerConnectedServicesEnabled");""!==hc&&(Ib=this.AJ(hc,Oa));Ib.then(function(nd){Bc.ULS.sendTraceTag(558187080,3004,50,"CloudPolicySettingsHelper.IsFeatureEnabledV2: Feature: {0}, enabled or not: {1}, by policy: {2}",
T,nd,hc);return null});return Ib};Qc.prototype.handleError=function(T,Oa,Ib){return Oa?new Promise(function(hc){hc(Ib)}):new Promise(function(hc,nd){nd(T)})};Qc.prototype.Nna=function(T,Oa,Ib){var hc=this;if(!T)return Promise.resolve(new ee);var nd=!1,Td=null;$c.Health.instance.recordKpiUsage("GetCloudPolicySettings",1,"jpittsdirects",null);var Ed=this.B1c("GetCloudPolicySettings");return(new Promise(function(he,Pe){if(void 0!==hc.zib&&null!==hc.zib&&0<hc.zib.length){var hf=hc.lFj();if(void 0!==hf&&
null!==hf){nd=!0;he(hf);return}}hc.Jhb.g2c(Oa,Ib,1,null,Object(mc.a)(hc,hc.DUi,"processCloudPolicySettingsResponseHeaders"),["CheckIn-Interval"],hc.ub.zd("CloudPolicySettingsRequestQueueTimeout",15E3),hc.ub.zd("CloudPolicySettingsRequestSentTimeout",3E4)).then(function(pg){Bc.ULS.sendTraceTag(51662933,3004,50,"Retrieved CloudPolicySettingsData from OCPS");hc.$Fj(pg);he(pg);return pg},function(pg){Pe(pg);return null})})).then(function(he){var Pe=hc.Pwc(Ed);Ed=Pe.stopwatch;Td=Pe.returnValue;(Pe=hc.kq())&&
Pe.set("FromCache",nd.toString());Pe=Object.assign(new rg.a,{durationMs:Td,extendedProperties:Pe});$c.Health.instance.recordKpiSuccess("GetCloudPolicySettings",Pe);return he})};Qc.prototype.BFj=function(){return ue.F0f().then(function(){Bc.ULS.sendTraceTag(593282845,3004,50,"CloudPolicySettingsHelper - Retrieving CloudPolicySettingsData Promise from Sidecar");return sidecar.cloudPolicy.GetCloudPolicySettingsData()})};Qc.prototype.Aua=function(T){return String.format("{0}{1}",this.ub.Ua("WebServiceBase"),
T)};Qc.prototype.nPi=function(T){var Oa=ud.d(T).uu;Bc.ULS.sendTraceTag(50622687,3004,Oa?50:10,"ParseCloudPolicySettingsResponse: fetched CloudPolicySettingsData from {0}",T);return Oa};Qc.prototype.DUi=function(T){try{if(void 0!==T&&null!==T&&"CheckIn-Interval"in T){var Oa=parseInt(T["CheckIn-Interval"]);void 0!==Oa&&null!==Oa&&0<Oa&&(this.cEc=Oa)}}catch(Ib){Bc.ULS.sendTraceTag(51662934,3004,10,"ProcessCloudPolicySettingsResponseHeaders Exception {0}",Ib)}};Qc.prototype.uub=function(T){return T in
this.H$d?"0"!==this.H$d[T]:!0};Qc.prototype.lFj=function(){try{var T=Ie.a.instance.getItem(this.zib);if(void 0===T||null===T)return Bc.ULS.sendTraceTag(51662936,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null"),null;Bc.ULS.sendTraceTag(51662937,3004,50,"TryGetCloudPolicySettingsDataFromCache retrieved data {0} from LocalStorage",T);var Oa=JSON.parse(T);if(void 0===Oa||null===Oa)return Bc.ULS.sendTraceTag(51662938,3004,15,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage is null after parsing"),
null;if(void 0===Oa.ExpirationTime||null===Oa.ExpirationTime)return Bc.ULS.sendTraceTag(51662939,3004,15,"TryGetCloudPolicySettingsDataFromCache ExpirationTime from LocalStorage is null after parsing"),null;if((new Date(Oa.ExpirationTime)).getTime()<Date.now())return Bc.ULS.sendTraceTag(51662940,3004,50,"TryGetCloudPolicySettingsDataFromCache Cache is expired"),null;var Ib=new ee;Ib.PolicySettings=Oa.PolicySettings;Ib.ControllerConnectedServicesFeatureNames=new cg.a;this.ub.Dy("ServicesControlsMicrosoftControllerServicesList")&&
this.ub.Tv("ServicesControlsMicrosoftControllerServicesList");for(var hc=yl(this.JPb),nd=hc.next();!nd.done;nd=hc.next())Ib.ControllerConnectedServicesFeatureNames.add(nd.value);Bc.ULS.sendTraceTag(51662941,3004,50,"TryGetCloudPolicySettingsDataFromCache data from LocalStorage retrieved");return Ib}catch(Td){return Bc.ULS.sendTraceTag(51662942,3004,10,"TryGetCloudPolicySettingsDataFromCache exception {0}",Td.toString()),null}};Qc.prototype.$Fj=function(T){try{if(void 0===T||null===T||void 0===T.PolicySettings||
null===T.PolicySettings)Bc.ULS.sendTraceTag(51662944,3004,15,"TrySetCloudPolicySettingsDataIntoCache data/PolicySettings is null");else if(0>=this.cEc)Bc.ULS.sendTraceTag(51662945,3004,15,"TrySetCloudPolicySettingsDataIntoCache _checkInInterval is Invalid");else{var Oa=new Ee(T,this.cEc),Ib=JSON.stringify(Oa);Bc.ULS.sendTraceTag(51662946,3004,50,"TrySetCloudPolicySettingsDataIntoCache data to cache {0}",Ib);Ie.a.instance.setItem(this.zib,Ib);Bc.ULS.sendTraceTag(51662947,3004,50,"TrySetCloudPolicySettingsDataIntoCache set data to cache")}}catch(hc){Bc.ULS.sendTraceTag(51662976,
3004,10,"TrySetCloudPolicySettingsDataIntoCache exception {0}",hc.toString())}};Qc.prototype.P$b=function(){var T=De.P$b(this.ub);return T&&0<T.length?"OCPS"+T:null};Qc.prototype.kq=function(){try{return new Map}catch(T){return null}};Qc.prototype.B1c=function(T){var Oa=dg.a.instance.Hh("Microsoft.Office.Telemetry.Usage.IStopwatchBuilder");return void 0!==Oa&&null!==Oa?Oa.Fc("WebServiceCall",T):null};Qc.prototype.Pwc=function(T){if(void 0!==T&&null!==T){var Oa=T.Ac;T.stop();return{returnValue:Oa,
stopwatch:null}}return{returnValue:null,stopwatch:T}};Object(Jc.a)(Qc,"CloudPolicySettingsHelper",null,[288]);Rc.prototype.clone=function(){var T=new Rc;T.ot=this.ot;T.Pag=this.Pag;T.zGe=this.zGe;T.QGa=this.QGa;T.Qag=this.Qag;T.AGe=this.AGe;T.aea=this.aea;T.tPc=this.src;return T};Rc.prototype.serialize=function(T){T=void 0===T?null:T;var Oa={};if(!T||T.contains(Rc.yNa))Oa[Rc.yNa]=this.ot;if(!T||T.contains(Rc.EBb))Oa[Rc.EBb]=this.QGa;if(!T||T.contains(Rc.FBb))Oa[Rc.FBb]=this.aea;return JSON.stringify(Oa)};
Rc.create=function(T,Oa){Oa=void 0===Oa?null:Oa;var Ib=new Rc;Ib.tPc=T;void 0!==Oa&&null!==Oa&&(Rc.yNa in Oa&&(Ib.ot=Oa[Rc.yNa]),Rc.EBb in Oa&&(Ib.QGa=Oa[Rc.EBb]),Rc.FBb in Oa&&(Ib.aea=Oa[Rc.FBb]));return Ib};Rc.deserialize=function(T,Oa){try{var Ib=JSON.parse(T);if(void 0!==Ib&&null!==Ib)return Rc.create(Oa,Ib);Bc.ULS.sendTraceTag(50860946,306,10,"UserPrivacySettings Deserialize: Unable to convert {0} to dict",T);throw Error.argument("settingsData");}catch(hc){throw Bc.ULS.sendTraceTag(50860947,
306,10,"UserPrivacySettings Deserialize Exception = {0}",hc.toString()),hc;}};tl.Object.defineProperties(Rc.prototype,{src:{configurable:!0,enumerable:!0,get:function(){return this.tPc}}});Rc.yNa="CCS";Rc.EBb="CCSTime";Rc.FBb="OfficePrivacyRoamedNoticeShown";Object(Jc.a)(Rc,"UserPrivacySettings",null,[]);var ng=b(135);sc.prototype.Aua=function(T){var Oa=String.format("{0}RoamingServiceHandler.ashx?action=",this.ub.appSettings.RoamingServiceHandlerWebServiceBase||"");Oa=new Sys.StringBuilder(Oa);Oa.append(T);
Oa.append("&");Oa.append(we.AFrameworkApplication.hj);return Oa.toString()};sc.prototype.executeRequest=function(T,Oa,Ib,hc){return this.Og.rXb(T,Oa,void 0===hc?null:hc,null,Ib,"33",!1,null,6E4)};sc.prototype.saveSettings=function(T){var Oa=this;return new Promise(function(Ib,hc){try{if(void 0===Oa.xe||null===Oa.xe||void 0===T||null===T)Bc.ULS.sendTraceTag(51258443,3004,15,"SaveUserPrivacySettings: Can't determine setting changes to save"),hc("Can't determine setting changes to save");else{var nd=
Oa.xe.ot!==T.ot;if(2===Oa.xe.src&&nd)Oa.ocj(T),Ib(!0);else{var Td=Oa.ngj(T);if(void 0===Td||null===Td||!Td.length)Bc.ULS.sendTraceTag(50917389,3004,15,"SaveUserPrivacySettings: returning since nothing changed"),hc("No changes to save");else if(1===Oa.xe.src)Ib(Oa.J7f(Td));else if(!Oa.xe.src){Bc.ULS.sendTraceTag(51258444,3004,50,"UserPrivacySettingsHelper: SaveSettings to Roaming {0}",Td);var Ed=Oa.executeRequest(Oa.Aua("saveUserPrivacySettings"),2,"SaveUserPrivacySettingsRequest",Td);Ed.continueWith(function(){if(Ed.Ch||
Ed.jg)Bc.ULS.sendTraceTag(50860929,3004,10,"SaveUserPrivacySettings: Roaming Request Cancelled/Failed"),Ib(!1);else{var he=Ed.result;void 0!==he.vh&&null!==he.vh&&void 0!==he.vh.data&&null!==he.vh.data&&he.vh.data.httpStatus===le.a.sO?(Bc.ULS.sendTraceTag(51258445,3004,50,"SaveUserPrivacySettings: Roaming Request Succeeded"),Ib(!0)):(Bc.ULS.sendTraceTag(51258446,3004,10,"SaveUserPrivacySettings: Roaming Request Failed"),Ib(!1))}})}}}}catch(he){Bc.ULS.sendTraceTag(50860930,3004,10,"SaveUserPrivacySettings: Exception = {0}",
he.toString()),Ib(!1)}})};sc.prototype.ngj=function(T){if(void 0===this.xe||null===this.xe||void 0===T||null===T)throw Error.invalidOperation("User Privacy settings have not been initialized");var Oa=new cg.a;T.src?1===T.src&&this.xe.ot!==T.ot&&Oa.add(Rc.yNa):(this.xe.ot!==T.ot&&(Oa.add(Rc.yNa),Oa.add(Rc.EBb)),this.xe.aea!==T.aea&&Oa.add(Rc.FBb));return Oa.count?T.serialize(Oa):(Bc.ULS.sendTraceTag(50860931,3004,50,"SaveUserPrivacySettings: returning since nothing changed"),null)};sc.prototype.getSettings=
function(){if(!this.IOc){var T=this;this.IOc=new Promise(function(Oa){try{T.xe?Oa(T.xe.clone()):T.tFj().then(function(Ib){T.xe=Ib;Oa(T.xe.clone());return null},function(){T.rFj().then(function(Ib){T.xe=Ib;Oa(T.xe.clone());return null},function(){T.sFj().then(function(Ib){T.xe=Ib;Oa(T.xe.clone());return null},function(){Bc.ULS.sendTraceTag(50967430,3004,10,"UserPrivacySettings TryGetSettingsFromQueryParams returned an error)");T.xe=new Rc;Oa(T.xe.clone());return null});return null});return null})}catch(Ib){Bc.ULS.sendTraceTag(50860932,
3004,10,"UserPrivacySettings GetSettings: Exception = {0}",Ib.toString()),T.xe=new Rc,Oa(T.xe.clone())}})}return this.IOc};sc.prototype.tFj=function(){var T=this;return new Promise(function(Oa,Ib){try{var hc=-1!==window.location.href.indexOf("&wd_pn=2");if(T.ub.ra("PrivacyDialogShouldCheckRoaming")||hc){var nd=T.executeRequest(T.Aua("getUserPrivacySettings"),1,"GetUserPrivacySettingsRequest");nd.continueWith(function(){try{if(nd.Ch||nd.jg)Bc.ULS.sendTraceTag(50860934,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Request failure");
else{var Td=nd.result;if(Td&&Td.vh&&Td.vh.data)if(Td.vh.data.httpStatus!==le.a.sO)Bc.ULS.sendTraceTag(50860936,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Received error response {0}",Td.vh.data.httpStatus);else{if(Td.vh.data.fe){Oa(sc.parse(Td.vh.data.fe,0));Bc.ULS.sendTraceTag(51258447,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Success, Settings {0}",Td.vh.data.fe);return}Bc.ULS.sendTraceTag(50860937,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: ResponseData is null")}else Bc.ULS.sendTraceTag(50860935,
3004,10,"UserPrivacySettings TryGetSettingsFromRoaming: Data is null");Ib("UserPrivacySettings TryGetSettingsFromRoaming Request Faillure")}}catch(Ed){Bc.ULS.sendTraceTag(50860938,3004,10,"UserPrivacySettings TryGetSettingsFromRoaming Exception handling request {0}",Ed.toString()),Ib("UserPrivacySettings TryGetSettingsFromRoaming Request Exception")}})}else Bc.ULS.sendTraceTag(50860933,3004,50,"UserPrivacySettings TryGetSettingsFromRoaming: Roaming should not be used"),Ib("Roaming should not be used")}catch(Td){Bc.ULS.sendTraceTag(50860939,
3004,10,"TryGetSettingsFromRoaming Exception = {0}",Td.toString()),Ib("UserPrivacySettings TryGetSettingsFromRoaming Exception")}})};sc.prototype.rFj=function(){var T=this;return new Promise(function(Oa,Ib){try{var hc=ng.a.get("WacUPToggleState"),nd=null;void 0!==hc&&null!==hc&&0<hc.length&&(nd=decodeURIComponent(hc));if(void 0!==nd&&null!==nd&&0<nd.length){var Td=sc.parse(nd,1);Bc.ULS.sendTraceTag(51258448,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings retrieved from cookie {0}",Td.toString());
Oa(Td)}else{var Ed=Rc.create(1),he=new cg.a;he.add(Rc.yNa);var Pe=Ed.serialize(he);T.J7f(Pe)?(Bc.ULS.sendTraceTag(51258449,3004,50,"TryGetSettingsFromCookie: UserPrivacySettings initialized and retrieved from cookie {0}",Pe),Oa(Ed)):(Bc.ULS.sendTraceTag(51258450,3004,15,"TryGetSettingsFromCookie: Failure initializing cookie with settings {0}",Pe),Ib("UserPrivacySettings TryGetSettingsFromCookie Failure in TrySaveSettingsToCookie"))}}catch(hf){Bc.ULS.sendTraceTag(50860941,3004,10,"TryGetSettingsFromCookie from Cookie Exception = {0}",
hf.toString()),Ib("UserPrivacySettings TryGetSettingsFromCookie Eception")}})};sc.prototype.sFj=function(){return new Promise(function(T){try{var Oa=-1!==window.location.href.indexOf("&wdccsoff=1"),Ib=Rc.create(2);Oa?(Ib.ot=2,we.AFrameworkApplication.gFe(),Bc.ULS.sendTraceTag(51258451,3004,50,"TryGetSettingsFromQueryParams: Retrieved from query param {0}",Ib.toString())):(Ib.ot=1,Bc.ULS.sendTraceTag(51258452,3004,50,"TryGetSettingsFromQueryParams: Initialized with query param as data source for {0}",
Ib.toString()));T(Ib)}catch(hc){Bc.ULS.sendTraceTag(50967431,3004,50,"TryGetSettingsFromCookie from Query Params Exception = {0}",hc.toString()),Oa=Rc.create(2),Oa.ot=1,T(Oa)}})};sc.prototype.ocj=function(T){Bc.ULS.sendTraceTag(51258453,3004,50,"UserPrivacySettingsHelper: SaveSettingsToQueryParam");2===T.ot?we.AFrameworkApplication.gFe():we.AFrameworkApplication.Zfh();Bc.ULS.sendTraceTag(51258454,3004,50,"SaveSettingsToQueryParam saved settings = {0}",T)};sc.prototype.J7f=function(T){try{Bc.ULS.sendTraceTag(51258455,
3004,50,"UserPrivacySettingsHelper: TrySaveSettingsToCookie Saving settings {0}",T);var Oa=this.ub.Ua("PrivacyCookieDomain")||"";if(!Oa||!Oa.length)throw Error.invalidOperation("PrivacyCookieDomain is null or empty");Bc.ULS.sendTraceTag(51258456,3004,50,"SaveUserPrivacySettings to Cookie {0}",T);return ng.a.VMd("WacUPToggleState",T,ng.a.b_,"/",Oa)}catch(Ib){return Bc.ULS.sendTraceTag(50860942,3004,50,"SaveUserPrivacySettings to Cookie Exception = {0}",Ib.toString()),!1}};sc.prototype.isFeatureEnabled=
function(T){var Oa=this;return this.getSettings().then(function(Ib){for(var hc=Oa.ub.Dy("ServicesControlsMicrosoftControllerServicesList")?Oa.ub.Tv("ServicesControlsMicrosoftControllerServicesList"):[],nd=new Fd.a,Td=0;Td<hc.length;Td++)nd.add(hc[Td]);return nd.contains(T)?2!==Ib.ot:!0},function(){Bc.ULS.sendTraceTag(50860945,3004,10,"Failed to get privacy setting for feature {0}",T);return!0})};sc.parse=function(T,Oa){try{return Bc.ULS.sendTraceTag(50860943,3004,50,"Parsing user privacy settings {0} from {1}",
T,Oa),Rc.deserialize(T,Oa)}catch(Ib){throw Bc.ULS.sendTraceTag(50860944,3004,10,"GetUserPrivacySettings Exception = {0}",Ib.toString()),Ib;}};Object(Jc.a)(sc,"UserPrivacySettingsHelper",null,[289]);var Ff=b(274);Cg.prototype.di=function(T){var Oa=this;this.rb=T;this.rb.register(288,"Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").zc().Ic(function(){return new Qc(we.AFrameworkApplication.ga,we.AFrameworkApplication.Hd)});this.rb.register(289,"Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper").zc().Ic(function(){return new sc(we.AFrameworkApplication.ga,
we.AFrameworkApplication.Hd)});this.rb.register(290,"Common.App.ApplicationFeatureHelper.IAlternateAuthHelper").zc().Ic(function(){return new gc(we.AFrameworkApplication.ga,we.AFrameworkApplication.Hd)});this.rb.register(291,"Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").zc().Ic(function(){return new De(we.AFrameworkApplication.ga,we.AFrameworkApplication.Hd,Oa.rb.resolve("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper"),Oa.rb.resolve("Common.App.ApplicationFeatureHelper.IUserPrivacySettingsHelper"),
we.AFrameworkApplication.Eb)})};Cg.prototype.init=function(){var T=this;we.AFrameworkApplication.ga.$v(function(){var Oa=T.rb.resolve("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");we.AFrameworkApplication.ga.ra("LicensingIsEnabled")&&(Oa.isFeatureEnabled("LicensingTestFeature",!1).then(function(Ib){Bc.ULS.sendTraceTag(42513092,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned IsFeatureEnabled as {0}. IsAnonymousUser : {1}.",Ib,we.AFrameworkApplication.ga.Ua("IsAnonymousUser"));
return null}),Oa.getFeatureTier("LicensingTestFeature",0).then(function(Ib){Bc.ULS.sendTraceTag(42804872,3004,50,"ApplicationFeatureHelperPackage.Init: LicensingTestFeature returned GetFeatureTier as {0}. IsAnonymousUser : {1}.",Ib,we.AFrameworkApplication.ga.Ua("IsAnonymousUser"));return null}));T.rb.resolve("Common.App.ApplicationFeatureHelper.IAlternateAuthHelper");T.SAj()})};Cg.prototype.dispose=function(){};Cg.prototype.SAj=function(){try{we.AFrameworkApplication.ga.ra("SideCarIsEnabled")&&ue.F0f().then(function(T){Bc.ULS.sendTraceTag(594057429,
3004,50,"Sidecar Loader attempted to load Sidecar.  SideCarIsAvailable:{0}",T);return T})}catch(T){}};Cg.main=function(){Ff.a.instance.mj(new Cg)};tl.Object.defineProperties(Cg.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.ApplicationFeatureHelper.ApplicationFeatureHelperPackage"}}});Object(Jc.a)(Cg,"ApplicationFeatureHelperPackage",null,[4,5]);var be=b(157),Rf=b(394),Re=Rf.a;vm(rf,Re);rf.prototype.createElement=function(){var T=document.createElement("link");T.setAttribute("rel",
"stylesheet");T.setAttribute("type","text/css");T.setAttribute("href",this.Mt);return T};rf.prototype.e2c=function(){return null};rf.prototype.Zpc=function(){this.element.setAttribute("href","");this.element.setAttribute("href",this.PH.Mt)};tl.Object.defineProperties(rf.prototype,{u2b:{configurable:!0,enumerable:!0,get:function(){return!1}}});Object(Jc.a)(rf,"CssResource",Rf.a,[]);var Ze=b(28),hg=b(55);Af.prototype.dli=function(){this.QQb||(Bc.ULS.sendTraceTag(21030598,324,50,"InProductMessagingDependenciesLoad usage"),
this.QQb=hg.Task.WAA(Af.jli(),Af.ali()),this.QQb.continueWith(function(T){Bc.ULS.sendTraceTag(21030599,324,10,"{0}",Ze.a.lcd(T.mg))},5));return this.QQb};Af.prototype.fli=function(){if(!this.ATb)try{Bc.ULS.sendTraceTag(39978390,324,50,"InProductMessagingFreemiumDependenciesLoad usage"),this.ATb=hg.Task.WAA(Af.C6c(Zf.a.create(we.AFrameworkApplication.ga.Ua("DimeUrl"),null,null))),this.ATb.continueWith(function(T){Bc.ULS.sendTraceTag(39978391,324,10,"{0}",Ze.a.lcd(T.mg))},5)}catch(T){Bc.ULS.sendTraceTag(594874951,
324,10,"{0}",Ze.a.lcd(T))}return this.ATb};Af.jli=function(){var T=Af.Nac("inproductmessaging.js");T=Zf.a.create(T,null,null);return Af.C6c(T)};Af.ali=function(){var T=Af.Nac("inproductmessaging.css");T=new rf(T);return Af.C6c(T)};Af.Nac=function(T){return be.a.y1b(String.format("ipm/{0}",T))};Af.C6c=function(T){Ng.a.bia(T);return T.U6a};Object(Jc.a)(Af,"DependencyDownloader",null,[665]);vg.xOi="inProductMessagingOverlayDiv";vg.jRi="PlayButtonImage";vg.H7i="ReplayButtonImage";Object(Jc.a)(vg,"Constants",
null,[]);Yf.prototype.okj=function(){this.gke(vg.jRi,this.kRi);this.gke(vg.H7i,this.I7i)};Yf.prototype.gke=function(T,Oa){Oa&&(this.Y7f[T]=Oa)};tl.Object.defineProperties(Yf.prototype,{DIg:{configurable:!0,enumerable:!0,get:function(){return this.i_d},set:function(T){this.i_d=T}},pti:{configurable:!0,enumerable:!0,get:function(){return this.J9d},set:function(T){this.J9d=T}},Nsj:{configurable:!0,enumerable:!0,get:function(){return this.vee},set:function(T){(this.vee=T)&&this.okj()}}});Object(Jc.a)(Yf,
"FirstRunExperienceUISettings",null,[664]);Object(Jc.a)(Of,"FirstRunExperienceViewData",null,[663]);var Bg=b(171),qh=b(108);Lf.prototype.Mg=function(){this.La.hf(af.a.swh,qh.a.frame,Object(mc.a)(this,this.qwh,"firstRunExperienceHandler"),64);this.La.$b(af.a.aRe,qh.a.frame,Object(mc.a)(this,this.X1h,"inProductMessagingTabHandler"));this.La.$b(af.a.$Qe,qh.a.frame,Object(mc.a)(this,this.W1h,"inProductMessagingShiftTabHandler"));this.La.$b(af.a.tah,qh.a.frame,Object(mc.a)(this,this.uah,"dimeLaunchHandler"));
this.La.$b(af.a.gOf,qh.a.frame,Bg.ActionManager.$f);this.La.$b(af.a.g8i,qh.a.frame,Bg.ActionManager.$f);this.La.$b(af.a.h8i,qh.a.frame,Bg.ActionManager.$f);this.Ie&&this.Ie.updateCommandUI()};Lf.prototype.qwh=function(T,Oa,Ib,hc,nd){2===Ib&&this.sRb.Fji(nd);return 32};Lf.prototype.uah=function(T,Oa,Ib,hc,nd){2===Ib&&this.sRb.Dji(nd);return 32};Lf.prototype.X1h=function(T,Oa,Ib){return 2===Ib?this.sRb.Bud():32};Lf.prototype.W1h=function(T,Oa,Ib){return 2===Ib?this.sRb.zud():32};Object(Jc.a)(Lf,"InProductMessagingActor",
null,[]);Object(Jc.a)(Uf,"DimeExperienceUISettings",null,[]);var Zg=b(168),qf=b(588);ae.prototype.D4h=function(T){Zg.b("getHeaderApi")?T.isFeatureEnabled("MsoPremiumBadge",!0).then(function(Oa){var Ib=T.isFreemiumUpsellEnabled();Ib&&(appChrome.getHeaderApi().then(function(hc){hc.updatePremiumStatus(Oa,Ib);return null}),T.Vya("MsoPremiumBadge",function(hc){appChrome.getHeaderApi().then(function(nd){nd.updatePremiumStatus(hc.isEnabled,Ib);return null})}));return null}):Bc.ULS.sendTraceTag(593859840,
324,10,"getHeaderApi not available")};ae.prototype.Fji=function(T){var Oa=this;this.cUb.dli().continueWith(function(){Oa.PWa.huj(T)})};ae.prototype.Dji=function(T){function Oa(){}var Ib="gopremium",hc=null;T?(T.experience&&""!==Object(Oc.a)(String,T.experience)&&(Ib=Object(Oc.a)(String,T.experience)),T.onTaskComplete&&(Oa=T.onTaskComplete),T.campaignId&&""!==Object(Oc.a)(String,T.campaignId)&&(hc=Object(Oc.a)(String,T.campaignId))):Bc.ULS.sendTraceTag(51675402,324,50,"Experience not given, using default experience");
this.Wgf(Ib,Oa,hc)};ae.prototype.Wgf=function(T,Oa,Ib){var hc=this;Ib=void 0===Ib?null:Ib;if(this.Q8b&&this.Sqb){var nd={};nd.experience=T||"gopremium";nd.campaignId=Ib||qf.b(this.W0,this.WCc,Object(Oc.a)(String,nd.experience),!0);this.La.processAction(af.a.gOf,2);Bc.ULS.sendTraceTag(51675403,324,50,"Launching Freemium Upsell dialog: "+nd.experience);try{var Td=Object.assign(new Uf,{instance:this.Sqb,Ghc:nd,t4f:Oa||function(){},EPf:function(Ed){Bc.ULS.sendTraceTag(51675405,324,50,"Dime launch result: "+
Ed.status)},LKf:function(){Bc.ULS.sendTraceTag(51675406,324,10,"Dime launch error");hc.Q8b=!1;hc.Sqb=null}});this.PWa.qsj(Td)}catch(Ed){Bc.ULS.sendTraceTag(51675407,324,10,"Dime launch error: "+Ed.message),this.Q8b=!1,this.Sqb=null,T={},this.La.ze(af.a.R8b,2,(T.experience=nd.experience,T))}}else Bc.ULS.sendTraceTag(39978392,324,10,"FreemiumUpsellDialogDependencies not loaded"),nd={},this.La.ze(af.a.R8b,2,(nd.experience=T,nd))};ae.prototype.Lhf=function(){var T=this;this.cUb.fli().continueWith(function(){try{var Oa=
Ze.a.Kl(we.AFrameworkApplication.uiCulture),Ib=qf.c(T.W0);if(Ib){Oa={partnerId:Ib,language:Oa};Oa.sessionId=we.AFrameworkApplication.userSessionId;Oa.authHint=we.AFrameworkApplication.ga.Ua("UserPrincipalName");var hc=we.AFrameworkApplication.ga.Ua("Puid")||"";""!==hc&&(Oa.userInfo={puid:hc});T.Sqb=new Dime(Oa);T.Q8b=!0;Bc.ULS.sendTraceTag(592721856,324,50,"Dime initialized")}else Bc.ULS.sendTraceTag(51675409,324,15,"App not supported")}catch(nd){Bc.ULS.sendTraceTag(51675410,324,10,"FreemiumUpsellDialogDependencies failed: "+
nd.message)}},3)};ae.prototype.Bud=function(){return this.PWa.Bud()};ae.prototype.zud=function(){return this.PWa.zud()};Object(Jc.a)(ae,"InProductMessagingUIManager",null,[662]);re.prototype.Init=function(T){this.Zfe=T};re.prototype.SendTrace=function(T,Oa){Bc.ULS.sendTraceTag(34182235,this.Zfe,this.BVa[T],"{0}",Oa)};Object(Jc.a)(re,"DefaultNetworkingManager",null,[691]);var mh=b(275),Pa=b(372),qb=b(100);je.prototype.huj=function(T){T&&(InProductMessaging.Networking.NetworkingMgr=new re,InProductMessaging.Networking.NetworkingMgr.Init(387),
InProductMessaging.Init(T.Nsj,T.pti,T.DIg,T.kui,T.locale,Object(mc.a)(this,this.OBi,"onDismissFirstRunExperience"),T.Y7f),this.LQa(vg.xOi,!0))};je.prototype.qsj=function(T){var Oa=this;if(T&&T.instance&&T.Ghc){var Ib=document.getElementById("wacDimeContainer");Ib||(Ib=document.createElement("div"),Ib.id="wacDimeContainer",document.body.appendChild(Ib));we.AFrameworkApplication.ga.ra("DimeFocusManagerIsEnabled")&&this.LQa("wacDimeContainer",!1);T.Ghc.parentElementId="wacDimeContainer";T.instance.launch(T.Ghc,
T.t4f).then(function(hc){Oa.QFb();document.body.removeChild(Ib);T.EPf(hc)}).catch(function(hc){Oa.QFb();document.body.removeChild(Ib);T.LKf(hc)})}else throw Error.argument("DimeExperienceUISettings");};je.prototype.LQa=function(T,Oa){if(this.hc&&T&&(T=document.getElementById(T),this.t4h(T),T=this.hc.rM("InProductMessagingFocusId"))){var Ib=this.hc.Ii;Ib&&"InProductMessagingFocusId"===Ib.name||this.hc.nR("InProductMessagingFocusId",!1);Oa&&this.TIf(T.scope)}};je.prototype.t4h=function(T){var Oa=!1;
Oa=void 0===Oa?!0:Oa;var Ib=this.hc.ii("InProductMessagingFocusId");Ib.parent=mh.AFrame.oT;var hc=new Pa.DOMFocusListing(function(){return T});hc.I$a=Oa;hc.Sn(3);hc.Sn(2);hc.Sn(4);Oa=this.hc.Jra(function(){return T},Ib,hc);Oa.KFb();Oa.YZ=!0;Oa.KGa=!0};je.prototype.TIf=function(T){T.Qk(qb.FocusManager.instance().I1);T.Qk(qb.FocusManager.instance().J1);T.bindAction(qb.FocusManager.instance().I1,af.a.aRe);T.bindAction(qb.FocusManager.instance().J1,af.a.$Qe)};je.prototype.QFb=function(){this.hc&&(this.hc.jca("InProductMessagingFocusId"),
this.hc.yPa("InProductMessagingFocusId"))};je.prototype.OBi=function(T,Oa){this.QFb();T=Object.assign(new Of,{completed:T,g2i:Oa});we.AFrameworkApplication.Eb.ze(af.a.pwh,2,T)};je.prototype.Bud=function(){var T=document.activeElement,Oa=this.hc.hQ();return T&&Oa&&Oa.jf&&T===Oa.jf.ho?(Oa.jf.ol(T),Oa.rxa()?32:8):4};je.prototype.zud=function(){var T=document.activeElement,Oa=this.hc.hQ();return T&&Oa&&Oa.jf&&T===Oa.jf.firstElement?(Oa.jf.ol(T),Oa.oNa()?32:8):4};Object(Jc.a)(je,"InProductMessagingUIWrapper",
null,[661]);var tc=b(144);rd.prototype.di=function(T){T.register(Af,"Common.App.InProductMessaging.DependencyDownloader").as("Common.App.InProductMessaging.IDependencyDownloader").zc().Ic(function(){return new Af});T.register(je,"Common.App.InProductMessaging.InProductMessagingUIWrapper").as("Common.IInProductMessagingUIWrapper").zc().Ic(function(){return new je(qb.FocusManager.instance())});T.register(ae,"Common.App.InProductMessaging.InProductMessagingUIManager").as("Common.IInProductMessagingUIManager").zc().Ic(function(){return new ae(we.AFrameworkApplication.Eb,
T.resolve("Common.IInProductMessagingUIWrapper"),T.resolve("Common.App.InProductMessaging.IDependencyDownloader"),we.AFrameworkApplication.sa.Pa.Lj,we.AFrameworkApplication.sa.Pa.Kba)});T.register(Lf,"Common.App.InProductMessaging.InProductMessagingActor").zc().Ic(function(){return new Lf(we.AFrameworkApplication.Eb,we.AFrameworkApplication.sa,T.resolve("Common.IInProductMessagingUIManager"))});T.register(Yf,"Common.App.InProductMessaging.FirstRunExperienceUISettings").as("Common.IFirstRunExperienceUISettings").zc().Ic(function(){return new Yf});
T.register(Of,"Common.App.InProductMessaging.FirstRunExperienceViewData").as("Common.IFirstRunExperienceViewData").zc().Ic(function(){return new Of});this.rb=T};rd.prototype.init=function(){var T=this;this.rb.resolve("Common.App.InProductMessaging.InProductMessagingActor").Mg();we.AFrameworkApplication.ga.$v(function(){we.AFrameworkApplication.sa.Pa.isReactSharedHeaderUxEnabled&&tc.a.get_instance().xl(15,function(){T.rb.mc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Oa){T.rb.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").D4h(Oa)})});
we.AFrameworkApplication.ga.ra("FreemiumUpsellShowDialogIsEnabled")&&qf.a()&&!$e.a.xA&&1!==we.AFrameworkApplication.sa.Pa.Lj&&T.rb.mc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Oa){Oa.isFeatureEnabled("MsoPremiumBadge",!0).then(function(Ib){!Ib&&Oa.isFreemiumUpsellEnabled()&&T.rb.resolve("Common.App.InProductMessaging.InProductMessagingUIManager").Lhf();return null})})})};rd.prototype.dispose=function(){};rd.main=function(){Ff.a.instance.mj(new rd)};tl.Object.defineProperties(rd.prototype,
{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.InProductMessaging"}}});Object(Jc.a)(rd,"InProductMessagingPackage",null,[4,5]);Yd.prototype.F8c=function(T){var Oa=new Sys.StringBuilder(this.vv.aHb);Oa.append("RoamingServiceHandler.ashx?action=");Oa.append("getFirstRunExperienceSettings");Oa.append("&");Oa.append(this.ked(T));Oa.append("&");Oa.append(we.AFrameworkApplication.hj);we.AFrameworkApplication.Hd.Ul(Oa.toString(),1,null,null,!0,2,Object(mc.a)(this,this.SJa,"getRequestSuccessCallback"),
Object(mc.a)(this,this.fja,"getRequestFailureCallback"),null)};Yd.prototype.G8c=function(T){var Oa=new Sys.StringBuilder(this.vv.aHb);Oa.append("RoamingServiceHandler.ashx?action=");Oa.append("saveFirstRunExperienceSettings");Oa.append("&");Oa.append(we.AFrameworkApplication.hj);Oa=Oa.toString();T=ud.c(T);we.AFrameworkApplication.Hd.Ul(Oa,2,T,null,!0,4,Object(mc.a)(this,this.ESi,"postRequestSuccessCallback"),Object(mc.a)(this,this.JOa,"postRequestFailureCallback"),null)};Yd.prototype.SJa=function(T){var Oa=
!1,Ib=null;try{if(0<T.data.fe.length){var hc=Object(Oc.a)(Object,ud.a(T.data.fe)),nd=hc?hc[this.vv.BUc]:null;nd&&(Ib=Object(Oc.a)(Object,ud.a(nd.toString())))}Oa=!0}catch(Td){this.fja(null)}Oa&&this.xhb&&this.xhb(T.data,Ib)};Yd.prototype.fja=function(T){this.thb&&this.thb(T?T.data:null)};Yd.prototype.ESi=function(T){this.gbe&&this.gbe(T?T.data:null)};Yd.prototype.JOa=function(T){this.Fjb&&this.Fjb(T?T.data:null)};Yd.prototype.ked=function(T){for(var Oa=new Sys.StringBuilder("requestedsettings="),
Ib=0;Ib<T.count;Ib++)Oa.append(T.na(Ib)),Ib<T.count-1&&Oa.append(";");return Oa.toString()};Object(Jc.a)(Yd,"FirstRunExperienceRequestHandler",null,[]);ge.prototype.ePd=function(T){T?(this.vv=T,this.zci()&&(Bc.ULS.sendTraceTag(51675532,306,50,"Initiating call to get FRE data for current user from Roaming Settings Service"),T=new cg.a,T.add(this.vv.BUc),this.RQb=new Yd(this.vv,Object(mc.a)(this,this.SJa,"getRequestSuccessCallback"),Object(mc.a)(this,this.fja,"getRequestFailureCallback"),null,Object(mc.a)(this,
this.JOa,"postRequestFailureCallback")),this.RQb.F8c(T)),(this.vv.Fyb||we.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUITest",!1))&&this.fPd()):Bc.ULS.sendTraceTag(51675531,306,10,"Invalid launcherSettings")};ge.prototype.zci=function(){try{if(this.vv.Fyb)return!0;if(!we.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceEnabled",!0)||we.AFrameworkApplication.ga.ra("IsAnonymousUser"))return!1;if(this.vv.y$h||
this.vv.h6a||we.AFrameworkApplication.ga.ra("IsO365ConsumerHost"))return!0;var T=we.AFrameworkApplication.ga.Ua("FlightId");return-1!==(T?T.toString().toLowerCase():"").indexOf("firstrunexperienceui")}catch(Oa){Bc.ULS.sendTraceTag(576582624,306,10,"Error checking setting {0}",Oa?Oa.toString():null)}return!1};ge.prototype.CRf=function(T){var Oa={},Ib={};Ib.FREDisplayedDate=(new Date).toUTCString();Ib.VersionDisplayed=T;Ib.RemindMeLater=!1;Oa[this.vv.BUc]=ud.c(Ib);Bc.ULS.sendTraceTag(51675533,306,50,
"Initiating call to save FRE data for current user from Roaming Settings Service");this.RQb&&this.RQb.G8c(Oa)};ge.prototype.SJa=function(T,Oa){T=T?+T.R2-+T.AE:-1;T>this.vv.uQf?Bc.ULS.sendTraceTag(51675534,306,50,"Call to Roaming Settings Service took {0}ms. This is more than the {1}ms threshold. A new attempt will be made next time the user starts a new session.",T,this.vv.uQf):Oa?this.erj(Oa)?(Bc.ULS.sendTraceTag(51675536,306,50,"FRE data already exists for current user. FRE UI should be displayed again. User selected 'Remind me later' option more than {0} hours ago.",
this.vv.Kmf),this.fPd()):Bc.ULS.sendTraceTag(51675537,306,100,"Current user has already seen this version of the FRE. No further action required."):(Bc.ULS.sendTraceTag(51675535,306,50,"No FRE data found for current user. FRE UI should be displayed."),this.fPd())};ge.prototype.fja=function(T){Bc.ULS.sendTraceTag(51675541,306,10,"First Run Experience failed to GET data from Roaming Settings Service with status: {0}",T?T.httpStatus:-1)};ge.prototype.JOa=function(T){Bc.ULS.sendTraceTag(51675542,306,
10,"First Run Experience failed to POST data to Roaming Settings Service with status: {0}",T?T.httpStatus:-1)};ge.prototype.fPd=function(){var T=this,Oa=dg.a.instance.Hh("Common.ISystemInitiatedFeedback");Oa?this.t_f(Oa):(Bc.ULS.sendTraceTag(51675543,306,50,"Error resolving ISystemInitiatedFeedback"),we.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.FirstRunExperienceUIResolveFuture",!0)&&((Oa=dg.a.instance.mc("Common.ISystemInitiatedFeedback"))?Oa.execute(function(Ib){T.t_f(Ib)}):
Bc.ULS.sendTraceTag(539494111,306,50,"Error resolving ISystemInitiatedFeedback Future")))};ge.prototype.t_f=function(T){if(T){var Oa=this.vv.Gwh;Oa&&(we.AFrameworkApplication.Gka(Oa),we.AFrameworkApplication.oic(Oa));Bc.ULS.sendTraceTag(51675544,306,50,"Attempting to display First Run Experience UI using floodgate.",Oa);T.logActivity("ShowFirstRunExperienceUIV2",null);window.addEventListener?(this.khb=Object(mc.a)(this,this.MCi,"onFirstRunExperienceCampaignEvent"),window.addEventListener("FGWebSurfaceEvent",
this.khb,!0),window.addEventListener("FRELaunchedEvent",this.khb,!0)):(Bc.ULS.sendTraceTag(51675545,306,50,"FRE V2 UI triggered. Attempting to save FRE data."),this.CRf(this.vv.currentVersion))}else Bc.ULS.sendTraceTag(539494112,306,50,"Invalid ISystemInitiatedFeedback")};ge.prototype.MCi=function(T){if(T){var Oa=T.detail;T=T.type;var Ib=this.vv&&this.vv.campaignId?this.vv.campaignId.split("-")[0]:null;if("FRELaunchedEvent"===T||Ib&&Oa&&Oa.id&&-1!==Oa.id.indexOf(Ib))Oa.success&&(Bc.ULS.sendTraceTag(51675546,
306,50,"FRE V2 UI has been launched. Attempting to save FRE data."),this.CRf(this.vv.currentVersion)),window.removeEventListener&&(window.removeEventListener("FGWebSurfaceEvent",this.khb,!0),window.removeEventListener("FRELaunchedEvent",this.khb,!0))}};ge.prototype.erj=function(T){if("RemindMeLater"in T&&"FREDisplayedDate"in T){if("true"===T.RemindMeLater.toString()&&(+new Date-+new Date(T.FREDisplayedDate.toString()))/36E5>this.vv.Kmf)return!0}else if(we.AFrameworkApplication.ga.ra("WacShowVersionBasedFREToAllUsers")&&
"VersionDisplayed"in T&&T.VersionDisplayed<this.vv.currentVersion)return Bc.ULS.sendTraceTag(528262853,306,50,"Current version is higher so FRE V2 UI should be displayed again."),!0;return!1};Object(Jc.a)(ge,"FirstRunExperienceLauncher",null,[578]);jd.prototype.di=function(T){this.rb=T;this.rb.register(578,"Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher").zc().Ic(function(){return new ge})};jd.prototype.init=function(){};jd.prototype.dispose=function(){};jd.main=function(){Ff.a.instance.mj(new jd)};
tl.Object.defineProperties(jd.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.FirstRunExperienceLauncher"}}});Object(Jc.a)(jd,"FirstRunExperienceLauncherPackage",null,[4,5]);var dd=b(216),Kd=b(350),yd=b(308),ze=b(353),te=b(1),lf=b(36),bf=b(9),xf=b(521),Og=b(14),mf=xf.a;vm(zd,mf);zd.prototype.MU=function(){var T={};T.id=this.xc;var Oa=Og.a.instance.ea(2183);T.DialogMessage=Oa;return T};tl.Object.defineProperties(zd.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"ClipboardReadPermissionAskDialog"}}});
Object(Jc.a)(zd,"ClipboardReadPermissionAskDialog",xf.a,[]);var bg=b(48);mb.prototype.Z$e=function(T){return T?this.sessionStateId===T.sessionStateId&&this.sessionId===T.sessionId:!1};mb.prototype.isFromCurrentSession=function(T){return this.sessionId===T.ya.UserSessionId};Object(Jc.a)(mb,"SourceItem",null,[]);vm(Nb,mb);Nb.prototype.isEqual=function(T){return T&&Object.getType(T)===Nb?this.Z$e(T)&&this.activeFloatingObjectControlId===T.activeFloatingObjectControlId&&this.sheetName===T.sheetName:!1};
Nb.prototype.toString=function(){return this.type.toString()};Object(Jc.a)(Nb,"ArtSourceItem",mb,[]);var Wf;(function(T){T[T.valid=0]="valid";T[T.notPairwiseDisjoint=1]="notPairwiseDisjoint";T[T.cutNotSupportedInDiscontinuousSelection=2]="cutNotSupportedInDiscontinuousSelection";T[T.notValidForm=3]="notValidForm";T[T.temporarilyBlockedCopy=4]="temporarilyBlockedCopy"})(Wf||(Wf={}));Object(Jc.b)("CopySourceValidationOptions",Wf);var zf=b(43);vm(nc,mb);nc.prototype.isEqual=function(T){return T&&Object.getType(T)===
nc?this.Z$e(T)&&zf.Q(this.ranges,T.ranges)&&this.sheetName===T.sheetName:!1};nc.prototype.toString=function(){return zf.i(this.ranges,",",this.$,!1)};Object(Jc.a)(nc,"RangeSourceItem",mb,[]);id.DMj="PasteError_FailedToReadFromClipboard_UserHashMismatchError";Object(Jc.a)(id,"ExpectedErrorNames",null,[]);gb.VV="text/plain";gb.html="text/html";gb.png="image/png";gb.SN="data/shadow-workbook";gb.hci="metadata/is-last-copy-was-external";gb.Q9h="metadata/is-last-copy-was-external-XLO-source";gb.bTg="metadata/chrome-extension-id";
gb.g1c="copyId";gb.tDg="metadata/additional-signature-data-attributes";Object(Jc.a)(gb,"ClipboardDataFormat",null,[]);var tg=b(45),Hf=b(20),xc=b(34);Ce.prototype.xJa=function(){return Ce.aQi};Ce.prototype.wHh=function(){return this.l7b&&1===this.l7b.length?this.xHh(this.l7b[0]):null};Ce.prototype.xHh=function(T){var Oa=Hf.g(this.$),Ib=Oa.$a.Kj(T),hc=Oa.Lg(T,Ib);Oa=Oa.rtl;if(!hc)return null;T=Hf.g(this.$).fg(Ib);var nd=T.Dn;if(!nd.Rd(hc))return null;hc=nd.Jf(hc);var Td=hc.topLeft.y,Ed=hc.bottomRight.y,
he=Oa?hc.bottomRight.x:hc.topLeft.x;hc=Oa?hc.topLeft.x:hc.bottomRight.x;var Pe=new tg.a(hc+(Oa?-81:81),Ed+38+6);if(nd.o_a(Pe))return this.U2a(T,nd,Ib,hc,Ed,Oa?12:-3,66);Pe=new tg.a(hc+(Oa?-81:81),Ed);if(nd.o_a(Pe))return this.U2a(T,nd,Ib,hc,Ed,Oa?20:3,22);Pe=new tg.a(hc,Ed+38+6);if(nd.o_a(Pe))return this.U2a(T,nd,Ib,hc,Ed,-81+(Oa?18:0),66);hc=new tg.a(he+(Oa?81:-81),Ed);if(nd.o_a(hc))return this.U2a(T,nd,Ib,he,Ed,-81+(Oa?12:-6),22);Ed=new tg.a(he,Td-38-6);return nd.o_a(Ed)?this.U2a(T,nd,Ib,he,Td,
Oa?15:0,16):this.U2a(T,nd,Ib,Oa?nd.topLeft.x:nd.bottomRight.x,nd.bottomRight.y,-81+(Oa?15:-6),22)};Ce.prototype.U2a=function(T,Oa,Ib,hc,nd,Td,Ed){var he=Hf.g(this.$),Pe=he.rtl;T=Sys.UI.DomElement.getLocation(T.domElement);hc=new Sys.UI.Point(hc+(Pe?0:T.x)-Oa.topLeft.x,nd+T.y-Oa.topLeft.y);Pe&&(he=he.view.visibleArea,hc.x=he.bottomRight.x-he.topLeft.x-hc.x,2===Ib||4===Ib)&&(hc.x+=Oa.bottomRight.x);hc=xc.a(this.$).OJa(hc);return new Sys.UI.Point(hc.x+Td,hc.y+Ed)};tl.Object.defineProperties(Ce.prototype,
{sDg:{configurable:!0,enumerable:!0,get:function(){return this.dgg}},Yji:{configurable:!0,enumerable:!0,get:function(){return this.lng}},x_i:{configurable:!0,enumerable:!0,get:function(){return this.Xpg}},qsh:{configurable:!0,enumerable:!0,get:function(){return this.Ujg}}});Ce.aQi=["PasteRecoveryUI"];Object(Jc.a)(Ce,"PasteRecoveryUI",null,[699]);var bd=b(78),Bd=b(306);Pd.jvg="ActiveSelection";Pd.SN="ShadowWorkbook";Pd.Aeg="GVML";Pd.VV="PlainText";Pd.html="Html";Pd.NJg="Bitmap";Object(Jc.a)(Pd,"PayloadType",
null,[]);Ad.Suj="Slice4";Ad.Tuj="Slice5";Ad.Uuj="Slice6";Object(Jc.a)(Ad,"SliceName",null,[]);pe.Wvi="NotCalled";pe.success="Success";pe.failed="Failed";Object(Jc.a)(pe,"SucceededPopulatingSystemClipboardOptions",null,[]);var Ld=b(355),Od;(function(T){T[T.valid=0]="valid";T[T.destinationRangesIsEmpty=1]="destinationRangesIsEmpty";T[T.discontinuousSelectionNotSupportPasteFromExternal=2]="discontinuousSelectionNotSupportPasteFromExternal";T[T.discontinuousSelectionNotSupportPasteCrossSession=3]="discontinuousSelectionNotSupportPasteCrossSession";
T[T.multipleSourcesAndMultipleDestinationsAreNotSupported=4]="multipleSourcesAndMultipleDestinationsAreNotSupported";T[T.multipleDestinationsAreNotMultiplyOfSourceRange=5]="multipleDestinationsAreNotMultiplyOfSourceRange";T[T.sourceAndDestinationAreOverlapping=6]="sourceAndDestinationAreOverlapping";T[T.copySourceNotValid=7]="copySourceNotValid";T[T.cutNotSupportedInDiscontinuousSelection=8]="cutNotSupportedInDiscontinuousSelection";T[T.pasteLinkNotSupportMultipleDestination=9]="pasteLinkNotSupportMultipleDestination";
T[T.temporarilyBlockedPaste=10]="temporarilyBlockedPaste";T[T.unknown=100]="unknown"})(Od||(Od={}));Object(Jc.b)("PasteValidationOptions",Od);var ef=b(56),ag=b(41),lg=b(141),$f=b(35),Aa=b(148),Ob=b(337),Ec=b(27),md=b(459),Md=b(8),Me=b(19),Qe=b(105),sf=b(154),Vf=b(132),Da=b(585),rb=b(101),$b=b(335),vc=lf.a;vm(bc,vc);bc.prototype.HBg=function(T){this.addHandler(bc.tzd,T)};bc.prototype.D5i=function(T){this.removeHandler(bc.tzd,T)};bc.prototype.copy=function(T){var Oa=this;T.stopwatch=this.$.Ub.Fc("UserAction",
bg.b().pi(T.ribbonCommandInfo.command)+"ClientSide");if(this.fo){var Ib=ef.GetServiceTaskFactory.Xa(this.$.da,478,479,0);$f.TaskExtensions.Ba(Ib,function(){Oa.pasteShortcutManager=Ib.result},this.ma,3)}var hc=!!Jf(this.fK);te.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!$e.a.rC&&(this.T5a=!1);this.Hv("Copy/before/"+Kd.a[T.ribbonCommandInfo.method],!1,void 0,!0,T.copyPasteTargetType).catch(function(){});var nd=-1985798686===T.ribbonCommandInfo.command;
if(1===this.gridView.Te&&(nd=this.Er.q$e(this.gridView.ha.va.selectedRanges,nd))){var Td=bc.YYg(nd);this.wya(Td,Wf[nd],!1);return Promise.reject(!1)}T.userHash=this.userHash;T.id=gg.a.create().toString();var Ed=this,he=this;return this.p2b.onCopy(T).then(function(Pe){Pe.isAsyncCopy||T.stopwatch.stop();Ed.pasteIndicationManager.FGe();Bc.ULS.sendTraceTag(24150883,0,50,"CopyPasteInfrastructure.OnCopy: Copy operation finished successfully. {0}",Ld.d(T));Ed.ymi(Pe,hc);!T.isFormatPainter&&Ed.fo&&(Ed.pasteShortcutManager?
Ed.pasteShortcutManager.dgh():Bc.ULS.shipAssertTag(537167823,0,!1,"Copy: pasteShortcutManager is null."));return Promise.resolve(!0)},function(Pe){var hf=!1,pg="none",fg=bc.Hqb,Xg=!0,yg=-1,Rh=bc.copyErrorName+bc.nIa,Kh=!1,Yg=null;if(Pe){Yg=Pe.copyContext;yg=Pe.reason;Rh+=bc.DJa(Pe);Pe.message&&(fg=Pe.message);var ji=bc.XYg(Pe);if(ji)if(3===ji.copyErrorName)hf=!0,fg=pg="Async Copy canceled by the user.",Xg=!1;else if(Ec.a.Pq(ji.ewaErrors))if(fg=he.r$b(ji.ewaErrors),Ec.a.gh(ji.ewaErrors,bc.operationSucceededWithAlert))Kh=
hf=!0;else if(Ec.a.gh(ji.ewaErrors,bc.pasteDataLimitHit)||Ec.a.gh(ji.ewaErrors,bc.copyThrottlingError))hf=!0;13===Pe.reason?(hf=!0,Xg=!1):11===Pe.reason&&(Xg=!1)}hf?Bc.ULS.sendTraceTag(36304157,0,15,"CopyPasteInfrastructure.OnCopy: Copy operation failed with an expected error. clearStateNeeded: {0}, Friendly message: {1}, Error Message: {2}, CommandParameters: {3}",Xg,pg,Pe?he.getStringifiedError(Pe):"null",Ld.d(T)):Bc.ULS.sendTraceTag(24150912,0,10,"CopyPasteInfrastructure.OnCopy: Copy operation failed with an unexpected error. clearStateNeeded: {0}, Error Message: {1}, CommandParameters: {2}",
Xg,Pe?he.getStringifiedError(Pe):"null",Ld.d(T));Xg&&he.Hv("Copy/fail/"+Kd.a[T.ribbonCommandInfo.method],!0,void 0,void 0,T.copyPasteTargetType).catch(function(){});he.xmi(T,hf,fg,Rh,yg,Kh,Yg);return Promise.reject(Pe)})};bc.prototype.paste=function(T){var Oa=this;T.stopwatch=this.$.Ub.Fc("UserAction",bg.b().pi(T.ribbonCommandInfo.command)+"ClientSide");te.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!$e.a.rC&&(Bc.ULS.sendTraceTag(537167822,0,50,"CopyPasteInfrastructure.OnPaste: Cross-app shadow workbook paste is enabled"),
this.T5a=!1,T.clipboardPicklingApiDataFormatsToRead=[gb.SN]);Hf.g(this.$).Ji&&Hf.g(this.$).Ji.Y6(this.Pdd(T.ribbonCommandInfo.command),T.stopwatch.id);if(T.isPasteCommandFromRecoveryUI){var Ib=this.$.da.Aa(406);var hc=yd.a.clone(Ib.pqd);Ib=Ib.$pd;T.pasteRecoveryCachedClipboardItems=Ib?Ib[bc.UCf]:null}else hc=yd.a.clone(this.gridView.ha.va.selectedRanges);T.originalDestinations=hc;T.expandDestinations=this.EXc(T.originalDestinations,T.commandType);if(this.SXc(T.commandType,T.expandDestinations)||this.$Pg())return T.userHash=
this.userHash,T.id=gg.a.create().toString(),te.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PerfImpactExperimentForAsyncApi",!1)&&!$e.a.rC&&(T.clipboardReadPermissionPromptShown=!1,T.clipboardAsyncApiDataFormatsToRead=[gb.VV+"Async"],this.p2b.shouldShowClipboardReadPermissionDialog().then(function(nd){nd&&(T.clipboardReadPermissionPromptShown=!0,new zd(Oa.$));return Promise.resolve(!0)},function(){return Promise.resolve(!0)})),this.p2b.onPaste(T).then(function(nd){return Oa.gmc(nd,T)},
function(nd){return Oa.MCb(T,nd)});this.$.Ce(927125067,bd.a.Wb,30,null);Bc.ULS.sendTraceTag(24150913,0,15,'CopyPasteInfrastructure.OnPaste: paste was triggered but the estimated destination range is not editable, do nothing. ExpandDestinations: {0}, CommandType: {1}, copyPasteTargetType="{2}"',zf.i(T.expandDestinations,",",this.$,!1),T.commandType,T.copyPasteTargetType);return Promise.resolve(!0)};bc.prototype.Pdd=function(T){if(te.EwaSettings.isChangeGateEnabled("OfficeVSO:4313497_PasteOptionPerfTelemetry"))switch(T){case 1804571062:return 6;
case -185374993:return 7;case 1766348718:return 8}return 3};bc.prototype.$Pg=function(){return!!Hf.g(this.$).ha.Qa.activeFloatingObjectControlId&&this.$.xs(null,!1,470)};bc.prototype.uzb=function(){var T=Jf(this.fK);return T&&T.commandParameters?T.commandParameters.copyPasteTargetType:0};bc.prototype.gci=function(){return!!Jf(this.fK)&&de(Jf(this.fK),this.$)};bc.prototype.Hv=function(T,Oa,Ib,hc,nd){var Td=this;Ib=void 0===Ib?!1:Ib;hc=void 0===hc?!1:hc;nd=void 0===nd?0:nd;try{this.fo&&this.pasteShortcutManager&&
this.pasteShortcutManager.L4b();var Ed=nd,he=this.Wii();if(!hc&&2===he)return Bc.ULS.sendTraceTag(537167821,0,50,"CopyPasteInfrastructure.ClearState clipboard won't be cleared as there's art in the clipboard. clearClipboardContent = '{0}', isExplicit = '{1}', isForce = '{2}', Current CCP operation copyPasteTargetType = '{3}', LastCopyPasteTargetType = '{4}'",Oa,Ib,hc,nd,he),Promise.reject(null);Ed||(Ed=he);var Pe=this.$.Ub.Fc("UserAction","ClearCopyState"),hf=Pe.id;Bc.ULS.sendTraceTag(537167820,0,
50,"CopyPasteInfrastructure.ClearState clear clipboard state. clearClipboardContent = '{0}', isExplicit = '{1}', isForce = '{2}', Current CCP operation copyPasteTargetType = '{3}', LastCopyPasteTargetType = '{4}'",Oa,Ib,hc,nd,he);this.Er.Svb();this.CXi();return this.p2b.onCancelCopy(Oa).then(function(){Oa&&te.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!$e.a.rC&&(Td.T5a=!1);Pe.stop();Td.zif(T,hf,!0,Ib,Oa,"","",Pe.Ac,Ed);return Promise.resolve(!0)},function(pg){Bc.ULS.sendTraceTag(24150915,
0,15,"CopyPasteInfrastructure.ClearState: error during call to copyPasteFlowManager.OnClear(). error: {0}",pg?Td.getStringifiedError(pg):"null");Pe.stop();var fg=bc.oQg+bc.nIa,Xg=bc.Hqb;pg&&(fg+=bc.DJa(pg),pg.message&&(Xg=pg.message));Td.zif(T,hf,!1,Ib,Oa,Xg,fg,Pe.Ac,Ed);return Promise.reject(pg)})}catch(pg){return Promise.reject(null)}};bc.prototype.P0b=function(T,Oa,Ib,hc,nd){Ib=void 0===Ib?!1:Ib;hc=void 0===hc?!1:hc;nd=void 0===nd?0:nd;return hc||!te.EwaSettings.la(686)||this.Lch()?this.Hv(T,Oa,
Ib,hc,nd):(Bc.ULS.sendTraceTag(537167819,0,50,"CopyPasteInfrastructure.ClearStateOnlyIfClipboardHasContentFromSameSession clipboard won't be cleared as there is no content in the clipboard from the current session"),Promise.reject(null))};bc.prototype.wya=function(T,Oa,Ib){Bc.ULS.sendTraceTag(590705172,0,50,"CopyPasteInfrastructure.PopupDiscontinuousSelectionErrorDialog: Blocked CCP due to discontinuous selection, reason: {0}",Oa);if(te.EwaSettings.isChangeGateEnabled("OfficeVSO:5352069_ReportDiscontinousCCPErrorsAsQos")){var hc=
new rb.a;hc.ia("reason",Oa);Da.a(sf.a.discontinuousSelectionBlocking,[Ib?Vf.a.WPi:Vf.a.PZg],!0,!0,!1,!1,hc)}T=Ec.a.jd(1,1,735,T,0,371863010,"DiscontinuousSelectionBlocking");te.EwaSettings.az()?new Ob.a(this.$,T):(T=new Aa.ErrorDialog(this.$,T),T.initialize(),T.mf())};bc.prototype.Wii=function(){var T=Jf(this.fK);return T&&T.sourceItem?Object.getType(T.sourceItem)===Nb?2:1:0};bc.prototype.dragDropCells=function(T,Oa,Ib,hc,nd){var Td=this;nd=void 0===nd?!1:nd;T.stopwatch=this.$.Ub.Fc("UserAction",
"DragDropClientSide");this.Hv("DragDrop/before/"+Kd.a[T.ribbonCommandInfo.method],!1,void 0,void 0,T.copyPasteTargetType).catch(function(){});var Ed=nd?2:1,he=0;he=nd?4:hc?256:128;var Pe={encounteredDeploymentErrors:!1};Pe.commandParameters=T;T.userHash=this.userHash;T.id=gg.a.create().toString();return this.Er.pasteRange(T.ribbonCommandInfo,zf.q(Oa,this.$),zf.q(Ib,this.$),Ed,he,[T.stopwatch],Pe,!1).then(function(){Bc.ULS.sendTraceTag(537167818,0,50,'CopyPasteInfrastructure.DragDropCells: success. copyPasteTargetType="{0}"',
T.copyPasteTargetType);Td.gridView.ha.selectionType=-1;Td.Ord(T,Ed,Oa,Ib,Pe);return Promise.resolve(!0)},function(hf){Bc.ULS.sendTraceTag(537167817,0,10,'CopyPasteInfrastructure.DragDropCells: {0}, copyPasteTargetType="{1}"',hf?Td.getStringifiedError(hf):"null",T.copyPasteTargetType);return Td.Ixd(hf,T,Ed,Oa,Ib,Pe)})};bc.prototype.fdh=function(T,Oa,Ib,hc,nd){var Td=this;nd=void 0===nd?!1:nd;T.stopwatch=this.$.Ub.Fc("UserAction","DragDropReplaceClientSide");this.P0b("DragDropReplace/before/"+Kd.a[T.ribbonCommandInfo.method],
!1,void 0,void 0,T.copyPasteTargetType).catch(function(){});var Ed=nd?2:1,he=0;he=nd?4:hc?256:128;var Pe={encounteredDeploymentErrors:!1};Pe.commandParameters=T;te.EwaSettings.getBooleanFeatureGate(Bd.a.w5b,!1)&&(T.isDragInsert=!1);T.userHash=this.userHash;T.id=gg.a.create().toString();return this.Er.pasteRange(T.ribbonCommandInfo,zf.q(Oa,this.$),zf.q(Ib,this.$),Ed,he,[T.stopwatch],Pe,!1).then(function(){Bc.ULS.sendTraceTag(537167816,0,50,'CopyPasteInfrastructure.DragDropReplaceCells: success. copyPasteTargetType="{0}"',
T.copyPasteTargetType);Td.gridView.ha.selectionType=-1;Td.Ord(T,Ed,Oa,Ib,Pe);return Promise.resolve(!0)},function(hf){Bc.ULS.sendTraceTag(537167815,0,10,'CopyPasteInfrastructure.DragDropReplaceCells: {0}, copyPasteTargetType="{1}"',hf?Td.getStringifiedError(hf):"null",T.copyPasteTargetType);return Td.Ixd(hf,T,Ed,Oa,Ib,Pe)})};bc.prototype.edh=function(T,Oa,Ib,hc,nd){var Td=this;nd=void 0===nd?!1:nd;T.stopwatch=this.$.Ub.Fc("UserAction","DragDropInsertClientSide");this.P0b("DragDropInsert/before/"+
Kd.a[T.ribbonCommandInfo.method],!1,void 0,void 0,T.copyPasteTargetType).catch(function(){});var Ed=nd?2:1,he=zf.K(this.EXc([Ib],Ed)),Pe=this.$.fa.oa.sheetName,hf=this.$.fa.oa.sheetName,pg=zf.v(Oa,this.$);pg.SheetName=Pe;Pe=zf.v(he,this.$);Pe.SheetName=hf;hc=he.isRow||Oa.isRow||hc?1:0;var fg={encounteredDeploymentErrors:!1};T.isDragInsert=!0;fg.commandParameters=T;T.userHash=this.userHash;T.id=gg.a.create().toString();nd=this.Er.idh(fg,pg,Pe,nd,hc,T.ribbonCommandInfo);var Xg=this;return $b.c(nd.then(function(){Bc.ULS.sendTraceTag(537167814,
0,50,'CopyPasteInfrastructure.DragDropInsertCells: success. copyPasteTargetType="{0}"',T.copyPasteTargetType);Td.gridView.ha.selectionType=-1;Td.Ord(T,Ed,Oa,Ib,fg);return Promise.resolve(!0)},function(yg){Bc.ULS.sendTraceTag(537167813,0,10,'CopyPasteInfrastructure.DragDropInsertCells: {0}, copyPasteTargetType="{1}"',yg?Xg.getStringifiedError(yg):"null",T.copyPasteTargetType);return Xg.Ixd(yg,T,Ed,Oa,Ib,fg)})).CWR(function(){return!0})};bc.prototype.g6h=function(T,Oa){var Ib=this,hc=Jf(this.fK);if(!hc)return Bc.ULS.sendTraceTag(537167812,
0,50,"InsertCopiedCutCells: CopyContext must not be null or undefined"),hg.Task.Ta(!1);if(!ib(hc.sourceItem))return Bc.ULS.sendTraceTag(537167811,0,50,"InsertCopiedCutCells: CopyContext must be a Range"),hg.Task.Ta(!1);var nd=hc.sourceItem;if(!nd)return Bc.ULS.shipAssertTag(537167810,0,!!nd,"InsertCopiedCutCells: rangeSourceItem must not be null or undefined"),hg.Task.Ta(!1);if(!nd.isFromCurrentSession(this.$))return Bc.ULS.sendTraceTag(537167809,0,50,"InsertCopiedCutCells: rangeSourceItem is from a different session"),
hg.Task.Ta(!1);if(1<nd.ranges.length)return Bc.ULS.sendTraceTag(537167808,0,50,"InsertCopiedCutCells: multiple source ranges are not supported"),this.wya(2121,"InsertCopiedCutCells",!0),hg.Task.Ta(!1);hc=zf.K(nd.ranges);var Td=this.gridView.ha.va.Qd.clone();T=zf.K(this.EXc([Td],T));var Ed=this.tgf();nd=nd.sheetName;Td=this.$.fa.oa.sheetName;var he=zf.v(hc,this.$);he.SheetName=nd;var Pe=zf.v(T,this.$);Pe.SheetName=Td;return(T.Lh||hc.Lh?hg.Task.Ta(0):T.isRow||hc.isRow?hg.Task.Ta(1):this.h6h.z2b(this.$,
Hf.g(this.$).rtl)).CWR(function(hf){return Ib.Er.executeInsertCopiedCutCellsOperation(he,Pe,Ed,hf.result,Oa)}).continueWith(function(){Ed?Ib.Er.Svb():Ib.Hv("InsertCopiedCutCells/success/"+Kd.a[Oa.method],!0)})};bc.prototype.wmd=function(){var T=Jf(this.fK),Oa=this.gridView.ha.va.Dh;return!!T&&ib(T.sourceItem)&&Oa&&1===T.sourceItem.ranges.length};bc.prototype.tgf=function(){return this.ugf(-911352779)};bc.prototype.xhc=function(){return this.ugf(-1985798686)};bc.prototype.SXc=function(T,Oa){var Ib=
new lg.a(this.$.xa),hc=36===T,nd=Ib.te(4);T=2===this.uzb()&&Ib.te(1);hc=hc&&nd;Ib=!Ib.ik||!this.xhc()||!lg.a.k5b(Oa,Hf.g(this.$));return hc||T||this.$.xs(Oa,!0)&&Ib};bc.prototype.Pec=function(T,Oa){return this.Er.Pec(T,Oa)};bc.prototype.dispose=function(){vc.prototype.dispose.call(this);this.mm();this.fK.removeMetadataChangeListener(bc.Cmf)};bc.prototype.o5c=function(T,Oa,Ib,hc,nd,Td){if(!this.oUg(T.commandParameters.ribbonCommandInfo.command))return T.cseStatus=2,!1;if(Td&&Oa.Rd(hc))return T.cseStatus=
4,!1;if(Ib!==nd)return T.cseStatus=6,!1;if(te.EwaSettings.isChangeGateEnabled("OfficeVSO:5593878_PasteCSE_CCPErrorTests")&&(hc.width%Oa.width||hc.height%Oa.height))return T.cseStatus=16,!1;Oa=Oa.Jf(this.gridView.Ph);hc=hc.Jf(this.gridView.Ph);if(!Oa||!hc)return T.cseStatus=7,!1;nd=zf.v(Oa,this.$);nd.SheetName=Ib;Ib=this.hi.ZPi(this.gridView,nd,zf.v(hc,this.$),T.commandParameters.ribbonCommandInfo.command,T.commandParameters.stopwatch);1===Ib&&(Td&&(this.hi.GZc(Oa,!1),this.hi.GZc(Oa,!0)),-185374993===
T.commandParameters.ribbonCommandInfo.command&&Hf.g(this.$).oXi(),this.pasteIndicationManager.vhd(T.commandParameters.id),this.atc(T.commandParameters.expandDestinations,T.commandParameters.isPasteCommandFromRecoveryUI),this.swe("DoPasteClientEstimation/"+Kd.a[T.commandParameters.ribbonCommandInfo.method],T));T.cseStatus=Ib;return 1===Ib};bc.prototype.eEf=function(){this.copyPasteShortcutDialogFactory.create(this.$).showDialog(!0,!1,!1,this.roi)};bc.prototype.Zni=function(T,Oa,Ib,hc){T=Lc(T,Oa,Ib,
hc,this.$.ya.UserSessionId);T.k=!0;bg.b().Ne(45,T,!0)};bc.prototype.KIi=function(T,Oa,Ib,hc,nd){var Td=!1,Ed=!1,he=bc.Hqb,Pe=bc.JGe+bc.nIa;T&&(Pe+=bc.DJa(T),Ec.a.Pq(T.ewaErrors)?(he=this.r$b(T.ewaErrors),Ec.a.gh(T.ewaErrors,[-103190598])&&(Td=!0)):T.message&&(he=T.message));Ed||(Ed=this.Qld(T));Oa=Lc(Oa,Ib,hc,nd,this.$.ya.UserSessionId);Oa.k=!1;Oa.l=Ed;Oa.n=he;Oa.p=Pe;Oa.q=Td;bg.b().Ne(45,Oa,!0);return Promise.reject(T)};bc.prototype.oUg=function(T){switch(T){case 237279923:case 808159687:return Bd.a.mdi;
case -185374993:return!0;case 1804571062:return!0;default:return!1}};bc.prototype.ugf=function(T){var Oa=Jf(this.fK);if(!Oa)return!1;var Ib=Oa.sourceItem;return Ib&&!Ib.isFromCurrentSession(this.$)?(Bc.ULS.sendTraceTag(537167779,0,50,"CopyPasteInfrastructure.LastOperationWasCopyCut: Last copy operation was from a different session."),!1):Oa.commandParameters.ribbonCommandInfo.command===T};bc.prototype.Lch=function(){var T=Jf(this.fK);return T?(T=T.sourceItem)&&!T.isFromCurrentSession(this.$)?(Bc.ULS.sendTraceTag(537167778,
0,50,"CopyPasteInfrastructure.DoesClipboardHaveCopiedOrCutContent: Last copy/cut operation was from a different session."),!1):!0:!1};bc.prototype.Aoj=function(T){return T&&T.lastCopy?de(T.lastCopy,this.$):!0};bc.prototype.VVe=function(T,Oa,Ib,hc,nd){var Td={};Td.a=this.$.ya.UserSessionId;Td.e=T.stopwatch.id;Td.c=bg.b().pi(T.ribbonCommandInfo.command);Td.b=Kd.a[T.ribbonCommandInfo.method];Td.d=T.id;Td.f=Ib.toString();Td.g=hc.toString();Td.h=Oa.toString();Td.o=T.stopwatch.Ac;Td.q=!1;Td.r=T.copyPasteTargetType.toString();
Td.s=nd.encounteredDeploymentErrors;te.EwaSettings.getBooleanFeatureGate(Bd.a.w5b,!1)&&(Td.i=nd.commandParameters.dragDropIsShiftKeyDown,Td.j=nd.commandParameters.isDragInsert);return Td};bc.prototype.Ord=function(T,Oa,Ib,hc,nd){T=this.VVe(T,Oa,Ib,hc,nd);T.k=!0;bg.b().Ne(45,T,!0)};bc.prototype.Emi=function(T,Oa,Ib,hc,nd,Td,Ed,he,Pe){T=this.VVe(T,Oa,Ib,hc,Pe);T.k=!1;T.l=nd;T.n=Td;T.p=Ed;T.q=he;bg.b().Ne(45,T,!0)};bc.prototype.zif=function(T,Oa,Ib,hc,nd,Td,Ed,he,Pe){var hf={};hf.a=this.$.ya.UserSessionId;
hf.b=Oa;hf.c=T;hf.f=Ib;hf.e=hc;hf.d=nd;hf.g=Td;hf.h=Ed;hf.i=he;hf.j=Pe.toString();bg.b().Ne(46,hf,!0)};bc.prototype.ymi=function(T,Oa){T=this.sVe(T.commandParameters,T);T.l=!0;T.j=Oa;bg.b().Ne(43,T,!0)};bc.prototype.xmi=function(T,Oa,Ib,hc,nd,Td,Ed){T=this.sVe(T,Ed);T.l=!1;T.m=Oa;T.o=Ib;T.y=hc;T.x=nd;T.z=Td;bg.b().Ne(43,T,!0);Bc.ULS.sendTraceTag(537167776,0,15,"CopyPasteInfrastructure.LogCopyFailedTelemetry: ErrorName={0},ErrorReason={1},IsExpectedError={2},IsSucceededWithAlert={3},ErrorMessage={4}",
T.y,T.x,T.m,T.z,T.o)};bc.prototype.sVe=function(T,Oa){var Ib={};Ib.a=this.$.ya.UserSessionId;Ib.f=T.stopwatch.id;Ib.g=T.id;Ib.c=bg.b().pi(T.ribbonCommandInfo.command);Ib.b=Kd.a[T.ribbonCommandInfo.method];Ib.q=T.stopwatch.Ac;Ib.bd=bc.z9b();Ib.bg=T.copyPasteHandlerName;Ib.bj=void 0===T.ribbonCommandInfo.df||null===T.ribbonCommandInfo.df?null:ze.a[T.ribbonCommandInfo.df];Ib.bq=T.uploadToClipService;Ib.br=T.floatingObjectType;Ib.s=T.copyPasteTargetType.toString();Ib.bc=Vd(T.copyPasteTargetType);Ib.z=
!1;if(Oa){Ib.bk=Oa.id;Ib.bl=Oa.serverRequestTimeInMs;Oa.requestTelemetryData&&(Ib.bm=Oa.requestTelemetryData.EcsOperationDuration,Ib.bn=Oa.requestTelemetryData.EcsRequestDuration,Ib.bo=Oa.requestTelemetryData.WfeRequestDuration);Ib.d=Oa.sourceItem?Oa.sourceItem.toString():null;Ib.e=-1;if(ib(Oa.sourceItem)){Ib.e=0;T=yl(Oa.sourceItem.ranges);for(var hc=T.next();!hc.done;hc=T.next())Ib.e+=hc.value.HT}Ib.h=Oa.isAsyncCopy;Ib.i=Oa.isFromCache;Ib.k=Oa.isSelectionAllowed;Ib.r=Oa.plainTextPayloadSize;Ib.u=
Oa.htmlPayloadSize;Ib.v=Oa.htmlSizeExceedsLimit;Ib.w=Oa.copyTotalSizeExceedsLimit;Ib.t=Oa.shadowWorkbookPayloadSize;Ib.p=Oa.clientSideCopyTime;Ib.ba=Oa.encounteredDeploymentErrors;Ib.bb=Oa.shadowWorkbookSizeExceedsLimit;Ib.be=Oa.syncClipboardItemsKeys;Ib.bf=Oa.asyncClipboardItemsKeys;Ib.bh=this.Fze(Oa.succeededPopulatingSystemClipboardSync);Ib.bi=this.Fze(Oa.succeededPopulatingSystemClipboardAsync)}return Ib};bc.prototype.atc=function(T,Oa){Oa=void 0===Oa?!1:Oa;if(!this.gridView.isEditing&&!this.gridView.zi){var Ib=
this.gridView.ha.va,hc=!Oa&&1===T.length&&zf.Q(T,Ib.selectedRanges),nd=hc?Ib.activeCell:T[0].topLeft;T[0].contains(nd)||(Bc.ULS.shipAssertTag(537167775,0,!1,"CopyPasteInfrastructure.SelectPastedRange: SelectedRanges {0}, IndexOfActiveRange {1}, ActiveCell {2}, calculatedDestinationRanges {3}, keepThePreviousActiveCell {4}, newActiveCell {5}, isPasteCommandFromRecoveryUI {6}",Ib.selectedRanges,Ib.wA,Ib.activeCell,T,hc,nd,Oa),nd=T[0].topLeft);this.gridView.ha.bD(T,0,nd,0,void 0,Qe.a.UZg)}};bc.prototype.iZe=
function(T,Oa){var Ib={};Ib.a=this.$.ya.UserSessionId;Ib.g=T.stopwatch.id;Ib.t=T.stopwatch.Ac;Ib.bz=!1;Oa&&(Ib.bv=Oa.id,Ib.bw=Oa.serverRequestTimeInMs,Ib.n=Oa.commandParameters.clipboardFormatReadTimes,Ib.o=Oa.commandParameters.clipboardFormatReadStatus,Ib.p=Oa.commandParameters.clipboardReadPermissionPromptShown,Ib.q=Oa.commandParameters.asyncApiReadTimedOut,Oa.requestTelemetryData&&(Ib.cb=Oa.requestTelemetryData.EcsOperationDuration,Ib.cc=Oa.requestTelemetryData.EcsRequestDuration,Ib.cd=Oa.requestTelemetryData.WfeRequestDuration));
Ib.x=T.copyPasteTargetType.toString();Ib.bl=Vd(T.copyPasteTargetType);Ib.br=T.copyPasteHandlerName;Ib.i=zf.i(T.expandDestinations,",",this.$,!1);Ib.h=zf.i(T.originalDestinations,",",this.$,!1);Ib.e=T.id;Ib.d=T.commandType;Ib.c=bg.b().pi(T.ribbonCommandInfo.command);Ib.b=Kd.a[T.ribbonCommandInfo.method];Ib.bf=!1;Ib.bg=!1;Ib.bp=bc.z9b();Ib.bt=void 0===T.ribbonCommandInfo.df||null===T.ribbonCommandInfo.df?null:ze.a[T.ribbonCommandInfo.df];Ib.cj=T.isPasteCommandFromEnterShortcut;if(Ib.ca=T.isPasteCommandFromRecoveryUI)Ib.cf=
T.pasteRecoveryUndoStopwatch.id,Ib.cg=T.pasteRecoveryUndoStopwatch.Ac;if(Oa){if((T=Oa.copyContextSnapshot)&&!Oa.wasLastCopyExternal){Ib.f=T.commandParameters.id;Ib.j=T.sourceItem.toString();Ib.k=-1;if(ib(T.sourceItem)){Ib.k=0;for(var hc=yl(T.sourceItem.ranges),nd=hc.next();!nd.done;nd=hc.next())Ib.k+=nd.value.HT}Ib.bg=1===T.commandParameters.commandType}else Oa.clipboardItems?Ib.f=Oa.clipboardItems.getItem(gb.g1c):Bc.ULS.sendTraceTag(537167774,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext.ClipboardItems is null");
Ib.bz=Oa.pasteRecoveryUIDisplayed;Ib.ci=Oa.cseStatus}else Bc.ULS.sendTraceTag(537167773,0,50,"CopyPasteInfrastructure.GetPasteUsageData: pasteContext is null");return Ib};bc.prototype.Lni=function(T,Oa,Ib,hc,nd,Td,Ed,he,Pe){T=this.iZe(T,he);T.l=!1;T.m=Oa;T.s=Ib;T.bc=hc;T.be=nd;T.bd=Td;T.bf=Ed;he?(T.y=wc(he)||!he.copyContextSnapshot,T.bi=!T.y&&de(he.copyContextSnapshot,this.$),T.bj=he.shadowWorkbookSizeExceedsLimit,T.v=he.shadowWorkbookPayloadSize,T.w=he.htmlPayloadSize,T.bq=Qd(he.clipboardItems),
T.bb=he.activeSelectionType,T.bs=he.isSameSession,T.bn=he.payloadOrigin,T.bo=he.payloadType,T.bu=he.externalAppSource,T.bx=he.indicationDisplayScheduled,T.by=he.pasteIndicationDisplayStatus,T.ck=he.pasteDestinationHasMergedCells):T.bi=de(Pe,this.$);bg.b().Ne(44,T,!0);Bc.ULS.sendTraceTag(537167772,0,15,"CopyPasteInfrastructure.LogPasteFailedTelemetry: ErrorName={0},ErrorReason={1},IsExpectedError={2},IsSucceededWithAlert={3},ErrorMessage={4}",T.be,T.bd,T.m,T.bf,T.s)};bc.prototype.Mni=function(T){var Oa=
this.iZe(T.commandParameters,T);Oa.y=T.wasLastCopyExternal;Oa.l=!0;Oa.u=T.plainTextPayloadSize;Oa.v=T.shadowWorkbookPayloadSize;Oa.w=T.htmlPayloadSize;Oa.z=T.isClipboardDataContainShadowWorkbook;Oa.ba=T.isShadowWorkbookParsedSuccessfully;Oa.bb=T.activeSelectionType;Oa.bc=T.pasteResult;Oa.bh=T.encounteredDeploymentErrors;Oa.bj=T.shadowWorkbookSizeExceedsLimit;Oa.bk=oc(T);Oa.bq=Qd(T.clipboardItems);Oa.bs=T.isSameSession;Oa.bn=T.payloadOrigin;Oa.bo=T.payloadType;Oa.bu=T.externalAppSource;Oa.bx=T.indicationDisplayScheduled;
Oa.by=T.pasteIndicationDisplayStatus;Oa.ck=T.pasteDestinationHasMergedCells;Oa.bm=T.clipboardItems?T.clipboardItems.getItem(gb.bTg):null;Oa.bi=!T.isSameSession&&!T.wasLastCopyExternal;bg.b().Ne(44,Oa,!0)};bc.prototype.ak=function(){this.$.xa.Pf(this.Yh);this.$.xa.QAg(this.Ilc);this.$.userOperationManager.uy(this.cR);this.$.Rk(this.od);Hf.g(this.$).Kc.wm(this.dDb)};bc.prototype.mm=function(){this.$&&this.$.xa&&(this.$.xa.rg(this.Yh),this.$.xa.V4i(this.Ilc));this.$&&this.$.userOperationManager&&this.$.userOperationManager.pz(this.cR);
this.gridView&&this.gridView.Kc&&this.gridView.Kc.im(this.dDb)};bc.prototype.MCb=function(T,Oa){var Ib=null,hc=!1,nd=null,Td="UnknownFailure",Ed=-1,he=bc.Hqb,Pe=bc.pasteErrorName+bc.nIa,hf=!1;this.pasteIndicationManager.vhd(T.id);this.Kbf&&this.pasteDestinationHasMergedCells(T.expandDestinations)&&(Oa.pasteContext.pasteDestinationHasMergedCells=!0);var pg=Jf(this.fK);(T.clearStateOnFinish||T.clearSystemClipboard)&&this.Hv("Paste/fail/"+Kd.a[T.ribbonCommandInfo.method],!0,void 0,void 0,T.copyPasteTargetType).catch(function(){});
if(Oa){Ed=Oa.reason;Pe+=bc.DJa(Oa);Oa.message&&(he=Oa.message);if(Ib=bc.lZg(Oa))if(1===Ib.pasteErrorName)hc=!0,Td="CopyPasteLengthTooLongPopup",he=nd="The pasted content is too long. Popup a dialog to the user.",Bc.ULS.sendTraceTag(25216992,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',nd,T.copyPasteTargetType),Ib=Ec.a.jd(1,0,26,674,0,1306609195,"CopyPasteOversizeError"),te.EwaSettings.az()?new Ob.a(this.$,Ib):(Ib=new Aa.ErrorDialog(this.$,Ib),Ib.initialize(),Ib.mf());
else if(7===Ib.pasteErrorName)hc=!0,Td="No-Op",he=nd="The shadow workbook is not ready yet and an async copy failed to populate the clipboard. Do nothing (by the spec)",Bc.ULS.sendTraceTag(33948251,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',nd,T.copyPasteTargetType);else if(8===Ib.pasteErrorName)hc=!0,Td="UseShortcutsPopup",he=nd="Unable to paste content from the system clipboard. Popup dialog to the user.",Bc.ULS.sendTraceTag(25216994,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',
nd,T.copyPasteTargetType),this.eEf();else if(18===Ib.pasteErrorName){hc=!0;Td="PasteExternalNotSupportMultipleSelectionPopup";he="Paste external not support multiple selection.";nd="Unknown";var fg=2121;100!==Ib.validationFailureReason&&(nd=Od[Ib.validationFailureReason],fg=bc.yze(Ib.validationFailureReason));this.wya(fg,nd,!0)}else 20===Ib.pasteErrorName||19===Ib.pasteErrorName?(hc=!0,20===Ib.pasteErrorName?(Td="PasteAcrossSessionNotSupportMultipleSelectionPopup",he="Paste across session does not support multiple selection."):
(Td="PasteInSameSessionNotSupportMultipleSelectionPopup",he="This kind of multiple selection is not supported for same session paste."),nd="Unknown",fg=2121,100!==Ib.validationFailureReason&&(nd=Od[Ib.validationFailureReason],fg=bc.yze(Ib.validationFailureReason)),Ib=6===Ib.validationFailureReason,this.SXc(T.commandType,T.expandDestinations)&&Ib&&this.atc(T.expandDestinations),this.wya(fg,nd,!0)):6===Ib.pasteErrorName?(hc=!0,Td="No-Op",he=nd="Paste Formatting/Transpose is not yet a supported operation on System Clipboard based content",
Bc.ULS.sendTraceTag(36263241,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',nd,T.copyPasteTargetType)):17===Ib.pasteErrorName?(hc=!0,Td="No-Op",he=nd="Paste text on Art is not yet a supported operation",Bc.ULS.sendTraceTag(0,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',nd,T.copyPasteTargetType)):16===Ib.pasteErrorName?(hc=!0,Td="No-Op",he=nd="Paste has failed because the previous copy has failed",Bc.ULS.sendTraceTag(537167771,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}", error={2}',
nd,T.copyPasteTargetType,this.getStringifiedError(Ib))):Ec.a.Pq(Ib.ewaErrors)?(Ec.a.y9(Ib.ewaErrors)||Ec.a.gh(Ib.ewaErrors,Ec.a.abc())?(hc=!0,Td="CommunicationError",nd=Ec.a.Uc(Ib.ewaErrors),Bc.ULS.sendTraceTag(36304159,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',he,T.copyPasteTargetType)):Ec.a.gh(Ib.ewaErrors,bc.Bcj)?(hc=!0,Td="SavingWorkbookError",nd=Ec.a.Uc(Ib.ewaErrors),Bc.ULS.sendTraceTag(36304160,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',
he,T.copyPasteTargetType)):Ec.a.gh(Ib.ewaErrors,bc.operationSucceededWithAlert)&&(hf=hc=!0,Td="OperationSucceededWithAlert",nd=Ec.a.Uc(Ib.ewaErrors),Bc.ULS.sendTraceTag(36304161,0,15,'CopyPasteInfrastructure.OnPasteFailed: {0} copyPasteTargetType="{1}"',he,T.copyPasteTargetType)),hc||(he=this.r$b(Ib.ewaErrors),hc=this.Qld(Oa))):11===Ib.pasteErrorName&&(hc=!0,Td="No-Op",he="Paste has failed because user try copy cross-session oart object");15===Oa.reason&&(hc=!0,Td="No-Op",he="Rejecting deferred paste there is metadata update without copy context. Usually it means that copy canceled before finished.");
Me.a.equals(Pe,id.DMj,!1)&&(hc=!0,Td="No-Op",he="User hash of the copy is different then the user hash of the paste during cross-session copy-paste. Do nothing.")}hc||Bc.ULS.sendTraceTag(24150916,0,10,'CopyPasteInfrastructure.OnPasteFailed: {0}, copyPasteTargetType="{1}"',Oa?this.getStringifiedError(Oa):"null",T.copyPasteTargetType);this.Lni(T,hc,he,Td,Pe,Ed,hf,Oa.pasteContext,pg);return Promise.reject(Oa)};bc.prototype.gmc=function(T,Oa){var Ib;Bc.ULS.sendTraceTag(24150917,0,50,'CopyPasteInfrastructure.OnPasteSuccess: paste succeed. copyPasteTargetType="{0}"',
Oa.copyPasteTargetType);this.pasteIndicationManager.vhd(Oa.id);if(this.dQi(Oa.copyPasteTargetType,T)){te.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!$e.a.rC&&T.wasLastCopyExternal&&T.payloadType===Pd.SN&&(this.T5a=!0);var hc=null;(null===(Ib=T.pastedRange)||void 0===Ib?0:Ib.Ranges)&&0<T.pastedRange.Ranges.length?hc=zf.g(T.pastedRange.Ranges):T.wasLastCopyExternal||(hc=Oa.expandDestinations);this.oej(T,hc);if(this.vqj(T,hc)){Ib=yd.a.clone(Oa.originalDestinations);
hc=1028===Oa.commandType?yd.a.clone(Oa.expandDestinations):yd.a.clone(hc);var nd=null;T.wasLastCopyExternal&&(Oa.isKeyboardEvent||Oa.isPasteCommandFromRecoveryUI)&&(nd={},nd=(nd[bc.UCf]=T.clipboardItems,nd));this.Kbf&&this.pasteDestinationHasMergedCells(Oa.expandDestinations)&&(T.pasteDestinationHasMergedCells=!0);T.pasteRecoveryUIDisplayed=!0;var Td=new Ce(this.$,Ib,hc,nd),Ed=ef.GetServiceTaskFactory.Xa(this.$.da,406,405,0);$f.TaskExtensions.Ba(Ed,function(){var he=Ed.result;he.MJg(Td);he.Gtj(Oa.ribbonCommandInfo.method)},
this.ma,3)}}this.swe("Paste/success/"+Kd.a[Oa.ribbonCommandInfo.method],T);this.Mni(T);this.DZf&&(!Oa.isKeyboardEvent||oc(T))&&this.$.fa.ih.get(66)&&(Bc.ULS.sendTraceTag(537167770,0,15,"CopyPasteInfrastructure.OnPasteSuccess: show localStorage disable notification"),this.DZf=!1,this.L_g());return Promise.resolve(!0)};bc.prototype.vqj=function(T,Oa){return!Oa||1!==Oa.length||T.commandParameters.clearSystemClipboard||T.commandParameters.clearStateOnFinish||T.commandParameters.skipClipboardAccess?!1:
wc(T)&&(Oa=T.clipboardItems.getItem(gb.VV),T=T.clipboardItems.getItem(gb.html),void 0===Oa||null===Oa||Oa.length>this.Ctd||void 0===T||null===T||T.length>this.dNa)?(Bc.ULS.sendTraceTag(537167769,0,50,"CopyPasteInfrastructure.ShouldShowPasteRecoveryUI: Not showing PasteRecoveryUI for external copy."),!1):!0};bc.prototype.dQi=function(T,Oa){return 1===T||Oa.payloadType===Pd.VV||te.EwaSettings.la(161)&&Oa.payloadType===Pd.html||te.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",
!1)&&!$e.a.rC&&Oa.payloadType===Pd.SN};bc.prototype.pasteDestinationHasMergedCells=function(T){var Oa=Hf.g(this.$).Ca.oE();if(!Oa||!Oa.length)return!1;Oa=yl(Oa);for(var Ib=Oa.next();!Ib.done;Ib=Oa.next())if(Ib.value.Uv(T[0]))return!0;return!1};bc.prototype.swe=function(T,Oa){var Ib=this,hc;(function(){var nd=Ib.P9h(Oa);hc=nd.nGa;return nd})().returnValue&&this.Hv(T,hc,void 0,void 0,Oa.commandParameters.copyPasteTargetType).catch(function(){})};bc.prototype.Ixd=function(T,Oa,Ib,hc,nd,Td){Bc.ULS.sendTraceTag(24150918,
0,10,"CopyPasteInfrastructure.OnDragAndDropCellsFailed: {0}",T?this.getStringifiedError(T):"null");var Ed=!1,he=!1,Pe=!1,hf=bc.Hqb,pg=bc.JGe+bc.nIa;T&&(pg+=bc.DJa(T),Ec.a.Pq(T.ewaErrors)?(hf=this.r$b(T.ewaErrors),Ec.a.gh(T.ewaErrors,bc.operationSucceededWithAlert)&&(Ed=!0),Ec.a.gh(T.ewaErrors,bc.dragDropNonEmptyRange)&&(he=Pe=!0)):T.message&&(hf=T.message));Pe||(Pe=this.Qld(T));he?this.gridView.ha.selectionType=-1:this.Er.A_i(nd);this.Emi(Oa,Ib,hc,nd,Pe,hf,pg,Ed,Td);return Promise.reject(T)};bc.prototype.EXc=
function(T,Oa){var Ib=T,hc=this.xLh();if(null===hc||void 0===hc?0:hc.ranges)Ib=this.Er.lPg(Oa,hc.ranges,T);return Ib};bc.prototype.xLh=function(){var T=Jf(this.fK);return T&&ib(T.sourceItem)?T.sourceItem:null};bc.prototype.CXi=function(){this.raiseEvent(bc.tzd,null)};bc.prototype.oej=function(T,Oa){var Ib=T.commandParameters.originalDestinations;Oa&&(zf.Q(this.gridView.ha.va.selectedRanges,Ib)?(this.atc(Oa),Bc.ULS.sendTraceTag(537167767,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range, range: {0}",
Md.HelperMethods.enb(Oa))):T.commandParameters.isPasteCommandFromRecoveryUI?(this.atc(Oa,!0),Bc.ULS.sendTraceTag(537167766,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: select paste range for IsPasteCommandFromRecoveryUI, range: {0}, active cell: {1}",Oa,Oa[0].topLeft)):Bc.ULS.sendTraceTag(537167765,0,50,"CopyPasteInfrastructure.SelectPastedRangeIfNeeded: user change his selection during paste operation. don't change selection. originalPasteDestinations: {0}",Md.HelperMethods.enb(Ib)))};
bc.prototype.P9h=function(T){if(T.isPlainTextPaste||T.isHtmlPaste||ed(T)||T.commandParameters.isPasteCommandFromEnterShortcut)return{returnValue:!0,nGa:!1};var Oa=T.copyContextSnapshot;if(T.commandParameters.clearStateOnFinish)return{returnValue:!0,nGa:!0};if(Oa&&ib(Oa.sourceItem)){var Ib=Oa.sourceItem;if(!Ib.isFromCurrentSession(this.$))return{returnValue:!1,nGa:!0};Oa=-1985798686===Oa.commandParameters.ribbonCommandInfo.command;if(!(1<Ib.ranges.length||1<T.commandParameters.expandDestinations.length)){var hc=
zf.K(Ib.ranges);T=zf.K(T.commandParameters.expandDestinations);var nd=this.$.fa.oa.sheetName;Ib=Ib.sheetName;if(Ib===nd&&T.equals(hc))return{returnValue:!1,nGa:!0};if(Ib===nd&&T.Jf(hc))return{returnValue:!0,nGa:!1}}return{returnValue:Oa,nGa:!0}}return{returnValue:!1,nGa:!0}};bc.prototype.Zzf=function(){var T=Jf(this.fK);(T=this.Er.Fub(T))&&T.isFromCurrentSession(this.$)&&this.Hv("OnStartEdit",!1).catch(function(){})};bc.prototype.r$b=function(T){T=Ec.a.kIh(T,bc.nIa);return this.Bsi+Ze.a.lu(T).toString()};
bc.prototype.Qld=function(T){T=bc.DJa(T);return!!T&&Me.a.M0a(T,bc.Asi)};bc.prototype.L_g=function(){var T=Ec.a.jd(1,2,325,326,$e.a.Po?327:$e.a.iH?328:329,530046625,"ActivateLocalStorage"),Oa=ef.GetServiceTaskFactory.Xa(this.$.da,5,4,0);$f.TaskExtensions.Ba(Oa,function(){Oa.result.hg(41,T)},this.ma,3)};bc.prototype.Fze=function(T){return void 0===T||null===T?pe.Wvi:T?pe.success:pe.failed};bc.lZg=function(T){var Oa=T.innerError;return(null===Oa||void 0===Oa?0:Oa.pasteErrorName)?T.innerError:null};bc.XYg=
function(T){var Oa=T.innerError;return(null===Oa||void 0===Oa?0:Oa.copyErrorName)?T.innerError:null};bc.DJa=function(T){var Oa="";if(!T)return bc.LDe;T.errorName&&(Oa=T.errorName,T.innerError&&(Oa+=bc.nIa+bc.DJa(T.innerError)));Oa||(Oa=T&&T.name?T.name:bc.LDe);return Oa};bc.z9b=function(){bc.bKb||(ag.a.Ybf()?bc.bKb=Ad.Uuj:ag.a.Ymd()?bc.bKb=Ad.Tuj:bc.bKb=Ad.Suj);return bc.bKb};bc.yze=function(T){switch(T){case 7:case 1:return 2128;case 5:return 2125;case 6:return 2124;case 8:case 3:case 2:case 4:case 9:case 10:return 2121;
default:return Bc.ULS.shipAssertTag(537167764,0,!1,"CopyPasteInfrastructure.ConvertPasteValidationOptionToJsStringId: no case for validationOptions = {0}",T),2128}};bc.YYg=function(T){switch(T){case 3:return 2122;case 1:return 2123;case 2:case 4:return 2121;default:return Bc.ULS.shipAssertTag(537167763,0,!1,"CopyPasteInfrastructure.ConvertCopySourceValidationOptionToJsStringId: no case for validationOptions = {0}",T),2128}};tl.Object.defineProperties(bc.prototype,{pasteIndicationManager:{configurable:!0,
enumerable:!0,get:function(){return this.$.da.Aa(373)}}});bc.Cmf="EwaJsMetadataChangeListenerId";bc.tzd="cpiOSC";bc.$8g="cpiDID";bc.Hqb="Unknown";bc.LDe="UnknownError";bc.nIa="_";bc.JGe="DragAndDropError";bc.pasteErrorName="PasteError";bc.oQg="CancelError";bc.copyErrorName="CopyError";bc.Asi="MergedCellOverlap";bc.UCf="PasteRecoveryCachedClipboardItems";bc.Bcj=[1352631530,1679665408];bc.operationSucceededWithAlert=[-103190598];bc.pasteDataLimitHit=[1306609195];bc.copyThrottlingError=[-386183710];
bc.dragDropNonEmptyRange=[563945982];bc.bKb=null;Object(Jc.a)(bc,"CopyPasteInfrastructure",lf.a,[677,678,3]);Object(Jc.a)(Je,"ClipboardPlatformInitializationResult",null,[]);var sb=b(686),ec=b(120),ce=b(4),Rd=b(81);Object(Jc.a)(Ac,"MacroRecorderPasteRangePayload",null,[116]);cc.prototype.getContent=function(){return this.content};Object(Jc.a)(cc,"MacroRecorderPasteStringPayload",null,[116]);var Ne=b(59);Object(Jc.a)(pb,"MacroRecorderPastePayload",null,[116]);var Be=b(603),sd=b(911),cf=b(519),Dd=b(163),
tf=b(201),vf=b(126),eg=b(273),jg=b(336);za.prototype.getParameters=function(){return this.parameters};Object(Jc.a)(za,"MacroRecorderRangeCopyCutCellsInsertedPayload",null,[116]);var Xe=b(368);uc.prototype.copy=function(T,Oa,Ib,hc,nd){function Td(hf,pg,fg){var Xg={CopyPasteTargetType:1};Xg.SourceRanges=T;Xg.CopyOperationId=Oa.id;Bc.ULS.sendTraceTag(537167756,0,50,"CopyPasteInfrastructure.Copy served from CopyPasteProxy : {0}, CopyOperationId : {1}",Ed.HLa,Xg.CopyOperationId);Ed.qMa=Ed.HLa?Jd(Ed.$.qa.ex,
Xg,eg.b(hf,Ib),hc?eg.a(pg,hc):pg,fg,Oa.ribbonCommandInfo,he,nd):Jd(Ed.$.qa.ta,Xg,eg.b(hf,Ib),hc?eg.a(pg,hc):pg,fg,Oa.ribbonCommandInfo,he,nd);return Ed.qMa}var Ed=this;hc=void 0===hc?null:hc;nd=void 0===nd?null:nd;var he=this.$.qa.ta.Xb();this.tkd&&this.TX();this.nhc=he.ClientRequestId;var Pe=te.EwaSettings.tc()?new Dd.a(505,0,Td,80):new cf.a(505,0,Td,16);Pe=this.$.userOperationManager.ic(Pe,Oa.ribbonCommandInfo);this.tkd&&this.Su.add(Pe)};uc.prototype.TCf=function(T,Oa,Ib,hc,nd,Td){var Ed=this;return new Promise(function(he,
Pe){var hf,pg=Td.commandParameters.stopwatch.Ac,fg=2;20===Td.commandParameters.commandType&&(fg=16);36===Td.commandParameters.commandType&&(fg=32);ag.a.Ymd()&&68===Td.commandParameters.commandType&&(fg=64);ag.a.qpd(Ed.$)&&1028===Td.commandParameters.commandType&&(fg=1024);var Xg=null;if(null===(hf=Td.copyContextSnapshot)||void 0===hf?0:hf.commandParameters)Xg=Td.copyContextSnapshot.commandParameters.id;uc.bLd(Ed.$,T,hc,Oa,Ib,null,function(yg){uc.wbc(yg,Td,he,Pe,pg,Ed.$)},function(yg){Td.serverRequestTimeInMs=
Td.commandParameters.stopwatch.Ac-pg;yg=vf.a.yg(yg.data);Pe(new sd.a(5,yg))},nd,fg,Xg,Td.commandParameters.id)})};uc.prototype.pasteRange=function(T,Oa,Ib,hc,nd,Td,Ed,he){var Pe=this;return new Promise(function(hf,pg){var fg=Ed.commandParameters.stopwatch.Ac;uc.Dfj(Pe.$,T,Oa,Ib,hc|-5&nd,function(Xg){uc.wbc(Xg,Ed,hf,pg,fg,Pe.$)},function(Xg){Ed.serverRequestTimeInMs=Ed.commandParameters.stopwatch.Ac-fg;Xg=vf.a.yg(Xg.data);pg(new sd.a(5,Xg))},Td,he)})};uc.prototype.WUi=function(T,Oa,Ib,hc,nd,Td,Ed){var he=
this;return new Promise(function(Pe,hf){if(Oa)if(Oa.length>he.dNa){var pg=Ed.clipboardItems.getItem(gb.VV),fg=-1;void 0!==pg&&null!==pg&&(fg=pg.length);Bc.ULS.sendTraceTag(42071712,0,15,"CopyPasteInfrastructure.ProcessPasteHtml copy paste length too long. clipboardHtml.Length: {0}, MaxHtmlImportLength: {1}, PlainTextLength: {2}",Oa.length,he.dNa,fg);hf(new sd.a(1))}else pg=function(Xg,yg,Rh){he.$.Xu();var Kh=Ed.commandParameters.stopwatch.Ac;Xg=eg.b(Xg,function(Ei){uc.wbc(Ei,Ed,Pe,hf,Kh,he.$,Oa)});
yg=eg.a(yg,function(Ei){Ed.serverRequestTimeInMs=Ed.commandParameters.stopwatch.Ac-Kh;Ei=vf.a.yg(Ei.data);hf(new sd.a(3,Ei))});var Yg=he.$.qa.ta.Xb(),ji=zf.v(T,he.$),Di={};Di.SourceHtml=Oa;Di.DestinationRanges=ji?zf.s(ji):null;Di.CopyOperationId=Ib;Di.PasteId=hc;Bc.ULS.sendTraceTag(537167755,0,50,"CopyPasteInfrastructure.ProcessPasteHtml served from CopyPasteProxy : {0}. PasteId : {1}",he.HLa,Di.PasteId);return he.HLa?od(he.$.qa.ex,Di,Xg,yg,Rh,null,Yg,Td):od(he.$.qa.ta,Di,Xg,yg,Rh,null,Yg,Td)},pg=
te.EwaSettings.tc()?new Dd.a(204,0,pg,65):new cf.a(204,0,pg,1),he.$.userOperationManager.ic(pg,nd);else Pe("")})};uc.prototype.XUi=function(T,Oa,Ib,hc,nd){var Td=this;return new Promise(function(Ed,he){Bc.ULS.sendTraceTag(537167754,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: method start. pasteContext.Id={0}",nd.id);Oa&&(Oa=Me.a.trimEnd(Oa,"\n","\r"));Bc.ULS.sendTraceTag(537167753,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after clipboardText.TrimEnd. pasteContext.Id={0}",
nd.id);if(Oa){var Pe=Td.Ctd;if(Oa.length>Pe)Bc.ULS.sendTraceTag(24150921,0,15,"CopyPasteInfrastructure.ProcessPasteText copy paste length too long. clipboardText.Length: {0}, MaxCopyPasteLength: {1}",Oa.length,Pe),he(new sd.a(1));else{var hf=zf.v(T,Td.$);Bc.ULS.sendTraceTag(537167752,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before treatAsLink calculation. pasteContext.Id={0}",nd.id);Pe=!Td.$.fa.isNamedObjectViewMode&&!Oa.includes("\n")&&!Oa.includes("\t");Bc.ULS.sendTraceTag(537167751,
0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before isLink check. pasteContext.Id={0}. treatAsLink={1}",nd.id,Pe);Pe=Pe&&Me.a.ybf(Oa);Bc.ULS.sendTraceTag(537167750,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after treatAsLink calculation. pasteContext.Id={0}. treatAsLink={1}",nd.id,Pe);var pg=Td.$.qa.ta.Xb();if(Pe){var fg=526;Bc.ULS.sendTraceTag(537167749,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before FixUpUrl. pasteContext.Id={0}",nd.id);
var Xg=tf.a.m$c(Oa);Bc.ULS.sendTraceTag(537167748,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: after FixUpUrl. pasteContext.Id={0}",nd.id);var yg=zf.s(hf);Pe=function(Kh,Yg,ji){var Di=nd.commandParameters.stopwatch.Ac;Kh=eg.b(Kh,function(Ei){Bc.ULS.sendTraceTag(537167747,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: on ApplyHyperlink successCallback. pasteContext.Id={0}",nd.id);nd.requestTelemetryData=Ei.RequestTelemetryData;nd.serverRequestTimeInMs=nd.commandParameters.stopwatch.Ac-
Di;Ei.Errors&&0<Ei.Errors.length?he(new sd.a(2,Ei.Errors)):Ed(Oa)});Yg=eg.a(Yg,function(Ei){nd.serverRequestTimeInMs=nd.commandParameters.stopwatch.Ac-Di;Ei=vf.a.yg(Ei.data);he(new sd.a(2,Ei))});Td.$.Xu();Bc.ULS.sendTraceTag(537167746,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before ApplyHyperlink. pasteContext.Id={0}",nd.id);return Rd.c(Td.$.qa.ta,yg,Oa,Xg,!1,!1,63,Kh,Yg,ji,T,pg,hc)};var Rh=function(){return new Be.a(yg,Oa,Xg)}}else fg=180,Pe=function(Kh,Yg,ji){Td.$.Xu();var Di=
nd.commandParameters.stopwatch.Ac;Kh=eg.b(Kh,function(Ei){Bc.ULS.sendTraceTag(537167745,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: on PasteString successCallback. pasteContext.Id={0}",nd.id);uc.wbc(Ei,nd,Ed,he,Di,Td.$,Oa)});Yg=eg.a(Yg,function(Ei){nd.serverRequestTimeInMs=nd.commandParameters.stopwatch.Ac-Di;Ei=vf.a.yg(Ei.data);he(new sd.a(4,Ei))});Bc.ULS.sendTraceTag(537167744,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before PasteString. pasteContext.Id={0}",
nd.id);return Xd(Td.$.qa.ta,hf,Oa,Kh,Yg,ji,null,pg,hc)},Rh=function(){return new cc(hf,Oa)};Bc.ULS.sendTraceTag(537167715,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: before UserNonBlockingWebMethodOperation. pasteContext.Id={0}",nd.id);Pe=te.EwaSettings.tc()?new Dd.a(fg,0,Pe,65,Rh):new cf.a(fg,0,Pe,1,Rh);Bc.ULS.sendTraceTag(537167714,0,50,"CopyPasteInfrastructure.ProcessPasteText profiling trace: returning. pasteContext.Id={0}",nd.id);Td.$.userOperationManager.ic(Pe,Ib)}}else Ed("")})};
uc.prototype.K5e=function(T,Oa){Oa=[1===Oa?4:5];this.gridView.Nb.uw(jg.a.RW(Ne.d(this.$.oa),T),Oa,!0);this.gridView.Nb.Yr(Oa);this.gridView.Nb.update(!0)};uc.prototype.Svb=function(){var T=[4,5];this.gridView.Nb.kl(T,!1,!this.Dfc);this.gridView.Nb.Jl(null,T,!this.Dfc);1===this.gridView.ha.Te&&this.gridView.Yr(!1,!this.Dfc);this.Dfc&&this.gridView.Nb.update(!1,!1)};uc.prototype.lPg=function(T,Oa,Ib){var hc=[];Ib=yl(Ib);for(var nd=Ib.next();!nd.done;nd=Ib.next())Array.add(hc,this.oPg(T,Oa,nd.value));
return hc};uc.prototype.TX=function(){if(this.Su)for(var T=yl(this.Su),Oa=T.next();!Oa.done;Oa=T.next())Oa=Oa.value,this.$&&this.$.userOperationManager&&(Oa.operation&&Bc.ULS.sendTraceTag(526758675,0,50,"CopyPasteUtils.AbortOutstandingUserOperation: Trying to abort pending operation {0}.",ec.a(Oa.operation.operationName)),this.mQg(),this.$.userOperationManager.CHa(Oa))};uc.prototype.mQg=function(){if(this.qMa){var T=this.qMa.kt;Bc.ULS.sendTraceTag(526758674,0,15,"Cancelling pending copy request with Id={0}",
T);vf.a.Zt(T);this.nhc&&Rd.j(this.$.qa.ta,this.nhc,null,null,null);this.nhc=this.qMa=null}};uc.prototype.aF=function(T,Oa){2===Oa.Wx?(this.Su.clear(),this.qMa=null):1===Oa.Wx&&this.Su&&this.Su.contains(Oa.Sg)&&(Bc.ULS.sendTraceTag(526758673,0,50,"CopyPasteUtils.OnQueueChanged: web method {0} returned, it took {1} milliseconds to complete.",ec.a(Oa.Sg.operation.operationName),Oa.Sg.dequeueUtcTime.getTime()-Oa.Sg.enqueueUtcTime.getTime()),this.Su.remove(Oa.Sg),this.qMa=null)};uc.prototype.oPg=function(T,
Oa,Ib){Bc.ULS.shipAssertTag(537167713,0,!!Oa,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray shouldn't be null");Bc.ULS.shipAssertTag(537167712,0,0<Oa.length,"CopyPasteUtils.CalculateSingleImpactedRange: sourceArray length shouldn't be zero");var hc=0,nd=0,Td=new Set,Ed=new Set;Oa=yl(Oa);for(var he=Oa.next();!he.done;he=Oa.next()){he=he.value;var Pe=String.format("{0}_{1}",he.left,he.right),hf=String.format("{0}_{1}",he.top,he.bottom);Ed.has(Pe)||(Ed.add(Pe),nd+=he.width);Td.has(hf)||(Td.add(hf),
hc+=he.height)}if(36===T)return Ib.isSingle?uc.IOe(nd,hc,Ib):Ib.clone();516===T&&(T=hc,hc=nd,nd=T);T=!(Ib.width%nd)&&!(Ib.height%hc);Td=Ib.Z4&&!(Ib.height%hc);Ib.bba&&!(Ib.width%nd)||Td?Ib=uc.IOe(nd,hc,Ib):T?Ib=Ib.clone():(Ib=Ib.clone(),Ib.bottom=Math.min(bf.a.Fh,Ib.top+hc-1),Ib.right=Math.min(bf.a.Qh,Ib.left+nd-1));return Ib};uc.prototype.GGg=function(T,Oa,Ib,hc,nd,Td,Ed,he,Pe,hf,pg){if(!hc||!hc.length)return 1;if(1<hc.length){if(!this.mec&&Td)return 3;if(hf)return 0;if(he)return 9;if(Pe)return 8;
if(pg)return 2;if(1<Oa.length)return 4;var fg=Oa[0];if(!Ed&&!yd.a.all(hc,function(Xg){return Xg.isSingle||!(Xg.width%fg.width)&&!(Xg.height%fg.height)}))return 5;if((!this.mec||!Td)&&Me.a.equals(T,Ib,!0))for(nd=yl(nd),T=nd.next();!T.done;T=nd.next())if(T=T.value,T.Rd(fg)&&!T.equals(fg))return 6}else if(Oa&&0<Oa.length){if(this.q$e(Oa,Pe))return 7;if(1<Oa.length){if(!this.mec&&Td)return 3;if((!this.mec||!Td)&&Me.a.equals(T,Ib,!0))for(T=yl(Oa),Oa=T.next();!Oa.done;Oa=T.next())if(Oa=Oa.value,Ib=nd[0],
Oa.Rd(Ib)&&!Oa.equals(Ib))return 6}}return 0};uc.prototype.q$e=function(T,Oa){if(!T||1>=T.length)return 0;if(Oa)return 2;if(!zf.S(T))return 1;Oa=new sb.a(cb.a.Ik());for(var Ib=yl(T),hc=Ib.next();!hc.done;hc=Ib.next()){hc=hc.value;for(var nd=yl(T),Td=nd.next();!Td.done;Td=nd.next()){Td=Td.value;var Ed=hc.top===Td.top&&hc.bottom===Td.bottom,he=hc.left===Td.left&&hc.right===Td.right,Pe=Math.max(hc.left,Td.left)<Math.min(hc.right,Td.right);if(Math.max(hc.top,Td.top)<Math.min(hc.bottom,Td.bottom)&&!Ed||
Pe&&!he)return 3;Oa.add(String.format("{0}-{1}-{2}-{3}",hc.top,hc.bottom,Td.left,Td.right));Oa.add(String.format("{0}-{1}-{2}-{3}",Td.top,Td.bottom,hc.left,hc.right))}}T=yl(T);for(Ib=T.next();!Ib.done;Ib=T.next())Ib=Ib.value,Oa.remove(String.format("{0}-{1}-{2}-{3}",Ib.top,Ib.bottom,Ib.left,Ib.right));return 0<Oa.count?3:0};uc.prototype.A_i=function(T){var Oa=this.gridView.ha;Oa.updateSelection(T,T.topLeft,0);Oa.selectionType=-1};uc.prototype.Fub=function(T){if(null===T||void 0===T?0:T.sourceItem){if(!ib(T.sourceItem))return null;
if((T=T.sourceItem)&&zf.cb(T.ranges,!0))return T}return null};uc.prototype.Pec=function(T,Oa){Bc.ULS.shipAssertTag(537167711,0,!!T,"CopyPasteUtils.IsFromKeyboardShortcut: commandInfo shouldn't be null");return Oa&&ce.a.bI in Oa||T.tabName?!1:1===T.method};uc.Dfj=function(T,Oa,Ib,hc,nd,Td,Ed,he,Pe){function hf(){return new Ac(Ib,hc,nd)}function pg(Xg,yg,Rh){T.Xu();var Kh=T.qa.ta;Xg=eg.b(Xg,Td);yg=eg.a(yg,Ed);var Yg=he;Yg=void 0===Yg?null:Yg;var ji=Kh.Oa(9,fg);ji.sourceRanges=Ib;ji.destinationRanges=
hc;ji.flags=nd;return Rd.i(Kh,"PasteRange",ji,Xg,yg,Rh,null,64,Yg)}var fg=T.qa.ta.Xb(Pe);Pe=te.EwaSettings.tc()?new Dd.a(506,0,pg,65,hf):new cf.a(506,0,pg,1,hf);T.userOperationManager.ic(Pe,Oa)};uc.wbc=function(T,Oa,Ib,hc,nd,Td,Ed){Ed=void 0===Ed?null:Ed;Bc.ULS.sendTraceTag(537167710,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: on HandlePasteResult start. pasteContext.Id={0}",Oa.id);Oa.requestTelemetryData=T.RequestTelemetryData;Oa.serverRequestTimeInMs=Oa.commandParameters.stopwatch.Ac-
nd;Ec.a.hh(T.Errors)?Ec.a.w9(T.Errors)?(Oa&&(Oa.encounteredDeploymentErrors=!0),Bc.ULS.sendTraceTag(537167707,0,15,"CopyPasteUtils.HandlePasteServerResponse: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",Ec.a.Uc(T.Errors))):hc(new sd.a(5,T.Errors)):T.Result?(hc=!!T&&!!T.RequestTelemetryData,Hf.g(Td).Ji.Pka(Oa.commandParameters.stopwatch.id,T.StateId,hc?T.RequestTelemetryData.EcsOperationDuration:0,hc?T.RequestTelemetryData.EcsRequestDuration:0,hc?
T.RequestTelemetryData.WfeRequestDuration:0),Oa.pastedRange=T.Result.SheetMultiRange,Bc.ULS.sendTraceTag(537167708,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise ewaResult.Result is not null. pasteContext.Id={0}",Oa.id),Ib(!0)):(Bc.ULS.sendTraceTag(537167709,0,50,"CopyPasteInfrastructure.HandlePasteResult profiling trace: resolving promise when ewaResult.Result is null. pasteContext.Id={0}",Oa.id),Ib(Ed||!0))};uc.bLd=function(T,Oa,Ib,hc,nd,Td,Ed,he,Pe,hf,pg,fg){function Xg(){return new pb(Kh)}
function yg(Yg,ji,Di){T.Xu();return ad(T.qa.ta,Kh,eg.b(Yg,Ed),eg.a(ji,he),Di,Td,Rh,Pe)}var Rh=T.qa.ta.Xb(),Kh=uc.O3g(Ib,hc,nd,hf,pg,fg);Ib=te.EwaSettings.tc()?new Dd.a(503,0,yg,65,Xg):new cf.a(503,0,yg,1,Xg);T.userOperationManager.ic(Ib,Oa)};uc.O3g=function(T,Oa,Ib,hc,nd,Td){var Ed={};Ed.ShadowWorkbookBase64=T.shadowWorkbookBase64;Ed.SourceRanges={};Ed.SourceRanges.Ranges=Array(1);Ed.SourceRanges.Ranges[0]={};Ed.SourceRanges.Ranges[0].FirstRow=T.rangeRowStart;Ed.SourceRanges.Ranges[0].LastRow=T.rangeRowEnd;
Ed.SourceRanges.Ranges[0].FirstColumn=T.rangeColumnStart;Ed.SourceRanges.Ranges[0].LastColumn=T.rangeColumnEnd;te.EwaSettings.getBooleanFeatureGate(Bd.a.j3b,!1)?Ib?Ed.DestinationRanges=zf.u(Ib.SheetName,Ib.NamedObjectName,zf.g(Ib.Ranges)):(Bc.ULS.sendTraceTag(537167706,0,15,"CopyPasteInfrastructure.CreatePasteParameters: multiRangeDestination is null"),Ed.DestinationRanges=null):Ed.DestinationRanges=Oa?zf.s(Oa):null;Ed.CopyPasteTargetType=1;Ed.PasteType=hc;Ed.CopyOperationId=nd;Ed.PasteId=Td;Ed.SourceClientPath=
T.sourceClientPath;Ed.SourceSheetName=T.sourceSheetName;Ed.SourceWorkbookName=T.sourceWorkbookName;if(!T.originalSourceRangesCountExceedsLimit&&T.originalSourceRanges&&0<T.originalSourceRanges.length&&1024===hc){Ed.OriginalSourceMultiRange={};Oa=Array(T.originalSourceRanges.length);for(Ib=0;Ib<Oa.length;++Ib)Oa[Ib]={},Oa[Ib].FirstRow=T.originalSourceRanges[Ib][0],Oa[Ib].FirstColumn=T.originalSourceRanges[Ib][1],Oa[Ib].LastRow=T.originalSourceRanges[Ib][2],Oa[Ib].LastColumn=T.originalSourceRanges[Ib][3];
Ed.OriginalSourceMultiRange.Ranges=Oa}return Ed};uc.IOe=function(T,Oa,Ib){Ib=Ib.clone();Ib.height<Oa&&(Ib.bottom=Math.min(bf.a.Fh,Ib.top+Oa-1));Ib.width<T&&(Ib.right=Math.min(bf.a.Qh,Ib.left+T-1));return Ib};uc.prototype.executeInsertCopiedCutCellsOperation=function(T,Oa,Ib,hc,nd,Td,Ed){function he(){return new za(Pe)}Td=void 0===Td?null:Td;Ed=void 0===Ed?null:Ed;var Pe={};Pe.InsertDirection=hc;Pe.SourceRange=T;Pe.DestRange=Oa;Pe.CopyCutOperation=Ib?0:1;var hf=this.$.qa.ta;return Xe.a(this.$.userOperationManager,
function(pg,fg,Xg){pg=Td?eg.b(pg,Td):pg;fg=Ed?eg.a(fg,Ed):fg;var yg=hf.Oa(41,null);yg.insertCopiedCutCellsParameters=Pe;return Rd.i(hf,"InsertCopiedCutCells",yg,pg,fg,Xg,null,4)},function(pg){return new Dd.a(104,0,pg,void 0,he)},nd)};uc.prototype.idh=function(T,Oa,Ib,hc,nd,Td){var Ed=this;return new Promise(function(he,Pe){Ed.executeInsertCopiedCutCellsOperation(Oa,Ib,hc,nd,Td,function(hf){T.requestTelemetryData=hf.RequestTelemetryData;hf.Errors&&0<hf.Errors.length?Pe(new sd.a(21,hf.Errors)):he(!0)},
function(hf){hf=vf.a.yg(hf.data);Pe(new sd.a(21,hf))}).continueWith(function(){if(hc)Ed.Svb();else{var hf=Ed.$.da.Aa(254);hf&&hf.P0b("DragDropInsert/success/"+Kd.a[Td.method],!0)}})})};tl.Object.defineProperties(uc.prototype,{Ctd:{configurable:!0,enumerable:!0,get:function(){Bc.ULS.sendTraceTag(537167757,0,50,"CopyPasteUtils.MaxCopyPasteLength returning BootstrapContext.MaxCopyPasteLength. MaxCopyPasteLength={0}",this.$.ya.MaxCopyPasteLength);return this.$.ya.MaxCopyPasteLength}},dNa:{configurable:!0,
enumerable:!0,get:function(){return this.HLa?te.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.CopyPasteHtmlImportMaxLength",this.$.ya.CopyPasteMaxPayloadLength):bf.a.dNa}}});Object(Jc.a)(uc,"CopyPasteUtils",null,[676]);var wg=b(496),mg;(function(T){T[T.range=0]="range";T[T.art=1]="art"})(mg||(mg={}));Object(Jc.b)("SourceItemType",mg);var td=b(24),wf=b(92);Ic.prototype.serializeSourceItem=function(T){var Oa={};if(T&&Object.getType(T)===nc)Oa.sheetName=T.sheetName,Oa.topArray=yd.a.map(T.ranges,
function(Ib){return Ib.top}),Oa.leftArray=yd.a.map(T.ranges,function(Ib){return Ib.left}),Oa.bottomArray=yd.a.map(T.ranges,function(Ib){return Ib.bottom}),Oa.rightArray=yd.a.map(T.ranges,function(Ib){return Ib.right}),Oa.sessionStateId=T.sessionStateId,Oa.sessionId=T.sessionId,Oa.sourceItemType=this.RTf(0);else if(T&&Object.getType(T)===Nb)Oa.activeFloatingObjectControlId=T.activeFloatingObjectControlId,Oa.sheetName=T.sheetName,Oa.sessionStateId=T.sessionStateId,Oa.sessionId=T.sessionId,Oa.floatingObjectType=
this.egj(T.type),Oa.sourceItemType=this.RTf(1);else return Bc.ULS.shipAssertTag(537167705,0,!1,"EnvironmentSerializationHelper.SerializeSourceItem: sourceItem shouldn't be null."),null;return JSON.stringify(Oa)};Ic.prototype.serializeCommandParameters=function(T){if(!T)return Bc.ULS.shipAssertTag(537167704,0,!1,"EnvironmentSerializationHelper.Serialize: commandParameters shouldn't be null."),null;var Oa={};Oa.id=T.id;Oa.commandType=T.commandType;Oa.copyPasteTargetType=T.copyPasteTargetType;T.ribbonCommandInfo&&
(Oa.ribbonCommandName=this.mgj(T.ribbonCommandInfo.command),Oa.inputMethodName=this.ggj(T.ribbonCommandInfo.method),Oa.frameModeName=this.fgj(T.ribbonCommandInfo.mode),Oa.uiLocationName=this.pgj(T.ribbonCommandInfo.df),Oa.tabName=T.ribbonCommandInfo.tabName);return JSON.stringify(Oa)};Ic.prototype.deserializeSourceItem=function(T){if(!T)return null;try{var Oa=JSON.parse(T);if(!Oa)return Bc.ULS.shipAssertTag(537167703,0,!1,"EnvironmentSerializationHelper.Deserialize: Json.Parse return null result."),
null;var Ib=null;switch(this.$9g(Oa.sourceItemType)){case 0:Ib=new nc(this.$,this.X9g(Oa),Oa.sheetName,Oa.sessionStateId,Oa.sessionId);break;case 1:Ib=new Nb(Oa.activeFloatingObjectControlId,Oa.sheetName,Oa.sessionStateId,Oa.sessionId,this.U9g(Oa.floatingObjectType))}return Ib}catch(hc){return Bc.ULS.sendTraceTag(537167702,0,10,"EnvironmentSerializationHelper.DeserializeSourceItem: got exception while try to JSON.Parse string length: {0}, errror: {1}",T?T.length:0,hc),null}};Ic.prototype.deserializeCommandParameters=
function(T){if(!T)return null;try{var Oa=JSON.parse(T);if(!Oa)return Bc.ULS.shipAssertTag(537167701,0,!1,"EnvironmentSerializationHelper.DeserializeCommandParameters: Json.Parse return null result."),null;var Ib=Ld.a();Ib.id=Oa.id;Ib.ribbonCommandInfo=this.Z9g(Oa);Ib.commandType=Oa.commandType;Ib.copyPasteTargetType=Oa.copyPasteTargetType;return Ib}catch(hc){return Bc.ULS.sendTraceTag(537167700,0,10,"EnvironmentSerializationHelper.DeserializeCommandParameters: got exception while try to JSON.Parse string length: {0}, errror: {1}",
T?T.length:0,hc),null}};Ic.prototype.X9g=function(T){var Oa=[];Bc.ULS.shipAssertTag(537167699,0,!!T.topArray&&0<T.topArray.length,"EnvironmentSerializationHelper.DeserializeRanges: TopArray shouldn't be {0}.",T.topArray?"empty":"null");Bc.ULS.shipAssertTag(537167698,0,!!T.leftArray&&0<T.leftArray.length,"EnvironmentSerializationHelper.DeserializeRanges: LeftArray shouldn't be {0}.",T.leftArray?"empty":"null");Bc.ULS.shipAssertTag(537167697,0,!!T.bottomArray&&0<T.bottomArray.length,"EnvironmentSerializationHelper.DeserializeRanges: BottomArray shouldn't be {0}.",
T.bottomArray?"empty":"null");Bc.ULS.shipAssertTag(537167696,0,!!T.rightArray&&0<T.rightArray.length,"EnvironmentSerializationHelper.DeserializeRanges: RightArray shouldn't be {0}.",T.rightArray?"empty":"null");if(!(T.topArray&&T.leftArray&&T.bottomArray&&T.rightArray))return Oa;Bc.ULS.shipAssertTag(537167695,0,T.topArray.length===T.bottomArray.length&&T.topArray.length===T.leftArray.length&&T.topArray.length===T.rightArray.length,"EnvironmentSerializationHelper.DeserializeRanges: The length of TopArray({0}), BottomArray({1}), LeftArray({2}), RightArray({3}) should be the same.",
T.topArray.length,T.bottomArray.length,T.leftArray.length,T.rightArray.length);for(var Ib=Math.min(T.topArray.length,T.bottomArray.length,T.leftArray.length,T.rightArray.length),hc=0;hc<Ib;hc++)Array.add(Oa,new td.Range(T.topArray[hc],T.leftArray[hc],T.bottomArray[hc],T.rightArray[hc],!1,!1));return Oa};Ic.prototype.Z9g=function(T){return new wf.a(this.Y9g(T.ribbonCommandName),this.W9g(T.inputMethodName),this.V9g(T.frameModeName),this.a$g(T.uiLocationName),T.tabName)};Ic.prototype.mgj=function(T){return void 0!==
T&&null!==T&&T.toString()in this.hJd?this.hJd[T.toString()]:(Bc.ULS.shipAssertTag(537167694,0,!1,"EnvironmentSerializationHelper.SerializeRibbonCommand expected to get RibbonCommand.Copy({0}) or RibbonCommand.Cut({1}) but got {2}",-911352779,-1985798686,T),this.hJd["-911352779"])};Ic.prototype.Y9g=function(T){return T&&T in this.U2f?this.U2f[T]:(Bc.ULS.shipAssertTag(537167693,0,!1,"EnvironmentSerializationHelper.DeserializeRibbonCommand: expected to get RibbonCommand.Copy({0}) or RibbonCommand.Cut({1}) but got {2}",
-911352779,-1985798686,T),-911352779)};Ic.prototype.ggj=function(T){return void 0!==T&&null!==T&&Kd.a[T]in this.Nja?this.Nja[Kd.a[T]]:(Bc.ULS.shipAssertTag(537167692,0,!1,"EnvironmentSerializationHelper.SerializeInputMethod: got unexpected value {0}",T),this.Nja.unknown)};Ic.prototype.W9g=function(T){return T&&T in this.T2f?this.T2f[T]:(Bc.ULS.shipAssertTag(537167691,0,!1,"EnvironmentSerializationHelper.DeserializeInputMethod: got unexpected value {0}",T),0)};Ic.prototype.fgj=function(T){return void 0!==
T&&null!==T&&wg.a[T]in this.U1a?this.U1a[wg.a[T]]:(Bc.ULS.shipAssertTag(537167690,0,!1,"EnvironmentSerializationHelper.SerializeFrameMode: got unexpected value {0}",T),this.U1a.edit)};Ic.prototype.V9g=function(T){return T&&T in this.S2f?this.S2f[T]:(Bc.ULS.shipAssertTag(537167689,0,!1,"EnvironmentSerializationHelper.DeserializeFrameMode: got unexpected value {0}",T),2)};Ic.prototype.RTf=function(T){return void 0!==T&&null!==T&&mg[T]in this.mKb?this.mKb[mg[T]]:(Bc.ULS.shipAssertTag(537167688,0,!1,
"EnvironmentSerializationHelper.SerializeSourceItemType: got unexpected value {0}",T),this.mKb.range)};Ic.prototype.$9g=function(T){return T&&T in this.V2f?this.V2f[T]:(Bc.ULS.shipAssertTag(537167687,0,!1,"EnvironmentSerializationHelper.DeserializeSourceItemType: got unexpected value {0}",T),0)};Ic.prototype.egj=function(T){return void 0!==T&&null!==T&&T.toString()in this.mVc?this.mVc[T.toString()]:(Bc.ULS.shipAssertTag(537167686,0,!1,"EnvironmentSerializationHelper.SerializeArtSourceItemType: got unexpected value {0}",
T),this.mVc["99"])};Ic.prototype.U9g=function(T){return T&&T in this.R2f?this.R2f[T]:(Bc.ULS.shipAssertTag(537167685,0,!1,"EnvironmentSerializationHelper.DeserializeArtSourceItemType: got unexpected value {0}",T),99)};Ic.prototype.pgj=function(T){return void 0!==T&&null!==T&&ze.a[T]in this.rr?this.rr[ze.a[T]]:(Bc.ULS.shipAssertTag(36229129,0,!1,"EnvironmentSerializationHelper.SerializeUILocation: got unexpected value {0}",T),this.rr.ribbon)};Ic.prototype.a$g=function(T){return T&&T in this.W2f?this.W2f[T]:
(Bc.ULS.shipAssertTag(537167684,0,!1,"EnvironmentSerializationHelper.DeserializeUILocation: got unexpected value {0}",T),2)};Object(Jc.a)(Ic,"EnvironmentSerializationHelper",null,[]);Jb.kRf="SameSession";Jb.CCe="CrossSession";Jb.ghf="LegacyCrossSession";Jb.external="External";Object(Jc.a)(Jb,"PayloadOrigin",null,[]);Ba.prototype.shouldWaitForCopyToComplete=function(){return!1};Ba.prototype.onDeferredPasteStarted=function(){};Ba.prototype.onDeferredPasteCompleted=function(){};Ba.prototype.beforePaste=
function(){};Ba.prototype.KFj=function(T){var Oa=null;try{var Ib=T.getItem(gb.SN);if(!Ib)return{returnValue:!1,h0:Oa};Oa=JSON.parse(Ib);return{returnValue:this.bhi(Oa),h0:Oa}}catch(hc){return Bc.ULS.sendTraceTag(537167835,0,50,"BaseCopyPasteHandler.TryParseRangeShadowWorkbookPayload: Exception caught: "+hc),{returnValue:!1,h0:Oa}}};Ba.prototype.bhi=function(T){return!!T&&(!!T.shadowWorkbookBase64||T.shadowWorkbookSizeExceedsLimit)&&void 0!==T.rangeRowStart&&void 0!==T.rangeRowEnd&&void 0!==T.rangeColumnStart&&
void 0!==T.rangeColumnEnd};Ba.prototype.Inc=function(T){T.wasLastCopyExternal=!0;if(te.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CrossAppShadowWorkbookPaste",!1)&&!$e.a.rC&&516!==T.commandParameters.commandType&&1028!==T.commandParameters.commandType){var Oa=this.KFj(T.clipboardItems);var Ib=Oa.h0;if(Oa.returnValue)return T.isShadowWorkbookParsedSuccessfully=!0,this.XPi(T,Ib)}return 516!==T.commandParameters.commandType&&36!==T.commandParameters.commandType?te.EwaSettings.la(161)&&
20!==T.commandParameters.commandType&&(Ib=T.clipboardItems.getItem(gb.html),void 0!==Ib&&null!==Ib&&Ib&&Ib.trim()!==this.qVc&&(Ib.startsWith("<")||$e.a.zf&&Ib.startsWith("\n<")))?(Oa=T.clipboardItems.getItem(gb.g1c),this.VPi(T,Ib,void 0===Oa?null:Oa)):this.PCf(T):Promise.reject(new sd.a(6))};Ba.prototype.XPi=function(T,Oa){Bc.ULS.sendTraceTag(537167834,0,50,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: Pasting shadow workbook from system clipboard");T.pasteResult="SystemClipboardShadowWorkbookPaste";
T.payloadType=Pd.SN;T.payloadOrigin=Jb.external;T.shadowWorkbookPayloadSize=Zb(Oa);T.shadowWorkbookSizeExceedsLimit=db(Oa);var Ib=null,hc=null,nd=T.commandParameters.originalDestinations;te.EwaSettings.getBooleanFeatureGate(Bd.a.j3b,!1)?Ib=zf.r(nd,this.$):hc=zf.v(zf.K(nd),this.$);Oa.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(T.originalSourceRangesCountExceedsLimit=Oa.originalSourceRangesCountExceedsLimit);if(T.shadowWorkbookSizeExceedsLimit)return Bc.ULS.sendTraceTag(537167833,0,15,
"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: shadow workbook length({0}) is over the limit({1}). reject the paste request. ShadowWorkbookSizeExceedsLimit: {2}",T.shadowWorkbookPayloadSize,bf.a.gjc,Oa.shadowWorkbookSizeExceedsLimit),Promise.reject(new sd.a(1));Bc.ULS.sendTraceTag(537167832,0,50,"BaseCopyPasteHandler.PasteFromExternalByShadowWorkbook: trigger Paste request. PasteOperationId={0}",T.commandParameters.id);return this.Er.TCf(T.commandParameters.ribbonCommandInfo,hc,Ib,Oa,[T.commandParameters.stopwatch],
T)};Ba.prototype.PCf=function(T){var Oa=T.clipboardItems.getItem(gb.VV);if(void 0!==Oa&&null!==Oa&&Oa.trim()===this.qVc)return Promise.reject(new sd.a(7));void 0!==Oa&&null!==Oa&&(T.plainTextPayloadSize=Oa.length);T.isPlainTextPaste=!0;T.pasteResult="SystemClipboardPaste";T.payloadOrigin=oc(T)?Jb.ghf:Jb.external;T.payloadType=Pd.VV;Bc.ULS.sendTraceTag(537167831,0,50,"BaseRangeCopyPasteHandler.PasteByPlainText: trigger ProcessPasteText request. pasteContext.Id={0}, PasteOperationId={1}",T.id,T.commandParameters.id);
Oa=this.Er.XUi(zf.K(T.commandParameters.originalDestinations),Oa,T.commandParameters.ribbonCommandInfo,[T.commandParameters.stopwatch],T);Bc.ULS.sendTraceTag(537167830,0,50,"BaseRangeCopyPasteHandler.PasteByPlainText: returned from ProcessPasteText. pasteContext.Id={0}",T.id);return Oa};Ba.prototype.VPi=function(T,Oa,Ib){T.htmlPayloadSize=Oa.length;T.isHtmlPaste=!0;T.pasteResult="SystemClipboardHtmlPaste";T.payloadType=Pd.html;T.payloadOrigin=oc(T)?Jb.ghf:Jb.external;Bc.ULS.sendTraceTag(42071711,
0,50,"BaseRangeCopyPasteHandler.PasteByHtml: trigger ProcessPasteHtml request. PasteOperationId={0}",T.commandParameters.id);return this.Er.WUi(zf.K(T.commandParameters.originalDestinations),Oa,Ib,T.commandParameters.id,T.commandParameters.ribbonCommandInfo,[T.commandParameters.stopwatch],T)};Ba.prototype.cCe=function(T){var Oa={};T&&(Oa.shadowWorkbookBase64=T.ShadowWorkbookBase64,Oa.shadowWorkbookSizeExceedsLimit=T.ShadowWorkbookSizeExceedsLimit,Oa.originalSourceRangesCountExceedsLimit=T.OriginalSourceRangesCountExceedsLimit,
Oa.originalSourceRangesCount=T.OriginalSourceRangesCount,Oa.shadowWorkbookBlockedSize=T.ShadowWorkbookBlockedSize);return Oa};Ba.prototype.mbg=function(T,Oa){var Ib=wc(T),hc=32===(T.commandParameters.commandType&32),nd=1024===(T.commandParameters.commandType&1024),Td=!1,Ed=null,he=null,Pe=!1;if(!Ib){Td=-1985798686===T.commandParameters.ribbonCommandInfo.command;var hf=T.copyContextSnapshot;if(Oa)Pe=!hf.sourceItem.isFromCurrentSession(this.$);else if(hf=this.Er.Fub(hf))Ed=hf.ranges,he=hf.sheetName,
Pe=!T.isSameSession}return this.Er.GGg(he,Ed,this.$.oa.sheetName,T.commandParameters.originalDestinations,T.commandParameters.expandDestinations,Pe,hc,nd,Td,Oa,Ib)};tl.Object.defineProperties(Ba.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}},qVc:{configurable:!0,enumerable:!0,get:function(){return this.Om.Va(5)}}});Object(Jc.a)(Ba,"BaseCopyPasteHandler",null,[712,713,714]);Wa.prototype.getValue=function(T){return this.key&&this.key.isEqual(T)?this.createClipboardItems(this.clipboardItems):
null};Wa.prototype.setValue=function(T,Oa){this.key=T;this.clipboardItems=this.createClipboardItems(Oa)};Wa.prototype.createClipboardItems=function(T){var Oa=this.U9.create(),Ib=T.getItem(gb.VV);Ib&&Oa.setItem(gb.VV,Ib);(Ib=T.getItem(gb.SN))&&Oa.setItem(gb.SN,Ib);(T=T.getItem(gb.html))&&Oa.setItem(gb.html,T);return Oa};Object(Jc.a)(Wa,"CopyCache",null,[]);var Oh=b(67);vm(Za,Ba);Za.prototype.getSourceItem=function(){var T=yd.a.clone(this.gridView.ha.va.selectedRanges);return new nc(this.$,T,this.$.fa.oa.sheetName,
this.$.fa.rf,this.$.ya.UserSessionId)};Za.prototype.beforeSerialize=function(T){var Oa=this;T.isSelectionAllowed=!1;T.isAsyncCopy=!1;T.isFromCache=!1;T.encounteredDeploymentErrors=!1;T.plainTextPayloadSize=0;T.shadowWorkbookPayloadSize=0;T.htmlPayloadSize=0;T.clientSideCopyTime=0;var Ib=new lg.a(this.$.xa),hc=T.sourceItem;T.isSelectionAllowed=yd.a.all(hc.ranges,function(nd){return Oa.isSelectionAllowed(Ib,nd)});T.isSelectionAllowed&&this.Er.K5e(hc.ranges,T.commandParameters.commandType)};Za.prototype.ULa=
function(T){return this.gridView.Ca.cH()&&Hf.i(this.gridView,T)};Za.prototype.sQi=function(T,Oa,Ib,hc){var nd=!1,Td=1===Oa.commandParameters.commandType,Ed=hc[0].HT;1===Ib.ranges.length&&1===hc.length?te.EwaSettings.isChangeGateEnabled("OfficeVSO:5593878_PasteCSE_CCPErrorTests1")&&Td&&1!==Ed&&Ed!==Ib.ranges[0].HT?T.cseStatus=17:nd=this.TZg.o5c(T,zf.K(Ib.ranges),Ib.sheetName,zf.K(T.commandParameters.expandDestinations),this.$.fa.oa.sheetName,Td):T.cseStatus=5;nd&&Hf.g(this.$).Ji.n0(T.commandParameters.stopwatch.id,
Oh.BasicTelemetryCalculator.sQ);return this.bQi(T,Ib,zf.u(this.$.oa.sheetName,null,hc),Oa.commandParameters.commandType,nd)};Za.prototype.isSelectionAllowed=function(T,Oa){return T.yyb(Oa,this.gridView)};Za.prototype.bQi=function(T,Oa,Ib,hc,nd){Oa=zf.u(Oa.sheetName,null,Oa.ranges);T.pasteResult="SameSessionPaste";T.payloadOrigin=Jb.kRf;T.payloadType=Pd.jvg;Bc.ULS.sendTraceTag(537167829,0,50,"BaseRangeCopyPasteHandler.PasteSameSession: trigger PasteRange request. PasteOperationId={0}",T.commandParameters.id);
return this.Er.pasteRange(T.commandParameters.ribbonCommandInfo,Oa,Ib,hc,T.commandParameters.commandType,[T.commandParameters.stopwatch],T,nd)};Object(Jc.a)(Za,"BaseRangeCopyPasteHandler",Ba,[]);var Jg=b(32);dc.prototype.onDeferredPasteStarted=function(T){this.fU.wb(T.id)||this.fU.add(T.id,!0);if(0<this.fU.count){var Oa=ef.GetServiceTaskFactory.Xa(this.$.da,5,4,0);$f.TaskExtensions.Ba(Oa,function(){Oa.result.hg(28,null)},this.$.ma,3)}};dc.prototype.onDeferredPasteCompleted=function(T){var Oa=0<this.fU.count;
this.fU.wb(T.id)&&this.fU.remove(T.id);if(Oa&&!this.fU.count){var Ib=ef.GetServiceTaskFactory.Xa(this.$.da,5,4,0);$f.TaskExtensions.Ba(Ib,function(){Ib.result.removeEntry(28)},this.$.ma,3)}};Object(Jc.a)(dc,"DeferredPasteTracker",null,[]);var oh;(function(T){T[T.none=0]="none";T[T.loadClipboardFromServerFailed=1]="loadClipboardFromServerFailed";T[T.loadCopiedDataFromServerFailed=2]="loadCopiedDataFromServerFailed";T[T.asyncCopyCanceled=3]="asyncCopyCanceled";T[T.loadCopiedArtDataFromServerFailed=
4]="loadCopiedArtDataFromServerFailed"})(oh||(oh={}));Object(Jc.b)("CopyErrorType",oh);var kd=b(1058),sg=b(1214),lh=kd.a;vm(Xb,lh);Object(Jc.a)(Xb,"CopyInnerError",kd.a,[]);vm($a,Za);$a.prototype.serialize=function(T){var Oa=T.sourceItem,Ib={},hc=this.f1c.getValue(Oa);if(hc)Ib.synchronousResult=hc,T.isFromCache=!0,T.clientSideCopyTime=T.commandParameters.stopwatch.Ac;else{var nd=null,Td=zf.F(Oa.ranges);if(!ag.a.Zaf()&&this.ULa(Td)){Bc.ULS.sendTraceTag(537167936,0,50,"AcrossSessionRangeCopyPasteHandler.Serialize: All data is loaded prepare the data in the client side.");
Td=this.clipboardRangeFactory.create(Td);try{nd=Td.toString(),hc=this.U9.create(),hc.setItem(gb.VV,nd),this.f1c.setValue(Oa,hc),Ib.synchronousResult=hc,T.clientSideCopyTime=T.commandParameters.stopwatch.Ac}finally{Td&&Td.dispose()}}else T.isAsyncCopy=!0,Ib.synchronousResult=this.U9.create(),Ib.synchronousResult.setItem(gb.VV,this.qVc);Ib.asynchronousResult=this.Qbd(T,Oa,nd)}T.syncClipboardItemsKeys=Qd(Ib.synchronousResult);return Ib};$a.prototype.shouldWaitForCopyToComplete=function(T){if(!T||!T.copyContextSnapshot)return Bc.ULS.sendTraceTag(537167907,
0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: pasteContext or pasteContext.CopyContextSnapshot is not define, return false."),!1;Bc.ULS.shipAssertTag(537167906,0,!!this.$.ya,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: this.EwaControl.BootstrapContext shouldn't be null");if(T.copyContextSnapshot.sessionId===this.$.ya.UserSessionId)return Bc.ULS.sendTraceTag(537167905,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: Same session copy scenario, return false."),
!1;Bc.ULS.sendTraceTag(537167904,0,50,"AcrossSessionRangeCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0};$a.prototype.onDeferredPasteStarted=function(T){this.fU.onDeferredPasteStarted(T)};$a.prototype.onDeferredPasteCompleted=function(T){this.fU.onDeferredPasteCompleted(T)};$a.prototype.deserialize=function(T){T.isClipboardDataContainShadowWorkbook=!(void 0===T.clipboardItems.getItem(gb.SN)||null===T.clipboardItems.getItem(gb.SN));if(Hf.g(this.$).ha.Te&326)return wc(T)&&(T.wasLastCopyExternal=
!0),Promise.reject(new sd.a(17));var Oa=this.mbg(T,!1);if(Oa)return Promise.reject(new sd.a(wc(T)?18:T.isSameSession?19:20,void 0,void 0,void 0,Oa));var Ib=T.copyContextSnapshot,hc=this.Er.Fub(Ib);if(wc(T))return this.Inc(T);Oa=T.commandParameters.originalDestinations;if(hc&&T.isSameSession)return this.sQi(T,Ib,hc,Oa);if(516!==T.commandParameters.commandType){hc=this.JFj(T.clipboardItems);Ib=hc.h0;if(hc.returnValue){T.isShadowWorkbookParsedSuccessfully=!0;var nd=hc=null;te.EwaSettings.getBooleanFeatureGate(Bd.a.j3b,
!1)?hc=zf.r(Oa,this.$):nd=zf.v(zf.K(Oa),this.$);return this.TPi(T,nd,hc,Ib)}if(T.isClipboardInaccessible)return Promise.reject(new sd.a(8));if(36!==T.commandParameters.commandType)return this.PCf(T)}return Promise.reject(new sd.a(6))};$a.prototype.beforePaste=function(T){this.$.da.Aa(373).Wcj(T);T.indicationDisplayScheduled=!0};$a.prototype.fFj=function(T){if(!(T&&T.SourceRanges&&T.SourceRanges.Ranges&&T.SourceRanges.Ranges.length&&(T.OriginalSourceRangesCountExceedsLimit||T.OriginalSourceMultiRange&&
T.OriginalSourceMultiRange.Ranges&&T.OriginalSourceMultiRange.Ranges.length)))return{returnValue:!1,h0:null};var Oa=T.SourceRanges.Ranges[0];if(!T.ShadowWorkbookBase64&&!T.ShadowWorkbookSizeExceedsLimit)return{returnValue:!1,h0:null};var Ib=this.cCe(T);Ib.rangeRowStart=Oa.FirstRow;Ib.rangeRowEnd=Oa.LastRow;Ib.rangeColumnStart=Oa.FirstColumn;Ib.rangeColumnEnd=Oa.LastColumn;Ib.sourceClientPath=T.SourceClientPath;Ib.sourceSheetName=T.SourceSheetName;Ib.sourceWorkbookName=T.SourceWorkbookName;if(!T.OriginalSourceRangesCountExceedsLimit)for(T=
T.OriginalSourceMultiRange.Ranges,Ib.originalSourceRanges=Array(T.length),Oa=0;Oa<T.length;++Oa)Ib.originalSourceRanges[Oa]=[T[Oa].FirstRow,T[Oa].FirstColumn,T[Oa].LastRow,T[Oa].LastColumn];return{returnValue:!0,h0:Ib}};$a.prototype.JFj=function(T){var Oa=null;T=T.getItem(gb.SN);if(!T)return{returnValue:!1,h0:Oa};Oa=JSON.parse(T);return{returnValue:this.ahi(Oa),h0:Oa}};$a.prototype.ahi=function(T){return!!T&&(!!T.shadowWorkbookBase64||T.shadowWorkbookSizeExceedsLimit)&&void 0!==T.rangeRowStart&&void 0!==
T.rangeRowEnd&&void 0!==T.rangeColumnStart&&void 0!==T.rangeColumnEnd};$a.prototype.TPi=function(T,Oa,Ib,hc){Bc.ULS.shipAssertTag(537167903,0,!!hc,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadowWorkbookPayload shouldn't be null");we.AFrameworkApplication.bK("Microsoft.Office.Excel.Server.Flighting.IDenyListNewCopyPasteExperienceAcrossSessions");T.pasteResult="CrossSessionPaste";T.payloadOrigin=Jb.CCe;T.payloadType=Pd.SN;T.shadowWorkbookPayloadSize=Zb(hc);T.shadowWorkbookSizeExceedsLimit=
db(hc);hc.hasOwnProperty("originalSourceRangesCountExceedsLimit")&&(T.originalSourceRangesCountExceedsLimit=hc.originalSourceRangesCountExceedsLimit);if(T.shadowWorkbookSizeExceedsLimit)return Bc.ULS.sendTraceTag(34415003,0,15,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: shadow workbook length({0}) is over the limit({1}). reject the paste request. ShadowWorkbookSizeExceedsLimit: {2}",T.shadowWorkbookPayloadSize,bf.a.gjc,hc.shadowWorkbookSizeExceedsLimit),Promise.reject(new sd.a(1));if(1028===
T.commandParameters.commandType&&T.originalSourceRangesCountExceedsLimit)return Bc.ULS.sendTraceTag(572617859,0,15,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: Original source ranges count({0}) is over the limit({1}). Reject the paste request. OriginalSourceRangesCountExceedsLimit: {2}",hc.originalSourceRangesCount,bf.a.hri,hc.originalSourceRangesCountExceedsLimit),Promise.reject(new sd.a(1));Bc.ULS.sendTraceTag(537167902,0,50,"AcrossSessionRangeCopyPasteHandler.PasteAcrossSessions: trigger Paste request. PasteOperationId={0}",
T.commandParameters.id);return this.Er.TCf(T.commandParameters.ribbonCommandInfo,Oa,Ib,hc,[T.commandParameters.stopwatch],T)};$a.prototype.Qbd=function(T,Oa,Ib){var hc=this;Bc.ULS.shipAssertTag(537167901,0,!!T,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: copyContext shouldn't be null");var nd=T.commandParameters.stopwatch.Ac;return new Promise(function(Td,Ed){Bc.ULS.sendTraceTag(26035421,0,50,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data for copy Id: {0}",
T.id);var he=zf.u(Oa.sheetName,null,Oa.ranges);hc.Er.copy(he,T.commandParameters,function(Pe){T.requestTelemetryData=Pe.RequestTelemetryData;T.serverRequestTimeInMs=T.commandParameters.stopwatch.Ac-nd;if(Ec.a.hh(Pe.Errors))Ec.a.w9(Pe.Errors)?(T.encounteredDeploymentErrors=!0,Bc.ULS.sendTraceTag(537167898,0,15,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}. copy Id: {1}",Ec.a.Uc(Pe.Errors),
T.id)):(Bc.ULS.sendTraceTag(26035419,0,10,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}. copy Id: {1}",Ec.a.Uc(Pe.Errors),T.id),Ed(new Xb(2,Pe.Errors)));else if(Bc.ULS.sendTraceTag(537167900,0,50,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeed for copy Id: {0}",T.id),T.markForCancellation)Ed(new Xb(3,Pe.Errors));else{Pe=Pe.Result;var hf=Pe.PlainTextResult;void 0!==Ib&&null!==Ib&&(hf=Ib);void 0!==
hf&&null!==hf&&(T.plainTextPayloadSize=hf.length);var pg=hc.U9.create(),fg=hc.fFj(Pe);var Xg=fg.h0;fg.returnValue&&(T.shadowWorkbookPayloadSize=Zb(Xg),T.shadowWorkbookSizeExceedsLimit=db(Xg),T.originalSourceRangesCountExceedsLimit=Pe.OriginalSourceRangesCountExceedsLimit,Xg=JSON.stringify(Xg),pg.setItem(gb.SN,Xg));pg.setItem(gb.VV,hf);ag.a.Zaf()&&(hf=Pe.HtmlResult,T.htmlSizeExceedsLimit=Pe.HtmlSizeExceedsLimit,void 0!==hf&&null!==hf&&(T.htmlPayloadSize=hf.length),pg.setItem(gb.html,hf));T.copyTotalSizeExceedsLimit=
Pe.CopyTotalSizeExceedsLimit;pg.setItem(gb.g1c,T.commandParameters.id);hc.f1c.setValue(Oa,pg);T.asyncClipboardItemsKeys=Qd(pg);Td(pg)}},function(Pe){T.serverRequestTimeInMs=T.commandParameters.stopwatch.Ac-nd;Pe=vf.a.yg(Pe.data);Bc.ULS.sendTraceTag(537167897,0,10,"AcrossSessionRangeCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}. copy Id: {1}",Ec.a.Uc(Pe),T.id);Ed(new Xb(2,Pe))},[T.commandParameters.stopwatch])})};Object(Jc.a)($a,"AcrossSessionRangeCopyPasteHandler",
Za,[]);Object(Jc.a)(kb,"CopyArtRequest",null,[]);Object(Jc.a)(Ua,"PasteArtRequest",null,[]);Ha.prototype.uYh=function(T){if(this.ndi(T.YMa)){Bc.ULS.sendTraceTag(537167681,5,50,"PasteArtRequestManager.HandleRequest: Enqueued paste request as a result of rapid paste on same destination: {0}",T.YMa);var Oa=this.FGb.na(T.YMa);this.FGb.ia(T.YMa,T);var Ib=Oa.promise;Oa.nbf=!1;return this.Cgh(T,Ib)}this.FGb.ia(T.YMa,T);return this.Qji(T)};Ha.prototype.ndi=function(T){return this.FGb.wb(T)};Ha.prototype.Qji=
function(T){var Oa=this;return new Promise(function(Ib,hc){T.promise=Oa.oYa.OCf(T).then(function(nd){Ib(null);return Oa.gmc(T,nd)},function(nd){hc(null);return Oa.MCb(nd)})})};Ha.prototype.Cgh=function(T,Oa){var Ib=this;return new Promise(function(hc,nd){T.promise=Oa.then(function(Td){Ib.HKj(T,Td);return Ib.oYa.OCf(T).then(function(Ed){hc(null);return Ib.gmc(T,Ed)},function(Ed){nd(null);return Ib.MCb(Ed)})},function(Td){return Ib.MCb(Td)})})};Ha.prototype.gmc=function(T,Oa){T.nbf&&(this.NTg(T.YMa),
this.EKd(T,Oa));return this.yVi(Oa)};Ha.prototype.NTg=function(T){this.FGb.remove(T)};Ha.prototype.EKd=function(T,Oa){var Ib=this.UQh();T.YMa===Ib&&this.oYa.EKd(T.destination,Oa,T.item.type)};Ha.prototype.UQh=function(){var T=Hf.g(this.$).ha.Qa.activeFloatingObjectControlId;T||(T=zf.v(Hf.g(this.$).ha.va.activeCell,this.$),T=T.FirstRow+"_"+T.FirstColumn);return T};Ha.prototype.HKj=function(T,Oa){T.destination=null;T.yEe=Oa};Object(Jc.a)(Ha,"PasteArtRequestManager",null,[]);var Ye=b(188),Rg=b(115),
jh=b(103);vm(Ga,Ba);Ga.prototype.getSourceItem=function(){Bc.ULS.shipAssertTag(537167896,0,!!this.ha.Qa.activeFloatingObjectControlId,"Expecting a floating object to be currently selected for copy");Bc.ULS.sendTraceTag(537167895,0,50,"ArtCopyPasteHandler.GetSourceItem: Creating ArtSourceItem with FloatingObjectId=[{0}]",this.ha.Qa.activeFloatingObjectControlId);return new Nb(this.ha.Qa.activeFloatingObjectControlId,this.$.fa.oa.sheetName,this.$.fa.rf,this.$.ya.UserSessionId,this.ha.Qa.nc.floatingObject.type)};
Ga.prototype.beforeSerialize=function(T){T&&T.commandParameters?(T?(T.isAsyncCopy=!1,T.isSelectionAllowed=!1,T.isFromCache=!1,T.plainTextPayloadSize=0,T.shadowWorkbookPayloadSize=0,T.htmlPayloadSize=0,T.htmlSizeExceedsLimit=!1,T.clientSideCopyTime=0,T.encounteredDeploymentErrors=!1,T.shadowWorkbookSizeExceedsLimit=!1,T.originalSourceRangesCountExceedsLimit=!1,T.copyTotalSizeExceedsLimit=!1):Bc.ULS.sendTraceTag(537167826,0,10,"CommonCopyPasteUtils.InitializeCopyContext: copyContext is null."),T.commandParameters.copyPasteTargetType=
2):Bc.ULS.sendTraceTag(537167894,0,10,"ArtCopyPasteHandler.BeforeSerialize: copyContext or copyContext.CommandParameters is null.")};Ga.prototype.serialize=function(T){var Oa=T.sourceItem,Ib={};if(!Oa)return Bc.ULS.sendTraceTag(537167893,0,10,"ArtCopyPasteHandler.Serialize: artSourceItem should not be null"),Ib;if(!this.Vfi())return Bc.ULS.sendTraceTag(36824456,0,50,"ArtCopyPasteHandler.Serialize: Unsupported floating object type. This will clear the clipboard"),Ib;Bc.ULS.sendTraceTag(537167892,0,
50,"ArtCopyPasteHandler.Serialize: Serializing ArtSourceItem with FloatingObjectId=[{0}]",Oa.activeFloatingObjectControlId);this.RBd();var hc=this.e1c.getValue(Oa);if(hc)Ib.synchronousResult=hc,T.isFromCache=!0,T.isAsyncCopy=!1,T.clientSideCopyTime=T.commandParameters.stopwatch.Ac,1===T.commandParameters.commandType&&this.$.Ce(2045211913,T.commandParameters.ribbonCommandInfo.method,T.commandParameters.ribbonCommandInfo.df,null);else{T.isFromCache=!1;T.isAsyncCopy=!0;hc=this.U9.create();if(T.commandParameters.uploadToClipService){var nd=
{};nd["data-clipservice-ccpid"]=T.commandParameters.id;nd["data-pkey"]=T.commandParameters.pKey;nd["data-clipservice-type"]=T.commandParameters.clipServiceDataType;nd["data-clipservice-count"]=T.commandParameters.objectCount.toString();nd["data-clipservice-dc"]=T.commandParameters.clipServiceDataCenter;nd["data-clipservice-client"]=this.EUg;nd["data-TimeStamp"]=(new Date).toUTCString();nd["data-clipservice-version"]=this.FUg;hc.setItem(gb.tDg,JSON.stringify(nd))}Ib.synchronousResult=this.Pwg(hc);
Ib.asynchronousResult=this.Qbd(T,Oa,hc)}T.syncClipboardItemsKeys=Qd(Ib.synchronousResult);return Ib};Ga.prototype.Pwg=function(T){Bc.ULS.shipAssertTag(537167891,0,!!this.ha.Qa.nc,"Expecting a floating object to be currently selected for copy");T||(T=this.U9.create());var Oa=this.ha.Qa.nc.itb();Oa&&(Oa=String.format("<img src='{0}'>",Oa),T.setItem(gb.html,Oa));return T};Ga.prototype.RBd=function(){var T=this.ha.Qa.nc;this.gnb.RBd(Rg.a.dpb(T.floatingObject),Rg.a.HUg(T.qt))};Ga.prototype.shouldWaitForCopyToComplete=
function(){Bc.ULS.sendTraceTag(537167890,0,50,"ArtCopyPasteHandler.ShouldWaitForCopyToComplete: returning true");return!0};Ga.prototype.onDeferredPasteStarted=function(T){this.fU.onDeferredPasteStarted(T)};Ga.prototype.onDeferredPasteCompleted=function(T){this.fU.onDeferredPasteCompleted(T)};Ga.prototype.deserialize=function(T){var Oa=wc(T),Ib=null,hc=null,nd=!1;if(!Oa){Ib=T.copyContextSnapshot;hc=Ib.sourceItem;if(!hc)return Promise.reject(new sd.a(10));nd=hc.isFromCurrentSession(this.$)}var Td=this.mbg(T,
!0);if(Td)return Promise.reject(new sd.a(Oa?18:nd?19:20,void 0,void 0,void 0,Td));if(Oa)return this.Inc(T);if(!nd&&!Ga.p$h(hc))return T=String.format("User attempted to paste art of type [{0}] between sessions.",hc.type),Bc.ULS.sendTraceTag(537167889,0,50,T),Promise.reject(new sd.a(11,void 0,void 0,T));if(Ib.isAsyncSerializeFailed)return Promise.reject(new sd.a(16,void 0,void 0,"Last async serialize failed, therefore no current shadow workbook payload to paste"));try{var Ed=T.clipboardItems.getItem(gb.SN);
var he=JSON.parse(Ed)}catch(Pe){return Bc.ULS.sendTraceTag(537167888,0,10,"ArtCopyPasteHandler.Deserialize: Failed to parse shadow workbook JSON with exception: {0}",copyPasteInfra.getStringifiedError(Pe)),Promise.reject(new sd.a(12,void 0,Pe))}he.floatingObjectId!==hc.activeFloatingObjectControlId?Bc.ULS.sendTraceTag(537167887,0,10,"ArtCopyPasteHandler.Deserialize: FloatingObjectId mismatch! Deserializing with artSourceItem.ActiveFloatingObjectControlId=[{0}], shadowWorkbookPayload.FloatingObjectId=[{1}]",
hc.activeFloatingObjectControlId,he.floatingObjectId):Bc.ULS.sendTraceTag(537167886,0,50,"ArtCopyPasteHandler.Deserialize: Deserializing with artSourceItem.ActiveFloatingObjectControlId=[{0}], shadowWorkbookPayload.FloatingObjectId=[{1}]",hc.activeFloatingObjectControlId,he.floatingObjectId);if(!he||!he.shadowWorkbookBase64)return Promise.reject(new sd.a(13,void 0,void 0,String.format("shadowWorkbookPayload is null = {0}",!he)));T.isShadowWorkbookParsedSuccessfully=!0;T.shadowWorkbookPayloadSize=
Zb(he);T.shadowWorkbookSizeExceedsLimit=db(he);T.payloadOrigin=nd?Jb.kRf:Jb.CCe;T.payloadType=Pd.Aeg;if(db(he))return T=String.format("Shadow workbook size [{0}] is over the limit [{1}]. ShadowWorkbookSizeExceedsLimit: {2}",T.shadowWorkbookPayloadSize,bf.a.gjc,he.shadowWorkbookSizeExceedsLimit),Bc.ULS.sendTraceTag(36304156,0,15,"ArtCopyPasteHandler.Deserialize: {0}",T),Promise.reject(new sd.a(1,void 0,void 0,T));Ib=Oa=null;Hf.g(this.$).ha.Te&326?Ib=Hf.g(this.$).ha.Qa.activeFloatingObjectControlId:
Oa=this.$.oa&&this.$.oa.activeCell?zf.v(this.$.oa.activeCell,this.$):zf.v(zf.K(T.commandParameters.originalDestinations),this.$);nd=null;if(this.gnb.gZf(hc))try{nd=this.gnb.o5c()}catch(Pe){Bc.ULS.sendTraceTag(537167885,0,10,"ArtCopyPasteHandler.Deserialize: Exception encountered while performing client-side estimation. Exception: {0}",copyPasteInfra.getStringifiedError(Pe))}return this.UPi.uYh(new Ua(T.commandParameters.ribbonCommandInfo,Oa,Ib,T.commandParameters.commandType,[T.commandParameters.stopwatch],
he,hc,T,nd))};Ga.prototype.Inc=function(T){T.wasLastCopyExternal=!0;if(T.clipboardItems.getItem("image/png")){var Oa=T.commandParameters.stopwatch.Ac;T.payloadType=Pd.NJg;var Ib={};return $b.b(this.$.Ce(1403967063,T.commandParameters.ribbonCommandInfo.method,T.commandParameters.ribbonCommandInfo.df,(Ib.dataUrl=T.clipboardItems.getItem("image/png"),Ib))).then(function(hc){T.serverRequestTimeInMs=T.commandParameters.stopwatch.Ac-Oa;return hc?Promise.resolve(null):Promise.reject(new sd.a(15))},function(){T.serverRequestTimeInMs=
T.commandParameters.stopwatch.Ac-Oa;return Promise.reject(new sd.a(15))})}Bc.ULS.shipAssertTag(537167884,0,!1,"Should not paste external content that is not image via ArtCopyPasteHandler");return Ba.prototype.Inc.call(this,T)};Ga.prototype.Vfi=function(){var T=Hf.g(this.$).ha;return T.Qa.activeFloatingObjectControlId&&T.Qa.nc&&T.Qa.nc.floatingObject?T.Qa.nc.floatingObject.FRd():!1};Ga.prototype.Qbd=function(T,Oa,Ib){var hc=this;return new Promise(function(nd,Td){var Ed=T.commandParameters.stopwatch.Ac;
Bc.ULS.sendTraceTag(41562516,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: issue request to the server to get the copied data...");hc.oYa.LZg(new kb(Oa.activeFloatingObjectControlId,T.commandParameters,function(he){T.requestTelemetryData=he.RequestTelemetryData;T.serverRequestTimeInMs=T.commandParameters.stopwatch.Ac-Ed;if(Ec.a.hh(he.Errors))Ec.a.w9(he.Errors)?(T.encounteredDeploymentErrors=!0,Bc.ULS.sendTraceTag(537167879,0,15,"ArtCopyPasteHandler.GetCopiedDataFromServer: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",
Ec.a.Uc(he.Errors))):(Bc.ULS.sendTraceTag(36229122,0,10,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}",Ec.a.Uc(he.Errors)),Td(new Xb(4,he.Errors)));else if(Bc.ULS.sendTraceTag(537167883,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer succeeded for FloatingObjectId=[{0}].",Oa.activeFloatingObjectControlId),T.markForCancellation)Td(new Xb(3,he.Errors));else{Ec.a.Pq(he.Errors)&&Bc.ULS.sendTraceTag(537167882,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: Server messages present. Errors: {0}",
Ec.a.Uc(he.Errors));var Pe=he.Result;if(Pe){Pe=hc.cCe(Pe);Pe.floatingObjectId=Oa.activeFloatingObjectControlId;T.shadowWorkbookPayloadSize=Zb(Pe);T.shadowWorkbookSizeExceedsLimit=db(Pe);try{var hf=JSON.stringify(Pe)}catch(pg){Td(new sd.a(14,void 0,pg,String.format("Failed to stringify shadow workbook: copyContext.ShadowWorkbookPayloadSize: [{0}], shadowWorkbookPayload.FloatingObjectId: [{1}]",T.shadowWorkbookPayloadSize,Pe.floatingObjectId)));return}Bc.ULS.shipAssertTag(537167881,0,!!Ib,"Expecting syncClipboardItems to be defined");
Ib.setItem(gb.SN,hf);1===T.commandParameters.commandType&&(hc.gTi(Oa.type,Oa.activeFloatingObjectControlId,he.StateId),hc.deleteFloatingObject(Oa.activeFloatingObjectControlId,Oa.type));hc.e1c.setValue(Oa,Ib);T.asyncClipboardItemsKeys=Qd(Ib);nd(Ib)}else Bc.ULS.sendTraceTag(537167880,0,50,"ArtCopyPasteHandler.GetCopiedDataFromServer: Result form server returned null, copied item id: {0}",Oa.activeFloatingObjectControlId),nd(hc.e1c.getValue(Oa))}},T.commandParameters.commandType,Oa.type,function(he){T.serverRequestTimeInMs=
T.commandParameters.stopwatch.Ac-Ed;he=vf.a.yg(he.data);1===T.commandParameters.commandType&&hc.oYa.HGj(Oa.type,Oa.activeFloatingObjectControlId);Bc.ULS.sendTraceTag(537167878,0,10,"ArtCopyPasteHandler.GetCopiedDataFromServer: GetCopiedDataFromServer failed. errors: {0}",Ec.a.Uc(he));Td(new Xb(4,he))},[T.commandParameters.stopwatch]))})};Ga.prototype.deleteFloatingObject=function(T,Oa){T=Ye.a.Jy(Oa,T);if(T=jh.a(this.$).Hp(T))jh.a(this.$).deleteFloatingObject(T,14,!0),Hf.g(this.$).ha.Qa.ZB=null};Ga.prototype.gTi=
function(T,Oa,Ib){var hc=this.$.da.Aa(277);if(hc){var nd=null;T=Ye.a.Jy(T,Oa);T=jh.a(this.$).Hp(T);if(null===T||void 0===T?0:T.Ti)nd=T.Ti.block;if(nd){var Td=T.floatingObject.Eg();hc.gXb(function(){return!nd.Wi.wb(Td)},Ib,"CutArt")}}};Ga.p$h=function(T){return 1===T.type||5===T.type};Object(Jc.a)(Ga,"ArtCopyPasteHandler",Ba,[]);var Fg=b(52);vm(bb,pb);Object(Jc.a)(bb,"MacroRecorderPasteArtPayload",pb,[]);ka.prototype.G2h=function(T,Oa,Ib,hc,nd,Td,Ed){var he=this;Td=void 0===Td?null:Td;Ed=void 0===
Ed?null:Ed;var Pe=this.$.qa.ta.Xb(),hf=null,pg={CopyPasteTargetType:2};pg.FloatingObjectId=T;pg.CopyOperationId=Ib.id;Ib.floatingObjectType=Oa;pg.UploadToClipService=Ib.uploadToClipService;pg.PKey=Ib.pKey;pg.ClipServiceDataCenter=Ib.clipServiceDataCenter;var fg=0;2===nd?(nd=505,fg=16,hf=function(Xg,yg,Rh){return Jd(he.$.qa.ta,pg,eg.b(Xg,hc),Td?eg.a(yg,Td):yg,Rh,Ib.ribbonCommandInfo,Pe,Ed)}):(nd=179,hf=function(Xg,yg,Rh){he.kch(Oa,T);he.$.Xu();var Kh=he.$.qa.ta;Xg=eg.b(Xg,hc);yg=Td?eg.a(yg,Td):yg;
var Yg=Ib.ribbonCommandInfo,ji=Ed;ji=void 0===ji?null:ji;var Di=Kh.Oa(1,void 0===Pe?null:Pe);Di.copyParameters=pg;return Rd.i(Kh,"Cut",Di,Xg,yg,Rh,Yg,0,ji)});te.EwaSettings.tc()?this.$.userOperationManager.ic(new Dd.a(nd,0,hf,fg|64),Ib.ribbonCommandInfo):this.$.userOperationManager.ic(new cf.a(nd,0,hf,fg),Ib.ribbonCommandInfo)};ka.prototype.kch=function(T,Oa){var Ib=Ye.a.Jy(T,Oa);(Ib=jh.a(this.$).Hp(Ib))?(Hf.g(this.$).ha.Qa.wG(Ib),Ib.isVisible=!1):Bc.ULS.sendTraceTag(537167876,0,50,"ArtCopyPasteUtils.DoCutClientEstimation: floatingObjectcontrol is null. FloatingObjectType : {0}, FloatingObjectId: {1}",
T,Oa)};ka.prototype.HGj=function(T,Oa){T=Ye.a.Jy(T,Oa);if(T=jh.a(this.$).Hp(T))T.isVisible=!0};ka.prototype.LZg=function(T){this.G2h(T.floatingObjectId,T.JZg,T.commandParameters,T.lr,T.h7g,T.J3,T.wWd)};ka.prototype.f3h=function(T,Oa,Ib,hc,nd,Td,Ed,he,Pe){var hf=this;he=void 0===he?null:he;Pe=void 0===Pe?!0:Pe;return new Promise(function(pg,fg){var Xg=Td.commandParameters.stopwatch.Ac;hf.bLd(T,nd,Oa,Ib,function(yg){Td.requestTelemetryData=yg.RequestTelemetryData;Td.serverRequestTimeInMs=Td.commandParameters.stopwatch.Ac-
Xg;if(Ec.a.w9(yg.Errors))Td&&(Td.encounteredDeploymentErrors=!0),Bc.ULS.sendTraceTag(537167875,0,15,"ArtCopyPasteUtils.PasteArt: Got deployment errors - keeping promise unfulfilled until we replay the operation. errors: {0}",Ec.a.Uc(yg.Errors));else if(Ec.a.hh(yg.Errors))Bc.ULS.sendTraceTag(36459652,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: {0}",Ec.a.Uc(yg.Errors)),fg(new sd.a(9,yg.Errors));else if(yg.Result){var Rh=yg.Result;Bc.ULS.sendTraceTag(537167874,0,50,"ArtCopyPasteUtils.PasteArt: PasteArt succeeded.");
hf.tTi(Ed,Rh.FloatingObjectId,yg.StateId);pg(ka.Nid(Rh.FloatingObjectId))}else Bc.ULS.sendTraceTag(537167873,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed, result returned from server is null."),fg(new sd.a(9,yg.Errors))},function(yg){Td.serverRequestTimeInMs=Td.commandParameters.stopwatch.Ac-Xg;yg=vf.a.yg(yg.data);Bc.ULS.sendTraceTag(537167872,0,10,"ArtCopyPasteUtils.PasteArt: PasteArt failed. errors: {0}",Ec.a.Uc(yg));fg(new sd.a(9,yg))},hc,he,Pe)})};ka.prototype.tTi=function(T,Oa,Ib){var hc=
this,nd=this.$.da.Aa(277);if(nd){var Td=Ye.a.Jy(T,ka.Nid(Oa));nd.gXb(function(){return!!jh.a(hc.$).Hp(Td)},Ib,"PasteArt")}};ka.prototype.HUd=function(T,Oa){Oa&&this.gnb.HUd(T,Ye.a.Jy(T.type,Oa))};ka.prototype.OCf=function(T){var Oa=this;return this.f3h(T.ribbonCommandInfo,T.destination,T.yEe,T.wWd,T.h0,T.pasteContext,T.item.type,T.Cwe,T.item.isFromCurrentSession(this.$)).then(function(Ib){return Ib},function(Ib){Oa.HUd(T.item,T.Cwe);return Promise.reject(Ib)})};ka.prototype.EKd=function(T,Oa,Ib){T||
(T=zf.v(Hf.g(this.$).ha.va.activeCell,this.$));Hf.g(this.$).Yfc(zf.D(T),1)?jh.a(this.$).zma(Ib,Oa,!0):Hf.g(this.$).ha.Qa.kGa(T,Oa,Ib).continueWith(function(hc){hc.result?Bc.ULS.sendTraceTag(537167843,5,50,"ArtCopyPasteUtils.SelectPastedObject: Selection succeeded in async manner for object ID [{0}]",Oa):Bc.ULS.sendTraceTag(537167842,5,10,"ArtCopyPasteUtils.SelectPastedObject: Selection failed in async manner for object ID [{0}]",Oa)})};ka.prototype.bLd=function(T,Oa,Ib,hc,nd,Td,Ed,he,Pe){function hf(){if(Pe){var Rh=
Fg.a.li(Fg.a.Hc(yg));Rh.FloatingObjectId=Oa.floatingObjectId;yg.DestinationRanges||(Rh.DestinationRanges=zf.p(fg.$.xa.oa.sheetName,"",0,0,0,0));return new bb(Rh,Pe,0,0)}return new bb(yg,Pe,0,0)}function pg(Rh,Kh,Yg){he||fg.$.Xu();return ad(fg.$.qa.ta,yg,eg.b(Rh,nd),eg.a(Kh,Td),Yg,null,Xg,Ed)}var fg=this;Pe=void 0===Pe?!0:Pe;var Xg=this.$.qa.ta.Xb(),yg={};yg.ShadowWorkbookBase64=Oa.shadowWorkbookBase64;yg.FloatingObjectId=hc;yg.DestinationRanges=Ib?zf.s(Ib):null;yg.CopyPasteTargetType=2;yg.ClientEstimationFloatingObjectId=
he;Ib=te.EwaSettings.tc()?new Dd.a(503,0,pg,void 0,hf):new cf.a(503,0,pg,void 0,hf);Ib.flags=te.EwaSettings.tc()?65:1;this.$.userOperationManager.ic(Ib,T)};ka.Nid=function(T){return String.format("{0}.{{{1}}}",T.length+2,T.toUpperCase())};Object(Jc.a)(ka,"ArtCopyPasteUtils",null,[704]);var Ki=b(239);Mb.prototype.RBd=function(T,Oa){this.ssa=T;this.c1c=Oa};Mb.prototype.o5c=function(){if(!this.ssa||!this.c1c)return Bc.ULS.sendTraceTag(537167841,0,15,"ArtPasteClientEstimation.DoPasteClientEstimation: copiedFloatingObjectControl and/or copiedEffectsExtents is null, aborting client side estimation."),
"";var T=Rg.a.dpb(new Ye.a(this.ssa));T.Id=ka.Nid(gg.a.create().toString());T.Version=-1;T.Name="";T.IsClientEstimation=!0;var Oa=this.q4h(T);if(!Oa)return null;var Ib=new Ye.a(T);Oa.block.Wi.add(Ib);Ib.LGb();var hc=jh.a(this.$);hc.x2b(Ib,Oa);Oa=hc.Hp(Ye.a.hKh(T));!Oa||Oa.floatingObject.BLa||Oa.floatingObject.$La||Oa.HQa(this.c1c);hc.zma(T.Type,T.Id,!0);return T.Id};Mb.prototype.gZf=function(T){return te.EwaSettings.la(222)&&T.isFromCurrentSession(this.$)&&!Hf.g(this.$).rtl&&!Hf.g(this.$).$a.Zi};
Mb.prototype.HUd=function(T,Oa){this.gZf(T)&&(T=jh.a(this.$).Hp(Oa))&&(Bc.ULS.sendTraceTag(537167840,5,50,"ArtPasteClientEstimation.UndoPasteClientEstimation: undoing client-side estimation. Removing floating object with ID: [{0}] of type [{1}]",Oa,T.floatingObject.type),jh.a(this.$).deleteFloatingObject(T,15,!0),T.Ti&&T.J$a(T.Ti,!1))};Mb.prototype.q4h=function(T){if(!T)return Bc.ULS.sendTraceTag(537167839,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: Called with null FloatingObjectData."),
null;if(Hf.g(this.$).ha.Qa.activeFloatingObjectControlId){var Oa=Hf.g(this.$).ha.Qa.ZB.floatingObject;T.OriginDeltaX=Oa.offsetX+this.p9a;T.OriginDeltaY=Oa.offsetY+this.p9a;T.AbsoluteLeft+=this.p9a;T.AbsoluteTop+=this.p9a;T.AbsoluteRight+=this.p9a;T.AbsoluteBottom+=this.p9a;T.ZOrder=Oa.hy+1;return Hf.g(this.$).ha.Qa.ZB.Ti}if(!this.$.oa||!this.$.oa.activeCell)return Bc.ULS.sendTraceTag(537167838,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: ActiveItem/ActiveCell is null - cannot perform estimation for grid paste."),
null;var Ib=this.$.oa.activeCell;Oa=Hf.g(this.$).M0(Ib);if(!Oa)return Bc.ULS.sendTraceTag(537167837,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: gridViewBlock for range {0} is null.",Ib.toString()),null;var hc=Md.HelperMethods.LJa(Oa.domElement,Oa.sj.domElement);Ib=Oa.gridView.Lg(Ib,2);if(!hc||!Ib)return Bc.ULS.sendTraceTag(537167836,0,15,"ArtPasteClientEstimation.InitializeFloatingObjectLocation: blockPositionRelativeToGridOrigin is null: {0}. cellPositionRelativeToGridOrigin is null: {1} .",
!hc,!Ib),null;T.OriginDeltaX=Ib.topLeft.x-hc.x;T.OriginDeltaY=Ib.topLeft.y-hc.y;T.AbsoluteLeft=Ib.topLeft.x;T.AbsoluteTop=Ib.topLeft.y;T.AbsoluteRight=T.AbsoluteLeft+Math.abs(this.ssa.AbsoluteRight-this.ssa.AbsoluteLeft);T.AbsoluteBottom=T.AbsoluteTop+Math.abs(this.ssa.AbsoluteBottom-this.ssa.AbsoluteTop);T.ZOrder=this.ssa.ZOrder+100;return new Ki.a(Oa.gridView.Ca.jl(Oa.hashCode),Oa.hashCode)};Object(Jc.a)(Mb,"ArtPasteClientEstimation",null,[703]);E.prototype.create=function(){var T=window.clipboardPlatform;
return T?T.createClipboardItems():null};Object(Jc.a)(E,"ClipboardItemsFactory",null,[702]);wb.undefined="Undefined";Object(Jc.a)(wb,"CCPTelemetryConsts",null,[]);rc.cells="Cells";rc.floatingObject="FloatingObject";rc.unknown="Unknown";Object(Jc.a)(rc,"ActiveSelection",null,[]);tb.obh="DisplayNotInvoked";tb.g5c="Displayed";tb.ETi="PrerequisitesNotReady";Object(Jc.a)(tb,"PasteIndicationDisplayStatus",null,[]);var ti=b(106);eb.prototype.getCopyFlowHandler=function(T){var Oa=this.eGh(Hf.g(this.$).Te);
T.commandParameters.copyPasteHandlerName=Oa.name;return Oa};eb.prototype.getPasteFlowHandler=function(T){var Oa=T.copyContextSnapshot;Oa=ed(T)?this.lVc:wc(T)?this.QDd:(null===Oa||void 0===Oa?0:Oa.sourceItem)&&Object.getType(Oa.sourceItem)===Nb?this.lVc:this.QDd;T.commandParameters.copyPasteHandlerName=Oa.name;return Oa};eb.prototype.initializePasteContext=function(T){if(T&&(T.isSameSession=!1,T.isShadowWorkbookParsedSuccessfully=!1,T.pasteResult=wb.undefined,T.payloadOrigin=wb.undefined,T.payloadType=
wb.undefined,T.encounteredDeploymentErrors=!1,T.shadowWorkbookSizeExceedsLimit=!1,T.originalSourceRangesCountExceedsLimit=!1,T.activeSelectionType=this.dCh(),T.indicationDisplayScheduled=!1,T.pasteDestinationHasMergedCells=!1,T.pasteIndicationDisplayStatus=tb.obh,T.copyContextSnapshot)){var Oa=T.copyContextSnapshot,Ib=ib(Oa.sourceItem),hc=Oa.sourceItem;var nd=!!hc&&Object.getType(hc)===Nb;hc=0;var Td=!1;Ib?(Td=Oa.sourceItem,T.isSameSession=Td.isFromCurrentSession(this.$),hc=1,Td=this.odi(Td,T)):nd&&
(T.isSameSession=Oa.sourceItem.isFromCurrentSession(this.$),hc=2);if(T.copyContextSnapshot.commandParameters){nd=-1985798686===Oa.commandParameters.ribbonCommandInfo.command;var Ed=T.commandParameters;var he=this.$;Oa?he&&he.ya?Oa=Oa.sessionId===he.ya.UserSessionId:(Bc.ULS.shipAssertTag(537166211,0,!1,"ewaControl shouldn't be null"),Oa=!1):(Bc.ULS.shipAssertTag(537166212,0,!1,"copyContext shouldn't be null"),Oa=!1);Ed.clearSystemClipboard=Oa&&nd&&Ib&&!Td;T.commandParameters.copyPasteTargetType=hc}}};
eb.prototype.getSessionId=function(){return this.$.ya.UserSessionId};eb.prototype.odi=function(T,Oa){var Ib=ti.b(T.ranges,function(hc){return hc.Lh})&&ti.b(Oa.commandParameters.originalDestinations,function(hc){return 1!==hc.top});return ti.b(T.ranges,function(hc){return hc.isRow})&&ti.b(Oa.commandParameters.originalDestinations,function(hc){return 1!==hc.left})||Ib};eb.prototype.eGh=function(T){switch(T){case 1:return this.QDd;case 64:case 4:case 2:case 256:return this.lVc;default:throw Error.invalidOperation("Unsupported selection");
}};eb.prototype.dCh=function(){return Hf.g(this.$).ha.Te&470?rc.floatingObject:1===Hf.g(this.$).ha.Te?rc.cells:rc.unknown};tl.Object.defineProperties(eb.prototype,{QDd:{configurable:!0,enumerable:!0,get:function(){if(!this.nNc){var T=this.$.da.Aa(254,!0);T&&(this.nNc=new $a(this.$,T,new E))}return this.nNc}},lVc:{configurable:!0,enumerable:!0,get:function(){if(!this.dDc&&this.$.da.Aa(254,!0)){var T=new Mb(this.$);this.dDc=new Ga(this.$,new E,new ka(this.$,T),T)}return this.dDc}}});Object(Jc.a)(eb,
"ExcelCopyPasteApplicationHost",null,[675]);var th=b(139),Pg=xf.a;vm(Ta,Pg);Ta.prototype.Kh=function(T){this.Jo=new th.a;var Oa=Og.a.instance.ea(16);T=this.MU(T);this.initializeAndShow(Oa,this.i6h,T)};Ta.prototype.MU=function(T){var Oa={};return Oa[Ta.Ly]=this.xc,Oa[Ta.Jei]=T,Oa};tl.Object.defineProperties(Ta.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"InsertCopiedCutCellsDialog"}}});Ta.yah="direction";Ta.Jei="isRtl";var hi={};Ta.zah=(hi.Vertical=1,hi.Horizontal=0,hi);Object(Jc.a)(Ta,
"InsertCopiedCutCellsDialog",xf.a,[]);fb.prototype.z2b=function(T,Oa){return(new Ta(T,Oa)).Jo.task};Object(Jc.a)(fb,"InsertCopiedCutCellsDialogFactory",null,[674]);var ah=b(88),qi=b(44),Ch=b(42);ub.prototype.FGe=function(){var T=this;this.voc||(Bc.ULS.sendTraceTag(537167680,0,50,"PasteIndicationManager.DownloadPrerequisitesIfNeeded: Trying to get appChrome"),this.gridView.$.rE(function(Oa){Oa.pua(0).then(function(){T.voc=!0})}))};ub.prototype.Wcj=function(T){var Oa=this,Ib=T.commandParameters.id;
Bc.ULS.sendTraceTag(537167651,0,50,"PasteIndicationManager.ScheduleDisplay: pasteCommandId = {0}, cancelCtx is null = {1}, PrerequisitesDownloaded = {2}",Ib,!this.Cr,this.voc);this.FGe();this.B3b=Ib;Ib=!this.hof();if(!this.Cr||Ib)this.Mte(),this.Cr=qi.a.instance.create(function(){Oa.nbh(T)},void 0===T.timeoutToShowSpinnerInMs||null===T.timeoutToShowSpinnerInMs?100:T.timeoutToShowSpinnerInMs,Ch.a.YPi);this.U1=T.commandParameters.originalDestinations};ub.prototype.nbh=function(T){this.voc?(this.display(T.commandParameters.originalDestinations),
T.pasteIndicationDisplayStatus=tb.g5c):(Bc.ULS.sendTraceTag(537167650,0,50,"PasteIndicationManager.DisplayIfPossible: Prerequisites were not ready, skipping display"),this.hide(),T.pasteIndicationDisplayStatus=tb.ETi)};ub.prototype.display=function(T){Bc.ULS.sendTraceTag(537167649,0,50,"PasteIndicationManager.Display: started");this.gridView.Nb.uw(jg.a.RW(Ne.d(this.gridView.$.oa),T),ub.Jnc,!0);this.gridView.Nb.Yr(ub.Jnc)};ub.prototype.vhd=function(T){Bc.ULS.sendTraceTag(537167648,0,50,"PasteIndicationManager.HideForPasteId: pasteCommandId = {0}, currentPasteCommandId = {1}",
T,this.B3b);T&&Me.a.equals(T,this.B3b,!1)&&this.hide()};ub.prototype.hide=function(T){this.U1&&(void 0===T?0:T)&&this.hof()&&Bc.ULS.sendTraceTag(537167647,0,15,"PasteIndicationManager.Hide: Triggered by a SelectionChanged event while indication is (or will be) active but active range did not change");this.B3b="";this.Mte();this.U1=null;this.gridView.Nb.kl(ub.Jnc);this.gridView.Nb.Jl(null,ub.Jnc)};ub.prototype.hof=function(){return zf.Q(this.gridView.ha.va.selectedRanges,this.U1)};ub.prototype.Mte=
function(){this.Cr&&(ah.a.Fa(this.Cr),this.Cr=null)};ub.prototype.dispose=function(){this.hide();this.gridView.ha.mF(this.m5e)};ub.Jnc=[30];Object(Jc.a)(ub,"PasteIndicationManager",null,[614,3]);var gh=b(1131),yi=b(51),ii=dd.a;vm(Tc,ii);Tc.prototype.create=function(){var T=this,Oa=yi.a.VZ([51,52],4,this.tb,void 0,void 0,void 0,Tc.vQa),Ib=ef.GetServiceTaskFactory.create(this.$.da,18,this.$.ma,this.tb);$f.TaskExtensions.Ba($f.TaskExtensions.ve([Ib,Oa],this.ma),function(){var hc=new gh.a,nd=null;T.vXg(hc).then(function(Td){nd=
Td.Fwe;var Ed=copyPasteInfra.createCopyPasteInfra(nd,new eb(T.$),hc,T.$);Bc.ULS.shipAssertTag(537167762,0,!!T.$.ya,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext should not be null");Bc.ULS.shipAssertTag(537167761,0,!!T.$.ya&&!!T.$.ya.DocumentHostInfo,"CopyPasteInfrastructureFactory.Create: this.ewaControl.BootstrapContext.DocumentHostInfo should not be null");var he=nd.getMetadataManager();T.Fb(new bc(T.$,he,Ib.result,Ed,new uc(T.$,Hf.g(T.$)),new fb,T.$.ya.DocumentHostInfo.UserId,
nd.getInitializationError()));Td.NZa?Bc.ULS.sendTraceTag(41731933,0,50,"CopyPasteInfrastructureFactory.Create: Initialize CCP infra succeed. SliceName={0}, StrategyType={1}, StrategyCapabilities={2}, IsBestStrategyTypeInitialized={3}, InfraLoadTimeMS={4}",bc.z9b(),Td.NZa.dataClipboardStrategyType,JSON.stringify(Td.NZa.dataClipboardCapabilities),Td.NZa.clipboardStrategiesToInitialize[0].clipboardStrategyType===Td.NZa.dataClipboardStrategyType,void 0===window.bsqmXLSPageLoadStartTime||null===window.bsqmXLSPageLoadStartTime?
"-1":(Date.now()-window.bsqmXLSPageLoadStartTime.getTime()).toString()):Bc.ULS.shipAssertTag(537167760,0,!1,"CopyPasteInfrastructureFactory.Create: initResult.ClipboardPlatformEnvironmentInitializationInfo should not be null")},function(Td){Bc.ULS.shipAssertTag(38847436,0,!1,"CopyPasteInfrastructureFactory.Create: error during call to clipboardPlatformEnvironment.Init(). Copy Paste operations will not be available in this session. SliceName: {0} error: {1}",bc.z9b(),Td?copyPasteInfra.getStringifiedError(Td):
"null")})},this.ma,3)};Tc.prototype.dispose=function(){ii.prototype.dispose.call(this)};Tc.prototype.vXg=function(T){var Oa=null,Ib=window.clipboardPlatform;Ib&&(Oa=Ib.getClipboardPlatformEnvironment());if(!Oa)return Bc.ULS.shipAssertTag(537167759,0,!1,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: getClipboardPlatformEnvironment should have returned a valid object"),Promise.reject(null);Ib=this.$.ya;var hc=[Ib.OfficeOnlineChromeExtensionId,Ib.ChromeClipboardAccessExtensionId],
nd=this.Om.Va(5),Td=this.$.ig.get(57),Ed=!Td&&this.$.ig.get(5),he=this.$.fa.lc;he&&(he.inWebPart||he.inViewerFromWebPart||he.isDivSyndicated)&&(Ed=!1);Td=this.dFh(Ed,!Td);Bc.ULS.shipAssertTag(537167758,0,!!Ib.DocumentHostInfo,"CopyPasteInfrastructureFactory.ConfigureClipboardPlatformEnvironment: bootstrapContext.DocumentHostInfo should not be null");return Oa.init(this.$,T,hc,Ib.SharedClipboardHostingApp,Ib.SharedClipboardHostingApps,Ib.SharedClipboardHostingEnvironments,Ib.SharedClipboardOverrideOrigin,
Ib.SharedClipboardSchemaVersion,Ib.SharedClipboardExpirationInMinutes,Ib.ClipboardPromiseTimeoutInMinutes,nd,Ib.MachineCluster,new Ic(this.$),Td,Ib.DocumentHostInfo.UserId,Ib.ClipboardTtlInMS,te.EwaSettings.la(314),Ib.UserSessionId).then(function(Pe){return Object.assign(new Je,{Fwe:Oa,NZa:Pe})},function(Pe){return Promise.reject(Pe)})};Tc.prototype.dFh=function(T,Oa){var Ib=[];T&&Oa&&Array.add(Ib,this.J5g());Oa&&(Array.add(Ib,this.R2c(7)),Array.add(Ib,this.R2c(0)));T&&Array.add(Ib,this.lBe());Array.add(Ib,
{clipboardStrategyType:4});Bc.ULS.sendTraceTag(39978242,0,50,"CopyPasteInfrastructureFactory.GetClipboardStrategiesInitList: create clipboard stratgy initialization list: isBrowserStorageAllowed={0}, isSystemClipboardAllowed={1}, result = {2}",T,Oa,Ib?Ib.join(","):"[]");return Ib};Tc.prototype.lBe=function(){var T=this.$.ya,Oa={clipboardStrategyType:5};Oa.sessionId=T.UserSessionId;Oa.useSharedClipboardIframe=!0;Oa.sharedClipboardHostingApp=T.SharedClipboardHostingApp;Oa.sharedClipboardHostingApps=
T.SharedClipboardHostingApps;Oa.sharedClipboardHostingEnvironments=T.SharedClipboardHostingEnvironments;Oa.sharedClipboardOverrideOrigin=T.SharedClipboardOverrideOrigin;Oa.sharedClipboardSchemaVersion=T.SharedClipboardSchemaVersion;Oa.sharedClipboardExpirationInMinutes=T.SharedClipboardExpirationInMinutes;Oa.wacCluster=T.MachineCluster;return Oa};Tc.prototype.J5g=function(){var T={clipboardStrategyType:6};T.localStorageStrategyParameters=this.lBe();T.systemClipboardStrategyParameters=this.R2c(0);
return T};Tc.prototype.R2c=function(T){var Oa={};Oa.clipboardStrategyType=T;Oa.skipFilesIfPlainTextExists=!0;return Oa};Tc.ja=function(T){T.da.Ha(373,new ub(T));T.da.Ha(Tc.vQa,new Tc(T))};Tc.vQa=255;Object(Jc.a)(Tc,"CopyPasteInfrastructureFactory",dd.a,[]);var la=b(10),nb=b(117),Wb=b(12),Dc=lf.a;vm(wd,Dc);wd.prototype.dispose=function(){this.mm();this.nk=this.Et=this.$=null;this.statusBarManager&&(this.statusBarManager.iF(this),this.statusBarManager=null)};wd.prototype.gn=function(){return this.FZf};
wd.prototype.Jr=function(T,Oa){if("QueryPasteShortcutEnabledLabel"!==T&&!Array.contains(wd.Rxj,T))return!1;var Ib=this.fo();"QueryPasteShortcutEnabledLabel"===T?(Oa.Visible=Ib,Bc.ULS.sendTraceTag(537167636,0,100,"PasteShortcutManager.ExecuteRootCommand: Setting visible to {0} for commandId {1}",Ib,T)):(Oa.Visible=!Ib,Bc.ULS.sendTraceTag(537167635,0,100,"PasteShortcutManager.ExecuteRootCommand: Setting visible to {0} for commandId {1}",!Ib,T));return!0};wd.prototype.dgh=function(){this.ak();this.raiseEvent("pasteShortcutStatusChanged")};
wd.prototype.L4b=function(){this.mm();this.raiseEvent("pasteShortcutStatusChanged")};wd.prototype.fo=function(){return this.U6c};wd.prototype.iq=function(T){this.addHandler("pasteShortcutStatusChanged",T)};wd.prototype.zq=function(T){this.removeHandler("pasteShortcutStatusChanged",T)};wd.prototype.ak=function(){if(!this.fo()){this.U6c=!0;Hf.g(this.$).Jj.wm(this.oFe);this.nk.ja("blur",this.Iah);var T=this.$.da.Aa(65);T&&T.O2&&T.O2.registerForCommentEvents(this.nFe);this.Et.Vu(Wb.a.Rb,this.$.domElement,
this.onKeyDown,!0)}};wd.prototype.mm=function(){if(this.fo()){this.U6c=!1;Hf.g(this.$).Jj.im(this.oFe);this.nk.detach("blur");var T=this.$.da.Aa(65);T&&T.O2&&T.O2.unregisterForCommentEvents(this.nFe);this.Et.kv(Wb.a.Rb,this.$.domElement,this.onKeyDown,!0)}};wd.Rxj=["QuerySheetNumberButton","QueryWorkbookStatisticsButton"];Object(Jc.a)(wd,"PasteShortcutManager",lf.a,[679,281,233,3]);var zb=b(121),hd=dd.a;vm(Pc,hd);Pc.prototype.create=function(){var T=this.$;this.Fb(T.da.Aa(478)||this.$.da.Ha(478,new wd(T,
nb.KeyInputManager.instance,zb.a.instance.VD())))};Pc.ja=function(T){T.da.Ha(479,new Pc(T))};Object(Jc.a)(Pc,"PasteShortcutManagerFactory",dd.a,[]);Xc.prototype.isEnabled=function(){if(we.AFrameworkApplication.ga?we.AFrameworkApplication.ga.ra("IsAnonymousUser"):1)return!1;var T=we.AFrameworkApplication.Gb?Object(Oc.a)(String,we.AFrameworkApplication.Gb.AudienceGroup):"";return"Unknown"!==T&&"Automation"!==T};tl.Object.defineProperties(Xc.prototype,{BUc:{configurable:!0,enumerable:!0,get:function(){return"Excel"}},
campaignId:{configurable:!0,enumerable:!0,get:function(){return"aed9de6b-d4e7-4878-988a-9dfec66fed9e"}},version:{configurable:!0,enumerable:!0,get:function(){return 1}},currentVersion:{configurable:!0,enumerable:!0,get:function(){return 0}},y$h:{configurable:!0,enumerable:!0,get:function(){return this.isEnabled()&&this.$.la(346)}},h6a:{configurable:!0,enumerable:!0,get:function(){return this.isEnabled()&&this.$.la(348)}},Fyb:{configurable:!0,enumerable:!0,get:function(){return this.$.la(347)}},Gwh:{configurable:!0,
enumerable:!0,get:function(){return null}},Kmf:{configurable:!0,enumerable:!0,get:function(){return 24}},uQf:{configurable:!0,enumerable:!0,get:function(){return 4E3}},aHb:{configurable:!0,enumerable:!0,get:function(){return this.$.ya.WebServiceBase||""}}});Object(Jc.a)(Xc,"FirstRunExperienceLauncherSettings",null,[680]);Hc.prototype.ePd=function(){this.bRe&&this.bRe.ePd(this.rwh)};Object(Jc.a)(Hc,"FirstRunExperienceManager",null,[612]);var ke=dd.a;vm(Eb,ke);Eb.prototype.create=function(){this.Fb(this.$.da.Aa(311)||
this.I1g())};Eb.prototype.I1g=function(){var T=new Xc(this.$);T=new Hc(dg.a.instance.resolve("Common.App.FirstRunExperienceLauncher.IFirstRunExperienceLauncher"),T);T.ePd();return T};Eb.ja=function(T){T.da.Ha(312,new Eb(T))};Object(Jc.a)(Eb,"FirstRunExperienceManagerFactory",dd.a,[]);var He=b(57),df=dd.a;vm(Kb,df);Kb.prototype.create=function(){this.Fb(this.$.da.Aa(361)||this.u2g())};Kb.prototype.u2g=function(){var T=this;this.Xid=dg.a.instance.Hh("Common.IInProductMessagingUIManager");He.a.Qf.isReactSharedHeaderUxEnabled?
tc.a.get_instance().xl(16,function(){T.m8e()}):this.m8e();return this.Xid};Kb.prototype.m8e=function(){var T=this;dg.a.instance.mc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Oa){Oa.isFeatureEnabled("MsoPremiumBadge",!0).then(function(Ib){!Ib&&Oa.isFreemiumUpsellEnabled()&&T.Xid.Lhf();return null})})};Kb.ja=function(T){T.da.Ha(362,new Kb(T))};Object(Jc.a)(Kb,"InProductMessagingManagerFactory",dd.a,[]);var kf=b(817),ff=b(98),Ef=b(175);Object(Jc.a)(xb,"UploadBlobParameters",
null,[]);var Qf=b(109);Ja.prototype.mDb=function(T){this.Cj=T;if(!this.m0a){if(this.lWd){if(this.C7a&&$e.a.ME){this.MQb=T.i5b(Object(mc.a)(this,this.Qxd,"onFileChosen"));return}this.MQb=T.i5b(null);if(!this.jBa(this.MQb,T))return}this.finalizeUpload(T,null)}};Ja.prototype.Qxd=function(T){if(this.jBa(T,this.Cj)){if($e.a.ME||$e.a.zf)this.MQb=T;this.finalizeUpload(this.Cj,null)}};Ja.prototype.Rmc=function(){this.Bzd&&this.Bzd()};Ja.prototype.L9i=function(){this.sqa=0;this.iEa=this.ga.zd("Box4UploadRetryDelayStart",
200);this.Cj&&(this.Cj.dispose(),this.Cj=null)};tl.Object.defineProperties(Ja.prototype,{context:{configurable:!0,enumerable:!0,get:function(){return this.nS}},ga:{configurable:!0,enumerable:!0,get:function(){return this.ub}},retryCount:{configurable:!0,enumerable:!0,get:function(){return this.sqa}},bJd:{configurable:!0,enumerable:!0,get:function(){return this.iEa}}});Object(Jc.a)(Ja,"FileUploader",null,[]);var Vg=b(413),Kg=b(909),yh=b(128);vm(Lb,Ja);Lb.prototype.kWe=function(T){switch(T){case 1:return CommonUIStrings.l_ImageUploadNoFileSpecified;
case 2:return CommonUIStrings.l_ImageUploadUnsupportedFileType;default:return""}};Lb.prototype.kbg=function(T){return Lb.jBa(T,this.lUh())};Lb.prototype.lUh=function(){return Lb.Ige};Lb.prototype.jBa=function(T,Oa){return(T=this.kbg(T))?(Oa&&Oa.Yie(),2===T&&this.ri(0,this.kWe(T)),!1):!0};Lb.prototype.finalizeUpload=function(T,Oa){Bc.ULS.sendTraceTag(36783360,322,50,"PictureUploader.FinalizeUpload");this.Bzd=Oa;this.Ssj();Vg.a.mark(5576);this.tTb=this.fI.Fc("LoadResource","PictureUploadTime")};Lb.prototype.ri=
function(T,Oa){var Ib=new yh.StandardDialog;Ib.kc=0;Ib.xz(T,CommonUIStrings.l_ImageUploadFailedTitle,Oa,null)};Lb.prototype.Rmc=function(){Bc.ULS.sendTraceTag(36783361,322,50,"PictureUploader.OnUploadComplete");Ja.prototype.Rmc.call(this);this.tTb&&(this.tTb.stop(),this.tTb=null);this.TUg()};Lb.prototype.Ssj=function(){this.Oqa=(new Kg.a).create();this.Oqa.message=CommonUIStrings.l_ImageUploadWait;this.Oqa.kc=5;this.Oqa.Gu=!1;this.Oqa.eAa(null,null,null)};Lb.prototype.TUg=function(){this.Oqa&&(this.Oqa.close(),
this.Oqa=null)};Lb.e_h=function(T,Oa){T=Ze.a.Kl(T);for(var Ib=0;Ib<Oa.length;++Ib)if(T.endsWith(Oa[Ib]))return!0;return!1};Lb.jBa=function(T,Oa){Oa=void 0===Oa?null:Oa;Oa||(Oa=Lb.Ige);return T?Lb.e_h(T,Oa)?0:2:1};tl.Object.defineProperties(Lb.prototype,{fI:{configurable:!0,enumerable:!0,get:function(){return we.AFrameworkApplication.sa.fD}}});Lb.Ige=".jpg .jpeg .png .gif .bmp .tif .tiff".split(" ");Object(Jc.a)(Lb,"PictureUploader",Ja,[]);var fh=b(681),If=b(572),eh=b(140),Qh=b(40),xi=b(1185),Ca=eh.a;
vm(Ra,Ca);Ra.prototype.validate=function(){this.Cj.DG||Bc.ULS.sendTraceTag(25798091,322,10,"UploadFrame.FileInputElement is null");return this.Cj.DG.value?!0:(Ra.xz(CommonUIStrings.l_FileUploadNoFileSpecified),!1)};Ra.prototype.eDi=function(T){this.frg&&(this.Cj=this.iXf(T,this.QVb))};Ra.prototype.oMi=function(){this.Cj&&this.Cj.DG&&(this.I3d||(this.Cj.f1i(Object(mc.a)(this,this.Qxd,"onFileChosen")),this.I3d=!0),this.Cj.OPe())};Ra.prototype.Qxd=function(T){this.$Va.uploadStatusLabel=T;this.zzc(this.titleText,
Object(mc.a)(this,this.vdc,"insertDialogHandler"),this.$Va)};Ra.prototype.vdc=function(T){1===T&&this.isEnabled()?Ra.gy&&this.Cj.DG&&!this.Cj.DG.value?(this.$Va.uploadStatusLabel=CommonUIStrings.l_FileUploadNoFileSpecified,this.zzc(this.titleText,Object(mc.a)(this,this.vdc,"insertDialogHandler"),this.$Va)):(this.Xvb(),this.QVb.finalizeUpload(this.Cj,Object(mc.a)(this,this.dispose,"dispose"))):T||this.hide()};Ra.prototype.jXf=function(){this.kGc=!1;this.Cj=this.iXf(document.getElementById("uploadFrameContainer"),
this.QVb);we.AFrameworkApplication.ga.ra("InsertPictureDialogFocusLoopFixIsEnabled")&&(this.Wfa=Object(mc.a)(this,this.Czd,"onUploadFrameLoad"),Qh.a.addHandler(this.Cj.iFrame,"load",this.Wfa));this.Cj.DG||Bc.ULS.sendTraceTag(25798092,322,15,"UploadFrame.FileInputElement is null");this.ZFf()};Ra.prototype.Czd=function(){this.ZFf()};Ra.prototype.ZFf=function(){if(this.Cj&&!this.kGc){var T=this.Cj.DG;T&&(Qh.a.addHandler(T,Wb.a.Rb,Object(mc.a)(this,this.onKeyDown,"onKeyDown")),T=[T],this.Vm=T.concat.apply(T,
this.Vm),this.s$f(),this.kGc=!0)}};Ra.prototype.dispose=function(){if(this.Cj&&!Ra.gy){var T=this.Cj.DG;T&&Qh.a.removeHandler(T,Wb.a.Rb,Object(mc.a)(this,this.onKeyDown,"onKeyDown"));this.Wfa&&Qh.a.removeHandler(this.Cj.iFrame,"load",this.Wfa)}this.Cj=null;Ca.prototype.dispose.call(this)};Ra.prototype.s$f=function(){if(0<this.Vm.length){var T=new xi.a(this.Vm),Oa=qb.FocusManager.instance().hQ();Oa&&(this.Vm[0].focus(),Oa.jf=T,Oa.YZ=!0)}};Ra.prototype.onKeyDown=function(T){4!==qb.FocusManager.instance().aGf(T)&&
T.preventDefault()};Ra.xz=function(T){var Oa=document.getElementById("errorText");Oa.innerText=T;Oa.style.display="inline-block"};tl.Object.defineProperties(Ra.prototype,{hMj:{configurable:!0,enumerable:!0,get:function(){return this.QVb}}});tl.Object.defineProperties(Ra,{gy:{configurable:!0,enumerable:!0,get:function(){return we.AFrameworkApplication.sa.Pa.Lu&&we.AFrameworkApplication.sa.Pa.Ucf}}});Object(Jc.a)(Ra,"InsertFileDialog",eh.a,[]);tl.Object.defineProperties(Sa,{xf:{configurable:!0,enumerable:!0,
get:function(){return eh.a.jj(Sa.Tj,CommonUIStrings.l_ImageUploadDialogText,CommonUIStrings.l_ImageUploadNoFileSpecified)}}});Sa.Tj="<div class='WACDialogRow' id='block1'> <label id='labelText' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='block2'> <div id='uploadFrameContainer'></div> <div class='WACDialogError' id='errorText' role='alert'>{1}</div> </div>";Object(Jc.a)(Sa,"InsertImageDialogHtml",null,[]);vm(Fa,Ra);Fa.prototype.validate=function(){this.Cj.DG||Bc.ULS.sendTraceTag(25798095,
322,10,"UploadFrame.FileInputElement is null");var T=Object(Oc.a)(Lb,this.hMj),Oa=T.kbg(this.Cj.DG.value);return Oa?(Ra.xz(T.kWe(Oa)),!1):!0};tl.Object.defineProperties(Fa.prototype,{qWb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_ImageUploadButtonText}},titleText:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_ImageUploadingTitle}},aah:{configurable:!0,enumerable:!0,get:function(){return Sa.xf}}});Object(Jc.a)(Fa,"InsertImageDialog",Ra,[]);var ra=
b(576),yb=b(89),Hd=b(193),ye=b(77),Cf=b(416);lb.prototype.j8e=function(){this.nD=gg.a.create().toString();this.aqa?this.I6c():this.Wne()};lb.prototype.F_g=function(T){this.Ln=document.createElement("iframe");this.Ln.className=T;this.Ln.id=T;this.m4d&&(this.Ln.style.visibility="visible",this.Ln.style.height="30px",this.Ln.setAttribute("frameborder","0"));this.Wfa=Object(mc.a)(this,this.Czd,"onUploadFrameLoad");Qh.a.addHandler(this.Ln,"load",this.Wfa)};lb.prototype.i5b=function(T){var Oa=this;we.AFrameworkApplication.sa.yEb();
if(!this.Iq)return Bc.ULS.sendTraceTag(25798093,322,50,"_fileInput is null"),"";Qh.a.addHandler(this.Iq,"change",function(){Oa.Yth(T)});Yb(Object(mc.a)(this,this.OPe,"fileInputClick"),1,"DoFileOpenDialog");return this.Iq.value};lb.prototype.Yth=function(T){T&&T(this.Iq.value)};lb.prototype.Zth=function(){this.KQb&&(this.KQb.innerText=this.xXe())};lb.prototype.f1i=function(T){var Oa=this;Qh.a.addHandler(this.Iq,"change",function(){T(Oa.xXe())})};lb.prototype.xXe=function(){var T=null;if(this.Iq.value){var Oa=
this.Iq.value,Ib=Oa.lastIndexOf("\\");0<Ib&&(T=Oa.substring(Ib+1,Oa.length))}return T?T:""};lb.prototype.OPe=function(){try{Bc.ULS.sendTraceTag(35939520,322,50,"UploadFrame.FileInputClick - Clicking on File input element."),this.Iq.click()}catch(T){throw Bc.ULS.sendTraceTag(36783331,322,10,"UploadFrame.FileInputClick Exception: {0}",T.message),T;}};lb.prototype.Fyj=function(){this.dfi()?this.g3f():(this.aWd(),this.gs.submit())};lb.prototype.dfi=function(){return(this.mmg||this.aqa)&&!(void 0===window.self.FormData||
null===window.self.FormData)};lb.prototype.KTf=function(T){if(T){var Oa=this.eAe();this.Jg=new XMLHttpRequest;this.Jg.open("POST",Oa);this.Jg.setRequestHeader("X-CorrelationId",this.nD);this.Smi(T);this.Jg.onreadystatechange=Object(mc.a)(this,this.aoa,"uploadResponseReceived");this.Jg.send(T)}};lb.prototype.Smi=function(T){if(!$e.a.xA&&T.get){var Oa=T.get("ImageId");T=window.self.navigator;var Ib={};Oa=(Ib.CorrelationId=this.nD,Ib.Canary=we.AFrameworkApplication.canary,Ib.ImageNodeId=Oa,Ib);T&&(T=
T.connection?T.connection:T.mozConnection?T.mozConnection:T.webkitConnection?T.webkitConnection:null)&&(Oa.effectiveType=T.effectiveType,Oa.downlink=T.downlink,Oa.type=T.type,Oa.rtt=T.rtt);Bc.ULS.sendTraceTag(573345858,322,50,"LogFileUploadStatistics: FileUpload {0}",Oa)}};lb.prototype.g3f=function(){try{this.aWd();Bc.ULS.sendTraceTag(594888409,322,50,"SubmitFormWithRequest is preparing to send an upload request");var T=new (Type.parse("FormData"))(this.gs);this.KTf(T)}catch(Oa){Bc.ULS.sendTraceTag(594888407,
322,10,"SubmitFormWithRequest failed to send the request with exception "+Oa.message),this.U8a(null)}};lb.prototype.f3f=function(T){try{if(this.aWd(),Bc.ULS.sendTraceTag(594888406,322,50,"SubmitFormWithBlob is preparing to send an upload request"),this.qNj(T)){this.LQb=T;this.gs.contains(this.Iq)&&this.gs.removeChild(this.Iq);var Oa=new (Type.parse("FormData"))(this.gs);Oa.append("applicationfileInput",T.blob,T.filename);this.KTf(Oa)}else this.U8a(null)}catch(Ib){Bc.ULS.sendTraceTag(591267743,322,
10,"SubmitFormWithBlob failed to send the request with exception "+Ib.message),this.U8a(null)}};lb.prototype.qNj=function(T){return T&&void 0!==T.blob&&null!==T.blob&&void 0!==T.filename&&null!==T.filename&&""!==T.filename?void 0===window.self.FormData||null===window.self.FormData?(Bc.ULS.sendTraceTag(578380442,322,10,"FormData isn't supported"),!1):!0:(T=T?String.format("[isNull: false] [blobIsNullorEmpty: {0}] [filenameIsNullOrEmpty: {1}]",void 0===T.blob||null===T.blob,void 0===T.filename||null===
T.filename||""===T.filename):"[isNull: true] [blobIsNullorEmpty: false] [filenameIsNullOrEmpty: false]",Bc.ULS.sendTraceTag(578380441,322,10,String.format("Content of the blob is empty {0}",T)),!1)};lb.prototype.aoa=function(){if(4===this.Jg.readyState)if(200===this.Jg.status){Bc.ULS.sendTraceTag(594888405,322,50,"UploadResponseReceived received a successful response. CorrelationId: {0}",this.nD);var T=this.Jg.getResponseHeader("X-NewKey"),Oa=this.y9h(this.Jg),Ib=!1;if(void 0!==T&&null!==T&&Oa&&(Ib=
this.gNj(T),!this.GQc&&Ib)){Bc.ULS.sendTraceTag(594888404,322,50,"UploadResponseReceived resubmitting the upload request with a fresh canary. correlationId: {0}",this.nD);this.GQc=!0;void 0!==this.LQb&&null!==this.LQb?this.f3f(this.LQb):this.g3f();return}Bc.ULS.sendTraceTag(594888403,322,50,"UploadResponseReceived processing the response [retried: {0}] [canaryInvalid: {1}] [gotNewCanary: {2}] [canaryRenewed: {3}] [CorrelationId: {4}]",this.GQc,Oa,!(void 0===T||null===T),Ib,this.nD);this.U8a(this.Jg.responseText)}else Bc.ULS.sendTraceTag(42874946,
322,15,"Upload request failed with status: {0} [isResponseNull: {1}] [correlationId: {2}]",this.Jg.status,this.Jg.responseText?!1:!0,this.nD),this.U8a(null)};lb.prototype.y9h=function(T){try{var Oa=ud.a(T.responseText).Responses;if(void 0!==Oa&&null!==Oa&&1===Oa.length){var Ib=Oa[0];if(void 0!==Ib&&null!==Ib&&2===Ib.length&&28===Ib[1].StatusCode)return!0}}catch(hc){}return!1};lb.prototype.gNj=function(T){Cf.a.r9f(T);return we.AFrameworkApplication.canary!==T?!1:!0};lb.prototype.aWd=function(){this.HQc||
(this.HQc=new Date)};lb.prototype.dispose=function(){this.sm||(this.aqa?this._parent.removeChild(this.gs):(this._parent.removeChild(this.Ln),Qh.a.removeHandler(this.Ln,"load",this.Wfa),this.Wfa=null),this.jGc&&(Qh.a.removeHandler(this.Iq,"change",this.jGc),this.jGc=null),this.PPe&&(this.ehb&&(Qh.a.removeHandler(this.Iq,"change",this.ehb),this.ehb=null),this.KQb=null),this.Iq=this.gs=this._parent=this.Ln=null,this.sm=!0,this.HQc=null,Bc.ULS.sendTraceTag(25798094,322,50,"UploadFrame disposed"))};lb.prototype.delayedDispose=
function(){this.dispose()};lb.prototype.j2g=function(T){if(this.gs){var Oa;(Oa=this.gs.querySelector("input[name=__REQUESTDIGEST]"))?Oa.value=T:(Oa=this.k2c(),Oa.type="hidden",Oa.id="__REQUESTDIGEST",Oa.name="__REQUESTDIGEST",Oa.value=T,this.gs.appendChild(Oa))}};lb.prototype.k2c=function(){return this.aqa?document.createElement("input"):this.Ln.contentWindow.document.createElement("input")};lb.prototype.Czd=function(){try{if(!this.Ln.contentWindow.document.body)return}catch(hc){this.bZh();return}if(!(this._initialized||
this.C7a&&$e.a.ME))this.I6c();else if(!this.C7a||!$e.a.ME||this.lci){var T=$e.a.Af?this.Ln.contentWindow.document.body.innerText:this.Gag?this.Ln.contentWindow.document.body.firstChild.innerText:this.Ln.contentWindow.document.body.firstChild.innerHTML;var Oa=this.Ln.contentWindow.document.body.innerText.toLowerCase(),Ib=0<=Oa.indexOf("responses")||0<=Oa.indexOf("wopisrc");Oa=0<=Oa.indexOf("http error");!Ib&&Oa&&Bc.ULS.sendTraceTag(42551183,322,15,"Couldn't obtain a valid response but the frame contains: "+
this.Ln.contentWindow.document.body.innerText);this.U8a(T)}};lb.prototype.I6c=function(){if(!this._initialized){var T=this.ea("uploadForm"),Oa=this.ea("fileInput"),Ib=this.eAe();this.O1g();this.gs.id=T;this.gs.method="post";this.gs.encoding="multipart/form-data";this.gs.action=Ib;this.Iq.type="file";this.hZd&&(this.Iq.accept=this.hZd,this.h0d&&(this.Iq.capture=this.h0d));this.Iq.id=Oa;this.Iq.name=Oa;this.xEg&&(this.Iq.multiple=!0);!this.PPe||$e.a.Af||$e.a.iH||(this.ehb=Object(mc.a)(this,this.Zth,
"fileInputChangedHandleAccessibility"),Qh.a.addHandler(this.Iq,"change",this.ehb),this.KQb=yb.a.Sne(this.gs,this.Iq,"InputFileDescription"));this.m4d&&(this.aqa||(T=this.Ln.contentWindow.document.body,T.style.margin="0",T.style.overflow="hidden"),T=we.AFrameworkApplication.sa,this.Iq.style.fontFamily=T.B0,this.Iq.style.fontSize=T.Oyc,this.Iq.style.margin="0");(T=document.getElementById("__REQUESTDIGEST"))&&this.j2g(T.value);this.gs.appendChild(this.Iq);this._initialized=!0;this.Vlg(this)}};lb.prototype.O1g=
function(){if(this.aqa)this.gs=document.createElement("form"),this._parent.appendChild(this.gs),this.Iq=document.createElement("input");else{this.gs=this.Ln.contentWindow.document.createElement("form");var T=this.Ln.contentWindow.document;T.body.appendChild(this.gs);this.Iq=T.createElement("input")}};lb.prototype.Wne=function(){this._parent.appendChild(this.Ln);this.C7a&&$e.a.ME&&this.I6c()};lb.prototype.eAe=function(){var T=new me.QueryStringBuilder(this.UPe);we.AFrameworkApplication.Plb(T);this.Ygj(T);
T=T.toString();if($e.a.zf||$e.a.ME||$e.a.iH)T=ye.a.Pad(T);return T};lb.prototype.Yie=function(){var T=new Qf.a(2,1,0,Object(mc.a)(this,this.delayedDispose,"delayedDispose"),4);we.AFrameworkApplication.oj.fh(T)};tl.Object.defineProperties(lb.prototype,{NPf:{configurable:!0,enumerable:!0,get:function(){return this.rqg}},sessionId:{configurable:!0,enumerable:!0,get:function(){return this.FOc}},iFrame:{configurable:!0,enumerable:!0,get:function(){return this.Ln}},DG:{configurable:!0,enumerable:!0,get:function(){return this.Iq}},
C7a:{configurable:!0,enumerable:!0,get:function(){return we.AFrameworkApplication.ga?we.AFrameworkApplication.ga.ra("NativeFileOpenDialogIsEnabled"):!1}},PPe:{configurable:!0,enumerable:!0,get:function(){return we.AFrameworkApplication.ga?we.AFrameworkApplication.ga.ra("FileInputDescriptionAccessibilityIsEnabled"):!1}},lci:{configurable:!0,enumerable:!0,get:function(){return this.aqa?!1:Hd.a(this.Ln.contentWindow.location.pathname,this.UPe,0)}},xEg:{configurable:!0,enumerable:!0,get:function(){return!$e.a.xA&&
we.AFrameworkApplication.ga.ra("AllowMultipleImageInsertFromLocalDevice")}}});Object(Jc.a)(lb,"UploadFrame",null,[3]);vm(sa,lb);sa.prototype.ea=function(T){return T};sa.prototype.Ygj=function(T){Bc.ULS.shipAssertTag(528345168,0,!!this.sessionId,"SessionId shouldn't be null.");vf.a.GUc(T,this.$.ya);T.f9(bf.a.sessionId,this.sessionId);var Oa=Hf.g(this.$).ha;Oa=zf.o(Oa.va.U3,this.$);T.f9(bf.a.RVi,this.$.xa.oa.name);T.f9(bf.a.QVi,Oa.FirstRow.toString());T.f9(bf.a.PVi,Oa.FirstColumn.toString())};sa.prototype.bZh=
function(){this.NPf("ServerUploadError")};sa.prototype.U8a=function(T){this.NPf(T)};sa.rai=function(T){return!T||Me.a.equals(T,"ServerUploadError",!1)};Object(Jc.a)(sa,"UploadFrameWrapper",lb,[]);vm(xa,Fa);xa.prototype.iXf=function(T,Oa){return new sa(T,Object(mc.a)(Oa,Oa.mDb,"onUploadFrameInitialized"),Object(mc.a)(Oa,Oa.aoa,"uploadResponseReceived"),this.ga,!0,this.$)};xa.prototype.dispose=function(){this.dzc();this.Iu=this.gAc=null;Fa.prototype.dispose.call(this)};xa.prototype.hide=function(){Fa.prototype.hide.call(this);
this.$.Ab.XJ=!1};xa.prototype.validate=function(){var T=this.gAc.LWd(this.Cj.DG.value,this.gAc.o7f(this.Cj));return T?(T=this.gAc.jcd(T).Description,this.qVd(T),this.rRd(),!1):!0};xa.prototype.isEnabled=function(){return!0};xa.prototype.qVd=function(T){this.tU.innerHTML=T};xa.prototype.bV=function(){this.tU=document.getElementById("errorText");this.tU.style.display="inline-block";this.qAa=!1;this.qVd("");this.GHa.style.maxWidth=this.GHa.currentStyle.minWidth};xa.prototype.rRd=function(){this.Iu.pa(Wb.a.click,
this.Cj.DG,this.ZQ);this.Iu.pa(Wb.a.Rb,this.Cj.DG,this.ZQ);this.qAa=!0};xa.prototype.dzc=function(){this.qAa&&(this.Iu.za(Wb.a.click,this.Cj.DG,this.ZQ),this.Iu.za(Wb.a.Rb,this.Cj.DG,this.ZQ),this.qAa=!1)};Object(Jc.a)(xa,"InsertImageDialogWrapper",Fa,[]);ta.prototype.getSheetName=function(){return this.sheetName};Object(Jc.a)(ta,"MacroRecorderPictureInsertedPayload",null,[116]);vm(Fb,Lb);Fb.prototype.dispose=function(){ah.a.Fa(this.sZb);this.Cj&&this.Cj.Yie();this.Cj=this.sZb=this.vb=null};Fb.prototype.finalizeUpload=
function(T,Oa){var Ib=this;Lb.prototype.finalizeUpload.call(this,T,Oa);Xe.a(this.$.userOperationManager,function(hc,nd){Ib.lr=hc;Ib.M$=nd;Ib.AXd.start();Ib.sZb.Bq();Ib.fyc=!1;Ib.L6f(T);return Ib.iZi(T)},function(hc){function nd(){return new ta(Ed,Ib.dBd?Ib.dBd:"")}var Td={};Ib.$.wj(Td);var Ed=Td.SheetName;hc=te.EwaSettings.tc()?new Dd.a(510,0,hc,72,nd):new cf.a(510,0,hc,8,nd);hc.Qza(function(){return!0});hc.ee=Ib.ee;return hc},this.ee)};Fb.prototype.iZi=function(T){function Oa(){hc.zw(!0)}var Ib=
this;if(!this.$)return Bc.ULS.sendTraceTag(537155794,0,50,"ReadPictureAsDataURLTask: EwaControl is null"),hg.Task.Ta(!0);if(!this.$.Taa)return hg.Task.Ta(!0);var hc=new th.a,nd=new FileReader;T=T.DG.files[0];nd.onload=function(){Ib.dBd=nd.result;hc.zw(!0)};nd.onerror=Oa;nd.onabort=Oa;nd.readAsDataURL(T);return hc.task};Fb.prototype.o7f=function(T){var Oa=-1;T=T.DG;(null===T||void 0===T?0:T.files)&&0<T.files.length&&(Oa=T.files[0].size);return Oa};Fb.prototype.LWd=function(T,Oa){var Ib=Fb.DZg(Lb.jBa(T));
Ib?6===Ib&&this.Moi(T):-1!==Oa&&(Bc.ULS.sendTraceTag(537155793,0,50,"Validating picture, pictureSize: {0}, maxAllowedSize: {1}, remainingWorkbookSize: {2}",Oa,this.Atd,this.$.fa.ygf),Oa>this.Atd?Ib=3:Oa>this.$.fa.ygf&&(Ib=7));Bc.ULS.sendTraceTag(537155792,0,50,"Validated file on client, validation result: {0}",Ib);return Ib};Fb.prototype.jBa=function(T,Oa){return(T=this.LWd(T,this.o7f(Oa)))?(this.m0a||1===T||this.G_f(T),!1):!0};Fb.prototype.L6f=function(T){T.Fyj()};Fb.prototype.jcd=function(T){var Oa=
0,Ib=1,hc=-1100324317,nd="InsertPictureUnknownError",Td=null;switch(T){case 1:Oa=1701;Ib=0;hc=940870981;nd="InsertPictureNoFileSelected";break;case 3:Ib=0;hc=1250467391;nd="InsertPicturePictureTooBig";Td=String.format(Og.a.instance.Cb(171),this.$qi.toLocaleString());break;case 6:Oa=1705;Ib=0;hc=1380041209;nd="InsertPictureUnsupportedFormat";break;case 7:Oa=1702;Ib=0;hc=-903115058;nd="InsertPictureExceedWorkbookSize";break;case 4:Oa=1703;Ib=0;hc=1218352119;nd="InsertPictureUploadTimeout";break;case 5:Oa=
1704,Ib=0,hc=1979899005,nd="InsertPictureServiceNonDeterministicError"}T=Fb.jd(Oa,Ib,hc,nd);Td&&(T.Description=Td);return T};Fb.prototype.showDialog=function(){Fb.xte()?(this.m0a=!1,this.Cj=new sa(this.$.domElement,this.mDb,this.aoa,this.ga,!1,this.$,!0)):(Bc.ULS.sendTraceTag(537155790,0,50,"Showing Insert Picture dialog"),!this.Fyb&&($e.a.Ku||$e.a.ME&&72>$e.a.Kve)?(this.m0a=!1,this.Cj=new sa(this.$.domElement,this.mDb,this.aoa,this.ga,!1,this.$)):(this.m0a=!0,this.Cj=(new xa(this,this.$,this.ga)).Cj))};
Fb.prototype.OYh=function(T){var Oa={};try{if(Oa=Fg.a.li(T),bg.b().CB(this.AXd.id,Oa.ServerCorrelationId,"actions","ServerActions"),!Ec.a.hh(Oa.Errors)&&Oa.Result){this.$.fa.ZW(Oa.StateId,"PictureUploaderWrapper.UploadResponseReceived");var Ib=Oa.Result;jh.a(this.$).zma(1,Ib);var hc=this.$.da.Aa(277);hc&&hc.rSc(this.$,1,Oa.Result,Oa,"InsertPicture");Bc.ULS.sendTraceTag(537155789,0,50,"Insert picture completed successfully :)")}}catch(nd){Bc.ULS.sendTraceTag(537155788,0,50,"PictureUploaderWrapper.HandleSuccessCallback: got exception while try to JSON.Parse string length: {0}, errror: {1}",
T?T.length:-1,nd)}this.Dyc(Oa,null,"InsertPictureWebMethod")};Fb.prototype.H2e=function(T){T={Errors:[this.jcd(T)]};this.Dyc(T,null,"InsertPictureWebMethod")};Fb.prototype.Dyc=function(T,Oa,Ib){this.lr(T,Oa,Ib)};Fb.prototype.XTd=function(T,Oa,Ib){this.M$(T,Oa,Ib)};Fb.prototype.G_f=function(T){T=this.jcd(T);te.EwaSettings.az()?new Ob.a(this.$,T):(new Aa.ErrorDialog(this.$,T)).mf()};Fb.prototype.Moi=function(T){var Oa=this.$.ya.InsertPicturUnsupportedExtensionsForLogging;T=Ze.a.Kl(T);for(var Ib=0;Ib<
Oa.length;++Ib)if(T.endsWith(Oa[Ib])){Bc.ULS.sendTraceTag(537155787,0,50,"Insert picture blocked invalid extension: {0}",Oa[Ib]);break}};Fb.uNj=function(T){return!T||Me.a.equals(T,bf.a.insertPictureUnknownError,!0)?2:Me.a.equals(T,bf.a.insertPictureNoFileSelectedError,!0)?1:Me.a.equals(T,bf.a.t6h,!0)?3:Me.a.equals(T,bf.a.u6h,!0)?5:0};Fb.jd=function(T,Oa,Ib,hc){return Ec.a.jd(1,0,0,T,Oa,Ib,hc)};Fb.DZg=function(T){switch(T){case 1:return 1;case 2:return 6}return 0};Fb.xte=function(){return te.EwaSettings.isChangeGateEnabled("OfficeVSO:5329840_InsertPictureOpenFileBrowserDirectly")&&
void 0!==window.self.FormData&&null!==window.self.FormData?!0:!1};tl.Object.defineProperties(Fb.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.vb}},$qi:{configurable:!0,enumerable:!0,get:function(){return this.Atd/1024/1024}}});Object(Jc.a)(Fb,"PictureUploaderWrapper",Lb,[3]);vm(Qb,Fb);Qb.prototype.XTd=function(T,Oa,Ib){Fb.prototype.XTd.call(this,T,Oa,Ib);this.t0.setException(Error.create("DataUrlUploaderWrapper.TriggerFailedCallback: File upload request failed"))};Qb.prototype.Dyc=
function(T,Oa,Ib){Fb.prototype.Dyc.call(this,T,Oa,Ib);Ec.a.hh(T.Errors)?this.t0.setException(Error.create(String.format("DataUrlUploaderWrapper.TriggerSuccessCallback: File upload request returned with errors: {0}",Ec.a.Uc(T.Errors)))):this.t0.setResult(!0)};Qb.prototype.L6f=function(T){var Oa=new xb(this.Scc.name,this.Scc);T.f3f(Oa)};Qb.fAh=function(T){var Oa=T.split(",");T=Oa[0].includes("base64")?window.self.atob(Oa[1]):window.self.decodeURI(Oa[1]);Oa=Oa[0].split(":")[1].split(";")[0];for(var Ib=
new Uint8Array(T.length),hc=0;hc<T.length;hc++)Ib[hc]=T.charCodeAt(hc);T=new Blob([Ib],{type:Oa});T.name="Image.png";return T};Object(Jc.a)(Qb,"DataUrlUploaderWrapper",Fb,[]);var Bf=b(579),ch=b(302),Tg=b(170),fe=b(172),Ih=b(82),Th=b(1254),h=Th.a;vm(Gb,h);Gb.prototype.Npc=function(T,Oa){this.isEnabled()&&this.TEa(this.targetOrigin)&&(this.Qn(T),this.Km(T,Oa))};Object(Jc.a)(Gb,"InsertMediaCrossDocumentMessenger",Th.a,[655,242,3]);Object(Jc.a)(hb,"OnlineMediaSearchResult",null,[]);var Bb=b(305),ic=eh.a;
vm(ya,ic);ya.prototype.Fsj=function(T){var Oa=this;this.afc=!1;this.showDialog(this.Xn,null);this.Gva=document.getElementById(this.mi("InsertMediaFrame"));if(!this.Gva)throw this.Lta(this.Tnb),Error.invalidOperation("Couldn't get InsertMediaIframe.");var Ib=document.getElementById(this.mi("WACDialogPanel"));Ib&&Ib.setAttribute(yb.a.Sd,yb.a.kYa);Ib=document.createElement("div");Ib.id="KeepFocusStartDiv";Ib.tabIndex=0;Ib.className="keep-focus-start";this.Gva.parentNode.insertBefore(Ib,this.Gva.parentNode.firstChild);
Ib=document.createElement("div");Ib.id="KeepFocusDiv";Ib.tabIndex=0;Ib.className="keep-focus";this.Gva.parentNode.appendChild(Ib);$addHandler(this.GHa,"keydown",this.Tpd);this.Gva.src=this.v8e;this.Gva.frameBorder="0";Ib=document.getElementById(this.mi("WACDialogButtonPanel"));if(!Ib)throw Error.invalidOperation("Couldn't get WACDialogButtonPanel.");Ib.className="display-none";Ib=document.getElementById(this.mi("WACDialogTitleText"));if(!Ib)throw Error.invalidOperation("Couldn't get WACDialogTitleText.");
Ib.className="display-none";2===this.kmf&&(document.getElementById(this.mi("WACDialogTitlePanel")).className="display-none",document.getElementById(this.mi("WACDialogBodyPanel")).className="padding-zero");qb.FocusManager.instance().hQ().scope.JQ=!0;this.kR=new Gb(this.Gva.contentWindow,this.v8e);this.kR.Npc(Tg.a.Vwg,function(hc){Oa.zyi(hc,Object(mc.a)(T,T.aoa,"uploadResponseReceived"))});this.kR.Npc(Tg.a.insert,function(){Oa.GFi(Object(mc.a)(T,T.aoa,"uploadResponseReceived"))});this.kR.Npc(Tg.a.$Xc,
this.Ezi);2!==this.kmf||this.bah||(this.kR.Npc(Tg.a.Hji,this.rGi),this.GMa=this.Nmb.Vya("MsoPremiumStockImages",function(hc){Bc.ULS.sendTraceTag(537155811,0,50,"OnCompleteM365Upsell: Upsell completed from stock images");if(hc.isEnabled){var nd={};Oa.kR.Qj(Tg.a.bMj,(nd.LicenseTier=hc.toString(),nd))}else Bc.ULS.sendTraceTag(537155810,0,10,"OnCompleteM365Upsell: Upsell completed but license tier didn't upgrade.")}))};ya.prototype.dispose=function(){this.Cza=null;this.Nmb&&this.GMa&&this.Nmb.WFd("MsoPremiumStockImages",
this.GMa);this.kR&&(this.kR.dispose(),this.kR=null);ic.prototype.dispose.call(this)};ya.prototype.hide=function(){ic.prototype.hide.call(this);Ih.a.fuc(this.$)};ya.prototype.zyi=function(T,Oa){T=T&&T.Values?(T=T.Values)?Object.assign(new hb,{Action:T.action||"",Caption:T.caption||"",ContentType:T.contentType||"",FileExtension:T.extension||"",PageUrl:T.pageUrl||"",SourceUrl:T.sourceUrl||"",ThumbnailUrl:T.thumbnailUrl||"",LicenseUrl:T.licenseUrl||"",LicenseDisplayName:T.licenseDisplayName||"",Height:T.height||
0,Width:T.width||0}):null:null;T&&(Array.add(this.Cza,T),this.afc&&(Bc.ULS.sendTraceTag(537155809,0,50,"InsertMediaDialog.OnAddItem: Insert Message handling was pending"),Oa(this.Cza),this.afc=!1,this.Lta(this.Tnb)))};ya.prototype.GFi=function(T){this.Cza&&0<this.Cza.length?this.Cza.length<=this.Wme?(T(this.Cza),this.Lta(this.Tnb)):(this.xz(),Bc.ULS.sendTraceTag(537155808,0,10,"OnInsert : Tried to insert more than allowed limit of items."),Array.clear(this.Cza)):this.afc=!0};ya.prototype.x2g=function(){var T=
document.createElement("div");T.id="InsertMediaDialog";T.className=te.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixHorizonalScroll",!0)?"insert-media-dialog":"insert-media-dialog-old";var Oa=document.createElement("div");Oa.id="InsertMediaPanel";Oa.className=te.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.InsertMediaDialog.ZoomFixCancelButton",!0)?"insert-media-panel":"insert-media-panel-old";var Ib=document.createElement("iframe");Ib.id=
"InsertMediaFrame";Ib.className="insert-media-frame";T.appendChild(Oa);Oa.appendChild(Ib);return Bb.b(T)};ya.prototype.xz=function(){var T=Ec.a.jd(1,0,0,0,0,466721363,"InsertPictureExceededAllowedCount");T.Description=String.format(Og.a.instance.Cb(196),this.Wme.toLocaleString());te.EwaSettings.az()?new Ob.a(this.$,T):(new Aa.ErrorDialog(this.$,T)).mf()};tl.Object.defineProperties(ya.prototype,{V3:{configurable:!0,enumerable:!0,get:function(){return fe.a.C4b+"/InsertMediaDialog"}},canBePreempted:{configurable:!0,
enumerable:!0,get:function(){return!1}}});Object(Jc.a)(ya,"InsertMediaDialog",eh.a,[]);var Nc=b(458),pd=b(375);vm(da,Lb);da.prototype.aoa=function(T){var Oa=this;if(T){for(var Ib=Array(T.length),hc=0;hc<T.length;hc++){var nd=T[hc];Ib[hc]={};Ib[hc].SourceUrl=nd.SourceUrl;Ze.a.awa(nd.LicenseUrl)&&Ze.a.awa(nd.PageUrl)&&(Ib[hc].LicenseUrl=nd.LicenseUrl,Ib[hc].LicenseDisplayName=nd.LicenseDisplayName,Ib[hc].PageUrl=nd.PageUrl);Ib[hc].AltText=-2053056795===this.ee.command?nd.Caption:""}var Td=-2009825598===
this.ee.command?"bing":"M365";hc=Hf.g(this.$);var Ed=zf.o(hc.ha.va.activeCell,this.$);Xe.a(this.$.userOperationManager,function(he,Pe,hf){return Rd.L(Oa.$.qa.ta,Ed,Ib,Td,eg.b(he,Oa.iIi),eg.a(Pe,Oa.hIi),hf,null)},function(he){return new Dd.a(595,0,he)},this.ee);Md.HelperMethods.EZ?(hc=new Map,hc.set("MediaProvider",Td),hc.set("ImagesCount",T.length.toString()),hc.set("TimeTakenToOpenDialog",this.Qjf.toString()),$c.Health.instance.recordKpiUsage(pd.a.q6h,1,Nc.a.Lxc,hc)):Bc.ULS.sendTraceTag(537155805,
0,15,"OnlinePictureUploaderWrapper.UploadResponseReceived: KPI Usage not supported.");this.Rmc()}else Bc.ULS.sendTraceTag(537155806,0,10,"OnlinePictureUploaderWrapper.UploadResponseReceived: Response is null")};da.prototype.dispose=function(){this.$=null};da.prototype.showDialog=function(){var T=this,Oa=null;Oa=this.$.Ub.Fc("UserAction","showOnlineImagesDialogTimeStopwatch");switch(this.ee.command){case -2009825598:this.Qrj();break;case -2053056795:this.Bne.execute(function(Ib){Ib.isFeatureEnabled("MsoPremiumStockImages",
!1).catch(function(hc){return Bc.ULS.sendTraceTag(557200643,0,10,"OnlinePictureUploaderWrapper::ShowDialog - Failed to load the premium state from application feature helper: {0}",hc)}).then(function(hc){T.Rrj(hc);return null})})}Oa.stop();this.Qjf=Oa.Ac};da.prototype.Qrj=function(){var T=this.$.ya.BingPictureEndpoint,Oa=Bf.a.DJ(we.AFrameworkApplication.lcid),Ib=gg.a.create();T?(T=0<T.search(RegExp("insertmedia.bing.office.net","gi"))?String.format(T,1,1):String.format(T,1,we.AFrameworkApplication.lcid,
Oa?Oa.name:"en-us",we.AFrameworkApplication.buildVersion,Ib.toString(),1,this.$.ya.DocumentHostInfo.LoggableUserId),this.z2b(T,1,-1,Og.a.instance.ea(1707))):(Bc.ULS.sendTraceTag(537155804,0,10,"OnlinePictureUploaderWrapper::ShowDialogForBingPictures - Can't access the Bing service endpoint"),this.t0.setException(Error.create("Failed to access the Bing service endpoint")))};da.prototype.Rrj=function(T){var Oa=this.$.ya.M365PictureEndpoint,Ib=gg.a.create();if(Oa){var hc=this.$.ya.DocumentHostInfo.UserId;
hc=hc?Ze.a.lu(hc).toString():"0";var nd=this.Bne.instance.isFreemiumUpsellEnabled();T=T?1:nd?0:-1;Ib=Ib.toString();nd=Bf.a.DJ(we.AFrameworkApplication.lcid).name;Oa=String.format(Oa,we.AFrameworkApplication.lcid,nd,we.AFrameworkApplication.buildVersion,Ib,1,hc,T,1);this.z2b(Oa,2,T,Og.a.instance.ea(1706))}else Bc.ULS.sendTraceTag(537155803,0,10,"OnlinePictureUploaderWrapper::ShowDialogForStockImages - Can't access the M365 service endpoint"),this.t0.setException(Error.create("Failed to access the M365 service endpoint"))};
da.prototype.z2b=function(T,Oa,Ib,hc){try{(new ya(this.$,T,dg.a.instance.Hh("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Oa,Ib,hc)).Fsj(this),this.t0.setResult(!0)}catch(nd){Bc.ULS.sendTraceTag(537155802,0,10,"OnlinePictureUploaderWrapper::CreateAndShowDialog failed [Exception : {0}] [MediaProvider : {1}] [DialogLicenseTier : {2}]",nd,Oa,Ib),this.t0.setException(nd)}};Object(Jc.a)(da,"OnlinePictureUploaderWrapper",Lb,[3]);Tb.prototype.executeCommand=function(T,Oa,Ib){T=Oa.command;
switch(T){case 1403967063:if(Ib&&"dataUrl"in Ib)return Oa=new th.a,new Qb(this.$,null,ff.a.instance,we.AFrameworkApplication.ga,Ib,Ib.dataUrl,Oa),Oa.task;new Fb(this.$,Oa,ff.a.instance,we.AFrameworkApplication.ga,Ib);return hg.Task.Ta(!0);case -2053056795:case -2009825598:return T=new th.a,new da(this.$,Oa,ff.a.instance,we.AFrameworkApplication.ga,Ib,T),T.task;default:return Ef.a(T)}};Tb.prototype.Gc=function(T,Oa){if(T=this.$.isEditMode)switch(Oa.command){case 1403967063:T=!0;break;case -2053056795:T=
te.EwaSettings.isChangeGateEnabled("OfficeVSO:5744839_InsertOnlinePictures");break;case -2009825598:T=(T=te.EwaSettings.isChangeGateEnabled("OfficeVSO:5744839_InsertOnlinePictures"))&&te.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsertBingPictures",!1);break;default:T=!1}return T};Tb.prototype.fd=function(){return!1};Tb.prototype.Xc=function(){return!1};Object(Jc.a)(Tb,"PictureCommandHandler",null,[237]);var xe=kf.a;vm(Sb,xe);Sb.prototype.Md=function(){this.Ed([new Tb(this.$)])};Sb.ja=
function(T){kf.a.de(90,new Sb(T))};Object(Jc.a)(Sb,"PictureCommandHandlerFactory",kf.a,[]);var Ue=b(514),qe=b(408),ja=b(74),Ka=b(555),qc=b(596),lc=Ka.a;vm(Xa,lc);Xa.prototype.$Md=function(T){this.zpa!==T&&(this.zpa=T,this.ZEb())};Xa.prototype.dispose=function(){this.gridView.Kc.im(this.vrf);this.gridView.Kc.Rp(this.urf);this.gridView=null;lc.prototype.dispose.call(this)};Xa.prototype.ZEb=function(){this.LDd(this.zpa)};Xa.prototype.refresh=function(){this.$Md(!this.gridView.isEditing)};tl.Object.defineProperties(Xa.prototype,
{oH:{configurable:!0,enumerable:!0,get:function(){return this.zpa}},name:{configurable:!0,enumerable:!0,get:function(){return qc.a.cellEdit}}});Object(Jc.a)(Xa,"CellEditSafeStatePublisher",Ka.a,[]);Object(Jc.a)(Cb,"SafeStatePublisherState",null,[]);var Cd=b(656),pc=lf.a;vm(ob,pc);ob.prototype.UXb=function(T){this.addHandler(ob.dQa,T)};ob.prototype.Rqc=function(T){this.removeHandler(ob.dQa,T)};ob.prototype.Xya=function(T,Oa){function Ib(Td,Ed){nd.oH=Ed.oH;hc.ODd()}var hc=this,nd=new Cb(T,Oa);this.eQa.add(nd);
T.UXb(Ib);nd.handler=Ib;this.ODd()};ob.prototype.UUd=function(T){for(var Oa=null,Ib=yl(this.eQa),hc=Ib.next();!hc.done;hc=Ib.next())if(hc=hc.value,hc.publisher===T){this.W8f(hc);Oa=hc;break}Oa&&(this.eQa.remove(Oa),this.ODd())};ob.prototype.dispose=function(){for(var T=yl(this.eQa),Oa=T.next();!Oa.done;Oa=T.next())this.W8f(Oa.value);this.eQa.clear();pc.prototype.dispose.call(this)};ob.prototype.i_e=function(){for(var T=!0,Oa=yl(this.eQa),Ib=Oa.next();!Ib.done&&(Ib=Ib.value,T=T&&Ib.oH,T);Ib=Oa.next());
return T};ob.prototype.W8f=function(T){T.publisher.Rqc(T.handler)};ob.prototype.ODd=function(){var T=this.i_e();T!==this.Cgf&&(this.raiseEvent(ob.dQa,new Cd.a(T)),this.Cgf=T)};tl.Object.defineProperties(ob.prototype,{HHj:{configurable:!0,enumerable:!0,get:function(){return ti.f(ti.c(this.eQa.toArray(),function(T){return!T.oH}),function(T){return T.publisher.name})}}});ob.dQa="SSC";Object(Jc.a)(ob,"ClientStateMonitor",lf.a,[]);var K=b(6),ha=b(64),H=Ka.a;vm(Ma,H);Ma.prototype.$Md=function(T){T!==this.zpa&&
(this.zpa=T,this.ZEb())};Ma.prototype.dispose=function(){ha.a(this.$).Bqc(this.zsf);this.h4a.zq(this.fN);this.l5d=null;H.prototype.dispose.call(this)};Ma.prototype.ZEb=function(){this.LDd(this.oH)};Ma.prototype.refresh=function(){this.$Md(1===this.h4a.ut||ha.a(this.$).ui===this.h4a)};tl.Object.defineProperties(Ma.prototype,{oH:{configurable:!0,enumerable:!0,get:function(){return this.zpa}},name:{configurable:!0,enumerable:!0,get:function(){return qc.a.h4a}},h4a:{configurable:!0,enumerable:!0,get:function(){return this.l5d}}});
Object(Jc.a)(Ma,"IdleActivitySafeStatePublisher",Ka.a,[]);var aa=b(307),ea=b(3),ab=ja.a;vm(Ia,ab);Ia.prototype.Xc=function(){return!1};Ia.prototype.executeCommand=function(){return hg.Task.Ta(!0)};Ia.prototype.Gc=function(T,Oa){return 1905775613===Oa.command};Ia.prototype.fd=function(){return!1};Object(Jc.a)(Ia,"ToggleMergeSuspensionSafeState",ja.a,[237]);var Vb=lf.a;vm(pa,Vb);pa.prototype.iq=function(T){this.addHandler(pa.gud,T)};pa.prototype.zq=function(T){this.removeHandler(pa.gud,T)};pa.prototype.gz=
function(){this.raiseEvent(pa.gud)};pa.prototype.gn=function(T){return T===pa.YVi&&!!this.mergeSuspensionManager};pa.prototype.Jr=function(T,Oa){if(!this.gn(T))return!1;this.mergeSuspensionManager&&(Oa.LabelText=this.ekc,Oa.On=this.Cvd);return!0};pa.prototype.dispose=function(){this.uLb&&(this.Ka.L$a(this.uLb),this.uLb.dispose(),this.uLb=null);this.mergeSuspensionManager&&(this.mergeSuspensionManager.s9a.jGb(this.xCb),this.mergeSuspensionManager.jha.Rqc(this.ZNa),this.mergeSuspensionManager=null);
this.statusBarManager&&(this.statusBarManager.iF(this),this.statusBarManager=null);this.ekc=null;Vb.prototype.dispose.call(this)};pa.gud="MSMSC";pa.YVi="QueryMergeSuspensionStatus";Object(Jc.a)(pa,"MergeSuspensionIndicatorManager",lf.a,[281,233,3]);var fc=b(1025),Yc=Sys.EventArgs;vm(na,Yc);Object(Jc.a)(na,"TogglePendingMergeBlockedByClientEventArgs",Sys.EventArgs,[]);var Zd=b(1026),oe=lf.a;vm(Y,oe);Y.prototype.p3h=function(){return Object(qe.a)(ob,this.jha)?Object(Oc.a)(ob,this.jha).i_e():!1};Y.prototype.XXb=
function(T){this.addHandler(Y.oTd,T)};Y.prototype.Sqc=function(T){this.removeHandler(Y.oTd,T)};Y.prototype.ZBg=function(T){this.addHandler(Y.spc,T)};Y.prototype.S5i=function(T){this.removeHandler(Y.spc,T)};Y.prototype.hBg=function(T){this.addHandler(Y.bud,T)};Y.prototype.m5i=function(T){this.removeHandler(Y.bud,T)};Y.prototype.DXi=function(){this.JDd(1===this.getState())};Y.prototype.dispose=function(){this.jha.Rqc(this.ZNa);this.jha=null;this.s9a.jGb(this.xCb);this.s9a=null;oe.prototype.dispose.call(this)};
Y.prototype.Z$b=function(){return Object.assign(new fc.a,{Current:this.u5.Current,Pending:this.u5.Pending,SuspensionStartTimestamp:this.u5.SuspensionStartTimestamp})};Y.prototype.getState=function(){return(this.ywh?Z(this.u5):this.u5.Pending!==this.u5.Current)?this.oH?2:1:0};Y.prototype.NQe=function(T,Oa){T!==Oa&&(1===Oa?this.JDd(!0):1===T&&this.JDd(!1));2===Oa?this.raiseEvent(Y.spc,new Zd.a(this.u5)):this.Wfh&&this.raiseEvent(Y.spc,new Zd.a(null))};Y.prototype.Nni=function(T,Oa,Ib){!T&&Oa?(T=1===
Oa,Bc.ULS.sendTraceTag(252760283,0,50,"MergeSuspensionState.LogPendingMergesStatusChanged: Pending changes exist. IsBlocking: {0} publisher: {1} counter: {2}",T,T?this.jha.HHj.join(","):"",ma(this.u5))):T&&!Oa&&Bc.ULS.sendTraceTag(252760284,0,50,"MergeSuspensionState.LogPendingMergesStatusChanged: No pending changes. counter: {0}",ma(Ib))};Y.prototype.JDd=function(T){this.raiseEvent(Y.oTd,new na(T))};Y.oTd="TPMBBC";Y.spc="RFPMU";Y.bud="MCC";Object(Jc.a)(Y,"MergeSuspensionState",lf.a,[]);var Ge=lf.a;
vm(S,Ge);S.prototype.mmb=function(T){this.addHandler("MCU",T)};S.prototype.jGb=function(T){this.removeHandler("MCU",T)};S.prototype.WNa=function(T,Oa){Oa=void 0===Oa?"":Oa;var Ib=this.t1.Current<T.Current||this.t1.Pending<T.Pending;if(T.SuspensionStartTimestamp&&this.vhc!==T.SuspensionStartTimestamp){if(this.vhc>T.SuspensionStartTimestamp){Ib&&Bc.ULS.sendTraceTag(553736149,0,50,"PendingMergeMonitor.OnMergeCounterReceivedFromServer: skipping a higher stale counter received via {0}. S: {1}, C: {2}",
Oa,S.IAb(T),S.IAb(this.t1));return}Ib||Bc.ULS.sendTraceTag(553736148,0,50,"PendingMergeMonitor.OnMergeCounterReceivedFromServer: recovering from a potentially stale counter. S: {0}, C: {1}",S.IAb(T),S.IAb(this.t1))}else if(!Ib)return;this.t1=T;this.vHf(T)};S.prototype.dispose=function(){this.$.fa.kk(this.Ftc);this.$.fa.mW(this.Ftc);this.$.qa.Lt(this.sBa);Hf.g(this.$).Kc.Rp(this.l8a);var T=this.$.da.Aa(292);T&&T.jGb(this.JAb);Ge.prototype.dispose.call(this)};S.prototype.vHf=function(T){Z(T)&&T.SuspensionStartTimestamp>
this.vhc&&(Bc.ULS.sendTraceTag(537155416,0,50,"PendingMergeMonitor.RaiseMergeCounterUpdated: Merge suspension requested. MergeCounter: {0}",ma(T)),this.vhc=T.SuspensionStartTimestamp);this.raiseEvent("MCU",new Zd.a(T))};S.prototype.rPf=function(){Bc.ULS.sendTraceTag(588276808,0,50,"PendingMergeMonitor.ResetMergeCounter : Last counter was {0}",S.IAb(this.t1));this.t1=Object.assign(new fc.a,{Pending:0,Current:0,SuspensionStartTimestamp:null})};S.IAb=function(T){return T?String.format("({0}/{1} @{2})",
T.Current,T.Pending,T.SuspensionStartTimestamp):"null"};tl.Object.defineProperties(S.prototype,{u5:{configurable:!0,enumerable:!0,get:function(){return this.t1}}});S.BXd="PMM.RTC";S.L5c="PMM.EwaResult";Object(Jc.a)(S,"PendingMergeMonitor",lf.a,[]);Object(Jc.a)(ca,"ClientRevisions",null,[]);var pf=b(200),Le=b(26);I.prototype.pQi=function(T){var Oa=this;if(this.lRa(T))(new th.a).setResult(!0);else{var Ib=this.qQi(T);this.tMa=T;this.Jzd++;Ib.CWCT(function(){Oa.SBi()},pf.a.none,0,this.aO)}};I.prototype.qQi=
function(T){function Oa(){Bc.ULS.sendTraceTag(588276806,0,10,"DoPendingMergeThrottler.performDoPendingMergeInternal: request failed {0} / {1} @{2}",T.Current,T.Pending,T.SuspensionStartTimestamp)}var Ib=this.ta.Xb();this.Xu();this.MMb=this.Pg.A7;Bc.ULS.sendTraceTag(554767493,0,50,"DoPendingMergeThrottler.performDoPendingMergeInternal: Sending DoPendingMerge {0} / {1} @{2}",T.Current,T.Pending,T.SuspensionStartTimestamp);if(this.Bma){var hc=this.Bma.EMi();return O(this.ta,hc,this.TBi.bind(this),Oa,
null,null,Ib)}return ba(this.ta,null,Oa,null,null,Ib)};I.prototype.lRa=function(T){return!this.tMa||T.SuspensionStartTimestamp>this.tMa.SuspensionStartTimestamp?(this.$Ka&&Bc.ULS.sendTraceTag(528561877,0,50,"DoPendingMergeThrottler.shouldThrottle: Allowing request for new suspension while previous is ongoing, new counter: {0} / {1} @{2}",T.Current,T.Pending,T.SuspensionStartTimestamp),!1):this.$Ka?!0:wa(T,this.tMa)&&this.Pg.A7-this.MMb<this.GGb};I.prototype.SBi=function(){this.Jzd--};I.prototype.TBi=
function(T){this.Bma&&this.Bma.Byi(T.Result,T.StateId)};tl.Object.defineProperties(I.prototype,{$Ka:{configurable:!0,enumerable:!0,get:function(){return 0<this.Jzd}}});Object(Jc.a)(I,"DoPendingMergeThrottler",null,[351]);R.prototype.Cmb=function(T){return T};Object(Jc.a)(R,"ReturnNewestAggregatorStrategy",null,[357]);vm(W,R);W.prototype.otb=function(T){return T};W.prototype.cEb=function(T){if(!T||this.lRa(T)){var Oa=new th.a;Oa.setResult(!0);return Oa.task}Oa=this.ta.Xb();this.Xu();this.MMb=this.Pg.A7;
this.tMa=T;Bc.ULS.sendTraceTag(554767493,0,50,"DoPendingMergeThrottlingStrategy.PerformAction: Sending DoPendingMerge {0}",ma(T));return ba(this.ta,null,function(){Bc.ULS.sendTraceTag(588276806,0,10,"DoPendingMergeThrottlingStrategy.PerformAction: request failed {0}",ma(T))},null,null,Oa)};W.prototype.lRa=function(T){return wa(T,this.tMa)&&this.Pg.A7-this.MMb<this.GGb};Object(Jc.a)(W,"DoPendingMergeThrottlingStrategy",R,[349]);tl.Object.defineProperties(ia.prototype,{reportName:{configurable:!0,enumerable:!0,
get:function(){return"SelectionAdjust"}}});Object(Jc.a)(ia,"SelectionAdjustSessionEndsReport",null,[359]);P.prototype.Nbg=function(T){if(!this.v_d)return Bc.ULS.sendTraceTag(528590294,0,10,"Selection.viewportBlocksReadyForAdjust: _blockCacheItems undefined"),!1;for(var Oa=yl(this.v_d),Ib=Oa.next();!Ib.done;Ib=Oa.next())if(Ib=Ib.value,Ib.tk&&Ib.ie.Revision<T)return!1;return!0};P.prototype.CCj=function(){var T;if(this.JBa)return{SheetName:this.sheetName,ActiveCell:null===(T=this.activeCell)||void 0===
T?void 0:T.toString(),SelectedRange:this.selectedRanges[0].toString(),TopLeft:void 0}};P.prototype.toString=function(){var T,Oa;return String.format("active cell: {0} selection: {1}",null!==(Oa=null===(T=this.activeCell)||void 0===T?void 0:T.toString())&&void 0!==Oa?Oa:"null",ti.f(this.selectedRanges,function(Ib){var hc;return null!==(hc=null===Ib||void 0===Ib?void 0:Ib.toString())&&void 0!==hc?hc:"null"}).join(","))};P.prototype.equals=function(T){return T?this.activeCell.equals(T.activeCell)&&zf.Q(this.selectedRanges,
T.selectedRanges)&&this.sheetName===T.sheetName:!1};tl.Object.defineProperties(P.prototype,{activeCell:{configurable:!0,enumerable:!0,get:function(){return this.MF}},selectedRanges:{configurable:!0,enumerable:!0,get:function(){return this.U8}},sheetName:{configurable:!0,enumerable:!0,get:function(){return this.NUb}},activeItemName:{configurable:!0,enumerable:!0,get:function(){return this.Vfg}},JBa:{configurable:!0,enumerable:!0,get:function(){return 1===this.selectedRanges.length}}});Object(Jc.a)(P,
"Selection",null,[]);var ug=b(208);N.prototype.EMi=function(){te.EwaSettings.isChangeGateEnabled("OfficeVSO:6005376_SelectionAdjustTelemetryUpdates")&&(this.kT.totalRequests++,this.cJ&&(this.kT.errors++,Bc.ULS.sendTraceTag(526960090,0,15,"SelectionAdjustManager.onWaitingForAdjustedSelection: About to ignore a defined Adjusted selection: {0}",this.cJ.toString())));this.cJ=null;this.Wv=this.yJa();var T=null,Oa=this.Wv.CCj(),Ib=!te.EwaSettings.isChangeGateEnabled("OfficeVSO:6011633_SelectionAdjustNonContinuousFix");
if(Oa||Ib)T={ActiveSheetName:this.Wv.sheetName,SheetViewportStateChanges:[Oa]};return T};N.prototype.Byi=function(T,Oa){var Ib=this;if(this.Wv)if(T){var hc,nd;if(function(){var Td=zf.Z(T.ActiveCell,Ib.$.xa);hc=Td.range;return Td}().returnValue)if(function(){var Td=zf.Z(T.SelectedRange,Ib.$.xa);nd=Td.range;return Td}().returnValue){if(this.cJ=new this.mTf(this.$,hc,[nd],T.SheetName,this.Wv.activeItemName),this.Nwc=Oa,this.Yze)Oa=!0,this.Wv.JBa?this.Wv.equals(this.cJ)&&(this.kT.adjustedDidntChange++,
Oa=!1):(this.kT.nonContinuous++,Oa=!1),Oa||this.qwe(!1)}else this.kT.errors++,this.Wv=null,Bc.ULS.sendTraceTag(537155410,0,10,"SelectionAdjustManager.OnAdjustedSelectionReady: Unable to extract selected range {0}",T.SelectedRange);else this.kT.errors++,this.Wv=null,Bc.ULS.sendTraceTag(537155411,0,10,"SelectionAdjustManager.OnAdjustedSelectionReady: Unable to extract active cell {0}",T.ActiveCell)}else this.kT.errors++,Bc.ULS.sendTraceTag(537155412,0,15,"SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted returned null, initialSelection: {0}",
this.Wv.toString());else this.kT.errors++,Bc.ULS.sendTraceTag(537155413,0,10,"SelectionAdjustManager.OnAdjustedSelectionReady: Adjusted selection results returned when not waiting for them, adjusted:  ActiveCell: {0}, SelectedRange: {1}",null===T||void 0===T?void 0:T.ActiveCell,null===T||void 0===T?void 0:T.SelectedRange)};N.prototype.dispose=function(){this.gridView.Ca.yq(this.Hg);this.gridView.Ca.Zo(this.e8a);this.gridView.Ca.XLf(this.e8a);this.gridView.Ca.Q$a(this.e8a)};N.prototype.yJa=function(){var T=
this.$.oa;return(null===T||void 0===T?0:T.activeCell)&&T.selectedRanges&&T.sheetName?new this.mTf(this.$,T.activeCell,T.selectedRanges,T.sheetName,this.$.activeItemName):null};N.prototype.aqe=function(T){if(this.cJ)if(this.Wv){if(T){if(Hf.g(this.$).Ca.Tlf<this.Nwc)return;this.XEf&&!this.Wv.JBa||Bc.ULS.sendTraceTag(528590295,0,15,"SelectionAdjustManager.attemptAdjustSelection: got to blockCacheConsistent while pending for selection adjust")}else if(this.XEf&&!this.Wv.JBa||!this.Wv.Nbg(this.Nwc)||!this.cJ.Nbg(this.Nwc))return;
T=!1;try{if(this.Wv.equals(this.yJa())){if(!this.Yze){if(!this.Wv.JBa){this.kT.nonContinuous++;return}if(this.Wv.equals(this.cJ)){this.kT.adjustedDidntChange++;return}}this.kT.adjusted++;this.gridView.PU(this.cJ.selectedRanges,0,this.cJ.sheetName,null,this.cJ.activeCell,null,null,0,Qe.a.yej)}else this.kT.divergence++,T=!0,this.X7i()}finally{this.qwe(T)}}else Bc.ULS.sendTraceTag(537155409,0,10,"SelectionAdjustManager.attemptAdjustSelection: initialSelection is null while adjustedSelection isn't null, adjustedSelection: {0}",
this.cJ.toString())};N.prototype.qwe=function(T){var Oa,Ib,hc,nd;this.E8i&&Bc.ULS.sendTraceTag(526792898,0,50,"SelectionAdjustManager.clearSelections: initial: {0} initialContinuous: {1} adjusted: {2}, divergence: {3}",null!==(Ib=null===(Oa=this.Wv)||void 0===Oa?void 0:Oa.toString())&&void 0!==Ib?Ib:"null",this.Wv.JBa,null!==(nd=null===(hc=this.cJ)||void 0===hc?void 0:hc.toString())&&void 0!==nd?nd:"null",T);this.Wv=this.cJ=null};N.prototype.X7i=function(){if(this.Y7i){var T=this.yJa();Bc.ULS.sendTraceTag(537155408,
0,50,"SelectionAdjustManager.ReportDivergence: initial: {0} current: {1} adjusted: {2} sheetSameBetweenInitialAndAdjusted: {3} sheetSameBetweenInitialAndCurrent: {4}",this.Wv.toString(),T?T.toString():"",this.cJ.toString(),this.Wv.sheetName===this.cJ.sheetName,this.Wv.sheetName===(T?T.sheetName:null))}};tl.Object.defineProperties(N.prototype,{mTf:{configurable:!0,enumerable:!0,get:function(){return P}}});Object(Jc.a)(N,"SelectionAdjustManager",null,[350,3]);var ig=lf.a;vm(U,ig);U.prototype.dispose=
function(){this.$.qa.fza(this.tBa);ah.a.Fa(this.brb);this.Swc();this.EV.S5i(this.Uxf);this.EV.Sqc(this.jDb);this.EV.m5i(this.hwf);this.EV=null;this.Bma&&this.Bma.dispose();ig.prototype.dispose.call(this)};U.prototype.wTf=function(T){this.brb.dEb(T)};U.prototype.exj=function(){this.Swc();if(this.$Ee()){var T=this.EV.Z$b();Bc.ULS.sendTraceTag(537155414,0,50,"RequestController.StartKeepBlockingPendingMergesTimer: Prevented starting StartKeepBlockingPendingMergesTimer because of repeated failure in counter {0} fail count: {1}",
ma(T),this.Yyb)}else this.Zyb=this.vra.create(this.BTf,this.GGb,Ch.a.Zyb),this.u6a=this.vra.XB(this.BTf,this.yii,Ch.a.u6a)};U.prototype.Swc=function(){this.u6a&&(this.Zyb.cancel(),this.u6a.cancel(),this.u6a=this.Zyb=null)};U.prototype.aGi=function(T){var Oa=" fail count: "+this.Yyb;this.Yyb++;this.$Ee()&&this.Swc();Bc.ULS.sendTraceTag(542229773,0,10,"RequestController.OnKeepBlockingPendingMergesRequestFailed: request failed {0}{1}",ma(T),Oa)};U.prototype.$Ee=function(){return this.Yyb>U.ori};U.ori=
5;Object(Jc.a)(U,"RequestController",lf.a,[]);var ih=ja.a;vm(B,ih);B.prototype.XXb=function(T){this.jfa.XXb(T)};B.prototype.Sqc=function(T){this.jfa&&this.jfa.Sqc(T)};B.prototype.Xya=function(T,Oa){this.iCa.Xya(T,Oa)};B.prototype.UUd=function(T){this.iCa.UUd(T)};B.prototype.WNa=function(T,Oa){this.xjb.WNa(T,void 0===Oa?"":Oa)};B.prototype.dispose=function(){this.ddc&&(this.ddc.dispose(),this.ddc=null);this.$Hd&&(this.$Hd.dispose(),this.$Hd=null);this.jfa&&(this.jfa.dispose(),this.jfa=null);this.xjb.dispose();
this.xjb=null;this.iCa.dispose();this.iCa=null;this.wZa&&(this.wZa.dispose(),this.wZa=null);this.i4a&&(this.i4a.dispose(),this.i4a=null);this.$=null;ih.prototype.dispose.call(this)};B.prototype.ZEb=function(){this.jfa.DXi()};B.prototype.q3h=function(T,Oa){this.iCa=new ob;Oa?Object(qe.a)(Ma,Oa)?this.Xya(Oa,Object(Oc.a)(Ma,Oa).oH):Object(qe.a)(Xa,Oa)?this.Xya(Oa,Object(Oc.a)(Xa,Oa).oH):this.Xya(Oa,!0):(this.wZa=new Xa(T),this.i4a=new Ma(T),this.Xya(this.wZa,this.wZa.oH),this.Xya(this.i4a,this.i4a.oH))};
tl.Object.defineProperties(B.prototype,{jha:{configurable:!0,enumerable:!0,get:function(){return this.iCa}},s9a:{configurable:!0,enumerable:!0,get:function(){return this.xjb}},EV:{configurable:!0,enumerable:!0,get:function(){return this.jfa}}});Object(Jc.a)(B,"MergeSuspensionManager",ja.a,[308,3]);var $g=dd.a;vm(w,$g);w.prototype.create=function(){Bc.ULS.sendTraceTag(537155419,0,50,"MergeSuspensionFactory.Create");this.Fb(this.Nc.da.Aa(343)||this.Nc.da.Ha(343,new B(this.Nc,qi.a.instance)))};w.ja=
function(T){Bc.ULS.sendTraceTag(537155418,0,50,"MergeSuspensionFactory.Attach");T.da.Ha(344,new w(T))};Object(Jc.a)(w,"MergeSuspensionFactory",dd.a,[]);G.Rki=3;G.connected=0;Object(Jc.a)(G,"ConnectionStateConstants",null,[]);var xh=b(107),vh=b(113),nf=b(39);r.prototype.iVf=function(){this.durationMs=vh.a(Le.a.Ra,this.startTime)};r.prototype.Qyd=function(T){var Oa=this,Ib;this.iVf();nf.a(T).Pqc(this.crf);nf.a(T).pg.Qqc(this.Vba);T.da.Za(291,function(hc){hc.T$a(Oa.IV)});if(null===(Ib=T.fa)||void 0===
Ib?0:Ib.Df)T.fa.Df.kNf(this.Ezd),this.wasUserActiveOnPIEnd=T.fa.Df.Yq};r.prototype.ak=function(T){var Oa=this;nf.a(T).QXb(this.crf);this.isToastShown?this.toastRaiser="Immediate":nf.a(T).pg.ATc(this.Vba);T.da.Za(291,function(Ib){Oa.hasTabbedOut=Ib.kj;Ib.aFa(Oa.IV)});this.wasUserActiveOnPIStart&&T.fa.Df.VCg(this.Ezd)};Object(Jc.a)(r,"PartialInteractivityData",null,[]);var dh=b(1216);vm(z,r);z.prototype.OAi=function(T,Oa){this.swappedByOffline=Oa;this.Qyd(T)};z.prototype.pij=function(T){this.errorDataDuringConnectivityIssuesMode=
T};z.prototype.c_i=function(T){10>this.failedRequests.length&&(T=T+"_"+xh.getElapsedSeconds(this.startTime,Le.a.Ra.Kb).toString(),this.failedRequests.push(T))};Object(Jc.a)(z,"ConnectivityIssuesData",r,[]);var Dh=b(166);t.Pdh="DuringWork";t.connectivityIssues="ConnectivityIssues";t.offline="Offline";Object(Jc.a)(t,"UnavailabilityTypes",null,[]);x.prototype.dispose=function(){this.$&&(nf.a(this.$).pg.hMf(this.osf),this.$.uf&&this.$.uf.gMf(this.lsf));this.data&&this.$.qa.uf.lNf(this.Xo);this.$=null};
x.prototype.UOg=function(T){var Oa=this.c9c-1;return(this.data.averageDurationBetweenFailedRequestsSec*(Oa-1)+T)/Oa};Object(Jc.a)(x,"ConnectivityIssuesTelemetryManager",null,[3]);var Eg=b(992),ei=b(1262),Ti=b(1215);A.prototype.dispose=function(){this.$&&(this.qOd&&this.$.qa&&0<this.H7a.count&&this.$.qa.Lt(this.Zh),this.rOd&&(this.$Qd("Dispose"),this.$.fa.Df.eza(this.Uba)))};A.prototype.U2h=function(){te.EwaSettings.la(212)&&this.YSi();this.rOd&&this.ZSi()};A.prototype.r3h=function(){this.zBb=this.ABb;
this.kqd=0;var T={};if(!this.H7a){this.H7a=new cg.a;var Oa=ei.a.Iad(this.D8i,"InitSampleMeasurement",this.$);Oa=yl(Oa);for(var Ib=Oa.next();!Ib.done;Ib=Oa.next())Ib=Ib.value,T[Ib.Xhd]=Ib.baseUrl,this.H7a.add(Ib)}T=Sys.Serialization.JavaScriptSerializer.serialize(T);Bc.ULS.sendTraceTag(537155210,0,50,"Init Network measurement: numberOfRequestToWaitPerNetworkMeasurement: {0}, numberOfRequestFromTheLastNetworkMeasurement: {1}, testParams: {2} ",this.ABb,this.zBb,T);0<this.H7a.count&&this.$.qa.us(this.Zh)};
A.prototype.xxj=function(){for(var T=yl(this.H7a),Oa=T.next();!Oa.done;Oa=T.next())Oa.value.HJd()};A.prototype.IQd=function(T){this.ARa&&this.ARa.Qo||(Bc.ULS.sendTraceTag(537155208,0,50,"NetworkMeasurement.StartConnectionSpeedTest: starting ping tests. caller: {0}",T),this.ARa=qi.a.instance.XB(this.cfj,5E3,Ch.a.wvj),this.ARa.Uja())};A.prototype.$Qd=function(T){this.ARa&&this.ARa.Qo&&(Bc.ULS.sendTraceTag(537155207,0,50,"NetworkMeasurement.StopConnectionSpeedTest: stopping ping tests. caller: {0}",
T),this.ARa.cancel())};A.prototype.ypj=function(T){return this.zBb>=this.ABb&&T-this.kqd>this.nud};A.prototype.zSg=function(){return A.vQf(this.$.ya.SlowNetworkMeasurementsSamplePercentage)};A.prototype.YSi=function(){this.ABb=this.$.ya.NumberOfRequestToWaitPerNetworkMeasurement;this.nud=1E3*this.$.ya.MinTimeBetweenNetworkMeasurementInSec;var T=this.$.ya.NetworkMeasurementsSamplePercentage;0<this.ABb&&0<this.nud&&(this.qOd=A.vQf(T))&&this.r3h()};A.prototype.ZSi=function(){if(!this.pwc){this.pwc=new cg.a;
var T=ei.a.Iad(this.T7i,"PrepareAndInitSlowNetworkTests.ConnectionSpeedTest",this.$,[Ti.a.RBc]);T=yl(T);for(var Oa=T.next();!Oa.done;Oa=T.next())this.pwc.add(Oa.value);this.$.fa.Df.Yq&&this.IQd("PrepareAndInitSlowNetworkTests")}};A.vQf=function(T){return 100*Math.random()<T};Object(Jc.a)(A,"NetworkMeasurement",null,[3]);var Qi=b(913);m.prototype.UIj=function(){this.$T&&this.$T.iVf()};m.prototype.yxg=function(T){this.allOfflinePartialInteractivitiesDataInSession.push(T);this._count++};tl.Object.defineProperties(m.prototype,
{count:{configurable:!0,enumerable:!0,get:function(){return this._count}},$T:{configurable:!0,enumerable:!0,get:function(){return this.allOfflinePartialInteractivitiesDataInSession[this.allOfflinePartialInteractivitiesDataInSession.length-1]}}});Object(Jc.a)(m,"OfflinePartialInteractivitiesDataForLog",null,[]);vm(v,r);v.prototype.Slj=function(T){this.timeFromLastOffline=T};v.prototype.qij=function(T){this._errorDataDuringOfflineMode=T};Object(Jc.a)(v,"OfflinePartialInteractivityData",r,[]);u.prototype.dispose=
function(){this.$&&nf.a(this.$)&&nf.a(this.$).pg.XGd(this.F8a);ah.a.Fa(this.Jsb);this.$=this.Jsb=null};u.prototype.PHi=function(T){this.$T=new v(Le.a.Ra.Kb,this.$,!!T);this.$T.Slj(-1!==this.yCd?window.performance.now()-this.yCd:-1);this.zNa.yxg(this.$T);nf.a(this.$).pg.ATc(this.Vba);this.H1a();this.Jsb=qi.a.instance.XB(this.H1a,u.cxh,Ch.a.H1a);Dh.a(this.$).bTc(this.BRf)};u.prototype.QHi=function(){this.$T.Qyd(this.$);this.H1a();ah.a.Fa(this.Jsb);this.Jsb=null;this.yCd=window.performance.now();nf.a(this.$).pg.Qqc(this.Vba);
Dh.a(this.$).HGd(this.BRf);this.U7i()};u.prototype.ucj=function(T,Oa){var Ib=this;this.$?this.Egf=$f.TaskExtensions.Ba(this.Egf,function(){Ib.indexedDB.Rab(new Qi.a(T,Oa))},this.$.ma):Bc.ULS.sendTraceTag(537155205,0,15,"OfflineModeTelemetryManager.SaveToIndexedDBSequential: EwaControl is null when attempting to write to IDB")};u.prototype.O7i=function(){var T=this.$.ma;$f.TaskExtensions.Ba($f.TaskExtensions.Ba(this.indexedDB.CJa(u.EAd),this.u8i,T),this.B2i,T)};u.prototype.U7i=function(){if(this.$T){var T=
Sys.Serialization.JavaScriptSerializer.serialize(this.$T);te.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_71qb3_Offline")?bg.b().aIb(560791645,0,50,t.offline,this.$T.durationMs,"OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: {0}",T):Bc.ULS.sendTraceTag(560791645,0,50,"OfflineModeTelemetryManager.ReportCurrentOfflinePartialInteractivityData: Ending offline partial interactivy data: {0}",T)}te.EwaSettings.isChangeGateEnabled("OfficeVSO:5508233_ReportNetworkDownVeto")&&
this.$T&&this.$T.isToastShown&&$c.Health.instance.recordQosError(sf.a.GMj,[Vf.a.Ohc],!0,!1,!1,!1,null)};u.fjd="NetworkAvailability";u.gjd="NetworkAvailabilityData";u.EAd="partialInteractivityData";u.cxh=3E3;Object(Jc.a)(u,"OfflineModeTelemetryManager",null,[3]);f.prototype.dispose=function(){ah.a.Fa(this.$pf);ah.a.Fa(this.pvd);ah.a.Fa(this.Xka);ah.a.Fa(this.RXg);this.$=null};Object(Jc.a)(f,"NetworkConnectionTelemetryManager",null,[3]);vm(l,r);l.prototype.F8a=function(){this.wasInteruptedByOfflineMode=
!0};Object(Jc.a)(l,"SilentReopenData",r,[]);n.prototype.dispose=function(){this.pg.HMf(this.cwf);this.pg.q6i(this.Mzf);this.X6=this.pg=this.$=null};n.prototype.Jzf=function(T,Oa){T.ZO?this.X6=new l(Le.a.Ra.Kb,this.$,!!T.wna,Oa):(5===T.wna&&(this.X6.wasInteruptedByOfflineMode=!0),3!==T.wna&&2!==T.wna||Bc.ULS.sendTraceTag(537155202,0,10,"SilentReopenPartialInteractivityTelemetryManager.OnSilentReopen: BackToWork/DuringWork partial interactivity has been swapped to DuringWork/BackToWork."),this.X6.Qyd(this.$),
2===Oa?te.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_8dtae_B2W")?bg.b().bIb(571289604,0,50,t.offline,this.X6.durationMs,this.X6):Bc.ULS.sendTraceTag(571289604,0,50,Fg.a.Hc(this.X6)):te.EwaSettings.isChangeGateEnabled("OfficeVSO:5690761_AvailabilityUTRDuringWork_6w9lg_DuringWork")?bg.b().bIb(542782150,0,50,t.Pdh,this.X6.durationMs,this.X6):Bc.ULS.sendTraceTag(542782150,0,50,Fg.a.Hc(this.X6)),this.X6=null)};Object(Jc.a)(n,"SilentReopenPartialInteractivityTelemetryManager",
null,[3]);var hj=lf.a;vm(k,hj);k.prototype.dispose=function(){this.uf&&(this.fvc&&(this.uf.r5i(this.ECb),this.uf.lGb(this.Hwf)),this.uf.gMf(this.msf),this.uf.d4i(this.nsf));this.lyb&&this.documentVisibilityObserver&&(this.documentVisibilityObserver.cGb(this.Nxa),this.lyb=!1);this.$&&(this.Upc&&this.azc(),this.$.fa&&(this.$.fa.aNf(this.Lzf),this.$.fa.Df&&this.$.fa.Df.eza(this.Uba)));te.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&this.x0&&(this.x0.dispose(),
this.x0=null);ah.a.Fa(this.Ynf);this.$=null;hj.prototype.dispose.call(this)};k.prototype.Qqi=function(){this.jOd=!0};k.prototype.Fhe=function(){this.ina||(this.ina=nf.a(this.$).pg.dXa(3,"NetworkConnectionStateManager.ActivateDuringWorkSilentReopenPartialInteractivity"))};k.prototype.Z8h=function(){if(this.jOd)return this.jOd=!1,!0;var T=this.i7>this.Hjf||this.Zid>this.Hjf&&10>this.i7;Bc.ULS.sendTraceTag(537155223,0,50,"NetworkConnectionStateManager.IsBackToWorkSilentReopen: Inactivity duration: Time from last activity:{0}, Time gap between last two activities: {1}. return value:{2}",
this.i7,this.Zid,T);return T};k.prototype.G8i=function(){te.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&(this.x0=qi.a.instance.create(function(){$c.Health.instance.recordQosError(sf.a.Bvj,[Vf.a.Ohc],!0,!0,!1,!1,null)},6E3,"ReportLongSilentReopenBackToWorkVeto",void 0,!0))};k.prototype.dvg=function(){var T=this;this.ina||this.l0?Bc.ULS.sendTraceTag(542782155,0,10,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Trying to activate during-work partial interactivity when we are already in this partial interactivity or there is a running timer that's going to do it soon."):
this.l0=qi.a.instance.create(function(){T.$?T.ina?Bc.ULS.sendTraceTag(537155221,0,15,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Tried to activate SilentReopenDuringWork PI when there is already an DuringWorkSilentReopen partial interactivity object"):Hf.g(T.$).isEditing?(T.E$a||(Hf.g(T.$).rc.hq(T.Rh),Bc.ULS.sendTraceTag(541893722,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Registered OnEditEnded while during-work silent reopen")),T.F$a=
!0,Bc.ULS.sendTraceTag(537155220,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: Need to init during-work silent reopen partial interactivity but the user is during a cell edit. Registered to OnEditEnded event.")):T.Fhe():Bc.ULS.sendTraceTag(537155222,0,50,"NetworkConnectionStateManager.ActivateSilentReopenDuringWorkWhenNeeded: EwaControl is null")},this.O0f,Ch.a.vuj,void 0,!0)};k.prototype.Smf=function(T){this.t0c=this.Wse(2,T,!0);this.tme()};k.prototype.Ejc=function(T,
Oa){this.DUb=this.Wse(T,Oa,!1);this.tme()};k.prototype.Wse=function(T,Oa,Ib){Ib=Ib?this.t0c:this.DUb;return Oa?Ib|T:Ib&~T};k.prototype.nTd=function(){var T=!!this.ANa,Oa=!!this.vRa,Ib=!!this.ina,hc=!!this.N1b;this.iAb&&!T?this.cvg():!this.iAb&&T&&this.h8g();!this.zic||Oa||Ib?this.zic||(Oa?this.uDe():(Ib||this.l0&&this.l0.Qo)&&this.vDe()):this.RYf&&this.afa?this.$ug():!this.kJb||this.afa||te.EwaSettings.isChangeGateEnabled("OfficeVSO:5658794_DontActivatePartialInteractivityIfTimerIsRunning")&&this.l0||
this.dvg();this.Zja&&!hc?this.S5f(!0):!this.Zja&&hc&&this.S5f(!1)};k.prototype.cvg=function(){this.$?this.ANa?Bc.ULS.sendTraceTag(537155215,0,15,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Tried to activate offline PI when there is already an offline partial interactivity object"):Hf.g(this.$).isEditing?(this.F$a||(Hf.g(this.$).rc.hq(this.Rh),Bc.ULS.sendTraceTag(537155217,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Registered OnEditEnded during offline mode")),
this.E$a=!0,Bc.ULS.sendTraceTag(537155216,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: Turned offline while user is editing a cell, registered to OnEditEnded event.")):this.Ihe():Bc.ULS.sendTraceTag(537155214,0,50,"NetworkConnectionStateManager.ActivateOfflinePartialInteractivityIfNeeded: EwaControl is null")};k.prototype.Ihe=function(){this.ANa||(this.ANa=nf.a(this.$).pg.dXa(5,"NetworkConnecStateManager.ActivateOfflinePartialInteractivity"))};k.prototype.h8g=function(){this.ANa&&
(ah.a.Fa(this.ANa),this.ANa=null)};k.prototype.uDe=function(){this.vRa&&(ah.a.Fa(this.vRa),this.vRa=null);te.EwaSettings.isChangeGateEnabled("OfficeVSO:5533387_ReportLongSilentReopenBackToWorkVeto")&&this.x0&&this.x0.Qo&&this.x0.cancel();this.x0=null};k.prototype.vDe=function(){this.ina&&(ah.a.Fa(this.ina),this.ina=null);this.l0&&(ah.a.Fa(this.l0),this.l0=null);this.F$a&&!this.E$a&&Hf.g(this.$).rc.Rp(this.Rh);this.F$a=!1};k.prototype.$ug=function(){this.vRa||(this.vRa=nf.a(this.$).pg.dXa(2,"NetworkConnectionStateManager.ActivateLongInactivitySilentReopenPartialInteractivity",
void 0,Og.a.instance.ea(2119)));this.G8i()};k.prototype.S5f=function(T){T?(this.N1b=nf.a(this.$).pg.dXa(4,"NetworkConnectionStateManager.ConnectivityIssues"),this.ZVi()):(ah.a.Fa(this.N1b),this.N1b=null)};k.prototype.ZVi=function(){if(this.$&&this.$.qa){var T=this.$.qa.ta.Xb();Rd.ib(this.$.qa.ta,null,null,null,T)}};k.prototype.azc=function(){ha.a(this.$).gQ(K.a.kOa).zq(this.Swf);this.$.ml(this.od);this.Upc=!1};k.prototype.tme=function(){this.documentVisibilityObserver||Bc.ULS.sendTraceTag(537155211,
0,15,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: Document visibility observer is null while it shouldn't be.");this.documentVisibilityObserver&&this.documentVisibilityObserver.kj?this.lyb||(this.documentVisibilityObserver.hmb(this.Nxa),this.lyb=!0,Bc.ULS.sendTraceTag(541193954,0,50,"NetworkConnectionStateManager.AdjustPartialInteractivityStateWhenPossible: tabbed out user, will update the partial interactivity state when the user will be back.")):this.nTd()};tl.Object.defineProperties(k.prototype,
{M$h:{configurable:!0,enumerable:!0,get:function(){return this.afa}},iAb:{configurable:!0,enumerable:!0,get:function(){return!(this.DUb&1)}},zic:{configurable:!0,enumerable:!0,get:function(){return!(this.DUb&2)}},Zja:{configurable:!0,enumerable:!0,get:function(){return!!(this.t0c&2)}}});Object(Jc.a)(k,"NetworkConnectionStateManager",lf.a,[309,3]);var Ah=dd.a;vm(c,Ah);c.prototype.create=function(){var T=this;$f.TaskExtensions.Ba(ef.GetServiceTaskFactory.Xa(this.$.da,395,396,this.tb),function(Oa){T.Fb(T.$.da.Aa(400)||
new k(T.$,Oa.result))},this.$.ma,3)};c.ja=function(T){T.da.Ha(401,new c(T))};Object(Jc.a)(c,"NetworkConnectionStateManagerFactory",dd.a,[]);var Ci=b(1372);d.prototype.dispose=function(){this.z8f();this.H8f();this.pqd=this.$pd=this.CK=this.nk=this.Et=this.mpc=this.$=null;this.oXd=0};d.prototype.MJg=function(T){this.CK=T;this.$pd=T.sDg;this.pqd=T.x_i};d.prototype.NHa=function(){if(this.CK){var T=zf.K(this.CK.qsh);this.Jvj(T);this.hide();this.z8f();this.CK=null}};d.prototype.Jvj=function(T){if(te.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.OnPasteEnabled",
!1)&&T)if(null==this.A6a||1868184698!=this.A6a.command&&753331043!=this.A6a.command&&2137617149!=this.A6a.command)if(Hf.g(this.$).Vb.T4(T))Bc.ULS.sendTraceTag(526758983,306,50,"RecoveryUIController:dismissRecoveryUI Last paste was a table. Table hand raise is not triggered.");else if(Hf.g(this.$).Vb.S4(T))Bc.ULS.sendTraceTag(526758982,306,50,"RecoveryUIController:dismissRecoveryUI Last paste was a pivot table. Table hand raise is not triggered.");else{var Oa=Ne.d(this.$.xa.oa);T=new jg.a(T,Oa);this.KEj(T)}else this.A6a=
null,Bc.ULS.sendTraceTag(526758984,306,50,"RecoveryUIController:dismissRecoveryUI Last command was create table or create pivot table. Table hand raise is not triggered.")};d.prototype.gei=function(){return!!this.CK&&this.mpc.Gai};d.prototype.Gtj=function(T){this.CK?this.show(T):Bc.ULS.shipAssertTag(537154072,0,!1,"RecoveryUIController.ShowRecoveryUI: recoveryUI is null.")};d.prototype.BLh=function(){return this.CK?this.CK.Yji:null};d.prototype.show=function(T){var Oa=this.CK.wHh();Oa?(this.mpc.showFloatie(Object.assign(new Ci.a,
{x:Oa.x,y:Oa.y}),this.CK.xJa(),T),this.ak()):Bc.ULS.sendTraceTag(537154071,0,100,"RecoveryUIController.Show: point is null.")};d.prototype.hide=function(){this.gei()&&this.mpc.bC();this.H8f()};d.prototype.ak=function(){if(!this.P4b){var T=Hf.g(this.$);T.view.it(this.I$f);T.Jj.wm(this.EFe);this.nk.ja("blur",this.$ah);this.$.Ka.fmb(this.Jxa);this.$.xa.Pf(this.FFe);(T=this.$.da.Aa(65))&&T.O2&&T.O2.registerForCommentEvents(this.DFe);this.P4b=!0}this.ecc||(this.Et.Vu(Wb.a.Rb,this.$.domElement,this.onKeyDown,
!0),this.Et.Vu(Wb.a.Vd,this.$.domElement,this.onKeyUp,!0),this.ecc=!0)};d.prototype.z8f=function(){if(this.P4b){var T=Hf.g(this.$);T.view.Wr(this.I$f);T.Jj.im(this.EFe);this.nk.detach("blur");this.$.Ka.S$a(this.Jxa);this.$.xa.rg(this.FFe);(T=this.$.da.Aa(65))&&T.O2&&T.O2.unregisterForCommentEvents(this.DFe);this.P4b=!1}};d.prototype.H8f=function(){this.ecc&&(this.Et.kv(Wb.a.Rb,this.$.domElement,this.onKeyDown,!0),this.Et.kv(Wb.a.Vd,this.$.domElement,this.onKeyUp,!0),this.ecc=this.OZ=this.m7b=!1)};
d.prototype.OKj=function(){this.CK&&250<=Le.a.Ra.re.m-this.oXd&&this.show(-1)};d.prototype.KEj=function(T){$f.TaskExtensions.Ba(ef.GetServiceTaskFactory.Xa(this.$.da,426,427,1),function(Oa){Oa.result.Pda(T,"Paste")},this.$.ma,3)};Object(Jc.a)(d,"RecoveryUIController",null,[305,3]);var ni=dd.a;vm(a,ni);a.prototype.create=function(){var T=this,Oa=this.$;Oa.rE(function(Ib){Ib.qjd().then(function(hc){T.Fb(Oa.da.Aa(406)||new d(Oa,hc,nb.KeyInputManager.instance,zb.a.instance.VD()))})})};a.ja=function(T){T.da.Ha(405,
new a(T))};Object(Jc.a)(a,"RecoveryUIControllerFactory",dd.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.InsertPicture");Type.registerNamespace("_Ewa");Type.registerNamespace("Common");Type.registerNamespace("Common.App.ApplicationFeatureHelper");Cg.main();Type.registerNamespace("Common.App.InProductMessaging");rd.main();Type.registerNamespace("Common.App.FirstRunExperienceLauncher");jd.main();Type.registerNamespace("Common.App.InsertFile");Type.registerNamespace("Common.App.InsertPicture");
(function(){la.a.Ga(function(T){Tc.ja(T)})})();(function(){la.a.Ga(function(T){Pc.ja(T)})})();(function(){la.a.Ga(function(){la.a.Ga(Eb.ja)})})();(function(){la.a.Ga(function(){la.a.Ga(Kb.ja)})})();(function(){la.a.Ga(function(T){Sb.ja(T)})})();Ue.a.Yi(".insert-media-dialog-old{width:870px;float:left;margin-top:7px}.insert-media-dialog{width:870px;width:clamp(400px,870px,80vw);float:left;margin-top:7px}.app-rtl .insert-media-dialog{float:right}.insert-media-frame{width:100%;height:100%;visibility:visible}.insert-media-panel-old{height:550px}.insert-media-panel{height:550px;height:clamp(300px,550px,90vh)}.keep-focus-start{position:absolute;width:-1000px;top:-1000px}.keep-focus{position:absolute;width:-1000px;top:1000px}.display-none{display:none}.padding-zero{padding:0}");
la.a.Ga(w.ja);la.a.Ga(c.ja);(function(){la.a.Ga(function(T){a.ja(T)})})()},992:function(y,D,b){function a(A){var x=this;this.businessBar=this.D6a=null;this.qzi=function(t,z){z.g5c?x.szi(z):x.rzi(z)};this.Zh=function(t,z){t=z.context.methodName;x.D6a&&t===x.D6a&&(k.ULS.sendTraceTag(537155230,0,50,'NetworkConnectionHealthChecker.OnWebMethodSuccess: Failed web method "{0}" has now succeeded. Querying local storage for BB showings.',x.D6a),x.X6a(a.eIb,!0),x.D6a=null);x.bjf(!1);x.M1b=!1};this.Xo=function(t,
z){l.a.gh(z.errors,[-1387426400])&&!x.M1b&&(x.M1b=!0,x.dZf()&&window.performance.mark(a.Zpf),(new d(x)).qji())};this.Rg=function(){x.bjf(!0);x.X6a(a.cBb,!1);x.X6a(a.eIb,!1)};this.Txa=function(){k.ULS.sendTraceTag(537155225,0,50,"NetworkConnectionHealthChecker.OnNetworkResumed: Network resumed for session. Querying local storage for BB showings.");x.X6a(a.cBb,!0)};this.$=A;this.qa=this.$.qa;this.localStorage=new u.a;this.M1b=!1;this.$.fa.sn(this.Rg);this.qa.uf.nmb(this.Txa);this.qa.us(this.Zh);this.$.da.Za(5,
function(t){x.businessBar=t;t.szg(x.qzi)});this.qa.FB(this.Xo)}function d(A){var x=this;this.fid=[v.a.zdg,v.a.RBc];this.zo=function(t,z){x.zN[z]=t;x.WZh()&&x.y8i("OnNetworkDownImmediatePing"===t.caller)};this.Xka=A;this.$=A.$;this.zN={}}function c(){this.scenario=null;this.timeElapsed=0;this.isNewSession=!1;this.rawData=null}b.r(D);y=b(0);var k=b(13),n=b(315),l=b(27),f=b(8),u=b(304);Object(y.a)(c,"ConnectionErrorLogInfo",null,[]);var v=b(1215),m=b(1262);d.prototype.qji=function(){var A=m.a.Iad(this.zo,
"OnNetworkDownImmediatePing",this.$,this.fid);A=yl(A);for(var x=A.next();!x.done;x=A.next())x.value.HJd()};d.prototype.WZh=function(){for(var A=yl(this.fid),x=A.next();!x.done;x=A.next())if(x=x.value,void 0===this.zN[x]||null===this.zN[x])return!1;return!0};d.prototype.y8i=function(A){var x=this.$.uf.kV;A&&this.syj(x);A=yl(this.fid);for(var t=A.next();!t.done;t=A.next())t=t.value,this.zN[t]=Sys.Serialization.JavaScriptSerializer.serialize(this.zN[t]);A=Date.now();t=this.Xka.qfd(b(992).NetworkConnectionHealthChecker.cBb).returnValue;
var z=this.Xka.qfd(b(992).NetworkConnectionHealthChecker.eIb).returnValue;this.zN.isOfflineMode=x;this.zN.networkDownBBAge=-1===t?t:A-t;this.zN.transientServerCommunicationFailuresBBAge=-1===z?z:A-z;this.Xka.businessBar?(this.zN.isNetworkDownBBShown=this.Xka.businessBar.MB(54).toString(),this.zN.isServerErrorBBShown=this.Xka.businessBar.MB(21).toString()):(this.zN.isNetworkDownBBShown="unknown",this.zN.isServerErrorBBShown="unknown");k.ULS.sendTraceTag(537155224,0,50,"ConnectionHealthTestsRunner.ReportPingResults: {0}",
Sys.Serialization.JavaScriptSerializer.serialize(this.zN))};d.prototype.syj=function(A){for(var x=b(992).NetworkConnectionHealthChecker,t={},z=yl(Object.keys(this.zN)),r=z.next();!r.done;r=z.next())r=this.zN[r.value],t[r.testName]=r.isSuccess;t.isOfflineMode=A;this.Xka.jRd(x.s0c,Sys.Serialization.JavaScriptSerializer.serialize(t))};Object(y.a)(d,"ConnectionHealthTestsRunner",null,[]);b.d(D,"NetworkConnectionHealthChecker",function(){return a});a.prototype.dispose=function(){this.$&&(this.$.fa&&this.$.fa.hr(this.Rg),
this.qa&&(this.qa.uf.lGb(this.Txa),this.qa.VC(this.Xo),this.qa.Lt(this.Zh)))};a.prototype.szi=function(A){var x={};x.Timestamp=Date.now().toString();switch(A.bob){case 21:this.D6a=A.data.FailedMethod;x.FailedMethod=this.D6a;this.jRd(a.eIb,JSON.stringify(x));break;case 54:this.jRd(a.cBb,JSON.stringify(x))}};a.prototype.rzi=function(A){switch(A.bob){case 21:this.X6a(a.eIb,!0);break;case 54:this.X6a(a.cBb,!0)}};a.prototype.jRd=function(A,x){try{this.localStorage.og()&&this.localStorage.setItem(A,x)}catch(t){k.ULS.sendTraceTag(537155231,
0,15,"NetworkConnectionHealthChecker.StoreDataInLocalStorage: Failed to set item to local storage. reason: {0}",t.message||"Unknown")}};a.prototype.qfd=function(A){if(this.localStorage.og()&&(A=this.localStorage.K2a(A))&&"null"!==A){var x=JSON.parse(A);A=parseInt(x.Timestamp);x=Sys.Serialization.JavaScriptSerializer.serialize(x);return{returnValue:A,rawData:x}}return{returnValue:-1,rawData:null}};a.prototype.bjf=function(A){if(this.localStorage.og()){var x=this.localStorage.K2a(a.s0c);if(x&&"null"!==
x){var t=-1;this.M1b&&(t=this.NHh(a.Zpf,a.eyi));k.ULS.sendTraceTag(537155229,0,50,"NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: Ping Results: {0}, Period offline: {1}, New session: {2}",Sys.Serialization.JavaScriptSerializer.serialize(x),t,A);this.localStorage.removeItem(a.s0c)}}};a.prototype.NHh=function(A,x){if(!this.dZf())return-1;window.performance.measure(x,A);A=window.performance.getEntriesByName(x);return A.length&&A[A.length-1]?A[A.length-1].duration:(k.ULS.sendTraceTag(537155228,
0,10,"NetworkConnectionHealthChecker.LogPingResultsFromLocalStorage: measure name {0} returned no measures.",x),-1)};a.prototype.X6a=function(A,x){try{var t=this.qfd(A);var z=t.rawData;var r=t.returnValue;if(-1!==r){var G=Object.assign(new c,{timeElapsed:Date.now()-r,scenario:A,isNewSession:!x,rawData:z});k.ULS.sendTraceTag(537155227,0,50,"NetworkConnectionHealthChecker.LogNetworkIssueBBShown: {0}",JSON.stringify(G))}this.localStorage.removeItem(A)}catch(w){k.ULS.sendTraceTag(537155226,0,15,"NetworkConnectionHealthChecker.LogNetworkIssueBBShown: Failed to get item from local storage. reason: {0}",
w.message||"Unknown")}};a.prototype.dZf=function(){return f.HelperMethods.MWc&&n.a.Snb};a.cBb="NetworkDownBBShown";a.eIb="ServerCommunicationFailureBBShown";a.s0c="ConnectionHealthPingRsults";a.Zpf="offMoStMa";a.eyi="offMoDuMea";Object(y.a)(a,"NetworkConnectionHealthChecker",null,[3])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.pi.js.map/31cfb92aa5eb6aeae36d1f459da533aa/EwaDS.pi.js.map