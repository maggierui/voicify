(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[32],{1390:function(y,D,b){function a(gc){return ne.call(this,gc)||this}function d(gc){this.$=gc}function c(gc){var fd=ue.call(this)||this;fd.$=gc;fd.dc();return fd}function k(gc,fd,vd,se,Jc){var Bc=ee.call(this)||this;Bc.statusBarManager=null;Bc.DWc=!1;Bc.D9=null;Bc.Zzc=!1;Bc.mLd=null;Bc.hxa=null;Bc.kBd=!1;Bc.fo=!1;Bc.lp=null;Bc.dbe=null;Bc.ffa=null;Bc.X$d=null;Bc.rDa=null;Bc.gIe=function(){da.ULS.sendTraceTag(537154520,306,
50,"PolicyManagerWrapper::EnableAutoLabellingInDocument - Triggered EnableAutoLabellingInDocument");var Ae=Bc.eKf(1);da.ULS.sendTraceTag(537154519,306,50,"PolicyManagerWrapper::EnableAutoLabellingInDocument - Annotation registration result: {0}.",Ae)};Bc.uPd=function(Ae,cb){cb?(Bc.lp=cb.title,Bc.dbe=cb.aoc,Bc.ffa=cb.buttonText,Bc.X$d=cb.hrf,Bc.KD.hg(27,null),da.ULS.sendTraceTag(537154509,306,50,"Add entry to BusinessBar succeeded. Message is shown to user.")):da.ULS.sendTraceTag(537154510,306,15,
"ShowPolicyBusinessBar is called but PolicyTipventArgs is null.")};Bc.o0f=function(Ae,cb){var mc=Object(Ce.a)(ia,cb);mc?mc.N_f?Bc.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CommonBusinessBarEntryForSensitivityLabelError",!1)?(da.ULS.sendTraceTag(537154508,306,15,"ShowSetPolicyLabelFailureInBusinessBar :: SetPolicyLabelFailure because of {0}",mc.errorType),Bc.KD.Otj(mc.title,mc.message,mc.buttonText,function(Oc){mc.hY&&(Bc.KD.MB(52)&&Bc.KD.removeEntry(52),mc.hY(Oc))})):1===mc.errorType?
(da.ULS.sendTraceTag(537154507,306,15,"ShowSetPolicyLabelFailureInBusinessBar :: SetPolicyLabelFailure because of File too large"),Bc.KD.hg(47,null)):2===mc.errorType?Bc.KD.hg(48,null):3===mc.errorType?Bc.KD.hg(49,null):4===mc.errorType?Bc.KD.hg(50,null):5===mc.errorType?Bc.KD.Ptj(mc.title,mc.message,mc.buttonText,function(Oc){Bc.KD.MB(51)&&Bc.KD.removeEntry(51);mc.hY(Oc)}):Bc.KD.hg(46,null):da.ULS.sendTraceTag(537154506,306,50,"ShowSetPolicyLabelFailureInBusinessBar :: SetPolicyLabelFailure ShowMessage is false"):
(da.ULS.sendTraceTag(537154505,306,10,"ShowSetPolicyLabelFailureInBusinessBar :: SetPolicyLabelFailure args is null"),Bc.KD.hg(46,null))};Bc.AVd=function(Ae,cb){Bc.c6&&(da.ULS.sendTraceTag(537154504,306,50,"PolicyManagerWrapper: UpdateLabelInfo called"),Bc.c6.wWf(),Bc.c6.OVf(),Bc.c6.FGf(),Bc.$.Fd&64&&(cb.onSuccess&&Bc.hxa?Bc.$Fg():Bc.c6.K6f()));Bc.ga.ra("SupportsOfficeClientCoauthoring")&&(Ae=Bc.fr.pn,Bc.rDa=Ae.AppliedPolicyId,"null"===Bc.labelId&&(Bc.rDa=""),Bc.Zzc&&(Ae=Ae.PolicyLabelAssignmentMethod&&
ub.c(Ae.PolicyLabelAssignmentMethod)===ub.c("standard")?4:2,Bc.applyPolicyLabel(Bc.labelId,Ae,!0,Bc.mLd)));Bc.sOe();Bc.gz()};Bc.Buf=function(){Bc.kBd=!0;Bc.sOe()};Bc.ozf=function(Ae,cb){da.ULS.sendTraceTag(42322116,306,50,"PolicyManagerWrapper.OnSetLabelSucceeded: Applying outcomes for change in policy label. ProtectedFile = {0}, ApplyLabelFlag = {1}",Fb.AFrameworkApplication.protectedFile,cb.cP);Bc.applyPolicyLabel(cb.$nc,cb.cP,!1,null)};Bc.Tyi=function(Ae,cb){Bc.rDa=cb.$nc;if(id.a.Pq(Ae.Errors)){var mc=
id.a.L$(Ae.Errors,[2045508683]);0<mc.length&&(Ae.Errors=id.a.jF(Ae.Errors,[2045508683],"PolicyManagerWrapper: OnApplyManualPolicyLabelSuccessCallback"),Bc.$.fa.Yo(Ae.Errors));mc=id.a.L$(Ae.Errors,[2046680228]);0<mc.length&&(4===cb.cP||1===cb.cP)&&(Ae.Errors=id.a.jF(Ae.Errors,[2046680228],"PolicyManagerWrapper: OnApplyManualPolicyLabelSuccessCallback"),Bc.$.fa.Yo(Ae.Errors));mc=Ae=null;for(var Oc=yl(Bc.fr.pn.SensitivityLabels),Sc=Oc.next();!Sc.done;Sc=Oc.next())Sc=Sc.value,Nb.a.equals(Bc.labelId,Sc.Id,
!1)&&(Ae=Sc),Nb.a.equals(cb.WTf,Sc.Id,!1)&&(mc=Sc);Oc={};Oc.ApplyLabelFlag=cb.cP;Ae?(Oc.currentLabel="Set",Oc.currentLabelEnabled=Ae.Enabled,Oc.currentLabelName=Ae.Name?"Set":"NotSet",Oc.currentLabelParentId=Ae.ParentId?"Set":"NotSet"):Oc.currentLabel="NotSet";mc?(Oc.serverLabel="Set",Oc.serverLabelEnabled=mc.Enabled,Oc.serverLabelName=mc.Name?"Set":"NotSet",Oc.serverLabelParentId=mc.ParentId?"Set":"NotSet"):Oc.serverLabel="NotSet";da.ULS.sendTraceTag(541638850,306,15,"PolicyManagerWrapper.OnApplyManualPolicyLabelSuccessCallback Failed. DiagnosticInfo : {0}",
JSON.stringify(Oc))}};Bc.eKg=function(Ae,cb){if(!Bc.$.workbookContext.HasRoundTrippedHFPart)return!1;var mc=Bc.fr.pn;if(!mc)return da.ULS.sendTraceTag(537154502,306,15,"PolicyManagerWrapper.BlockSetSensitivityCall: policyLabelsData is null."),!1;var Oc=null;mc=yl(mc.SensitivityLabels);for(var Sc=mc.next();!Sc.done;Sc=mc.next())Sc=Sc.value,Nb.a.equals(Sc.Id,Ae,!1)&&(Oc=Sc);return Oc&&Bc.h_h(Oc)?(da.ULS.sendTraceTag(50341186,306,50,"PolicyManagerWrapper.BlockSetSensitivityCall: selectedSensitivityLabel has watermark label action."),
Bc.vrj(cb),!0):!1};Bc.m8h=function(){var Ae=!1;!Bc.$.ya.IsNewWorkbook||Bc.labelId&&Bc.labelId.length||(Ae=!0);da.ULS.sendTraceTag(537154501,306,50,"PolicyManagerWrapper.IsANewFile: is this a new file : {0}",Ae);return Ae};Bc.olf=function(Ae,cb){1===cb.Dne?Bc.$.isEditMode?(da.ULS.sendTraceTag(537154500,306,50,"MandatoryLabellingHandler : Swtiching to view-mode."),Bc.$.Ka.Zb(new gb.a(-723527778,0,Bc.$.ed,10,null))):da.ULS.sendTraceTag(537154499,306,50,"MandatoryLabellingHandler : App is already in view-mode."):
(Bc.hxa=cb.hxa,Bc.$.fa.j9(Bc.Noe),Bc.$.Odb(),da.ULS.sendTraceTag(537154498,306,50,"MandatoryLabellingHandler : Swtiching to edit-mode."),Bc.$.Ka.Zb(new gb.a(-8805455,0,Bc.$.ed,10,null)))};Bc.rje=function(Ae,cb){cb?(Ae=!!(Bc.$.Fd&64),da.ULS.sendTraceTag(537154496,306,50,"AddMandatoryLabellingBusinessBar User has edit permission : {0}",Ae),Ae&&(Bc.$.Odb(),Bc.KD.Usj(cb.title,cb.message,cb.buttonText,function(mc){cb.hY(mc)}))):da.ULS.sendTraceTag(537154497,306,15,"AddMandatoryLabellingBusinessBar is called but MandatoryLabellingAppHandlerEventArgs is null.")};
Bc.vLf=function(){Bc.KD.MB(40)&&Bc.KD.removeEntry(40)};Bc.U7f=function(Ae,cb){cb.Epj&&(da.ULS.sendTraceTag(527716803,306,50,"PolicyManagerWrapper.udpLabelingAppHandler: Open the document in the client when the applied label is a UDP label."),Pd.TaskExtensions.Ba(Ad.GetServiceTaskFactory.Xa(Bc.$.da,55,56,0),function(mc){mc.result.M0c()},Bc.$.ma,3))};Bc.Noe=function(){Bc.hxa&&Bc.$.isEditMode?(Bc.$.fa.w6(Bc.Noe),Bc.y2a()):da.ULS.sendTraceTag(537154467,306,15,"ApplyMandatoryLabelOnEditMode : mandatoryPolicyId empty {0} , edit mode : {1}.",
!Bc.hxa,Bc.$.isEditMode)};Bc.mEj=function(){Bc.$.isEditMode?(Bc.$.fa.w6(Bc.mEj),Bc.y2a()):da.ULS.sendTraceTag(537154466,306,15,"TriggerDefaultLabelingOnModeChanged is not expected in View-mode. Mode.")};Bc.uja=function(){var Ae=Bc.$.fa.zn;Ae&&!Nb.a.equals(Ae.AppliedPolicyLabelId,Bc.labelId,!1)&&(da.ULS.sendTraceTag(537154464,306,50,"PolicyManagerWrapper.HandleWorkbookMetadataChanged: Calling GetPolicyLabels to update statusbar and ribbon control."),da.ULS.shipAssertTag(537154463,306,Bc.$.isEditMode,
"PolicyManagerWrapper.HandleWorkbookMetadataChanged policyId cannot change in read-only mode, this can happen if right policy id is not read from server."),Bc.ga.ra("SupportsOfficeClientCoauthoring")&&Bc.$.isEditMode&&(Bc.Zzc=!0,Bc.mLd=Ae.AppliedPolicyLabelId),Bc.rDa=Ae.AppliedPolicyLabelId,Bc.y2a())};Bc.Mld=function(){var Ae=!0;if(!Bc.$.fa.amIAlone)for(var cb=yl(Bc.$.fa.Em),mc=cb.next();!mc.done;mc=cb.next())if(!mc.value.SupportsClientIsMipTrusted){Ae=!1;break}da.ULS.sendTraceTag(537154462,306,50,
"PolicyManagerWrapper.IsEveryCoauthorInSessionClientMipTrusted : {0}",Ae);return Ae};Bc.Fvf=function(){da.ULS.sendTraceTag(537154461,306,50,"PolicyManagerWrapper.OnLabelUpdate: RTC notification received");Bc.Zzc=!0;Bc.y2a()};Bc.$=se;Bc.fr=gc;Bc.KD=vd;Bc.ga=Jc;Bc.fr.vle(Bc.uPd);Bc.c6=fd;return Bc}function n(gc){return Qc.call(this,gc,n.iQ(gc))||this}function l(gc,fd,vd,se,Jc){var Bc=rf.call(this)||this;Bc.Alf=3;Bc.augmentationLoopManager=null;Bc.aA=null;Bc.yYa=!1;Bc.$8a=[];Bc.xgf=new Lc.a(zd.a.JJ());
Bc.vCd=0;Bc.ACd=null;Bc.A2b=function(Ae,cb){Ae=Object.assign(new Of.a,{parentPath:["session","doc","security"],items:[Object.assign(new Yf.a,{id:"clp",body:Object.assign(new v,{existingLabelPriority:cb.existingLabelPriority,partialDocSITs:cb.hxe,fullDocSITs:cb.gxe})})]});Bc.$8a.push(Ae);Bc.ywb()};Bc.h9f=function(Ae,cb){Ae=Object.assign(new vg.a,{parentPath:["session","doc","security"],items:[Object.assign(new Yf.a,{id:"clp",body:Object.assign(new v,{existingLabelPriority:cb.existingLabelPriority})})]});
Bc.$8a.push(Ae);Bc.ywb()};Bc.i9f=function(Ae,cb){Ae=Object.assign(new vg.a,{parentPath:["session","doc","security"],items:[Object.assign(new Yf.a,{id:"clp",body:Object.assign(new v,{partialDocSITs:cb.hxe,fullDocSITs:cb.gxe})})]});Bc.$8a.push(Ae);Bc.ywb()};Bc.J5=function(){da.ULS.sendTraceTag(537154588,306,50,"AutoPolicyManager::OnApplicationModeChanged - isEditMode:{0}.",Bc.$.isEditMode);Bc.$.isEditMode?nc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)?Bc.ywb():
Bc.s7e():(Bc.businessBar.removeEntry(39),Bc.businessBar.removeEntry(38),Bc.e8g())};Bc.Nkc=function(){da.ULS.sendTraceTag(537154587,306,50,"AutoPolicyManager::OnAugmentationLoopSessionClose called.");Bc.uEe();Bc.augmentationLoopManager=null};Bc.Tii=function(Ae,cb){var mc,Oc,Sc,$c,le;da.ULS.sendTraceTag(537154586,306,50,"AutoPolicyManager::LabellingAnnotationHandler called.");if(3===cb.operationType)da.ULS.sendTraceTag(537154585,306,50,"AutoPolicyManager::LabellingAnnotationHandler Ignoring delete operation.");
else{var we=Ae=null,jc=null;if(Bc.Dkd()){var Zc=cb.bY;if(!Zc){da.ULS.sendTraceTag(537154584,306,50,"AutoPolicyManager::LabellingAnnotationHandler LabellingAnnotation is null.");return}if(null===(mc=Zc.automatic)||void 0===mc?0:mc.id)Ae=Zc.automatic.id;if(null===(Oc=Zc.recommended)||void 0===Oc?0:Oc.id)we=Zc.recommended.id,Zc.recommended.policyTip&&(jc=Zc.recommended.policyTip)}else{mc=cb.bY;if(!mc){da.ULS.sendTraceTag(537154583,306,50,"AutoPolicyManager::LabellingAnnotationHandler LabellingAnnotation is null.");
return}if(null===(Sc=null===(Zc=mc.automatic)||void 0===Zc?void 0:Zc.sensitivityLabel)||void 0===Sc?0:Sc.id)Ae=mc.automatic.sensitivityLabel.id;if(null===(le=null===($c=mc.recommended)||void 0===$c?void 0:$c.sensitivityLabel)||void 0===le?0:le.id)we=mc.recommended.sensitivityLabel.id,mc.recommended.sensitivityLabel.policyTip&&(jc=mc.recommended.sensitivityLabel.policyTip)}Bc.applyPolicyLabel(Ae,we,jc,1)}};Bc.Kki=function(Ae,cb){da.ULS.sendTraceTag(537154582,306,50,"AutoPolicyManager::LinkedDataTypeLabellingAnnnotationHandler - Handler called.");
3===cb.operationType?da.ULS.sendTraceTag(537154581,306,50,"AutoPolicyManager::LinkedDataTypeLabellingAnnnotationHandler - Received delete operation."):(Ae=cb.bY)?(Ae=Ae.classificationId,Bc.applyPolicyLabel(Ae,Ae,null,2)):da.ULS.sendTraceTag(537154580,306,50,"AutoPolicyManager::LinkedDataTypeLabellingAnnnotationHandler - Received an empty annotation.")};Bc.YKf=function(Ae,cb){cb?cb.kyb&&Bc.businessBar.MB(39)?(Bc.businessBar.removeEntry(39),da.ULS.sendTraceTag(537154562,306,50,"Remove entry to RecommendedSensitivityLabelBusinessBarEntry succeeded.")):
!cb.kyb&&Bc.businessBar.MB(38)&&(Bc.businessBar.removeEntry(38),da.ULS.sendTraceTag(537154561,306,50,"Remove entry to AutomaticSensitivityLabelBusinessBarEntry succeeded.")):da.ULS.sendTraceTag(537154563,306,15,"RemoveAutoPolicyBusinessBar is called but AddAutoPolicyBusinessBarEntryEventArgs is null.")};Bc.XZf=function(Ae,cb){cb?cb.kyb?(Bc.businessBar.Ftj(cb.title,cb.message,cb.buttonText,function(mc){cb.hY(mc);Bc.businessBar.MB(39)&&Bc.businessBar.removeEntry(39)}),da.ULS.sendTraceTag(537154531,
306,50,"Add entry to RecommendedSensitivityLabelBusinessBarEntry succeeded. Message is shown to user.")):(Bc.businessBar.trj(cb.title,cb.message,cb.buttonText,function(mc){cb.hY(mc);Bc.businessBar.MB(38)&&Bc.businessBar.removeEntry(38)}),da.ULS.sendTraceTag(537154530,306,50,"Add entry to AutomaticSensitivityLabelBusinessBarEntry succeeded. Message is shown to user.")):da.ULS.sendTraceTag(537154560,306,15,"ShowAutoPolicyBusinessBar is called but AddAutoPolicyBusinessBarEntryEventArgs is null.")};Bc.jBd=
gc;Bc.policyManager=fd;Bc.$=vd;Bc.ga=se;Bc.businessBar=Jc;Bc.z2h();Bc.f0i();Bc.disposed=!1;return Bc}function f(){var gc=Af.call(this)||this;gc.classificationId=null;gc.H_=Object.assign(new je.a,{T_:f.getTypeName(),B_:f.pe()});return gc}function u(){var gc=Lf.call(this)||this;gc.recommended=null;gc.automatic=null;gc.source=null;gc.H_=Object.assign(new je.a,{T_:u.getTypeName(),B_:u.pe()});return gc}function v(){var gc=m.call(this)||this;gc.existingLabelPriority=null;gc.H_=Object.assign(new je.a,{T_:v.getTypeName(),
B_:v.pe()});return gc}function m(){var gc=Uf.call(this)||this;gc.partialDocSITs=null;gc.fullDocSITs=null;gc.H_=Object.assign(new je.a,{T_:m.getTypeName(),B_:m.pe()});return gc}function A(){var gc=re.call(this)||this;gc.recommended=null;gc.automatic=null;gc.source=null;gc.H_=Object.assign(new je.a,{T_:A.getTypeName(),B_:A.pe()});return gc}function x(gc,fd,vd,se,Jc,Bc,Ae){Ae=gc.Oa(1,void 0===Ae?null:Ae);Ae.tenantId=fd;return Yd.i(gc,"GetPolicyApplicationMethod",Ae,vd,se,Jc,Bc,4)}function t(gc,fd,vd,
se,Jc,Bc,Ae){Ae=gc.Oa(1,void 0===Ae?null:Ae);Ae.tenantId=fd;return Yd.i(gc,"GetPolicyLabelId",Ae,vd,se,Jc,Bc,4)}function z(){this.bYa=this.annotationType=null;this.aLa=this.FE=!1}function r(){this.$nc=this.WTf=null;this.cP=0}function G(){this.Y0=this.jqa=this.rb=this.dh=null}function w(gc,fd,vd,se,Jc){se=void 0===se?0:se;Jc=void 0===Jc?null:Jc;this.jFc=this.R2d=null;this.Dqa=this.uhb=this.whb=0;this.L7="";this.mEa=this.cDc=this.e6d=this.Boa=this.IKc=null;this.G6d=!1;this.TBa=null;this.KHc=0;this.yTb=
this.oEa=this.XCa=this.xTb=null;this.Ya=new Mb.a;this.GIb=this.zub=this.jEa=null;this.wIc=!1;this.Dzb=null;this.ub=gc;this.Og=fd;this.uh=vd;this.wSb=se;this.pn=new ca;this.bbe=this.ub.Ua("PolicyHandlerEndpointName")||"PolicyHandler.ashx";this.uO=Jc;this.$wb=gc.ra("WacApplyManualPolicyLabelIsEnabled");this.fec=gc.ra("CoAuthForProtectedFilesIsEnabled");this.supportsOfficeClientCoauthoring=gc.ra("SupportsOfficeClientCoauthoring");this.lfi=!1;this.qkj=3E4;this.je=za.a.instance;gc.ra("SupportsPolicies")&&
Kb.a("MipSupportsPolicies");this.fec&&this.supportsOfficeClientCoauthoring&&Kb.a("MipSupportsOfficeClientCoauthoring")}function B(){}function U(gc,fd,vd,se,Jc,Bc,Ae,cb,mc,Oc,Sc,$c,le,we,jc,Zc,ud,Fd,me,$e,Df){this.url=gc;this.JNj=fd;this.body=vd;this.headers=se;this.Wbb=Jc;this.priority=Bc;this.state=Ae;this.bcg=void 0===cb?null:cb;this.sR=void 0===mc?null:mc;this.pV=void 0===Oc?!1:Oc;this.xWi=void 0===Sc?null:Sc;this.cgj=void 0===$c?null:$c;this.name=void 0===le?null:le;this.HDb=void 0===we?null:
we;this.S$c=void 0===jc?!1:jc;this.aCf=void 0===Zc?null:Zc;this.q7b=void 0===ud?null:ud;this.Ldc=void 0===Fd?null:Fd;this.Cab=void 0===me?null:me;this.B0h=void 0===$e?null:$e;this.responseType=void 0===Df?null:Df}function N(gc){var fd=Ic.call(this)||this;fd.Epj=gc;return fd}function P(gc){var fd=Jb.call(this)||this;fd.ZFg=gc;return fd}function ia(gc,fd,vd,se,Jc,Bc,Ae){se=void 0===se?null:se;Jc=void 0===Jc?null:Jc;Bc=void 0===Bc?null:Bc;Ae=void 0===Ae?null:Ae;var cb=Zb.call(this)||this;cb.errorType=
gc;cb.ZFg=fd;cb.N_f=vd;cb.title=se;cb.message=Jc;cb.buttonText=Bc;cb.hY=Ae;return cb}function W(gc,fd){var vd=db.call(this)||this;vd.$nc=gc;vd.cP=fd;return vd}function R(){return Ba.call(this)||this}function I(gc,fd){var vd=Wa.call(this)||this;vd.cob=gc;vd.kyb=fd;return vd}function Q(gc,fd,vd,se){var Jc=Za.call(this)||this;Jc.title=gc;Jc.aoc=fd;Jc.buttonText=vd;Jc.hrf=se;return Jc}function O(gc,fd){var vd=dc.call(this)||this;vd.hxa=gc;vd.Dne=fd;return vd}function ba(gc){gc=void 0===gc?!1:gc;var fd=
Xb.call(this)||this;fd.onSuccess=gc;return fd}function ca(){this.AreLabelsAvailable=!1;this.AppliedPolicyId=null;this.MandatoryLabelingEnforced=this.RequiredDowngradeJustification=!1;this.SensitivityLabels=this.PolicyLabelVersionToken=this.PolicyLabelAssignmentMethod=this.CustomUrl=this.DefaultLabelId=null;this.AreLabelsAvailable=!1;this.AppliedPolicyId="";this.RequiredDowngradeJustification=!1;this.PolicyLabelVersionToken=this.PolicyLabelAssignmentMethod=this.DefaultLabelId="";this.SensitivityLabels=
[];this.MandatoryLabelingEnforced=!1;this.CustomUrl=""}function S(){return $a.call(this)||this}function Y(gc){var fd=kb.call(this)||this;fd.$Rj=gc;return fd}function na(gc,fd,vd){var se=Ua.call(this)||this;se.hxe=gc;se.gxe=fd;se.existingLabelPriority=vd;return se}function Z(gc,fd,vd,se,Jc){var Bc=Ga.call(this)||this;Bc.cob=gc;Bc.title=fd;Bc.message=vd;Bc.buttonText=se;Bc.hY=Jc;return Bc}function wa(gc,fd,vd,se,Jc,Bc){var Ae=bb.call(this)||this;Ae.cob=gc;Ae.title=fd;Ae.message=vd;Ae.buttonText=se;
Ae.hY=Jc;Ae.kyb=Bc;return Ae}function ma(gc,fd,vd,se){this.UJc=this.VJc=null;this.lJc=this.EJc=this.eib=this.d9d=this.nFc=!1;this.jUa=this.Cea=this.xfa=this.Eoa=this.cSb=this.sv=this.H8=this.Ag=null;this.jDc=0;this.G3d=this.BJc=this.sDc=null;this.La=gc;this.Ie=fd;this.ub=vd;this.dh=se;this.Nib={};this.cbe={};this.e9d={};this.$wb=vd.ra("WacApplyManualPolicyLabelIsEnabled");this.dh.value.Nle(Object(ya.a)(this,this.TCd,"processAutoSensitivityLabel"));this.dh.value.ITc(Object(ya.a)(this,this.TCd,"processAutoSensitivityLabel"));
this.dh.value.oTc(Object(ya.a)(this,this.fMi,"onUpdateLabelInfo"));Fb.AFrameworkApplication.sa&&Fb.AFrameworkApplication.sa.jBg(Object(ya.a)(this,this.M_i,"refreshDocumentPolicyLabelsOnModeChange"));vd.ra("SupportsPolicies")&&vd.Ua("AppliedPolicyId")&&(this.VJc=vd.Ua("IrmPolicyTitle"),this.UJc=vd.Ua("IrmPolicyDescription"));this.eNc=vd.ra("ProtectedFile");this.Vgg=this.ub.zd("SetPolicyLabelAwaitFileExistsOnHostMaxRetries",6);this.Wgg=this.ub.zd("SetPolicyLabelAwaitFileExistsOnHostRetryDelayMs",5E3)}
function pa(){}function Ia(){this.aib=!!Fb.AFrameworkApplication.sa&&Fb.AFrameworkApplication.sa.Pa.Lu}function Ma(gc,fd,vd){var se=Fa.call(this,!1,!1,!0)||this;if(!gc||!vd)return da.ULS.sendTraceTag(560547850,306,10,"MandatoryLabelingDialog was triggered with invalid inputs"),se;var Jc={};Jc=(Jc.id="MandatoryLabellingDialog",Jc);se.jjg=vd;se.uKc=fd;if(!Fb.AFrameworkApplication.ga.ra("MandatoryLabelingDialogLearnMoreSwitchIsEnabled")||se.uKc&&""!==se.uKc)fd={},fd=(fd.href=se.uKc,fd.target="_blank",
fd),vd={},Jc.learnMoreLink=(vd.type="AppLinkProps",vd.id="mandatoryLabellingLearnMoreLink",vd.text=CommonUIStrings.l_LearnMore,vd.handler=fd,vd.customTooltip=CommonUIStrings.L_LearnMoreTooltip,vd);fd={};gc=(fd.id="mandatoryLabellingFlyoutMenuSection",fd.controls=gc,fd);fd={};fd=(fd.sections=[],fd.shouldAutoOpen=!1,fd);Array.add(fd.sections,gc);gc={};Jc.labelFlyout=(gc.type="AppFlyoutAnchorProps",gc.id="mandatoryLabellingFyout",gc.label="Pick a label",gc.hideLabel=!1,gc.hideChevron=!1,gc.hideIcon=
!0,gc.menuDefinition=fd,gc);gc={};gc=(gc.id="MandatoryLabellingDialog",gc.bodyControls=Jc,gc);Jc.initialLabelText=CommonUIStrings.l_MandatoryLabellingDialogInitialLabelText;Jc.descriptionText=CommonUIStrings.l_MandatoryLabellingDialogDescriptionText;se.initializeAndShow(CommonUIStrings.l_MandatoryLabellingDialogBusinessBarTitle,Object(ya.a)(se,se.Dqi,"mandatoryLabellingDialogHandler"),gc);return se}function ob(gc,fd){var vd=Yb.call(this,!1,!1,ob.gy)||this;vd.Dpa=[CommonUIStrings.l_SensitivityJustificationNoLongerApplies,
CommonUIStrings.l_SensitivityJustificationIncorrect,CommonUIStrings.l_SensitivityJustificationOther];vd.JTb=null;vd.ITb=!1;vd.Dde=gc;vd.wI=fd;vd.xf=vd.WLg();vd.kc=1;vd.Me=ob.id;vd.Cc(1,CommonUIStrings.l_DialogChange);vd.RK(1,!1);vd.Kma(0);return vd}function Cb(){}function Xa(gc,fd){this.cP=gc;this.displayName=fd}function Sb(gc,fd,vd){vd=void 0===vd?null:vd;this.id=gc.Id;vd||(vd="");this.PZi=vd;this.sensitivityLabel=gc}b.r(D);var Tb=b(0),da=b(13),ya=b(80),hb=b(991),Gb=b(185);Object(Tb.a)(Sb,"AutoPolicyLabelData",
null,[]);Object(Tb.a)(Xa,"PolicyLabelRequestState",null,[]);var Qb=b(140),Fb=b(5),ta=b(369),xa=b(12),sa=b(40),lb=b(28);tl.Object.defineProperties(Cb,{Qpd:{configurable:!0,enumerable:!0,get:function(){return Cb.vii}}});Cb.vii="<div class='WACDialogRow' id='JustificationMessageBlock'> <div class='WACDialogIcon' id='JustificationIconArea'> <div class='clip32x32' id='JustificationIconClip' unselectable='on' style='z-index: 0; display: inline-block;'> <img id='iconJustification' class='{1}' role='presentation' src={0} /> </div> </div> <div class='WACDialogTextPanel WACJustificationDialogMessage' id='JustificationMessageArea'> <label id='messageJustification' class='WACDialogLabel' >{2}</label> </div> </div> <br/> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock0'> <input type='radio' id='radiobox0' name='ListRadioBox' class='WACDialogRadio' alt='{3}' title='{3}'></input> <label id='JustificationDlgList0' class='WACDialogLabel' for='radiobox0' >{3}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock1'> <input type='radio' id='radiobox1' name='ListRadioBox' class='WACDialogRadio' alt='{4}' title='{4}'></input> <label id='JustificationDlgList1' class='WACDialogLabel' for='radiobox1' >{4}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow' id='JustificationDlgBlock2'> <input type='radio' id='radiobox2' name='ListRadioBox' class='WACDialogRadio' alt='{5}' title='{5}'></input> <label id='JustificationDlgList2' class='WACDialogLabel' for='radiobox2' >{5}</label> </div> <div class='WACDialogTextPanel WACJustificationDialogRow WACJustificationDialogTextAreaRow' id='JustificationTextAreaBlock'> <textarea id='txtJustification' class='JustificationTextArea' placeholder='{6}' style='border:solid 1px grey;resize:none;' autocomplete=\"off\"></textarea> </div>";
Object(Tb.a)(Cb,"JustificationDialogHtml",null,[]);var Yb=Qb.a;vm(ob,Yb);ob.prototype.kPd=function(){if(ob.gy)this.initializeAndShow(CommonUIStrings.l_SensitivityJustificationTitle,Object(ya.a)(this,this.sIf,"reactJustificationDialogHandler"),this.NZe(this.ITb));else{for(var gc={},fd=0;fd<this.Dpa.length;fd++)gc[ob.ADd+fd]=!1;gc[ob.dLb]="";this.initializeAndShow(CommonUIStrings.l_SensitivityJustificationTitle,Object(ya.a)(this,this.uii,"justificationDialogHandler"),gc);this.B0i();sa.a.addHandler($get(ob.dLb),
xa.a.input,Object(ya.a)(this,this.XAj,"textAreaHandler"))}};ob.prototype.validate=function(){if(ob.gy)return this.lbg(this.JTb);var gc=$get(ob.dLb);return gc.disabled?!0:this.lbg(gc.value)};ob.prototype.lbg=function(gc){var fd=2>gc.length,vd=500<gc.length,se=RegExp("[{|}|;|\\\\]").test(gc);gc=""===lb.a.aqc(gc);return!fd&&!vd&&!se&&!gc};ob.prototype.uii=function(gc,fd){var vd="";if(1===gc)for(var se=0;se<this.Dpa.length;se++)if(fd[ob.ADd+se]){vd=se===this.Dpa.length-1?fd[ob.dLb]:this.Dpa[se];break}this.wI(gc,
this.Dde,vd)};ob.prototype.sIf=function(gc){var fd="";1===gc&&this.JTb&&(fd=this.JTb);this.wI(gc,this.Dde,fd)};ob.prototype.$Fi=function(gc){this.JTb=gc;gc=this.validate();this.ITb!==gc&&(this.ITb=gc,this.zzc(CommonUIStrings.l_SensitivityJustificationTitle,Object(ya.a)(this,this.sIf,"reactJustificationDialogHandler"),this.NZe(this.ITb)))};ob.prototype.NZe=function(gc){var fd={},vd={},se={},Jc={};return Jc.id=this.Me,Jc.bodyControls=(vd.choiceGroupProps={},vd.textAreaProps=(fd.placeholder=CommonUIStrings.l_SensitivityJustificationPlaceholder,
fd),vd),Jc.actionButtonProps=(se.label=CommonUIStrings.l_DialogChange,se.disabled=!gc,se),Jc.infoMessage=CommonUIStrings.l_SensitivityJustificationMessage,Jc.justificationIrrelevantLabel=CommonUIStrings.l_SensitivityJustificationNoLongerApplies,Jc.justificationIncorrectLabel=CommonUIStrings.l_SensitivityJustificationIncorrect,Jc.justificationOtherLabel=CommonUIStrings.l_SensitivityJustificationOther,Jc.onJustificationUpdated=Object(ya.a)(this,this.$Fi,"onJustificationUpdated"),Jc};ob.prototype.XAj=
function(gc){gc.target&&this.RK(1,this.validate())};ob.prototype.WLg=function(){return Qb.a.jj(ob.Qpd,Fb.AFrameworkApplication.pC,ta.getImageClass(ob.iconName),CommonUIStrings.l_SensitivityJustificationMessage,this.Dpa[0],this.Dpa[1],this.Dpa[2],CommonUIStrings.l_SensitivityJustificationPlaceholder)};ob.prototype.B0i=function(){for(var gc=document.getElementsByName(ob.Nki),fd=0;fd<gc.length;fd++)sa.a.addHandler(gc[fd],xa.a.focus,Object(ya.a)(this,this.$Gf,"radioButtonFocusHandler")),sa.a.addHandler(gc[fd],
xa.a.click,Object(ya.a)(this,this.$Gf,"radioButtonFocusHandler"))};ob.prototype.$Gf=function(gc){if(gc=gc.target){gc.checked=!0;var fd=$get(ob.dLb);gc.id===ob.ADd+(this.Dpa.length-1)?(fd.disabled=!1,Sys.UI.DomElement.setVisible(fd,!0),fd.focus()):(fd.disabled=!0,gc.focus());this.RK(1,this.validate())}};tl.Object.defineProperties(ob,{gy:{configurable:!0,enumerable:!0,get:function(){return Fb.AFrameworkApplication.sa.Pa.Lu&&Fb.AFrameworkApplication.sa.Pa.Vcf}}});ob.Qpd=Cb.Qpd;ob.Nki="ListRadioBox";
ob.ADd="radiobox";ob.dLb="txtJustification";ob.iconName="Info_32x32x32";ob.id="JustificationDialog";Object(Tb.a)(ob,"JustificationDialog",Qb.a,[]);var Fa=Qb.a;vm(Ma,Fa);Ma.prototype.Dqi=function(gc,fd){1===gc&&fd.selectedLabel&&(gc=fd.selectedLabel,""!==gc&&this.jjg(gc))};Object(Tb.a)(Ma,"MandatoryLabellingDialog",Qb.a,[]);Ia.prototype.R2g=function(gc,fd,vd){this.aib&&new Ma(gc,fd,vd)};tl.Object.defineProperties(Ia,{instance:{configurable:!0,enumerable:!0,get:function(){return Ia.Na||(Ia.Na=new Ia)}}});
Ia.Na=null;Object(Tb.a)(Ia,"MandatoryLabellingDialogFactory",null,[378]);pa.Vxj="sbProtectForm14";pa.Xxj="SBStatusBarMarkAsReadOnly14";pa.Zji="Info_16x16x32";pa.Nob="QuickSearchCompletedToday_16x16x32";pa.$Dd="CommonControlCheckboxCheck_16";pa.Q5f="On";pa.visible="Visible";pa.ixh="ImageIsVisible";pa.bI="SourceControlId";pa.menuItemId="MenuItemId";pa.menu="Menu";pa.zUc="AppLockId";pa.value="Value";pa.Bi="LabelText";pa.alt="Alt";pa.R6e="Image16by16";pa.l4a="Image16by16Class";pa.Uxj="SBProtectForm_16";
pa.Wxj="SBStatusBarMarkAsReadOnly_16";pa.icon="Icon";pa.iconColor="IconColor";pa.customTooltip="CustomTooltip";pa.UYi="MipTagDynamicFillWithOutline_20";pa.VYi="MipTagLockDynamicFillWithOutline_20";pa.TYi="MipTagErrorOutline_20";pa.WYi="MipTagQuestionOutline_20";pa.STd="transparent";Object(Tb.a)(pa,"PolicyConstants",null,[]);var Sa=b(998),Ra=b(845),Lb=b(823),Ja=b(914),xb=b(93),Kb=b(176),Eb=b(892),Hc=b(864),Xc=b(168),Pc=b(949),wd=b(128),Tc=b(89),ub=b(193),fb=b(808),Ta=b(86),eb=b(108),tb=b(29),rc=b(55);
ma.prototype.Mg=function(){this.La.$b(tb.a.yBf,eb.a.frame,Object(ya.a)(this,this.lGe,"documentLabelPaneHandler"));this.La.hf(tb.a.f$a,eb.a.frame,Object(ya.a)(this,this.f$a,"queryPolicyLabel"),96);this.La.$b(tb.a.lSa,eb.a.frame,Object(ya.a)(this,this.lSa,"toggleSensitivity"));this.La.$b(tb.a.vya,eb.a.frame,Object(ya.a)(this,this.vya,"populateSensitivityFlyout"));this.La.$b(tb.a.setSensitivity,eb.a.frame,Object(ya.a)(this,this.setSensitivity,"setSensitivity"));this.La.hf(tb.a.g$a,eb.a.frame,Object(ya.a)(this,
this.g$a,"querySensitivity"),96);this.La.$b(tb.a.j6,eb.a.frame,Object(ya.a)(this,this.j6,"querySensitivityToggleButton"));this.La.$b(tb.a.i6,eb.a.frame,Object(ya.a)(this,this.i6,"querySensitivitySubFlyout"));this.slb(tb.a.lSa)||this.La.jbb(tb.a.lSa,4);this.slb(tb.a.vya)||this.La.jbb(tb.a.vya,4);this.slb(tb.a.setSensitivity)||this.La.jbb(tb.a.setSensitivity,4);this.slb(tb.a.j6)||this.La.jbb(tb.a.j6,4);this.slb(tb.a.i6)||this.La.jbb(tb.a.i6,4);this.Ie.updateCommandUI()};ma.prototype.XLb=function(){this.La.QC(tb.a.yBf,
eb.a.frame,Object(ya.a)(this,this.lGe,"documentLabelPaneHandler"));this.La.QC(tb.a.f$a,eb.a.frame,Object(ya.a)(this,this.f$a,"queryPolicyLabel"));this.La.QC(tb.a.lSa,eb.a.frame,Object(ya.a)(this,this.lSa,"toggleSensitivity"));this.La.QC(tb.a.vya,eb.a.frame,Object(ya.a)(this,this.vya,"populateSensitivityFlyout"));this.La.QC(tb.a.setSensitivity,eb.a.frame,Object(ya.a)(this,this.setSensitivity,"setSensitivity"));this.La.QC(tb.a.g$a,eb.a.frame,Object(ya.a)(this,this.g$a,"querySensitivity"));this.La.QC(tb.a.j6,
eb.a.frame,Object(ya.a)(this,this.j6,"querySensitivityToggleButton"));this.La.QC(tb.a.i6,eb.a.frame,Object(ya.a)(this,this.i6,"querySensitivitySubFlyout"))};ma.prototype.lSa=function(){return 32};ma.prototype.XTe=function(gc){var fd="mandatoryLabelling_"+gc.Id;this.e9d[fd]=gc.Id;var vd={};return vd.type="AppToggleButtonProps",vd.id=fd,vd.label=gc.DisplayName,vd.hideLabel=!1,vd.customTooltip=gc.Tooltip,vd};ma.prototype.gMh=function(){var gc=[],fd=this.H8,vd;for(vd in fd){var se=fd[vd],Jc=this.sv[vd];
if(Jc&&Jc.Enabled)if(se.count){var Bc={};Bc=(Bc.sections=[],Bc.shouldAutoOpen=!1,Bc);var Ae={};Ae=(Ae.id="mandatoryLabelling_flyoutMenuSection_"+Jc.Id,Ae.controls=[],Ae);se=yl(se);for(var cb=se.next();!cb.done;cb=se.next())(cb=this.sv[cb.value])&&cb.Enabled&&Array.add(Ae.controls,this.XTe(cb));Array.add(Bc.sections,Ae);Ae={};Jc=(Ae.type="AppFlyoutAnchorProps",Ae.id="mandatoryLabelling_"+Jc.Id,Ae.label=Jc.DisplayName,Ae.hideLabel=!1,Ae.hideChevron=!1,Ae.hideIcon=!1,Ae.menuDefinition=Bc,Ae);Array.add(gc,
Jc)}else Array.add(gc,this.XTe(Jc))}return gc};ma.prototype.vya=function(gc,fd,vd,se,Jc){if(1===vd||!this.dh.value.zga(!0))return 32;Jc.MenuItems=Object.assign(new Eb.a,{Id:"SensitivityList",MenuSectionList:[],UpdateDynamically:!0});Array.add(Jc.MenuItems.MenuSectionList,this.Lc(!this.isReactRibbonEnabled()));this.Ag.CustomUrl&&Array.add(Jc.MenuItems.MenuSectionList,this.I2g(this.isReactRibbonEnabled()?this.Ag.CustomUrl:lb.a.Mf(this.Ag.CustomUrl)));this.isReactRibbonEnabled()||(Jc.PopulationXML=Lb.s(Jc.MenuItems));
return 32};ma.prototype.g$a=function(gc,fd,vd,se,Jc){if(1===vd||!Jc||!this.$wb)return 32;this.Ag=this.dh.value.pn;if(this.dh.value.zga(!0)&&(Jc[pa.visible]=!0,Kb.a("MipLabelsAvailable"),this.ub.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelTUIEnabled",!1)&&this.Ag&&this.Ag.AreLabelsAvailable&&(gc=Ta.a.instance.mc("Common.ISystemInitiatedFeedback")))){var Bc=ma.yj(this.Ag.AppliedPolicyId)?"LouderLabel_NoLabelAppliedOnLoadActivity":"LouderLabel_LabelExistsOnLoadActivity";gc.execute(function(Ae){Ae.logActivity(Bc,
null)})}return 32};ma.prototype.j6=function(gc,fd,vd,se,Jc){if(1===vd||!Jc)return 32;var Bc,Ae;Jc[pa.Q5f]=!!(Bc=Jc[pa.menuItemId])&&!!(Ae=this.Nib[Bc])&&Ae===this.Ag.AppliedPolicyId;return 32};ma.prototype.i6=function(gc,fd,vd,se,Jc){if(1===vd||!Jc)return 32;var Bc,Ae,cb;gc=!!(Bc=Jc[pa.bI])&&!!(Ae=this.Nib[Bc])&&!!(cb=this.H8[Ae])&&cb.contains(this.Ag.AppliedPolicyId);Jc[pa.ixh]=gc;Jc[pa.Q5f]=gc;return 32};ma.prototype.setSensitivity=function(gc,fd,vd,se,Jc){return 1!==vd&&Jc?this.zbb(this.Nib[Jc[pa.bI]],
Jc,2):32};ma.prototype.xec=function(){return this.ub.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DefaultAndMandatoryLabelingDecouplingEnabled",!1)&&!!Fb.AFrameworkApplication.sa&&1===Fb.AFrameworkApplication.sa.mode};ma.prototype.M_i=function(){this.lJc&&!this.xec()&&(this.lJc=!1,this.dh.value.L_i())};ma.prototype.K6f=function(){this.Ag.DefaultLabelId&&this.Ag.MandatoryLabelingEnforced?this.nFc||this.xec()?this.Ag.AppliedPolicyId?this.v6b(""):(this.dh.value.vei(this.dh.value.Dzb)||this.xec())&&
this.B6c():this.QLd():this.Ag.DefaultLabelId?this.QLd():this.Ag.MandatoryLabelingEnforced&&(this.Ag.AppliedPolicyId?this.v6b(""):this.B6c())};ma.prototype.wEj=function(){this.Ag.MandatoryLabelingEnforced?this.Ag&&this.Ag.AreLabelsAvailable?this.ub.ra("TestOverrideIsReactDialogEnabled")||this.Ie&&this.Ie.Pa&&this.Ie.Pa.Lu?""===this.Ag.AppliedPolicyId?!this.ub.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DefaultAndMandatoryLabelingDecouplingEnabled",!1)&&this.Ag.DefaultLabelId&&(this.ub.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DefaultLabelingExistingDocumentIsEnabled",
!1)||this.MLa)?da.ULS.sendTraceTag(572601948,306,50,"Mandatory labelling not invoked b/c default label policy present!"):this.B6c():this.v6b(""):da.ULS.sendTraceTag(572641315,306,50,"Mandatory labelling not invoked b/c react dialogs disabled!"):da.ULS.sendTraceTag(572601946,306,50,"Mandatory labelling not invoked b/c there are no sensitivity labels!"):da.ULS.sendTraceTag(572601945,306,50,"Mandatory labelling not invoked b/c user did not have policy!")};ma.prototype.Fbf=function(){return this.Ag.MandatoryLabelingEnforced?
this.Ag&&this.Ag.AreLabelsAvailable?this.ub.ra("TestOverrideIsReactDialogEnabled")||this.Ie&&this.Ie.Pa&&this.Ie.Pa.Lu?!0:(da.ULS.sendTraceTag(539109065,306,50,"Mandatory labelling not invoked b/c react dialogs disabled!"),!1):(da.ULS.sendTraceTag(539109064,306,50,"Mandatory labelling not invoked b/c there are no sensitivity labels!"),!1):(da.ULS.sendTraceTag(539109063,306,50,"Mandatory labelling not invoked b/c user did not have policy!"),!1)};ma.prototype.B6c=function(){var gc=this;this.ub.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DefaultAndMandatoryLabelingDecouplingEnabled",
!1)&&!this.Fbf()||Fb.AFrameworkApplication.O4||this.d9d||(this.d9d=Fb.AFrameworkApplication.O4=!0,da.ULS.sendTraceTag(562837517,306,50,"Mandatory labelling is invoked successfully."),this.dh.value.tHf("",1),this.dh.value.uSc(37,CommonUIStrings.l_MandatoryLabellingDialogBusinessBarTitle,CommonUIStrings.l_MandatoryLabellingDialogDescriptionText,CommonUIStrings.l_MandatoryLabellingDialogBusinessBarButton,function(){gc.Bqi()}))};ma.prototype.v6b=function(gc){this.ub.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DefaultAndMandatoryLabelingDecouplingEnabled",
!1)&&!this.Fbf()||!Fb.AFrameworkApplication.O4||(Fb.AFrameworkApplication.O4=!1,da.ULS.sendTraceTag(562837518,306,50,"Mandatory labelling is escaped successfully."),this.dh.value.gGd(),this.dh.value.tHf(gc,2))};ma.prototype.Bqi=function(){Ia.instance.R2g(this.gMh(),this.Ag.CustomUrl,Object(ya.a)(this,this.Cqi,"mandatoryLabellingDialogCallback"))};ma.prototype.Cqi=function(gc){this.v6b(this.e9d[gc])};ma.prototype.Bqe=function(){return this.ub.ra("CoAuthForProtectedFilesEnabled")&&this.ub.ra("SupportsOfficeClientCoauthoring")&&
this.ub.ra("SetPolicyLabelAwaitFileExistsOnHostIsEnabled")&&!!this.G3d&&this.MLa};ma.prototype.zbb=function(gc,fd,vd){var se=this;this.dh.value.BXi(vd);var Jc=32,Bc=!1,Ae=!0,cb=2===vd||8===vd||16===vd,mc=gc===this.Ag.AppliedPolicyId;if(this.sDc&&this.sDc(gc,cb))da.ULS.sendTraceTag(42860829,306,15,"SetSensitivity : As app doesn't support changing the label, skipping SetSensitivity call. ApplyLabelFlag : {0}",vd),this.Ie.updateCommandUI();else if(fd&&pa.zUc in fd&&this.dh.value.Djj(fd[pa.zUc]),gc)if(this.dh.value.Mdf()||
this.Bqe()&&this.EJc)da.ULS.sendTraceTag(42796168,306,50,"Policy label cannot be set because a set policy label request is already in progress. ApplyLabelFlag: {0}",vd),this.Ie.updateCommandUI(),cb&&this.yYb(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityQuickApplicationErrorMessage);else if(this.ub.ra("HasDocumentEditRights"))if(this.dh.value.fQg(gc))if(this.ub.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LabelHasUDPEnabled",!1)&&this.sv[gc]&&this.sv[gc].HasUserDefinedPermissions&&
!mc)da.ULS.sendTraceTag(540608323,306,50,"UDP label cannot be applied during UDP in WAC Phase 1. ApplyLabelFlag: {0}",vd),1!==vd&&4!==vd&&this.fEg();else if(cb&&this.Ag.MandatoryLabelingEnforced&&mc)da.ULS.sendTraceTag(570972054,306,50,"Policy label cannot be removed due to mandatory labeling. ApplyLabelFlag: {0}",vd),this.yYb(CommonUIStrings.l_MandatoryLabellingBlockLabelRemovalDialogTitle,CommonUIStrings.l_MandatoryLabellingBlockLabelRemovalDialogDescriptionText);else{if(cb&&this.ub.ra("WacLabelingJustificationDialogIsEnabled")&&
this.Ag.RequiredDowngradeJustification&&(mc||this.sv[gc].RequiredDowngradeJustification)&&!this.cSb)return da.ULS.sendTraceTag(570972055,306,50,"Downgrade justification is required. ApplyLabelFlag: {0}",vd),this.kPd(gc),Jc;if(this.Bqe()&&!this.G3d())this.jDc<this.Vgg?(da.ULS.sendTraceTag(577356770,306,50,"File does not exist on host, retrying after delay. RetryCount: {0} ApplyLabelFlag: {1}",this.jDc,vd),this.EJc=!0,this.jDc++,rc.Task.delay(this.Wgg).continueWith(function(){se.EJc=!1;se.zbb(gc,fd,
vd)})):(da.ULS.sendTraceTag(577356771,306,15,"Policy label cannot be set because maximum retries were reached checking for file existence. ApplyLabelFlag: {0}",vd),Bc=1!==vd,Ae=!1,Jc=8);else{if(this.ub.getBooleanFeatureGate("Microsoft.Office.SharedOnline.WacBlockParentLabelSetLabel",!1)&&this.kdi(gc)&&(da.ULS.sendTraceTag(553911752,306,15,"Policy label cannot be set because the selected label is a parent label. ApplyLabelFlag: {0}",vd),1===vd||8===vd||4===vd))return Jc;da.ULS.sendTraceTag(570972056,
306,50,"SetSensitivityByPolicyId is succeeded. ApplyLabelFlag: {0}",vd);this.setPolicyLabel(mc?"":gc,this.cSb,vd);return Jc}}else da.ULS.sendTraceTag(42796169,306,50,"Policy label cannot be set because the user is in a coauth session. ApplyLabelFlag: {0}",vd),this.Ie.updateCommandUI(),cb&&this.yYb(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityCoauthApplicationErrorMessage);else da.ULS.sendTraceTag(558892739,306,50,"Policy label cannot be set because the user doesn't have edit rights. ApplyLabelFlag: {0}",
vd),this.Ie.updateCommandUI(),cb&&this.yYb(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityNoEditRightsErrorMessage);else da.ULS.sendTraceTag(42796167,306,15,"Policy label cannot be set because the selected policy ID is null. ApplyLabelFlag: {0}",vd),this.Ie.updateCommandUI(),Bc=cb,Ae=!1,Jc=8;this.dh.value.NDd(0,vd,Bc,Ae);return Jc};ma.prototype.fYa=function(gc,fd,vd,se){vd=void 0===vd?null:vd;se=void 0===se?!1:se;xb.Health.instance.recordKpiUsage("MipAutoClassificationSetLabel",
0,"wordclpfc",null);this.ub.ra("SupportsOfficeClientCoauthoring")&&this.ub.ra("CoAuthForProtectedFilesIsEnabled")?(this.eib=!1,(this.Ag=this.dh.value.pn)&&!this.Ag.AppliedPolicyId?this.eib=!0:this.Ag&&this.Ag.PolicyLabelAssignmentMethod&&(this.eib=ub.c(this.Ag.PolicyLabelAssignmentMethod)===ub.c("standard"))):this.eib=se;gc=ma.yj(gc)?null:this.sv[gc];(fd=ma.yj(fd)?null:this.sv[fd])?this.xfa=new Sb(fd,!0,vd):(this.dh.value.Gca(29),this.Cea=null);gc?this.Eoa=new Sb(gc,!1):this.jUa=null;this.TCd(null,
null);return 32};ma.prototype.aGg=function(gc){""!==this.Ag.AppliedPolicyId?this.dh.value.NDd(4,16,!0):this.zbb(gc,null,16)};ma.prototype.OVf=function(){this.sv={};if(this.Ag=this.dh.value.pn)for(var gc=yl(this.Ag.SensitivityLabels),fd=gc.next();!fd.done;fd=gc.next())fd=fd.value,this.sv[fd.Id]=fd};ma.prototype.kdi=function(gc){if(this.H8&&gc in this.H8){gc=yl(this.H8[gc]);for(var fd=gc.next();!fd.done;fd=gc.next())if((fd=this.sv[fd.value])&&fd.Enabled)return!0}return!1};ma.prototype.wWf=function(){this.H8=
{};if(this.Ag=this.dh.value.pn){for(var gc=yl(this.Ag.SensitivityLabels),fd=gc.next();!fd.done;fd=gc.next())fd=fd.value,fd.ParentId||(this.H8[fd.Id]=new Gb.a);gc=yl(this.Ag.SensitivityLabels);for(fd=gc.next();!fd.done;fd=gc.next())fd=fd.value,fd.ParentId&&fd.ParentId in this.H8&&this.H8[fd.ParentId].add(fd.Id)}};ma.prototype.FGf=function(){if(this.ub.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CacheSensitivityVisibility",!1)){this.Ag=this.dh.value.pn;var gc=this.$wb&&this.isReactRibbonEnabled()&&
this.dh.value.zga();ma.CPa(gc)}else this.$wb&&this.isReactRibbonEnabled()?(this.Ag=this.dh.value.pn,this.dh.value.zga()?(ma.CPa(!0),appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Sensitivity",!1))):ma.CPa(!1)):ma.CPa(!1)};ma.prototype.h0i=function(gc){this.sDc=gc};ma.prototype.X0i=function(gc){this.BJc=gc};ma.prototype.QLd=function(){this.ub.ra("WacApplyDefaultPolicyLabelIsEnabled")&&(this.xec()?this.lJc=!0:!this.nFc&&(this.nFc=!0,(this.Ag=this.dh.value.pn)&&this.Ag.DefaultLabelId&&
!this.Ag.AppliedPolicyId&&(da.ULS.sendTraceTag(593774211,306,50,"Default label configured, checking if this is a new file"),this.ub.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DefaultLabelingExistingDocumentIsEnabled",!1)||this.MLa))&&(da.ULS.sendTraceTag(593774210,306,50,"Default labeling triggered. DefaultLabel: {0}",this.Ag.DefaultLabelId),this.zbb(this.Ag.DefaultLabelId,null,1)))};ma.prototype.TCd=function(){var gc=this;if(!this.dh.value.Mdf()){var fd=this.sv[this.dh.value.pn.AppliedPolicyId];
this.eib&&this.Eoa&&this.jUa!==this.Eoa.id&&(!fd||fd.Order<this.Eoa.sensitivityLabel.Order)&&(fd=this.zbb(this.Eoa.id,{},4),32!==fd?da.ULS.sendTraceTag(50868813,306,10,"ProcessAutoSensitivityLabel: SetSensitivityByPolicyId failed with response: "+fd):(this.jUa=this.Eoa.id,this.Cea&&(fd=this.sv[this.Cea])&&fd.Order<=this.Eoa.sensitivityLabel.Order&&(this.dh.value.Gca(29),this.Cea=null)));fd=this.sv[this.dh.value.pn.AppliedPolicyId];if(this.xfa&&this.Cea!==this.xfa.id&&(!fd||fd.Order<this.xfa.sensitivityLabel.Order)){var vd=
this.xfa.id;this.dh.value.Gca(29);this.dh.value.aXb(29,CommonUIStrings.l_PolicyBusinessBarTitle,String.format(CommonUIStrings.l_PolicyLabelRecommendationMessage,this.Zdd(this.xfa.sensitivityLabel))+" "+this.xfa.PZi,CommonUIStrings.l_PolicyLabelRecommendationButton,function(){gc.zbb(vd,{},8)});this.Cea=this.xfa.id}this.xfa=this.Eoa=null}};ma.prototype.setPolicyLabel=function(gc,fd,vd){vd=void 0===vd?2:vd;this.cSb=fd;this.dh.value.setPolicyLabel(gc);this.Ie.updateCommandUI();fd=new Xa(vd,this.Zdd(this.sv[gc]));
this.dh.value.zMd(gc,this.cSb,fd)};ma.prototype.OYg=function(gc,fd,vd){1===gc?this.setPolicyLabel(fd===this.Ag.AppliedPolicyId?"":fd,vd):this.Ie.updateCommandUI()};ma.prototype.kPd=function(gc){(new ob(gc,Object(ya.a)(this,this.OYg,"continueToSetPolicyLabel"))).kPd()};ma.prototype.yYb=function(gc,fd){gc=void 0===gc?"":gc;fd=void 0===fd?"":fd;var vd=new wd.StandardDialog;vd.Gu=Fb.AFrameworkApplication.gxb;vd.kc=0;vd.Cc(1,CommonUIStrings.l_DialogClose);vd.HW(gc,fd,null)};ma.prototype.gKg=function(gc){1===
gc&&this.dh.value.FXi()};ma.prototype.fEg=function(){var gc=new wd.StandardDialog;gc.Gu=Fb.AFrameworkApplication.gxb;gc.kc=1;gc.Cc(1,CommonUIStrings.l_OICDownLoadACopyDialogOpenButton);gc.Cc(0,CommonUIStrings.l_DialogClose);gc.HW(CommonUIStrings.l_SensitivityApplicationDialogErrorTitle,CommonUIStrings.l_SensitivityBlockUDPSetLabelMessage,Object(ya.a)(this,this.gKg,"blockUDPSetLabelHandler"))};ma.prototype.isReactRibbonEnabled=function(){return!!this.Ie&&!!this.Ie.Pa&&this.Ie.Pa.Li};ma.prototype.Zfc=
function(){return this.Ie&&this.Ie.Pa?this.Ie.Pa.Zfc:!1};ma.prototype.lGe=function(){return 32};ma.prototype.f$a=function(gc,fd,vd,se,Jc){if(1===vd)return 32;this.Ag=this.dh.value.pn;if(!this.Ag||!Jc)return 32;Jc[pa.value]="";Jc[pa.Bi]="";Jc[pa.alt]=null;Jc[pa.R6e]=null;Jc[pa.l4a]=null;Jc[pa.customTooltip]="";Jc[pa.visible]=!1;Jc[pa.iconColor]="";vd=fd=gc=Jc[pa.icon]="";if(!this.Ag.AreLabelsAvailable){if(!this.VJc)return 32;gc=this.VJc;vd=pa.STd;this.UJc&&(fd=this.UJc)}else if(this.Ag.AppliedPolicyId){se=
null;for(var Bc=yl(this.Ag.SensitivityLabels),Ae=Bc.next();!Ae.done;Ae=Bc.next())if(Ae=Ae.value,Ae.Id.toLowerCase()===this.Ag.AppliedPolicyId.toLowerCase()){se=Ae;break}se&&(gc=this.Zdd(se),fd=se.Tooltip,this.eNc=Fb.AFrameworkApplication.protectedFile=se.IsEndpointProtectionEnabled,vd=this.YUe(se))}this.ub.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",!1)?(gc?(Jc[pa.value]=gc,Jc[pa.Bi]=gc,Jc[pa.customTooltip]=fd,this.ZVf(vd,this.eNc,Jc)):this.ub.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.ClpUseOutlineImageForNoLabel")?
(Jc[pa.iconColor]=pa.STd,this.Ag.MandatoryLabelingEnforced?(Jc[pa.value]=Jc[pa.Bi]=HeaderStrings.SelectASensitivityLabel,Jc[pa.icon]=pa.TYi):(Jc[pa.value]=Jc[pa.Bi]=HeaderStrings.NoSensitivityLabel,Jc[pa.icon]=pa.WYi)):(Jc[pa.iconColor]="#000000",this.Ag.MandatoryLabelingEnforced?(Jc[pa.value]=Jc[pa.Bi]=HeaderStrings.SelectASensitivityLabel,Jc[pa.icon]="MipTagErrorDynamicColor_20"):(Jc[pa.value]=Jc[pa.Bi]=HeaderStrings.NoSensitivityLabel,Jc[pa.icon]="MipTagQuestionDynamicColor_20")),Jc[pa.visible]=
!0):gc&&(Jc[pa.value]=gc,Jc[pa.Bi]=gc,this.Zfc()?Jc[pa.customTooltip]=fd:Jc[pa.alt]=fd,this.ZVf(vd,this.eNc,Jc),Jc[pa.visible]=!0);return 32};ma.prototype.Zdd=function(gc){return gc?this.sv?gc.ParentId&&this.sv[gc.ParentId]?this.sv[gc.ParentId].DisplayName+"\\"+gc.DisplayName:gc.DisplayName:(da.ULS.sendTraceTag(4282E4,306,15,"Policy ID to Sensitivity label dictionary has not been initialized."),gc.DisplayName):""};ma.prototype.ZVf=function(gc,fd,vd){this.ub.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",
!1)?(vd[pa.icon]=this.r0e(fd),vd[pa.iconColor]=this.s0e(gc)):this.Zfc()?vd[pa.icon]=fd?pa.Uxj:pa.Wxj:(vd[pa.R6e]=Fb.AFrameworkApplication.pC,vd[pa.l4a]=fd?ta.getImageClass(pa.Vxj):ta.getImageClass(pa.Xxj))};ma.prototype.I2g=function(gc){var fd=this.XT("LearnMoreSection",!0);gc=Object.assign(new Ra.a,{Id:"SensitivityLearnMore",ExternalId:"SensitivityLearnMore",MenuItemId:gc,LabelText:CommonUIStrings.l_LearnMore,Command:"1959943459",Image16by16:Fb.AFrameworkApplication.pC,Image16by16Class:ta.getImageClass(pa.Zji),
Visible:!0,Alt:CommonUIStrings.L_LearnMoreTooltip,KeyTip:"L"});Array.add(fd.ControlList,gc);return fd};ma.prototype.qCe=function(gc,fd,vd){vd=void 0===vd?!1:vd;var se="Toggle_"+gc.Id;se="Sensitivity_"+se;var Jc=gc.DisplayName,Bc=gc.Tooltip,Ae=gc.Id===this.Ag.AppliedPolicyId,cb=vd?lb.a.Mf(se):se;this.ub.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ClpLouderLabelEnabled",!1)?(Ae=this.YUe(gc),fd=Object.assign(new Pc.a,{Id:cb,ExternalId:cb,LabelText:vd?lb.a.Mf(Jc):Jc,Command:"2935633379",MenuItemId:cb,
QueryCommand:"991261903",Visible:!0,Alt:vd?lb.a.Mf(Bc):Bc,AriaLabel:Tc.a.iZb,IconColor:this.s0e(Ae),KeyTip:fd}),fd.ExternalImageId=this.r0e(gc.IsEndpointProtectionEnabled)):(cb=Object.assign(new Sa.a,{Id:cb,ExternalId:cb,LabelText:vd?lb.a.Mf(Jc):Jc,Command:"2935633379",MenuItemId:cb,QueryCommand:"991261903",CheckedImage:Fb.AFrameworkApplication.pC,Visible:!0,Alt:vd?lb.a.Mf(Bc):Bc,IsChecked:Ae,AriaLabel:Tc.a.iZb,KeyTip:fd}),this.isReactRibbonEnabled()?(cb.CheckedImageClass=ta.getImageClass(pa.$Dd),
cb.ExternalImageId=pa.$Dd):cb.CheckedImageClass=ta.getImageClass(pa.Nob),fd=cb);cb=se;this.Nib[cb]=gc.Id;this.cbe[gc.Id]=cb;return fd};ma.prototype.XT=function(gc,fd){fd=void 0===fd?!1:fd;return Object.assign(new Hc.a,{Title:"",Id:gc,DisplayMode:pa.menu,ShowMenuSectionSeparator:fd,ControlsId:"Ctrl_"+gc,ControlList:[]})};ma.prototype.F5g=function(gc,fd,vd){gc=this.XT(gc+"Sub");var se=1;fd=yl(fd);for(var Jc=fd.next();!Jc.done;Jc=fd.next())(Jc=this.sv[Jc.value])&&Jc.Enabled&&(Array.add(gc.ControlList,
this.qCe(Jc,se.toString(),vd)),se++);return gc};ma.prototype.Lc=function(gc){gc=void 0===gc?!1:gc;var fd=this.XT("SensitivitySection"),vd=1,se=this.H8,Jc;for(Jc in se){var Bc=se[Jc],Ae=this.sv[Jc];if(Ae&&Ae.Enabled){if(Bc.count){var cb="Sensitivity_"+Ae.Name,mc=gc?lb.a.Mf(cb):cb;mc=Object.assign(new Ja.a,{Id:mc,ExternalId:mc,LabelText:gc?lb.a.Mf(Ae.DisplayName):Ae.DisplayName,Command:"798637440",QueryCommand:"2875864574",Menu:Object.assign(new Eb.a,{Title:"",MenuSectionList:[],UpdateDynamically:!0}),
ImageIsVisible:!1,Toggled:!1,ImageUsesSpaceWhileInvisible:!0,AriaLabel:Tc.a.iZb,KeyTip:vd.toString()});this.isReactRibbonEnabled()?mc.ExternalImageId=pa.$Dd:(mc.Image16by16=Fb.AFrameworkApplication.pC,mc.Image16by16Class=ta.getImageClass(pa.Nob));Array.add(mc.Menu.MenuSectionList,this.F5g(cb,Bc,gc));Array.add(fd.ControlList,mc);this.Nib[mc.Id]=Ae.Id;this.cbe[Ae.Id]=mc.Id}else Array.add(fd.ControlList,this.qCe(Ae,vd.toString(),gc));vd++}}return fd};ma.prototype.slb=function(gc){return!!this.La.W3(gc)&&
!!this.La.W3(gc).flags&&!!this.La.W3(gc).flags.length};ma.prototype.fMi=function(gc,fd){fd.onSuccess&&this.sv&&(gc=this.sv[this.dh.value.pn.AppliedPolicyId])&&(this.Cea&&(fd=this.sv[this.Cea])&&fd.Order<=gc.Order&&(this.dh.value.Gca(29),this.Cea=null),this.jUa&&this.jUa!==gc.Id&&(this.dh.value.Gca(28),this.jUa=null))};ma.prototype.r0e=function(gc){return gc?pa.VYi:pa.UYi};ma.prototype.s0e=function(gc){return gc?gc:pa.STd};ma.prototype.YUe=function(gc){if(gc.Color||!gc.ParentId)return gc.Color;var fd=
this.sv[gc.ParentId];return fd?fd.Color:gc.Color};ma.CPa=function(gc){Fb.AFrameworkApplication.ga&&Fb.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)||(gc?(fb.a.gwd("ribbon","sensitivity"),fb.a.cwd("ribbon","sensitivity")):fb.a.fwd("ribbon","sensitivity"));Fb.AFrameworkApplication.ga&&Fb.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CacheSensitivityVisibility",!1)&&Xc.c()&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Sensitivity",
!gc))};ma.yj=function(gc){return gc&&gc.length?!1:!0};tl.Object.defineProperties(ma.prototype,{MLa:{configurable:!0,enumerable:!0,get:function(){return Fb.AFrameworkApplication.MLa||!!this.BJc&&this.BJc()}}});Object(Tb.a)(ma,"PolicyActor",null,[362]);var wb=b(686),E=b(574),Mb=b(94),ka;(function(gc){gc[gc.unknown=0]="unknown";gc[gc.boot=1]="boot";gc[gc.refresh=2]="refresh";gc[gc.selfSetPolicyLabel=3]="selfSetPolicyLabel"})(ka||(ka={}));Object(Tb.b)("GetPolicyLabelsReason",ka);var bb=Sys.EventArgs;
vm(wa,bb);Object(Tb.a)(wa,"AddAutoPolicyBusinessBarEntryEventArgs",Sys.EventArgs,[]);var Ga=Sys.EventArgs;vm(Z,Ga);Object(Tb.a)(Z,"AddMandatoryLabellingBusinessBarEntryEventArgs",Sys.EventArgs,[]);var Ha;(function(gc){gc[gc.none=0]="none";gc[gc.reasonDefaultLabel=1]="reasonDefaultLabel";gc[gc.reasonManual=2]="reasonManual";gc[gc.reasonAutomatic=4]="reasonAutomatic";gc[gc.reasonRecommended=8]="reasonRecommended";gc[gc.reasonMandatory=16]="reasonMandatory"})(Ha||(Ha={}));Object(Tb.b)("ApplyLabelFlags",
Ha);var Ua=Sys.EventArgs;vm(na,Ua);Object(Tb.a)(na,"AutoCLPSecurityNodesEventArgs",Sys.EventArgs,[]);var kb=Sys.EventArgs;vm(Y,kb);Object(Tb.a)(Y,"GetPolicyLabelEventArgs",Sys.EventArgs,[]);var $a=Sys.EventArgs;vm(S,$a);Object(Tb.a)(S,"GetPolicyLabelFailureEventArgs",Sys.EventArgs,[]);Object(Tb.a)(ca,"GetPolicyLabelsData",null,[]);var Xb=Sys.EventArgs;vm(ba,Xb);Object(Tb.a)(ba,"LabelInfoUpdateEventArgs",Sys.EventArgs,[]);var dc=Sys.EventArgs;vm(O,dc);Object(Tb.a)(O,"MandatoryLabellingAppHandlerEventArgs",
Sys.EventArgs,[]);var Za=Sys.EventArgs;vm(Q,Za);Object(Tb.a)(Q,"PolicyTipEventArgs",Sys.EventArgs,[]);var Wa=Sys.EventArgs;vm(I,Wa);Object(Tb.a)(I,"RemoveAutoPolicyBusinessBarEntryEventArgs",Sys.EventArgs,[]);var Ba=Sys.EventArgs;vm(R,Ba);Object(Tb.a)(R,"RemoveMandatoryLabellingBusinessBarEntryEventArgs",Sys.EventArgs,[]);var db=Sys.EventArgs;vm(W,db);Object(Tb.a)(W,"SetPolicyLabelEventArgs",Sys.EventArgs,[]);var Zb=Sys.EventArgs;vm(ia,Zb);Object(Tb.a)(ia,"SetPolicyLabelFailureEventArgs",Sys.EventArgs,
[]);var Jb=Sys.EventArgs;vm(P,Jb);Object(Tb.a)(P,"SetPolicyLabelTriggeredEventArgs",Sys.EventArgs,[]);var Ic=Sys.EventArgs;vm(N,Ic);Object(Tb.a)(N,"UDPLabelingAppHandlerEventArgs",Sys.EventArgs,[]);var uc=b(109),za=b(98),pb=b(38),cc=b(77),Ac=b(47);Object(Tb.a)(U,"ClientRequest",null,[]);var ad=b(416),Jd=b(308);B.nij=function(gc,fd){if(!gc||!fd||gc.count!==fd.count)return!1;gc=yl(gc);for(var vd=gc.next();!vd.done;vd=gc.next())if(!fd.contains(vd.value))return!1;return!0};B.toArray=function(gc){if(!gc)return null;
var fd=Array(gc.count),vd=0;gc=yl(gc);for(var se=gc.next();!se.done;se=gc.next())fd[vd]=se.value,vd++;return fd};Object(Tb.a)(B,"HashSetUtils",null,[]);var Xd=b(272),od=b(75),Je=b(178);w.prototype.vle=function(gc){this.Ya.addHandler("PolicyTipEvent",gc)};w.prototype.oTc=function(gc){this.Ya.addHandler("LabelInfoUpdateEvent",gc)};w.prototype.Nle=function(gc){this.Ya.addHandler("SetPolicyLabelEventKey",gc)};w.prototype.o6i=function(gc){this.Ya.removeHandler("SetPolicyLabelEventKey",gc)};w.prototype.ITc=
function(gc){this.Ya.addHandler("SetPolicyLabelFailureEventKey",gc)};w.prototype.n6i=function(gc){this.Ya.removeHandler("SetPolicyLabelFailureEventKey",gc)};w.prototype.xAg=function(gc){this.Ya.addHandler("GetPolicyLabelEventKey",gc)};w.prototype.wAg=function(gc){this.Ya.addHandler("GetPolicyLabelFailureEventKey",gc)};w.prototype.uAg=function(gc){this.Ya.addHandler("GetAutoPolicyLabelEventKey",gc);this.Hkd&&(da.ULS.sendTraceTag(51668058,306,15,"GetAutoPolicyLabelHandler was registered after the AutoPolicyLabelHandlerEvent was raised"),
this.DDd(new Y(0)))};w.prototype.H4i=function(gc){this.Ya.removeHandler("GetAutoPolicyLabelEventKey",gc)};w.prototype.Rzg=function(gc){this.Ya.addHandler("CreateAutoCLPSecurityNodesEventKey",gc)};w.prototype.i4i=function(gc){this.Ya.removeHandler("CreateAutoCLPSecurityNodesEventKey",gc)};w.prototype.PCg=function(gc){this.Ya.addHandler("UpdateAutoCLPLabelPriorityNodeEventKey",gc)};w.prototype.E6i=function(gc){this.Ya.removeHandler("UpdateAutoCLPLabelPriorityNodeEventKey",gc)};w.prototype.QCg=function(gc){this.Ya.addHandler("UpdateAutoCLPSITNodesEventKey",
gc)};w.prototype.F6i=function(gc){this.Ya.removeHandler("UpdateAutoCLPSITNodesEventKey",gc)};w.prototype.lke=function(gc){this.Ya.addHandler("AddAutoPolicyBusinessBarEntryEventKey",gc)};w.prototype.C3i=function(gc){this.Ya.removeHandler("AddAutoPolicyBusinessBarEntryEventKey",gc)};w.prototype.Ale=function(gc){this.Ya.addHandler("RemoveAutoPolicyBusinessBarEntryEventKey",gc)};w.prototype.X5i=function(gc){this.Ya.removeHandler("RemoveAutoPolicyBusinessBarEntryEventKey",gc)};w.prototype.mke=function(gc){this.Ya.addHandler("AddMandatoryLabellingBusinessBarEntryEventKey",
gc)};w.prototype.E3i=function(gc){this.Ya.removeHandler("AddMandatoryLabellingBusinessBarEntryEventKey",gc)};w.prototype.Ble=function(gc){this.Ya.addHandler("RemoveMandatoryLabellingBusinessBarEntryEventKey",gc)};w.prototype.Y5i=function(gc){this.Ya.removeHandler("RemoveMandatoryLabellingBusinessBarEntryEventKey",gc)};w.prototype.fBg=function(gc){this.Ya.addHandler("MandatoryLabellingAppHandlerEventKey",gc)};w.prototype.l5i=function(gc){this.Ya.removeHandler("MandatoryLabellingAppHandlerEventKey",
gc)};w.prototype.NCg=function(gc){this.Ya.addHandler("UDPLabelingAppHandlerEventKey",gc)};w.prototype.D6i=function(gc){this.Ya.removeHandler("UDPLabelingAppHandlerEventKey",gc)};w.prototype.CSg=function(){return Fb.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IsClpBlockedByAppSpecificScenarioEnabled",!1)?this.e6d?this.e6d():!1:!1};w.prototype.d0i=function(gc){this.cDc=gc};w.prototype.Sv=function(){return(new Date).getTime()};w.prototype.i$b=function(){this.uh&&(this.xTb=
this.uh.Fc("WebServiceCall","Call Get Policy Endpoint On Server"));var gc=Xd.a.Gha(1,1);this.ub.ra("SendHostAttributionInfoForPolicyLabelEnabled")?(gc=new U(this.V2a("datalosspolicy"),1,null,null,!0,2,null,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,gc),this.Og.send(gc).jFd(Object(ya.a)(this,this.Fsf,"onDataLossPolicySuccessCallback"),Object(ya.a)(this,this.Esf,"onDataLossPolicyFailureCallback"))):this.Og.Ul(this.V2a("datalosspolicy"),1,null,null,!0,2,Object(ya.a)(this,
this.Fsf,"onDataLossPolicySuccessCallback"),Object(ya.a)(this,this.Esf,"onDataLossPolicyFailureCallback"),null);this.whb++;da.ULS.sendTraceTag(25565151,306,50,"Policy request is sent to server. The endpoint used is {0}. Policy call times: {1}.",this.bbe,this.whb)};w.prototype.L_i=function(){this.ccd(this.L7,2,this.Boa)};w.prototype.ccd=function(gc,fd,vd,se){fd=void 0===fd?0:fd;vd=void 0===vd?null:vd;se=void 0===se?!1:se;xb.Health.instance.recordKpiUsage("MipGetPolicyLabel",0,"officewebclp",this.ncd(void 0,
fd));this.zub=this.Sv();var Jc=this.f2c(fd);this.h$b(gc,Jc,vd,se,fd)};w.prototype.Fsf=function(gc){this.JDf();var fd=this.oUd(gc);gc=fd.data;fd.returnValue&&(da.ULS.sendTraceTag(25565153,306,50,"Request to get DataLossPrevention policy succeeded."),this.whb=0,this.uh&&(this.yTb=this.uh.Fc("Task","Parse and Handle Get Policy Response")),this.lPi(gc),this.yTb&&(this.yTb.stop(),this.yTb=null))};w.prototype.Esf=function(gc){this.JDf();this.whb<=this.wSb?this.i$b():(da.ULS.sendTraceTag(25565154,306,15,
"Request to get DataLossPrevention policy failed with error response: {0}.",gc?gc.data?gc.data.PPa:null:null),this.whb=0)};w.prototype.Mdf=function(){return 0<this.Dqa};w.prototype.setPolicyLabel=function(gc){this.pn.AppliedPolicyId=gc};w.prototype.zMd=function(gc,fd,vd){vd=void 0===vd?null:vd;var se=this.m2g(vd);this.pkj(gc,fd,se,vd)};w.prototype.qzf=function(gc){this.oEa&&(this.oEa.stop(),this.oEa=null);var fd=this.z_e(gc);var vd=fd.gTf;fd=fd.DWf;var se=gc.data.state,Jc=se?se.cP:2,Bc=this.oUd(gc);
gc=Bc.data;Bc.returnValue?(da.ULS.sendTraceTag(41799707,306,50,"Request to set label policy data succeeded. ApplyLabelFlag: {0}",Jc),this.Dqa=0,this.DPi(gc,vd,fd,se)):this.eJd(Jc)};w.prototype.BXi=function(gc){xb.Health.instance.recordKpiUsage("MipSetPolicyLabel",0,"officewebclp",this.ncd(gc));this.GIb=this.Sv();da.ULS.sendTraceTag(575947405,306,50,"Raising set policy label triggered event.");this.Ya.raiseEvent("SetPolicyLabelTriggeredEventKey",new P(gc))};w.prototype.nwi=function(){this.fec&&this.supportsOfficeClientCoauthoring&&
this.Gei&&this.jEa.fda(12,null,!0)};w.prototype.pzf=function(gc){this.oEa&&(this.oEa.stop(),this.oEa=null);var fd=this.z_e(gc);var vd=fd.gTf;fd=fd.DWf;this.Dqa<=this.wSb?this.zMd(vd,fd):(vd=(vd=gc.data.state)?vd.cP:2,da.ULS.sendTraceTag(41799708,306,15,"Request to set label policy failed with error response: {0}. ApplyLabelFlag: {1}",gc?gc.data?gc.data.PPa:null:null,vd),this.Dzb="WACServerConnectionFailed",this.Dqa=0,this.eJd(vd))};w.prototype.vei=function(gc){if(gc&&("LabelNotSupported"===gc||"LabelErrorRetryLater"===
gc||"CoherencyFailure"===gc||"LabelIdNotFound"===gc||"LabelDisabled"===gc))return da.ULS.sendTraceTag(539103556,306,50,"LabelError is retriable: {0}",gc),!0;da.ULS.sendTraceTag(539103557,306,50,"LabelError is not retriable: {0}",gc);return!1};w.prototype.fQg=function(gc){if(!gc)return!1;for(var fd=null,vd=null,se=yl(this.pn.SensitivityLabels),Jc=se.next();!Jc.done;Jc=se.next())Jc=Jc.value,Jc.Id===gc&&(fd=Jc),Jc.Id===this.L7&&(vd=Jc);if(!fd)return!1;if(this.fec&&this.supportsOfficeClientCoauthoring){if(this.cDc&&
this.cDc()||this.Mld)return!0}else if(Fb.AFrameworkApplication.By&&Fb.AFrameworkApplication.By.qtb||this.Boa&&this.Boa())return!0;return fd.IsEndpointProtectionEnabled===(!!vd&&vd.IsEndpointProtectionEnabled)};w.prototype.aXb=function(gc,fd,vd,se,Jc){28===gc?this.bHf(new wa(gc,fd,vd,se,Jc,!1)):this.bHf(new wa(gc,fd,vd,se,Jc,!0))};w.prototype.Gca=function(gc){28===gc?this.EHf(new I(gc,!1)):this.EHf(new I(gc,!0))};w.prototype.NWi=function(gc,fd,vd){da.ULS.sendTraceTag(545280777,306,50,"Raising a CreateAutoCLPSecurityNodes event.");
this.Ya.raiseEvent("CreateAutoCLPSecurityNodesEventKey",new na(gc,fd,vd))};w.prototype.GXi=function(gc){da.ULS.sendTraceTag(545280778,306,50,"Raising a UpdateAutoCLPLabelPriorityNode event.");this.Ya.raiseEvent("UpdateAutoCLPLabelPriorityNodeEventKey",new na(null,null,gc))};w.prototype.HXi=function(gc,fd){da.ULS.sendTraceTag(545280779,306,50,"Raising a UpdateAutoCLPSITNodes event.");this.Ya.raiseEvent("UpdateAutoCLPSITNodesEventKey",new na(gc,fd,null))};w.prototype.tHf=function(gc,fd){da.ULS.sendTraceTag(572650527,
306,50,"Raising a mandatory labelling"+(1===fd?"Reading":"Edit")+" switch event.");this.Ya.raiseEvent("MandatoryLabellingAppHandlerEventKey",new O(gc,fd))};w.prototype.uSc=function(gc,fd,vd,se,Jc){37===gc&&this.DWi(new Z(37,fd,vd,se,Jc))};w.prototype.gGd=function(){this.vXi(new R)};w.prototype.FXi=function(){da.ULS.sendTraceTag(540608322,306,50,"Raising a UDP labeling event.");this.Ya.raiseEvent("UDPLabelingAppHandlerEventKey",new N(!0))};w.prototype.zga=function(gc){gc=void 0===gc?!1:gc;var fd=!!this.pn&&
this.pn.AreLabelsAvailable&&!!this.pn.SensitivityLabels&&0<this.pn.SensitivityLabels.length&&Jd.a.any(this.pn.SensitivityLabels,function(vd){return!!vd&&vd.Enabled});fd||gc||ma.CPa(!1);return fd};w.prototype.Duf=function(gc){this.XCa&&(this.XCa.stop(),this.XCa=null);var fd=this.oUd(gc);var vd=fd.data;fd.returnValue?(da.ULS.sendTraceTag(34996493,306,50,"Request to get label policy data succeeded."),this.uhb=0,vd=this.uPi(vd),gc=this.wZe(gc.data),xb.Health.instance.recordKpiSuccess("MipGetPolicyLabel",
this.n9b(void 0,gc,this.zub)),this.zub=null,gc=new Y(gc),this.YWi(gc),this.ub.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)?vd&&this.qoj()?this.Hkd?this.iIj():(this.A2b(),this.DDd(gc),this.wIc=!0):this.dpc():!this.Hkd&&vd&&this.ub.ra("WacApplyManualPolicyLabelIsEnabled")&&this.Yoe()?(this.DDd(gc),this.wIc=!0):vd||this.dpc()):this.dpc()};w.prototype.qoj=function(){if(!this.ub.ra("WacApplyManualPolicyLabelIsEnabled"))return da.ULS.sendTraceTag(539877667,306,50,"ShouldAutoClassificationRun returned false - Manual Labeling is not enabled"),
!1;if(!this.Yoe())return!1;if(""===this.L7)return da.ULS.sendTraceTag(539877696,306,50,"ShouldAutoClassificationRun returned true - document is not labeled"),!0;if(this.TBa===this.KHc)return da.ULS.sendTraceTag(539877697,306,50,"ShouldAutoClassificationRun returned false - Applied label already has the highest priority"),!1;da.ULS.sendTraceTag(539877698,306,50,"ShouldAutoClassificationRun returned true - document is labeled but not with the highest priority label");return!0};w.prototype.A2b=function(){this.j9f();
da.ULS.sendTraceTag(545104324,306,50,"Creating AutoCLP Security nodes. HasSITs: {0}, LabelPriority: {1}",0<this.mEa.count,this.TBa);var gc=B.toArray(this.mEa);this.NWi(gc,gc,this.TBa)};w.prototype.iIj=function(){var gc=this.mEa;this.j9f();B.nij(gc,this.mEa)||(da.ULS.sendTraceTag(545104325,306,50,"Updating AutoCLP SIT nodes. HasSITs: {0}",0<this.mEa.count),gc=B.toArray(this.mEa),this.HXi(gc,gc));this.G6d&&(da.ULS.sendTraceTag(545104326,306,50,"Updating AutoCLP Label Priority node. LabelPriority: {0}",
this.TBa),this.GXi(this.TBa))};w.prototype.j9f=function(){for(var gc=new wb.a(E.a.Ik()),fd=yl(this.pn.SensitivityLabels),vd=fd.next();!vd.done;vd=fd.next())if((vd=vd.value)&&vd.AutoLabelingSensitiveTypeIds&&0<vd.AutoLabelingSensitiveTypeIds.length){vd=yl(vd.AutoLabelingSensitiveTypeIds);for(var se=vd.next();!se.done;se=vd.next())(se=se.value)&&gc.add(se)}this.mEa=gc};w.prototype.Cuf=function(gc){var fd=this.wZe(gc.data);xb.Health.instance.recordKpiFailure("MipGetPolicyLabel","GetPolicyLabelsFailure",
!1,!1,this.n9b(void 0,fd,this.zub));this.zub=null;this.XCa&&(this.XCa.stop(),this.XCa=null);if(this.uhb<=this.wSb){if(this.ub.ra("SendHostAttributionInfoForPolicyLabelEnabled")){var vd=gc.data.request.get_headers();if("HostAttributionInfo.ScenarioParamName"in vd&&vd[Xd.a.YJd]&&"HostAttributionInfo.ScenarioTypeParamName"in vd&&vd[Xd.a.ZJd]){gc.data.request.get_headers();gc.data.request.get_headers();gc=this.f2c(fd);this.h$b(this.L7,gc,this.Boa,void 0,fd);return}}this.ccd(this.L7,fd,this.Boa)}else da.ULS.sendTraceTag(34996494,
306,15,"Request to get label policy failed with error response: {0}.",gc?gc.data?gc.data.PPa:null:null),this.dpc(),this.uhb=0};w.prototype.wZe=function(gc){return gc.state?gc.state:0};w.prototype.V2a=function(gc,fd){fd=void 0===fd?!1:fd;var vd=String.format("{0}{1}?action={2}&{3}",this.ub.Ua("PolicyHandlerWebServiceBase")||Fb.AFrameworkApplication.sa.Pa.h_,this.bbe,gc,Fb.AFrameworkApplication.hj);"setpolicylabel"===gc&&Fb.AFrameworkApplication.By&&Fb.AFrameworkApplication.By.laf&&(vd=cc.a.gl(vd,"sl",
"1"));fd&&(vd=cc.a.gl(vd,"cbd","1"));return vd};w.prototype.z_e=function(gc){var fd;var vd=fd=null;gc&&gc.data&&gc.data.request&&gc.data.request.get_headers()&&(vd=gc.data.request.get_headers()[ad.a.hTf],fd=gc.data.request.get_headers()[ad.a.EWf]);return{gTf:vd,DWf:fd}};w.prototype.oUd=function(gc){gc=gc?gc.data?gc.data.fe:null:null;return gc&&gc.length&&!this.gfi(gc)?{returnValue:!0,data:gc}:(da.ULS.sendTraceTag(25565152,306,10,"No response data from policy endpoint."),{returnValue:!1,data:gc})};
w.prototype.lPi=function(gc){try{var fd=pb.b(gc)}catch(vd){da.ULS.sendTraceTag(37880331,306,10,"Error when deserializing DataLossPrevention response.");return}if(fd)if(fd.IsPolicyTipAvailable)switch(fd.IsPolicyTipAvailable.toLowerCase()){case "false":da.ULS.sendTraceTag(26007261,306,50,"policyData.IsPolicyTipAvailable is false so DLP policy tip is not present.");break;case "true":da.ULS.sendTraceTag(25565186,306,50,"DLP Policy is enabled on this document.");this.jFc=fd.NavigateUrl;this.rtj(fd.GeneralText,
Object(ya.a)(this,this.wBi,"onDataLossPolicyOverrideButtonClick"));break;default:da.ULS.sendTraceTag(26007262,306,10,"policyData.IsPolicyTipAvailable is expected to be 'true' or 'false' but it is {0}",fd.IsPolicyTipAvailable)}else da.ULS.sendTraceTag(26007260,306,10,"policyData.IsPolicyTipAvailable is null or empty whereas it should be 'true' or 'false'.");else da.ULS.sendTraceTag(25565185,306,10,"policyData is null after deserializing DataLossPrevention response.")};w.prototype.DPi=function(gc,fd,
vd,se){var Jc=this,Bc=se?se.cP:2,Ae=0,cb="",mc;if(function(){var Sc=pb.d(gc);mc=Sc.uu;return Sc}().returnValue)if(mc){cb="Success";var Oc=this.f2c(3);if(mc.IsSuccessful){xb.Health.instance.recordKpiSuccess("MipSetPolicyLabel",this.n9b(Bc,void 0,this.GIb));this.Dzb=this.GIb=null;da.ULS.sendTraceTag(51233632,306,50,"setPolicyLabel was successful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}",Bc);2===Bc&&this.Gca(29);this.plj(fd,Bc);this.nwi();this.Gca(28);se&&4===Bc&&
this.aXb(28,CommonUIStrings.l_PolicyBusinessBarTitle,String.format(CommonUIStrings.l_PolicyLabelAutomaticallyAppliedMessage,se.displayName),CommonUIStrings.l_DialogOk,function(){});Kb.a("MipAppliedLabels",void 0,void 0,[Object.assign(new od.a,{name:"SetPolicyLabelApplyFlag",string:Ha[Bc]})]);this.h$b(fd,Oc,this.Boa,void 0,3);return}da.ULS.sendTraceTag(51233631,306,10,"setPolicyLabel was unsuccessful as seen after deserializing set policy label data response. ApplyLabelFlag: {0}, FailureReason: {1}",
Bc,mc.FailureReason);this.Dzb=mc.FailureReason;"FileTooLarge"===mc.FailureReason?Ae=1:"LabelNotSupported"===mc.FailureReason?Ae=2:"LabelDisabled"===mc.FailureReason?Ae=3:"MinorVersionLimitExceeded"===mc.FailureReason&&(Ae=5);this.lfi&&0<=mc.FailureReason.indexOf("InvalidOperationOnZeroByteFile")&&(se=new uc.a(2,1,this.qkj,function(){da.ULS.sendTraceTag(575428443,306,15,"Retring SetPolicyLabelRequestAsync as previous called failed due to zero byte. Attempt number : {0}",Jc.Dqa);Jc.Dqa<=Jc.wSb&&Jc.zMd(fd,
vd)}),this.je.fh(se));this.fec&&this.supportsOfficeClientCoauthoring&&this.h$b(this.pn.AppliedPolicyId,Oc,this.Boa,!0,3)}else cb="setPolicyLabelData null.",da.ULS.sendTraceTag(42467541,306,10,"setPolicyLabelData is null after deserializing set policy label data response. ApplyLabelFlag: {0}",Bc);else cb="TryDeserialize failed.",da.ULS.sendTraceTag(41799709,306,10,"Error when deserializing set policy label data response. ApplyLabelFlag: {0}",Bc);this.eJd(Bc,Ae);Bc=this.n9b(Bc,void 0,this.GIb);this.GIb=
null;Bc.extendedProperties.set("SetPolicyLabelDataFailureReason",this.Dzb);Bc.extendedProperties.set("SetPolicyLabelDataParseStatus",cb.toString());xb.Health.instance.recordKpiFailure("MipSetPolicyLabel","SetPolicyLabelFailure",!1,!1,Bc)};w.prototype.eJd=function(gc,fd){fd=void 0===fd?0:fd;this.setPolicyLabel(this.L7);this.rHf(new ba);this.NDd(fd,gc,2===gc||8===gc||16===gc,!1)};w.prototype.plj=function(gc,fd){this.setPolicyLabel(this.L7=gc);if(""===gc)Fb.AFrameworkApplication.protectedFile=!1,Fb.AFrameworkApplication.enableMacrosForProtectedFile=
!1;else for(var vd=yl(this.pn.SensitivityLabels),se=vd.next();!se.done;se=vd.next())if(se=se.value,se.Id===gc){Fb.AFrameworkApplication.protectedFile=se.IsEndpointProtectionEnabled;break}this.AXi(new W(gc,fd))};w.prototype.$Jj=function(){for(var gc=yl(this.pn.SensitivityLabels),fd=gc.next();!fd.done;fd=gc.next())(fd=fd.value)&&fd.Enabled&&(fd.Id===this.L7&&(this.G6d=this.TBa!==fd.Order,this.TBa=fd.Order),fd.Order>this.KHc&&(this.KHc=fd.Order))};w.prototype.uPi=function(gc){var fd=pb.d(gc);gc=fd.uu;
if(!fd.returnValue)return da.ULS.sendTraceTag(34996495,306,10,"Error when deserializing label policy data response."),!1;if(!gc)return da.ULS.sendTraceTag(42467542,306,10,"policyData is null after deserializing label policy data response."),!1;if(!gc.AreLabelsAvailable)return!1;this.pn=gc;this.L7=gc.AppliedPolicyId;this.ub.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)&&this.$Jj();this.zga()&&da.ULS.sendTraceTag(51197846,306,50,"Labels are available for display after GetPolicyLabels call.");
this.rHf(new ba(!0));return!0};w.prototype.Yoe=function(){if(!this.zga())return da.ULS.sendTraceTag(539877699,306,50,"AreAutoLabelingSensitiveTypesAvailable returned false - No labels to display"),!1;for(var gc=yl(this.pn.SensitivityLabels),fd=gc.next();!fd.done;fd=gc.next())if((fd=fd.value)&&fd.AutoLabelingSensitiveTypeIds&&0<fd.AutoLabelingSensitiveTypeIds.length)return!0;da.ULS.sendTraceTag(539877700,306,50,"AreAutoLabelingSensitiveTypesAvailable returned false - No labels with AutoClp SIT");return!1};
w.prototype.rHf=function(gc){da.ULS.sendTraceTag(35393610,306,50,"Raising label info update event.");this.Ya.raiseEvent("LabelInfoUpdateEvent",gc)};w.prototype.YWi=function(gc){da.ULS.sendTraceTag(50676305,306,50,"Raising get policy label event.");this.Ya.raiseEvent("GetPolicyLabelEventKey",gc)};w.prototype.dpc=function(){ma.CPa(!1);this.Ya.raiseEvent("GetPolicyLabelFailureEventKey",new S)};w.prototype.DDd=function(gc){var fd=this;this.uO&&this.uO.execute(function(vd){vd=[vd.isFeatureEnabled("MsoClpSpTwo",
!0),vd.isFeatureEnabled("MsoDrmPremiumSpTwo",!0)];Promise.all(vd).then(function(se){Jd.a.any(se,function(Jc){return Jc})&&(da.ULS.sendTraceTag(50944077,306,50,"Raising get auto policy label event."),fd.Ya.raiseEvent("GetAutoPolicyLabelEventKey",gc),Kb.a("MipAutoClassificationEnabled"));return null})})};w.prototype.ncd=function(gc,fd){gc=void 0===gc?null:gc;fd=void 0===fd?null:fd;var vd=new Map;vd.set("ClpCoauth",this.supportsOfficeClientCoauthoring.toString());null!=gc&&vd.set("ApplyLabelFlags",Ha[gc]);
null!=fd&&vd.set("GetPolicyLabelsReason",ka[fd]);return vd};w.prototype.n9b=function(gc,fd,vd){gc=void 0===gc?null:gc;fd=void 0===fd?null:fd;vd=void 0===vd?null:vd;var se=new Je.a;se.extendedProperties=this.ncd(gc,fd);null!=vd&&(se.durationMs=this.Sv()-vd);return se};w.prototype.AXi=function(gc){da.ULS.sendTraceTag(41799710,306,50,"Raising set policy label event.");this.Ya.raiseEvent("SetPolicyLabelEventKey",gc)};w.prototype.bHf=function(gc){da.ULS.sendTraceTag(51128227,306,50,"Raising an add auto policy business bar entry event.");
gc&&gc.kyb&&Kb.a("MipRecommendations");this.Ya.raiseEvent("AddAutoPolicyBusinessBarEntryEventKey",gc)};w.prototype.EHf=function(gc){da.ULS.sendTraceTag(51128256,306,50,"Raising an remove auto policy business bar entry event.");this.Ya.raiseEvent("RemoveAutoPolicyBusinessBarEntryEventKey",gc)};w.prototype.DWi=function(gc){da.ULS.sendTraceTag(573842331,306,50,"Raising an add mandatory labelling business bar entry event.");this.Ya.raiseEvent("AddMandatoryLabellingBusinessBarEntryEventKey",gc)};w.prototype.vXi=
function(gc){da.ULS.sendTraceTag(573842332,306,50,"Raising a remove mandatory labelling business bar entry event.");this.Ya.raiseEvent("RemoveMandatoryLabellingBusinessBarEntryEventKey",gc)};w.prototype.rtj=function(gc,fd){fd=void 0===fd?null:fd;da.ULS.sendTraceTag(34996496,306,50,"Showing policy tip to user.");this.Ya.raiseEvent("PolicyTipEvent",new Q(CommonUIStrings.l_PolicyBusinessBarTitle,gc,CommonUIStrings.l_PolicyOverrideButton,fd))};w.prototype.NDd=function(gc,fd,vd,se){var Jc=this;da.ULS.sendTraceTag(42074656,
306,void 0===se||se?50:15,"Raising set policy label failure event. ApplyLabelFlags: {0}",fd);if(this.ub.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CommonBusinessBarEntryForSensitivityLabelError",!1)){se=CommonUIStrings.l_SensitivityApplicationErrorBusinessBarTitle;var Bc=CommonUIStrings.l_SensitivityApplicationErrorBusinessBarMessage,Ae=null,cb=null;switch(gc){case 1:se=CommonUIStrings.l_SensitivityApplicationErrorFileTooLargeBusinessBarTitle;Bc=CommonUIStrings.l_SensitivityApplicationErrorFileTooLargeBusinessBarMessage;
break;case 2:se=CommonUIStrings.l_SensitivityApplicationErrorLabelNotSupportedBusinessBarTitle;Bc=CommonUIStrings.l_SensitivityApplicationErrorLabelNotSupportedBusinessBarMessage;break;case 3:se=CommonUIStrings.l_SensitivityApplicationErrorLabelDisabledBusinessBarTitle;Bc=CommonUIStrings.l_SensitivityApplicationErrorLabelDisabledBusinessBarMessage;break;case 4:se=CommonUIStrings.l_SensitivityCoauthMandatoryApplicationErrorTitle;Bc=CommonUIStrings.l_SensitivityCoauthMandatoryApplicationErrorMessage;
break;case 5:se=CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarTitle,Bc=CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarMessage,Ae=CommonUIStrings.l_LearnMore,cb=function(){Jc.FWf()}}gc=new ia(gc,fd,vd,se,Bc,Ae,cb)}else gc=5===gc?new ia(gc,fd,vd,CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarTitle,CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedBusinessBarMessage,CommonUIStrings.l_LearnMore,
function(){Jc.FWf()}):new ia(gc,fd,vd);this.Ya.raiseEvent("SetPolicyLabelFailureEventKey",gc)};w.prototype.Djj=function(gc){this.IKc=gc};w.prototype.wBi=function(){this.jFc?(da.ULS.sendTraceTag(25565187,306,50,"DLP override button was clicked."),Ac.a.xU(this.jFc)):da.ULS.sendTraceTag(25565188,306,10,"Null NavigateUrl got in policy response. Could not navigate to SPO.")};w.prototype.gfi=function(gc){if(!gc.startsWith("<")||-1===gc.indexOf("Error")&&-1===gc.indexOf("Unavailable"))return!1;da.ULS.sendTraceTag(25565189,
306,10,"The response from server is not a valid JSON response and it matches the error page keyword. This might be the error response from a non-existing endpoint.");return!0};w.prototype.JDf=function(){this.xTb&&(this.xTb.stop(),this.xTb=null)};w.prototype.YBh=function(gc){if(!gc)return"manual";switch(gc.cP){case 0:return"manual";case 4:return"auto";case 1:return"default";case 16:return"mandatory";case 2:return"manual";case 8:return"recommended";default:return"manual"}};w.prototype.gDh=function(gc){if(!gc)return"privileged";
gc=gc.cP;var fd="privileged";if(4===gc||1===gc)fd="standard";return fd};w.prototype.h$b=function(gc,fd,vd,se,Jc){vd=void 0===vd?null:vd;se=void 0===se?!1:se;Jc=void 0===Jc?0:Jc;this.ub.ra("WacLabelingGetPolicyLabelsIsEnabled")&&(this.L7=gc,this.Boa=vd,this.uh&&(this.XCa=this.uh.Fc("WebServiceCall","Call Get Policy Endpoint On Server")),vd={},vd[ad.a.PFg]=gc,this.ub.ra("SendHostAttributionInfoForPolicyLabelEnabled")?(gc=new U(this.V2a("getpolicylabels",se),1,null,vd,!0,2,Jc,void 0,void 0,void 0,void 0,
void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,fd),this.Og.send(gc).jFd(Object(ya.a)(this,this.Duf,"onGetPolicyLabelsSuccessCallback"),Object(ya.a)(this,this.Cuf,"onGetPolicyLabelsFailureCallback"))):this.Og.Ul(this.V2a("getpolicylabels",se),1,null,vd,!0,2,Object(ya.a)(this,this.Duf,"onGetPolicyLabelsSuccessCallback"),Object(ya.a)(this,this.Cuf,"onGetPolicyLabelsFailureCallback"),Jc,void 0,void 0,void 0,void 0,"22"),this.uhb++,da.ULS.sendTraceTag(34996492,306,50,"Policy label request sent to server. Policy call times: {0}",
this.uhb))};w.prototype.pkj=function(gc,fd,vd,se){se=void 0===se?null:se;if(this.$wb){this.uh&&(this.oEa=this.uh.Fc("WebServiceCall","Call Set Policy Endpoint On Server"));var Jc={};Jc[ad.a.hTf]=gc;fd&&(Jc[ad.a.EWf]=encodeURIComponent(fd));this.IKc&&(Jc[ad.a.gFg]=this.IKc);se?(Jc[ad.a.BWf]=this.YBh(se),Jc[ad.a.CWf]=this.gDh(se)):(Jc[ad.a.BWf]="manual",Jc[ad.a.CWf]="privileged");this.supportsOfficeClientCoauthoring&&this.pn&&(Jc[ad.a.oRi]=this.pn.PolicyLabelVersionToken);this.ub.ra("SendHostAttributionInfoForPolicyLabelEnabled")?
(gc=new U(this.V2a("setpolicylabel",!0),1,null,Jc,!0,2,se,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,vd),this.Og.send(gc).jFd(Object(ya.a)(this,this.qzf,"onSetPolicyLabelSuccessCallback"),Object(ya.a)(this,this.pzf,"onSetPolicyLabelFailureCallback"))):this.Og.Ul(this.V2a("setpolicylabel",!0),1,null,Jc,!0,2,Object(ya.a)(this,this.qzf,"onSetPolicyLabelSuccessCallback"),Object(ya.a)(this,this.pzf,"onSetPolicyLabelFailureCallback"),se,void 0,void 0,void 0,void 0,
"32");this.Dqa++;da.ULS.sendTraceTag(41799706,306,50,"Set policy label request sent to server. Policy call times: {0}",this.Dqa)}else da.ULS.sendTraceTag(570972052,306,50,"SetPolicyLabelRequestInternalAsync was exited - ApplyManualPolicyLabel was not enabled.")};w.prototype.FWf=function(){var gc=new wd.StandardDialog,fd=this.ub.Ua("BreadcrumbFolderUrl");fd?(gc.kc=11,gc.Cc(1,CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoAction),gc.Cc(2,CommonUIStrings.l_DialogOk)):(gc.kc=
0,gc.Cc(1,CommonUIStrings.l_DialogOk));gc.mje(CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoHelpText,"0f6cd105-974f-44a4-aadb-43ac5bdfd247");gc.M2i();gc.HW(CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoTitle,CommonUIStrings.l_SensitivityApplicationErrorMinorVersionLimitReachedViewInfoMessage,function(vd){1===vd&&fd&&Ac.a.sf(fd,"_blank",void 0,"SetPolicyLabelFailureBusinessBarActionCallback.BreadcrumbFolderUrl")})};w.prototype.f2c=function(gc){switch(gc){case 1:return Xd.a.Gha(1,
1);case 2:return Xd.a.Gha(7,1);case 3:return Xd.a.Gha(8,1);default:return Xd.a.Gha(7,0)}};w.prototype.m2g=function(gc){gc=void 0===gc?null:gc;if(!gc)return Xd.a.Gha(8,0);switch(gc.cP){case 1:case 16:return Xd.a.Gha(1,1);case 4:case 2:case 8:return Xd.a.Gha(8,1);default:return Xd.a.Gha(8,0)}};tl.Object.defineProperties(w.prototype,{Hkd:{configurable:!0,enumerable:!0,get:function(){return this.wIc}},Mld:{configurable:!0,enumerable:!0,get:function(){if(!this.R2d)return!1;for(var gc=yl(this.R2d.YRj()),
fd=gc.next();!fd.done;fd=gc.next())if(fd=fd.value,!fd.Capabilities||!fd.Capabilities.SupportsClientIsMipTrusted)return!1;return!0}},Gei:{configurable:!0,enumerable:!0,get:function(){return!!this.jEa}}});Object(Tb.a)(w,"PolicyManager",null,[310]);var bc=b(144),Qd=b(274);G.prototype.init=function(){var gc=this;Fb.AFrameworkApplication.ga.ra("ShouldInitCommonPolicyPackage")&&(Fb.AFrameworkApplication.ga.ra("IsDataLossPreventionEnabledForUser")&&Fb.AFrameworkApplication.sa&&(this.dh=this.rb.resolve("Common.App.Policy.Contracts.IPolicyManager"),
this.dh.vle(Object(ya.a)(this,this.uPd,"showPolicyBusinessBar")),da.ULS.sendTraceTag(36537375,306,50,"PolicyManager is created successfully."),bc.a.get_instance().xl(6,function(){gc.dh.i$b()})),Fb.AFrameworkApplication.ga.ra("WacLabelingPoliciesIsEnabled")&&Fb.AFrameworkApplication.ga.ra("SupportsPolicies")?bc.a.get_instance().xl(6,Object(ya.a)(this,this.Jyi,"onAfterRibbonBehaviorAttached")):ma.CPa(!1))};G.prototype.dispose=function(){};G.prototype.di=function(gc){gc.register(310,"Common.App.Policy.Contracts.IPolicyManager").zc().Ic(function(){return new w(Fb.AFrameworkApplication.ga,
Fb.AFrameworkApplication.Hd,Fb.AFrameworkApplication.sa.fD,Fb.AFrameworkApplication.ga.zd("MaxGetPolicyRetries",1),gc.mc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"),Fb.AFrameworkApplication.sa.Pa.Lj)});gc.register(ma,"Common.App.Policy.PolicyActor").as("Common.App.Policy.Contracts.IPolicyActor").zc().Ic(function(){return new ma(Fb.AFrameworkApplication.Eb,Fb.AFrameworkApplication.sa,Fb.AFrameworkApplication.ga,gc.LId("Common.App.Policy.Contracts.IPolicyManager"))});this.rb=gc};
G.prototype.Jyi=function(){this.jqa=this.rb.resolve("Common.App.Policy.PolicyActor");this.jqa.Mg();this.Y0=this.rb.Hh("CommonUI.BusinessBar");this.dh||(this.dh=this.rb.resolve("Common.App.Policy.Contracts.IPolicyManager"));this.dh.oTc(Object(ya.a)(this,this.AVd,"updateLabelInfo"));Fb.AFrameworkApplication.ga.ra("WacApplyManualPolicyLabelIsEnabled")&&(this.dh.ITc(Object(ya.a)(this,this.FYh,"handleSetPolicyLabelFailure")),this.dh.lke(Object(ya.a)(this,this.aXb,"addAutoPolicyBusinessBarEntry")),this.dh.Ale(Object(ya.a)(this,
this.Gca,"removeAutoPolicyBusinessBarEntry")),this.dh.mke(Object(ya.a)(this,this.uSc,"addMandatoryLabellingBusinessBarEntry")),this.dh.Ble(Object(ya.a)(this,this.gGd,"removeMandatoryLabellingBusinessBarEntry")))};G.prototype.AVd=function(gc,fd){this.jqa.wWf();this.jqa.OVf();this.jqa.FGf();gc=this.dh.CSg();Fb.AFrameworkApplication.ga.ra("HasDocumentEditRights")&&!gc?Fb.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.DefaultAndMandatoryLabelingDecouplingEnabled",!1)?this.jqa.K6f():
(this.jqa.QLd(),fd.onSuccess&&this.jqa.wEj()):da.ULS.sendTraceTag(558682911,306,50,"Default/Mandatory Labeling has been skipped because HasDocumentEditRights: {0}, IsClpBlockedByAppSpecificScenario: {1}",Fb.AFrameworkApplication.ga.ra("HasDocumentEditRights"),gc);Fb.AFrameworkApplication.sa.updateCommandUI()};G.prototype.uPd=function(gc,fd){this.uZe(fd.title,fd.aoc,38,fd.hrf,fd.buttonText);da.ULS.sendTraceTag(34174784,306,10,"Failed to add entry to business bar. Policy message could not be shown to user.")};
G.prototype.FYh=function(gc,fd){if(fd.N_f){gc=CommonUIStrings.l_SensitivityApplicationErrorBusinessBarTitle;var vd=CommonUIStrings.l_SensitivityApplicationErrorBusinessBarMessage,se=null,Jc=null;Fb.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CommonBusinessBarEntryForSensitivityLabelError",!1)?(gc=fd.title,vd=fd.message,se=fd.buttonText,Jc=fd.hY):1===fd.errorType?(gc=CommonUIStrings.l_SensitivityApplicationErrorFileTooLargeBusinessBarTitle,vd=CommonUIStrings.l_SensitivityApplicationErrorFileTooLargeBusinessBarMessage):
2===fd.errorType?(gc=CommonUIStrings.l_SensitivityApplicationErrorLabelNotSupportedBusinessBarTitle,vd=CommonUIStrings.l_SensitivityApplicationErrorLabelNotSupportedBusinessBarMessage):Fb.AFrameworkApplication.ga.ra("ClpLabelDisabledErrorCodeIsEnabled")&&3===fd.errorType?(gc=CommonUIStrings.l_SensitivityApplicationErrorLabelDisabledBusinessBarTitle,vd=CommonUIStrings.l_SensitivityApplicationErrorLabelDisabledBusinessBarMessage):4===fd.errorType?(gc=CommonUIStrings.l_SensitivityCoauthMandatoryApplicationErrorTitle,
vd=CommonUIStrings.l_SensitivityCoauthMandatoryApplicationErrorMessage):5===fd.errorType&&(gc=fd.title,vd=fd.message,se=fd.buttonText,Jc=fd.hY);this.uZe(gc,vd,21,null,null,Jc,se);da.ULS.sendTraceTag(42074654,306,10,"Failed to add entry to business bar. CLP policy message could not be shown to user.")}};G.prototype.Gca=function(){};G.prototype.aXb=function(gc,fd){this.Y0&&(this.dh.Gca(fd.cob),gc=new hb.a(fd.title,fd.message,null),gc.id=fd.cob,gc.closeable=!0,gc.image=3,gc.addButton(fd.buttonText,fd.hY,
fd.buttonText,!0),this.Y0.BD(gc,!1))};G.prototype.uSc=function(gc,fd){this.Y0&&(gc=new hb.a(fd.title,fd.message,null),gc.id=fd.cob,gc.closeable=!1,gc.image=3,gc.addButton(fd.buttonText,fd.hY,fd.buttonText,!1),this.Y0.BD(gc,!1))};G.prototype.gGd=function(){};G.prototype.uZe=function(gc,fd,vd,se,Jc,Bc,Ae){se=void 0===se?null:se;Jc=void 0===Jc?null:Jc;Bc=void 0===Bc?null:Bc;Ae=void 0===Ae?null:Ae;gc=new hb.a(gc,fd,null);gc.id=vd;gc.closeable=!0;se&&gc.Xwg(Jc,se);Bc&&gc.addButton(Ae,Bc,Ae)};G.main=function(){Qd.a.instance.mj(new G)};
tl.Object.defineProperties(G.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.Policy"}}});Object(Tb.a)(G,"PackageManager",null,[4,5]);var Vd=b(10),de=b(685),pe=b(216),Ad=b(56),Pd=b(35),Ce=b(84),Jf=b(36),oc=b(306),ed=b(368),wc=b(163),gb=b(92),id=b(27),ib=b(302),nc=b(1),Nb=b(19),mb=b(273);Object(Tb.a)(r,"ApplyPolicyContextParameters",null,[]);var Lc=b(816),zd=b(584),jd=b(44),ge=b(42);Object(Tb.a)(z,"AnnotationActivationOptions",null,[]);var Yd=b(81),rd=b(848),je=b(821),
re=rd.a;vm(A,re);A.getTypeName=function(){return"AugLoop_SecurityClp_LabellingAnnotation"};A.pe=function(){return["AugLoop_Core_Annotation"]};Object(Tb.a)(A,"LabellingAnnotation",rd.a,[]);var ae=b(849),Uf=ae.a;vm(m,Uf);m.getTypeName=function(){return"AugLoop_SecurityShared_SecurityShared"};m.pe=function(){return[]};Object(Tb.a)(m,"SecurityShared",ae.a,[]);vm(v,m);v.getTypeName=function(){return"AugLoop_SecurityShared_CLP"};v.pe=function(){return["AugLoop_SecurityShared_SecurityShared"]};Object(Tb.a)(v,
"CLP",m,[]);var Lf=rd.a;vm(u,Lf);u.getTypeName=function(){return"AugLoop_Automatic_Clp_LabellingAnnotation"};u.pe=function(){return["AugLoop_Core_Annotation"]};Object(Tb.a)(u,"LabellingAnnotation",rd.a,[]);var Of=b(1125),Yf=b(1016),vg=b(1127),Af=rd.a;vm(f,Af);f.getTypeName=function(){return"AugLoop_LinkedDataType_LinkedDataTypeAnnotation"};f.pe=function(){return["AugLoop_Core_Annotation"]};Object(Tb.a)(f,"LinkedDataTypeAnnotation",rd.a,[]);var rf=Jf.a;vm(l,rf);l.prototype.dispose=function(){this.disposed||
(this.disposed=!0,this.O9g(),this.uEe(),this.jBd=this.policyManager=this.augmentationLoopManager=null,rf.prototype.dispose.call(this))};l.prototype.fYa=function(gc,fd,vd,se,Jc){Jc=void 0===Jc?!1:Jc;da.ULS.sendTraceTag(537154642,306,50,"AutoPolicyManager: ApplyAutoPolicyLabel called for LabellingSource {0} with AutoLabelPresent: {1}, RecommendedLabelPresent: {2}, isStandard: {3}.",se,!!gc,!!fd,Jc);this.oc?this.jBd&&(this.gQg(fd,se)?(this.ACd=fd,this.vCd=se,this.xgf.ia(se,fd)):fd=this.ACd,gc=this.jBd.fYa(gc,
fd,vd,Jc),da.ULS.sendTraceTag(537154640,306,50,"AutoPolicyManager::ApplyAutoPolicyLabel - policyActor.ApplyAutoPolicyLabel returned {0}.",gc)):da.ULS.sendTraceTag(537154641,306,15,"AutoPolicyManager: ApplyAutoPolicyLabel failing because IsDisposed: {0}, IsSessionActive: {1}.",this.disposed,this.$.fa.oc)};l.prototype.gQg=function(gc,fd){if(!this.policyManager.zga())return da.ULS.sendTraceTag(537154639,306,15,"CanShowRecommendedSensitivityLabel - Labels are not available."),!1;var vd=this.policyManager.pn;
var se=this.xgf.Ec(this.vCd).value;var Jc=null,Bc=null,Ae=null;vd=yl(vd.SensitivityLabels);for(var cb=vd.next();!cb.done;cb=vd.next())cb=cb.value,cb.Id===gc&&(Jc=cb),cb.Id===se&&(Bc=cb),cb.Id===this.ACd&&(Ae=cb);return Bc&&Bc.Id===gc?(da.ULS.sendTraceTag(537154638,306,50,"AutoPolicyManager: CanShowRecommendedSensitivityLabel - Suppressing the recommendation since it is same as last recommendation from current source."),!1):this.businessBar.MB(39)&&this.vCd!==fd&&Ae&&(!Jc||Ae.Order>=Jc.Order)?(da.ULS.sendTraceTag(537154637,
306,50,"AutoPolicyManager: CanShowRecommendedSensitivityLabel - Suppressing the recommendation since current label priority is lower than last label priority."),!1):!0};l.prototype.Dkd=function(){return nc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)};l.prototype.f0i=function(){this.policyManager.lke(this.XZf);this.policyManager.Ale(this.YKf);this.$.fa.j9(this.J5);this.Dkd()&&(this.policyManager.Rzg(this.A2b),this.policyManager.PCg(this.h9f),this.policyManager.QCg(this.i9f))};
l.prototype.O9g=function(){this.businessBar.removeEntry(39);this.businessBar.removeEntry(38);this.policyManager.C3i(this.XZf);this.policyManager.X5i(this.YKf);this.$.fa.w6(this.J5);nc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)&&(this.policyManager.i4i(this.A2b),this.policyManager.E6i(this.h9f),this.policyManager.F6i(this.i9f))};l.prototype.z2h=function(){this.aA=new Lc.a(zd.a.JJ());var gc=this.Dkd()?A.getTypeName():u.getTypeName();this.aA.add(1,Object.assign(new z,
{annotationType:gc,bYa:this.Tii,FE:!1,aLa:!1}));this.aA.add(2,Object.assign(new z,{annotationType:f.getTypeName(),bYa:this.Kki,FE:!1,aLa:!1}))};l.prototype.h3f=function(){for(var gc=yl(this.$8a),fd=gc.next();!fd.done;fd=gc.next())this.augmentationLoopManager.submitOperation(fd.value);this.$8a=[]};l.prototype.$_i=function(gc){if(!this.aA.wb(gc))return da.ULS.sendTraceTag(537154636,306,15,"AutoPolicyManager::RegisterAnnotation - AnnotationActivationOptions not available for LabellingSource {0}.",gc),
!1;if(this.aA.na(gc).FE)return da.ULS.sendTraceTag(537154635,306,15,"AutoPolicyManager::RegisterAnnotation - Annotations already registered for LabellingSource {0}.",gc),!0;this.aA.na(gc).FE=!0;da.ULS.sendTraceTag(537154634,306,50,"AutoPolicyManager::RegisterAnnotation - Annotations registered for LabellingSource {0}.",gc);if(!this.$.isEditMode)return da.ULS.sendTraceTag(537154633,306,50,"AutoPolicyManager::RegisterAnnotation - Skipping AugmentationLoop initialization in view mode."),!0;nc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",
!1)?this.ywb():this.s7e();return!0};l.prototype.s7e=function(){for(var gc=this,fd=!1,vd=yl(this.aA),se=vd.next();!se.done&&!(fd=se.value.value.FE||fd);se=vd.next());fd?this.augmentationLoopManager?(da.ULS.sendTraceTag(537154631,306,50,"AutoPolicyManager::InitAugmentationLoopIfNecessaryAndActivateAnnotations - AugmentationLoop already initialized."),this.yWb()):this.yYa?da.ULS.sendTraceTag(537154630,306,50,"AutoPolicyManager::InitAugmentationLoopIfNecessaryAndActivateAnnotations - AugmentationLoop initialization in-progress."):
(this.yYa=!0,fd=this.$.ya.FlightingSettings.AutoCLPStartUpDelay,da.ULS.sendTraceTag(537154629,306,50,"AutoPolicyManager::InitAugmentationLoopIfNecessaryAndActivateAnnotations - Initializing AugmentationLoop in {0} milliseconds.",fd),jd.a.instance.create(function(){gc.B2h()},fd,ge.a.tqe,!0,!0)):da.ULS.sendTraceTag(537154632,306,50,"AutoPolicyManager::InitAugmentationLoopIfNecessaryAndActivateAnnotations - no registered annotations.")};l.prototype.ywb=function(){var gc=this,fd=0<this.$8a.length;if(!fd)for(var vd=
yl(this.aA),se=vd.next();!se.done&&!(fd=se.value.value.FE||fd);se=vd.next());fd?this.augmentationLoopManager?(da.ULS.sendTraceTag(537154627,306,50,"AutoPolicyManager::InitAugmentationLoopIfNecessary - AugmentationLoop already initialized."),this.yWb(),this.h3f()):this.yYa?da.ULS.sendTraceTag(537154626,306,50,"AutoPolicyManager::InitAugmentationLoopIfNecessary - AugmentationLoop initialization in-progress."):(this.yYa=!0,fd=this.$.ya.FlightingSettings.AutoCLPStartUpDelay,da.ULS.sendTraceTag(537154625,
306,50,"AutoPolicyManager::InitAugmentationLoopIfNecessary - Initializing AugmentationLoop in {0} milliseconds.",fd),jd.a.instance.create(function(){gc.C2h()},fd,ge.a.tqe,!0,!0)):da.ULS.sendTraceTag(537154628,306,50,"AutoPolicyManager::InitAugmentationLoopIfNecessary - no registered annotations and operations.")};l.prototype.C2h=function(){var gc=this;Pd.TaskExtensions.Ba(Ad.GetServiceTaskFactory.Xa(this.$.da,328,327,1),function(fd){gc.augmentationLoopManager=fd.result;gc.yYa=!1;gc.augmentationLoopManager?
(da.ULS.sendTraceTag(537154595,306,50,"AutoPolicyManager::InitAugmentationLoop - AugmentationLoopManager instantiated."),gc.augmentationLoopManager.gSc(gc.Nkc),gc.$.isEditMode?(gc.yWb(),gc.h3f()):da.ULS.sendTraceTag(537154594,306,50,"AutoPolicyManager::InitAugmentationLoop - Skipping annotation activation in view mode.")):da.ULS.sendTraceTag(537154624,306,10,"AutoPolicyManager::InitAugmentationLoop - Failed to instantiate AugmentationLoopManager.")},this.ma,3)};l.prototype.B2h=function(){var gc=this;
Pd.TaskExtensions.Ba(Ad.GetServiceTaskFactory.Xa(this.$.da,328,327,1),function(fd){gc.augmentationLoopManager=fd.result;gc.yYa=!1;gc.augmentationLoopManager?(da.ULS.sendTraceTag(571479120,306,50,"AutoPolicyManager::InitAugmentationLoop - AugmentationLoopManager instantiated."),gc.augmentationLoopManager.gSc(gc.Nkc),gc.$.isEditMode?gc.yWb():da.ULS.sendTraceTag(537154592,306,50,"AutoPolicyManager::InitAugmentationLoop - Skipping annotation activation in view mode.")):da.ULS.sendTraceTag(537154593,306,
10,"AutoPolicyManager::InitAugmentationLoop - Failed to instantiate AugmentationLoopManager.")},this.ma,3)};l.prototype.uEe=function(){for(var gc=yl(this.aA),fd=gc.next();!fd.done;fd=gc.next())fd=fd.value,fd.value.FE&&this.N9g(fd.key)};l.prototype.N9g=function(gc){this.aA.na(gc).aLa&&this.sDe(gc);this.aA.na(gc).FE=!1;da.ULS.sendTraceTag(537154591,306,50,"AutoPolicyManager::DeregisterAnnotation completed for LabellingSource {0}.",gc)};l.prototype.yWb=function(){for(var gc=yl(this.aA),fd=gc.next();!fd.done;fd=
gc.next())fd=fd.value,fd.value.FE&&!fd.value.aLa&&this.activateAnnotation(fd.key)};l.prototype.activateAnnotation=function(gc){this.augmentationLoopManager.activateAnnotation(this.aA.na(gc).annotationType);this.augmentationLoopManager.bT(this.aA.na(gc).annotationType,this.aA.na(gc).bYa);this.aA.na(gc).aLa=!0;da.ULS.sendTraceTag(537154590,306,50,"AutoPolicyManager::ActivateAnnotation completed for LabellingSource {0}.",gc)};l.prototype.e8g=function(){for(var gc=yl(this.aA),fd=gc.next();!fd.done;fd=
gc.next())fd=fd.value,fd.value.aLa&&this.sDe(fd.key)};l.prototype.sDe=function(gc){this.augmentationLoopManager.MFb(this.aA.na(gc).annotationType,this.aA.na(gc).bYa);this.aA.na(gc).aLa=!1;da.ULS.sendTraceTag(537154589,306,50,"AutoPolicyManager::DeactivateAnnotation completed for LabellingSource {0}.",gc)};l.prototype.applyPolicyLabel=function(gc,fd,vd,se){var Jc=this;if(this.ga.ra("SupportsOfficeClientCoauthoring"))da.ULS.sendTraceTag(537154579,306,50,"AutoPolicyManager::ApplyPolicyLabel - SupportsOfficeClientCoauthoring is enabled."),
this.fYa(gc,fd,vd,se);else{da.ULS.sendTraceTag(537154578,306,50,"AutoPolicyManager::ApplyPolicyLabel - SupportsOfficeClientCoauthoring is disabled.");var Bc=function(Ae){Jc.fYa(gc,fd,vd,se,!Ae||1===Ae||4===Ae)};this.fed(Bc,function(){Bc(2)},this.Alf)}};l.prototype.FVc=function(gc,fd){var vd=this.v7f(gc);gc=vd.sensitivityLabel;var se=vd.zFa;if(!vd.returnValue)return da.ULS.sendTraceTag(537154577,306,15,"AutoApplyOrRecommendPolicyLabel - Failed to set the sensitivity labels."),!1;if(se&&se.Order>=gc.Order)return da.ULS.sendTraceTag(537154576,
306,50,"AutoApplyOrRecommendPolicyLabel - The applied label has a higher sensitivty."),!1;this.applyPolicyLabel(gc.Id,gc.Id,null,fd);return!0};l.prototype.GVc=function(gc,fd){var vd=this;fd=!1;var se=null,Jc=null;if(!function(){var cb=vd.v7f(gc);se=cb.sensitivityLabel;Jc=cb.zFa;return cb}().returnValue)return da.ULS.sendTraceTag(537154575,306,15,"AutoApplyOrRecommendPowerBILabel - Failed to set the sensitivity labels."),{returnValue:!1,xLa:fd};if(Jc&&Jc.ParentId&&se.ParentId&&Jc.ParentId===se.ParentId)return da.ULS.sendTraceTag(537154574,
306,50,"AutoPolicyManager::AutoApplyOrRecommendPowerBILabel - Label has a common parent with AppliedLabel."),{returnValue:!1,xLa:fd};if(Jc&&Jc.Order>=se.Order)return da.ULS.sendTraceTag(537154573,306,50,"AutoPolicyManager::AutoApplyOrRecommendPowerBILabel - Label does not have a higher priority than AppliedLabel."),{returnValue:!1,xLa:fd};if(this.ga.ra("SupportsOfficeClientCoauthoring")){da.ULS.sendTraceTag(537154572,306,50,"AutoPolicyManager::AutoApplyOrRecommendPowerBILabel - SupportsOfficeClientCoauthoring is enabled.");
var Bc=this.policyManager.pn;Bc=!Bc.AppliedPolicyId||!Bc.PolicyLabelAssignmentMethod||ub.c(Bc.PolicyLabelAssignmentMethod)===ub.c("standard");this.Soe(se.Id,Bc)}else{da.ULS.sendTraceTag(537154571,306,50,"AutoPolicyManager::AutoApplyOrRecommendPowerBILabel - SupportsOfficeClientCoauthoring is disabled.");var Ae=function(cb){vd.Soe(se.Id,!cb||1===cb||4===cb)};this.fed(Ae,function(){Ae(2)},this.Alf)}return{returnValue:!0,xLa:fd}};l.prototype.fed=function(gc,fd,vd,se){var Jc=this;se=void 0===se?0:se;
if(this.oc){var Bc=this.$.qa.ta.Xb();x(this.$.qa.ta,this.$.ya.DocumentHostInfo.TenantId,function(Ae){Jc.sOh(Ae,gc)},function(){Jc.rOh(gc,fd,vd,se)},null,null,Bc)}else da.ULS.sendTraceTag(537154570,306,15,"AutoPolicyManager: GetPolicyApplicationMethod failing because IsDisposed: {0}, IsSessionActive: {1}.",this.disposed,this.$.fa.oc)};l.prototype.sOh=function(gc,fd){da.ULS.sendTraceTag(537154569,306,50,"AutoPolicyManager: GetPolicyApplicationMethod web service call was successful.");this.oc?!gc||ib.a(gc)?
da.ULS.sendTraceTag(537154567,306,15,gc?"AutoPolicyManager: GetPolicyApplicationMethod result has non-status message.":"AutoPolicyManager: GetPolicyApplicationMethod result is null"):fd(gc.Result):da.ULS.sendTraceTag(537154568,306,50,"AutoPolicyManager: GetPolicyApplicationMethodSuccessCallback failing because IsDisposed: {0}, IsSessionActive: {1}.",this.disposed,this.$.fa.oc)};l.prototype.rOh=function(gc,fd,vd,se){da.ULS.sendTraceTag(537154566,306,15,"AutoPolicyManager: GetPolicyApplicationMethod web service call failed. Trying again");
this.oc?se>=vd?(da.ULS.sendTraceTag(537154564,306,15,"AutoPolicyManager: GetPolicyApplicationMethod max retries exhausted."),fd()):this.fed(gc,fd,vd,se+1):da.ULS.sendTraceTag(537154565,306,50,"AutoPolicyManager: GetPolicyApplicationMethodFailureCallback failing because IsDisposed: {0}, IsSessionActive: {1}.",this.disposed,this.$.fa.oc)};l.prototype.Soe=function(gc,fd){fd?this.fYa(gc,null,null,3,!0):this.fYa(null,gc,null,3,!1)};l.prototype.v7f=function(gc){var fd;var vd=fd=null;if(!this.$.isEditMode)return{returnValue:!1,
sensitivityLabel:fd,zFa:vd};if(!this.policyManager.zga())return da.ULS.sendTraceTag(537154529,306,15,"TryGettingSensitivityLabels - Labels are not available."),{returnValue:!1,sensitivityLabel:fd,zFa:vd};var se=this.policyManager.pn;if(!se)return da.ULS.sendTraceTag(537154528,306,15,"TryGettingSensitivityLabels - GetPolicyLabelsData returned an invalid result."),{returnValue:!1,sensitivityLabel:fd,zFa:vd};if(Jd.a.yj(se.SensitivityLabels))return da.ULS.sendTraceTag(537154527,306,15,"TryGettingSensitivityLabels - Attempting to apply labels when there are no sensitivity labels available."),
{returnValue:!1,sensitivityLabel:fd,zFa:vd};var Jc=se.AppliedPolicyId;gc=yl(gc);for(var Bc=gc.next();!Bc.done;Bc=gc.next()){Bc=Bc.value;for(var Ae=yl(se.SensitivityLabels),cb=Ae.next();!cb.done;cb=Ae.next())cb=cb.value,cb.Id===Bc&&(!fd||fd.Order<cb.Order)&&(fd=cb),cb.Id===Jc&&(vd=cb)}return fd?{returnValue:!0,sensitivityLabel:fd,zFa:vd}:(da.ULS.sendTraceTag(537154526,306,10,"TryGettingSensitivityLabels - None of the sensitivity labels matched."),{returnValue:!1,sensitivityLabel:fd,zFa:vd})};tl.Object.defineProperties(l.prototype,
{oc:{configurable:!0,enumerable:!0,get:function(){return!this.disposed&&this.$.fa.oc}}});Object(Tb.a)(l,"AutoPolicyManager",Jf.a,[3]);var Cg=b(148),sc=b(11),Rc=b(14),Qc=Cg.ErrorDialog;vm(n,Qc);n.prototype.lm=function(){var gc=this;Qc.prototype.lm.call(this);if(this.error.Appearance&1&&this.$.Fd&2){var fd=this.getButton(0);sc.DOMElementExtensions.WLd(fd.get_element(),Rc.a.instance.ea(1269));this.$O(function(){0===gc.returnValue&&gc.$.Fd&2&&(da.ULS.sendTraceTag(50373725,306,50,"BlockSenitivityLabelActionDialog : Opening the book in excel desktop."),
Pd.TaskExtensions.Ba(Ad.GetServiceTaskFactory.Xa(gc.$.da,55,56,0),function(vd){vd.result.M0c()},gc.$.ma,3))})}};n.iQ=function(gc){return gc.Fd&2?id.a.jd(3,1,0,1908,0,-1237306487,"SensitivityLabelBlockApplyLabelOpenInDesktop"):id.a.jd(1,1,0,1909,0,-313914360,"SensitivityLabelBlockApplyLabel")};Object(Tb.a)(n,"BlockSenitivityLabelActionDialog",Cg.ErrorDialog,[]);var ee=Jf.a;vm(k,ee);k.prototype.initialize=function(){var gc=this;this.ga.ra("SupportsPolicies")?(this.rDa=this.ga.Ua("AppliedPolicyId"),
this.c6.Mg(),this.$.da.Za(29,function(fd){gc.statusBarManager=fd;fd.$I(gc)}),this.gz(),nc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CLPHostAuthenticationId",!1)&&!this.ga.Ua("HostUserId")||this.pRi(),this.c6.h0i(this.eKg),this.c6.X0i(this.m8h),this.fr.d0i(this.Mld),this.fo=nc.EwaSettings.getBooleanFeatureGate(oc.a.QOa,!1)):nc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.CacheSensitivityVisibility",!1)&&Xc.c()&&appChrome.api.dispatch(appChrome.actions.updateControlHiddenState("Sensitivity",
!1));(!nc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CLPHostAuthenticationId",!1)||this.ga.Ua("HostUserId"))&&nc.EwaSettings.la(169)&&this.$.fa.ih.get(45)&&(da.ULS.sendTraceTag(537154524,306,50,"DataLossPrevention feature is Enabled and launched on Excel."),this.GHh())};k.prototype.iq=function(gc){this.addHandler("LabelInfoChangedKey",gc)};k.prototype.zq=function(gc){this.removeHandler("LabelInfoChangedKey",gc)};k.prototype.gn=function(){return!0};k.prototype.Jr=function(gc,fd){if("QueryPolicyLabel"!==
gc)return!1;if(this.eRa())return fd.Visible=!1,!0;fd.Visible=!0;return 32===Fb.AFrameworkApplication.Eb.ze(tb.a.f$a,2,fd)};k.prototype.dispose=function(){this.statusBarManager&&(this.statusBarManager.iF(this),this.statusBarManager=null);this.c6.XLb();this.DWc=!1;this.fr.n6i(this.o0f);this.fr.o6i(this.ozf);this.$.fa.mw(this.uja);if(this.ga.ra("SupportsOfficeClientCoauthoring")){var gc=this.$.da.Aa(292);gc&&gc.a5i(this.Fvf)}this.fr.E3i(this.rje);this.fr.Y5i(this.vLf);this.fr.l5i(this.olf);this.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LabelHasUDPEnabled",
!1)&&this.fr.D6i(this.U7f);nc.EwaSettings.la(295)&&this.fr.H4i(this.gIe);this.D9&&(this.D9.dispose(),this.D9=null);ee.prototype.dispose.call(this)};k.prototype.FVc=function(gc,fd){if(!this.ga.ra("SupportsPolicies"))return da.ULS.sendTraceTag(537154523,306,15,"AutoApplyOrRecommendPolicyLabel - Called when SupportPolicies is disabled."),!1;if(!this.kBd)return da.ULS.sendTraceTag(537154522,306,15,"AutoApplyOrRecommendPolicyLabel - PolicyData hasn't been received yet."),!1;if(Jd.a.yj(gc))return!1;this.D9||
this.ljd();return this.D9.FVc(gc,fd)};k.prototype.gz=function(){this.raiseEvent("LabelInfoChangedKey")};k.prototype.GHh=function(){var gc=this;nc.EwaSettings.isChangeGateEnabled("OfficeVSO:6000793_RibbonDisplayedDependencyInDataLossPolicyCall")?bc.a.get_instance().xl(10,function(){gc.fr.i$b()}):this.fr.i$b()};k.prototype.pRi=function(){var gc=this;bc.a.get_instance().xl(10,function(){gc.fr.oTc(gc.AVd);gc.fr.xAg(gc.Buf);gc.fr.wAg(gc.Buf);gc.fr.ITc(gc.o0f);gc.fr.Nle(gc.ozf);gc.$.fa.jt(gc.uja);gc.fr.mke(gc.rje);
gc.fr.Ble(gc.vLf);gc.fr.fBg(gc.olf);gc.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.LabelHasUDPEnabled",!1)&&gc.fr.NCg(gc.U7f);if(gc.ga.ra("SupportsOfficeClientCoauthoring")){var fd=gc.$.da.Aa(292);fd&&fd.WAg(gc.Fvf)}nc.EwaSettings.la(295)&&(da.ULS.sendTraceTag(537154521,306,50,"PolicyManagerWrapper: ApplyAutomaticPolicyLabel enabled and registered GetAutoPolicyLabelHandler"),gc.fr.uAg(gc.gIe));gc.Eth()})};k.prototype.Eth=function(){this.ga.ra("SupportsOfficeClientCoauthoring")||this.labelId&&
this.labelId.length?this.y2a():this.ZCh(this.$.ya.DocumentHostInfo.TenantId)};k.prototype.ljd=function(){this.D9=new l(this.c6,this.fr,this.$,this.ga,this.KD)};k.prototype.eKf=function(gc){if(!this.ga.ra("SupportsPolicies"))return da.ULS.sendTraceTag(537154518,306,10,"PolicyManagerWrapper::RegisterAugmentationLoopAnnotations called when CLP is disabled."),!1;this.D9||this.ljd();return this.D9.$_i(gc)};k.prototype.GVc=function(gc,fd){if(nc.EwaSettings.isChangeGateEnabled("OfficeVSO:5697254_ApplyPowerBiLabel")){if(!this.ga.ra("SupportsPolicies"))return da.ULS.sendTraceTag(537154517,
306,10,"PolicyManagerWrapper::AutoApplyOrRecommendPowerBILabel called when CLP is disabled."),{returnValue:!1,xLa:!1};if(!this.kBd)return da.ULS.sendTraceTag(537154516,306,15,"PolicyManagerWrapper::AutoApplyOrRecommendPowerBILabel called before PolicyData fetch is complete."),{returnValue:!1,xLa:!0};this.D9||this.ljd();return this.D9.GVc(gc,fd)}da.ULS.sendTraceTag(537154515,306,10,"PolicyManagerWrapper::AutoApplyOrRecommendPowerBILabel called when BRS ApplyPowerBiLabel is disabled.");return{returnValue:!1,
xLa:!1}};k.prototype.ZCh=function(gc){var fd=this;da.ULS.sendTraceTag(537154514,306,50,"PolicyManagerWrapper: Doing GetPolicyLabelId web service call with tenantId length {0}",gc.length);var vd=this.$.qa.ta.Xb();t(this.$.qa.ta,gc,function(se){fd.Wyj(se)},null,null,null,vd)};k.prototype.Wyj=function(gc){da.ULS.sendTraceTag(537154513,306,50,"PolicyManagerWrapper: GetPolicyLabelId web service call was successful");gc&&!ib.a(gc)&&(this.rDa=gc.Result);this.y2a();this.labelId?da.ULS.sendTraceTag(537154512,
306,50,"PolicyManagerWrapper: Fetched LabelId length from custom.xml is {0}",this.labelId.length):da.ULS.sendTraceTag(537154511,306,50,"PolicyManagerWrapper: LabelId is invalid")};k.prototype.y2a=function(){this.fr.ccd(this.labelId,void 0,void 0,!1)};k.prototype.sOe=function(){if(!this.DWc){this.$.Gf();this.DWc=!0;this.KD.m3e();var gc={};gc.hasLabel=!!this.labelId&&0<this.labelId.length;gc.isProtectedFile=this.ga.ra("ProtectedFile");gc.SupportsPolicies=this.ga.ra("SupportsPolicies");gc.AreLabelsAvailableForDisplay=
this.fr.zga();gc.SupportsOfficeClientCoauthoring=this.ga.ra("SupportsOfficeClientCoauthoring");gc.IsAnonymousUser=this.ga.ra("IsAnonymousUser");da.ULS.sendTraceTag(51238051,306,50,"CLPUsage : {0}",JSON.stringify(gc))}};k.prototype.$Fg=function(){this.c6.aGg(this.hxa);this.hxa=null};k.prototype.h_h=function(gc){gc=yl(gc.LabelActions);for(var fd=gc.next();!fd.done;fd=gc.next())if(Nb.a.equals(fd.value.Name,"ApplyWatermark",!1))return!0;return!1};k.prototype.vrj=function(gc){gc?(new n(this.$)).mf():da.ULS.sendTraceTag(537154465,
306,50,"PolicyManagerWrapper.showBlockApplyLabelDialogDialog: Watermark Dialog box called with showDialog set to false from autoapply.")};k.prototype.applyPolicyLabel=function(gc,fd,vd,se){var Jc=this,Bc=pb.c(this.fr.pn);if(void 0===gc||null===gc)gc="";var Ae=new r;Ae.$nc=gc;Ae.WTf=se;Ae.cP=fd;var cb=this.$.qa.ta;ed.a(this.$.userOperationManager,function(mc,Oc,Sc){Oc=gc;var $c=Jc.$.ya.DocumentHostInfo.TenantId;mc=mb.b.call(null,Jc.Tyi,mc);var le=cb.Oa(41,null);le.labelsInfoJson=Bc;le.appliedLabelId=
Oc;le.tenantId=$c;le.applyLabelFlag=fd;le.skipApplyOutcomes=vd;return Yd.i(cb,"ApplyPolicyLabel",le,mc,null,Sc,Ae,0)},function(mc){return new wc.a(222,0,mc)},null);this.Zzc=!1;this.mLd=null};k.prototype.eRa=function(){var gc=this.$.da.Aa(478);return this.fo&&gc?gc.fo():!1};tl.Object.defineProperties(k.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return this.lp}},aoc:{configurable:!0,enumerable:!0,get:function(){return this.dbe}},linkText:{configurable:!0,enumerable:!0,get:function(){return this.ffa}},
yGi:{configurable:!0,enumerable:!0,get:function(){return this.X$d}},labelId:{configurable:!0,enumerable:!0,get:function(){return this.rDa}}});Object(Tb.a)(k,"PolicyManagerWrapper",Jf.a,[281,233,372]);var ue=pe.a;vm(c,ue);c.prototype.create=function(){var gc=this,fd=Ad.GetServiceTaskFactory.Xa(this.$.da,5,4,this.tb),vd=Fb.AFrameworkApplication.Hd,se=Fb.AFrameworkApplication.ga;Pd.TaskExtensions.Ba(fd,function(){try{var Jc=new de.a(function(){return new w(se,vd,Fb.AFrameworkApplication.sa.fD,gc.$.ya.MaxGetPolicyRetries,
Ta.a.instance.mc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper"))}),Bc=new de.a(function(){return new ma(Fb.AFrameworkApplication.Eb,Fb.AFrameworkApplication.sa,Fb.AFrameworkApplication.ga,Jc)}),Ae=gc.$.da.Aa(274);Ae||(Ae=new k(Jc.value,Bc.value,fd.result,gc.$,Fb.AFrameworkApplication.ga),Ae.initialize());gc.Fb(Ae)}catch(cb){throw da.ULS.sendTraceTag(537154525,306,10,"PolicyManager was not created successfully [Exception: {0}]",cb.toString()),cb;}},this.ma,3)};c.ja=function(gc){gc.da.Ha(275,
new c(gc))};Object(Tb.a)(c,"PolicyManagerFactory",pe.a,[]);var Ee=b(817),De=b(175);d.prototype.Xc=function(){return!1};d.prototype.executeCommand=function(gc,fd,vd){switch(fd.command){case tb.a.setSensitivity:return this.$.workbookContext.FileCoauthorable||(vd[pa.zUc]=this.$.workbookContext.ExclusiveLockId),gc=Fb.AFrameworkApplication.Eb.ze(tb.a.setSensitivity,2,vd),rc.Task.Ta(32===gc);case tb.a.i6:return gc=Fb.AFrameworkApplication.Eb.ze(tb.a.i6,2,vd),rc.Task.Ta(32===gc);case tb.a.j6:return gc=Fb.AFrameworkApplication.Eb.ze(tb.a.j6,
2,vd),rc.Task.Ta(32===gc);default:return De.a(fd.command)}};d.prototype.Gc=function(gc,fd){switch(fd.command){case tb.a.setSensitivity:case tb.a.i6:case tb.a.j6:return!0;default:return!1}};d.prototype.fd=function(gc,fd,vd){switch(fd){case "PopulateSensitivityFlyout":return 32===Fb.AFrameworkApplication.Eb.ze(tb.a.vya,2,vd);default:return!1}};Object(Tb.a)(d,"SensitivityCommandHandler",null,[237]);var ne=Ee.a;vm(a,ne);a.prototype.Md=function(){this.Ed([new d(this.$)])};a.ja=function(gc){Ee.a.de(316,
new a(gc))};Object(Tb.a)(a,"SensitivityCommandHandlerFactory",Ee.a,[]);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.Policy.Contracts");Type.registerNamespace("Common.App.Policy");G.main();(function(){Vd.a.Ga(function(gc){c.ja(gc);a.ja(gc)})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.policy.js.map/8d0d1afc534b068e7fe5a49a9c0c16e8/EwaDS.policy.js.map