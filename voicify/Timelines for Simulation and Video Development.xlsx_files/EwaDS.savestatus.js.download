(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[39],{1404:function(y,D,b){function a(R){var I=W.call(this)||this;I.Nc=R;I.dc();return I}function d(R,I){var Q=this;this.gde=this.zIc=!1;this.nDb=function(O,ba){(null===ba||void 0===ba?0:ba.AG)&&P.a.IGg([ba.AG])&&(Q.Bsc=!0)};this.vq=function(){Q.Bsc=!1};this.Zc=function(O,ba){N.b(ba)&&Q.Wda(!0);Q.Bsc=!1};this.od=function(){Q.uQ=Q.$.uQ;Q.Wda()};this.Eyf=function(){Q.$R()};this.Gxf=function(){Q.uQ=Q.$.uQ};this.fxd=function(){ia.g(Q.$).Ca.yq(Q.fxd);
Q.uQ=Q.$.uQ};this.PRf=I;this.$=R;this.$.userOperationManager.uy(this.Gxf);this.$.Rk(this.od);this.$.fa.mCg(this.Eyf);this.$.fa.Sj(this.Zc);this.$.xTc(this.nDb);this.$.fa.aP(this.vq);this.Wda()}function c(){this.oOc=this.rNc=this.kkb=this.rb=null}function k(R,I,Q,O){this.Cfa=this.vfa=this.Gfa=this.Ffa=null;this.ADa=0;this.vD=this.nOc=this.RBa=this.XCc=this.wEa=null;this.Ud=R;this.n8=I;this.i1=Q;this.fj=O;this.u6d=!0;this.rL=!1;this.Hz=3;this.wqa=!0}function n(R,I){this.Nr=null;this.Ffa=CommonUIStrings.l_SavedStatus;
this.Gfa=CommonUIStrings.l_SavingStatus;this.vfa=CommonUIStrings.l_ReadOnlyStatus;this.Cfa=CommonUIStrings.l_ReviewModeStatus;this.jRb=I;this.i1=R;this.Hz=3;this.wqa=!0}function l(R){this.Cfa=this.vfa=this.Gfa=this.Ffa=null;this.U7d=this.Hw=this.rL=!1;this.BNc=this.i8d=null;this.a8d=0;this.ub=this.g8d=null;this.i1=R;this.Hz=3;this.Shb=!0}b.r(D);y=b(0);var f=b(80),u=b(13),v=b(168),m=b(47);l.prototype.initialize=function(R,I,Q){var O=this;this.Ffa=this.Aed(R,I);this.Gfa=CommonUIStrings.l_SavingStatus;
this.vfa=CommonUIStrings.l_ReadOnlyStatus;this.Cfa=CommonUIStrings.l_ReviewModeStatus;this.i1&&this.i1.execute(function(ba){ba.sTc(Object(f.a)(O,O.zMb,"updateToSavingStatus"))});this.Hw=!0;this.ub=Q;return!0};l.prototype.Wda=function(R,I){this.rL=R;this.Hz=I;this.$R(this.Shb)};l.prototype.$R=function(R){!this.Shb&&R&&(this.g8d=new Date);this.Shb=R;R=null;3===this.Hz&&(R=this.Shb?this.Ffa:this.Gfa);this.hbh(R)};l.prototype.Aed=function(R,I){return R?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):
I&&I.length?String.format(CommonUIStrings.l_SavedToStatus,I):CommonUIStrings.l_SavedStatus};l.prototype.zMb=function(){this.$R(!1)};l.prototype.wMh=function(){switch(this.Hz){case 1:return this.vfa;case 2:return this.Cfa;default:return null}};l.prototype.G$h=function(R){return this.U7d===this.rL&&this.a8d===this.Hz&&this.i8d===R};l.prototype.HFe=function(R){var I=this;appChrome.getHeaderApi().then(function(Q){Q.updateDocumentTitleStatus(I.rL,R,I.wMh(),I.g8d,I.Shb);return null});this.BNc=null};l.prototype.hbh=
function(R){var I=this;this.Hw&&v.c()&&!this.G$h(R)&&(m.a.TOf()?(this.BNc&&u.ULS.sendTraceTag(595146389,340,50,"Previous UpdateDocumentTitleStatus idle callback can be cancelled."),this.BNc=window.requestIdleCallback(function(){I.HFe(R)})):window.requestAnimationFrame(function(){I.HFe(R)}),this.U7d=this.rL,this.i8d=R,this.a8d=this.Hz)};Object(y.a)(l,"ReactSaveStatusUIHandler",null,[326]);var A=b(170);n.prototype.Wu=function(){var R=this;this.i1&&this.i1.execute(function(I){I.sTc(Object(f.a)(R,R.zMb,
"updateToSavingStatus"))});this.jRb.execute(function(I){R.Nr=I})};n.prototype.Wda=function(R,I){this.Hz=I;3===I?this.$R(this.wqa):2===I?this.yUd(this.Cfa):this.yUd(this.vfa)};n.prototype.zMb=function(){this.$R(!1)};n.prototype.$R=function(R){this.wqa=R;this.yUd(this.wqa?this.Ffa:this.Gfa)};n.prototype.yUd=function(R){this.Nr&&this.Nr.Qj(A.a.kGj,this.cYg(R))};n.prototype.cYg=function(R){var I={};I.StatusText=R;return I};Object(y.a)(n,"SaveStatusPostMessageHandler",null,[326]);var x=b(834),t=b(165),
z=b(87);k.prototype.initialize=function(R,I){if(!this.Ud)return!1;this.Ffa=this.Aed(R,I);this.Gfa=CommonUIStrings.l_SavingStatus;this.vfa=CommonUIStrings.l_ReadOnlyStatus;this.Cfa=CommonUIStrings.l_ReviewModeStatus;this.Wu();return!0};k.prototype.Aed=function(R,I){return R?String.format(CommonUIStrings.l_SavedToStatus,CommonUIStrings.l_OneDriveName):I&&I.length?String.format(CommonUIStrings.l_SavedToStatus,I):CommonUIStrings.l_SavedStatus};k.prototype.Wu=function(){var R=this;this.n8&&this.n8.execute(function(I){I.MBg(Object(f.a)(R,
R.hCe,"createStatusAndModeElements"));I.DBg(Object(f.a)(R,R.ysj,"showHideSaveStatusElement"));I.wDj&&R.hCe(null,null)});this.i1&&this.i1.execute(function(I){I.sTc(Object(f.a)(R,R.zMb,"updateToSavingStatus"))})};k.prototype.Xs=function(){this.vD&&this.Ud&&this.Ud.GF(this.vD)};k.prototype.ysj=function(R,I){this.Wda("true"===I,this.Hz)};k.prototype.Wda=function(R,I){this.rL=R;this.Hz=I;this.XCc&&(this.XCc.style.display=this.rL||3===this.Hz||!this.wEa?"none":"");this.RBa&&(this.RBa.style.display=this.rL||
3===this.Hz?"none":"",this.RBa.innerText=1===this.Hz?this.vfa:this.Cfa,this.RBa.title=1===this.Hz?CommonUIStrings.l_ReadOnlyStatusTooltip:CommonUIStrings.l_ReviewModeStatusTooltip);this.nOc&&(this.nOc.style.display=this.rL||1===this.Hz||!this.wEa&&!this.RBa?"none":"");this.vD&&(this.vD.style.display=this.rL||1===this.Hz?"none":"",this.$R(this.wqa),this.vD.title=CommonUIStrings.l_SaveStatusTooltip)};k.prototype.hCe=function(R,I){R=document.getElementById(x.CuiHelper.Z4e);I&&I.nPj||!R||""===this.Ffa||
""===this.Gfa||""===this.vfa||""===this.Cfa||(this.wEa=document.getElementById(x.CuiHelper.b_b),this.XCc=x.CuiHelper.vsa(R,"BreadcrumbAppModeDash","-",null,!1),this.RBa=x.CuiHelper.vsa(R,"BreadcrumbAppModeStatus",1===this.Hz?this.vfa:this.Cfa,null,!1),this.R9f(this.RBa),this.nOc=x.CuiHelper.vsa(R,"BreadcrumbSaveStatusDash","-",null,!1),this.vD=x.CuiHelper.vsa(R,"BreadcrumbSaveStatus",this.Ffa,null,!1),this.R9f(this.vD),this.Wda(this.rL,this.Hz))};k.prototype.zMb=function(){this.$R(!1)};k.prototype.$R=
function(R){this.wqa=R;this.aLj(this.wqa?this.Ffa:this.Gfa)};k.prototype.aLj=function(R){!this.vD||3!==this.Hz&&2!==this.Hz||(this.u6d&&!this.wqa?(this.ADa=this.vD.offsetWidth<this.ADa?this.ADa:this.vD.offsetWidth,this.fIj(this.Gfa),this.u6d=!1):this.vD.innerText=R)};k.prototype.R9f=function(R){R.style.direction=this.fj?"rtl":"ltr";R.style.width="auto";R.style.textAlign=this.fj?"right":"left";R.style.display=this.rL?"none":"";R.setAttribute("Unselectable","on")};k.prototype.fIj=function(R){this.vD&&
(this.vD.style.width="",this.vD.innerText=R,this.ADa=this.vD.offsetWidth<this.ADa?this.ADa:this.vD.offsetWidth,R=t.a.qA(this.vD),this.vD.style.width=this.ADa-z.a.HC(R.paddingLeft)-z.a.HC(R.paddingRight)+1+"px")};Object(y.a)(k,"SaveStatusUIHandler",null,[326]);var r=b(5),G=b(97);c.prototype.di=function(R){var I=this;this.rb=R;r.AFrameworkApplication.ga.ra("PostMessageEmbedded")&&r.AFrameworkApplication.hideHeaderEmbedded?this.rb.register(n,"Common.App.SaveStatus.SaveStatusPostMessageHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").zc().Ic(function(){return new n(I.rb.mc("Common.App.HostNotification.EditNotificationEventSource"),
I.rb.mc("Postmessage.IHostPostmessenger"))}):r.AFrameworkApplication.sa.Pa.hef||(r.AFrameworkApplication.sa.Pa.isReactSharedHeaderUxEnabled?this.rb.register(l,"Common.App.SaveStatus.ReactSaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").zc().Ic(function(){return new l(I.rb.mc("Common.App.HostNotification.EditNotificationEventSource"))}):this.rb.register(k,"Common.App.SaveStatus.SaveStatusUIHandler").as("Common.App.SaveStatus.ISaveStatusUIHandler").zc().Ic(function(){return new k(G.EventHandlerManager.instance,
I.rb.mc("Common.App.Header.HeaderEventSource"),I.rb.mc("Common.App.HostNotification.EditNotificationEventSource"),r.AFrameworkApplication.isRtl)}))};c.prototype.init=function(){r.AFrameworkApplication.ga.$v(Object(f.a)(this,this.QA,"onFullAppSettingsReady"))};c.prototype.QA=function(){var R=r.AFrameworkApplication.ga,I=!!r.AFrameworkApplication.sa.Pa&&4===r.AFrameworkApplication.sa.Pa.Lj;if(R.ra("WordEditorAutoSaveImprovementIsEnabled")||R.ra("PptEditorSaveStatusInHeaderEnabled")||I&&R.ra("SimplifiedReactRibbonUxIsEnabled")||
R.ra("ExcelSaveStatusInHeaderEnabled")||R.ra("VisioSaveStatusInHeaderEnabled"))r.AFrameworkApplication.ga.ra("PostMessageEmbedded")&&r.AFrameworkApplication.hideHeaderEmbedded?(this.oOc=this.rb.resolve("Common.App.SaveStatus.SaveStatusPostMessageHandler"))&&this.oOc.Wu():r.AFrameworkApplication.sa.Pa.hef||(r.AFrameworkApplication.sa.Pa.isReactSharedHeaderUxEnabled?(this.rNc=this.rb.resolve("Common.App.SaveStatus.ReactSaveStatusUIHandler"))&&this.rNc.initialize(R.ra("IsSkyDrive"),R.Ua("HostNameToIncludeInSavedStatus"),
r.AFrameworkApplication.ga):(this.kkb=this.rb.resolve("Common.App.SaveStatus.SaveStatusUIHandler"))&&this.kkb.initialize(R.ra("IsSkyDrive"),R.Ua("HostNameToIncludeInSavedStatus")))};c.prototype.dispose=function(){this.kkb&&this.kkb.Xs()};tl.Object.defineProperties(c.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveStatus"}}});Object(y.a)(c,"PackageManager",null,[4,5]);D=b(274);var w=b(10),B=b(86),U=b(216),N=b(219),P=b(27),ia=b(20);d.prototype.dispose=function(){this.$&&
(this.$.ml(this.od),this.$.$Gd(this.nDb),this.$.userOperationManager&&this.$.userOperationManager.pz(this.Gxf),this.$.fa&&(this.$.fa.f6i(this.Eyf),this.$.fa.kk(this.Zc),this.$.fa.mW(this.vq)),ia.g(this.$)&&ia.g(this.$).Ca&&ia.g(this.$).Ca.yq(this.fxd))};d.prototype.Wda=function(R){R=!this.$.isEditMode||(void 0===R?!1:R);this.PRf.Wda(R,this.$.isEditMode?3:1);this.$R()};d.prototype.$R=function(){this.$.isEditMode&&this.PRf.$R(!this.uQ&&!this.dji&&!this.Bsc)};tl.Object.defineProperties(d.prototype,{dji:{configurable:!0,
enumerable:!0,get:function(){return this.$.fa?this.$.fa.Fgf:!1}},uQ:{configurable:!0,enumerable:!0,get:function(){return this.zIc},set:function(R){R?this.zIc=!0:ia.g(this.$)&&ia.g(this.$).Ca&&(ia.g(this.$).Ca.cH()?this.zIc=!1:ia.g(this.$).Ca.np(this.fxd));this.$R()}},Bsc:{configurable:!0,enumerable:!0,get:function(){return this.gde},set:function(R){this.gde=R;this.$R()}}});Object(y.a)(d,"SaveStatusManager",null,[3]);var W=U.a;vm(a,W);a.prototype.create=function(){var R=this,I=B.a.instance;I.mc("Common.App.SaveStatus.ISaveStatusUIHandler").execute(function(Q){var O=
new d(R.Nc,Q);I.register(d,"Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager").zc().Ic(function(){return O});R.Fb(I.resolve("Microsoft.Office.Excel.WebUI.Client.SaveStatus.SaveStatusManager"))})};a.ja=function(R){R.da.Ha(299,new a(R))};Object(y.a)(a,"SaveStatusFactory",U.a,[]);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.SaveStatus");D.a.instance.mj(new c);w.a.Ga(a.ja)}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.savestatus.js.map/965aafa38fbe8d034d151fc0eb94f0b5/EwaDS.savestatus.js.map