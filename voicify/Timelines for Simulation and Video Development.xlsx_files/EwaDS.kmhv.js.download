(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[4],{1087:function(y,D,b){function a(t,z){var r=this;this.Zc=function(){f.a.ug(v.a(r.$).nd.activityState,x.a.Fwd)||r.R$.reset()};this.$=z;this.Jic=t;this.fa=z.fa;this.fa.Sj(this.Zc);this.R$=A.a.Ppe(this.$)}function d(t){var z=this;this.ej=this.yBc=null;this._state=0;this.moveNext=function(){try{for(z._state=1;1===z._state;)z.hu=z.hu()}catch(r){z.dispose(),z._state=3}};this.wf=t;this.hu=this.fL;this.moveNext()}b.r(D);y=b(0);var c=
b(13),k=b(35),n=b(201),l=b(126),f=b(32),u=b(1),v=b(64),m=b(55);d.prototype.fL=function(){this.yBc=this.wf.$.Ub.Fc("LoadResource","DownloadACopyOperation");return this.lYd};d.prototype.lYd=function(){var t=b(1087).DownloadACopyOperation;if(this.wf.R$.I6e||!(this.yBc.Ac<t.hjc))return this.kdg;this.ej=m.Task.delay(t.IGe).g();this.ej.isCompleted||(this._state=2,this.ej.cN(this.moveNext));return this.Eeb};d.prototype.kdg=function(){var t=b(1087).DownloadACopyOperation;this.yBc.Ac>=t.hjc&&c.ULS.sendTraceTag(537154819,
0,15,"Download did not complete after 10 seconds.");v.a(this.wf.$).nd.kJ();this._state=3};d.prototype.Eeb=function(){this.ej.Sy();return this.lYd};d.prototype.dispose=function(){};Object(y.a)(d,"$$sm_Microsoft$Office$Excel$WebUI$Client$OpenInClient$DownloadACopyOperation$IframeCompleteLoadOld",null,[3]);var A=b(1181),x=b(133);b.d(D,"DownloadACopyOperation",function(){return a});a.prototype.$ch=function(){var t=this,z=this.HNg(this.$),r=this.$.userOperationManager.operationCount;0<r&&c.ULS.sendTraceTag(537154822,
0,15,"flushing queue in downloadcopy. Queue is {0}",r);this.$.userOperationManager.aaa("DownloadACopyOperation.DownloadForkedFile");this.Jic&&c.ULS.sendTraceTag(537154821,0,50,"DownloadACopyOperation - Dataloss scenario");this.R$.downloadFile(z,-21742208);u.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?k.TaskExtensions.Ba(m.Task.delay(1),function(){t.H6e()},this.R$.ma,3):k.TaskExtensions.Ba(m.Task.delay(1),function(){t.y1h()},
this.R$.ma,3)};a.prototype.dispose=function(){this.fa&&this.fa.kk(this.Zc);this.$=this.fa=null};a.prototype.H6e=function(t){var z=this;(t=void 0===t?null:t)||(t=this.$.Ub.Fc("LoadResource","DownloadACopyOperation"));!this.R$.I6e&&t.Ac<a.hjc?window.setTimeout(function(){z.H6e(t)},a.IGe):(t.Ac>=a.hjc&&c.ULS.sendTraceTag(537154820,0,15,"Download did not complete after 10 seconds."),v.a(this.$).nd.kJ())};a.prototype.y1h=function(){new d(this)};a.prototype.HNg=function(t){var z=new Sys.StringBuilder,r=
t.workbookContext,G=t.ya;z.append(t.hda);z.append(G.FileHandlerRelativeUri);z.append("?id=");z.append(encodeURIComponent(n.a.XFb(r.WorkbookUri,"sc")));t.fa.oc&&(z.append("&sessionId="),z.append(encodeURIComponent(t.fa.sessionId)));z.append("&workbookType=FullForkedWorkbook");z.append("&dataloss=");z.append(this.Jic?"true":"false");l.a.yFa(z,G);return z.toString()};a.hjc=1E5;a.IGe=100;Object(y.a)(a,"DownloadACopyOperation",null,[3])},1173:function(y,D,b){function a(l,f){l=n.call(this,l,f)||this;d.ULS.sendTraceTag(537170201,
0,50,"WacGdprNoticeBusinessBarEntry.WacGdprNoticeBusinessBarEntry: Called");l.title="";l.message=a.bxa;l.nKa=!0;return l}b.d(D,"a",function(){return a});y=b(0);var d=b(13),c=b(47),k=b(77);b=b(831);var n=b.a;vm(a,n);a.prototype.ula=function(l){n.prototype.ula.call(this,l);c.a.openWindow(4,k.a.NG(a.Kkf))};a.prototype.XE=function(l){n.prototype.XE.call(this,l);a.Ssd&&a.Ssd(null)};a.initialize=function(l,f,u,v){d.ULS.sendTraceTag(537170200,0,50,"WacGdprNoticeBusinessBarEntry.Initialize: Called");a.bxa=
l;a.Lkf=f;a.Kkf=u;a.Ssd=v};tl.Object.defineProperties(a.prototype,{linkText:{configurable:!0,enumerable:!0,get:function(){return a.Lkf}}});a.bxa=null;a.Lkf=null;a.Kkf=null;a.Ssd=null;Object(y.a)(a,"WacGdprNoticeBusinessBarEntry",b.a,[])},1174:function(y,D,b){function a(){}b.d(D,"a",function(){return a});y=b(0);a.kih="ewa-bb";a.mih="ewa-bb-entry";a.nih="ewa-bb-entry-body";a.tih="ewa-bb-icon";a.pih="ewa-bb-entry-icon";a.sih="ewa-bb-entry-title";a.rih="ewa-bb-entry-message";a.UJe="ewa-bb-entry-button";
a.qih="ewa-bb-entry-link";a.oih="ewa-bb-entry-close";a.VJe="ewa-bb-entry-button-holder";a.C7c="ewa-nov2-ltr";a.lih="ewa-bb-content";a.E7c="ewa-nov2-rtl";Object(y.a)(a,"CssClassNames",null,[])},1175:function(y,D,b){function a(c,k){c=d.call(this,c,k)||this;c.Vy=!0;c.title=a.soa;c.message=a.qoa;return c}b.d(D,"a",function(){return a});y=b(0);b=b(831);var d=b.a;vm(a,d);a.prototype.Vo=function(c){d.prototype.Vo.call(this,c);(c=a.roa)&&c(null)};a.initialize=function(c,k,n,l){a.soa=c;a.qoa=k;a.poa=n;a.roa=
l};tl.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.poa}}});a.soa=null;a.qoa=null;a.poa=null;a.roa=null;Object(y.a)(a,"AutomaticSensitivityLabelBusinessBarEntry",b.a,[])},1176:function(y,D,b){function a(c,k){c=d.call(this,c,k)||this;c.Vy=!0;c.title=a.soa;c.message=a.qoa;return c}b.d(D,"a",function(){return a});y=b(0);b=b(831);var d=b.a;vm(a,d);a.prototype.Vo=function(c){d.prototype.Vo.call(this,c);(c=a.roa)&&c(null)};a.initialize=function(c,
k,n,l){a.soa=c;a.qoa=k;a.poa=n;a.roa=l};tl.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.poa}}});a.soa=null;a.qoa=null;a.poa=null;a.roa=null;Object(y.a)(a,"RecommendedSensitivityLabelBusinessBarEntry",b.a,[])},1177:function(y,D,b){function a(c,k){c=d.call(this,c,k)||this;c.Vy=!0;c.title=a.soa;c.message=a.qoa;return c}b.d(D,"a",function(){return a});y=b(0);b=b(831);var d=b.a;vm(a,d);a.prototype.Vo=function(c){d.prototype.Vo.call(this,c);(c=
a.roa)&&c(null)};a.initialize=function(c,k,n,l){a.soa=c;a.qoa=k;a.poa=n;a.roa=l};tl.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.poa}}});a.soa=null;a.qoa=null;a.poa=null;a.roa=null;Object(y.a)(a,"MandatorySensitivityLabelBusinessBarEntry",b.a,[])},1178:function(y,D,b){function a(c,k){c=d.call(this,c,k)||this;c.Vy=!0;c.title=a.sAb;c.message=a.bxa;return c}b.d(D,"a",function(){return a});y=b(0);b=b(831);var d=b.a;vm(a,d);a.prototype.Vo=function(c){d.prototype.Vo.call(this,
c);a.dxa&&a.dxa(null)};a.initialize=function(c,k,n,l){a.sAb=c;a.bxa=k;a.e7a=n;a.dxa=l};tl.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.e7a}}});a.sAb=null;a.bxa=null;a.e7a=null;a.dxa=null;Object(y.a)(a,"SensitivityLabelMinorVersionLimitReachedBusinessBarEntry",b.a,[])},1179:function(y,D,b){function a(c,k){c=d.call(this,c,k)||this;a.e7a&&a.dxa&&(c.Vy=!0);c.title=a.sAb;c.message=a.bxa;return c}b.d(D,"a",function(){return a});y=b(0);b=b(831);
var d=b.a;vm(a,d);a.prototype.Vo=function(c){d.prototype.Vo.call(this,c);a.dxa&&a.dxa(null)};a.initialize=function(c,k,n,l){a.sAb=c;a.bxa=k;a.e7a=n;a.dxa=l};tl.Object.defineProperties(a.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return a.e7a}}});a.sAb=null;a.bxa=null;a.e7a=null;a.dxa=null;Object(y.a)(a,"SensitivityApplicationSetLabelErrorBusinessBarEntry",b.a,[])},1180:function(y,D,b){function a(l,f,u,v,m,A){this.FX=l;this.GX=f;this.QHc=u;this.lD=v;this.fQb=m;this.NTa=A}
b.d(D,"a",function(){return a});y=b(0);var d=b(1238),c=b(5),k=b(49),n=b(86);a.prototype.BYi=function(l){this.cqf(l)};a.prototype.oki=function(l){this.cqf(l)};a.prototype.cqf=function(l){var f=10;1===l?(n.a.instance.resolve("Common.IOfficeTrialExperience").Ihc(this.NTa),f=3):2===l&&((!this.QHc||this.QHc(this.lD))&&this.GX&&d.a.instance.y3g(this.GX,this.FX,this.lD),f=5);l&&1!==l||this.FX&&this.FX(this.lD);c.AFrameworkApplication.orc(k.a.EBf,this.fQb,f);this.dispose()};a.prototype.dispose=function(){this.lD=
this.GX=this.FX=null};tl.Object.defineProperties(a.prototype,{B_f:{configurable:!0,enumerable:!0,get:function(){return!this.GX&&!this.QHc}},Kpf:{configurable:!0,enumerable:!0,get:function(){return 2===this.NTa?CommonUIStrings.l_OICErrorC2ROneNoteOffer:CommonUIStrings.l_OICErrorC2ROffer}},id:{configurable:!0,enumerable:!0,get:function(){return"OICErrorDialogWithTrial"}},vJe:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorMessageNoOffice}},w6e:{configurable:!0,enumerable:!0,
get:function(){return CommonUIStrings.l_OICErrorIHaveOfficeButton}},nva:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},i5e:{configurable:!0,enumerable:!0,get:function(){return"OICFailure"}},icon:{configurable:!0,enumerable:!0,get:function(){return 3}},qWb:{configurable:!0,enumerable:!0,get:function(){return 2===this.NTa?CommonUIStrings.l_OICErrorC2RInstallOneNoteButton:CommonUIStrings.l_OICErrorC2RInstallButton}},Xn:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});
Object(y.a)(a,"AOICErrorDialogWithTrial",null,[3])},1181:function(y,D,b){function a(A,x){var t=m.call(this,A)||this;t.iMj=["id","sessionId","workbookType","workbookFileType","dataloss"];t.command=0;t.kCb=function(){var z=t.mIh();if(z){t.$.KH(!0);if(-2028960985!==t.command&&1461300262!==t.command){var r=u.a(t.$).nd.activityState;r[f.a.kXa]=l.a.download;r[v.a.RRc]=t.command}n.a(t.$).St(z.Errors)}};t.iframe=A;t.$=x;t.wc.ja("load",t.kCb);return t}b.d(D,"a",function(){return a});y=b(0);var d=b(13),c=b(47);
D=b(232);var k=b(201),n=b(39),l=b(6),f=b(33),u=b(64),v=b(607),m=D.a;vm(a,m);a.prototype.downloadFile=function(A,x){var t={};(A=this.Vsh(A,t))&&c.a.moc("dlfr",A,t);this.command=x};a.prototype.Vsh=function(A,x){var t=A.split("?");if(2!==t.length)return A=null,d.ULS.sendTraceTag(537154816,0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (missing '?')"),A;t=t[1].split("&");t=yl(t);for(var z=t.next();!z.done;z=t.next()){var r=z.value.split("=",2);if(2!==r.length){A=null;d.ULS.sendTraceTag(537154787,
0,15,"FileLoader.ExtractParametersFromUriToDictionary: unable to parse URI (key value pair has no '=' sign)");break}z=r[0];Array.contains(this.iMj,z)&&(r=decodeURIComponent(r[1]),x[z]=r,A=k.a.XFb(A,z))}return A};a.prototype.reset=function(){this.iframe&&(this.iframe.src="about:blank");this.command=1461300262};a.prototype.mIh=function(){try{return this.iframe.contentWindow.ewaResult}catch(x){if(!this.$.fa.lc.isDivSyndicated){var A=window.document.referrer.match(RegExp("://(.[^/]+)/"));d.ULS.sendTraceTag(537154785,
0,50,"FileLoader.OnFrameLoad: parent domain: {0}, current domain: {1}, iframe domain: {2}. ewaControl IsCrossDomain: {3}",1<A.length?A[1]:"",escape(window.location.host),escape(this.iframe.contentWindow.location.host),this.$.Tva);throw x;}return null}};a.Ppe=function(A){var x=document.createElement("iframe");x.id="ewaFileLoader";x.style.cssText="height:0;width:0;display:none";x.src="about:blank";x.setAttribute("name","dlfr");x=A.domElement.appendChild(x);return new a(x,A)};tl.Object.defineProperties(a.prototype,
{I6e:{configurable:!0,enumerable:!0,get:function(){return"loading"!=this.iframe.contentDocument.readyState&&"uninitialized"!=this.iframe.contentDocument.readyState}}});Object(y.a)(a,"FileLoader",D.a,[])},1182:function(y,D,b){function a(){this.BaseDocQuerySignature=null;this.RoamingApp=0}b.d(D,"a",function(){return a});y=b(0);var d=b(1341),c=b(5),k=b(38),n=b(77);a.prototype.kLd=function(){return k.c([this.Mia(),this])};a.prototype.execute=function(l,f,u){var v="RoamingAppsHandler.ashx";d.a.instance.roamingAppsAreEnabled&&
0<document.URL.toUpperCase().indexOf("WDENABLEROAMING=1")&&(v=n.a.gl(v,"wdEnableRoaming","1"));c.AFrameworkApplication.Hd.Ul(v,2,this.kLd(),{"Content-Type":"application/json; charset=utf-8"},!1,this.X2a(),l,f,u,void 0,void 0,void 0,void 0,"6")};Object(y.a)(a,"ARoamingAppsRequest",null,[])},1186:function(y,D,b){function a(){this.printOperationCallbacks=this.universalPrintAppSettings=this.setAdditionalHeaderText=this.disableBackToSheetButton=this.disableTellMeControl=this.logger=this.printPreviewPaneCallbacks=
this.backActionButtonText=null}b.d(D,"a",function(){return a});y=b(0);Object(y.a)(a,"PrintPreviewPaneProps",null,[])},1231:function(y,D,b){function a(ub,fb){var Ta=Tc.call(this,fb)||this;Ta.Jxh=I.DOMElementExtensions.Ep+",div";Ta.CY=Array(65);Ta.sm=!1;Ta.KV=function(eb){if(eb.Ea.keyCode===U.a.hD){var tb=Ta.Jb.querySelectorAll(Ta.Jxh),rc=I.DOMElementExtensions.zl(tb);tb=I.DOMElementExtensions.Ry(tb);return I.DOMElementExtensions.jda(eb.Ea,rc,tb)}return!1};Ta.vb=ub;Ta.set_visible(!1);Ta.addCssClass(O.a.kih);
N.KeyInputManager.instance.pa(P.a.Rb,Ta.Jb,Ta.KV);ca.a(ub).Tg(Ta);return Ta}function d(ub,fb,Ta,eb){ub=wd.call(this,ub,fb)||this;ub.automateCommandManager=Ta.da.Aa(352);B.ULS.shipAssertTag(526787654,0,!!ub.automateCommandManager);ub.id=Hc.a.create();ub.$=Ta;ub.message="";ub.update(eb);return ub}function c(ub,fb){ub=Ra.call(this,ub,fb)||this;ub.wBa=Sa.a.e3b();ub.Vy=!0;ub.m4=ub.wBa.sMj;ub.title=ub.wBa.title;ub.message=ub.wBa.message;return ub}function k(ub,fb){ub=Yb.call(this,ub,fb)||this;ub.Vy=!0;
ub.title="";return ub}function n(ub,fb){fb=Qb.call(this,ub,fb)||this;fb.policyManager=ub.$.da.Aa(274);if(!fb.policyManager)return B.ULS.sendTraceTag(537170202,306,50,"Tried creating PolicyBusinessBarEntry but policyManager service has not been registered."),fb;fb.message=fb.policyManager.aoc;fb.title=fb.policyManager.title;fb.nKa=!0;return fb}function l(ub,fb){ub=hb.call(this,ub,fb)||this;ub.Vy=!0;ub.m4=!0;return ub}function f(ub,fb,Ta,eb){ub=ya.call(this,ub,fb)||this;ub.Ovb=Ta;ub.command=eb;ub.nKa=
!0;ub.Vy=!0;return ub}function u(ub,fb,Ta){ub=Tb.call(this,ub,fb)||this;ub.Ovb=Ta;ub.nKa=!0;return ub}function v(ub,fb,Ta){ub=Sb.call(this,ub,fb)||this;ub.Ovb=Ta;ub.Vy=!0;return ub}function m(ub,fb){ub=Cb.call(this,ub,fb)||this;ub.Vy=!0;ub.m4=!1;return ub}function A(ub,fb){ub=ob.call(this,ub,fb)||this;ub.Vy=!0;ub.m4=!0;return ub}function x(ub,fb,Ta,eb,tb,rc,wb){return t.call(this,ub,0,fb,Ta,eb,tb,rc,wb)||this}function t(ub,fb,Ta,eb,tb,rc,wb,E){this.JI=this.K7=this.iX=0;this.uhg=ub;this.vCj=fb;this.HO=
Ta;this.Flg=wb;this.Dhb=R.a.lu(E);this.Jjg=E;eb&&(this.iX=eb);tb&&(this.K7=tb);rc&&(this.JI=rc)}function z(ub,fb,Ta,eb,tb){ub=r.call(this,ub,fb,Ta,eb)||this;ub.command=tb;ub.m4=!0;return ub}function r(ub,fb,Ta,eb){ub=pa.call(this,ub,fb)||this;ub.error=Ta;ub.options=eb;ub.error&&ub.options&2&&(ub.message=ub.error.Description);ub.error&&ub.options&1&&(ub.title=ub.error.Caption);ub.Vy=!(eb&4);return ub}function G(ub,fb,Ta){return w.call(this,ub,fb,Ta)||this}function w(ub,fb,Ta){ub=wa.call(this,ub,fb)||
this;ub.Vy=!0;ub.command=Ta;return ub}b.r(D);y=b(0);var B=b(13),U=b(91),N=b(117),P=b(12),ia=b(88),W=b(49),R=b(28),I=b(11),Q=b(232),O=b(1174),ba=b(4),ca=b(256),S=b(1175),Y=b(831),na=b(1258),Z=b(92),wa=Y.a;vm(w,wa);w.prototype.Vo=function(ub){wa.prototype.Vo.call(this,ub);this.businessBar.$.Ka.Zb(new Z.a(this.command,ub,this.businessBar.$.ed,10,null))};Object(y.a)(w,"CommandActionBusinessBarEntry",Y.a,[]);vm(G,w);G.prototype.XE=function(ub){w.prototype.XE.call(this,ub)};Object(y.a)(G,"EditAttemptReadOnlyBusinessBarEntry",
w,[]);var ma=b(39),pa=Y.a;vm(r,pa);r.prototype.Vo=function(ub){pa.prototype.Vo.call(this,ub);this.error.Appearance&=-33;ma.a(this.businessBar.$).St([this.error])};Object(y.a)(r,"ErrorBusinessBarEntry",Y.a,[]);vm(z,r);z.prototype.I5=function(ub){r.prototype.I5.call(this,ub);this.businessBar.$.Ka.Zb(new Z.a(this.command,ub,this.businessBar.$.ed,10,null))};Object(y.a)(z,"ErrorAndCommandBusinessBarEntry",r,[]);var Ia=b(14);t.ea=function(ub){return Ia.a.instance.ea(ub)};tl.Object.defineProperties(t.prototype,
{title:{configurable:!0,enumerable:!0,get:function(){return t.ea(this.vCj)}},message:{configurable:!0,enumerable:!0,get:function(){return t.ea(this.HO)}},messageId:{configurable:!0,enumerable:!0,get:function(){return this.HO}},bob:{configurable:!0,enumerable:!0,get:function(){return this.uhg}},actionButton:{configurable:!0,enumerable:!0,get:function(){return t.ea(this.iX)}},aYa:{configurable:!0,enumerable:!0,get:function(){return t.ea(this.K7)}},link:{configurable:!0,enumerable:!0,get:function(){return t.ea(this.JI)}},
Vj:{configurable:!0,enumerable:!0,get:function(){return this.Flg}},hash:{configurable:!0,enumerable:!0,get:function(){return this.Dhb}},alt:{configurable:!0,enumerable:!0,get:function(){var ub=b(1231).BusinessBarControl;switch(this.Vj){case ub.mIa:return t.ea(26);case ub.KF:return t.ea(25);case ub.Xj:return t.ea(24);default:return t.ea(0)}}},X6c:{configurable:!0,enumerable:!0,get:function(){return this.Jjg}}});Object(y.a)(t,"EwaBusinessBarEntry",null,[]);vm(x,t);tl.Object.defineProperties(x.prototype,
{title:{configurable:!0,enumerable:!0,get:function(){return""}}});Object(y.a)(x,"EwaNoTitleBusinessBarEntry",t,[]);var Ma=b(69),ob=Y.a;vm(A,ob);A.prototype.Vo=function(ub){ob.prototype.Vo.call(this,ub);this.set_visible(!1);this.businessBar.$.OH();this.businessBar.$.Ka.Zb(new Z.a(1038998010,ub,this.businessBar.$.ed,10,null))};A.prototype.I5=function(ub){ob.prototype.I5.call(this,ub);this.businessBar.$.Ka.Zb(new Z.a(-722953877,ub,this.businessBar.$.ed,10,null))};A.prototype.XE=function(ub){this.businessBar.removeEntry(53);
Ma.g(ub)};Object(y.a)(A,"ExternalLinksEnableContentBusinessBarEntry",Y.a,[]);var Cb=Y.a;vm(m,Cb);m.prototype.Vo=function(ub){Cb.prototype.Vo.call(this,ub);this.businessBar.$.Ka.Zb(new Z.a(-722953877,ub,this.businessBar.$.ed,10,null))};m.prototype.XE=function(ub){this.businessBar.removeEntry(5);Ma.g(ub)};Object(y.a)(m,"ExternalLinksShowErrorBusinessBarEntry",Y.a,[]);var Xa=b(8),Sb=Y.a;vm(v,Sb);v.prototype.Vo=function(ub){Sb.prototype.Vo.call(this,ub);Xa.HelperMethods.Xba(this.businessBar.$.pI,this.Ovb,
this.businessBar.$.aX)};Object(y.a)(v,"HelpButtonBusinessBarEntry",Y.a,[]);var Tb=Y.a;vm(u,Tb);u.prototype.ula=function(ub){Tb.prototype.ula.call(this,ub);Xa.HelperMethods.Xba(this.businessBar.$.pI,this.Ovb,this.businessBar.$.aX)};Object(y.a)(u,"HelpTextBusinessBarEntry",Y.a,[]);var da=b(78),ya=Y.a;vm(f,ya);f.prototype.Vo=function(ub){ya.prototype.Vo.call(this,ub);this.businessBar.$.Ka.Zb(new Z.a(this.command,ub,this.businessBar.$.ed,10,null))};f.prototype.ula=function(ub){ya.prototype.ula.call(this,
ub);var fb=new Z.a(-859308420,ub,this.businessBar.$.ed,12,null),Ta={};ub=(Ta[da.a.Kg]="HelpID="+this.Ovb,Ta.InputMethod=ub,Ta[da.a.hd]=ba.a.XU,Ta[ba.a.Ana]=!0,Ta);this.businessBar.$.Ka.Zb(fb,ub)};Object(y.a)(f,"HelpTextTaskPaneAndCommandBusinessBarEntry",Y.a,[]);var hb=Y.a;vm(l,hb);l.prototype.Vo=function(ub){hb.prototype.Vo.call(this,ub);this.set_visible(!1);this.businessBar.$.OH();this.businessBar.$.Ka.Zb(new Z.a(-1081442996,ub,this.businessBar.$.ed,10,null))};l.prototype.I5=function(ub){hb.prototype.I5.call(this,
ub);this.businessBar.$.Ka.Zb(new Z.a(1702917262,ub,this.businessBar.$.ed,10,null))};l.prototype.XE=function(ub){this.businessBar.removeEntry(57);Ma.g(ub)};Object(y.a)(l,"LinkedEntitiesEnableUntrustedImagesBusinessBarEntry",Y.a,[]);var Gb=b(1177),Qb=Y.a;vm(n,Qb);n.prototype.ula=function(ub){Qb.prototype.ula.call(this,ub);(ub=this.policyManager.yGi)&&ub(null)};tl.Object.defineProperties(n.prototype,{linkText:{configurable:!0,enumerable:!0,get:function(){return this.policyManager.linkText}}});Object(y.a)(n,
"PolicyBusinessBarEntry",Y.a,[]);var Fb=b(1176),ta=b(1179),xa=b(1178);b(410);var sa=b(176),lb=b(29),Yb=Y.a;vm(k,Yb);k.prototype.Vo=function(ub){Yb.prototype.Vo.call(this,ub);sa.c(lb.a.jvi);window.open("https://www.microsoft.com/edge?form=MI13FQ&OCID=MI13FQ","_blank")};Object(y.a)(k,"UnsupportedBrowserBusinessBarEntry",Y.a,[]);var Fa=b(1173),Sa=b(1273),Ra=Y.a;vm(c,Ra);c.prototype.Vo=function(ub){Ra.prototype.Vo.call(this,ub);this.wBa.irf(null)};c.prototype.I5=function(ub){Ra.prototype.I5.call(this,
ub);this.wBa.lrf(null)};c.prototype.XE=function(ub){Ra.prototype.XE.call(this,ub);this.wBa.yFe(null)};tl.Object.defineProperties(c.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return this.wBa.Cse}},aYa:{configurable:!0,enumerable:!0,get:function(){return this.wBa.Ese}}});Object(y.a)(c,"WildFireMobileAppBusinessBarEntry",Y.a,[]);var Lb=b(245),Ja=b(19),xb=b(240),Kb=b(166),Eb=b(46),Hc=b(179),Xc=b(75),Pc=b(125),wd=Y.a;vm(d,wd);d.prototype.update=function(ub){this.yza=ub.yza;this.Zca=
ub.Zca;this.emi(ub.V0b);this.p9i();"preparing"===this.Zca?this.title="Preparing script to run.":"running"===this.Zca?(this.title="Script is running.",this.Vy=!0,this.pWb="Stop",this.h_c=this.rlb=this.bAf):"succeeded"===this.Zca?(this.title="Script run succeeded.",this.Vy=!0,this.pWb="View logs",this.rlb=this.$Af,this.m4=!0,this.oUc="View script",this.pUc=this.AMi):"runFailed"===this.Zca?(this.title="Script run failed.",this.Vy=!0,this.pWb="View logs",this.rlb=this.$Af,this.m4=!0,this.oUc="Contact owner",
this.pUc=this.SAi):"fetchFailed"===this.Zca?this.title="Script is unshared. Contact onwer to share it again":"canceled"===this.Zca&&(this.title="Script run is canceled.")};d.prototype.Vo=function(ub){wd.prototype.Vo.call(this,ub);this.rlb&&this.rlb()};d.prototype.I5=function(ub){wd.prototype.I5.call(this,ub);this.aYa&&this.pUc()};d.prototype.XE=function(ub){wd.prototype.XE.call(this,ub);this.h_c&&this.h_c()};d.prototype.p9i=function(){this.message=this.title="";this.Vy=!1;this.pWb="";this.rlb=void 0;
this.m4=!1;this.oUc="";this.pUc=void 0;this.Rvb=!1;this.h_c=void 0};d.prototype.bAf=function(){var ub=Hc.a.create().toString();this.automateCommandManager.zWh(ub);this.jic(-2186799,ub)};d.prototype.$Af=function(){var ub=Hc.a.create().toString();this.automateCommandManager.yWh(ub);this.jic(1036446140,ub)};d.prototype.AMi=function(){var ub=Hc.a.create();this.yza&&this.automateCommandManager.A3e(this.id.toString(),JSON.stringify({cD:this.yza}),ub);this.jic(-585097204,ub.toString())};d.prototype.SAi=
function(){var ub=Hc.a.create().toString();this.automateCommandManager.xWh(ub);this.jic(-639858579,ub)};d.prototype.emi=function(ub){var fb=[];fb.push(Object.assign(new Xc.a,{name:"id",string:this.id.toString()}));fb.push(Object.assign(new Xc.a,{name:"hasScriptLink",bool:!!this.yza}));fb.push(Object.assign(new Xc.a,{name:"runStatus",string:this.Zca}));fb.push(Object.assign(new Xc.a,{name:"clickId",string:ub}));sa.a(Pc.a.Uxi,void 0,void 0,fb)};d.prototype.jic=function(ub,fb){var Ta=[];Ta.push(Object.assign(new Xc.a,
{name:"id",string:this.id.toString()}));Ta.push(Object.assign(new Xc.a,{name:"hasScriptLink",bool:!!this.yza}));Ta.push(Object.assign(new Xc.a,{name:"runStatus",string:this.Zca}));Ta.push(Object.assign(new Xc.a,{name:"clickId",string:fb}));sa.d(ub,void 0,void 0,void 0,void 0,void 0,Ta)};tl.Object.defineProperties(d.prototype,{actionButton:{configurable:!0,enumerable:!0,get:function(){return this.pWb}},aYa:{configurable:!0,enumerable:!0,get:function(){return this.oUc}}});Object(y.a)(d,"OfficeScriptsRunStatusBusinessBarEntry",
Y.a,[]);b.d(D,"BusinessBarControl",function(){return a});var Tc=Q.a;vm(a,Tc);a.prototype.Qe=function(ub,fb){fb||I.DOMElementExtensions.setFocus(this.domElement.firstChild);return!fb};a.prototype.zh=function(ub){return I.DOMElementExtensions.Ye(this.Jb,ub)};a.prototype.ji=function(){};a.prototype.Vh=function(){};a.prototype.dispose=function(){this.sm||(N.KeyInputManager.instance.za(P.a.Rb,this.Jb,this.KV),ia.a.pc(this.CY),this.CY=Array(65),this.vb=null,Tc.prototype.dispose.call(this),this.sm=!0)};
a.prototype.Y4a=function(ub){if(!this.get_visible())return!1;ub=this.CY[ub];return!!ub&&ub.isVisible};a.prototype.MB=function(ub){return!!this.CY[ub]};a.prototype.iMb=function(ub,fb){if(ub=this.CY[ub])ub.update(fb),ub.sIj()};a.prototype.BD=function(ub,fb,Ta,eb){Ta=void 0===Ta?null:Ta;eb=void 0===eb?null:eb;var tb=!1;if(this.MB(ub))Ta=this.CY[ub].get_visible();else{this.set_visible(!0);var rc=a.r1e()[ub];this.CY[ub]=this.l$(ub,fb,Ta,eb);Ta=!1;tb=!0;eb="";var wb=0;fb&&(eb=fb.MessageIdName,wb=fb.MessageId);
var E=rc.X6c;B.ULS.sendTraceTag(537170258,0,50,"BusinessBarControl.AddEntry of type: {0}, time from app interactive: {1}",ub,Eb.PageLoadTrackingInfo.instance.oaa(new Date));Kb.a(this.$).JHd(rc.hash,eb,wb,W.a.Uyc,!0,1,fb,E)}Ta||!Array.contains(na.a.Vac(),ub)&&!tb||(this.CY[ub].set_visible(!0),this.$.OH())};a.prototype.removeEntry=function(ub){return this.H2i(ub)};a.prototype.NFd=function(){ia.a.pc(this.CY);this.CY=Array(65);this.set_visible(!1)};a.prototype.H2i=function(ub){if(!this.MB(ub))return!1;
ia.a.Fa(this.CY[ub]);this.CY[ub]=null;this.domElement.hasChildNodes()||this.set_visible(!1);this.$.OH();return!0};a.prototype.l$=function(ub,fb,Ta,eb){Ta=void 0===Ta?null:Ta;eb=void 0===eb?null:eb;var tb=a.r1e()[ub],rc=!!(this.$.Fd&64);switch(ub){case 2:case 4:case 23:case 25:case 26:case 35:case 34:ub=new Y.a(this,tb);break;case 12:case 29:case 30:case 31:case 32:case 55:ub=rc?new w(this,tb,-8805455):new Y.a(this,tb);break;case 22:ub=new G(this,tb,-8805455);break;case 44:case 43:ub=rc?new z(this,
tb,fb,0,-8805455):new r(this,tb,fb,0);break;case 11:case 41:case 7:case 0:case 1:case 3:case 33:ub=new r(this,tb,fb,0);break;case 19:ub=new Y.a(this,tb);break;case 45:ub=new r(this,tb,fb,0);break;case 6:case 14:ub=new v(this,tb,fb.HelpTopicId);break;case 64:ub=new u(this,tb,fb.HelpTopicId);break;case 36:ub=new u(this,tb,ba.a.F7g);break;case 16:ub=new Y.a(this,tb);ub.title=R.a.If(this.$.workbookContext.FullDocumentInfo.IrmPolicyTitle);ub.message=R.a.If(this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription);
break;case 18:ub=new w(this,tb,-1762562205);ub.Rvb=!0;break;case 20:ub=new c(this,tb);break;case 21:case 54:ub=new Y.a(this,tb);break;case 28:ub=new Y.a(this,tb);break;case 24:ub=new k(this,tb);break;case 27:ub=new n(this,tb);break;case 37:ub=new Fa.a(this,tb);break;case 38:ub=new S.a(this,tb);break;case 39:ub=new Fb.a(this,tb);break;case 40:ub=new Gb.a(this,tb);break;case 46:ub=new Y.a(this,tb);break;case 47:ub=new Y.a(this,tb);break;case 48:ub=new Y.a(this,tb);break;case 49:ub=new Y.a(this,tb);
break;case 50:ub=new Y.a(this,tb);break;case 51:ub=new xa.a(this,tb);break;case 52:ub=new ta.a(this,tb);break;case 53:ub=new A(this,tb);break;case 5:ub=new m(this,tb);break;case 56:ub=new w(this,tb,-1753056834);fb?(fb=fb.Directive,Ja.a.xn(fb)||"&nbsp;"===fb||(ub.message=fb)):Ta&&(ub.message=Ta);break;case 57:ub=new l(this,tb);break;case 58:ub=new Y.a(this,tb);break;case 59:case 62:ub=new u(this,tb,ba.a.Vwi);break;case 60:ub=new f(this,tb,ba.a.bJg,-8805455);break;case 61:ub=new w(this,tb,515196233);
break;case 63:ub=new d(this,tb,this.$,eb);break;default:ub=new r(this,tb,fb,7)}ub.E1c();return ub};a.r1e=function(){var ub=xb.a.h5a()?259:258;return a.rse||(a.rse=[new t(0,274,275,276,0,0,a.mIa,"BB_UnableToRefreshLock"),new t(1,274,275,276,0,0,a.mIa,"BB_UnableToRefreshLockExpected"),new t(2,266,267,0,0,0,a.KF,"BB_WorkbookAlmostTooLarge"),new t(3,268,269,270,0,0,a.mIa,"BB_WorkbookTooLarge"),new t(4,257,ub,0,0,0,a.KF,"BB_ExternalWorkbookLinksDisabled"),new t(5,261,260,262,0,0,a.mIa,"BB_ExternalWorkbookLinksShowError"),
new t(6,263,264,265,0,0,a.Xj,"BB_EditAndRefreshDisabledOnBIAHostedFiles"),new t(7,249,250,251,0,0,a.Xj,"BB_UnsupportedFeatures"),new t(8,0,0,0,0,0,a.Xj,"BB_CollabDataAndDataStringsLocaleMismatch"),new t(9,0,0,0,0,0,a.Xj,"BB_CollabDataStringsLocaleMismatch"),new t(10,0,0,0,0,0,a.Xj,"BB_CollabDataLocaleMismatch"),new t(11,277,278,279,0,0,a.mIa,"BB_LastGenericStatusError"),new t(12,280,281,282,0,0,a.KF,"BB_ScratchPadWarning"),new t(13,283,284,285,0,0,a.mIa,"BB_AuthenticationLost"),new t(14,286,287,288,
0,0,a.KF,"BB_OdfCompatibilityIssues"),new t(15,0,565,0,0,0,a.KF,"BB_PivotChartInteractivityMissingWarning"),new t(16,0,0,0,0,0,a.Xj,"BB_WorkbookIsIrmProtected"),new t(17,0,0,0,0,0,a.Xj,"BB_BIFeatureNotAvailable"),new t(18,289,290,285,0,0,a.KF,"BB_AnonymousCreateMode"),new t(19,252,253,0,0,0,a.KF,"BB_UnsupportedInteractiveReportEditing"),new t(20,0,0,0,0,0,a.Xj,"BB_MobileAppCampaignBizBar"),new t(21,295,296,0,0,0,a.Xj,"BB_TransientServerCommunicationFailures"),new t(22,1591,1602,1603,0,0,a.Xj,"BB_EditAttemptInReadOnly"),
new t(23,1591,1602,0,0,0,a.Xj,"BB_EditAttemptInReadOnlyNoEditPermissions"),new t(24,0,Xa.HelperMethods.THj(),1580,0,0,a.Xj,"BB_UnsupportedBrowser"),new t(25,298,299,0,0,0,a.Xj,"BB_ReadOnlyPermissions"),new t(26,300,301,0,0,0,a.Xj,"BB_DocumentIsIrmProtectedWarning"),new t(27,0,0,0,0,0,a.KF,"BB_PolicyWarningMessage"),new t(28,1239,297,0,0,0,a.Xj,"BB_WorkingOnIt"),new t(29,1591,1589,1590,0,0,a.Xj,"BB_PasswordProtectedWorkbookLockedForEdit"),new t(30,1604,1605,1606,0,0,a.Xj,"BB_WorkbookIsReadOnlyRecommended"),
new t(31,1591,1607,1608,0,0,a.Xj,"BB_WorkbookHasPasswordToModify"),new t(32,1591,1609,1612,0,0,a.Xj,"BB_LegacySharedWorkbookEditWarning"),new t(33,1599,1610,251,0,0,a.Xj,"BB_LegacyConnectionsWarning"),new t(34,1600,1601,0,0,0,a.Xj,"BB_GroupedSlicers"),new t(35,311,312,0,0,0,a.KF,"BB_ThirdPartyAddinDisabled"),new t(36,1732,1733,0,0,1734,a.Xj,"BB_FinanceLinkedEntityDisclaimerBar"),new t(37,0,0,0,0,0,a.Xj,"BB_WacGdprNotice"),new t(38,0,0,0,0,0,a.Xj,"BB_AutomaticSensitivityLabel"),new t(39,0,0,0,0,0,
a.Xj,"BB_RecommendedSensitivityLabel"),new t(40,0,0,0,0,0,a.Xj,"BB_MandatorySensitivityLabel"),new t(41,313,314,315,0,0,a.Xj,"BB_LocalStorageDisabled"),new t(42,622,623,0,0,0,a.Xj,"BB_AutoRefreshDisabled"),new t(43,980,978,982,1268,0,a.Xj,"BB_CorruptedFileRepaired"),new t(44,981,979,982,1268,0,a.Xj,"CorruptedOdsFileRepaired"),new t(45,271,272,273,0,0,a.KF,"BB_MinorVersionLimitReached"),new t(46,302,303,0,0,0,a.KF,"BB_SensitivityApplicationGenericError"),new t(47,304,306,0,0,0,a.KF,"BB_SensitivityApplicationTooLargeFileError"),
new t(48,305,306,0,0,0,a.KF,"BB_SensitivityApplicationLabelNotSupportedError"),new t(49,307,308,0,0,0,a.KF,"BB_SensitivityApplicationLabelDisabledError"),new t(50,309,310,0,0,0,a.KF,"BB_SensitivityApplicationMandatoryConflictError"),new t(51,0,0,0,0,0,a.KF,"BB_SensitivityApplicationMinorVersionLimitReachedError"),new t(52,0,0,0,0,0,a.KF,"BB_SensitivityApplicationSetLabelError"),new t(53,2052,2053,2054,2057,0,a.Xj,"BB_ExternalWorkbookLinksPromptEnableContent"),new t(54,295,296,0,0,0,a.Xj,"BB_NetworkDown"),
new t(55,316,317,318,0,0,a.Xj,"BB_DefaultToViewDueToCogs"),new t(56,1758,1759,1760,0,0,a.Xj,"BB_RefreshLinkedEntityErrorBar"),new t(57,1735,1736,1737,1738,0,a.Xj,"BB_LinkedEntitiesUntrustedImagesDisabled"),new x(58,248,0,0,0,a.Xj,"BB_CanvasHealth"),new t(59,319,320,0,0,321,a.Xj,"BB_NovModeDepreciation"),new t(60,983,984,1268,0,985,a.Xj,"BB_MismatchedFileFormatConverted"),new t(61,2162,2163,2164,0,0,a.Xj,"BB_OptimizeWorkbook"),new t(62,322,323,0,0,324,a.Xj,"BB_NovModePostDepreciation"),new t(63,2200,
0,0,0,0,a.Xj,"BB_OfficeScriptsRunning"),new t(64,2141,2142,0,0,2143,a.Xj,"BB_PowerQueryRefreshDataSourceNotSupported")])};tl.Object.defineProperties(a.prototype,{Zd:{configurable:!0,enumerable:!0,get:function(){return Lb.a.dXc}},Jb:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.get_visible()}},$:{configurable:!0,enumerable:!0,get:function(){return this.vb}}});a.mIa="ewa-mb-error";a.KF="ewa-mb-warning";
a.Xj="ewa-mb-info";a.rse=null;Object(y.a)(a,"BusinessBarControl",Q.a,[100])},1238:function(y,D,b){function a(){this.aib=!!m.AFrameworkApplication.sa&&m.AFrameworkApplication.sa.Pa.Lu}function d(w,B,U){var N=n.call(this,w,B,U)||this;w={};w=(w.errorMessage=N.wJe,w.errorFileDownloadOffer=N.Trb,w);B={};w.helpLink=(B.type="AppLinkProps",B.id="helpLink",B.text=N.nva,B.onExecute=function(P){N.CNa(P)},B);B=new G.a(!1,!1,!0);B.kc=1;B.Cc(1,N.Urb);B.Me=N.id;U={};w=(U.id=N.id,U.dialogIcon=N.icon,U.bodyControls=
w,U);B.initializeAndShow(N.Xn,Object(u.a)(N,N.eEd,"reactOICErrorDialogHandler"),w);return N}function c(w,B,U,N){var P=f.call(this,w,B,U,N)||this;w={};w=(w.errorMessage=P.errorMessage,w);B={};w.helpLink=(B.type="AppLinkProps",B.id="helpLink",B.text=P.nva,B.onExecute=function(ia){P.CNa(ia)},B);P.jvc?(w.macOfficePreLinkText=P.glf,B={},w.macOfficeLink=(B.type="AppLinkProps",B.id="macOfficeLink",B.text=P.dlf,B.onExecute=function(ia){P.Gwd(ia)},B),w.macOfficePostText=P.flf):P.S1b&&(w.errorFileDownloadOffer=
P.Trb);B=new G.a(!1,!1,!0);P.S1b?(B.kc=1,B.Cc(1,P.Urb)):B.kc=0;B.Me=P.id;U={};w=(U.id=P.id,U.dialogIcon=P.icon,U.bodyControls=w,U);B.initializeAndShow(P.Xn,Object(u.a)(P,P.eEd,"reactOICErrorDialogHandler"),w);return P}function k(w,B,U){w=n.call(this,w,B,U)||this;w.Ql=null;B=document.createElement("span");B.id="errorMessageText";B.innerText=w.wJe;B.appendChild(document.createElement("br"));B.appendChild(document.createElement("br"));w.Ql=document.createElement("a");w.Ql.href="#";w.Ql.innerText=w.nva;
B.appendChild(w.Ql);z.a.addHandler(w.Ql,"click",Object(u.a)(w,w.CNa,"oicErrorHelpLinkHandler"));B.appendChild(document.createElement("br"));B.appendChild(document.createElement("br"));U=document.createElement("span");U.innerText=w.Trb;B.appendChild(U);U=new r.StandardDialog;U.Me=w.id;U.kc=1;U.Cc(1,w.Urb);U.Kk(w.Xn,null,w.icon,Object(u.a)(w,w.ard,"legacyOICErrorDialogHandler"),B);U.AW("errorMessageText");return w}function n(w,B,U){this.FX=B;this.GX=w;this.lD=U}function l(w,B,U,N){w=f.call(this,w,B,
U,N)||this;w.Ql=null;w.Qpa=null;B=document.createElement("span");B.id="errorMessageText";B.innerText=w.errorMessage;B.appendChild(document.createElement("br"));B.appendChild(document.createElement("br"));w.Ql=document.createElement("a");w.Ql.href="#";w.Ql.innerText=w.nva;B.appendChild(w.Ql);z.a.addHandler(w.Ql,"click",Object(u.a)(w,w.CNa,"oicErrorHelpLinkHandler"));U=new r.StandardDialog;U.Me=w.id;if(w.jvc){N=document.createElement("span");var P=document.createElement("span");N.innerText=w.glf;P.innerText=
w.flf;w.Qpa=document.createElement("a");w.Qpa.href="#";w.Qpa.innerText=w.dlf;B.appendChild(document.createElement("br"));B.appendChild(N);B.appendChild(w.Qpa);B.appendChild(P);z.a.addHandler(w.Qpa,"click",Object(u.a)(w,w.Gwd,"oicErrorMacOfferLinkHandler"))}else w.S1b&&(B.appendChild(document.createElement("br")),B.appendChild(document.createElement("br")),N=document.createElement("span"),N.innerText=w.Trb,B.appendChild(N));w.S1b?(U.kc=1,U.Cc(1,w.Urb)):U.kc=0;U.Kk(w.Xn,null,w.icon,Object(u.a)(w,w.ard,
"legacyOICErrorDialogHandler"),B);U.AW("errorMessageText");return w}function f(w,B,U,N){this.XKc=null;this.fQb=N;this.FX=w;this.GX=B;this.lD=U;this.lee=this.elf.Dpj;w=CommonUIStrings.l_OICErrorMacOfficeOffer.split("{0}");this.Lng=w[0];this.Kng=w[1]}y=b(0);var u=b(80),v=b(13),m=b(5),A=b(49),x=b(410),t=b(86);f.prototype.eEd=function(w){this.IBb(w)};f.prototype.ard=function(w){this.IBb(w)};f.prototype.IBb=function(w){var B=10;this.GX&&1===w&&(this.GX(this.lD),B=1);this.FX&&this.FX(this.lD);this.nF(B)};
f.prototype.CNa=function(){x.Redirect.showHelp("OICFailure");this.nF(2)};f.prototype.Gwd=function(){this.elf.$gf();this.nF(4)};f.prototype.nF=function(w){v.ULS.sendTraceTag(18715410,211,10,"Report OICErrorDialog. Dialog cause: {0}, solution: {1}",this.fQb,w);m.AFrameworkApplication.orc(A.a.CBf,this.fQb,w)};f.prototype.dispose=function(){this.lD=this.FX=this.GX=null};tl.Object.defineProperties(f.prototype,{elf:{configurable:!0,enumerable:!0,get:function(){return this.XKc||(this.XKc=t.a.instance.resolve("Common.IMacOfficeOffer"))}},
id:{configurable:!0,enumerable:!0,get:function(){return"OICErrorDialog"}},errorMessage:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorMessage}},nva:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},jvc:{configurable:!0,enumerable:!0,get:function(){return this.lee}},glf:{configurable:!0,enumerable:!0,get:function(){return this.Lng}},flf:{configurable:!0,enumerable:!0,get:function(){return this.Kng}},dlf:{configurable:!0,enumerable:!0,
get:function(){return CommonUIStrings.l_OICErrorMacOFficeLink}},icon:{configurable:!0,enumerable:!0,get:function(){return this.lee?3:2}},Trb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorFileDownloadOffer}},S1b:{configurable:!0,enumerable:!0,get:function(){return!!this.GX}},Urb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}},Xn:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});
Object(y.a)(f,"AOICErrorDialog",null,[3]);var z=b(40),r=b(128);vm(l,f);l.prototype.dispose=function(){this.Ql&&(z.a.removeHandler(this.Ql,"click",Object(u.a)(this,this.CNa,"oicErrorHelpLinkHandler")),this.Ql=null);this.Qpa&&(z.a.removeHandler(this.Qpa,"click",Object(u.a)(this,this.Gwd,"oicErrorMacOfferLinkHandler")),this.Qpa=null);f.prototype.dispose.call(this)};Object(y.a)(l,"OICErrorDialog",f,[]);n.prototype.eEd=function(w){this.IBb(w)};n.prototype.ard=function(w){this.IBb(w)};n.prototype.IBb=function(w){var B=
10;1===w&&(this.GX(this.lD),B=1);this.FX&&this.FX(this.lD);this.nF(B)};n.prototype.CNa=function(){x.Redirect.showHelp("OICFailure");this.nF(2)};n.prototype.nF=function(w){m.AFrameworkApplication.orc(A.a.DBf,3,w)};n.prototype.dispose=function(){this.lD=this.GX=this.FX=null};tl.Object.defineProperties(n.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return"OICErrorDialogWithDownload"}},wJe:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorNoOfficeDetected}},
nva:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorHelpLink}},Trb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorFileDownloadOffer}},Urb:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_OICErrorNoOfficeDownloadButton}},icon:{configurable:!0,enumerable:!0,get:function(){return 2}},Xn:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DefaultDialogTitle}}});Object(y.a)(n,"AOICErrorDialogWithDownload",
null,[3]);vm(k,n);k.prototype.dispose=function(){this.Ql&&(z.a.removeHandler(this.Ql,"click",Object(u.a)(this,this.CNa,"oicErrorHelpLinkHandler")),this.Ql=null);n.prototype.dispose.call(this)};Object(y.a)(k,"OICErrorDialogWithDownload",n,[]);var G=b(140);vm(c,f);Object(y.a)(c,"ReactOICErrorDialog",f,[]);vm(d,n);Object(y.a)(d,"ReactOICErrorDialogWithDownload",n,[]);b.d(D,"a",function(){return a});a.prototype.x3g=function(w,B,U){this.aib?new c(w,B,null,U):new l(w,B,null,U)};a.prototype.y3g=function(w,
B,U){this.aib?new d(w,B,U):new k(w,B,U)};a.prototype.z3g=function(w,B,U,N,P){var ia=b(1315).ReactOICErrorDialogWithTrial,W=b(1316).OICErrorDialogWithTrial;this.aib?new ia(w,B,U,null,N,P):new W(w,B,U,null,N,P)};tl.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){return a.Na||(a.Na=new a)}}});a.Na=null;Object(y.a)(a,"OICErrorDialogFactory",null,[226])},1258:function(y,D,b){function a(Z,wa){var ma=na.call(this)||this;ma.Ma=new u.a;ma.xT=null;ma.MFc=[];ma.Okc=function(){ma.$.qa.hLa?
ma.removeEntry(13):ma.hg(13,null)};ma.Txa=function(){I.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&c.ULS.sendTraceTag(537170243,0,50,"BusinessBar.OnNetworkResumed: removing TransientServerCommunicationFailures BB");ma.removeEntry(21);ma.MB(54)&&(c.ULS.sendTraceTag(537170242,0,15,"BusinessBar.OnNetworkResumed: removing NetworkDown BB"),ma.removeEntry(54));ma.YNf("OnNetworkResumed")};ma.Zh=function(Ia,Ma){Ia=0;for(var ob=a.Vac().length;Ia<ob;Ia++){var Cb=a.Vac()[Ia];ma.removeEntry(Cb)}Ma.context&&
0<Ma.context.communicationErrorRetryCount&&(c.ULS.sendTraceTag(537170240,0,50,"OnWebMethodSuccess: retry due to previous communication failure succeeded, turning off the TransientServerCommunicationFailures business bar"),ma.removeEntry(21));ma.YNf("OnWebMethodSuccess")};ma.Xo=function(Ia,Ma){var ob;Ia=ma.Guh(Ma.errors);for(var Cb=[],Xa=0,Sb=Ia.length;Xa<Sb;++Xa){var Tb=Ia[Xa];if(1===Tb.Type&&Tb.Appearance&32)Cb=ma.DYh(Tb,Cb);else if(Ma.tgj){c.ULS.sendTraceTag(537170210,0,50,"OnWebMethodError: Server communication failure detected, turning on the TransientServerCommunicationFailures business bar");
var da=(null===(ob=Ma.context)||void 0===ob?0:ob.stopwatch)?Ma.context.stopwatch.Ac:-1;5E3>da?c.ULS.sendTraceTag(537170208,0,50,"OnWebMethodError:  communication errors duration is below the min time for notification, skipping raise of business bar (duration = {0}ms).",da):k.AFrameworkApplication.God()||ma.Nyg(Tb,Ma.context.methodName)}da=[].concat(Fl(a.Vac()));for(var ya=0,hb=Cb.length;ya<hb;++ya){var Gb=Cb[ya];ma.hg(Gb,Tb);Array.remove(da,Gb)}Tb=0;for(ya=da.length;Tb<ya;++Tb)ma.removeEntry(da[Tb])}};
ma.ECb=function(Ia,Ma){Ia=0;for(var ob=Ma.errors.length;Ia<ob;++Ia){var Cb=Ma.errors[Ia];k.AFrameworkApplication.God()||(I.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&c.ULS.sendTraceTag(537170207,0,15,"BusinessBar.OnNetworkDownEvent: adding NetworkDown BB"),ma.hg(54,Cb))}};ma.Zc=function(Ia,Ma){ma.qd(Ia,Ma)};ma.qd=function(){var Ia=ma.$.fa;Ia.oc||Ia.Qg()||(ma.NFd(),Array.clear(ma.MFc))};ma.od=function(Ia,Ma){ma.$.fa.Qg()&&!Ma.DQ||ma.u7e(Ma.DQ)};ma.qDb=function(){var Ia=
ma.$.userOperationManager.Iac();Ia&&Ia.operation.flags&1&&ma.A_f()};ma.Puf=function(){ma.A_f()};ma.Kf=function(){ma.hve();ma.J_f()};ma.hN=function(){if(ma.$.U4&&ma.$.fa.Qg()&&ma.$.fa.oc)if(ma.$.fa.isEditMode)ma.removeEntry(43),ma.removeEntry(12),ma.removeEntry(29),ma.removeEntry(30),ma.removeEntry(31),ma.removeEntry(32),ma.removeEntry(22),ma.removeEntry(55);else{var Ia=ma.$.da.Aa(331);Ia&&Ia.HIa||ma.removeEntry(53);ma.removeEntry(5)}};ma.$=Z;ma.XXa=wa;ma.oHg();k.AFrameworkApplication.Hd&&k.AFrameworkApplication.Hd.wSc(ma);
ma.Elb=Array(65);for(var pa=0;65>pa;pa++)ma.Elb[pa]=null;ma.Pg=W.EcmaDateClock.instance;ma.Tff=ma.Pg.Kb.getTime();wa&&(wa=Z.qa,pa=wa.uf,wa.FB(ma.Xo),wa.us(ma.Zh),wa.bmb(ma.Okc),wa.zXa(ma.Okc),I.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled")||(pa.oBg(ma.ECb),pa.nmb(ma.Txa)),Z.fa.Sj(ma.Zc),Z.fa.jt(ma.Kf),Z.Rk(ma.od),Z.Vl(ma.qd),Z.fa.j9(ma.hN),Z.userOperationManager.uy(ma.qDb),I.EwaSettings.la(169)&&Z.fa.ih.get(45)&&k.AFrameworkApplication.ga.ra("SupportsPolicies")||ma.m3e(),
ma.u7e(ba.c(Z)));Z.da.Ha(5,ma);return ma}function d(Z,wa,ma){ma=void 0===ma?null:ma;var pa=t.call(this)||this;pa.bob=Z;pa.g5c=wa;pa.data=ma;return pa}y=b(0);var c=b(13),k=b(5),n=b(88),l=b(23),f=b(135),u=b(36),v=b(74),m;(function(Z){Z[Z.unableToRefreshLock=0]="unableToRefreshLock";Z[Z.unableToRefreshLockExpected=1]="unableToRefreshLockExpected";Z[Z.workbookAlmostTooLarge=2]="workbookAlmostTooLarge";Z[Z.workbookTooLarge=3]="workbookTooLarge";Z[Z.externalWorkbookLinksDisabled=4]="externalWorkbookLinksDisabled";
Z[Z.externalWorkbookLinksShowError=5]="externalWorkbookLinksShowError";Z[Z.editAndRefreshDisabledOnBIAHostedFiles=6]="editAndRefreshDisabledOnBIAHostedFiles";Z[Z.unsupportedFeatures=7]="unsupportedFeatures";Z[Z.collabDataAndDataStringsLocaleMismatch=8]="collabDataAndDataStringsLocaleMismatch";Z[Z.collabDataStringsLocaleMismatch=9]="collabDataStringsLocaleMismatch";Z[Z.collabDataLocaleMismatch=10]="collabDataLocaleMismatch";Z[Z.lastGenericStatusError=11]="lastGenericStatusError";Z[Z.scratchPadWarning=
12]="scratchPadWarning";Z[Z.authenticationLost=13]="authenticationLost";Z[Z.odfCompatibilityIssues=14]="odfCompatibilityIssues";Z[Z.pivotChartInteractivityMissingWarning=15]="pivotChartInteractivityMissingWarning";Z[Z.workbookIsIrmProtected=16]="workbookIsIrmProtected";Z[Z.biFeatureNotAvailable=17]="biFeatureNotAvailable";Z[Z.anonymousCreateSaveWarning=18]="anonymousCreateSaveWarning";Z[Z.unsupportedInteractiveReportEditing=19]="unsupportedInteractiveReportEditing";Z[Z.mobileAppCampaignBizBar=20]=
"mobileAppCampaignBizBar";Z[Z.transientServerCommunicationFailures=21]="transientServerCommunicationFailures";Z[Z.editAttemptInReadOnly=22]="editAttemptInReadOnly";Z[Z.editAttemptInReadOnlyNoEditPermissions=23]="editAttemptInReadOnlyNoEditPermissions";Z[Z.unsupportedBrowser=24]="unsupportedBrowser";Z[Z.readOnlyPermissions=25]="readOnlyPermissions";Z[Z.documentIsIrmProtectedWarning=26]="documentIsIrmProtectedWarning";Z[Z.policyWarningMessage=27]="policyWarningMessage";Z[Z.workingOnIt=28]="workingOnIt";
Z[Z.passwordProtectedWorkbookLockedForEdit=29]="passwordProtectedWorkbookLockedForEdit";Z[Z.workbookIsReadOnlyRecommended=30]="workbookIsReadOnlyRecommended";Z[Z.workbookHasPasswordToModify=31]="workbookHasPasswordToModify";Z[Z.legacySharedWorkbookEditWarningBB=32]="legacySharedWorkbookEditWarningBB";Z[Z.legacyConnectionsBB=33]="legacyConnectionsBB";Z[Z.groupedSlicersBB=34]="groupedSlicersBB";Z[Z.thirdPartyAddinDisabled=35]="thirdPartyAddinDisabled";Z[Z.financeLinkedEntityDisclaimerBar=36]="financeLinkedEntityDisclaimerBar";
Z[Z.wacGdprNotice=37]="wacGdprNotice";Z[Z.automaticSensitivityLabel=38]="automaticSensitivityLabel";Z[Z.recommendedSensitivityLabel=39]="recommendedSensitivityLabel";Z[Z.mandatorySensitivityLabel=40]="mandatorySensitivityLabel";Z[Z.localStorageDisabled=41]="localStorageDisabled";Z[Z.autoRefreshDisabled=42]="autoRefreshDisabled";Z[Z.corruptedFileRepaired=43]="corruptedFileRepaired";Z[Z.corruptedOdsFileRepaired=44]="corruptedOdsFileRepaired";Z[Z.minorVersionLimitReached=45]="minorVersionLimitReached";
Z[Z.sensitivityApplicationGenericError=46]="sensitivityApplicationGenericError";Z[Z.sensitivityApplicationTooLargeFileError=47]="sensitivityApplicationTooLargeFileError";Z[Z.sensitivityApplicationLabelNotSupportedError=48]="sensitivityApplicationLabelNotSupportedError";Z[Z.sensitivityApplicationLabelDisabledError=49]="sensitivityApplicationLabelDisabledError";Z[Z.sensitivityApplicationMandatoryConflictError=50]="sensitivityApplicationMandatoryConflictError";Z[Z.sensitivityApplicationMinorVersionLimitReachedError=
51]="sensitivityApplicationMinorVersionLimitReachedError";Z[Z.sensitivityApplicationSetLabelError=52]="sensitivityApplicationSetLabelError";Z[Z.promptEnableExternalLinks=53]="promptEnableExternalLinks";Z[Z.networkDown=54]="networkDown";Z[Z.defaultToViewDueToCogs=55]="defaultToViewDueToCogs";Z[Z.refreshLinkedEntityErrorBar=56]="refreshLinkedEntityErrorBar";Z[Z.promptEnableLinkedEntitiesUntrustedImages=57]="promptEnableLinkedEntitiesUntrustedImages";Z[Z.canvasHealth=58]="canvasHealth";Z[Z.novModeDepreciation=
59]="novModeDepreciation";Z[Z.mismatchedFileFormatConverted=60]="mismatchedFileFormatConverted";Z[Z.optimizeWorkbook=61]="optimizeWorkbook";Z[Z.novModePostDepreciation=62]="novModePostDepreciation";Z[Z.officeScriptsRunning=63]="officeScriptsRunning";Z[Z.powerQueryRefreshDataSourceNotSupported=64]="powerQueryRefreshDataSourceNotSupported";Z[Z.count=65]="count"})(m||(m={}));Object(y.b)("EwaBusinessBarEntryType",m);var A=b(4),x=b(1175),t=Sys.EventArgs;vm(d,t);Object(y.a)(d,"BusinessBarEntryDisplayChangedEventArgs",
Sys.EventArgs,[]);var z=b(1177),r=b(1176),G=b(1179),w=b(1178),B=b(1173),U=b(476),N=b(56),P=b(218),ia=b(35),W=b(691),R=b(27),I=b(1),Q=b(8),O=b(20),ba=b(53),ca=b(64),S=b(975),Y=b(176);b.d(D,"a",function(){return a});var na=v.a;vm(a,na);a.prototype.m3e=function(){R.a.Pq(this.$.fa.dF)&&this.Xo(this,new U.a(this.$.fa.dF,null,!1,-1,-1,-1,-1,"",-1,"",-1))};a.prototype.szg=function(Z){this.Ma.addHandler("bBarAttachedOrDetached",Z)};a.prototype.dispose=function(){if(this.$){var Z=this.$,wa=Z.qa,ma=wa.uf;wa.VC(this.Xo);
wa.Lt(this.Zh);wa.vqc(this.Okc);wa.ZFb(this.Okc);ma.lGb(this.Txa);ma.s5i(this.ECb);Z.fa.kk(this.Zc);Z.fa.mw(this.Kf);Z.ml(this.od);Z.Fn(this.qd);Z.fa.w6(this.hN);Z.userOperationManager.pz(this.qDb);O.g(Z).Kc.im(this.Puf)}n.a.Fa(this.xT);this.$=this.xT=null;na.prototype.dispose.call(this)};a.prototype.q9h=function(Z){switch(Z){case 4:case 5:case 11:case 53:case 7:case 36:return!0;case 57:return I.EwaSettings.la(682);default:return!1}};a.prototype.hg=function(Z,wa,ma,pa,Ia){ma=void 0===ma?null:ma;pa=
void 0===pa?null:pa;Ia=void 0===Ia?null:Ia;if(!this.$.isMobileMode||this.q9h(Z))this.XXa&&!this.MB(Z)&&(I.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&c.ULS.sendTraceTag(537170254,0,50,"Adding entry to BB: {0}",Enum.toString(m,Z)),this.Elb[Z]=this.Pg.A7,this.xT.BD(Z,wa,pa,Ia),this.Ma.raiseEvent("bBarAttachedOrDetached",new d(Z,!0,ma))),wa&&32===wa.Appearance&&ca.a(this.$).nd.Oka(wa)};a.prototype.rsj=function(Z,wa,ma,pa){c.ULS.sendTraceTag(537170253,0,50,"BusinessBar.ShowGdprPrivacyNotice: Called");
B.a.initialize(Z,wa,ma,pa);this.hg(37,null)};a.prototype.trj=function(Z,wa,ma,pa){x.a.initialize(Z,wa,ma,pa);this.hg(38,null)};a.prototype.Ftj=function(Z,wa,ma,pa){r.a.initialize(Z,wa,ma,pa);this.hg(39,null)};a.prototype.Usj=function(Z,wa,ma,pa){z.a.initialize(Z,wa,ma,pa);this.hg(40,null)};a.prototype.Ptj=function(Z,wa,ma,pa){w.a.initialize(Z,wa,ma,pa);this.hg(51,null)};a.prototype.Otj=function(Z,wa,ma,pa){G.a.initialize(Z,wa,ma,pa);this.hg(52,null)};a.prototype.removeEntry=function(Z){this.XXa&&
(I.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")&&c.ULS.sendTraceTag(537170251,0,50,"Removing entry from BB: {0}",Enum.toString(m,Z)),this.Elb[Z]=null,this.xT.removeEntry(Z)&&this.Ma.raiseEvent("bBarAttachedOrDetached",new d(Z,!1)))};a.prototype.Y4a=function(Z){return this.XXa?this.xT.Y4a(Z):!1};a.prototype.MB=function(Z){return this.XXa?this.xT.MB(Z):!1};a.prototype.dBb=function(){c.ULS.sendTraceTag(537170248,0,50,"Network disconnect notification received from the app")};
a.prototype.ckc=function(){c.ULS.sendTraceTag(537170247,0,50,"Network resumed notification received from the app, turning off the TransientServerCommunicationFailures business bar");this.removeEntry(21)};a.prototype.oHg=function(){var Z=b(1231).BusinessBarControl;if(this.XXa&&!this.xT){O.g(this.$).Kc.wm(this.Puf);var wa=document.getElementById(this.$.Ib+A.a.tse);this.xT=new Z(this.$,wa)}};a.prototype.NFd=function(){this.XXa&&this.xT.NFd()};a.prototype.YNf=function(Z){if(I.EwaSettings.isChangeGateEnabled("OfficeVSO:4359300_AddLogsToBusinessBar")){var wa=
this.Pg.A7;if(3E5<=wa-this.Tff){this.Tff=wa;for(var ma=0;65>ma;ma++){var pa=this.Elb[ma];pa&&(pa=wa-pa,3E5<=pa&&c.ULS.sendTraceTag(537170241,0,50,"{0}: entry [{1}] was activated but not turned off for {2} Millis",Z,Enum.toString(m,ma),pa))}}}};a.prototype.Guh=function(Z){for(var wa=[],ma=yl(Z),pa=ma.next();!pa.done;pa=ma.next())switch(pa.value.MessageId){case -113742550:pa=[757111532,2113407564,1393475740,1911608588,104919273,-689453604,157762400,-949523941],(this.$.fa.isNamedObjectViewMode||R.a.gh(Z,
pa))&&Array.add(wa,-113742550)}return R.a.jF(Z,wa)};a.prototype.DYh=function(Z,wa){switch(Z.MessageId){case 2113407564:for(var ma=R.a.XYa([1821390342,-943219229,-502303485,1437034227]),pa=0;pa<ma.length;pa++)ma[pa].HelpTopicId=Z.HelpTopicId,ma[pa].HelpDescription=Z.HelpDescription,Array.add(this.MFc,ma[pa])}switch(Z.MessageId){case -395951567:this.hg(6,Z);break;case 1643490758:this.hg(4,Z);break;case -907264831:this.hg(5,Z);break;case 757111532:case 2113407564:this.hg(7,Z);break;case 2010656511:this.hg(15,
Z);break;case 1321660996:this.$.I3c=!0;this.hg(8,Z);break;case 526339737:this.$.I3c=!0;this.hg(9,Z);break;case -407088521:this.hg(10,Z);break;case 1756116017:this.hg(14,Z);break;case -1703455218:this.hg(17,Z);break;case 1393475740:this.hg(25,Z);break;case -949523941:this.hg(26,Z);break;case 1779381952:this.hg(42,Z);break;case 1421575100:this.hg(43,Z);break;case 613676060:this.hg(44,Z);break;case 1233668252:this.hg(60,Z);break;case 1911608588:Z=!!(this.$.Fd&64);!this.$.fa.Qg()&&Z&&Array.add(wa,29);
break;case 1544494907:break;case -655555355:Array.add(wa,this.Vod()?1:0);break;case -1221382671:Array.add(wa,2);break;case 1662282929:Array.add(wa,3);break;case 104919273:this.$.fa.Qg()||Array.add(wa,30);break;case -689453604:Z=!!(this.$.Fd&64);this.$.fa.B4e=!0;!this.$.fa.Qg()&&Z&&Array.add(wa,31);break;case 157762400:this.$.fa.gfc=!0;!this.$.fa.Qg()&&this.$.Fd&64&&!this.$.isEditMode&&Array.add(wa,32);break;case -73730134:I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableEditingOfFilesWithLegacyConnections",
!1)&&!this.$.fa.Qg()&&this.$.Fd&64&&Array.add(wa,33);break;case -293349236:Array.add(wa,64);break;case -37299333:break;case 136737622:Array.add(wa,45);break;case -1780327030:this.hg(53,Z);break;case -113742550:this.hg(55,Z);break;default:this.hg(11,Z)}return wa};a.prototype.F3h=function(){var Z=this;if(k.AFrameworkApplication.ga.ra("WildFireExcelBizBar")&&!S.a.Mmd(S.a.lbd(1))&&(l.a.Ip||l.a.Xg)){var wa=N.GetServiceTaskFactory.create(this.$.da,155,this.$.ma,1);ia.TaskExtensions.Ba(wa,function(){Z.hg(20,
null)},this.ma,3)}};a.prototype.C3h=function(){var Z=I.EwaSettings.la(73),wa=I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IE11SoftBlockConsumerIsEnabled",!1),ma=I.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.IE11SoftBlockStringIsEnabled",!1);Q.HelperMethods.HOd(ma||wa,Z)&&(Y.a("NewBrowserSuggestionShown"),ma||f.a.vw("NewBrowserSuggestionShown","true",7),this.hg(24,null))};a.prototype.Y2h=function(Z){!Z&&P.g(this.$)&&this.hg(59,null)};a.prototype.Z2h=function(Z){!Z&&
P.h(this.$)&&this.hg(62,null)};a.prototype.u7e=function(Z){(!Z&&!this.$.printingEnabled||this.$.ig.get(1))&&this.$.workbookContext.FullDocumentInfo.IrmPolicyDescription&&(c.ULS.sendTraceTag(537170205,0,50,"BusinessBar.InitBusinessBar: Adding bisinessBar for irm protection."),this.hg(16,null));this.F3h();this.C3h();this.hve();this.J_f();this.Y2h(Z);this.Z2h(Z)};a.prototype.hve=function(){this.$.workbookContext.Options&32768&&this.fsj()};a.prototype.fsj=function(){I.EwaSettings.isChangeGateEnabled("OfficeVSO:5776164_DoNotShowFinanceBizBarOnColumnResize")&&
this.Elb[36]||this.hg(36,null)};a.prototype.J_f=function(){I.EwaSettings.la(682)&&this.$.workbookContext.Options&524288&&this.hg(57,null)};a.prototype.g0f=function(Z,wa){this.hg(56,Z,null,wa)};a.prototype.zje=function(Z,wa){var ma=null,pa=null;ma=void 0===ma?null:ma;pa=void 0===pa?null:pa;wa=void 0===wa?null:wa;this.xT.MB(Z)?this.xT.iMb(Z,wa):this.hg(Z,null,ma,pa,wa)};a.prototype.A_f=function(){this.$.Fd&8&&this.hg(12,null)};a.prototype.Vod=function(){var Z=this.$.da.Aa(38);return Z?Z.tokenExpired:
!1};a.prototype.Nyg=function(Z,wa){if(!this.MB(21)&&-1387426400!==Z.MessageId){c.ULS.sendTraceTag(537170204,0,50,"BusinessBar: raising the transient communication failures notification.");var ma={};ma.FailedMethod=wa;this.hg(21,Z,ma)}};a.Vac=function(){return a.Ome||(a.Ome=[0,1,2,3])};tl.Object.defineProperties(a.prototype,{j6c:{configurable:!0,enumerable:!0,get:function(){return this.MFc}},domElement:{configurable:!0,enumerable:!0,get:function(){return this.xT?this.xT.domElement:null}}});a.Ome=null;
Object(y.a)(a,"BusinessBarManager",v.a,[532,3,83])},1273:function(y,D,b){function a(A,x,t,z,r,G){this.jMc=null;this._id=A;this.RMc=x;this.Xkg=void 0===r?null:r;this.Vhb=z;this.ikb=void 0===G?null:G;this.Coa=null;this.RWa=t;this.Hkb=d.instance.mSh(x,A)}function d(){this.RCc=new f.a;this.PCc=new f.a;this.OCc=new f.a;this.pLg(this.RCc);this.oLg(this.PCc);this.nLg(this.OCc);this.THc=new f.a;this.SHc=new f.a;this.RHc=new f.a;this.KNg(this.THc);this.JNg(this.SHc);this.INg(this.RHc);this.fEc=new f.a;this.ILg(this.fEc);
this.UEa(this.fEc);this.UEa(this.OCc);this.UEa(this.PCc);this.UEa(this.RCc);this.UEa(this.SHc);this.UEa(this.THc);this.UEa(this.RHc)}y=b(0);var c=b(13),k=b(80),n=b(991),l=b(975),f=b(1253);d.prototype.mSh=function(A,x){switch(A){case 1:return this.rVh(x);case 2:return this.PCh(x)}return l.a.wvc?this.fEc:null};d.prototype.pLg=function(A){A.add("Headline",CommonUIStrings.l_WildFireWordBizBarHeadline);A.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);A.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarAndroidCallToAction)};
d.prototype.oLg=function(A){A.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);A.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);A.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarAndroidCallToAction)};d.prototype.nLg=function(A){A.add("Headline",CommonUIStrings.l_WildFireExcelBizBarHeadline);A.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);A.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarAndroidCallToAction)};d.prototype.KNg=function(A){A.add("Headline",
CommonUIStrings.l_WildFireWordBizBarHeadline);A.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);A.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);A.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);A.add("CallToAction",CommonUIStrings.l_WildFireWordBizBarIPadCallToAction);A.add("OverlayBig","Get the Word app");A.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");A.add("OverlaySmallSplit1",
"Discover Word");A.add("OverlaySmallSplit2","designed for the iPad.");A.add("SkipButton","Skip for now")};d.prototype.ILg=function(A){A.add("Headline","Get the Office Online extension for Chrome");A.add("UseAppButton","Get the extension");A.add("CallToAction","The quickest way to view, edit, and share Office files in Chrome.")};d.prototype.JNg=function(A){A.add("Headline",CommonUIStrings.l_WildFirePPTBizBarHeadline);A.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);A.add("InstallButton",
CommonUIStrings.l_WildFireBizBarInstallButtonText);A.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);A.add("CallToAction",CommonUIStrings.l_WildFirePPTBizBarIPadCallToAction);A.add("OverlayBig","Get the PowerPoint app");A.add("OverlaySmall","Built for the iPad\u2014for when you're working on the go, even offline.");A.add("OverlaySmallSplit1","Discover PowerPoint");A.add("OverlaySmallSplit2","designed for the iPad.");A.add("SkipButton","Skip for now")};d.prototype.INg=function(A){A.add("Headline",
CommonUIStrings.l_WildFireExcelBizBarHeadline);A.add("UseAppButton",CommonUIStrings.l_WildFireBizBarUseAppButtonText);A.add("InstallButton",CommonUIStrings.l_WildFireBizBarInstallButtonText);A.add("OpenAppButton",CommonUIStrings.l_WildFireBizBarOpenAppButtonText);A.add("CallToAction",CommonUIStrings.l_WildFireExcelBizBarIPadCallToAction)};d.prototype.UEa=function(A){A.add("Corporation","Microsoft Corporation")};d.prototype.rVh=function(A){switch(A){case 3:return this.THc;case 2:return this.SHc;case 1:return this.RHc}return null};
d.prototype.PCh=function(A){switch(A){case 3:return this.RCc;case 2:return this.PCc;case 1:return this.OCc}return null};tl.Object.defineProperties(d,{instance:{configurable:!0,enumerable:!0,get:function(){d.Na||(d.Na=new d);return d.Na}}});d.Na=null;Object(y.a)(d,"WildFireStringFactory",null,[]);var u=b(5),v=b(47),m=b(23);b.d(D,"a",function(){return a});a.prototype.E1c=function(){this.Coa=new n.a(this.title,this.message,null);this.Coa.addButton(this.Cse,Object(k.a)(this,this.irf,"onButtonOneClick"),
"");this.RWa&&this.Coa.$xg(this.Ese,Object(k.a)(this,this.lrf,"onButtonTwoClick"));this.Coa.V9=Object(k.a)(this,this.yFe,"dismissBar");this.Coa.image=3;this.Coa.id=16;this.Coa.closeable=!0};a.prototype.irf=function(){this.RWa?this.D6h():this.jMj()};a.prototype.lrf=function(){this.RWa&&this.kNi()};a.prototype.D6h=function(){c.ULS.sendTraceTag(17932829,306,50,"Install App Button of BusinessBar Clicked");this.Vhb&&this.ikb&&this.ikb();l.a.AJf(this._id,this.RMc)};a.prototype.kNi=function(){this.openUrl&&
(c.ULS.sendTraceTag(17932830,306,50,"Open App Button of BusinessBar Clicked"),this.Vhb&&this.ikb&&this.ikb(),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(l.a.Jne(this._id),this.openUrl,0,!1))};a.prototype.jMj=function(){l.a.wvc?this.RNg():(c.ULS.sendTraceTag(17109255,306,50,"AppBusinessBarNav"),l.a.QMd("BizBarClicked"),1!==this.RMc&&2!==this.RMc||l.a.sUg(this.openUrl,this.Vhb,this._id,this.ikb))};a.prototype.RNg=function(){this.Vhb?c.ULS.sendTraceTag(17571974,323,50,"ChromeExtBannerClicked"):
c.ULS.sendTraceTag(17571975,301,50,"ChromeExtBannerClicked");v.a.xU(u.AFrameworkApplication.ga.appSettings.WildFireChromeExtensionUrl.toString())};a.prototype.Vah=function(){this.Vhb?c.ULS.sendTraceTag(17571976,323,50,"ChromeExtBannerDismissed"):c.ULS.sendTraceTag(17571977,301,50,"ChromeExtBannerDismissed");l.a.QMd(l.a.Ive)};a.prototype.yFe=function(){l.a.wvc?this.Vah():(l.a.QMd(l.a.lbd(this._id)),c.ULS.sendTraceTag(17109256,306,50,"AppBusinessBarDismissed"))};a.e3b=function(){var A=u.AFrameworkApplication.sa.Pa,
x=new a(A.Lj,l.a.Tac(),8<m.a.f4a,1===A.Kba,function(){return A.NB},A.qRf());c.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed");return x};tl.Object.defineProperties(a.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return this.Hkb.na("Headline")}},message:{configurable:!0,enumerable:!0,get:function(){return this.Hkb.na("CallToAction")}},sMj:{configurable:!0,enumerable:!0,get:function(){return this.RWa}},Cse:{configurable:!0,enumerable:!0,get:function(){return this.RWa?this.Hkb.na("InstallButton"):
this.Hkb.na("UseAppButton")}},Ese:{configurable:!0,enumerable:!0,get:function(){return this.RWa?this.Hkb.na("OpenAppButton"):""}},ONg:{configurable:!0,enumerable:!0,get:function(){return this.Coa}},openUrl:{configurable:!0,enumerable:!0,get:function(){this.jMc||(this.jMc=this.Xkg());return this.jMc}}});Object(y.a)(a,"WildFireBusinessBar",null,[])},1315:function(y,D,b){function a(l,f,u,v,m,A){var x=n.call(this,l,f,u,v,m,A)||this;l={};f=(l.errorMessage=x.vJe,l.offerString=x.Kpf,l);l=new k.a(!1,!1,!0);
x.B_f?(l.kc=1,u={},f.helpLink=(u.type="AppLinkProps",u.id="helpLink",u.text=x.nva,u.onExecute=function(){c.Redirect.showHelp(x.i5e)},u)):(l.kc=4,l.Cc(2,x.w6e));l.Cc(1,x.qWb);l.Me=x.id;u={};f=(u.id=x.id,u.dialogIcon=x.icon,u.bodyControls=f,u);l.initializeAndShow(x.Xn,Object(d.a)(x,x.BYi,"reactOICErrorDialogWithTrialHandler"),f);return x}b.r(D);b.d(D,"ReactOICErrorDialogWithTrial",function(){return a});y=b(0);var d=b(80);D=b(1180);var c=b(410),k=b(140),n=D.a;vm(a,n);Object(y.a)(a,"ReactOICErrorDialogWithTrial",
D.a,[])},1316:function(y,D,b){function a(n,l,f,u,v,m){n=k.call(this,n,l,f,u,v,m)||this;l=document.createElement("span");l.innerText=n.vJe;l.appendChild(document.createElement("br"));l.appendChild(document.createElement("br"));f=document.createElement("span");f.innerText=n.Kpf;l.appendChild(f);f=new c.StandardDialog;n.B_f?(f.kc=1,f.mje(n.nva,n.i5e)):(f.kc=4,f.Cc(2,n.w6e));f.Cc(1,n.qWb);f.Me=n.id;f.Kk(n.Xn,null,n.icon,Object(d.a)(n,n.oki,"legacyOICErrorDialogWithTrialHandler"),l);return n}b.r(D);b.d(D,
"OICErrorDialogWithTrial",function(){return a});y=b(0);var d=b(80);D=b(1180);var c=b(128),k=D.a;vm(a,k);Object(y.a)(a,"OICErrorDialogWithTrial",D.a,[])},1317:function(y,D,b){function a(){return d.call(this)||this}b.r(D);b.d(D,"CheckRoamingRightsRequest",function(){return a});y=b(0);b=b(1182);var d=b.a;vm(a,d);a.prototype.X2a=function(){return 2};a.prototype.Mia=function(){return 1};Object(y.a)(a,"CheckRoamingRightsRequest",b.a,[])},1318:function(y,D,b){function a(){return d.call(this)||this}b.r(D);
b.d(D,"GetRoamingLauncherRequest",function(){return a});y=b(0);b=b(1182);var d=b.a;vm(a,d);a.prototype.X2a=function(){return 0};a.prototype.Mia=function(){return 2};Object(y.a)(a,"GetRoamingLauncherRequest",b.a,[])},1341:function(y,D,b){function a(u){this.dEc=!1;this.hWa=a.jdc;this.UNc=this.XLc=0;this.platform=null;this.Cqg=u;this.zge=this.VNc=!1}function d(){this.state=this.callback=null;this.Xld=!1}function c(){this.classId=0}y=b(0);var k=b(80),n=b(38);c.DHa=function(u){try{return n.a(u)}catch(v){}return null};
Object(y.a)(c,"ARoamingAppsResponse",null,[]);Object(y.a)(d,"GetRoamingAppsLauncherContext",null,[]);var l=b(5),f=b(109);b.d(D,"a",function(){return a});a.prototype.QSg=function(){l.AFrameworkApplication.Bfc&&this.roamingAppsAreEnabled&&!this.VNc&&!this.dEc&&(this.UNc=1,this.dEc=!0,this.M9i(),this.lOe())};a.prototype.M9i=function(){this.hWa=a.jdc;this.XLc=0};a.prototype.getRoamingAppsLauncher=function(u,v,m){this.CMj?(u=new d,u.callback=v,u.state=m,u.Xld=!0,this.qOe(u)):v(!1,"",m)};a.prototype.lOe=
function(){var u=new (b(1317).CheckRoamingRightsRequest);u.RoamingApp=this.UNc;u.BaseDocQuerySignature=l.AFrameworkApplication.hj;u.execute(Object(k.a)(this,this.SSg,"checkUserRoamingRightsSucceeded"),Object(k.a)(this,this.RSg,"checkUserRoamingRightsFailed"),null)};a.prototype.SSg=function(u){l.AFrameworkApplication.Gg||((u=c.DHa(u.data.fe))?this.SMd(u.HasRights):this.SMd(!1))};a.prototype.RSg=function(){if(!l.AFrameworkApplication.Gg)if(this.XLc>=a.wri)this.SMd(!1);else{var u=new f.a(2,1,this.hWa,
Object(k.a)(this,this.retryCheckUserRoamingRights,"retryCheckUserRoamingRights"),59);l.AFrameworkApplication.oj.fh(u);this.XLc++;this.hWa*=a.eaj;this.hWa>a.Slf&&(this.hWa=a.Slf)}};a.prototype.SMd=function(u){this.zge=u;this.VNc=!0;this.dEc=!1};a.prototype.retryCheckUserRoamingRights=function(){this.lOe()};a.prototype.qOe=function(u){var v=new (b(1318).GetRoamingLauncherRequest);v.RoamingApp=this.UNc;v.BaseDocQuerySignature=l.AFrameworkApplication.hj;v.execute(Object(k.a)(this,this.wQh,"getRoamingAppsLauncherSucceeded"),
Object(k.a)(this,this.vQh,"getRoamingAppsLauncherFailed"),u)};a.prototype.wQh=function(u){if(!l.AFrameworkApplication.Gg){var v=c.DHa(u.data.fe);u=u.data.state;v?(this.platform=v.Platform,u.callback(!0,v.Launcher,u.state)):u.callback(!1,"",u.state)}};a.prototype.vQh=function(u){if(!l.AFrameworkApplication.Gg){var v=u.data.state;5===u.data.status&&v.Xld?(v.Xld=!1,this.qOe(v)):v.callback(!1,"",v.state)}};tl.Object.defineProperties(a.prototype,{roamingAppsAreEnabled:{configurable:!0,enumerable:!0,get:function(){return this.Cqg}},
CMj:{configurable:!0,enumerable:!0,get:function(){return this.roamingAppsAreEnabled&&this.VNc?this.zge:!1}}});tl.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){return a.wB||(a.wB=new a(l.AFrameworkApplication.HGg))}}});a.jdc=1E3;a.eaj=5;a.Slf=12E5;a.wri=5;a.wB=null;Object(y.a)(a,"RoamingAppsManager",null,[])},1376:function(y,D,b){function a(J){return vj.call(this,J)||this}function d(J,oa,Va){var Ub=this;this.ignorePrintArea=!1;this.kEj=function(){var e=Oa.g(Ub.$).Ca;
Ub.SOc=!0;e.ewd()};this.ZHi=function(){Ub.Egd()};this.YHi=function(e,C,M){td.ULS.sendTraceTag(537154272,0,10,"PrintCommandHandler:OnPageLayoutCommandFailure Method : {0} failed to execute",M);Ub.Egd()};this.$=J;this.fa=J.fa;this.Sha=oa;this.qN=new I(1,this.ignorePrintArea);this.NC=oa=new c(J,oa,kd.AFrameworkApplication.Hd,Va);this.$.da.Ha(418,oa);this.uFf=new G(J);this.$.da.Ha(384,this);this.SOc=!1}function c(J,oa,Va,Ub){var e=this;this.activeCell=this.selectedRange=this.qg=this.graphServiceEndpoint=
null;this.x_=0;this.Im=this.Tu=null;this.ZG=new r;this.sk=new r;this.oba=0;this.B6a=null;this.LKb=!1;this.Y1a=this.LDb=null;this.Dnd=!1;this.z5a=this.cyb=this.Gfc=!0;this.Ela=this.kya=this.uMa=null;this.mxb=!1;this.y6a=null;this.S4a=this.jJc=!1;this.Sxd=function(C){if(!(C&&C.data&&C.data.fe&&C.data.responseHeaders&&C.data.fe.length)){var M=C?C.data?C.data.fe?C.data.responseHeaders?C.data.fe.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":"requestSucceededEventArgs.Data.ResponseHeaders":
"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs";e.qg&&(C=e.sza(nf.a.instance.ea(1165)),e.hna(C,0));td.ULS.sendTraceTag(593266765,0,10,"PrintPreviewManager:OnFileHandlerSuccessCallback - Invalid Parameter : {0}",M);e.QHd&&(C=Object.assign(new Hd.a,{extendedProperties:new Map}),C.extendedProperties.set("InvalidParameterName",M),sg.Health.instance.recordQosError(Xj.a.wFf,[Eh.a.xFf],!1,!0,!0,!1,C))}else if(0<e.oba&&C.data.id===e.oba){if(C.data.responseHeaders["Content-Type"]&&
(Fc.a.contains(C.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)||Fc.a.contains(C.data.responseHeaders["Content-Type"].toString(),"text/plain",!0))){td.ULS.sendTraceTag(593266764,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - pdf converted successfully");var qa=null;Fc.a.contains(C.data.responseHeaders["Content-Type"].toString(),"text/plain",!0)&&(qa=e.i0g(C));M={};e.YBb(M,null,null,qa);C.data.responseHeaders["Total-Pdf-PageCount"]?(qa=parseInt(C.data.responseHeaders["Total-Pdf-PageCount"].toString()),
e.mxb||(e.JCd>=qa?e.Ela=qa:e.mxb=!0),e.z5a&&e.qg&&e.qg.setPageRangeSettings(qa,e.JCd,e.mxb,e.kya,e.Ela)):td.ULS.sendTraceTag(537154257,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - did not receive the TotalPdfPageCount header.")}else M=Fj.a.li(C.data.fe),Ah.a.y9(M.Errors)||Yg.a(e.$).nd.AD(M.Errors[0].MessageId),e.n_i(M.Errors),e.qg&&(qa=e.sza(M.Errors[0].Description),-1831476778===M.Errors[0].MessageId?(td.ULS.sendTraceTag(537154256,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - showing pdf print timeout error message"),
e.hna(qa,0,nf.a.instance.ea(1168))):e.hna(qa,0)),297284985===M.Errors[0].MessageId?td.ULS.sendTraceTag(570716892,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - Nothing to print. Message Id: {0}",M.Errors[0].MessageId):td.ULS.sendTraceTag(593266763,0,15,"PrintPreviewManager:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: {0}",M.Errors[0].MessageId);C=C.data.state;C.H7c(M,C.userContext,C.methodName)}};this.Rxd=function(C){if(0<e.oba&&C.data.id===e.oba){var M=$h.a.yg(C.data);
e.qg&&e.hna(e.sza(M[0].Description),1);td.ULS.sendTraceTag(593266762,0,15,"PrintPreviewManager:OnFileHandlerFailureCallback has failed - Errors: [{0}]",Ah.a.Uc(M));M=C.data.state;M.M$(C,M.userContext,M.methodName);e.$.userOperationManager.Aka.operation.Qza(function(){return e.LKb})}};this.jBi=function(C,M,qa){C.Errors&&0<C.Errors.length&&e.qg?(Ah.a.y9(C.Errors)||Yg.a(e.$).nd.AD(C.Errors[0].MessageId),e.hna(e.sza(C.Errors[0].Description),0),td.ULS.sendTraceTag(537154254,0,50,"PrintPreviewManager: Failed to convert workbook. Error message Id: {0}",
C.Errors[0].MessageId)):(td.ULS.sendTraceTag(537154253,0,50,"PrintPreviewManager:OnConvertWorkbookToPdfSucceededInWebParts - Pdf conversion succeeded"),e.YBb(C,M,qa,null))};this.iBi=function(C){C=$h.a.yg(C.data);e.qg&&e.hna(e.sza(C[0].Description),1);td.ULS.sendTraceTag(537154252,0,15,"PrintPreviewManager:OnConvertWorkbookToPdfFailed invoked - Errors: [{0}]",Ah.a.Uc(C));e.$.userOperationManager.Aka.operation.Qza(function(){return e.LKb})};this.Lwf=function(C,M){if(M)switch(M.hUi){case 1:if(e.sk&&
e.Y1a)switch(C=e.Y1a.Ac,e.Y1a.stop(),e.Y1a=null,e.sk.lv){case 1:e.aZc(C,4800,"ActiveSheet");break;case 0:e.aZc(C,6100,"CurrentSelection");break;case 2:e.aZc(C,7500,"EntireWorkbook")}break;case 0:e.LDb&&(C=e.LDb.Ac,e.LDb.stop(),2400<C&&(M=Object.assign(new Hd.a,{extendedProperties:new Map}),M.extendedProperties.set("PaneLoadTime",C.toString()),sg.Health.instance.recordQosError(Xj.a.zvj,[Eh.a.i1f],!1,!0,!0,!1,M)),e.Tu.N7h(function(qa){e.vtj(qa)}))}};this.aF=function(C,M){(1===M.Wx&&e.uMa===M.Sg||2===
M.Wx)&&e.xId()};this.$=J;this.Sha=oa;this.I2=Va;this.vwd=Ub;this.QHd=ni.HelperMethods.EZ;this.Ma=new Gh.a;this.JCd=this.$.ya.PrintPreviewerPaginationRange;this.jwa=Eg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageMargin",!1);this.lfc=Eg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseMSPdfViewerForRendering",!1);this.useMSPdfViewer=this.crj();this.M4h();this.c9h=this.mSg();this.Cnd=Eg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebPrintFloodgateSurvey",
!1);if(this.isUniversalPrintEnabled=!!Ub&&Ub.gLa()&&Eg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&this.$.ig.get(116))this.graphServiceEndpoint=this.$.ya.GraphServiceEndpoint}function k(){this.appName=this.disabledChangeGates=this.isUniversalPrintFlowEnabled=this.graphServiceEndpointVersion=this.graphServiceEndpoint=null}function n(){this.onBackToSheet=null}function l(){this.onNotifyPrintJobStatus=this.onClosePreviewer=this.getGraphServiceAuthorizationToken=this.onLocalPrint=
null}function f(){this.selectedColor=this.selectedMargin=this.selectedScaling=this.selectedPaperSize=this.selectedOrientation=this.selectedWhatToPrint=0;this.selectedPrintGridlines=this.selectedIgnorePrintArea=!1;this.selectedRowAndColumnHeadings=this.selectedVerticalCenter=this.selectedHorizontalCenter=this.selectedDraft=this.selectedPageEnd=this.selectedPageStart=null}function u(){this.onDropdownSettingsFocus=this.onPrint=this.onSettingChange=null}function v(J,oa,Va,Ub,e,C){var M=A.call(this,e)||
this;M.Ld=!1;M.a1f=!1;M.Vyd=function(qa){M.NC.Vyd(qa)};M.czd=function(qa){M.NC.czd(qa)};M.EJi=function(){td.ULS.sendTraceTag(537154190,0,50,"PrintSettingsManager.OnSavePrintSettingsToFileSuccess: Saving print settings to file successful.")};M.DJi=function(qa){qa=$h.a.yg(qa.data);td.ULS.sendTraceTag(537154189,0,10,"PrintSettingsManager.OnSavePrintSettingsToFileFailure: Save print settings to file failed. Errors: {0}.",Ah.a.Uc(qa))};M.aF=function(qa,Na){2===Na.Wx?M.Su.clear():1===Na.Wx&&M.Su&&M.Su.contains(Na.Sg)&&
(td.ULS.sendTraceTag(537154188,0,50,"PrintSettingsManager.OnQueueChanged: web method {0} returned, it took {1} milliseconds to complete.",$k.a(Na.Sg.operation.operationName),Na.Sg.dequeueUtcTime.getTime()-Na.Sg.enqueueUtcTime.getTime()),M.Su.remove(Na.Sg))};M.NC=J;M.qN=Va;M.$=oa;M.sheetName=Ub;M.locale=window.navigator.browserLanguage||window.navigator.language||M.$.ya.UICultureTag;M.UOi=M.kZg();M.$.userOperationManager.uy(M.aF);M.Su=new ra.a;M.jwa=Eg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageMargin",
!1);M.isUniversalPrintEnabled=C;return M}function m(J,oa){this.sheetPrintOptions=this.sheetName=null;this.sheetName=J;this.sheetPrintOptions=oa}function A(J){this.Rvi=[.75,.75,.7,.7,.3,.3];this.Hui=[.75,.75,.25,.25,.3,.3];this.kPj=[1,1,1,1,.5,.5];this.f9d=this.mde=this.Bae=this.kae=this.Zge=this.d6=this.narrow=this.wide=this.normal=null;this.sheetPrintOptions={};this.Om=J;this.$4h();this.g5h()}function x(){this.printSettingOptionKey=0;this.printSettingOptionText=null}function t(){this.footer=this.header=
this.bottom=this.top=this.right=this.left=0}function z(){this.marginValue=this.printSettingOption=null}function r(){this.margin=this.W_=this.$ba=this.orientation=this.lv=0;this.ignorePrintArea=!1;this.sheetPrintOptions=null;this.y0a=!1;this.NoColor=null}function G(J){var oa=this;this.ribbonCommandInfo=this.yDb=null;this.qEj=function(Va,Ub,e){Ub=!!Va&&!!Va.RequestTelemetryData;Oa.g(oa.$).Ji&&Oa.g(oa.$).Ji.Pka(oa.eKa.na(oa.ribbonCommandInfo.command),Va.StateId,Ub?Va.RequestTelemetryData.EcsOperationDuration:
0,Ub?Va.RequestTelemetryData.EcsRequestDuration:0,Ub?Va.RequestTelemetryData.WfeRequestDuration:0);oa.vOf&&oa.gSg(e)};this.$=J;this.vOf=ni.HelperMethods.EZ&&Eg.EwaSettings.isChangeGateEnabled("OfficeVSO:5140883_ReportPrintAreaPageBreaksQosError");this.eKa=new Tk.a;this.$ua=new Tk.a;this.$ua.add(78661008,12);this.$ua.add(275604654,13);this.$ua.add(-13332329,14);this.$ua.add(-837651977,9);this.$ua.add(-1778266776,10);this.$ua.add(845325699,11);this.Cnd=Eg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ExcelWebPrintFloodgateSurvey",
!1)}function w(){this.LastColumn=this.LastRow=this.FirstColumn=this.FirstRow=0}function B(){this.Max=this.Min=this.Index=0}function U(){this.Col=this.Row=null}function N(J){this.sheetName=null;this.sheetName=J}function P(J){this.sheetName=null;this.sheetName=J}function ia(J){this.sharedSheetCell=null;this.sharedSheetCell=J}function W(J){this.sharedSheetCell=null;this.sharedSheetCell=J}function R(J,oa){this.multiRange=null;this.addToPrintArea=!1;this.multiRange=J;this.addToPrintArea=oa}function I(J,
oa){this.f6=0;this.p5d=!1;this.lv=J;this.ignorePrintArea=oa}function Q(J,oa,Va,Ub,e,C,M,qa){var Na=Z.call(this,J,oa,Va,Ub,e,Eg.EwaSettings.la(406))||this;Na.pca=null;Na.D$=null;Na.Qcc=null;Na.eQd=!1;Na.Hwa=null;Na.H9a=null;Na.mya=null;Na.vza=null;Na.k4a=null;Na.Dya=1;Na.Sla=1;Na.w_=0;Na.f6=1;Na.LEb=!1;Na.Tr=null;Na.zHb=0;Na.yHb=0;Na.nya=null;Na.wza=null;Na.selectedRange=null;Na.x_=0;Na.f8a=function(){Na.x_++;Na.f6=Na.CXc();Na.q6c(Na.D$.checked?!0:!1);Na.V6&&(Na.Qcc.disabled=Na.Mv.checked);Na.RLd(Na.D$.checked?
!0:!1);td.ULS.sendTraceTag(595194762,0,50,"PdfPrintDialog:OnChangeWhatToPrint What to print option changed to {0}",Na.f6.toString());return!0};Na.wrf=function(){Na.x_++;Na.LEb=Na.k4a.checked;td.ULS.sendTraceTag(537154311,0,50,"PdfPrintDialog:OnChangeIgnorePrintArea Setting Ignore print area changed to {0}",Na.LEb.toString())};Na.Vkc=function(){Na.x_++;Na.Dya=Na.fte();td.ULS.sendTraceTag(595079450,0,50,"PdfPrintDialog:OnChangeOrienation orientation option changed to {0}",Na.Dya.toString());return!0};
Na.xrf=function(){Na.x_++;var Hb=Na.Sla;Na.Sla=Q.paperSizeOptions[Na.mya.selectedIndex];td.ULS.sendTraceTag(595079449,0,50,"PdfPrintDialog:OnChangePaperSize paperSize option changed from {0} to {1}",Hb.toString(),Na.Sla.toString());return!0};Na.yrf=function(){Na.x_++;var Hb=Na.w_;Na.w_=Q.scalingOptions[Na.vza.selectedIndex];2===Na.w_?(Na.zHb=1,Na.yHb=0):3===Na.w_?(Na.zHb=0,Na.yHb=1):1===Na.w_&&(Na.zHb=1,Na.yHb=1);td.ULS.sendTraceTag(595079448,0,50,"PdfPrintDialog:OnChangeScaling scaling option changed from {0} to {1}",
Hb.toString(),Na.w_.toString());return!0};Na.Sxd=function(Hb){if(Hb&&Hb.data&&Hb.data.fe&&Hb.data.responseHeaders&&Hb.data.fe.length){if(Hb.data.responseHeaders["Content-Type"]&&Fc.a.contains(Hb.data.responseHeaders["Content-Type"].toString(),"application/pdf",!0)){td.ULS.sendTraceTag(51676164,0,50,"PdfPrintDialog:OnFileHandlerSuccessCallback - pdf converted successfully");var Gc={};Na.YBb(Gc,null,null)}else Gc=Fj.a.li(Hb.data.fe),td.ULS.sendTraceTag(51676165,0,15,"PdfPrintDialog:OnFileHandlerSuccessCallback - Failed to convert workbook. Error message Id: {0}",
Gc.Errors[0].MessageId);Hb=Hb.data.state;Hb.H7c(Gc,Hb.userContext,Hb.methodName)}else td.ULS.sendTraceTag(51676163,0,10,"PdfPrintDialog:OnFileHandlerSuccessCallback - Invalid Parameter : {0}",Hb?Hb.data?Hb.data.fe?Hb.data.responseHeaders?Hb.data.fe.length?null:"requestSucceededEventArgs.Data.ResponseData.Length":"requestSucceededEventArgs.Data.ResponseHeaders":"requestSucceededEventArgs.Data.ResponseData":"requestSucceededEventArgs.Data":"requestSucceededEventArgs")};Na.Rxd=function(Hb){var Gc=$h.a.yg(Hb.data);
td.ULS.sendTraceTag(51676166,0,15,"PdfPrintDialog:OnFileHandlerFailureCallback has failed - Errors: [{0}]",Ah.a.Uc(Gc));Gc=Hb.data.state;Gc.M$(Hb,Gc.userContext,Gc.methodName)};Na.YBb=function(Hb){Hb.Errors&&0<Hb.Errors.length?td.ULS.sendTraceTag(51499295,0,50,"PdfPrintDialog: Failed to convert workbook. Error message Id: {0}",Hb.Errors[0].MessageId):(6===Na.ee.df&&kd.AFrameworkApplication.sa.Re.dk(Oa.g(Na.$).vSf),td.ULS.shipAssertTag(537154309,0,!!Na.$.xa.oa,"PdfPrintDialog.OnConvertWorkbookToPdfSucceeded: EwaControl.Sheets.ActiveItem should not be null"),
Na.$.xa.oa&&Na.Sha.c0f(Na.WGa()))};Na.Sha=C;Na.activeCell=Na.$.oa.activeCell.toString();Na.Im.SelectedRanges&&Na.Im.SelectedRanges.Ranges&&0<Na.Im.SelectedRanges.Ranges.length&&Na.Im.SelectedRanges.Ranges[0]&&(Na.selectedRange=rh.B(Na.Im.SelectedRanges.Ranges[0]).toString());Na.sheetName=M;Na.qN=qa;Na.uAd={};J=0;for(oa=Q.paperSizeOptions.length;J<oa;++J)Na.uAd[Q.paperSizeOptions[J].toString()]=J;Na.locale=window.navigator.browserLanguage||window.navigator.language||Na.$.ya.UICultureTag;Na.V6=Eg.EwaSettings.isChangeGateEnabled("OfficeVSO:4738349_EnableIgnorePrintAreaSettingInPrintDialog");
return Na}function O(J,oa){this.printSettings=this.sheetName=null;this.sheetName=J;this.printSettings=oa}function ba(){}function ca(J,oa,Va,Ub,e){J=Z.call(this,J,oa,Va,Ub,e)||this;J.Orb=null;return J}function S(J,oa,Va,Ub,e,C,M,qa){qa=J.Oa(1,void 0===qa?null:qa);qa.sheetName=oa;qa.locale=Va;return Le.i(J,"GetPrintSettings",qa,Ub,e,C,M,4)}function Y(J,oa,Va,Ub,e,C,M){M=J.Oa(1,void 0===M?null:M);M.ConvertInParameters=oa;return Le.i(J,"ConvertWorkbookToPrintPdf",M,Va,Ub,e,C,4)}function na(J,oa,Va,Ub,
e,C,M,qa){qa=J.Oa(9,void 0===qa?null:qa);qa.sheetName=oa;qa.printSettings=Va;return Le.i(J,"SetSheetPrintSettings",qa,Ub,e,C,M,0)}function Z(J,oa,Va,Ub,e,C){J=sk.call(this,J,oa,Va,void 0===C?!1:C)||this;J.Mv=null;J.Im=Ub;J.vPb=e;return J}function wa(){this.r2d=this.rb=null}function ma(J,oa,Va,Ub,e,C,M,qa,Na,Hb){this.UVb=null;this.ljg=J;this.Zib=oa;this.GLc=Va;this.rmg=Ub;this.Umg=e;this.cNc=new mg.a(Object(wf.a)(this,this.ZOh,"getProbeResults"));this.rUa=C;this.u8d=Na;this.hsg=M;this.Vmg=qa;this.ang=
Hb}function pa(J,oa){this.C3f=J;this.WRa=oa}function Ia(J){this.isEnabled=Boolean.parse(J.DirectPrintIsEnabled||"false");Boolean.parse(J.DirectPrintProbeIsEnabled||"false");this.Sbi=Boolean.parse(J.DirectPrintEnabledForInternetExplorer||"false");this.VRa=(J.DirectPrintSupportedMimeTypes||"").split(Ia.V4c);this.WRa=(J.DirectPrintSupportedPlugins||"").split(Ia.V4c);this.S1h=(J.DirectPrintImmersivePreviewPlugins||"").split(Ia.V4c);this.V$e=Boolean.parse(J.DirectPrintEnabledForEdge||"false");this.N9h=
Boolean.parse(J.ChromePrintLayoutFixIsEnabled||"false");this.cTg=parseInt(J.ChromeVersionFromWhichPrintLayoutIsEnabled||"76");this.kud=14;this.Jmf=14394;if(J=J.DirectPrintMinimalSupportedEdgeVersion){var oa=J.split(".");2===oa.length?(this.kud=parseInt(oa[0]),this.Jmf=parseInt(oa[1])):td.ULS.sendTraceTag(20734112,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is invalid: {0}",J)}else td.ULS.sendTraceTag(20734113,208,15,"DirectPrintBrsSettings:: DirectPrintMinimalSupportedEdgeVersion is not set in BRS")}
function Ma(J,oa,Va,Ub,e){Va=void 0===Va?null:Va;Ub=void 0===Ub?!0:Ub;e=void 0===e?!1:e;oa=rg.call(this,J,!0,!(Ma.PSa&&Ub),new cg(J,oa),Va,e)||this;Ma.PSa=Ma.PSa&&Ub;if(Ma.PSa){Ub=document.createElement("iframe");e=null;var C=oa.fah;Ub.name="pdfObjectFrame";Ub.id="pdfObjectIFrame";if(Va&&0<Va.count){var M=Kg.a.Ydd(J,Va);J=Kg.a.kGd(J,Va);e=document.createElement("form");e.id="printPreviewPostForm";e.method="POST";e.target=Ub.name;e.action=J;J=yl(M);for(Va=J.next();!Va.done;Va=J.next())Va=Va.value,
M=document.createElement("input"),M.type="hidden",M.name=Va.key,M.value=Va.value,e.appendChild(M)}else Ub.src=J;C.appendChild(Ub);e&&(C.appendChild(e),e.submit());Sys.UI.DomElement.addCssClass(Ub,"DirectPrintPdfObjectHidden");Qh.a.nh(Ub,Qh.a.GB,Qh.a.rj)}return oa}function ob(J){this.IO=J}function Cb(J,oa,Va,Ub){Ub=void 0===Ub?null:Ub;var e=nk.call(this)||this;e.kpa=null;e.Rl=null;e.PO=null;e.Vm=[];e.kTb=oa;e.IO=J;e.rlg=Va;e.AUb=Ub;e.Gkb=new Nj.a("LoadResource","LoadPrintablePdf");return e}function Xa(J){var oa=
Uh.call(this)||this;oa.$=J;oa.dc();return oa}function Sb(J){this.stopwatch=this.IYb=this.Jxc=this.wSd=null;this.C4f=0;this.$=J;(this.WUc=Eg.EwaSettings.isChangeGateEnabled("OfficeVSO:5782706_NSVTC"))||J.da.Ha(322,this)}function Tb(J){this.Ffe=0;this.D4f=J}function da(J,oa,Va,Ub,e,C,M){this.title=J;this.body=oa;this.aUi=Va;this.primaryButtonAction=Ub;this.secondaryButtonAction=C;this.TSf=e;this.targetObject=M}function ya(J){var oa=ri.call(this)||this;oa.$=J;oa.dc();return oa}function hb(J){this.$=
J;J.da.Ha(309,this)}function Gb(J){var oa=Ui.call(this,J)||this;oa.Jo=null;oa.stopwatch=null;oa.Cui=function(Va){if(1===Va)oa.$.Ka.Zb(new Gj.a(-2050946363,Yc.a.Wb,2,8,null)).continueWith(function(e){oa.Jo.setResult(!Di.a(e)&&e.result)}),Va="Yes";else{var Ub=2===Va;oa.Jo.setResult(Ub);Va=2===Va?"No":"Close";Ub&&oa.RTi()}oa.Dni(Va);oa.hide()};return oa}function Qb(){}function Fb(J){return wi.call(this,J)||this}function ta(J){this.Di=J}function xa(J){var oa=pi.call(this)||this;oa.$=J;oa.dc();return oa}
function sa(J){J.da.Ha(446,this)}function lb(J){return Bh.call(this,J)||this}function Yb(J,oa){var Va=this;this.sortOptions=this.vwc=this.selectedRange=null;this.p$e=!1;this.activeCell=this.Yf=this.Bb=this.Wc=null;this.SKi=function(Ub,e){Wg.b(Ub,-901005882)?(Yg.a(Va.$).nd.AD(-901005882),Va.iDd(e)):Va.x4e(Ub)?Va.i3e(Ub.Errors[0]):!Wg.a(Ub)&&Ub.Result&&(Va.sortOptions=e,Va.vwc=rh.D(Ub.Result.ActualSortRange),Va.Jgf=Va.ha().Lha,Va.p$e||(Va.selectedRange=Va.ha().va.Qd,Va.selectedRange.equals(Va.vwc)||
Va.Xtj()),Va.sortOptions&&Va.sortOptions.ActiveCell&&(Ub=Va.sortOptions.ActiveCell,Ub=new Oi.Range(Ub.FirstRow+1,Ub.FirstColumn+1,Ub.FirstRow+1,Ub.FirstColumn+1,!0,!1),Va.ZK(Ub),Va.aUd(Ub)))};this.onContentReady=function(){Va.gKf(!1);var Ub=Va.ha();Ub.va.Dh&&Ub.va.Qd.equals(Va.vwc)&&Ub.updateSelection(Va.selectedRange,Ub.va.activeCell,0,void 0,void 0,void 0,!0)};this.pEi=function(Ub,e){Ub&&!Ah.a.hh(Ub.Errors)&&Va.Wc&&(Va.Wc.Do=Ub.Result,Va.nIb(),Va.applyPivotSort(e))};this.oEi=function(){};this.$=
J;this.Jgf="";this.namedSheetViewPublic=oa;this.gridView=Oa.g(this.$);this.$.Ub.Xh("LoadResource","LoadDialogControlsStopwatch")}function Fa(J,oa,Va,Ub,e,C,M){M=J.Oa(41,void 0===M?null:M);M.options=oa;return Le.i(J,"Sort",M,Va,Ub,e,C,0)}function Sa(J){this.filterRange=null;this.filterRange=J}function Ra(J){this.selection=null;this.selection=J}function Lb(J,oa,Va,Ub){var e=Gi.call(this,J)||this;e.wOd=!1;e.uec=!1;e.a6=[];e.Q7h=function(C,M){var qa=e.X1g(C);e.C4a(214,function(Na,Hb,Gc){return Le.G(e.$.qa.ta,
qa,e.AZa(Na,e.kAh(M)),e.KT(Hb),Gc,null)},16,!0)};e.P7h=function(C,M,qa){C=Le.F(e.$.qa.ta,M,e.VAh(M,qa),e.HEi,null,C);Array.add(e.a6,C)};e.HEi=function(){td.ULS.sendTraceTag(529105632,0,10,"CustomSortDialog.OnGetSortConditionColorsOrIconsRequestFailure: GetSortConditionColorsOrIcons request failed.");e.S4b(Lb.Xpb())};e.P4c=function(C,M){if(1===C){C=M.sortRangeType;var qa={};qa.SortOptions=M.sortOptions;qa.ShouldRestoreSelection=e.wOd;qa.SelectedRange=e.selectedRange;qa.OriginalActiveCell=e.dnc;qa.TopCellAddress=
e.qSa;if(e.Opj(C)){var Na=e.$;e.namedSheetViewPublic.dAa().continueWith(function(Hb){Hb.result&&Lb.BHf(Na,qa)})}else Lb.BHf(e.$,qa)}else e.wOd&&e.Yna(e.selectedRange,e.dnc)};e.v0h=function(C,M){e.wOd=!0;e.Yna(C,M)};e.getColorName=function(C){return Nf.a.JJa(Kf.a.GG(C))};td.ULS.shipAssertTag(529105669,0,!!oa.ActiveCell);td.ULS.shipAssertTag(529105668,0,!!oa.SelectedRange);td.ULS.shipAssertTag(529105667,0,rh.D(oa.SelectedRange).contains(rh.C(oa.ActiveCell)));td.ULS.shipAssertTag(529105666,0,Fc.a.equals(oa.SelectedRange.SheetName,
oa.ActiveCell.SheetName,!0));Eg.EwaSettings.isChangeGateEnabled("OfficeVSO:5963270_DialogMergeSuspension")&&(e.Oab=new ci.a(J,Jh.a.f7g,function(){return e.uec}));e.selectedRange=oa.SelectedRange;e.dnc=oa.ActiveCell;e.IPg=oa.ExpandSelection;e.namedSheetViewPublic=Va;e.qSa=Ub;e.initializeAndShow(nf.a.instance.ea(182),e.P4c,e.xsa(oa));return e}function Ja(J,oa){J=uh.call(this,J,oa)||this;J.LAb=J.Jad();J.jr();return J}function xb(J,oa){var Va=J.SortRange;J=J.SortTopToBottom?Va.LastColumn-Va.FirstColumn:
Va.LastRow-Va.FirstRow;return 0<=oa&&oa<=J}function Kb(J,oa){if(!J.SortColumnInfoItems)return td.ULS.sendTraceTag(537151618,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: SortColumnInfoItems is null"),!1;for(var Va=new ra.a,Ub=yl(J.SortColumnInfoItems),e=Ub.next();!e.done;e=Ub.next()){e=e.value;if(!xb(J,e.ColumnOffset))return td.ULS.sendTraceTag(537151617,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: offset [{0}] is out of bounds. sort range: {1}",e.ColumnOffset,J.SortRange),!1;if(!e.Name)return td.ULS.sendTraceTag(537151616,
0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: invalid column name for offset [{0}]",e.ColumnOffset),!1;if(e.CellColors&&!e.CellColors.length)return td.ULS.sendTraceTag(537151587,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: cell colors are not null but length = [{0}]",e.CellColors.length),!1;if(e.TextColors&&!e.TextColors.length)return td.ULS.sendTraceTag(537151586,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: text colors are not null but length = [{0}]",e.TextColors.length),
!1;if(e.Icons&&!e.Icons.length)return td.ULS.sendTraceTag(537151585,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: icons are not null but length = [{0}]",e.Icons.length),!1;Va.add(e.ColumnOffset)}if(J.SortConditions)for(Ub=yl(J.SortConditions),e=Ub.next();!e.done;e=Ub.next())if(e=e.value,!Va.contains(e.RowColOffset))return td.ULS.shipAssertTag(537151584,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: missing column info item for sort condition [{0}]",e.RowColOffset),!1;if(J.HeaderColumnInfoItems){if(J.HeaderColumnInfoItems.length!==
J.SortColumnInfoItems.length)return td.ULS.shipAssertTag(537151583,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo length doesn't match sort column info length"),!1;for(Va=0;Va<J.HeaderColumnInfoItems.length;++Va){Ub=J.HeaderColumnInfoItems[Va];if(oa&&Ub.ColumnOffset!==J.SortColumnInfoItems[Va].ColumnOffset)return td.ULS.shipAssertTag(537151582,0,!1,"SharedSortInfoResultExtension.VerifyColumnInfo: header columnInfo item offset doesn't match sort columnInfo item offset."),!1;
if(Ub.CellColors&&1<Ub.CellColors.length)return td.ULS.sendTraceTag(537151581,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.CellColors is not null and has more than 1 background color"),!1;if(Ub.TextColors&&1<Ub.TextColors.length)return td.ULS.sendTraceTag(537151580,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.TextColors is not null and has more than 1 font color"),!1;if(Ub.Icons&&1<Ub.Icons.length)return td.ULS.sendTraceTag(537151579,0,10,"SharedSortInfoResultExtension.VerifyColumnInfo: headerColumnInfo.Icons is not null and has more than 1 icon"),
!1}}return!0}function Eb(J){if(!J.SortConditions)return!0;for(var oa=yl(J.SortConditions),Va=oa.next();!Va.done;Va=oa.next()){Va=Va.value;if(!xb(J,Va.RowColOffset))return td.ULS.sendTraceTag(537151620,0,10,"SharedSortInfoResultExtension.VerifySortConditions: offset [{0}] is out of bounds. sort range: {1}",Va.RowColOffset,J.SortRange),!1;if(1===Va.SortConditionType&&Va.FillGradient&&!Xc.isValid(Va.FillGradient))return td.ULS.sendTraceTag(537151619,0,10,"SharedSortInfoResultExtension.VerifySortConditions: sortCondition contains invalid fillGradient"),
!1}return!0}function Hc(J){return J.SortRange?4===J.SortRangeType?(td.ULS.sendTraceTag(537151622,0,10,"SharedSortInfoResultExtension.VerifySortRange: Unsupported sort range type: {0}",J.SortRangeType),!1):2===J.SortRangeType&&J.SortTopToBottom&&(null==J.HeaderRowSize||0>J.HeaderRowSize)?(td.ULS.sendTraceTag(537151621,0,10,"SharedSortInfoResultExtension.VerifySortRange: header row size must be equal or greater than 1, when range is sheetrange"),!1):!0:(td.ULS.sendTraceTag(537151623,0,10,"SharedSortInfoResultExtension.VerifySortRange: sort range is null"),
!1)}function Xc(){}function Pc(J,oa,Va,Ub){new Sys.UI.Point(J,oa);new Sys.UI.Point(Va,Ub)}function wd(){}function Tc(J,oa,Va,Ub){J=J.HeaderColumnInfo;return Ub||J?2===oa&&Va?J.CellColors&&1!==J.CellColors.length?(td.ULS.sendTraceTag(537151626,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.CellColors should be null or have exactly 1 color."),!1):J.TextColors&&1!==J.TextColors.length?(td.ULS.sendTraceTag(537151625,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.TextColors should be null or have exactly 1 color"),
!1):J.Icons&&1!==J.Icons.length?(td.ULS.sendTraceTag(537151624,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo.Icons should be null or have exactly 1 icon"),!1):!0:J?(td.ULS.sendTraceTag(537151627,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyHeaderColumnInfo: headerColumnInfo should be null when range type is not SheetRange, or when headerRowSize{0} == 0.",Va),!1):!0:!0}function ub(J,oa){J=J.ColumnInfo;switch(oa){case 1:return J.CellColors&&
J.CellColors.length?!0:(td.ULS.sendTraceTag(537151631,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on cell color result cell colors is null or there are no colors (must have at least 1)."),!1);case 2:return J.TextColors&&J.TextColors.length?!0:(td.ULS.sendTraceTag(537151630,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on font color result text colors is nullor there are no colors (must have at least 1)."),!1);case 3:return J.Icons&&J.Icons.length?
!0:(td.ULS.sendTraceTag(537151629,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: sort on icon result icons is nullor there are no icons (must have at least 1)."),!1);default:return td.ULS.sendTraceTag(537151628,0,10,"SharedSortConditionColorsOrIconsResultExtention.VerifyColumnInfo: illeagl sort condition type."),!1}}function fb(J){var oa=this;this.Ov=function(Va){switch(Va){case 0:oa.VMa("Cancel");break;case 1:oa.VMa("Expand and sort");oa.zOe(!0);break;case 2:oa.VMa("Just sort"),
oa.zOe(!1)}};this.zOe=J}function Ta(J,oa,Va,Ub,e,C,M){M=J.Oa(41,void 0===M?null:M);M.filterRange=oa;return Le.i(J,"ReapplyAutoFilter",M,Va,Ub,e,C,0)}function eb(J){this.options=null;this.options=J}function tb(J){return Nd.call(this,J)||this}function rc(J,oa,Va){var Ub=ld.call(this)||this;Ub.ute=!1;Ub.tte=!1;Ub.Czi=function(){Ub.ute=!0;Ub.g_f()};Ub.$=J;Ub.Sa=oa;Ub.FJ=Va;Yg.a(Ub.$).iFd(new cd.a(he.a.$8f,he.a.idle,rc.FRg),new Fk.a(he.a.Uwe,he.a.f_,null,he.a.kO,he.a.idle));return Ub}function wb(J){var oa=
ac.call(this,J,nf.a.instance.ea(1225))||this;oa.textBox=null;oa.oQa=null;oa.BSa=null;oa.SAf=function(){var Va=oa.$;oa.ou();var Ub=new E(Va,1228,1229,1230,function(e,C,M){var qa=Va.qa.ta.Xb(),Na=Va.qa.ta;qa=Na.Oa(1,qa);return Le.i(Na,"UnshareForm",qa,e,C,M,null,0)},16);Ub.initialize();Ub.mf()};return oa}function E(J,oa,Va,Ub,e,C){C=void 0===C?0:C;J=jb.call(this,J,nf.a.instance.ea(oa),!1)||this;J.message=Va;J.jyi=Ub;J.wXd=e;J.operationFlags=C;return J}function Mb(J,oa,Va){var Ub=Ha.call(this,J,new Sys.UI.Point(Mb.b9g,
Mb.D8g),nf.a.instance.ea(oa?1223:1222))||this;Ub.G_a=null;Ub.bJc=!1;Ub.Qmc=function(e){function C(Hb,Gc,gd){return Le.E(M.qa.ta,T.b(Hb,Ub.cKi),Gc,gd,qa)}var M=Ub.$,qa=new ka;qa.TG=e.Values[bb.TG];var Na=!1;switch(e.MessageId){case bb.VXf:Ub.ou();Na=!0;qa.GBd=1334518759;break;case bb.view:Ub.FAa=nf.a.instance.ea(1223);Ub.cag(!0);break;case bb.Mwe:Ub.ou(),Na=!0}Eg.EwaSettings.tc()?(e=new Ge.a(140,0,C),e.flags=Na?16:80):(e=Na?new Ge.a(140,0,C):new rj.a(140,0,C),e.flags=16);M.userOperationManager.ic(e,
Ub.ee)};Ub.iCi=function(){var e=Ub.$;e.ya.SurveyRedirectUrl?(Ub.ou(),e.Ce(1305810481,0,8,null)):(Ub.FAa=nf.a.instance.ea(1222),Ub.cag(!1))};Ub.qKi=function(){var e=Ub.$;Ub.ou();e.Ce(1334518759,0,8,null)};Ub.Vrf=function(e){var C=Ub.$;Ub.ou();e.MessageId===bb.Wwe&&C.fa.T$c()};Ub.IIi=function(){Ub.bJc=!0;Ub.raiseEvent(Mb.brd)};Ub.cKi=function(e,C){if(!Wg.a(e)){e=Ub.$;if(C.TG){var M=e.fa.xa;if(M.contains(C.TG.SheetName))Ub.Jlc(C);else{var qa=null;qa=function(){M.dma(qa);Ub.Jlc(C)};M.pga(qa)}}1461300262!==
C.GBd&&e.Ce(C.GBd,0,8,null)}};Ub.Y6d=oa;Ub.ee=Va;return Ub}function ka(){this.TG=null;this.GBd=1461300262}function bb(){}function Ga(J){J=Ha.call(this,J,new Sys.UI.Point(960,680),nf.a.instance.ea(1218))||this;J.name=ab.a.ZHe;return J}function Ha(J,oa,Va,Ub){var e=yk.call(this,J,Va,2,void 0===Ub?null:Ub)||this;e.OHc=null;e.onResize=function(){var C=e.zKh();e.GKa.setAttribute("width",C.x.toString());e.GKa.setAttribute("height",C.y.toString());e.ZIj(C);e.hyd()};e.Pgh=function(){var C=e.Zw.parentNode.style,
M=C.top;C.top="2px";C.top=M};e.XDe=oa;e.$.Yz(e.onResize);e.dcc();return e}function Ua(J){return Lg.call(this,J)||this}function kb(J){this.$=J}function $a(J,oa,Va,Ub,e,C,M,qa){qa=J.Oa(9,void 0===qa?null:qa);qa.sheetName=oa;qa.directionRtl=Va;return Le.i(J,"ChangeSheetDirection",qa,Ub,e,C,M,0)}function Xb(J,oa,Va,Ub,e,C,M,qa){qa=J.Oa(9,void 0===qa?null:qa);qa.sheetName=oa;qa.show=Va;return Le.i(J,"ShowHeadings",qa,Ub,e,C,M,0)}function dc(J,oa,Va,Ub,e,C,M,qa){qa=J.Oa(9,void 0===qa?null:qa);qa.sheetName=
oa;qa.show=Va;return Le.i(J,"ShowGridlines",qa,Ub,e,C,M,0)}function Za(J,oa){this.sheetName=null;this.value=!1;this.sheetName=J;this.value=oa}function Wa(J,oa){var Va=Gk.call(this)||this;Va.activityName=J;Va.$L=oa;Va.dc();return Va}function Ba(J,oa,Va,Ub,e){J=nj.call(this,J,oa)||this;Ba.itd=[-1468309555,611268539,-2087635043,2100961153,810218235,1112506702];Ba.htd=[-1468309555,-315732528,-399065540,810218235,1531005923,1593924569,1112506702,1220851643];Ba.Zkf=[-1468309555,611268539,-1750576502,61029505];
Ba.Ykf=[-1468309555,-315732528,1112506702,-238814601,-1750576502,61029505,-1337545025];J.cwc=Va;J.uuj=Ub;J.zDj=e;return J}function db(){var J=lk.call(this)||this;J.dc();return J}function Zb(J,oa){return Pk.call(this,J,oa)||this}function Jb(J){var oa=wk.call(this)||this;oa.$=J;oa.dc();return oa}function Ic(J,oa){this.$=J;this.Di=oa;this.$.da.Ha(393,this)}function uc(J){var oa=Ok.call(this,J)||this;oa.Qxh=function(Va,Ub,e,C,M){return 1===e?32:Va===Pg.a.hQa&&2===e?(Va=oa.$.qa.ta.Xb(),Le.Z(oa.$.qa.ta,
M[0],M[1],null,null,Va),32):8};return oa}function za(J,oa){this.$=J;this.Di=oa}function pb(J){return Xh.call(this,J)||this}function cc(J,oa){var Va=this;this.cJi=function(Ub,e){if(!Wg.a(Ub)&&e){var C=!!Ub&&!!Ub.RequestTelemetryData;Oa.g(Va.$).Ji.Pka(e,Ub.StateId,C?Ub.RequestTelemetryData.EcsOperationDuration:0,C?Ub.RequestTelemetryData.EcsRequestDuration:0,C?Ub.RequestTelemetryData.WfeRequestDuration:0)}};this.$=J;this.hi=oa}function Ac(J,oa){var Va=Zi.call(this,J)||this;Va.gub=function(Ub){Ub=Va.idd(Ub);
return Va.Fad(Ub)};Va.e$i=function(Ub,e){var C=Va.zyb=e[Ac.D$h];1===Ub?(Ub=e[Ac.Buj],C=Va.T0e(Ub,C),td.ULS.shipAssertTag(537153996,0,C!==Ac.Laa,"ResizeHeadersDialogHandler - invalid size input, size = {0}",Ub),Ub=C!==Va.xjd,td.ULS.sendTraceTag(537153995,0,50,"ResizeHeadersDialog OK button pressed, isRow = {0}, isDefaultUnits = {1}, inputPx = {2}, inputChanged = {3}.",Va.isRow,Va.zyb,C,Ub),Ub&&Va.I_g(C)):td.ULS.sendTraceTag(537153994,0,50,"ResizeHeadersDialog Cancel button pressed, isRow = {0}.",Va.isRow)};
Va.isRow=2040891415===oa.command;Va.gridView=Oa.g(Va.$);Va.Lrc=new Je(Va.$.workbookContext.DxDigitNormal);Va.xjd=Va.fPg();J=Va.vZg(Va.xjd);oa=Va.xZg(Va.xjd);Va.Xn=nf.a.instance.ea(Va.isRow?467:468);J=Va.MU(J,oa);Va.initializeAndShow(Va.Xn,Va.e$i,J);td.ULS.sendTraceTag(537153997,0,50,"ResizeHeaders React Dialog opened, isRow = {0}.",Va.isRow);return Va}function ad(J){this.resizeParameters=null;this.resizeParameters=J}function Jd(J,oa){this.isRow=!1;this.autoFitRange=null;this.isRow=J;this.autoFitRange=
oa}function Xd(){var J=Ek.call(this)||this;J.dc();return J}function od(J,oa){var Va=Dk.call(this,oa.domElement)||this;Va.DPf=!1;Va.Zaa=!1;Va.tKb=null;Va.fzb=null;Va.Dr=null;Va.offset=0;Va.$l=0;Va.xHb=0;Va.s0=null;Va.y6=null;Va.wM=null;Va.u_h="headerResizeTooltip";Va.isd=null;Va.EF=null;Va.yab=!1;Va.nVa=!1;Va.OVc=!1;Va.iN=function(Ub){Ub=Ij.a(Va.grid.$).Fe(Ub);if(3===Ub.zb&&!Va.Eef(Ub.Ea)||!Va.GEf(Ub,!1))return!1;td.ULS.sendTraceTag(537154058,2,50,"HeaderResizeBehavior.OnMouseDown: About to generate tooltip");
var e=Va.BPd();Va.pTe(Ub,e,!0);Va.yab||(bj.a.instance.pa(If.a.kh,Va.domElement.ownerDocument.body,Va.Mxa),fj.a.instance.pa(If.a.Ig,Va.domElement.ownerDocument.body,Va.Mxa),Va.yab=!0);Va.Oaf()&&Va.Zaa&&Va.O6e(Ub);return!1};Va.jlc=function(Ub){Ub=Ij.a(Va.grid.$).Fe(Ub);Va.Oaf()&&Va.OVc&&Va.O6e(Ub);if(Ub.Ea.button||!Va.Zaa)return!1;fk.g(Ub.Ea);Va.zIe();Ub=Sf.a.z4a;Va.Dr&&(Ub=Va.nVa?Va.gcd():Va.Dr.Fua());var e=Ub!==Va.$l;if(Va.tKb&&e&&Ub!==Sf.a.z4a){Ub=Va.grid;e=Va.a_e(Ub);var C={};C.SheetMultiRange=
rh.r(e,Ub.$);od.AMd(C,Va.isRow,Va.$l);Va.Dgh(C);Ub.Ozj=!0}else Va.Sh(null,null),Va.nqc();return Va.nVa=!1};Va.Nba=function(Ub){Ub=Ni.a.create(Ub.eventName,Ub.Sb,Ub.Ea,Ub.zb);Ub=Ij.a(Va.grid.$).Fe(Ub);if(!Va.GEf(Ub,!0))return!1;Ub=Va.grid;var e=Va.a_e(Ub);e=rh.r(e,Ub.$);Ub.Nb.kl([Va.isRow?13:14]);Ub.Nb.mcb();Va.nqc();var C={};Ub.$.Ce(Va.isRow?146338636:1391094586,Yc.a.Wb,30,(C.autoFitRanges=e,C));return!1};Va.Mxa=function(Ub){Ub=Ij.a(Va.grid.$).Fe(Ub);if(!Va.Zaa)return!1;fk.g(Ub.Ea);var e=Va.isRow;
if(!Va.s0){Va.s0=document.createElement("div");Va.s0.style.cssText="position: relative; width: inherit; height: inherit;"+(e?"top: 0px; ":Va.rtl?"right: 0px:":"left: 0px:");for(var C=Va.Dr.EJ();C.nextSibling;)Va.s0.appendChild(C.nextSibling);C.parentNode.appendChild(Va.s0)}C=e?Ub.clientPoint.y-Va.fzb.y:(Va.rtl?-1:1)*(Ub.clientPoint.x-Va.fzb.x);var M=e?Ub.clientPoint.y-Va.tKb.y:(Va.rtl?-1:1)*(Ub.clientPoint.x-Va.tKb.x),qa=Va.Dr.Fua();if(qa===Sf.a.z4a)return!1;C&&(0<Va.$l||0<qa+M)&&qa+M<=Va.Flf&&(Va.$l=
Va.BPd(M),Va.pTe(Ub,Va.$l,!1),Fe.DOMElementExtensions.KSa(Va.Dr.EJ(),!e,Math.max(Va.xHb+M,0)),Va.s0.style[e?"top":Va.rtl?"right":"left"]=Math.max(M,-Va.xHb)+"px",Fe.DOMElementExtensions.KSa(Va.Dr.gf.domElement,!e,(e?Va.Dr.gf.kP:Va.Dr.gf.lP)+Math.max(M,-Va.xHb)),Va.fzb=new Sys.UI.Point(Ub.clientPoint.x,Ub.clientPoint.y),Fe.DOMElementExtensions.setVisible(Va.EF,!1));return!0};Va.bR=function(Ub){Ub=Ij.a(Va.grid.$).Fe(Ub);var e;if(!Va.idf||-1!==Va.grid.ha.selectionType)return Ib.a(Va.grid.$).sq()&&(e=
Va.Ucd(Ub))&&(e.jva.style.cursor=""),!1;if(Va.Zaa)return Va.l5h(),!1;e=Va.Ucd(Ub);if(!e)return!1;e.jva.style.cursor=!Va.grid.isEditing&&Va.spd(e)?Va.isRow?"row-resize":"col-resize":"";fk.g(Ub.Ea);return!0};Va.dr=function(){Va.nqc()};Va.Sh=function(){if((3===Yc.a.Wb||Bf.a.Pr)&&Va.grid.ha.va.Dh){var Ub=Va.grid.ha.va.Qd;if(!(!Ub.isRow&&!Ub.Lh||!Va.domElement||Ub.isRow&&Va.isRow&&!Array.contains(Va.gf.No,Ub.top)||Ub.Lh&&!Va.isRow&&!Array.contains(Va.gf.No,Ub.left))){var e=Va.grid.Lg(Ub,Va.gf.sj.paneType);
e&&(Va.EF||Va.a6g(),Ub.isRow&&Va.isRow?(Fe.DOMElementExtensions.setVisible(Va.EF,!0),Va.EF.style.top=e.bottomRight.y-Va.EF.offsetHeight/2+"px"):Ub.isRow||Va.isRow||(Fe.DOMElementExtensions.setVisible(Va.EF,!0),Zk.c(Va.EF.style,Va.grid.rtl,e.bottomRight.x-Va.EF.offsetWidth/2+"px")))}}};Va.$E=function(Ub,e){e.ZO&&Va.zob()};Va.gf=oa;Va.isRow=oa.isRow;Va.rtl=oa.sj.rtl;Va.grid=J;Va.Flf=Va.isRow?Sf.a.Htd:Sf.a.ejc;Va.q_h=nf.a.instance.ea(426);Va.z_h=nf.a.instance.ea(425);Va.t_h=nf.a.instance.ea(427);Gg.a(Va.grid.$,
function(Ub){Va.isd=Ub.IP(yc.a.m$i,!1)});Vh.a.instance.pa(If.a.Ij,Va.domElement,Va.Nba);bj.a.instance.pa(If.a.Wd,Va.domElement.ownerDocument.body,Va.jlc);fj.a.instance.pa(If.a.De,Va.domElement.ownerDocument.body,Va.jlc);Bf.a.Pr||(bj.a.instance.pa(If.a.pointerDown,Va.domElement,Va.iN),bj.a.instance.pa(If.a.kh,Va.domElement,Va.bR));Va.grid.ha.k2(Va.Sh);Va.grid.ha.m9(Va.dr);Va.grid.Nq(Va.Sh);Ib.a(Va.grid.$).pg.qga(Va.$E);return Va}function Je(J){this.O5c=J}function bc(J,oa,Va,Ub,e,C,M){this.jva=J;this.RAb=
oa;this.BNa=Va;this.lhd=Ub;this.Aab=e;this.Def=C;this.yZh=M}function Qd(){}function Vd(J){var oa=mj.call(this)||this;oa.$=J;oa.dc();return oa}function de(J){var oa=this;this.Lna=this.uSe=this.BEb=this.e1a=this.zoc=this.mca=this.NOa=null;this.kod=this.kMb=this.fJd=!1;this.vJb=!0;this.Aec=!1;this.vPd=!0;this.jMb=this.O_a=this.cze=0;this.ftc={};this.pnc={};this.onc={};this.TEf=0;this.W5a=this.X6d=!1;this.u3i=function(){Fe.DOMElementExtensions.toggleCssClass(oa.$.Oq,"ewr-presentMode-transition",!1);$removeHandler(oa.e1a,
"transitionend",oa.Lna)};this.aj=function(){parseInt(oa.$.Ey.style.right)!==oa.cze&&window.requestAnimationFrame(function(){oa.uzc(0);oa.$.Kya(Pb.a.kZ("PresentModeManager.OnContentAreaResized"))})};this.$xa=function(){var Va=Object(Ug.a)(uf.a,oa.$.oa);if(Va&&oa.$y){oa.gridView.lmd=!1;Va=Va.headersVisible;var Ub=Oa.g(oa.$).rtl;Fe.DOMElementExtensions.toggleCssClass(oa.$.Oq,"ewr-presentMode-on-headers-off",!Va);Fe.DOMElementExtensions.toggleCssClass(oa.$.Oq,"ewr-presentMode-on-rtl",Ub);(12!==oa.O_a&&
!Va||32!==oa.O_a&&Va&&!Ub||0!==oa.O_a&&Va&&Ub)&&window.requestAnimationFrame(function(){oa.uzc(2)})}};this.od=function(){oa.m9e();oa.lh("OnWorkbookOpened");td.ULS.sendTraceTag(537154323,0,50,"PresentModeManager.OnWorkbookOpened: Silent reload happened during present mode")};this.dr=function(){oa.kod=!0;oa.Vda("OnSelectionStarted")};this.Sh=function(){oa.kod=!1;oa.Vda("OnSelectionEnded");oa.KRf()};this.Mj=function(){oa.Vda("OnEditStarted")};this.Rh=function(){oa.Vda("OnEditEnded")};this.iw=function(){if(!oa.Aec){var Va=
Eg.EwaSettings.isChangeGateEnabled("OfficeVSO:5411756_FlickerFixForPresentModeOverlay");oa.Vda("OnVisibleAreaChanged",!0,Va)}};this.Hxa=function(){oa.Aec=!0};this.Wo=function(){oa.Vda("OnCurrentSelectionModeChanged");oa.KRf();oa.lh("OnCurrentSelectionModeChanged")};this.Hm=function(){oa.Vda("OnBlockCacheItemEvicted")};this.Pe=function(){oa.Vda("OnBlockCacheItemChanged")};this.Lba=function(){oa.Aec||oa.Vda("OnActiveItemPanesChanged")};this.Yh=function(){oa.Aec=!1;oa.mca.lh("ActiveSheetChanged");oa.$xa()};
this.YCb=function(Va,Ub){if(Va=Object(Ug.a)(uf.a,Ub.item))Va.Hob(16,!0),Va.umb(oa.$xa)};this.fDi=function(){pe.$ai||(oa.zoc&&oa.zoc.Ks&&oa.zoc.hide(),Oa.g(oa.$).isEditing&&Oa.g(oa.$).Dq(!0),oa.Svc(!1),td.ULS.sendTraceTag(537154321,0,50,"PresentModeManager.OnFullScreenChangeEventHandler: Esc pressed to exit present mode"))};this.gDi=function(){td.ULS.sendTraceTag(537154320,0,10,"PresentModeManager.OnFullScreenErrorEventHandler: Error handling full screen mode")};this.$=J;this.gridView=Oa.g(this.$);
this.adj=J.ya.PresentModeRenderUpdateTimeout;this.initialize(J)}function pe(){}function Ad(J,oa){var Va=Ai.call(this,J)||this;Va.JTi=function(){Va.mca.qPd(!0)};Va.mca=oa;Va.domElement.classList.add("ewr-presentMode-on");J={};J=(J[Ad.Ly]=Va.xc,J);Va.kc=0;Va.initializeAndShow("",Va.JTi,J);return Va}function Pd(J){this.gZa=this.hCd=null;this.$=J;this.gridView=Oa.g(this.$)}function Ce(){this.overlayCavityInfos=this.overlayContainerInfo=this.containerId=null}function Jf(){this.height=this.width=0}function oc(){this.angle=
this.translateY=this.translateX=this.height=this.width=this.top=this.left=0}function ed(J){var oa=this;this.Gpe=this.LOa=this.fCd=this.gCd=this.lca=this.ewaAccessibilityManager=null;this.isInitialized=!1;this.eoc={};this.doc={};this.HOa=null;this.MDf=0;this.onKeyDown=function(Va){Va=Va.Ea;if(9===Va.keyCode){var Ub=oa.lca.querySelectorAll(Fe.DOMElementExtensions.Ep),e=Fe.DOMElementExtensions.zl(Ub);Ub=Fe.DOMElementExtensions.Ry(Ub);Fe.DOMElementExtensions.jda(Va,e,Ub);return!0}return!1};this.Fl=function(){var Va=
[];oa.$.da.Za(337,function(Ub){oa.LOa.getPresentModeFloatieControlsMap().then(function(e){for(var C={},M=0;M<e.length;M++)C[e[M].controlId]=e[M].modelType;Va.push.apply(Va,Ub.rca.g3a(C));0<Va.length&&appChrome.api.dispatch(Va);oa.qcj()})})};this.$=J}function wc(){}function gb(J){return Hj.call(this,J)||this}function id(J,oa){this.$=J;this.presentModeManager=oa}function ib(J,oa,Va,Ub){var e=Mh.call(this)||this;e.activityName=J;e.$L=oa;e.vJ=Va;e.$=Ub;e.dc();return e}function nc(J,oa,Va){var Ub=li.call(this,
J,oa)||this;Ub.vi=null;Ub.ski=function(e){var C=Ub.es.nd,M=Object(Ug.a)(8,C.Ge);var qa=e.Qqb;Ub.unsubscribe(function(Gc){e.remove_disposing(Gc)});for(var Na=0,Hb=C.errors.length;Na<Hb;Na++)-573864504===C.errors[Na].MessageId&&C.Oka(C.errors[Na]);switch(qa){case 1:M.fa.Myc=!0;td.ULS.sendTraceTag(537155485,0,50,"LegacySharedWorkbookActivity.LegacySharedDialogDisposing: User has selected to turn off the Legacy Shared Workbook setting ");Ub.oh(M.isEditMode?he.a.FLb:Ub.M8g);Ub.Uo();break;case 2:Ub.oh(he.a.openInExcelClient);
Ub.Uo();break;case 0:C.activityState[fg.a.rs]=!1,Ub.oh(Ub.vJ),Ub.Uo()}};Ub.M8g=oa;Ub.vJ=Va;return Ub}function Nb(J,oa){J=ai.call(this,J,oa)||this;J.Yoa=0;J.jr();return J}function mb(J,oa,Va,Ub){var e=Ck.call(this)||this;e.activityName=J;e.$L=oa;e.vJ=Va;e.$=Ub;e.dc();return e}function Lc(J,oa,Va){return je.call(this,J,oa,Va)||this}function zd(J,oa){J=rd.call(this,J)||this;J.password=null;J.aff=oa;J.Kh();return J}function jd(J,oa,Va,Ub){var e=Vj.call(this)||this;e.activityName=J;e.$L=oa;e.vJ=Va;e.$=
Ub;e.dc();return e}function ge(J,oa,Va){return je.call(this,J,oa,Va)||this}function Yd(J){var oa=rd.call(this,J)||this;oa.YId=5;oa.V6d=!1;oa.passwordToModify=null;oa.NCf=function(){oa.$.isEditMode&&oa.Ffc&&(Ed.b().A6c("PasswordToModifyPasswordVerifiedTillInteractive"),oa.$.ml(oa.NCf))};oa.Kh();oa.$.Rk(oa.NCf);return oa}function rd(J){var oa=Te.call(this,J)||this;oa.Yoa=0;oa.MYi=function(Va,Ub){oa.o$a(Va,Ub)};return oa}function je(J,oa,Va){var Ub=Mi.call(this,J,oa)||this;Ub.vi=null;Ub.GAd=null;Ub.SPi=
function(e,C){Ub.VDb(e,C)};Ub.vJ=Va;return Ub}function re(J){var oa=zj.call(this)||this;oa.$=J;J.da.Ha(56,new Uf(J));oa.dc();return oa}function ae(J,oa){return Pj.call(this,J,oa)||this}function Uf(J){var oa=Yi.call(this)||this;oa.$=J;oa.dc();Uf.yXg();return oa}function Lf(J,oa,Va){var Ub=Of.call(this,!0)||this;Ub.Ma=new Gh.a;Ub.RRe=!1;Ub.y5c=!1;Ub.fxe=null;Ub.xm=null;Ub.C1b=null;Ub.Zc=function(){qj.a.ug(Yg.a(Ub.$).nd.activityState,Pe.a.Fwd)||Ub.R$.reset()};Ub.hCi=function(e){Ub.bOf(e)};Ub.gCi=function(){Ub.$rj()};
Ub.$=J;Ub.fa=J.fa;Ub.FJ=oa;Ub.businessBar=Va;Ub.fa.Sj(Ub.Zc);Ub.R$=Nk.a.Ppe(Ub.$);Ub.zXg();J.da.Ha(55,Ub);return Ub}function Of(J){this.rfa=this.G2d=this.aUa=null;this.ohb=!1;this.XKc=this.L$d=null;this.pPb=this.nD=this.IUb="";this.application=this.qB=0;this.uzj=this.LRd=!1;this.mMj=J&&kd.AFrameworkApplication.ga.ra("OICLaunchDialogIsEnabled");kd.AFrameworkApplication.Eb.W3(Pg.a.TPa)||kd.AFrameworkApplication.Eb.$b(Pg.a.TPa,th.a.frame,Object(wf.a)(this,this.iaj,"retryOpenInClientAction"));kd.AFrameworkApplication.Eb.gkc&&
(J=kd.AFrameworkApplication.Eb.oZ(3588168074))&&(this.IUb=J.sessionOrigin?J.sessionOrigin:"",this.nD=J.correlationId?J.correlationId:"",this.pPb=J.TriggerTime?J.TriggerTime:"");this.N0f=!!kd.AFrameworkApplication.ga&&kd.AFrameworkApplication.ga.ra("SilentExternalHandler")}function Yf(){}function vg(){}function Af(J){var oa=ui.call(this)||this;oa.Yp=J;oa.Me="ProtocolLaunchingDialog";kd.AFrameworkApplication.oj.N3a&&kd.AFrameworkApplication.oj.Prc();kd.AFrameworkApplication.sa.Pa.Vfd&&oa.fje(CommonUIStrings.l_OICStandardDialogSectionGiveFeedback,
Object(wf.a)(oa,oa.vlc,"onGiveFeedbackClick"));Af.$3e?(oa.kc=12,oa.Cc(1,CommonUIStrings.l_CloseFile),oa.Cc(2,CommonUIStrings.l_OICDialogContinueHere),oa.Cc(3,CommonUIStrings.l_OICDialogLaunchAgain)):(oa.kc=4,oa.Cc(1,CommonUIStrings.l_OICDialogContinueHere),oa.Cc(2,CommonUIStrings.l_OICDialogLaunchAgain));oa.MAb(CommonUIStrings.l_OICDialog2ndTitle,5===oa.Yp.zBf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICStandardDialogSectionTitle,null,null,Object(wf.a)(oa,oa.lDd,"protocolLaunchingDialogResultHandler"),
null);return oa}function rf(J){var oa=yj.call(this)||this;oa.wea=null;oa.UTa=null;oa.$oa=!1;oa.Goa=null;oa.Yp=J;oa.xf=Cg.xf;oa.PVc=!0;oa.kc=5;oa.Me="ProtocolLaunchingDialog";oa.dFc="OICRetryDialog";kd.AFrameworkApplication.oj.N3a&&kd.AFrameworkApplication.oj.Prc();kd.AFrameworkApplication.oj.fh(new Ye.a(2,1,5E3,function(){oa.switchToBackupMode()},101));oa.showDialog("",Object(wf.a)(oa,oa.lDd,"protocolLaunchingDialogResultHandler"));oa.aWf();oa.AW("Issues");oa.DRe();td.ULS.sendTraceTag(19239262,211,
50,"OIC dialog launched");document.getElementById("WACDialogTitlePanel").className+=" OICDialog";return oa}function Cg(){}function sc(J){var oa=bh.call(this)||this;oa.$Ba=null;oa.VTa=null;oa.$oa=!1;oa.Yp=J;oa.xf=Rc.xf;oa.PVc=!0;oa.kc=5;oa.Me="OICLaunchDialog";oa.showDialog("",Object(wf.a)(oa,oa.hyi,"oicLaunchDialogResultHandler"));oa.aWf();oa.AW("ProtocolLaunchingDialogTitle");4!==kd.AFrameworkApplication.sa.Pa.editMode&&(document.getElementById("ProtocolLaunchingDialogTitle").innerText=CommonUIStrings.l_OICLaunchDialogTitleForView);
oa.uz(oa.$Ba);td.ULS.sendTraceTag(22140865,211,50,"OIC launch dialog opened");document.getElementById("WACDialogTitlePanel").className+=" OICDialog";return oa}function Rc(){}function Qc(J,oa,Va,Ub,e){var C=document.createElement("img");C.alt=J;C.className=Ti.getImageClassWithCluster(Va,Ub);C.src=oa;C.setAttribute(Qh.a.Sd,Qh.a.vs);J=document.createElement("span");J.className="ProtocolLaunchingDialogImg32Container";J.appendChild(C);C=document.createElement("span");C.className="ProtocolLaunchingDialogIconContainer";
C.appendChild(J);e.appendChild(C)}function ee(J,oa,Va,Ub,e,C,M){var qa=document.createElement("a");qa.className="ProtocolLaunchingDialogButtonAnchor";qa.className+=" OICDialog";qa.id=J;qa.setAttribute(Qh.a.Sd,Qh.a.zr);qa.style.padding="0";qa.style.margin="0";Ub&&Qc(e,oa,Va,Ub,qa);J=document.createElement("span");J.className="ProtocolLaunchingDialogButtonLabel";J.innerText=e;qa.appendChild(J);qa.tabIndex=0;C&&Vh.a.instance.pa(If.a.click,qa,C);M&&Dh.KeyInputManager.instance.pa(If.a.Vd,qa,M);return qa}
function ue(J){return J.Ea.keyCode===eh.a.$h||J.Ea.keyCode===eh.a.iBa?(J.Sb.click(),!0):!1}function Ee(J){for(var oa=0;oa<J.children.length;oa++){var Va=J.children[oa];Va.style.position="relative";Va.style.top=(Va.parentNode.offsetHeight-Va.offsetHeight)/2+"px"}}function De(){}function ne(J,oa,Va){var Ub=this;this.La=J;this.Dmg=oa;this.aDc=null;(this.RVb=kd.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1))&&ii.a.instance.mc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(e){Ub.aDc=
e});this.s1=Va}function gc(J,oa,Va){this.La=J;this.Amg=oa;this.s1=Va}function fd(J){var oa=Cj.call(this)||this;oa.$=J;oa.dc();return oa}function vd(J){var oa=kg.call(this)||this;oa.$=J;oa.dc();return oa}function se(J,oa,Va){Va=void 0===Va?!1:Va;var Ub=xj.call(this,J,oa)||this;Ub.nAb=null;Ub.Wyd=function(e){Ub.unsubscribe(function(C){e.remove_disposing(C)});Ub.oh(he.a.Ck);Ub.Uo()};Ub.Jic=Va;return Ub}function Jc(J){return Dg.call(this,J)||this}function Bc(J,oa){this.Di=oa;this.$=J}function Ae(J){var oa=
Ve.call(this)||this;oa.$=J;oa.dc();return oa}function cb(J){return ie.call(this,J)||this}function mc(J){this.Zn="Excel";this.$=J;this.yU=kc.a.current}function Oc(J,oa,Va,Ub,e,C,M){M=J.Oa(9,void 0===M?null:M);M.sheetName=oa;M.confirmationChoice=!0;return Le.i(J,"DeleteSheet",M,Va,Ub,e,C,0)}function Sc(){}function $c(J){var oa=Id.call(this)||this;oa.mYd=null;oa.oYd=0;oa.ej=null;oa._state=0;oa.moveNext=function(){try{for(oa._state=1;1===oa._state;)oa.hu=oa.hu()}catch(Va){oa.dispose(),oa.mda(Va),oa._state=
3}};oa.wf=J;oa.hu=oa.fL;oa.moveNext();return oa}function le(){}function we(J){return Rb.call(this,J)||this}function jc(J,oa){this.$=J;this.gridView=oa}function Zc(J,oa,Va){var Ub=vb.call(this,J)||this;Ub.Flb=0;Ub.uxb=!1;Ub.r0a=null;Ub.jFe=!1;Ub.Jpb=!0;Ub.JRc=null;Ub.Xn=null;Ub.uvd=0;Ub.vvd=null;Ub.tvd=null;Ub.removeHyperLink=!1;Ub.cellValue=null;Ub.location=null;Ub.Y0h=function(e,C){1===e||2===e?(td.ULS.sendTraceTag(555755670,0,50,"HyperLink {0} pressed",1===e?"OK":"Remove"),Ub.vvd=C[Zc.Jki],Ub.uvd=
C[Zc.tej],Ub.tvd=C[Zc.ubh],2===e&&(Ub.removeHyperLink=!0),Ub.commit()):td.ULS.sendTraceTag(537157644,0,50,"HyperLink Cancel pressed")};Ub.rNj=function(e,C){return C&&e.length?1===C?Ub.lWe(rh.y(e,Ub.fa.xa)||Ub.tui(e),744):Ub.lWe(Jg.a.Hld(e),746):null};Ub.selectedRange=oa;Ub.yL=Va;Ub.fa=J.fa;Ub.sheetName=oa.SheetName;Ub.QKa();Ub.lm();Ub.kc=Ub.uxb?9:1;Ub.Cc(1,nf.a.instance.ea(4));Ub.uxb&&Ub.Cc(2,nf.a.instance.ea(747));J={};J=(J[Zc.Fah]=Ub.jFe,J[Zc.vbh]=Ub.r0a,J[Zc.gvg]=Ub.Flb,J[Zc.hvg]=Ub.JRc,J[Zc.RZg]=
Ub.Jpb,J);oa={};J=(oa[Zc.Ly]=Ub.xc,oa[Zc.sNj]=Ub.rNj,oa[Zc.lKg]=J,oa);Ub.initializeAndShow(Ub.Xn,Ub.Y0h,J);return Ub}function ud(J){return Ei.call(this,J)||this}function Fd(J,oa,Va,Ub){var e=ji.call(this)||this;e.$=J;e.businessBar=Ub;e.openInExcelOperation=oa;e.FJ=Va;return e}function me(){}function $e(J){var oa=Qi.call(this,J)||this;oa.uH=null;oa.SBb=function(){td.ULS.sendTraceTag(574993313,306,50,"MouseClick: Open with redirection timer");if(oa.$.ya.IsMeetingLiveSession)return oa.$eg(),!0;Bf.a.Ip?
(td.ULS.sendTraceTag(574993312,306,50,"Android intent scheme is being used to open android app from browser"),oa.NB&&oa.NB.length||td.ULS.sendTraceTag(537162595,306,15,"ClientUrl is null"),oa.openUrl("intent:"+oa.NB+"#Intent;scheme=ms-excel;action=android.intent.action.VIEW;S.browser_fallback_url="+oa.Eq+";end","_top")):9<=Bf.a.vid?(td.ULS.sendTraceTag(537162594,306,50,"OpenInAppDialog.onClickHandler: Open in app directly if installed for iOS version 9 or above"),oa.openUrl(oa.DNa,"_top"),window.setTimeout(function(){oa.openUrl(oa.Eq,
"_blank")},9E3)):(td.ULS.sendTraceTag(537162593,306,50,"OpenInAppDialog.onClickHandler: Open in app if installed, else redirection to appstore for iOS version below 9."),oa.openUrl(oa.DNa,"_top"),window.setTimeout(function(){oa.openUrl(oa.Eq,"_blank")},500));return!0};oa.tla=function(Va){return Va.Ea.keyCode===eh.a.$h||Va.Ea.keyCode===eh.a.iBa?(td.ULS.sendTraceTag(537162592,306,50,"KeyPress: Open with redirection timer"),Va.Sb.click(),!0):!1};if(1!==kd.AFrameworkApplication.sa.Pa.Lj)return oa;oa.NB=
oa.$.workbookContext.ClientUrl;oa.DNa="ms-excel:ofe|u|"+oa.NB;oa.Eq=kd.AFrameworkApplication.ga.Ua("AppUrl");Bf.a.dka?oa.Eq="itms-apps://"+kd.AFrameworkApplication.ga.Ua("WildFireUrlExceliOS")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac":Bf.a.Ip&&(Eg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseAppAndroidMarketURL",!1)&&oa.$.ya.IsMeetingLiveSession?(td.ULS.sendTraceTag(529397969,306,100,"Using app android market url"),oa.Eq=kd.AFrameworkApplication.ga.Ua("WildFireMarketUrlExcelAndroid")):
Bf.a.jfc?oa.Eq=kd.AFrameworkApplication.ga.Ua("WildFireUrlChinaStoreAndroid"):4<Bf.a.gne.vAb&&(oa.Eq=kd.AFrameworkApplication.ga.Ua("WildFireUrlExcelAndroid")+"&referrer=utm_source%3Dwac%26utm_medium%3Dweb%26utm_campaign%3Dminiwac"));return oa}function Df(){}function gg(J){this.calculateType=0;this.calculateType=J}function og(J){this.calculationMode=0;this.calculationMode=J}function dg(J,oa){var Va=this;this.dialog=null;this.Tsf=function(){Va.dialog&&Va.dialog.hide()};this.iyi=J;this.Ab=oa;this.Ab.gmb(this.Tsf)}
function af(J,oa){return rg.call(this,J,void 0,void 0,oa)||this}function rg(J,oa,Va,Ub,e,C){oa=void 0===oa?!0:oa;Va=void 0===Va?!1:Va;Ub=void 0===Ub?null:Ub;e=void 0===e?null:e;C=void 0===C?!1:C;var M=$g.call(this)||this;M.DX=null;M.Rl=null;M.PUa=null;M.QUa=null;var qa=M.eTd?M.eTd:CommonUIStrings.l_DefaultDialogTitle;rg.Tvb=C;M.mQb=Ub||new cg(J,!0);M.mQb.Mpe(M);var Na=[],Hb=[];rg.gy&&(M.WTc&&M.WTc.forEach(function(Wd){Array.add(Na,Wd)}),M.hme&&M.hme.forEach(function(Wd){Array.add(Hb,Wd)}));oa?Va?
(M.kc=4,M.Cc(1,M.buttonText),M.Cc(2,CommonUIStrings.l_DialogClose)):(M.kc=6,M.Cc(0,CommonUIStrings.l_DialogClose)):M.kc=5;C=document.createElement("span");M.Y2c&&(C.className=M.Y2c);Ub=document.createElement("a");Ub.innerText=M.Rhc;Ub.href=J;Ub.target="_blank";Ub.id=M.Qhc;Ub.className=ih.AFrame.Pme;var Gc=!Bf.a.rC&&!!e&&0<e.count;if(Gc){var gd=Kg.a.Ydd(J,e);e=Kg.a.kGd(J,e);Ub.href="#";Ub.target="_self";M.Rl=document.createElement("form");M.Rl.id="printPreviewPostForm1";M.Rl.method="post";M.Rl.target=
"_blank";M.Rl.action=e;e=yl(gd);for(gd=e.next();!gd.done;gd=e.next()){gd=gd.value;var Uc=document.createElement("input");Uc.type="hidden";Uc.name=gd.key;Uc.value=gd.value;M.Rl.appendChild(Uc)}}else M.Rl=null;M.Rl||rg.Tvb?rg.Tvb||(J={},Array.add(Hb,(J.type="AppLinkProps",J.id=M.Qhc,J.text=M.Rhc,J.onExecute=function(){M.lIf()},J))):(e={},gd={},Array.add(Hb,(gd.type="AppLinkProps",gd.id=M.Qhc,gd.text=M.Rhc,gd.handler=(e.href=Gc?"#":J,e.target=Gc?"_self":"_blank",e),gd)));M.iNa&&Array.add(Na,M.iNa);Va?
(J=document.createElement("span"),J.innerText=M.iNa.replace("{0}",""),C.appendChild(J)):M.Bmf?(J=document.createElement("span"),J.id=M.mi("message"),Gc=document.createElement("span"),e=document.createElement("span"),gd=M.iNa.split("{0}"),Gc.innerText=gd[0],e.innerText=gd[1],J.appendChild(Gc),J.appendChild(Ub),J.appendChild(e),C.appendChild(J)):(J=document.createElement("span"),J.innerText=M.iNa,C.appendChild(J),C.appendChild(document.createElement("br")),C.appendChild(document.createElement("br")),
C.appendChild(Ub),rg.Tvb||Array.add(Na,"{0}"));M.Rl&&C.appendChild(M.Rl);rg.gy&&(M.N6a&&(M.Hzb?M.eje(M.N6a,M.Hzb):(Array.add(Na,"{0}"),J={},Array.add(Hb,(J.type="AppLinkProps",J.id="LearnMoreLinkId",J.text=M.N6a,J.onExecute=function(){M.Khc()},J)))),M.Yqa(Na,Hb));M.MAb(qa,null,M.D6e,null,Object(wf.a)(M,M.Ov,"dialogHandler"),rg.gy?null:C);M.AW(M.mi("message"));!rg.gy&&M.Hzb&&M.N6a&&(qa=document.createElement("div"),qa.className="WACDialogLearnMoreLinkContainer",M.DX=document.createElement("a"),M.DX.innerText=
M.N6a,M.DX.href=M.Hzb,M.DX.target="_blank",M.DX.id=M.mi("LearnMoreLinkId"),M.DX.className=ih.AFrame.Pme,qa.appendChild(M.DX),oa?M.Lb.insertBefore(qa,M.Lb.lastChild):M.Lb.appendChild(qa),M.AW(String.format("{0} {1}",M.mi("message"),M.mi("LearnMoreLinkId"))));M.Kgb=Ub;Va?M.uz(M.kB):M.uz(M.Kgb);M.Cif();kd.AFrameworkApplication.sa.OW.pa(If.a.click,M.Kgb,Object(wf.a)(M,M.CGe,"downloadLinkClicked"),null);M.DX&&kd.AFrameworkApplication.sa.OW.pa(If.a.click,M.DX,Object(wf.a)(M,M.Khc,"learnMoreLinkClicked"),
null);M.lQb=!1;return M}function cg(J,oa){this._url=J;this.Log=oa}function Ie(J){return pc.call(this,J)||this}function Ng(J){this.Di=J}function Zf(J){var oa=Ue.call(this)||this;oa.$=J;oa.dc();return oa}function ng(){}function Ff(){this.rb=null}function be(J){this.DKa=this.a$a=null;this._initialized=!1;this.aid=J}function Rf(){this.rb=null}function Re(J,oa,Va,Ub,e,C){oa=Pa.call(this,oa,Va,Ub,e,C)||this;oa.La=J;return oa}function Ze(J,oa,Va,Ub,e,C,M){oa=ze.call(this,oa,Va,Ub,e,C,M)||this;oa.fkg=J;return oa}
function hg(J,oa,Va,Ub){J=yd.call(this,J,oa,Va,Ub)||this;J.Gog=oa;return J}function Bg(J){var oa=h.call(this)||this;oa.kc=1;oa.Cc(1,CommonUIStrings.l_RetryButtonLabel);oa.Cc(0,CommonUIStrings.l_DialogClose);oa.La=J;return oa}function qh(J,oa,Va){this.La=J;this.lX=oa;this.dlb=Va}function Zg(J,oa,Va,Ub){var e=Th.call(this)||this;e.j8=null;e.VQb=null;e.La=J;e.lX=oa;e.dlb=Va;e.Cc(1,CommonUIStrings.l_SaveButtonLabel);e.xf=qf.xf;e.Me="FileNameDialog-SaveACopy";e.yh=Ub;return e}function qf(){}function mh(){this.rb=
null}function Pa(J,oa,Va,Ub,e){this.j8=this.um=this.dCa=null;this.MCa=!1;this.yh=this.Xfa=null;this.FQc=J;this.Kjb=oa;this.fs=Va;this.Ie=Ub;this.uh=e}function qb(J){this.ub=J;this.IEa=J.appSettings.SkyDriveUploadWebServiceBase;this.Oz=J.appSettings.FileName;this.Wea=J.Ua("SkyDriveUploadHandler")||"skydriveuploadhandler.ashx"}function tc(J,oa,Va,Ub,e,C,M){this.HEa=J;this.Oz=oa;this.JUa=Va;this.VQb=Ub;this.kNc=e;this.Wea=C;this.yh=M}function dd(J,oa,Va){this.La=J;this.D1=oa;this.lX=Va}function Kd(J,
oa,Va){var Ub=Ih.call(this)||this;Ub.La=J;Ub.D1=oa;Ub.lX=Va;Ub.gu=!1;Ub.kc=1;Ub.Kma(1);Ub.Cc(1,CommonUIStrings.l_SignIn);Ub.Cc(0,CommonUIStrings.l_SignInToSaveDialogCancelButton);return Ub}function yd(J,oa,Va,Ub){this.gUb=null;this.Pqg=J;this.ub=Va;this.cae=oa;this.D8d=new zb.a;this.uh=Ub}function ze(J,oa,Va,Ub,e,C){this.yh=null;this.Mrg=J;this.D1=oa;this.dlb=Va;this.ub=Ub;this.KOb=e;this.fs=C}function te(){}function lf(){var J=Tg.call(this)||this;J.kc=0;J.Cc(1,CommonUIStrings.l_DialogClose);return J}
function bf(){this.Kfa=this.HSb=this.FSb=this.rb=null}function xf(J,oa,Va,Ub,e){this.um=this.dCa=null;this.JCc=!1;this.lOc=this.j8=null;this.FQc=oa;this.Kjb=Va;this.fs=Ub;this.Ie=e;this.La=J}function Og(J){this.IEa=J.appSettings.SaveAsToHostWebServiceBase;this.Oz=J.appSettings.FileName;this.Wea=J.Ua("SharePointSaveAsHandler")||"sharepointsaveashandler.ashx"}function mf(J,oa,Va,Ub,e,C,M,qa){this.HEa=J;this.Oz=oa;this.JUa=Ub;this.kNc=C;this.j8=Va;this.Trg=e;this.Wea=M;this.yh=qa}function bg(J,oa,Va,
Ub){this.yh=this.d$d=null;this.BEa=J;this.fs=oa;this.hMc=Va;this.Ie=Ub}function Wf(J,oa,Va,Ub,e,C,M){this.ub=J;this.lGc=Va;this.La=oa;this.lkb=Ub;this.ghb=e;this.hMc=C;this.Khg=M}function zf(){return ye.call(this)||this}function tg(J,oa,Va,Ub){var e=this;this.uo=this.ijb=null;this.ghb=J;this.Ie=Va;this.ipg=Ub;this.YCa=new mg.a(function(){return new Oh.a(oa.value,Object(wf.a)(e,e.oub,"getMoreInfoEventReceived"))})}function Hf(J,oa,Va,Ub,e,C,M,qa,Na,Hb){this.La=oa;this.ub=J;this.lX=Ub;this.Yfa=C;this.fs=
e;this.Ie=Va;this.hde=M;this.ong=void 0===qa?null:qa;this.BEa=void 0===Na?null:Na;this.xWa=void 0===Hb?null:Hb}function xc(J,oa,Va,Ub,e,C,M,qa,Na){this.tKc=null;this.Oz="";this.lkb=J;this.fs=oa;this.yh=Na;this.Yfa=Va;this.Ie=e;this.rv=Ub;this.BEa=M;this.xWa=qa;C&&(this.tKc=new mg.a(function(){return new Oh.a(C.value,null)}))}function bd(){this.properties=this.friendlyPath=this.folderName=null}function Bd(){this.extension=this.fileName=null;this.enableMoreLocations=!1;this.saveLocations=this.scenario=
null}function Ld(J,oa,Va,Ub,e,C,M,qa){J=md.call(this,J,oa,Va,Ub,e,C,qa)||this;J.qy=null;J.pOc=null;J.tpa=null;J.dOg=CommonUIStrings.l_SaveToAnotherFolder;J.xf=Od.xf;J.Me="FileNameDialog-SaveToSharePoint";J.lkb=M;J.Nog=qa;return J}function Od(){}function ef(){var J=fh.call(this)||this;J.kc=0;J.Cc(1,CommonUIStrings.l_DialogClose);return J}function ag(){this.rb=null}function lg(J,oa,Va,Ub,e,C,M,qa){this.um=null;this.RVa=this.MCa=!1;this.Xfa=this.yh=this.Oz=null;this.ub=oa;this.HEa=this.ub.appSettings.SaveAsToHostWebServiceBase;
this.$5d=Ub;this.Kjb=e;this.Og=Va;this.fs=C;this.uh=qa;this.Ie=M;this.La=J;this.Wea=oa.Ua("SaveAsToHostUploadHandler")||"hostuploadhandler.ashx"}function $f(J,oa,Va){this.Yfa=Va;this.lGc=oa;this.ub=J}function Aa(J,oa,Va,Ub,e,C){this.La=oa;this.ub=J;this.lX=Ub;this.Yfa=C;this.fs=e;this.Ie=Va}function Ob(J,oa,Va,Ub,e,C){J=md.call(this,J,oa,Va,Ub,e,C)||this;J.xf=Ec.xf;J.Me="FileNameDialog-SaveAsToHost";return J}function Ec(){}function md(J,oa,Va,Ub,e,C,M){M=void 0===M?null:M;var qa=Qf.call(this)||this;
qa.CI=null;qa.La=oa;qa.lX=Ub;qa.Yfa=C;qa.ub=J;qa.fs=e;qa.Ie=Va;qa.ahb=qa.ub.ra("SaveToHostWithExtraCharsInFileName");qa.yh=M;qa.Cc(1,CommonUIStrings.l_SaveButtonLabel);return qa}function Md(J,oa){this.ub=J;this.La=oa;this.ahb=this.ub.ra("SaveToHostWithExtraCharsInFileName")}function Me(J,oa){var Va=kf.call(this)||this;Va.RVa=!1;Va.Oz=null;Va.La=J;Va.ahb=oa;Va.rRa=!1;return Va}function Qe(){this.rb=null}function sf(J){this.Sl=null;this.Og=J;this.MNc=3}function Vf(J,oa,Va,Ub){oa=rb.call(this,J,oa,Va,
Ub)||this;oa.options.advanced.filter=J.Ua("OneDriveApiV72Filter")||"folder,photo";oa.options.advanced.linkType="download";oa.options.multiSelect=kd.AFrameworkApplication.Hne;J.ra("OneDriveApiV72CommandModeEnabled")&&(oa.options.commandMode=J.Ua("OneDriveApiV72CommandMode")||"none");J.ra("OneDriveApiV72QosExtraDataEnabled")&&(oa.options.qosExtradata=new Da(kd.AFrameworkApplication.userSessionId));return oa}function Da(J){this.olsSessionId=this.value=this.key=null;this.olsSessionId=J}function rb(J,
oa,Va,Ub){oa=sb.call(this,J,oa,Va,Ub)||this;oa.zgg=J;oa.options={};oa.options.advanced={};oa.options.action="query";oa.options.clientId=oa.ga.Ua("OneDriveApiV72ClientId");oa.options.advanced.trapFocus=!0;return oa}function $b(J,oa,Va,Ub,e){J=sb.call(this,J,oa,Va,Ub)||this;J.bae=null;J.hRb=null;J.Gjg=e;J.options={};J.options.clientId=J.ga.Ua("OneDriveApiV7ClientId");J.options.cancel=Object(wf.a)(J,J.kyc,"toggleHostDivVisibility");return J}function vc(J,oa,Va,Ub,e,C){oa=sb.call(this,oa,Va,Ub,C)||this;
oa.yh=null;oa.D1=J;oa.Grg=e;return oa}function sb(J,oa,Va,Ub){this.PDa=this.P5=null;this.HOc=this.JOc=!1;this.QVa=null;this.ub=J;this.KOb=oa;this.uDa=Va;this.fs=Ub}function ec(){}function ce(){var J=Dc.call(this)||this;J.kc=0;J.Cc(1,CommonUIStrings.l_DialogClose);return J}function Rd(){}function Ne(J,oa,Va,Ub){this.fhb=J;this.Ypa=oa;this.w1=Va;this.Skg=Ub}function Be(J,oa,Va,Ub,e,C,M){var qa=this;this.uo=null;this.ude=!1;this.mpa=this.V_d=0;this.kog=J;this.OVa=oa;this.LSb=Va;this.fhb=Ub;this.Ypa=
e;this.w1=C;this.YCa=new mg.a(function(){return new Oh.a(M.value,Object(wf.a)(qa,qa.oub,"getMoreInfoEventReceived"))})}function sd(J,oa,Va,Ub,e,C,M,qa){var Na=this;this.NDc=null;this.XQc=!0;this.bPb="";this.htg=0;this.yVa=null;this.dKc=3;this.ub=qa;this.w1=J;this.gj=oa;this.gkg=Va;this.nhg=Ub;this.mhg=e;this.YCa=new mg.a(function(){return new Oh.a(C.value,null)});this.Tkg=new mg.a(function(){return new Oh.a(M.value,Object(wf.a)(Na,Na.aui,"mruEventResultReceived"))});this.ub.ra("WacInTabOpenMRUIsEnabledForUiHost");
this.ub.ra("UiHostSupportsDocRebootFeatures")}function cf(){return ah.call(this)||this}function Dd(J,oa,Va,Ub,e,C){var M=this;this.ZPc=this.uo=this.cPb=null;this.$Ub=this.ePc=!1;this.s9d=0;this.TOc=this.kJc=!1;this.w1=J;this.fhb=oa;this.YCa=new mg.a(function(){return new Oh.a(Va.value,Object(wf.a)(M,M.oub,"getMoreInfoEventReceived"))});this.bog=Ub;this.Ypa=e;this.xrg=C;this.vkb=this.uvc;2===this.mK.Dba&&(this.TOc=!0)}function tf(){this.folderName=this.folderUrl=this.hostName=this.hostUrl=null}function vf(){}
function eg(){}b.r(D);var jg=b(514),Xe=b(0),wg=b(274);eg.prototype.di=function(){};eg.prototype.init=function(){};eg.prototype.dispose=function(){};eg.main=function(){wg.a.instance.mj(new eg)};tl.Object.defineProperties(eg.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.DialogWithLinkToResource"}}});Object(Xe.a)(eg,"CommonAppDialogWithLinkToResourcePackage",null,[4,5]);var mg=b(685),td=b(13),wf=b(80),Oh=b(941),Jg=b(28),oh=b(124);vf.ggh=function(J){return vf.nse("New",
J)};vf.hgh=function(J){return vf.nse("Open",J)};vf.Vre=function(J,oa){return vf.Tga("LoadingMenuSection",vf.Hli,J,vf.Znb("lblLoading",oa))};vf.$nb=function(J,oa,Va,Ub){return vf.Tga("MessageMenuSection",vf.mnf,oa,vf.Znb("lblMessage",J,void 0===Va?null:Va,void 0===Ub?null:Ub))};vf.BMg=function(J){return vf.Vre(J,CommonUIStrings.l_VoicedLoadingText)};vf.CMg=function(J,oa){return vf.$nb(CommonUIStrings.l_NewCreationLocationMessage,J.Bi,oa.iR,oa.sna)};vf.AMg=function(J,oa){return vf.$nb(String.format(CommonUIStrings.l_NewProvisioningStorageMessage,
oa.sna,"\n\n"),J.Bi)};vf.Xre=function(J){return vf.$nb(CommonUIStrings.l_NewGenericErrorMessage,J.Bi)};vf.yMg=function(J,oa,Va){return vf.Tga("menuNewBlank",vf.n_h,Va?J.Bi:null,vf.Unb(J.U4e,J.V4e,J.W4e,null,J.Dja,J.gwb,oa,"blank"))};vf.wNg=function(){return vf.Znb("lblTemplatesLoading",CommonUIStrings.l_VoicedLoadingText)};vf.ise=function(){return vf.Znb("lblTemplatesError",CommonUIStrings.l_NewTemplateErrorMessage)};vf.xNg=function(J,oa){return vf.Tga("menuNewTemplates",J,null,oa)};vf.wMg=function(J,
oa){return vf.Tga("menuNewMoreTemplates",vf.PRe,null,vf.Unb("menuNewMoreTemplatesButton",CommonUIStrings.l_NewMoreTemplates,CommonUIStrings.l_NewMoreTemplates,null,null,null,J,oa))};vf.ALg=function(J,oa,Va){var Ub="";Va&&oa&&(Ub=vf.Tga("BrowseMoreMenuSection",vf.PRe,null,vf.Unb("btnBrowseMore",oa,oa,null,null,null,J||"1959943459",Va)));return Ub};vf.Znb=function(J,oa,Va,Ub){Va=void 0===Va?null:Va;var e=Ub=void 0===Ub?null:Ub;oa&&0<oa.length&&(e=vf.fof.Rnc(oa).trimEnd(),e=0<=e.indexOf("{0}")?String.format(e,
Ub):String.format("{0} {1}",e,Ub));Va=Va&&Ub?String.format('\r\n\t\t\t\t\tInnerLink="{0}"\r\n\t\t\t\t\tInnerLinkText="{1}"\r\n\t\t\t\t\tInnerLinkTitle="{2}"',Jg.a.Mf(Va),Jg.a.Mf(Ub),Jg.a.Mf(e)):"";return String.format('\r\n\t\t\t\t<Label\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\t{2}/>',Jg.a.Mf(J||""),vf.fof.Rnc(Jg.a.Mf(oa||"")),Va)};vf.Unb=function(J,oa,Va,Ub,e,C,M,qa){return String.format('\r\n\t\t\t\t<Button\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tLabelText="{1}"\r\n\t\t\t\t\tDescription="{2}"\r\n\t\t\t\t\tImage{3}Class="{4}"\r\n\t\t\t\t\tImage{3}="{5}"\r\n\t\t\t\t\tCommand="{6}"\r\n\t\t\t\t\tMenuItemId="{7}"/>',
Jg.a.Mf(J||""),Jg.a.Mf(oa||""),Jg.a.Mf(Va||""),Ub||"32by32",Jg.a.Mf(e||""),Jg.a.Mf(C||""),M,Jg.a.Mf(qa||""))};vf.nse=function(J,oa){return String.format('\r\n\t\t\t\t<Menu Id="menuJewel{0}">{1}\r\n\t\t\t\t</Menu>',J,oa)};vf.Tga=function(J,oa,Va,Ub){Va=Va?String.format('Title="{0}"',Jg.a.Mf(Va)):"";return String.format('\r\n\t\t\t\t<MenuSection\r\n\t\t\t\t\tId="{0}"\r\n\t\t\t\t\tDisplayMode="{1}"\r\n\t\t\t\t\t{2}\r\n\t\t\t\t\tShowMenuSectionSeparator="false">\r\n\t\t\t\t\t<Controls>{3}\r\n\t\t\t\t\t</Controls>\r\n\t\t\t\t</MenuSection>',
Jg.a.Mf(J||""),Jg.a.Mf(oa||""),Va,Ub)};vf.mnf="MenuMru";vf.Hli="MenuLoading";vf.n_h="MenuHeader";vf.PRe="MenuFooter";vf.fof=oh.a.gx("\n","&#10;");Object(Xe.a)(vf,"NewAndOpenXmlUtilities",null,[]);var kd=b(5),sg=b(93),lh=b(168);Object(Xe.a)(tf,"HostInformation",null,[]);var Ye=b(109),Rg=b(47),jh=b(371),Fg=b(170),Ki=b(689),ti=b(597),th=b(108),Pg=b(29);Dd.prototype.Mg=function(){var J=this.mK.I7a;J.$b(Pg.a.newDocument,th.a.frame,Object(wf.a)(this,this.newDocument,"newDocument"));J.hf(Pg.a.hoc,th.a.frame,
Object(wf.a)(this,this.hoc,"populateNewMenu"),96)};Dd.prototype.newDocument=function(J,oa,Va,Ub,e){return 1===Va?32:2===Va&&e&&e.MenuItemId&&e.SourceControlId?this.y_a(e.MenuItemId,e.SourceControlId):8};Dd.prototype.y_a=function(J,oa){var Va=this.fkc.t2c;if(null===Va)return 8;var Ub=kd.AFrameworkApplication.ga.ra("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");if(kd.AFrameworkApplication.ska&&Ub){td.ULS.sendTraceTag(51455198,202,50,"CreateNewActor.CreateNewDocument: Sending CreateNewDocument post message.");
var e={};e[jh.a.Wcb]=J;e[jh.a.bP]=this.bP;e[jh.a.lcid]=kd.AFrameworkApplication.lcid.toString();e[jh.a.reason]=Ki.a.createNew;kd.AFrameworkApplication.OU().execute(function(C){C.Qj(Fg.a.y_a,e)})}else Ub=(new Date).getTime(),oa=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&or=wacFileNew&bid={6}&Canary={7}&{8}",Va,Jg.a.pf(this.Zka),Jg.a.pf(J),Jg.a.pf(this.bP),Jg.a.pf(kd.AFrameworkApplication.lcid.toString()),Jg.a.pf(Ub.toString()),Jg.a.pf(oa),Jg.a.pf(kd.AFrameworkApplication.canary),
kd.AFrameworkApplication.hj),(Va=kd.AFrameworkApplication.ga.Ua("ScenarioId"))&&""!==Va&&(oa+="&wdscenarioid="+Jg.a.pf(Va)),oa+="&"+kd.AFrameworkApplication.zac(),kd.AFrameworkApplication.bwa&&(oa+="&"+kd.AFrameworkApplication.R$b()),(Va=this.uo?this.uo.iR:null)&&(oa+="&DestinationUrl="+Jg.a.pf(Va)),Rg.a.sf(oa,"_blank",void 0,"CreateNewDocument");2===this.mK.Dba&&(oa={},td.ULS.sendTraceTag(24700384,202,50,"CreateNewDocument from New Menu {0}",(oa.AppType=ti.a[this.mK.Dba],oa.Template=J,oa)));return 32};
Dd.prototype.Eoi=function(J){var oa=Number.MAX_VALUE,Va=Number.MIN_VALUE,Ub=window.performance;if(Ub&&"undefined"!==typeof Ub.getEntriesByName){for(var e=0;e<J.length;e++){var C=Ub.getEntriesByName(J[e]);C&&0<C.length&&(C=C[0],oa=Math.min(parseInt(String(C.fetchStart)),oa),Va=Math.max(parseInt(String(C.responseEnd)),Va))}Va>oa&&(J={},td.ULS.sendTraceTag(5849601,202,50,"Total time to download template thumbnails {0}",(J.TotalElapsedMs=Va-oa,J.MinFetchStart=oa,J.MaxResponseEnd=Va,J)))}};Dd.prototype.hoc=
function(J,oa,Va,Ub,e){if(1===Va)return this.TOc&&(kd.AFrameworkApplication.bK("Microsoft.Office.Server.Powerpoint.Web.IPptMoreThemesInNewMenuSettings"),this.TOc=!1),32;2!==Va||this.kJc||(this.s9d=(new Date).getTime(),J={},td.ULS.sendTraceTag(5849602,202,50,"File New menu flyout opened by user {0}",(J.ShouldShowTemplates=this.uvc,J.CachedNewMenuXmlExists=!!this.cPb,J.ShouldCallGetMoreInfo=this.mK.supportsGetMoreInfoForPersonalStorage,J)));return this.URi(e)};Dd.prototype.URi=function(J){J&&(this.cPb?
J.PopulationXML=this.cPb:(this.mK.supportsGetMoreInfoForPersonalStorage&&!this.uo&&this.svi.Sy("Opened New menu",!0),J.PopulationXML=this.KBh(this.getTemplateListJson())));return 32};Dd.prototype.Zcf=function(){return!this.mK.supportsGetMoreInfoForPersonalStorage||!!this.uo&&3===this.uo.state&&!!this.uo.sna&&!!this.uo.iR};Dd.prototype.bei=function(){return kd.AFrameworkApplication.sa&&kd.AFrameworkApplication.sa.Pa.IZ?!0:this.Zcf()};Dd.prototype.getTemplateListJson=function(){var J=this;if(!this.uvc||
!this.bei())return null;if(this.vkb&&!this.$Ub){var oa="9",Va=kd.AFrameworkApplication.ga.appSettings;"NumberOfTemplatesInBackstage"in Va&&(oa=Va.NumberOfTemplatesInBackstage);var Ub=this.bP;"TemplateCollectionId"in Va&&(Ub=Va.TemplateCollectionId);oa=String.format(this.mK.h_+"TemplateServiceProxy.ashx?lcid={0}&apps={1}&show={2}",Jg.a.pf(kd.AFrameworkApplication.lcid.toString()),Jg.a.pf(Ub),oa);Boolean.parse(Va.AppendOriginQueryParam||"false")&&(oa+="&org=backstage");oa+="&"+kd.AFrameworkApplication.zac();
kd.AFrameworkApplication.bwa&&(oa+="&"+kd.AFrameworkApplication.R$b());this.mK.eBb.Ul(oa,1,null,null,!1,2,function(e){J.mK.SMa("CreateNewActor.GetTemplateListJson",e.data);J.RAj(e.data.fe)},function(e){J.mK.SMa("CreateNewActor.GetTemplateListJson",e.data);J.QAj()},null,void 0,void 0,void 0,void 0,"5");this.vkb=!1}return this.ZPc};Dd.prototype.RAj=function(J){this.ZPc=J;this.vkb=!1;this.xFb();if(kd.AFrameworkApplication.sa&&kd.AFrameworkApplication.sa.Pa.IZ&&lh.c()){J=kd.AFrameworkApplication.ga.ra("UihostSupportsCreateNewDocumentFeatureIsEnbaledInWAC");
var oa=kd.AFrameworkApplication.ska;appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson(this.ZPc,!0,J&&oa))}};Dd.prototype.QAj=function(){this.$Ub=this.vkb=!0;this.xFb();kd.AFrameworkApplication.sa&&kd.AFrameworkApplication.sa.Pa.IZ&&lh.c()&&appChrome.api.dispatch(appChrome.actions.setFileMenuTemplateJson("",!1,!1));sg.Health.instance.recordQosError("TemplateServiceReturnedFailure",["TemplateServiceFailed"],!1,!0,!0,!1,null)};Dd.prototype.dTh=function(J){for(var oa=0,Va=0;Va<J.length;Va++)if("ST"===
J[Va].ImageType){oa=Va;break}var Ub=J.length?J[oa]:null;J=Ub?Ub.Url||"":"";var e,C=Va=oa=!1;if(Ub&&(e=Ub.AspectRatio))e=parseFloat(e),1>e?oa=!0:1.5<e?Va=!0:1===e&&(C=!0);else switch(e={},td.ULS.sendTraceTag(5849603,202,10,"Thumbnail aspect ratio missing {0}",(e.Url=J,e)),this.mK.Dba){case 3:oa=!0;break;case 2:Va=!0;break;case 5:C=!0}return{returnValue:J,M1h:oa?"95by123":Va?"123by69":C?"100by100":"123by95"}};Dd.prototype.KBh=function(J){var oa=this.zMg(J,this.fkc,this.fkc.UFa||"1056925771");J=oa.returnValue;
if(oa.Wuc){this.cPb=J;oa=(new Date).getTime()-this.s9d;var Va={};td.ULS.sendTraceTag(5849604,202,50,"New menu rendering completed by GenerateXMLFromJSON {0}",(Va.ElapsedMsSinceMenuOpened=oa,Va))}return J};Dd.prototype.oub=function(J,oa){td.ULS.sendTraceTag(590964757,202,50,"GetMoreInfoEventReceived");this.uo||3!==J.state?2===J.state&&(td.ULS.sendTraceTag(590964759,202,50,"GetMoreInfoResult was bad, need to retry"),this.ePc=!0,this.xFb()):(this.uo=J,oa||this.xFb(),kd.AFrameworkApplication.sa&&kd.AFrameworkApplication.sa.Pa.IZ&&
lh.c()&&lh.d("setFileMenuHostInformation")&&(J=Object.assign(new tf,{hostUrl:this.uo.iR,hostName:this.uo.sna,folderUrl:kd.AFrameworkApplication.breadcrumbFolderUrl,folderName:kd.AFrameworkApplication.breadcrumbFolderName}),td.ULS.sendTraceTag(590964758,202,50,"Sending HostInformation to FileMenu"),appChrome.api.dispatch(appChrome.actions.setFileMenuHostInformation(J))))};Dd.prototype.zMg=function(J,oa,Va){var Ub=!1;var e=this.Zcf(),C="";if(this.mK.supportsGetMoreInfoForPersonalStorage)if(this.ePc)C=
vf.Xre(oa),this.ePc=!1,td.ULS.sendTraceTag(5849605,202,10,"Rendering File>New with error message due to GetMoreInfo request failure");else if(this.uo)if(e)C=vf.CMg(oa,this.uo);else if(this.uo.O6h)Ub=!0,this.vkb=!1,C=vf.AMg(oa,this.uo),td.ULS.sendTraceTag(5849607,202,50,"Rendering File>New with personal storage instantiation message");else{Ub=!0;C=vf.Xre(oa);var M={};td.ULS.sendTraceTag(5849608,202,10,"Rendering File>New with error message due to GetMoreInfo invalid response. {0}",(M.PersonalFileStorageUrlIsSet=
!!this.uo.iR,M.StorageServiceDisplayNameIsSet=!!this.uo.sna,M))}else C=vf.BMg(oa.Bi),td.ULS.sendTraceTag(5849606,202,50,"Rendering File>New with loading spinner");e&&(e=C,oa=vf.yMg(oa,Va,!C),J=this.vNg(J,Va),Ub=J.Wuc,C=e+(oa+J.returnValue));return{returnValue:vf.ggh(C),Wuc:Ub}};Dd.prototype.vNg=function(J,oa){var Va=!1;if(!this.uvc)return Va=!0,td.ULS.sendTraceTag(5849609,202,50,"Rendering File>New without template buttons due to BRS"),{returnValue:"",Wuc:Va};var Ub="",e="",C="MenuTemplate";if(this.$Ub)Ub=
vf.ise(),this.$Ub=!1,td.ULS.sendTraceTag(5849610,202,10,"Rendering File>New with template error message");else if(J){try{var M=Sys.Serialization.JavaScriptSerializer.deserialize(J,!0);Ub=this.uNg(M,oa);td.ULS.sendTraceTag(5849612,202,50,"Rendering File>New with template buttons");kd.AFrameworkApplication.gof&&"OneDrive"===this.Zka&&(e=vf.wMg(this.tvi,kd.AFrameworkApplication.gof))}catch(qa){oa={},td.ULS.sendTraceTag(5849613,202,10,"Failed to parse JSON response from template service {0}",(oa.JsonToConvert=
J,oa)),Ub=vf.ise()}Va=!0}else C="MenuLoading",Ub=vf.wNg(),td.ULS.sendTraceTag(5849611,202,50,"Rendering File>New with template loading spinner");return{returnValue:vf.xNg(C,Ub)+e,Wuc:Va}};Dd.prototype.uNg=function(J,oa){for(var Va=this,Ub="",e=[],C=0;C<J.length;C++){var M=J[C],qa="";if(M){var Na=M.Title,Hb=M.AssetId,Gc=M.Thumbnails;Hb&&Na&&Gc&&(M=void 0,qa=this.dTh(Gc),M=qa.M1h,qa=qa.returnValue,Ub+=vf.Unb("jbtnNewTemplate"+C,Na,null,M,null,qa,oa,Hb))}e[C]=qa}J=new Ye.a(4,1,5E3,function(){Va.Eoi(e)},
106);this.mK.dkc.fh(J);return Ub};Dd.prototype.xFb=function(){this.kJc=!0;this.mK.Znf.Aw(this.fkc.Lsb);this.kJc=!1};tl.Object.defineProperties(Dd.prototype,{bP:{configurable:!0,enumerable:!0,get:function(){switch(this.mK.Dba){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}},mK:{configurable:!0,enumerable:!0,get:function(){return this.w1.value}},fkc:{configurable:!0,enumerable:!0,get:function(){return this.fhb.value}},svi:{configurable:!0,
enumerable:!0,get:function(){return this.YCa.value}},tvi:{configurable:!0,enumerable:!0,get:function(){return this.bog.value}},Zka:{configurable:!0,enumerable:!0,get:function(){return this.Ypa.value}},uvc:{configurable:!0,enumerable:!0,get:function(){return this.xrg.value}}});Object(Xe.a)(Dd,"CreateNewActor",null,[]);var hi=b(1314),ah=hi.a;vm(cf,ah);cf.prototype.Wje=function(){this.gT(0,CommonUIStrings.l_OpenMenuEmptyMruMessage);this.gT(1,CommonUIStrings.l_OpenMenuServerErrorMessage);this.gT(2,CommonUIStrings.l_Open);
this.gT(3,CommonUIStrings.l_OpenMenuRecentDocuments);this.gT(4,CommonUIStrings.l_OpenMenuMoreOnHost);this.gT(5,CommonUIStrings.l_VoicedLoadingText)};cf.INi=function(J){return cf.instance.ea(J)};tl.Object.defineProperties(cf,{instance:{configurable:!0,enumerable:!0,get:function(){return cf.Na||(cf.Na=new cf)}}});cf.Na=null;Object(Xe.a)(cf,"MruActorIntlHelper",hi.a,[]);var qi;(function(J){J[J.success=0]="success";J[J.failure=1]="failure";J[J.spinner=2]="spinner";J[J.none=3]="none"})(qi||(qi={}));Object(Xe.b)("DisplayState",
qi);var Ch=b(38);sd.prototype.aui=function(J,oa){this.yVa=J;oa||this.TJf()};sd.prototype.s1i=function(){this.DC.I7a.hf(Pg.a.goc,th.a.frame,Object(wf.a)(this,this.goc,"populateMruMenu"),96)};sd.prototype.goc=function(J,oa,Va,Ub,e){return 1!==Va&&e?this.RRi(e):32};sd.prototype.RRi=function(J){this.Mgh();this.Lgh();J.PopulationXML=vf.hgh(this.bPb+this.NDc);return 32};sd.prototype.Mgh=function(){var J=3,oa=!1;if(this.bPb&&this.htg===this.yVa.sCj)J={},td.ULS.sendTraceTag(5849627,202,50,"Open menu MRU entries to XML conversion not required {0}",
(J.CacheRefresh="Not Dirty",J)),J=this.dKc;else{var Va={};td.ULS.sendTraceTag(5849628,202,50,"Open menu MRU entries to XML conversion started {0}",(Va.CacheRefresh="Starting",Va));Va=this.DC.Sv();this.yVa=this.$ti.Sy("File Open opened",!0);if(this.bPb&&2!==this.dKc&&3!==this.yVa.state)oa=!0;else{J=this.dRh(this.yVa);kd.AFrameworkApplication.sa&&kd.AFrameworkApplication.sa.Pa.IZ&&lh.c()&&J&&appChrome.api.dispatch(appChrome.actions.setFileMenuMRUJson(J,!0));var Ub=this.LBh(this.yVa);J=Ub.kvi;this.bPb=
Ub.returnValue}Va=this.DC.Sv()-Va;Ub={};td.ULS.sendTraceTag(5849629,202,50,"Open menu MRU entries to XML conversion ended {0}",(Ub.CacheRefresh="Complete",Ub.ElapsedMs=Va,Ub))}2!==J&&(Va={},Va=(Va.DisplayState=qi[J],Va),1!==J&&(Va.IsStale=oa),td.ULS.sendTraceTag(5849630,202,50,"MRU section display state {0}",Va));this.dKc=J};sd.prototype.dRh=function(J){try{var oa=Ch.c(J.Iud)}catch(Va){oa=null,td.ULS.sendTraceTag(0,202,10,"MruActor.Serialize: Exception thrown from JsonSerializer.Serialize Exception: {0}",
Va)}return oa};sd.prototype.Lgh=function(){if(this.XQc){td.ULS.sendTraceTag(5849632,202,50,"Open menu Browse More Link creation necessary.");var J=this.$pi();this.XQc=J.TOj;this.NDc=J.returnValue}else td.ULS.sendTraceTag(5849631,202,50,"Open menu Browse More Link creation not required.");J={};td.ULS.sendTraceTag(5849633,202,50,"Browse More link display state {0}",(J.WaitingOnLinkInfo=this.XQc,J.NotDisplayingLink=!this.NDc,J))};sd.prototype.LBh=function(J){if(1!==J.state&&J.state)if(3===J.state&&J.Iud){var oa=
this.xMg(J.Iud);J=0}else J={},td.ULS.sendTraceTag(5849634,202,50,"Open menu XML built {0}",(J.Display="Server Error",J)),oa=vf.$nb(this.kja(1),this.kja(2)),J=1;else J={},td.ULS.sendTraceTag(5849635,202,50,"Open menu XML built {0}",(J.Display="Spinner",J)),J=2,oa=vf.Vre(this.kja(2),this.kja(5));return{returnValue:oa,kvi:J}};sd.prototype.xMg=function(J){var oa=this.HAb.UFa||"2155708348";if(J.length){var Va=vf.Znb("lblRecentDocuments",this.kja(3));for(var Ub=0,e=0;e<J.length;e++){var C=J[e];"FileName"in
C&&"DocumentUrl"in C&&"Path"in C&&(Va+=vf.Unb("MruButton"+e,C.FileName.toString(),C.Path.toString(),null,this.HAb.Dja,this.HAb.gwb,oa,C.DocumentUrl.toString()),C.IsPinned&&Ub++)}Va=vf.Tga("RecentDocumentsMenuSection",vf.mnf,this.kja(2),Va);oa={};td.ULS.sendTraceTag(5849665,202,50,"Open menu XML built {0}",(oa.Display="MRU List",oa.TotalDocuments=J.length,oa.NumPinnedDocuments=Ub,oa))}else Va=vf.$nb(this.kja(0),this.kja(2)),J={},td.ULS.sendTraceTag(5849664,202,50,"Open menu XML built {0}",(J.Display=
"Empty MRU",J));return Va};sd.prototype.$pi=function(){var J=!0;var oa=this.TKg,Va=this.SKg;if(oa&&Va||!this.DC.supportsGetMoreInfoForPersonalStorage)J=!1;else{var Ub=this.aac.Sy("File Open",!1);3===Ub.state&&(oa=Ub.iR,Va=Ub.sna,J=!1)}Va=Va?String.format(this.kja(4),Va):null;return{returnValue:vf.ALg(this.HAb.UFa,Va,oa),TOj:J}};sd.prototype.TJf=function(){this.DC.Znf.Aw(this.HAb.Lsb)};tl.Object.defineProperties(sd.prototype,{DC:{configurable:!0,enumerable:!0,get:function(){return this.w1.value}},
kja:{configurable:!0,enumerable:!0,get:function(){return this.gj.value}},HAb:{configurable:!0,enumerable:!0,get:function(){return this.gkg.value}},TKg:{configurable:!0,enumerable:!0,get:function(){return this.nhg.value}},SKg:{configurable:!0,enumerable:!0,get:function(){return this.mhg.value}},aac:{configurable:!0,enumerable:!0,get:function(){return this.YCa.value}},$ti:{configurable:!0,enumerable:!0,get:function(){return this.Tkg.value}}});Object(Xe.a)(sd,"MruRenderer",null,[]);var gh=b(233),yi=
b(896);Be.prototype.y_a=function(){!this.uo&&this.rvd.supportsGetMoreInfoForPersonalStorage?this.aac.Sy("NewDocumentFromStream",!0):this.createNewDocumentFromStream()};Be.prototype.oub=function(J){if(!this.uo&&3===J.state)this.uo=J;else if(2===J.state){this.ude?td.ULS.sendTraceTag(24904471,202,10,"After second try GetMoreResult still fail."):(this.aac.Sy("NewDocumentFromStream",!0),this.ude=!0);return}this.createNewDocumentFromStream()};Be.prototype.createNewDocumentFromStream=function(){this.V_d=
(new Date).getTime();var J=this.buh.t2c;if(null===J)this.OVa(null);else{var oa=this.LSb.menuItemId,Va=this.LSb.bI,Ub=this.LSb.wyj,e=this.LSb.fuh;this.mpa="streamBase64"===Ub?e.length/1024:0;td.ULS.sendTraceTag(35156358,202,50,"FileType:{0}, FileSize:{1}",this.bP,this.mpa);var C=(new Date).getTime();J=String.format("{0}CreateNewDocument.aspx?dest={1}&tpl={2}&app={3}&lcid={4}&ct={5}&so=4&bid={6}&Canary={7}&{8}&sa={9}",J,Jg.a.pf(this.Zka),Jg.a.pf(oa),Jg.a.pf(this.bP),Jg.a.pf(kd.AFrameworkApplication.lcid.toString()),
Jg.a.pf(C.toString()),Jg.a.pf(Va),Jg.a.pf(kd.AFrameworkApplication.canary),kd.AFrameworkApplication.hj,Jg.a.pf(Ub));J+="&"+kd.AFrameworkApplication.zac();kd.AFrameworkApplication.bwa&&(J+="&"+kd.AFrameworkApplication.R$b());(oa=this.uo?this.uo.iR:null)&&(J+="&DestinationUrl="+Jg.a.pf(oa));this.rvd.eBb.Ul(J,2,e,{"Content-Type":"application/json; charset=utf-8"},!0,2,Object(wf.a)(this,this.nvi,"newDocumentFromStreamSuccessHandler"),Object(wf.a)(this,this.mvi,"newDocumentFromStreamFailureHandler"),null,
void 0,void 0,void 0,void 0,"31")}};Be.prototype.nvi=function(J){if(J&&J.data&&J.data.fe){var oa=Ch.d(J.data.fe);var Va=oa.uu;oa.returnValue?Va.StatusCode!==gh.a.sO&&Va.StatusCode!==gh.a.nqb?(td.ULS.sendTraceTag(24904475,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: StatusCode: {2}",this.bP,this.mpa,Va.StatusCode),this.OVa(null)):Va.NewDocumentUrl&&""!==Va.NewDocumentUrl?(J=(new Date).getTime()-this.V_d,td.ULS.sendTraceTag(35156359,202,50,"FileType:{0}, FileSize:{1}, TimeConsumed:{2}",
this.bP,this.mpa,J),this.kog(Va.NewDocumentUrl)):(td.ULS.sendTraceTag(24904476,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data do not have NewDocumentUrl.",this.bP,this.mpa),this.OVa(null)):(Va={},td.ULS.sendTraceTag(24904474,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Failed to deserialize: {2}",this.bP,this.mpa,(Va.ResponseData=yi.a.Adb(J.data.fe),Va)),this.OVa(null))}else td.ULS.sendTraceTag(24904473,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: Response data is null",
this.bP,this.mpa),this.OVa(null)};Be.prototype.mvi=function(J){J&&J.data&&td.ULS.sendTraceTag(24904477,202,10,"FileType:{0}, FileSize:{1}; CreateNewDocument from stream failure: ErrorStatus: {2}",this.bP,this.mpa,J.data.status);this.OVa(null)};tl.Object.defineProperties(Be.prototype,{bP:{configurable:!0,enumerable:!0,get:function(){switch(this.rvd.Dba){case 3:return"WordWAC";case 1:return"ExcelWAC";case 2:return"PowerPointWAC";case 5:return"VisioWAC"}return null}},buh:{configurable:!0,enumerable:!0,
get:function(){return this.fhb.value}},Zka:{configurable:!0,enumerable:!0,get:function(){return this.Ypa.value}},rvd:{configurable:!0,enumerable:!0,get:function(){return this.w1.value}},aac:{configurable:!0,enumerable:!0,get:function(){return this.YCa.value}}});Object(Xe.a)(Be,"NewDocumentFromStreamOperation",null,[]);Ne.prototype.create=function(J,oa,Va){return new Be(J,oa,Va,this.fhb,this.Ypa,this.w1,this.Skg)};Object(Xe.a)(Ne,"NewDocumentFromStreamOperationFactory",null,[535]);var ii=b(86),la=
b(524),nb=b(55);Rd.prototype.di=function(J){J.register(Ne,"Common.App.NewAndOpen.UX.NewDocumentFromStreamOperationFactory").as("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory").zc().Ic(function(){return new Ne(new mg.a(function(){return kd.AFrameworkApplication.sa.Pa.rcd()}),new mg.a(function(){return kd.AFrameworkApplication.Zka}),new mg.a(function(){return J.Hh("Common.INewAndOpenCommonHelpers")}),new mg.a(function(){return J.Hh("Common.IEventEmitter<Common.IGetMoreInfoResult>")}))})};
Rd.prototype.init=function(){var J=this;kd.AFrameworkApplication.ga.$v(function(){J.zwb()})};Rd.prototype.zwb=function(){var J=la.a.Fq(ii.a.instance.mc("Common.INewAndOpenCommonHelpers")),oa=la.a.Fq(ii.a.instance.mc("Common.IEventEmitter<Common.IGetMoreInfoResult>"));kd.AFrameworkApplication.Zka&&nb.Task.WAA.call(null,J,oa).continueWith(function(){var Ub=new Dd(new mg.a(function(){return J.result}),new mg.a(function(){return kd.AFrameworkApplication.sa.Pa.rcd()}),new mg.a(function(){return oa.result}),
new mg.a(function(){return kd.AFrameworkApplication.sa.Pa.scd().UFa||"1959943459"}),new mg.a(function(){return kd.AFrameworkApplication.Zka}),new mg.a(function(){return kd.AFrameworkApplication.Qci}));Ub.Mg();Ub.xFb()});if(kd.AFrameworkApplication.GIf){var Va=la.a.Fq(ii.a.instance.mc("Common.IEventEmitter<Common.IMruResult>"));nb.Task.WAA.call(null,J,oa,Va).continueWith(function(){var Ub=new sd(new mg.a(function(){return J.result}),new mg.a(function(){return cf.INi}),new mg.a(function(){return kd.AFrameworkApplication.sa.Pa.scd()}),
new mg.a(function(){return kd.AFrameworkApplication.HNi}),new mg.a(function(){return kd.AFrameworkApplication.GNi}),new mg.a(function(){return oa.result}),new mg.a(function(){return Va.result}),kd.AFrameworkApplication.ga);Ub.s1i();Ub.TJf()})}};Rd.prototype.dispose=function(){};tl.Object.defineProperties(Rd.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.NewAndOpen.UX"}}});Object(Xe.a)(Rd,"UXPackageManager",null,[4,5,3]);var Wb=b(128),Dc=Wb.StandardDialog;vm(ce,Dc);
ce.prototype.displayError=function(J){this.xz(J,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null)};ce.prototype.f5c=function(J){this.xz(J,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError,null,!0)};Object(Xe.a)(ce,"ErrorDialog",Wb.StandardDialog,[571]);var zb=b(139);ec.prototype.STe=function(){td.ULS.sendTraceTag(24134234,352,50,"Returning endpoint for ODC");var J=new zb.a;J.setResult("api.onedrive.com");return J.task};Object(Xe.a)(ec,"OneDriveConsumerEndpointHelper",
null,[549]);var hd=b(49),ke=b(373),He=b(221);sb.prototype.P2a=function(){this.QVa||(this.QVa=this.Y8a?He.a.create(this.Y8a,null,null,null,!1):null);return this.QVa};sb.prototype.setup=function(J){var oa=this;this.PDa=J;this.JOc||this.HOc?this.JOc&&this.PDa&&this.PDa(!0):(J=this.P2a())?(this.HOc=!0,J.U6a.continueWith(function(Va){oa.THi(Va)}),ke.a.bia(J)):(td.ULS.sendTraceTag(20509837,352,15,"Failure with OneDrive API download as the onedrive url received is empty."),this.PDa(!1))};sb.prototype.tyd=
function(J){td.ULS.sendTraceTag(20509838,352,15,"Failure during OneDrive API download: {0}",J.mg?J.mg.toString():"No error detail.")};sb.prototype.THi=function(J){this.HOc=!1;if(J.jg)this.tyd(J),this.PDa(!1);else try{this.JOc=!0,td.ULS.sendTraceTag(17909022,352,50,"Initializing OneDrive API"),this.Cjd(),td.ULS.sendTraceTag(17909023,352,50,"OneDrive API is initialized."),this.PDa(!0)}catch(oa){td.ULS.sendTraceTag(20555412,352,10,"Failed during OneDrive API init: {0}",oa.toString()),this.PDa(!1)}};
sb.prototype.startPicker=function(J){this.P5=J;this.uDa?td.ULS.sendTraceTag(23881878,216,50,"In limited edit mode, will not show Picker."):(td.ULS.sendTraceTag(23881877,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(wf.a)(this,this.Swd,"onApiReady")))};sb.prototype.Swd=function(J){J?this.Hhc():this.ri()};sb.prototype.ri=function(){this.fs().displayError(hd.a.eNi)};sb.prototype.onSuccess=function(J){td.ULS.sendTraceTag(17909057,352,50,"Success Callback called. Calling callback function.");
this.P5&&this.P5(!0,J)};sb.prototype.dispose=function(){this.QVa&&this.QVa.dispose()};tl.Object.defineProperties(sb.prototype,{Ane:{configurable:!0,enumerable:!0,get:function(){return this.KOb}},ga:{configurable:!0,enumerable:!0,get:function(){return this.ub}}});Object(Xe.a)(sb,"AOneDriveFilePickerApiManager",null,[606,3]);vm(vc,sb);vc.prototype.start=function(J,oa){this.yh=J;this.startPicker(oa)};vc.prototype.Cjd=function(){var J={},oa={};J=1===this.Ane||2===this.Ane?(J.client_id=this.ga.appSettings.UploadToSkyDriveClientId,
J):(oa.client_id=this.ga.appSettings.UploadToSkyDriveClientId,oa.env="INT",oa);WL.init(J)};vc.prototype.startPicker=function(J){this.P5=J;!this.uDa&&this.D1.hLa?(td.ULS.sendTraceTag(17909025,352,50,"User is signed in. We will show file picker."),this.setup(Object(wf.a)(this,this.Swd,"onApiReady"))):(td.ULS.sendTraceTag(17909026,352,50,"User is not signed in. show need to sign in dialog."),this.Grg())};vc.prototype.Hhc=function(){try{td.ULS.sendTraceTag(17909027,352,50,"Launching file dialogue"),WL.fileDialog(this.yh).then(Object(wf.a)(this,
this.onSuccess,"onSuccess"),Object(wf.a)(this,this.O5,"onFailure"))}catch(J){td.ULS.sendTraceTag(17909056,352,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",J,J.stack),this.ri()}};vc.prototype.O5=function(J){if(J&&J.error){if("user_canceled"===J.error.code){td.ULS.sendTraceTag(17909058,352,50,"User canceled.");return}td.ULS.sendTraceTag(17909059,352,50,"File Dialog returned with error code:{0}, and error message: {1}",J.error.code,J.error.message)}else td.ULS.sendTraceTag(17909060,352,50,
"File Dialog returned with no response");this.P5&&this.P5(!1,J);this.ri()};tl.Object.defineProperties(vc.prototype,{Y8a:{configurable:!0,enumerable:!0,get:function(){return this.ga.Ua("OneDriveApiUrl")}}});Object(Xe.a)(vc,"OneDriveFilePickerApiManagerV5",sb,[]);vm($b,sb);$b.prototype.start=function(J,oa){var Va=this;this.hRb=oa;var Ub=this.Gjg.STe();Ub.continueWith(function(){td.ULS.sendTraceTag(24134241,352,50,"Fetch endpoint task completed, attempting to start OneDrive picker");Va.bae=Ub.result;
Va.startPicker(function(e,C){Va.kyc();J(e,C)})},3);Ub.continueWith(function(){td.ULS.sendTraceTag(24134242,352,15,Ub.mg.message);Va.kyc()},5)};$b.prototype.Cjd=function(){var J=this;this.options.success=function(oa){var Va={};Va.data=oa;J.onSuccess(Va)};this.options.error=function(oa){var Va={};Va.error=oa;J.O5(Va)};this.options.advanced={};this.options.advanced.linkType="share";this.options.advanced.endpointHint=this.bae;this.options.advanced.iframeParentDiv=this.hRb};$b.prototype.Hhc=function(){try{td.ULS.sendTraceTag(22090007,
352,50,"Launching OneDrive file picker dialog"),this.kyc(),OneDrive.open(this.options)}catch(J){td.ULS.sendTraceTag(22090008,352,10,"Opening OneDrive file picker threw an exception: {0}",J.message),this.ri()}};$b.prototype.O5=function(J){this.P5&&this.P5(!1,J);this.ri()};$b.prototype.kyc=function(){this.hRb.style.visibility="hidden"===this.hRb.style.visibility?"":"hidden"};tl.Object.defineProperties($b.prototype,{Y8a:{configurable:!0,enumerable:!0,get:function(){return this.ga.Ua("OneDriveApiV72Url")}}});
Object(Xe.a)($b,"OneDriveFilePickerApiManagerV7",sb,[]);vm(rb,sb);rb.prototype.start=function(J,oa,Va,Ub){this.options.advanced.iframeParentDiv=Va;this.options.advanced.endpointHint=Ub;this.options.cancel=oa;this.zgg.ra("OneDriveApiV72RecentsViewEnabled")&&(this.options.advanced.navigation={},this.options.advanced.navigation.entryLocation={},this.options.advanced.navigation.entryLocation.oneDrive={},this.options.advanced.navigation.entryLocation.oneDrive.recent={});this.startPicker(J)};rb.prototype.startPicker=
function(J){this.P5=J;this.uDa?td.ULS.sendTraceTag(24391838,216,50,"In limited edit mode, will not show Picker."):(td.ULS.sendTraceTag(24391837,216,50,"Not in limited edit mode, will show file picker."),this.setup(Object(wf.a)(this,this.Swd,"onApiReady")))};rb.prototype.Cjd=function(){var J=this;this.options.success=function(oa){var Va={};Va.data=oa;J.onSuccess(Va)};this.options.error=function(oa){var Va={};Va.error=oa;J.O5(Va)}};rb.prototype.Hhc=function(){try{td.ULS.sendTraceTag(23881879,216,50,
"Launching OneDrive file picker dialog"),OneDrive.save(this.options)}catch(J){td.ULS.sendTraceTag(23881880,216,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",J.message,J.stack),this.ri()}};rb.prototype.tyd=function(J){td.ULS.sendTraceTag(25180160,216,15,"Failure during OneDrive API download: {0}",J.mg?J.mg.toString():"No error detail.");ke.a.m3i(this.Y8a);this.QVa=null};rb.prototype.ri=function(){this.fs().f5c(hd.a.Vbj)};rb.prototype.O5=function(J){this.P5&&this.P5(!1,J)};
tl.Object.defineProperties(rb.prototype,{Y8a:{configurable:!0,enumerable:!0,get:function(){return this.ga.Ua("OneDriveApiV72Url")}}});Object(Xe.a)(rb,"OneDriveFilePickerApiManagerV72",sb,[]);Object(Xe.a)(Da,"IExtraData",null,[]);vm(Vf,rb);Vf.prototype.Hhc=function(){try{td.ULS.sendTraceTag(26071182,352,50,"Launching OneDrive file picker dialog with filter: {0}, commandMode: {1}, QosExtraData: {2} officeSessionId: {3}",this.options.advanced.filter,this.options.commandMode,this.options.qosExtradata?
this.options.qosExtradata.olsSessionId:"",kd.AFrameworkApplication.userSessionId),OneDrive.open(this.options)}catch(J){td.ULS.sendTraceTag(26071183,352,10,"Opening OneDrive file picker fail. Exception: {0}, Callstack: {1}.",J.message,J.stack),this.ri()}};tl.Object.defineProperties(Vf.prototype,{Y8a:{configurable:!0,enumerable:!0,get:function(){return this.ga.Ua("OneDriveApiV72Url")}}});Object(Xe.a)(Vf,"OneDriveFilePickerApiOpenManagerV72",rb,[]);sf.prototype.STe=function(){this.Sl=new zb.a;td.ULS.sendTraceTag(24134235,
352,50,"Sending initial request for OneDrive for Business Endpoint");this.YKd();return this.Sl.task};sf.prototype.YKd=function(J){J=void 0===J?null:J;var oa=String.format("GetMoreInfoHandler.ashx?{0}",kd.AFrameworkApplication.gHa);this.Og.h9(oa,1,null,J,["PersonalFileStorageUrl","X-NewKey"],!1,2,Object(wf.a)(this,this.FMh,"getMoreInfoSucceeded"),Object(wf.a)(this,this.DMh,"getMoreInfoFailed"),null,void 0,void 0,void 0,void 0,"21")};sf.prototype.DMh=function(J){if(J.data.httpStatus===gh.a.wEb&&"X-NewKey"in
J.data.responseHeaders){td.ULS.sendTraceTag(24134236,352,50,"GetMoreInfo request failed due to bad canary. Updating with new canary and resending");var oa={};oa["X-Key"]=J.data.responseHeaders["X-NewKey"];this.YKd(oa)}else 0<this.MNc?(td.ULS.sendTraceTag(24134237,352,50,"GetMoreInfo request failed, attmepting again. {0} retries remaining",this.MNc),this.MNc--,this.YKd()):(td.ULS.sendTraceTag(24134238,352,50,"GetMoreInfo request failed, and no more retries remaining. Faulting task"),this.Sl.setException(Error.create("GetMoreInfo request failed and no more retries remain")))};
sf.prototype.FMh=function(J){"PersonalFileStorageUrl"in J.data.responseHeaders&&""!==J.data.responseHeaders.PersonalFileStorageUrl?(td.ULS.sendTraceTag(24134239,352,50,"Successfully received an ODB endpoint"),this.Sl.setResult(J.data.responseHeaders.PersonalFileStorageUrl)):(td.ULS.sendTraceTag(24134240,352,50,"GetMoreInfo request was successful but didn't return an ODB endpoint"),this.Sl.setException(Error.create("GetMoreInfo request succeeded but did not have ODB endpoint")))};Object(Xe.a)(sf,"OneDriveForBusinessEndpointHelper",
null,[549]);var df=b(581);Qe.prototype.init=function(){};Qe.prototype.dispose=function(){};Qe.prototype.di=function(J){var oa=this;this.rb=J;this.rb.register(vc,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV5").as("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager").zc().Ic(function(){return new vc(df.a.instance,kd.AFrameworkApplication.ga,kd.AFrameworkApplication.V0a,kd.AFrameworkApplication.limitedEdit,kd.AFrameworkApplication.j0f,function(){return new ce})});kd.AFrameworkApplication.Vdf?
this.rb.register(549,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").zc().Ic(function(){return new ec}):this.rb.register(549,"Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper").zc().Ic(function(){return new sf(kd.AFrameworkApplication.Hd)});this.rb.register($b,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV7").zc().Ic(function(){return new $b(kd.AFrameworkApplication.ga,kd.AFrameworkApplication.V0a,kd.AFrameworkApplication.limitedEdit,function(){return new ce},
oa.rb.resolve("Common.App.OneDriveFilePickerApi.IOneDriveApiEndpointHelper"))});this.rb.register(rb,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72").zc().Ic(function(){return new rb(kd.AFrameworkApplication.ga,kd.AFrameworkApplication.V0a,kd.AFrameworkApplication.limitedEdit,function(){return new ce})});this.rb.register(Vf,"Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiOpenManagerV72").zc().Ic(function(){return new Vf(kd.AFrameworkApplication.ga,kd.AFrameworkApplication.V0a,
kd.AFrameworkApplication.limitedEdit,function(){return new ce})})};Qe.main=function(){wg.a.instance.mj(new Qe)};tl.Object.defineProperties(Qe.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.OneDriveFilePickerApi"}}});Object(Xe.a)(Qe,"PackageManager",null,[4,5]);var kf=Wb.StandardDialog;vm(Me,kf);Me.prototype.displayError=function(J,oa,Va){this.Oz=oa;this.RVa=Va;td.ULS.sendTraceTag(8194008,216,50,"Display error with code:{0}, overwriteTarget:{1}.",J,Va);(J=this.dZc(J))?
(this.kc=0,this.Cc(1,CommonUIStrings.l_DialogClose)):(this.kc=6,this.Cc(0,CommonUIStrings.l_DialogClose));J||td.ULS.sendTraceTag(8194009,216,50,"Show standard error dialog.");this.xz(hd.a.Ubj,this.$bd(J),this.mHh(J,oa),Object(wf.a)(this,this.cJd,"retryDialogHandler"),!0)};Me.prototype.cJd=function(J){1===J?(td.ULS.sendTraceTag(8194010,216,50,"User click to retry button in error dialog."),this.Oz?this.La.ze(Pg.a.rHb,2,[this.Oz,this.RVa]):this.La.processAction(Pg.a.rHb,2)):td.ULS.sendTraceTag(8194011,
216,50,"User cancel the error dialog.")};Me.prototype.dZc=function(J){return 0>J||6<J?(td.ULS.sendTraceTag(8194012,216,15,"Unexpected error code {0}.",J),0):J};Me.prototype.mHh=function(J,oa){J=this.dZc(J);return this.ahb?[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameAllowPercentOctothorpe,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,oa),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameDisallowPercentOctothorpe][J]:
[CommonUIStrings.l_FailToSaveFile,CommonUIStrings.l_InvalidFileNameText,CommonUIStrings.l_EmptyNameText,CommonUIStrings.l_InvalidPermissionText,String.format(CommonUIStrings.l_OverwriteTargetText,oa),CommonUIStrings.l_LockTargetText,CommonUIStrings.l_InvalidFileNameText][J]};Me.prototype.$bd=function(J){J=this.dZc(J);return[CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle,CommonUIStrings.l_EmptyNameTitle,CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_GeneralFailTitle,
CommonUIStrings.l_GeneralFailTitle,CommonUIStrings.l_InvalidFileNameTitle][J]};Object(Xe.a)(Me,"ErrorRetryDialog",Wb.StandardDialog,[592]);Md.prototype.create=function(){return new Me(this.La,this.ahb)};Object(Xe.a)(Md,"ErrorRetryDialogFactory",null,[554]);var ff=b(140),Ef=b(40),Qf=ff.a;vm(md,Qf);md.prototype.qFe=function(J,oa){this.RK(1,!!J&&J!==oa);this.CI=document.getElementById(md.RPe);Ef.a.addHandler(this.CI,"change",Object(wf.a)(this,this.plc,"onFileNameChange"));Ef.a.addHandler(this.CI,"input",
Object(wf.a)(this,this.plc,"onFileNameChange"));this.CI.focus()};md.prototype.M7b=function(J){return this.ahb?(new RegExp("["+this.w6b('\\/:*?"<>|')+"]")).test(J):(new RegExp("["+this.w6b('\\/:*?"<>|#{}%~&')+"]")).test(J)};md.prototype.w6b=function(J){return J.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&")};md.prototype.ugd=function(){var J=Jg.a.Vq(kd.AFrameworkApplication.Zl.tn);this.RK(1,!!this.CI&&""!==this.CI.value&&this.CI.value!==J)};md.prototype.plc=function(){var J=this;this.CI&&window.setTimeout(function(){J.ugd()},
0)};md.prototype.L7b=function(J,oa){if(1!==J)td.ULS.sendTraceTag(23881882,216,50,"User click cancel to cancel upload file in file name dialog.");else{J=oa[md.RPe];oa=md.$Bf in oa?oa[md.$Bf]:!1;td.ULS.sendTraceTag(23881883,216,50,"User click save to upload file with new name {0} and overwrite the target {1}.",Jg.a.Cpc(J),oa);var Va=Jg.a.X3(kd.AFrameworkApplication.fileName);(J=J?J.trim():null)&&""!==J&&""!==Va||1===this.sa.state?this.M7b(J)?this.fs.create().displayError(1,J,oa):this.Yfa.pna(J+Va,oa,
this.yh):this.fs.create().displayError(2,J,oa)}};md.prototype.dispose=function(){this.CI&&(Ef.a.removeHandler(this.CI,"change",Object(wf.a)(this,this.plc,"onFileNameChange")),Ef.a.removeHandler(this.CI,"input",Object(wf.a)(this,this.plc,"onFileNameChange")),this.CI=null);Qf.prototype.dispose.call(this)};tl.Object.defineProperties(md.prototype,{sa:{configurable:!0,enumerable:!0,get:function(){return this.Ie}}});md.RPe="txtFileName";md.$Bf="chkOverwrite";Object(Xe.a)(md,"FileNameDialogBase",ff.a,[]);
tl.Object.defineProperties(Ec,{xf:{configurable:!0,enumerable:!0,get:function(){return ff.a.jj(Ec.Tj,CommonUIStrings.l_SaveACopyFileName,CommonUIStrings.l_SaveAsToHostOverwrite)}}});Ec.Tj="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='OverwriteBlock'> <span id='OverwriteBlockSpan' class='WACDialogSpan'><input type='checkbox' id='chkOverwrite' class='WACDialogCheckBox'></input> <label id='lbcOverwrite' class='\"WACDialogInlineLabel\"' for='chkOverwrite'>{1}</label></span> </div>";
Object(Xe.a)(Ec,"FileNameDialogHtml",null,[]);vm(Ob,md);Ob.prototype.RP=function(J,oa){var Va=Jg.a.Vq(kd.AFrameworkApplication.Zl.tn),Ub={};oa=(Ub.txtFileName=J||Va,Ub.lblFolderName=CommonUIStrings.l_ToCurrentFolder,Ub.chkOverwrite=oa,Ub);this.initializeAndShow(CommonUIStrings.L_SaveAs,Object(wf.a)(this,this.L7b,"fileNameDialogHandler"),oa);this.qFe(J,Va)};Object(Xe.a)(Ob,"FileNameDialog",md,[591]);Aa.prototype.create=function(){return new Ob(this.ub,this.La,this.Ie,this.lX,this.fs,this.Yfa)};Object(Xe.a)(Aa,
"FileNameDialogFactory",null,[553]);var Vg=b(688);$f.prototype.Mg=function(){2===kd.AFrameworkApplication.sa.Pa.Lj?kd.AFrameworkApplication.Eb.hf(Pg.a.rHb,th.a.frame,Object(wf.a)(this,this.yRf,"saveAsToHostActionDispatcher"),4):kd.AFrameworkApplication.Eb.$b(Pg.a.rHb,th.a.frame,Object(wf.a)(this,this.yRf,"saveAsToHostActionDispatcher"))};$f.prototype.yRf=function(J,oa,Va,Ub,e){return oa.contextId!==th.a.frame||J!==Pg.a.rHb?2:this.ub.ra("SaveAsToHostBrsIsEnabled")?1===Va?Vg.SessionStatusManager.instance.svb||
kd.AFrameworkApplication.O4?8:32:2===Va?(td.ULS.sendTraceTag(8194015,216,50,"User clicked on SaveAsToHost button from the backstage."),J=this.lGc.create(),e&&Object.getType(e)===Array&&2===e.length?J.RP(e[0],!!e[1]):J.RP(null,!1),32):8:8};Object(Xe.a)($f,"SaveAsToHostActor",null,[]);var Kg=b(77);lg.prototype.UJb=function(){1!==this.Ie.state&&(this.um=this.Kjb(),this.um.message=CommonUIStrings.l_CommentProgressTooltip,this.um.kc=5,this.um.Gu=!1,this.um.eAa(CommonUIStrings.l_DefaultDialogTitle,null,
null))};lg.prototype.JR=function(J){J=void 0===J?0:J;1!==this.Ie.state&&this.fs.create().displayError(J,Jg.a.Vq(this.Oz),this.RVa)};lg.prototype.nPa=function(){var J=this.ub.appSettings.BreadcrumbFolderUrl;td.ULS.sendTraceTag(8194016,216,50,"Redirecting to OneDrive for business Folder.");Rg.a.sf(J,Rg.a.cX(3),void 0,"UploadToHostManager.RedirectToFolder")};lg.prototype.mPa=function(J){var oa=!1,Va=!1;this.ub&&(oa=this.ub.ra("SaveACopyIsEnabledForUiHost"),Va=this.ub.ra("UiHostSupportsDocRebootFeatures"));
td.ULS.sendTraceTag(8194017,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1} uiHostSupportsFeature {2}",J,oa,Va);if(oa&&Va){td.ULS.sendTraceTag(51245197,216,50,"UploadToHostManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var Ub={};Ub[jh.a.iPa]="1";Ub[jh.a.documentUrl]=J;Ub[jh.a.reason]=Ki.a.saveAs;kd.AFrameworkApplication.OU().execute(function(e){e.Qj(Fg.a.dta,Ub)})}else oa&&!Va&&kd.AFrameworkApplication.ewa?Rg.a.sf(J,Rg.a.cX(4),void 0,"UploadToHostManager.RedirectToEditUrl"):
Rg.a.sf(J,Rg.a.cX(3),void 0,"UploadToHostManager.RedirectToEditUrl")};lg.prototype.pna=function(J,oa,Va){Va=void 0===Va?null:Va;td.ULS.sendTraceTag(8194018,216,50,"Starting to upload file");this.$5d&&!this.$5d()&&this.Og&&(this.uh&&(this.Xfa=this.uh.Fc("DialogShown","SaveAsToHostUploadTime")),this.UJb(),this.RVa=oa,this.Oz=J,(this.yh=Va)&&"true"===this.yh.SkipSaveToHost?this.c7b():this.$P())};lg.prototype.$P=function(){var J=this;32!==this.La.processAction(Pg.a.hQa,1)?(td.ULS.sendTraceTag(18989378,
219,15,"The save file change is not supported, this operation may exist data losting."),this.c7b()):this.La.ze(Pg.a.hQa,2,[function(){td.ULS.sendTraceTag(18989379,219,50,"Call the force save file change successfully.");J.c7b()},function(oa,Va){td.ULS.sendTraceTag(18989380,219,15,"The file change is not saved successfully, this operation may lead to data loss.");J.JR(Va)}])};lg.prototype.rMi=function(J){this.PHa();this.MCa=!1;if(J&&J.data&&J.data.fe){var oa=Ch.d(J.data.fe);var Va=oa.uu;if(oa.returnValue)if(Va.StatusCode!==
gh.a.sO&&Va.StatusCode!==gh.a.nqb)td.ULS.sendTraceTag(8194049,216,10,"UploadToHostManager failure. Response data is not JSON."),J={},J.FailureReason=Va.StatusCode.toString(),J.ExtraInfo=Va.ExtraInfo,this.Rca(J),this.JR(parseInt(Va.ExtraInfo));else{td.ULS.sendTraceTag(8194050,216,50,"UploadToHost execute success.");this.XHd();try{Va.NewDocumentUrl&&""!==Va.NewDocumentUrl?this.mPa(Va.NewDocumentUrl):this.nPa()}catch(Ub){td.ULS.sendTraceTag(37025699,216,15,"Redirect failed with exception: {0}",Ub.toString())}this.bEb()}else Va=
{},td.ULS.sendTraceTag(8194048,216,10,"Failed to deserialize : {0}",(Va.ResponseData=yi.a.Adb(J.data.fe),Va)),J={},this.Rca((J.FailureReason="Failed to deserialize response",J)),this.JR()}else td.ULS.sendTraceTag(8194019,216,10,"UploadToHostManager failure. Response data is null"),J={},this.Rca((J.FailureReason="null response",J)),this.JR()};lg.prototype.qMi=function(J){if(5!==J.data.status&&12!==J.data.status||this.MCa){var oa={};td.ULS.sendTraceTag(8194052,216,10,"UploadToHostManager HTTP failure with code: {0}",
(oa.Status=J.data.status,oa.HttpStatus=J.data.httpStatus,oa));oa={};this.Rca((oa.FailureReason=J.data.httpStatus.toString(),oa));this.PHa();this.JR();this.bEb()}else td.ULS.sendTraceTag(8194051,216,10,"UploadToHostManager failure. Retry automatically."),this.MCa=!0,this.yh&&"true"===this.yh.SkipSaveToHost?this.c7b():this.$P()};lg.prototype.PHa=function(){this.um&&(this.um.close(),this.um=null)};lg.prototype.bEb=function(){this.Xfa&&(this.Xfa.stop(),this.Xfa=null)};lg.prototype.XHd=function(){this.yh&&
"VersionHistory"===this.yh.SaveEntryPoint&&this.La.processAction(Pg.a.xrc,2)};lg.prototype.Rca=function(J){this.yh&&"VersionHistory"===this.yh.SaveEntryPoint&&this.La.ze(Pg.a.YHd,2,J)};lg.prototype.c7b=function(){var J=this.HEa+this.Wea;J=Kg.a.gl(J,"qs",Jg.a.pf(kd.AFrameworkApplication.hj));J=Kg.a.gl(J,"n",Jg.a.pf((new Date).getTime().toString()));J=Kg.a.gl(J,"ov",Jg.a.pf(this.RVa.toString()));J=Kg.a.gl(J,"fn",Jg.a.pf(this.Oz));this.yh&&this.yh.FileDownloadUrl&&(J=Kg.a.gl(J,"furl",Jg.a.pf(this.yh.FileDownloadUrl)));
this.Og.Ul(J,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,Object(wf.a)(this,this.rMi,"onUploadFinished"),Object(wf.a)(this,this.qMi,"onUploadFailed"),null,void 0,void 0,void 0,void 0,"1")};Object(Xe.a)(lg,"UploadToHostManager",null,[552]);var yh=b(909);ag.prototype.init=function(){kd.AFrameworkApplication.ga.$v(Object(wf.a)(this,this.QA,"onFullAppSettingsReady"))};ag.prototype.QA=function(){kd.AFrameworkApplication.ga.ra("SaveAsToHostBrsIsEnabled")&&this.rb.resolve("Common.App.SaveAsToHost.SaveAsToHostActor").Mg()};
ag.prototype.di=function(J){this.rb=J;this.rb.register(Md,"Common.App.SaveAsToHost.ErrorRetryDialogFactory").as("Common.App.SaveAsToHost.IErrorRetryDialogFactory").Ic(function(){return new Md(kd.AFrameworkApplication.ga,kd.AFrameworkApplication.Eb)}).zc();this.rb.register(lg,"Common.App.SaveAsToHost.UploadToHostManager").as("Common.App.SaveAsToHost.IUploadToHostManager").Ic(function(){return new lg(kd.AFrameworkApplication.Eb,kd.AFrameworkApplication.ga,kd.AFrameworkApplication.Hd,function(){return kd.AFrameworkApplication.Gg},
function(){return(new yh.a).create()},J.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),kd.AFrameworkApplication.sa,kd.AFrameworkApplication.sa.fD)}).zc();this.rb.register(Aa,"Common.App.SaveAsToHost.FileNameDialogFactory").as("Common.App.SaveAsToHost.IFileNameDialogFactory").Ic(function(){return new Aa(kd.AFrameworkApplication.ga,kd.AFrameworkApplication.Eb,kd.AFrameworkApplication.sa,kd.AFrameworkApplication.sa.Pa,J.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),J.resolve("Common.App.SaveAsToHost.UploadToHostManager"))}).zc();
this.rb.register($f,"Common.App.SaveAsToHost.SaveAsToHostActor").Ic(function(){return new $f(kd.AFrameworkApplication.ga,J.resolve("Common.App.SaveAsToHost.FileNameDialogFactory"),J.resolve("Common.App.SaveAsToHost.UploadToHostManager"))}).zc()};ag.prototype.dispose=function(){};ag.main=function(){wg.a.instance.mj(new ag)};tl.Object.defineProperties(ag.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveAsToHost"}}});Object(Xe.a)(ag,"SaveAsToHostPackage",null,[4,5]);
var fh=Wb.StandardDialog;vm(ef,fh);ef.prototype.displayError=function(J,oa){this.KFe(J,oa,hd.a.Wbj)};ef.prototype.KFe=function(J,oa,Va){td.ULS.sendTraceTag(25180161,216,10,"Show upload error dialog with error code {0}.",Va);this.xz(Va,J,oa,null)};ef.prototype.f5c=function(J,oa){td.ULS.sendTraceTag(25235986,216,15,"Show warning dialog of Picker related issue.");this.xz(hd.a.Ybj,J,oa,null,!0)};Object(Xe.a)(ef,"ErrorDialog",Wb.StandardDialog,[708]);tl.Object.defineProperties(Od,{xf:{configurable:!0,
enumerable:!0,get:function(){return ff.a.jj(Od.Tj,CommonUIStrings.l_FileNameLabel,CommonUIStrings.l_NewFileLocationLabel,CommonUIStrings.l_CurrentOnlineFolder,"")}}});Od.Tj="<div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div> <div class='WACDialogRow' id='DocumentLocationBlock'> <label id='locationName' class='WACDialogLabel' for='locationName' >{1}</label> <div class='FolderLocationDiv' id='folderLocation'> <label id='currentLocation' class='WACDialogLabel' for='currentLocation' >{2}</label> <span id='anotherFolder' class='WACDialogSpan'>{3}</span> </div> </div>";
Object(Xe.a)(Od,"FileNameDialogHtml",null,[]);var If=b(12),eh=b(91),Qh=b(89);vm(Ld,md);Ld.prototype.RP=function(J){var oa=Jg.a.Vq(kd.AFrameworkApplication.Zl.tn),Va=kd.AFrameworkApplication.breadcrumbFolderName,Ub=kd.AFrameworkApplication.breadcrumbBrandName,e={};e=(e.txtFileName=J||oa,e);var C=CommonUIStrings.L_SaveAs;2===kd.AFrameworkApplication.sa.Pa.Lj&&(C=CommonUIStrings.L_SaveACopy);this.initializeAndShow(C,Object(wf.a)(this,this.L7b,"fileNameDialogHandler"),e);this.qFe(J,oa);this.GHa.style.width=
"450px";Sys.UI.DomElement.addCssClass(document.getElementById("DocumentLocationBlock"),"SaveAsDialogRow");kd.AFrameworkApplication.ga.ra("HideSaveToAnotherFolderButtonforUIHost")||(this.qy=document.getElementById("anotherFolder"),J=document.getElementById("folderLocation"),this.pOc=Qh.a.Sne(J,this.qy,"anotherFolderDescribedBy"),this.qy.className="WACButton WACDialogButtonNormal",J=!1,Va&&Va.length?(this.Mie(this.qy,this.pOc,String.format(CommonUIStrings.l_ScreenReader_CurrentFileLocation,Ub,Va)),
J=this.Rvg(Ub,Va)):this.Mie(this.qy,this.pOc,CommonUIStrings.l_CurrentOnlineFolder),this.Nwg(this.qy),this.Tvg(this.qy),J?(document.getElementById("currentLocation").style.width="100%",Sys.UI.DomElement.addCssClass(this.qy,"SaveToAnotherLocationTwo"),td.ULS.sendTraceTag(24459297,216,50,"Move save to another folder button to second line.")):Sys.UI.DomElement.addCssClass(this.qy,"SaveToAnotherLocationOne"),Ef.a.addHandler(this.qy,If.a.click,Object(wf.a)(this,this.dzd,"onSaveToAnotherLocationClick")),
Ef.a.addHandler(this.qy,If.a.Rb,Object(wf.a)(this,this.Fyf,"onSaveToAnotherLocationKeyDown")))};Ld.prototype.Rvg=function(J,oa){var Va=!1;var Ub=document.getElementById("currentLocation");Ub.innerText="";var e=this.mYe(Ub,J),C=this.mYe(Ub,oa),M=255,qa=255;255<e+C&&(M=Math.max(238,408-e),qa=Math.max(170,408-C),Va=!0);this.iyg(Ub,J,qa,oa,M);return Va};Ld.prototype.mYe=function(J,oa){var Va=document.createElement("div");Va.innerText=oa;Va.style.visibility="hidden";J.appendChild(Va);oa=Va.clientWidth;
J.removeChild(Va);return oa};Ld.prototype.iyg=function(J,oa,Va,Ub,e){oa&&(this.Kie(J,oa,Va),this.byg(J));Ub&&this.Kie(J,Ub,e)};Ld.prototype.Kie=function(J,oa,Va){var Ub=document.createElement("div");Ub.innerText=oa;Ub.title=oa;Ub.className="SaveToAnotherFolderBreadcrumb";Ub.style.maxWidth=Va.toString()+"px";J.appendChild(Ub)};Ld.prototype.byg=function(J){var oa=document.createElement("span");oa.id="FolderSeparator";var Va=document.createElementNS("http://www.w3.org/2000/svg","svg");Va.setAttribute("class",
"SeparatorCaret");var Ub=document.createElementNS("http://www.w3.org/2000/svg","polygon");Ub.setAttribute("points","1 4 1 11 5 7.5");Va.appendChild(Ub);oa.appendChild(Va);J.appendChild(oa)};Ld.prototype.Mie=function(J,oa,Va){Va=String.format(CommonUIStrings.l_ScreenReader_SaveToAnotherFolderButton,Va);oa&&(oa.innerText=Va);J.tabIndex=0;J.setAttribute(Qh.a.Sd,Qh.a.zr)};Ld.prototype.Tvg=function(J){var oa=document.createElement("span");oa.id="anotherFolderText";oa.innerText=this.dOg;oa.className="AnotherFolderTextSpan";
J.appendChild(oa)};Ld.prototype.Nwg=function(J){var oa=document.createElement("span");oa.className="cui-img-cont-float cui-img-16by16 ";this.tpa=document.createElementNS("http://www.w3.org/2000/svg","svg");this.tpa.setAttribute("class","FolderIconSVG");var Va=document.createElementNS("http://www.w3.org/2000/svg","path");Va.setAttribute("d","M0,14V4L1.25,3h6.5L9.606,1H13.25L14,2V6h1.5L16,7.25,14.25,14H0ZM13,6V2H10L8.25,4,1.957,3.914,1,4.75V12L3.25,6.75l1-.75H13Z");this.tpa.appendChild(Va);oa.appendChild(this.tpa);
J.appendChild(oa)};Ld.prototype.Fyf=function(J){!J||J.keyCode!==eh.a.$h&&J.keyCode!==eh.a.L0||this.dzd(J)};Ld.prototype.dzd=function(){if(this.CI){var J=Jg.a.X3(kd.AFrameworkApplication.fileName),oa=this.CI.value;this.hide();oa&&""!==oa&&""!==J||1===this.sa.state?(""!==J&&(oa+=J),this.M7b(oa)?this.fs.create().displayError(1,oa,!1):this.lkb.start(oa,this.Nog)):this.fs.create().displayError(2,oa,!1)}};Ld.prototype.NRg=function(J){this.qy&&this.tpa&&(J?(this.qy.tabIndex=0,Sys.UI.DomElement.removeCssClass(this.qy,
"DisabledSaveAsButton"),Sys.UI.DomElement.removeCssClass(this.tpa,"DisabledFolderIconSVG")):(this.qy.tabIndex=-1,Sys.UI.DomElement.containsCssClass(this.qy,"DisabledSaveAsButton")||Sys.UI.DomElement.containsCssClass(this.tpa,"DisabledFolderIconSVG")||(Sys.UI.DomElement.addCssClass(this.qy,"DisabledSaveAsButton"),Sys.UI.DomElement.addCssClass(this.tpa,"DisabledFolderIconSVG"))))};Ld.prototype.ugd=function(){md.prototype.ugd.call(this);this.NRg(!!this.CI&&""!==this.CI.value)};Ld.prototype.dispose=function(){this.qy&&
(Ef.a.removeHandler(this.qy,If.a.click,Object(wf.a)(this,this.dzd,"onSaveToAnotherLocationClick")),Ef.a.removeHandler(this.qy,If.a.Rb,Object(wf.a)(this,this.Fyf,"onSaveToAnotherLocationKeyDown")),this.qy=null);md.prototype.dispose.call(this)};Object(Xe.a)(Ld,"FileNameDialog",md,[711]);var xi=b(805),Ca=b(574),ra=b(185),yb=b(1043);Object(Xe.a)(Bd,"SaveAsDialogInput",null,[]);Object(Xe.a)(bd,"SaveLocation",null,[]);var Hd=b(178);xc.prototype.tGh=function(){var J=new xi.a(Ca.a.Ik());J.ia("type","currentHost");
return Object.assign(new bd,{folderName:this.rv.breadcrumbFolderName,friendlyPath:this.rv.breadcrumbBrandName,properties:J})};xc.prototype.rfi=function(J){return!!J&&"ClassicMru"===J.type&&!!J.service_info&&!!J.service_info.service_id&&-1!==J.service_info.service_id.indexOf("SHAREPOINT")};xc.prototype.vRh=function(){if(!this.tKc||!this.BEa)return null;var J=this.tKc.value.Sy("SaveAsToSharePointDialog",!1);if(!J||3!==J.state||!J.nnf)return null;J=J.nnf;for(var oa=new ra.a,Va=0,Ub=0,e=0;e<J.length;e++){var C=
J[e];if(this.rfi(C)&&(Va++,C.sharepoint_info)){var M=C.url,qa=C.sharepoint_info.site_url,Na=C.title;C=yb.b(C,kd.AFrameworkApplication.isRtl);if(M&&qa&&Na&&C){Ub++;var Hb=new xi.a(Ca.a.Ik());Hb.ia("type","SharePoint");Hb.ia("siteUrl",qa);Hb.ia("folderUrl",M);Ub++;oa.add(Object.assign(new bd,{folderName:Na,friendlyPath:C,properties:Hb}))}}}e=new Map;e.set("NumPlaces",J.length.toString());e.set("NumSharepointPlaces",Va.toString());e.set("placesWithMetadata",Ub.toString());sg.Health.instance.recordKpiUsage("SharePointSaveAsDialogMru",
0,"smartfio",e);0<Va&&(Ub?.5>1*Ub/Va&&sg.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","PartialPlacesMetadataMissing",!1,!1,null):sg.Health.instance.recordKpiFailure("SharePointSaveAsDialogMru","AllPlacesMetadataMissing",!1,!1,null));return oa};xc.prototype.lHh=function(){var J=new ra.a;J.add(this.tGh());var oa=this.vRh();oa&&J.addRange(oa);return Object.assign(new Bd,{enableMoreLocations:!kd.AFrameworkApplication.ga.ra("HideSaveToAnotherFolderButtonforUIHost"),fileName:this.Oz,extension:Jg.a.X3(this.rv.tn),
saveLocations:J.toArray(),scenario:"SaveToSharePoint"})};xc.prototype.iHh=function(){return{inputPropsCallback:Object(wf.a)(this,this.lHh,"getDialogInput")}};xc.prototype.RP=function(J){this.Oz=J;this.Oz||(this.Oz=String.format(CommonUIStrings.l_SaveACopy_Filename,Jg.a.Vq(this.rv.tn)));J={};J=(J.id="SaveAsDialog",J.bodyControls=this.iHh(),J);var oa=CommonUIStrings.L_SaveAs;2===this.Ie.Pa.Lj&&(oa=CommonUIStrings.L_SaveACopy);var Va=new ff.a(!1,!1,!0);Va.kc=1;Va.Me="SaveAsDialog";Va.Cc(1,CommonUIStrings.l_SaveButtonLabel);
Va.initializeAndShow(oa,Object(wf.a)(this,this.Sbj,"saveAsDialogHandler"),J)};xc.prototype.Xsj=function(J,oa){J&&""!==J&&""!==oa||1===this.Ie.state?this.qfi()?this.yli(J,oa):(""!==oa&&(J+=oa),this.lkb.start(J,this.yh)):(td.ULS.sendTraceTag(579179796,216,10,"filename is empty but dialog should have handled this error case"),this.fs.create().displayError(2,J,!1))};xc.prototype.yli=function(J,oa){var Va=this;sg.Health.instance.recordKpiUsage("SaveACopySFP",0,"smartfio",null);var Ub=this.xWa.Z1c(CommonUIStrings.l_PickerSaveACopyOkButton,
CommonUIStrings.l_PickerSaveACopyTitle,!1,!0,null,"SaveACopy",2);this.xWa.u$b(Ub).then(function(e){if(e&&0<e.length){var C=e[0][jh.a.IQi];e=e[0][jh.a.cBd];if(""!==C&&""!==e)Va.BEa.pna(e,J+oa,C,Va.yh),sg.Health.instance.recordKpiSuccess("SaveACopySFP",null);else{Va.fs.create().displayError(0,J,!1);var M=Va.kq();M&&(M.set("SiteUrlAvailable",""===C?"false":"true"),M.set("FolderUrlAvailable",""===e?"false":"true"));sg.Health.instance.recordKpiFailure("SaveACopySFP","Not all values Available to start upload",
!1,!1,Object.assign(new Hd.a,{extendedProperties:M}))}}else Va.fs.create().displayError(0,J,!1),sg.Health.instance.recordKpiFailure("SaveACopySFP","Picker Data is unavaliable",!1,!1,null)}).catch(function(e){"Canceled"===e?((e=Va.kq())&&e.set("IsCanceled","true"),sg.Health.instance.recordKpiSuccess("SaveACopySFP",Object.assign(new Hd.a,{extendedProperties:e}))):sg.Health.instance.recordKpiFailure("SaveACopySFP",e,!1,!1,null)})};xc.prototype.qfi=function(){return this.xWa?this.xWa.qod()&&(kd.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSaveACopyPicker",
!1)||"SharePointOnlineConsumer"===kd.AFrameworkApplication.ga.Ua("FileSource")):(td.ULS.sendTraceTag(572343636,216,50,"_sharedFilePickerManager is null"),!1)};xc.prototype.kq=function(){try{return new Map}catch(J){return null}};xc.prototype.Sbj=function(J,oa){if(oa&&1===J){J=oa.fileName;var Va=Jg.a.X3(this.rv.tn);oa.moreLocationsSelected&&this.Xsj(J,Va);if(oa.locationCallback){var Ub=oa.locationCallback();Ub?Ub.properties&&"currentHost"===Ub.properties.na("type")?this.Yfa.pna(J+Va,!1,this.yh):Ub.properties&&
"SharePoint"===Ub.properties.na("type")?(oa=Ub.properties.na("siteUrl"),Ub=Ub.properties.na("folderUrl"),this.BEa.pna(Ub,J+Va,oa,this.yh)):td.ULS.sendTraceTag(579179799,216,10,"unknown location type sent back"):td.ULS.sendTraceTag(579179798,216,10,"selected location is empty")}else td.ULS.sendTraceTag(579179797,216,10,"locationCallback is empty")}};Object(Xe.a)(xc,"ReactSaveAsDialog",null,[711]);Hf.prototype.create=function(J){return this.Ie&&this.Ie.Pa.Lu?new xc(this.hde,this.fs,this.Yfa,kd.AFrameworkApplication.Zl,
this.Ie,this.ong,this.BEa,this.xWa,J):new Ld(this.ub,this.La,this.Ie,this.lX,this.fs,this.Yfa,this.hde,J)};Object(Xe.a)(Hf,"FileNameDialogFactory",null,[707]);tg.prototype.start=function(J){var oa=this;if(!this.qBf)if(kd.AFrameworkApplication.breadcrumbFolderUrl&&kd.AFrameworkApplication.breadcrumbFolderUrl.length)this.ijb=kd.AFrameworkApplication.breadcrumbFolderUrl;else return td.ULS.sendTraceTag(23881884,216,10,"CachedGetMoreInfoResult is null, can't get OneDrive for Bussiness page url. BreadcrumbFolderUrl is null. Get more info result is null: ",
!this.uo),!1;var Va=this.ipg();Va.qtj();var Ub=Va.gOh();if(!Ub)return td.ULS.sendTraceTag(24664067,216,10,"Picker container is null, will not show picker."),!1;this.ghb.start(function(e,C){Va.hide();J(e,C)},function(){oa.hxd(Va)},Ub,this.ijb);return!0};tg.prototype.hxd=function(J){J.hide();td.ULS.sendTraceTag(24664068,216,50,"User cancelled save to another folder.")};tg.prototype.BNh=function(J){J=J.toLowerCase();J.endsWith("/")||(J+="/");var oa=J.indexOf("/documents/");return-1!==oa?J.substring(0,
oa+1)+"_layouts/15/onedrive.aspx":""};tg.prototype.oub=function(J){this.uo||3!==J.state||(this.uo=J)};tl.Object.defineProperties(tg.prototype,{qBf:{configurable:!0,enumerable:!0,get:function(){this.ijb||(this.YCa.value.Sy("Save As",!0),this.uo&&this.uo.iR&&this.uo.iR.length&&(this.ijb=this.BNh(this.uo.iR)));return this.ijb}}});Object(Xe.a)(tg,"OneDriveFilePickerHelper",null,[706]);var ye=ff.a;vm(zf,ye);zf.prototype.qtj=function(){this.dFc="FilePickerDialog";this.xf="<div class='FilePickerDiv' id='FilePickerDiv'></div>";
this.Me="PickerDialog-MsoSp";this.showDialog("",null)};zf.prototype.gOh=function(){return document.getElementById("FilePickerDiv")};zf.prototype.WN=function(){};zf.prototype.bPa=function(){};Object(Xe.a)(zf,"PickerDialog",ff.a,[705]);var Cf=b(974),Bf=b(23);Wf.prototype.Mg=function(){var J=this,oa=this.ghb.P2a();oa?Bf.a.xA||this.ub.ra("SaveToSharePointOnDemandDownloadJsIsEnabled")?this.La.hf(Pg.a.saveToSharePoint,th.a.frame,Object(wf.a)(this,this.SRf,"saveToSharePointActionDispatcher"),64):(oa.U6a.continueWith(function(Va){Va.jg&&
J.ghb.tyd(Va)}),this.J_b()):td.ULS.sendTraceTag(25180162,216,15,"Failure with OneDrive API download as the js url is empty.")};Wf.prototype.J_b=function(){ke.a.mFd(Object(wf.a)(this,this.SRf,"saveToSharePointActionDispatcher"));ke.a.D6c([new Cf.a(Pg.a.saveToSharePoint,th.a.frame,0)],this.ghb.P2a())};Wf.prototype.SRf=function(J,oa,Va,Ub,e){return oa.contextId!==th.a.frame||J!==Pg.a.saveToSharePoint?2:this.h6a&&(this.hMc.qBf||this.Hte)?1===Va?Vg.SessionStatusManager.instance.svb||kd.AFrameworkApplication.O4?
8:this.Khg()?32:8:2===Va?(td.ULS.sendTraceTag(23881885,216,50,"User clicked on SaveToSharePoint button from "+(e&&e.SaveEntryPoint&&"VersionHistory"===e.SaveEntryPoint.toString()?"version history.":"the backstage.")),this.Hte?(td.ULS.sendTraceTag(24524226,216,50,"Show save a copy dialog."),this.lGc.create(e).RP(null)):(td.ULS.sendTraceTag(24524225,216,50,"No permission save to current folder, show Picker to save to another folder."),this.lkb.start(null,e)),32):8:8};tl.Object.defineProperties(Wf.prototype,
{h6a:{configurable:!0,enumerable:!0,get:function(){return this.ub.ra("SaveToAnotherFolderBrsIsEnabled")}},Hte:{configurable:!0,enumerable:!0,get:function(){return this.ub.ra("UserCanWriteRelative")}}});Object(Xe.a)(Wf,"SaveToSharePointActor",null,[]);bg.prototype.start=function(J,oa){var Va=this;td.ULS.sendTraceTag(25180163,216,50,"Try launch Picker.");this.d$d=J;this.yh=oa;this.hMc.start(function(Ub,e){Va.aVi(Ub,e)})||this.rPd()};bg.prototype.aVi=function(J,oa){if(J)this.onSuccess(oa);else this.O5(oa)};
bg.prototype.rPd=function(){1!==this.Ie.state&&this.fs().f5c(CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_OneDriveContactError)};bg.prototype.onSuccess=function(J){td.ULS.sendTraceTag(23881886,216,50,"Success Callback called. Calling UploadToSharePointManager to start upload.");if(J&&J.data&&J.data.value&&J.data.value.length&&J.data.value[0].sharePoint){var oa=J.data.value[0].sharePoint.url;J=J.data.value[0].sharePoint.listUrl;var Va=null;if(oa&&(Va=J?this.PRh(J):this.ORh(oa))){this.BEa.pna(oa,
this.d$d,Va,this.yh);return}td.ULS.sendTraceTag(25180164,216,10,"Picker return invalid data, folder url is null: {0}, siteUrl url is null: {1}.",!oa,!Va)}td.ULS.sendTraceTag(23881887,216,10,"Picker return invalid data or empty SharePoint url.");this.rPd()};bg.prototype.ORh=function(J){J.endsWith("/")||(J+="/");for(var oa=0,Va=0;Va<J.length;Va++)if("/"===J.charAt(Va)&&5===++oa)return J.substr(0,Va);return null};bg.prototype.PRh=function(J){J.endsWith("/")&&(J=J.substring(0,J.length-1));var oa=J.lastIndexOf("/");
return-1!==oa?J.substring(0,oa):null};bg.prototype.O5=function(J){td.ULS.sendTraceTag(23881888,216,10,"Picker failure Callback called.");J&&J.error?td.ULS.sendTraceTag(23881889,216,10,"File Dialog returned with error code:{0}, and error message: {1}.",J.error.errorCode,J.error.message):td.ULS.sendTraceTag(23881890,216,10,"File Dialog returned empty error.");this.rPd()};Object(Xe.a)(bg,"SaveToSharePointManager",null,[694]);mf.prototype.execute=function(J,oa){if(!kd.AFrameworkApplication.Gg&&kd.AFrameworkApplication.Hd){var Va=
this.HEa+this.Wea;Va=Kg.a.gl(Va,"fu",Jg.a.pf(this.j8));Va=Kg.a.gl(Va,"su",Jg.a.pf(this.Trg));Va=Kg.a.gl(Va,"fn",Jg.a.pf(this.Oz));Va=Kg.a.gl(Va,"n",Jg.a.pf((new Date).getTime().toString()));this.yh&&this.yh.FileDownloadUrl&&(Va=Kg.a.gl(Va,"furl",Jg.a.pf(this.yh.FileDownloadUrl)));Va=Va+"&"+this.kNc;this.JUa&&this.JUa.length?Va=Kg.a.gl(Va,"fnn",Jg.a.pf(this.JUa)):td.ULS.sendTraceTag(23881891,216,15,"No new file name in request.");td.ULS.sendTraceTag(23881920,216,50,"Trying send SharePointSaveAsHandler.ashx request.");
kd.AFrameworkApplication.Hd.Ul(Va,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,J,oa,null,void 0,void 0,void 0,void 0,"9")}};Object(Xe.a)(mf,"SharePointSaveAsCaller",null,[701]);Og.prototype.create=function(J,oa,Va,Ub){return new mf(this.IEa,this.Oz,J,oa,Va,kd.AFrameworkApplication.hj,this.Wea,Ub)};Object(Xe.a)(Og,"SharePointUploadCallerFactory",null,[693]);var ch=b(807);xf.prototype.pna=function(J,oa,Va,Ub){this.JCc=!1;td.ULS.sendTraceTag(23881921,216,50,"UploadToSharePointManager.StartUpload : Starting to upload file");
this.UJb();this.j8=J;Ub&&Ub.SaveEntryPoint&&(this.lOc=Ub.SaveEntryPoint);this.dCa=this.FQc.create(J,oa,Va,Ub);Ub&&"true"===Ub.SkipSaveToHost?this.$P():this.Rxh()};xf.prototype.Rxh=function(){function J(){td.ULS.sendTraceTag(23881923,216,15,"The file change is not saved successfully, this operation may lead to data loss.");oa.$P()}var oa=this;32!==this.La.ze(Pg.a.hQa,2,[function(){td.ULS.sendTraceTag(23881922,216,50,"Call the force save file change successfully.");oa.$P()},J])&&J()};xf.prototype.$P=
function(){td.ULS.sendTraceTag(23881924,216,50,"Send SharePointSaveAsHandler.ashx request.");this.dCa.execute(Object(wf.a)(this,this.IJi,"onSaveToSharePointUploadFinished"),Object(wf.a)(this,this.HJi,"onSaveToSharePointUploadFailed"))};xf.prototype.IJi=function(J){if(J&&J.data&&J.data.fe){var oa=Ch.d(J.data.fe);var Va=oa.uu;if(oa.returnValue)if(Va.StatusCode!==gh.a.sO&&Va.StatusCode!==gh.a.nqb)td.ULS.sendTraceTag(25235987,216,15,"UploadToSharePointManager upload failed with status: {0}, status code: {1}.",
J.data.status,Va.StatusCode),Va.StatusCode!==gh.a.QOf&&this.jGe(J.data.status)||(this.Rca(Va.StatusCode.toString()),this.Yrj(Va.StatusCode));else{td.ULS.sendTraceTag(23881927,216,50,"UploadToSharePointManager upload success.");this.XHd();try{Va.NewDocumentUrl?this.mPa(Va.NewDocumentUrl):this.nPa()}catch(Ub){td.ULS.sendTraceTag(37025729,216,15,"Redirect failed with exception: {0}",Ub.toString())}}else Va={},td.ULS.sendTraceTag(23881926,216,10,"Failed to deserialize : {0}",(Va.ResponseData=yi.a.Adb(J.data.fe),
Va)),this.m5b()||(this.Rca("Failed to deserialize response"),this.SJb())}else td.ULS.sendTraceTag(23881925,216,10,"Upload failure. Response data is null"),this.m5b()||(this.Rca("Unknown"),this.SJb())};xf.prototype.HJi=function(J){J&&J.data?this.jGe(J.data.status)||(td.ULS.sendTraceTag(23881929,216,10,"Upload failed."),this.Rca(ch.a[J.data.status]),this.SJb()):(td.ULS.sendTraceTag(23881928,216,10,"Upload failure. Response data is null"),this.m5b()||(this.Rca("Unknown"),this.SJb()))};xf.prototype.m5b=
function(){if(!this.JCc)return td.ULS.sendTraceTag(23881930,216,10,"Upload fail. Retrying."),this.JCc=!0,this.$P(),!0;td.ULS.sendTraceTag(23881931,216,10,"Upload fail. Already retry once but still fail.");return!1};xf.prototype.jGe=function(J){td.ULS.sendTraceTag(23881932,216,10,"HTTP failure with code: {0}",J);return this.m5b()};xf.prototype.nPa=function(){td.ULS.sendTraceTag(23881933,216,50,"Redirecting to Folder.");Rg.a.sf(this.j8,Rg.a.cX(3),void 0,"UploadToSharePointManager.RedirectToFolder")};
xf.prototype.mPa=function(J){var oa=!1,Va=!1;kd.AFrameworkApplication.ga&&(oa=kd.AFrameworkApplication.ga.ra("SaveACopyIsEnabledForUiHost"),Va=kd.AFrameworkApplication.ga.ra("UiHostSupportsDocRebootFeatures"));td.ULS.sendTraceTag(23881934,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",J,oa);if(oa&&Va){td.ULS.sendTraceTag(51245198,216,50,"UploadToSharePointManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var Ub={};Ub[jh.a.iPa]="1";Ub[jh.a.documentUrl]=J;Ub[jh.a.reason]=
Ki.a.saveAs;kd.AFrameworkApplication.OU().execute(function(e){e.Qj(Fg.a.dta,Ub)})}else Rg.a.sf(J,Rg.a.cX(3),void 0,"UploadToSharePointManager.RedirectToEditUrl")};xf.prototype.UJb=function(){this.Ie&&1===this.Ie.state||(this.um=this.Kjb(),this.um.message=CommonUIStrings.l_CommentProgressTooltip,this.um.kc=5,this.um.Gu=!1,this.um.eAa(CommonUIStrings.l_DefaultDialogTitle,null,null))};xf.prototype.PHa=function(){this.um&&(this.um.close(),this.um=null)};xf.prototype.SJb=function(){this.ri(CommonUIStrings.l_SaveFailedDialogTitle,
CommonUIStrings.l_FailToSaveFile)};xf.prototype.atj=function(){this.ri(CommonUIStrings.l_NoSavePermissionDialogTitle,CommonUIStrings.l_NoSavePermissionDialogMessage)};xf.prototype.dsj=function(){var J=String.format(CommonUIStrings.l_SaveAsFileTooLargeMessage,250);this.ri(CommonUIStrings.l_SaveAsFileTooLargeTitle,J,hd.a.Tbj)};xf.prototype.ri=function(J,oa,Va){Va=void 0===Va?hd.a.Xbj:Va;td.ULS.sendTraceTag(25180165,216,10,"Upload failure with title: {0}, message: {1}",J,oa);this.PHa();1!==this.Ie.state&&
this.fs().KFe(J,oa,Va)};xf.prototype.Yrj=function(J){td.ULS.sendTraceTag(25180166,216,50,"Upload fail with status code: {0}.",J);switch(J){case gh.a.d8f:this.atj();break;case gh.a.QOf:this.dsj();break;default:this.SJb()}};xf.prototype.XHd=function(){"VersionHistory"===this.lOc&&this.La.processAction(Pg.a.xrc,2)};xf.prototype.Rca=function(J){if("VersionHistory"===this.lOc){var oa={};this.La.ze(Pg.a.YHd,2,(oa.FailureReason=J,oa))}};Object(Xe.a)(xf,"UploadToSharePointManager",null,[556]);bf.prototype.init=
function(){};bf.prototype.dispose=function(){};bf.prototype.di=function(J){var oa=this;this.rb=J;this.FSb=la.a.Fq(J.mc("Common.IEventEmitter<Common.IGetMoreInfoResult>"));this.HSb=la.a.Fq(J.mc("Common.IEventEmitter<Common.IMruResult>"));kd.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SharedSaveACopyPicker",!1)||"SharePointOnlineConsumer"===kd.AFrameworkApplication.ga.Ua("FileSource")?(this.Kfa=la.a.Fq(J.mc("Common.App.SharedFilePicker.ISharedFilePicker")),nb.Task.WAA.call(null,
this.FSb,this.HSb,this.Kfa).continueWith(function(){oa.dKf()})):(this.Kfa=null,nb.Task.WAA.call(null,this.FSb,this.HSb).continueWith(function(){oa.dKf()}))};bf.prototype.dKf=function(){var J=this;this.rb.register(Og,"Common.App.SaveToSharePoint.SharePointUploadCallerFactory").as("Common.App.SaveToSharePoint.ISharePointUploadCallerFactory").Ic(function(){return new Og(kd.AFrameworkApplication.ga)}).zc();this.rb.register(xf,"Common.App.SaveToSharePoint.UploadToSharePointManager").as("Common.App.SaveToSharePoint.IUploadToSharePointManager").Ic(function(){return new xf(kd.AFrameworkApplication.Eb,
J.rb.resolve("Common.App.SaveToSharePoint.SharePointUploadCallerFactory"),function(){return(new yh.a).create()},function(){return new ef},kd.AFrameworkApplication.sa)}).zc();this.rb.register(bg,"Common.App.SaveToSharePoint.SaveToSharePointManager").as("Common.App.SaveToSharePoint.ISaveToSharePointManager").Ic(function(){return new bg(J.rb.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),function(){return new ef},J.rb.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),
kd.AFrameworkApplication.sa)}).zc();this.rb.register(tg,"Common.App.SaveToSharePoint.OneDriveFilePickerHelper").as("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper").Ic(function(){return new tg(J.rb.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),new mg.a(function(){return J.FSb.result}),kd.AFrameworkApplication.sa,function(){return new zf})}).zc();this.rb.register(Hf,"Common.App.SaveToSharePoint.FileNameDialogFactory").Ic(function(){return new Hf(kd.AFrameworkApplication.ga,
kd.AFrameworkApplication.Eb,kd.AFrameworkApplication.sa,kd.AFrameworkApplication.sa.Pa,J.rb.resolve("Common.App.SaveAsToHost.IErrorRetryDialogFactory"),J.rb.resolve("Common.App.SaveAsToHost.IUploadToHostManager"),J.rb.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),new mg.a(function(){return J.HSb.result}),J.rb.resolve("Common.App.SaveToSharePoint.UploadToSharePointManager"),J.Kfa?J.Kfa.result:null)}).zc();this.rb.register(Wf,"Common.App.SaveToSharePoint.SaveToSharePointActor").Ic(function(){return new Wf(kd.AFrameworkApplication.ga,
kd.AFrameworkApplication.Eb,J.rb.resolve("Common.App.SaveToSharePoint.FileNameDialogFactory"),J.rb.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager"),J.rb.resolve("Common.App.OneDriveFilePickerApi.OneDriveFilePickerApiManagerV72"),J.rb.resolve("Common.App.SaveToSharePoint.IOneDriveFilePickerHelper"),function(){return kd.AFrameworkApplication.sa.cQg})}).zc();kd.AFrameworkApplication.ga.ra("SaveToAnotherFolderBrsIsEnabled")&&this.rb.resolve("Common.App.SaveToSharePoint.SaveToSharePointActor").Mg()};
bf.main=function(){wg.a.instance.mj(new bf)};tl.Object.defineProperties(bf.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveToSharePoint"}}});Object(Xe.a)(bf,"PackageManager",null,[4,5]);var Tg=Wb.StandardDialog;vm(lf,Tg);lf.prototype.displayError=function(J){this.xz(J,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,null)};Object(Xe.a)(lf,"ErrorDialog",Wb.StandardDialog,[690]);te.default=0;Object(Xe.a)(te,"SaveToCloudErrorCodes",null,
[]);ze.prototype.start=function(J){this.yh=J;if("SharePointOnlineConsumer"===this.ub.Ua("FileSource")){var oa=ii.a.instance.resolve("Common.App.SaveToSharePoint.ISaveToSharePointManager");if(oa){oa.start(null,J);return}}this.D1.hLa?(td.ULS.sendTraceTag(6590559,216,50,"User is signed in. We will show file picker."),this.zPg()):(td.ULS.sendTraceTag(6590560,216,50,"User is not signed in. We will show sign in dialog."),this.showSignInDialog())};ze.prototype.showSignInDialog=function(){this.Mrg.create().RP()};
ze.prototype.ri=function(){this.fs().displayError(te.default)};ze.prototype.zPg=function(){try{td.ULS.sendTraceTag(6590561,216,50,"Initializing OneDrive API");var J={},oa=(J.client_id=this.ub.appSettings.UploadToSkyDriveClientId,J.env="INT",J);if(1===this.KOb||2===this.KOb)J={},oa=(J.client_id=this.ub.appSettings.UploadToSkyDriveClientId,J);J={};var Va=(J.mode="save",J.lightbox="grey",J);WL.init(oa);td.ULS.sendTraceTag(6590562,216,50,"OneDrive API is initialized. Launching file dialogue");WL.fileDialog(Va).then(Object(wf.a)(this,
this.onSuccess,"onSuccess"),Object(wf.a)(this,this.O5,"onFailure"))}catch(Ub){td.ULS.sendTraceTag(6590563,216,10,"OneDrive API Failure. [Exception:{0}] [Stack:{1}]",Ub,Ub.stack),this.ri()}};ze.prototype.onSuccess=function(J){td.ULS.sendTraceTag(6590592,216,50,"Success Callback called. Calling UploadToCloudManger to start upload.");J&&J.data&&J.data.folders&&this.dlb.pna(J.data.folders[0].id,J.data.folders[0].urls.viewInBrowser,null,this.yh)};ze.prototype.O5=function(J){if(J&&J.error){if("user_canceled"===
J.error.code){td.ULS.sendTraceTag(6590593,216,50,"User cancelled upload to their OneDrive.");return}td.ULS.sendTraceTag(6590594,216,50,"File Dialog returned with error code:{0}, and error message: {1}",J.error.code,J.error.message)}else td.ULS.sendTraceTag(6590595,216,50,"File Dialog returned with no response");this.ri()};Object(Xe.a)(ze,"SaveToCloudManager",null,[689]);yd.prototype.h6a=function(){return this.ub.ra("SaveToCloudStorageUIIsEnabled")};yd.prototype.yTe=function(){return Pg.a.saveToCloudStorage};
yd.prototype.J_b=function(){ke.a.mFd(Object(wf.a)(this,this.QRf,"saveToCloudActionDispatcher"));ke.a.D6c([new Cf.a(Pg.a.saveToCloudStorage,th.a.frame,0)],this.cae.P2a())};yd.prototype.Mg=function(){var J=this,oa=this.cae.P2a();oa?(oa.l9(function(){J.D8d.setResult(!0)}),this.J_b()):td.ULS.sendTraceTag(6590596,216,15,"Failure with OneDrive API download as the onedrive url received is empty ")};yd.prototype.pJf=function(){td.ULS.sendTraceTag(6590597,216,50,"User clicked on SaveToOneDrive button")};yd.prototype.QRf=
function(J,oa,Va,Ub,e){var C=this;return oa.contextId!==th.a.frame||J!==this.yTe()?2:this.h6a()?1===Va?Vg.SessionStatusManager.instance.svb||kd.AFrameworkApplication.O4?8:32:2===Va?(this.pJf(),e&&e.FileDownloadUrl&&td.ULS.sendTraceTag(50708835,216,50,"SaveToCloudStorageActor FileDownloadUrl is there"),this.uh&&(this.gUb=this.uh.Fc("DialogShown","SaveToOneDriveReponseTime")),this.D8d.task.continueWith(function(){C.gUb&&(C.gUb.stop(),C.gUb=null);C.Pqg.start(e)}),32):8:8};Object(Xe.a)(yd,"SaveToCloudStorageActor",
null,[577]);var fe=b(277),Ih=Wb.StandardDialog;vm(Kd,Ih);Kd.prototype.RP=function(){this.D1.zXa(Object(wf.a)(this,this.Gzf,"onSignIn"));this.Kk(CommonUIStrings.l_SignInToSaveDialogTitle,CommonUIStrings.l_SaveToCloudSignInDialog,0,Object(wf.a)(this,this.b6h,"inputHandler"))};Kd.prototype.b6h=function(J){J?this.b6():(td.ULS.sendTraceTag(6590598,216,50,"User dismissed SignIn Dialog."),this.hide())};Kd.prototype.kSg=function(){var J="2";if(this.lX)switch(this.lX.Lj){case 3:J="0";break;case 2:J="3";break;
case 1:J="1"}return J};Kd.prototype.hide=function(){this.D1.ZFb(Object(wf.a)(this,this.Gzf,"onSignIn"));Ih.prototype.hide.call(this)};Kd.prototype.b6=function(){var J=new fe.QueryStringBuilder("Signin.aspx");J.Ei("prompt","1");J.Ei("cbcxt",this.kSg());kd.AFrameworkApplication.Plb(J);Rg.a.sf(J.toString(),"LoginWindow",void 0,"SignInDialog")};Kd.prototype.Gzf=function(){this.Ks&&this.hide();td.ULS.sendTraceTag(7143885,216,50,"User signed in successfully. Calling Savetocloudstorage action handler");
this.La.processAction(Pg.a.saveToCloudStorage,2)};Object(Xe.a)(Kd,"SignInDialog",Wb.StandardDialog,[613]);dd.prototype.create=function(){return new Kd(this.La,this.D1,this.lX)};Object(Xe.a)(dd,"SignInDialogFactory",null,[576]);tc.prototype.execute=function(J,oa){if(!kd.AFrameworkApplication.Gg&&kd.AFrameworkApplication.Hd){var Va=this.HEa+this.Wea;Va=Kg.a.gl(Va,"fo",Jg.a.pf(this.VQb));Va=Kg.a.gl(Va,"fn",Jg.a.pf(this.Oz));Va=Kg.a.gl(Va,"qs",Jg.a.pf(this.kNc));Va=Kg.a.gl(Va,"n",Jg.a.pf((new Date).getTime().toString()));
this.yh&&this.yh.FileDownloadUrl&&(Va=Kg.a.gl(Va,"furl",Jg.a.pf(this.yh.FileDownloadUrl)));this.JUa&&(Va=Kg.a.gl(Va,"fnn",Jg.a.pf(this.JUa)));kd.AFrameworkApplication.Hd.Ul(Va,1,"",{"Content-Type":"application/json; charset=utf-8"},!1,2,J,oa,null)}};Object(Xe.a)(tc,"SkyDriveUploadCaller",null,[610]);qb.prototype.create=function(J,oa,Va){return new tc(this.IEa,this.Oz,oa,J,kd.AFrameworkApplication.hj,this.Wea,Va)};Object(Xe.a)(qb,"SkydriveUploadCallerFactory",null,[573]);Pa.prototype.UJb=function(){this.Ie&&
1===this.Ie.state||(this.um=this.Kjb(),this.um.message=CommonUIStrings.l_CommentProgressTooltip,this.um.kc=5,this.um.Gu=!1,this.um.eAa(CommonUIStrings.l_DefaultDialogTitle,null,null))};Pa.prototype.PHa=function(){this.um&&(this.um.close(),this.um=null)};Pa.prototype.JR=function(){1!==kd.AFrameworkApplication.sa.state&&this.fs().displayError(te.default)};Pa.prototype.nPa=function(){td.ULS.sendTraceTag(6590599,216,50,"Redirecting to OneDrive Folder.");Rg.a.sf(this.j8,Rg.a.cX(3),void 0,"UploadToCloudManager.RedirectToFolder")};
Pa.prototype.mPa=function(J){var oa=!1,Va=!1;kd.AFrameworkApplication.ga&&(oa=kd.AFrameworkApplication.ga.ra("SaveACopyIsEnabledForUiHost"),Va=kd.AFrameworkApplication.ga.ra("UiHostSupportsDocRebootFeatures"));td.ULS.sendTraceTag(6654163,216,50,"Redirecting to edit url {0}. IsEnabledForUiHost {1}",J,oa);if(oa&&Va){td.ULS.sendTraceTag(594929733,216,50,"UploadToCloudManager.RedirectToEditUrl: Sending DocumentRefresh post message.");var Ub={};Ub[jh.a.iPa]="1";Ub[jh.a.documentUrl]=J;kd.AFrameworkApplication.OU().execute(function(e){e.Qj(Fg.a.dta,
Ub)})}else Rg.a.sf(J,Rg.a.cX(3),void 0,"UploadToCloudManager.RedirectToEditUrl")};Pa.prototype.pna=function(J,oa,Va,Ub){Va=void 0===Va?null:Va;Ub=void 0===Ub?null:Ub;td.ULS.sendTraceTag(7143886,216,50,"Starting to upload file");this.uh&&(this.Xfa=this.uh.Fc("DialogShown","SaveToOneDriveUploadTime"));this.UJb();this.j8=oa;this.dCa=this.FQc.create(J,Va,Ub);this.yh=Ub;this.$P()};Pa.prototype.$P=function(){td.ULS.sendTraceTag(6590600,216,50,"Calling SkydriveUploadHandler.");this.dCa.execute(Object(wf.a)(this,
this.GJi,"onSaveToCloudUploadFinished"),Object(wf.a)(this,this.FJi,"onSaveToCloudUploadFailed"))};Pa.prototype.GJi=function(J){this.PHa();this.MCa=!1;if(J&&J.data&&J.data.fe){var oa=Ch.d(J.data.fe);var Va=oa.uu;if(oa.returnValue)if(Va.StatusCode!==gh.a.sO&&Va.StatusCode!==gh.a.nqb)td.ULS.sendTraceTag(6590602,216,10,"UploadToCloudManager upload failure. Response data is not JSON."),this.JR();else{td.ULS.sendTraceTag(6590603,216,50,"UploadToCloudManager upload success.");try{Va.NewDocumentUrl&&""!==
Va.NewDocumentUrl?this.mPa(Va.NewDocumentUrl):this.nPa()}catch(Ub){td.ULS.sendTraceTag(37025728,216,15,"Redirect failed with exception: {0}",Ub.toString())}this.bEb()}else Va={},td.ULS.sendTraceTag(7660114,216,10,"Failed to deserialize : {0}",(Va.ResponseData=yi.a.Adb(J.data.fe),Va)),this.JR()}else td.ULS.sendTraceTag(6590601,216,10,"UploadToCloudManager upload failure. Response data is null"),this.JR()};Pa.prototype.FJi=function(J){5!==J.data.status&&12!==J.data.status||this.MCa?(td.ULS.sendTraceTag(6590605,
216,10,"UploadToCloudManager HTTP failure with code: {0}",J.data.status),this.PHa(),this.JR(),this.bEb()):(td.ULS.sendTraceTag(6590604,216,10,"UploadToCloudManager failure. Retrying."),this.MCa=!0,this.$P())};Pa.prototype.bEb=function(){this.Xfa&&(this.Xfa.stop(),this.Xfa=null)};Object(Xe.a)(Pa,"UploadToCloudManager",null,[572]);mh.prototype.init=function(){kd.AFrameworkApplication.ga.ra("SaveToCloudStorageUIIsEnabled")&&this.rb.resolve("Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Mg()};
mh.prototype.dispose=function(){};mh.prototype.di=function(J){this.rb=J;this.rb.register(dd,"Common.App.SaveToCloudStorage.SignInDialogFactory").as("Common.App.SaveToCloudStorage.ISignInDialogFactory").Ic(function(){return new dd(kd.AFrameworkApplication.Eb,df.a.instance,kd.AFrameworkApplication.sa.Pa)}).zc();this.rb.register(qb,"Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory").as("Common.App.SaveToCloudStorage.ISkydriveUploadCallerFactory").Ic(function(){return new qb(kd.AFrameworkApplication.ga)}).zc();
this.rb.register(yd,"Common.App.SaveToCloudStorage.SaveToCloudStorageActor").Ic(function(){return new yd(J.resolve("Common.App.SaveToCloudStorage.SaveToCloudManager"),J.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),kd.AFrameworkApplication.ga,kd.AFrameworkApplication.sa.fD)}).zc();this.rb.register(Pa,"Common.App.SaveToCloudStorage.UploadToCloudManager").Ic(function(){return new Pa(J.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),function(){return(new yh.a).create()},
function(){return new lf},kd.AFrameworkApplication.sa,kd.AFrameworkApplication.sa.fD)}).zc();this.rb.register(ze,"Common.App.SaveToCloudStorage.SaveToCloudManager").Ic(function(){return new ze(J.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),df.a.instance,J.resolve("Common.App.SaveToCloudStorage.UploadToCloudManager"),kd.AFrameworkApplication.ga,kd.AFrameworkApplication.V0a,function(){return new lf})}).zc()};mh.main=function(){wg.a.instance.mj(new mh)};tl.Object.defineProperties(mh.prototype,
{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveToCloudStorage"}}});Object(Xe.a)(mh,"PackageManager",null,[4,5]);tl.Object.defineProperties(qf,{xf:{configurable:!0,enumerable:!0,get:function(){return ff.a.jj(qf.Tj,CommonUIStrings.l_SaveACopyFileName)}}});qf.Tj="<div class='WACDialogRow' id='DocumentFolderBlock'> <label id='lblFolderName' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRow' id='DocumentNameBlock'> <label id='lblFileName' class='WACDialogLabel' for='txtFileName' >{0}</label> <input type='text' id='txtFileName' class='WACDialogInput' autocomplete=\"off\"/> </div>";
Object(Xe.a)(qf,"FileNameDialogHtml",null,[]);var Th=ff.a;vm(Zg,Th);Zg.prototype.RP=function(J,oa,Va){this.VQb=J;this.j8=Va;J={};oa=(J.txtFileName=Jg.a.Vq(kd.AFrameworkApplication.Zl.tn),J.lblFolderName=String.format(CommonUIStrings.l_DestinationFolder,oa),J);this.initializeAndShow(CommonUIStrings.l_SaveToOneDrive,Object(wf.a)(this,this.L7b,"fileNameDialogHandler"),oa);td.ULS.sendTraceTag(7174148,216,50,"The file name dialog is initialized and shown.");document.getElementById("txtFileName").focus()};
Zg.prototype.L7b=function(J,oa){1!==J?td.ULS.sendTraceTag(7165650,216,50,"User click cancel to cancel upload file in file name dialog."):(J=oa.txtFileName.trim(),td.ULS.sendTraceTag(7165651,216,50,"User click save to upload file with new name."),oa=Jg.a.X3(kd.AFrameworkApplication.fileName),J&&""!==J&&""!==oa&&(J+=oa),this.dlb.pna(this.VQb,this.j8,J,this.yh))};Object(Xe.a)(Zg,"FileNameDialog",ff.a,[700]);qh.prototype.create=function(J){return new Zg(this.La,this.lX,this.dlb,J)};Object(Xe.a)(qh,"FileNameDialogFactory",
null,[692]);var h=Wb.StandardDialog;vm(Bg,h);Bg.prototype.displayError=function(J){td.ULS.sendTraceTag(7165652,216,50,"Show error dialog here {0}.",J);this.xz(J,CommonUIStrings.l_DefaultDialogTitle,CommonUIStrings.l_ErrorSavingToOneDrive,Object(wf.a)(this,this.cJd,"retryDialogHandler"))};Bg.prototype.cJd=function(J){1===J?(td.ULS.sendTraceTag(7165653,216,50,"User click to retry the action."),this.La.processAction(Pg.a.saveACopy,2)):td.ULS.sendTraceTag(7165654,216,50,"User cancel the error dialog.")};
Object(Xe.a)(Bg,"RetryDialog",Wb.StandardDialog,[690]);vm(hg,yd);hg.prototype.h6a=function(){return this.ub.ra("SaveACopyBrsIsEnabled")};hg.prototype.yTe=function(){return Pg.a.saveACopy};hg.prototype.J_b=function(){ke.a.mFd(Object(wf.a)(this,this.QRf,"saveToCloudActionDispatcher"));ke.a.D6c([new Cf.a(Pg.a.saveACopy,th.a.frame,0)],this.Gog.P2a())};hg.prototype.pJf=function(){td.ULS.sendTraceTag(7205456,216,50,"User clicked on SaveAs button from the backstage.")};Object(Xe.a)(hg,"SaveACopyActor",yd,
[]);vm(Ze,ze);Ze.prototype.onSuccess=function(J){J&&J.data&&J.data.folders?(td.ULS.sendTraceTag(7165655,216,50,"User selected which folder to upload file to."),this.fkg.create(this.yh).RP(J.data.folders[0].id,J.data.folders[0].name,J.data.folders[0].urls.viewInBrowser)):(td.ULS.sendTraceTag(7165656,216,10,"Fail to select folder to upload file."),this.ri())};Ze.prototype.O5=function(J){J&&J.error&&"user_canceled"===J.error.code&&td.ULS.sendTraceTag(7205457,216,50,"User cancelled upload to their OneDrive in Save A Copy.");
ze.prototype.O5.call(this,J)};Ze.prototype.ri=function(){td.ULS.sendTraceTag(7205458,216,50,"Error occur in Save A Copy Manager.");ze.prototype.ri.call(this)};Object(Xe.a)(Ze,"SaveACopyManager",ze,[]);vm(Re,Pa);Re.prototype.cod=function(){return!!this.yh&&!!this.yh.SaveEntryPoint&&"VersionHistory"===this.yh.SaveEntryPoint.toString()};Re.prototype.JR=function(){td.ULS.sendTraceTag(7205459,216,50,"Display Error for Save A Copy.");if(this.cod()){var J={};this.La.ze(Pg.a.YHd,2,(J.FailureReason="Unknown",
J))}Pa.prototype.JR.call(this)};Re.prototype.nPa=function(){td.ULS.sendTraceTag(7205460,216,50,"Redirecting to OneDrive Folder for Save A Copy.");this.cod()&&this.La.processAction(Pg.a.xrc,2);Pa.prototype.nPa.call(this)};Re.prototype.mPa=function(J){td.ULS.sendTraceTag(7205461,216,50,"Redirecting to edit url {0} for Save A Copy.",J);this.cod()&&this.La.processAction(Pg.a.xrc,2);Pa.prototype.mPa.call(this,J)};Re.prototype.$P=function(){var J=this;this.yh&&"true"===this.yh.SkipSaveToHost?Pa.prototype.$P.call(this):
32!==this.La.processAction(Pg.a.hQa,1)?(td.ULS.sendTraceTag(8741711,216,15,"The save file change is not supported, this operation may result in data loss"),Pa.prototype.$P.call(this)):this.La.ze(Pg.a.hQa,2,[function(){td.ULS.sendTraceTag(8741712,216,50,"Call the force save file change successfully.");Pa.prototype.$P.call(J)},function(){td.ULS.sendTraceTag(8741713,216,15,"The file change is not saved successfully, this operation may lead to data loss.");J.JR()}])};Object(Xe.a)(Re,"SaveACopyUploadToCloudManager",
Pa,[]);Rf.prototype.init=function(){kd.AFrameworkApplication.ga.$v(Object(wf.a)(this,this.QA,"onFullAppSettingsReady"))};Rf.prototype.QA=function(){kd.AFrameworkApplication.ga.ra("SaveACopyBrsIsEnabled")&&this.rb.resolve("Common.App.SaveACopy.SaveACopyActor").Mg()};Rf.prototype.dispose=function(){};Rf.prototype.di=function(J){this.rb=J;this.rb.register(Re,"Common.App.SaveACopy.SaveACopyUploadToCloudManager").Ic(function(){return new Re(kd.AFrameworkApplication.Eb,J.resolve("Common.App.SaveToCloudStorage.SkydriveUploadCallerFactory"),
function(){return(new yh.a).create()},function(){return new Bg(kd.AFrameworkApplication.Eb)},kd.AFrameworkApplication.sa,kd.AFrameworkApplication.sa.fD)}).zc();this.rb.register(qh,"Common.App.SaveACopy.FileNameDialogFactory").as("Common.App.SaveACopy.IFileNameDialogFactory").Ic(function(){return new qh(kd.AFrameworkApplication.Eb,kd.AFrameworkApplication.sa.Pa,J.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"))}).zc();this.rb.register(hg,"Common.App.SaveACopy.SaveACopyActor").Ic(function(){return new hg(J.resolve("Common.App.SaveACopy.SaveACopyManager"),
J.resolve("Common.App.OneDriveFilePickerApi.IOneDriveFilePickerApiManager"),kd.AFrameworkApplication.ga,kd.AFrameworkApplication.sa.fD)}).zc();this.rb.register(Ze,"Common.App.SaveACopy.SaveACopyManager").Ic(function(){return new Ze(J.resolve("Common.App.SaveACopy.FileNameDialogFactory"),J.resolve("Common.App.SaveToCloudStorage.SignInDialogFactory"),df.a.instance,J.resolve("Common.App.SaveACopy.SaveACopyUploadToCloudManager"),kd.AFrameworkApplication.ga,kd.AFrameworkApplication.V0a,function(){return new Bg(kd.AFrameworkApplication.Eb)})}).zc()};
Rf.main=function(){wg.a.instance.mj(new Rf)};tl.Object.defineProperties(Rf.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SaveACopy"}}});Object(Xe.a)(Rf,"PackageManager",null,[4,5]);var Bb;(function(J){J[J.myFiles=0]="myFiles";J[J.recent=1]="recent";J[J.currentFolder=2]="currentFolder";J[J.yourPhone=3]="yourPhone"})(Bb||(Bb={}));Object(Xe.b)("SharedFilePickerLandingLocation",Bb);be.prototype.R0a=function(J){this._initialized||(J.Qn(Fg.a.XIf),J.Km(Fg.a.XIf,Object(wf.a)(this,
this.NIi,"onReceivedPickerResponse")),this._initialized=!0)};be.prototype.u$b=function(J){var oa=this;return this.DKa=new Promise(function(Va,Ub){var e={};e[jh.a.HQi]=J;oa.a$a=function(C,M){""===M?(td.ULS.sendTraceTag(572548163,306,50,"Resolving Promise with Picker Data"),Va(C)):("Canceled"===M?td.ULS.sendTraceTag(572548164,306,50,M):td.ULS.sendTraceTag(556901065,306,10,M),Ub(M))};oa.aid.execute(function(C){oa.R0a(C);C.Qj(Fg.a.LNi,e)})})};be.prototype.NIi=function(J){this.a$a(J.Values[jh.a.vej],void 0===
J.Values[jh.a.bBd]||null===J.Values[jh.a.bBd]?"":J.Values[jh.a.bBd])};be.prototype.qod=function(){return kd.AFrameworkApplication.ga.ra("UiHostCommonFilePicker")};be.prototype.Z1c=function(J,oa,Va,Ub,e,C,M){var qa=void 0===qa?null:qa;var Na={};Na[jh.a.hej]=J;Na[jh.a.titleText]=oa;Na[jh.a.uEg]=Va;Na[jh.a.vEg]=Ub;Na[jh.a.wEg]=!1;Na[jh.a.kbh]=!0;Na[jh.a.muh]=e;Na[jh.a.KQi]=C;Na[jh.a.JQi]=Bb[M];lh.a("isSharedUXDarkModeOn")&&appChrome.api.isSharedUXDarkModeOn()&&(Na[jh.a.LQi]="Dark");qa&&(null!=qa.nUc&&
(Na[jh.a.nUc]=qa.nUc),null!=qa.ajd&&(Na[jh.a.ajd]=qa.ajd));return Na};Object(Xe.a)(be,"SharedFilePickerManager",null,[555]);Ff.prototype.di=function(J){this.rb=J;J.register(be,"Common.App.SharedFilePicker.SharedFilePickerManager").as("Common.App.SharedFilePicker.ISharedFilePicker").zc().Ic(function(){return new be(J.mc("Postmessage.IHostPostmessenger"))})};Ff.prototype.init=function(){var J=this;kd.AFrameworkApplication.ga.$v(function(){J.zwb()})};Ff.prototype.zwb=function(){this.rb.resolve("Common.App.SharedFilePicker.ISharedFilePicker")};
Ff.prototype.dispose=function(){};Ff.main=function(){wg.a.instance.mj(new Ff)};tl.Object.defineProperties(Ff.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.SharedFilePicker"}}});Object(Xe.a)(Ff,"SharedFilePickerPackage",null,[4,5]);var ic=b(1273),Nc=b(975);ng.prototype.Lie=function(J){var oa=!1;J&&(J.E1c(),J.ONg&&(oa=!1));return oa};ng.prototype.o0g=function(){var J=kd.AFrameworkApplication.sa.Pa;J=new ic.a(J.Lj,Nc.a.Tac(),!1,1===J.Kba);this.Lie(J)&&td.ULS.sendTraceTag(17571982,
306,50,"ChromeExtBannerDisplayed")};ng.prototype.e3b=function(J,oa,Va,Ub,e,C){J=new ic.a(J,Va,Ub,oa,e,C);this.Lie(J)&&td.ULS.sendTraceTag(9208407,306,50,"AppBusinessBarDisplayed")};ng.prototype.u6g=function(){var J=kd.AFrameworkApplication.sa.Pa,oa=kd.AFrameworkApplication.ga,Va=J.Lj,Ub=1===J.Kba;if(oa.ra(Nc.a.IUh(Va))){var e=Nc.a.Tac(),C=8<Bf.a.f4a;if(2!==Va||2!==e||!Ub){oa=oa.ra(Nc.a.JUh(Va));var M=J.qRf(),qa=function(){return J.NB};oa&&!Nc.a.Mmd(Nc.a.lbd(Va))&&this.e3b(Va,Ub,e,C,qa,M)}}};ng.prototype.init=
function(){var J=kd.AFrameworkApplication.ga,oa=J.ra("WildFireChromeExtensionEnabled");J=J.ra("WildFireChromeExtensionBar")&&oa;Nc.a.wvc&&J&&!Nc.a.Mmd(Nc.a.Ive)?this.o0g():(document.body&&Nc.a.Dqj&&this.u6g(),kd.AFrameworkApplication.Eb.$b(Pg.a.Tqd,th.a.frame,Object(wf.a)(this,this.Tqd,"launchWildFireBusinessBar")))};ng.prototype.Tqd=function(J,oa,Va,Ub,e){if(1===Va)return 32;if(!e)return 8;this.e3b(e.app,e.mode,e.platform,e.useTwoButton,null,null);return 32};ng.prototype.dispose=function(){};ng.prototype.di=
function(){};ng.main=function(){wg.a.instance.mj(new ng)};tl.Object.defineProperties(ng.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.WildFire"}}});Object(Xe.a)(ng,"PackageManager",null,[4,5]);var pd=b(216),xe=b(1258),Ue=pd.a;vm(Zf,Ue);Zf.prototype.create=function(){this.Fb(this.$.da.Aa(5)||new xe.a(this.$,!this.$.Daa))};Zf.ja=function(J){J.da.Ha(4,new Zf(J))};Object(Xe.a)(Zf,"BusinessBarManagerFactory",pd.a,[]);var qe=b(10),ja;"undefined"==typeof ja&&(ja={});window.MSOJS=
ja;ja.gfb=function(){function J(){return M()&&(We()||3<=(gd()?Gf("version/"):0))}function oa(){return 0<=window.navigator.userAgent.indexOf("Windows")}function Va(){return 0<=window.navigator.userAgent.indexOf("Windows Phone")}function Ub(){pl||(pl=!0,nl=e("Windows Phone"))}function e(Xf){Xf=(new RegExp(Xf+"\\s+(\\d+(\\.\\d*)?)")).exec(window.navigator.userAgent);var sh=-1;return null!=Xf&&2<=Xf.length&&(sh=parseFloat(Xf[1]),isNaN(sh)&&(sh=-1)),sh}function C(){return"function"==typeof navigator.msLaunchUri&&
!Va()&&!Wd()&&!qa()}function M(){return 0<=window.navigator.userAgent.indexOf("Macintosh")}function qa(){return 0<=window.navigator.userAgent.indexOf("Edge/")}function Na(){return 0<=window.navigator.userAgent.indexOf(" MSIE ")||0<=window.navigator.userAgent.indexOf("Trident/")}function Hb(){return Na()?8==window.document.documentMode:!1}function Gc(){return 0<=window.navigator.userAgent.indexOf(" Firefox/")}function gd(){return 0<=window.navigator.userAgent.indexOf(" AppleWebKit/")}function Uc(){return 0<=
window.navigator.userAgent.toLowerCase().indexOf("chrome")}function Wd(){var Xf=window.navigator.userAgent.toLowerCase();return 0<=Xf.indexOf("android")&&0<=Xf.indexOf("chrome")}function We(){return 3<=(Gc()?Gf("firefox/"):0)}function Gf(Xf){var sh=window.navigator.userAgent.toLowerCase(),di=sh.indexOf(Xf),Sh,Fi;return 0<=di?(Sh=di+Xf.length,Fi=sh.length,parseInt(sh.substring(Sh,Fi))):0}function xg(Xf,sh,di,Sh,Fi){if(Sh&&null!=sh)sh();else if(C())navigator.msLaunchUri(Xf,sh,di);else if(!(Uc()||0<=
window.navigator.userAgent.indexOf("iPhone")||0<=window.navigator.userAgent.indexOf("iPad")||0<navigator.maxTouchPoints&&M())||qa())Ig(Xf,sh,di);else if(Uc()&&Fi)a:{try{window.open(Xf,"_self")}catch(Si){null!=di&&di();break a}null!=sh&&sh()}else Hg(Xf,sh,di)}function Hg(Xf,sh,di){var Sh=document.getElementById("OICLinkTag"),Fi;null==Sh&&(Sh=document.createElement("a"),Sh.id="OICLinkTag",Sh.style.visibility="hidden",Sh.href="",Sh.target=0==(aj.Options&qk.SupportsTopTargetNavigation)||aj.NoBrowserModalDialogs?
"_blank":"_top",document.body.appendChild(Sh),null!=Sh.addEventListener&&Sh.addEventListener("click",function(Si){null!=Si.stopPropagation&&Si.stopPropagation()},!1));try{"undefined"==typeof MouseEvent&&(Fi=function(Si){var Li=document.createEvent("MouseEvent");return Li.initMouseEvent(Si,!1,!1,window,0,0,0,0,0,!1,!1,!1,!1,0,null),Li},Fi.prototype=Event.prototype,window.MouseEvent=Fi),Sh.href=Xf,Sh.dispatchEvent(new MouseEvent("click"))}catch(Si){null!=di&&di();return}null!=sh&&sh()}function Ig(Xf,
sh,di){var Sh=document.getElementById("OICFrame");null==Sh&&(Sh=document.createElement("iframe"),Sh.className="ObjectInDialog",Sh.style.visibility="hidden",Sh.src="about:blank",document.body.appendChild(Sh),Sh.id="OICFrame");try{Sh.contentWindow.location.href=Xf}catch(Fi){null!=di&&di();return}null!=sh&&sh()}function Hh(Xf){return 0!=(Xf.Options&qk.SkipProtocolHandler)||Hb()}function jj(Xf){return Xf===Yk.ReadOnly||Xf===Yk.ReadWrite}function Kj(Xf,sh,di,Sh){var Fi,Si;try{if(Fi=new ActiveXObject(Cc),
Fi)return Si=Fi.ViewDocument3(window.self,Xf,sh,Sh),Si?(Vk(Lk.O14ActiveX),ej.None):ej.Failed}catch(Li){}if(qk.O14Only===(di&qk.O14Only))return aj.DescriptiveUnattemptedEnums?ej.O14AttemptFailure:ej.Unattempted;try{if(Fi=new ActiveXObject(Vc),Fi)return Si=Fi.ViewDocument3(window.self,Xf,sh,Sh),Si?(Vk(Lk.O12ActiveX),ej.None):ej.Failed}catch(Li){}if(qk.O12UpOnly===(di&qk.O12UpOnly))return aj.DescriptiveUnattemptedEnums?ej.O12UpOnlyFail:ej.Unattempted;try{if(Fi=new ActiveXObject(qd),Fi)return Si=jj(sh)?
Fi.ViewDocument2(window.self,Xf,Sh):Fi.EditDocument2(window.self,Xf,Sh),Si?(Vk(Lk.O11ActiveX),ej.None):ej.Failed}catch(Li){}return aj.DescriptiveUnattemptedEnums?ej.ActiveXUnattempted:ej.Unattempted}function Qj(Xf,sh,di,Sh,Fi){var Si,Li,Uj;Xf==pj.Visio&&di==Yk.ReadWrite&&(di=Yk.WriteOnly);Xf=Fi;(Sh=Sh||Va()&&!(Ub(),8<=nl))||(Si="",Si+=jj(di)?Fh+Zh:ki,Si+=gj,Xf+=Sk(Si));Xf+=Sk(sh);aj.NewTelemetryDataIsEnabled&&(Li=-1!==Xf.indexOf("?")?"&":"?",Li+=aj.SessionOrigin?"OR=wac-"+aj.SessionOrigin+"&":"",
Li+=aj.ClickTime?"CT="+aj.ClickTime+"&":"",Li+=aj.CorrelationId?"CID="+aj.CorrelationId:"",Li="?"!=Li?Li:"",Li="&"!=Li.slice(-1)?Li:Li.slice(0,-1),Xf+=Sk(Li));sh=window.location.href;di=tk;Sh=sh.toLowerCase().indexOf("&"+di+"=");var wj;di=-1==Sh?void 0:(Uj=Sh+(di.length+2),wj=sh.indexOf("&",Uj),-1==wj)?sh.substr(Uj):sh.substring(Uj,wj);if(null!=di&&"undefined"!=typeof di){Uj="";try{Uj=decodeURIComponent(di)}catch(Mk){}0<Uj.length&&RegExp("(c|t)[\\w]{8}-[\\w]{4}-[\\w]{4}-[\\w]{4}-[\\w]{12}").test(Uj)&&
(Xf+=Ji,Xf+=Uj)}return Xf}function Jk(Xf,sh,di,Sh,Fi,Si){var Li=ll(Xf),Uj;return null==Li?(F(aj.DescriptiveUnattemptedEnums?ej.ProtocolHandlerIsNull:ej.Unattempted,aj.Application),!1):(Uj=Qj(Xf,sh,di,Sh,Li),xg(Uj,al,fl,Fi,Si),!0)}function Sk(Xf){if(M()&&Uc()){var sh="";try{sh=decodeURI(Xf)}catch(di){}if(sh==Xf)return encodeURI(Xf)}return Xf}function al(){Vk(Lk.ProtocolHandler)}function fl(){aj.Options|=qk.SkipProtocolHandler;ml(aj,ik,Kk)}function gl(){null!=Wk&&Wk(Lk.RoamingProtocolHandler)}function bl(){null!=
Xk&&Xk(ej.ControlNeeded)}function kl(){var Xf=document.getElementById(Qg),sh;if(null==Xf){if(sh=Gd,M()&&3<=(gd()?Gf("version/"):0)&&Uk(ve,!0)&&(sh=ve),!Uk(sh,!0))if(M()&&Uk(qg,!0))sh=qg;else return null;Xf=document.createElement("object");Xf.id=Qg;Xf.type=sh;Xf.style.width="0px";Xf.style.height="0px";Xf.style.setProperty("visibility","hidden","");document.body.appendChild(Xf);Xf=document.getElementById(Qg)}return Xf}function Uk(Xf,sh){var di=window.navigator.mimeTypes,Sh;return null==di?!1:(Sh=di[Xf],
Sh)?sh&&!Sh.enabledPlugin?!1:!0:!1}function hl(Xf){try{if(null!=new ActiveXObject(Xf))return!0}catch(sh){}return!1}function jl(Xf){switch(Xf){case pj.OneNote:return Nh;default:return""}}function ll(Xf){if(Xf!=pj.OneNote&&Va()&&!(Ub(),8<=nl))return"office:";switch(Xf){case pj.Excel:return"ms-excel:";case pj.OneNote:return"onenote:";case pj.PowerPoint:return"ms-powerpoint:";case pj.Visio:return"ms-visio:";case pj.Word:return"ms-word:";case pj.Project:return"ms-project:";case pj.Publisher:return"ms-publisher:";
case pj.Infopath:return"ms-infopath:";case pj.Access:return"ms-access:";default:return""}}function ol(Xf){switch(Xf){case pj.Excel:return"root\\office15\\excel.exe";case pj.PowerPoint:return"root\\office15\\powerpnt.exe";case pj.Visio:return"root\\office15\\visio.exe";case pj.Word:return"root\\office15\\winword.exe";case pj.Project:return"root\\office15\\winproj.exe";case pj.Publisher:return"root\\office15\\mspub.exe";case pj.Infopath:return"root\\office15\\infopath.exe";case pj.Access:return"root\\office15\\msaccess.exe";
default:return null}}function ml(Xf,sh,di){if(aj=Xf,ik=sh,Kk=di,Xf.DocumentUrl){var Sh=di=sh=Xf.DocumentUrl;try{Sh=decodeURIComponent(Xf.DocumentUrl)}catch(Mk){}try{di=encodeURI(Xf.DocumentUrl)}catch(Mk){}sh=sh+""+Xf.CorrelationIdForWinClient;Sh+=Xf.CorrelationIdForWinClient;di+=Xf.CorrelationIdForWinClient;Xf.Mode===Yk.ReadWrite&&qk.CheckoutRequired===(Xf.Options&qk.CheckoutRequired)&&(Xf.Mode=Yk.ForceCheckout);qk.HostIsEditOnly===(Xf.Options&qk.HostIsEditOnly)&&(Xf.Mode=Yk.WriteOnly);if(Hh(Xf)?
0:M()&&(Xf.Application==pj.OneNote||Uk(jf,!1)||Uk(gf,!1))||C()||Wd()||!(J()||We()||"ActiveXObject"in window&&!Va()||Uc())||15<=fa())Jk(Xf.Application,Xf.EncodeUrl?di:sh,Xf.Mode,Xf.Application==pj.OneNote,Xf.SilentExternalHandler,Xf.NavigateUsingWindowOpen);else{var Fi;if(Fi=Hb())a:{var Si=Xf.EncodeUrl?sh:Sh,Li=Xf.Mode,Uj=jl(Xf.Application);try{Fi=(new ActiveXObject(Ab)).ViewDocument3(window.self,Si,Li,Uj);break a}catch(Mk){}Fi=!1}if(Fi)Vk(Lk.O15ActiveX);else{if(J()||We()){var wj=Xf.EncodeUrl?sh:Sh;
Sh=Xf.Mode;Fi=jl(Xf.Application);Si=kl();if(null==Si)wj=aj.DescriptiveUnattemptedEnums?ej.PluginIsNull:ej.Unattempted;else{Li=!1;try{Li=Si.ViewDocument3(window.self,wj,Sh,Fi)}catch(Mk){}if(!Li)try{Li=jj(Sh)?Si.ViewDocument2(window.self,wj,Fi):Si.EditDocument2(window.self,wj,Fi)}catch(Mk){}wj=Li?(Vk(Lk.NpapiPlugin),ej.None):ej.Failed}}else{try{wj=new ActiveXObject(ph),null!=wj&&wj.SaveSSOCreds()}catch(Mk){}wj=Kj(Xf.EncodeUrl?sh:Sh,Xf.Mode,Xf.Options,jl(Xf.Application))}if(wj!=ej.None){if(Sh=Xf.CouldUseRoamingApps)ql||
(ql=!0,rl=e("Windows NT")),Sh=6.1<=rl&&!(0<=window.navigator.userAgent.indexOf("ARM;"))&&(Na()||We()||Uc());if(Sh&&Xf.Application!=pj.OneNote){if(!ja.gfb.BQj()){F(ej.ControlNeeded,aj.Application);return}if(Xf.RoamingAppsLauncher){"undefined"==typeof Xf.RoamingAppsLauncher||null==Xf.RoamingAppsLauncher?F(aj.DescriptiveUnattemptedEnums?ej.RoamingLauncherIsNull:ej.Unattempted,aj.Application):"undefined"==typeof Xf.RoamingBitsUrl||null==Xf.RoamingBitsUrl?ja.gfb.JQj(Xf.DocumentUrl,Xf.RoamingAppsLauncher,
Xf.Application,Xf.ApplicationParameters,ik,Kk):ja.gfb.Oeg(Xf.DocumentUrl,Xf.RoamingAppsLauncher,Xf.RoamingApplicationExe,Xf.ApplicationParameters,Xf.RoamingPlatform,Xf.RoamingBitsUrl,ik,Kk);return}if(!Xf.ContinueIfLauncherIsNull){F(ej.LauncherNeeded,aj.Application);return}}qk.NoProtocolHandlerFallback==(Xf.Options&qk.NoProtocolHandlerFallback)||Hh(Xf)||Na()||M()&&!(aj.DescriptiveUnattemptedEnums?wj>=ej.O14Unattempted&&wj<=ej.DocumentUrlIsNull:wj==ej.Unattempted)?F(wj,aj.Application):Jk(Xf.Application,
Xf.EncodeUrl?di:sh,Xf.Mode,Xf.Application==pj.OneNote,Xf.SilentExternalHandler,Xf.NavigateUsingWindowOpen)}}}}else F(aj.DescriptiveUnattemptedEnums?ej.DocumentUrlIsNull:ej.Unattempted,aj.Application)}function Vk(Xf){null!=ik&&ik(Xf)}function F(Xf,sh){"undefined"==typeof sh&&(sh=null);null!=Kk&&Kk(Xf,sh)}function fa(){var Xf=0;if(J()||We()||Uc()){var sh=kl();try{null!=sh&&(Xf=sh.GetOfficeVersion())}catch(di){}}else hl(Ab)?Xf=15:hl(Cc)?Xf=14:hl(Vc)?Xf=12:hl(qd)&&(Xf=11);return Xf}function Qa(){return M()&&
(Uk(Gd,!0)||Uk(ve,!0))}var Ab="SharePoint.OpenDocuments.5",Cc="SharePoint.OpenDocuments.4",Vc="SharePoint.OpenDocuments.3",qd="SharePoint.OpenDocuments.2",Gd="application/x-sharepoint",ve="application/x-sharepoint-webkit",jf="application/x-sharepoint-protocolhandler",gf="application/x-sharepoint-webkit-protocolhandler",qg="application/officelive",Qg="npSharePointPlugin",ph="IDBHO.IDBHOCtrl",Nh="OneNote.Notebook",Fh="ofv|",Zh="ofc|",ki="ofe|",gj="u|",Ji="|f|",tk="wdlor",Sj="",kk="",Tj="",ik,Kk,Wk,
Xk,aj,ql,rl,pl,nl,Yk={ReadWrite:0,ReadOnly:1,WriteOnly:2,ForceCheckout:3,WriteLocalCopy:4,OpenInBrowser:5},qk={None:0,CheckoutRequired:1,O14Only:2,HostIsEditOnly:4,O12UpOnly:8,SkipProtocolHandler:16,NoProtocolHandlerFallback:32,SupportsTopTargetNavigation:64},ej={None:0,Failed:1,Unattempted:2,LauncherNeeded:3,ControlNeeded:4,PopupBlocked:5,O14Unattempted:6,O12UpOnlyUnattempted:7,PluginIsNull:8,ActiveXUnattempted:9,ProtocolHandlerIsNull:10,ProtocolHandlerNoCallbackIsNull:11,RoamingLauncherIsNull:12,
DocumentUrlIsNull:13},Lk={Unknown:0,NpapiPlugin:1,O10ActiveX:2,O11ActiveX:3,O12ActiveX:4,O14ActiveX:5,ProtocolHandler:6,RoamingActiveX:7,RoamingFFExtension:8,RoamingProtocolHandler:9,O15ActiveX:10},pj={Unknown:0,Excel:1,OneNote:2,PowerPoint:3,Visio:4,Word:5,Project:6,Publisher:7,Infopath:8,Access:9};return{OpenDocumentMode:Yk,OpenDocumentOptions:qk,OpenDocumentFailureType:ej,OpenDocumentControl:Lk,OfficeApplication:pj,EditDocumentInClient:ml,EditDocumentInClientParams:function(){this.DocumentUrl=
"";this.Options=this.Mode=0;this.Application=pj.Unknown;this.CouldUseRoamingApps=!1;this.RoamingAppsLauncher="";this.ContinueIfLauncherIsNull=!1;this.RoamingBitsUrl=this.RoamingApplicationExe=this.RoamingPlatform=this.ApplicationParameters="";this.EncodeUrl=this.SilentExternalHandler=!1;this.CorrelationIdForWinClient="";this.NewTelemetryDataIsEnabled=this.NoBrowserModalDialogs=this.DescriptiveUnattemptedEnums=this.NavigateUsingWindowOpen=!1;this.SessionOrigin=this.ClickTime=this.CorrelationId=""},
OfficeVersionInstalled:fa,IsO14MacPluginInstalled:Qa,OfferOfficeInDialog:function(){return oa()&&11>=fa()},OfferOfficeNoIntrusive:function(){return oa()&&15>fa()},OfferMacOffice:function(){return M()&&!(0<=window.navigator.userAgent.indexOf("PPC Mac"))&&!Qa()},InstallRoamingControl:function(){Gc()?window.InstallTrigger.install({Office:{URL:kk}}):Ig(Tj,null,null)},CanUseRoamingControl:function(){var Xf,sh,di;if(C())return!0;if(Uc())return"undefined"!=typeof navigator.plugins.refresh&&navigator.plugins.refresh(!1),
!!navigator.mimeTypes["application/x-vnd.officeondemand"];if(Gc())return Xf=document.createElement("RoamingExtensionElement"),document.documentElement.appendChild(Xf),sh=document.createEvent("Events"),sh.initEvent("RoamingOfficeInstalled",!0,!1),Xf.dispatchEvent(sh),!!Xf.getAttribute("installed");if(Na())try{return di=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),di.HrExists()}catch(Sh){}return!1},InitUrls:function(Xf,sh,di){Sj=Xf;kk=di;Tj=sh},LaunchRoamingApps:function(Xf,sh,di,Sh,Fi,Si){ja.gfb.Oeg(Xf,
sh,ol(di),Sh,"x86",Sj,Fi,Si)},LaunchRoamingApps2:function(Xf,sh,di,Sh,Fi,Si,Li,Uj){var wj="",Mk;if(null!=Sh&&(wj+=" "+Sh),null!=Xf&&(wj+=' "'+Xf+'"'),C()||Uc())Wk=Li,Xk=Uj,Li='office: "'+(Si+'" "')+(di+'" "ROAMING"'),Li+=' "'+sh+'"',Li+=' "'+Fi+'"',Li+=" "+wj,xg(Li,gl,bl,!1,!1);else if(Gc())Xf=document.createElement("RoamingExtensionElement"),Xf.setAttribute("cabUrl",Si),Xf.setAttribute("app",di),Xf.setAttribute("licensingEntitlements",sh),Xf.setAttribute("platform",Fi),Xf.setAttribute("args",wj),
document.documentElement.appendChild(Xf),sh=document.createEvent("Events"),sh.initEvent("RoamingOfficeLaunch",!0,!1),Xf.dispatchEvent(sh),null!=Li&&Li(Lk.RoamingFFExtension);else if(Na()){if(Mk=new ActiveXObject("RoamingOfficeActiveX.RoamingOffice"),null!=Mk)try{Mk.HrConfigureSingle(Si,di,sh,Fi,wj),null!=Li&&Li(Lk.RoamingActiveX)}catch(sl){}}else null!=Uj&&Uj(ej.Failed)},ShouldShowDialog:function(){return!Va()},NavigateToUrlUsingClickingOnATag:Hg,OpenDocumentWithProtocolHandler:Jk,OpenDocumentWithProtocolHandlerNoCallBack:function(Xf,
sh,di,Sh){var Fi=ll(Xf),Si;return null==Fi?(F(aj.DescriptiveUnattemptedEnums?ej.ProtocolHandlerNoCallbackIsNull:ej.Unattempted,aj.Application),!1):(Si=Qj(Xf,sh,di,Sh,Fi),xg(Si,null,null,!1,!1),!0)}}}();ja.ClientUtils=ja.gfb;var Ka=b(817),qc=b(56),lc=b(35),Cd=b(175);Ng.prototype.Xc=function(){return!1};Ng.prototype.executeCommand=function(J,oa,Va){return 2!==this.Di.ze(Pg.a.newDocument,2,Va)?nb.Task.Ta(!0):Cd.a(oa.command)};Ng.prototype.Gc=function(J,oa){return 1056925771===oa.command};Ng.prototype.fd=
function(J,oa,Va){J=!0;switch(oa){case "PopulateNewMenu":this.Di&&this.Di.ze(Pg.a.hoc,2,Va);break;default:J=!1}return J};Object(Xe.a)(Ng,"CreateNewCommandHandler",null,[237]);var pc=Ka.a;vm(Ie,pc);Ie.prototype.Md=function(){var J=this,oa=qc.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.tb),Va=qc.GetServiceTaskFactory.create(this.$.da,165,this.ma,this.tb);lc.TaskExtensions.Ba(lc.TaskExtensions.ve([oa,Va],this.ma),function(){J.Ed([new Ng(kd.AFrameworkApplication.Eb)])},this.ma,3)};Ie.ja=function(J){Ka.a.de(87,
new Ie(J))};Object(Xe.a)(Ie,"CreateNewCommandHandlerFactory",Ka.a,[]);var K=b(1254),ha=b(878),H=b(308),aa=b(195),ea=b(281),ab=b(4),Vb=b(150),fc=b(96),Yc=b(78),Zd=b(73),oe=b(368),Ge=b(163),pf=b(57),Le=b(81),ug=b(317),ig=b(605);cg.prototype.Mpe=function(){};cg.prototype.m5c=function(){this.Log?Rg.a.downloadFile(this._url):Rg.a.sf(this._url,"_blank",void 0,"OpenUrlInTabDialogDownloadBehavior:DoDownload")};cg.prototype.dispose=function(){};Object(Xe.a)(cg,"OpenUrlInTabDialogDownloadBehavior",null,[529,
3]);var ih=b(275),$g=Wb.StandardDialog;vm(rg,$g);rg.prototype.wVc=function(){this.Rl&&(this.PUa||(this.PUa=Object(wf.a)(this,this.ryi,"onActionButtonClicked"),this.jy.pa(If.a.click,this.kB,this.PUa)),this.QUa||(this.QUa=Object(wf.a)(this,this.syi,"onActionButtonKeyUp"),this.he.pa(If.a.Vd,this.kB,this.QUa)));$g.prototype.wVc.call(this)};rg.prototype.ryi=function(J){this.oOe(J);return!0};rg.prototype.syi=function(J){return this.Kff(J,Object(wf.a)(this,this.oOe,"executeDismissActionButtonFromArgs"))};
rg.prototype.oOe=function(J){this.Rl&&this.Rl.submit();this.Lta(J.Sb)};rg.prototype.Nrd=function(){};rg.prototype.CGe=function(){this.Eif();this.Rl?this.Rl.submit():this.mQb.m5c();return!0};rg.prototype.Khc=function(){return!1};rg.prototype.dispose=function(){this.mQb.dispose();this.Kgb&&(kd.AFrameworkApplication.sa.OW.za(If.a.click,this.Kgb,Object(wf.a)(this,this.CGe,"downloadLinkClicked")),this.Kgb=null);this.DX&&(kd.AFrameworkApplication.sa.OW.za(If.a.click,this.DX,Object(wf.a)(this,this.Khc,"learnMoreLinkClicked")),
this.DX=null);this.jy&&this.PUa&&(this.jy.za(If.a.click,this.kB,this.PUa),this.PUa=null);this.he&&this.QUa&&(this.he.za(If.a.Vd,this.kB,this.QUa),this.QUa=null);$g.prototype.dispose.call(this)};rg.prototype.lIf=function(){this.Rl&&(document.body.appendChild(this.Rl),this.Rl.submit(),document.body.removeChild(this.Rl))};rg.prototype.Ov=function(J){1===J&&(this.Nrd(),this.Rl?rg.gy&&this.lIf():this.mQb.m5c());this.dispose()};tl.Object.defineProperties(rg.prototype,{D6e:{configurable:!0,enumerable:!0,
get:function(){return null}},eTd:{configurable:!0,enumerable:!0,get:function(){return null}},iNa:{configurable:!0,enumerable:!0,get:function(){return null}},Hzb:{configurable:!0,enumerable:!0,get:function(){return null}},N6a:{configurable:!0,enumerable:!0,get:function(){return null}},Bmf:{configurable:!0,enumerable:!0,get:function(){return!1}},buttonText:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_Open}},Y2c:{configurable:!0,enumerable:!0,get:function(){return null}},WTc:{configurable:!0,
enumerable:!0,get:function(){return null}},hme:{configurable:!0,enumerable:!0,get:function(){return null}}});tl.Object.defineProperties(rg,{gy:{configurable:!0,enumerable:!0,get:function(){return kd.AFrameworkApplication.sa.Pa.Lu&&kd.AFrameworkApplication.sa.Pa.Tcf}},Tvb:{configurable:!0,enumerable:!0,get:function(){return rg.W4d},set:function(J){rg.W4d=J}}});rg.W4d=!1;Object(Xe.a)(rg,"ADialogWithLinkToResource",Wb.StandardDialog,[]);var xh=b(410),vh=b(312),nf=b(14);vm(af,rg);af.prototype.Cif=function(){td.ULS.sendTraceTag(537162658,
0,50,"DownloadACopyAsOdsDialog.LogDialogDisplayed - ODS download dialog displayed")};af.prototype.Eif=function(){td.ULS.sendTraceTag(537162657,0,50,"DownloadACopyAsOdsDialog.LogDownloadLinkClicked - ODS download dialog link clicked")};af.prototype.Khc=function(){xh.Redirect.showHelp(vh.a.Nxi);return!0};tl.Object.defineProperties(af.prototype,{iNa:{configurable:!0,enumerable:!0,get:function(){return nf.a.instance.Va(410)}},Rhc:{configurable:!0,enumerable:!0,get:function(){return nf.a.instance.Va(411)}},
Qhc:{configurable:!0,enumerable:!0,get:function(){return"DownloadOdsLink"}},Hzb:{configurable:!0,enumerable:!0,get:function(){return"#"}},N6a:{configurable:!0,enumerable:!0,get:function(){return nf.a.instance.Va(412)}},Bmf:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(Xe.a)(af,"DownloadACopyAsOdsDialog",rg,[]);dg.prototype.Mpe=function(J){this.dialog=J};dg.prototype.m5c=function(){this.iyi.vBf(-1059172980)};dg.prototype.dispose=function(){this.Ab.bGb(this.Tsf)};Object(Xe.a)(dg,
"DownloadACopyAsOdsDialogDownloadBehavior",null,[529,3]);Object(Xe.a)(og,"MacroRecorderWorkbookCalculationModeSetPayload",null,[116]);Object(Xe.a)(gg,"MacroRecorderWorkbookRecalculatedPayload",null,[116]);var dh=b(207),Dh=b(117),Eg=b(1),ei=b(303);tl.Object.defineProperties(Df,{tNi:{configurable:!0,enumerable:!0,get:function(){return Df.sNi}}});Df.sNi="<div class='\"\"' id='OpenInAppDialog'> <div class='PrivacyDialogTitle UIFontDialogTitle' id='OpenInAppTitle'> <label id='OpenInAppTitle' class='\"\"' style='font-size:16pt' >{0}</label> </div> <div class='WACDialogRow' id='InfoMessageArea'> <label id='InfoMessageAreaLine1' class='\"\"' style='font-size:12pt' >{1}</label> <br/> </div> <br/> <div class='AppInstallButton' id='LinkToInstall' role='button' tabIndex='0'> <div class='clip32x32' id='BottomInfoIconClip' unselectable='on' style='display: inline-block; pointer-events:none;' role='img'> <img id='BottomIconInfo' class='{3}' role='presentation' src={2} /> </div> <div class='\"\"' id='AppstoreLink' style='display:inline-block; padding-top:4px; vertical-align:top;'> <label id='AppstoreLinkTitle' class='PrivacyDialogTitle' unselectable='on' style='font-size: 14pt; margin-left:8px' >{4}</label> </div> </div>";
Object(Xe.a)(Df,"OpenInAppDialogCopyHtml",null,[]);var Ti=b(369),Qi=ei.a;vm($e,Qi);$e.prototype.openUrl=function(J,oa){var Va=document.getElementById("link");Va||(Va=document.createElement("a"),Va.id="link",Va.style.visibility="hidden",Va.href="",document.body.appendChild(Va));Va.target=oa;Va.href=J;Va.click()};$e.prototype.$eg=function(){var J=this;td.ULS.sendTraceTag(529397968,306,50,"OpenInAppForLiveFiles API invoked");lc.TaskExtensions.Ba(qc.GetServiceTaskFactory.Xa(this.$.da,21,137,1),function(oa){var Va=
{};Va.OpenInAppUrl=J.DNa;Va.StoreUrl=J.Eq;oa.result.Qj("UI_OpenInMobileApp",Va)},this.$.ma)};$e.prototype.uNi=function(){td.ULS.sendTraceTag(529397967,306,100,"OpenInAppDialogHandler invoked")};$e.prototype.Kh=function(){this.xf=ff.a.jj(Df.tNi,nf.a.instance.ea(652),nf.a.instance.ea(653),kd.AFrameworkApplication.pC,Ti.getImageClass(kd.AFrameworkApplication.ga.Ua("AppIcon")),nf.a.instance.ea(654));this.Me="OpenInAppDialog";this.kc=5;this.initializeAndShow("",this.uNi.bind(this),null);this.uz(this.uH)};
$e.prototype.$u=function(J){Qi.prototype.$u.call(this,J);document.getElementById("WACDialogBodyPanel").style.padding="0 4px 0 24px";this.uH=document.getElementById("LinkToInstall");dh.a.instance.pa(If.a.click,this.uH,this.SBb);Dh.KeyInputManager.instance.pa(If.a.Vd,this.uH,this.tla)};$e.prototype.dispose=function(){this.uH&&(dh.a.instance.za(If.a.click,this.uH,this.SBb),Dh.KeyInputManager.instance.za(If.a.Vd,this.uH,this.tla),this.uH=null);Qi.prototype.dispose.call(this)};tl.Object.defineProperties($e.prototype,
{xc:{configurable:!0,enumerable:!0,get:function(){return"OpenInAppDialogCopy"}}});Object(Xe.a)($e,"OpenInAppDialogCopy",ei.a,[]);var hj=b(26),Ah=b(27),Ci=b(352),ni=b(8),T=b(273),Oa=b(20),Ib=b(39),hc=b(246),nd=b(458),Td=b(375),Ed=b(48),he=b(6),Pe=b(133),hf=b(1123),pg=b(79),fg=b(33),Xg=b(358),yg=b(248);me.prototype.iQ=function(J,oa){J=Ah.a.jd(12,1,655,0,0,0,"Blank");J.Description=String.format(nf.a.instance.ea(656),oa);return J};me.prototype.j9b=function(J){switch(J){case 1:case 2:return 0;default:return 2}};
Object(Xe.a)(me,"ReloadCloseConfirmation",null,[99]);var Rh=b(145),Kh=b(606),Yg=b(64),ji=aa.a;vm(Fd,ji);Fd.prototype.Xc=function(){return!1};Fd.prototype.executeCommand=function(J,oa,Va,Ub){var e=this,C=this.o5b,M=this.$,qa=oa.command,Na=this.openInExcelOperation,Hb=this.$.Ib,Gc=Va.SourceControlId;M.Mk.Jje(qa);J=null;switch(qa){case 1455037301:this.$.U4?Na.jze():Na.M0c();break;case -2044628748:case 2004484710:this.$.U4?Na.jze():Na.openInExcelClient();break;case 213236505:"ContextMenu.ShowOpenInAppDialogOnMobile"===
Gc?(this.fAb("CellLongPress"),td.ULS.sendTraceTag(576495705,0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from cell long press")):(this.fAb("PencilIcon"),td.ULS.sendTraceTag(576495704,0,50,"FileOperationsCommandHandler.ExecuteCommand: Open-in-app dialog invoked from pencil icon in toolbar"));this.showOpenInAppDialog();break;case -2028960985:Na.L1f();break;case -1059172980:new af(Na.mse(qa),new dg(Na,M.Ab));break;case -1285148982:this.clientWorkflow.nd.activityState[fg.a.TRc]=
!0;this.Cyc(!1);break;case -75280711:this.Cyc(!1);break;case -455164169:this.Cyc(!0);break;case -1388494670:this.$.da.Za(400,function(Hg){Hg.Qqi();e.Cyc(!1)});break;case 810888577:kd.AFrameworkApplication.qk=(new Date).getTime();td.ULS.sendTraceTag(537162656,0,50,"FileOperationsCommandHandler.ExecuteCommand: Set AccessTokenTtl to {0}",kd.AFrameworkApplication.qk);break;case -1804063550:case -974518828:oa=0;ab.a.Mzd in Va&&(oa=Va[ab.a.Mzd]);Na.vBf(qa,oa);break;case -1339961039:oa=!1;Va&&ab.a.WGb in
Va&&(oa=Va[ab.a.WGb]);this.reloadWorkbook(!1,oa);break;case -8805455:var gd=this.workbookContext;M.isEditMode||(Fd.Qwe(M),J=lc.TaskExtensions.Ba(this.FJ.value,function(Hg){Hg=Hg.result;var Ig=Hg.isEnabled();Ig&&ig.a(Hg,Fg.a.copyAndEdit,pf.a.Qf.rVe(),e.$.fa.ih.get(2))?td.ULS.sendTraceTag(537162655,0,50,"FileOperationsCommandHandler.ExecuteCommand: ReloadInEditMode ribbon command was procesed through SendMessageIfOptionSet()"):Ig&&kd.AFrameworkApplication.Cag?(Ig={},Ig[K.a.CCd]=kd.AFrameworkApplication.userSessionId,
Ig[kd.AFrameworkApplication.lti]=hj.a.Ra.Kb.getTime().toString(),td.ULS.sendTraceTag(537162654,0,50,"FileOperationsCommandHandler.ExecuteCommand: processing ReloadInEditMode ribbon command whike UseEditModePostMessage flag is ON"),Hg.Qj(Fg.a.editMode,Ig)):C.CopyAndEditUrl?e.KZg():(e.lc.supportsEditing||gd.EditUrl)&&e.reloadWorkbookInEditMode()},this.ma,3));break;case -723527778:M.isEditMode&&(Fd.Qwe(M),this.reloadWorkbookInViewMode());break;case 1783960667:case -1355155015:var Uc=M.qa.ta.Xb(),Wd=
-1355155015===qa?1:0,We=function(){return new gg(Wd)};J=oe.a(this.$.userOperationManager,function(Hg,Ig,Hh){return Le.U(M.qa.ta,Wd,null,Hg,Ig,Hh,null,Uc)},function(Hg){return new Ge.a(128,0,Hg,void 0,We)},oa);Oa.g(M).Bh.qG(!1);break;case -1158102843:J=Oa.g(M).Bh.recalcSheet(oa);Oa.g(M).Bh.qG(!1);break;case -988468372:if(Eg.EwaSettings.la(305))if(Ub=parseInt(Va[Yc.a.hd]),0<=Ub&&3>Ub)this.setCalculationMode(oa,Ub);else return td.ULS.sendTraceTag(537162652,0,10,"SetCalculationMode , unexpected menuItemId: {0}",
Va[Yc.a.hd]),Cd.a(qa);break;case 257398710:Vb.a.ntw(C.ReportAbuseUrl,M);break;case 1800405051:this.Zbj();break;case -48469327:this.saveACopy();break;case 214430355:oa=!1;Va&&ab.a.Y5c in Va&&(oa=Va[ab.a.Y5c]);if(!this.Mpj(oa,Va))break;kd.AFrameworkApplication.O4?this.businessBar.hg(40,null):this.businessBar.hg(oa?22:23,null);break;case 1389557314:J=lc.TaskExtensions.Ba(this.FJ.value,function(Hg){ig.a(Hg.result,Fg.a.nuh,null,e.$.fa.ih.get(6))||Vb.a.ntw(C.FileVersionUrl,M)},this.ma,3);break;case 2145659238:this.closeWorkbook();
break;case 1773624819:Gc===Hb+ab.a.Bff?Na.Mji():Na.Lji();break;case 512141517:Gc===Hb+ab.a.Aff?Na.Wji():Na.Vji();break;case -1224038235:var Gf=ha.a.On in Va?!Va[ha.a.On]:fc.j(M.fa.workbookContext.Options);Va[ha.a.Description]=Gf?nf.a.instance.ea(561):nf.a.instance.ea(562);J=oe.a(this.$.userOperationManager,function(Hg,Ig,Hh){var jj=e.$.qa.ta,Kj=jj.Oa(9,null);Kj.isReadOnlyRecommended=!Gf;return Le.i(jj,"SetReadOnlyRecommended",Kj,Hg,Ig,Hh,null,0)},function(Hg){return new Ge.a(129,0,Hg)},oa);break;
case 1118926154:if(this.$.isEditMode){var xg=new zb.a;this.$.da.Za(53,function(Hg){Hg?(Hg.Lm.Gji(e.$.Ib+ab.a.Epd),xg.setResult(!0)):td.ULS.sendTraceTag(537162649,0,50,"Ignoring RibbonCommand.LaunchFileMenuShortcut, the ribbonManager is null.")});J=xg.task}break;case -1698025133:Na.openInBrowser();break;case 520859864:J=lc.TaskExtensions.Ba(qc.GetServiceTaskFactory.Xa(this.$.da,393,394,Ub.gja()),function(Hg){Hg.result||td.ULS.sendTraceTag(537162648,0,10,"FileMenuCommandHandler::ExecuteCommand Failed to create SaveToHostManager")},
this.$.ma,3);break;default:J=Cd.a(qa)}return J||nb.Task.Ta(!0)};Fd.prototype.fAb=function(J){if(Eg.EwaSettings.isChangeGateEnabled("OfficeVSO:4859963_LogUsageKpiForOpenInAppDialog"))if(ni.HelperMethods.EZ){var oa=new Map;oa.set("EntryPoint",J);sg.Health.instance.recordKpiUsage(Td.a.rNi,0,nd.a.Vsi,oa)}else td.ULS.sendTraceTag(537162647,0,15,"FileOperationsCommandHandler.LogUsageKpiOpenInAppDialog: KPI Usage not supported")};Fd.prototype.showOpenInAppDialog=function(){kd.AFrameworkApplication.isMobileMode&&
(Eg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseOpenInAppDialogCopyMobile",!1)?(td.ULS.sendTraceTag(574993315,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: SD-side open-in-app dialog used"),(new $e(this.$)).Kh()):(td.ULS.sendTraceTag(574993314,0,50,"FileOperationsCommandHandler.ShowOpenInAppDialog: Git-side open-in-app dialog used"),kd.AFrameworkApplication.showOpenInAppDialog()))};Fd.prototype.Mpj=function(J,oa){var Va=this;return kd.AFrameworkApplication.isMobileMode&&
!Zd.a(this.$.ya,30)?(this.showOpenInAppDialog(),td.ULS.sendTraceTag(577300448,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: Open-in-app dialog invoked from cell double tap"),this.fAb("CellDoubleTap"),td.ULS.sendTraceTag(537162646,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view in mobile browser "),!1):kd.AFrameworkApplication.xfc&&(J&&Ci.c(this.workbookContext.WorkbookFileName)||!this.workbookContext.FullDocumentInfo.HostEditUrl)?
(td.ULS.sendTraceTag(537162645,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view a non-editable format .{0}, HostEditUrl {1}empty. Skipped prompt to edit",Ci.d(this.workbookContext.WorkbookFileName)?"xls":"csv",this.workbookContext.FullDocumentInfo.HostEditUrl?"not ":""),!1):H.a.any([25,26,30,31,55,32],function(Ub){return Va.businessBar.Y4a(Ub)})?(td.ULS.sendTraceTag(537162644,0,50,"FileOperationsCommandHandler.ShouldPromptEditInBrowser: User attempted to edit in reading view after opening in Edit by default"),
!1):oa&&ab.a.uVi in oa&&!J?!1:!0};Fd.prototype.Gc=function(J,oa){J=!1;switch(oa.command){case 1455037301:case -2044628748:case 2004484710:case -2028960985:case -974518828:case -1339961039:case -8805455:case -723527778:case 1783960667:case -1158102843:case -1355155015:case 257398710:case 214430355:case 1389557314:case 2145659238:case 1773624819:case 512141517:case 1118926154:case -1698025133:case 213236505:J=!0;break;case 520859864:J=Eg.EwaSettings.isChangeGateEnabled("OfficeVSO:3773098_SaveDeferredActionDispatcherEnabled")?
!0:!1;break;case -1285148982:case -75280711:case -455164169:J=Eg.EwaSettings.la(108);break;case -1388494670:J=Eg.EwaSettings.la(108);break;case 810888577:J=Eg.EwaSettings.la(272);break;case -1224038235:J=this.$.fa.amIAlone;break;case -988468372:J=Eg.EwaSettings.la(305);break;case -1804063550:case -1059172980:case 1800405051:case -48469327:J=!0,td.ULS.shipAssertTag(537162642,0,this.$.Yja,"Command execute requested for SaveAs or Copy operation when data duplication is disallowed.")}return J};Fd.prototype.fd=
function(){return!1};Fd.prototype.Zbj=function(){var J=this;if(this.oc){var oa=this.$;Ib.a(oa).Rs(new hc.a(he.a.Qy,5,function(){oa.KH(!1,!0);var Va=J.clientWorkflow.nd.activityState;Va[yg.a.Kq]=he.a.$ca;Va[Pe.a.aT]=2;Va[fg.a.rs]=oa.isEditMode;Va[Pe.a.dga]=!1}))}};Fd.prototype.saveACopy=function(){var J=this;if(this.oc){var oa=this.$;Ib.a(oa).Rs(new hc.a(he.a.Qy,5,function(){oa.KH(!1,!1);var Va=J.clientWorkflow.nd,Ub=Va.activityState;Ub[yg.a.Kq]=he.a.oRf;Ub[Kh.a.YWb]=J.lc.hasUnsupportedFeaturesForEdit;
Ub[Pe.a.dga]=!1;Va.ft(Ah.a.L$(J.businessBar.j6c,[-502303485]))}))}};Fd.prototype.Cyc=function(J){var oa=this;Ib.a(this.$).Rs(new hc.a(he.a.Hma,2,function(){oa.$.KH(!0,!0);var Va=Yg.a(oa.$).nd,Ub=oa.$.isEditMode;Ub=Ah.a.jd(1,1,0,0,0,Ub?-315732528:-2087635043,Ub?"DeploymentInvalidEditSession":"InvalidOrTimedOutSession");Ub.ForceVersionUpgrade=J;Va.ft([Ub]);Va=Yg.a(oa.$).nd.activityState;Va[yg.a.Kq]=he.a.Hma;Va[fg.a.rs]=oa.$.isEditMode;Va[Pe.a.dga]=!1}))};Fd.prototype.closeWorkbook=function(){var J=
this;if(this.oc){var oa=this.$;pf.a.Qf.Yuc("2145659238")?lc.TaskExtensions.Ba(this.FJ.value,function(Va){Va.result.Qj(Fg.a.MPe,{})},this.ma,3):Ib.a(oa).Rs(new hc.a(he.a.Qy,5,function(){oa.KH(!0,!1);var Va=J.clientWorkflow.nd.activityState;Va[Pe.a.XX]=!1;Va[Pe.a.dga]=!1;J.lc.inViewerFromWebPart?(ug.a.pDd(oa,J.clientWorkflow.nd),oa.Mk.ty("InViewerFromWebPart"),Va[yg.a.Kq]=he.a.f_):(Va[yg.a.Kq]=he.a.Ck,oa.Fd&32?Va[Pe.a.aT]=0:(Va[Pe.a.aT]=1,Va[Pe.a.NWb]=new hf.a),Va[Rh.a.gie]=!0)}))}};Fd.prototype.KZg=
function(){var J=this,oa=this.lc.vbaRemovedDuringConversion;td.ULS.sendTraceTag(537162636,0,50,"FileOperationsCommandHandler.CopyAndEditWorkbook: vbaRemovedDuringConversion = {0}",oa);var Va=this.$;oa?Ib.a(Va).Rs(new hc.a(he.a.Qy,5,function(){var Ub=Ah.a.jd(3,0,0,1219,0,1069271157,"XLSMacroFailure");J.clientWorkflow.nd.ft([Ub]);J.clientWorkflow.nd.activityState[yg.a.Kq]=he.a.pdb})):kd.AFrameworkApplication.hideHeader?ni.HelperMethods.sf(this.o5b.CopyAndEditUrl,"_blank",void 0,"FileOperationCommandHandler.CopyAndEditUrl"):
Vb.a.ntw(this.o5b.CopyAndEditUrl,Va)};Fd.prototype.reloadWorkbookInEditMode=function(){var J=this;if(this.oc)if(Eg.EwaSettings.isChangeGateEnabled("OfficeVSO:4585988_RefreshRibbonCookieOnModeRefresh")&&pf.a.Qf.nV&&pf.a.Qf.cFd(),kd.AFrameworkApplication.xfc&&!kd.AFrameworkApplication.ska)ni.HelperMethods.sf(this.$.Ynb(!0),ea.a.blank,void 0,"FileOperationCommandHandler.BuildHostUrl");else{var oa=this.$,Va=!1,Ub=this.lc.hasUnsupportedFeaturesForEdit,e=this.workbookContext.FileWasRepaired;Ci.d(this.workbookContext.WorkbookFileName)?
(Va=!0,td.ULS.sendTraceTag(537162634,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an XLS file, unsupported features = {0}",Ub)):Ci.a(this.workbookContext.WorkbookFileName)&&(Va=!0,td.ULS.sendTraceTag(537162633,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an CSV file"));var C=oa.ig.get(59);C=!(oa.fa.lc.supportsEditing&&C);if(Va&&!Ub||C&&(Va||Ub)){var M=C?Ub?-2066104278:816071846:Eg.EwaSettings.isChangeGateEnabled("OfficeVSO:4035916_RemoveConvertInTeams")&&
Zd.a(this.$.ya,25)&&!this.$.tyb?765011943:-213064907;Va=function(){var qa=Ah.a.XYa([M]);J.clientWorkflow.nd.ft(qa);J.clientWorkflow.nd.activityState[yg.a.Kq]=he.a.pdb}}else Va=function(){oa.KH(!0,!1);var qa=J.clientWorkflow.nd,Na=qa.activityState;Na[Pe.a.aT]=1;Na[Xg.a.SWb]=Ki.a.Cjc;Na[fg.a.rs]=!0;Na[Kh.a.YWb]=J.lc.hasUnsupportedFeaturesForEdit;Na[Pe.a.dga]=!!J.workbookContext.EditUrl;Na[pg.a.W1]=J.workbookContext.EditUrl;if(!J.o5b.CopyAndEditUrl){var Hb=[Eg.EwaSettings.isChangeGateEnabled("OfficeVSO:4035912_RemoveEditACopyInTeams")&&
Zd.a(J.$.ya,25)&&!J.$.tyb?-943219229:1821390342];qa.ft(Ah.a.L$(J.businessBar.j6c,Hb))}e&&!Ub?(Ci.b(J.workbookContext.WorkbookFileName)&&Eg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ConverterOdfFileRepairEnabled",!1)?(qa=Ah.a.XYa([-425642652]),td.ULS.sendTraceTag(537162631,0,50,"FileOperationsCommandHandler.ReloadWorkbookInEditMode: working on an .ods file")):qa=Ah.a.XYa([108482388]),J.clientWorkflow.nd.ft(qa),Na[yg.a.Kq]=he.a.DRf):J.$.fa.B4e?(td.ULS.sendTraceTag(546111811,0,50,"Password-To-Modify Workbook: User trying to switch to edit-mode."),
Ed.b().RQd("DialogShown","Password-To-Modify Workbook: Logging StopWatch duration after user tries to switch to exclusive edit-session","PasswordToModifyDialogShown"),Na[yg.a.Kq]=he.a.UDb):Na[yg.a.Kq]=J.$.fa.gfc?he.a.Lzb:he.a.pdb};Ib.a(oa).Rs(new hc.a(he.a.Qy,5,Va))}};Fd.prototype.reloadWorkbookInViewMode=function(){var J=this;if(this.oc){Eg.EwaSettings.isChangeGateEnabled("OfficeVSO:4585988_RefreshRibbonCookieOnModeRefresh")&&pf.a.Qf.nV&&pf.a.Qf.cFd();var oa=this.$;Bf.a.Xg&&Oa.g(oa).Kc.textBox.blur();
Ib.a(oa).Rs(new hc.a(he.a.Qy,5,function(){oa.KH(!oa.fa.isNamedObjectViewMode,!1);var Va=J.clientWorkflow.nd.activityState;Va[yg.a.Kq]=he.a.oha;Va[Pe.a.aT]=1;Va[Pe.a.XX]=!0;Va[fg.a.rs]=!1;Va[fg.a.Jlb]=!0;Va[Xg.a.SWb]=Ki.a.Cjc}))}};Fd.prototype.reloadWorkbook=function(J,oa){var Va=this;if(this.oc){var Ub=this.$;Ub.gM&65536&&Ib.a(Ub).Rs(new hc.a(he.a.Qy,5,function(){Ub.KH(J,!0);var e=Va.clientWorkflow.nd.activityState;e[yg.a.Kq]=he.a.Dk;e[fg.a.WRc]=Va.workbookContext.NovMode;oa||(e[Pe.a.aT]=1,e[Pe.a.NWb]=
new me)}))}};Fd.prototype.setCalculationMode=function(J,oa){function Va(){return new og(oa)}var Ub=this;td.ULS.sendTraceTag(537162629,0,50,"SetCalculationMode ,calculation mode chosen : {0} ",oa);var e=this.$.fa.workbookContext.CalcMode;this.$.fa.workbookContext.CalcMode=oa;return oe.a(this.$.userOperationManager,function(C,M,qa){var Na=Ub.$.qa.ta;C=T.b(C,Fd.eKi(Ub.$,e));M=T.a(M,Fd.dKi(Ub.$,e));var Hb=Na.Oa(9,null);Hb.calc_type=oa;return Le.i(Na,"SetCalculationOptions",Hb,C,M,qa,null,0)},function(C){return new Ge.a(197,
0,C,void 0,Va)},J)};Fd.Qwe=function(J){J.Ab&&0<J.Ab.eR&&J.Ab.E8c(function(oa){oa.ou()})};Fd.eKi=function(J,oa){return function(Va){Ah.a.hh(Va.Errors)&&(J.fa.workbookContext.CalcMode=oa,td.ULS.sendTraceTag(537162628,0,50,"OnSetCalcModeSucess: successCallback was called with errors for SetCalculationMode. reverting calc mode to {0}.  Error id names: {1}",oa,Ah.a.Uc(Va.Errors)))}};Fd.dKi=function(J,oa){return function(){J.fa.workbookContext.CalcMode=oa;td.ULS.sendTraceTag(537162627,0,50,"OnSetCalcModeFailure: failedCallback was called for SetCalculationMode. reverting calc mode to {0})",
oa)}};tl.Object.defineProperties(Fd.prototype,{oc:{configurable:!0,enumerable:!0,get:function(){return this.$.fa.oc}},workbookContext:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext}},o5b:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.FullDocumentInfo}},clientWorkflow:{configurable:!0,enumerable:!0,get:function(){return Yg.a(this.$)}},lc:{configurable:!0,enumerable:!0,get:function(){return this.$.lc}}});Object(Xe.a)(Fd,"FileOperationsCommandHandler",
aa.a,[237]);var Di=b(147),Ei=Ka.a;vm(ud,Ei);ud.prototype.Md=function(){var J=this,oa=this.$,Va=[],Ub=qc.GetServiceTaskFactory.create(oa.da,56,this.ma,this.tb);Va.push(Ub);var e=qc.GetServiceTaskFactory.Xa(oa.da,5,4,this.tb);Va.push(e);lc.TaskExtensions.Ba(nb.Task.WAA.apply(null,Va),function(){Di.b(Ub)&&J.Ed([new Fd(oa,Ub.result,new mg.a(function(){return qc.GetServiceTaskFactory.create(oa.da,137,J.ma,J.tb)}),e.result)])},this.ma,0)};ud.ja=function(J){Ka.a.de(94,new ud(J))};Object(Xe.a)(ud,"FileOperationsCommandHandlerFactory",
Ka.a,[]);var rh=b(43),Sd;(function(J){J[J.url=0]="url";J[J.ref=1]="ref";J[J.mailto=2]="mailto"})(Sd||(Sd={}));Object(Xe.b)("HyperlinkSelectionState",Sd);var Bj=b(900),Sf=b(9),X=b(603),ua=b(82),vb=Bj.a;vm(Zc,vb);Zc.prototype.PXe=function(J,oa){switch(oa){case 2:return J.startsWith("mailto:")?J:"mailto:"+J;case 1:return String.format("{0}{1}",Sf.a.qEf,this.LLh(J));default:return J}};Zc.prototype.Uw=function(){var J=this,oa=this.$;this.location=this.PXe(this.vvd,this.uvd);try{this.location=ua.a.ym(this.location)}catch(e){td.ULS.sendTraceTag(537157643,
0,15,"Decoding link text failed")}td.ULS.sendTraceTag(555755667,0,50,"Committing {0} link",Sd[this.uvd]);this.cellValue=this.tvd.length?this.tvd:this.vvd;oa.Xu();var Va=oa.qa.ta.Xb(),Ub=rh.s(this.selectedRange);return function(e,C,M){return Le.c(oa.qa.ta,Ub,J.cellValue,J.location,J.removeHyperLink,!1,123,e,C,M,J.yL.range,Va)}};Zc.prototype.Wl=function(){var J=this,oa=rh.s(this.selectedRange);return function(){return new X.a(oa,J.cellValue,J.location)}};Zc.prototype.Ush=function(){var J=this.yL.cell.e4a;
this.yL.cell.tvb?J&&J.startsWith("mailto:")?(this.Flb=2,J=J.substr(7)):this.Flb=0:this.Flb=1;return J};Zc.prototype.QKa=function(){Eg.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")?this.uxb=this.yL.waa:this.uxb=!!this.yL.GJa(64)||!!this.yL.GJa(128)};Zc.prototype.lm=function(){if(this.uxb){this.r0a=this.yL.text;var J=this.Ush();J&&(this.JRc=J);this.Xn=nf.a.instance.ea(807);this.Jpb=this.JRc===this.r0a}else this.yL.text?(this.r0a=this.yL.text,this.Jpb=!1):(this.r0a="",this.Jpb=!0),
this.Flb=0,this.Xn=nf.a.instance.ea(806);this.yL.MJ&&(this.Jpb=!1,this.jFe=!0,Eg.EwaSettings.isChangeGateEnabled("OfficeVSO:5533269_formulaTextFixInHyperLink")&&(this.r0a=this.yL.formulaBarText))};Zc.prototype.tui=function(J){return this.fa.xb.tj(J)};Zc.prototype.lWe=function(J,oa){return J?null:nf.a.instance.ea(oa)};Zc.prototype.LLh=function(J){var oa=rh.Z(J,this.fa.xa);var Va=oa.sheetName;var Ub=oa.range;oa.returnValue&&Ub&&(J=rh.x(Ub,Va||this.sheetName,!1));return J};tl.Object.defineProperties(Zc.prototype,
{xc:{configurable:!0,enumerable:!0,get:function(){return"HyperLinkDialog"}},Cw:{configurable:!0,enumerable:!0,get:function(){return 526}}});Zc.sNj="validateLinkValues";Zc.lKg="bodyProps";Zc.Fah="disableDisplayText";Zc.vbh="displayTextValue";Zc.gvg="activeLinkOption";Zc.hvg="activeLinkValue";Zc.RZg="copyLinkValueToDisplay";Zc.Jki="linkValue";Zc.tej="selectedLink";Zc.ubh="displayText";Object(Xe.a)(Zc,"HyperlinkDialog",Bj.a,[]);jc.prototype.Xc=function(){return!1};jc.prototype.Gc=function(J,oa){return 1===
J&&-1583422759===oa.command};jc.prototype.fd=function(){return!1};jc.prototype.executeCommand=function(){this.Dsj();return nb.Task.Ta(!0)};jc.prototype.Dsj=function(){var J=rh.v(this.gridView.ha.va.Qd,this.$),oa=Oa.e(this.gridView);(!Eg.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.xs([this.gridView.ha.va.Qd],!0))&&oa&&new Zc(this.$,J,oa)};Object(Xe.a)(jc,"ShowHyperlinkCommandHandler",null,[237]);var Rb=Ka.a;vm(we,Rb);we.prototype.Md=
function(){this.Ed([new jc(this.$,Oa.g(this.$))])};we.ja=function(J){Ka.a.de(105,new we(J))};Object(Xe.a)(we,"ShowHyperlinkCommandHandlerFactory",Ka.a,[]);var Fc=b(19),kc=b(1143);le.create="Create";le.activate="Activate";le.close="Close";le.remove="Delete";le.duplicate="Duplicate";Object(Xe.a)(le,"Actions",null,[]);var Id=nb.Task;vm($c,Id);$c.prototype.fL=function(){this.mYd=Ah.a.jd(3,2,0,1615,0,-1244327602,"MsFormDeleteConfirmation");this.ej=Ib.a(this.wf.$).ri(this.mYd).G();this.ej.isCompleted||
(this._state=2,this.ej.cN(this.moveNext));return this.vBc};$c.prototype.vBc=function(){this.oYd=this.ej.Sy();this.oYd||(this.wf.$.workbookContext.Options=ni.HelperMethods.QN(!1,this.wf.$.workbookContext.Options,2048),this.wf.deleteMsFormMetaDataSheet());this._state=3;this.DQa(!0)};$c.prototype.dispose=function(){};Object(Xe.a)($c,"$$sm_Microsoft$Office$Excel$WebUI$Client$MsForm$MsFormCommandHandler$DeleteMsForm",nb.Task,[3]);Sc.action="Action";Sc.Ewh="FlexPane";Sc.I8b="formId";Sc.id="id";Sc.title=
"Title";Sc.sNb="XlWorkbookId";Sc.Eyh="Fragment";Sc.host="Host";Sc.xDj="TopView";Sc.R1="auth_pvr";Object(Xe.a)(Sc,"Parameters",null,[]);mc.prototype.Xc=function(J,oa){switch(oa){case -105284469:return!fc.i(this.$.kg)||this.hasMsForm;case -1219864912:case 1674421386:case -1128532220:case 2023601781:return!this.hasMsForm}return!1};mc.prototype.executeCommand=function(J,oa){J=lc.TaskExtensions.om();oa=oa.command;switch(oa){case -105284469:this.insertMsForm();break;case -1219864912:this.previewMsForm();
break;case -1128532220:this.editMsForm();break;case 1674421386:this.sendMsForm();break;case 2023601781:J=this.deleteMsForm();break;default:J=Cd.a(oa)}return J};mc.prototype.Gc=function(J,oa){if(!this.$.fa.ih.get(61))return!1;J=!1;switch(oa.command){case -105284469:J=fc.i(this.$.kg)&&!this.hasMsForm;break;case -1219864912:case 1674421386:case -1128532220:case 2023601781:J=this.hasMsForm}return J};mc.prototype.fd=function(){return!1};mc.prototype.insertMsForm=function(){var J=Jg.a.Vq(this.$.workbookContext.FullDocumentInfo.BreadcrumbDocName),
oa={},Va={};oa[Sc.action]=le.create;oa[Sc.R1]=this.R1;Va[Sc.action]=le.create;Va[Sc.sNb]=encodeURIComponent(this.oNb);Va[Sc.host]=this.Zn;Va[Sc.title]=encodeURIComponent(J);this.yAb(oa,Va);this.$.workbookContext.Options=ni.HelperMethods.QN(!1,this.$.workbookContext.Options,2048)};mc.prototype.editMsForm=function(){var J={},oa={};J[Sc.R1]=this.R1;oa[Sc.I8b]=this.Pjc;oa[Sc.sNb]=encodeURIComponent(this.oNb);oa[Sc.host]=this.Zn;this.yAb(J,oa)};mc.prototype.previewMsForm=function(){var J={},oa={};J[Sc.R1]=
this.R1;oa[Sc.I8b]=this.Pjc;oa[Sc.sNb]=encodeURIComponent(this.oNb);oa[Sc.host]=this.Zn;oa[Sc.xDj]="Preview";this.yAb(J,oa)};mc.prototype.sendMsForm=function(){var J={},oa={};J[Sc.R1]=this.R1;oa[Sc.I8b]=this.Pjc;oa[Sc.Ewh]="SendForm";oa[Sc.sNb]=encodeURIComponent(this.oNb);oa[Sc.host]=this.Zn;this.yAb(J,oa)};mc.prototype.deleteMsForm=function(){return new $c(this)};mc.prototype.deleteMsFormMetaDataSheet=function(){var J=this;this.$.userOperationManager.tt(new Ge.a(158,0,function(oa,Va,Ub){return Oc(J.$.qa.gw,
J.yU.Usb,T.b(oa,function(){J.C9g()}),Va,Ub,null)}))};mc.prototype.C9g=function(){var J={},oa={};J[Sc.action]=le.remove;J[Sc.R1]=this.R1;oa[Sc.action]=le.remove;oa[Sc.host]=this.Zn;oa[Sc.I8b]=encodeURIComponent(this.Pjc);oa[Sc.sNb]=encodeURIComponent(this.oNb);this.yAb(J,oa)};mc.prototype.yAb=function(J,oa){var Va=this.$.ya.MsFormBaseUrl+"/Pages/DesignPage.aspx",Ub="",e="";if(oa){for(var C in oa){var M=C,qa=oa[C];e+=e.length?"&":"";e+=M+"="+qa}J||(J={});J[Sc.Eyh]=encodeURIComponent(e)}if(J)for(var Na in J)oa=
Na,e=J[Na],Ub+=Ub.length?"&":"?",Ub+=oa+"="+e;window.open(Va+Ub,"_blank")};tl.Object.defineProperties(mc.prototype,{hasMsForm:{configurable:!0,enumerable:!0,get:function(){return fc.c(this.$.kg)}},Pjc:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.MsFormId}},oNb:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.MsFormDocUrl}},R1:{configurable:!0,enumerable:!0,get:function(){return Fc.a.contains(this.$.ku.DocumentHostInfo.FileSource,"onedrive",
!0)?"MSA":"OrgId"}}});Object(Xe.a)(mc,"MsFormCommandHandler",null,[237]);var ie=Ka.a;vm(cb,ie);cb.prototype.Md=function(){var J=this,oa=qc.GetServiceTaskFactory.create(this.$.da,203,this.ma,this.tb);lc.TaskExtensions.Ba(lc.TaskExtensions.ve([oa],this.ma),function(){J.Ed([new mc(J.$)])},this.ma,3)};cb.ja=function(J){J.fa.ih.get(61)&&Ka.a.de(215,new cb(J))};Object(Xe.a)(cb,"MsFormCommandHandlerFactory",Ka.a,[]);var Ve=pd.a;vm(Ae,Ve);Ae.prototype.create=function(){var J=this;lc.TaskExtensions.Ba(qc.GetServiceTaskFactory.create(this.$.da,
164,this.ma,this.tb),function(){J.Fb(new Rd)},this.ma,3)};Object(Xe.a)(Ae,"NewAndOpenUXFactory",pd.a,[]);Bc.prototype.executeCommand=function(J,oa,Va){J=2;switch(oa.command){case Pg.a.openUrlInNewTab:J=this.Di.ze(Pg.a.openUrlInNewTab,2,Va);break;case Pg.a.jOa:J=this.Di.ze(Pg.a.jOa,2,Va)}return 2!==J?nb.Task.Ta(!0):Cd.a(oa.command)};Bc.prototype.Gc=function(J,oa){return oa.command===Pg.a.openUrlInNewTab||oa.command===Pg.a.jOa};Bc.prototype.fd=function(J,oa,Va){return"PopulateMruMenu"===oa?(this.Di.ze(Pg.a.goc,
2,Va),!0):!1};Bc.prototype.Xc=function(){return!1};Object(Xe.a)(Bc,"OpenFromMruCommandHandler",null,[237]);var Dg=Ka.a;vm(Jc,Dg);Jc.prototype.Md=function(){var J=this,oa=qc.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.tb),Va=qc.GetServiceTaskFactory.create(this.$.da,165,this.ma,this.tb);lc.TaskExtensions.Ba(lc.TaskExtensions.ve([oa,Va],this.ma),function(){J.Ed([new Bc(J.$,kd.AFrameworkApplication.Eb)])},this.ma,3)};Jc.ja=function(J){Ka.a.de(88,new Jc(J))};Object(Xe.a)(Jc,"OpenFromMruCommandHandlerFactory",
Ka.a,[]);var Mg=b(88),Ug=b(84),$d=b(242),Se=b(667),Ri=b(1087),xj=$d.a;vm(se,xj);se.prototype.execute=function(J){var oa=Object(Ug.a)(8,J.Ge);if(!oa.Yja)return td.ULS.sendTraceTag(537154818,0,50,"DownloadAForkedCopyActivity.Execute: blocking Download action as the workbook is protected"),this.rkd(J),this.oh(he.a.idle),1;this.nAb||(this.nAb=new Ri.DownloadACopyOperation(this.Jic,oa));this.nAb.$ch();td.ULS.shipAssertTag(537154817,0,3!==Yg.a(oa).ui.ut,"The current activity should not be closed.");return 1};
se.prototype.rkd=function(J){var oa=Object(Ug.a)(8,J.Ge),Va=new Se.a(oa);this.subscribe(J,this.Wyd,function(Ub){Va.add_disposing(Ub)});td.ULS.sendTraceTag(50954707,0,50,"DownloadAForkedCopyActivity.ProtectedFileDataLeakErrorDialog: showing alert dialog to user");Va.initialize();Va.mf()};se.prototype.dispose=function(){Mg.a.Fa(this.nAb);this.nAb=null;xj.prototype.dispose.call(this)};Object(Xe.a)(se,"DownloadAForkedCopyActivity",$d.a,[]);var kg=pd.a;vm(vd,kg);vd.prototype.create=function(){var J=this;
lc.TaskExtensions.Ba(qc.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.tb),function(){J.Fb(new se(he.a.x0a,he.a.Ck,!0))},this.ma)};Object(Xe.a)(vd,"DownloadACopyPreDatalossActivityFactory",pd.a,[]);var Cj=pd.a;vm(fd,Cj);fd.prototype.create=function(){var J=this;lc.TaskExtensions.Ba(qc.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.tb),function(){J.Fb(new se(he.a.unmergeableDownloadCopy,he.a.Rna))},this.ma)};Object(Xe.a)(fd,"DownloadAForkedCopyActivityFactory",pd.a,[]);gc.prototype.Mg=
function(){this.La.$b(Pg.a.tryMacOffice,th.a.frame,Object(wf.a)(this,this.YLi,"onTryMacOffice"));this.La.$b(Pg.a.A7f,th.a.frame,Object(wf.a)(this,this.OAf,"onTryMacOfficeFromViewer"));this.La.$b(Pg.a.z7f,th.a.frame,Object(wf.a)(this,this.OAf,"onTryMacOfficeFromViewer"))};gc.prototype.YLi=function(J,oa,Va,Ub,e){if(1===Va)return 32;e?(J=e.SourceControlId,"btnjTryMacOfficeForWordEditor"===J?Rg.a.sf(Kg.a.jZ(12),"_blank",void 0,"MacOfficeOffer.TriggerFromWordEditor"):"PptJewel.About.TryMacOffice"===J&&
Rg.a.sf(Kg.a.jZ(22),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTEditor")):this.$gf();return 32};gc.prototype.OAf=function(J,oa,Va){if(1===Va)return 32;switch(J){case Pg.a.A7f:Rg.a.sf(Kg.a.jZ(15),"_blank",void 0,"MacOfficeOffer.TriggerFromWordViewer");break;case Pg.a.z7f:Rg.a.sf(Kg.a.jZ(25),"_blank",void 0,"MacOfficeOffer.TriggerFromPPTViewer")}return 32};gc.prototype.$gf=function(){var J=void 0===J?null:J;var oa=0;J&&(oa=J);Rg.a.sf(2===oa?"https://go.microsoft.com/fwlink/?LinkId=331579":gc.Qpi,
"_blank",void 0,"LaunchMacTrialWindow")};tl.Object.defineProperties(gc.prototype,{jvc:{configurable:!0,enumerable:!0,get:function(){return this.Amg&&Bf.a.isMac&&!Bf.a.ydi&&!MSOJS.ClientUtils.IsO14MacPluginInstalled()}},Dpj:{configurable:!0,enumerable:!0,get:function(){return this.jvc}}});tl.Object.defineProperties(gc,{Qpi:{configurable:!0,enumerable:!0,get:function(){return Kg.a.NG("522401")}}});Object(Xe.a)(gc,"MacOfficeOffer",null,[193]);ne.prototype.Mg=function(){this.La.$b(Pg.a.tryOffice,th.a.frame,
Object(wf.a)(this,this.ZLi,"onTryOffice"));this.La.$b(Pg.a.tryOfficeThroughTellMe,th.a.frame,Object(wf.a)(this,this.tryOfficeThroughTellMe,"tryOfficeThroughTellMe"));this.La.$b(Pg.a.D7f,th.a.frame,Object(wf.a)(this,this.E7f,"tryOfficeThroughViewer"));this.La.$b(Pg.a.C7f,th.a.frame,Object(wf.a)(this,this.E7f,"tryOfficeThroughViewer"))};ne.prototype.ZLi=function(J,oa,Va,Ub,e){if(this.RVb&&1===Va)return this.isFreemiumUpsellEnabled&&this.oJb?32:8;2===Va&&(e?(J=e.SourceControlId,"btnjTryOfficeForWordEditor"===
J?Rg.a.sf(Kg.a.jZ(11),"_blank",void 0,"OfficeTrial.TriggerFromWordEditor"):"PptJewel.About.TryOffice"===J?Rg.a.sf(Kg.a.jZ(21),"_blank",void 0,"OfficeTrial.TriggerFromPPTViewer"):this.Ihc()):this.Ihc());return 32};ne.prototype.tryOfficeThroughTellMe=function(J,oa,Va,Ub,e){if(this.RVb&&1===Va)return this.isFreemiumUpsellEnabled&&this.oJb?32:8;2===Va&&(e?(J=e.SourceControlId,Rg.a.sf(Kg.a.NG("862405")+this.ZNh(J),"_blank",void 0,"TryOfficeThroughTellMe.WithSourceControlId")):Rg.a.sf(Kg.a.NG("522402"),
"_blank",void 0,"TryOfficeThroughTellMe.Legacy"));return 32};ne.prototype.E7f=function(J,oa,Va){if(this.RVb&&1===Va)return this.isFreemiumUpsellEnabled&&this.oJb?32:8;if(2===Va)switch(J){case Pg.a.D7f:Rg.a.sf(Kg.a.jZ(14),"_blank",void 0,"TryOfficeThroughViewer.Word");break;case Pg.a.C7f:Rg.a.sf(Kg.a.jZ(24),"_blank",void 0,"TryOfficeThroughViewer.PPT")}return 32};ne.prototype.Ihc=function(J){J=void 0===J?null:J;var oa=0;J&&(oa=J);Rg.a.sf(ne.MLh(oa),"_blank",void 0,"LaunchOfficeOffer")};ne.prototype.ZNh=
function(J){var oa=0;switch(J){case "jbtnTryOfficeThroughTellMeForWordTrackChanges":oa=1;break;case "jbtnTryOfficeThroughTellMeForWordShapes":oa=2;break;case "jbtnTryOfficeThroughTellMeForWordLabel":oa=3;break;case "jbtnTryOfficeThroughTellMeForWordCitations":oa=4;break;case "jbtnTryOfficeThroughTellMeForWordTextBox":oa=5;break;case "jbtnTryOfficeThroughTellMeForWordTableOfContent":oa=6;break;case "jbtnTryOfficeThroughTellMeForWordSmartArt":oa=7;break;case "jbtnTryOfficeThroughTellMeForWordWordArt":oa=
8;break;case "jbtnTryOfficeThroughTellMeForWordMultiColumnLayout":oa=9;break;case "jbtnTryOfficeThroughTellMeForWordEquation":oa=10;break;case "jbtnTryOfficeThroughTellMeForPPTGroupShapes":oa=16;break;case "jbtnTryOfficeThroughTellMeForPPTWordArt":oa=17;break;case "jbtnTryOfficeThroughTellMeForPPTSpellCheckDict":oa=18;break;case "jbtnTryOfficeThroughTellMeForPPTInsertAudio":oa=19;break;case "jbtnTryOfficeThroughTellMeForPPTInsertChart":oa=20;break;case "TellMe.TryOfficeThroughTellMeForXLSSpellCheck":oa=
26;break;case "TellMe.TryOfficeThroughTellMeForXLSMacros":oa=27;break;case "TellMe.TryOfficeThroughTellMeForXLSPivotTable":oa=28;break;case "TellMe.TryOfficeThroughTellMeForXLSHeaderFooter":oa=29}return oa?String.format("&pc={0:D}",oa):""};ne.MLh=function(J){if(Bf.a.Xg)switch(J){case 1:return Kg.a.NG("393806");case 2:return Kg.a.NG("393810");case 3:return Kg.a.NG("393809");case 5:return Kg.a.NG("393805")}else if(Bf.a.Ip)switch(J){case 1:return Kg.a.NG("521979");case 3:return Kg.a.NG("521980");case 5:return Kg.a.NG("521978");
case 2:return Kg.a.NG("522490")}else{if(2===J)return Kg.a.NG("517778");if(1===J)return Kg.a.jZ(30)}return Kg.a.NG("522402")};tl.Object.defineProperties(ne.prototype,{Jpf:{configurable:!0,enumerable:!0,get:function(){return this.oJb}},Pxi:{configurable:!0,enumerable:!0,get:function(){return this.oJb&&MSOJS.ClientUtils.OfferOfficeInDialog()}},oJb:{configurable:!0,enumerable:!0,get:function(){return this.Dmg&&!Bf.a.isMac}},isFreemiumUpsellEnabled:{configurable:!0,enumerable:!0,get:function(){var J=!1;
this.aDc&&(J=this.aDc.isFreemiumUpsellEnabled());return J}}});Object(Xe.a)(ne,"OfficeTrialExperience",null,[192]);De.prototype.di=function(J){J.register(ne,"Common.App.OpenInClient.OfficeTrialExperience").as("Common.IOfficeTrialExperience").zc().Ic(function(){return new ne(kd.AFrameworkApplication.Eb,kd.AFrameworkApplication.$xb,kd.AFrameworkApplication.lcid)});J.register(gc,"Common.App.OpenInClient.MacOfficeOffer").as("Common.IMacOfficeOffer").zc().Ic(function(){return new gc(kd.AFrameworkApplication.Eb,
kd.AFrameworkApplication.mfc,kd.AFrameworkApplication.lcid)})};Object(Xe.a)(De,"OpenInClientConfiguration",null,[5]);var sj=b(1341),Gh=b(36),zh=b(1238),Vh=b(276);tl.Object.defineProperties(Rc,{xf:{configurable:!0,enumerable:!0,get:function(){return ff.a.jj(Rc.Tj,CommonUIStrings.l_OICLaunchDialogTitle)}}});Rc.Tj="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='OICDialogRow' id='OICDialog'> <div class='OICDialogButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonLaunchRichClient'> <div id='OICLaunchRichClient' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonReturn'> <div id='OICReturnToApp' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(Xe.a)(Rc,"OICLaunchDialogHtml",null,[]);var bh=ff.a;vm(sc,bh);sc.prototype.q8a=function(){this.$Ba=ee("BtnRichClient",this.Yp.$qb,this.Yp.owb,this.Yp.Pid,CommonUIStrings.l_OICLaunchRichClient,Object(wf.a)(this,this.yyf,"onRichClientButtonClick"),ue);document.getElementById("OICLaunchRichClient").appendChild(this.$Ba);Ee(this.$Ba);this.VTa=ee("BtnReturn",this.Yp.$qb,this.Yp.owb,this.Yp.W6e,CommonUIStrings.l_OICReturnToOnlineClient,Object(wf.a)(this,this.vyf,"onReturnButtonClick"),ue);document.getElementById("OICReturnToApp").appendChild(this.VTa);
Ee(this.VTa)};sc.prototype.vyf=function(){this.hide();this.Yp.Dab();return!0};sc.prototype.yyf=function(){td.ULS.sendTraceTag(22140866,211,50,"OIC dialog: launch rich client");this.hide();kd.AFrameworkApplication.Eb.processAction(Pg.a.TPa,2);return!0};sc.prototype.hyi=function(){this.Yp.Dab()};sc.prototype.dispose=function(){this.$oa||(this.$Ba&&(Vh.a.instance.za(If.a.click,this.$Ba,Object(wf.a)(this,this.yyf,"onRichClientButtonClick")),Dh.KeyInputManager.instance.za(If.a.Vd,this.$Ba,ue)),this.VTa&&
(Vh.a.instance.za(If.a.click,this.VTa,Object(wf.a)(this,this.vyf,"onReturnButtonClick")),Dh.KeyInputManager.instance.za(If.a.Vd,this.VTa,ue)),bh.prototype.dispose.call(this),this.$oa=!0)};Object(Xe.a)(sc,"OICLaunchDialog",ff.a,[]);tl.Object.defineProperties(Cg,{xf:{configurable:!0,enumerable:!0,get:function(){return ff.a.jj(Cg.Tj,CommonUIStrings.l_OICDialogTitle)}}});Cg.Tj="<div class='ProtocolLaunchingDialogBody' id='PLDDlgBody'> <div class='ProtocolLaunchingDialogTitle UIFontDialogTitle OICDialog' id='ProtocolLaunchingDialogTitle'> <div class='WACDialogSectionTitle'>{0}</div> </div> <div class='ProtocolLaunchingDialogIssues OICDialog' id='ProtocolhandlerGetHelp'> <div class='UIFontDialogText OICDialog' id='Issues'> </div> <div class='ProtocolLaunchingDialogHelpButtons' id='Buttons'> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonEdit'> <div id='ProtocolHandlerDialogEditInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonGiveFeedback'> <div id='ProtocolHandlerDialogGiveFeedbackInApp' class='UIFontDialogButton WACGlyph'></div> </div> <br/> <div class='ProtocolLaunchingDialogButton' id='ButtonRetryOIC'> <div id='ProtocolHandlerDialogRetryOIC' class='UIFontDialogButton WACGlyph OICDialog'></div> </div> </div> </div> </div>";
Object(Xe.a)(Cg,"ProtocolLaunchingDialogV2Html",null,[]);var yj=ff.a;vm(rf,yj);rf.prototype.q8a=function(){var J=document.getElementById("Issues");if(J){Qc("",this.Yp.$qb,this.Yp.owb,this.Yp.Pid,J);var oa=document.createElement("span");oa.className="WACDialogSectionTitle";oa.innerText=5===this.Yp.zBf?CommonUIStrings.l_OICBrowserDialogTitle:CommonUIStrings.l_OICDialogSectionTitle;J.appendChild(oa);Ee(J);J.style.display="none"}kd.AFrameworkApplication.sa.Pa.Vfd?(this.UTa=ee("GiveFeedback",this.Yp.$qb,
this.Yp.owb,"",CommonUIStrings.l_OICDialogSectionGiveFeedback,Object(wf.a)(this,this.vlc,"onGiveFeedbackClick"),Object(wf.a)(this,this.Iuf,"onGiveFeedbackKeyUp")),document.getElementById("ProtocolHandlerDialogGiveFeedbackInApp").appendChild(this.UTa),Ee(this.UTa)):document.getElementById("ButtonGiveFeedback").style.display="none";kd.AFrameworkApplication.sa.Pa.editMode&&!kd.AFrameworkApplication.Gah?(this.wea=ee("Edit",this.Yp.$qb,this.Yp.owb,"",2===kd.AFrameworkApplication.sa.Pa.Lj?4===kd.AFrameworkApplication.sa.Pa.editMode?
CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICReturnToOnlineClient:4===kd.AFrameworkApplication.sa.Pa.editMode?CommonUIStrings.l_OICResumeEditing:CommonUIStrings.l_OICContinueInBrowser,Object(wf.a)(this,this.jtf,"onEditClick"),Object(wf.a)(this,this.otf,"onEditKeyUp")),document.getElementById("ProtocolHandlerDialogEditInApp").appendChild(this.wea),Ee(this.wea)):document.getElementById("ButtonEdit").style.display="none";kd.AFrameworkApplication.sa.Pa.editMode||kd.AFrameworkApplication.$xb||
!J||(J.style.display="none")};rf.prototype.FRe=function(){return this.Goa?(this.uz(this.Goa),!0):!1};rf.prototype.DRe=function(){return this.wea?(this.uz(this.wea),!0):!1};rf.prototype.otf=function(J){return this.dxd(J,0)};rf.prototype.Iuf=function(J){return this.dxd(J,2)};rf.prototype.tyf=function(J){return this.dxd(J,1)};rf.prototype.dxd=function(J,oa){var Va=!1;if(J.Ea.keyCode===eh.a.$h||J.Ea.keyCode===eh.a.iBa)J.Sb.click(),Va=!0;else if(J.Ea.keyCode===Sys.UI.Key.down||J.Ea.keyCode===Sys.UI.Key.up)switch(oa){case 1:Va=
this.DRe();break;case 0:Va=this.FRe()}return Va};rf.prototype.jtf=function(){this.hide();4===kd.AFrameworkApplication.sa.Pa.editMode?(td.ULS.sendTraceTag(18715411,211,50,"Restart the App and continue editing"),this.Yp.Dab()):(td.ULS.sendTraceTag(18715412,211,50,"Switch to edit doc in browser"),this.Yp.sgd());return!0};rf.prototype.vlc=function(){td.ULS.sendTraceTag(37339423,211,50,"Open give feedback dialog");this.Yp.$2e();return!0};rf.prototype.smc=function(){td.ULS.sendTraceTag(19239263,211,50,
"OIC dialog retry");document.getElementById("WACDialogPanel").style.display="none";kd.AFrameworkApplication.Eb.processAction(Pg.a.TPa,2);return!0};rf.prototype.lDd=function(){this.Yp.Dab()};rf.prototype.switchToBackupMode=function(){var J=document.getElementById("ProtocolLaunchingDialogTitle");if(J){J.innerText=CommonUIStrings.l_OICDialog2ndTitle;if(J=document.getElementById("Issues"))J.style.display="block";(J=document.getElementById("ProtocolHandlerDialogRetryOIC"))&&!J.children.length&&(this.Goa=
ee("RetryOIC","","","",CommonUIStrings.l_OICDialogRetry,Object(wf.a)(this,this.smc,"onRetryOICClick"),Object(wf.a)(this,this.tyf,"onRetryOICKeyUp")),J.appendChild(this.Goa),Ee(this.Goa),this.wea||this.FRe())}};rf.prototype.dispose=function(){this.$oa||(this.wea&&(Vh.a.instance.za(If.a.click,this.wea,Object(wf.a)(this,this.jtf,"onEditClick")),Dh.KeyInputManager.instance.za(If.a.Vd,this.wea,Object(wf.a)(this,this.otf,"onEditKeyUp"))),this.UTa&&(Vh.a.instance.za(If.a.click,this.UTa,Object(wf.a)(this,
this.vlc,"onGiveFeedbackClick")),Dh.KeyInputManager.instance.za(If.a.Vd,this.UTa,Object(wf.a)(this,this.Iuf,"onGiveFeedbackKeyUp"))),this.Goa&&(Vh.a.instance.za(If.a.click,this.Goa,Object(wf.a)(this,this.smc,"onRetryOICClick")),Dh.KeyInputManager.instance.za(If.a.Vd,this.Goa,Object(wf.a)(this,this.tyf,"onRetryOICKeyUp"))),yj.prototype.dispose.call(this),this.$oa=!0)};Object(Xe.a)(rf,"ProtocolLaunchingDialog",ff.a,[]);var Tf=b(426),ui=Wb.StandardDialog;vm(Af,ui);Af.prototype.vlc=function(J){td.ULS.sendTraceTag(595342858,
211,50,"Open give feedback dialog");this.Etf(J)};Af.prototype.smc=function(){td.ULS.sendTraceTag(595342857,211,50,"OIC dialog retry");kd.AFrameworkApplication.Eb.processAction(Pg.a.TPa,2)};Af.prototype.lDd=function(J){Af.$3e?3===J?this.$Pf():2!==J&&J?1===J&&this.QUg():this.continueEditing():2===J?this.$Pf():1!==J&&J||this.continueEditing()};Af.prototype.QUg=function(){td.ULS.sendTraceTag(577783557,211,50,"Closing the document");kd.AFrameworkApplication.Eb.ze(Pg.a.close,2,Tf.a)};Af.prototype.$Pf=function(){td.ULS.sendTraceTag(593602691,
211,50,"OIC dialog retry");window.setTimeout(Object(wf.a)(this,this.smc,"onRetryOICClick"),0)};Af.prototype.continueEditing=function(){4===kd.AFrameworkApplication.sa.Pa.editMode||kd.AFrameworkApplication.ga.ra("WordConsumptionViewToEditRedirectIsEnabled")&&1===kd.AFrameworkApplication.sa.mode?(td.ULS.sendTraceTag(593602690,211,50,"Restart the App and continue editing"),this.Yp.Dab()):(td.ULS.sendTraceTag(593602689,211,50,"Switch to edit doc in browser"),this.Yp.sgd())};tl.Object.defineProperties(Af,
{$3e:{configurable:!0,enumerable:!0,get:function(){return kd.AFrameworkApplication.ga.ra("OICDialogThreeActions")&&32===kd.AFrameworkApplication.Eb.processAction(Pg.a.close,1)}}});Object(Xe.a)(Af,"StandardProtocolLaunchingDialog",Wb.StandardDialog,[]);Object(Xe.a)(vg,"EditDocumentInClientParams",null,[]);Yf.a6c=function(J,oa,Va,Ub,e,C,M,qa,Na,Hb,Gc,gd,Uc,Wd,We,Gf){M=void 0===M?!1:M;qa=void 0===qa?!1:qa;Na=void 0===Na?"":Na;Hb=void 0===Hb?!1:Hb;Gc=void 0===Gc?!1:Gc;gd=void 0===gd?!1:gd;Uc=void 0===
Uc?"":Uc;Wd=void 0===Wd?"":Wd;We=void 0===We?"":We;Gf=void 0===Gf?!1:Gf;var xg=new vg;xg.DocumentUrl=J;xg.Mode=oa;xg.Options=Va;xg.Application=Ub;xg.SilentExternalHandler=M;xg.EncodeUrl=qa;xg.CorrelationIdForWinClient=Na;xg.NavigateUsingWindowOpen=Hb;xg.DescriptiveUnattemptedEnums=Gc;xg.NoBrowserModalDialogs=gd;xg.SessionOrigin=Uc;xg.CorrelationId=Wd;xg.ClickTime=We;xg.NewTelemetryDataIsEnabled=Gf;MSOJS.ClientUtils.EditDocumentInClient(xg,e,C)};Object(Xe.a)(Yf,"ClientUtils",null,[]);var Yj=b(176),
tj=b(962),ij=b(75);Of.prototype.iaj=function(J,oa,Va){return oa.contextId!==th.a.frame?2:1===Va?32:this.TPa()};Of.prototype.rzj=function(){return!(2===this.application&&kd.AFrameworkApplication.ga.ra("IsEmbeddedScenario"))};Of.prototype.closeApplication=function(){this.LRd||this.Prh()};Of.prototype.Dab=function(){this.uzj||this.csh()};Of.prototype.SIf=function(J){this.mMj&&Bf.a.Xg?new sc(this):this.B1b(J)};Of.prototype.B1b=function(J){J=this.pji(J);var oa=J.returnValue;td.ULS.sendTraceTag(34198736,
211,50,"OICLaunchClient,{0},{1}",32===oa,J.MAa);return oa};Of.prototype.NFa=function(J,oa,Va,Ub,e,C){this.aUa=J;this.G2d=oa;this.rfa=C;this.application=Va;this.qB=Ub;kd.AFrameworkApplication.downloadCopyOnOpenInClient?this.Xgf():kd.AFrameworkApplication.limitedEdit&&!kd.AFrameworkApplication.hostAuthenticatesUsersDuringOpenInClient?kd.AFrameworkApplication.j0f():this.nJg(e)};Of.prototype.TPa=function(){return this.B1b(this.ohb)};Of.prototype.GTf=function(){var J=new tj.a(Fg.a.openInClient);J.Values["ui-language"]=
kd.AFrameworkApplication.lcid.toString();J.Values[K.a.l3c]=kd.AFrameworkApplication.userSessionId;return this.rfa.value.send(J)?32:8};Of.prototype.Nfj=function(J){var oa=new tj.a(Fg.a.COj);oa.Values["ui-language"]=kd.AFrameworkApplication.lcid.toString();oa.Values[K.a.l3c]=kd.AFrameworkApplication.userSessionId;oa.Values[jh.a.BOj]=J;this.rfa.value.send(oa)};Of.prototype.pji=function(J){this.ohb=J;this.Nfj(5===this.qB?Of.yNi:Of.ANi);return 5===this.qB?this.oji():this.tji()};Of.prototype.oji=function(){this.chf();
return{returnValue:32,MAa:"HostEditUrl,"}};Of.prototype.tji=function(){var J,oa=J="";kd.AFrameworkApplication.Tje&&(oa="|f|"+kd.AFrameworkApplication.userSessionId);var Va=kd.AFrameworkApplication.ga.ra("IsAssignmentMode")&&kd.AFrameworkApplication.ga.ra("UseWindowOpenForOpenInClientInChromeAssignmentsIsEnabled")||kd.AFrameworkApplication.isUnifiedHostMode||Bf.a.qka,Ub=kd.AFrameworkApplication.ga.ra("UnattemptedEnumIsEnabled"),e=kd.AFrameworkApplication.ga.ra("NoBrowserModalDialogs");if(kd.AFrameworkApplication.wEf){J+=
"NewOrder,";var C=8;this.rfa&&this.rfa.value&&this.rfa.value.isEnabled()&&kd.AFrameworkApplication.oWd&&(J+="Post,",C=this.GTf());if(32===C)return{returnValue:C,MAa:J};td.ULS.sendTraceTag(4994821,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage");return kd.AFrameworkApplication.Zl.Z8a?(td.ULS.shipAssertTag(5566816,211,!!kd.AFrameworkApplication.Zl.Z8a),J+="HostUrl,",{returnValue:kd.AFrameworkApplication.sa.E7a(kd.AFrameworkApplication.Zl.Z8a),MAa:J}):this.aUa?(td.ULS.sendTraceTag(18715405,
211,15,"Try to open doc in rich client, SessionId {0}",kd.AFrameworkApplication.userSessionId),J+="DocUrl,",Yf.a6c(this.aUa,this.qB,this.options,this.application,Object(wf.a)(this,this.ntf,"onEditInClientSuccess"),Object(wf.a)(this,this.mtf,"onEditInClientFailure"),this.N0f,kd.AFrameworkApplication.ga.ra("OICEncodeUrlIsEnabled"),oa,Va,Ub,e,this.IUb,this.nD,this.pPb,kd.AFrameworkApplication.Eb.gkc),{returnValue:32,MAa:J}):{returnValue:8,MAa:J}}J+="OldOrder,";if(!this.aUa&&kd.AFrameworkApplication.Zl.Z8a)return this.rfa&&
this.rfa.value&&this.rfa.value.isEnabled()&&kd.AFrameworkApplication.oWd?(J+="Post,",oa=this.GTf()):(td.ULS.sendTraceTag(22595483,211,50,"AOpenInclientOperation.LaunchClient: cannot send postmessage"),oa=8),32!==oa?(td.ULS.shipAssertTag(22595484,211,!!kd.AFrameworkApplication.Zl.Z8a),J+="HostUrl,",{returnValue:kd.AFrameworkApplication.sa.E7a(kd.AFrameworkApplication.Zl.Z8a),MAa:J}):{returnValue:oa,MAa:J};td.ULS.sendTraceTag(22595485,211,15,"Try to open doc in rich client, SessionId {0}",kd.AFrameworkApplication.userSessionId);
J+="DocUrl,";Yf.a6c(this.aUa,this.qB,this.options,this.application,Object(wf.a)(this,this.ntf,"onEditInClientSuccess"),Object(wf.a)(this,this.mtf,"onEditInClientFailure"),this.N0f,kd.AFrameworkApplication.ga.ra("OICEncodeUrlIsEnabled"),oa,Va,Ub,e,this.IUb,this.nD,this.pPb,kd.AFrameworkApplication.Eb.gkc);return{returnValue:32,MAa:J}};Of.prototype.bOf=function(J){kd.AFrameworkApplication.Pm.setDw(8981,J)};Of.prototype.ntf=function(J){this.bOf(J);td.ULS.sendTraceTag(18715406,211,50,"Open in rich client succeed");
6===J&&MSOJS.ClientUtils.ShouldShowDialog()?(this.L3f||this.chf(),this.Fni()):this.LRd||this.closeApplication()};Of.prototype.mtf=function(J,oa){oa=void 0===oa?0:oa;td.ULS.sendTraceTag(18715407,211,10,"Fail to open doc in rich client. Failure Type: {0:D2}, Application: {1}",J,oa);if(5===J)alert(CommonUIStrings.l_OICErrorPopupBlockerForSafari);else{var Va=!!this.G2d&&!this.ohb,Ub=0;1===J&&(Ub=2);6<=J&&13>=J&&(Ub=1,1===oa&&(this.LRd=!0));this.Txc.Pxi?(td.ULS.sendTraceTag(18715408,211,50,"Open OICErrorDialogWithTrial. Dialog cause: {0}",
Ub),zh.a.instance.z3g(this.ohb?Object(wf.a)(this,this.aqf,"oicErrorDialogHandlerCloseForced"):Object(wf.a)(this,this.bqf,"oicErrorDialogHandlerNoCloseForced"),Va?Object(wf.a)(this,this.Kvf,"onLaunchDownload"):null,this.cFe(!1)?Object(wf.a)(this,this.c1h,"iHaveOfficeButtonHandler"):null,Ub,oa)):(td.ULS.sendTraceTag(18715409,211,50,"Open OICErrorDialog. Dialog cause: {0}",Ub),zh.a.instance.x3g(this.ohb?Object(wf.a)(this,this.aqf,"oicErrorDialogHandlerCloseForced"):Object(wf.a)(this,this.bqf,"oicErrorDialogHandlerNoCloseForced"),
Va?Object(wf.a)(this,this.Kvf,"onLaunchDownload"):null,Ub))}};Of.prototype.Fni=function(){try{var J=[Object.assign(new ij.a,{name:"CorrelationId",string:this.nD}),Object.assign(new ij.a,{name:"SessionOrigin",string:this.IUb}),Object.assign(new ij.a,{name:"ClickTime",string:this.pPb}),Object.assign(new ij.a,{name:"ProtocolHandlerFinishedTimestamp",double:(new Date).getTime()})];Yj.a("OpenInClientCompleted",!0,0,J)}catch(oa){td.ULS.sendTraceTag(537773316,306,15,"Record OIC attempt failed: "+oa.toString())}};
Of.prototype.chf=function(){kd.AFrameworkApplication.sa&&kd.AFrameworkApplication.sa.Pa.Lu&&kd.AFrameworkApplication.ga.ra("StandardProtocolDialogIsEnabled")?new Af(this):new rf(this)};Of.prototype.aqf=function(){this.closeApplication()};Of.prototype.bqf=function(){this.Dab()};Of.prototype.Kvf=function(){this.Xgf()};Of.prototype.c1h=function(){return this.cFe(!0)};Of.prototype.cFe=function(J){var oa=(Bf.a.EM||Bf.a.iH)&&!!kd.AFrameworkApplication.I4b;oa&&J&&(Rg.a.sf(kd.AFrameworkApplication.I4b,"_blank",
void 0,"OpenInClient"),this.closeApplication());return oa};tl.Object.defineProperties(Of.prototype,{zBf:{configurable:!0,enumerable:!0,get:function(){return this.qB}},options:{configurable:!0,enumerable:!0,get:function(){var J=0;kd.AFrameworkApplication.h9i&&(J|=1);kd.AFrameworkApplication.openInClientEditOnly&&(J|=4);this.rzj()&&(J|=64);return J}},$qb:{configurable:!0,enumerable:!0,get:function(){return kd.AFrameworkApplication.pC}},owb:{configurable:!0,enumerable:!0,get:function(){return kd.AFrameworkApplication.iwb}},
W6e:{configurable:!0,enumerable:!0,get:function(){return""}},Pid:{configurable:!0,enumerable:!0,get:function(){return""}},L3f:{configurable:!0,enumerable:!0,get:function(){return kd.AFrameworkApplication.ga.ra("OneNoteMobileViewerIsEnabled")}},Txc:{configurable:!0,enumerable:!0,get:function(){return this.L$d||(this.L$d=ii.a.instance.resolve("Common.IOfficeTrialExperience"))}}});Of.ANi="OpenInDesktop";Of.yNi="OpenInBrowser";Object(Xe.a)(Of,"AOpenInClientOperation",null,[]);var Ph=b(197),Lh=b(201),
$h=b(126),lj=b(44),Zj=b(42),Ag=b(180),Gj=b(92),qj=b(32),Wi=b(477),Nk=b(1181),ek=b(607);vm(Lf,Of);Lf.prototype.XWg=function(){this.SIf(this.RRe)};Lf.prototype.LYg=function(){var J=this,oa=this.$;lc.TaskExtensions.Ba(this.FJ.value,function(Va){J.NFa(oa.workbookContext.ClientUrl,kd.AFrameworkApplication.q3,1,oa.isEditMode?2:0,!0,new mg.a(function(){return Va.result}))},this.ma,3)};Lf.prototype.sgd=function(){pf.a.Qf.editMode&&(this.$.Ab.XJ=!1)};Lf.prototype.$2e=function(){var J={};J[ab.a.B7b]=!1;J[ab.a.O$]=
"OpenInExcel";this.$.Ce(802602464,Yc.a.Wb,8,J)};Lf.prototype.M0c=function(){var J=this;if(this.fa.oc){var oa=this.$;oa.isEditMode&&lc.TaskExtensions.Ba(this.FJ.value,function(Va){J.NFa(oa.workbookContext.ClientUrl,kd.AFrameworkApplication.q3,1,2,!1,new mg.a(function(){return Va.result}))},this.ma,3)}};Lf.prototype.jze=function(){var J=this;this.fa.oc&&lc.TaskExtensions.Ba(this.FJ.value,function(oa){J.NFa(J.$.workbookContext.ClientUrl,kd.AFrameworkApplication.q3,1,J.$.isEditMode?2:0,!1,new mg.a(function(){return oa.result}))},
this.ma,3)};Lf.prototype.openInExcelClient=function(){var J=this;this.fa.oc&&(this.$.isEditMode||lc.TaskExtensions.Ba(this.FJ.value,function(oa){J.NFa(J.$.workbookContext.ClientUrl,kd.AFrameworkApplication.q3,1,0,!1,new mg.a(function(){return oa.result}))},this.ma,3))};Lf.prototype.openInBrowser=function(){var J=this;this.fa.oc&&lc.TaskExtensions.Ba(this.FJ.value,function(oa){J.NFa(J.$.workbookContext.ClientUrl,kd.AFrameworkApplication.q3,1,5,!1,new mg.a(function(){return oa.result}))},this.ma,3)};
Lf.prototype.downloadFile=function(J){var oa=this.mse(J);this.R$.downloadFile(oa,J)};Lf.prototype.vBf=function(J,oa){oa=void 0===oa?0:oa;if(this.fa.oc){var Va=this.$;Yg.a(Va).iLa?this.wBf(J,Va):0<oa?this.nxj(J,Va,oa):this.WZf(Va)}};Lf.prototype.NFa=function(J,oa,Va,Ub,e,C){this.$.Ab.XJ=!Eg.EwaSettings.isChangeGateEnabled("OfficeVSO:5209012_KeepMenuEnableAfterOIC")||!this.$.lc.inWebPart;this.RRe=e;this.C1b=null;this.y5c=!1;this.sJg(J,oa,Ub,e,C)};Lf.prototype.B1b=function(J){var oa=this.$.lc;td.ULS.sendTraceTag(537154775,
0,50,"OpenInExcelOperation.CompleteClientLaunch: IsEmbedded:{0}, InWebPart:{1}, DivSyndicated:{2}, Mode:{3}",oa.inEmbedView,oa.inWebPart,oa.isDivSyndicated,this.$.isEditMode?Ph.a.edit:Ph.a.view);return Lf.Vbf()?(this.b1b(),Yf.a6c(this.aUa,this.qB,this.options,1,this.hCi,this.gCi,!1,kd.AFrameworkApplication.ga.ra("OICEncodeUrlIsEnabled")),32):Of.prototype.B1b.call(this,J)};Lf.prototype.Prh=function(){this.cPf();var J=this.$;if(!this.fa.lc.inWebPart&&this.fa.oc&&!J.isEditMode){var oa=new Gj.a(2145659238,
Yc.a.Wb,this.$.ed,0,null);this.fxe=lj.a.instance.create(function(){J.Ka.Zb(oa)},0,Zj.a.BNi)}};Lf.prototype.dispose=function(){this.fa&&this.fa.kk(this.Zc);Mg.a.pc([this.Ma,this.fxe,this.xm]);this.$=this.fa=null};Lf.prototype.csh=function(){this.cPf()};Lf.prototype.Xgf=function(){var J=this;lj.a.instance.create(function(){J.$.Ka.Zb(new Gj.a(-2028960985,Yc.a.Wb,0,30,null))},0,Zj.a.CNi,!0,!0)};Lf.prototype.nJg=function(J){var oa=this.$,Va=Yg.a(this.$).nd.activityState;Va[Wi.a.hie]=!0;oa.isEditMode&&
this.fa.oc?(this.b1b(),Ib.a(oa).Rs(new hc.a(he.a.Qy,5,function(){oa.KH(!1);Va[yg.a.Kq]=he.a.d1b;Va[Wi.a.svg]=J;Va[Pe.a.h$c]=!0;oa.isEditMode&&(Va[Pe.a.aT]=1,Va[Pe.a.XX]=!0,Va[Rh.a.WWb]=!0,Va[Rh.a.XRc]=!0);Va[Wi.a.kie]=1455037301}))):this.SIf(J)};Lf.prototype.L1f=function(){var J=kd.AFrameworkApplication.q3;if(this.$.downloadCopyOnOpenInClient){if(8===this.$.frame.E7a(J,!0)){var oa=this.$.fa.lc;td.ULS.sendTraceTag(537154773,0,50,"Url:[{0}] IsEmbedded:[{1}] InWebPart:[{2}] DivSyndicated:[{3}], Mode:[{4}]",
J,oa.inEmbedView,oa.inWebPart,oa.isDivSyndicated,this.$.isEditMode?Ph.a.edit:Ph.a.view)}}else this.R$.downloadFile(J,-2028960985);this.y5c=!0;this.b1b()};Lf.prototype.Lji=function(){this.Txc.Jpf&&this.Txc.Ihc(1)};Lf.prototype.Mji=function(){this.Txc.Jpf&&ni.HelperMethods.sf(Kg.a.jZ(33),"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryOffice")};Lf.prototype.Vji=function(){ni.HelperMethods.sf(Kg.a.jZ(31),"_blank",void 0,"OpenExcelOperation.XLSBackstageUnknownTryMacOffice")};Lf.prototype.Wji=function(){ni.HelperMethods.sf(Kg.a.jZ(34),
"_blank",void 0,"OpenExcelOperation.XLSViewerUnknownTryMacOffice")};Lf.prototype.mse=function(J){var oa=new Sys.StringBuilder,Va=this.$.workbookContext,Ub=this.$.ya;oa.append(this.$.hda);oa.append(Ub.FileHandlerRelativeUri);oa.append("?id=");oa.append(encodeURIComponent(Lh.a.XFb(Va.WorkbookUri,"sc")));this.$.fa.oc&&(oa.append("&sessionId="),oa.append(encodeURIComponent(this.$.fa.sessionId)));switch(J){case -974518828:oa.append("&workbookType=PublishedItemsSnapshot");break;case -1804063550:oa.append("&workbookType=FullWorkbook");
break;case -1059172980:oa.append("&workbookType=FullWorkbook&workbookFileType=Odf");break;default:oa.clear()}$h.a.yFa(oa,Ub);return oa.toString()};Lf.prototype.zXg=function(){sj.a.instance.QSg();var J=this.$.ya;MSOJS.ClientUtils.InitUrls(J.RoamingAppsX86RootUrl,J.RoamingAppsControlInstallerUrl,J.RoamingAppsFirefoxExtensionUrl)};Lf.prototype.cPf=function(){var J=this.$;this.fa.oc||ug.a.pDd(J,Yg.a(J).nd);this.b1b();this.C1b&&this.C1b(this,this.y5c);J.frame.hv.Yl(this.$.frame.iaa());J.frame.OW.Yl(this.$.frame.iaa());
J.Ab.XJ=!1;Oa.g(J).focus()};Lf.prototype.sJg=function(J,oa,Va,Ub,e){var C=this.$;kd.AFrameworkApplication.sa&&!Lf.Vbf()&&(C.frame.hv.dn(C.frame.iaa()),C.frame.OW.dn(C.frame.iaa()));Of.prototype.NFa.call(this,J,oa,1,Va,Ub,e)};Lf.prototype.b1b=function(){var J=this.$;Yg.a(J).ui.activityName===he.a.openInExcelClient&&Yg.a(J).nd.kJ()};Lf.prototype.$rj=function(){var J=Ah.a.jd(1,0,665,666,0,1341525452,"OpenInExcelActiveXError");Ib.a(this.$).St([J])};Lf.prototype.nxj=function(J,oa,Va){var Ub=this,e=null,
C=window.setTimeout(function(){Yg.a(oa).Bqc(e);Ub.WZf(oa)},Va);e=function(){Yg.a(oa).iLa&&(Yg.a(oa).Bqc(e),window.clearTimeout(C),Ub.wBf(J,oa))};Yg.a(oa).$Sc(e)};Lf.prototype.WZf=function(J){var oa=Ah.a.jd(1,1,0,680,0,-1753121099,"ProcessingUserChangesFileDownloadIgnored");Ib.a(J).St([oa])};Lf.prototype.wBf=function(J,oa){var Va=this;Ib.a(oa).Rs(new hc.a(he.a.Qy,5,function(){oa.KH(!1);var Ub=Yg.a(oa).nd,e=Ub.activityState;e[yg.a.Kq]=he.a.BGe;e[Kh.a.YWb]=oa.fa.lc.hasUnsupportedFeaturesForEdit;e[ek.a.RRc]=
J;Ub.ft(Ah.a.L$(Va.businessBar.j6c,[1437034227]))}))};Lf.Vbf=function(){return 1<pf.a.getRegisteredEwaInstances().length};tl.Object.defineProperties(Lf.prototype,{W6e:{configurable:!0,enumerable:!0,get:function(){return"EditInExcelWebApp_32x32x32"}},ma:{configurable:!0,enumerable:!0,get:function(){this.xm=this.xm||new Ag.a;return this.xm.token}},Pid:{configurable:!0,enumerable:!0,get:function(){return"excel32"}},L3f:{configurable:!0,enumerable:!0,get:function(){return this.fa.lc.inWebPart}}});Object(Xe.a)(Lf,
"OpenInExcelOperation",Of,[536,3]);var Yi=pd.a;vm(Uf,Yi);Uf.prototype.create=function(){var J=this;if(this.$.da.Aa(55))this.Fb(this.$.da.Aa(55));else{var oa=qc.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.tb),Va=qc.GetServiceTaskFactory.Xa(this.$.da,5,4,this.tb);lc.TaskExtensions.Ba(nb.Task.WAA(oa,Va),function(){J.Fb(new Lf(J.$,new mg.a(function(){return qc.GetServiceTaskFactory.create(J.$.da,137,J.ma,J.tb)}),Va.result))},this.ma,3)}};Uf.yXg=function(){Uf.dqf||(Uf.dqf=!0,(new De).di(ii.a.instance),
ii.a.instance.resolve("Common.IOfficeTrialExperience").Mg(),ii.a.instance.resolve("Common.IMacOfficeOffer").Mg())};Uf.dqf=!1;Object(Xe.a)(Uf,"OpenInClientFactory",pd.a,[]);var Lj=b(111),uj=b(387),Pj=Lj.a;vm(ae,Pj);ae.prototype.execute=function(J){var oa=Object(Ug.a)(8,J.Ge);lc.TaskExtensions.Ba(qc.GetServiceTaskFactory.create(oa.da,56,oa.ma,0),function(Va){oa.downloadCopyOnOpenInClient?(J.activityState[uj.a.iie]=!0,Va.result.L1f()):Va.result.LYg()},oa.ma,3);return 1};Object(Xe.a)(ae,"OpenInExcelClientActivity",
Lj.a,[]);var zj=pd.a;vm(re,zj);re.prototype.create=function(){var J=this;lc.TaskExtensions.Ba(qc.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.tb),function(){J.Fb(new ae(he.a.openInExcelClient,he.a.idle))},this.ma)};Object(Xe.a)(re,"OpenInExcelClientActivityFactory",pd.a,[]);var Mi=$d.a;vm(je,Mi);je.prototype.initialize=function(J){Mi.prototype.initialize.call(this,J)};je.prototype.execute=function(J){this.vi=J;J=Object(Ug.a)(8,this.vi.Ge);this.dqb(J);return 1};je.prototype.qI=function(J){Mi.prototype.qI.call(this,
J)};je.prototype.dqb=function(){var J=this;this.subscribe(this.vi,this.SPi,function(oa){J.GAd.add_disposing(oa)})};je.prototype.VDb=function(J){this.unsubscribe(function(oa){J.remove_disposing(oa)});this.vi.activityState[fg.a.X1]=0};Object(Xe.a)(je,"PasswordProtectedFileActivity",$d.a,[]);var xd=b(521),Te=xd.a;vm(rd,Te);rd.prototype.o$a=function(J){this.Yoa=J};rd.prototype.W2=function(){var J={};J[xd.a.description]=nf.a.instance.ea(1916);J[xd.a.Jla]=nf.a.instance.ea(1912);J[xd.a.MCf]=nf.a.instance.ea(1934);
J[xd.a.KCf]=nf.a.instance.ea(1935);J[xd.a.LCf]=nf.a.instance.ea(1913);J[xd.a.cjd]=nf.a.instance.ea(1919);J[xd.a.cqe]=nf.a.instance.ea(1614);J[xd.a.ONj]=nf.a.instance.Va(25);J[xd.a.xbg]=Object(wf.a)(this,this.aTa,"verifySubmittedPassword");return J};rd.prototype.xsa=function(){var J={};J[ei.a.Ly]=this.xc;J[xd.a.lre]=this.W2();return J};rd.prototype.Kh=function(){this.kc=1;this.initializeAndShow(this.Xn,this.MYi,this.xsa())};tl.Object.defineProperties(rd.prototype,{xc:{configurable:!0,enumerable:!0,
get:function(){return"PasswordDialog"}},Qqb:{configurable:!0,enumerable:!0,get:function(){return this.Yoa}},Xn:{configurable:!0,enumerable:!0,get:function(){return nf.a.instance.ea(1915)}}});Object(Xe.a)(rd,"PasswordProtectedFilePasswordInputDialog",xd.a,[]);var Wg=b(302);vm(Yd,rd);Yd.prototype.o$a=function(J,oa){rd.prototype.o$a.call(this,J,oa);td.ULS.sendTraceTag(537154755,0,50,"PasswordProtectedFileModifyActivity.PasswordProtectedFileModifyPasswordInputDialogDisposing: user response: {0}",J)};
Yd.prototype.aTa=function(J,oa){this.passwordToModify=J;var Va={};Va.FileModifyPassword=Jg.a.pf(J);Le.nb(this.$.qa.ta,Va,this.uMi(oa),this.tMi(oa),null,null)};Yd.prototype.W2=function(){var J=rd.prototype.W2.call(this);J[xd.a.cjd]=nf.a.instance.ea(1920);J[xd.a.description]=nf.a.instance.Va(24);return J};Yd.prototype.Kh=function(){Ed.b().A6c("PasswordToModifyDialogShown");td.ULS.sendTraceTag(557446529,0,50,"PasswordProtectedFileModifyPasswordInputDialog.InitializeAndShowDialog: Initializing dialog.");
rd.prototype.Kh.call(this)};Yd.prototype.uMi=function(J){var oa=this;return function(Va){Ah.a.gh(Va.Errors,[-2019873242])&&oa.S4b(oa.Xpb());if(!Va||Wg.a(Va))if(0<oa.YId)oa.eIf(J);else{td.ULS.sendTraceTag(537154754,0,10,"VerifyPasswordToModifyOperation.GenerateOnVerifyPasswordToModifyRequestSuccess: Unexpected error: {0}",Ah.a.Uc(Va.Errors));oa.$.fa.Yo(Va.Errors);oa.hide();return}oa.V6d=Va.Result;oa.Ffc&&(Ed.b().RQd("UserAction","Password-To-Modify Workbook: Logging StopWatch duration after user enters corect password",
"PasswordToModifyPasswordVerifiedTillInteractive"),td.ULS.sendTraceTag(555758470,0,50,"PasswordProtectedFileModifyPasswordInputDialog.OnVerifyPasswordToModifyRequestSuccess: User entered the correct password."));J(oa.Ffc?0:1)}};Yd.prototype.tMi=function(J){var oa=this;return function(){0<oa.YId?oa.eIf(J):(td.ULS.sendTraceTag(537154753,0,10,"PasswordProtectedFileModifyInputDialog.OnVerifyPasswordToModifyRequestFailure: VerifyPasswordToModify request failed."),J(3))}};Yd.prototype.eIf=function(J){--this.YId;
this.aTa(this.passwordToModify,J)};Yd.prototype.Xpb=function(){return Ah.a.jd(1,0,1613,1614,1,-2019873242,"TooManyWrongPasswordAttemptFileModifyError")};tl.Object.defineProperties(Yd.prototype,{Ffc:{configurable:!0,enumerable:!0,get:function(){return this.V6d}},Xn:{configurable:!0,enumerable:!0,get:function(){return nf.a.instance.ea(1917)}}});Object(Xe.a)(Yd,"PasswordProtectedFileModifyPasswordInputDialog",rd,[]);vm(ge,je);ge.prototype.dqb=function(J){this.GAd=new Yd(J);je.prototype.dqb.call(this,
J)};ge.prototype.VDb=function(J,oa){var Va=J.Qqb,Ub=J.Ffc,e=J.passwordToModify;je.prototype.VDb.call(this,J,oa);this.vi.kxa([2001366804]);switch(Va){case 1:Ub?(oa=Object(Ug.a)(8,this.vi.Ge),this.vi.activityState[fg.a.zie]=Jg.a.pf(e),this.vi.activityState[fg.a.jXa]=!0,J.passwordToModify="",this.oh(oa.isEditMode?he.a.Oj:this.$L)):td.ULS.sendTraceTag(537154757,0,50,"PasswordProtectedFileModifyActivity.PasswordProtectedFilePasswordInputDialogDisposing: Unexpected State , Dialog disposed but password not verified.");
this.Uo();break;case 0:this.vi.activityState[fg.a.rs]=!1;this.oh(this.vJ);this.Uo();break;default:td.ULS.sendTraceTag(537154756,0,50,"PasswordToModifyFileModifyActivity.OnPasswordInputCommited: unhandled user response '{0}'",Va)}};Object(Xe.a)(ge,"PasswordProtectedFileModifyActivity",je,[]);var Vj=pd.a;vm(jd,Vj);jd.prototype.create=function(){this.Fb(new ge(this.activityName,this.$L,this.vJ))};jd.ja=function(J){J.da.Ha(434,new jd(he.a.UDb,he.a.pdb,he.a.rGa,J))};Object(Xe.a)(jd,"PasswordProtectedFileModifyActivityFactory",
pd.a,[]);vm(zd,rd);zd.prototype.aTa=function(J,oa){this.password=J;oa(0)};zd.prototype.W2=function(){var J=rd.prototype.W2.call(this);this.aff&&(J[xd.a.Dhh]=1);return J};zd.prototype.Kh=function(){td.ULS.sendTraceTag(537154722,0,50,"PasswordProtectedFileOpenPasswordInputDialog.InitializeAndShowDialog: Initializing dialog. isWrongPassword={0}",this.aff);rd.prototype.Kh.call(this);Ib.a(this.$).zme()};Object(Xe.a)(zd,"PasswordProtectedFileOpenPasswordInputDialog",rd,[]);vm(Lc,je);Lc.prototype.dqb=function(J){var oa=
Ah.a.gh(this.vi.errors,[1217361942]);this.GAd=new zd(J,oa);J.Rdc||J.WEe();je.prototype.dqb.call(this,J)};Lc.prototype.VDb=function(J,oa){var Va=J.password;J.password="";var Ub=J.Qqb;je.prototype.VDb.call(this,J,oa);this.vi.activityState[fg.a.aSc]=Jg.a.pf(Va);this.vi.activityState[fg.a.jXa]=!0;this.vi.kxa([110414285,1217361942]);td.ULS.sendTraceTag(537154752,0,50,"PasswordProtectedFileOpenActivity.PasswordProtectedFileOpenPasswordInputDialogDisposing: user response: {0}",Ub);switch(Ub){case 1:this.oh(this.$L);
this.Uo();break;case 0:this.oh(this.vJ),this.Uo()}};Object(Xe.a)(Lc,"PasswordProtectedFileOpenActivity",je,[]);var Ck=pd.a;vm(mb,Ck);mb.prototype.create=function(){this.Fb(new Lc(this.activityName,this.$L,this.vJ))};mb.ja=function(J){J.da.Ha(386,new mb(he.a.Hnc,he.a.Oj,he.a.Ck,J))};Object(Xe.a)(mb,"PasswordProtectedFileOpenActivityFactory",pd.a,[]);var yf=b(378),ai=yf.a;vm(Nb,ai);Nb.prototype.YN=function(J,oa){this.Yoa=J;ai.prototype.YN.call(this,J,oa)};Nb.prototype.jr=function(){ai.prototype.jr.call(this);
this.kc=9;var J=this.DLh();this.Cc(1,nf.a.instance.ea(1612));this.Cc(2,nf.a.instance.ea(960));this.Kk(nf.a.instance.ea(686),ua.a.ym(J),this.icon,this.ZN)};Nb.prototype.DLh=function(){return String.format(nf.a.instance.ea(687))};tl.Object.defineProperties(Nb.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"SharedWorkbookDialog"}},Qqb:{configurable:!0,enumerable:!0,get:function(){return this.Yoa}}});Object(Xe.a)(Nb,"LegacySharedWorkbookDialog",yf.a,[]);var li=$d.a;vm(nc,li);nc.prototype.initialize=
function(J){li.prototype.initialize.call(this,J)};nc.prototype.execute=function(J){this.vi=J;this.c1g();return 1};nc.prototype.qI=function(J){li.prototype.qI.call(this,J)};nc.prototype.c1g=function(){var J=Object(Ug.a)(8,this.vi.Ge),oa=Ah.a.XYa([-573864504]);oa[0].HelpDescription=nf.a.instance.ea(689);oa[0].HelpTopicId=vh.a.tki;var Va=new Nb(J,oa[0]);this.subscribe(this.vi,this.ski,function(Ub){Va.add_disposing(Ub)})};Object(Xe.a)(nc,"LegacySharedWorkbookActivity",$d.a,[]);var Mh=pd.a;vm(ib,Mh);ib.prototype.create=
function(){this.Fb(new nc(this.activityName,this.$L,this.vJ))};ib.ja=function(J){J.da.Ha(460,new ib(he.a.Lzb,he.a.pdb,he.a.rGa,J))};Object(Xe.a)(ib,"LegacySharedWorkbookActivityFactory",pd.a,[]);id.prototype.Xc=function(){return!1};id.prototype.Gc=function(J,oa){if(!Eg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PresentMode",!1))return!1;switch(oa.command){case 642419866:return!0;case 588342182:return this.presentModeManager.$y;default:return!1}};id.prototype.executeCommand=function(J,
oa){J=lc.TaskExtensions.om();oa=oa.command;switch(oa){case 642419866:this.presentModeManager.Svc(!this.presentModeManager.$y);this.presentModeManager.lh("TogglePresentMode");break;case 588342182:this.presentModeManager.W5a=!this.presentModeManager.W5a;this.presentModeManager.X_f(this.presentModeManager.W5a,"TogglePresentModeOverlay");this.presentModeManager.lh("TogglePresentModeOverlay");break;default:J=Cd.a(oa)}return J};id.prototype.fd=function(){return!1};Object(Xe.a)(id,"PresentModeCommandHandler",
null,[237]);var Hj=Ka.a;vm(gb,Hj);gb.prototype.Md=function(){var J=this;lc.TaskExtensions.Ba(qc.GetServiceTaskFactory.Xa(this.$.da,423,424,this.tb),function(oa){J.Ed([new id(J.$,oa.result)])},this.ma,3)};gb.ja=function(J){Ka.a.de(420,new gb(J))};Object(Xe.a)(gb,"PresentModeCommandHandlerFactory",Ka.a,[]);var fi=b(135),Dj=b(110);wc.dmh="ewa-presentMode-overlay";wc.emh="ewa-presentMode-panel-container";wc.fmh="ewa-presentMode-rowHdrParent-container";Object(Xe.a)(wc,"CssClassNames",null,[]);var L=b(16),
Ea=b(142),Pb=b(283),yc=b(125),Wc=b(119),Ke=b(433),Fe=b(11),uf=b(95),Mf=b(339),Gg=b(127),wh=b(412),Pf=b(256),hh=b(245),zi=b(186);ed.prototype.dispose=function(){this.$=this.fCd=this.gCd=this.lca=this.LOa=null};ed.prototype.p4h=function(){var J=this;window.requestAnimationFrame(function(){J.lca=document.createElement("div");J.$.Ey.insertBefore(J.lca,J.$.Ey.lastChild);J.lca.id=J.$.Ib+ab.a.p8b;J.lca.classList.add(wc.emh);J.gCd=document.getElementById(J.$.Ib+ab.a.U3c);J.fCd=[J.$.Ay];J.isInitialized=!0});
this.LOa=presentMode.PresentModeControllerFactoryGlobal.createPresentModeFloatieController();this.LOa.initializePresentModeFloatie()};ed.prototype.PSh=function(){var J={};J.PollingCountPerCaller=Dj.a.toJSON(this.doc);J.PollingDurationPerCaller=Dj.a.toJSON(this.eoc);return J};ed.prototype.qPd=function(J){this.isInitialized?J?(this.LOa.showPresentModeFloatie(this.lca,this.gCd,this.fCd),this.lh("ShowOrHideFloatiePanel"),this.Y0i()):(this.LOa.hidePresentModeFloatie(),this.pHj()):td.ULS.sendTraceTag(537154326,
0,15,"PresentModeFloatieManager.ShowOrHideFloatiePanel called before initialization complete")};ed.prototype.lh=function(J){this.MDf=ni.HelperMethods.jc();this.HOa=J;this.Gpe=zi.AsyncMethodContext.Ky(this.Fl,100,Zj.a.ITi+J,this.Gpe)};ed.prototype.Qe=function(J,oa){if(oa)return!1;J=Fe.DOMElementExtensions.zl(this.lca.querySelectorAll(Fe.DOMElementExtensions.Ep));if(!J)return td.ULS.sendTraceTag(537154325,0,10,"PresentModeFloatieManager.SetFocusOnSection: Could not find first focusable item in present mode toolbar"),
!1;J.focus();return!0};ed.prototype.zh=function(J){return Fe.DOMElementExtensions.Ye(this.Jb,J)};ed.prototype.ji=function(){};ed.prototype.Vh=function(){};ed.prototype.Y0i=function(){var J=this;Pf.a(this.$).Tg(this);this.$.da.Za(15,function(oa){J.ewaAccessibilityManager=oa;J.ewaAccessibilityManager.mode=5});Dh.KeyInputManager.instance.pa(If.a.Rb,this.Jb,this.onKeyDown)};ed.prototype.pHj=function(){Pf.a(this.$).XA(this);Oa.g(this.$).f0();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=
0);Dh.KeyInputManager.instance.za(If.a.Rb,this.Jb,this.onKeyDown)};ed.prototype.qcj=function(){var J=ni.HelperMethods.jc()-this.MDf,oa=this.eoc[this.HOa]?this.eoc[this.HOa]:0;this.eoc[this.HOa]=oa>J?oa:J;this.doc[this.HOa]=this.doc[this.HOa]?this.doc[this.HOa]+1:1};tl.Object.defineProperties(ed.prototype,{Jb:{configurable:!0,enumerable:!0,get:function(){return this.lca}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){this.LOa.updatePresentModeFloatieShyState(2);return!!this.lca}},Zd:{configurable:!0,
enumerable:!0,get:function(){return hh.a.UEf}}});Object(Xe.a)(ed,"PresentModeFloatieManager",null,[539,100,3]);var vi=b(58);Object(Xe.a)(oc,"OverlayCavityInfo",null,[]);Object(Xe.a)(Jf,"OverlayContainerInfo",null,[]);Object(Xe.a)(Ce,"PresentModeOverlayProps",null,[]);Pd.prototype.Z4h=function(){var J=this;this.hCd=presentMode.PresentModeControllerFactoryGlobal.createPresentModeOverlayController();window.requestAnimationFrame(function(){J.gZa=Array(5);for(var oa,Va,Ub=1;4>=Ub;Ub++)oa=document.createElement("div"),
Fe.DOMElementExtensions.setVisible(oa,!1),oa.id=String.format("{0}-{1}","PresentModeOverlay",Ub),Fe.DOMElementExtensions.toggleCssClass(oa,wc.dmh,!0),Va=J.gridView.fg(Ub).domElement,Va.insertBefore(oa,Va.firstChild),J.gZa[Ub]=oa})};Pd.prototype.W_f=function(J){J&&this.CKj();for(var oa=1;4>=oa;oa++)this.qcf(oa)&&Fe.DOMElementExtensions.setVisible(this.gZa[oa],J);Fe.DOMElementExtensions.toggleCssClass(this.$.Oq,"ewr-presentMode-overlay",J)};Pd.prototype.CKj=function(){for(var J=this.kPg(),oa,Va=1;4>=
Va;Va++)oa=Va,J[oa]&&this.hCd.showOverlayWithCavity(this.gZa[oa],J[oa])};Pd.prototype.dispose=function(){this.hCd=this.gZa=this.gridView=this.$=null};Pd.prototype.kPg=function(){for(var J,oa,Va=Oa.g(this.$).rtl,Ub,e=Array(5),C=1;4>=C;C++)oa=C,this.qcf(C)&&(J=this.gridView.fg(C),Ub=this.gridView.ha.Qa.Qaa?this.gJh(C,J,Va):this.YJh(C,J,Va),J=this.J3g(J),e[oa]=this.b4g(this.gZa[oa].id,J,Ub));return e};Pd.prototype.qcf=function(J){return this.gridView.$a.NJ(J)};Pd.prototype.J3g=function(J){return Object.assign(new Jf,
{width:J.Dn.width,height:J.Dn.height})};Pd.prototype.b4g=function(J,oa,Va){return Object.assign(new Ce,{containerId:J,overlayContainerInfo:oa,overlayCavityInfos:Va?[Va]:null})};Pd.prototype.gJh=function(J,oa,Va){var Ub=Oa.g(this.$).ha.Qa.nc;if(!Ub)return td.ULS.sendTraceTag(537154317,0,10,"PresentModeOverlayRenderer.GetFloatingObjectOverlayCavityInfo: Selected Floating Object is null."),null;var e=Ub.extension.jJh(J);J=e.pBa;Ub=e.rotation;var C=e.translateX;var M=e.translateY;return e.returnValue?
(e=J.x-oa.Dn.x,Object.assign(new oc,{left:(Va?oa.Dn.width-(e+J.width):e)-3+1,top:J.y-oa.Dn.y-3+1,width:J.width+5,height:J.height+5,angle:Ub,translateX:C,translateY:M})):null};Pd.prototype.YJh=function(J,oa,Va){J=this.gridView.Nb.ytb(this.gridView.ha.va.activeRange,J)||vi.a.z3;if(!J.Jf(oa.Dn))return null;var Ub=J.x-oa.Dn.x;return Object.assign(new oc,{left:Va?oa.Dn.width-(Ub+J.width)-2:Ub-3,top:J.y-oa.Dn.y-3,width:J.width+5,height:J.height+5})};Object(Xe.a)(Pd,"PresentModeOverlayRenderer",null,[538,
3]);var Ai=xd.a;vm(Ad,Ai);Ad.prototype.hide=function(){Ai.prototype.hide.call(this);fi.a.vw(ab.a.a0f,"false",this.$.ya.ShowPresentModeWelcomeDialogCookieExpirationDays)};tl.Object.defineProperties(Ad.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"PresentModeWelcomeDialog"}}});Object(Xe.a)(Ad,"PresentModeWelcomeDialog",xd.a,[]);pe.requestFullscreen=function(J){J.webkitRequestFullscreen?J.webkitRequestFullscreen():J.msRequestFullscreen?J.msRequestFullscreen():J.mozRequestFullScreen?
J.mozRequestFullScreen():J.requestFullscreen?J.requestFullscreen():td.ULS.sendTraceTag(7145619,210,50,"RequestFullscreen got invoked in unknown browser")};pe.exitFullscreen=function(){document.webkitExitFullscreen?document.webkitExitFullscreen():document.msExitFullscreen?document.msExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.exitFullscreen?document.exitFullscreen():td.ULS.sendTraceTag(7145620,210,50,"ExitFullscreen got invoked in unknown browser")};tl.Object.defineProperties(pe,
{ezh:{configurable:!0,enumerable:!0,get:function(){return document.webkitFullscreenEnabled?"webkitfullscreenchange":document.msFullscreenEnabled?"MSFullscreenChange":document.mozFullScreenEnabled?"mozfullscreenchange":document.fullscreenEnabled?"fullscreenchange":null}},fzh:{configurable:!0,enumerable:!0,get:function(){return"undefined"!==typeof document.webkitFullscreenEnabled?"webkitfullscreenerror":"undefined"!==typeof document.msFullscreenEnabled?"MSFullscreenError":"undefined"!==typeof document.mozFullScreenEnabled?
"mozfullscreenerror":"undefined"!==typeof document.fullscreenEnabled?"fullscreenerror":null}},$ai:{configurable:!0,enumerable:!0,get:function(){return!!document.webkitFullscreenElement||!!document.msFullscreenElement||!!document.mozFullScreenElement||!!document.fullscreenElement}}});Object(Xe.a)(pe,"FullscreenUtils",null,[]);de.prototype.Svc=function(J){var oa=this;this.$y!==J&&(this.X6d=J,this.W5a=this.$y,this.m9e(),this.vJb=this.HZf(),window.requestAnimationFrame(function(){Fe.DOMElementExtensions.toggleCssClass(oa.$.Oq,
"ewr-presentMode-transition",!0);$addHandler(oa.e1a,"transitionend",oa.Lna);oa.gtj(!J);oa.EOi();Fe.DOMElementExtensions.toggleCssClass(oa.$.Oq,"ewr-presentMode-on",J);oa.ftj(J);Ea.b(oa.$).U_f(oa.$y);Ea.c(oa.$).U_f(oa.$y);oa.$.lma();oa.NOa.W_f(oa.vJb);if(oa.$y){oa.sYa();fi.a.get(ab.a.a0f)?oa.mca.qPd(oa.$y):oa.zoc=new Ad(oa.$,oa.mca);var Va=wh.b(oa.$);Va&&(oa.fJd=Va.r6c(!1));oa.TEf=ni.HelperMethods.jc()}else oa.mca.qPd(J),oa.fJd&&(Va=wh.b(oa.$))&&(Va.r6c(!0),oa.fJd=!1),oa.w4b(),oa.Uni()}))};de.prototype.X_f=
function(J,oa){this.vPd=J;this.Vda(oa)};de.prototype.lh=function(J){this.mca.lh(J)};de.prototype.dispose=function(){this.w4b();this.NOa&&(this.NOa.dispose(),this.NOa=null);this.gridView=this.$=null};de.prototype.gtj=function(J){var oa=this.$.da.Aa(25);void 0===oa||null===oa?td.ULS.sendTraceTag(537154324,0,10,"PresentModeManager.ShowOrHideGridPresence: presenceView is null"):J?oa.Mvc():oa.gcc()};de.prototype.EOi=function(){var J=this;Fe.DOMElementExtensions.toggleCssClass(document.getElementById(kd.AFrameworkApplication.n1a),
L.a.yu,this.$y);Fe.DOMElementExtensions.toggleCssClass(this.$.Oq,"ewr-presentMode-on",this.$y);this.jtj(this.$y);this.gridView.lmd=!this.$y;this.SKj();this.$.da.Za(32,function(oa){oa.lLj(J.$y)});Wc.b(this.$,function(oa){oa.$9f(J.$y)})};de.prototype.jtj=function(J){if(this.BEb)if(J){if(J=Object(Ug.a)(uf.a,this.$.oa))Fe.DOMElementExtensions.toggleCssClass(this.$.Oq,"ewr-presentMode-on-headers-off",!J.headersVisible),Fe.DOMElementExtensions.toggleCssClass(this.$.Oq,"ewr-presentMode-on-rtl",Oa.g(this.$).rtl);
this.uzc(0)}else this.$.Oq.classList.remove("ewr-presentMode-on-headers-off"),this.$.Oq.classList.remove("ewr-presentMode-on-rtl"),this.uzc(1)};de.prototype.uzc=function(J){var oa=Object(Ug.a)(uf.a,this.$.oa);if(oa){var Va=parseInt(this.$.Ey.style.right);if(1===J||2===J){if(isNaN(Va)||Va<this.O_a)return;Va-=this.O_a}J&&2!==J||(J=oa.headersVisible,oa=Oa.g(this.$).rtl,J=J?oa?0:32:12,Va=isNaN(Va)?J:Va+J,this.O_a=J);this.$.Ey.style.right=ni.HelperMethods.Qb(Va);this.cze=Va}};de.prototype.SKj=function(){var J=
document.getElementById(this.$.Ib+ab.a.W3b).parentNode;Fe.DOMElementExtensions.toggleCssClass(J,wc.fmh,this.$y)};de.prototype.initialize=function(J){this.NOa=new Pd(J);this.NOa.Z4h();this.mca=new ed(J);this.mca.p4h();this.e1a=document.getElementById("MainApp");this.uSe=this.fDi;$addHandler(this.e1a,pe.ezh,this.uSe);$addHandler(this.e1a,pe.fzh,this.gDi);this.BEb||(this.BEb=document.createElement("div"),this.BEb.className="ewa-presentMode-right-frame",this.$.Ay.appendChild(this.BEb));this.Lna=this.u3i};
de.prototype.sYa=function(){this.gridView.ha.m9(this.dr);this.gridView.ha.j2(this.Sh);this.gridView.rc.wm(this.Mj);this.gridView.rc.hq(this.Rh);this.gridView.DD(this.Wo);this.gridView.view.it(this.iw);this.gridView.xXb(this.Hxa);this.gridView.Ca.gG(this.Hm);this.gridView.Ca.gq(this.Pe);this.$.xa.Pf(this.Yh);this.$.xa.yXa(this.Lba);this.$.xa.pga(this.YCb);this.$.Yz(this.aj);this.$.Rk(this.od);var J=Object(Ug.a)(Mf.a,this.$.xa);J=yl(J.items);for(var oa=J.next();!oa.done;oa=J.next())oa.value.umb(this.$xa)};
de.prototype.w4b=function(){this.gridView&&(this.gridView.ha.Oca(this.dr),this.gridView.ha.L_(this.Sh),this.gridView.rc.im(this.Mj),this.gridView.rc.Rp(this.Rh),this.gridView.lF(this.Wo),this.gridView.view.Wr(this.iw),this.gridView.wqc(this.Hxa),this.gridView.Ca.LH(this.Hm),this.gridView.Ca.Zo(this.Pe));if(this.$){this.$.xa.rg(this.Yh);this.$.xa.P$a(this.Lba);this.$.xa.dma(this.YCb);this.$.RC(this.aj);this.$.ml(this.od);var J=Object(Ug.a)(Mf.a,this.$.xa);J=yl(J.items);for(var oa=J.next();!oa.done;oa=
J.next())oa.value.kHd(this.$xa)}};de.prototype.HZf=function(){if(!this.$y||!this.W5a)return!1;if(1===this.gridView.ha.Te){var J=this.$.oa.activeRange.isSingle,oa=1===this.$.oa.selectedRanges.length&&!J,Va=this.gridView.isEditing,Ub=this.kod;oa||td.ULS.sendTraceTag(537154322,0,50,"PresentModeManager.ShouldShowPresentModeOverlay: Not showing present mode overlay, single cell selection : {0}",J);return this.vPd&&oa&&!Va&&!Ub}return this.vPd};de.prototype.ftj=function(J){J?pe.requestFullscreen(this.e1a):
pe.exitFullscreen()};de.prototype.Vda=function(J,oa,Va){var Ub=this;Va=void 0===Va?!1:Va;void 0!==oa&&oa||(this.vJb=this.HZf());td.ULS.sendTraceTag(555356484,0,100,"PresentModeManager.UpdateLayout: UpdateLayout triggered by {0}, visibility: {1}, immediateUpdate: {2}",J,this.vJb,Va);if(this.kMb&&Va)td.ULS.sendTraceTag(543023559,0,50,"PresentModeManager.UpdateLayout: Cancel update layout for {0}",this.jMb),window.cancelAnimationFrame(this.jMb),this.jMb=0;else if(this.kMb){td.ULS.sendTraceTag(543023558,
0,50,"PresentModeManager.UpdateLayout: Skipping update layout for {0}",J);return}Va?this.CVd(ni.HelperMethods.jc(),J):(this.jMb=window.requestAnimationFrame(function(e){Ub.CVd(e,J)}),this.kMb=!0)};de.prototype.CVd=function(J,oa){var Va=this,Ub=ni.HelperMethods.jc();if(Ub-J>this.adj)this.jMb=window.requestAnimationFrame(function(C){Va.CVd(C,oa)}),this.kMb=!1,td.ULS.sendTraceTag(537154319,0,50,"PresentModeManager.UpdateLayoutCallback: Scheduling update for next frame,  ElapsedTime = {0}ms.",Ub-J);else{this.NOa.W_f(this.vJb);
this.kMb=!1;var e=ni.HelperMethods.jc();J=ni.HelperMethods.jc()-J;Ub=e-Ub;this.ecj(J,oa);td.ULS.sendTraceTag(537154318,0,50,"PresentModeManager.UpdateLayoutCallback: UpdateLayoutTotalDuration = {0}ms. rafTotalDuration = {1}ms",Ub,J)}};de.prototype.m9e=function(){var J=this;oe.a(this.$.userOperationManager,function(oa,Va,Ub){var e=J.$.qa.ta,C=J.$y,M=e.Oa(41,null);M.shouldEnablePresentMode=C;return Le.i(e,"SetPresentMode",M,oa,Va,Ub,null,0)},function(oa){return new Ge.a(252,0,oa)},null)};de.prototype.KRf=
function(){var J=Ke.a(this.gridView.Te);1!==this.gridView.Te||this.$.oa.activeRange.isSingle||(J="Range");this.ftc[J]=this.ftc[J]?this.ftc[J]+1:1};de.prototype.ecj=function(J,oa){var Va=this.pnc[oa]?this.pnc[oa]:0;this.pnc[oa]=Va>J?Va:J;this.onc[oa]=this.onc[oa]?this.onc[oa]+1:1};de.prototype.Uni=function(){var J={},oa=ni.HelperMethods.jc()-this.TEf;J.PresentModeDuration=oa;J.SelectionCountPerObject=Dj.a.toJSON(this.ftc);J.OverlayCountPerCaller=Dj.a.toJSON(this.onc);J.OverlayDurationPerCaller=Dj.a.toJSON(this.pnc);
oa=this.mca.PSh();for(var Va in oa)J[Va]=oa[Va];Gg.b(this.$).ae(yc.a.HTi,J,void 0,!0)};tl.Object.defineProperties(de.prototype,{$y:{configurable:!0,enumerable:!0,get:function(){return this.X6d}}});Object(Xe.a)(de,"PresentModeManager",null,[533,3]);var kj=b(335),mj=pd.a;vm(Vd,mj);Vd.prototype.create=function(){var J=this,oa=qc.GetServiceTaskFactory.Xa(this.$.da,283,284,1);lc.TaskExtensions.Ba(oa,function(){lc.TaskExtensions.Ba(kj.c(oa.result.wo.loadScript("presentMode")),function(){var Va=J.$.da.Aa(423);
Va||(Va=new de(J.$),J.$.da.Ha(423,Va));J.Fb(Va)},J.$.ma,3)},this.$.ma,3)};Vd.ja=function(J){J.da.Ha(424,new Vd(J))};Object(Xe.a)(Vd,"PresentModeManagerFactory",pd.a,[]);var bj=b(169),fj=b(158),Ni=b(675),Rj=b(83),Aj=b(30);Qd.smh="ewa-resizehdr-row-hidden";Qd.rmh="ewa-resizehdr-col-hidden";Object(Xe.a)(Qd,"CssClassNames",null,[]);var rk=b(61),Oi=b(24),oi=b(141),Qk=b(51),fk=b(69),Zk=b(247),uk=b(370);Object(Xe.a)(bc,"HeaderEventCachedInfo",null,[]);Je.prototype.Aze=function(J){return Math.max(0,Math.min(Je.Vlf,
ni.HelperMethods.hBd(J)))};Je.prototype.rze=function(J){return this.fRi(J)};Je.prototype.yVg=function(J){return Math.round(this.O5c*J+2*this.ZVe()+1)};Je.prototype.fRi=function(J){return Math.max(0,Math.min(Je.Dlf,(Math.max(0,Math.min(Sf.a.ejc,J))-2*this.ZVe()-1)/this.O5c))};Je.prototype.ZVe=function(){return Math.floor(Math.max((this.O5c+3)/4,2))};Je.prototype.X$b=function(J,oa){return oa?J?Je.Vlf:Sf.a.Htd:J?Je.Dlf:Sf.a.ejc};Je.Vlf=409;Je.Dlf=255;Object(Xe.a)(Je,"ResizeHeadersConverter",null,[]);
var Ij=b(34),Dk=Rj.a;vm(od,Dk);od.prototype.dispose=function(){this.IZc();this.grid.ha&&(this.grid.ha.Nca(this.Sh),this.grid.ha.Oca(this.dr));this.grid.Us(this.Sh);Ib.a(this.grid.$)&&Ib.a(this.grid.$).pg.ema(this.$E);Vh.a.instance.za(If.a.Ij,this.domElement,this.Nba);bj.a.instance.za(If.a.Wd,this.domElement.ownerDocument.body,this.jlc);fj.a.instance.za(If.a.De,this.domElement.ownerDocument.body,this.jlc);Bf.a.Pr||(bj.a.instance.za(If.a.pointerDown,this.domElement,this.iN),bj.a.instance.za(If.a.kh,
this.domElement,this.bR));this.yab&&(bj.a.instance.za(If.a.kh,this.domElement.ownerDocument.body,this.Mxa),fj.a.instance.za(If.a.Ig,this.domElement.ownerDocument.body,this.Mxa),this.yab=!1);this.EF&&(bj.a.instance.za(If.a.pointerDown,this.EF,this.iN),Vh.a.instance.za(If.a.Ij,this.EF,this.Nba),this.IZc(),this.EF=null);this.DPf&&(Fe.DOMElementExtensions.Sf(od.Bab),od.Bab=null);this.gf=null;Dk.prototype.dispose.call(this)};od.prototype.lhh=function(){if(!od.Bab){document.getElementById(od.CPf);this.DPf=
!0;var J=od.Bab=document.createElement("div");this.grid.$.frame.iaa().appendChild(J);J.id=od.CPf;J.className=Aj.a.tmh;Fe.DOMElementExtensions.setVisible(J,!1)}};od.prototype.zIe=function(){this.yab&&(bj.a.instance.za(If.a.kh,this.domElement.ownerDocument.body,this.Mxa),fj.a.instance.za(If.a.Ig,this.domElement.ownerDocument.body,this.Mxa),this.yab=!1);this.Zaa=!1;this.maj();this.qGd();uk.c(this.grid.$,!0,"HeaderResizeBehavior:PrepareResizeOperation")};od.prototype.maj=function(){this.grid.Nb.kl([this.isRow?
13:14]);this.grid.Nb.mcb()};od.prototype.pTe=function(J,oa,Va){this.wM&&Va&&(td.ULS.sendTraceTag(537154051,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement already created, creating a new element instead"),this.qGd());this.wM||Va||td.ULS.sendTraceTag(537154050,2,15,"HeaderResizeBehavior.GenerateResizeTooltip: headerResizeTooltipElement is null, creating a new element instead");this.isd&&this.isd(function(){var Ub={};return Ub.Location="canvas",Ub});this.wM?this.uTe(oa):
(this.wM=document.createElement("div"),this.wM.id=this.u_h,this.uTe(oa),this.wM.className=Aj.a.hlh,oa=document.getElementById(this.grid.$.Ib+ab.a.wnf),oa.insertBefore(this.wM,oa.firstChild),J=Ij.a(this.grid.$).OJa(J.clientPoint),this.wM.style.left=(this.rtl?Math.max(J.x-this.wM.offsetWidth,0):J.x-Math.max(J.x+this.wM.offsetWidth-oa.offsetWidth,0)).toString()+"px",oa=document.getElementById(ab.a.xFa),this.wM.style.top=(J.y-oa.offsetHeight-this.wM.offsetHeight).toString()+"px")};od.prototype.qGd=function(){Fe.DOMElementExtensions.Sf(this.wM);
this.wM=null};od.prototype.uTe=function(J){var oa=new Je(this.grid.$.workbookContext.DxDigitNormal);this.wM.innerText=String.format("{0} {1} ({2} {3})",this.isRow?this.q_h:this.z_h,this.isRow?oa.Aze(J).toFixed(2):oa.rze(J).toFixed(2),J.toString(),this.t_h)};od.prototype.GEf=function(J,oa){var Va;if(-1!==this.grid.ha.selectionType||2===J.zb&&J.Ea.button||!this.spd(Va=this.Ucd(J))||!this.idf)return!1;fk.g(J.Ea);this.tKb=this.fzb=new Sys.UI.Point(J.clientPoint.x,J.clientPoint.y);this.GOg(Va,oa);if(!this.Dr)return!1;
this.Zaa=!0;this.rei(this.Dr,Va)&&this.m3h();J={};Gg.b(this.grid.$).ae(yc.a.d$i,(J.IsResizingHiddenHeader=this.nVa,J.IsAutoFitting=oa,J.NumberOfSelectedRanges=this.grid.ha.va.nK,J.Location="canvas",J));this.xHb=this.gcd();this.offset=this.Dr.lja();this.$l=this.Dr.Fua();if(this.$l===Sf.a.z4a)return!1;uk.c(this.grid.$,!1,"HeaderResizeBehavior:PrepareResizeOperation");return!0};od.prototype.rei=function(J,oa){var Va=this.Dr.EJ();if(!Va)return td.ULS.shipAssertTag(537154049,2,!1,"cell being resized element received is null"),
!1;Va=Va.nextSibling;if(!Va)return!1;J=J.getRange();Va=this.gf.uua(Va).getRange();if((!J||!Va)&&Eg.EwaSettings.isChangeGateEnabled("OfficeVSO:4307391_ColumnResizeOnSnappingHeaders_IsResizingHidden"))return td.ULS.shipAssertTag(537154048,2,!1,"IsResizingHidden: range is null"),!1;var Ub=J.right===Va.right;return J.right+1!==Va.right&&!Ub&&this.spd(oa,!0)};od.prototype.m3h=function(){var J=this.Dr.EJ(),oa=this.gf.uua(J.nextSibling);od.sei(oa,this.isRow)?(this.Dr=oa,this.y6=this.Dr.getRange()):(this.Kwg(J),
this.Dr=oa,J=this.Dr.getRange(),this.y6=this.isRow?new Oi.Range(J.top-1,J.left,J.top-1,J.right,!1,!0):new Oi.Range(J.top,J.left-1,J.bottom,J.left-1,!1,!0),this.nVa=!0)};od.prototype.Kwg=function(J){var oa=this.gf.uua(J.nextSibling),Va=od.h2g(oa,this.isRow,this.rtl);Va&&J.parentNode.insertBefore(Va,oa.EJ())};od.prototype.a_e=function(J){var oa=this.y6,Va=J.ha.va.selectedRanges;if(J.ha.va.frb(oa))if(this.isRow){if(H.a.all(Va,function(Ub){return Ub.isRow}))return Va}else if(H.a.all(Va,function(Ub){return Ub.Lh}))return Va;
return[oa]};od.prototype.gcd=function(){var J=this.Dr.EJ().style;return Math.max(0,Math.min(this.Flf,0|parseInt(this.isRow?J.height:J.width)))};od.prototype.BPd=function(J){J=void 0===J?0:J;var oa=this.grid,Va=this.gf.sj.paneType;Va=this.isRow?3===Va?[3,2]:[1,4]:4===Va?[2,4]:[1,3];var Ub=oa.view.visibleArea.bottomRight,e=this.Dr.Fua();e===Sf.a.z4a&&(e=0);J=this.nVa?Math.max(this.gcd(),0):Math.max(e+J,0);Ub=this.isRow?new vi.a(0,this.offset,Ub.x,J):new vi.a(this.offset,0,J,Ub.y);e=[this.isRow?13:14];
oa.Nb.Jl(Oi.Range.ld(1,1),e,!1);oa.Nb.Yr(e,Ub,Va);return J};od.prototype.IZc=function(){this.y6=this.tKb=this.fzb=null;if(this.s0){var J=this.s0.parentNode;if(J)for(J.removeChild(this.s0);this.s0.firstChild;)J.appendChild(this.s0.firstChild);this.s0=null}this.Dr=null;Fe.DOMElementExtensions.setVisible(od.Bab,!1);this.Zaa=!1;this.qGd();Fe.DOMElementExtensions.setVisible(this.EF,!1)};od.prototype.Ucd=function(J){if(Fe.DOMElementExtensions.Yy(J.Sb,"a"))return null;var oa=this.Eef(J.Ea);if(oa&&this.grid.ha.va.Dh){var Va=
this.grid.ha.va.Qd;Va=this.gf.Ds(Oi.Range.ld(Va.bottom,Va.right))}else Va=this.gf.uua(J.Sb);if(!Va)return null;var Ub=Va.EJ(),e=new Sys.UI.Bounds(Ub.offsetLeft,Ub.offsetTop,Ub.offsetWidth,Ub.offsetHeight),C=Fe.DOMElementExtensions.getBoundingClientRect(J.Sb);C=new Sys.UI.Point(J.clientPoint.x-C.x,J.clientPoint.y-C.y);this.isRow&&!oa&&(C.y+=ni.HelperMethods.sA(J.Sb,Ub,this.rtl).y);return new bc(Ub,C,e,Va.getRange(),Math.max(od.Ssi,Math.min(od.Dri,(this.isRow?e.height:e.width)*od.n$i)),oa,!this.isRow&&
0<Ub.getElementsByTagName("input").length)};od.prototype.spd=function(J,oa){oa=void 0===oa?!1:oa;if(!J||this.grid.isEditing)return!1;if(J.Def)return!0;var Va=J.BNa,Ub=J.Aab,e=this.gf.sj.paneType,C=this.grid.fg(e).Ph,M=!!C&&C.top===J.lhd.top,qa=!!C&&C.left===J.lhd.left;e=!!C&&C.bottom===J.lhd.bottom&&(3===e||2===e);this.isRow?(qa=J.RAb.y,J=qa<=Ub&&!M,Va=qa>=Va.height-Ub-(e?od.Yyh:0),oa=oa?J:Va||J):(e=J.yZh,M=this.rtl,C=J.RAb.x,J=C<=Ub&&(!qa||M)&&(!e||!M),Va=C>=Va.width-Ub&&(!M||!qa)&&(!e||M),oa=oa?
M?Va:J:J||Va);return oa};od.prototype.GOg=function(J,oa){var Va=this.isRow;if(J.Def)this.Dr=this.gf.uua(J.jva);else if(Va&&J.RAb.y<=J.Aab&&J.BNa.height>J.Aab||!Va&&J.BNa.width>J.Aab&&(!this.rtl&&J.RAb.x<=J.Aab||this.rtl&&J.RAb.x>=J.BNa.width-J.Aab)){if(this.Dr=J.jva.previousSibling?this.gf.uua(J.jva.previousSibling):this.uLh(),oa&&J.jva.classList.contains(Va?Aj.a.XNe:Aj.a.WNe)&&(J=this.gf.uua(J.jva)))J=J.getRange(),this.y6=Va?new Oi.Range(J.top-1,J.left,J.top-1,J.right,!1,!0):new Oi.Range(J.top,J.left-
1,J.bottom,J.left-1,!1,!0)}else this.Dr=this.gf.uua(J.jva);!this.y6&&this.Dr&&(this.y6=this.Dr.getRange())};od.prototype.uLh=function(){var J=this.isRow?1:0;return(J=this.gf.sj.JF(this.gf.sj.Ca.Eg(this.grid.$.oa,rk.a.YL(this.gf.position.X+J-1,this.gf.position.Y-J,this.gf.position.PaneType))))?J.tLh():null};od.prototype.l5h=function(){var J=this.o$i;Fe.DOMElementExtensions.setVisible(J,!0);J.style.cursor=this.isRow?Aj.a.iLe:Aj.a.aKe;this.BPd()};od.prototype.Dgh=function(J){var oa={};this.grid.$.Ce(this.isRow?
745189930:-445963340,Yc.a.Wb,30,(oa.resizeRowColumnParameters=J,oa))};od.prototype.a6g=function(){var J=document.createElement("div");J.className=Aj.a.fnh;var oa=document.createElement("div");oa.className=L.a.OB;J.appendChild(oa);var Va=document.createElement("img");Va.src=Qk.a.Be(0);Va.className=this.isRow?L.a.qmh:L.a.nmh;oa.appendChild(Va);this.gf.HB.domElement.parentNode.insertBefore(J,this.gf.HB.domElement);bj.a.instance.pa(If.a.pointerDown,J,this.iN);Vh.a.instance.pa(If.a.Ij,J,this.Nba);Fe.DOMElementExtensions.setVisible(J,
!1);this.EF=J};od.prototype.nqc=function(){this.IZc();this.EF&&(this.gf.HB.domElement.parentNode.removeChild(this.EF),this.EF=null)};od.prototype.Eef=function(J){return Fe.DOMElementExtensions.Ye(this.EF,J.target)};od.prototype.zob=function(){this.Zaa&&(this.zIe(),Fe.DOMElementExtensions.KSa(this.Dr.EJ(),!this.isRow,this.xHb),this.nqc(),this.nVa=!1)};od.prototype.Oaf=function(){return Eg.EwaSettings.la(709)};od.prototype.O6e=function(J){(J=J.Ea.rawEvent)&&J.detail===od.Rdj&&(J.type===If.a.Mp?(this.Zaa=
!1,this.OVc=!0):J.type===If.a.AH&&(this.Zaa=!0,this.OVc=!1))};od.d2g=function(J,oa){return new od(J,oa)};od.sei=function(J,oa){if(!J||!J.EJ())return td.ULS.shipAssertTag(537154014,2,!1,"header after hidden headers is null"),!1;var Va=J.getRange();J=J.EJ().style;if(!Va||!J)return td.ULS.shipAssertTag(537154013,2,!1,"header range or style is null"),!1;J=oa?J.height:J.width;return(oa?Va.top:Va.left)===(oa?Sf.a.Fh:Sf.a.Qh)&&J===od.Rcg};od.h2g=function(J,oa,Va){if(!J)return td.ULS.shipAssertTag(537154012,
2,!1,"header after hidden is null"),null;var Ub=J.EJ();if(!Ub||!Ub.style)return td.ULS.shipAssertTag(537154011,2,!1,"header after hidden element or style is null"),null;J=document.createElement("div");var e=Ub.style;J.style.top=oa?e.top:od.Rcg;oa||(Va?J.style.right=e.right:J.style.left=e.left);J.classList.add(oa?Qd.smh:Qd.rmh);J.classList.add(oa?Aj.a.jsb:Aj.a.isb);Va=document.createElement("div");Va.classList.add(oa?Aj.a.LNe:Aj.a.p8c);Ub=oa?Number.parseInvariant(Ub.innerText):Oi.Range.WZa(Ub.innerText);
Va.innerText=oa?(Ub-1).toString():Oi.Range.sY(Ub-1);J.appendChild(Va);return J};od.AMd=function(J,oa,Va){if(oa)for(J.ColumnWidth=-1,J.RowHeight=Va,J=yl(J.SheetMultiRange.Ranges),oa=J.next();!oa.done;oa=J.next())oa=oa.value,oa.FirstColumn=0,oa.LastColumn=0;else for(J.RowHeight=-1,J.ColumnWidth=Va,J=yl(J.SheetMultiRange.Ranges),oa=J.next();!oa.done;oa=J.next())oa=oa.value,oa.FirstRow=0,oa.LastRow=0};tl.Object.defineProperties(od.prototype,{idf:{configurable:!0,enumerable:!0,get:function(){var J=(new oi.a(this.grid.$.xa)).te(this.isRow?
16:8),oa=this.grid.$.Ab.XJ,Va=this.grid.zi,Ub=Ib.a(this.grid.$).sq();return J&&!oa&&!Va&&!Ub}},o$i:{configurable:!0,enumerable:!0,get:function(){this.lhh();return od.Bab}}});od.Ssi=0;od.Dri=5;od.Yyh=3;od.n$i=.1;od.CPf="ewa-rszrbg";od.Rcg="0px";od.Rdj=2;od.Bab=null;Object(Xe.a)(od,"HeaderResizeBehavior",Rj.a,[]);var Ek=pd.a;vm(Xd,Ek);Xd.prototype.create=function(){this.Fb(od.d2g)};Xd.ja=function(J){J.da.Ha(136,new Xd)};Object(Xe.a)(Xd,"HeaderResizeBehaviorFactory",pd.a,[]);var vk=b(179),Ej=b(415),
rj=b(519),Jj=b(67);Object(Xe.a)(Jd,"MacroRecorderSheetRowsColumnsAutoFitPayload",null,[116]);Object(Xe.a)(ad,"MacroRecorderSheetRowsColumnsResizedPayload",null,[116]);var Zi=xd.a;vm(Ac,Zi);Ac.prototype.MU=function(J,oa){var Va={};return Va[Ac.x4]=this.xc,Va[Ac.Eei]=this.isRow,Va[Ac.K3h]=J,Va[Ac.J3h]=oa,Va[Ac.Kbi]=this.zyb,Va[Ac.hdd]=this.gub,Va};Ac.prototype.fPg=function(){var J=this.cCh();try{return this.wGh(J)}finally{J&&J.dispose()}};Ac.prototype.I_g=function(J){var oa={};oa.SheetMultiRange=rh.r(this.gridView.ha.va.selectedRanges,
this.$);Ac.AMd(oa,this.isRow,J);J={};this.$.Ce(this.isRow?745189930:-445963340,Yc.a.Wb,8,(J.resizeRowColumnParameters=oa,J))};Ac.prototype.T0e=function(J,oa){return Fc.a.jV(J)?oa?this.uZg(J):this.wZg(J):Ac.Laa};Ac.prototype.wZg=function(J){return Math.floor(parseFloat(J))};Ac.prototype.uZg=function(J){J=parseFloat(J);return 0>J?Ac.Laa:J?this.isRow?ni.HelperMethods.nRi(J):this.Lrc.yVg(J):0};Ac.prototype.xZg=function(J){return J===Ac.Laa?"":this.isRow?this.Lrc.Aze(J).toString():this.Lrc.rze(J).toFixed(2)};
Ac.prototype.vZg=function(J){return J===Ac.Laa?"":J.toString()};Ac.prototype.wGh=function(J){if(!J||!J.$$mn()||!J.Wn)return Ac.Laa;var oa=Object(Ug.a)(419,J.Wn);if(!oa)return Ac.Laa;for(oa=this.isRow?oa.Ewb:oa.vjd;J.$$mn();){var Va=Object(Ug.a)(419,J.Wn);if(Va&&(this.isRow?Va.Ewb:Va.vjd)!==oa)return Ac.Laa}return oa};Ac.prototype.cCh=function(){for(var J=[],oa=yl(this.gridView.ha.va.selectedRanges),Va=oa.next();!Va.done;Va=oa.next()){Va=Va.value.clone();var Ub=this.gridView.fg(this.gridView.$a.Kj(Va));
Ub=Va.Jf(Ub.Ph);if(!Ub)return null;this.isRow?Va.right=Va.left=Ub.left:Va.top=Va.bottom=Ub.top;Array.add(J,Va)}return J.length?this.gridView.m$("ResizeHeadersDialog.GetActiveRowColumnLoadedRangeEnumerator",J):null};Ac.prototype.idd=function(J){if(!Fc.a.jV(J))return 1;J=this.T0e(J,this.zyb);return!J&&this.qei()?3:this.dhi(J)?0:2};Ac.prototype.qei=function(){var J=this.gridView.ha.va.selectedRanges;return this.isRow&&rh.P(J)||!this.isRow&&rh.O(J)};Ac.prototype.Fad=function(J){var oa="";switch(J){case 0:oa=
"";break;case 1:oa=nf.a.instance.ea(751);break;case 2:J=this.zyb;oa=String.format(nf.a.instance.Cb(98),0,this.X$b(J));break;case 3:oa=nf.a.instance.ea(752)}return oa};Ac.prototype.dhi=function(J){return 0<=J&&J<=this.X$b(!1)};Ac.prototype.X$b=function(J){return this.Lrc.X$b(J,this.isRow)};Ac.AMd=function(J,oa,Va){if(oa)for(J.ColumnWidth=Ac.Laa,J.RowHeight=Va,J=yl(J.SheetMultiRange.Ranges),oa=J.next();!oa.done;oa=J.next())oa=oa.value,oa.FirstColumn=0,oa.LastColumn=0;else for(J.RowHeight=Ac.Laa,J.ColumnWidth=
Va,J=yl(J.SheetMultiRange.Ranges),oa=J.next();!oa.done;oa=J.next())oa=oa.value,oa.FirstRow=0,oa.LastRow=0};tl.Object.defineProperties(Ac.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"ResizeHeadersDialog"}},zyb:{configurable:!0,enumerable:!0,get:function(){return Ac.i7d},set:function(J){Ac.i7d=J}}});Ac.x4="id";Ac.Eei="isRow";Ac.K3h="initialSizeInPx";Ac.J3h="initialSizeInDefaultUnits";Ac.Kbi="isInitialUnitsDefaultUnits";Ac.hdd="getInputErrorIfInvalid";Ac.Buj="size";Ac.D$h="isDefaultUnits";
Ac.Laa=-1;Ac.i7d=!0;Object(Xe.a)(Ac,"ResizeHeadersDialog",xd.a,[]);var gk=b(586);cc.prototype.Xc=function(J,oa){J=!0;switch(oa){case -445963340:case 1391094586:J=this.te(8);break;case 745189930:case 146338636:J=this.te(16)}return!J};cc.prototype.executeCommand=function(J,oa,Va){var Ub=lc.TaskExtensions.om();var e=Oa.g(this.$);J=vk.a.create().toString();var C=oa.command;switch(C){case 1391094586:case 146338636:var M=1391094586===C;(J=Va.autoFitRanges)&&J.Ranges&&J.Ranges.length||(J=rh.r(e.ha.va.selectedRanges,
this.$));Ub=this.fch(M?1:0,J,oa);break;case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:M=-445963340===C||-706918724===C||369708605===C;if(-445963340===C||745189930===C)M=Ej.a(oa.command),e.Ji.Y6(16,J,M),Va=Va.resizeRowColumnParameters;else{var qa=e.ha.va.selectedRanges;if(-706918724===C&&6===oa.df&&rh.O(qa)){td.ULS.sendTraceTag(537154007,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideColumn' was ignored because entire row is selected");break}if(1051390410===
C&&6===oa.df&&rh.P(qa)){td.ULS.sendTraceTag(537154006,0,50,"ResizeCommandHandler.HandleResizeCommand: Command 'HideRow' was ignored because entire column is selected");break}e=369708605===C||1542466017===C?-2:0;Va={};Va.SheetMultiRange=rh.r(qa,this.$);if(M)for(Ub=yl(Va.SheetMultiRange.Ranges),C=Ub.next();!C.done;C=Ub.next())C=C.value,C.FirstRow=0,C.LastRow=0;else for(Ub=yl(Va.SheetMultiRange.Ranges),C=Ub.next();!C.done;C=Ub.next())C=C.value,C.FirstColumn=0,C.LastColumn=0;Va.RowHeight=M?-1:e;Va.ColumnWidth=
M?e:-1}Ub=this.Ach(Va,oa,J);break;case 957527587:case 2040891415:new Ac(this.$,oa)}return Ub};cc.prototype.Gc=function(J,oa,Va,Ub){if(J=!!Va&&!!Ub&&1===Ub.eA)switch(oa.command){case 1391094586:case 146338636:case -445963340:case 745189930:case -706918724:case 1051390410:case 369708605:case 1542466017:case 957527587:case 2040891415:break;default:J=!1}return J};cc.prototype.fd=function(){return!1};cc.prototype.mni=function(J){td.ULS.sendTraceTag(537154004,0,50,"ResizeCommandHandler.LogInstantaneousResize: Resize operation succeeded: {0}. Reason: {1}.",
J.success,Object(gk.c)(J)?void 0:J.reason)};cc.prototype.te=function(J){return(new oi.a(this.$.xa)).te(J)};cc.prototype.fch=function(J,oa,Va){function Ub(){return new Jd(M,oa)}var e=this,C=this.$.qa.ta.Xb(),M=!J;return oe.a(this.$.userOperationManager,function(qa,Na,Hb){var Gc=e.$.qa.ta,gd=Gc.Oa(41,C);gd.isRow=M;gd.autoFitRanges=oa;return Le.i(Gc,"AutoFit",gd,qa,Na,Hb,null,0)},function(qa){return new Ge.a(135,0,qa,void 0,Ub)},Va)};cc.prototype.Ach=function(J,oa,Va){function Ub(){return new ad(J)}
var e=this,C=rh.g(J.SheetMultiRange.Ranges),M=oa.command;if(745189930===M||-445963340===M){td.ULS.shipAssertTag(537154002,0,this.$.activeItemName===J.SheetMultiRange.SheetName,"ResizeCommandHandler.DoResize: should do CSE for active sheet only!");var qa=Oa.g(this.$);M=745189930===M;qa=this.hi.Ksj(qa,C,M?J.RowHeight:J.ColumnWidth,M);this.mni(qa);Object(gk.c)(qa)&&Oa.g(this.$).Ji.n0(Va,Jj.BasicTelemetryCalculator.sQ)}var Na=this.$.qa.ta.Xb(!0);return oe.a(this.$.userOperationManager,function(Hb,Gc,
gd){e.$.Xu();rh.i(C,",",e.$,!1);var Uc=e.$.qa.ta;Hb=T.b(Hb,e.cJi);var Wd=Uc.Oa(41,void 0===Na?null:Na);Wd.resizeRowColumnParameters=J;return Le.i(Uc,"ResizeRowsColumns",Wd,Hb,Gc,gd,Va,0)},function(Hb){return new Ge.a(136,0,Hb,void 0,Ub)},oa)};Object(Xe.a)(cc,"ResizeCommandHandler",null,[237]);var Xh=Ka.a;vm(pb,Xh);pb.prototype.Md=function(){var J=this,oa=qc.GetServiceTaskFactory.create(this.$.da,18,this.ma,this.tb);lc.TaskExtensions.Ba(oa,function(){J.Ed([new cc(J.$,oa.result)])},this.ma,3)};pb.ja=
function(J){Ka.a.de(113,new pb(J))};Object(Xe.a)(pb,"ResizeCommandHandlerFactory",Ka.a,[]);za.prototype.Xc=function(){return!1};za.prototype.executeCommand=function(J,oa,Va){J=2;switch(oa.command){case -309686558:J=this.Di.ze(Pg.a.saveACopy,2,Va);break;case 617689800:J=this.Di.ze(Pg.a.saveToCloudStorage,2,Va);break;case -1244760097:J=this.Di.ze(Pg.a.saveToSharePoint,2,Va)}return 2===J&&oa?Cd.a(oa.command):nb.Task.Ta(!0)};za.prototype.Gc=function(J,oa){J=!1;switch(oa.command){case -1244760097:case -309686558:case 617689800:J=
!0,td.ULS.shipAssertTag(537153984,0,this.$.Yja,"Command execute requested for SaveAs operation when data duplication is disallowed.")}return J};za.prototype.fd=function(){return!1};Object(Xe.a)(za,"SaveToHostCommandHandler",null,[237]);var Ok=Ka.a;vm(uc,Ok);uc.prototype.Md=function(){var J=this;lc.TaskExtensions.Ba(qc.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.tb),function(){J.Ed([new za(J.$,kd.AFrameworkApplication.Eb)])},this.ma,3);kd.AFrameworkApplication.Eb.$b(Pg.a.hQa,th.a.frame,
this.Qxh)};uc.ja=function(J){Ka.a.de(267,new uc(J))};Object(Xe.a)(uc,"SaveToHostCommandHandlerFactory",Ka.a,[]);Ic.prototype.Xc=function(J){switch(J){case -309686558:return 8===this.Di.processAction(Pg.a.saveACopy,1,null);case 617689800:return 8===this.Di.ze(Pg.a.saveToCloudStorage,1,null);case -1244760097:return 8===this.Di.ze(Pg.a.saveToSharePoint,1,null)}return!1};Ic.prototype.dispose=function(){this.$=null};Object(Xe.a)(Ic,"SaveToHostManager",null,[530,3]);var wk=pd.a;vm(Jb,wk);Jb.prototype.create=
function(){this.Fb(this.$.da.Aa(393)||new Ic(this.$,kd.AFrameworkApplication.Eb))};Jb.ja=function(J){J.da.Ha(394,new Jb(J))};Object(Xe.a)(Jb,"SaveToHostManagerFactory",pd.a,[]);var Pk=Lj.a;vm(Zb,Pk);Zb.prototype.execute=function(J){var oa=Object(Ug.a)(8,J.Ge);td.ULS.shipAssertTag(537153921,0,Ah.a.Ymb(J.errors),"SessionReloadActivity.Execute: Only recoverable errors should reach this activity.");oa.KH(!0,!0);J.activityState[fg.a.RWb]=oa.fa.sessionId;J.activityState[fg.a.Ilb]=!0;J.activityState[fg.a.XWb]=
!0;td.ULS.sendTraceTag(537153920,0,50,"SessionReloadActivity.Execute: session is going to reopen from cached state");return 3};Object(Xe.a)(Zb,"SessionReloadActivity",Lj.a,[]);var lk=pd.a;vm(db,lk);db.prototype.create=function(){this.Fb(new Zb(he.a.hbb,he.a.Dk))};db.ja=function(J){J.da.Ha(142,new db)};Object(Xe.a)(db,"SessionReloadActivityFactory",pd.a,[]);var Fj=b(52),Wj=b(260),xk=b(106),ak=b(46),Fk=b(244),hk=b(112),nj=Lj.a;vm(Ba,nj);Ba.prototype.execute=function(J){var oa=Object(Ug.a)(8,J.Ge);J.activityState[fg.a.Xqa]=
!0;var Va=Ba.LRh(J);if(Ba.xoj(J,Va))return Ba.Sqi(J),Va=50,0<J.errors.length&&(Va=15),td.ULS.sendTraceTag(537153891,0,Va,"SessionReloadSilentActivity.ShouldCancelReload: ignore session reload, remaining errors : {0}",Ah.a.Uc(J.errors)),J.activityState[fg.a.Xqa]=!1,this.oh(he.a.idle),3;switch(Va){case 1:case 3:this.U5h(J,Va);break;case 2:this.T5h(J);break;case 0:J.activityState[fg.a.kXa]=null}td.ULS.sendTraceTag(21837003,0,50,"SessionReloadSilentActivity.Execute: silentReloadType:{0}. activityName:{1}. NextActivityName:{2}. TimeFromLastStatefulResponse:{3}.",
Va,this.activityName,this.j_,oa.fa.j7);var Ub=qj.a.ug(J.activityState,hk.a.tdb);td.ULS.shipAssertTag(40502925,0,!Ub||Ub&&(1===Va||3===Va),"triggerSilentReloadAfterTokenRefresh: {0}, silentReloadType: {1}",Ub,Va);oa=oa.Mk.reloadCount;return Va&&0<oa?(Ub=Wj.a.Qua(oa,200),td.ULS.sendTraceTag(537153890,0,50,"SessionReloadSilentActivity.Execute: schedule Silent-Type [{0}] retryNum [{1}] delayInMs [{2}] activityName [{3}]",Va,oa,Ub,this.activityName),lj.a.instance.create(function(){Ba.kJ(J)},Ub,Zj.a.Fgj),
1):3};Ba.prototype.U5h=function(J,oa){td.ULS.sendTraceTag(8438495,0,50,"SessionReloadSilentActivity.InitiateSilentReopen: Silent reopen triggered");var Va=Object(Ug.a)(8,J.Ge);J.activityState[fg.a.Ilb]=!0;Va.Rdc||ak.PageLoadTrackingInfo.instance.Fj("ReopenOnLoad");!Ba.isEditMode(J)&&Ah.a.Ymb(J.errors)&&(td.ULS.sendTraceTag(537153889,0,50,"SessionReloadSilentActivity.ShouldAttemptViewSilentReopen: session is going to reopen from cached state"),J.activityState[fg.a.RWb]=Va.fa.sessionId,J.activityState[fg.a.XWb]=
!0);J.utd();3===oa?(Va.fa.Qg()||Va.fa.Bwi(),Va.KH(!0,!0),this.oh(this.zDj),J.activityState[fg.a.oie]=Va.workbookContext.CalcMode):(Eg.EwaSettings.isChangeGateEnabled("OfficeVSO:5678588_FixSilentReopenAfterTokenRefresh")&&1===oa&&Va.KH(!0,!0),J.activityState[fg.a.TRc]=!1,this.oh(this.cwc))};Ba.prototype.T5h=function(J){td.ULS.sendTraceTag(537153888,0,15,"SessionReloadSilentActivity.InitiateSilentRefresh: Silent refresh triggered");J.activityState[fg.a.kXa]=null;J.utd();this.oh(this.uuj);J=Object(Ug.a)(8,
J.Ge);J.Rdc||(ak.PageLoadTrackingInfo.instance.Fj("RefreshOnLoad"),J.zGb())};Ba.kJ=function(J){J.kJ()};Ba.LRh=function(J){var oa=Object(Ug.a)(8,J.Ge),Va=oa.fa,Ub=Ba.isEditMode(J),e=Ah.a.gh(J.errors,Ub?Ba.htd:Ba.itd),C=Ah.a.gh(J.errors,Ub?Ba.Ykf:Ba.Zkf),M=oa.uQ,qa=oa.Mk.reloadCount,Na=oa.ya.MaxConsecutiveSilentReloadAllowed,Hb=oa.Mk.w4e(),Gc=Ah.a.Uc(J.errors),gd=Ah.a.Uc(J.Fya),Uc=0<Ah.a.hM(function(Gf){return!Gf.triggerSilentReopenOnly},J.errors).length,Wd=e,We=qj.a.ug(J.activityState,hk.a.tdb);We&&
(Wd=!0);e={name:"SessionReloadSilentActivity.GetSilentReloadType",editMode:Ub,isSilentReopenError:e,isSilentRefreshError:C};e.reloadSequenceCount=oa.Mk.uPa;e.reloadCount=qa;e.maxReloads=Na;e.stopSilentReloads=Hb;e.errorNames=Gc;e.processedErrorNames=gd;e.isClientDirty=M;e.errorsForSilentReopenOnly=Uc;e.triggerSilentReloadAfterTokenRefresh=We;e.IsReopenDisabled=oa.WLa;M=Fj.a.Hc(e);td.ULS.sendTraceTag(21837004,0,50,M);if(!Hb){if(Wd&&(Ub?Ba.noj(J):Ba.poj(J)))return Fk.a.FYf(J,oa)?3:oa.WLa?2:1;if(C&&
(Ub||!Va.s$a))return 2}return 0};Ba.xoj=function(J,oa){for(var Va=yl(J.errors),Ub=Va.next();!Ub.done;Ub=Va.next())if(Ub=Ub.value,-1337545025===Ub.MessageId||-238814601===Ub.MessageId)return!1;return Ah.a.hM(function(e){return!e.triggerSilentReopenOnly},J.errors).length?3!==oa:!1};Ba.Sqi=function(J){var oa=Ah.a.hM(function(Ub){return!Ub.triggerSilentReopenOnly},J.errors);oa=yl(oa);for(var Va=oa.next();!Va.done;Va=oa.next())J.Oka(Va.value)};Ba.isEditMode=function(J){var oa=Object(Ug.a)(8,J.Ge);return oa.fa.oc?
oa.Ju&&!!(oa.Fd&64):qj.a.ug(J.activityState,fg.a.rs)};Ba.poj=function(J){var oa=Object(Ug.a)(8,J.Ge),Va=Ah.a.L$(J.errors,Ba.itd);if(xk.b(Va,function(Ub){return Ub.ForceVersionUpgrade}))return!1;J=Ah.a.Ymb(J.errors);return!oa.fa.s$a||J?!0:!1};Ba.noj=function(J){J=Ah.a.L$(J.errors,Ba.htd);return!xk.b(J,function(oa){return oa.ForceVersionUpgrade})};Ba.itd=null;Ba.htd=null;Ba.Zkf=null;Ba.Ykf=null;Object(Xe.a)(Ba,"SessionReloadSilentActivity",Lj.a,[]);var Gk=pd.a;vm(Wa,Gk);Wa.prototype.create=function(){this.Fb(new Ba(this.activityName,
this.$L,he.a.Dk,he.a.lj,he.a.FLb))};Wa.ja=function(J){J.da.Ha(143,new Wa(he.a.Hma,he.a.HZb));J.da.Ha(144,new Wa(he.a.Gtc,he.a.kOa));J.da.Ha(145,new Wa(he.a.Htc,he.a.Ozd));J.da.Ha(154,new Wa(he.a.ibb,he.a.kO))};Object(Xe.a)(Wa,"SessionReloadSilentActivityFactory",pd.a,[]);Za.prototype.getSheetName=function(){return this.sheetName};Za.prototype.getValue=function(){return this.value};Object(Xe.a)(Za,"MacroRecorderSheetOptionToggledPayload",null,[116]);kb.prototype.Xc=function(){return!1};kb.prototype.executeCommand=
function(J,oa){function Va(){return new Za(Ub.SheetName,Hb)}var Ub={};this.$.wj(Ub);J=oa.command;var e=Object(Ug.a)(uf.a,this.$.xa.getItemByName(Ub.SheetName));if(!e)return Cd.a(J);switch(J){case 705559150:case -1411193626:var C=16;var M=!e.hideGridLines;var qa=dc;var Na=183;var Hb=e.hideGridLines;break;case -2052321504:case 515737500:C=4;M=!e.headersVisible;qa=Xb;Na=184;Hb=!e.headersVisible;break;case -1478455630:C=2;M=!e.displayRtl;qa=$a;Na=185;Hb=!e.displayRtl;Oa.g(this.$).Ca.pIj(M);break;default:return Cd.a(J)}e.Hob(C,
M);var Gc=this.$.qa.ta;return oe.a(this.$.userOperationManager,function(gd,Uc,Wd){return qa(Gc,Ub.SheetName,Hb,T.b(gd,function(We){kb.eDb(We,e,C,M)}),T.a(Uc,function(){kb.hCb(e,C,M)}),Wd,null)},function(gd){return new Ge.a(Na,0,gd,void 0,Va)},oa)};kb.prototype.Gc=function(J,oa){J=!1;switch(oa.command){case -1411193626:case 515737500:case -1478455630:J=!0;break;case 705559150:case -2052321504:J=uk.a(this.$)}return J};kb.prototype.fd=function(){return!1};kb.eDb=function(J,oa,Va,Ub){Ah.a.Pq(J.Errors)&&
oa.Hob(Va,!Ub)};kb.hCb=function(J,oa,Va){J.Hob(oa,!Va)};Object(Xe.a)(kb,"SheetOptionsToggleCommandHandler",null,[237]);var Lg=Ka.a;vm(Ua,Lg);Ua.prototype.Md=function(){this.Ed([new kb(this.$)])};Ua.ja=function(J){Ka.a.de(100,new Ua(J))};Object(Xe.a)(Ua,"SheetOptionsToggleCommandHandlerFactory",Ka.a,[]);var Hk=b(59),Ik=b(203),yk=Ik.a;vm(Ha,yk);Ha.prototype.initialize=function(){var J=this.$.Ib+"iframeDialog_frame",oa=this.$.Ib+"iframeDialog";var Va=String.format('<iframe id="{0}" frameborder="0" scrolling="auto" src="{1}">\r\n</iframe>',
J,this.QWe(oa));this.Ob.style.margin=ni.HelperMethods.Qb(0);this.Ob.style.marginBottom=ni.HelperMethods.Qb(-2);this.Ob.innerHTML=Va;this.OHc=document.getElementById(J);this.domElement.id=oa;this.onResize(null,Sys.EventArgs.Empty);Bf.a.dfc&&lj.a.instance.create(this.Pgh,50,Zj.a.a1h,!0,!0);yk.prototype.initialize.call(this)};Ha.prototype.dispose=function(){this.$&&this.$.RC(this.onResize);yk.prototype.dispose.call(this)};Ha.prototype.setFocus=function(){Fe.DOMElementExtensions.setFocus(this.GKa)};Ha.prototype.onHide=
function(){this.GKa.contentWindow.close();Fe.DOMElementExtensions.Sf(this.GKa);this.OHc=null;yk.prototype.onHide.call(this)};Ha.prototype.ZIj=function(J){var oa=this.domElement.style;oa.width=ni.HelperMethods.Qb(J.x);oa.marginLeft=ni.HelperMethods.Qb(-J.x/2)};Ha.prototype.zKh=function(){var J=Fe.DOMElementExtensions.getBounds(document.body);return new Sys.UI.Point(Math.min(Math.floor(.9*J.width),this.XDe.x),Math.min(Math.floor(.9*J.height),this.XDe.y))};tl.Object.defineProperties(Ha.prototype,{GKa:{configurable:!0,
enumerable:!0,get:function(){return this.OHc}}});Object(Xe.a)(Ha,"IFrameDialog",Ik.a,[]);vm(Ga,Ha);Ga.prototype.QWe=function(J){var oa=new Sys.StringBuilder(this.$.ya.EmbedConfiguratorUrl);Lh.a.Vf(oa,ab.a.Uih,J);Zd.a(this.$.ya,34)&&Lh.a.Vf(oa,ab.a.bKe,"1");Zd.a(this.$.ya,35)&&Lh.a.Vf(oa,ab.a.cKe,"1");return oa.toString()};Ga.prototype.onShow=function(){td.ULS.sendTraceTag(537151690,0,50,"EmbeddingDialog.OnShow: the dialog is being shown");Ha.prototype.onShow.call(this)};tl.Object.defineProperties(Ga.prototype,
{xc:{configurable:!0,enumerable:!0,get:function(){return"EmbeddingDialog"}}});Object(Xe.a)(Ga,"EmbeddingDialog",Ha,[]);bb.VXf="FrameDialog_ShareFromEdit";bb.view="FrameDialog_View";bb.Mwe="FrameDialog_CloseAndRefresh";bb.ynj="FrameDialog_ShareFromView";bb.edit="FrameDialog_Edit";bb.O_i="FrameDialog_RefreshGrid";bb.UUg="FrameDialog_CloseMe";bb.Wwe="FrameDialog_CloseMeError";bb.ready="FrameDialog_Ready";bb.mRi="FrameDialog_PleaseClose";bb.TG="GotoRange";Object(Xe.a)(bb,"PostMessageConstants",null,[]);
var bk=b(105);Object(Xe.a)(ka,"SessionUpdateContext",null,[]);vm(Mb,Ha);Mb.prototype.ZAg=function(J){this.addHandler(Mb.brd,J)};Mb.prototype.d5i=function(J){this.removeHandler(Mb.brd,J)};Mb.prototype.dispose=function(){Mg.a.Fa(this.G_a);this.G_a=null;Ha.prototype.dispose.call(this)};Mb.prototype.initialize=function(){Ha.prototype.initialize.call(this);var J=Kg.a.maa(this.$.ya.FormLightBoxUrl),oa=this.G_a=new K.a(this.GKa.contentWindow,J);oa.isEnabled()&&oa.TEa(J)&&(this.Zla(bb.VXf,this.Qmc),this.Zla(bb.view,
this.Qmc),this.Zla(bb.Mwe,this.Qmc),this.Zla(bb.ynj,this.qKi),this.Zla(bb.edit,this.iCi),this.Zla(bb.O_i,this.Qmc),this.Zla(bb.ready,this.IIi),this.Zla(bb.UUg,this.Vrf),this.Zla(bb.Wwe,this.Vrf))};Mb.prototype.close=function(J){J===this.closeAction&&this.wbf&&this.G_a.send(new tj.a(bb.mRi))||Ha.prototype.close.call(this,J)};Mb.prototype.QWe=function(){return this.YAe(this.Tfc)};Mb.prototype.YAe=function(J){var oa=this.$.ya,Va=new Sys.StringBuilder(oa.FormLightBoxUrl);Lh.a.Vf(Va,ab.a.myh,this.$.fa.sessionId);
Lh.a.Vf(Va,ab.a.kyh,J?ab.a.lyh:ab.a.jyh);$h.a.yFa(Va,oa);return Va.toString()};Mb.prototype.cag=function(J){this.bJc=!1;this.GKa.src=this.YAe(J);this.Y6d=J};Mb.prototype.Zla=function(J,oa){this.G_a.Qn(J);this.G_a.Km(J,oa)};Mb.prototype.Jlc=function(J){var oa=this.$.fa.xa.getItemByName(J.TG.SheetName);oa&&!oa.ey&&Oa.g(this.$).yi(J.TG,null,null,null,20,bk.a.Uxh)};tl.Object.defineProperties(Mb.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"FormDialog"}},wbf:{configurable:!0,enumerable:!0,
get:function(){return this.bJc}},Tfc:{configurable:!0,enumerable:!0,get:function(){return this.Y6d}}});Mb.b9g=900;Mb.D8g=1200;Mb.brd="lightBoxReady";Object(Xe.a)(Mb,"FormDialog",Ha,[232]);var Sg;(function(J){J[J.comment=10]="comment";J[J.range=12]="range";J[J.table=13]="table";J[J.chart=14]="chart"})(Sg||(Sg={}));Object(Xe.b)("NavigationType",Sg);var zk=b(1018),Mj=b(114),cj=b(580),ck=b(1077),V=b(278),va=b(852),jb=va.a;vm(E,jb);E.prototype.initialize=function(){var J="<div class='"+Mj.a.xu+"'>\r\n\t<div class='"+
Mj.a.oKe+"'>\r\n\t\t<div class='"+L.a.ZZc+"'>\r\n\t\t\t<img src='{0}' class='"+L.a.gNe+"' alt='{1}' />\r\n\t\t</div>\r\n\t</div>\r\n\t<div class='"+Mj.a.rKe+"'>\r\n\t\t<p>{2}</p>\r\n\t</div>\r\n</div>";J=String.format(J,Qk.a.Be(13),nf.a.instance.ea(25),nf.a.instance.ea(this.message));this.Ob.innerHTML=J;this.addButton(0,this.jyi);this.addButton(1);jb.prototype.initialize.call(this)};E.prototype.Uw=function(){return this.wXd};tl.Object.defineProperties(E.prototype,{xc:{configurable:!0,enumerable:!0,
get:function(){return"WebMethodConfirmationDialog"}},Cw:{configurable:!0,enumerable:!0,get:function(){return 1005}},fsa:{configurable:!0,enumerable:!0,get:function(){return this.operationFlags}}});Object(Xe.a)(E,"WebMethodConfirmationDialog",va.a,[]);var ac=zk.a;vm(wb,ac);wb.prototype.dispose=function(){this.BSa&&this.BSa.Jca(this.SAf);Mg.a.pc([this.textBox,this.oQa,this.BSa]);this.BSa=this.oQa=this.textBox=null;ac.prototype.dispose.call(this)};wb.prototype.initialize=function(){var J="<div class='"+
Mj.a.xu+"'>\r\n\t<span>{0}</span>\r\n</div>\r\n<div class='"+Mj.a.$rb+"'>\r\n\t<input type='text' id='{1}' class='"+Mj.a.vU+"' aria-live='polite' aria-atomic='true'/>\r\n\t<br />\r\n\t<a href='#' id='{2}' class='{3}'>{4}</a>\r\n</div>";J=String.format(J,nf.a.instance.ea(1226),"sfd_input","sfd_unshare",L.a.yu,nf.a.instance.ea(1227));this.Ob.innerHTML=J;this.textBox=new V.a(this.getElementById("sfd_input"));this.oQa=new ck.a(this.textBox.domElement);this.BSa=cj.a.create(this.getElementById("sfd_unshare"));
this.BSa.g2(this.SAf);this.textBox.text=nf.a.instance.ea(720);this.textBox.enabled=!1;this.textBox.readOnly=!Bf.a.Xg;this.addButton(1,10);ac.prototype.initialize.call(this)};wb.prototype.Rga=function(){var J=this;return function(oa,Va,Ub){var e=J.$.qa.ta.Xb(),C=J.$.qa.ta;oa=J.Lia(oa);Va=J.eaa(Va);e=C.Oa(1,e);return Le.i(C,"ShareForm",e,oa,Va,Ub,null,0)}};wb.prototype.Lx=function(J,oa,Va){this.textBox.text=J.Result;this.textBox.enabled=!0;Fe.DOMElementExtensions.setVisible(this.BSa.domElement,!0);
ac.prototype.Lx.call(this,J,oa,Va)};wb.prototype.setFocus=function(){if(this.textBox&&this.textBox.enabled)try{this.textBox.focus();return}catch(J){}ac.prototype.setFocus.call(this)};tl.Object.defineProperties(wb.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"ShareFormDialog"}}});Object(Xe.a)(wb,"ShareFormDialog",zk.a,[]);var Kc=b(668),cd=b(130),zc=b(251),Mc=b(15),ld=aa.a;vm(rc,ld);rc.prototype.Xc=function(J,oa){J=this.$.workbookContext.FullDocumentInfo;switch(oa){case 353606613:case -1099009678:case 192430811:return!Eg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",
!1)||this.$.fa.isNamedObjectViewMode;case 869186573:return oa=zc.a()&&this.$.fa.ih.get(5),!J.FileSharingUrl&&!oa;case -1570751769:case 1986648902:return 131072!==(this.$.gM&131072);case 330035228:return!(this.Q1a(!0)&&this.fBc);case -509039657:return!(this.Q1a()&&this.fBc);case 1334518759:return!(this.Q1a()&&this.fBc&&this.Dte())}return!1};rc.prototype.executeCommand=function(J,oa,Va){J=this.$.workbookContext.FullDocumentInfo;var Ub=Pg.a.workflow,e=lc.TaskExtensions.om(),C=oa.command;if(C===Ub||-266099===
C)return this.gZh(oa,Ub,J);switch(C){case 1986648902:this.hXf();break;case -1570751769:this.SWh(oa);break;case 869186573:oa=Pg.a.xnj;e=kd.AFrameworkApplication.ga.ra("ShareMenuIsEnabled");Ub=null;(Eg.EwaSettings.la(581)||e)&&Va&&"CopyLink"===Va.SourceControlId?(Ub={},Ub[jh.a.XIb]="copy",oa=Pg.a.UXf):e&&Va&&"ManageAccess"===Va.SourceControlId?(Ub={},Ub[jh.a.XIb]="manageAccess",oa=Pg.a.znj):Va&&"LinkToComment"===Va.SourceControlId&&(Ub={},Ub[jh.a.XIb]="copy",Ub[jh.a.WXf]=Va.navId,oa=Pg.a.UXf);e=this.p0f(J,
Ub);Yj.c(oa);break;case -1099009678:e=this.kNd(12,J);break;case 192430811:e=this.kNd(13,J);break;case 353606613:e=this.kNd(14,J);break;case -59906385:case 1197060601:this.tYh(oa,J);break;case 1305810481:this.W2e(!1,oa);break;case 330035228:this.W2e(!0,oa);break;case -509039657:this.deleteForm();break;case 1334518759:oa.txb=!0;this.shareForm();break;case 710925581:pf.a.Qf.Yuc("710925581")&&(e=lc.TaskExtensions.Ba(this.FJ.value,function(M){M.result.Qj(Fg.a.conversation,{})},this.ma,3));break;case 327119921:this.JWh();
break;default:e=Cd.a(C)}return e};rc.prototype.Gc=function(J,oa){J=!1;oa=oa.command;if(oa===Pg.a.workflow)return!0;switch(oa){case 1986648902:case -1570751769:case 869186573:case -59906385:case 1197060601:case 1305810481:case 330035228:case -509039657:case 1334518759:case -266099:case 710925581:case 327119921:J=!0;break;case 353606613:case -1099009678:case 192430811:J=Eg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)&&!this.$.fa.isNamedObjectViewMode}return J};rc.prototype.fd=
function(J,oa,Va){if("PopulateFormMenu"===oa){oa=this.fBc?this.Dte()?rc.gsh:rc.hsh:rc.rvi;J=this.Sa.Lc();for(var Ub=0;Ub<oa.length;Ub++)Array.add(J.buttons,this.Sa.yb(oa[Ub]));oa=this.Sa.zp("Forms.Flyout");Array.add(oa.yc,J);Va.MenuItems=oa.JB();return!0}return!1};rc.prototype.gZh=function(J,oa,Va){return this.QJd&&J.command===oa?(this.OJd(J,-266099),lc.TaskExtensions.g4()):lc.TaskExtensions.Ba(this.FJ.value,function(Ub){ig.a(Ub.result,Fg.a.workflow,null,Va.WorkflowPostMessage)||ni.HelperMethods.sf(Va.WorkflowUrl,
"_blank",void 0,"SocialSharingCommandHandler.WorkflowUrl")},this.ma,3)};rc.prototype.Dte=function(){return!!this.$.workbookContext.FullDocumentInfo.ShareFormCommandUrl||this.$.fa.ih.get(26)};rc.prototype.JWh=function(){var J=vk.a.create().toString();td.ULS.sendTraceTag(528581128,306,50,"Calling share to teams deeplink with ID: "+J);var oa=this.$.frame,Va=oa.E7a,Ub=this.$,e=new fe.QueryStringBuilder(kd.AFrameworkApplication.ga.Ua("TeamsMeetingShareEndpoint"));e.Ei("deeplinkId",J);e.Ei("lm","deeplink");
J=e.Ei;var C={};var M=new fe.QueryStringBuilder(kd.AFrameworkApplication.ga.Ua("TeamsAppSharingUrl"));M.Ei("auth","2");M.Ei("flight","officeunihost");M.Ei("source","TEAMS-ELECTRON.meetingStage.deeplink");var qa={};qa.fileType=Jg.a.X3(Ub.workbookContext.FullDocumentInfo.WorkbookPath).substring(1);qa.objectUrl=Ub.workbookContext.FullDocumentInfo.WorkbookPath;qa.baseUrl=Ub.workbookContext.FullDocumentInfo.BreadcrumbBrandUrl;Ub=Ub.workbookContext.WorkbookFileVersionId;for(var Na=decodeURIComponent(Ub);Ub!=
Na;)Ub=Na,Na=decodeURIComponent(Ub);0>Ub.indexOf("{")||0>Ub.indexOf("}")?(td.ULS.sendTraceTag(528250338,306,15,"Decoded fileId does not match expected format. Decoded id: "+Ub),Ub=""):Ub=Ub.substring(Ub.indexOf("{")+1,Ub.indexOf("}")).toLowerCase();qa.fileId=Ub;qa=Ch.c(Ch.c(qa));M.Ei("subEntityId",qa.substring(1,qa.length-1));C.appSharingUrl=M.toString();C.appId=kd.AFrameworkApplication.ga.Ua("TeamsAppId");C=JSON.stringify(C);J.call(e,"appContext",C);Va.call(oa,e.toString(),!0)};rc.prototype.SWh=
function(J){this.QJd?this.OJd(J,1986648902):this.hXf()};rc.prototype.W2e=function(J,oa){!J&&this.$.ya.SurveyRedirectUrl?this.vVi():(J=new Mb(this.$,J,oa),J.initialize(),J.mf())};rc.prototype.tYh=function(J,oa){var Va=this;this.QJd&&1197060601===J.command?this.OJd(J,-59906385):lc.TaskExtensions.Ba(this.FJ.value,function(Ub){Ub=Ub.result;Ub&&ig.a(Ub,Fg.a.replyWithChanges,null,Va.$.fa.ih.get(8))||(Ub=new Sys.StringBuilder(oa.ReplyWithChangesUrl),Lh.a.Vf(Ub,Tf.e,Tf.d),Vb.a.ntw(Ub.toString(),Va.$))},this.ma,
3)};rc.prototype.OJd=function(J,oa){var Va=this,Ub=Yg.a(this.$).nd.activityState,e=new Gj.a(oa,J.method,J.mode,J.df,J.tabName);Ib.a(this.$).Rs(new hc.a(he.a.Qy,5,function(){Ub[yg.a.Kq]=he.a.sRf;Ub[Kc.a.PRc]=e;Va.$.Mk.ty("SocialSharingSaveBeforeCommand");Va.$.Mk.Jje(e.command)}))};rc.prototype.hXf=function(){var J=this,oa=this.$.ya.DocumentHostInfo;oa.HostEmbeddedViewUrl||this.ute?this.g_f():this.$.ig.get(53)&&lc.TaskExtensions.Ba(this.FJ.value,function(Va){J.YFj(Va.result)||Vb.a.ntw(oa.FileEmbedCommandUrl,
J.$)},this.ma,3)};rc.prototype.YFj=function(J){return J.isEnabled()&&(this.tte||(this.tte=J.Km(Fg.a.ste,this.Czi)))?J.Qj(Fg.a.Rth,null):!1};rc.prototype.g_f=function(){if(Bf.a.Pr)Vb.a.ntw(this.$.ya.EmbedConfiguratorUrl,this.$);else{var J=new Ga(this.$);J.initialize();J.mf()}};rc.prototype.deleteForm=function(){var J=this.$,oa=new E(J,1231,1232,1224,function(Va,Ub,e){var C=J.qa.ta.Xb(),M=J.qa.ta;C=M.Oa(9,C);C.surveyId=null;return Le.i(M,"DeleteSurvey",C,Va,Ub,e,null,0)});oa.initialize();oa.mf()};rc.prototype.shareForm=
function(){var J=this,oa=this.$.workbookContext.FullDocumentInfo;if(this.$.fa.ih.get(26)){var Va=new wb(this.$);Va.initialize();Va.mf()}else lc.TaskExtensions.Ba(this.FJ.value,function(Ub){var e={};ig.a(Ub.result,Fg.a.shareForm,(e[jh.a.yzj]=J.$.workbookContext.SurveyTitle,e),J.$.fa.ih.get(10))||Vb.a.ntw(oa.ShareFormCommandUrl,J.$)},this.ma,3)};rc.prototype.vVi=function(){var J=this.$;J.ya.SurveyRedirectUrl.replace(RegExp("&startupdialog=[formedit|formpreview]","gi"),"");var oa=new Sys.StringBuilder(J.ya.SurveyRedirectUrl);
Lh.a.Vf(oa,"startupDialog","FormEdit");var Va=Yg.a(this.$),Ub=Va.nd.activityState;Ub[pg.a.W1]=oa.toString();Ub[pg.a.zL]=pg.a.bvd;this.$.Mk.ty("SocialSharingEnvironmentChange");Ib.a(J).Rs(new hc.a(he.a.Qy,5,function(){var e=Ah.a.jd(3,2,1276,1277,1278,554412057,"FossEnvironmentUnsupported");Va.nd.ft([e]);Ub[yg.a.Kq]=he.a.$8f}))};rc.prototype.Q1a=function(J){return(this.$.fa.isEditMode||(void 0===J?!1:J))&&this.$.fa.ih.get(25)&&zc.a()};rc.prototype.wRh=function(J){var oa=void 0===oa?null:oa;var Va=Oa.g(this.$).ha;
var Ub=this.$.xa.oa?Hk.d(this.$.xa.oa):null;if(!Ub)return td.ULS.sendTraceTag(537151649,0,10,"SocialSharingCommandHandler.GetSharingDetail: Unable to find current sheet id for navType: {0}.",Sg[J]),null;14===J?oa=this.VQh(Va):12===J?(oa=Va.Lha,oa=Fc.a.contains(oa,"!",!0)?oa.split("!")[1]:oa):13===J&&(Va=Va.va.selectedRanges,Va[0]&&(Va=Oa.g(this.$).Vb.vk(Va[0])))&&(oa=Va.pj);if(!oa)return td.ULS.sendTraceTag(537151648,0,10,"SocialSharingCommandHandler.GetSharingDetail: Unable to find the selected range reference or object id for navType: {0}",
Sg[J]),null;Va={};Va[jh.a.XIb]="copy";Va[jh.a.WXf]=this.cIh(J,oa,Ub);td.ULS.sendTraceTag(537151647,0,50,"SocialSharingCommandHandler.GetSharingDetail: Send Section_Sharing post message with navType: {0} and sectionNameOrId: {1} and SheetId: {2}",Sg[J],oa,Ub);return Va};rc.prototype.VQh=function(J){if(J.Qa.Qaa&&(J=J.Qa.nc.floatingObject)&&!J.type){var oa=J.id.split(".");if(1<oa.length)return oa[1];td.ULS.sendTraceTag(537151646,0,10,"SocialSharingCommandHandler.GetSelectedFloatingObjectXluid: Invalid floating object id =  {0}",
J.id)}return null};rc.prototype.cIh=function(J,oa,Va){J=btoa(J+"_"+oa+"_"+Va);J=J.replace(RegExp("\\+","g"),"-");J=J.replace(RegExp("\\/","g"),"_");return J=J.replace(RegExp("\\=+$","g"),"")};rc.prototype.p0f=function(J,oa){var Va=this;return lc.TaskExtensions.Ba(this.FJ.value,function(Ub){ig.a(Ub.result,Fg.a.sharing,oa,Va.$.fa.ih.get(5))?td.ULS.sendTraceTag(537151644,0,50,"SocialSharingCommandHandler.ShowShareDialog: Send UI_Sharing post message with mode: {0}",oa?oa[jh.a.XIb]:""):ni.HelperMethods.sf(J.FileSharingUrl,
"_blank",void 0,"SocialSharingCommandHandler.FileSharingUrl")},this.ma,3)};rc.prototype.kNd=function(J,oa){if(!Eg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1))return null;var Va=this.wRh(J);if(Va)return this.p0f(oa,Va);td.ULS.sendTraceTag(537151643,0,10,"SocialSharingCommandHandler.ShareExcelSection: Unable to get the sharing details for navType: {0}",Sg[J]);return null};tl.Object.defineProperties(rc.prototype,{fBc:{configurable:!0,enumerable:!0,get:function(){return fc.b(this.$.kg)}},
QJd:{configurable:!0,enumerable:!0,get:function(){return this.$.isEditMode&&(this.$.fa.veh||this.$.uQ)}}});rc.rvi=[103];rc.gsh=[107,104,105,106];rc.hsh=[104,105];rc.FRg=[new Mc.a(he.a.Uwe,554412057,0,0,1279),new Mc.a(he.a.idle,554412057,0,1)];Object(Xe.a)(rc,"SocialSharingCommandHandler",aa.a,[237]);var Nd=Ka.a;vm(tb,Nd);tb.prototype.Md=function(){var J=this,oa=new mg.a(function(){return qc.GetServiceTaskFactory.create(J.$.da,137,J.ma,J.tb)});lc.TaskExtensions.Ba(qc.GetServiceTaskFactory.create(this.$.da,
102,this.ma,this.tb),function(Va){J.Ed([new rc(J.$,Va.result,oa)])},this.ma,3)};tb.ja=function(J){Ka.a.de(114,new tb(J))};Object(Xe.a)(tb,"SocialSharingCommandHandlerFactory",Ka.a,[]);Object(Xe.a)(eb,"MacroRecorderRangeCustomSortedPayload",null,[116]);var Ud=b(1094),Oe=b(1095),of=b(973),Nf=b(876),Kf=b(202);fb.prototype.show=function(){var J=new Wb.StandardDialog;J.kc=11;J.Cc(1,nf.a.instance.ea(2059));J.Cc(2,nf.a.instance.ea(2060));J.e0f(nf.a.instance.ea(2058),nf.a.instance.Va(645),this.Ov)};fb.prototype.VMa=
function(J){td.ULS.sendTraceTag(594125219,0,50,"ExpandSortSelectionDialog: user operation: {0}",J)};Object(Xe.a)(fb,"ExpandSortSelectionDialog",null,[]);wd.isValid=function(J){return Array.contains(wd.ush,J.Position)?!0:(td.ULS.shipAssertTag(537159826,0,!1,"FillGradientStopExtension.IsValid: unexpected position value [{0}]",J.Position),!1)};wd.ush=[0,.5,1];Object(Xe.a)(wd,"FillGradientStopExtension",null,[]);Object(Xe.a)(Pc,"GradientLine",null,[]);Xc.isValid=function(J){if(!(J.Degree.toString()in
Xc.ssh))return td.ULS.shipAssertTag(537159829,0,!1,"FillGradientExtension.IsValid: unexpected degree value [{0}]",J.Degree),!1;if(!J.GradientStops)return td.ULS.shipAssertTag(537159828,0,!1,"FillGradientExtension.IsValid: no gradient stops"),!1;if(J.GradientStops.length<Xc.Nsi||J.GradientStops.length>Xc.lri)return td.ULS.shipAssertTag(537159827,0,!1,"FillGradientExtension.IsValid: unexpected number of gradient stops [{0}]",J.GradientStops.length),!1;J=yl(J.GradientStops);for(var oa=J.next();!oa.done;oa=
J.next())if(!wd.isValid(oa.value))return!1;return!0};Xc.Nsi=2;Xc.lri=3;var zg={};Xc.ssh=(zg["0"]=new Pc(0,0,1,0),zg["180"]=new Pc(1,0,0,0),zg["90"]=new Pc(0,0,0,1),zg["270"]=new Pc(0,1,0,0),zg["45"]=new Pc(0,0,1,1),zg["225"]=new Pc(1,1,0,0),zg["135"]=new Pc(1,0,0,1),zg["315"]=new Pc(0,1,1,0),zg);Object(Xe.a)(Xc,"FillGradientExtension",null,[]);var uh=yf.a;vm(Ja,uh);Ja.prototype.YN=function(J,oa){if(1===J){var Va=rh.v(this.LAb,this.$);Oa.g(this.$).yi(Va,null,null,null,0,bk.a.Pvj)}Va={};Va=(Va.DialogButton=
J,Va.Location="dialog",Va);Gg.b(this.$).ae(yc.a.Rvj,Va,null,!0);uh.prototype.YN.call(this,J,oa)};Ja.prototype.jr=function(){uh.prototype.jr.call(this);var J=this.Ovj();this.kc=1;this.Cc(1,nf.a.instance.ea(2169));this.Kk(nf.a.instance.ea(2170),ua.a.ym(J),1,this.ZN)};Ja.prototype.Ovj=function(){return String.format(nf.a.instance.Cb(165),this.LAb.toString())};Ja.prototype.Jad=function(){var J=this.error.Description.split("_");return new Oi.Range(Number.parseInvariant(J[1])+1,Number.parseInvariant(J[2])+
1,Number.parseInvariant(J[3])+1,Number.parseInvariant(J[4])+1,!0,!1)};tl.Object.defineProperties(Ja.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"SortMergedCellsErrorDialog"}}});Object(Xe.a)(Ja,"SortMergedCellsErrorDialog",yf.a,[]);var Jh=b(596),ci=b(655),Gi=of.a;vm(Lb,Gi);Lb.prototype.dispose=function(){this.uec||(this.uec=!0,this.V_b(),this.a6=null,Eg.EwaSettings.isChangeGateEnabled("OfficeVSO:5963270_DialogMergeSuspension")&&(this.Oab.dispose(),this.Oab=null));Gi.prototype.dispose.call(this)};
Lb.prototype.kAh=function(J){var oa=this;return function(Va){if(Wg.b(Va,-901005882))Yg.a(oa.$).nd.AD(-901005882),oa.iDd();else if(Wg.b(Va,-569193796))Yg.a(oa.$).nd.AD(-569193796),oa.hide(),new Ja(oa.$,Va.Errors[0]);else if(Wg.a(Va))td.ULS.sendTraceTag(529105665,0,10,"CustomSortDialog.GenerateGetSortInfoSuccessCallback: GetSortInfo result contains non-status messages"),oa.hide();else{Va=Va.Result;oa.$.wj(Va.SortRange);var Ub=Eg.EwaSettings.isChangeGateEnabled("OfficeVSO:4545720_FixingSharedSortInfoResultExtension");
Va&&Hc(Va)&&Eb(Va)&&Kb(Va,Ub)?J(Va):oa.S4b(Lb.Xpb())}}};Lb.prototype.VAh=function(J,oa){var Va=this;return function(Ub,e){if(Va.uec)td.ULS.sendTraceTag(529105635,0,50,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: response was received after dialog is disposed");else if(!Ub||Wg.a(Ub))td.ULS.sendTraceTag(529105634,0,10,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: Unexpected error: {0}",Ah.a.Uc(Ub.Errors)),Va.$.fa.Yo(Ub.Errors),Va.hide();else{Ub=
Ub.Result;var C=J.RangeType,M=J.HeaderRowSize,qa=J.SortTopToBottom;Ub&&ub(Ub,J.ConditionType)&&Tc(Ub,C,M,qa)?(Ub.ColumnInfo.ColumnOffset=e,void 0!==Ub.HeaderColumnInfo&&null!==Ub.HeaderColumnInfo&&(Ub.HeaderColumnInfo.ColumnOffset=e),oa(Ub,J.ConditionType,J.SortTopToBottom)):(td.ULS.sendTraceTag(529105633,0,10,"CustomSortDialog.GenerateOnGetSortConditionColorsOrIconsRequestSuccess: sortConditionColorsOrIconsResult is not valid"),Va.S4b(Lb.Xpb()))}}};Lb.prototype.Opj=function(J){return!!this.namedSheetViewPublic&&
(!J||3===J)};Lb.prototype.X1g=function(J){var oa={};oa.SelectedRange=this.selectedRange;oa.ActiveCell=this.dnc;oa.SortInfoMode=J;oa.ExpandSortSelection=this.IPg;oa.ExpandSortSelectionSupported=!0;return oa};Lb.prototype.xsa=function(J){var oa={};oa[ei.a.Ly]=this.xc;oa.fromAutoFilter=J.FromAutoFilter;oa.gridRTL=Oa.g(this.$).rtl;oa.activeCell=J.ActiveCell;oa.selectedRange=J.SelectedRange;oa.invokeGetSortInfo=this.Q7h;oa.invokeGetSortConditionColorsOrIcons=this.P7h;oa.highlightSortRange=this.v0h;oa.getColorName=
this.getColorName;return oa};Lb.prototype.Yna=function(J,oa){J=rh.D(J);this.ha.va.Qd.equals(J)||this.ha.updateSelection(J,rh.C(oa),0,void 0,void 0,void 0,!0)};Lb.prototype.iDd=function(){var J=this;(new fb(function(oa){var Va={};Va.ActiveCell=J.dnc;Va.SelectedRange=J.selectedRange;Va.ExpandSelection=oa;Va.FromAutoFilter=!1;oa={};J.$.Ce(-207540907,Yc.a.Wb,8,(oa.SortCommandData=Va,oa))})).show()};Lb.prototype.V_b=function(){if(void 0!==this.a6&&null!==this.a6)for(var J=yl(this.a6),oa=J.next();!oa.done;oa=
J.next())this.$.qa.ta.Bdb(oa.value.kt)};Lb.BHf=function(J,oa){var Va={};J.Ce(1659552324,Yc.a.Wb,8,(Va.CustomSortCommandData=oa,Va))};Lb.Xpb=function(){return Ah.a.jd(1,0,26,0,1,-1517197771,"CustomSortValidationError")};tl.Object.defineProperties(Lb.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"CustomSortDialog"}},ha:{configurable:!0,enumerable:!0,get:function(){return Oa.g(this.$).ha}}});Object(Xe.a)(Lb,"CustomSortDialog",of.a,[]);var Wh=b(1183);Ra.prototype.getSelection=function(){return this.selection};
Object(Xe.a)(Ra,"MacroRecorderRangeAutoFilterClearedPayload",null,[116]);Object(Xe.a)(Sa,"MacroRecorderRangeFilterReappliedPayload",null,[116]);var bi=b(901),kh=b(902),Eh=b(132);Yb.prototype.Xc=function(J,oa){return!this.Ynd(J,oa)};Yb.prototype.executeCommand=function(J,oa,Va){J=null;var Ub=oa.command;switch(Ub){case -864298118:J=this.mch(oa,Va);break;case -1010737776:J=this.r5c(!0,oa,Va);break;case 2123420468:J=this.r5c(!1,oa,Va);break;case -207540907:case -1677817820:J=this.gridView.Vb.S4(this.gridView.ha.va.activeCell)?
this.wVi():this.tVi(oa,Va);break;case 1659552324:J=this.jch(oa,Va);break;case 368460465:J=this.Cch(oa);break;case 529856798:J=this.gch(oa);break;case 644342024:J=this.xch(oa)}return J||Cd.a(Ub)};Yb.prototype.Gc=function(J,oa){if(J=1===J)switch(oa.command){case -864298118:case -1010737776:case 2123420468:case 368460465:case 529856798:case 1659552324:case 644342024:case -207540907:case -1677817820:break;default:J=!1}return J};Yb.prototype.fd=function(){return!1};Yb.prototype.ha=function(){return this.$&&
this.gridView?this.gridView.ha:null};Yb.prototype.gKf=function(J){J?this.gridView.Nq(this.onContentReady):this.gridView.Us(this.onContentReady);this.p$e=J};Yb.prototype.Qqj=function(J){return!!this.sortOptions&&Fc.a.equals(this.Jgf,J.Lha,!0)};Yb.prototype.Ynd=function(J,oa){var Va=Oa.g(this.$).ha.va.selectedRanges;return(new oi.a(this.$.xa)).yn(J,oa,Va,this.gridView)};Yb.prototype.r5c=function(J,oa,Va){var Ub={OperationType:0};Ub.IsAscending=J;Ub.HasHeader=!0;Ub.GuessHeader=!0;Ub.SortTopToBottom=
!0;Ub.ExpandSortSelectionSupported=!0;Va&&void 0!==Va[Yb.DRa]&&null!==Va[Yb.DRa]?(Va=Va[Yb.DRa],Ub.ActiveCell=Va.ActiveCell,Ub.SelectedRange=Va.SelectedRange,Ub.ExpandSortSelection=Va.ExpandSelection):(Ub.ActiveCell=rh.o(this.ha().va.activeCell,this.$),Ub.SelectedRange=rh.v(this.ha().va.Qd,this.$),Ub.ExpandSortSelection=null);return this.Eod([rh.D(Ub.SelectedRange)])?this.gridView.Vb.S4(rh.D(Ub.SelectedRange))?this.uch(J):this.p9e(Ub,oa):lc.TaskExtensions.om()};Yb.prototype.mch=function(J,oa){var Va=
null,Ub=this.ha();Ub&&(this.Qqj(Ub)?this.Eod(Ub.va.selectedRanges)&&(this.sortOptions.IsAscending=!this.sortOptions.IsAscending,Va=this.p9e(this.sortOptions,J)):Va=this.r5c(!0,J,oa));return Va};Yb.prototype.Eod=function(J){return Eg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SheetProtectionSettings",!1)&&(Eg.EwaSettings.isChangeGateEnabled("OfficeVSO:5767424_EnablePauseProtectionInViewMode")||this.$.isEditMode)?this.$.isEditMode?this.$.xs(J,!0,1):this.$.YUc(J,!0,1):!0};Yb.prototype.uch=
function(J){this.lOh(J);return nb.Task.Ta(!0)};Yb.prototype.sMg=function(J){if(Eg.EwaSettings.isChangeGateEnabled("OfficeVSO:4112173_MacroRecorderTableSortOnRange")){var oa=this.gridView.Vb.vk(this.ha().va.Qd,!1);if(oa){var Va=oa.name;oa=oa.usedRange;oa=this.ha().va.activeCell.left-oa.left;return new Oe.a(Va,oa,J.IsAscending)}}return new Ud.a(J)};Yb.prototype.p9e=function(J,oa){function Va(){return Ub.sMg(J)}var Ub=this;this.gridView.Bh.qG(!1);return this.IIe(function(e,C,M){return Fa(Ub.$.qa.ta,
J,T.b(e,Ub.SKi),C,M,J)},function(e){return new Ge.a(141,0,e,void 0,Va)},oa,this.Npj(J))};Yb.prototype.Npj=function(J){if(!this.namedSheetViewPublic)return!1;var oa=this.ha().va.Qd,Va=rh.v(this.ha().va.Qd,this.$),Ub=this.gridView.Vb.TLa(oa,!0),e=this.ha().va.wwa()&&this.gridView.Vb.Pcf(Va),C=this.gridView.Vb.Ndi(Va);J=!oa.bba&&!oa.Z4||oa.isSingle||null!=J.ExpandSortSelection?J.ExpandSortSelection&&this.gridView.Vb.Pcf(Va):!1;return Ub||e||C||J};Yb.prototype.wVi=function(){return this.$.Ce(-1556797033,
Yc.a.Wb,8,null)};Yb.prototype.tVi=function(J,oa){J=8===J.df&&oa&&void 0!==oa[Yb.DRa]&&null!==oa[Yb.DRa]?oa[Yb.DRa]:19===J.df&&oa&&void 0!==oa[Yc.a.Kg]&&null!==oa[Yc.a.Kg]?Fj.a.li(oa[Yc.a.Kg]):this.Z0g();if(!this.Eod([rh.D(J.SelectedRange)]))return lc.TaskExtensions.om();Oa.g(this.$).Bh.qG(!1);var Va=null;(oa=oa.TopCellAddress)&&(Va=rh.o(oa,this.$));new Lb(this.$,J,this.namedSheetViewPublic,Va);return nb.Task.Ta(!0)};Yb.prototype.jch=function(J,oa){function Va(){return new eb(M.SortOptions)}function Ub(){M.ShouldRestoreSelection&&
C.Yna(M.SelectedRange,M.OriginalActiveCell);td.ULS.sendTraceTag(537151575,0,10,"SortCommandHandler.DoCustomSort.onSortFailedCallback: Custom Sort failed. Called from: {0}",J.df)}function e(qa){Eg.EwaSettings.isChangeGateEnabled("OfficeVSO:5899794_MergedCellsErrorFix")&&C.x4e(qa)?C.i3e(qa.Errors[0]):(M.ShouldRestoreSelection&&C.Yna(M.SelectedRange,M.OriginalActiveCell),td.ULS.sendTraceTag(537151576,0,50,"SortCommandHandler.DoCustomSort.onSortSuccessCallback: Custom Sort succeeded. Called from: {0}",
J.df),M.TopCellAddress?qa=rh.C(M.TopCellAddress):(qa=M.OriginalActiveCell,qa=new Oi.Range(qa.FirstRow+1,qa.FirstColumn+1,qa.FirstRow+1,qa.FirstColumn+1,!0,!1)),C.ZK(qa))}var C=this,M=oa[Yb.e7g];return oe.a(this.$.userOperationManager,function(qa,Na,Hb){return Fa(C.$.qa.ta,M.SortOptions,T.b(qa,e),T.a(Na,Ub),Hb,C.sortOptions)},function(qa){return new Ge.a(187,0,qa,void 0,Va)},null)};Yb.prototype.Yna=function(J,oa){J=rh.D(J);Oa.g(this.$).ha.va.Qd.equals(J)||Oa.g(this.$).ha.updateSelection(J,rh.C(oa),
0,void 0,void 0,void 0,!0)};Yb.prototype.Z0g=function(){var J={};J.ActiveCell=rh.o(this.ha().va.activeCell,this.$);J.SelectedRange=rh.v(this.ha().va.Qd,this.$);J.FromAutoFilter=!1;J.ExpandSelection=null;return J};Yb.prototype.Cch=function(J){function oa(){return new Wh.a(Ub)}var Va=this,Ub=this.yJa();if(!Ub)return nb.Task.Ta(!1);var e=this.$.qa.ta.Xb();return Eg.EwaSettings.tc()?oe.a(this.$.userOperationManager,function(C,M,qa){return Le.jb(Va.$.qa.ta,Ub,bi.a.Tua(Eh.a.BYa,kh.a.toggleAutoFilter,C),
M,qa,null,e)},function(C){return new Ge.a(516,0,C,64,oa)},J):oe.a(this.$.userOperationManager,function(C,M,qa){return Le.jb(Va.$.qa.ta,Ub,bi.a.Tua(Eh.a.BYa,kh.a.toggleAutoFilter,C),M,qa,null,e)},function(C){return new rj.a(516,0,C,void 0,oa)},J)};Yb.prototype.gch=function(J){function oa(){return new Ra(Ub)}var Va=this,Ub=this.yJa();if(!Ub)return nb.Task.Ta(!1);var e=this.gridView.Vb.vk(this.ha().va.Qd,!0);e&&td.ULS.sendTraceTag(537151574,0,50,"DoClearAutoFilter for namedObject: Type : {0}",e.type.toString());
var C=this.$.qa.ta.Xb();e=Eg.EwaSettings.tc()?function(M){return new Ge.a(517,0,M,64,oa)}:function(M){return new rj.a(517,0,M,void 0,oa)};return this.IIe(function(M,qa,Na){var Hb=Va.$.qa.ta;M=bi.a.Tua(Eh.a.Ara,kh.a.clearAutoFilter,M);var Gc=Hb.Oa(41,void 0===C?null:C);Gc.selectedRange=Ub;return Le.i(Hb,"ClearAutoFilter",Gc,M,qa,Na,null,0)},e,J,!!this.namedSheetViewPublic)};Yb.prototype.IIe=function(J,oa,Va,Ub){var e=this;return Ub?this.namedSheetViewPublic.dAa().continueWith(function(C){C.result&&
oe.a(e.$.userOperationManager,J,oa,Va)}):oe.a(this.$.userOperationManager,J,oa,Va)};Yb.prototype.xch=function(J){function oa(){return new Sa(Ub)}var Va=this,Ub=this.yJa();if(!Ub)return nb.Task.Ta(!1);var e=this.$.qa.ta.Xb();return Eg.EwaSettings.tc()?oe.a(this.$.userOperationManager,function(C,M,qa){return Ta(Va.$.qa.ta,Ub,bi.a.Tua(Eh.a.Ara,kh.a.aIf,C),M,qa,null,e)},function(C){return new Ge.a(518,0,C,64,oa)},J):oe.a(this.$.userOperationManager,function(C,M,qa){return Ta(Va.$.qa.ta,Ub,bi.a.Tua(Eh.a.Ara,
kh.a.aIf,C),M,qa,null,e)},function(C){return new rj.a(518,0,C,void 0,oa)},J)};Yb.prototype.x4e=function(J){return Wg.b(J,-569193796)};Yb.prototype.i3e=function(J){Yg.a(this.$).nd.AD(-569193796);new Ja(this.$,J)};Yb.prototype.iDd=function(J){var oa=this;(new fb(function(Va){var Ub={};Ub.ActiveCell=J.ActiveCell;Ub.SelectedRange=J.SelectedRange;Ub.ExpandSelection=Va;Va={};oa.$.Ce(J.IsAscending?-1010737776:2123420468,Yc.a.Wb,8,(Va[Yb.DRa]=Ub,Va))})).show()};Yb.prototype.Xtj=function(){var J=this.ha();
J.updateSelection(this.vwc,J.va.activeCell,0,void 0,void 0,void 0,!0);this.gKf(!0)};Yb.prototype.yJa=function(){var J=this.ha();if(!J)return td.ULS.shipAssertTag(537151573,0,!!J,"SelectionManger is null"),null;this.gridView.Bh.qG(!1);return rh.v(J.va.Qd,this.$)};Yb.prototype.nIb=function(){this.Wc&&this.Wc.Do&&(this.Yf=this.Wc.Do,this.Bb=this.Wc.b$b())};Yb.prototype.lOh=function(J){var oa=this;if(this.$.isEditMode&&(this.Wc=this.gridView.Vb.nq(this.gridView.ha.va.activeCell))){this.activeCell=rh.o(this.gridView.ha.va.activeCell,
this.$);if(this.Wc&&this.Wc.Do){var Va=this.Wc.Do.CurrentCol;if(this.Wc.Do.CurrentRow===this.activeCell.FirstRow&&Va===this.activeCell.FirstColumn){this.nIb();this.applyPivotSort(J);return}}this.$.qa.ta.Xb();Va=new Ge.a(228,0,function(Ub,e,C){return Le.B(oa.$.qa.ta,oa.activeCell,T.b(Ub,oa.pEi),T.a(e,oa.oEi),C,J)},16);this.$.userOperationManager.ic(Va,null)}};Yb.prototype.applyPivotSort=function(J){var oa=this;if(this.Wc&&this.Bb&&this.activeCell&&this.Yf){var Va=8===this.Yf.CellArea,Ub=1===this.Yf.CellArea||
2===this.Yf.CellArea;(Va||Ub)&&8!==this.Yf.CellType&&4!==this.Yf.CellType&&(Va?oe.a(this.$.userOperationManager,function(e,C,M){return Le.e(oa.$.qa.ta,oa.activeCell,J?1:2,oa.Bb.Caption,e,C,M,null)},function(e){return new Ge.a(1015,0,e,void 0,null)},null):(Va=1===this.Yf.CellArea?1:2,this.$.la(726)?Vb.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Wc.externalSourceIndex,this.Bb.Index.toString(),this.Bb.Caption,this.Wc.isOlap?"":this.Bb.Caption,Va,J):Vb.a.aps(this.$.domElement,
this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Wc.externalSourceIndex,this.Bb.Index.toString(),J)))}};Yb.prototype.ZK=function(J){Eg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.PivotTableHandRaise",!1)&&lc.TaskExtensions.Ba(qc.GetServiceTaskFactory.Xa(this.$.da,430,431,1),function(oa){oa.result.Pda(J);td.ULS.sendTraceTag(537151571,306,50,"SortCommandHandler:TriggerPivotTableHandRaise Trigger hand raise from sort.")},this.$.ma,3)};Yb.prototype.aUd=function(J){Eg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",
!1)&&lc.TaskExtensions.Ba(qc.GetServiceTaskFactory.Xa(this.$.da,476,475,0),function(oa){oa.result.aUd(J,0);td.ULS.sendTraceTag(537151570,0,50,"SortCommandHandler:TriggerProactiveSuggestion Trigger proactive suggestion from sort.")},this.$.ma,3)};Yb.e7g="CustomSortCommandData";Yb.DRa="SortCommandData";Object(Xe.a)(Yb,"SortCommandHandler",null,[237]);var Bh=Ka.a;vm(lb,Bh);lb.prototype.Md=function(){var J=this;lc.TaskExtensions.Ba(qc.GetServiceTaskFactory.Xa(this.$.da,309,310,this.tb),function(oa){J.Ed([new Yb(J.$,
oa.result)])},this.$.ma,3)};lb.ja=function(J){Ka.a.de(160,new lb(J))};Object(Xe.a)(lb,"SortCommandHandlerFactory",Ka.a,[]);sa.prototype.v5g=function(J,oa){new Ja(J,oa)};Object(Xe.a)(sa,"SortUtil",null,[512]);var pi=pd.a;vm(xa,pi);xa.prototype.create=function(){var J=this.$.da.Aa(446);J||(J=new sa(this.$),this.$.da.Ha(446,J));this.Fb(J)};xa.ja=function(J){J.da.Ha(447,new xa(J))};Object(Xe.a)(xa,"SortUtilFactory",pd.a,[]);ta.prototype.executeCommand=function(J,oa,Va){return 2!==this.Di.ze(Pg.a.tryOfficeThroughTellMe,
2,Va)?nb.Task.Ta(!0):Cd.a(oa.command)};ta.prototype.Gc=function(J,oa){return 215809929===oa.command};ta.prototype.fd=function(){return!1};ta.prototype.Xc=function(){return!1};Object(Xe.a)(ta,"TryOfficeThroughTellMeCommandHandler",null,[237]);var wi=Ka.a;vm(Fb,wi);Fb.prototype.Md=function(){this.Ed([new ta(kd.AFrameworkApplication.Eb)])};Fb.ja=function(J){Ka.a.de(207,new Fb(J))};Object(Xe.a)(Fb,"TryOfficeThroughTellMeCommandHandlerFactory",Ka.a,[]);var $i=b(156);Qb.nM=function(){return ff.a.jj(Qb.Tj,
$i.a.Va(433))};Qb.Tj="<div class='namedsheetview_teaching_dialog_control' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_description_label' id='IconAndDescriptionRow'> <div class='namedsheetview_teaching_dialog_textarea' id='TextArea'> <label id='TeachingDescriptionId' class='WACDialogLabel' >{0}</label> </div> </div> </div>";Object(Xe.a)(Qb,"NamedSheetViewTeachingDialogHtml",null,[]);var Ui=ei.a;vm(Gb,Ui);Gb.prototype.Kh=function(){this.kc=4;this.stopwatch=this.$.Ub.Fc("UserAction",
this.xc);var J=nf.a.instance.ea(1854);this.xf=Qb.nM();this.Jo=new zb.a;this.initializeAndShow(J,this.Cui,{});return this.Jo.task};Gb.prototype.$u=function(J){Ui.prototype.$u.call(this,J);this.Cc(1,nf.a.instance.ea(1856));this.Cc(2,nf.a.instance.Va(446))};Gb.prototype.RTi=function(){this.$.fa.$jc=!1};Gb.prototype.Dni=function(J){var oa={};oa.a=this.$.ya.UserSessionId;oa.b="NamedSheetViewTeachingDialogClose";oa.c=J;oa.e=!0;this.stopwatch&&(this.stopwatch.stop(),oa.d=this.stopwatch.Ac);Ed.b().Ne(53,
oa,!0)};tl.Object.defineProperties(Gb.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"ShowNamedSheetViewTeachingDialog"}}});Object(Xe.a)(Gb,"NamedSheetViewTeachingDialog",ei.a,[]);var gi=b(189);hb.prototype.dAa=function(){if(this.nqj()){if(Eg.EwaSettings.la(608)){this.$.xa.oa.ye.zOd=!0;var J=new zb.a;this.$.Ka.Zb(new Gj.a(-2050946363,Yc.a.Wb,2,0,null)).continueWith(function(oa){J.setResult(!Di.a(oa)&&oa.result)});return J.task}return(new Gb(this.$)).Kh()}return nb.Task.Ta(!0)};
hb.prototype.nqj=function(){var J=this.$.xa.oa;return this.$.fa.R7a&&this.$.fa.$jc&&!J.ye.sC&&this.$.fa.cM&&!gi.c(this.$)};Object(Xe.a)(hb,"NamedSheetViewPublic",null,[514]);var ri=pd.a;vm(ya,ri);ya.prototype.create=function(){this.Fb(this.$.da.Aa(309)||new hb(this.$))};ya.ja=function(J){J.da.Ha(310,new ya(J))};Object(Xe.a)(ya,"NamedSheetViewPublicFactory",pd.a,[]);var Hi=b(1313),Ii=b(1002),Yh=b(582);Object(Xe.a)(da,"NamedSheetViewTeachingCalloutContent",null,[]);tl.Object.defineProperties(Tb.prototype,
{B4f:{configurable:!0,enumerable:!0,get:function(){return this.Ffe}},DVi:{configurable:!0,enumerable:!0,get:function(){return this.B4f<this.D4f.count?this.D4f.na(this.Ffe++):null}}});Object(Xe.a)(Tb,"NamedSheetViewTeachingCalloutList",null,[]);var si=b(1184);Sb.prototype.y3h=function(J){var oa=this;this.C4f=J;var Va=Object.assign(new ra.a,{});Sb.Dai(J)?(Va.add(new da(nf.a.instance.Va(435),nf.a.instance.Va(436),nf.a.instance.ea(1884),function(){oa.vH(2,"Continue");oa.cC(!0)},nf.a.instance.ea(1885),
function(){oa.cC();oa.vH(1,"ExitGuide")},si.a())),1===J&&Va.add(new da(nf.a.instance.ea(1886),nf.a.instance.Va(438),nf.a.instance.ea(1884),function(){oa.vH(2,"FirstEnterTempViewContinueSecond");oa.cC(!0)},nf.a.instance.ea(1885),function(){oa.cC();oa.vH(1,"FirstEnterTempViewExitGuideSecond")},si.a())),Va.add(new da(nf.a.instance.Va(439),nf.a.instance.Va(440),nf.a.instance.ea(1884),function(){oa.vH(2,"FirstEnterExitCalloutContinue");oa.cC(!0)},nf.a.instance.ea(1885),function(){oa.cC();oa.vH(1,"FirstEnterExitCalloutGuide")},
Sb.rYe())),Va.add(new da(nf.a.instance.ea(1887),nf.a.instance.Va(437),nf.a.instance.ea(1888),function(){oa.P_f();oa.cC();oa.vH(1,"LearnMore")},nf.a.instance.ea(1889),function(){oa.cC();oa.vH(1,"Done")},Sb.qYe()))):2===J?Va.add(new da(nf.a.instance.ea(1886),nf.a.instance.Va(438),nf.a.instance.ea(1883),function(){oa.cC();oa.vH(1,"EnterTempViewAfterPersistedView")},null,null,si.a())):3===J&&(Va.add(new da(nf.a.instance.Va(435),nf.a.instance.ea(1895),nf.a.instance.ea(1884),function(){oa.vH(2,"AutoOptInExitCalloutContinue");
oa.cC(!0)},nf.a.instance.ea(1885),function(){oa.cC();oa.vH(1,"AutoOptInExitGuide")},Sb.rYe())),Va.add(new da(nf.a.instance.ea(1886),nf.a.instance.Va(438),nf.a.instance.ea(1884),function(){oa.vH(2,"Continue");oa.cC(!0)},nf.a.instance.ea(1885),function(){oa.cC();oa.vH(1,"ExitGuide")},si.a())),Va.add(new da(nf.a.instance.ea(1887),nf.a.instance.Va(437),nf.a.instance.ea(1888),function(){oa.P_f();oa.cC();oa.vH(1,"LearnMore")},nf.a.instance.ea(1889),function(){oa.cC();oa.vH(1,"Done")},Sb.qYe())));this.wSd=
new Tb(Va)};Sb.prototype.P_f=function(){var J=new Gj.a(-859308420,Yc.a.Wb,this.$.ed,9,null),oa={};oa=(oa[Yc.a.Kg]="HelpID=SheetViews",oa.InputMethod=Yc.a.Wb,oa[Yc.a.hd]=ab.a.XU,oa.ShouldCanvasTakeFocus=!0,oa);this.$.Ka.Zb(J,oa)};Sb.prototype.show=function(J){this.y3h(J);this.gcb()};Sb.prototype.Qjj=function(J){this.IYb=J};Sb.prototype.gcb=function(){var J=this,oa=this.wSd.DVi;if(oa){var Va=Object.assign(new Hi.a,{label:oa.aUi,onExecute:oa.primaryButtonAction}),Ub=null;oa.TSf&&(Ub=Object.assign(new Hi.a,
{label:oa.TSf,onExecute:oa.secondaryButtonAction}));oa=Object.assign(new Ii.a,{target:oa.targetObject,content:oa.body,title:oa.title,showCloseIcon:!0,primaryButtonProps:Va,secondaryButtonProps:Ub,useTeachingStyles:!0});oa=this.IYb.callout(oa);Va=Object.assign(new Yh.a,{onShow:function(){J.vH(0)}});this.Jxc=this.IYb.addNotification(oa,Va);this.WUc||(this.$.uod=!0)}};Sb.prototype.dismiss=function(){this.cC();this.vH(1,"DismissedByOthers")};Sb.prototype.cC=function(J){J=void 0===J?!1:J;this.Jxc&&(this.WUc||
(this.$.uod=!1),this.IYb.removeNotification(this.Jxc),this.Jxc=null);J&&this.gcb()};Sb.prototype.vH=function(J,oa){var Va={};Va.a=this.$.ya.UserSessionId;Va.b=this.C4f;Va.c=this.wSd.B4f;Va.d=J;Va.e=void 0===oa?null:oa;J?(this.stopwatch&&(this.stopwatch.stop(),Va.f=this.stopwatch.Ac,this.stopwatch=null),2===J&&(this.stopwatch=this.$.Ub.Fc("UserAction","ShowNamedSheetViewTeachingCalloutNext"))):this.stopwatch=this.$.Ub.Fc("UserAction","ShowNamedSheetViewTeachingCallout");Ed.b().Ne(52,Va,!0)};Sb.qYe=
function(){return document.getElementById("m_excelWebRenderer_ewaCtl_columnHeadersDiv")};Sb.rYe=function(){return document.querySelector("[data-unique-id=Ribbon-NamedSheetViewExit]")};Sb.Dai=function(J){return!J||1===J};Object(Xe.a)(Sb,"NamedSheetViewTeachingCallout",null,[511]);var Uh=pd.a;vm(Xa,Uh);Xa.prototype.create=function(){var J=this.$.da.Aa(322);J||(J=new Sb(this.$),Eg.EwaSettings.isChangeGateEnabled("OfficeVSO:5782706_NSVTC")&&this.$.da.Ha(322,J));this.Fb(J)};Xa.ja=function(J){J.da.Ha(323,
new Xa(J))};Object(Xe.a)(Xa,"NamedSheetViewTeachingCalloutFactory",pd.a,[]);var nh=b(100),dj=b(172),dk=b(1185),mk=b(87),Nj=b(1073),nk=Wb.StandardDialog;vm(Cb,nk);Cb.prototype.RP=function(){this.kc=5;this.width=40;var J=document.createElement("span");J.id=this.mi("DirectPrintHeaderContent");var oa=document.createElement("span");oa.innerText=CommonUIStrings.l_DirectPrintDialogHeader;Sys.UI.DomElement.addCssClass(oa,"DirectPrintHeader");this.PO=document.createElement("iframe");this.PO.name="pdfObjectFrame";
this.PO.title=CommonUIStrings.l_DirectPrintDialogIFrame;this.PO.onload=Object(wf.a)(this,this.mUi,"printablePdfLoaded");if(this.AUb&&0<this.AUb.count){var Va=Kg.a.Ydd(this.kTb,this.AUb),Ub=Kg.a.kGd(this.kTb,this.AUb);this.Rl=document.createElement("form");this.Rl.id="printPreviewPostForm";this.Rl.method="POST";this.Rl.target=this.PO.name;this.Rl.action=Ub;Va=yl(Va);for(Ub=Va.next();!Ub.done;Ub=Va.next()){Ub=Ub.value;var e=document.createElement("input");e.type="hidden";e.name=Ub.key;e.value=Ub.value;
this.Rl.appendChild(e)}}else this.PO.setAttribute("src",this.kTb);Sys.UI.DomElement.addCssClass(this.PO,dj.a.F$d);this.rlg?(Sys.UI.DomElement.addCssClass(this.PO,"DirectPrintPdfObjectHidden"),oa.innerText=CommonUIStrings.l_DirectPrintDialogSuccessText,Qh.a.nh(this.PO,Qh.a.GB,Qh.a.rj)):(Sys.UI.DomElement.addCssClass(this.PO,"DirectPrintPdfObject"),this.Vm.push(this.PO));J.appendChild(oa);J.appendChild(document.createElement("br"));J.appendChild(this.PO);this.Rl&&J.appendChild(this.Rl);J.appendChild(document.createElement("br"));
J.appendChild(this.WXg(this.Rl?"#":this.kTb));this.Gkb.start();this.MAb(CommonUIStrings.l_AppTitle,null,null,null,null,J);this.AW(this.mi("DirectPrintHeaderContent"));this.Rl&&this.Rl.submit();this.M1g();td.ULS.sendTraceTag(4771852,328,50,"Direct Print Dialog launched.")};Cb.prototype.WXg=function(J){var oa=document.createElement("span"),Va=document.createElement("span");Va.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFHeader;oa.appendChild(Va);kd.AFrameworkApplication.ga&&(2===kd.AFrameworkApplication.sa.Pa.Lj&&
kd.AFrameworkApplication.ga.ra("PPTDisableDirectPrintDialogDownloadPDFLink")||1===kd.AFrameworkApplication.sa.Pa.Lj&&kd.AFrameworkApplication.ga.ra("XLODisableDirectPrintDialogOpenPDFLink"))?(J=document.createElement("span"),2===kd.AFrameworkApplication.sa.Pa.Lj?J.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLabel:1===kd.AFrameworkApplication.sa.Pa.Lj&&(J.innerText=CommonUIStrings.l_InternalError_Directive,td.ULS.sendTraceTag(573691527,328,50,"Hyperlink removed from DirectPrintDialog in XLO.")),
this.kpa=J,oa.appendChild(document.createElement("br")),oa.appendChild(J)):(Va=document.createElement("a"),Va.innerText=CommonUIStrings.l_DirectPrintDialogDownloadPDFLink,Va.href=J,Va.target="_blank",Va.id="PrintPDFLink",Va.className="AllowBrowserClick",this.kpa=Va,oa.appendChild(document.createElement("br")),oa.appendChild(Va),this.Rl&&Ef.a.addHandler(Va,"click",Object(wf.a)(this,this.Imc,"onSubmit")),this.IO.pa(If.a.click,this.kpa,Object(wf.a)(this,this.EGe,"downloadPDFLinkClicked"),null));this.Vm.push(this.kpa);
return oa};Cb.prototype.Imc=function(J){this.Rl&&(this.Rl.target="_blank",this.Rl.submit());J.preventDefault()};Cb.prototype.M1g=function(){if(0<this.Vm.length){var J=new dk.a(this.Vm),oa=nh.FocusManager.instance().hQ();oa&&(this.kpa.focus(),oa.jf=J,oa.YZ=!0)}};Cb.prototype.EGe=function(){td.ULS.sendTraceTag(4585050,328,50,"Download PDF from Direct Print dialog clicked.");return!1};Cb.prototype.Nrd=function(){td.ULS.sendTraceTag(21031114,328,50,"Download PDF from Direct Print dialog button clicked")};
Cb.prototype.mUi=function(){td.ULS.sendTraceTag(51426332,328,50,"PDF content loaded successfully");this.Gkb&&this.Gkb.stop()};Cb.prototype.dispose=function(){this.kpa&&(this.IO.za(If.a.click,this.kpa,Object(wf.a)(this,this.EGe,"downloadPDFLinkClicked")),this.kpa=null);mk.a.K_(this.PO);this.PO=null;nk.prototype.dispose.call(this)};Object(Xe.a)(Cb,"DirectPrintDialog",Wb.StandardDialog,[523]);ob.prototype.sHh=function(J,oa,Va){return new Cb(this.IO,J,oa,void 0===Va?null:Va)};Object(Xe.a)(ob,"DirectPrintDialogFactory",
null,[510]);vm(Ma,rg);Ma.prototype.Cif=function(){td.ULS.sendTraceTag(7690390,324,50,"Legacy print dialog displayed")};Ma.prototype.Eif=function(){kd.AFrameworkApplication.Pm.vwb(9540);td.ULS.sendTraceTag(7690391,324,50,"Legacy print dialog clicked")};Ma.prototype.Nrd=function(){td.ULS.sendTraceTag(19462215,324,50,"Legacy print dialog button clicked")};tl.Object.defineProperties(Ma.prototype,{D6e:{configurable:!0,enumerable:!0,get:function(){return"Print_32x32x32"}},eTd:{configurable:!0,enumerable:!0,
get:function(){return Ma.PSa?CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint:null}},iNa:{configurable:!0,enumerable:!0,get:function(){return Ma.PSa?null:CommonUIStrings.l_PrintDialogDocumentIsReadyToPrint}},WTc:{configurable:!0,enumerable:!0,get:function(){var J=[];Array.add(J,CommonUIStrings.l_PrintDialogCanCloseDocument);if(rg.Tvb){var oa=CommonUIStrings.l_DirectPrintDialogFallbackSuggestion;""!==kd.AFrameworkApplication.sa.Pa.VCe&&(oa=kd.AFrameworkApplication.sa.Pa.VCe);Array.add(J,oa)}return Ma.PSa?
J:null}},Rhc:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_DirectPrintDialogDownloadPDFLink}},Qhc:{configurable:!0,enumerable:!0,get:function(){return"PrintPDFLink"}},buttonText:{configurable:!0,enumerable:!0,get:function(){return CommonUIStrings.l_PrintDialogOpenPDF}},Y2c:{configurable:!0,enumerable:!0,get:function(){return kd.AFrameworkApplication.OEe?"UIFontDialogTextLarge":null}}});tl.Object.defineProperties(Ma,{PSa:{configurable:!0,enumerable:!0,get:function(){return!!kd.AFrameworkApplication.sa&&
kd.AFrameworkApplication.sa.Pa.Lu&&kd.AFrameworkApplication.ga.ra("DirectPrintDialogAsStandardDialogIsEnabled")&&!(Bf.a.rC||Bf.a.Af||Bf.a.zf||Bf.a.N5a)&&!kd.AFrameworkApplication.isUnifiedHostMode&&kd.AFrameworkApplication.ga.ra("ShouldHostDefaultToNativeBrowserPrintExperience")},set:function(){}}});Object(Xe.a)(Ma,"PrintDialogWithLinkToPdf",rg,[]);Ia.V4c=",";Object(Xe.a)(Ia,"DirectPrintBrsSettings",null,[]);Object(Xe.a)(pa,"DirectPrintProbeResults",null,[]);ma.prototype.start=function(){};ma.prototype.mWi=
function(){var J=Array(this.aC.VRa.length);if(void 0!==this.Zib&&null!==this.Zib)for(var oa=0;oa<this.aC.VRa.length;oa++)J[oa]=this.aC.VRa[oa]in this.Zib&&this.rmg(this.Zib[this.aC.VRa[oa]]);return J};ma.prototype.nWi=function(){for(var J=Array(this.aC.WRa.length),oa=!(void 0===this.GLc||null===this.GLc),Va=0;Va<this.aC.WRa.length;Va++){var Ub=this.aC.WRa[Va];J[Va]=oa&&Ub in this.GLc?!0:this.Umg(Ub)}return J};ma.prototype.ASh=function(){for(var J=this.mWi(),oa=Array(J.length),Va=0;Va<J.length;Va++)oa[Va]=
J[Va]?this.Xsh(this.Zib[this.aC.VRa[Va]]):null;return oa};ma.prototype.Xsh=function(J){if(void 0===J||null===J)return null;J=J.enabledPlugin;return void 0===J||null===J?null:J.name};ma.prototype.ZOh=function(){for(var J=this.ASh(),oa=this.nWi(),Va={},Ub={},e=0;e<this.aC.VRa.length;e++)Va[this.aC.VRa[e]]=J[e];for(J=0;J<this.aC.WRa.length;J++)Ub[this.aC.WRa[J]]=oa[J];return new pa(Va,Ub)};ma.prototype.arj=function(){return this.ang||!this.aC.isEnabled||kd.AFrameworkApplication.isUnifiedHostMode?!1:
this.gzj()};ma.prototype.yvc=function(){if(null!=this.UVb)return this.UVb;var J=ma.U$e(this.aC);return this.UVb=this.aC.V$e&&J||this.M9h()};ma.prototype.M9h=function(){return Bf.a.Po&&this.aC.N9h&&Bf.a.Kve>=this.aC.cTg?!0:!1};ma.prototype.gzj=function(){if(!this.Vmg(this.aC))return!1;var J=Dj.a.Hfd(this.cNc.value.C3f);J=yl(J);for(var oa=J.next();!oa.done;oa=J.next())if(oa=oa.value,void 0!==oa&&null!==oa)return!0;J=Dj.a.Hfd(this.cNc.value.WRa);J=yl(J);for(oa=J.next();!oa.done;oa=J.next())if(oa.value)return!0;
return!1};ma.prototype.IZh=function(){var J=Dj.a.Hfd(this.cNc.value.C3f);J=yl(J);for(var oa=J.next();!oa.done;oa=J.next())if(H.a.contains(this.aC.S1h,oa.value))return!0;return!1};ma.prototype.c0f=function(J){var oa=void 0===oa?!1:oa;var Va=void 0===Va?null:Va;kd.AFrameworkApplication.sa&&kd.AFrameworkApplication.ga.ra("DirectPrintDialogAsStandardDialogIsEnabled")?this.u8d(J,Va):this.arj()?this.mbh(J,this.IZh()&&!oa,Va):this.u8d(J,Va)};ma.prototype.mbh=function(J,oa,Va){Va=void 0===Va?null:Va;var Ub=
this.hsg.Fc("UserAction","OpenDirectPrintDialog");this.rUa.sHh(J,oa,Va).RP();Ub.stop()};ma.cef=function(J){try{return new ActiveXObject(J),!0}catch(oa){td.ULS.sendTraceTag(4535642,328,100,"Failed to instantiate {0} as an ActiveX control.",J)}return!1};ma.W$e=function(J){return void 0===J||null===J?!1:!(void 0===J.enabledPlugin||null===J.enabledPlugin)};ma.create=function(J){var oa=new Ia(kd.AFrameworkApplication.ga.appSettings),Va=null;try{Va=window.navigator.mimeTypes}catch(Hb){td.ULS.sendTraceTag(573923532,
328,15,"Failed to get Window.Navigator.mimeTypes")}var Ub=null;try{Ub=window.navigator.plugins}catch(Hb){td.ULS.sendTraceTag(573923533,328,15,"Failed to get Window.Navigator.plugins")}var e=ma.W$e,C=ma.cef;J=J.resolve("Common.App.DirectPrint.DirectPrintDialogFactory");var M=kd.AFrameworkApplication.sa.fD,qa=ma.def,Na=!!kd.AFrameworkApplication.sa&&kd.AFrameworkApplication.sa.Pa.Lu&&!kd.AFrameworkApplication.ga.ra("PrintDialogFallbackLinkEnabled");return new ma(oa,Va,Ub,e,C,J,M,qa,function(Hb,Gc){return new Ma(Hb,
!1,Gc,!0,Na)},kd.AFrameworkApplication.vLa)};ma.def=function(J){return Bf.a.Po||Bf.a.Af&&J.Sbi||J.V$e&&ma.U$e(J)?!0:!1};ma.U$e=function(J){var oa=Bf.a.xrb;if(oa){var Va=oa.split(".");if(2===Va.length)return oa=parseInt(Va[0]),Va=parseInt(Va[1]),oa>J.kud||oa===J.kud&&Va>=J.Jmf}return!1};tl.Object.defineProperties(ma.prototype,{aC:{configurable:!0,enumerable:!0,get:function(){return this.ljg}}});Object(Xe.a)(ma,"DirectPrintManager",null,[509]);wa.prototype.di=function(J){var oa=this;this.rb=J;J.register(ob,
"Common.App.DirectPrint.DirectPrintDialogFactory").zc().Ic(function(){return new ob(kd.AFrameworkApplication.sa.OW)});J.register(509,"Common.App.DirectPrint.IDirectPrintManager").zc().Ic(function(){return ma.create(oa.rb)})};wa.prototype.init=function(){this.r2d=this.rb.resolve("Common.App.DirectPrint.IDirectPrintManager");this.r2d.start()};wa.prototype.dispose=function(){};tl.Object.defineProperties(wa.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.DirectPrint"}}});
Object(Xe.a)(wa,"PackageManager",null,[4,5]);var Ak=b(594),sk=zk.a;vm(Z,sk);Z.prototype.setFocus=function(){this.Mv.checked?Fe.DOMElementExtensions.setFocus(this.Mv):Fe.DOMElementExtensions.setFocus(this.getButton(0).get_element())};tl.Object.defineProperties(Z.prototype,{ee:{configurable:!0,enumerable:!0,get:function(){return this.vPb}}});Z.F3b="printCurrentSelection";Object(Xe.a)(Z,"BasePrintDialog",zk.a,[]);var Pi=b(226);vm(ca,Z);ca.prototype.initialize=function(){td.ULS.sendTraceTag(537154316,
0,50,"HtmlPrintDialog:Initialize - Preparing dialog for HTML Legacy print");this.w4h();this.rXa(1172);this.addButton(1);Z.prototype.initialize.call(this)};ca.prototype.Rga=function(){var J=this;return function(oa,Va,Ub){var e=J.$.qa.ta,C=J.Im;oa=J.Lia(oa);Va=J.eaa(Va);var M=J.ee,qa=e.Oa(1,null);qa.printOptions=C;return Le.i(e,"ValidatePrint",qa,oa,Va,Ub,M,0)}};ca.prototype.commit=function(){this.yWg();return!0};ca.prototype.Lx=function(J,oa,Va){var Ub,e=J.Result;if(e&&oa){var C=0,M=0;(null===(Ub=
e.SelectedRanges)||void 0===Ub?0:Ub.Ranges)&&0<e.SelectedRanges.Ranges.length&&e.SelectedRanges.Ranges[0]&&(C=Math.min(ca.hYf(e.SelectedRanges.Ranges[0]),65535));e.UsedRange&&(M=Math.min(ca.hYf(rh.j(rh.D(e.UsedRange))),65535));Pi.h(oa,C);Pi.i(oa,M)}this.Im=e;Z.prototype.Lx.call(this,J,oa,Va)};ca.prototype.setFocus=function(){this.Orb.checked?Fe.DOMElementExtensions.setFocus(this.Orb):Z.prototype.setFocus.call(this)};ca.prototype.w4h=function(){this.Ob.innerHTML=ca.iTi(this.$.fa.isNamedObjectViewMode);
this.Mv=Fe.DOMElementExtensions.getElementById(this.Ob,Z.F3b);this.Orb=Fe.DOMElementExtensions.getElementById(this.Ob,"printEntireItem");this.Im.Type&&this.Im.UseSelection?(this.Mv.checked=!0,this.Orb.disabled=!this.Im.SheetName):(this.Orb.checked=!0,this.Mv.disabled=!this.Im.Type||!Oa.g(this.$).ha.va.Dh)};ca.prototype.yWg=function(){td.ULS.sendTraceTag(51499290,0,50,"HtmlPrintDialog:CommitWithGenerateHtml - CommitWithGenerateHtml called");var J=new Sys.StringBuilder;this.eBh(J);var oa=String.format("location=0,scrollbars=1,resizable=1,menubar=1,toolbar={0},status=0",
Bf.a.zf?0:1);ni.HelperMethods.sf(J.toString(),"",oa,"PrintDialog.PrintViewUrl")||td.ULS.sendTraceTag(51499291,0,10,"HtmlPrintDialog:CommitWithGenerateHtml - A browser blocked the xlprintview.aspx page!")};ca.prototype.eBh=function(J){var oa=this.$.ya;J.append(this.$.hda+oa.LayoutsRelativeUri+"/xlprintview.aspx?");Lh.a.Vf(J,ab.a.IVi,this.Im.SessionId);Lh.a.Vf(J,ab.a.KVi,this.Mv.checked?"1":"0");if(this.Im.Type){if(!this.Im.UsedRangeTooBig){var Va=rh.D(this.Im.UsedRange);(Va=rh.x(Va,this.Im.SheetName))&&
Lh.a.Vf(J,ab.a.LVi,Va)}1===this.Im.Type?Lh.a.Vf(J,ab.a.GVi,this.Im.ObjectId):(Va=rh.B(this.Im.SelectedRanges.Ranges[0]),Va=rh.x(Va,this.Im.SheetName),Lh.a.Vf(J,ab.a.HVi,Va))}else Lh.a.Vf(J,ab.a.FVi,this.Im.ObjectId);$h.a.yFa(J,oa);Lh.a.Vf(J,ab.a.JVi,this.Im.Title)};ca.iTi=function(J){return String.format("<div class='"+Mj.a.xu+"'>{0}</div>\r\n\t<div class='"+Mj.a.r7c+"'>\r\n\t\t<input type='radio' id='{1}' name='print' /> <label for='{1}'>{2}</label><br />\r\n\t\t<input type='radio' id='{3}' name='print' /> <label for='{3}'>{4}</label>\r\n\t</div>\r\n</div>",
nf.a.instance.ea(1173),Z.F3b,nf.a.instance.ea(1176),"printEntireItem",J?nf.a.instance.ea(1175):nf.a.instance.ea(1174))};ca.hYf=function(J){return(J.LastColumn-J.FirstColumn+1)*(J.LastRow-J.FirstRow+1)};tl.Object.defineProperties(ca.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"HtmlPrintDialog"}}});Object(Xe.a)(ca,"HtmlPrintDialog",Z,[]);var Vi=b(576),mi=b(66);ba.dUi="PrintDialogBody";ba.printDialogTitle="PrintDialogTitle";ba.D6b="ewa-dlg-elements-container-rtl";ba.eUi="PrintDialogLeftContainer";
ba.fUi="PrintDialogRightContainer";ba.W9a="PrintDialogRadioButtonContainer";ba.CFf="PrintRadioButtonElementInnerDiv";ba.kUi="PrintRadioButtonElementOuterDiv";ba.X9a="PrintDialogTitleSection";ba.GCd="PrintDialogComboBoxContainer";ba.lUi="PrintRadioButtonIcon";ba.cUi="PrintButtonArea";ba.Vx="PrintPreviewerContainer";Object(Xe.a)(ba,"CssClassNames",null,[]);var Bi=b(898),oj=b(285),Oj=b(1015),jk=b(853);O.prototype.getSheetName=function(){return this.sheetName};O.prototype.getPrintSettings=function(){return this.printSettings};
Object(Xe.a)(O,"MacroRecorderSheetPrintSettingsSavedPayload",null,[116]);vm(Q,Z);Q.prototype.initialize=function(){this.V6&&Eg.EwaSettings.isChangeGateEnabled("OfficeVSO:4879681_PrintAreaCheckboxKeyboardFocus")&&Q.w2g(this.Ob);this.Le?this.Iye(987,null):(this.Vk(),this.rXa(987));Z.prototype.initialize.call(this)};Q.prototype.dispose=function(){this.xGj();Z.prototype.dispose.call(this)};Q.prototype.close=function(J){td.ULS.sendTraceTag(591196544,0,50,"PdfPrintDialog.Close: User changed printSettings {0} times before exiting dialog {1} printing done",
this.x_,J?"without":"with");this.rcj();if(this.Tr){var oa=this.uGh();!this.eQd&&!this.D$.checked&&this.$.isEditMode&&this.ehd(oa)&&this.icj(oa)}Z.prototype.close.call(this,J)};Q.prototype.Rga=function(){var J=this;return function(oa,Va,Ub){return S(J.$.qa.ta,J.$.xa.oa.name,J.locale,J.Lia(oa),J.eaa(Va),Ub,null)}};Q.prototype.Lx=function(J,oa,Va){this.Tr=J.Result;this.zHb=this.Tr.ScalingWidth;this.yHb=this.Tr.ScalingHeight;this.k$c();this.e4h();Z.prototype.Lx.call(this,J,oa,Va)};Q.prototype.Vk=function(){td.ULS.sendTraceTag(537154315,
0,50,"PdfPrintDialog:InitializeDialogElements - Preparing dialog for Print Pdf");this.x4h();Z.prototype.Vk.call(this)};Q.prototype.commit=function(){this.xWg();return!0};Q.prototype.setFocus=function(){this.Le?Ik.a.Lyc(this.pca):this.pca.checked?Fe.DOMElementExtensions.setFocus(this.pca):Z.prototype.setFocus.call(this)};Q.prototype.M5h=function(){switch(this.qN.lv){case 1:this.pca.checked=!0;break;case 0:this.Mv.disabled?this.pca.checked=!0:this.Mv.checked=!0;break;case 2:this.D$.checked=!0;break;
default:td.ULS.sendTraceTag(537154314,0,10,"Invalid what to print state {0}. Resetting to defaults.",this.qN.lv),this.qN.lv=1,this.pca.checked=!0}};Q.prototype.rcj=function(){this.qN.lv=this.CXc();this.V6&&(this.qN.ignorePrintArea=this.k4a.checked)};Q.prototype.k$c=function(){if(100!==this.Tr.ScalingPercent||this.Tr.FitToPage&&(1<this.Tr.ScalingWidth||1<this.Tr.ScalingHeight))this.eQd=!0,this.Tr.ScalingWidth=Q.q4c,this.Tr.ScalingHeight=Q.p4c,this.Tr.ScalingPercent=Q.f4b,this.Tr.FitToPage=Q.j4c;this.Tr.PaperSize.toString()in
this.uAd||(this.eQd=!0,this.Tr.PaperSize=this.Tr.PaperSize===Q.WIg?34:Q.Iqb)};Q.prototype.e4h=function(){this.Dya=this.Tr.IsLandscape?2:1;this.w_=this.Tr.FitToPage?1===this.Tr.ScalingWidth&&1===this.Tr.ScalingHeight?1:this.Tr.ScalingWidth||1!==this.Tr.ScalingHeight?2:3:0;this.Sla=this.Tr.PaperSize;this.q6c(this.D$.checked?!0:!1);this.RLd(this.D$.checked?!0:!1)};Q.prototype.L4h=function(){this.Qcc.disabled=this.Mv.checked;this.LEb=this.k4a.checked=this.qN.ignorePrintArea};Q.prototype.Y4g=function(J){this.wza=
document.createElement("select");this.wza.style.width=224+mi.a.kf;this.wza.style.height=32+mi.a.kf;this.wza.setAttribute(ab.a.JD,"scalingElementId");this.vza=new jk.a(this.wza,!0);for(var oa=0,Va=Q.scalingOptions.length;oa<Va;++oa){var Ub=nf.a.instance.ea(Q.Rcj[oa]);this.vza.AL(Ub,Q.scalingOptions[oa].toString(),!1)}J.appendChild(this.wza)};Q.prototype.NBe=function(J){this.nya=document.createElement("select");this.nya.style.width=224+mi.a.kf;this.nya.style.height=32+mi.a.kf;this.nya.setAttribute(ab.a.JD,
"paperSizeElementId");this.mya=new jk.a(this.nya,!0);for(var oa=0,Va=Q.paperSizeOptions.length;oa<Va;++oa){var Ub=nf.a.instance.ea(Q.VOi[oa]);this.mya.AL(Ub,Q.paperSizeOptions[oa].toString(),!1)}J.appendChild(this.nya)};Q.prototype.uGh=function(){var J={};J.IsLandscape=2===this.Dya;J.PaperSize=this.Sla;J.ScalingWidth=this.zHb;J.ScalingHeight=this.yHb;J.ScalingPercent=100;J.FitToPage=this.w_?!0:!1;return J};Q.prototype.WGa=function(){var J=new Sys.StringBuilder;J.append(Oj.a(this.$,"Pdf",!0));this.Sha.yvc()&&
Lh.a.Vf(J,Sf.a.Hag,"1");Lh.a.Vf(J,Sf.a.wDd,""+this.f6);Lh.a.Vf(J,Sf.a.PGf,this.$.xa.oa.name);this.f6||(Lh.a.Vf(J,Sf.a.OGf,this.selectedRange),Lh.a.Vf(J,Sf.a.IGf,this.activeCell));Lh.a.Vf(J,Sf.a.JGf,""+this.Dya);Lh.a.Vf(J,Sf.a.KGf,""+this.Sla);Lh.a.Vf(J,Sf.a.NGf,""+this.w_);Lh.a.Vf(J,Sf.a.MGf,"1");Lh.a.Vf(J,Sf.a.HGf,this.LEb?"1":"0");Lh.a.Vf(J,Sf.a.LGf,"1");td.ULS.sendTraceTag(51499296,0,50,"PdfPrintDialog: Print Pdf Url {0}",J.toString());return J.toString()};Q.prototype.Wwb=function(){var J=this,
oa=null;td.ULS.sendTraceTag(537154313,0,50,"PdfPrintDialog:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");this.$.userOperationManager.ic(new Ge.a(223,0,function(Va,Ub,e){Va=new oj.a(Va,null,Ub,e,null,!0,!1,"GetFileCopyFileHandler","");Va.correlationID=vk.a.create().toString();oa=Va;kd.AFrameworkApplication.Hd.h9(J.WGa(),1,null,null,Q.E9c,!1,2,J.Sxd,J.Rxd,oa,void 0,void 0,void 0,12E4);return nb.Task.Ta(!0)},16),null)};Q.prototype.x4h=function(){td.ULS.sendTraceTag(537154312,0,50,
"PdfPrintDialog:InitializeForPrintPdf - Preparing full print pdf dialog");this.hTi(this.Ob);this.q6c(!0);this.RLd(!0);this.Mv=Fe.DOMElementExtensions.getElementById(this.Ob,Z.F3b);this.pca=Fe.DOMElementExtensions.getElementById(this.Ob,"printActiveSheet");this.D$=Fe.DOMElementExtensions.getElementById(this.Ob,"printEntireWorkbook");this.V6&&(this.Qcc=Fe.DOMElementExtensions.getElementById(this.Ob,"ignorePrintAreaCheckboxButtonId"),this.k4a=new Bi.a(this.Qcc));this.bvc()&&(this.Mv.disabled=!0,this.Im.SheetName=
this.sheetName);this.M5h();this.V6&&this.L4h();this.V0i()};Q.prototype.bvc=function(){return!!this.Im.ObjectId||!Oa.g(this.$).ha.va.Dh};Q.prototype.V0i=function(){Vi.a.instance.pa(If.a.change,this.pca,this.f8a);Vi.a.instance.pa(If.a.change,this.D$,this.f8a);Vi.a.instance.pa(If.a.change,this.Mv,this.f8a);Vi.a.instance.pa(If.a.change,this.Hwa,this.Vkc);Vi.a.instance.pa(If.a.change,this.H9a,this.Vkc);Vi.a.instance.pa(If.a.change,this.nya,this.xrf);Vi.a.instance.pa(If.a.change,this.wza,this.yrf);this.V6&&
this.k4a.dmb(this.wrf)};Q.prototype.xGj=function(){Vi.a.instance.za(If.a.change,this.pca,this.f8a);Vi.a.instance.za(If.a.change,this.D$,this.f8a);Vi.a.instance.za(If.a.change,this.Mv,this.f8a);Vi.a.instance.za(If.a.change,this.Hwa,this.Vkc);Vi.a.instance.za(If.a.change,this.H9a,this.Vkc);Vi.a.instance.za(If.a.change,this.nya,this.xrf);Vi.a.instance.za(If.a.change,this.wza,this.yrf);this.V6&&this.k4a.Ica(this.wrf)};Q.prototype.hTi=function(J){J.classList.add(ba.dUi);if(!this.Le){document.getElementById("ewaDialogTitle").classList.add(ba.printDialogTitle);
var oa=document.getElementById("ewaDialogCloseButtonLink");oa.style.top=32+mi.a.kf;this.rtl?oa.style.left=32+mi.a.kf:oa.style.right=32+mi.a.kf}oa=Q.Iy(ba.eUi);J.appendChild(oa);var Va=Q.Iy(ba.X9a,1180);Va.style.marginBottom=12+mi.a.kf;Va.id="whatToPrintTitleElementId";oa.appendChild(Va);Va=Q.Iy(ba.W9a);oa.appendChild(Va);Q.gqb(Va,this.rtl,"printActiveSheet",1184,"whatToPrintRbName","PrintWhatExcelActiveSheets_32x32x32","activeSheetRadioButtonInnerLabelElementId","whatToPrintTitleElementId");oa.appendChild(document.createElement("BR"));
Va=Q.Iy(ba.W9a);oa.appendChild(Va);Q.gqb(Va,this.rtl,"printEntireWorkbook",1177,"whatToPrintRbName","PrintWhatExcelEntireWorkbook_32x32x32","entireWorkbookRadioButtonInnerLabelElementId","whatToPrintTitleElementId");oa.appendChild(document.createElement("BR"));Va=Q.Iy(ba.W9a);oa.appendChild(Va);Q.gqb(Va,this.rtl,Z.F3b,1176,"whatToPrintRbName","PrintWhatExcelSelection_32x32x32","currentSelectionRadioButtonInnerLabelElementId","whatToPrintTitleElementId");this.V6?(Va=Q.Iy(ba.X9a,1209),Va.style.marginTop=
24+mi.a.kf,Va.id="printAreaElementId",oa.appendChild(Va),Eg.EwaSettings.isChangeGateEnabled("OfficeVSO:4879681_PrintAreaCheckboxKeyboardFocus")?(Va.style.marginBottom=12+mi.a.kf,Va=Q.Iy(Mj.a.s7c),Va.id="ignorePrintAreaCheckboxWarpperId",Fe.DOMElementExtensions.setVisible(Va,!0),oa.appendChild(Va),oa=this.getElementById("ignorePrintAreaCheckboxButtonId"),Fe.DOMElementExtensions.setVisible(oa,!0),Va.appendChild(oa),oa=this.getElementById("ignorePrintAreaCheckboxLabelId"),Fe.DOMElementExtensions.setVisible(oa,
!0),Va.appendChild(oa)):(Va=Q.Iy(ba.W9a),oa.appendChild(Va),Q.m0g(Va,this.rtl))):(Va=Q.Iy(ba.X9a,1182),Va.style.marginTop=24+mi.a.kf,Va.id="paperSizeElementId",oa.appendChild(Va),Va=Q.Iy(ba.GCd),this.NBe(Va),oa.appendChild(Va));oa=Q.Iy(ba.fUi);J.appendChild(oa);J=Q.Iy(ba.X9a,1181);J.style.marginBottom=12+mi.a.kf;J.id="orientationTitleElementId";oa.appendChild(J);J=Q.Iy(ba.W9a);oa.appendChild(J);Q.gqb(J,this.rtl,"portraitRadioButtonId",1187,"orientationRbName","Portrait_32x32x32","portraitRadioButtonInnerLabelElementId",
"orientationTitleElementId");oa.appendChild(document.createElement("BR"));J=Q.Iy(ba.W9a);oa.appendChild(J);Q.gqb(J,this.rtl,"landscapeRadioButtonId",1186,"orientationRbName","Landscape_32x32x32","landscapeRadioButtonInnerLabelElementId","orientationTitleElementId");this.V6&&(J=Q.Iy(ba.X9a,1182),J.style.marginTop=12+mi.a.kf,J.id="paperSizeElementId",oa.appendChild(J),J=Q.Iy(ba.GCd),this.NBe(J),oa.appendChild(J));J=Q.Iy(ba.X9a,1183);J.style.marginTop=(this.V6?10:74)+mi.a.kf;J.id="scalingElementId";
oa.appendChild(J);J=Q.Iy(ba.GCd);this.Y4g(J);oa.appendChild(J);this.Le||document.getElementById("buttonarea").classList.add(ba.cUi);this.Hwa=Fe.DOMElementExtensions.getElementById(this.Ob,"landscapeRadioButtonId");this.H9a=Fe.DOMElementExtensions.getElementById(this.Ob,"portraitRadioButtonId")};Q.prototype.xWg=function(){var J=this;td.ULS.sendTraceTag(51499294,0,50,"PdfPrintDialog:CommitWithConvertPdf - CommitWithConvertPdf called");this.f6=this.CXc();2!==this.f6&&(this.Dya=this.fte(),this.mya&&(this.Sla=
Q.paperSizeOptions[this.mya.selectedIndex]),this.vza&&(this.w_=Q.scalingOptions[this.vza.selectedIndex]));if(this.$.Tva&&Eg.EwaSettings.isChangeGateEnabled("OfficeVSO:4445349_DisablePrintLatencyImprovementForCrossDomain")){var oa=this.$.qa.ta.Xb();this.$.userOperationManager.ic(new Ge.a(133,0,function(Va,Ub,e){var C={};C.WhatToPrint=J.f6;C.UseNamedAction=J.Sha.yvc();C.SelectedSheetName=J.$.xa.oa.name;C.ActiveCell=J.activeCell;C.SelectedRanges=[J.selectedRange];C.IsPdfDocumentRequired=!1;C.Orientation=
J.Dya;C.PaperSize=J.Sla;C.Scaling=J.w_;C.RichValuesEnabled=!0;J.V6&&(C.IgnorePrintArea=J.LEb);return Y(J.$.qa.ta,C,T.b(J.YBb,Va),Ub,e,oa)},16),null)}else this.Wwb()};Q.prototype.q6c=function(J){this.H9a.disabled=J;this.Hwa.disabled=J;this.mya.Hn.disabled=J;this.vza.Hn.disabled=J};Q.prototype.RLd=function(J){J?(this.Hwa.checked=!1,this.H9a.checked=!1,this.mya.selectedIndex=-1,this.vza.selectedIndex=-1):(2===this.Dya?this.Hwa.checked=!0:this.H9a.checked=!0,this.mya.selectedIndex=this.uAd[this.Sla.toString()],
this.vza.selectedIndex=this.w_)};Q.prototype.icj=function(J){var oa=this;td.ULS.sendTraceTag(537154310,0,50,"PdfPrintDialog:SavePrintSettingsToFile - We should make a set SheetPrintSettings call here to set print Settings.");var Va=this.$.xa.oa.name,Ub=this.$.qa.ta.Xb();this.$.userOperationManager.ic(new Ge.a(226,0,function(e,C,M){return na(oa.$.qa.ta,Va,J,e,C,M,Ub)},void 0,function(){return new O(Va,J)}),null)};Q.prototype.ehd=function(J){return this.Tr.IsLandscape!==J.IsLandscape||this.Tr.PaperSize!==
J.PaperSize||this.Tr.FitToPage!==J.FitToPage||this.Tr.ScalingHeight!==J.ScalingHeight||this.Tr.ScalingWidth!==J.ScalingWidth?!0:!1};Q.prototype.fte=function(){return this.Hwa&&this.Hwa.checked?2:1};Q.prototype.CXc=function(){return this.Mv.checked?0:this.pca.checked?1:this.D$.checked?2:1};Q.Iy=function(J,oa){J=void 0===J?null:J;oa=void 0===oa?0:oa;var Va=document.createElement("div");J&&(Va.className=J);oa&&(Va.innerHTML=nf.a.instance.ea(oa));return Va};Q.w2g=function(J){var oa=document.createElement("input");
oa.setAttribute("type","checkbox");oa.className=Mj.a.jKe;oa.id="ignorePrintAreaCheckboxButtonId";oa.setAttribute("name","ignorePrintAreaCbName");oa.style.height=16+mi.a.kf;oa.style.width=16+mi.a.kf;Fe.DOMElementExtensions.setVisible(oa,!1);var Va=nf.a.instance.ea(1209),Ub=nf.a.instance.ea(1210);oa.setAttribute(ab.a.Bv,Va+mi.a.space+Ub);J.appendChild(oa);oa=document.createElement("label");oa.setAttribute("for","ignorePrintAreaCheckboxButtonId");oa.id="ignorePrintAreaCheckboxLabelId";oa.innerHTML=Ub;
oa.setAttribute(ab.a.dP,"true");oa.style.position="relative";oa.style.marginLeft=15+mi.a.kf;Fe.DOMElementExtensions.setVisible(oa,!1);J.appendChild(oa)};Q.m0g=function(J,oa){var Va=document.createElement("input");Va.setAttribute("type","checkbox");Va.id="ignorePrintAreaCheckboxButtonId";Va.setAttribute("name","ignorePrintAreaCbName");Va.setAttribute(ab.a.JD,"printAreaElementId"+mi.a.space+"ignorePrintAreaCheckboxButtonInnerLabelElementId");Va.style.height=16+mi.a.kf;Va.style.width=16+mi.a.kf;oa?Va.style.marginRight=
0+mi.a.kf:Va.style.marginLeft=0+mi.a.kf;J.appendChild(Va);oa=document.createElement("label");oa.setAttribute("for","ignorePrintAreaCheckboxButtonId");oa.setAttribute(ab.a.dP,"true");oa.style.position="relative";oa.style.marginLeft=15+mi.a.kf;J.appendChild(oa);J=Q.Iy(ba.CFf,1210);J.id="ignorePrintAreaCheckboxButtonInnerLabelElementId";oa.appendChild(J)};Q.gqb=function(J,oa,Va,Ub,e,C,M,qa){var Na=document.createElement("input");Na.setAttribute("type","radio");Na.id=Va;Na.setAttribute("name",e);Na.setAttribute(ab.a.JD,
qa+mi.a.space+M);Na.style.height=16+mi.a.kf;Na.style.width=16+mi.a.kf;oa?Na.style.marginRight=0+mi.a.kf:Na.style.marginLeft=0+mi.a.kf;J.appendChild(Na);oa=document.createElement("label");oa.setAttribute("for",Va);oa.style.position="relative";J.appendChild(oa);J=Ti.createClusteredImage(32,32,C,ba.lUi,!0,nf.a.instance.ea(Ub));Ub=Q.Iy(ba.CFf,Ub);Ub.id=M;Ub.setAttribute(ab.a.dP,"true");M=Q.Iy(ba.kUi);M.appendChild(Ub);oa.appendChild(M);oa.appendChild(J)};tl.Object.defineProperties(Q.prototype,{xc:{configurable:!0,
enumerable:!0,get:function(){return"PdfPrintDialog"}}});Q.q4c=1;Q.p4c=0;Q.f4b=100;Q.Iqb=9;Q.j4c=!0;Q.WIg=13;Q.paperSizeOptions=[1,5,6,7,8,9,11,12,3,20,27,28,34,37,43,14];Q.VOi=[1189,1190,1197,1191,1192,1193,1194,1195,1188,1198,1199,1200,1201,1202,1203,1204];Q.scalingOptions=[0,1,2,3];Q.Rcj=[1205,1206,1207,1208];Q.E9c=["Content-Type"];Object(Xe.a)(Q,"PdfPrintDialog",Z,[]);tl.Object.defineProperties(I.prototype,{lv:{configurable:!0,enumerable:!0,get:function(){return this.f6},set:function(J){0<=J&&
2>=J?this.f6=J:(td.ULS.sendTraceTag(537154308,0,10,"Attempt to set invalid state. Setting ActiveSheets instead."),this.f6=1)}},ignorePrintArea:{configurable:!0,enumerable:!0,get:function(){return this.p5d},set:function(J){J||!J?this.p5d=J:td.ULS.sendTraceTag(537154307,0,10,"Attempt to set invalid ignorePrintArea")}}});Object(Xe.a)(I,"PdfPrintDialogBrowserSessionState",null,[]);var ok=b(1370);Object(Xe.a)(R,"MacroRecorderPrintAreaSetPayload",null,[116]);Object(Xe.a)(W,"MacroRecorderPageBreakInsertedPayload",
null,[116]);Object(Xe.a)(ia,"MacroRecorderPageBreakRemovedPayload",null,[116]);P.prototype.getSheetName=function(){return this.sheetName};Object(Xe.a)(P,"MacroRecorderPageBreaksAllResetPayload",null,[116]);N.prototype.getSheetName=function(){return this.sheetName};Object(Xe.a)(N,"MacroRecorderPrintAreaClearedPayload",null,[116]);var Xj=b(154);Object(Xe.a)(U,"PageBreaksInformation",null,[]);Object(Xe.a)(B,"RowColBreak",null,[]);Object(Xe.a)(w,"SharedRange",null,[]);var Tk=b(122);G.prototype.executeCommand=
function(J,oa,Va,Ub,e,C,M){e=void 0===e?null:e;C=void 0===C?null:C;M=void 0===M?null:M;this.$Td();this.ribbonCommandInfo=oa;this.Mwj(oa.command);J=T.b(e,this.qEj);td.ULS.sendTraceTag(543794888,0,50,"PrintCommandHandler.ExecuteCommand: {0} command execution started",oa.command);switch(oa.command){case 78661008:return this.y3e(oa,J,C,M,!1);case 275604654:return this.y3e(oa,J,C,M,!0);case -13332329:return this.w2e(oa,J,C,M);case -837651977:return this.zXh(oa,J,C,M);case -1778266776:return this.rYh(oa,
J,C,M);case 845325699:return this.t3e(oa,J,C,M)}return Cd.a(oa.command)};G.prototype.Gc=function(J,oa){switch(oa.command){case 78661008:case 275604654:case -837651977:case -1778266776:return 1===J;case 845325699:case -13332329:return!0}return!1};G.prototype.GWf=function(J,oa,Va){var Ub=Oa.g(this.$),e=Ub.Ca,C=rh.r(Ub.ha.va.selectedRanges,this.$);if((e=e.oE())&&e.length){e=yl(e);for(var M=e.next();!M.done;M=e.next()){M=M.value;var qa=M.yf;if(qa){for(var Na=rh.j(M.Wf),Hb=[],Gc=yl(C.Ranges),gd=Gc.next();!gd.done;gd=
Gc.next()){var Uc=gd.value;Uc.FirstRow>Na.LastRow+1||Uc.LastRow<Na.FirstRow||Uc.FirstColumn>Na.LastColumn+1||Uc.LastColumn<Na.FirstColumn||(gd=this.POh(Na,Uc,qa),Uc=this.OOh(Na,Uc,qa),Hb.push(Object.assign(new w,{FirstRow:gd.FirstRow,FirstColumn:Uc.FirstColumn,LastRow:gd.LastRow,LastColumn:Uc.LastColumn})))}0<Hb.length&&!Va?qa.setPrintArea(Hb):0<Hb.length&&Va?qa.addToPrintArea(Hb):!Va&&qa.hasPrintArea()&&qa.clearPrintArea();!qa.isDirty()&&qa.hasPageLayout()&&qa.setDirty("PrintAreaBreakManager::SetPrintAreaInstantaneous, hash: "+
M.Xd,4)}}this.KLb(Ub,J,oa)}};G.prototype.YTg=function(J,oa){var Va=Oa.g(this.$),Ub=Oa.g(this.$).Ca.oE();if(Ub&&Ub.length){Ub=yl(Ub);for(var e=Ub.next();!e.done;e=Ub.next()){e=e.value;var C=e.yf;C&&(C.clearPrintArea(),!C.isDirty()&&C.hasPageLayout()&&C.setDirty("PrintAreaBreakManager::ClearPrintAreaInstantaneous, hash: "+e.Xd,4))}this.KLb(Va,J,oa)}};G.prototype.s6h=function(J,oa){var Va=Oa.g(this.$),Ub=Va.Ca,e=rh.o(Va.ha.va.activeCell,this.$);if(e){var C=Ub.oE();if(C&&C.length){Ub=null;for(var M=yl(C),
qa=M.next();!qa.done;qa=M.next()){qa=qa.value;var Na=qa.yf;if(Na){var Hb=rh.j(qa.Wf);if(!(e.FirstRow>Hb.LastRow||e.FirstRow<Hb.FirstRow||e.FirstColumn>Hb.LastColumn||e.FirstColumn<Hb.FirstColumn)&&(Ub=this.K3g(Na,Hb,e),Na.insertPageBreak(Ub),!Na.isDirty()&&Na.hasPageLayout()&&Na.setDirty("PrintAreaBreakManager::InsertPageBreakInstantaneous, hash: "+qa.Xd,4),Ub))break}}if(!Ub)for(C=yl(C),qa=C.next();!qa.done;qa=C.next())if(Ub=qa.value,M=Ub.yf)Ub=rh.j(Ub.Wf),Ub=this.MBe(M,Ub,e),M.insertPageBreak(Ub);
this.KLb(Va,J,oa)}}};G.prototype.i3i=function(J,oa){var Va=Oa.g(this.$),Ub=Va.Ca,e=rh.o(Va.ha.va.activeCell,this.$);if(e&&(Ub=Ub.oE())&&Ub.length){Ub=yl(Ub);for(var C=Ub.next();!C.done;C=Ub.next()){C=C.value;var M=C.yf;if(M){var qa=rh.j(C.Wf);(qa=this.MBe(M,qa,e))&&M.removePageBreak(qa);!M.isDirty()&&M.hasPageLayout()&&M.setDirty("PrintAreaBreakManager::RemovePageBreakInstantaneous, hash: "+C.Xd,4)}}this.KLb(Va,J,oa)}};G.prototype.k9i=function(J,oa){var Va=Oa.g(this.$),Ub=Va.Ca.oE();if(Ub&&Ub.length){Ub=
yl(Ub);for(var e=Ub.next();!e.done;e=Ub.next()){e=e.value;var C=e.yf;C&&(C.resetAllPageBreak(),!C.isDirty()&&C.hasPageLayout()&&C.setDirty("PrintAreaBreakManager::ResetAllPageBreakInstantaneous, hash: "+e.Xd,4))}this.KLb(Va,J,oa)}};G.prototype.y3e=function(J,oa,Va,Ub,e){if(!e){var C=this.$.xb.getItemByName("PRINT_AREA");if(C&&(td.ULS.sendTraceTag(537154306,0,15,"PrintCommandHandler.HandleSetPrintAreaCommand: Print_Area already present as NamedObject of type : {0}",C.type),2===C.type))return this.X7h(),
nb.Task.Ta(!0)}C=Oa.g(this.$).ha.va;var M=rh.r(C.selectedRanges,this.$);if(1===M.Ranges.length&&!e){if(C.wwa())return this.GYh(J,M,oa,Va,Ub,e),nb.Task.Ta(!0);if(rh.R(M.Ranges[0]))return this.$.xa.oa.hasPrintArea?this.w2e(J,oa,Va,Ub):nb.Task.Ta(!0)}this.GWf(J.command,Ub,e);return this.o9e(J,oa,Va,M,e)};G.prototype.w2e=function(J,oa,Va,Ub){this.YTg(J.command,Ub);return this.I7h(J,oa,Va)};G.prototype.zXh=function(J,oa,Va,Ub){this.s6h(J.command,Ub);return this.U7h(J,oa,Va)};G.prototype.rYh=function(J,
oa,Va,Ub){if(Eg.EwaSettings.isChangeGateEnabled("OfficeVSO:4767450_ResetAllPageBreaksOnSelectAllAndRemovePageBreak")){var e=rh.r(Oa.g(this.$).ha.va.selectedRanges,this.$);if(rh.R(e.Ranges[0]))return this.t3e(J,oa,Va,Ub)}this.i3i(J.command,Ub);return this.Z7h(J,oa,Va)};G.prototype.t3e=function(J,oa,Va,Ub){this.k9i(J.command,Ub);return this.a8h(J,oa,Va)};G.prototype.o9e=function(J,oa,Va,Ub,e){function C(){return new R(Ub,e)}function M(Na,Hb,Gc){Na=T.b(Na,oa);Hb=T.a(Hb,Va);var gd=qa.Oa(1,null);gd.selectedRanges=
Ub;gd.addToPrintArea=e;return Le.i(qa,"SetPrintArea",gd,Na,Hb,Gc,null,0)}var qa=this.$.qa.ta;return Eg.EwaSettings.tc()?oe.a(this.$.userOperationManager,M,function(Na){return new Ge.a(241,0,Na,64,C)},J):oe.a(this.$.userOperationManager,M,function(Na){return new rj.a(241,0,Na,void 0,C)},J)};G.prototype.I7h=function(J,oa,Va){function Ub(){return new N(C)}function e(qa,Na,Hb){qa=T.b(qa,oa);Na=T.a(Na,Va);var Gc=M.Oa(1,null);Gc.sheetName=C;return Le.i(M,"ClearPrintArea",Gc,qa,Na,Hb,null,0)}var C=this.$.xa.oa.name,
M=this.$.qa.ta;return Eg.EwaSettings.tc()?oe.a(this.$.userOperationManager,e,function(qa){return new Ge.a(243,0,qa,64,Ub)},J):oe.a(this.$.userOperationManager,e,function(qa){return new rj.a(243,0,qa,void 0,Ub)},J)};G.prototype.U7h=function(J,oa,Va){function Ub(){return new W(qa)}function e(Na,Hb,Gc){var gd=C.$.qa.ta;Na=T.b(Na,oa);Hb=T.a(Hb,Va);var Uc=gd.Oa(9,null);Uc.sheetCell=qa;return Le.i(gd,"InsertPageBreak",Uc,Na,Hb,Gc,null,0)}var C=this,M=Oa.g(this.$),qa=rh.o(M.ha.va.activeCell,this.$);return Eg.EwaSettings.tc()?
oe.a(this.$.userOperationManager,e,function(Na){return new Ge.a(244,0,Na,64,Ub)},J):oe.a(this.$.userOperationManager,e,function(Na){return new rj.a(244,0,Na,void 0,Ub)},J)};G.prototype.Z7h=function(J,oa,Va){function Ub(){return new ia(qa)}function e(Na,Hb,Gc){var gd=C.$.qa.ta;Na=T.b(Na,oa);Hb=T.a(Hb,Va);var Uc=gd.Oa(9,null);Uc.sheetCell=qa;return Le.i(gd,"RemovePageBreak",Uc,Na,Hb,Gc,null,0)}var C=this,M=Oa.g(this.$),qa=rh.o(M.ha.va.activeCell,this.$);return Eg.EwaSettings.tc()?oe.a(this.$.userOperationManager,
e,function(Na){return new Ge.a(245,0,Na,64,Ub)},J):oe.a(this.$.userOperationManager,e,function(Na){return new rj.a(245,0,Na,void 0,Ub)},J)};G.prototype.a8h=function(J,oa,Va){function Ub(){return new P(M)}function e(qa,Na,Hb){var Gc=C.$.qa.ta;qa=T.b(qa,oa);Na=T.a(Na,Va);var gd=Gc.Oa(9,null);gd.sheetName=M;return Le.i(Gc,"ResetAllPageBreaks",gd,qa,Na,Hb,null,0)}var C=this,M=this.$.xa.oa.name;return Eg.EwaSettings.tc()?oe.a(this.$.userOperationManager,e,function(qa){return new Ge.a(246,0,qa,64,Ub)},
J):oe.a(this.$.userOperationManager,e,function(qa){return new rj.a(246,0,qa,void 0,Ub)},J)};G.prototype.POh=function(J,oa,Va){if(!J||!oa||!Va)return null;var Ub=new w;Ub.FirstRow=oa.FirstRow===J.LastRow+1?Va.getRowIndex(J.LastRow+1)+1:oa.FirstRow<J.FirstRow?0:Va.getRowIndex(oa.FirstRow+1);Ub.LastRow=oa.FirstRow===J.LastRow+1||oa.LastRow>J.LastRow?Va.getRowIndex(J.LastRow+1)+1:Va.getRowIndex(oa.LastRow+1);return Ub};G.prototype.OOh=function(J,oa,Va){if(!J||!oa||!Va)return null;var Ub=new w;Ub.FirstColumn=
oa.FirstColumn===J.LastColumn+1?Va.getColumnIndex(J.LastColumn+1)+1:oa.FirstColumn<J.FirstColumn?0:Va.getColumnIndex(oa.FirstColumn+1);Ub.LastColumn=oa.FirstColumn===J.LastColumn+1||oa.LastColumn>J.LastColumn?Va.getColumnIndex(J.LastColumn+1)+1:Va.getColumnIndex(oa.LastColumn+1);return Ub};G.prototype.K3g=function(J,oa,Va){if(!oa||!Va||!J)return null;var Ub=J.getPrintArea();if(!Ub||!Ub.length)return null;var e=J.getRowIndex(Va.FirstRow+1),C=J.getColumnIndex(Va.FirstColumn+1),M=null,qa=null;Ub=yl(Ub);
for(var Na=Ub.next();!Na.done;Na=Ub.next())if(Na=Na.value,e>=Na.FirstRow&&e<=Na.LastRow&&C>=Na.FirstColumn&&C<=Na.LastColumn){if(Va.FirstRow===Na.FirstRow&&Va.FirstColumn===Na.FirstColumn)return new U;e>Na.FirstRow&&(M=Object.assign(new B,{Index:e-1,Min:Na.FirstColumn-1,Max:Math.min(Na.LastColumn,J.getColumnIndex(oa.LastColumn+1))}));C>Na.FirstColumn&&(qa=Object.assign(new B,{Index:C-1,Min:Na.FirstRow-1,Max:Math.min(Na.LastRow,J.getRowIndex(oa.LastRow+1))}));break}return M||qa?Object.assign(new U,
{Row:M?[M]:null,Col:qa?[qa]:null}):null};G.prototype.U4g=function(J,oa,Va){if(!oa||!Va||!J)return null;var Ub=null;Va.FirstRow>oa.FirstRow&&Va.FirstRow<=oa.LastRow?Ub=Object.assign(new B,{Index:J.getRowIndex(Va.FirstRow+1)-1,Min:-1,Max:-1}):Va.FirstRow===oa.LastRow+1&&(Ub=Object.assign(new B,{Index:J.getRowIndex(oa.LastRow+1),Min:-1,Max:-1}));return Ub};G.prototype.t0g=function(J,oa,Va){if(!oa||!Va||!J)return null;var Ub=null;Va.FirstColumn>oa.FirstColumn&&Va.FirstColumn<=oa.LastColumn?Ub=Object.assign(new B,
{Index:J.getColumnIndex(Va.FirstColumn+1)-1,Min:-1,Max:-1}):Va.FirstColumn===oa.LastColumn+1&&(Ub=Object.assign(new B,{Index:J.getColumnIndex(oa.LastColumn+1),Min:-1,Max:-1}));return Ub};G.prototype.MBe=function(J,oa,Va){if(!Va||!J||!oa)return null;var Ub=this.U4g(J,oa,Va);J=this.t0g(J,oa,Va);return Ub||J?Object.assign(new U,{Row:Ub?[Ub]:null,Col:J?[J]:null}):null};G.prototype.X7h=function(){var J=new Wb.StandardDialog;J.kc=0;J.Cc(1,nf.a.instance.ea(4));J.Kk(nf.a.instance.ea(559),nf.a.instance.ea(560),
1,null)};G.prototype.Mwj=function(J){if(this.$ua.wb(J)&&(this.vOf&&(this.yDb=this.$.Ub.Fc("UserAction","PrintAreaPageBreaksTimeStopwatch")),this.eKa.wb(J)&&this.eKa.remove(J),this.eKa.add(J,vk.a.create().toString()),Oa.g(this.$).Ji)){var oa=Ed.b()?Ed.b().pi(J):"";Oa.g(this.$).Ji.Y6(this.$ua.na(J),this.eKa.na(J),oa)}};G.prototype.gSg=function(J){if(this.yDb&&J){var oa=this.yDb.Ac;this.yDb.stop();this.yDb=null;switch(J){case "SetPrintArea":this.Mob(oa,1700,J);break;case "ClearPrintArea":this.Mob(oa,
1500,J);break;case "InsertPageBreak":this.Mob(oa,1500,J);break;case "RemovePageBreak":this.Mob(oa,1600,J);break;case "ResetAllPageBreaks":this.Mob(oa,1700,J)}}};G.prototype.Mob=function(J,oa,Va){J>oa&&(oa=Object.assign(new Hd.a,{extendedProperties:new Map}),oa.extendedProperties.set("OperationName",Va),oa.extendedProperties.set("OperationExecutionTime",J.toString()),sg.Health.instance.recordQosError(Xj.a.Avj,[Eh.a.vvj],!1,!0,!0,!1,oa))};G.prototype.GYh=function(J,oa,Va,Ub,e,C){var M=this,qa=new Wb.StandardDialog,
Na=new ok.a(nf.a.instance.ea(557),nf.a.instance.ea(558),nf.a.instance.ea(6),nf.a.instance.ea(5));qa.kc=1;qa.Cc(1,Na.confirmButton);qa.Cc(0,Na.cancelButton);qa.Kk(Na.title,Na.body,3,function(Hb){1===Hb&&(M.GWf(J.command,e,C),M.o9e(J,Va,Ub,oa,C))})};G.prototype.KLb=function(J,oa,Va){Va();this.eKa.wb(oa)&&J.Ji.n0(this.eKa.na(oa),Jj.BasicTelemetryCalculator.sQ)};G.prototype.$Td=function(){this.Cnd&&this.$.Ce(-1753588160,-1,0,null)};Object(Xe.a)(G,"PrintAreaBreakManager",null,[526]);var dl=b(384);r.prototype.equals=
function(J){return J?this.orientation===J.orientation&&this.$ba===J.$ba&&this.W_===J.W_&&this.margin===J.margin&&this.sheetPrintOptions===J.sheetPrintOptions&&this.y0a===J.y0a&&this.NoColor===J.NoColor:!1};r.Pze=function(J,oa){J&&oa&&(oa.lv=J.lv,oa.orientation=J.orientation,oa.$ba=J.$ba,oa.W_=J.W_,oa.margin=J.margin,oa.ignorePrintArea=J.ignorePrintArea,oa.sheetPrintOptions=J.sheetPrintOptions,oa.y0a=J.y0a,oa.NoColor=J.NoColor)};Object(Xe.a)(r,"PrintSettingsContainer",null,[]);var il=b(148),cl=b(337),
Bk=b(947),Rk=b(908),pk=b(686);Object(Xe.a)(z,"PrintSettingMarginOption",null,[]);Object(Xe.a)(t,"PrintSettingMarginValue",null,[]);Object(Xe.a)(x,"PrintSettingOption",null,[]);A.prototype.dispose=function(){};A.prototype.Aub=function(J){if(!J)return null;var oa=new t;oa.left=J.Left;oa.right=J.Right;oa.top=J.Top;oa.bottom=J.Bottom;oa.header=J.Header;oa.footer=J.Footer;return oa};A.prototype.x2c=function(J){td.ULS.shipAssertTag(537154186,0,6===J.length,"PrintPreviewManager.CreatePageMargin: marginValue array passed in, doesn't contain 6 margin values");
var oa={};oa.Top=J[0];oa.Bottom=J[1];oa.Left=J[2];oa.Right=J[3];oa.Header=J[4];oa.Footer=J[5];return oa};A.prototype.g5h=function(){this.Zge=[Object.assign(new x,{printSettingOptionKey:1,printSettingOptionText:this.Om.ea(1184)}),Object.assign(new x,{printSettingOptionKey:2,printSettingOptionText:this.Om.ea(1177)}),Object.assign(new x,{printSettingOptionKey:0,printSettingOptionText:this.Om.ea(1176)})];this.kae=[Object.assign(new x,{printSettingOptionKey:1,printSettingOptionText:this.Om.ea(1187)}),
Object.assign(new x,{printSettingOptionKey:2,printSettingOptionText:this.Om.ea(1186)})];this.Bae=[Object.assign(new x,{printSettingOptionKey:1,printSettingOptionText:this.Om.ea(1189)}),Object.assign(new x,{printSettingOptionKey:5,printSettingOptionText:this.Om.ea(1190)}),Object.assign(new x,{printSettingOptionKey:6,printSettingOptionText:this.Om.ea(1197)}),Object.assign(new x,{printSettingOptionKey:7,printSettingOptionText:this.Om.ea(1191)}),Object.assign(new x,{printSettingOptionKey:8,printSettingOptionText:this.Om.ea(1192)}),
Object.assign(new x,{printSettingOptionKey:9,printSettingOptionText:this.Om.ea(1193)}),Object.assign(new x,{printSettingOptionKey:11,printSettingOptionText:this.Om.ea(1194)}),Object.assign(new x,{printSettingOptionKey:12,printSettingOptionText:this.Om.ea(1195)}),Object.assign(new x,{printSettingOptionKey:13,printSettingOptionText:this.Om.ea(1196)}),Object.assign(new x,{printSettingOptionKey:3,printSettingOptionText:this.Om.ea(1188)})];this.mde=[Object.assign(new x,{printSettingOptionKey:0,printSettingOptionText:this.Om.ea(1205)}),
Object.assign(new x,{printSettingOptionKey:1,printSettingOptionText:this.Om.ea(1206)}),Object.assign(new x,{printSettingOptionKey:2,printSettingOptionText:this.Om.ea(1207)}),Object.assign(new x,{printSettingOptionKey:3,printSettingOptionText:this.Om.ea(1208)})];this.f9d=[Object.assign(new z,{printSettingOption:Object.assign(new x,{printSettingOptionKey:0,printSettingOptionText:this.Om.ea(1211)}),marginValue:this.Aub(this.normal)}),Object.assign(new z,{printSettingOption:Object.assign(new x,{printSettingOptionKey:1,
printSettingOptionText:this.Om.ea(1212)}),marginValue:this.Aub(this.wide)}),Object.assign(new z,{printSettingOption:Object.assign(new x,{printSettingOptionKey:2,printSettingOptionText:this.Om.ea(1213)}),marginValue:this.Aub(this.narrow)}),Object.assign(new z,{printSettingOption:Object.assign(new x,{printSettingOptionKey:3,printSettingOptionText:this.Om.ea(1214)}),marginValue:this.Aub(this.d6)})]};A.prototype.$4h=function(){this.normal=this.x2c(this.Rvi);this.narrow=this.x2c(this.Hui);this.wide=this.x2c(this.kPj)};
tl.Object.defineProperties(A.prototype,{whatToPrintOptions:{configurable:!0,enumerable:!0,get:function(){return this.Zge}},orientationOptions:{configurable:!0,enumerable:!0,get:function(){return this.kae}},paperSizeOptions:{configurable:!0,enumerable:!0,get:function(){return this.Bae}},scalingOptions:{configurable:!0,enumerable:!0,get:function(){return this.mde}},marginDetailedOptions:{configurable:!0,enumerable:!0,get:function(){return this.f9d}}});A.a9g=1;A.N8g=1;A.Iqb=9;A.S8g=2;A.L8g=0;A.E8g=!1;
A.A8g=!1;A.xHa={PrintGrid:!1,HorizontalCenter:!1,VerticalCenter:!1,PrintHeaders:!1};Object(Xe.a)(A,"PrintSettingsManagerBase",null,[3]);var $k=b(120);m.prototype.getSheetName=function(){return this.sheetName};Object(Xe.a)(m,"MacroRecorderSheetPrintOptionsSavedPayload",null,[116]);vm(v,A);v.prototype.N7h=function(J){var oa=this;this.O7h(function(Va){J&&(Va=oa.UOh(Va),J(Va))})};v.prototype.SJd=function(J,oa){if(J){var Va=new I(J.lv,J.ignorePrintArea);this.hcj(Va);!oa||this.a1f?td.ULS.sendTraceTag(593294034,
0,50,"PrintSettingsManager.SavePrintSettings: Saving of print settings skipped because {0}",oa?"skipSaveToFile is true":"shouldFilePersistedPrintSettingsBeSaved is false"):(oa=this.WOh(J.W_),oa.IsLandscape=2===J.orientation,oa.PaperSize=J.$ba,this.isUniversalPrintEnabled&&(oa.NoColor=J.NoColor),this.jwa&&(oa.PageMargin=this.ied(J.margin)),oa.SheetPrintOptions=A.xHa,oa.SheetPrintOptions.PrintGrid=J.sheetPrintOptions.PrintGrid,oa.SheetPrintOptions.HorizontalCenter=J.sheetPrintOptions.HorizontalCenter,
oa.SheetPrintOptions.VerticalCenter=J.sheetPrintOptions.VerticalCenter,oa.SheetPrintOptions.PrintHeaders=J.sheetPrintOptions.PrintHeaders,this.gcj(oa))}else td.ULS.sendTraceTag(593294035,0,10,"PrintSettingsManager.SavePrintSettings: printSettingsContainer passed as parameter is null")};v.prototype.ied=function(J){var oa={};J?1===J?oa=this.wide:2===J?oa=this.narrow:3===J&&(oa=this.d6):oa=this.normal;return oa};v.prototype.e8h=function(J){var oa=this;if(J){td.ULS.sendTraceTag(537154197,0,50,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: Make server call to save print options to file");
var Va=function(){return new m(oa.$.xa.oa.name,J)},Ub=this.$.qa.ta,e=this.$.qa.ta.Xb(),C=function(M,qa,Na){var Hb=oa.$.xa.oa.name;M=T.b(oa.Vyd,M);qa=T.a(oa.czd,qa);var Gc=Ub.Oa(1,null);Gc.sheetName=Hb;Gc.printOptions=J;return Le.i(Ub,"SetPrintOptions",Gc,M,qa,Na,e,0)};Va=Eg.EwaSettings.tc()?new Ge.a(598,0,C,64,Va):new rj.a(598,0,C,void 0,Va);this.$.userOperationManager.ic(Va,null)}else td.ULS.sendTraceTag(537154198,0,10,"PrintSettingsManager.InvokeSetPrintOptionsWebMethod: sheetPrintOptions passed as parameter is null")};
v.prototype.dispose=function(){this.Ld||(this.Ld=!0,this.$.userOperationManager.pz(this.aF),this.TX())};v.prototype.hcj=function(J){this.qN.lv=J.lv;this.qN.ignorePrintArea=J.ignorePrintArea};v.prototype.O7h=function(J){function oa(qa,Na,Hb){return S(e.$.qa.ta,e.sheetName,e.locale,T.b(qa,Ub),T.a(Na,Va),Hb,C)}function Va(qa){qa=$h.a.yg(qa.data);td.ULS.sendTraceTag(537154194,0,10,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: {0}.",Ah.a.Uc(qa));J(null)}function Ub(qa){Wg.a(qa)?
td.ULS.sendTraceTag(537154196,0,15,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings failed. Errors: {0}.",Ah.a.Uc(qa.Errors)):(td.ULS.sendTraceTag(537154195,0,50,"PrintSettingsManager.GetPrintSettingsPersistedInFile: Get print settings succeeded."),J(qa.Result))}var e=this,C=this.$.qa.ta.Xb();var M=Eg.EwaSettings.tc()?new Ge.a(247,0,oa,80):new rj.a(247,0,oa,16);M=this.$.userOperationManager.ic(M,null);this.Su.add(M)};v.prototype.gcj=function(J){var oa=this;td.ULS.sendTraceTag(593294031,
0,50,"PrintSettingsManager.SavePrintSettingsPersistedInFile: Make server call to save print settings to file");var Va=this.$.qa.ta.Xb();this.$.userOperationManager.ic(new Ge.a(226,0,function(Ub,e,C){return na(oa.$.qa.ta,oa.sheetName,J,T.b(Ub,oa.EJi),T.a(e,oa.DJi),C,Va)},void 0,function(){return new O(oa.sheetName,J)}),null)};v.prototype.Edi=function(J){return this.z$e(J)||!this.rcf(J.PaperSize)};v.prototype.k$c=function(J){this.z$e(J)&&(td.ULS.sendTraceTag(537154192,0,50,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Custom scaling present in file."),
J.ScalingWidth=v.q4c,J.ScalingHeight=v.p4c,J.ScalingPercent=v.f4b,J.FitToPage=v.j4c);this.rcf(J.PaperSize)||(td.ULS.sendTraceTag(537154191,0,15,"PrintSettingsManager.FixPrintSettingsNotSupportedInXlo: Paper size {0} present in file which is unsupported by XLO.",J.PaperSize.toString()),J.PaperSize=v.Iqb);return J};v.prototype.SOh=function(J){if(J.FitToPage){if(1===J.ScalingWidth&&1===J.ScalingHeight)return 1;if(!J.ScalingWidth&&1===J.ScalingHeight)return 3}else return 0;return 2};v.prototype.ROh=function(J){return this.lnd(J,
this.normal)?0:this.lnd(J,this.wide)?1:this.lnd(J,this.narrow)?2:3};v.prototype.lnd=function(J,oa){return J.Left===oa.Left&&J.Right===oa.Right&&J.Top===oa.Top&&J.Bottom===oa.Bottom&&J.Header===oa.Header&&J.Footer===oa.Footer};v.prototype.WOh=function(J){var oa={};oa.ScalingPercent=v.f4b;oa.FitToPage=!!J;2===J?(oa.ScalingWidth=1,oa.ScalingHeight=0):3===J?(oa.ScalingWidth=0,oa.ScalingHeight=1):1===J&&(oa.ScalingWidth=1,oa.ScalingHeight=1);return oa};v.prototype.rcf=function(J){return this.UOi.contains(J.toString())};
v.prototype.z$e=function(J){return 100!==J.ScalingPercent||J.FitToPage&&(1<J.ScalingWidth||1<J.ScalingHeight)};v.prototype.kZg=function(){for(var J=new pk.a(Ca.a.Ik()),oa=0;oa<this.paperSizeOptions.length;oa++)J.add(this.paperSizeOptions[oa].printSettingOptionKey.toString());return J};v.prototype.UOh=function(J){var oa=null;if(J){var Va=this.qN.lv,Ub=this.qN.ignorePrintArea;this.Edi(J)&&(this.a1f=!0,J=this.k$c(J));oa=new r;oa.lv=Va;oa.ignorePrintArea=Ub;oa.orientation=J.IsLandscape?2:1;oa.$ba=J.PaperSize;
oa.W_=this.SOh(J);oa.sheetPrintOptions=A.xHa;oa.sheetPrintOptions.PrintGrid=J.SheetPrintOptions.PrintGrid;oa.y0a=J.Draft;this.isUniversalPrintEnabled&&(oa.NoColor=J.NoColor);oa.sheetPrintOptions.HorizontalCenter=J.SheetPrintOptions.HorizontalCenter;oa.sheetPrintOptions.VerticalCenter=J.SheetPrintOptions.VerticalCenter;oa.sheetPrintOptions.PrintHeaders=J.SheetPrintOptions.PrintHeaders;this.jwa&&(oa.margin=this.ROh(J.PageMargin),Eg.EwaSettings.isChangeGateEnabled("OfficeVSO:5466517_AddPageMarginLogs")&&
td.ULS.sendTraceTag(553965398,0,50,"PageMargin received : {0}",oa.margin),3===oa.margin&&(this.d6={},this.d6.Left=J.PageMargin.Left,this.d6.Right=J.PageMargin.Right,this.d6.Top=J.PageMargin.Top,this.d6.Bottom=J.PageMargin.Bottom,this.d6.Header=J.PageMargin.Header,this.d6.Footer=J.PageMargin.Footer))}return oa};v.prototype.TX=function(){if(this.Su){for(var J=yl(this.Su),oa=J.next();!oa.done;oa=J.next())oa=oa.value,this.$&&this.$.userOperationManager&&(oa.operation&&td.ULS.sendTraceTag(537154187,0,
50,"PrintSettingsManager.AbortOutstandingUserOperation: Trying to abort pending operation {0}.",$k.a(oa.operation.operationName)),this.$.userOperationManager.CHa(oa)),this.Su.remove(oa);this.Su=null}};v.q4c=1;v.p4c=0;v.f4b=100;v.Iqb=9;v.j4c=!0;Object(Xe.a)(v,"PrintSettingsManager",A,[]);Object(Xe.a)(u,"PrintSettingsTaskPaneCallbacks",null,[]);Object(Xe.a)(f,"SelectedPrintSettings",null,[]);Object(Xe.a)(l,"PrintOperationCallbacks",null,[]);Object(Xe.a)(n,"PrintPreviewPaneCallbacks",null,[]);var el=
b(1186);Object(Xe.a)(k,"UniversalPrintAppSettings",null,[]);var Xi=b(374);c.prototype.YBg=function(J){this.Ma.addHandler("ppocek",J)};c.prototype.R5i=function(J){this.Ma.removeHandler("ppocek",J)};c.prototype.utj=function(J,oa){this.I9i();this.$.userOperationManager.uy(this.aF);this.Im=J;this.Ma.raiseEvent("ppocek");this.Im.SelectedRanges&&this.Im.SelectedRanges.Ranges&&0<this.Im.SelectedRanges.Ranges.length&&this.Im.SelectedRanges.Ranges[0]&&(this.selectedRange=rh.B(this.Im.SelectedRanges.Ranges[0]).toString());
td.ULS.shipAssertTag(537154268,0,!this.Tu,"PrintPreviewManager.ShowPrintPreviewer: printSettingsManager should be null.");this.Tu=new v(this,this.$,oa,this.$.xa.oa.name,nf.a.instance,this.isUniversalPrintEnabled);td.ULS.shipAssertTag(537154267,0,!this.qg,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should be null.");this.qg=new Rk.PrintPreviewPane(this.$,this,this.useMSPdfViewer,this.isUniversalPrintEnabled);this.qg.Ebh();this.qg.wtj();this.qg.pBg(this.Lwf)};c.prototype.hMh=function(){this.Tu.d6&&
4<=this.Tu.marginDetailedOptions.length&&(this.Tu.marginDetailedOptions[3].marginValue=this.Tu.Aub(this.Tu.d6));return this.Tu.marginDetailedOptions};c.prototype.bvc=function(){return!!this.Im&&!!this.Im.ObjectId||!Oa.g(this.$).ha.va.Dh};c.prototype.XOh=function(){var J=Object.assign(new f,{selectedWhatToPrint:A.a9g,selectedOrientation:A.N8g,selectedPaperSize:A.Iqb,selectedScaling:A.S8g,selectedMargin:A.L8g,selectedIgnorePrintArea:A.E8g,selectedPrintGridlines:A.xHa.PrintGrid,selectedDraft:A.A8g,selectedHorizontalCenter:A.xHa.HorizontalCenter,
selectedVerticalCenter:A.xHa.VerticalCenter,selectedRowAndColumnHeadings:A.xHa.PrintHeaders});this.ZG?(J.selectedWhatToPrint=this.ZG.lv,J.selectedOrientation=this.ZG.orientation,J.selectedPaperSize=this.ZG.$ba,J.selectedScaling=this.ZG.W_,this.jwa&&(J.selectedMargin=this.ZG.margin),J.selectedIgnorePrintArea=this.ZG.ignorePrintArea,J.selectedPrintGridlines=this.ZG.sheetPrintOptions.PrintGrid,J.selectedDraft=this.ZG.y0a,this.isUniversalPrintEnabled&&(J.selectedColor=this.ZG.NoColor?0:1),J.selectedHorizontalCenter=
this.ZG.sheetPrintOptions.HorizontalCenter,J.selectedVerticalCenter=this.ZG.sheetPrintOptions.VerticalCenter,J.selectedRowAndColumnHeadings=this.ZG.sheetPrintOptions.PrintHeaders):td.ULS.sendTraceTag(593294038,0,10,"PrintPreviewManager.GetPrintSettingsSelectedOnPaneOpen: initialPrintSettings is null.");return J};c.prototype.AZe=function(){var J=this;return Object.assign(new n,{onBackToSheet:function(){J.kla()}})};c.prototype.TOh=function(){var J=this;return Object.assign(new el.a,{backActionButtonText:nf.a.instance.ea(1164),
printPreviewPaneCallbacks:this.AZe(),logger:new dl.a,disableTellMeControl:!0,printOperationCallbacks:Object.assign(new l,{onClosePreviewer:function(){J.kla()},getGraphServiceAuthorizationToken:this.r9b(),onLocalPrint:function(){J.Cxf()},onNotifyPrintJobStatus:this.onNotifyPrintJobStatus}),universalPrintAppSettings:Object.assign(new k,{graphServiceEndpoint:this.graphServiceEndpoint,graphServiceEndpointVersion:this.j9h()?"testppebeta-print":"v1.0",isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled,
appName:"Excel"})})};c.prototype.VOh=function(){var J=this;return Object.assign(new u,{onSettingChange:function(oa){J.rIi(oa)},onPrint:function(){J.Cxf()}})};c.prototype.rIi=function(J){this.x_++;J?(this.qg&&this.qg.puj(),this.sk.lv=J.selectedWhatToPrint,this.sk.W_=J.selectedScaling,this.sk.orientation=J.selectedOrientation,this.sk.$ba=J.selectedPaperSize,this.isUniversalPrintEnabled&&(this.sk.NoColor=!J.selectedColor),this.jwa&&(this.sk.margin=J.selectedMargin),this.sk.ignorePrintArea=J.selectedIgnorePrintArea,
this.dkj(J.selectedPageStart,J.selectedPageEnd),this.Tu&&this.SZh(this.sk,J)?(this.sk.sheetPrintOptions=A.xHa,this.sk.sheetPrintOptions.PrintGrid=J.selectedPrintGridlines,this.sk.sheetPrintOptions.HorizontalCenter=J.selectedHorizontalCenter,this.sk.sheetPrintOptions.VerticalCenter=J.selectedVerticalCenter,this.sk.sheetPrintOptions.PrintHeaders=J.selectedRowAndColumnHeadings,this.Tu.e8h(this.sk.sheetPrintOptions)):this.Wwb()):td.ULS.sendTraceTag(593294037,0,10,"PrintPreviewManager.OnPrintSettingsChange: changedPrintSettings passed as input is null.")};
c.prototype.kla=function(){this.S4a&&(this.LKb=!0);td.ULS.sendTraceTag(591196513,0,50,"PrintPreviewManager.OnCloseButtonClick: User changed printSettings {0} times before clicking on backToWorkbook icon",this.x_);this.Bxf();this.Tve()};c.prototype.Cxf=function(){td.ULS.sendTraceTag(591196512,0,50,"PrintPreviewManager.OnPrintButtonClick: User changed printSettings {0} times before clicking on print button.",this.x_);this.jwa&&Eg.EwaSettings.isChangeGateEnabled("OfficeVSO:5466517_AddPageMarginLogs")&&
td.ULS.sendTraceTag(543024129,0,50,"PrintPreviewManager.OnPrintButtonClick: Current margin value : {0}, Initial margin value : {1}",this.sk.margin,this.ZG.margin);if(this.useMSPdfViewer)this.yFf();else if(this.z5a)try{this.qg.printPdf(),this.m_c()}catch(J){td.ULS.sendTraceTag(574482433,0,15,"PrintPreviewManager.OnPrintButtonClick: Unable to print. Opening the window."),this.yFf()}else this.Sha.c0f(this.WGa(!0)),this.m_c()};c.prototype.yFf=function(){var J=this.WGa(!0);this.m_c();ni.HelperMethods.sf(J,
void 0,void 0,"PrintPreviewManager.CreateFileCopyFileHandlerURL")};c.prototype.dispose=function(){Mg.a.Fa(this.Ma)};c.prototype.Wwb=function(){var J=this;if(this.$.Tva)this.K7h();else{this.TX();this.eQf();var oa=null;this.A4h();td.ULS.sendTraceTag(593266766,0,50,"PrintPreviewManager:InvokeGetFileCopyFileHandler - Invoking GetFileCopyFileHandler");var Va=function(Ub,e,C){Ub=new oj.a(Ub,null,e,C,null,!0,!1,"GetFileCopyFileHandler","");Ub.correlationID=vk.a.create().toString();oa=Ub;J.oba=J.I2.h9(J.WGa(J.z5a?
!1:!0,J.c9h?"Base64":"Pdf"),1,null,null,c.E9c,!1,2,J.Sxd,J.Rxd,oa,void 0,void 0,void 0,12E4);Ub.requestId=J.oba;td.ULS.sendTraceTag(537154264,0,50,"PrintPreviewManager.InvokeGetFileCopyFileHandler: Creating request with id: {0}.",J.oba);return nb.Task.Ta(!0)};this.uMa=Eg.EwaSettings.tc()?this.$.userOperationManager.ic(new Ge.a(223,0,Va,80),null):this.$.userOperationManager.ic(new rj.a(223,0,Va,16),null)}};c.prototype.m_c=function(){this.Bxf();this.Tve()};c.prototype.Vyd=function(J){Ah.a.Pq(J.Errors)?
this.qg.showErrorMessageForPrintOptions(nf.a.instance.ea(1215)):(td.ULS.sendTraceTag(537154263,0,50,"PrintPreviewManager.OnPrintOptionsUpdationSuccess: SetPrintOptions server call is successful."),this.Wwb(),this.qg&&this.qg.hideErrorMessageForPrintOptions())};c.prototype.czd=function(J){this.qg&&this.qg.showErrorMessageForPrintOptions(nf.a.instance.ea(1215));J=$h.a.yg(J.data);td.ULS.sendTraceTag(537154262,0,10,"PrintPreviewManager.OnSavePrintOptionsToFileFailure: Save print options to file failed. Errors: {0}.",
Ah.a.Uc(J))};c.prototype.K7h=function(){function J(Ub,e,C){var M={};M.WhatToPrint=oa.sk.lv;M.UseNamedAction=oa.Sha.yvc();M.SelectedSheetName=oa.$.xa.oa.name;M.ActiveCell=oa.activeCell;M.SelectedRanges=[oa.selectedRange];M.IsPdfDocumentRequired=!1;M.Orientation=oa.sk.orientation;M.PaperSize=oa.sk.$ba;M.Scaling=oa.sk.W_;M.RichValuesEnabled=!0;M.IgnorePrintArea=oa.sk.ignorePrintArea;M.Preview=!0;oa.isUniversalPrintEnabled&&(M.NoColor=oa.sk.NoColor);oa.DYf()&&(M.PaginationStartPage=oa.kya,M.PaginationEndPage=
oa.Ela,M.OutputTotalPdfPageCount=!0);if(oa.jwa){var qa=oa.Tu.ied(oa.sk.margin);qa&&(M.PageMargin={},M.PageMargin.Top=qa.Top,M.PageMargin.Bottom=qa.Bottom,M.PageMargin.Left=qa.Left,M.PageMargin.Right=qa.Right,M.PageMargin.Header=qa.Header,M.PageMargin.Footer=qa.Footer)}oa.B6a=Y(oa.$.qa.ta,M,T.b(oa.jBi,Ub),T.a(oa.iBi,e),C,Va);return oa.B6a}var oa=this;td.ULS.sendTraceTag(553649883,0,50,"PrintPreviewManager:InvokeConvertWorkbookToPrintPdf - Invoking ConvertWorkbookToPrintPdf");this.TX();var Va=this.$.qa.ta.Xb();
Eg.EwaSettings.tc()?this.uMa=this.$.userOperationManager.ic(new Ge.a(133,0,J,80),null):this.uMa=this.$.userOperationManager.ic(new rj.a(133,0,J,16),null)};c.prototype.Tve=function(){this.$.userOperationManager.pz(this.aF);this.TX();this.eQf();td.ULS.shipAssertTag(537154261,0,!!this.qg,"PrintPreviewManager.cleanUpPrintPreviewPanes: printPreviewPane should not be null");this.qg&&(this.qg.t5i(this.Lwf),this.qg.Nbh(),this.qg=null);this.Im=null;this.Tu&&(this.Tu.dispose(),this.Tu=null);this.Y1a=this.LDb=
null;this.jJc=!1;this.Ma&&this.Ma.raiseEvent("ppocek")};c.prototype.epj=function(){return this.$.isEditMode&&!!this.ZG&&!!this.sk&&2!==this.sk.lv&&this.ehd()};c.prototype.SJd=function(){td.ULS.shipAssertTag(537154260,0,!!this.Tu,"PrintPreviewManager.SavePrintSettings: printSettingsManager should not be null");this.Tu&&this.Tu.SJd(this.sk,this.epj())};c.prototype.WGa=function(J,oa){oa=void 0===oa?"Pdf":oa;var Va=new Sys.StringBuilder;Va.append(Oj.a(this.$,oa,!0));Lh.a.Vf(Va,Sf.a.wDd,""+this.sk.lv);
J&&this.Sha.yvc()&&Lh.a.Vf(Va,Sf.a.Hag,"1");Lh.a.Vf(Va,Sf.a.PGf,this.$.xa.oa.name);this.sk.lv||(Lh.a.Vf(Va,Sf.a.OGf,this.selectedRange),Lh.a.Vf(Va,Sf.a.IGf,this.activeCell));Lh.a.Vf(Va,Sf.a.JGf,""+this.sk.orientation);Lh.a.Vf(Va,Sf.a.KGf,""+this.sk.$ba);Lh.a.Vf(Va,Sf.a.NGf,""+this.sk.W_);Lh.a.Vf(Va,Sf.a.MGf,"1");Lh.a.Vf(Va,Sf.a.HGf,this.sk.ignorePrintArea?"1":"0");Lh.a.Vf(Va,Sf.a.LGf,"1");this.EFg(Va);this.isUniversalPrintEnabled&&Lh.a.Vf(Va,Sf.a.gWi,this.sk.NoColor?"1":"0");this.jwa&&this.DFg(Va);
Fc.a.equals(oa,"Pdf",!0)&&(Va.append("&#toolbar=0"),Va.append("&zoom=100"));J=Va.toString().replace("GetFileCopyFileHandler.aspx?","GetFileCopyFileHandler.aspx/?");td.ULS.sendTraceTag(537154259,0,50,"PrintPreviewManager: Print Pdf Url {0}",J);return J};c.prototype.dkj=function(J,oa){J||oa?(this.mxb=!0,this.kya=J,this.Ela=oa):this.tPf()};c.prototype.EFg=function(J){this.DYf()&&(Lh.a.Vf(J,Sf.a.iWi,""+this.kya),Lh.a.Vf(J,Sf.a.hWi,""+this.Ela),Lh.a.Vf(J,Sf.a.jWi,"1"),td.ULS.sendTraceTag(537154258,0,50,
"PrintPreviewManager: AppendPaginationQueryParameter Print Pdf page range from {0} to {1}",this.kya,this.Ela))};c.prototype.DYf=function(){return null!=this.kya&&0<this.kya&&null!=this.Ela&&0<this.Ela};c.prototype.DFg=function(J){if(this.Tu&&this.sk){var oa=this.Tu.ied(this.sk.margin);oa&&Lh.a.Vf(J,Sf.a.fWi,""+oa.Top+" "+oa.Bottom+" "+oa.Left+" "+oa.Right+" "+oa.Header+" "+oa.Footer)}};c.prototype.YBb=function(J,oa,Va,Ub){this.qg&&(td.ULS.shipAssertTag(537154255,0,!!this.$.xa.oa,"PrintPreviewManager.OnConvertWorkbookToPdfSucceeded: ewaControl.Sheets.ActiveItem should not be null"),
this.$.xa.oa&&(this.z5a?(Ub||(Ub=this.WGa(!1)),this.qg.oli(Ub)):this.otj()))};c.prototype.ehd=function(){return!this.ZG.equals(this.sk)};c.prototype.Bxf=function(){!this.LKb&&0<this.x_&&(this.Dnd?this.SJd():td.ULS.sendTraceTag(537154251,0,50,"PrintPreviewManager:OnPreviewerClose - Previewer is being closed without settings pane being loaded."));td.ULS.shipAssertTag(537154250,0,!!this.qg,"PrintPreviewManager.OnPreviewerClose: printPreviewPane should not be null");this.qg&&this.qg.a0h();this.$Td()};
c.prototype.ri=function(){td.ULS.sendTraceTag(593294036,0,50,"PrintPreviewManager.ShowErrorDialog: Error Dialog displayed.");if(this.qg){var J=this.sza(nf.a.instance.ea(1));this.hna(J,1)}else J=Ah.a.jd(1,0,26,0,1,-1100324317,"GetPrintSettingsFailedError"),Eg.EwaSettings.az()?new cl.a(this.$,J):(new il.ErrorDialog(this.$,J)).mf()};c.prototype.vtj=function(J){J?(!J.lv&&this.bvc()&&(td.ULS.sendTraceTag(537154249,0,50,"PrintPreviewManager.ShowPrintPreviewer: Falling back to ActiveSheet because current selection is a ${0}.",
this.Im.ObjectId?"floatingObject":"discontinuousRange"),J.lv=1),r.Pze(J,this.ZG),r.Pze(J,this.sk),td.ULS.shipAssertTag(537154248,0,!!this.qg,"PrintPreviewManager.ShowPrintPreviewer: printPreviewPane should not be null"),this.qg&&(this.Dnd=!0,this.qg.xtj(),this.Wwb())):(td.ULS.sendTraceTag(537154247,0,10,"PrintPreviewManager.ShowPrintPreviewer: printSettings fetched from server is null."),this.ri())};c.prototype.aZc=function(J,oa,Va){J>oa&&(oa=Object.assign(new Hd.a,{extendedProperties:new Map}),oa.extendedProperties.set("WtpSelectedValue",
Va),oa.extendedProperties.set("FullyRenderedPdfLoadTime",J.toString()),sg.Health.instance.recordQosError(Xj.a.yvj,[Eh.a.i1f],!1,!0,!0,!1,oa))};c.prototype.TX=function(){this.uMa&&(0<this.oba||this.B6a)&&(td.ULS.sendTraceTag(537154246,0,50,"PrintPreviewManager.AbortOutstandingUserOperation: Cancelling request with id: {0}.",this.oba),this.$.userOperationManager.CHa(this.uMa),this.B6a?$h.a.Zt(this.B6a.kt):this.I2.Zt(this.oba),this.xId())};c.prototype.xId=function(){this.B6a=this.uMa=null};c.prototype.A4h=
function(){this.QHd&&this.sk&&(this.Y1a=this.$.Ub.Fc("UserAction",(1===this.sk.lv?"ActiveSheet":this.sk.lv?"EntireWorkbook":"CurrentSelection")+"FullyRenderedPdfLoadTimeStopwatch"))};c.prototype.tPf=function(){this.mxb=!1;this.kya=1;this.Ela=this.JCd};c.prototype.sza=function(J){if(J)return J.replace("&#39;","'");td.ULS.sendTraceTag(537154245,0,15,"PrintPreviewManager.SanitizeErrorMessage: error message is null");return J};c.prototype.otj=function(){td.ULS.sendTraceTag(537154244,0,50,"PrintPreviewManager.ShowPdfRenderingError invoked");
if(this.cyb)if(this.Gfc)td.ULS.sendTraceTag(537154243,0,10,"PrintPreviewManager.ShowPdfRenderingError: Called when preview was supported in both host & browser");else{var J=this.sza(nf.a.instance.ea(1169));this.hna(J,2)}else J=this.sza(nf.a.instance.ea(1170)),this.hna(J,3)};c.prototype.hna=function(J,oa,Va){this.qg.xz(J,oa,void 0===Va?null:Va)};c.prototype.M4h=function(){this.Gfc=this.Bve();this.cyb=this.ESg();this.z5a=this.FSg();td.ULS.sendTraceTag(557061534,0,50,"PrintPreviewManager.InitializeIsPdfPreviewSupportedVars: isPdfPreviewSupportedInCurrentBrowser : {0}, isPdfPreviewSupportedInCurrentHost: {1}, isPdfPreviewSupportedInPreviewer: {2}",
this.Gfc,this.cyb,this.z5a)};c.prototype.I9i=function(){this.y6a=null;this.xId();this.tPf();this.LDb=this.$.Ub.Fc("UserAction","paneLoadTimeStopwatch");this.activeCell=this.$.oa.activeCell.toString();this.x_=0;this.Dnd=this.S4a=this.LKb=!1;this.jJc=!0};c.prototype.crj=function(){var J=this.lfc&&this.oef()?!0:!1;td.ULS.sendTraceTag(537154242,0,50,"PrintPreviewManager.ShouldUseMSPdfViewer : {0}",J);return J};c.prototype.Bve=function(){return!Bf.a.xA};c.prototype.mSg=function(){var J=15;Bf.a.iH&&Bf.a.xrb&&
(J=parseFloat(Bf.a.xrb));return this.Bve()&&14<J&&this.cyb};c.prototype.ESg=function(){var J=this.$.ig.get(111);return this.lfc?J:J&&!this.oef()};c.prototype.oef=function(){return Bf.a.rC||kd.AFrameworkApplication.isUnifiedHostMode};c.prototype.FSg=function(){return this.Gfc&&this.cyb};c.prototype.eQf=function(){this.y6a&&(URL.revokeObjectURL(this.y6a),this.y6a=null)};c.prototype.i0g=function(J){var oa=J.data.fe;J=this.$.Ub.Fc("UserAction","PrintPreviewBlobFileCreation");var Va=window.self.atob(oa);
oa=new Uint8Array(oa.length);for(var Ub=0;Ub<Va.length;Ub++)oa[Ub]=Va.charCodeAt(Ub)&255;Va=new Blob([oa],{type:"application/pdf"});this.y6a=URL.createObjectURL(Va);td.ULS.sendTraceTag(537154241,0,50,"PrintPreviewManager:OnFileHandlerSuccessCallback - Blob created. Total time to create : {0} ms. Blob size: {1}",J.Ac,Va.size);J.stop();return this.y6a+"#toolbar=0&zoom=100"};c.prototype.n_i=function(J){if(this.QHd&&Ah.a.gh(J,c.fQi)){var oa=Object.assign(new Hd.a,{extendedProperties:new Map});oa.extendedProperties.set("ErrorMessageIdName",
J[0].MessageIdName);sg.Health.instance.recordQosError(Xj.a.wFf,[Eh.a.xFf],!1,!0,!0,!1,oa)}};c.prototype.SZh=function(J,oa){return J.sheetPrintOptions.PrintGrid!==oa.selectedPrintGridlines||J.sheetPrintOptions.HorizontalCenter!==oa.selectedHorizontalCenter||J.sheetPrintOptions.VerticalCenter!==oa.selectedVerticalCenter||J.sheetPrintOptions.PrintHeaders!==oa.selectedRowAndColumnHeadings};c.prototype.$Td=function(){this.Cnd&&this.$.Ce(-1753588160,-1,0,null)};c.prototype.j9h=function(){return!!this.$.ya&&
!!this.$.ya.DocumentHostInfo&&"TestHost"===this.$.ya.DocumentHostInfo.HostTier};c.prototype.getToken=function(){return this.vwd.YR("Print",this.graphServiceEndpoint).then(function(J){return J?(J.IsSuccess||td.ULS.sendTraceTag(537154240,0,15,"PrintPreviewManager:GetToken: failed to get token. Error code: {0}, Error message : {1}",J.ErrorCode,J.ErrorMessage),J):Object.assign(new Bk.a,{IsSuccess:!1,ErrorMessage:"Missing result object",ErrorCode:"need_result"})}).catch(function(J){var oa=new Bk.a;Object.getType(J)===
Object.getType(oa)?oa=J:(oa.ErrorMessage=J.toString(),oa.ErrorCode="exception");return Promise.resolve(oa)})};c.prototype.r9b=function(){var J=this;return function(){var oa=Promise.resolve("");try{if(J.vwd&&J.vwd.gLa())return J.getToken().then(function(Va){return Va.IsSuccess?Promise.resolve(Va.Token):oa},function(){return oa})}catch(Va){td.ULS.sendTraceTag(537154211,0,10,"PrintPreviewManager:GetAuthTokenDelegate - Exception thrown while fetching token",Va)}return oa}};c.prototype.onNotifyPrintJobStatus=
function(J,oa){J=Xi.a.sy.notificationBar.l$(J,!1);J.displayTimeoutSeconds=10;J.image="failure"===oa?1:"success"===oa?3:0;Xi.a.sy.notificationBar.BD(J)};tl.Object.defineProperties(c.prototype,{Ddi:{configurable:!0,enumerable:!0,get:function(){return this.jJc}}});c.fQi=[-953554093,1773721536,-1104435974,-1243918982,1205917367,1931972532,1294226134,1239184329,1207537900,-1053855722,-2077518688,1348242499,2030854436,-1831476778];c.E9c=["Content-Type","Total-Pdf-PageCount"];Object(Xe.a)(c,"PrintPreviewManager",
null,[524,3,525]);d.prototype.Xc=function(){return!1};d.prototype.executeCommand=function(J,oa,Va,Ub){var e=oa.command;return 1588554917===e?(oa.txb=!0,uk.a(this.$)&&this.$.da.Aa(423).Svc(!1),this.vch(oa)?nb.Task.Ta(!0):Cd.a(e)):this.uFf.executeCommand(J,oa,Va,Ub,this.ZHi,this.YHi,this.kEj)};d.prototype.Gc=function(J,oa){return 1588554917===oa.command?(td.ULS.shipAssertTag(537154305,0,this.$.Yja,"Command execute requested for Print operation when data duplication is disallowed."),!0):this.uFf.Gc(J,
oa)};d.prototype.fd=function(){return!1};d.prototype.vch=function(J){return this.$.fa.oc?this.wch(J):!1};d.prototype.wch=function(J){td.ULS.sendTraceTag(21099871,0,50,"PrintCommandHandler:DoPrintHtml");var oa=this.$.Ub.Fc("UserAction","DoPrintHtml"),Va=this.$,Ub=this.fa.isNamedObjectViewMode?Va.xb.oa.sheetName:Va.xa.oa.name,e=this.fa.isNamedObjectViewMode,C=!e;Va=this.QOh(Va,Ub,C);var M=!0;!Eg.EwaSettings.isChangeGateEnabled("OfficeVSO:5315453_MoveWebpartsSessionsToPreviewer")&&this.$.Tva&&(M=!1);
C?M?Ak.a(this.$)?td.ULS.sendTraceTag(537154304,0,50,"PrintCommandHandler:DoPrintHtml - Print previewer is already opened."):(this.NC.utj(Va,this.qN),td.ULS.sendTraceTag(591196515,0,50,"PrintCommandHandler:DoPrintHtml Print previewer opened")):((new Q(this.$,nf.a.instance.ea(1178),3,Va,J,this.Sha,Ub,this.qN)).mf(),td.ULS.sendTraceTag(595194760,0,50,"PrintCommandHandler:DoPrintHtml Print dialog shown in pdf mode in {0} ms.",oa.Ac)):((new ca(this.$,nf.a.instance.ea(1178),3,Va,J)).mf(),td.ULS.sendTraceTag(591196514,
0,15,"PrintCommandHandler:DoPrintHtml Print dialog shown in html mode in {0} ms. isNamedObjectViewMode: {1}.",oa.Ac,e));oa.stop();this.Egd();return!0};d.prototype.QOh=function(J,oa,Va){var Ub={};Ub.SessionId=this.fa.sessionId;Ub.UsedRangeTooBig=!1;var e=Oa.g(J),C=e.ha,M=C.Te;if(Hk.e(J.oa))Ub.Type=0,Ub.ObjectId=J.oa.name,Ub.UseSelection=!1;else if(Hk.g(J.oa))Ub.Type=1,Ub.ObjectId=J.oa.Eja,Ub.UseSelection=!0;else if(2===M||4===M||64===M)e=C.Qa.nc.floatingObject,Ub.Type=1,Ub.SheetName=oa,Ub.ObjectId=
e.id,Ub.UseSelection=!0;else if(Va&&M&470)Ub.ObjectId=C.Qa.nc.floatingObject.id,Ub.SheetName=oa;else if(Hk.i(J.oa)){Ub.Type=2;Ub.SheetName=oa;if(C.va.Dh)if(Va=C.va.Qd,Ub.SelectedRanges=rh.q(Va,J),20<Va.HT)Ub.UseSelection=!0;else{oa=0;e=e.sl("PrintCommandHandler.DoPrintHtml",Va);try{for(e.$$rst();e.$$mn()&&2>oa;)e.$$cu().text&&oa++;Ub.UseSelection=2<=oa}finally{e&&e.dispose()}}else Ub.UseSelection=!1,Ub.SelectedRanges=rh.q(C.va.activeRange,J);this.fa.isNamedObjectViewMode&&(Ub.UsedRange=rh.v(J.oa.usedRange,
J))}Ub.Title=J.workbookContext.WorkbookFileName;return Ub};d.prototype.Egd=function(){Oa.g(this.$);if(!this.NYf){this.SOc=!0;var J=this.$.Ub.Fc("UserAction","HandlePageLayoutRendering");this.AEj();td.ULS.sendTraceTag(537154274,0,50,"PrintCommandHandler:HandlePageLayoutRendering rendering is done in {0} ms.",J.Ac);J.stop()}};d.prototype.AEj=function(){for(var J=Oa.g(this.$).Ca,oa=J.oE(),Va=!1,Ub=0,e=0;e<oa.length;e++){var C=oa[e],M=C.yf;M&&M.hasPageLayout()&&(Va=!0,M.setDirty("PrintCommandHandler::TriggerPageLayoutRendering, hash: "+
C.Xd,4),Ub++)}Va&&(td.ULS.sendTraceTag(537154273,0,50,"PrintCommandHandler:TriggerPageLayoutRendering number of total cached blocks is {0}, number of blocks that require re-rendering is {1}",oa.length,Ub),J.ewd())};tl.Object.defineProperties(d.prototype,{NYf:{configurable:!0,enumerable:!0,get:function(){return this.SOc}}});Object(Xe.a)(d,"PrintCommandHandler",null,[237,513]);var vj=Ka.a;vm(a,vj);a.prototype.Md=function(){var J=this,oa=kd.AFrameworkApplication.ga.appSettings,Va=this.$.ya.DirectPrintSetting;
oa.DirectPrintIsEnabled=Va.DirectPrintIsEnabled.toString();oa.DirectPrintProbeIsEnabled=Va.DirectPrintProbeIsEnabled.toString();oa.DirectPrintEnabledForInternetExplorer=Va.DirectPrintEnabledForInternetExplorer.toString();oa.DirectPrintSupportedMimeTypes=Va.DirectPrintSupportedMimeTypes;oa.DirectPrintSupportedPlugins=Va.DirectPrintSupportedPlugins;oa.DirectPrintImmersivePreviewPlugins=Va.DirectPrintImmersivePreviewPlugins;oa.DirectPrintMinimalSupportedEdgeVersion=Va.DirectPrintMinimalSupportedEdgeVersion;
oa.DirectPrintEnabledForEdge=Va.DirectPrintEnabledForEdge.toString();oa=new Ia(oa);var Ub=null;Va=null;try{Va=window.navigator.mimeTypes}catch(M){td.ULS.sendTraceTag(537154270,0,15,"Failed to get Window.Navigator.mimeTypes")}var e=null;try{e=window.navigator.plugins}catch(M){td.ULS.sendTraceTag(537154269,0,15,"Failed to get Window.Navigator.plugins")}Ub=new ma(oa,Va,e,ma.W$e,ma.cef,new ob(kd.AFrameworkApplication.sa.OW),kd.AFrameworkApplication.sa.fD,ma.def,function(M,qa){return new Ma(M,!1,qa)},
!1);if(Eg.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UniversalPrint",!1)&&this.$.ig.get(116)){var C=qc.GetServiceTaskFactory.Xa(this.$.da,349,350,this.tb);lc.TaskExtensions.Ba(C,function(){var M=new d(J.$,Ub,C.result);J.Ed([M])},this.$.ma)}else this.Ed([new d(this.$,Ub,null)])};a.ja=function(J){Ka.a.de(73,new a(J))};Object(Xe.a)(a,"PrintCommandHandlerFactory",Ka.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.BusinessBar");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.HyperLink");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.MsForm");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PresentMode");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Print");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Resize");Type.registerNamespace("_Ewa");jg.a.Yi(".ewa-bb{padding:0;display:block;background-color:#fcf7b6;color:#444;position:relative;overflow:hidden;cursor:default}.ewa-bb-entry{position:relative;height:auto;border-bottom:1px solid #d7d889;overflow:hidden}.ewa-bb-entry:first-child{border-top:1px solid #d7d889}.ewa-bb-entry-body{min-height:24px;position:relative}.ewa-bb-icon{vertical-align:middle;display:inline-block}.ewa-bb-entry-icon{margin:2px 6px 0;display:inline-block}.ewa-bb-entry-title{font-weight:bold}.ewa-bb-entry-message{padding:0 8px}.ewa-bb-entry-button{background-color:#fff;border:1px solid #ababab;color:#444;text-align:center;cursor:default;margin-bottom:1px;padding:3px 10px 4px}.ewa-bb-entry-button:hover{background:#f0f0f0}.ewa-bb-entry-button:active{background:#c6c6c6}.ewa-bb-entry-link{color:#369}.ewa-bb-entry-close{position:absolute;top:50%;margin-top:-8px;cursor:pointer}.ewa-bb-entry-close .clip16x16{display:inline-block}.ewa-bb-entry-title,.ewa-bb-entry-message,.ewa-bb-entry-button-holder,.ewa-bb-entry-link{vertical-align:middle}.ewa-root-ltr .ewa-bb-entry-close,.ewa-nov2-ltr .ewa-bb-entry-close{right:2px}.ewa-root-ltr .ewa-bb-content,.ewa-nov2-ltr .ewa-bb-content{margin-right:26px}.ewa-root-ltr .ewa-bb-entry-button-holder,.ewa-nov2-ltr .ewa-bb-button-holder,.ewa-root-ltr .ewa-bb-entry-link,.ewa-nov2-ltr .ewa-bb-entry-link{margin-left:8px}.ewa-root-rtl .ewa-bb-entry-close,.ewa-nov2-rtl .ewa-bb-entry-close{left:2px}.ewa-root-rtl .ewa-bb-content,.ewa-nov2-rtl .ewa-bb-content{margin-left:26px}.ewa-root-rtl .ewa-bb-entry-button-holder,.ewa-nov2-rtl .ewa-bb-button-holder,.ewa-root-rtl .ewa-bb-entry-link,.ewa-nov2-rtl .ewa-bb-entry-link{margin-right:8px}");
Type.registerNamespace("CADWLTR");eg.main();Type.registerNamespace("Common.App.NewAndOpen.UX");wg.a.instance.mj(new Rd);Type.registerNamespace("Common.App.OneDriveFilePickerApi");Qe.main();Type.registerNamespace("Common");Type.registerNamespace("Common.App.OpenInClient");Type.registerNamespace("Common.App.SaveAsToHost");ag.main();Type.registerNamespace("Common.App.SaveToSharePoint");bf.main();Type.registerNamespace("Common.App.SaveToCloudStorage");mh.main();Type.registerNamespace("Common.App.SaveACopy");
Rf.main();Type.registerNamespace("Common.App.SharedFilePicker");Ff.main();Type.registerNamespace("Common.App.WildFire");ng.main();qe.a.Ga(Zf.ja);qe.a.Ga(Ie.ja);qe.a.Ga(ud.ja);jg.a.Yi(".HyperlinkDialog .ewa-dlg-body-sectionlabel{margin-bottom:5px}.HyperlinkDialog .disabledInput{background-color:#ebebe4;border:solid 1px #b5b5b5}.HyperlinkDialog .ewa-dlg-body-fullLine{width:inherit;min-width:318px;padding-right:5px;padding-left:25px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-fullLine{padding-right:25px;padding-left:5px}.HyperlinkDialog input[type=text]{width:100%;outline:none;padding-left:3px;border:solid 1px #ccc}.HyperlinkDialog .ewa-dlg-body-sectionbreak{height:50px;position:relative}.HyperlinkDialog input[type=radio]{position:absolute;left:0}.ewa-dlg-elements-container-rtl .HyperlinkDialog input[type=radio]{left:auto;right:0}.HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-left:24px}.ewa-dlg-elements-container-rtl .HyperlinkDialog .ewa-dlg-body-sectionlabel label{margin-right:24px;margin-left:auto}.ValidationLabel{position:relative;display:block}.ValidationLabelWarning{color:#cc4200}.ValidationLabelError{color:#d90000}.ValidationWarningGlowColor,.ValidationErrorGlowColor,.ValidationLableGlow{border-style:solid;border-width:1px;-webkit-transition:all .2s ease-in-out;-moz-transition:all .2s ease-in-out;-ms-transition:all .2s ease-in-out;-o-transition:all .2s ease-in-out}.HyperlinkDialog div .ValidationErrorGlowColor{box-shadow:0 0 2px #d90000;border-color:#d90000}.HyperlinkDialog div .ValidationWarningGlowColor{box-shadow:0 0 2px #cc4200;border-color:#cc4200}");
qe.a.Ga(we.ja);jg.a.Yi(".MsformCalloutContent{color:#fff;font-size:13pt;line-height:1;padding-right:5px;margin-bottom:12px;margin-top:-6px;padding-left:10px;width:90%}.MsFormCalloutOuter{background-color:#107c41;z-index:1030}");(function(){qe.a.Ga(function(J){cb.ja(J)})})();(function(){qe.a.Ga(function(J){J.da.Ha(165,new Ae(J))})})();qe.a.Ga(Jc.ja);(function(){qe.a.Ga(function(J){J.da.Ha(57,new re(J));J.da.Ha(60,new fd(J));J.da.Ha(63,new vd(J))})})();qe.a.Ga(mb.ja);qe.a.Ga(jd.ja);qe.a.Ga(ib.ja);jg.a.Yi(".ewa-presentMode-overlay{pointer-events:none}.ewa-presentMode-panel-container{z-index:1054;position:absolute;bottom:32px;visibility:hidden}.ewr-presentMode-on .ewa-presentMode-panel-container{visibility:visible}.ewa-presentMode-rowHdrParent-container{position:relative;z-index:1055}.ewa-presentMode-right-frame{position:absolute;bottom:32px;top:0;right:0;width:0;opacity:0;background-color:#f5f5f5}.ewr-presentMode-on .ewa-presentMode-right-frame{width:32px;opacity:1;background-color:#323130}.ewr-presentMode-on-rtl .ewa-presentMode-right-frame{width:0;opacity:0}.ewr-presentMode-on-headers-off .ewa-presentMode-right-frame{width:12px !important;opacity:1}.ewr-namedsheetview .ewa-presentMode-right-frame{background-color:#000 !important}.ewr-presentMode-transition .ewa-presentMode-right-frame{transition:background-color .4s linear}.ewr-presentMode-on #dialogHost{z-index:1056 !important}");
(function(){qe.a.Ga(function(J){Vd.ja(J);gb.ja(J)})})();jg.a.Yi('.PrintDialogBody{height:260px;width:516px;margin-top:17px}.PrintDialogTitle{font-size:21px;margin-top:14px;margin-left:18px;font-family:"Segoe UI Light"}.ewa-dlg-elements-container-rtl .PrintDialogTitle{margin-left:auto;margin-right:18px}.PrintDialogLeftContainer{float:left;width:240px;height:100%;font-size:14px;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogLeftContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRightContainer{float:left;font-size:14px;width:240px;height:inherit;margin-left:18px}.ewa-dlg-elements-container-rtl .PrintDialogRightContainer{float:right;margin-left:auto;margin-right:18px}.PrintDialogRadioButtonContainer{width:224px;height:32px;display:flex;align-items:center}.PrintRadioButtonElementInnerDiv{vertical-align:middle;display:table-cell}.PrintRadioButtonElementOuterDiv{position:absolute;top:0;left:64px;height:32px;width:140px;vertical-align:middle;display:table}.ewa-dlg-elements-container-rtl .PrintRadioButtonElementOuterDiv{left:auto;right:64px}.PrintDialogTitleSection{width:224px;height:19px}.PrintDialogComboBoxContainer{width:224px;height:32px;margin-top:12px}.PrintRadioButtonIcon{margin:0 16px;vertical-align:middle}.PrintButtonArea{margin-right:32px}.ewa-dlg-elements-container-rtl .PrintButtonArea{margin-right:auto;margin-left:32px}.PrintPreviewerContainer{height:100%;width:100%;z-index:998;position:absolute;background:#edebe9}.ewa-hide-print-elements-siblings{display:none}');
jg.a.Yi(".ewa-resizehdr-row-hidden{width:inherit;height:0}.ewa-resizehdr-col-hidden{width:0;height:inherit}");(function(){qe.a.Ga(function(J){Xd.ja(J);pb.ja(J)})})();qe.a.Ga(uc.ja);qe.a.Ga(Jb.ja);(function(){qe.a.Ga(function(J){db.ja(J);Wa.ja(J)})})();qe.a.Ga(Ua.ja);qe.a.Ga(tb.ja);(function(){qe.a.Ga(function(J){lb.ja(J);xa.ja(J)})})();qe.a.Ga(Fb.ja);(function(){qe.a.Ga(function(J){ya.ja(J);Xa.ja(J)})})();Type.registerNamespace("Common.App.DirectPrint");wg.a.instance.mj(new wa);qe.a.Ga(a.ja)},831:function(y,
D,b){function a(B,U){var N=w.call(this,document.createElement("div"))||this;N.Zw=null;N.iX=null;N.K7=null;N.pba=null;N.a1b=null;N.zhe=null;N.$me=null;N.vhf=null;N.Rvb=!1;N.Vy=!1;N.m4=!1;N.nKa=!1;N.vAi=function(P){N.XE(P)};N.yAi=function(P){13===P.keyCode&&N.XE(P)};N.Jwd=function(P){N.Vo(P.zb);return!0};N.Rwd=function(P){N.I5(P.zb);return!0};N.wyd=function(P){N.ula(P.zb);return!0};N.Y0=B;N.zG=U;N.SVc=U.bob.toString();N.title=U.title;N.message=U.message;N.set_visibilityMode(1);return N}b.d(D,"a",function(){return a});
y=b(0);var d=b(13),c=b(88),k=b(276),n=b(12),l=b(117),f=b(91);D=b(232);var u=b(1174),v=b(16),m=b(4),A=b(316),x=b(51),t=b(11),z=b(69),r=b(14),G=b(20),w=D.a;vm(a,w);a.prototype.dispose=function(){c.a.pc([this.a1b,this.iX,this.K7]);this.Vy&&this.iX&&(k.a.instance.za(n.a.click,this.iX.domElement,this.Jwd),l.KeyInputManager.instance.jv(this.domElement,this.zhe));this.m4&&this.K7&&(k.a.instance.za(n.a.click,this.K7.domElement,this.Rwd),l.KeyInputManager.instance.jv(this.domElement,this.$me));this.nKa&&this.pba&&
(k.a.instance.za(n.a.click,this.pba,this.wyd),l.KeyInputManager.instance.jv(this.domElement,this.vhf));this.pba=this.Zw=this.Y0=this.K7=this.iX=null;w.prototype.dispose.call(this)};a.prototype.update=function(){};a.prototype.sIj=function(){this.LBe(!0)};a.prototype.E1c=function(){this.LBe(!1)};a.prototype.LBe=function(B){var U="<div class='"+u.a.nih+"' id='{0}'><div class='"+u.a.lih+"'><a class='"+u.a.tih+"' title='{1}'><span class='"+v.a.YZc+" "+u.a.pih+"' id='{2}'>";this.Vj.length&&(U+="<img class='{3}' src='{4}'/>");
U+="</span></a><span class='"+u.a.sih+"' id='{5}'>{6}</span><span class='"+u.a.rih+"' id='message'>{7}</span><a id='link' href='#' class='"+u.a.qih+"'>{8}</a><span class='"+u.a.VJe+"'><button type='button' id='action' class='"+u.a.UJe+"'>{9}</button></span><span class='"+u.a.VJe+"'><button type='button' id='altAction' class='"+u.a.UJe+"'>{10}</button></span></div><a class='"+u.a.oih+"' tabindex='0' role='button'><span id='close' class='"+v.a.OB+"'><img class='"+v.a.b8c+"' src='{11}' alt='{12}' title='{12}' role='button'/></span></a></div>";
B||(this.domElement.tabIndex=0,this.businessBar.domElement.appendChild(this.domElement));var N=this.businessBar.$.Ib;B=N+"ewaBusinessBarEntryBody"+this.SVc;var P=N+"ewaBusinessBarEntryTitle"+this.SVc;N=N+"ewaBusinessBarEntryIcon"+this.SVc;this.domElement.className=u.a.mih;this.domElement.innerHTML=String.format(U,B,this.alt,N,this.Vj,x.a.Be(0),P,this.title,this.message,this.linkText,this.actionButton,this.aYa,x.a.Be(13),r.a.instance.ea(773));t.DOMElementExtensions.ro(this.domElement,m.a.Bga,P,B);
this.pba=$get("link",this.domElement);t.DOMElementExtensions.setVisible(this.pba,this.nKa);this.nKa&&(k.a.instance.pa(n.a.click,this.pba,this.wyd),this.vhf=l.KeyInputManager.instance.Ur(this.pba,this.wyd,f.a.$h,f.a.L0));this.iX=new A.a(t.DOMElementExtensions.getElementById(this.domElement,"action"));this.iX.isVisible=this.Vy;this.K7=new A.a(t.DOMElementExtensions.getElementById(this.domElement,"altAction"));this.K7.isVisible=this.m4;this.Vy&&(k.a.instance.pa(n.a.click,this.iX.domElement,this.Jwd),
this.zhe=l.KeyInputManager.instance.Ur(this.iX.domElement,this.Jwd,f.a.$h,f.a.L0),this.m4&&(k.a.instance.pa(n.a.click,this.K7.domElement,this.Rwd),this.$me=l.KeyInputManager.instance.Ur(this.iX.domElement,this.Rwd,f.a.$h,f.a.L0)));this.Zw=$get("close",this.domElement);this.a1b=this.Nd.Cd(this.Zw);this.a1b.ja("click",this.vAi);this.a1b.ja("keydown",this.yAi);t.DOMElementExtensions.setVisible(this.Zw,!this.Rvb)};a.prototype.Vo=function(){d.ULS.sendTraceTag(21517968,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnActionClick() for EntryName {1}",
this.zG.hash,this.zG.X6c);G.g(this.businessBar.$).Dq(!0)};a.prototype.I5=function(){d.ULS.sendTraceTag(537170257,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnAltActionClick()",this.zG.hash);G.g(this.businessBar.$).Dq(!0)};a.prototype.ula=function(){d.ULS.sendTraceTag(537170256,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnLinkClick()",this.zG.hash);G.g(this.businessBar.$).Dq(!0)};a.prototype.XE=function(B){d.ULS.sendTraceTag(21517971,0,50,"BusinessBar [{0}]: BusinessBarEntry.OnCloseClick() for EntryName {1}",
this.zG.hash,this.zG.X6c);this.set_visible(!1);this.businessBar.removeEntry(this.QNg);z.g(B)};tl.Object.defineProperties(a.prototype,{QNg:{configurable:!0,enumerable:!0,get:function(){return this.zG.bob}},businessBar:{configurable:!0,enumerable:!0,get:function(){return this.Y0}},actionButton:{configurable:!0,enumerable:!0,get:function(){return this.zG?this.zG.actionButton:""}},aYa:{configurable:!0,enumerable:!0,get:function(){return this.zG?this.zG.aYa:""}},linkText:{configurable:!0,enumerable:!0,
get:function(){return this.zG?this.zG.link:""}},Vj:{configurable:!0,enumerable:!0,get:function(){return this.zG?this.zG.Vj:""}},alt:{configurable:!0,enumerable:!0,get:function(){return this.zG?this.zG.alt:""}}});Object(y.a)(a,"BusinessBarEntry",D.a,[])},908:function(y,D,b){function a(Q,O,ba,ca){var S=I.call(this)||this;S.fF=null;S.PC=null;S.hR=null;S.Vx=null;S.MEb=null;S.sK=null;S.$hc=null;S.Wzb=null;S.Vzb=!1;S.Yva=!0;S.Lnc=null;S.ewaAccessibilityManager=null;S.ICd=null;S.HCd=null;S.LCd=null;S.vld=
!1;S.ovf=function(){v.ULS.sendTraceTag(537154206,0,50,"PrintPreviewPane:OnIframeContentChange API invoked with loadPdfCalled: {0}",S.Vzb);S.Vzb&&(S.i0h(),S.sK.style.visibility="visible",S.$hc?S.$hc.stop():v.ULS.sendTraceTag(537154205,0,10,"PrintPreviewPane:OnIframeContentChange - loadPdfStopwatchForIframe is null."),S.raiseEvent(a.sBb,new u(1)),S.aMd(),S.Vzb=!1)};S.$=Q;S.NC=O;S.g4g();S.lfc=G.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UseMSPdfViewerForRendering",!1);S.useMSPdfViewer=
ba;S.isUniversalPrintEnabled=ca;return S}function d(){this.msPdfViewerFileUrl=null;this.useMSPdfViewer=!1;this.onPdfLoad=null}function c(){this.logger=this.printSettingsTaskPaneCallbacks=this.selectedPrintSettingsValues=this.colorOptions=this.marginDetailedOptions=this.marginOptions=this.scalingOptions=this.paperSizeOptions=this.orientationOptions=this.whatToPrintOptions=null;this.isViewMode=this.shouldDisableCurrentSelection=!1;this.dataCultureTag=this.isMetricMeasurementUnit=this.isUniversalPrintFlowEnabled=
null}function k(){this.msPdfKitWasmUrl=this.msPdfKitJSUrl=this.pdfViewerWorkerUrl=null}function n(Q){this.qg=Q}function l(Q){this.qg=Q}function f(Q){this.qg=Q}function u(Q){var O=U.call(this)||this;O.hUi=Q;return O}b.r(D);y=b(0);var v=b(13),m=b(5);b(23);var A=b(384),x=b(36),t=b(56),z=b(11),r=b(121),G=b(1),w=b(14),B=b(20),U=Sys.EventArgs;vm(u,U);Object(y.a)(u,"PrintPreviewPaneOperationStatusEventArgs",Sys.EventArgs,[]);var N=b(256),P=b(245);f.prototype.Tg=function(){N.a(this.qg.$).sM(this.Zd)||N.a(this.qg.$).Tg(this)};
f.prototype.t7=function(){N.a(this.qg.$).sM(this.Zd)&&N.a(this.qg.$).XA(this)};f.prototype.zh=function(Q){return z.DOMElementExtensions.Ye(this.Jb,Q)};f.prototype.ji=function(){this.qg.$.frame.Re.dk(this.qg.$.frame.Re.cE)};f.prototype.Vh=function(){};f.prototype.Qe=function(Q,O){return O?!1:(this.qg.enterPrintPreviewHeaderFocusTrapZone(),!0)};tl.Object.defineProperties(f.prototype,{Zd:{configurable:!0,enumerable:!0,get:function(){return P.a.zFf}},Jb:{configurable:!0,enumerable:!0,get:function(){var Q=
b(908).PrintPreviewPane;return document.getElementById(Q.gUi)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(y.a)(f,"PrintPreviewHeaderKeyboardAccessibleSection",null,[100]);l.prototype.Tg=function(){N.a(this.qg.$).sM(this.Zd)||N.a(this.qg.$).Tg(this)};l.prototype.t7=function(){N.a(this.qg.$).sM(this.Zd)&&N.a(this.qg.$).XA(this)};l.prototype.zh=function(Q){return z.DOMElementExtensions.Ye(this.Jb,Q)};l.prototype.ji=function(){this.qg.$.frame.Re.dk(this.qg.$.frame.Re.cE)};
l.prototype.Vh=function(){};l.prototype.Qe=function(Q,O){return O?!1:(this.qg.useMSPdfViewer?(Q=document.getElementById(b(908).PrintPreviewPane.HAd))&&z.DOMElementExtensions.setFocus(Q,!0):z.DOMElementExtensions.setFocus(this.qg.sK),!0)};tl.Object.defineProperties(l.prototype,{Zd:{configurable:!0,enumerable:!0,get:function(){return P.a.AFf}},Jb:{configurable:!0,enumerable:!0,get:function(){var Q=b(908).PrintPreviewPane;return this.qg.useMSPdfViewer?document.getElementById(b(908).PrintPreviewPane.HAd):
document.getElementById(Q.XCf)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(y.a)(l,"PrintPreviewKeyboardAccessibleSection",null,[100]);n.prototype.Tg=function(){N.a(this.qg.$).sM(this.Zd)||N.a(this.qg.$).Tg(this)};n.prototype.t7=function(){N.a(this.qg.$).sM(this.Zd)&&N.a(this.qg.$).XA(this)};n.prototype.zh=function(Q){return z.DOMElementExtensions.Ye(this.Jb,Q)};n.prototype.ji=function(){this.qg.$.frame.Re.dk(this.qg.$.frame.Re.cE)};n.prototype.Vh=function(){};
n.prototype.Qe=function(Q,O){return O?!1:(this.qg.enterPrintSettingsTaskPaneFocusTrapZone(),!0)};tl.Object.defineProperties(n.prototype,{Zd:{configurable:!0,enumerable:!0,get:function(){return P.a.DFf}},Jb:{configurable:!0,enumerable:!0,get:function(){var Q=b(908).PrintPreviewPane;return document.getElementById(Q.KCd)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!0}}});Object(y.a)(n,"PrintSettingsTaskPaneKeyboardAccessibleSection",null,[100]);Object(y.a)(k,"MSPdfViewerFileUrl",
null,[]);Object(y.a)(c,"PrintSettingsTaskPaneProps",null,[]);Object(y.a)(d,"ViewerPaneProps",null,[]);var ia=b(1186),W=b(376),R=b(4);b.d(D,"PrintPreviewPane",function(){return a});var I=x.a;vm(a,I);a.prototype.pBg=function(Q){this.addHandler(a.sBb,Q)};a.prototype.t5i=function(Q){this.removeHandler(a.sBb,Q)};a.prototype.wtj=function(){this.c4g()};a.prototype.xtj=function(){var Q=this.$.Ub.Fc("UserAction","createSettingsPaneStopwatch"),O=document.getElementById(a.KCd);this.h4g();var ba=this.i4g();this.PC.createPrintSettingsTaskPane(O,
ba);Q.stop();this.Vzb=!1;if(this.isUniversalPrintEnabled&&this.Vx){Q="A4";switch(ba.selectedPrintSettingsValues.selectedPaperSize){case 8:Q="A3";break;case 9:Q="A4";break;case 11:Q="A5";break;case 12:Q="JIS B4";break;case 13:Q="JIS B5";break;case 5:Q="North America Legal";break;case 1:Q="North America Letter";break;case 6:Q="North America Invoice";break;case 7:Q="North America Executive";break;case 3:Q="North America Ledger"}this.fF.setDocumentSettings({mediaSize:Q,orientation:2===ba.selectedPrintSettingsValues.selectedOrientation?
"landscape":"portrait",colorMode:1===ba.selectedPrintSettingsValues.selectedColor?"color":"blackAndWhite"})}this.vFd()};a.prototype.setPageRangeSettings=function(Q,O,ba,ca,S){this.PC&&(this.PC.setPageRangeSettings(Q,O,ba,ca,S),this.uWf(String.format(w.a.instance.Cb(195),ca,S,Q)))};a.prototype.a0h=function(){this.Vx&&(this.Vx.style.display="none")};a.prototype.Nbh=function(){this.dispose();this.SUd();this.tGj();this.fF&&this.fF.closePrintPreviewPane();this.hR=this.PC=this.fF=this.Vx=null};a.prototype.oli=
function(Q){v.ULS.sendTraceTag(575534018,0,50,"PrintPreviewPane: LoadPdf invoked.");this.hidePreviewError();this.useMSPdfViewer?((this.Wzb=this.$.Ub.Fc("UserAction","pdfLoadTimeStopwatchForMsPdfViewer"))||v.ULS.sendTraceTag(537154210,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForMsPdfViewer is null."),this.hR.renderPdf(Q)):this.sK&&((this.$hc=this.$.Ub.Fc("UserAction","loadPdfStopwatch"))||v.ULS.sendTraceTag(537154209,0,10,"PrintPreviewPane:LoadPdf - loadPdfStopwatchForIframe is null."),this.Vzb=
!0,this.sK.src&&this.sK.src===Q?this.ovf(null):this.sK.src=Q);if(this.isUniversalPrintEnabled&&this.Vx){var O=W.b(this.$.workbookContext);this.fF.setFileUrl(Q,O)}};a.prototype.onPdfLoad=function(){this.Wzb?(v.ULS.sendTraceTag(537154208,0,50,"PrintPreviewPane:onPdfLoad - Rendering time : {0} ms, isFirstTimeLoad: {1}",this.Wzb.Ac,this.Yva),this.Wzb.stop()):v.ULS.sendTraceTag(537154207,0,10,"PrintPreviewPane:onPdfLoad - loadPdfStopwatchForMsPdfViewer is null.");this.raiseEvent(a.sBb,new u(1));this.hideWaitCursor();
this.aMd()};a.prototype.printPdf=function(){z.DOMElementExtensions.setFocus(this.sK);this.sK.contentWindow.print()};a.prototype.puj=function(){this.showSpinner();this.showWaitCursor();this.uWf("")};a.prototype.i0h=function(){this.hideSpinner();this.hideWaitCursor()};a.prototype.xz=function(Q,O,ba){this.Vx&&this.hR&&(this.vld=!1,this.hR.showErrorDetails(O,Q,void 0===ba?null:ba),this.NC.S4a=!0,this.sK&&(this.sK.src=""),this.disablePrintButton(),this.hideWaitCursor(),a.pdi(O)&&(this.vld=!0,this.bIi()))};
a.prototype.hidePreviewError=function(){this.NC.S4a=!1;this.hR.hidePreviewError();this.enablePrintButton()};a.prototype.Ebh=function(){(this.MEb=document.getElementById(a.BFf))&&this.MEb.parentNode&&this.MEb.parentNode.removeChild(this.MEb)};a.prototype.hideErrorMessageForPrintOptions=function(){this.PC&&this.PC.hideErrorMessageForPrintOptions()};a.prototype.showErrorMessageForPrintOptions=function(Q){this.PC&&this.PC.showErrorMessageForPrintOptions(Q)};a.prototype.showSpinner=function(){this.NC.S4a||
G.EwaSettings.isChangeGateEnabled("OfficeVSO:5547045_ShowLoadingIconOnSettingsChange")&&this.vld?this.hidePreviewError():this.sK&&(this.sK.style.visibility="hidden");this.hR&&this.hR.showSpinner()};a.prototype.hideSpinner=function(){this.hR&&this.hR.hideSpinner()};a.prototype.enablePrintButton=function(){this.PC&&this.PC.enablePrintButton();this.isUniversalPrintEnabled&&this.Vx&&this.fF.updatePrintButtonEnableDisableState(!0)};a.prototype.disablePrintButton=function(){this.PC&&this.PC.disablePrintButton();
this.isUniversalPrintEnabled&&this.Vx&&this.fF.updatePrintButtonEnableDisableState(!1)};a.prototype.showWaitCursor=function(){this.PC&&this.PC.showWaitCursor();this.isUniversalPrintEnabled&&this.Vx&&this.fF.updatePrintButtonEnableDisableState(!1)};a.prototype.hideWaitCursor=function(){this.PC&&this.PC.hideWaitCursor();this.isUniversalPrintEnabled&&this.Vx&&this.fF.updatePrintButtonEnableDisableState(!0)};a.prototype.e4g=function(){if(this.Vx)v.ULS.sendTraceTag(591927430,0,10,"PrintPreviewerPane:CreatePrintPreviewerContainer - printPreviewerContainer should be null");
else if(this.Vx=document.createElement("div"),this.Vx.id=a.BFf,this.Vx.classList.add(a.iUi),this.$.Oq.insertBefore(this.Vx,this.$.Oq.firstChild),m.AFrameworkApplication.sa&&m.AFrameworkApplication.sa.Pa.Ai){var Q=document.getElementById(R.a.xFa);Q&&(this.Vx.style.top=Q.clientHeight+"px",this.Vx.style.height="calc(100% - "+Q.clientHeight+"px)")}};a.prototype.enterPrintPreviewHeaderFocusTrapZone=function(){this.fF.enterPrintPreviewHeaderFocusTrapZone()};a.prototype.enterPrintSettingsTaskPaneFocusTrapZone=
function(){this.fF.enterPrintSettingsTaskPaneFocusTrapZone()};a.prototype.YRi=function(){var Q=this;this.$.da.Za(15,function(O){Q.ewaAccessibilityManager=O;Q.ewaAccessibilityManager.mode=3})};a.prototype.g4g=function(){this.LCd=new n(this);this.ICd=new l(this);this.HCd=new f(this)};a.prototype.vFd=function(){this.LCd.Tg();this.ICd.Tg();this.HCd.Tg();this.YRi()};a.prototype.SUd=function(){this.LCd.t7();this.ICd.t7();this.HCd.t7();B.g(this.$).f0();this.ewaAccessibilityManager&&(this.ewaAccessibilityManager.mode=
0)};a.prototype.jW=function(){this.Lnc=r.a.instance.Cd(this.sK);this.Lnc.ja("load",this.ovf)};a.prototype.tGj=function(){this.Lnc&&this.sK&&this.Lnc.detach("load")};a.prototype.aMd=function(){if(this.Yva){var Q=document.getElementById(a.KCd);Q&&(Q=z.DOMElementExtensions.getElementById(Q,a.vFf))&&(this.Yva=!1,Q.focus())}};a.prototype.bIi=function(){this.NC.S4a=!1;this.enablePrintButton();this.aMd()};a.prototype.c4g=function(){var Q=this;t.GetServiceTaskFactory.Xa(this.$.da,283,284,0).result.wo.loadScript("excelPrintPreviewer").then(function(){var O=
Q.$.Ub.Fc("UserAction","createEmptyPreviewerStopwatch");Q.e4g();Q.f4g();Q.isUniversalPrintEnabled?Q.fF.createEmptyPrintPreviewPaneAsync(Q.Vx,Q.SBe()).then(function(){O.stop();Q.Hye();Q.fF.updatePrintButtonEnableDisableState(!1)}):(Q.fF.createEmptyPrintPreviewPane(Q.Vx,Q.SBe()),O.stop(),Q.Hye())})};a.prototype.Hye=function(){var Q=this.$.Ub.Fc("UserAction","createPdfPreviewPaneStopwatch"),O=document.getElementById(a.HAd);this.useMSPdfViewer&&(O.tabIndex=0);this.Q3g();this.P3g(O);Q.stop();this.raiseEvent(a.sBb,
new u(0))};a.prototype.f4g=function(){this.fF||(this.fF=printPreviewer.PrintPreviewPaneControllerFactoryGlobal.createPrintPreviewPaneController());this.fF||v.ULS.sendTraceTag(537154203,0,10,"PrintPreviewerPane:CreatePrintPreviewerController - printPreviewerController should not be null")};a.prototype.h4g=function(){this.PC||(this.PC=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintSettingsTaskPaneController());this.PC||v.ULS.sendTraceTag(537154202,0,10,"PrintPreviewerPane:CreatePrintSettingsPaneController - printSettingsPaneController should not be null")};
a.prototype.Q3g=function(){this.hR||(this.hR=excelPrintPreviewer.PrintUIControllerFactoryGlobal.createPrintPreviewController());this.hR||v.ULS.sendTraceTag(537154201,0,10,"PrintPreviewerPane:CreatePdfPreviewPaneController - pdfPreviewerPaneController should not be null")};a.prototype.P3g=function(Q){this.lfc?this.hR.createPrintPreviewPane(Q,this.r6g()):this.hR.createPrintPreview(Q);this.useMSPdfViewer||(this.sK=z.DOMElementExtensions.getElementById(this.Vx,a.XCf),this.sK.title=w.a.instance.ea(1166),
this.jW())};a.prototype.i4g=function(){var Q="en-US";var O=this.$.ya.IsMetricMeasurementUnit;this.$.ya.DataCultureTag?Q=this.$.ya.DataCultureTag:v.ULS.sendTraceTag(536994563,0,50,"PrintPreviewerPane:createPrintSettingsProps - DataCultureTag in ewaControl.bootstrapContext is nullable");return Object.assign(new c,{whatToPrintOptions:this.NC.Tu.whatToPrintOptions,orientationOptions:this.NC.Tu.orientationOptions,paperSizeOptions:this.NC.Tu.paperSizeOptions,scalingOptions:this.NC.Tu.scalingOptions,marginDetailedOptions:this.NC.hMh(),
selectedPrintSettingsValues:this.NC.XOh(),printSettingsTaskPaneCallbacks:this.NC.VOh(),logger:new A.a,shouldDisableCurrentSelection:this.NC.bvc(),isViewMode:!this.$.isEditMode,isMetricMeasurementUnit:O,dataCultureTag:Q,isUniversalPrintFlowEnabled:this.isUniversalPrintEnabled})};a.prototype.SBe=function(){return this.isUniversalPrintEnabled?this.NC.TOh():Object.assign(new ia.a,{backActionButtonText:w.a.instance.ea(1164),printPreviewPaneCallbacks:this.NC.AZe(),logger:new A.a,disableTellMeControl:!0})};
a.prototype.r6g=function(){var Q=this;return this.useMSPdfViewer?Object.assign(new d,{useMSPdfViewer:!0,msPdfViewerFileUrl:this.e3g(),onPdfLoad:function(){Q.onPdfLoad()}}):Object.assign(new d,{useMSPdfViewer:!1})};a.prototype.e3g=function(){return Object.assign(new k,{pdfViewerWorkerUrl:this.$.ya.PrintPreviewerPdfViewerWorkerUrl,msPdfKitJSUrl:this.$.ya.PrintPreviewerMSPdfKitJsUrl,msPdfKitWasmUrl:this.$.ya.PrintPreviewerMSPdfKitWasmUrl})};a.prototype.uWf=function(Q){this.Vx&&this.fF.setAdditionalHeaderText(Q)};
a.pdi=function(Q){return 3===Q||2===Q};a.BFf="PrintPreviewerContainer";a.KCd="printSettingsTaskPaneId";a.HAd="previewId";a.XCf="printpreviewiframe";a.gUi="printPreviewHeaderId";a.vFf="printButton";a.iUi="PrintPreviewerContainer";a.sBb="pppnosu";Object(y.a)(a,"PrintPreviewPane",x.a,[534])},975:function(y,D,b){function a(){}b.d(D,"a",function(){return a});y=b(0);var d=b(13),c=b(5),k=b(47),n=b(23);a.WTe=function(l,f){switch(l){case 3:return a.MUh(f);case 2:return a.WNh(f);case 1:return a.pIh(f)}return""};
a.MUh=function(l){switch(l){case 1:return c.AFrameworkApplication.ga.appSettings.WildFireAdjustLinkWordWac.toString();case 2:return c.AFrameworkApplication.ga.appSettings.WildFireAdjustLinkWordWac.toString()}return""};a.WNh=function(l){switch(l){case 1:return c.AFrameworkApplication.ga.appSettings.WildFireAdjustLinkPptWac.toString();case 2:return c.AFrameworkApplication.ga.appSettings.WildFireAdjustLinkPptWac.toString()}return""};a.pIh=function(l){switch(l){case 1:return c.AFrameworkApplication.ga.appSettings.WildFireAdjustLinkExcelWac.toString();
case 2:return c.AFrameworkApplication.ga.appSettings.WildFireAdjustLinkExcelWac.toString()}return""};a.openInClient=function(l,f,u){if(n.a.Xg||n.a.Ip)window.setTimeout(function(){a.AJf(u,a.Tac())},500),MSOJS.ClientUtils.OpenDocumentWithProtocolHandlerNoCallBack(a.Jne(u),l,0,!1)};a.sUg=function(l,f,u,v){f&&v&&v();a.openInClient(l,f,u)};a.Tac=function(){return n.a.Xg?1:n.a.Ip?2:n.a.r6a?3:n.a.isMac?4:0};a.IUh=function(l){switch(l){case 3:return"WildFireWordBizBar";case 2:return"WildFirePowerPointBizBar";
case 1:return"WildFireExcelBizBar";default:return""}};a.JUh=function(l){switch(l){case 3:return"WildFireWordBizBarFlight";case 2:return"WildFirePowerPointBizBarFlight";case 1:return"WildFireExcelBizBarFlight";default:return""}};a.AJf=function(l,f){1===f?(d.ULS.sendTraceTag(17151569,306,50,"User Directed to App Store"),l=a.WTe(l,f),8<n.a.f4a?k.a.sf(l,void 0,void 0,"RedirectToAppStore"):k.a.xU(l)):document.hidden||(a.jfc?(l=c.AFrameworkApplication.ga.appSettings.WildFireUrlChinaStoreAndroid.toString())?
(d.ULS.sendTraceTag(18088018,306,50,"User Directed to China Proxy Page"),k.a.xU(l)):d.ULS.sendTraceTag(18088019,306,50,"Empty Url in China Proxy Page BRS Setting"):(d.ULS.sendTraceTag(18088020,306,50,"User Directed to Play Store"),MSOJS.ClientUtils.NavigateToUrlUsingClickingOnATag(a.WTe(l,f),null,null)))};a.Jne=function(l){switch(l){case 3:return 5;case 2:return 3;case 1:return 1;default:return 0}};a.lbd=function(l){switch(l){case 3:return"WordBizBarDismiss";case 2:return"PptBizBarDismiss";case 1:return"ExcelBizBarDismiss";
default:return""}};a.Mmd=function(l){return(l=a.eLh(l))&&""!==l?Boolean.parse(l):!1};a.QMd=function(l){a.pjj(l)};a.eLh=function(l){try{return localStorage.getItem(l)}catch(f){return d.ULS.sendTraceTag(18416668,306,50,"WildFire LocalStorage GetItem Failed with NullReferenceException : "+f.message),null}};a.pjj=function(l){try{localStorage.setItem(l,"true")}catch(f){d.ULS.sendTraceTag(18416669,306,50,"WildFire LocalStorage SetItem Failed with exception : "+f.message)}};tl.Object.defineProperties(a,
{jfc:{configurable:!0,enumerable:!0,get:function(){return"zh-CN"===window.navigator.language}},wvc:{configurable:!0,enumerable:!0,get:function(){return(n.a.r6a||n.a.isMac)&&n.a.Po}},Dqj:{configurable:!0,enumerable:!0,get:function(){return n.a.Xg||n.a.Ip}}});a.Ive="ChromeExtensionBarDismiss";Object(y.a)(a,"WildFireUtilities",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.kmhv.js.map/f99430fa5dfbd38042463d5e585dd760/EwaDS.kmhv.js.map