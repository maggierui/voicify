var shellPerformance=window.performance,HighResolutionTimingSupported=!!shellPerformance&&"function"==typeof shellPerformance.mark;HighResolutionTimingSupported&&shellPerformance.mark("shell_otellogging_start"),(self.suiteux_shell_webpackJsonp_main=self.suiteux_shell_webpackJsonp_main||[]).push([["otellogging"],{82969:function(e,n,t){t.r(n),t.d(n,{initializeLogging:function(){return Ci}});var r=t(31191);var i,o=(i=[],{fireEvent:function(e){i.forEach((function(n){return n(e)}))},addListener:function(e){e&&i.push(e)}});function a(e,n,t){o.fireEvent({level:e,category:n,message:t})}function s(e,n,t){a(0,e,(function(){var e=t instanceof Error?t.message:"";return n+": "+e}))}var u,l={};!function(e){var n=9007199254740991,t=/^Office(\.[A-Z][a-zA-Z0-9]*){2,}$/,r=/^[a-zA-Z0-9_\.]{1,95}$/;function i(e){return r.test(e)}function o(e){e&&e.forEach((function(e){if("string"!=typeof e.name||!i(e.name))throw new Error("Invalid dataField name");2===e.dataType&&a(e.value)}))}function a(e){if("number"!=typeof e||!isFinite(e)||Math.floor(e)!==e||e<-9007199254740991||e>n)throw new Error("Invalid integer "+JSON.stringify(e))}e.validateTelemetryEvent=function(e){if(!function(e){if(!e||e.length>98)return!1;return t.test(e)}(e.eventName))throw new Error("Invalid eventName");var n=e.eventContract;if(n){if(n.name&&!i(n.name))throw new Error("Invalid eventContract");o(n.dataFields)}o(e.dataFields)},e.validateInt=a}(u||(u={}));function c(e,n){return{name:e,dataType:1,value:n,classification:4}}function f(e,n){return{name:e,dataType:2,value:n,classification:4}}function d(e,n){return{name:e,dataType:0,value:n,classification:4}}function v(e){var n={eventName:e.eventName,eventFlags:e.eventFlags||{},telemetryProperties:e.telemetryProperties?(0,r.pi)({},e.telemetryProperties):{},dataFields:e.dataFields?e.dataFields.slice():[],timestamp:e.timestamp||(new Date).getTime()};return e.eventContract&&(n.eventContract={name:e.eventContract.name,dataFields:e.eventContract.dataFields.slice()}),n}var p=function(){function e(e,n,t){var i,o;this.telemetrySinks=[],this.persistentDataFields=[],this.eventQueue=[],this.config=t||{},e&&(this.telemetrySinks=e.telemetrySinks,(i=this.persistentDataFields).push.apply(i,e.persistentDataFields),this.config=(0,r.pi)((0,r.pi)({},e.getConfig()),this.config)),n&&(o=this.persistentDataFields).push.apply(o,n)}return e.prototype.sendTelemetryEvent=function(e){var n=v(e),t=n.telemetryProperties;if(t.customerContentVersion||t.customerContentType)a(0,0,(function(){return"Customer content"}));else{if(!t.ariaTenantToken||!t.nexusTenantToken){var r=function(e){for(var n=e.length;n>0;){var t=e.substr(0,n);if(l[t])return l[t];n=e.lastIndexOf(".",n-1)}}(n.eventName);if(!r)return void a(0,0,(function(){return"No tenant token: "+e.eventName}));t.ariaTenantToken=r.ariaTenantToken,t.nexusTenantToken=r.nexusTenantToken}this.sendTelemetryEventInternal(n)}},e.prototype.sendCustomerContent=function(e){var n=v(e),t=n.telemetryProperties;return(!t.customerContentVersion||t.customerContentVersion>1)&&(t.customerContentVersion=1),t.ariaTenantToken=void 0,t.nexusTenantToken=void 0,n.dataFields.push(f("EventContent.Type",2)),this.sendTelemetryEventInternal(n)},e.prototype.sendTelemetryEventInternal=function(e){try{if(0===this.telemetrySinks.length)return void(this.config.enableQueue&&this.eventQueue.length<1e3?this.eventQueue.push(e):a(1,0,(function(){return"No telemetry sinks are attached."})));this.processTelemetryEvent(e)}catch(e){return void s(0,"SendTelemetryEvent",e)}try{this.telemetrySinks.forEach((function(n){var t=e.telemetryProperties;t.customerContentVersion&&t.customerContentType?n.sendCustomerContent&&n.sendCustomerContent(e):n.sendTelemetryEvent(e)}))}catch(e){}},e.prototype.processTelemetryEvent=function(e){var n,t;e.dataFields&&(null===(t=e.dataFields)||void 0===t||t.unshift(d("OTelJS.Version","4.5.3")),this.persistentDataFields&&(n=e.dataFields).unshift.apply(n,this.persistentDataFields)),this.config.disableValidation||u.validateTelemetryEvent(e)},e.prototype.addSink=function(e){this.telemetrySinks.push(e)},e.prototype.flushQueue=function(){var e=this,n=this.eventQueue;this.eventQueue=[],this.telemetrySinks.length>0&&n.forEach((function(n){e.sendTelemetryEventInternal(n)}))},e.prototype.setTenantToken=function(e,n,t){!function(e,n){"Office."===e.substring(0,7)&&"."!==e[e.length-1]?l[e]=n:a(0,0,(function(){return"Namespace: "+e}))}(e,{ariaTenantToken:n,nexusTenantToken:t})},e.prototype.cloneEvent=function(e){return v(e)},e.prototype.getConfig=function(){return this.config},e}();function g(e,n){return e?e+"."+n:n}function h(e,n,t,r){t&&r.push(d(""+g(e,n),t))}function y(e,n,t,r){"boolean"==typeof t&&r.push(c(""+g(e,n),t))}function m(e,n,t,r){"number"==typeof t&&r.push(f(""+g(e,n),t))}var C,T=function(e){var n="Activity.Result",t=[];return m(n,"Code",e.code,t),h(n,"Type",e.type,t),m(n,"Tag",e.tag,t),y(n,"IsExpected",e.isExpected,t),t.push(d("zC.Activity.Result","Office.System.Result")),t},S={contractName:"Office.System.Activity",getFields:function(e){var n="Activity",t=[];return h(n,"CV",e.cV,t),m(n,"Duration",e.duration,t),m(n,"Count",e.count,t),m(n,"AggMode",e.aggMode,t),y(n,"Success",e.success,t),e.result&&t.push.apply(t,T(e.result)),t.push(d("zC.Activity",this.contractName)),t}},x=function(e){var n="User",t=[];return h(n,"PrimaryIdentityHash",e.primaryIdentityHash,t),h(n,"PrimaryIdentitySpace",e.primaryIdentitySpace,t),h(n,"TenantId",e.tenantId,t),h(n,"TenantGroup",e.tenantGroup,t),y(n,"IsAnonymous",e.isAnonymous,t),t},b=function(e){var n="App",t=[];return h(n,"Name",e.name,t),h(n,"Platform",e.platform,t),h(n,"Version",e.version,t),t},w=function(e){var n=[];return h("Session","Id",e.id,n),n};!function(e){var n,t=0;e.getNext=function(){return void 0===n&&(n=function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=22,t=[],r=0;r<n;r++)t.push(e.charAt(Math.floor(Math.random()*e.length)));return t.join("")}()),new r(n,++t)},e.getNextChild=function(e){return new r(e.getString(),++e.nextChild)};var r=function(){function e(e,n){this.base=e,this.id=n,this.nextChild=0}return e.prototype.getString=function(){return this.base+"."+this.id},e}();e.CV=r}(C||(C={}));var I=function(){return 1e3*Date.now()};"object"==typeof window&&"object"==typeof window.performance&&"now"in window.performance&&(I=function(){return 1e3*Math.floor(window.performance.now())});var E=function(e){var n,t=I(),r=v(e.telemetryEvent);return{cv:e.parentCv?C.getNextChild(e.parentCv):C.getNext(),eventName:e.telemetryEvent.eventName,dataFields:r.dataFields,eventFlags:r.eventFlags,telemetryProperties:r.telemetryProperties,createChildActivity:function(n){return E({telemetryEvent:n,sendTelemetryEvent:e.sendTelemetryEvent,parentCv:this.cv})},setResult:function(e,n,t){this.result={code:e,type:n,tag:t}},endNow:function(){if(!n){void 0===this.success&&void 0===this.result&&a(1,0,(function(){return"Activity does not have success or result set"}));var r=I();n=!0;var i={duration:r-t,count:1,aggMode:0,cV:this.cv.getString(),success:this.success,result:this.result},o=this.eventContract&&this.eventContract.dataFields?this.eventContract.dataFields:[];return o.push.apply(o,S.getFields(i)),this.eventContract={name:S.contractName,dataFields:o},e.sendTelemetryEvent(this)}a(0,0,(function(){return"Already ended"}))}}},P=function(e){var n=[];return n.push(d("Error.ErrorGroup",e.errorGroup)),n.push(f("Error.Tag",e.tag)),void 0!==e.code&&n.push(f("Error.Code",e.code)),void 0!==e.id&&n.push(f("Error.Id",e.id)),void 0!==e.count&&n.push(f("Error.Count",e.count)),n},k=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return(0,r.ZT)(n,e),n.prototype.createActivity=function(e){return function(e,n){return E({telemetryEvent:n,sendTelemetryEvent:function(n){e.sendTelemetryEvent(n)}})}(this,e)},n.prototype.sendActivity=function(e,n,t,r){return this.sendTelemetryEvent({eventName:e,eventContract:{name:S.contractName,dataFields:S.getFields(n)},dataFields:t,eventFlags:r})},n.prototype.sendError=function(e){var n=P(e.error);return null!=e.dataFields&&n.push.apply(n,e.dataFields),this.sendTelemetryEvent({eventName:e.eventName,dataFields:n,eventFlags:e.eventFlags})},n.prototype.createCustomerContentActivity=function(e){return function(e,n){return E({telemetryEvent:n,sendTelemetryEvent:function(n){e.sendCustomerContent(n)}})}(this,e)},n}(p),_="function",O="object",F="undefined",N=Object,M=N.prototype,L=N.assign,R=N.create,D=N.defineProperty,A=M.hasOwnProperty,B=null;function z(e){return void 0===e&&(e=!0),B&&e||(typeof globalThis!==F&&globalThis&&(B=globalThis),typeof self!==F&&self&&(B=self),typeof window!==F&&window&&(B=window),typeof t.g!==F&&t.g&&(B=t.g)),B}function K(e){throw new TypeError(e)}function U(e){if(R)return R(e);if(null==e)return{};var n=typeof e;function t(){}return n!==O&&n!==_&&K("Object prototype may only be an Object:"+e),t.prototype=e,new t}
// Copyright (c) Microsoft Corporation. All rights reserved.
// Licensed under the MIT License.
(z()||{}).Symbol,(z()||{}).Reflect;var q,H=L||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])M.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e},V=function(e,n){return V=N.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])},V(e,n)};function j(e,n){function t(){this.constructor=e}typeof n!==_&&null!==n&&K("Class extends value "+String(n)+" is not a constructor or null"),V(e,n),e.prototype=null===n?U(n):(t.prototype=n.prototype,new t)}function W(e,n){for(var t=0,r=n.length,i=e.length;t<r;t++,i++)e[i]=n[t];return e}!function(e){e[e.CRITICAL=1]="CRITICAL",e[e.WARNING=2]="WARNING"}(q||(q={}));var G={BrowserDoesNotSupportLocalStorage:0,BrowserCannotReadLocalStorage:1,BrowserCannotReadSessionStorage:2,BrowserCannotWriteLocalStorage:3,BrowserCannotWriteSessionStorage:4,BrowserFailedRemovalFromLocalStorage:5,BrowserFailedRemovalFromSessionStorage:6,CannotSendEmptyTelemetry:7,ClientPerformanceMathError:8,ErrorParsingAISessionCookie:9,ErrorPVCalc:10,ExceptionWhileLoggingError:11,FailedAddingTelemetryToBuffer:12,FailedMonitorAjaxAbort:13,FailedMonitorAjaxDur:14,FailedMonitorAjaxOpen:15,FailedMonitorAjaxRSC:16,FailedMonitorAjaxSend:17,FailedMonitorAjaxGetCorrelationHeader:18,FailedToAddHandlerForOnBeforeUnload:19,FailedToSendQueuedTelemetry:20,FailedToReportDataLoss:21,FlushFailed:22,MessageLimitPerPVExceeded:23,MissingRequiredFieldSpecification:24,NavigationTimingNotSupported:25,OnError:26,SessionRenewalDateIsZero:27,SenderNotInitialized:28,StartTrackEventFailed:29,StopTrackEventFailed:30,StartTrackFailed:31,StopTrackFailed:32,TelemetrySampledAndNotSent:33,TrackEventFailed:34,TrackExceptionFailed:35,TrackMetricFailed:36,TrackPVFailed:37,TrackPVFailedCalc:38,TrackTraceFailed:39,TransmissionFailed:40,FailedToSetStorageBuffer:41,FailedToRestoreStorageBuffer:42,InvalidBackendResponse:43,FailedToFixDepricatedValues:44,InvalidDurationValue:45,TelemetryEnvelopeInvalid:46,CreateEnvelopeError:47,CannotSerializeObject:48,CannotSerializeObjectNonSerializable:49,CircularReferenceDetected:50,ClearAuthContextFailed:51,ExceptionTruncated:52,IllegalCharsInName:53,ItemNotInArray:54,MaxAjaxPerPVExceeded:55,MessageTruncated:56,NameTooLong:57,SampleRateOutOfRange:58,SetAuthContextFailed:59,SetAuthContextFailedAccountName:60,StringValueTooLong:61,StartCalledMoreThanOnce:62,StopCalledWithoutStart:63,TelemetryInitializerFailed:64,TrackArgumentsNotSpecified:65,UrlTooLong:66,SessionStorageBufferFull:67,CannotAccessCookie:68,IdTooLong:69,InvalidEvent:70,FailedMonitorAjaxSetRequestHeader:71,SendBrowserInfoOnUserInit:72,PluginException:73,NotificationException:74,SnippetScriptLoadFailure:99,InvalidInstrumentationKey:100,CannotParseAiBlobValue:101,InvalidContentBlob:102,TrackPageActionEventFailed:103,FailedAddingCustomDefinedRequestContext:104,InMemoryStorageBufferFull:105},Q=D;N.freeze,N.seal;function J(e){return M.toString.call(e)}function X(e){return void 0===e||typeof e===F}function Z(e){return null===e||X(e)}function $(e){return!Z(e)}function Y(e,n){return e&&A.call(e,n)}function ee(e){return typeof e===O}function ne(e){return typeof e===_}function te(e,n,t,r){void 0===r&&(r=!1);var i=!1;if(!Z(e))try{Z(e.addEventListener)?Z(e.attachEvent)||(e.attachEvent("on"+n,t),i=!0):(e.addEventListener(n,t,r),i=!0)}catch(e){}return i}function re(e,n){if(e)for(var t in e)A.call(e,t)&&n.call(e,t,e[t])}function ie(e,n){if(e&&n){var t=n.length,r=e.length;if(e===n)return!0;if(r>=t){for(var i=r-1,o=t-1;o>=0;o--){if(e[i]!=n[o])return!1;i--}return!0}}return!1}function oe(e,n){var t=!1;if(e&&n){var r=n.length;if(e===n)return!0;if(e.length>=r){for(var i=0;i<r;i++)if(e[i]!==n[i])return!1;t=!0}}return t}function ae(e,n){return!(!e||!n)&&-1!==e.indexOf(n)}function se(e){return"[object Date]"===J(e)}function ue(e){return"[object Array]"===J(e)}function le(e){return"[object Error]"===J(e)}function ce(e){return"string"==typeof e}function fe(e){return"number"==typeof e}function de(e){return"boolean"==typeof e}function ve(e){if(e){if(e.toISOString)return e.toISOString();if(se(e)){var n=function(e){var n=String(e);return 1===n.length&&(n="0"+n),n};return e.getUTCFullYear()+"-"+n(e.getUTCMonth()+1)+"-"+n(e.getUTCDate())+"T"+n(e.getUTCHours())+":"+n(e.getUTCMinutes())+":"+n(e.getUTCSeconds())+"."+String((e.getUTCMilliseconds()/1e3).toFixed(3)).slice(2,5)+"Z"}}}function pe(e,n,t){var r=e.length;try{for(var i=0;i<r&&(!(i in e)||-1!==n.call(t||e,e[i],i,e));i++);}catch(e){}}function ge(e,n,t){var r=e.length,i=t||0;try{for(var o=Math.max(i>=0?i:r-Math.abs(i),0);o<r;o++)if(o in e&&e[o]===n)return o}catch(e){}return-1}function he(e){return"string"!=typeof e?e:e.replace(/^\s+|\s+$/g,"")}var ye=!{toString:null}.propertyIsEnumerable("toString"),me=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"];function Ce(e){var n=typeof e;n===_||n===O&&null!==e||K("objKeys called on non-object");var t=[];for(var r in e)e&&A.call(e,r)&&t.push(r);if(ye)for(var i=me.length,o=0;o<i;o++)e&&A.call(e,me[o])&&t.push(me[o]);return t}function Te(e,n,t,r){if(Q)try{var i={enumerable:!0,configurable:!0};return t&&(i.get=t),r&&(i.set=r),Q(e,n,i),!0}catch(e){}return!1}function Se(){var e=Date;return e.now?e.now():(new e).getTime()}function xe(e,n,t,r,i){var o=t;return e&&((o=e[n])===t||i&&!i(o)||r&&!r(t)||(o=t,e[n]=o)),o}function be(e){return!e}function we(e){return!!e}function Ie(e){throw new Error(e)}function Ee(e){return e&&(e=N(L?L({},e):e)),e}
/*
 * Application Insights JavaScript SDK - Core, 2.7.3
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
var Pe="window",ke="JSON",_e="msie",Oe="trident/",Fe=null,Ne=null,Me=!1,Le=null,Re=null;function De(e,n){var t=!1;if(e){try{if(!(t=n in e)){var r=e.prototype;r&&(t=n in r)}}catch(e){}if(!t)try{t=!X((new e)[n])}catch(e){}}return t}function Ae(e){var n=z();return n&&n[e]?n[e]:e===Pe&&Be()?window:null}function Be(){return Boolean(typeof window===O&&window)}function ze(){return Be()?window:Ae(Pe)}function Ke(){return Boolean(typeof document===O&&document)?document:Ae("document")}function Ue(){return Boolean(typeof navigator===O&&navigator)}function qe(){return Ue()?navigator:Ae("navigator")}function He(e){if(e&&Me){var n=Ae("__mockLocation");if(n)return n}return typeof location===O&&location?location:Ae("location")}function Ve(){return Boolean(typeof JSON===O&&JSON||null!==Ae(ke))}function je(){return Ve()?JSON||Ae(ke):null}function We(){var e=qe();return!(!e||!e.product)&&"ReactNative"===e.product}function Ge(){var e=qe();if(e&&(e.userAgent!==Ne||null===Fe)){var n=((Ne=e.userAgent)||"").toLowerCase();Fe=ae(n,_e)||ae(n,Oe)}return Fe}function Qe(e){var n=Object.prototype.toString.call(e),t="";return"[object Error]"===n?t="{ stack: '"+e.stack+"', message: '"+e.message+"', name: '"+e.name+"'":Ve()&&(t=je().stringify(e)),n+t}function Je(){return null===Re&&(Re=Ue()&&Boolean(qe().sendBeacon)),Re}function Xe(e){var n=!1;try{n=!!Ae("fetch");var t=Ae("Request");n&&e&&t&&(n=De(t,"keepalive"))}catch(e){}return n}function Ze(){return null===Le&&(Le="undefined"!=typeof XDomainRequest)&&$e()&&(Le=Le&&!De(Ae("XMLHttpRequest"),"withCredentials")),Le}function $e(){var e=!1;try{e=!!Ae("XMLHttpRequest")}catch(e){}return e}
/*!
 * Microsoft Dynamic Proto Utility, 1.1.4
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
var Ye="constructor",en="prototype",nn="function",tn="_dynClass",rn="_unknown_",on=Object,an=on.getPrototypeOf,sn=0;function un(e,n){return e&&on.prototype.hasOwnProperty.call(e,n)}function ln(e){return e&&(e===on.prototype||e===Array.prototype)}function cn(e){return ln(e)||e===Function.prototype}function fn(e){if(e){if(an)return an(e);var n=e.__proto__||e.prototype||(e.constructor?e.constructor.prototype:null);if(n)return n}return null}function dn(e,n){var t=[],r=on.getOwnPropertyNames;if(r)t=r(e);else for(var i in e)"string"==typeof i&&un(e,i)&&t.push(i);if(t&&t.length>0)for(var o=0;o<t.length;o++)n(t[o])}function vn(e,n,t){return n!==Ye&&typeof e[n]===nn&&(t||un(e,n))}function pn(e){throw new TypeError("DynamicProto: "+e)}function gn(e,n){for(var t=e.length-1;t>=0;t--)if(e[t]===n)return!0;return!1}function hn(e,n,t,r){var i=null;if(e&&un(t,tn)){var o=e._dynInstFuncs||{};if((i=(o[t._dynClass]||{})[n])||pn("Missing ["+n+"] "+nn),!i._dynInstChk&&!1!==o._dynInstChk){for(var a=!un(e,n),s=fn(e),u=[];a&&s&&!cn(s)&&!gn(u,s);){var l=s[n];if(l){a=l===r;break}u.push(s),s=fn(s)}try{a&&(e[n]=i),i._dynInstChk=1}catch(e){o._dynInstChk=!1}}}return i}function yn(e,n,t){var r=n[e];return r===t&&(r=fn(n)[e]),typeof r!==nn&&pn("["+e+"] is not a "+nn),r}function mn(e,n,t,r,i){if(!ln(e)){var o=t._dynInstFuncs=t._dynInstFuncs||{},a=o[n]=o[n]||{};!1!==o._dynInstChk&&(o._dynInstChk=!!i),dn(t,(function(n){vn(t,n,!1)&&t[n]!==r[n]&&(a[n]=t[n],delete t[n],(!un(e,n)||e[n]&&!e[n]._isDynProxy)&&(e[n]=function(e,n){var t=function(){return(hn(this,n,e,t)||yn(n,e,t)).apply(this,arguments)};return t._isDynProxy=1,t}(e,n)))}))}}function Cn(e,n){return un(e,en)?e.name||n||rn:((e||{}).constructor||{}).name||n||rn}function Tn(e,n,t,r){un(e,en)||pn("theClass is an invalid class definition.");var i=e.prototype;(function(e,n){if(an)for(var t=[],r=fn(n);r&&!cn(r)&&!gn(t,r);){if(r===e)return!0;t.push(r),r=fn(r)}return!1})(i,n)||pn("["+Cn(e)+"] is not in class hierarchy of ["+Cn(n)+"]");var o=null;un(i,tn)?o=i._dynClass:(o="_dynCls$"+Cn(e,"_")+"$"+sn,sn++,i._dynClass=o);var a=Tn._dfOpts,s=!!a.useBaseInst;s&&r&&void 0!==r.useBaseInst&&(s=!!r.useBaseInst);var u=function(e){var n={};return dn(e,(function(t){!n[t]&&vn(e,t,!1)&&(n[t]=e[t])})),n}(n),l=function(e,n,t,r){function i(e,n,t){var i=n[t];if(i._isDynProxy&&r){var o=e._dynInstFuncs||{};!1!==o._dynInstChk&&(i=(o[n._dynClass]||{})[t]||i)}return function(){return i.apply(e,arguments)}}var o={};dn(t,(function(e){o[e]=i(n,t,e)}));for(var a=fn(e),s=[];a&&!cn(a)&&!gn(s,a);)dn(a,(function(e){!o[e]&&vn(a,e,!an)&&(o[e]=i(n,a,e))})),s.push(a),a=fn(a);return o}(i,n,u,s);t(n,l);var c=!!an&&!!a.setInstFuncs;c&&r&&(c=!!r.setInstFuncs),mn(i,o,n,u,!1!==c)}Tn._dfOpts={setInstFuncs:!0,useBaseInst:!0};var Sn,xn=Tn,bn=["eventsSent","eventsDiscarded","eventsSendRequest","perfEvent"],wn=null;function In(e,n){return function(){var t=arguments,r=En(n);if(r){var i=r.listener;i&&i[e]&&i[e].apply(i,t)}}}function En(e){var n,t=wn;return t||!0===e.disableDbgExt||(t=wn||((n=Ae("Microsoft"))&&(wn=n.ApplicationInsights),wn)),t?t.ChromeDbgExt:null}function Pn(e){return e?'"'+e.replace(/\"/g,"")+'"':""}function kn(e,n){var t=typeof console!==F?console:Ae("console");if(t){var r="log";t[e]&&(r=e),ne(t[r])&&t[r](n)}}var _n=function(){function e(e,n,t,r){void 0===t&&(t=!1);var i=this;i.messageId=e,i.message=(t?"AI: ":"AI (Internal): ")+e;var o="";Ve()&&(o=je().stringify(r));var a=(n?" message:"+Pn(n):"")+(r?" props:"+Pn(o):"");i.message+=a}return e.dataType="MessageData",e}();var On=function e(n){this.identifier="DiagnosticLogger",this.queue=[];var t=0,r={};xn(e,this,(function(e){function i(e,t){var r=n[e];return Z(r)?t:r}function o(e,t){var r=En(n);r&&r.diagLog&&r.diagLog(e,t)}Z(n)&&(n={}),e.consoleLoggingLevel=function(){return i("loggingLevelConsole",0)},e.telemetryLoggingLevel=function(){return i("loggingLevelTelemetry",1)},e.maxInternalMessageLimit=function(){return i("maxMessageLimit",25)},e.enableDebugExceptions=function(){return i("enableDebugExceptions",!1)},e.throwInternal=function(n,t,i,a,s){void 0===s&&(s=!1);var u=new _n(t,i,s,a);if(e.enableDebugExceptions())throw u;var l=n===q.CRITICAL?"errorToConsole":"warnToConsole";if(X(u.message))o("throw"+(n===q.CRITICAL?"Critical":"Warning"),u);else{var c=e.consoleLoggingLevel();if(s){var f=+u.messageId;!r[f]&&c>=n&&(e[l](u.message),r[f]=!0)}else c>=n&&e[l](u.message);e.logInternalMessage(n,u)}},e.warnToConsole=function(e){kn("warn",e),o("warning",e)},e.errorToConsole=function(e){kn("error",e),o("error",e)},e.resetInternalMessageCount=function(){t=0,r={}},e.logInternalMessage=function(n,i){if(!(t>=e.maxInternalMessageLimit())){var a=!0,s="AITR_"+i.messageId;if(r[s]?a=!1:r[s]=!0,a&&(n<=e.telemetryLoggingLevel()&&(e.queue.push(i),t++,o(n===q.CRITICAL?"error":"warn",i)),t===e.maxInternalMessageLimit())){var u="Internal events throttle limit per PageView reached for this app.",l=new _n(G.MessageLimitPerPVExceeded,u,!1);e.queue.push(l),n===q.CRITICAL?e.errorToConsole(u):e.warnToConsole(u)}}}}))},Fn=null,Nn=function(){function e(n,t,r){var i,o=this,a=!1;(o.start=Se(),o.name=n,o.isAsync=r,o.isChildEvt=function(){return!1},ne(t))&&(a=Te(o,"payload",(function(){return!i&&ne(t)&&(i=t(),t=null),i})));o.getCtx=function(n){return n?n===e.ParentContextKey||n===e.ChildrenContextKey?o[n]:(o.ctx||{})[n]:null},o.setCtx=function(n,t){if(n)if(n===e.ParentContextKey)o[n]||(o.isChildEvt=function(){return!0}),o[n]=t;else if(n===e.ChildrenContextKey)o[n]=t;else{(o.ctx=o.ctx||{})[n]=t}},o.complete=function(){var n=0,r=o.getCtx(e.ChildrenContextKey);if(ue(r))for(var i=0;i<r.length;i++){var s=r[i];s&&(n+=s.time)}o.time=Se()-o.start,o.exTime=o.time-n,o.complete=function(){},!a&&ne(t)&&(o.payload=t())}}return e.ParentContextKey="parent",e.ChildrenContextKey="childEvts",e}(),Mn=function e(n){this.ctx={},xn(e,this,(function(e){e.create=function(e,n,t){return new Nn(e,n,t)},e.fire=function(e){e&&(e.complete(),n&&ne(n.perfEvent)&&n.perfEvent(e))},e.setCtx=function(n,t){n&&((e.ctx=e.ctx||{})[n]=t)},e.getCtx=function(n){return(e.ctx||{})[n]}}))},Ln="CoreUtils.doPerf";function Rn(e,n,t,r,i){if(e){var o=e;if(ne(o.getPerfMgr)&&(o=o.getPerfMgr()),o){var a=void 0,s=o.getCtx(Ln);try{if(a=o.create(n(),r,i)){if(s&&a.setCtx&&(a.setCtx(Nn.ParentContextKey,s),s.getCtx&&s.setCtx)){var u=s.getCtx(Nn.ChildrenContextKey);u||(u=[],s.setCtx(Nn.ChildrenContextKey,u)),u.push(a)}return o.setCtx(Ln,a),t(a)}}catch(e){a&&a.setCtx&&a.setCtx("exception",e)}finally{a&&o.fire(a),o.setCtx(Ln,s)}}}return t()}
/*
 * Application Insights JavaScript SDK - Core, 2.7.3
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
var Dn=function(e,n){var t=this,r=null,i=ne(e.processTelemetry),o=ne(e.setNextPlugin);t._hasRun=!1,t.getPlugin=function(){return e},t.getNext=function(){return r},t.setNext=function(e){r=e},t.processTelemetry=function(a,s){s||(s=n);var u=e?e.identifier:"TelemetryPluginChain";Rn(s?s.core():null,(function(){return u+":processTelemetry"}),(function(){if(e&&i){t._hasRun=!0;try{s.setNext(r),o&&e.setNextPlugin(r),r&&(r._hasRun=!1),e.processTelemetry(a,s)}catch(t){var n=r&&r._hasRun;r&&n||s.diagLog().throwInternal(q.CRITICAL,G.PluginException,"Plugin ["+e.identifier+"] failed during processTelemetry - "+Qe(t)),r&&!n&&r.processTelemetry(a,s)}}else r&&(t._hasRun=!0,r.processTelemetry(a,s))}),(function(){return{item:a}}),!a.sync)}};
/*
 * Application Insights JavaScript SDK - Core, 2.7.3
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
function An(e,n){var t=[];if(e&&e.length>0)for(var r=null,i=0;i<e.length;i++){var o=e[i];if(o&&ne(o.processTelemetry)){var a=new Dn(o,n);t.push(a),r&&r.setNext(a),r=a}}return t.length>0?t[0]:null}var Bn=function e(n,t,r,i){var o=this,a=null;null!==i&&(n&&ne(n.getPlugin)?a=function(e,n,t){var r=[],i=!t;if(e)for(;e;){var o=e.getPlugin();(i||o===t)&&(i=!0,r.push(o)),e=e.getNext()}return i||r.push(t),An(r,n)}(n,o,i||n.getPlugin()):i?a=function(e,n,t){var r=e,i=!1;return t&&e&&(r=[],pe(e,(function(e){(i||e===t)&&(i=!0,r.push(e))}))),t&&!i&&(r||(r=[]),r.push(t)),An(r,n)}(n,o,i):X(i)&&(a=An(n,o))),o.core=function(){return r},o.diagLog=function(){return function(e,n){return(e||{}).logger||new On(n)}(r,t)},o.getCfg=function(){return t},o.getExtCfg=function(e,n){var r;if(void 0===n&&(n={}),t){var i=t.extensionConfig;i&&e&&(r=i[e])}return r||n},o.getConfig=function(e,n,r){var i;void 0===r&&(r=!1);var a=o.getExtCfg(e,null);return a&&!Z(a[n])?i=a[n]:t&&!Z(t[n])&&(i=t[n]),Z(i)?r:i},o.hasNext=function(){return null!=a},o.getNext=function(){return a},o.setNext=function(e){a=e},o.processNext=function(e){var n=a;n&&(a=n.getNext(),n.processTelemetry(e,o))},o.createNew=function(n,i){return void 0===n&&(n=null),new e(n||a,t,r,i)}},zn="extensionConfig",Kn=function(){function e(){var e=this,n=!1,t=null,r=null;e.core=null,e.diagLog=function(n){return e._getTelCtx(n).diagLog()},e.isInitialized=function(){return n},e.setInitialized=function(e){n=e},e.setNextPlugin=function(e){r=e},e.processNext=function(e,n){n?n.processNext(e):r&&ne(r.processTelemetry)&&r.processTelemetry(e,null)},e._getTelCtx=function(n){void 0===n&&(n=null);var i=n;if(!i){var o=t||new Bn(null,{},e.core);i=r&&r.getPlugin?o.createNew(null,r.getPlugin):o.createNew(null,r)}return i},e._baseTelInit=function(i,o,a,s){i&&xe(i,zn,[],null,Z),!s&&o&&(s=o.getProcessTelContext().getNext());var u=r;r&&r.getPlugin&&(u=r.getPlugin()),e.core=o,t=new Bn(s,i,o,u),n=!0}}return e.prototype.initialize=function(e,n,t,r){this._baseTelInit(e,n,t,r)},e}();function Un(e,n){for(var t=[],r=null,i=e.getNext();i;){var o=i.getPlugin();o&&(r&&ne(r.setNextPlugin)&&ne(o.processTelemetry)&&r.setNextPlugin(o),ne(o.isInitialized)&&o.isInitialized()||t.push(o),r=o,i=i.getNext())}pe(t,(function(t){t.initialize(e.getCfg(),e.core(),n,e.getNext())}))}function qn(e){return e.sort((function(e,n){var t=0,r=ne(n.processTelemetry);return ne(e.processTelemetry)?t=r?e.priority-n.priority:1:r&&(t=-1),t}))}
/*
 * Application Insights JavaScript SDK - Core, 2.7.3
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
var Hn=500,Vn=function(e){function n(){var t,r=e.call(this)||this;function i(e){e&&e.length>0&&(function(e){pe(e,(function(e){e.priority<Hn&&Ie("Channel has invalid priority"+e.identifier)}))}(e=e.sort((function(e,n){return e.priority-n.priority}))),t.push(e))}return r.identifier="ChannelControllerPlugin",r.priority=500,xn(n,r,(function(e,n){e.setNextPlugin=function(e){},e.processTelemetry=function(e,n){t&&pe(t,(function(t){t.length>0&&r._getTelCtx(n).createNew(t).processNext(e)}))},e.getChannelControls=function(){return t},e.initialize=function(r,o,a){e.isInitialized()||(n.initialize(r,o,a),function(e,n){t=[],e&&pe(e,(function(e){return i(e)}));if(n){var r=[];pe(n,(function(e){e.priority>Hn&&r.push(e)})),i(r)}}((r||{}).channels,a),pe(t,(function(e){return Un(new Bn(e,r,o),a)})))}})),r}var t;return j(n,e),n._staticInit=(Te(t=n.prototype,"ChannelControls",t.getChannelControls),void Te(t,"channelQueue",t.getChannelControls)),n}(Kn),jn="toGMTString",Wn="toUTCString",Gn="expires",Qn="",Jn=null,Xn=null,Zn=null,$n=Ke(),Yn={},et={};function nt(e){return!e||e.isEnabled()}function tt(e,n){var t=function(e){var n=e.cookieCfg=e.cookieCfg||{};if(xe(n,"domain",e.cookieDomain,$,Z),xe(n,"path",e.cookiePath||"/",null,Z),Z(n.enabled)){var t=void 0;X(e.isCookieUseDisabled)||(t=!e.isCookieUseDisabled),X(e.disableCookiesUsage)||(t=!e.disableCookiesUsage),n.enabled=t}return n}(e||et),r=t.path||"/",i=t.domain,o=!1!==t.enabled,a={isEnabled:function(){var e=o&&rt(n),t=et._ckMgr;return e&&t&&a!==t&&(e=nt(t)),e},setEnabled:function(e){o=!1!==e},set:function(e,n,o,s,u){var l=!1;if(nt(a)){var c={},f=he(n||Qn),d=f.indexOf(";");if(-1!==d&&(f=he(n.substring(0,d)),c=it(n.substring(d+1))),xe(c,"domain",s||i,we,X),!Z(o)){var v=Ge();if(X(c.expires)){var p=Se()+1e3*o;if(p>0){var g=new Date;g.setTime(p),xe(c,Gn,ot(g,v?jn:Wn)||ot(g,v?jn:Wn)||Qn,we)}}v||xe(c,"max-age",Qn+o,null,X)}var h=He();h&&"https:"===h.protocol&&(xe(c,"secure",null,null,X),null===Xn&&(Xn=!lt((qe()||{}).userAgent)),Xn&&xe(c,"SameSite","None",null,X)),xe(c,"path",u||r,null,X),(t.setCookie||ut)(e,at(f,c)),l=!0}return l},get:function(e){var n=Qn;return nt(a)&&(n=(t.getCookie||st)(e)),n},del:function(e,n){var t=!1;return nt(a)&&(t=a.purge(e,n)),t},purge:function(e,r){var i,o=!1;if(rt(n)){var a=((i={}).path=r||"/",i.expires="Thu, 01 Jan 1970 00:00:01 GMT",i);Ge()||(a["max-age"]="0"),(t.delCookie||ut)(e,at(Qn,a)),o=!0}return o}};return a._ckMgr=a,a}function rt(e){if(null===Jn){Jn=!1;try{Jn=void 0!==($n||{}).cookie}catch(t){e&&e.throwInternal(q.WARNING,G.CannotAccessCookie,"Cannot access document.cookie - "+(le(n=t)?n.name:""),{exception:Qe(t)})}}var n;return Jn}function it(e){var n={};e&&e.length&&pe(he(e).split(";"),(function(e){if(e=he(e||Qn)){var t=e.indexOf("=");-1===t?n[e]=null:n[he(e.substring(0,t))]=he(e.substring(t+1))}}));return n}function ot(e,n){return ne(e[n])?e[n]():null}function at(e,n){var t=e||Qn;return re(n,(function(e,n){t+="; "+e+(Z(n)?Qn:"="+n)})),t}function st(e){var n=Qn;if($n){var t=$n.cookie||Qn;Zn!==t&&(Yn=it(t),Zn=t),n=he(Yn[e]||Qn)}return n}function ut(e,n){$n&&($n.cookie=e+"="+n)}function lt(e){return!!ce(e)&&(!(!ae(e,"CPU iPhone OS 12")&&!ae(e,"iPad; CPU OS 12"))||(!!(ae(e,"Macintosh; Intel Mac OS X 10_14")&&ae(e,"Version/")&&ae(e,"Safari"))||(!(!ae(e,"Macintosh; Intel Mac OS X 10_14")||!ie(e,"AppleWebKit/605.1.15 (KHTML, like Gecko)"))||(!(!ae(e,"Chrome/5")&&!ae(e,"Chrome/6"))||(!(!ae(e,"UnrealEngine")||ae(e,"Chrome"))||!(!ae(e,"UCBrowser/12")&&!ae(e,"UCBrowser/11")))))))}function ct(e,n){return new Mn(n)}var ft=0,dt=1,vt=2,pt=4,gt=5,ht=function e(n){this.listeners=[];var t=!!(n||{}).perfEvtsSendAll;xn(e,this,(function(e){e.addNotificationListener=function(n){e.listeners.push(n)},e.removeNotificationListener=function(n){for(var t=ge(e.listeners,n);t>-1;)e.listeners.splice(t,1),t=ge(e.listeners,n)},e.eventsSent=function(n){pe(e.listeners,(function(e){e&&e.eventsSent&&setTimeout((function(){return e.eventsSent(n)}),0)}))},e.eventsDiscarded=function(n,t){pe(e.listeners,(function(e){e&&e.eventsDiscarded&&setTimeout((function(){return e.eventsDiscarded(n,t)}),0)}))},e.eventsSendRequest=function(n,t){pe(e.listeners,(function(e){if(e&&e.eventsSendRequest)if(t)setTimeout((function(){return e.eventsSendRequest(n,t)}),0);else try{e.eventsSendRequest(n,t)}catch(e){}}))},e.perfEvent=function(n){n&&(!t&&n.isChildEvt()||pe(e.listeners,(function(e){if(e&&e.perfEvent)if(n.isAsync)setTimeout((function(){return e.perfEvent(n)}),0);else try{e.perfEvent(n)}catch(e){}})))}}))},yt=function(e){function n(){var t=e.call(this)||this,r=0;return xn(n,t,(function(e,n){function t(n){var t=e.getNotifyMgr();t&&t.eventsDiscarded([n],vt)}e.initialize=function(e,t,r,i){n.initialize(e,t,r||new On(e),i||new ht(e))},e.track=function(r){Rn(e.getPerfMgr(),(function(){return"AppInsightsCore:track"}),(function(){null===r&&(t(r),Ie("Invalid telemetry item")),function(e){if(Z(e.name))throw t(e),Error("telemetry name required")}(r),n.track(r)}),(function(){return{item:r}}),!r.sync)},e.addNotificationListener=function(n){var t=e.getNotifyMgr();t&&t.addNotificationListener(n)},e.removeNotificationListener=function(n){var t=e.getNotifyMgr();t&&t.removeNotificationListener(n)},e.pollInternalLogs=function(n){var t=e.config.diagnosticLogInterval;return t&&t>0||(t=1e4),r&&e.stopPollingInternalLogs(),r=setInterval((function(){var t=e.logger?e.logger.queue:[];pe(t,(function(t){var r={name:n||"InternalMessageId: "+t.messageId,iKey:e.config.instrumentationKey,time:ve(new Date),baseType:_n.dataType,baseData:{message:t.message}};e.track(r)})),t.length=0}),t)},e.stopPollingInternalLogs=function(){r&&(clearInterval(r),r=0)}})),t}return j(n,e),n}((function e(){var n,t,r,i,o,a=!1;xn(e,this,(function(e){e._extensions=new Array,t=new Vn,e.logger=new On({loggingLevelConsole:q.CRITICAL}),n=[],e.isInitialized=function(){return a},e.initialize=function(n,i,o,s){var u,l,c,f;e.isInitialized()&&Ie("Core should not be initialized more than once"),n&&!Z(n.instrumentationKey)||Ie("Please provide instrumentation key"),r=s,e._notificationManager=s,e.config=n||{},s&&!0!==e.config.disableDbgExt&&s.addNotificationListener(function(e){if(!Sn){Sn={};for(var n=0;n<bn.length;n++)Sn[bn[n]]=In(bn[n],e)}return Sn}(n)),e.config.enablePerfMgr&&xe(e.config,"createPerfMgr",ct),n.extensions=Z(n.extensions)?[]:n.extensions,(l=zn,(u=n)?!(f=u[l])&&Z(f)&&(f=X(c)?{}:c,u[l]=f):f=X(c)?{}:c,f).NotificationManager=s,o&&(e.logger=o);var d=[];d.push.apply(d,W(W([],i),n.extensions)),d=qn(d);var v=[],p=[],g={};pe(d,(function(e){(Z(e)||Z(e.initialize))&&Ie("Extensions must provide callback to initialize");var n=e.priority,r=e.identifier;e&&n&&(Z(g[n])?g[n]=r:o.warnToConsole("Two extensions have same priority #"+n+" - "+g[n]+", "+r)),!n||n<t.priority?v.push(e):p.push(e)})),d.push(t),v.push(t),d=qn(d),e._extensions=d,Un(new Bn([t],n,e),d),Un(new Bn(v,n,e),d),e._extensions=v,0===e.getTransmissionControls().length&&Ie("No channels available"),a=!0,e.releaseQueue()},e.getTransmissionControls=function(){return t.getChannelControls()},e.track=function(t){xe(t,"iKey",e.config.instrumentationKey,null,be),xe(t,"time",ve(new Date),null,be),xe(t,"ver","4.0",null,Z),e.isInitialized()?e.getProcessTelContext().processNext(t):n.push(t)},e.getProcessTelContext=function(){var n=e._extensions,r=n;return n&&0!==n.length||(r=[t]),new Bn(r,e.config,e)},e.getNotifyMgr=function(){return r||(r=U({addNotificationListener:function(e){},removeNotificationListener:function(e){},eventsSent:function(e){},eventsDiscarded:function(e,n){},eventsSendRequest:function(e,n){}}),e._notificationManager=r),r},e.getCookieMgr=function(){return o||(o=tt(e.config,e.logger)),o},e.setCookieMgr=function(e){o=e},e.getPerfMgr=function(){return i||e.config&&e.config.enablePerfMgr&&ne(e.config.createPerfMgr)&&(i=e.config.createPerfMgr(e,e.getNotifyMgr())),i||Fn},e.setPerfMgr=function(e){i=e},e.eventCnt=function(){return n.length},e.releaseQueue=function(){n.length>0&&(pe(n,(function(n){e.getProcessTelContext().processNext(n)})),n=[])}}))})),mt=0,Ct=13,Tt=32,St=1,xt=2,bt=3,wt=4,It=0,Et=1,Pt=6,kt=7,_t=H(H({},G),{AuthHandShakeError:501,AuthRedirectFail:502,BrowserCannotReadLocalStorage:503,BrowserCannotWriteLocalStorage:504,BrowserDoesNotSupportLocalStorage:505,CannotParseBiBlobValue:506,CannotParseDataAttribute:507,CVPluginNotAvailable:508,DroppedEvent:509,ErrorParsingAISessionCookie:510,ErrorProvidedChannels:511,FailedToGetCookies:512,FailedToInitializeCorrelationVector:513,FailedToInitializeSDK:514,InvalidContentBlob:515,InvalidCorrelationValue:516,SessionRenewalDateIsZero:517,SendPostOnCompleteFailure:518,PostResponseHandler:519,SDKNotInitialized:520}),Ot=4294967296,Ft=4294967295,Nt=!1,Mt=123456789,Lt=987654321;function Rt(e){e<0&&(e>>>=0),Mt=123456789+e&Ft,Lt=987654321-e&Ft,Nt=!0}function Dt(){try{var e=2147483647&Se();Rt((Math.random()*Ot^e)+e)}catch(e){}}function At(e){return e>0?Math.floor(Bt()/Ft*(e+1))>>>0:0}function Bt(e){var n,t=Ae("crypto")||Ae("msCrypto");return t&&t.getRandomValues?n=t.getRandomValues(new Uint32Array(1))[0]&Ft:Ge()?(Nt||Dt(),n=zt()&Ft):n=Math.floor(Ot*Math.random()|0),e||(n>>>=0),n}function zt(e){var n=((Lt=36969*(65535&Lt)+(Lt>>16)&Ft)<<16)+(65535&(Mt=18e3*(65535&Mt)+(Mt>>16)&Ft))>>>0&Ft|0;return e||(n>>>=0),n}
/*
 * Application Insights JavaScript SDK - Core, 2.7.3
 * Copyright (c) Microsoft and contributors. All rights reserved.
 */
var Kt="visibilitychange",Ut="pagehide",qt="pageshow";function Ht(e,n){var t=!1,r=ze();r&&(t=te(r,e,n),t=te(r.body,e,n)||t);var i=Ke();return i&&(t=te(i,e,n)||t),t}function Vt(e,n,t){var r=!1;if(n&&e&&ue(e)){var i=[];pe(e,(function(e){ce(e)&&(t&&-1!==ge(t,e)?i.push(e):r=Ht(e,n)||r)})),!r&&i.length>0&&(r=Vt(i,n))}return r}function jt(e,n){return Vt(["beforeunload","unload","pagehide"],e,n)}function Wt(e,n){var t=!1;return n&&-1!==ge(n,Ut)||(t=Ht(Ut,e)),n&&-1!==ge(n,Kt)||(t=Ht(Kt,(function(n){var t=Ke();e&&t&&"hidden"===t.visibilityState&&e(n)}))||t),!t&&n&&(t=Wt(e)),t}function Gt(e,n){var t=!1;return n&&-1!==ge(n,qt)||(t=Ht(qt,e)),n&&-1!==ge(n,Kt)||(t=Ht(Kt,(function(n){var t=Ke();e&&t&&"visible"===t.visibilityState&&e(n)}))||t),!t&&n&&(t=Gt(e)),t}function Qt(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(Zt,(function(e){var n=0|At(15);return("x"===e?n:3&n|8).toString(16)}))}function Jt(){var e=Ae("performance");return e&&e.now?e.now():Se()}var Xt,Zt=/[xy]/g;
/**
 * Utils.ts
 * @author  Abhilash Panwar (abpanwar) Hector Hernandez (hectorh)
 * @copyright Microsoft 2018
 * File containing utility functions.
 */
var $t="1DS-Web-JS-3.1.10",Yt="withCredentials",er=((Xt={})[0]=It,Xt[2]=Pt,Xt[1]=Et,Xt[3]=kt,Xt[4098]=Pt,Xt[4097]=Et,Xt[4099]=kt,Xt),nr=(Boolean(Ke()),Boolean(ze()));function tr(e){return!(""===e||Z(e))}function rr(e){if(e){var n=e.indexOf("-");if(n>-1)return e.substring(0,n)}return""}function ir(e){return!!(e&&fe(e)&&e>=St&&e<=wt)}function or(e,n,t){if(!n&&!tr(n)||"string"!=typeof e)return null;var r=typeof n;if("string"===r||"number"===r||"boolean"===r||ue(n))n={value:n};else if("object"!==r||n.hasOwnProperty("value")){if(Z(n.value)||""===n.value||!ce(n.value)&&!fe(n.value)&&!de(n.value)&&!ue(n.value))return null}else n={value:t?JSON.stringify(n):n};if(ue(n.value)&&!fr(n.value))return null;if(!Z(n.kind)){if(ue(n.value)||!cr(n.kind))return null;n.value=n.value.toString()}return n}function ar(e,n,t){var r=-1;if(!X(e))if(n>0&&(32===n?r=8192:n<=13&&(r=n<<5)),function(e){if(e>=0&&e<=9)return!0;return!1}(t))-1===r&&(r=0),r|=t;else{var i=er[vr(e)]||-1;-1!==r&&-1!==i?r|=i:i===Pt&&(r=i)}return r}function sr(e){void 0===e&&(e="D");var n=Qt();return"B"===e?n="{"+n+"}":"P"===e?n="("+n+")":"N"===e&&(n=n.replace(/-/g,"")),n}function ur(e,n,t,r,i){var o={},a=!1,s=0,u=arguments.length,l=Object.prototype,c=arguments;for("[object Boolean]"===l.toString.call(c[0])&&(a=c[0],s++);s<u;s++){re(e=c[s],(function(e,n){a&&n&&ee(n)?ue(n)?(o[e]=o[e]||[],pe(n,(function(n,t){n&&ee(n)?o[e][t]=ur(!0,o[e][t],n):o[e][t]=n}))):o[e]=ur(!0,o[e],n):o[e]=n}))}return o}var lr=Jt;function cr(e){return e===mt||e>mt&&e<=Ct||e===Tt}function fr(e){return e.length>0}function dr(e,n){var t=e;t.timings=t.timings||{},t.timings.processTelemetryStart=t.timings.processTelemetryStart||{},t.timings.processTelemetryStart[n]=lr()}function vr(e){var n=0;if(null!=e){var t=typeof e;"string"===t?n=1:"number"===t?n=2:"boolean"===t?n=3:t===O&&(n=4,ue(e)?(n=4096,e.length>0&&(n|=vr(e[0]))):Y(e,"value")&&(n=8192|vr(e.value)))}return n}
/*
 * 1DS JS SDK Core, 3.1.10
 * Copyright (c) Microsoft and contributors. All rights reserved.
 * (Microsoft Internal Only)
 */
/**
 * AppInsightsCore.ts
 * @author Abhilash Panwar (abpanwar) Hector Hernandez (hectorh)
 * @copyright Microsoft 2018
 */
var pr=function(e){function n(){var t=e.call(this)||this;return t.pluginVersionStringArr=[],t.pluginVersionString="",xn(n,t,(function(e,n){e.logger&&e.logger.queue||(e.logger=new On({loggingLevelConsole:q.CRITICAL})),e.initialize=function(t,r,i,o){Rn(e,(function(){return"AppInsightsCore.initialize"}),(function(){if(t){t.endpointUrl||(t.endpointUrl="https://browser.events.data.microsoft.com/OneCollector/1.0/");var a=t.propertyStorageOverride;if(a&&(!a.getProperty||!a.setProperty))throw new Error("Invalid property storage override passed.");t.channels&&pe(t.channels,(function(n){n&&pe(n,(function(n){if(n.identifier&&n.version){var t=n.identifier+"="+n.version;e.pluginVersionStringArr.push(t)}}))}))}e.getWParam=function(){return"undefined"!=typeof document?0:-1},r&&pe(r,(function(n){if(n&&n.identifier&&n.version){var t=n.identifier+"="+n.version;e.pluginVersionStringArr.push(t)}})),e.pluginVersionString=e.pluginVersionStringArr.join(";");try{n.initialize(t,r,i,o),e.pollInternalLogs("InternalLog")}catch(n){var s=e.logger,u=Qe(n);-1!==u.indexOf("channels")&&(u+="\n - Channels must be provided through config.channels only!"),s.throwInternal(q.CRITICAL,_t.FailedToInitializeSDK,"SDK Initialization Failed - no telemetry will be sent: "+u)}}),(function(){return{config:t,extensions:r,logger:i,notificationManager:o}}))},e.track=function(t){Rn(e,(function(){return"AppInsightsCore.track"}),(function(){var r=t;if(r){r.timings=r.timings||{},r.timings.trackStart=lr(),ir(r.latency)||(r.latency=St);var i=r.ext=r.ext||{};i.sdk=i.sdk||{},i.sdk.ver=$t;var o=r.baseData=r.baseData||{};o.properties||(o.properties={});var a=o.properties;a.version||(a.version=""),""!==e.pluginVersionString&&(a.version=e.pluginVersionString)}n.track(r)}),(function(){return{item:t}}),!t.sync)}})),t}return j(n,e),n}(yt),gr=pr,hr="REAL_TIME",yr="POST",mr="drop",Cr="send",Tr="requeue",Sr="rspFail",xr="application/x-json-stream",br="cache-control",wr="content-type",Ir="kill-duration",Er="time-delta-millis",Pr="AuthMsaDeviceTicket";
/*
 * 1DS JS SDK POST plugin, 3.1.10
 * Copyright (c) Microsoft and contributors. All rights reserved.
 * (Microsoft Internal Only)
 */
function kr(e){var n=(e.ext||{}).intweb;return n&&tr(n.msfpc)?n.msfpc:null}function _r(e){for(var n=null,t=0;null===n&&t<e.length;t++)n=kr(e[t]);return n}var Or=function(){function e(n,t){var r=t?[].concat(t):[],i=this,o=_r(r);i.iKey=function(){return n},i.Msfpc=function(){return o||""},i.count=function(){return r.length},i.events=function(){return r},i.addEvent=function(e){return!!e&&(r.push(e),o||(o=kr(e)),!0)},i.split=function(t,i){var a;if(t<r.length){var s=r.length-t;Z(i)||(s=i<s?i:s),a=r.splice(t,s),o=_r(r)}return new e(n,a)}}return e.create=function(n,t){return new e(n,t)},e}(),Fr=2e6,Nr=Math.min(Fr,65e3),Mr=/\./,Lr=function e(n,t,r,i){var o="data",a="baseData",s=!!i,u=t,l={};xn(e,this,(function(e){function t(e,n,i,o,a,c,f){re(e,(function(e,d){var v=null;if(d||tr(d)){var p=i,g=e,h=a,y=n;if(s&&!o&&Mr.test(e)){var m=e.split("."),C=m.length;if(C>1){h&&(h=h.slice());for(var T=0;T<C-1;T++){var S=m[T];y=y[S]=y[S]||{},p+="."+S,h&&h.push(S)}g=m[C-1]}}var x=o&&function(e,n){var t=l[e];return void 0===t&&(e.length>=7&&(t=oe(e,"ext.metadata")||oe(e,"ext.web")),l[e]=t),t}(p);if(v=!x&&u&&u.handleField(p,g)?u.value(p,g,d,r):or(g,d,r)){var b=v.value;if(y[g]=b,c&&c(h,g,v),f&&"object"==typeof b&&!ue(b)){var w=h;w&&(w=w.slice()).push(g),t(d,b,p+"."+g,o,w,c,f)}}}}))}e.createPayload=function(e,n,t,r,i,o){return{apiKeys:[],payloadBlob:"",overflow:null,sizeExceed:[],failedEvts:[],batches:[],numEvents:0,retryCnt:e,isTeardown:n,isSync:t,isBeacon:r,sendType:o,sendReason:i}},e.appendPayload=function(t,r,i){var o=t&&r&&!t.overflow;return o&&Rn(n,(function(){return"Serializer:appendPayload"}),(function(){for(var n=r.events(),o=t.payloadBlob,a=t.numEvents,s=!1,u=[],l=[],c=t.isBeacon,f=c?65e3:3984588,d=c?Nr:Fr,v=0,p=0;v<n.length;){var g=n[v];if(g){if(a>=i){t.overflow=r.split(v);break}var h=e.getEventBlob(g);if(h&&h.length<=d){var y=h.length;if(o.length+y>f){t.overflow=r.split(v);break}o&&(o+="\n"),o+=h,++p>20&&(o.substr(0,1),p=0),s=!0,a++}else h?u.push(g):l.push(g),n.splice(v,1),v--}v++}if(u&&u.length>0&&t.sizeExceed.push(Or.create(r.iKey(),u)),l&&l.length>0&&t.failedEvts.push(Or.create(r.iKey(),l)),s){t.batches.push(r),t.payloadBlob=o,t.numEvents=a;var m=r.iKey();-1===ge(t.apiKeys,m)&&t.apiKeys.push(m)}}),(function(){return{payload:t,theBatch:{iKey:r.iKey(),evts:r.events()},max:i}})),o},e.getEventBlob=function(e){try{return Rn(n,(function(){return"Serializer.getEventBlob"}),(function(){var n={};n.name=e.name,n.time=e.time,n.ver=e.ver,n.iKey="o:"+rr(e.iKey);var r={},i=e.ext;i&&(n.ext=r,re(i,(function(e,n){t(n,r[e]={},"ext."+e,!0,null,null,!0)})));var s=n.data={};s.baseType=e.baseType;var u=s.baseData={};return t(e.baseData,u,a,!1,[a],(function(e,n,t){Rr(r,e,n,t)}),!0),t(e.data,s,o,!1,[],(function(e,n,t){Rr(r,e,n,t)}),!0),JSON.stringify(n)}),(function(){return{item:e}}))}catch(e){return null}}}))};function Rr(e,n,t,r){if(r&&e){var i=ar(r.value,r.kind,r.propertyType);if(i>-1){var o=e.metadata;o||(o=e.metadata={f:{}});var a=o.f;if(a||(a=o.f={}),n)for(var s=0;s<n.length;s++){var u=n[s];a[u]||(a[u]={f:{}});var l=a[u].f;l||(l=a[u].f={}),a=l}a=a[t]={},ue(r.value)?a.a={t:i}:a.t=i}}}
/*
 * 1DS JS SDK POST plugin, 3.1.10
 * Copyright (c) Microsoft and contributors. All rights reserved.
 * (Microsoft Internal Only)
 */
/**
* RetryPolicy.ts
* @author Abhilash Panwar (abpanwar)
* @copyright Microsoft 2018
*/
var Dr,Ar,Br,zr=function(){function e(){}return e.shouldRetryForStatus=function(e){return!(e>=300&&e<500&&408!=e&&429!=e||501==e||505==e)},e.getMillisToBackoffForRetry=function(e){var n,t=Math.floor(1200*Math.random())+2400;return n=Math.pow(2,e)*t,Math.min(n,6e5)},e}(),Kr=function e(){var n={};xn(e,this,(function(e){e.setKillSwitchTenants=function(e,t){if(e&&t)try{var r=(a=e.split(","),s=[],a&&pe(a,(function(e){s.push(he(e))})),s);if("this-request-only"===t)return r;for(var i=1e3*parseInt(t,10),o=0;o<r.length;++o)n[r[o]]=Se()+i}catch(e){return[]}var a,s;return[]},e.isTenantKilled=function(e){var t=n,r=he(e);return void 0!==t[r]&&t[r]>Se()||(delete t[r],!1)}}))},Ur=function e(){var n=!0,t=!0,r=!0,i="use-collector-delta",o=!1;xn(e,this,(function(e){e.allowRequestSending=function(){return n},e.firstRequestSent=function(){r&&(r=!1,o||(n=!1))},e.shouldAddClockSkewHeaders=function(){return t},e.getClockSkewHeaderValue=function(){return i},e.setClockSkew=function(e){o||(e?(i=e,t=!0,o=!0):t=!1,n=!0)}}))},qr=((Dr={})[1]=Tr,Dr[100]=Tr,Dr[200]="sent",Dr[8004]=mr,Dr[8003]=mr,Dr),Hr={},Vr={};function jr(e){try{return e.responseText}catch(e){}return""}function Wr(e,n){var t=!1;if(e&&n){var r=Ce(e);if(r&&r.length>0)for(var i=n.toLowerCase(),o=0;o<r.length;o++){var a=r[o];if(a&&Y(n,a)&&a.toLowerCase()===i){t=!0;break}}}return t}function Gr(e,n,t,r){n&&t&&t.length>0&&(r&&Hr[n]?(e.hdrs[Hr[n]]=t,e.useHdrs=!0):e.url+="&"+n+"="+t)}Br=Pr,Hr[Ar=Pr]=Br,Vr[Br]=Ar;var Qr=function e(n,t,r,i){this._responseHandlers=[];var o,a,s,u,l="?cors=true&"+wr.toLowerCase()+"="+xr,c=new Kr,f=!1,d=new Ur,v=!1,p=0,g=!0,h=[],y={},m=[],C=null,T=!1,S=!1,x=!1;xn(e,this,(function(e){var b=!0;function w(e,n){for(var t=0,r=null,i=0;null==r&&i<e.length;)1===(t=e[i])?Ze()?r=I:$e()&&(r=P):2===t&&Xe(n)?r=E:v&&3===t&&Je()&&(r=_),i++;return r?{_transport:t,_isSync:n,sendPOST:r}:null}function I(e,n,t){var r=new XDomainRequest;r.open(yr,e.urlString),r.onload=function(){var e=jr(r);k(n,200,{},e),H(e)},r.onerror=function(){k(n,400,{})},r.ontimeout=function(){k(n,500,{})},r.onprogress=function(){},t?r.send(e.data):o._setTimeoutOverride((function(){r.send(e.data)}),0)}function E(e,n,t){var r,i=!1,o=!1,a=((r={body:e.data,method:yr}).Microsoft_ApplicationInsights_BypassAjaxInstrumentation=!0,r);t&&(a.keepalive=!0,2===e._sendReason&&(i=!0)),b&&(a.credentials="include"),e.headers&&Ce(e.headers).length>0&&(a.headers=e.headers),fetch(e.urlString,a).then((function(e){var t={},r="";e.headers&&e.headers.forEach((function(e,n){t[n]=e})),e.body&&e.text().then((function(e){r=e})),o||(o=!0,k(n,e.status,t,r),H(r))})).catch((function(e){o||(o=!0,k(n,0,{}))})),i&&!o&&(o=!0,k(n,200,{}))}function P(e,n,t){function r(e,n,t){if(!e[t]&&n&&n.getResponseHeader){var r=n.getResponseHeader(t);r&&(e[t]=he(r))}return e}function i(e){var n,t,i={};return e.getAllResponseHeaders?(n=e.getAllResponseHeaders(),t={},ce(n)&&pe(he(n).split(/[\r\n]+/),(function(e){if(e){var n=e.indexOf(": ");if(-1!==n){var r=he(e.substring(0,n)).toLowerCase(),i=he(e.substring(n+1));t[r]=i}else t[he(e)]=1}})),i=t):(i=r(i,e,Er),i=r(i,e,Ir),i=r(i,e,"kill-duration-seconds")),i}function o(e,t){k(n,e.status,i(e),t)}var a=function(e,n,t,r,i){function o(e,n,t){try{e[n]=t}catch(e){}}void 0===r&&(r=!1),void 0===i&&(i=!1);var a=new XMLHttpRequest;return r&&o(a,"Microsoft_ApplicationInsights_BypassAjaxInstrumentation",r),t&&o(a,Yt,t),a.open(e,n,!i),t&&o(a,Yt,t),a}(yr,e.urlString,b,!0,t);re(e.headers,(function(e,n){a.setRequestHeader(e,n)})),a.onload=function(){var e=jr(a);o(a,e),H(e)},a.onerror=function(){o(a)},a.ontimeout=function(){o(a)},a.send(e.data)}function k(e,n,t,r){try{e(n,t,r)}catch(e){o.diagLog().throwInternal(q.WARNING,_t.SendPostOnCompleteFailure,Qe(e))}}function _(e,n,t){var r=200,i=e._thePayload;try{var a=qe();if(!a.sendBeacon(e.urlString,e.data))if(i){var s=[];pe(i.batches,(function(n){if(s&&n&&n.count()>0){for(var t=n.events(),r=0;r<t.length;r++)if(!a.sendBeacon(e.urlString,C.getEventBlob(t[r]))){s.push(n.split(r));break}}else s.push(n.split(0))})),V(s,8003,i.sendType,!0)}else r=0}catch(e){o.diagLog().warnToConsole("Failed to send telemetry using sendBeacon API. Ex:"+e),r=0}finally{k(n,r,{},"")}}function O(e){return 2===e||3===e}function N(e){return S&&O(e)&&(e=2),e}function M(){return!f&&p<t}function L(){var e=m;return m=[],e}function R(e,n,t){var r=!1;return e&&e.length>0&&!f&&a[n]&&C&&(r=0!==n||M()&&(t>0||d.allowRequestSending())),r}function D(e){var n={};return e&&pe(e,(function(e,t){n[t]={iKey:e.iKey(),evts:e.events()}})),n}function A(e,t,r,i,u){if(e&&0!==e.length)if(f)V(e,1,i);else{i=N(i);try{var l=e,d=0!==i;Rn(s,(function(){return"HttpManager:_sendBatches"}),(function(o){o&&(e=e.slice(0));for(var s=[],l=null,f=lr(),p=a[i]||(d?a[1]:a[0]),h=(S||O(i)||p&&3===p._transport)&&!g&&v&&Je();R(e,i,t);){var y=e.shift();y&&y.count()>0&&(c.isTenantKilled(y.iKey())?s.push(y):(l=l||C.createPayload(t,r,d,h,u,i),C.appendPayload(l,y,n)?null!==l.overflow&&(e=[l.overflow].concat(e),l.overflow=null,K(l,f,lr(),u),f=lr(),l=null):(K(l,f,lr(),u),f=lr(),e=[y].concat(e),l=null)))}l&&K(l,f,lr(),u),e.length>0&&(m=e.concat(m)),V(s,8004,i)}),(function(){return{batches:D(l),retryCount:t,isTeardown:r,isSynchronous:d,sendReason:u,useSendBeacon:O(i),sendType:i}}),!d)}catch(e){o.diagLog().throwInternal(q.WARNING,_t.CannotSerializeObject,"Unexpected Exception sending batch: "+Qe(e))}}}function B(e,n){var t={url:l,hdrs:{},useHdrs:!1};t.hdrs=ur(t.hdrs,y),t.useHdrs=Ce(t.hdrs).length>0,Gr(t,"client-id","NO_AUTH",n),Gr(t,"client-version",$t,n);var r="";pe(e.apiKeys,(function(e){r.length>0&&(r+=","),r+=e})),Gr(t,"apikey",r,n),Gr(t,"upload-time",Se().toString(),n);var i=function(e){for(var n=0;n<e.batches.length;n++){var t=e.batches[n].Msfpc();if(t)return encodeURIComponent(t)}return""}(e);if(tr(i)&&(t.url+="&ext.intweb.msfpc="+i),d.shouldAddClockSkewHeaders()&&Gr(t,"time-delta-to-apply-millis",d.getClockSkewHeaderValue(),n),s.getWParam){var o=s.getWParam();o>=0&&(t.url+="&w="+o)}for(var a=0;a<h.length;a++)t.url+="&"+h[a].name+"="+h[a].value;return t}function z(e,n,t){e[n]=e[n]||{},e[n][o.identifier]=t}function K(n,t,i,u){if(n&&n.payloadBlob&&n.payloadBlob.length>0){var l=!!e.sendHook,f=a[n.sendType];!O(n.sendType)&&n.isBeacon&&2===n.sendReason&&(f=a[2]||a[3]||f);var v=x;(n.isBeacon||3===f._transport)&&(v=!1);var h=B(n,v);v=v||h.useHdrs;var y=lr();Rn(s,(function(){return"HttpManager:_doPayloadSend"}),(function(){for(var a=0;a<n.batches.length;a++)for(var m=n.batches[a].events(),C=0;C<m.length;C++){var x=m[C];if(T){var b=x.timings=x.timings||{};z(b,"sendEventStart",y),z(b,"serializationStart",t),z(b,"serializationCompleted",i)}x.sendAttempt>0?x.sendAttempt++:x.sendAttempt=1}V(n.batches,1e3+(u||0),n.sendType,!0);var w={data:n.payloadBlob,urlString:h.url,headers:h.hdrs,_thePayload:n,_sendReason:u};v&&(Wr(w.headers,br)||(w.headers[br]="no-cache, no-store"),Wr(w.headers,wr)||(w.headers["content-type"]=xr));var I=null;f&&(I=function(t){d.firstRequestSent();var i=function(t,i){!function(n,t,i,a){var s=9e3,u=null,l=!1,f=!1;try{var v=!0;if(typeof n!==F){if(t){d.setClockSkew(t[Er]);var g=t["kill-duration"]||t["kill-duration-seconds"];pe(c.setKillSwitchTenants(t["kill-tokens"],g),(function(e){pe(i.batches,(function(n){if(n.iKey()===e){u=u||[];var t=n.split(0);i.numEvents-=t.count(),u.push(t)}}))}))}if(200==n)return void(s=200);(!zr.shouldRetryForStatus(n)||i.numEvents<=0)&&(v=!1),s=9e3+n%1e3}if(v){s=100;var h=i.retryCnt;0===i.sendType&&(h<r?(l=!0,U((function(){0===i.sendType&&p--,A(i.batches,h+1,i.isTeardown,S?2:i.sendType,5)}),S,zr.getMillisToBackoffForRetry(h))):f=!0)}}finally{l||(d.setClockSkew(),function(n,t,r,i){try{i&&o._backOffTransmission(),200===t&&(i||n.isSync||o._clearBackOff(),function(e){if(T){var n=lr();pe(e,(function(e){e&&e.count()>0&&function(e,n){T&&pe(e,(function(e){z(e.timings=e.timings||{},"sendEventCompleted",n)}))}(e.events(),n)}))}}(n.batches)),V(n.batches,t,n.sendType,!0)}finally{0===n.sendType&&(p--,5!==r&&e.sendQueuedRequests(n.sendType,r))}}(i,s,a,f)),V(u,8004,i.sendType)}}(t,i,n,u)},a=n.isTeardown||n.isSync;try{f.sendPOST(t,i,a),e.sendListener&&e.sendListener(w,t,a,n.isBeacon)}catch(e){o.diagLog().warnToConsole("Unexpected exception sending payload. Ex:"+Qe(e)),k(i,0,{})}}),Rn(s,(function(){return"HttpManager:_doPayloadSend.sender"}),(function(){if(I)if(0===n.sendType&&p++,l&&!n.isBeacon&&3!==f._transport){var t={data:w.data,urlString:w.urlString,headers:ur({},w.headers)},r=!1;Rn(s,(function(){return"HttpManager:_doPayloadSend.sendHook"}),(function(){try{e.sendHook(t,(function(e){r=!0,g||e._thePayload||(e._thePayload=e._thePayload||w._thePayload,e._sendReason=e._sendReason||w._sendReason),I(e)}),n.isSync||n.isTeardown)}catch(e){r||I(w)}}))}else I(w)}))}),(function(){return{thePayload:n,serializationStart:t,serializationCompleted:i,sendReason:u}}),n.isSync)}n.sizeExceed&&n.sizeExceed.length>0&&V(n.sizeExceed,8003,n.sendType),n.failedEvts&&n.failedEvts.length>0&&V(n.failedEvts,8002,n.sendType)}function U(e,n,t){n?e():o._setTimeoutOverride(e,t)}function H(n){var t=e._responseHandlers;try{for(var r=0;r<t.length;r++)try{t[r](n)}catch(e){o.diagLog().throwInternal(q.CRITICAL,_t.PostResponseHandler,"Response handler failed: "+e)}if(n){var i=JSON.parse(n);tr(i.webResult)&&tr(i.webResult.msfpc)&&u.set("MSFPC",i.webResult.msfpc,31536e3)}}catch(e){}}function V(e,n,t,r){if(e&&e.length>0&&i){var a=i[(l=n,c=qr[l],tr(c)||(c="oth",l>=9e3&&l<=9999?c=Sr:l>=8e3&&l<=8999?c=mr:l>=1e3&&l<=1999&&(c=Cr)),c)];if(a){var u=0!==t;Rn(s,(function(){return"HttpManager:_sendBatchesNotification"}),(function(){U((function(){try{a.call(i,e,n,u,t)}catch(e){o.diagLog().throwInternal(q.CRITICAL,_t.NotificationException,"send request notification failed: "+e)}}),r||u,0)}),(function(){return{batches:D(e),reason:n,isSync:u,sendSync:r,sendType:t}}),!u)}}var l,c}e.initialize=function(e,n,t,r,i){var c;i||(i={}),l=e+l,x=!X(i.avoidOptions)&&!i.avoidOptions,s=n,u=n.getCookieMgr(),T=!s.config.disableEventTimings;var f=!!s.config.enableCompoundKey;o=t;var d=i.valueSanitizer,p=i.stringifyObjects;X(i.enableCompoundKey)||(f=!!i.enableCompoundKey),v=!We(),C=new Lr(s,d,p,f);var h=r;if(!r){g=!1;var y=He();y&&y.protocol&&"file:"===y.protocol.toLowerCase()&&(b=!1);var m=[];m=We()?[2,1]:[1,2,3];var S=i.transports;S&&(fe(S)?m=[S].concat(m):ue(S)&&(m=S.concat(m))),r=w(m,!1),h=w(m,!0),r||o.diagLog().warnToConsole("No available transport to send events")}(c={})[0]=r,c[1]=h||w([1,2,3],!0),c[2]=w([3,2,1],!0)||h,c[3]=w([2,3,1],!0)||h,a=c},e._getDbgPlgTargets=function(){return[a[0],c,C,a]},e.addQueryStringParameter=function(e,n){for(var t=0;t<h.length;t++)if(h[t].name===e)return void(h[t].value=n);h.push({name:e,value:n})},e.addHeader=function(e,n){y[e]=n},e.canSendRequest=function(){return M()&&d.allowRequestSending()},e.sendQueuedRequests=function(e,n){X(e)&&(e=0),S&&(e=N(e),n=2),R(m,e,0)&&A(L(),0,!1,e,n||0)},e.isCompletelyIdle=function(){return!f&&0===p&&0===m.length},e.setUnloading=function(e){S=e},e.addBatch=function(e){if(e&&e.count()>0){if(c.isTenantKilled(e.iKey()))return!1;m.push(e)}return!0},e.teardown=function(){m.length>0&&A(L(),0,!0,2,2)},e.pause=function(){f=!0},e.resume=function(){f=!1,e.sendQueuedRequests(0,4)},e.sendSynchronousBatch=function(e,n,t){e&&e.count()>0&&(Z(n)&&(n=1),S&&(n=N(n),t=2),A([e],0,!1,n,t||0))}}))},Jr=nr?window:void 0,Xr="eventsDiscarded",Zr=function(e){function n(){var t,r=e.call(this)||this;r.identifier="PostChannel",r.priority=1011,r.version="3.1.10";var i,o,a,s,u,l=!1,c=[],f=null,d=!1,v=0,p=500,g=0,h=1e4,y={},m=hr,C=null,T=null,S=0,x=0,b={},w=-1,I=!0,E=!1;return xn(n,r,(function(e,n){function r(e,n){if(e.sendAttempt||(e.sendAttempt=0),e.latency||(e.latency=St),e.ext&&e.ext.trace&&delete e.ext.trace,e.ext&&e.ext.user&&e.ext.user.id&&delete e.ext.user.id,I&&(e.ext=Ee(e.ext),e.baseData&&(e.baseData=Ee(e.baseData)),e.data&&(e.data=Ee(e.data))),e.sync)if(S||d)e.latency=bt,e.sync=!1;else if(o)return I&&(e=Ee(e)),void o.sendSynchronousBatch(Or.create(e.iKey,[e]),!0===e.sync?1:e.sync,3);var t=e.latency,r=g,i=h;t===wt&&(r=v,i=p);var a=!1;if(r<i)a=!R(e,n);else{var s=St,u=20;t===wt&&(s=wt,u=1),a=!0,function(e,n,t,r){for(;t<=n;){var i=M(e,n,!0);if(i&&i.count()>0){var o=i.split(0,r),a=o.count();if(a>0)return t===wt?v-=a:g-=a,V(Xr,[o],gt),!0}t++}return D(),!1}(e.iKey,e.latency,s,u)&&(a=!R(e,n))}a&&H(Xr,[e],gt)}function P(e,n,t){var r=A(e,n,t);return o.sendQueuedRequests(n,t),r}function k(){return g>0}function _(){if(w>=0&&A(w,0,u)&&o.sendQueuedRequests(0,u),v>0&&!T&&!d){var e=y[m][2];e>=0&&(T=O((function(){T=null,P(wt,0,1),_()}),e))}var n=y[m][1];!C&&!f&&n>=0&&!d&&(k()?C=O((function(){C=null,P(0===x?bt:St,0,1),x++,x%=2,_()}),n):x=0)}function O(n,t){0===t&&S&&(t=1);var r=1e3;return S&&(r=zr.getMillisToBackoffForRetry(S-1)),e._setTimeoutOverride(n,t*r)}function F(){null!==C&&(e._clearTimeoutOverride(C),C=null,x=0)}function N(n,t){F(),f&&(e._clearTimeoutOverride(f),f=null),d||P(St,n,t)}function M(e,n,t){var r=b[n];r||(r=b[n=St]);var i=r.iKeyMap[e];return!i&&t&&(i=Or.create(e),r.batches.push(i),r.iKeyMap[e]=i),i}function L(n,t){o.canSendRequest()&&!S&&(a>0&&g>a&&(t=!0),t&&null==f&&e.flush(n,null,20))}function R(e,n){I&&(e=Ee(e));var t=e.latency,r=M(e.iKey,t,!0);return!!r.addEvent(e)&&(t!==wt?(g++,n&&0===e.sendAttempt&&L(!e.sync,s>0&&r.count()>=s)):v++,!0)}function D(){for(var e=0,n=0,t=function(t){var r=b[t];r&&r.batches&&pe(r.batches,(function(r){t===wt?e+=r.count():n+=r.count()}))},r=St;r<=wt;r++)t(r);g=n,v=e}function A(n,t,r){var i=!1,a=0===t;return!a||o.canSendRequest()?Rn(e.core,(function(){return"PostChannel._queueBatches"}),(function(){for(var e=[],t=wt;t>=n;){var r=b[t];r&&r.batches&&r.batches.length>0&&(pe(r.batches,(function(n){o.addBatch(n)?i=i||n&&n.count()>0:e=e.concat(n.events()),t===wt?v-=n.count():g-=n.count()})),r.batches=[],r.iKeyMap={}),t--}e.length>0&&H(Xr,e,pt),i&&w>=n&&(w=-1,u=0)}),(function(){return{latency:n,sendType:t,sendReason:r}}),!a):(w=w>=0?Math.min(w,n):n,u=Math.max(u,r)),i}function B(e,n){P(St,0,n),z((function(){e&&e(),c.length>0?f=O((function(){return B(c.shift(),n)}),0):(f=null,k()&&_())}))}function z(e){o.isCompletelyIdle()?e():f=O((function(){z(e)}),.25)}function K(){(y={}).REAL_TIME=[2,1,0],y.NEAR_REAL_TIME=[6,3,0],y.BEST_EFFORT=[18,9,0]}function U(n,t){var r=e._notificationManager||{},i=r[n];if(i)try{i.apply(r,t)}catch(t){e.diagLog().throwInternal(q.CRITICAL,_t.NotificationException,n+" notification failed: "+t)}}function H(e,n){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];n&&n.length>0&&U(e,[n].concat(t))}function V(e,n){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];n&&n.length>0&&pe(n,(function(n){n&&n.count()>0&&U(e,[n.events()].concat(t))}))}function j(){s=t&&t.disableAutoBatchFlushLimit?0:Math.max(1500,h/6)}K(),b[wt]={batches:[],iKeyMap:{}},b[bt]={batches:[],iKeyMap:{}},b[xt]={batches:[],iKeyMap:{}},b[St]={batches:[],iKeyMap:{}},j(),o=new Qr(500,2,1,{requeue:function(n,t){var i=[];pe(n,(function(n){n&&n.count()>0&&pe(n.events(),(function(n){n&&(n.sync&&(n.latency=wt,n.sync=!1),n.sendAttempt<6?(dr(n,e.identifier),r(n,!1)):i.push(n))}))})),i.length>0&&H(Xr,i,dt);E&&N(2,2)},send:function(e,n,t){e&&e.length>0&&U("eventsSendRequest",[n>=1e3&&n<=1999?n-1e3:0,!0!==t])},sent:function(e,n){V("eventsSent",e,n),_()},drop:function(e,n){V(Xr,e,n>=8e3&&n<=8999?n-8e3:ft)},rspFail:function(e){V(Xr,e,dt),_()},oth:function(e,n){V(Xr,e,ft),_()}}),e._getDbgPlgTargets=function(){return[o]},e.initialize=function(r,s,u){Rn(s,(function(){return"PostChannel:initialize"}),(function(){var l=s;n.initialize(r,s,u),e.setInitialized(!1);var c=e._getTelCtx();r.extensionConfig[e.identifier]=r.extensionConfig[e.identifier]||{},t=c.getExtCfg(e.identifier),e._setTimeoutOverride=t.setTimeoutOverride?t.setTimeoutOverride:setTimeout.bind(Jr),e._clearTimeoutOverride=t.clearTimeoutOverride?t.clearTimeoutOverride:clearTimeout.bind(Jr),I=!t.disableOptimizeObj&&!!Ae("chrome");var f=l.getWParam;l.getWParam=function(){var e=0;return t.ignoreMc1Ms0CookieProcessing&&(e|=2),e|f()},t.eventsLimitInMem>0&&(h=t.eventsLimitInMem),t.immediateEventLimit>0&&(p=t.immediateEventLimit),t.autoFlushEventsLimit>0&&(a=t.autoFlushEventsLimit),j(),t.httpXHROverride&&t.httpXHROverride.sendPOST&&(i=t.httpXHROverride),tr(r.anonCookieName)&&o.addQueryStringParameter("anoncknm",r.anonCookieName),o.sendHook=t.payloadPreprocessor,o.sendListener=t.payloadListener;var d=t.overrideEndpointUrl?t.overrideEndpointUrl:r.endpointUrl;function v(e){"beforeunload"!==(e||ze().event).type&&(E=!0,o.setUnloading(E)),N(2,2)}e._notificationManager=r.extensionConfig.NotificationManager,o.initialize(d,e.core,e,i,t);var g=r.disablePageUnloadEvents||[];jt(v,g),Wt(v,g),Gt((function(e){E=!1,o.setUnloading(E)}),r.disablePageShowEvents),e.setInitialized(!0)}),(function(){return{coreConfig:r,core:s,extensions:u}}))},e.processTelemetry=function(n,i){dr(n,e.identifier);var o=(i=e._getTelCtx(i)).getExtCfg(e.identifier),a=!!t.disableTelemetry;o&&(a=a||!!o.disableTelemetry);var s=n;a||l||(t.overrideInstrumentationKey&&(s.iKey=t.overrideInstrumentationKey),o&&o.overrideInstrumentationKey&&(s.iKey=o.overrideInstrumentationKey),r(s,!0),E?N(2,2):_()),e.processNext(s,i)},e.setEventQueueLimits=function(e,n){h=e>0?e:1e4,a=n>0?n:0,j();var t=g>e;if(!t&&s>0)for(var r=St;!t&&r<=bt;r++){var i=b[r];i&&i.batches&&pe(i.batches,(function(e){e&&e.count()>=s&&(t=!0)}))}L(!0,t)},e.teardown=function(){N(2,2),l=!0,o.teardown()},e.pause=function(){F(),d=!0,o.pause()},e.resume=function(){d=!1,o.resume(),_()},e.addResponseHandler=function(e){o._responseHandlers.push(e)},e._loadTransmitProfiles=function(e){F(),K(),m=hr,_(),re(e,(function(e,n){var t=n.length;if(t>=2){var r=t>2?n[2]:0;if(n.splice(0,t-2),n[1]<0&&(n[0]=-1),n[1]>0&&n[0]>0){var i=n[0]/n[1];n[0]=Math.ceil(i)*n[1]}r>=0&&n[1]>=0&&r>n[1]&&(r=n[1]),n.push(r),y[e]=n}}))},e.flush=function(e,n,t){void 0===e&&(e=!0),d||(F(),t=t||1,e?(A(St,0,t),D(),null==f?f=O((function(){B(n,t)}),0):c.push(n)):(P(St,1,t),null!=n&&n()))},e.setMsaAuthTicket=function(e){o.addHeader(Pr,e)},e.hasEvents=k,e._setTransmitProfile=function(e){m!==e&&void 0!==y[e]&&(F(),m=e,_())},e._backOffTransmission=function(){S<4&&(S++,F(),_())},e._clearBackOff=function(){S&&(S=0,F(),_())}})),r}return j(n,e),n}(Kn),$r=Zr,Yr=function(e){function n(){return null!==e&&e.apply(this,arguments)||this}return(0,r.ZT)(n,e),n.prototype.initialize=function(n,t){this._postChannel=new $r;var i=[];t&&(i=i.concat(t)),n.channels=[[this._postChannel]],n.extensionConfig=n.extensionConfig||[],n.extensionConfig[this._postChannel.identifier]=(0,r.pi)((0,r.pi)({},n.channelConfiguration),n.extensionConfig[this._postChannel.identifier]);try{e.prototype.initialize.call(this,n,i)}catch(e){this.logger.warnToConsole("Failed to initialize SDK."+e)}},n.prototype.setUploadFrequency=function(e){if(this._postChannel&&e){var n=e/1e3,t=n/2,r={};r.OTelCustomTransmissionProfile=[n,t],this._postChannel._loadTransmitProfiles(r),this._postChannel._setTransmitProfile("OTelCustomTransmissionProfile")}},n.prototype.flush=function(e){this._postChannel&&this._postChannel.flush(e)},n.prototype.shutdown=function(){this._postChannel&&this._postChannel.teardown()},n}(gr),ei="Data.",ni="b22a201c3f1d41d28ccc399ba6cc9ca2-1972c77f-1f79-4283-a0f9-b4ddc4646f55-7121";function ti(e,n,t){n&&n.forEach((function(n){if(!n.classification||4===n.classification||1===n.classification||t.customerContentEnabled&&32===n.classification){var r,i;switch(r=t.prependDataToken?"zC."===n.name.substr(0,3)?"zC.Data."+n.name.substr(3):ei+n.name:n.name,n.dataType){case 3:i=6;break;case 2:i=4;break;case 4:i=8;break;case 0:return void(e[r]="string"==typeof n.value?n.value.substr(0,25e3):n.value);default:return void(e[r]=n.value)}var o={value:n.value,propertyType:i};e[r]=o}}))}function ri(e,n){try{return e()}catch(e){return s(1,"1DS Sink",e),n}}var ii,oi=function(e){function n(){var n=null!==e&&e.apply(this,arguments)||this;return n.identifier="PartAPlugin",n.priority=3,n._properties={},n}return(0,r.ZT)(n,e),n.prototype.initialize=function(n,t,r){e.prototype.initialize.call(this,n,t,r)},n.prototype.processTelemetry=function(e,n){e.data=ur(this._properties,e.data);var t=this._getTelCtx(n);this.processNext(e,t)},n.prototype.addDataFields=function(e){ti(this._properties,e,{prependDataToken:!1,customerContentEnabled:!1})},n}(Kn),ai="HttpManager:_sendBatches",si="HttpManager:_sendBatchesNotification",ui=function(){function e(e,n,t){this.start=Date.now(),this.name=e,this.isAsync=!0===t,this.payload=n}return e.prototype.isChildEvt=function(){return!1},e.prototype.complete=function(){this.time=Date.now()-this.start,this.exTime=this.time},e}(),li=function(){function e(e){this._callbacks=e}return e.prototype.create=function(e,n,t){return e===ai||e===si?new ui(e,n,t):null},e.prototype.fire=function(e){if(e&&e.complete(),this._callbacks)switch(e.name){case ai:this.handleSendBatches(e);break;case si:this.handleSendBatchesNotification(e)}},e.prototype.setCtx=function(e,n){},e.prototype.getCtx=function(e){},e.prototype.handleSendBatches=function(e){this._callbacks.requestProcessingStats&&this._callbacks.requestProcessingStats(e.time||0,0)},e.prototype.handleSendBatchesNotification=function(e){if(this._callbacks.requestProcessingStats&&e.payload){var n=e.payload();if(n.batches&&n.reason&&n.reason>=1e3&&n.reason<=1999){var t=0;for(var r in n.batches)t+=n.batches[r].evts.length;this._callbacks.requestProcessingStats(0,t)}}},e}();!function(e){e.USGOV_DOD="https://pf.events.data.microsoft.com/OneCollector/1.0/",e.USGOV_DOJ="https://tb.events.data.microsoft.com/OneCollector/1.0/",e.PUBLIC="https://browser.events.data.microsoft.com/OneCollector/1.0/",e.CUSTOMER_CONTENT="https://office-c.events.data.microsoft.com/OneCollector/1.0/",e.EUDB="https://eu-office.events.data.microsoft.com/OneCollector/1.0/"}(ii||(ii={}));var ci=void 0,fi=function(e){function n(n,t){var i,o,s=e.call(this,n,t)||this;s.usePartAPlugin=!0;var u=new oi,l=function(e){e&&e.addNotificationListener({eventsSent:function(e){a(2,2,(function(){return"Successfully sent "+e.length+" event(s)"})),a(3,2,(function(){return"Sent event(s) details : "+JSON.stringify(e,null,2)})),s.eventsSent+=e.length},eventsDiscarded:function(e,n){a(0,2,(function(){return"Discarded "+e.length+" event(s) because "+n})),a(3,2,(function(){return"Discarded event(s) details : "+JSON.stringify(e,null,2)})),s.eventsDiscarded+=e.length}})};function c(e,n,t,i){var o={instrumentationKey:n,endpointUrl:t,channelConfiguration:{eventsLimitInMem:e.eventsLimitInMem,httpXHROverride:e.httpXHROverride,setTimeoutOverride:e.setTimeoutOverride,clearTimeoutOverride:e.clearTimeoutOverride,ignoreMc1Ms0CookieProcessing:!0,disableOptimizeObj:!0},disableCookiesUsage:!0,extensionConfig:(0,r.pi)({},e.extensionConfig)};e.stats&&e.stats.networkStats&&o.channelConfiguration&&(o.channelConfiguration.payloadListener=function(n,t){var r,i=t||n;i.data&&(null===(r=e.stats)||void 0===r||r.networkStats(i.data.length))});var a=new Yr;return a.initialize(o,i),a.setUploadFrequency(e.uploadFrequency),e.notificationListener&&a.addNotificationListener(e.notificationListener),e.stats&&a.setPerfMgr(new li(e.stats)),a}s.sendTelemetryEvent=function(e){return ri((function(){var n=s.getOneDSTelemetryEvent(e);n&&i&&i.track(n)}),ci)},s.sendCustomerContent=function(e){return ri((function(){var n=s.getOneDSCustomerContent(e);n&&o&&o.track(n)}),ci)},s.addPersistentDataFields=function(e){u.addDataFields(e)},s.flush=function(e){i&&i.flush(e)},s.shutdown=function(){try{i&&i.shutdown()}catch(e){a(0,2,(function(){return"An error occurred on shutdown"}))}};var f=[u];if(t.plugins&&f.push.apply(f,t.plugins),!t.endpointUrl)throw new Error("Missing Endpoint Url");return i=c(t,"f998cc5ba4d448d6a1e8e913ff18be94-dd122e0a-fcf8-4dc5-9dbb-6afac5325183-7405",t.endpointUrl,f),t.enableCustomerContent&&t.endpointUrl===ii.PUBLIC&&(o=c(t,ni,ii.CUSTOMER_CONTENT,f)),t.disableStatsTracking||(l(i),l(o)),s.addPersistentDataFields(n),s}return(0,r.ZT)(n,e),n}((function(e,n){var t=this;this.eventsProcessed=0,this.eventsSent=0,this.eventsDiscarded=0,this.usePartAPlugin=!1;var i=[],o=!1,s={name:"DiagnosticLevel",processEvent:function(e){var n=e.eventFlags.diagnosticLevel;return o||10===n||110===n||120===n}},u={},l=sr(),c=(new Date).getTime().toString(),f=function(e,n){if(1===n.eventType)return ni;if(!e.telemetryProperties||!e.telemetryProperties.ariaTenantToken)throw new Error("Missing Tenant Token");return e.telemetryProperties.ariaTenantToken},d=function(e,n){var o,s=v(e);if(function(e){for(var n=function(n){var t=i[n];if(!t.processEvent(e))return a(2,1,(function(){return e.eventName+" suppressed by "+t.name})),{value:!1}},t=0;t<i.length;t++){var r=n(t);if("object"==typeof r)return r.value}return!0}(s)){t.eventsProcessed++;var d=((o=s.timestamp)?new Date(o):new Date).toISOString(),p={"Event.Sequence":{value:t.eventsProcessed,propertyType:4},"Event.Name":s.eventName,"Event.Source":"OTelJS","Event.Time":{value:d,propertyType:9}};ti(p,s.dataFields,{prependDataToken:!0,customerContentEnabled:1===n.eventType}),p["Event.Id"]=l+"."+t.eventsProcessed;var g="custom";s.eventContract&&(s.eventContract.name&&(p["Event.Contract"]=s.eventContract.name,g+="."+s.eventContract.name.toLowerCase().replace(/\./g,"_")),ti(p,s.eventContract.dataFields,{prependDataToken:!1,customerContentEnabled:1===n.eventType}));var h={iKey:f(s,n),name:s.eventName,data:p,time:d,baseType:g,ext:{sdk:{seq:t.eventsProcessed,epoch:c}}};return t.usePartAPlugin||(h.data=(0,r.pi)((0,r.pi)({},h.data),u)),h}};this.getOneDSTelemetryEvent=function(e){return d(e,{eventType:0})},this.getOneDSCustomerContent=function(e){if(n.enableCustomerContent&&e.telemetryProperties.customerContentVersion&&Math.floor(e.telemetryProperties.customerContentVersion)<=1&&1===e.telemetryProperties.customerContentType)return d(e,{eventType:1})},this.addPreprocessor=function(e){i.push(e)},this.addPersistentDataFields=function(e){ti(u,e,{prependDataToken:!1,customerContentEnabled:!1})},this.setOptionalEventsEnabled=function(e){o=e},this.setFullEventsEnabled=this.setOptionalEventsEnabled,n.enableOptionalEvents&&(o=!0),this.addPersistentDataFields(e),this.addPreprocessor(s)})),di=t(18092),vi=t(37344),pi=t(37831),gi=t(74688),hi=t(12708),yi=null,mi=function(){function e(e,n,t,r,i){void 0===i&&(i=5),this.serverRequestInfluxControl=i,this.context={},this.otelLogger=new k,this.intentionalPageViewLogTime=null;var o=new fi(e,{endpointUrl:this.getOneDSEndpoint(t,r)});this.otelLogger.addSink(o);this.otelLogger.setTenantToken("Office.Taos.Shell",n,-1),this.serverRequestInfluxControl<0?this.serverRequestInfluxControl=0:this.serverRequestInfluxControl>100&&(this.serverRequestInfluxControl=100)}return e.prototype.getOneDSEndpoint=function(e,n){if(n&&n.length>0)return n;if(!e)return ii.PUBLIC;var t=e.toLowerCase();return-1!==t.indexOf("tbprod")?ii.USGOV_DOJ:-1!==t.indexOf("pfprod")?ii.USGOV_DOD:ii.PUBLIC},e.prototype.registerContextParam=function(e,n){this.context[e]=n},e.prototype.writeEvent=function(e){if(null!=e){if(e.name===di.F5.ServerRequest){var n=e.properties.filter((function(e){return"ServerRequest_Status"===e.name}));if(n.length>0&&n[0].value>=200&&n[0].value<300)if(Math.floor(100*Math.random())+1>this.serverRequestInfluxControl)return}var t=[];if(e.name===di.F5.Click){var r=void 0;null===this.intentionalPageViewLogTime||this.intentionalPageViewLogTime>e.timestamp+864e5?(this.intentionalPageViewLogTime=e.timestamp,r=!0):r=!1,t.push(c("Click_IntentionalPageView",r))}t.push(d("Event_Type",di.hi[e.type])),e.properties.forEach((function(e){switch(e.type){case 1:t.push(c(e.name,e.value));break;case 3:t.push((n=e.name,r=e.value,{name:n,dataType:3,value:r,classification:4}));break;case 4:t.push(function(e,n){return{name:e,dataType:4,value:n,classification:4}}(e.name,e.value));break;case 2:t.push(f(e.name,e.value));break;default:t.push(d(e.name,e.value))}var n,r}));var i={eventName:e.elementName?"Office.Taos.Shell.".concat(di.F5[e.name],".").concat(e.elementName.replace(/^./,e.elementName[0].toUpperCase())):"Office.Taos.Shell.".concat(di.F5[e.name]),dataFields:t,eventFlags:{dataCategories:4,diagnosticLevel:110}};this.otelLogger.sendTelemetryEvent(i);0}},e}();function Ci(e,n){if(null==yi&&(0,hi.i)(n.PUID)){var t=di.cO.getNewID(),i=(0,pi.aH)(),o=(0,r.ev)((0,r.ev)((0,r.ev)((0,r.ev)((0,r.ev)([],b({name:"OfficeTaosShell",platform:"Web",version:window.O365ShellVerStr||"unknown"}),!0),w({id:n.SHSID}),!0),[d("Release.AudienceGroup",vi.Pr(n.FlightRing,i&&i.testTraffic))],!1),x({primaryIdentityHash:n.PUID,primaryIdentitySpace:n.IsConsumerShell?"MSAPUID":"OrgIdPUID",isAnonymous:!1,tenantId:n.TID,tenantGroup:n.IsConsumerShell?"Consumer":"Commercial"}),!0),[d("Context_Env",n.Environment||"unknown"),d("Context_Site",n.WorkloadId),d("Context_SiteSubId",e.CurrentMainLinkElementID),d("Context_WorkloadAppId",(0,gi.Dd)(n.WorkloadId,e.CurrentMainLinkElementID,document.URL)),d("Context_CID",vi.Eu(i.correlationID)),d("Context_PID",t),d("Context_UID",n.UID),d("Context_Language",e.CultureName),d("Context_Flights",e.FlightName),d("Context_FlightRings",n.FlightRing),d("Context_Segment",n.ActiveExperiences)],!1);window.O365ShellContext.SID=n.SHSID,window.O365ShellContext.PID=t,i.correlationID&&(window.O365ShellContext.CID=i.correlationID),(yi=new mi(o,"b0c82c6598ad49f3848b1d3dc0d8dd25-299cbfe9-b72e-4e9d-a5e3-20319efba5b5-7268",n.Environment,n.OTelTelemetryUri,n.AriaTelemetryServerRequestInfluxControl)).registerContextParam("Context_IsConsumer",n.IsConsumerShell?"true":"false"),yi.registerContextParam("Context_Site",n.WorkloadId);var a=(0,pi.jl)();a.registerService(yi),a.IsConsumer=n.IsConsumerShell}}}}]),HighResolutionTimingSupported&&(shellPerformance.mark("shell_otellogging_end"),shellPerformance.measure("shell_otellogging","shell_otellogging_start","shell_otellogging_end"));