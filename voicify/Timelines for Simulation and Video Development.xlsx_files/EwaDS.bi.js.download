(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[30],{1384:function(y,D,b){function a(la){var nb=ii.call(this)||this;nb.$=la;nb.dc();return nb}function d(){}function c(la){var nb=yi.call(this)||this;nb.ti=null;nb.$g=null;nb.$=la;nb.dc();return nb}function k(la,nb,Wb){var Dc=gh.call(this,la)||this;Dc.ke=null;Dc.Xwe=null;Dc.ep=!1;Dc.nr=0;Dc.qd=function(zb,hd){hd.Qg||Dc.Lf(!1)};Dc.Zj=function(){Dc.Lf(!1);Dc.raiseEvent("PQTPC");return!0};Dc.$=nb;Dc.taskPaneManager=Wb;bc.a(nb).Tg(Dc);
Dc.$.Vl(Dc.qd);return Dc}function n(la){return qi.call(this,la)||this}function l(la,nb){this.qoc=null;this.$=la;this.KSi=nb}function f(la,nb){var Wb=this;this.poc=this.Ahb=this.kca=this.Dxc=this.powerQueryTaskPane=null;this.kCf=this.Bf=!1;this.stateId=0;this.sEf=!1;this.KCb=function(){Wb.hideTaskPane();qf.EwaSettings.isChangeGateEnabled("OfficeVSO:5138260_ActivateQueryTargetWhenQuerySelected")&&Wb.$.xb.rg(Wb.Oe)};this.$xd=function(Dc){if(Dc&&!Lf.a(Dc))try{var zb=Dc.Result;if(zb.Queries){Wb.C_.clear();
for(var hd=yl(zb.Queries),ke=hd.next();!ke.done;ke=hd.next()){var He=ke.value;Wb.C_.add(He.Name,He)}}Wb.Dmj(zb.QueryGroups);Ac.ULS.sendTraceTag(537154435,0,50,"PowerQueryPaneManager.OnGetQueriesSuccess: type of queries: {0}",Wb.queries?Object.getType(Wb.queries).toString():"null");Ac.ULS.sendTraceTag(537154434,0,50,"PowerQueryPaneManager.OnGetQueriesSuccess: no. queries: {0}",Wb.queries?Wb.queries.length.toString():"null");if(qf.EwaSettings.Bcf()&&zb.PowerQueryConnectionsInfo){Wb.yK.clear();for(var df=
yl(zb.PowerQueryConnectionsInfo),kf=df.next();!kf.done;kf=df.next()){var ff=kf.value;Wb.yK.add(ff.QueryName,ff)}}Wb.Euf()}catch(Ef){Ac.ULS.sendTraceTag(537154433,0,10,"PowerQueryPaneManager.OnGetQueriesSuccess: QueryInfoList retrieval encountered exception {0}.",Ef)}};this.Fuf=function(){Wb.Euf()};this.lCb=function(){Ac.ULS.sendTraceTag(537154432,0,15,"PowerQueryPaneManager.OnGetQueriesFailure")};this.Oe=function(Dc,zb){zb.oa&&2===zb.oa.type&&Wb.iSd.wb(zb.oa.name)&&Wb.updateTaskPane(null,null,Wb.iSd.getItem(zb.oa.name))};
this.Kf=function(){var Dc=Wb.$.fa.zn.PowerQueryStateId;Ac.ULS.sendTraceTag(537154403,0,50,"PowerQueryPaneManager.OnWorkbookMetadataChanged: powerQueriesStateId: {0}, this.stateId: {1}",Dc,Wb.stateId);Dc>Wb.stateId&&Wb.Bf&&Wb.zTf();Wb.stateId=Dc};this.$xf=function(){Wb.RCb()};this.cyf=function(Dc,zb){Dc=[];for(var hd=yl(Wb.yK.values),ke=hd.next();!ke.done;ke=hd.next())if(ke=ke.value,zb===ke.ConnectionName&&(ke=ke.QueryName,Wb.nwa(ke))){Array.add(Dc,ke);break}Wb.kca.TQd(Dc)};this.lmc=function(Dc,zb){if(zb&&
zb.Result){Dc=zb.Result;zb=[];for(var hd=yl(Wb.yK.values),ke=hd.next();!ke.done;ke=hd.next())if(ke=ke.value,Dc===ke.ConnectionName&&(ke=ke.QueryName,Wb.nwa(ke))){Array.add(zb,ke);break}Wb.kca.B2f(zb)}};this.Zxf=function(){for(var Dc=[],zb=yl(Wb.yK.values),hd=zb.next();!hd.done;hd=zb.next())hd=hd.value.QueryName,Wb.nwa(hd)&&Array.add(Dc,hd);Wb.kca.B2f(Dc)};this.$=la;this.powerQueryManager=nb;this.iSd=new mb.a(!0);this.jNc=new mb.a(!1);this.C_=new mb.a(!1);this.e5h(la);this.Lla=qf.EwaSettings.isChangeGateEnabled("OfficeVSO:5751619_PowerQueryManagerWebClient");
this.Lla||(this.$.fa.jt(this.Kf),this.$.fa.zn&&(this.stateId=this.$.fa.zn.PowerQueryStateId));De.a(this.$).Qle(this.lmc);De.a(this.$).Rle(this.cyf);qf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryWebAsyncRefreshAll",!1)||(De.a(this.$).yle(this.$xf),De.a(this.$).xle(this.Zxf));this.Lla&&this.powerQueryManager.UCg(this.Fuf);Ac.ULS.sendTraceTag(542228699,0,15,"PowerQueryPaneManager.ShowPowerQueryTaskPane()")}function u(la,nb){var Wb=this;this.bva=new mb.a(!1);this.KJ=new mb.a(!0);
this.v3a=new mb.a(!0);this.w3a=this.A_=null;this.KJf=0;this.handleQueryGroupOperation=function(Dc,zb){var hd={};hd.Id=zb.id;hd.Name=zb.name;hd.Description=zb.description;hd.ParentId=zb.parentId;Wb.Nla.handleQueryGroupOperation(Dc,hd)};this.$=la;this.Nla=nb;this.isVisible=!1;this.oPa=new mb.a(!0);this.fFd={}}function v(){this.name=null;this.rowsLoaded=0;this.lastRefresh=null;this.fillObjectType=0;this.loadedToDataModel=!1;this.queryError=0;this.groupKey=null;this.rowsWithError=this.nestingDepth=0;
this.refreshEnabled=this.inRefresh=!1}function m(){this.callbacks=this.selectedQueryKey=this.groups=this.queries=this.type=null}function A(){this.onCancelQueryRefresh=this.handleQueryGroupOperation=this.onQueryRefresh=this.onQuerySelected=null}function x(){this.name=this.key=null;this.startIndex=this.count=0;this.data=this.children=null;this.level=0}function t(la){var nb=ti.call(this)||this;nb.$=la;nb.dc();return nb}function z(la){var nb=this;this.stateId=0;this.fDe=!1;this.Ahb=null;this.Kf=function(){var Wb=
nb.$.fa.zn.PowerQueryStateId;Ac.ULS.sendTraceTag(537154444,0,50,"PowerQueryManager.OnWorkbookMetadataChanged: powerQueriesStateId: {0}, this.stateId: {1}",Wb,nb.stateId);Wb>nb.stateId&&nb.o9c().continueWith(function(Dc){Dc.result?nb.stateId=Wb:Ac.ULS.sendTraceTag(537154443,0,15,"PowerQueryManager.OnWorkbookMetadataChanged failed to update the local state")})};this.hKj=function(Wb){if(Wb&&!Lf.a(Wb))try{var Dc=Wb.Result;if(Dc.Queries){nb.C_.clear();for(var zb=yl(Dc.Queries),hd=zb.next();!hd.done;hd=
zb.next()){var ke=hd.value;nb.C_.add(ke.Name,ke)}}nb.Ahb=Dc.QueryGroups;Ac.ULS.sendTraceTag(537154442,0,50,"PowerQueryManager.OnGetQueriesSuccess: type of queries: {0}",nb.queries?Object.getType(nb.queries).toString():"null");Ac.ULS.sendTraceTag(537154441,0,50,"PowerQueryManager.OnGetQueriesSuccess: no. queries: {0}",nb.queries?nb.queries.length.toString():"null");if(Dc.PowerQueryConnectionsInfo){nb.yK.clear();for(var He=yl(Dc.PowerQueryConnectionsInfo),df=He.next();!df.done;df=He.next()){var kf=
df.value;nb.yK.add(kf.QueryName,kf)}}nb.fDe=!0}catch(ff){Ac.ULS.sendTraceTag(537154440,0,10,"PowerQueryManager.OnGetQueriesSuccess: QueryInfoList retrieval encountered exception {0}.",ff)}};this.lCb=function(){Ac.ULS.sendTraceTag(537154439,0,15,"PowerQueryManager.OnGetQueriesFailure")};this.lMi=function(Wb){nb.Ma.raiseEvent("OnUpdatePowerQueryDataKeySucceeded",Wb)};this.kMi=function(Wb){nb.Ma.raiseEvent("OnUpdatePowerQueryDataFailed",Wb)};this.$=la;this.C_=new mb.a(!1);this.jNc=new mb.a(!1);this.Ma=
new td.a;this.$.fa.jt(this.Kf);this.$.fa.zn&&(this.stateId=this.$.fa.zn.PowerQueryStateId)}function r(la){return Fg.call(this,la)||this}function G(la){var nb=jh.call(this)||this;nb.Snc=null;nb.y$a=!1;nb.Nya=null;nb.bFd=!1;nb.Ma=new td.a;nb.Ww=null;nb.SEd=!1;nb.QTb=[];nb.i7h=function(Dc){nb.uVc(Dc.Ca)};nb.DPg=function(){nb.wMd(0);nb.GJf(!0,null,!1)};nb.eIi=function(Dc){Dc.RequestId||(nb.A9a=null,nb.$.fa.Yo(Dc.Errors))};nb.fIi=function(Dc){nb.A9a=null;Dc=cg.a.yg(Dc.data);nb.$.fa.Yo(Dc)};nb.Yxf=function(Dc){nb.ayf(Dc);
if(Dc.DepartableWebMethodOperationCompleted||Dc.Errors&&0<Dc.Errors.length)nb.SEd=!1,nb.Ma.raiseEvent("refreshAllCompleted",Dc,nb)};nb.yEi=function(Dc){Dc&&!Lf.a(Dc)&&(!(Dc=Dc.Result)||1>Dc.length||(nb.Ww&&nb.Ww.C(),nb.Ww=new mg.a,nb.b7f(Dc,0,nb.Ww.token)))};nb.xEi=function(Dc){Ac.ULS.sendTraceTag(537163298,306,50,"DataRefreshManager::OnGetSensitivityLabelsFailedCallback");Dc=cg.a.yg(Dc.data);nb.$.fa.Yo(Dc)};nb.kd=function(){nb.Z8e()};nb.d8a=function(Dc,zb){var hd=zb.$c.block,ke=hd.qe.PeriodicRefreshExpiryInSeconds;
void 0!==ke&&nb.zWf(ke);ke=id.g(nb.$);5===hd.state&&Dc===ke.Ca&&((Dc=(Dc=ke.JF(zb.$c.hash))?Dc.Wf:null)&&!Dc.Rd(ke.ha.va.activeCell)||nb.Z8e())};nb.Zc=function(){nb.$.fa.oc||nb.clear()};nb.$=la;nb.YAd=-1;nb.A9a=null;la=id.g(nb.$);var Wb=la.ha;Wb.iG(nb.kd);Wb.bra(nb.kd);la.Ca.nga(nb.d8a);nb.uVc(la.Ca);nb.uVc(fd.a(nb.$).Ca);nb.$.da.Za(36,nb.i7h);nb.$.fa.Sj(nb.Zc);qf.EwaSettings.isChangeGateEnabled("OfficeVSO:5697254_ApplyPowerBiLabel")&&(la=nb.$.ya.StartupDelayMultiplierForLabelsOnRefreshOnOpen*nb.$.ya.TimeToWaitForApplyingSensitivityLabels,
Ac.ULS.sendTraceTag(537163332,306,50,"DataRefreshManager async call to UpdateSensitivityLabels after {0} ms.",la),ae.a.instance.create(function(){nb.Yzc()},la,Uf.a.C7g,!0,!0));return nb}function w(la,nb,Wb,Dc,zb,hd,ke,He,df){var kf=He?"RefreshAllDirtyDataSources":"RefreshAll",ff=1|(qf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryWebAsyncRefresh",!1)?0:8);df=la.Oa(ff,df);ff=df.context;ff.RequestId=Wb;ff.CompleteResponseTimeout=Dc;df.periodic=nb;return Ce.i(la,kf,df,zb,hd,ke,
He,nb?8:0)}function B(la,nb){return Ye.call(this,la,B.iQ(nb))||this}function U(la,nb,Wb,Dc,zb,hd){zb=void 0===zb?kd.a.o4c:zb;return sg.call(this,la,nb,Wb,Dc,zb,void 0===hd?null:hd)||this}function N(la,nb){this.pivotTableName=this.pivotTableId=null;this.pivotTableId=la;this.pivotTableName=nb}function P(la){return wg.call(this,la)||this}function ia(la){var nb=Xe.call(this)||this;nb.ti=null;nb.$g=null;nb.$=la;nb.dc();return nb}function W(la,nb,Wb){var Dc=jg.call(this,la)||this;Dc.ke=null;Dc.$we=null;
Dc.nr=0;Dc.Hr=!1;Dc.qd=function(zb,hd){hd.Qg||Dc.Lf(!1)};Dc.Zj=function(){Dc.Lf(!1);Dc.raiseEvent("PivotTableSettingsTaskPaneClosed");return!0};Dc.$=nb;Dc.taskPaneManager=Wb;Dc.$.Vl(Dc.qd);Dc.ha=id.g(Dc.$).ha;bc.a(nb).Tg(Dc);return Dc}function R(la){var nb=eg.call(this)||this;nb.$=la;nb.dc();return nb}function I(la){var nb=this;this.Vnc=this.jEb=this.pivotTableSettingsTaskPane=null;this.Bf=!1;this.oca="";this.Aya=!1;this.WEf=0;this.X2=this.Ola=this.o3b=this.VEf=null;this.Hr=this.uNa=!1;this.kIi=function(Wb,
Dc){if(Lf.a(Wb)){var zb=Wb.Errors[0].Description;Wb=Wb.Errors[0].MessageId;var hd=Dc.zDf;Dc=Dc.ADf;var ke=nb.eja();if(!ke||Dc!==ke.fca)if(nb.Ola&&Dc===nb.Ola.fca)ke=nb.Ola;else{Ac.ULS.sendTraceTag(537154689,0,50,"OnPivotTableSettingsChanged Cannot Find PivotTable for opType: {0}",hd);return}switch(hd){case 1:ke.pivotTableName=nb.oca;break;case 2:ke.rwGrandTotalOn=nb.Aya;break;case 3:ke.colGrandTotalOn=nb.Aya;break;case 12:ke.errorString=nb.oca;break;case 13:ke.nullString=nb.oca;break;case 14:ke.saveSourceDataWithFile=
nb.Aya;break;case 15:ke.refreshOnLoad=nb.Aya;break;case 16:ke.altText=nb.oca;break;case 17:ke.altTextSummary=nb.oca;break;case 20:ke.indentIncrement=nb.WEf}Ac.ULS.sendTraceTag(537154688,0,50,"OnPivotTableSettingsChangedSuccessCallback encounters error {0} {1} for opType: {2}",Wb,zb,hd);nb.updateTaskPane(nb.eja())}};this.LCb=function(){nb.hideTaskPane(!0)};this.hla=function(){var Wb=nb.gridView.inRangePicker||nb.gridView.zi||!!(nb.ha.Te&470);Zc.a.Gd(nb.$)?(nb.fn()&&!Wb&&nb.s9f(),nb.dAc()):nb.Bf&&!Wb&&
(nb.s9f(),nb.X2!==nb.Ola&&nb.X2&&nb.updateTaskPane(nb.eja(),!0))};this.Ms=function(){Zc.a.Gd(nb.$)?(nb.fn()&&(nb.X2=nb.eja()),nb.dAc()):nb.Bf&&(nb.X2=nb.eja(),nb.updateTaskPane(nb.X2))};this.$=la;this.gridView=id.g(this.$);this.d5h(la);this.ha=this.gridView.ha;this.ha.fG(this.hla);this.gridView.DD(this.hla);this.gridView.hT(this.Ms);this.vL=Array(6);for(la=0;la<this.vL.length;la++)this.vL[la]=!1}function Q(){this.enabled=!1;this.caption=this.sheet=this.name=null}function O(){this.pivotTableName=null;
this.rwGrandTotalOn=this.colGrandTotalOn=!1;this.indentIncrement=0;this.displayNullString=this.displayErrorString=this.showItemsWithNoDataOnCol=this.showItemsWithNoDataOnRw=this.showDrillIndicators=this.autoFormatOnUpdate=!1;this.nullString=this.errorString=null;this.refreshOnLoad=this.saveSourceDataWithFile=!1;this.slicerConnections=this.altTextSummary=this.altText=null}function ba(la,nb){this.$=la;this.pivotTableSettingsPaneManager=nb}function ca(){this.onSettingChange=this.settingsInfo=this.type=
null;this.hasLessThanTwoRowFields=this.expandAllByDefault=this.isNativePivotTable=this.isRangeChanged=!1;this.onSaveSectionCollapseState=this.sectionCollapseStates=null;this.needFocusOnFirstElement=!1}function S(){this.zDf=0;this.ADf=null}function Y(la,nb,Wb,Dc,zb){this.pivotTableName=this.activeCell=null;this.opType=0;this.userInputText=null;this.userInputInt=0;this.activeCell=la;this.pivotTableName=nb;this.opType=Wb;this.userInputText=Dc;this.userInputInt=zb}function na(la){return vf.call(this,
la)||this}function Z(la){var nb=this;this.activeCell=this.Wc=null;this.jEi=function(Wb){Wb&&!Zg.a.hh(Wb.Errors)&&nb.Rqd(Wb.Result)};this.iEi=function(){};this.lEi=function(Wb){Wb&&!Zg.a.hh(Wb.Errors)&&nb.Sqd(Wb.Result)};this.kEi=function(){};this.hEi=function(Wb,Dc){Wb&&!Zg.a.hh(Wb.Errors)&&nb.Oqd(Wb.Result,Dc)};this.gEi=function(){};this.$=la;this.ha=id.g(this.$).ha}function wa(la,nb,Wb){var Dc=tf.call(this,la)||this;Dc.jsa=null;Dc.VQi=function(zb,hd){if(1===zb){Ac.ULS.sendTraceTag(537154695,0,50,
"PivotTableFilterConnectionsDialog.PivotTableFilterConnectionsDialogHandler: OK button pressed. Going to update connections.");var ke=Dc.f6g(hd),He=Dc.$.qa.ta.Xb();zb=new af.a(584,0,function(df,kf,ff){var Ef=Dc.$.qa.ta,Qf=Dc.pivotTableName,Vg=Dc.D9a;df=Of.b(df,Dc.jMi);kf=Of.a(kf,Dc.iMi);var Kg=Ef.Oa(41,void 0===He?null:He);Kg.pivotTableName=Qf;Kg.sheetName=Vg;Kg.updateInfo=ke;return Ce.i(Ef,"UpdatePivotTableSlicerConnectionInfo",Kg,df,kf,ff,null,0)},4);Dc.$.userOperationManager.ic(zb,null)}else Ac.ULS.sendTraceTag(537154694,
0,50,"PivotTableFilterConnectionsDialog.PivotTableFilterConnectionsDialogHandler: Canel button pressed.")};Dc.rEi=function(zb){!Lf.a(zb)&&zb.Result&&(Dc.jsa=zb.Result,Dc.xf=ma.UQi(),Dc.initializeAndShow(Dc.mah+" ("+Dc.pivotTableName+")",Dc.VQi,Dc.L5h()),zb=document.getElementById("filterConnectionsDialogTable").getElementsByTagName("tbody")[0],Dc.FRi(zb))};Dc.qEi=function(){Ac.ULS.sendTraceTag(537154693,0,10,"PivotTableFilterConnectionsDialog.GetPivotTableFilterConnectionsInfoWebMethodFailed: Getting information to populate Filter Connections dialog failed")};
Dc.jMi=function(){};Dc.iMi=function(){};Dc.pivotTableName=nb;Dc.D9a=Wb;Dc.mah=gb.a.instance.ea(2087);return Dc}function ma(){}function pa(){var la=Ne.call(this)||this;la.dc();return la}function Ia(la,nb){return Rd.call(this,la,nb)||this}function Ma(la,nb,Wb,Dc){var zb=$b.call(this,nb,la,!1)||this;zb.NZd=null;zb.Ki=null;zb.Nuc=new mb.a(!0);zb.d3=new mb.a(!0);zb.Msa=null;zb.W_a=null;zb.AGb=null;zb.ZMb=!1;zb.jzb=null;zb.hashCode=null;zb.Byc=!1;zb.LRa=null;zb.tzb=Oc.a.Ra.Kb;zb.businessBar=null;zb.lmc=
function(hd,ke){ke&&ke.Result&&(hd=ke.Result,hd.DataConnections&&hd.DataConnections.DataConnections&&zb.LJf(hd.DataConnections))};zb.Pe=function(hd,ke){switch(ke.$c.block.state){case 1:case 3:case 5:zb.Qma(ke)}};zb.Hm=function(){};zb.ko=function(hd,ke){zb.G6c();ke.oa&&zb.isVisible&&zb.bki(!Rc.j(ke.oa));zb.clearCache();zb.vQ=!1};zb.fN=function(hd){switch(hd.ut){case 1:zb.Byc&&zb.y9b(zb.Ki)}};zb.od=function(hd,ke){ke.DQ||(zb.G6c(),hd=zb.$,zb.msb=Ae.d(hd.kg),hd.fa.xBa.getTime()>zb.xBa.getTime()&&(zb.R0b(),
zb.xBa=hd.fa.xBa),zb.pwa&&zb.y9b(zb.Ki))};zb.Oe=function(){zb.KRa(!1)};zb.iN=function(){zb.$.fa.Ala()};zb.onKeyDown=function(hd){hd=zb.$.shortcutKeyManager.xt(hd);zb.executeRibbonCommand(hd)};zb.aj=function(){zb.Ki&&zb.Ki.Zna()};zb.W5=function(){zb.jcc();zb.qJ.Uaa=!0};zb.V5=function(){zb.qJ.oyb||zb.qJ.Syb||zb.VLb();zb.qJ.Uaa=!1};zb.wCb=function(){zb.jcc();zb.qJ.Uaa=!0};zb.Jt=function(){zb.qJ.oyb||zb.qJ.Syb||zb.VLb();zb.qJ.Uaa=!1};zb.wyf=function(){zb.qJ.oyb=zb.XGb.UM&&zb.XGb.yRi;zb.qJ.oyb?zb.jcc():
zb.qJ.Uaa||zb.qJ.Syb||zb.VLb()};zb.Fxf=function(){switch(sf.a(zb.$).state){case 0:case 1:case 2:case 4:zb.qJ.oyb||zb.qJ.Uaa||zb.VLb();zb.qJ.Syb=!1;break;case 5:case 3:case 7:case 8:case 6:zb.jcc(),zb.qJ.Syb=!0}};zb.rDi=function(hd,ke){if(zb.XLa(3)||zb.pwa){var He=hd.Result;hd=zb.pwa;if(null===He||void 0===He?0:He.ReportData)zb.AGb=He.ReportData;if(He&&He.DataConnectionsInfo)if(He=He.DataConnectionsInfo,1===He.DataConnections.length&&He.DataConnections[0].StreamingFailed)zb.R0b(),zb.KRa(!0);else{var df=
!0;zb.W_a=He.DataSources;for(var kf=yl(He.DataConnections),ff=kf.next();!ff.done;ff=kf.next())if(ff=ff.value,ff.IsReady||0>ff.SourceIndex){var Ef=ff.ConnectionName.toLowerCase();zb.d3.getItem(Ef)||zb.d3.add(Ef,ff)}else{ke.Agh();df=!1;break}df&&(hd?zb.LJf(He):(zb.Ki.sZ=4,zb.Tdb(ke,null)))}else zb.Ki.sZ=1}};zb.zEi=function(hd){hd&&zb.$.fa.Yo(hd.Errors)};zb.x4a=new Ec.a(la,la.fa,la.qa.Ek,4,0);zb.xBa=la.fa.xBa;zb.msb=!la.lc.refreshConfirmationRequired||Ae.d(la.kg);zb.PJe=!1;zb.domElement.classList.add(Ob.a.U6b);
zb.domElement.style.overflow="hidden";zb.domElement.tabIndex=0;zb.KRa(!1);zb.wc.ja("mousedown",zb.iN);zb.wc.ja("keydown",zb.onKeyDown);la.xa.aJ(zb.ko);la.xb.aJ(zb.ko);la.xb.Pf(zb.Oe);la.xa.Pf(zb.Oe);la.Yz(zb.aj);la.Ab.bYb(zb.W5);la.Ab.aYb(zb.V5);la.Ka.qTc(zb.wCb);la.Ka.cFa(zb.Jt);sf.a(la).iq(zb.Fxf);zb.Ca.gq(zb.Pe);zb.Ca.gG(zb.Hm);De.a(la).zle(zb.lmc);la.Rk(zb.od);qf.EwaSettings.tc()&&zb.Nq(zb.Kxa);mh.a(la).gQ(Da.a.idle).iq(zb.fN);zb.XGb=Wb;zb.XGb.EB(zb.wyf);zb.qJ=new ob;zb.o_b=Dc;da.ja(la,zb);return zb}
function ob(){this.Syb=this.Uaa=this.oyb=!1}function Cb(la,nb){this.owc=la;this.x7b=nb}function Xa(la,nb,Wb,Dc,zb){var hd=this;this.interactiveReportContent=this.boc=this.PF=null;this.J8e=!1;this.rRi=function(){hd.interactiveReportView.y9b(hd)};this.M5d=la;this.dmg=Wb;this.$=zb;this.PF=Dc?new Sb(nb):new Tb(nb,Wb);this.sZ=this.PF.P7e;this.Zna()}function Sb(la){this.o4a=document.createElement("img");ed.DOMElementExtensions.setVisible(this.o4a,!0);this.o4a.setAttribute("style","height: 80%; width: auto");
this.g5b=document.createElement("div");this.g5b.id=la;this.g5b.appendChild(this.o4a)}function Tb(la,nb){var Wb=this;this.iframe=document.createElement("iframe");this.iframe.src=nb;this.iframe.frameBorder="0";this.iframe.scrolling="no";this.iframe.id=la;this.hia=Qe.a.instance.Cd(this.iframe);this.hia.ja("load",function(){InteractiveReportAPI.SetHost(Wb.contentWindow,nb)})}function da(la){this.interactiveReportView=la}function ya(la){return ef.call(this,la)||this}function hb(la){this.activeCell=this.Wc=
null;this.$=la;this.ha=id.g(this.$).ha}function Gb(la,nb,Wb){var Dc=Od.call(this,la)||this;Dc.d1f=null;Dc.x6h=function(zb,hd){1===zb?(zb=hd.indices,Ac.ULS.sendTraceTag(537155741,0,50,"InsertSlicerDialog.ClickedOK: User clicked OK, inserting {0} Slicers",zb.length),0<zb.length&&Dc.I$g(zb)):Ac.ULS.sendTraceTag(537155740,0,50,"InsertSlicerDialog.Dismissed: User dismissed the dialog")};Dc.VDi=function(zb){Dc.d1f=zb.Result;zb={};zb=(zb.id=Dc.xc,zb.singleDimFields=Dc.d1f,zb);Dc.initializeAndShow(gb.a.instance.ea(2083),
Dc.x6h,zb)};Dc.gridView=id.g(la);Dc.va=Dc.gridView.ha.va;Dc.ha=id.g(la).ha;Dc.pivotTableName=nb;Dc.D9a=Wb;id.g(la).Vb.nq(Dc.ha.va.activeCell);Ac.ULS.sendTraceTag(543511326,0,50,"InsertSlicerDialog.Constructor: User Opened Insert Slicer Dialog");Dc.Q5h();return Dc}function Qb(la){return Bd.call(this,la)||this}function Fb(la){var nb=this;this.wid=!1;this.t9=this.r1h=null;this.$=la;this.gridView=id.g(la);yd.a.instance.mc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Wb){nb.t9=
Wb;Wb.isFeatureEnabled(Fb.E6e,!1).then(function(Dc){return nb.wid=Dc});nb.r1h=Wb.Vya(Fb.E6e,function(Dc){nb.wid=Dc.isEnabled})})}function ta(la,nb){var Wb=bd.call(this,la,new xa(la))||this;Wb.FRa=null;Wb.yxa=null;Wb.J$=null;Wb.destinationRange=null;Wb.GSd=null;Wb.qAa=!1;Wb.vu=0;Wb.Zvj="";Wb.zEe="";Wb.w8e=function(Dc,zb){Wb.hide();if(1===Dc){var hd=Dc="";2!==Wb.vu&&(Dc=ta.yAd(zb[ta.xwc],Wb.$.xa),Wb.Yvj(Dc,Wb.$)&&Ac.ULS.sendTraceTag(537155781,0,50,"InsertPivotTableDialog.InsertPivotTableDialogHandler - Source does not have enough entries"));
1!==Wb.vu&&zb[ta.L8c]&&(hd=ta.yAd(zb[ta.u4b],Wb.$.xa));2===Wb.vu&&hd===Wb.zEe||Wb.P5h(Dc,hd)}else Wb.KJb(!0,!0),Ac.ULS.sendTraceTag(537155780,0,50,"InsertPivotTableDialog.InsertPivotTableDialogHandler - cancel was clicked.")};Wb.ar=function(){Wb.TAa()};Wb.glc=function(){Wb.destinationRange.disabled=!Wb.J$.checked;Wb.TAa();return!1};Wb.Lsf=function(){Wb.TAa();return!1};Wb.Xzf=function(){Wb.TAa();return!1};Wb.nyd=function(Dc){if(Lf.a(Dc))Wb.KJb(!0,!0),Ac.ULS.sendTraceTag(537155742,0,50,"InsertPivotTableDialog.OnInsertPivotTableDone - failed.");
else if(Ac.ULS.sendTraceTag(537155743,0,50,"InsertPivotTableDialog.OnInsertPivotTableDone - success."),Dc=Dc.Result){var zb=Wb.$.xa.getItemByName(Dc.SheetName);zb&&(zb.activate(),Wb.gridView.yi(Dc,null,null,null,3,gc.a.w6h),Wb.KJb(!0,!1),Wb.vu||Wb.uij(),Dc=Pd.a.jFb,Dc!==Og.a(Wb.$).Lm.qo&&(Og.a(Wb.$).VEb(2),Og.a(Wb.$).Lm.activateRibbonTab(Dc)))}else Wb.KJb(!0,!1)};Wb.gridView=id.g(Wb.$);Wb.Iu=gg.a.instance;Wb.gu=!1;-1128516639===nb?(Wb.vu=1,Ac.ULS.sendTraceTag(537155785,0,50,"InsertPivotTableDialog.InsertPivotTableDialog - for PivotTable Operation Change data Source")):
-63037693===nb?(Wb.vu=2,Ac.ULS.sendTraceTag(537155784,0,50,"InsertPivotTableDialog.InsertPivotTableDialog - for PivotTable Operation Move PivotTable")):Ac.ULS.sendTraceTag(537155783,0,50,"InsertPivotTableDialog.InsertPivotTableDialog");return Wb}function xa(la){return xc.call(this,la)||this}function sa(la,nb){this.destinationRange=this.sourceRange=null;this.sourceRange=la;this.destinationRange=nb}function lb(la,nb,Wb,Dc,zb,hd,ke){ke=la.Oa(1,void 0===ke?null:ke);ke.activeCell=nb;return Ce.i(la,"GetDataSourceRangeForPivotTable",
ke,Wb,Dc,zb,hd,0)}function Yb(la,nb,Wb,Dc,zb,hd,ke,He,df){df=la.Oa(41,void 0===df?null:df);df.activeCell=nb;df.newRange=Wb;df.isDataSource=Dc;return Ce.i(la,"ChangePivotLocation",df,zb,hd,ke,He,0)}function Fa(la,nb,Wb,Dc,zb,hd,ke,He){He=la.Oa(1,void 0===He?null:He);He.sheetRange=nb;He.activeCell=Wb;return Ce.i(la,"GetExpandedRangeForPivotTable",He,Dc,zb,hd,ke,0)}function Sa(la,nb){this.title=la;this.xf=nb}function Ra(la,nb){this.AVb=la;this.Npg=nb;this.bpc=null}function Lb(){}function Ja(){this.v4b=
this.sourceRange=this.rda=null}function xb(la){var nb=dd.call(this)||this;nb.$=la;nb.dc();return nb}function Kb(la,nb,Wb,Dc){var zb=tc.call(this,la)||this;zb.J7b=300;zb.C9c=250;zb.bQ=new Ua;zb.dQ=new Ua;zb.T4c={};zb.Uj=null;zb.xi=null;zb.cQ=null;zb.hC=null;zb.EPe=null;zb.H7b=null;zb.u9c=null;zb.Eaa=null;zb.Sk=null;zb.sjg=!0;zb.E4c=0;zb.$ta=!1;zb.cn=null;zb.wt=null;zb.YHa=null;zb.wK=null;zb.jE=null;zb.sH=null;zb.iNb=null;zb.zV=null;zb.eif=!1;zb.p_b=!1;zb.eob=!1;zb.uk=null;zb.Ssb=Kb.lBc;zb.currentState=
$a.G2b();zb.AFa=null;zb.bsa=null;zb.QT=null;zb.cA=null;zb.o_c=null;zb.trb=null;zb.H5b=null;zb.srb=null;zb.F5b=null;zb.G5b=null;zb.ZHa=null;zb.jya=null;zb.jpb=null;zb.fHb=null;zb.PWd=null;zb.L9c=null;zb.gba=0;zb.xmd=!1;zb.yIb=!1;zb.sia=null;zb.Bf=!1;zb.y5a=!1;zb.n6=null;zb.gFb=null;zb.Twe=null;zb.kFb=-1;zb.cW=[];zb.fFb=!1;zb.dPa=null;zb.fEd=!1;zb.qIf=!1;zb.eFb=!1;zb.dFb="";zb.cPa=null;zb.m6=0;zb.l6="";zb.dEd=!1;zb.oIf=null;zb.fj=!1;zb.nr=0;zb.iGc=null;zb.Kxf=function(){if(zb.fFb&&zb.dPa){var hd=document.getElementById(zb.dPa);
hd&&hd.classList.add("fieldItemMenuOpen")}};zb.Jxf=function(){if(zb.fFb&&zb.dPa){var hd=document.getElementById(zb.dPa);hd&&(hd.classList.remove("fieldItemMenuOpen"),hd.classList.contains("fieldItemOnHover")||hd.classList.contains("fieldItemOnFocus")||(hd.style.visibility="hidden"))}zb.fFb=!1;zb.dPa=null};zb.Zj=function(){zb.wIb(!0,null);zb.hideTaskPane();return!0};zb.Lga=function(){if(zb.$)if(mh.a(zb.$).iLa&&zb.isVisible&&zb.currentState.D5a&&zb.$.fa.oc){if(zb.bQ.vl&&!zb.bQ.request){var hd=zb.bQ;
var ke=zb.$.qa.ta;var He=zb.currentState.wJ,df=zb.currentState.uN,kf=zb.currentState.qo,ff=zb.JDi,Ef=zb.KDi,Qf=zb.bQ.aof(),Vg=Ce.mb(ke,zb.currentState.Pt,zb.currentState.externalSourceIndex,Kb.fqb(zb.currentState));Vg.type=1;Vg.version=He;Vg.relatedGroup=df;Vg.selectedTab=kf;ke=Ce.i(ke,"GetPivotFieldListData",Vg,ff,Ef,null,Qf,4);hd.request=ke}zb.dQ.vl&&!zb.dQ.request&&(hd=zb.dQ,ke=zb.$.qa.ta,He=zb.currentState.eQ,df=zb.MDi,kf=zb.NDi,ff=zb.dQ.aof(),Ef=Ce.mb(ke,zb.currentState.Pt,zb.currentState.externalSourceIndex,
Kb.fqb(zb.currentState)),Ef.type=1,Ef.version=He,ke=Ce.i(ke,"GetPivotFieldManagerData",Ef,df,kf,null,ff,4),hd.request=ke)}else Kb.lY(zb.bQ),Kb.lY(zb.dQ)};zb.JDi=function(hd,ke){zb.KEf(hd,ke,zb.bQ)&&(hd=hd.Result)&&(zb.currentState.wJ=hd.FieldListVersion,zb.bQ.vl=!1,zb.W9f(hd));De.a(zb.$).Yzc();zb.refresh()};zb.KDi=function(hd){zb.Gsf(hd,zb.bQ)};zb.MDi=function(hd,ke){zb.KEf(hd,ke,zb.dQ)&&(hd=hd.Result)&&(zb.currentState.eQ=hd.FieldWellVersion,zb.dQ.vl=!1,zb.N9f(hd));zb.refresh()};zb.NDi=function(hd){zb.Gsf(hd,
zb.dQ)};zb.Vyi=function(hd){if(Zg.a.hh(hd.Errors)){zb.eob=!1;zb.AFa=null;for(var ke=0,He=hd.Errors.length;ke<He;++ke)if(1244452614===hd.Errors[ke].MessageId){qf.EwaSettings.isChangeGateEnabled("OfficeVSO:4354463_UpdateSelectionAfterApplyPivot")&&(hd=id.g(zb.$),ke=hd.Vb.nq(hd.ha.va.activeCell))&&(ke=og.Range.ld(ke.IQf+1,ke.left),ke=rf.v(ke,zb.$),hd.yi(ke,null,null,null,3,gc.a.Mth));zb.currentState.wJ=-1;zb.currentState.eQ=-1;zb.refresh();break}}zb.$ta=!0;zb.uMb()};zb.yCi=function(hd){zb.p_b=!1;if(!Zg.a.hh(hd.Errors)){if(zb.fieldList)zb.fieldList.lJj();
else if(zb.Mu&&0<zb.cW.length)for(hd=0;hd<zb.cW.length;++hd)zb.cW[hd].IsCollapsed=!1;zb.currentState.wJ=-1;zb.refresh()}zb.uMb()};zb.onResize=function(){zb.vab()};zb.xyd=function(hd){wc.g(hd)};zb.yyd=function(hd){if(!hd.button){var ke=hd.target;if(ke){var He=zb.O$b(ke);if(He){for(var df=null,kf=-1,ff=Kb.eL;ff<=Kb.eS;ff++)if(He.id.startsWith(zb.H7b[ff])){df=ka(zb.cQ[ff],He.id,!1);kf=ff;break}df&&(zb.kda(df,kf),zb.sjg&&(zb.Sk&&zb.k3(),ff=zb.parentElement,kf=eb.eWe(ge.HelperMethods.LJa(ke,ff),zb.hC[kf],
zb.H5b.currentStyle,zb.isRtl),zb.Sk=new eb(eb.cpb(df,He,kf,ke.offsetWidth),zb,df),ff.appendChild(zb.Sk.domElement),zb.Sk.jmb(zb.cCb),zb.Sk.imb(zb.bCb),zb.Sk.Fke(zb.aCb),zb.raiseEvent(Kb.G7b),zb.Sk.ona(hd)));wc.g(hd)}}}};zb.zyd=function(hd){if(!zb.Sk&&!hd.button){var ke=hd.target;if(ke&&(ke=zb.Ahi(ke))){var He=zb.Ofd(ke.id);zb.MIa(hd.target,He.kBc,He.returnValue,ke.id);wc.g(hd)}}};zb.cCb=function(){zb.fGe(zb.Sk.iEb,zb.Sk.cqd,!1);zb.k3();zb.raiseEvent(Kb.u1a)};zb.bCb=function(){zb.k3();zb.raiseEvent(Kb.u1a)};
zb.aCb=function(){var hd=zb.getElementById(bb(zb.uk,zb.Y$b(zb.Ssb)));if(hd){var ke=zb.Ofd(hd.id);zb.MIa(hd,ke.kBc,ke.returnValue,hd.id)}zb.rbb(null,"");zb.k3();zb.raiseEvent(Kb.u1a)};zb.Kmc=function(hd){return zb.I3e(hd.Ea.target===zb.jE)};zb.zAi=function(hd){wc.g(hd);zb.wIb(!0,null);zb.hideTaskPane()};zb.jGi=function(hd){wc.g(hd)};zb.tla=function(hd){var ke=!0;switch(hd.keyCode){case 32:case 13:zb.cn===zb.fieldList.domElement?ke=zb.fieldList.A$c(hd):zb.cn===zb.QT&&(zb.wIb(!0,null),zb.hideTaskPane())}ke&&
wc.g(hd)};zb.Zk=function(hd){wc.g(hd)};zb.JV=function(hd){var ke=!1;switch(hd.keyCode){case 38:case 40:if(zb.cn===zb.fieldList.domElement)ke=zb.fieldList.A$c(hd);else if(zb.cn!==zb.QT){ke=zb.getElementById(bb(zb.uk,zb.Y$b(zb.Ssb)));var He=zb.Ofd(ke.id);zb.MIa(hd.target,He.kBc,He.returnValue,ke.id);ke=!0}break;case 37:case 39:ke=zb.cn===zb.fieldList.domElement?zb.fieldList.A$c(hd):!0;break;case 32:case 13:ke=!0;break;case 9:ke=zb.I3e(!hd.shiftKey)}ke&&wc.g(hd)};zb.hla=function(){var hd=id.g(zb.$).ha;
hd.Qa.Tmd&&hd.Te&470||id.g(zb.$).inRangePicker||id.g(zb.$).zi||zb.wFb(!0,!0)};zb.Kf=function(){zb.refresh();zb.$.fa.zn.FieldListForceOnTop&&zb.Nvc(!1,null,!0)};zb.Utf=function(){zb.wFb(!0,!0)};zb.od=function(){zb.wFb(!0,!1)};zb.Yh=function(hd,ke){hd=Rc.e(ke.xK)||Rc.e(ke.oa);zb.wFb(!0,hd)};zb.Ms=function(hd,ke){hd=yl(ke.ZLj);for(ke=hd.next();!ke.done;ke=hd.next())zb.X9f(ke.value);zb.xmd&&(zb.xmd=!1,zb.rV||zb.taskPaneManager.xg&&1===zb.taskPaneManager.xg.taskPane.tg||zb.taskPaneManager.WC(zb,!0));zb.wFb(!1,
!0)};zb.Juf=function(hd,ke){id.g(zb.$).Cq||zb.X9f(ke.$c.hash)};zb.PBb=function(){zb.refresh()};zb.Zc=function(){zb.GK()};zb.vq=function(){zb.GK()};zb.cOa=function(){zb.refresh()};zb.nBf=function(){zb.Lga()};zb.Gtf=function(){zb.raiseEvent(Kb.G7b)};zb.Ftf=function(){zb.raiseEvent(Kb.u1a)};zb.$=nb;zb.kg=nb.kg;zb.nk=zb.Nd.VD();zb.taskPaneManager=Wb;zb.taskPaneManager.EB(zb.cOa);zb.Mu=!0;zb.Nnd=qf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableReactFieldListV2",!1);zb.ndf=qf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",
!1)&&qf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotFieldList",!1);zb.rV=Zc.a.Gd(zb.$);zb.Nbe=.5;zb.Mu&&(zb.sia=new ub(zb.$,zb),zb.$.Ka.qTc(zb.Kxf),zb.$.Ka.cFa(zb.Jxf));zb.Mu||(zb.zV=Dc.B_a(la,1E3,null,Ha.Akh,720));zb.wmg=!0;if(zb.DZ||zb.Mu)zb.J7b=400,zb.C9c=400;zb.rV||(la.style.width=ge.HelperMethods.Qb(zb.J7b));Zf.a.equals("rtl",la.dir,!0)&&(zb.fj=!0);zb.LPe=[4,2,1,8];zb.$.Rk(zb.od);la=id.g(zb.$);la.Ca.gq(zb.Juf);la.hT(zb.Ms);fd.a(zb.$).Ca.gq(zb.PBb);la.ha.fG(zb.hla);la.DD(zb.hla);
la.ha.Qa.oAg(zb.Utf);zb.$.xa.Pf(zb.Yh);zb.$.fa.jt(zb.Kf);zb.$.fa.Sj(zb.Zc);zb.$.fa.aP(zb.vq);mh.a(zb.$).$Sc(zb.nBf);bc.a(zb.$).Tg(zb);zb.refresh();return zb}function Eb(){this.valuesWellItems=this.rowsWellItems=this.columnsWellItems=this.filtersWellItems=null}function Hc(){this.id=0;this.name=null}function Xc(){this.searchRestoreValue=null;this.searchWithNoMatch=this.needSearchReset=this.needSearchRestore=!1}function Pc(){this.id=0;this.name=null;this.type=0;this.showSeparator=this.showMenu=this.showCheckBox=
this.canDrag=this.isMoreFields=this.isChecked=this.isCollapsed=this.isCollapsible=!1;this.children=null;this.isBolded=!1}function wd(la,nb,Wb,Dc){this.activeCell=this.additionalInformation=this.pivotData=this.pivotName=null;this.pivotName=la;this.pivotData=nb;this.additionalInformation=Wb;this.activeCell=Dc}function Tc(la,nb,Wb){this.cachedItemIndex=this.cachedSourceAxis=0;this.cachedItemName=null;this.cachedSourceAxis=la;this.cachedItemIndex=nb;this.cachedItemName=Wb}function ub(la,nb){this.$=la;
this.fieldManagerPane=nb}function fb(){this.type=null;this.dataUpdateType=0;this.fieldWellsItems=this.fieldListItems=null;this.isSortAscending=this.isPivotChart=this.isOlap=this.isDataModel=!1;this.focusResetId=this.focusResetType=this.fieldListSizePercentage=this.selectedTab=0;this.onFieldListItemMenuClickV2=this.onFieldWellItemMenuClickV2=this.onFieldCheckedChanged=this.onFieldExpandCollapse=this.onFieldMove=this.onExpandCollapseAll=this.onSortOrderChanged=this.onSelectedTabChanged=this.onSaveFieldListSizePercentage=
null;this.isRichPivotFieldList=!1;this.onSearchInputChanged=this.fieldListSearchInfo=null}function Ta(la,nb,Wb,Dc){var zb=Re.call(this,la)||this;zb.S4c={};zb.n0a={};zb.veb=null;zb.b4a=null;zb.wK=null;zb.fieldListItems=null;zb.Sk=null;zb.mRj=!0;zb.SKb=!1;zb.lH=!1;zb.Xpc=!1;zb.rsi=0;zb.ujc=!1;zb.Ytd=!1;zb.Tq=null;zb.wt=null;zb.y8b=null;zb.uk=null;zb.YIa=!0;zb.Psb="";zb.xPd="";zb.Xvc=!1;zb.yPd=null;zb.dG=-1;zb.scrollTop=0;zb.Twa="";zb.Whc="";zb.Dka="";zb.Qzb="";zb.Rzb="";zb.e5b="";zb.wCb=function(){zb.ujc=
zb.Ytd};zb.Jt=function(){zb.Ytd=!1;zb.ujc=!1};zb.wyi=function(hd){wc.g(hd);zb.hUf()};zb.Nyi=function(hd){wc.g(hd);zb.mUf()};zb.FKi=function(hd){zb.gYa(zb.l3);wc.g(hd)};zb.HKi=function(hd){if(13===hd.keyCode){if(Nb.a.Ykd||Nb.a.twa)wc.g(hd),zb.GMd(hd.target)}else 27===hd.keyCode&&(wc.g(hd),Nb.a.zf||Nb.a.twa?zb.uPf(hd.target):zb.Xvc=!0)};zb.Itj=function(){zb.Xvc?(zb.Xvc=!1,zb.uPf(zb.getElementById("flp_srt_combobox"))):zb.GMd(zb.getElementById("flp_srt_combobox"));zb.yPd=null};zb.GKi=function(hd){wc.g(hd);
Nb.a.zf||Nb.a.twa?zb.GMd(hd.target):zb.yPd||(zb.Xvc=!1,zb.yPd=ae.a.instance.create(zb.Itj,200,Uf.a.Hth,!0,!0))};zb.BGi=function(hd){wc.g(hd);if(!zb.Sk){hd=hd.target;var ke=null,He=null;Ta.cff(hd)&&(He=ka(zb.fieldListItems,hd.id,!0),ke=zb.getElementById(bb(He,"fli_")));if(ke){if(!zb.b4a||zb.b4a.id.localeCompare(ke.id))zb.b4a=ke,zb.hRa(He)?zb.esj(He):zb.fcc()}else zb.fcc(),zb.b4a=null}};zb.xyd=function(hd){wc.g(hd)};zb.AGi=function(){zb.b4a&&(zb.fcc(),zb.b4a=null)};zb.zyd=function(hd){if(!zb.Sk&&!hd.button){var ke=
hd.target;if(ke){var He=Ta.O$b(ke);if(He)zb.k7b(ka(zb.fieldListItems,He.id,!0)),wc.g(hd);else if(ke.id.startsWith("flm_")||ke.id.startsWith("flimtd_"))zb.MIa(hd,ke.parentNode,ka(zb.fieldListItems,ke.id,!0)),wc.g(hd)}}};zb.yyd=function(hd){if(!hd.button){var ke=hd.target;if(ke&&Ta.cff(ke)){var He=ka(zb.fieldListItems,ke.id,!0);zb.uk=He;zb.gYa(zb.ao);wc.g(hd);if(ke.id.startsWith("flb_"))zb.raiseEvent("FieldListChanging"),zb.k7b(He),zb.raiseEvent("FieldListChanged");else if(ke.id.startsWith("flcb_"))zb.raiseEvent("FieldListChanging"),
zb.nve(He),zb.raiseEvent("FieldListChanged");else{var df=Ta.O$b(ke);if(df&&He&&He.CanDrag){zb.Sk&&zb.k3();var kf=zb.host.parentElement,ff=eb.eWe(ge.HelperMethods.LJa(ke,kf),zb.ao,zb.ao.offsetParent.currentStyle,zb.host.isRtl);zb.Sk=new eb(eb.cpb(He,df,ff,ke.offsetWidth),zb.host,He);kf.appendChild(zb.Sk.domElement);zb.Sk.jmb(zb.cCb);zb.Sk.imb(zb.bCb);zb.Sk.Fke(zb.aCb);zb.raiseEvent("FieldListChanging");zb.Sk.ona(hd)}}}}};zb.cCb=function(){zb.host.ydh(zb.Sk.iEb,zb.Sk.cqd);zb.k3();zb.raiseEvent("FieldListChanged")};
zb.bCb=function(){zb.k3();zb.raiseEvent("FieldListChanged")};zb.aCb=function(){zb.Sk.iEb.IsCollapsible&&zb.k7b(zb.Sk.iEb);zb.k3();zb.raiseEvent("FieldListChanged")};zb.host=Wb;zb.$=nb;zb.host.DZ?(zb.Twa='<div id="{0}" class="{1}">{2}</div>',zb.Whc='<div id="{0}" class="{1}" title="{3}">{2}</div>',zb.Dka="ewa-flp-tdnonlabelitem-new",zb.Qzb="ewa-flp-tdnmenulabelitem-new",zb.Rzb='<li id="{0}" class="ewa-flp-listitem"><div direction="{2}" style="width: 100%"><div style="display: flex; align-items: center">{1}</div></div></li>',
zb.e5b='<div id="{0}" class="ewa-flp-spanlabel" title="{3}" {4}><label id="{1}" class="ewa-flp-listitemlabel {2}" style="width:calc(100% - 4px)">{3}</label></div>'):(zb.Twa='<td id="{0}" class="{1}">{2}</td>',zb.Whc='<td id="{0}" class="{1}" title="{3}">{2}</td>',zb.Dka="ewa-flp-tdnonlabelitem",zb.Qzb="ewa-flp-tdnmenulabelitem",zb.Rzb='<li id="{0}" class="ewa-flp-listitem"><table direction="{2}" cellspacing="0" cellPadding="0" style="width: 100%"><tr>{1}</tr></table></li>',zb.e5b='<div id="{0}" class="ewa-flp-spanlabel" title="{3}" {4}><label id="{1}" class="ewa-flp-listitemlabel {2}" style="max-width:{5}">{3}</label></div>');
zb.ao=document.getElementById(Dc+Pd.a.zPe);zb.QHa=document.getElementById(Dc+Pd.a.xPe);zb.bta=document.getElementById(Dc+Pd.a.yPe);zb.TKb=document.getElementById(Dc+Pd.a.DPe);ed.DOMElementExtensions.setVisible(zb.TKb,!1);zb.l3=document.getElementById(Dc+Pd.a.BPe);zb.RHa=document.getElementById(Dc+Pd.a.APe);zb.h0f=document.getElementById(Dc+Pd.a.CPe);ed.DOMElementExtensions.setVisible(zb.l3,!1);zb.Q$=[];Array.add(zb.Q$,zb.QHa);Array.add(zb.Q$,zb.bta);Array.add(zb.Q$,zb.l3);Array.add(zb.Q$,zb.ao);zb.$he=
zb.Nd.Cd(zb.QHa);zb.$he.ja("click",zb.wyi);zb.Nme=zb.Nd.Cd(zb.bta);zb.Nme.ja("click",zb.Nyi);zb.Yvc=zb.Nd.Cd(zb.l3.firstChild);zb.Yvc.ja("change",zb.GKi);zb.Yvc.ja("click",zb.FKi);zb.Yvc.ja("keyup",zb.HKi);zb.v1a=zb.Nd.Cd(zb.ao);zb.v1a.ja("mousedown",zb.yyd);zb.v1a.ja("mouseup",zb.zyd);zb.v1a.ja("mouseover",zb.BGi);zb.v1a.ja("mouseout",zb.AGi);zb.v1a.ja("click",zb.xyd);zb.$.Ka.qTc(zb.wCb);zb.$.Ka.cFa(zb.Jt);return zb}function eb(la,nb,Wb,Dc){var zb=Ff.call(this,la,la,!1,void 0===Dc?null:Dc)||this;
zb.v5b=!1;zb.ZBb=function(hd){zb.v5b=!0;zb.rt(hd)};zb.lA=zb.Nd.ysa();zb.host=nb;zb.mpg=Wb;return zb}function tb(la,nb,Wb){nb&&(nb.classList.remove("ewa-flp-pressedelement"),Wb&&nb.classList.add("ewa-flp-elementWithFocus"));return la?(Wb&&la.classList.remove("ewa-flp-elementWithFocus"),la.classList.add("ewa-flp-pressedelement"),la):null}function rc(la,nb){nb=ge.HelperMethods.Qb(Math.max(0,nb));la=la.style;Zf.a.equals(la.maxWidth,nb,!0)||(la.maxWidth=nb)}function wb(la,nb){return String.format('style="{0}:{1};"',
nb?"margin-right":"margin-left",ge.HelperMethods.Qb(la))}function E(la,nb,Wb){if(la)for(var Dc=0,zb=la.length;Dc<zb;Dc++){var hd=la[Dc];if(hd.ClientId===nb||Wb&&(hd=E(hd.Children,nb,Wb)))return hd}return null}function Mb(la,nb,Wb,Dc){la=yl(la);for(var zb=la.next();!zb.done;zb=la.next())if(zb=zb.value,zb.PivotCacheIndex===nb&&(zb.TypeTag===Wb||!Wb)||Dc&&(zb=Mb(zb.Children,nb,Wb,Dc)))return zb;return null}function ka(la,nb,Wb){if(la)for(var Dc=parseInt(nb.substring(nb.lastIndexOf("_")+1,nb.length)),
zb=0,hd=la.length;zb<hd;zb++){var ke=la[zb];if(ke.ClientId===Dc||Wb&&(ke=ka(ke.Children,nb,Wb)))return ke}return null}function bb(la,nb){return la?nb+la.ClientId:""}function Ga(la,nb,Wb){if(la)for(var Dc=0,zb=la.length;Dc<zb;Dc++){var hd=la[Dc];hd.ClientId=Wb++;hd.ClientParentId=nb;Wb=Ga(hd.Children,hd.ClientId,Wb)}return Wb}function Ha(){}function Ua(){this.nD=0;this.request=null;this.vl=!0}function kb(la){var nb=we.call(this)||this;nb.$=la;nb.dc();return nb}function $a(la,nb,Wb){this.R4=this.Nfc=
!1;this.anchorType=-1;this.confirmationRequiredForDataOps=!1;this.chartId=this.pivotTableName=null;this.ece=-1;this.Ede=1;this.LCa=this.F3d=this.E3d=-1;this.Aqa=null;if(la&&(nb?(this.uN=nb.uN,this.qo=nb.qo):this.qo=Wb,this.GZ=this.Nfc=!1,la.oa)){var Dc=id.g(la);Wb=nb=null;if(Rc.f(la.oa)){var zb=fd.a(la);zb.Yc&&zb.Yc.Attributes&4&&(this.chartId=zb.chartId,nb=zb.Yc)}else Rc.i(la.oa)&&((zb=Dc.ha.Qa.nc)?(Dc=zb.floatingObject)&&!Dc.type&&Dc.Yc&&Dc.Yc.Attributes&4&&(this.chartId=zb.floatingObject.id,nb=
Dc.Yc):Dc.ha.va.activeCell&&(zb=De.a(la).PJa(),Object(Xd.a)(sc.PivotTableRange,zb)&&(Wb=zb)));nb?(this.GZ=!0,this.anchorType=7,this.R4=!!(nb.Attributes&128),this.confirmationRequiredForDataOps=!!(nb.Attributes&64),this.LCa=nb.ExternalSourceIndex,this.wJ=nb.FieldListVersion,this.eQ=nb.FieldWellVersion,nb=this.Aqa={},la.wj(nb),nb.FirstColumn=nb.FirstRow=-1):Wb&&(this.Nfc=!0,this.anchorType=0,this.R4=Wb.isOlap,this.confirmationRequiredForDataOps=Wb.confirmationRequiredForDataOps,this.LCa=Wb.externalSourceIndex,
this.wJ=Wb.Ith,this.eQ=Wb.Pth,this.pivotTableName=Wb.pivotTableName,this.Aqa=rf.o(Wb,la))}}function Xb(la){return $c.call(this,la)||this}function dc(la,nb,Wb){nb||Ac.ULS.sendTraceTag(537162718,0,15,"FieldManagerPane is null on FieldListCommandHandler creation");this.$=la;this.fieldManagerPane=nb;this.fvg=Wb}function Za(la,nb){var Wb=se.call(this)||this;Wb.gridView=null;Wb.callout=null;Wb.nBi=function(Dc){if(Dc.isLoaded){Wb.state=1;Dc=Wb.$;var zb=id.g(Dc);Wb.XHg(zb);Dc.Vl(Wb.qd);Dc.Yz(Wb.aj);zb.Nq(Wb.$Q);
fd.a(Dc).Nq(Wb.K5);Dc.userOperationManager.uy(Wb.WAf);Qc.a.a2(1529658657,ne.a.Gv,0,1);Dc.Ka.b2(Wb)}else Wb.dispose()};Wb.Yxa=function(Dc,zb){Wb.allow&&!zb.u4&&(Dc=Wb.gridView.ha.Te,1===Dc?(Wb.e_c(),Wb.EW()):2!==Dc||Wb.$x.xZ||(Wb.$x.reset(),Wb.wx()))};Wb.Mj=function(){Wb.wx()};Wb.qd=function(){Wb.wx()};Wb.Vc=function(Dc,zb){Wb.callout||Wb.showCallout(3===Dc.zb,zb)};Wb.gxd=function(){Wb.callout.bza(Wb.gxd);Wb.callout=null;Wb.Nh.hide()};Wb.aj=function(){Wb.callout?Wb.wx():Wb.v5a()&&Wb.Nh.hide()};Wb.K5=
function(){3===Wb.state&&(Wb.state=1)};Wb.$Q=function(){3===Wb.state&&(ue.d(Wb.$)?ae.a.instance.create(Wb.p6c,350,Uf.a.GJg,!0,!0):Wb.p6c())};Wb.WAf=function(Dc,zb){(Dc=zb.Sg?zb.Sg.operation:null)&&Dc.flags&4&&(Wb.allow&&!zb.Wx?(Wb.state=3,Wb.wx()):3===Wb.state&&1===zb.Wx&&(zb=Dc.yd?Dc.yd.Errors:null)&&0<zb.length&&Wb.p6c())};Wb.p6c=function(){Wb.state=1;Wb.EW()};Wb.$=la;Wb.state=2;Wb.$x=new Wa(la);Wb.Nh=new Ba(la,Wb.Vc,nb);bc.a(Wb.$).Tg(Wb);pb.a.Rid(la.domElement.ownerDocument,zd.a.current.eo(74),
Wb.nBi);return Wb}function Wa(la){this.fgb=!1;this.LCa=0;this.Aqa=this.OMc=this.NMc=this.Ihb=null;this.$=la;this.reset()}function Ba(la,nb,Wb){var Dc=Af.call(this)||this;Dc.$=la;Dc.Mga=Wb.V2b(la,null,nb,Ad.a.K6b,zd.a.Be(9),gb.a.instance.ea(1143),"BIXPointerDown");return Dc}function db(la,nb,Wb,Dc){var zb=vg.call(this,la,gb.a.instance.ea(1142),!0,4)||this;zb.x$=null;zb.GEc=null;zb.KB=null;zb.zV=null;zb.qT=null;zb.fieldListSelector=null;zb.c6d=!1;zb.LDi=function(hd,ke){if(zb.domElement&&(zb.zV.NRa(),
!Lf.a(hd))){var He=hd.Result;He&&zb.Cxj(He,ke);vg.prototype.Lx.call(zb,hd,null,"")}};zb.Zsj=function(){ed.DOMElementExtensions.av(zb.RZb,gb.a.instance.ea(1144));var hd=zb.Lda.querySelector("."+za.WJe);hd.tabIndex=-1;ed.DOMElementExtensions.setFocus(hd)};zb.c8a=function(){zb.close(1);return!0};zb.domElement.id=la.domElement.id+"_BIExploreCallout";zb.$x=nb;zb.targetElement=Wb;zb.MPf=!1;zb.domElement.classList.remove(zb.rtl?pe.a.v7c:pe.a.u7c);zb.domElement.classList.remove(Ad.a.yu);zb.domElement.classList.add(zb.rtl?
za.Cih:za.Bih);(zb.touchMode=Dc)||zb.domElement.classList.add(za.Aih);zb.Lda.className=za.Fih;zb.Lda.style.backgroundImage="";zb.Dna.className=za.Eih;zb.Zw.parentNode.className=za.WJe;la=zb.Ob;la.className="";nb=String.format('<div id="{0}"class="{1}">{2}</div><div class="{3}"><div id="{4}" class="{5}"></div><div id="{6}" class="{7}"></div></div>',"bix-subtitle",za.Dih,zb.$x.T0h,za.uih,"bix-fieldlistselector",za.Gih,"bix-drilldetails",za.zih);ed.DOMElementExtensions.av(la,nb);zb.RZb=la.lastChild;
zb.dcc();return zb}function Zb(la,nb,Wb,Dc,zb){var hd=Yd.call(this,nb)||this;hd.A_c=0;hd.ixa=new mb.a(!1);hd.ctc=-1;hd.fTf=null;hd.lM=null;hd.nI=null;hd.Vc=function(ff){ff.Sb&&hd.Poc(ff.Sb);return!0};hd.iN=function(ff){!ff.button&&ff.target&&(hd.Poc(ff.target),wc.g(ff))};hd.onDoubleClick=function(ff){if(!ff.button&&ff.target){var Ef=hd.IQe(ff.target);var Qf=Ef.sWb;Ef.returnValue&&(wc.g(ff),(ff=hd.CXe(Qf))&&ff.isCollapsible&&hd.tLb(ff))}};(hd.touchMode=zb)?nc.a.instance.pa(Vd.a.click,hd.domElement,
hd.Vc):(hd.wc.ja("mousedown",hd.iN),hd.wc.ja("dblclick",hd.onDoubleClick));hd.Q0f=!Nb.a.Nei&&!zb;if(la.isChromeRtl){var ke="padding-right:{0}px;";hd.A_c=39}else ke="padding-left:{0}px;",hd.A_c=37;var He=new Lc.a(Dc.ExcludeHierarchies);He.z9.sort(function(ff,Ef){return ff-Ef});var df=-1,kf=null;la=function(){var ff=hd.G7e(Wb.FieldListItems,He,df,kf,Dc.Context);df=ff.Bzb;kf=ff.oe;return ff}().returnValue;if(!la)return hd;1===la.length&&(la=Array.clone(la[0].Children),la.forEach(function(ff){ff.ClientParentId=
-1}));if(!la.length)return hd;hd.fieldListItems=[];la.forEach(function(ff){Array.add(hd.fieldListItems,new Ic(hd,ff,ke,Ad.a.SLe,Ad.a.TLe))});kf||(kf=Zb.nvh(la,Dc.Context.DimensionCaption)||la[0]);hd.oe=hd.ldd(kf.ClientId);hd.tG();return hd}function Jb(la,nb){var Wb=jd.call(this)||this;Wb.k0h=la;Wb.caption=nb;return Wb}function Ic(la,nb,Wb,Dc,zb){var hd=this;this._element=null;this.GI=this.visible=!0;this.fieldListSelector=la;this.VDc=nb.Name||"";this.clientId=nb.ClientId;this.jDa=nb.IsCollapsible;
this.parentId=nb.ClientParentId;this.lpg=nb.PivotCacheIndex;this.type=nb.TypeTag;this.Tag=nb.UserRank;this.U0h=Wb;this.FCe=Dc;this.H6g=zb;this.fieldListSelector.Dyg(this.clientId,this);this.children=[];nb.Children.forEach(function(ke){Array.add(hd.children,new Ic(la,ke,Wb,Dc,zb))})}function uc(la,nb,Wb,Dc,zb,hd){var ke=ib.call(this,nb)||this;ke.I5c=["bix-drill-action-down","bix-drill-action-up","bix-drill-action-to"];ke.v3b=-1;ke.prb=null;ke.nrb=null;ke.orb=null;ke.bua=null;ke.Vc=function(He){for(var df=
ke.domElement,kf=He.target;kf!==df;){if(kf.id.startsWith("bix-drill-action")){ke.drillTo(ke.v3b,kf.id);wc.g(He);break}kf=kf.parentNode}};ke.ezf=function(He,df){He=-1===ke.v3b;var kf=df.k0h;ke.v3b=kf;var ff=null;kf===ke.Xqe.HierarchyId?(ke.gVf(!1),ke.drillUp||ke.drillDown?(ke.hVf(!0),ed.DOMElementExtensions.setVisible(ke.domElement,!0),ff=ke.nrb||ke.prb):ed.DOMElementExtensions.setVisible(ke.domElement,!1)):(ke.hVf(!1),ff=ke.orb,uc.$hj(ff,df.caption,gb.a.instance.ea(1145)),ke.gVf(!0),ed.DOMElementExtensions.setVisible(ke.domElement,
!0));He||ke.sVf(ff)};ke.$=la;ke.$x=Wb;ke.Xqe=Dc.Context;la=Dc.DrillContext;ke.drillUp=la.DrillUp;ke.drillDown=la.DrillDown;ke.Ghd=zb;ke.WI=hd;zb.GBg(ke.ezf);ke.tG();return ke}function za(){}b.r(D);var pb=b(514),cc=b(0),Ac=b(13),ad=b(88),Jd=b(84),Xd=b(408),od=b(74),Je=b(45),bc=b(256),Qd=b(169),Vd=b(12),de=b(852),pe=b(68);za.Bih="ewa-bix-ltr";za.Cih="ewa-bix-rtl";za.Fih="ewa-bix-titlebar";za.Dih="ewa-bix-subtitle";za.Eih="ewa-bix-title";za.WJe="ewa-bix-close";za.OB="clip16x16";za.uih="ewa-bix-body";
za.zih="ewa-bix-drilldetails";za.wih="ewa-bix-DrillButton";za.Aih="ewa-bix-hover";za.xih="ewa-bix-DrillLabel1";za.yih="ewa-bix-DrillLabel2";za.Gih="ewa-bixfl";za.XJe="ewa-bixfl-NoFocus";za.qnf="ms-core-needIEFilter";za.vih="ewa-bix-calloutBackground";za.csb="ewa-ipad";Object(cc.a)(za,"CssClassNames",null,[]);var Ad=b(16),Pd=b(4),Ce=b(81),Jf=b(28),oc=b(232),ed=b(11),wc=b(69),gb=b(14),id=b(20),ib=oc.a;vm(uc,ib);uc.prototype.dispose=function(){this.Ghd&&this.Ghd.B5i(this.ezf);this.I5c=this.prb=this.nrb=
this.orb=this.bua=this.WI=this.drillUp=this.drillDown=this.Xqe=this.$x=this.WI=this.Ghd=this.$=null;ib.prototype.dispose.call(this)};uc.prototype.focus=function(){this.setFocus(!0)};uc.prototype.hasFocus=function(){var la=ed.DOMElementExtensions.co(this.domElement);if(!la)return!1;la=la.id;return!!la&&la.startsWith("bix-drill-action")};uc.prototype.onKeyDown=function(la){var nb=la.keyCode;la=la.shiftKey;if(this.hasFocus()){var Wb=!1;13===nb?(this.drillTo(this.v3b,this.bua.id),Wb=!0):9===nb&&((Wb=
this.hK(!la))||this.fEe());return Wb}return 9===nb?this.setInitialFocus(!la):!1};uc.prototype.setFocus=function(la){return this.hasFocus()?this.hK(la):this.setInitialFocus(la)};uc.prototype.tG=function(){ed.DOMElementExtensions.ro(this.domElement,Pd.a.mYa,null,null);var la='<button id="{0}" class="'+za.wih+'" tabIndex="-1" title="{1}" style="display:none" onkeyup="return false;" onkeypress="return false;" role="menuitem" aria-describedby="{2} {4}"><div id="{2}"class="'+za.xih+'">{3}</div><div id="{4}" class="'+
za.yih+'">{5}</div></button>',nb="";if(this.drillDown){var Wb=gb.a.instance.ea(1147);var Dc=this.drillDown.Caption;var zb=String.format("{0} ({1})",Wb,Dc?Jf.a.$U(Dc):"");Dc=Dc?Jf.a.If(Dc):"";nb+=String.format(la,"bix-drill-action-down",zb,"bixdddl_1",Wb,"bixdddl_2",Dc)}this.drillUp&&(Wb=gb.a.instance.ea(1146),Dc=this.drillUp.Caption,zb=String.format("{0} ({1})",Wb,Dc?Jf.a.$U(Dc):""),Dc=Dc?Jf.a.If(Dc):"",nb+=String.format(la,"bix-drill-action-up",zb,"bixddul_1",Wb,"bixddul_2",Dc));nb+=String.format(la,
"bix-drill-action-to","","bixddtl_1",gb.a.instance.ea(1145),"bixddtl_2","");la=this.domElement;ed.DOMElementExtensions.av(la,nb);this.prb=this.getElementById("bix-drill-action-up");this.nrb=this.getElementById("bix-drill-action-down");this.orb=this.getElementById("bix-drill-action-to");this.wc.ja("click",this.Vc);la.setAttribute(Pd.a.p2,"");ed.DOMElementExtensions.setVisible(la,!1)};uc.prototype.drillTo=function(la,nb){var Wb=this;switch(nb){case "bix-drill-action-up":var Dc=this.drillUp.Id;break;
case "bix-drill-action-down":Dc=this.drillDown.Id;break;case "bix-drill-action-to":Dc=1;break;default:return}id.g(this.$).Dq(!0);this.WI.pWg(function(zb,hd,ke){var He=Wb.$x,df=Wb.$.qa.ta,kf=He.confirmationRequiredForDataOps,ff=Dc;He=Ce.mb(df,He.Pt,He.externalSourceIndex,Wb.$x.jR);He.requiresConfirmation=kf;He.hierarchyId=la;He.levelId=ff;return Ce.i(df,"BixDrill",He,zb,hd,ke,null,0)})};uc.prototype.hK=function(la){var nb=0;if(this.bua)switch(this.bua.id){case "bix-drill-action-down":nb=0;break;case "bix-drill-action-up":nb=
1;break;case "bix-drill-action-to":nb=2}return this.lWf(la?nb+1:nb-1,la)};uc.prototype.fEe=function(){var la=this.bua;la&&(la.blur(),this.domElement.setAttribute(Pd.a.p2,""));this.bua=null};uc.prototype.gVf=function(la){this.orb&&ed.DOMElementExtensions.setVisible(this.orb,la)};uc.prototype.hVf=function(la){this.prb&&ed.DOMElementExtensions.setVisible(this.prb,la);this.nrb&&ed.DOMElementExtensions.setVisible(this.nrb,la)};uc.prototype.sVf=function(la){la!==this.bua&&this.fEe();if(!la)return!1;la.tabIndex=
0;ed.DOMElementExtensions.setFocus(la);this.domElement.setAttribute(Pd.a.p2,la.id);this.bua=la;return!0};uc.prototype.setInitialFocus=function(la){return this.lWf(la?0:this.I5c.length-1,la)};uc.prototype.lWf=function(la,nb){for(var Wb=this.I5c;0<=la&&la<Wb.length;){var Dc=ed.DOMElementExtensions.getElementById(this.domElement,Wb[la]);if(Dc&&ed.DOMElementExtensions.isVisible(Dc))return this.sVf(Dc);la=nb?la+1:la-1}return!1};uc.$hj=function(la,nb,Wb){Wb=String.format("{0} ({1})",Wb,nb);la.setAttribute("title",
Wb);la.lastChild.innerText=nb};Object(cc.a)(uc,"BixDrillDetails",oc.a,[]);var nc=b(276),Nb=b(23),mb=b(32),Lc=b(204),zd=b(51);Ic.prototype.dispose=function(){this.children&&(ad.a.pc(this.children),this.children=null);this._element=null};Ic.prototype.wxe=function(){for(var la=yl(this.children),nb=la.next();!nb.done;nb=la.next())nb=nb.value,nb.visible=!1,nb.jDa&&(nb.GI=!0,nb.nXf(),0<nb.children.length&&nb.wxe())};Ic.prototype.Une=function(la,nb){this.visible=!la;var Wb=11*la,Dc=String.format('aria-labelledby="{0}" aria-selected="false" aria-level="{1}"',
this.yua(Ic.BEf),la+1);this.jDa&&(Dc+=String.format('aria-expanded="false" aria-owns="{0}"',this.yua(Ic.AEf)));this.jDa?(this.GI=!0,Wb=String.format('<div id="{0}" class="ewa-bixfl-Icon" style="{1}"><div class="clip16x16"><img id="{2}" class="{3}" role="{4}" src="{5}"/></div></div>',this.yua(Ic.zEf),this.uXe(Wb+4),this.yua(Ic.OBd),this.FCe,Pd.a.vs,zd.a.Be(9))):Wb=String.format('<div style="{0}"></div>',this.uXe(Wb+23));var zb=String.format('<span id="{0}">{1}</span>',this.yua(Ic.BEf),Jf.a.If(this.VDc));
nb+=String.format('<div id="{0}" class="{1}" tabIndex="-1" title="{2}" role="treeitem" {3}><table cellspacing="0" cellPadding="0" role="presentation"><tr><td style="width: 8px">{4}</td><td>{5}</td></tr></table></div>',this.yua(Ic.K9a),"ewa-bixfl-Item",Jf.a.$U(this.VDc),Dc,Wb,zb);this.jDa&&(++la,nb+=String.format('<div id="{0}" role="group" style="display:none;">',this.yua(Ic.AEf)),this.children.forEach(function(hd){nb=hd.Une(la,nb)}),nb+="</div>");return nb};Ic.prototype.k4b=function(){this.element.blur();
this.element.tabIndex=-1};Ic.prototype.msh=function(){this.children.forEach(function(la){la.visible=!0})};Ic.prototype.JVe=function(la,nb){for(var Wb=this.children,Dc=yl(Wb),zb=Dc.next();!zb.done;zb=Dc.next())if(zb=zb.value,!zb.jDa&&5===zb.type&&zb.Tag>nb&&(la=zb,nb=zb.Tag,3===nb))return{returnValue:la,Zlf:nb};Wb=yl(Wb);for(zb=Wb.next();!zb.done&&(Dc=zb.value,!Dc.jDa||(la=Dc.JVe(la,nb),nb=la.Zlf,la=la.returnValue,3!==nb));zb=Wb.next());return{returnValue:la,Zlf:nb}};Ic.prototype.xQh=function(){for(var la=
this;-1!==la.parentId;)la=this.fieldListSelector.ldd(la.parentId);return la};Ic.prototype.sec=function(la){for(var nb=this;-1!==nb.parentId;){if(la.clientId===nb.parentId)return!0;nb=this.fieldListSelector.ldd(nb.parentId)}return!1};Ic.prototype.setFocus=function(){this.element.tabIndex=0;ed.DOMElementExtensions.setFocus(this.element)};Ic.prototype.nXf=function(){var la=ed.DOMElementExtensions.getElementById(this.element,this.yua(Ic.OBd));if(la){var nb=this.element.nextSibling;ed.DOMElementExtensions.m7(la,
this.GI,this.FCe,this.H6g);this.element.setAttribute(Pd.a.cY,this.GI?Pd.a.pp:Pd.a.rj);ed.DOMElementExtensions.setVisible(nb,!this.GI)}};Ic.prototype.fmj=function(){var la=String.format(".{0}","ewa-bixfl-ItemSelected");la=this.fieldListSelector.domElement.querySelectorAll(la);for(var nb=0;nb<la.length;nb++){var Wb=la[nb];Wb.classList.remove("ewa-bixfl-ItemSelected");Wb.setAttribute(Pd.a.Dga,"false")}this.element.classList.add("ewa-bixfl-ItemSelected");this._element.setAttribute(Pd.a.Dga,"true")};Ic.prototype.tLb=
function(){(this.GI=!this.GI)?this.wxe():this.msh();this.nXf()};Ic.prototype.yua=function(la){return la+this.clientId};Ic.prototype.uXe=function(la){return String.format(this.U0h,la.toString())};tl.Object.defineProperties(Ic.prototype,{caption:{configurable:!0,enumerable:!0,get:function(){return this.VDc}},element:{configurable:!0,enumerable:!0,get:function(){return this._element||(this._element=this.fieldListSelector.getElementById(Ic.K9a+this.clientId))}},OZh:{configurable:!0,enumerable:!0,get:function(){return-1!==
this.parentId}},isCollapsed:{configurable:!0,enumerable:!0,get:function(){return this.GI}},isCollapsible:{configurable:!0,enumerable:!0,get:function(){return this.jDa}},isVisible:{configurable:!0,enumerable:!0,get:function(){return this.visible}},qDf:{configurable:!0,enumerable:!0,get:function(){return this.lpg}}});Ic.zEf="bixflec_";Ic.OBd="bixfleci_";Ic.K9a="bixfli_";Ic.BEf="bixflil_";Ic.AEf="bixflg_";Object(cc.a)(Ic,"BixFieldListItem",null,[3]);var jd=Sys.EventArgs;vm(Jb,jd);Object(cc.a)(Jb,"BixHierarchySelectionChangedEventArgs",
Sys.EventArgs,[]);var ge=b(8),Yd=oc.a;vm(Zb,Yd);Zb.prototype.GBg=function(la){this.get_events().addHandler("SelectionChanged",la)};Zb.prototype.B5i=function(la){this.get_events().removeHandler("SelectionChanged",la)};Zb.prototype.dispose=function(){this.touchMode&&(nc.a.instance.za(Vd.a.click,this.domElement,this.Vc),this.touchMode=!1);this.nI=null;this.fieldListItems&&(ad.a.pc(this.fieldListItems),this.fieldListItems=null);this.ixa=null;Yd.prototype.dispose.call(this)};Zb.prototype.focus=function(){this.setFocus(!0)};
Zb.prototype.Dyg=function(la,nb){this.ixa.add(la.toString(),nb)};Zb.prototype.ldd=function(la){la=la.toString();return this.ixa.wb(la)?this.ixa.getItem(la):null};Zb.prototype.hasFocus=function(){var la=ed.DOMElementExtensions.co(this.nI);return la?(la=la.id)&&la.startsWith(Ic.K9a)&&this.lM?!0:!1:!1};Zb.prototype.onKeyDown=function(la){la=la.keyCode;if(this.hasFocus()){var nb=!1;38===la||40===la?(this.hK(40===la),nb=!0):37===la||39===la?(la=la===this.A_c,nb=this.lM,nb.isCollapsible&&nb.isCollapsed!==
la?this.tLb(nb):la&&nb.OZh&&this.hK(!1),nb=!0):13===la||32===la?((la=this.lM)&&this.select(la),nb=!0):9===la&&this.gEe(!0);return nb}return 9===la?this.lM?this.kda(this.lM):this.setInitialFocus(!0):!1};Zb.prototype.Zgj=function(){this.nI.setAttribute(Pd.a.ipe,"bix-drilldetails")};Zb.prototype.setFocus=function(la){return this.nI.firstChild?this.hasFocus()?this.hK(la):this.lM?this.kda(this.lM):this.setInitialFocus(la):!1};Zb.prototype.start=function(){this.oe&&(this.select(this.oe.xQh()),this.lM&&
this.scroll(this.lM,!0))};Zb.prototype.tG=function(){var la;this.fieldListItems.forEach(function(nb){la=nb.Une(0,la)});this.nI=this.domElement;ed.DOMElementExtensions.av(this.nI,la.toString());ed.DOMElementExtensions.ro(this.nI,Pd.a.kZb,null,null,null);this.nI.setAttribute(Pd.a.Bv,gb.a.instance.ea(1148));this.nI.classList.add(Ad.a.Ir);this.nI.style.position="relative"};Zb.prototype.cLh=function(la){for(;la&&la!==this.nI;){var nb=la.id;if(nb&&nb.startsWith(Ic.K9a))return la;la=la.parentNode}return null};
Zb.prototype.G7e=function(la,nb,Wb,Dc,zb){var hd=this,ke=Wb;if(!la||!la.length)return{returnValue:null,Bzb:Wb,oe:Dc};for(var He=0,df={},kf=0,ff=la.length;kf<ff;df={qO:df.qO},kf++)if(df.qO=la[kf],Zb.Ubi(nb,df.qO))la[kf]=null,++He;else{df.qO.ClientParentId=ke;df.qO.ClientId=++Wb;if(df.qO.IsCollapsible&&(df.qO.Children=function(Ef){return function(){var Qf=hd.G7e(Ef.qO.Children,nb,Wb,Dc,zb);Wb=Qf.Bzb;Dc=Qf.oe;return Qf}}(df)().returnValue,!df.qO.Children)){la[kf]=null;++He;continue}5!==df.qO.TypeTag&&
3!==df.qO.TypeTag||df.qO.PivotCacheIndex!==zb.HierarchyId||(df.qO.UserRank=3,Dc=df.qO)}return He?He===la.length?{returnValue:null,Bzb:Wb,oe:Dc}:{returnValue:Zb.d3i(la),Bzb:Wb,oe:Dc}:{returnValue:la,Bzb:Wb,oe:Dc}};Zb.prototype.gEe=function(la){var nb=this.lM;nb&&(nb.k4b(),this.nI.setAttribute(Pd.a.p2,""));this.k4b();la||(this.lM=null)};Zb.prototype.k4b=function(){this.Q0f&&this.nI.classList.add(za.XJe)};Zb.prototype.hK=function(la){var nb=this.lM;if(!nb)return this.setInitialFocus(la);var Wb=this.ixa.values,
Dc=Wb.length,zb=Array.indexOf(Wb,nb);for(zb=la?++zb:--zb;0<=zb&&zb<Dc;){nb=Wb[zb];if(nb.isVisible)return this.kda(nb),this.scroll(nb,la),!0;zb=la?++zb:--zb}return!1};Zb.prototype.scroll=function(la,nb){var Wb=la.element;la=Wb.offsetHeight;Wb=Wb.offsetTop;var Dc=this.nI,zb=Dc.scrollTop,hd=(Math.floor(Dc.clientHeight/la)-3)*la,ke=Dc.scrollTop;nb?Wb>zb+la+hd&&(ke=Wb-(la+hd)):Wb<zb+la&&(ke=Wb-la);Dc.scrollTop=ke};Zb.prototype.setInitialFocus=function(la){for(var nb=this.ixa.count,Wb=la?0:nb-1;0<=Wb&&
Wb<nb;){var Dc=this.ixa.ag(Wb);if(Dc.isVisible)return this.kda(Dc),this.scroll(Dc,!0),!0;Wb=la?++Wb:--Wb}return!1};Zb.prototype.kda=function(la){this.lM&&la!==this.lM&&this.gEe(!1);if(!la)return!1;this.nI.setAttribute(Pd.a.p2,la.element.id);this.lM=la;-1!==this.ctc&&(la.setFocus(),this.Q0f&&this.nI.classList.remove(za.XJe));return!0};Zb.prototype.IQe=function(la){for(;la&&la!==this.nI;){var nb=la.id;if(nb.startsWith(Ic.K9a))return{returnValue:1,sWb:la};if(nb.startsWith(Ic.zEf)||nb.startsWith(Ic.OBd))return{returnValue:2,
sWb:la};la=la.parentNode}return{returnValue:0,sWb:null}};Zb.prototype.CXe=function(la){if(!la.id||!la.id.startsWith(Ic.K9a)&&(la=this.cLh(la),!la))return null;la=la.id.split("_")[1];return mb.a.Ec(this.ixa.Nu,la)};Zb.prototype.Poc=function(la){var nb=this.IQe(la);la=nb.sWb;if(nb=nb.returnValue)if(la=this.CXe(la))switch(nb){case 2:this.tLb(la);break;case 1:this.select(la)}};Zb.prototype.select=function(la){if(la){la.fmj();this.kda(la);if(la.isCollapsible&&(la=la.JVe(null,-1).returnValue,!la))return;
this.oe=la;this.ctc!==la.qDf&&(this.ctc=la.qDf,this.fTf=la.caption,this.raiseEvent("SelectionChanged",new Jb(this.ctc,this.fTf)),this.hasFocus()||this.k4b())}};Zb.prototype.tLb=function(la){la.tLb();la.isCollapsed&&this.oe&&this.oe.sec(la)&&this.select(la);this.scroll(la,!la.isCollapsed)};Zb.nvh=function(la,nb){la=yl(la);for(var Wb=la.next();!Wb.done;Wb=la.next())if(Wb=Wb.value,11===Wb.TypeTag&&Wb.Name===nb)return Wb;return null};Zb.Ubi=function(la,nb){switch(nb.TypeTag){case 5:case 3:break;default:return!1}return 0<=
ge.HelperMethods.Tw(la,0,la.aja(),nb.PivotCacheIndex,function(Wb,Dc){return Wb-Dc})};Zb.d3i=function(la){for(var nb=null,Wb=0;Wb<la.length;Wb++)la[Wb]&&(nb||(nb=[]),Array.add(nb,la[Wb]));return nb};tl.Object.defineProperties(Zb.prototype,{Zei:{configurable:!0,enumerable:!0,get:function(){return!!this.fieldListItems}}});Object(cc.a)(Zb,"BixFieldListSelector",oc.a,[346]);var rd=b(56),je=b(35),re=b(203),ae=b(44),Uf=b(42),Lf=b(302),Of=b(273),Yf=b(60),vg=de.a;vm(db,vg);db.prototype.Eci=function(la){la=
document.getElementById(la);return ed.DOMElementExtensions.isVisible(la)?(this.x$.setFocus(!0),!0):!1};db.prototype.pWg=function(la){this.GEc=la;id.g(this.$).Dq(!0);this.c6d=!0;this.close(2)};db.prototype.dispose=function(){ad.a.pc([this.KB,this.zV,this.x$,this.fieldListSelector]);this.$x=this.x$=this.fieldListSelector=this.zV=this.KB=null;this.cqc();this.GEc=this.targetElement=this.RZb=null;vg.prototype.dispose.call(this)};db.prototype.takeFocus=function(){this.setFocus()};db.prototype.close=function(la){this.cqc();
vg.prototype.close.call(this,la)};db.prototype.mf=function(la){var nb=this;la=void 0===la?!1:la;je.TaskExtensions.Ba(rd.GetServiceTaskFactory.Xa(this.$.da,12,477,0),function(Wb){nb.MPf||(nb.zV=Wb.result.B_a(nb.Ob,500,null,null,720),nb.zV.jAa())},this.$.ma);return je.TaskExtensions.ts(je.TaskExtensions.Ba(rd.GetServiceTaskFactory.create(this.$.da,84,this.ma,0),function(Wb){nb.KB=Wb.result;nb.KB.init(nb.domElement,nb.targetElement,document.body,nb.$.oa.displayRtl);nb.KB.Vye=8;nb.KB.lne=!0;nb.KB.qEb=
db.hVh();nb.dSc();nb.KB.lm()},this.ma,3),function(){return re.a.prototype.mf.call(nb,la)},this.ma,3,Yf.a.current)};db.prototype.Uw=function(){return this.GEc};db.prototype.Rga=function(){var la=this;return function(nb,Wb,Dc){var zb=la.$.qa.ta;nb=la.Lia(nb);Wb=la.eaa(Wb);var hd=Ce.mb(zb,la.$x.Pt,la.$x.externalSourceIndex,la.$x.jR);return Ce.i(zb,"GetBixAnalysis",hd,nb,Wb,Dc,null,4)}};db.prototype.onShow=function(){this.KB.GJd();vg.prototype.onShow.call(this)};db.prototype.Lx=function(la){var nb=this,
Wb=la.Result;if(la.Errors&&!la.Errors.length&&Wb&&-1===Wb.Context.HierarchyId)this.MPf=!0,this.zV&&this.zV.NRa(),ae.a.instance.create(this.Zsj,1,Uf.a.FJg,!0,!0),vg.prototype.Lx.call(this,la,null,"");else{var Dc=function(zb){zb.qo=0;nb.WKa(169,function(hd,ke,He){var df=nb.$.qa.ta,kf=zb.wJ,ff=zb.uN,Ef=zb.qo;hd=Of.b(hd,nb.LDi);var Qf=Ce.mb(df,zb.Pt,zb.externalSourceIndex,zb.C3g());Qf.type=4;Qf.version=kf;Qf.relatedGroup=ff;Qf.selectedTab=Ef;return Ce.i(df,"GetPivotFieldListData",Qf,hd,ke,He,Wb,4)},16)};
je.TaskExtensions.Ba(rd.GetServiceTaskFactory.create(this.$.da,110,this.ma,0),function(zb){Dc(zb.result)},this.ma,3)}};db.prototype.onKeyDown=function(la){var nb=this.ZTe();if(la.altKey&&85===la.keyCode)this.close(1),wc.g(la);else if(117===la.keyCode&&la.ctrlKey)this.close(1),wc.g(la);else if(nb){for(var Wb=!1,Dc=0;3>Dc&&!Wb;Dc++)2===nb?(Wb=this.fieldListSelector.onKeyDown(la))||(nb=1):1===nb&&((Wb=this.x$.onKeyDown(la))||(nb=2));Wb?wc.g(la):vg.prototype.onKeyDown.call(this,la)}else 13===la.keyCode?
this.close(1):vg.prototype.onKeyDown.call(this,la)};db.prototype.setFocus=function(){(this.x$||this.fieldListSelector)&&this.gHg(this.ZTe())};db.prototype.gHg=function(la){for(var nb=!1,Wb=0;2>Wb&&!nb;Wb++)1===la&&this.x$?(nb=this.x$.setFocus(!0))||(la=2):2===la&&this.fieldListSelector&&((nb=this.fieldListSelector.setFocus(!0))||(la=1))};db.prototype.ZTe=function(){if(!this.fieldListSelector||!this.x$)return 0;var la=this.fieldListSelector.hasFocus(),nb=this.x$.hasFocus();return!la&&!nb||nb?1:2};
db.prototype.Cxj=function(la,nb){var Wb=this.getElementById("bix-fieldlistselector");this.fieldListSelector=new Zb(this.$,Wb,la,nb,this.touchMode);this.fieldListSelector.Zei?(this.RZb.setAttribute(Pd.a.eZb,"true"),Wb=this.getElementById("bix-drilldetails"),this.x$=new uc(this.$,Wb,this.$x,nb,this.fieldListSelector,this),this.fieldListSelector.Zgj(),this.fieldListSelector.start(),this.setFocus(),this.RZb.setAttribute(Pd.a.eZb,"false")):(this.fieldListSelector.dispose(),this.fieldListSelector=null,
ed.DOMElementExtensions.av(this.Ob,gb.a.instance.ea(1144)))};db.prototype.dSc=function(){var la=this.qT=document.createElement("div");ed.DOMElementExtensions.WYb(la);la.classList.add(za.vih);Qd.a.instance.pa(Vd.a.pointerDown,la,this.c8a);this.domElement.ownerDocument.body.appendChild(la)};db.prototype.cqc=function(){this.qT&&(Qd.a.instance.za(Vd.a.pointerDown,this.qT,this.c8a),ed.DOMElementExtensions.Sf(this.qT),this.qT=null)};db.hVh=function(){return db.qEb||(db.qEb=[0,1,4,5])};tl.Object.defineProperties(db.prototype,
{xc:{configurable:!0,enumerable:!0,get:function(){return"BIExploreCallout"}},b9h:{configurable:!0,enumerable:!0,get:function(){return this.c6d}},fsa:{configurable:!0,enumerable:!0,get:function(){return 6}},Cw:{configurable:!0,enumerable:!0,get:function(){return 561}}});db.qEb=null;Object(cc.a)(db,"BIExploreCallout",de.a,[336,235]);var Af=od.a;vm(Ba,Af);Ba.prototype.dispose=function(){this.Mga.dispose();this.$=null;Af.prototype.dispose.call(this)};Ba.prototype.getButton=function(la){return this.Mga.getButton(la)};
Ba.prototype.btj=function(la,nb,Wb,Dc){this.Mga.so(la+this.t0b,nb+this.t0b,Wb,Dc)};Ba.prototype.ctj=function(){var la=id.g(this.$).ha.va.activeCell,nb=id.g(this.$).$a.Kj(la);(la=id.g(this.$).Lg(la,nb))&&0<=la.x&&0<=la.y?this.so(la.bottomRight.x+this.Uy,la.bottomRight.y+this.Uy,id.g(this.$).rtl,nb):this.hide()};Ba.prototype.so=function(la,nb,Wb,Dc){this.Mga.so(la,nb,Wb,Dc)};Ba.prototype.hide=function(){this.Mga.hide()};Ba.prototype.domElement=function(la){return this.Mga.domElement(la)};Ba.prototype.T0a=
function(la){this.Mga.T0a(la)};tl.Object.defineProperties(Ba.prototype,{Uy:{configurable:!0,enumerable:!0,get:function(){return this.Mga.Uy}},t0b:{configurable:!0,enumerable:!0,get:function(){return this.Mga.t0b}}});Object(cc.a)(Ba,"BIExploreLaunchButton",od.a,[]);var rf=b(43);Wa.prototype.reset=function(){this.Ihb="";this.Aqa=this.OMc=this.NMc=null};Wa.prototype.lkj=function(la,nb){this.reset();this.fgb=nb.confirmationRequiredForDataOps;this.LCa=nb.externalSourceIndex;this.OMc=nb.pivotTableName;
this.Aqa=rf.o(la,this.$);la.Rd(nb.aQa)||la.Rd(nb.b$)?(nb=id.g(this.$).sc(la),this.Ihb=Jf.a.If(nb.text)):(la=la.top-nb.top,nb.tJd&&nb.tJd.length>la&&(this.Ihb=nb.tJd[la]))};Wa.prototype.rhj=function(la,nb,Wb){this.reset();this.LCa=nb.ExternalSourceIndex;this.fgb=!!(nb.Attributes&64);this.Ihb=Jf.a.If(Wb.ValueString);this.NMc={};this.jR.ChartId=la;this.jR.AnchorValue2=-1;switch(Wb.Type){case 1:case 2:0<=Wb.CategoryIndex?(this.jR.AnchorType=2,this.jR.AnchorValue1=Wb.CategoryIndex):(this.jR.AnchorType=
1,this.jR.AnchorValue1=Wb.SeriesIndex);break;default:0>Wb.CategoryIndex&&0<=Wb.SeriesIndex?(this.jR.AnchorType=1,this.jR.AnchorValue1=Wb.SeriesIndex):(this.jR.AnchorType=3,this.jR.AnchorValue1=Wb.SeriesIndex,this.jR.AnchorValue2=Wb.CategoryIndex)}this.Aqa={};this.$.wj(this.Pt);this.Pt.FirstRow=-1;this.Pt.FirstColumn=-1};tl.Object.defineProperties(Wa.prototype,{confirmationRequiredForDataOps:{configurable:!0,enumerable:!0,get:function(){return this.fgb}},externalSourceIndex:{configurable:!0,enumerable:!0,
get:function(){return this.LCa}},T0h:{configurable:!0,enumerable:!0,get:function(){return this.Ihb}},xZ:{configurable:!0,enumerable:!0,get:function(){return!!this.jR}},H$e:{configurable:!0,enumerable:!0,get:function(){return!!this.Pt}},jR:{configurable:!0,enumerable:!0,get:function(){return this.NMc}},pivotTableName:{configurable:!0,enumerable:!0,get:function(){return this.OMc}},Pt:{configurable:!0,enumerable:!0,get:function(){return this.Aqa}}});Object(cc.a)(Wa,"BixSelectionContext",null,[]);var Cg=
b(921),sc=b(236),Rc=b(59),Qc=b(307),ee=b(245),ue=b(218),Ee=b(832),De=b(575),ne=b(3),gc=b(105),fd=b(522),vd=b(55),se=od.a;vm(Za,se);Za.prototype.zwe=function(){this.showCallout(!1)};Za.prototype.dispose=function(){this.gridView&&(this.gridView.Nb.pGb(this.Yxa),this.gridView.Kc&&this.gridView.Kc.im(this.Mj));if(this.$){var la=this.$;la.userOperationManager.pz(this.WAf);la.Fn(this.qd);la.RC(this.aj);id.g(la).Us(this.$Q);fd.a(la).Us(this.K5)}ad.a.Fa(this.Nh);this.$x=this.$=this.gridView=this.callout=
this.Nh=null;se.prototype.dispose.call(this)};Za.prototype.Xc=function(la,nb){if(1529658657===nb&&(8===la||!this.$x.H$e))return!0;1247109494!==nb&&-498523270!==nb||this.wx();return!1};Za.prototype.executeCommand=function(la,nb){this.callout?this.wx():(this.scrollIntoView(),this.showCallout(3===nb.method));return vd.Task.Ta(!0)};Za.prototype.Gc=function(la,nb){return 1529658657===nb.command};Za.prototype.fd=function(){return!1};Za.prototype.wx=function(){this.e_c();this.Nh.hide()};Za.prototype.Qe=
function(la,nb){this.callout&&!nb&&this.callout.takeFocus();return!nb};Za.prototype.zh=function(la){return ed.DOMElementExtensions.Ye(this.Jb,la)};Za.prototype.ji=function(){};Za.prototype.Vh=function(){};Za.prototype.VFf=function(la,nb,Wb,Dc,zb){this.$x.reset();if(this.allow&&!Rc.e(this.$.oa))if(Wb&&Wb.Attributes&512&&Dc&&nb){var hd=this.$.XI;this.e_c();this.$x.rhj(nb,Wb,Dc);this.v5a()?(nb=fd.a(this.$).domElement,Wb=ed.DOMElementExtensions.getLocation(nb),Dc=Math.abs(nb.scrollLeft),this.$.isChromeRtl&&
(Sys.Browser.agent===Sys.Browser.Safari&&(Dc=nb.scrollWidth-nb.offsetWidth-Dc),Dc*=-1),la=new Je.a(la.x-Wb.x+Dc,la.y-Wb.y+nb.scrollTop),hd&&(la.x=nb.offsetWidth-la.x)):(nb=this.gridView.fg(zb).view.Ng,la=Ee.a.Yt(nb,this.gridView.fg(zb).domElement,new Sys.UI.Point(Math.round(la.x),Math.round(la.y)),hd));this.Nh.btj(la.x,la.y,hd,zb)}else this.wx()};Za.prototype.XHg=function(la){la&&(this.gridView=la,this.gridView.Nb.smb(this.Yxa),this.gridView.Kc.wm(this.Mj))};Za.prototype.EW=function(){this.iqj()?
this.Nh.ctj():this.Nh.hide()};Za.prototype.iqj=function(){this.$x.reset();if(!this.allow||this.gridView.ha.Qa.nc)return!1;var la=De.a(this.$).PJa();if(Object(Xd.a)(sc.PivotTableRange,la)&&la.supportsBIExplore){var nb=this.gridView.ha.va.activeCell,Wb=this.gridView.sc(nb);if(nb&&Wb&&this.gridView.ha.va.oV){var Dc=nb.left-la.left,zb=nb.top-la.top;if(!(la.FVg&1<<Dc||la.hbj&1<<zb||la.zVg&1<<Dc||la.dbj&1<<zb||Wb.hasAutoFilter)&&(Dc=nb.Rd(la.aQa)||nb.Rd(la.b$),zb=!1,la.aQa&&la.b$?zb=nb.top<la.aQa.top&&
nb.left<la.b$.left||nb.top<la.b$.top:la.b$&&(zb=nb.top<la.b$.top),!Dc&&!zb&&0<Wb.text.length||Dc&&(0<Wb.text.length||Wb.PLa||Wb.C5a)))return this.$x.lkj(nb,la),!0}}return!1};Za.prototype.showCallout=function(la,nb){var Wb=this;nb=void 0===nb?1:nb;De.a(this.$).pu(this.$x.confirmationRequiredForDataOps,function(Dc){Dc&&Wb.$x.H$e&&(Wb.callout=new db(Wb.$,Wb.$x,Wb.Nh.domElement(nb),la),Wb.callout.initialize(),Wb.Nh.T0a(nb),Wb.callout.$O(Wb.gxd),Wb.callout.mf());Wb.Nh.getButton(1).qab()})};Za.prototype.e_c=
function(){this.Nh.getButton(1).qab();this.callout&&!this.callout.b9h&&(this.callout.bza(this.gxd),this.callout.ou(),this.callout=null)};Za.prototype.scrollIntoView=function(){var la=this.gridView.ha;if(1===la.Te){la=la.va.activeCell;var nb=this.gridView.view.visibleArea,Wb=this.gridView.Lg(la);nb&&Wb&&!nb.contains(Wb)&&this.gridView.yt(la,3,gc.a.HJg)}};Za.prototype.v5a=function(){return this.$.fa.isNamedObjectViewMode&&Rc.f(this.$.oa)};Za.ja=function(la,nb){Cg.a(la)||la.da.Ha(2,new Za(la,nb))};tl.Object.defineProperties(Za.prototype,
{Jb:{configurable:!0,enumerable:!0,get:function(){return this.callout?this.callout.domElement:null}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!!this.callout}},Zd:{configurable:!0,enumerable:!0,get:function(){return ee.a.nWc}},MXe:{configurable:!0,enumerable:!0,get:function(){Ac.ULS.shipAssertTag(537170304,8,!id.g(this.$).$a.Zi,"GetLaunchMonocleButton is not supported in freeze pane");return Object(Jd.a)(Sys.UI.Control,this.Nh.getButton(1))}},hYe:{configurable:!0,enumerable:!0,
get:function(){return this.callout}},allow:{configurable:!0,enumerable:!0,get:function(){return this.$.ig.get(6)&&1===this.state&&this.$.lc.n2(135200)}}});Object(cc.a)(Za,"BIExploreManager",od.a,[237,302,100,3,303]);var Jc=b(10),Bc=b(817),Ae=b(96),cb=b(602),mc=b(141),Oc=b(26),Sc=b(175);dc.prototype.Xc=function(la,nb){return(2140436015===nb||-1006032470===nb)&&!(new mc.a(this.fvg)).te(8192)};dc.prototype.executeCommand=function(la,nb,Wb,Dc){la=nb.command;Dc=Dc.gja();switch(la){case 2140436015:case -1006032470:this.fieldManagerPane&&
(this.fieldManagerPane.Nvc(!Ae.f(this.$.kg),nb,!1),Ac.ULS.sendTraceTag(537162717,0,50,"{0} Field List",2140436015===la?"Show":"Hide"));break;case 589118293:case -1687560254:return this.j5b(!0,!1,Dc);case 1176256599:return this.j5b(!1,!1,Dc);case -1751201991:return this.j5b(!0,!0,Dc);case -232434744:return this.j5b(!1,!0,Dc);default:return Sc.a(la)}return vd.Task.Ta(!0)};dc.prototype.Gc=function(la,nb){la=!1;switch(nb.command){case 2140436015:case -1006032470:la=!0;break;case 589118293:case -1687560254:case 1176256599:case -1751201991:case -232434744:la=
!0}return la};dc.prototype.fd=function(){return!1};dc.prototype.j5b=function(la,nb,Wb){var Dc=this,zb=Oc.a.Ra.Kb,hd=id.g(this.$).ha.va.activeCell;return je.TaskExtensions.Ba(rd.GetServiceTaskFactory.Xa(this.$.da,12,477,Wb),function(){De.a(Dc.$).pu(!1,function(ke){if(ke){id.g(Dc.$).Dq(!0);var He=rf.o(hd,Dc.$);Dc.$.ic(-867563466,function(df,kf,ff){return Ce.kb(Dc.$.qa.ta,He,0,!1,!1,!1,la,nb,df,kf,ff,null,null)},zb,0,6,161,function(){return new cb.a(He,nb)})}})},this.$.ma,3)};dc.lqb=function(la,nb,Wb){var Dc=
{};la.wj(Dc);Dc.FirstRow=nb;Dc.FirstColumn=Wb;return Dc};Object(cc.a)(dc,"FieldListCommandHandler",null,[237]);var $c=Bc.a;vm(Xb,$c);Xb.prototype.Md=function(){var la=this;je.TaskExtensions.Ba(rd.GetServiceTaskFactory.Xa(this.$.da,16,74,this.tb),function(nb){la.Ed([new dc(la.$,nb.result,la.$.xa)])},this.ma,3)};Xb.ja=function(la){Bc.a.de(75,new Xb(la))};Object(cc.a)(Xb,"FieldListCommandHandlerFactory",Bc.a,[]);var le=b(216);$a.prototype.C3g=function(){var la={};la.AnchorType=this.anchorType;7===this.anchorType&&
(la.ChartId=this.chartId);la.AnchorValue1=la.AnchorValue2=-1;return la};$a.G2b=function(){return new $a(null,null,-1)};$a.create=function(la,nb,Wb){return new $a(la,nb,Wb)};$a.mef=function(la,nb){return la.D5a!==nb.D5a||la.anchorType!==nb.anchorType||la.chartId!==nb.chartId||la.pivotTableName!==nb.pivotTableName||!!la.Pt&&!!nb.Pt&&la.Pt.SheetName!==nb.Pt.SheetName};$a.Jgi=function(la,nb){return $a.mef(la,nb)||la.uN!==nb.uN||la.qo!==nb.qo};tl.Object.defineProperties($a.prototype,{uN:{configurable:!0,
enumerable:!0,get:function(){return this.ece},set:function(la){this.ece=la}},qo:{configurable:!0,enumerable:!0,get:function(){return this.Ede},set:function(la){this.Ede=la}},wJ:{configurable:!0,enumerable:!0,get:function(){return this.E3d},set:function(la){this.E3d=la}},eQ:{configurable:!0,enumerable:!0,get:function(){return this.F3d},set:function(la){this.F3d=la}},D5a:{configurable:!0,enumerable:!0,get:function(){return this.GZ||this.Nfc}},externalSourceIndex:{configurable:!0,enumerable:!0,get:function(){return this.LCa}},
Pt:{configurable:!0,enumerable:!0,get:function(){return this.Aqa}},sheetName:{configurable:!0,enumerable:!0,get:function(){return this.Pt?this.Pt.SheetName:null}},uHa:{configurable:!0,enumerable:!0,get:function(){return this.chartId+"_"+this.pivotTableName+"_"+this.wJ+"_"+this.eQ}}});Object(cc.a)($a,"FieldListRequestState",null,[332]);var we=le.a;vm(kb,we);kb.prototype.create=function(){var la=$a.create(this.$,null,-1);this.Fb(la)};kb.prototype.dispose=function(){this.$=null;we.prototype.dispose.call(this)};
kb.ja=function(la){la.da.Ha(110,new kb(la))};Object(cc.a)(kb,"FieldListRequestStateFactory",le.a,[]);var jc=b(409),Zc=b(41),ud=b(922),Fd=b(117),me=b(5),$e=b(91),Df=b(47),gg=b(576);Ua.prototype.aof=function(){return this.nD=this.correlationId+1};tl.Object.defineProperties(Ua.prototype,{correlationId:{configurable:!0,enumerable:!0,get:function(){return this.nD}}});Object(cc.a)(Ua,"DataRequestInfo",null,[]);Ha.Akh="ewa-fieldlistloadingindicator-div";Ha.Bkh="ewa-flp-close";Ha.Ckh="ewa-flp-close-hover";
Ha.Dkh="ewa-flp-close-pressed";Ha.Gkh="ewa-flp-dropzoneareamiddleseparator";Ha.CKe="ewa-flp-dropzoneRightColumn";Ha.Hkh="ewa-flp-dropzonespanfiltermenu";Ha.DKe="ewa-flp-listiteminputfiltermenu";Ha.FKe="ewa-flp-spanlabel";Ha.Ekh="ewa-flp-collapseexpand";Ha.Fkh="ewa-flp-draggableitem";Ha.EKe="ewa-flp-selecteditem";Object(cc.a)(Ha,"CssClassNames",null,[]);var og=b(24),dg=b(600),af=b(163),rg=b(1275),cg=b(126),Ie=b(578),Ng=b(1128),Zf=b(19),ng=b(118),Ff=Ng.a;vm(eb,Ff);eb.prototype.imb=function(la){this.addHandler("DragCancelled",
la)};eb.prototype.dGb=function(la){this.removeHandler("DragCancelled",la)};eb.prototype.jmb=function(la){this.addHandler("DragFinished",la)};eb.prototype.eGb=function(la){this.removeHandler("DragFinished",la)};eb.prototype.Fke=function(la){this.addHandler("DragFinishedNoMovement",la)};eb.prototype.nMf=function(la){this.removeHandler("DragFinishedNoMovement",la)};eb.prototype.dispose=function(){ad.a.pc([this.lA]);Ff.prototype.dispose.call(this)};eb.prototype.x7e=function(){this.lA.ja("keydown",this.ZBb);
this.v5b=!1};eb.prototype.drag=function(la,nb){Ff.prototype.drag.call(this,la,nb);this.Zhj()};eb.prototype.isRtl=function(){return this.host.isRtl};eb.prototype.hZe=function(){return this.host.parentElement};eb.prototype.rt=function(la){Ff.prototype.rt.call(this,la);this.lA.kA();this.v5b?(this.v5b=!1,this.raiseEvent("DragCancelled")):this.y4e?this.raiseEvent("DragFinished"):this.raiseEvent("DragFinishedNoMovement")};eb.prototype.k_=function(la){this.rt(ge.HelperMethods.Am(la));return!1};eb.prototype.oK=
function(la){this.drag(!1,ge.HelperMethods.Am(la));return!1};eb.prototype.Zhj=function(){this.domElement.style.cursor=this.host.zdh(this.iEb,this.cqd)?"move":"not-allowed"};eb.cpb=function(la,nb,Wb,Dc){var zb=document.createElement("div");zb.className=Ha.Fkh;zb.style.left=ge.HelperMethods.Qb(Wb.x);zb.style.top=ge.HelperMethods.Qb(Wb.y);zb.style.width=ge.HelperMethods.Qb(Dc);zb.style.fontWeight=nb.currentStyle.fontWeight;zb.style.paddingRight=nb.currentStyle.paddingRight;zb.style.paddingLeft=nb.currentStyle.paddingLeft;
zb.style.textAlign=nb.currentStyle.textAlign;zb.innerHTML=la.Name?Jf.a.If(la.Name):"";zb.id=bb(la,"fldrag_");return zb};eb.eWe=function(la,nb,Wb,Dc){la.y-=nb.scrollTop;Dc&&Nb.a.Af&&(la.x+=parseInt(Wb.right),ng.a.Bwa(nb)&&(la.x+=ng.a.Sp));return la};tl.Object.defineProperties(eb.prototype,{iEb:{configurable:!0,enumerable:!0,get:function(){return this.mpg}}});Object(cc.a)(eb,"FieldListDraggableItem",Ng.a,[]);var be=b(147),Rf=b(92),Re=oc.a;vm(Ta,Re);Ta.prototype.zsc=function(la){la?this.ao.scrollTop=
this.scrollTop:this.scrollTop=this.ao.scrollTop};Ta.prototype.Hhi=function(la){return Df.a.EA(ed.DOMElementExtensions.getBounds(this.ao),la)};Ta.prototype.lJj=function(){this.uk.IsCollapsed=!this.uk.IsCollapsed};Ta.prototype.dispose=function(){ad.a.pc([this.$he,this.Nme,this.Yvc,this.v1a]);this.$&&(this.$.Ka.UGd(this.wCb),this.$.Ka.X$a(this.Jt));this.TKb=this.h0f=this.QHa=this.bta=this.l3=this.RHa=this.ao=this.fieldListItems=this.$=null;this.k3();Re.prototype.dispose.call(this)};Ta.prototype.mAg=
function(la){this.addHandler("FieldListChanging",la)};Ta.prototype.z4i=function(la){this.removeHandler("FieldListChanging",la)};Ta.prototype.lAg=function(la){this.addHandler("FieldListChanged",la)};Ta.prototype.y4i=function(la){this.removeHandler("FieldListChanged",la)};Ta.prototype.z9i=function(la){la&&this.setFocus(!1,!1);return la};Ta.prototype.wHg=function(la){this.fieldListItems&&(this.ccj(),this.fieldListItems=this.uk=this.wt=null);la&&(this.fieldListItems=la.FieldListItems,-1===this.uN&&(this.uN=
la.RelatedGroups&&0<la.RelatedGroups.length?la.RelatedGroups[0].GroupId:-1),this.SKb=la.ShowTabs,this.lH=la.IsPpm,this.Xpc=la.ShowRelatedGroups,this.qo=la.SelectedTab,this.Zki());this.mPf(this.scrollTop,this.Tq!==this.ao||this.ujc?null:this.uk);this.xlj(la?la.RelatedGroups:null,this.uN);la&&(this.emj(),this.host.DZ||this.vab())};Ta.prototype.setFocus=function(la,nb){la?(this.oLf(),nb&&(this.YIa=!0,this.uk=this.Tq=null,this.Psb="")):this.ujc||(this.wK=tb(null,this.wK,this.wK===this.wt),this.uz())};
Ta.prototype.Kab=function(la){this.UKf();return this.zYe(la)};Ta.prototype.UKf=function(){this.Tq===this.bta?this.Tq.classList.remove("ewa-flp-elementWithFocus"):this.Tq===this.ao&&this.XFd()};Ta.prototype.A$c=function(la){var nb=la.keyCode,Wb=!1;38===nb||40===nb?la.altKey?this.wt&&this.Tq===this.ao&&this.hRa(this.uk)&&(nb=this.getElementById(bb(this.uk,"flm_")),this.MIa(la,nb.parentNode,this.uk)):this.Tq===this.ao&&this.wt&&((la=this.kWf(this.fieldListItems,40===nb).mof)&&this.buc(la),Wb=!0):37===
nb||39===nb?this.Tq===this.ao&&this.wt&&this.uk.IsCollapsible&&(this.getElementById(bb(this.uk,"flb_")),this.k7b(this.uk),Wb=!0):32===nb||13===nb?this.Tq===this.QHa?Wb=this.hUf():this.Tq===this.bta?Wb=this.mUf():this.Tq===this.ao&&(Wb=!0,this.wt&&(this.uk.ShowCheckBox&&32===nb?(this.getElementById(bb(this.uk,"flcb_")),this.nve(this.uk)):this.hRa(this.uk)&&13===nb&&(nb=this.getElementById(bb(this.uk,"flm_")),this.MIa(la,nb.parentNode,this.uk)))):9===nb&&(Wb=this.Kab(!la.shiftKey));return Wb};Ta.prototype.ria=
function(la,nb){return la.Name+"_"+la.UniqueName+"_"+la.TypeTag+"_"+(nb||this.Nha)};Ta.prototype.ccj=function(){this.zRf(this.fieldListItems,"");this.n0a[this.Nha+"_fieldWellScrollTop"]=this.ao.scrollTop};Ta.prototype.zRf=function(la,nb){for(var Wb=0,Dc=la.length;Wb<Dc;Wb++){var zb=la[Wb],hd="";if(zb.IsCollapsible||zb.Children)hd=this.ria(zb,nb),zb.IsCollapsible&&(this.S4c[hd]=!!zb.IsCollapsed),zb.Children&&this.zRf(zb.Children,hd);this.uk&&this.uk.ClientId===zb.ClientId&&(this.Psb=hd||this.ria(zb,
nb))}};Ta.prototype.Zki=function(){this.Jhf(this.fieldListItems,"");this.ao&&(this.scrollTop=mb.a.Kn(this.n0a,this.Nha+"_fieldWellScrollTop",0))};Ta.prototype.Jhf=function(la,nb){for(var Wb=0,Dc=la.length;Wb<Dc;Wb++){var zb=la[Wb],hd="";if(zb.IsCollapsible||zb.Children)hd=this.ria(zb,nb),zb.IsCollapsible&&hd in this.S4c&&(zb.IsCollapsed=mb.a.ug(this.S4c,hd)),zb.Children&&this.Jhf(zb.Children,hd);this.Psb&&Zf.a.equals(this.Psb,hd||this.ria(zb,nb),!1)&&(this.uk=zb,this.Psb="")}};Ta.prototype.hRa=function(la){return 7===
la.TypeTag&&this.AQe(this.fieldListItems,la.ClientParentId)?!0:la.ShowFilterArrow||la.ShowCheckBox};Ta.prototype.nJh=function(la){return this.hRa(la)?this.getElementById(bb(la,"flm_")):la.IsCollapsible?this.getElementById(bb(la,"flb_")):la.ShowCheckBox?this.getElementById(bb(la,"flcb_")):this.getElementById(bb(la,"flfimg_"))};Ta.prototype.XFd=function(){this.wt&&this.wt.classList.remove("ewa-flp-elementWithFocus");ed.DOMElementExtensions.setVisible(this.y8b,!1);this.y8b=null};Ta.prototype.buc=function(la){this.XFd();
this.uk=la;la=this.nJh(this.uk);la.id.startsWith("flm_")&&(this.y8b=la,ed.DOMElementExtensions.setVisible(this.y8b,!0));ed.DOMElementExtensions.setFocus(la);this.wt=this.getElementById(bb(this.uk,"fli_"));this.wt.classList.add("ewa-flp-elementWithFocus")};Ta.prototype.mVf=function(){if(!this.fieldListItems||!this.fieldListItems.length)return!1;this.buc(this.uk||this.fieldListItems[0]);return!0};Ta.prototype.kWf=function(la,nb){var Wb=this,Dc;var zb=Dc=null;var hd=!1,ke=la.length;if(0<ke)if(this.uk)for(var He=
{},df=0;df<ke;He={gS:He.gS},df++){He.gS=la[df];nb?He.gS===this.uk&&(hd=!0,zb=Ta.mMa(He.gS)?He.gS.Children[0]:df<la.length-1?la[df+1]:null):Ta.mMa(He.gS)&&this.uk===He.gS.Children[0]?(hd=!0,zb=He.gS):He.gS===this.uk?(hd=!0,0<df&&(zb=Dc)):Dc=He.gS;if(hd)break;if(Ta.mMa(He.gS)){if(function(kf){return function(){var ff=Wb.kWf(kf.gS.Children,nb);zb=ff.mof;Dc=ff.XTi;return ff}}(He)().returnValue){zb?this.buc(zb):nb&&df<la.length-1&&(zb=la[df+1],this.buc(zb));hd=!0;break}Dc||(Dc=He.gS)}}else zb=la[0],hd=
!0;return{returnValue:hd,mof:zb,XTi:Dc}};Ta.prototype.zYe=function(la){if(this.YIa){this.YIa=!1;this.dG=la?0:this.Q$.length-1;var nb=this.Q$[this.dG]}else this.dG=la?this.dG+1:this.dG-1,nb=0<=this.dG&&4>this.dG?this.Q$[this.dG]:null;this.Tq=nb;if(!nb)return this.YIa=!0,!1;la=this.mWf(la);this.YIa=!la;return la};Ta.prototype.mWf=function(la){if(!ed.DOMElementExtensions.isVisible(this.Q$[this.dG])){this.dG=la?this.dG+1:this.dG-1;if(0>this.dG||4<=this.dG)return!1;this.Tq=this.Q$[this.dG];return this.mWf(la)}return 3!==
this.dG?this.uz():this.mVf()};Ta.prototype.uz=function(){!this.Tq&&this.YIa&&this.zYe(!0);if(this.Tq===this.ao)return this.mVf();ed.DOMElementExtensions.setFocus(this.Tq===this.QHa?this.getElementById("flp_activeTab"):this.Tq===this.bta?this.getElementById("flp_allTab"):this.Tq===this.l3?this.getElementById("flp_srt_combobox"):null);return!0};Ta.prototype.oLf=function(){this.Tq===this.ao&&this.XFd()};Ta.prototype.MIa=function(la,nb,Wb){if(Wb&&this.hRa(Wb)){var Dc={};this.wK=tb(this.getElementById(bb(Wb,
"fli_")),this.wK,this.wK===this.wt);if(Wb.ShowFilterArrow||7===Wb.TypeTag){var zb=-1065117584;Dc.pivotName=this.host.pivotName;Dc.domElement=nb;nb=ed.DOMElementExtensions.getBounds(la.target);nb=new Sys.UI.Point(nb.x,nb.y);Dc.location=nb;nb={};this.host.chartId?(nb.AnchorType=Wb.IsChecked?8:10,nb.ChartId=this.host.chartId):nb.AnchorType=Wb.IsChecked?9:11;if(7!==Wb.TypeTag)nb.AnchorValue1=Wb.PivotCacheIndex,nb.AnchorValue2=-1;else{var hd=0<=Wb.ClientParentId?E(this.fieldListItems,Wb.ClientParentId,
!0):null;nb.AnchorValue1=hd.PivotCacheIndex;nb.AnchorValue2=Wb.PivotCacheIndex}Dc.cell=this.host.Pt;Dc.dataSourceIndex=this.host.externalSourceIndex;Dc.requiresConfirmation=this.host.confirmationRequiredForDataOps;Dc.optionalPivotMenuAnchorParameter=nb}else zb=330754562,Dc.fieldItem=Wb,Dc.versionkey=this.host.uHa;Dc.isChart=!!this.host.chartId;Dc.isPpm=this.lH;Dc.rawEvent=la.rawEvent;Dc.objectVersion=this.rsi++;la=new Rf.a(zb,0,this.$.ed,30,null);var ke;this.Ytd=!be.a(ke=this.$.Ka.Zb(la,Dc))&&(6!==
ke.status||ke.result)}};Ta.prototype.nve=function(la){if(null===la||void 0===la?0:la.ShowCheckBox)this.host.hff(la,!la.IsChecked),this.uk=la};Ta.prototype.k7b=function(la){if(null===la||void 0===la?0:la.IsCollapsible)5===la.TypeTag&&la.IsCollapsed&&!la.Children.length?(this.host.h7b(),this.gYa(this.ao)):(la.IsCollapsed=!la.IsCollapsed,this.mPf(this.ao.scrollTop,la))};Ta.prototype.cSh=function(la){return 11===la.TypeTag?this.lH?1===this.qo?Ad.a.Bnh:Ad.a.Cnh:Ad.a.ynh:19===la.TypeTag?Ad.a.Gnh:29===la.TypeTag?
Ad.a.RLe:31===la.TypeTag?Ad.a.RLe:2===la.Image?la.IsCollapsed?Ad.a.znh:Ad.a.Anh:23===la.TypeTag?la.IsCollapsed?Ad.a.Hnh:Ad.a.Inh:13===la.TypeTag?la.IsCollapsed?Ad.a.Dnh:Ad.a.Enh:""};Ta.prototype.mPf=function(la,nb){var Wb=this.fieldListItems?String.format('<ul id="{0}" class="ewa-flp-unorderedlist">{1}</ul>',"flullist",this.L2b(this.fieldListItems).returnValue):"";Wb?(this.ao.innerHTML=Wb,0<la&&(this.ao.scrollTop=la),nb&&(this.uk=nb,this.gYa(this.ao))):this.ao.innerHTML=""};Ta.prototype.L2b=function(la){var nb=
!1;var Wb="";if(la)for(var Dc=this.ao.scrollWidth-42,zb=zd.a.Be(9),hd=0,ke=la.length;hd<ke;hd++){var He=la[hd],df="";if(Ta.mMa(He)){df=this.L2b(He.Children);var kf=df.M3a;df=df.returnValue;He.ShowCheckBox||(He.IsChecked=kf)}He.IsChecked&&(nb=!0);kf="";var ff=He.Name?Jf.a.If(He.Name):"",Ef=16*Math.max(0,He.InternalMargin),Qf="",Vg="",Kg="",yh=1,fh=0;if(He.IsCollapsible){var If=Ta.sdd(He,Ef,yh);fh+=If+16;Qf=String.format('<div class="clip16x16" {4}><input id="{0}" class="{1}" title="{2}" alt="{2}" type="image" src="{3}" tabindex="0" role="tree" aria-expanded="{5}"/></div>',
bb(He,"flb_"),Ha.Ekh+(He.IsCollapsed?" "+Ad.a.SLe:" "+Ad.a.TLe),gb.a.instance.ea(1130)+" "+ff,zb,wb(If,this.host.isRtl),He.IsCollapsed?Pd.a.pp:Pd.a.rj);++yh}var eh=this.cSh(He);eh&&(If=1===yh?Ef:0,fh+=If+16,Vg=String.format('<div class="clip16x16" {4}><img id="{0}" class="{2}" title="{1}" alt="{1}" src="{3}"/></div>',bb(He,"flimg_"),ff,eh,zb,wb(If,this.host.isRtl)),++yh);if(He.ShowCheckBox){var Qh=bb(He,"flldiv_flcb_");If=Ta.sdd(He,Ef,yh);fh+=If+16;Kg=String.format('<div id="{1}" {3}><input id="{0}" class="ewa-flp-checkbox" type="checkbox" {2} tabindex="0"/></div>',
bb(He,"flcb_"),Qh,He.IsChecked?'checked="checked"':"",wb(If,this.host.isRtl));++yh}If=Ta.sdd(He,Ef,yh);fh+=If+10;var xi=bb(He,"flldiv_fll_"),Ca=bb(He,"fll_flt_");Ef=bb(He,"flldiv_flfimg_");Ef=(Qh=9===He.FilterImage)?String.format('<div id="{1}" class="clip16x16"><img id="{0}" class="{3}" title="{2}" alt="{2}" src="{4}"/></div>',bb(He,"flfimg_"),Ef,gb.a.instance.ea(1129),Ad.a.uIa,zb):String.format('<div id="{1}" class="clip1x1 ewa-flp-listitemdivblankimage"><img id="{0}" class="{2}" src="{3}" role="presentation"/></div>',
bb(He,"flfimg_"),Ef,Ad.a.Fnh,zb);var ra=bb(He,"flldiv_flm_");ra=String.format('<div id="{1}" class="clip5x3 ewa-flp-listitemdivfiltermenu"><input id="{0}" class="{3}" type="image" title="{2}" alt="{2}" src="{4}" style="visibility: hidden; display: none;" tabindex="0" role="{5}" {6}/></div>',bb(He,"flm_"),ra,ff,Ad.a.PLe+" "+Ha.DKe,zb,He.ShowCheckBox?Pd.a.TGg:Pd.a.mYa,He.ShowCheckBox?Pd.a.hpe+'="'+(He.IsChecked?Pd.a.rj:Pd.a.pp)+'"':"");if(3===yh){yh=bb(He,"flitd_eci_");var yb=bb(He,"flitd_"+(eh?"simg_":
"cb_"));kf+=String.format(this.Twa,yh,this.Dka,Qf)+String.format(this.Twa,yb,this.Dka,eh?Vg:Kg)}else 2===yh&&(Vg=bb(He,"flitd_"+(He.IsCollapsible?"eci_":"cb_")),kf+=String.format(this.Twa,Vg,this.Dka,He.IsCollapsible?Qf:Kg));Kg=bb(He,"flitd_l_");Qf=bb(He,"flitd_fi_");Vg=bb(He,"flimtd_");this.host.DZ?(If=String.format(this.e5b,xi,Ca,He.IsChecked?Ha.EKe:"",ff,wb(If,this.host.isRtl)),kf+=String.format('<div id="{0}" style="width:calc(100% - {2})">{1}</div>',Kg,If,ge.HelperMethods.Qb(26+fh)),fh=Qh?this.Dka+
" ewa-flp-tdautomarginitem":this.Dka,If=Qh?this.Qzb:this.Qzb+" ewa-flp-tdautomarginitem",kf+=String.format(this.Twa,Qf,fh,Ef)+String.format(this.Whc,Vg,this.hRa(He)?If:fh,ra,ff)):(If=String.format(this.e5b,xi,Ca,He.IsChecked?Ha.EKe:"",ff,wb(If,this.host.isRtl),ge.HelperMethods.Qb(Math.max(0,Dc-fh))),kf+=String.format(this.Twa,Kg,"",If)+String.format(this.Twa,Qf,this.Dka,Ef)+String.format(this.Whc,Vg,this.hRa(He)?this.Qzb:this.Dka,ra,ff));kf=String.format(this.Rzb,bb(He,"fli_"),kf,this.host.isRtl?
"rtl":"ltr");Wb+=kf+df;if(He.ShowSeparator)Wb+='<div class="ewa-flp-tableseparator"></div>';else if(11===He.TypeTag||19===He.TypeTag||29===He.TypeTag||13===He.TypeTag)Wb+='<div class="ewa-flp-dimensionseparator"></div>'}return{returnValue:Wb,M3a:nb}};Ta.prototype.gYa=function(la){this.oLf();this.dG=Array.indexOf(this.Q$,la);this.YIa=!1;this.Tq=la;this.host.hasFocus(this);return this.uz()};Ta.prototype.hUf=function(){this.qo=1;this.host.bSd();this.Auc();return this.gYa(this.QHa)};Ta.prototype.mUf=
function(){this.qo=0;this.host.bSd();this.Auc();return this.gYa(this.bta)};Ta.prototype.GMd=function(la){if(la){la=la.getElementsByTagName("option");for(var nb=0,Wb=la.length;nb<Wb;++nb){var Dc=la[nb];if(Dc.selected){la=parseInt(Dc.id.substring(6,Dc.id.length));la!==this.uN&&(this.ao.scrollTop=0,this.uN=la,this.host.Jtj());break}}}};Ta.prototype.uPf=function(la){if(la)for(var nb=la.getElementsByTagName("option"),Wb=0,Dc=nb.length;Wb<Dc;++Wb){var zb=nb[Wb];zb.selected=parseInt(zb.id.substring(6,zb.id.length))===
this.uN;zb.selected&&(la.selectedIndex=Wb,la.title=zb.text)}};Ta.prototype.esj=function(la){if(this.veb){if(!this.veb.id.localeCompare(bb(la,"flm_")))return;this.fcc()}(la=this.getElementById(bb(la,"flm_")))&&!ed.DOMElementExtensions.isVisible(la)&&(ed.DOMElementExtensions.setVisible(la,!0),this.veb=la)};Ta.prototype.fcc=function(){this.Tq===this.ao&&void 0!==this.Tq.ownerDocument.activeElement&&null!==this.Tq.ownerDocument.activeElement&&void 0!==this.Tq.ownerDocument.activeElement.id&&null!==this.Tq.ownerDocument.activeElement.id&&
this.Tq.ownerDocument.activeElement.id.startsWith("flm_")&&this.veb===this.Tq.ownerDocument.activeElement||(ed.DOMElementExtensions.setVisible(this.veb,!1),this.veb=null)};Ta.prototype.k3=function(){if(this.Sk){var la=this.host.parentElement;la.removeChild(this.Sk.domElement);this.Sk.dGb(this.bCb);this.Sk.eGb(this.cCb);this.Sk.nMf(this.aCb);ad.a.pc([this.Sk]);this.Sk=null;la.style.cursor="default"}};Ta.prototype.Auc=function(){var la=ed.DOMElementExtensions.getElementById(this.QHa,"flp_activeTab"),
nb=ed.DOMElementExtensions.getElementById(this.bta,"flp_allTab");ed.DOMElementExtensions.toggleCssClass(la,"ewa-flp-buttontab-selected",1===this.qo);ed.DOMElementExtensions.toggleCssClass(nb,"ewa-flp-buttontab-selected",!this.qo)};Ta.prototype.emj=function(){ed.DOMElementExtensions.isVisible(this.TKb)!==this.SKb&&ed.DOMElementExtensions.setVisible(this.TKb,this.SKb);ed.DOMElementExtensions.isVisible(this.l3)!==this.Xpc&&ed.DOMElementExtensions.setVisible(this.l3,this.Xpc);this.RHa.innerHTML=this.Xpc?
gb.a.instance.ea(1128):gb.a.instance.ea(1127);if(this.host.DZ)this.SKb&&this.Auc();else{var la=this.h0f.offsetHeight+10;this.SKb&&(la+=this.TKb.offsetHeight,this.Auc());la=ge.HelperMethods.Qb(la);Zf.a.equals(this.ao.style.top,la,!0)||(this.ao.style.top=la)}};Ta.prototype.xlj=function(la,nb){var Wb=this.l3.firstChild;Wb.innerHTML=Wb.title="";for(var Dc=0;la&&Dc<la.length;Dc++)if(nb===la[Dc].GroupId){Wb.title=la[Dc].GroupName;break}for(Dc=0;la&&Dc<la.length;Dc++){var zb=document.createElement("option");
zb.text=la[Dc].GroupName;zb.id="flsrt_"+la[Dc].GroupId;zb.selected=la[Dc].GroupId===nb;Nb.a.Af?Wb.add(zb):Wb.appendChild(zb)}};Ta.prototype.AQe=function(la,nb){var Wb=null;la=yl(la);for(var Dc=la.next();!Dc.done;Dc=la.next()){Wb=Dc.value;if(Wb.ClientId===nb)break;if(Wb=this.AQe(Wb.Children,nb))break}return Wb};Ta.prototype.vab=function(){this.xPd||(this.xPd=this.RHa.currentStyle.maxWidth?this.RHa.currentStyle.maxWidth:"190px");ed.DOMElementExtensions.isVisible(this.l3)?(this.RHa.style.maxWidth=this.xPd,
this.l3.style.width=ge.HelperMethods.Qb(Math.max(0,this.ao.offsetWidth-(this.RHa.offsetWidth+10)))):this.RHa.style.maxWidth=ge.HelperMethods.Qb(this.ao.offsetWidth)};Ta.xHg=function(la,nb,Wb,Dc){Dc=la.Ib+Dc;var zb=ed.DOMElementExtensions.getElementById(Wb,Dc+Pd.a.t9c);return zb?new Ta(zb,la,nb,Dc):Ta.A1g(la,nb,Wb,Dc)};Ta.A1g=function(la,nb,Wb,Dc){var zb=Dc+Pd.a.zPe;if(nb.DZ){var hd='<div ID="{0}" class="ewa-flp-fieldlist-new">';var ke='<div class="ewa-flp-tabstable-new" ID="{4}" direction="{8}"><div ID="{0}" class="ewa-flp-divtabs"><input ID="{5}" type="button" value="{1}" class="ewa-flp-buttontab" area-controls="{7}" tabindex="0"/></div><div class="ewa-flp-tabsseparator-new">&nbsp;</div><div ID="{2}" class="ewa-flp-divtabs"><input ID="{6}" type="button" value="{3}" class="ewa-flp-buttontab" area-controls="{7}" tabindex="0"/></div></div>';
var He='<div ID="{3}" direction="{6}" style="display: flex; flex-wrap: wrap; margin-bottom: 4px;"><div ID="{1}" class="ewa-flp-divshowrelatedtolabel-new">{2}</div><div class="ewa-flp-showrelatedtoseparator">&nbsp;</div><div ID="{0}" class="ewa-flp-divshowrelatedto"><select id="{4}" class="ewa-flp-showrelatedtocombobox" area-controls="{5}" tabindex="0"></select></div></div>';var df='<div ID="{0}" class="ewa-flp-fieldwell-new ewa-scrollbars"></div>'}else hd='<div ID="{0}" class="ewa-flp-fieldlist">',
ke='<table class="ewa-flp-tabstable" ID="{4}" direction="{8}" cellspacing="0" cellPadding="0"><tr><td><div ID="{0}" class="ewa-flp-divtabs"><input ID="{5}" type="button" value="{1}" class="ewa-flp-buttontab" area-controls="{7}" tabindex="0"/></div></td><td style="padding-left: 2px; padding-right: 2px;"><div class="ewa-flp-tabsseparator">&nbsp;</div></td><td><div ID="{2}" class="ewa-flp-divtabs"><input ID="{6}" type="button" value="{3}" class="ewa-flp-buttontab" area-controls="{7}" tabindex="0"/></div></td></tr></table>',
He='<table ID="{3}" direction="{6}" cellspacing="0" cellPadding="0"><tr><td><div ID="{1}" class="ewa-flp-divshowrelatedtolabel">{2}</div></td><td><div class="ewa-flp-showrelatedtoseparator">&nbsp;</div></td><td><div ID="{0}" class="ewa-flp-divshowrelatedto"><select id="{4}" class="ewa-flp-showrelatedtocombobox" area-controls="{5}" tabindex="0"></select></div></td></tr></table>',df='<div ID="{0}" class="ewa-flp-fieldwell ewa-scrollbars"></div>';zb=String.format(hd,Dc+Pd.a.t9c)+String.format(ke,Dc+
Pd.a.xPe,gb.a.instance.ea(1125),Dc+Pd.a.yPe,gb.a.instance.ea(1126),Dc+Pd.a.DPe,"flp_activeTab","flp_allTab",zb,nb.isRtl?"rtl":"ltr")+String.format(He,Dc+Pd.a.BPe,Dc+Pd.a.APe,gb.a.instance.ea(1128),Dc+Pd.a.CPe,"flp_srt_combobox",zb,nb.isRtl?"rtl":"ltr")+String.format(df,zb)+"</div>";Wb.innerHTML=zb+Wb.innerHTML;return(Wb=ed.DOMElementExtensions.getElementById(Wb,Dc+Pd.a.t9c))?new Ta(Wb,la,nb,Dc):null};Ta.mMa=function(la){return la.IsCollapsible&&!la.IsCollapsed&&!!la.Children&&0<la.Children.length};
Ta.sdd=function(la,nb,Wb){return 1!==Wb?0:la.InternalMargin?la.IsCollapsible?nb+2:la.ShowCheckBox?nb+18:nb+-2:nb};Ta.cff=function(la){return la&&la.id?la.id.startsWith("flitd_")||la.id.startsWith("flimtd_")||la.id.startsWith("fll_")||la.id.startsWith("flb_")||la.id.startsWith("flcb_")||la.id.startsWith("flldiv_")||la.id.startsWith("flm_")||la.id.startsWith("flimg_")||la.id.startsWith("fli_")||la.id.startsWith("flfimg_"):!1};Ta.O$b=function(la){return la.id.startsWith("fll_")?la:la.id.startsWith("flitd_")?
(la=la.getElementsByTagName("label")[0])&&la.id.startsWith("fll_")?la:null:null};tl.Object.defineProperties(Ta.prototype,{uN:{configurable:!0,enumerable:!0,get:function(){return mb.a.Kn(this.n0a,this.Nha+"_fieldWellRelatedGroupId",-1)},set:function(la){this.n0a[this.Nha+"_fieldWellRelatedGroupId"]=la}},qo:{configurable:!0,enumerable:!0,get:function(){return mb.a.Kn(this.n0a,this.Nha+"_fieldWellSelectedTabId",1)},set:function(la){this.n0a[this.Nha+"_fieldWellSelectedTabId"]=la}},Nha:{configurable:!0,
enumerable:!0,get:function(){return(this.host.pivotName||"")+(this.host.chartId||"")}}});Object(cc.a)(Ta,"FieldList",oc.a,[]);var Ze=b(187),hg=b(1296),Bg=b(80),qh=b(869);Object(cc.a)(fb,"FieldListTaskPaneProps",null,[]);ub.prototype.tF=function(la){var nb=this;Ze.UISurfaces.Hk().then(function(Wb){Wb.showTaskPane("FieldListTaskPane",nb.Lv(la,-1,null,null,!1,-1,!1,0,-1,!1,null));return null})};ub.prototype.Bw=function(la,nb,Wb,Dc,zb,hd,ke,He,df,kf,ff){var Ef=this;Ze.UISurfaces.Hk().then(function(Qf){Qf.updateTaskPane("FieldListTaskPane",
Ef.Lv(la,nb,Wb,Dc,zb,hd,ke,He,df,kf,ff));return null})};ub.prototype.Aza=function(){Ze.UISurfaces.Hk().then(function(la){la.setSelectedTaskPane("FieldListTaskPane");return null})};ub.prototype.xM=function(){Ze.UISurfaces.Hk().then(function(la){la.hideTaskPane("FieldListTaskPane",2);return null})};ub.prototype.Lv=function(la,nb,Wb,Dc,zb,hd,ke,He,df,kf,ff){var Ef=this;nb=Object.assign(new fb,{type:"FieldListTaskPaneProps",fieldListItems:Wb,fieldWellsItems:Dc,dataUpdateType:nb,isDataModel:zb,selectedTab:hd,
isSortAscending:ke,focusResetType:He,focusResetId:df,isRichPivotFieldList:kf,fieldListSearchInfo:ff,isOlap:this.fieldManagerPane.R4,isPivotChart:this.fieldManagerPane.GZ,fieldListSizePercentage:this.fieldManagerPane.sYi,onFieldExpandCollapse:Object(Bg.a)(this.fieldManagerPane,this.fieldManagerPane.oYi,"reactExpandCollapseItem"),onExpandCollapseAll:Object(Bg.a)(this.fieldManagerPane,this.fieldManagerPane.nYi,"reactExpandCollapseAllItems"),onFieldCheckedChanged:Object(Bg.a)(this.fieldManagerPane,this.fieldManagerPane.xYi,
"reactItemCheckedChanged"),onFieldListItemMenuClickV2:Object(Bg.a)(this.fieldManagerPane,this.fieldManagerPane.qYi,"reactFieldListItemMenuClicked"),onSortOrderChanged:Object(Bg.a)(this.fieldManagerPane,this.fieldManagerPane.iYi,"reactChangePivotFieldListSortOrder"),onSaveFieldListSizePercentage:Object(Bg.a)(this.fieldManagerPane,this.fieldManagerPane.RYi,"reactSaveFieldListSizePercentage"),onSearchInputChanged:Object(Bg.a)(this.fieldManagerPane,this.fieldManagerPane.rYi,"reactFieldListSearchChange"),
onSelectedTabChanged:function(Qf){Ef.fieldManagerPane.jYi(Qf)},onFieldMove:function(Qf,Vg,Kg,yh){Ef.fieldManagerPane.AYi(Qf,Vg,Kg,yh)},onFieldWellItemMenuClickV2:function(Qf,Vg,Kg,yh){Ef.fieldManagerPane.tYi(Qf,Vg,Kg,yh)}});if(Zc.a.Gd(this.$))return Object.assign(new hg.a,{contentProps:nb,onOpen:function(){Ef.fieldManagerPane.Lxf()},onClose:function(){Ef.fieldManagerPane.CIi()},onManualClose:function(){Ef.fieldManagerPane.DIi()},title:this.fieldManagerPane.GZ?gb.a.instance.ea(1133):gb.a.instance.ea(1132),
width:400,enableResize:!0,minResizeWidth:400,maxResizeWidth:950});la=Object.assign(new qh.a,{type:"ExcelLegacyTaskPaneProps",container:la,paneProps:nb});return Object.assign(new hg.a,{contentProps:la,onOpen:function(){Ef.fieldManagerPane.Lxf()}})};Object(cc.a)(ub,"FieldListReactTaskPane",null,[353]);Object(cc.a)(Tc,"MacroRecorderPivotTablePivotedAdditionalInformation",null,[]);wd.prototype.getActiveCell=function(){return this.activeCell};Object(cc.a)(wd,"MacroRecorderPivotTablePivotedPayload",null,
[116]);var Zg=b(27),qf=b(1),mh=b(64),Pa=b(826);Object(cc.a)(Pc,"FieldListItem",null,[]);Object(cc.a)(Xc,"FieldListSearchInfo",null,[]);Object(cc.a)(Hc,"FieldWellItem",null,[]);Object(cc.a)(Eb,"FieldWellsItems",null,[]);var qb=b(63),tc=oc.a;vm(Kb,tc);Kb.prototype.hG=function(la){this.get_events().addHandler(Kb.IPe,la)};Kb.prototype.MH=function(la){this.get_events().removeHandler(Kb.IPe,la)};Kb.prototype.EB=function(la){this.addHandler(Kb.qsb,la)};Kb.prototype.UC=function(la){this.removeHandler(Kb.qsb,
la)};Kb.prototype.Kke=function(la){this.addHandler(Kb.G7b,la)};Kb.prototype.qMf=function(la){this.removeHandler(Kb.G7b,la)};Kb.prototype.Jke=function(la){this.addHandler(Kb.u1a,la)};Kb.prototype.pMf=function(la){this.removeHandler(Kb.u1a,la)};Kb.prototype.D_f=function(la){this.cA&&(!this.Mu&&this.bsa?ed.DOMElementExtensions.setVisible(this.bsa,la):this.n6&&ed.DOMElementExtensions.setVisible(this.n6,la))};Kb.prototype.Xv=function(){this.D_f(!1);this.domElement.classList.remove(this.$.isChromeRtl?Kb.GPe:
Kb.FPe);this.domElement.style.width=ge.HelperMethods.Qb(this.C9c);this.domElement.classList.add(Kb.tRe);this.vab()};Kb.prototype.$B=function(){this.D_f(!0);this.domElement.classList.add(this.$.isChromeRtl?Kb.GPe:Kb.FPe);this.domElement.style.width=ge.HelperMethods.Qb(this.J7b);this.domElement.classList.remove(Kb.tRe);this.vab()};Kb.prototype.Lf=function(){};Kb.prototype.fn=function(){return this.ZXa&&(!Ae.f(this.kg)||this.$.Yj)};Kb.prototype.Jp=function(){return $a.create(this.$,this.fieldList,this.kFb).D5a&&
(this.$.Yj||!Ae.f(this.kg))};Kb.prototype.bF=function(){};Kb.prototype.ake=function(la,nb){(la=Mb(this.xi.FieldListItems,la,this.currentState.R4?5:17,!0))&&la.CanDrag&&this.xG(la,nb,0,null,null)};Kb.prototype.xG=function(la,nb,Wb,Dc,zb){var hd=this;if(Dc&&!Zf.a.equals(Dc,this.uHa,!1))alert(gb.a.instance.Va(18));else{var ke=this.u9b(la.PivotCacheIndex,la.PivotTableIndex);Dc=ke.axis;var He=ke.pos;var df=ke.yDf;if(-1!==la.PivotTableIndex)var kf=Dc;else He=kf=0,df=la.PivotCacheIndex;if(!kf){if(7===la.TypeTag&&
(la=0<=la.ClientParentId?E(this.xi.FieldListItems,la.ClientParentId,!0):null,!la))return;He=0;df=la.PivotCacheIndex}if(kf!==nb||!nb||He!==Wb&&He!==Wb-1){var ff=new Tc(Dc,la.PivotCacheIndex,la.Name);De.a(this.$).pu(this.currentState.confirmationRequiredForDataOps,function(Ef){Ef&&hd.applyPivot(hd.currentState,kf,He,la.TypeTag,df,nb,Wb,zb,id.g(hd.$),ff,la)})}}};Kb.prototype.AYi=function(la,nb,Wb,Dc){if(this.xi&&this.Uj){var zb=null;switch(nb){case 0:zb=E(this.xi.FieldListItems,la,!0);break;case 1:zb=
E(this.Uj.RowAxis,la,!1);break;case 2:zb=E(this.Uj.ColumnAxis,la,!1);break;case 4:zb=E(this.Uj.FilterAxis,la,!1);break;case 8:zb=E(this.Uj.DataAxis,la,!1)}zb&&(Ac.ULS.sendTraceTag(554317779,0,50,"React Field List: drag and drop a field."),this.xG(zb,Wb,Dc,null,null))}};Kb.prototype.xYi=function(la,nb){this.xi&&this.jka&&(la=E(this.xi.FieldListItems,la,!0))&&(Ac.ULS.sendTraceTag(554317778,0,50,"React Field List: check/uncheck a field."),this.hff(la,nb))};Kb.prototype.oYi=function(la){this.xi&&(la=
E(this.xi.FieldListItems,la,!0))&&la.IsCollapsible&&(5===la.TypeTag&&la.IsCollapsed&&!la.Children.length?(Array.clear(this.cW),Array.add(this.cW,la),this.h7b()):(la.IsCollapsed=!la.IsCollapsed,this.Bf&&this.Y8b(0,-1,!1,!1,!1,!1)))};Kb.prototype.nYi=function(la){this.xi&&(Ac.ULS.sendTraceTag(554317777,0,50,"React Field List: expand/collapse all fields."),0<this.cW.length&&Array.clear(this.cW),this.mIf(this.xi.FieldListItems,la)?this.h7b():this.Bf&&this.Y8b(0,-1,!1,!1,!1,!1))};Kb.prototype.mIf=function(la,
nb){var Wb=!1;for(var Dc=0;Dc<la.length;Dc++){var zb=la[Dc];nb&&zb.IsCollapsible&&5===zb.TypeTag&&zb.IsCollapsed&&!zb.Children.length?(Array.add(this.cW,zb),Wb=!0):nb&&zb.IsCollapsible&&zb.IsCollapsed?zb.IsCollapsed=!1:nb||!zb.IsCollapsible||zb.IsCollapsed||(zb.IsCollapsed=!0);zb.IsCollapsible&&zb.Children&&0<zb.Children.length&&this.mIf(zb.Children,nb)&&(Wb=!0)}return Wb};Kb.prototype.Y8b=function(la,nb,Wb,Dc,zb,hd){if(this.xi){var ke=!1,He=!1,df=!1,kf=null;df=null;var ff=la;if(this.Nnd){Dc&&0<this.cW.length&&
Array.clear(this.cW);kf=this.Kad(this.xi.FieldListItems,Dc,!1);He=kf.yvb;df=kf.yHa;ke=kf.isRichPivotFieldList;kf=kf.returnValue;if(df){this.p_b||this.h7b();return}df=new Xc;df.needSearchReset=hd;df.needSearchRestore=!hd&&zb;df.searchRestoreValue=df.needSearchRestore?this.l6:"";df.searchWithNoMatch=""!==this.l6&&!He;df.searchWithNoMatch&&Dc&&je.TaskExtensions.Ba(rd.GetServiceTaskFactory.Xa(this.$.da,211,212,0),function(Ef){Ef.result.readText(gb.a.instance.ea(758))},this.$.ma,3);""!==this.l6&&2===la&&
(df.searchWithNoMatch?ff=1:Wb&&kf&&0<kf.length&&(nb=kf[0].id))}else la=this.nTe(this.xi.FieldListItems),ke=la.isRichPivotFieldList,kf=la.returnValue;this.sia.Bw(this.cA,0,kf,null,this.xi.IsPpm,this.xi.SelectedTab,this.xi.IsSortAscending,ff,nb,ke,df)}};Kb.prototype.jYi=function(la){Ac.ULS.sendTraceTag(554317776,0,50,"React Field List: change All/Active tab.");this.kFb=la;this.bSd()};Kb.prototype.tYi=function(la,nb,Wb,Dc){if(this.Uj){var zb=document.getElementById(Wb);if(zb){var hd=null,ke=-1;switch(nb){case 4:hd=
E(this.Uj.FilterAxis,la,!1);ke=this.Uj.FilterAxis.length;break;case 2:hd=E(this.Uj.ColumnAxis,la,!1);ke=this.Uj.ColumnAxis.length;break;case 1:hd=E(this.Uj.RowAxis,la,!1);ke=this.Uj.RowAxis.length;break;case 8:hd=E(this.Uj.DataAxis,la,!1),ke=this.Uj.DataAxis.length}if(hd){nb={};this.currentState.GZ?(nb.AnchorType=8,nb.ChartId=this.currentState.chartId):nb.AnchorType=9;nb.AnchorValue1=hd.PivotTableIndex;nb.AnchorValue2=hd.PivotCacheIndex;la=this.u9b(hd.PivotCacheIndex,hd.PivotTableIndex);var He=la.axis;
var df=la.pos;la=new Rf.a(-1453503574,0,this.$.ed,30,null);zb={domElement:zb};zb.fieldItem=hd;zb.zoneCount=ke;zb.sourceAxis=He;zb.sourceAxisPos=df;zb.optionalPivotMenuAnchorParameter=nb;zb.isOlap=this.currentState.R4;zb.isPpm=this.xi.IsPpm;zb.versionkey=this.uHa;zb.isKeyboardInput=Dc;zb.cell=this.currentState.Pt;zb.externalSourceIndex=this.externalSourceIndex;Dc=!1;qf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1)&&this.currentState.R4&&!this.xi.IsPpm&&this.xi.SupportsImplicitMeasures&&
(hd=Mb(this.xi.FieldListItems,hd.PivotCacheIndex,5,!0),Dc=!!hd&&!hd.IsCollapsible);zb.fieldItemsupportsImplicitMeasures=Dc;this.dPa=Wb;var kf;this.fFb=!be.a(kf=this.$.Ka.Zb(la,zb))&&(6!==kf.status||kf.result)}}}};Kb.prototype.qYi=function(la,nb,Wb){if(this.xi){var Dc=document.getElementById(nb);if(Dc&&(la=E(this.xi.FieldListItems,la,!0))){Dc={domElement:Dc,fieldItem:la};Dc.versionkey=this.uHa;Dc.isChart=!!this.chartId;Dc.isPpm=this.xi.IsPpm;Dc.isOlap=this.currentState.R4;Dc.supportsImplicitMeasures=
this.xi.SupportsImplicitMeasures;Dc.isKeyboardInput=Wb;this.dPa=nb;nb=new Rf.a(330754562,0,this.$.ed,30,null);var zb;this.fFb=!be.a(zb=this.$.Ka.Zb(nb,Dc))&&(6!==zb.status||zb.result)}}};Kb.prototype.pYi=function(la){var nb=this;la&&je.TaskExtensions.Ba(rd.GetServiceTaskFactory.Xa(this.$.da,103,104,0),function(Wb){var Dc=Wb.result,zb=id.g(nb.$),hd=rf.v(og.Range.ld(1,1),nb.$).SheetName;Wb=Dc.teb(zb);if(Wb){Dc=Wb.gf;var ke=Dc.Wf.top;var He=Dc.Wf.left;var df=Wb.rI.x;var kf=Wb.rI.y}else ke=He=1,Wb=Dc.$Ja(zb),
df=Wb.x,kf=Wb.y;nb.$.userOperationManager.ic(new af.a(203,0,function(ff,Ef,Qf){return Ce.M(nb.$.qa.ta,hd,nb.pivotName,la.PivotCacheIndex,0,ke,He,df,kf,ff,Ef,Qf,null)},void 0,function(){return new dg.a(hd,nb.pivotName,la.PivotCacheIndex,0)}),null)},this.$.ma,8)};Kb.prototype.iYi=function(la){var nb=this;Ac.ULS.sendTraceTag(554317775,0,50,"React Field List: change field list sort order.");var Wb=Kb.fqb(this.currentState);this.$.userOperationManager.ic(new af.a(251,0,function(Dc,zb,hd){var ke=nb.$.qa.ta,
He=Ce.mb(ke,nb.currentState.Pt,nb.currentState.externalSourceIndex,Wb);He.isAscending=la;return Ce.i(ke,"ChangePivotFieldListSortOrder",He,Dc,zb,hd,null,0)}),null)};Kb.prototype.RYi=function(la){this.Nbe=la};Kb.prototype.rYi=function(la){la!==this.l6&&(Ac.ULS.sendTraceTag(537162715,0,50,"React Field List: change search input."),this.l6=la,this.Y8b(0,-1,!1,!0,!1,!1))};Kb.prototype.dispose=function(){if(this.$){this.$.ml(this.od);this.Mu&&(this.$.Ka.UGd(this.Kxf),this.$.Ka.X$a(this.Jxf),Array.clear(this.cW));
var la=id.g(this.$);la&&(la.wN(this.Ms),la.lF(this.hla),la.ha&&(la.ha.vN(this.hla),la.ha.Qa.B4i(this.Utf)),la.Ca&&la.Ca.Zo(this.Juf));la=fd.a(this.$);(null===la||void 0===la?0:la.Ca)&&la.Ca.Zo(this.PBb);this.$.xa&&this.$.xa.rg(this.Yh);if(la=this.$.fa)la.mw(this.Kf),la.kk(this.Zc),la.mW(this.vq);mh.a(this.$)&&mh.a(this.$).Bqc(this.nBf);this.fieldList&&(this.fieldList.z4i(this.Gtf),this.fieldList.y4i(this.Ftf))}this.taskPaneManager&&this.taskPaneManager.UC(this.cOa);this.n6&&(nc.a.instance.za(Vd.a.click,
this.n6,this.Zj),Fd.KeyInputManager.instance.jv(this.n6,this.Twe));ad.a.pc([this.nk,this.o_c,this.trb,this.fieldList,this.Eaa,this.zV]);this.D8f();this.Eaa=this.iGc=null;this.hideTaskPane();this.sia=null;this.k3();this.zV=this.jya=this.jpb=this.fHb=this.L9c=this.PWd=this.jE=this.sH=this.bsa=this.cA=this.H5b=this.srb=this.F5b=this.G5b=this.ZHa=this.QT=this.taskPaneManager=this.$=null;tc.prototype.dispose.call(this)};Kb.prototype.Dah=function(){this.wK=tb(null,this.wK,this.wK===this.wt)};Kb.prototype.Qe=
function(la,nb){if(this.Mu){if(!nb){la=ed.DOMElementExtensions.zl(this.domElement.querySelectorAll(ed.DOMElementExtensions.Ep));if(!la)return!1;ed.DOMElementExtensions.setFocus(la)}return!nb}nb?this.vPa(!1):(this.wK=tb(null,this.wK,this.wK===this.wt),this.cn||(this.cn=this.fieldList.domElement),this.cn===this.QT?ed.DOMElementExtensions.setFocus(this.QT):this.cn===this.fieldList.domElement?this.fieldList.setFocus(nb,!1):this.kda(this.uk,this.Ssb));return!nb};Kb.prototype.zh=function(la){return ed.DOMElementExtensions.Ye(this.Jb,
la)};Kb.prototype.ji=function(){};Kb.prototype.Vh=function(){this.vPa(!1);this.fieldList&&this.fieldList.UKf()};Kb.prototype.Jtj=function(){this.refresh()};Kb.prototype.bSd=function(){this.refresh()};Kb.prototype.hff=function(la,nb){la&&la.CanDrag&&this.xG(la,nb?-1:0,-1,null,null)};Kb.prototype.ydh=function(la,nb){this.fGe(la,nb,!0)};Kb.prototype.zdh=function(la,nb){var Wb=this.WVe(nb);(la=this.UVe(la,Wb,!this.Sk))&&this.Zef(Wb)?this.lbh(this.hC[Wb],nb):this.rbb(null,"");return la};Kb.prototype.hasFocus=
function(la){this.fieldList&&la===this.fieldList&&this.cn!==this.fieldList.domElement&&(this.vPa(!1),this.cn=this.fieldList.domElement)};Kb.prototype.R5=function(){this.rV&&this.fn()&&this.Jp()&&(this.isVisible=!0)};Kb.prototype.Lxf=function(){this.fEd=!0;this.refresh()};Kb.prototype.CIi=function(){this.hideTaskPane()};Kb.prototype.DIi=function(){this.wIb(!0,null);this.hideTaskPane()};Kb.prototype.R3h=function(){this.y5a=this.Bf=!0;this.Mu&&this.rV?this.sia.tF(this.cA):this.Mu?(this.j5h(),this.sia.tF(this.cA)):
(this.a5h(),this.rV?this.taskPaneManager.fR(Kb.iI,this.hI):this.taskPaneManager.WC(this,!0))};Kb.prototype.showTaskPane=function(){this.isVisible=!0;this.Mu&&this.Nnd&&""!==this.l6&&(this.dEd=!0);this.Bf?this.Mu&&this.rV?this.sia.Aza():this.rV?this.taskPaneManager.fR(Kb.iI,this.hI):this.taskPaneManager.WC(this,!0):(this.Bf=!0,this.Mu&&this.sia.tF(this.cA),this.rV?this.rV&&!this.Mu&&this.taskPaneManager.fR(Kb.iI,this.hI):this.taskPaneManager.WC(this,!0))};Kb.prototype.hideTaskPane=function(){this.isVisible=
this.fEd=this.Bf=!1;this.Mu?this.sia.xM():this.rV&&this.taskPaneManager.hideTaskPane(Kb.iI)};Kb.prototype.Nvc=function(la,nb,Wb){this.wIb(la,nb);this.xmd=Wb;this.yIb=!la&&!!nb||Wb;la?this.hideTaskPane():this.showTaskPane()};Kb.prototype.h7b=function(){var la=this;De.a(this.$).pu(this.currentState.confirmationRequiredForDataOps,function(nb){nb&&la.expandPivotFieldListLevels(la.currentState)})};Kb.prototype.VG=function(){return!1};Kb.prototype.B1g=function(la){var nb=zd.a.Be(9),Wb=String.format(Kb.ech,
Kb.KPe)+String.format(this.DZ?Kb.dch:Kb.cch,this.titleText,Kb.JPe)+String.format(Kb.Sbh,la+Pd.a.w9c,la+Pd.a.v9c,nb,gb.a.instance.ea(1141)),Dc=wb(this.isRtl?Kb.rrb:0,this.isRtl),zb=wb(this.isRtl?0:Kb.rrb,this.isRtl);if(this.DZ){var hd=String.format(Kb.Ubh,la+Pd.a.B9c,gb.a.instance.ea(1134),String.format(Kb.d5b,Ad.a.uIa,gb.a.instance.ea(1135),la+Pd.a.y9c,nb,Kb.YXd,zb),String.format(Kb.d5b,Ad.a.Eta,gb.a.instance.ea(1136),la+Pd.a.x9c,nb,Kb.WXd,zb),String.format(Kb.d5b,Ad.a.Fta,gb.a.instance.ea(1137),
la+Pd.a.z9c,nb,Kb.ZXd,zb),String.format(Kb.d5b,Ad.a.f1a,gb.a.instance.ea(1140),la+Pd.a.A9c,nb,Kb.aYd,zb));Wb+=String.format(Kb.Xbh,la+Pd.a.I7b,hd)}else hd=String.format(Kb.aGe,Ha.Gkh,String.format(Kb.c5b,Ad.a.uIa,gb.a.instance.ea(1135),la+Pd.a.y9c,nb,Kb.YXd,"",Dc),String.format(Kb.c5b,Ad.a.Eta,gb.a.instance.ea(1136),la+Pd.a.x9c,nb,Kb.WXd,Ha.CKe,zb)),nb=String.format(Kb.aGe,"",String.format(Kb.c5b,Ad.a.Fta,gb.a.instance.ea(1137),la+Pd.a.z9c,nb,Kb.ZXd,"",Dc),String.format(Kb.c5b,Ad.a.f1a,gb.a.instance.ea(1140),
la+Pd.a.A9c,nb,Kb.aYd,Ha.CKe,zb)),hd=String.format(Kb.Tbh,la+Pd.a.B9c,gb.a.instance.ea(1134),hd,nb),Wb+=String.format(Kb.Wbh,la+Pd.a.I7b,hd);return Wb};Kb.prototype.$ne=function(){var la=document.getElementsByTagName("head")[0];if(la){var nb=document.createElement("link");nb.setAttribute("rel","stylesheet");nb.setAttribute("type","text/css");nb.setAttribute("href",ed.DOMElementExtensions.eZ(this.domElement,"data-cssfile",null));la.appendChild(nb)}};Kb.prototype.a5h=function(){var la=this.$.Ib;this.cA=
this.getElementById(la+Pd.a.I7b);this.cA||(this.$ne(),this.domElement.innerHTML=this.B1g(la),this.iNb=this.getElementById(Kb.KPe),this.cA=this.getElementById(la+Pd.a.I7b));this.bsa=this.getElementById(la+Pd.a.w9c);this.$.Yj&&ed.DOMElementExtensions.setVisible(this.bsa,!1);this.iGc=Ta.xHg(this.$,this,this.cA,Kb.Jth);this.H5b=this.getElementById(la+Pd.a.B9c);this.srb=this.getElementById(la+Pd.a.y9c);this.F5b=this.getElementById(la+Pd.a.x9c);this.G5b=this.getElementById(la+Pd.a.z9c);this.ZHa=this.getElementById(la+
Pd.a.A9c);this.jya=this.getElementById(Kb.JPe);this.jpb=this.getElementById(Kb.WXd);this.fHb=this.getElementById(Kb.ZXd);this.PWd=this.getElementById(Kb.aYd);this.L9c=this.getElementById(Kb.YXd);this.hC=[this.srb,this.F5b,this.G5b,this.ZHa];this.EPe=[this.L9c,this.jpb,this.fHb,this.PWd];this.H7b=[Kb.Dhi,Kb.Chi,Kb.Ehi,Kb.Fhi];this.u9c=[this.srb.scrollTop,this.F5b.scrollTop,this.G5b.scrollTop,this.ZHa.scrollTop];this.QT=this.getElementById(la+Pd.a.v9c);ad.a.Fa(this.Eaa);this.Eaa=new rg.a(this.$);this.Eaa.tnb(Pd.a.v9c,
Pd.a.w9c,Ha.Bkh,Ha.Ckh,Ha.Dkh);this.wc.ja("keydown",this.JV);this.wc.ja("keypress",this.jGi);this.wc.ja("keyup",this.tla);this.wc.ja("contextmenu",this.Zk);this.o_c=this.Nd.Cd(this.bsa);this.o_c.ja("click",this.zAi);this.trb=this.Nd.Cd(this.H5b);this.trb.ja("click",this.xyd);this.trb.ja("mousedown",this.yyd);this.trb.ja("mouseup",this.zyd);this.nk.ja("resize",this.onResize);this.fieldList.mAg(this.Gtf);this.fieldList.lAg(this.Ftf)};Kb.prototype.j5h=function(){var la=document.getElementById(this.$.Ib+
Pd.a.HPe);if(la){this.$ne();la.classList.add(Kb.HYi);var nb=this.z4g();la.appendChild(nb);nb=Pa.b("div",Kb.EYi,Kb.DYi);la.appendChild(nb);this.cA=nb}};Kb.prototype.z4g=function(){var la=Pa.b("div",Kb.JYi,Kb.IYi);this.gFb=Pa.b("span",Kb.LYi,Kb.KYi);this.gFb.innerText=this.titleText;this.n6=ud.a.yb(Kb.FYi,Kb.GYi,gb.a.instance.ea(10),"ClosePaneGlyph_16x16x32",!1);this.n6.classList.add(me.AFrameworkApplication.isRtl?Pd.a.X$:Pd.a.Y$);nc.a.instance.pa(Vd.a.click,this.n6,this.Zj);this.Twe=Fd.KeyInputManager.instance.Ur(this.n6,
this.Zj,$e.a.$h);this.$.Yj&&ed.DOMElementExtensions.setVisible(this.n6,!1);la.appendChild(this.gFb);la.appendChild(this.n6);return la};Kb.prototype.W9f=function(la){if(this.xi=la)this.currentState.wJ=this.xi.FieldListVersion,this.gba=Ga(this.xi.FieldListItems,-1,this.gba);if(this.fieldList)this.fieldList.wHg(this.xi),this.xi&&(this.currentState.qo=this.fieldList.qo,this.currentState.uN=this.fieldList.uN,this.yIb&&(this.Qe(!0,!1),this.yIb=!1));else if(this.Mu&&this.xi)if(this.Bf){this.kFb=this.currentState.qo=
this.xi.SelectedTab;this.pli();la=-1;var nb=0,Wb=!1;this.yIb?(this.xi.FieldListItems&&0<this.xi.FieldListItems.length&&(la=this.xi.FieldListItems[0].ClientId,nb=2,Wb=!0),this.yIb=!1):this.$ta&&!this.m6&&(this.cPa||this.eFb?this.xi.FieldListItems&&0<this.xi.FieldListItems.length&&(la=this.eFb?this.xi.FieldListItems[0].ClientId:this.cPa.ClientId,nb=2,Wb=this.eFb):this.qIf&&(la=this.xi.FieldListItems[0].ClientId,nb=1),this.K0b());var Dc=!1,zb=!1;this.Nnd&&(this.oIf!==this.xi.PivotXluid&&(this.oIf=this.xi.PivotXluid,
Dc=!0,this.l6=""),zb=!Dc&&this.dEd&&""!==this.l6);this.Y8b(nb,la,Wb,!1,zb,Dc);this.dEd=!1}else this.K0b()};Kb.prototype.K0b=function(){this.m6=0;this.cPa=null;this.dFb="";this.$ta=this.eFb=this.qIf=!1};Kb.prototype.EZf=function(la){return 7===la.TypeTag?!1:la.ShowFilterArrow||la.ShowCheckBox};Kb.prototype.mMa=function(la){return la.IsCollapsible&&(!la.IsCollapsed||2===la.Image)&&!!la.Children&&0<la.Children.length};Kb.prototype.yvb=function(la,nb){var Wb=nb.length;return 2<Wb&&'"'===nb.charAt(0)&&
'"'===nb.charAt(Wb-1)?Zf.a.contains(la,nb.substring(1,Wb-1),!0):Zf.a.n_a(nb,"*")||Zf.a.n_a(nb,"?")?(nb=nb.replace(RegExp("[.*+?|()\\[\\]{}\\\\]","g"),"\\\\$&"),nb="^"+Zf.a.iab(Zf.a.iab(nb,"\\\\?",".",!0),"\\\\*",".*",!0)+"$",0<=la.search(new RegExp(nb,"i"))):Zf.a.contains(la,nb,!0)};Kb.prototype.Kad=function(la,nb,Wb){var Dc,zb,hd;var ke=hd=zb=Dc=!1;for(var He=[],df=0;df<la.length;df++){var kf=la[df],ff=!1,Ef=!1,Qf=!1,Vg=[];if(""===this.l6){if(this.mMa(kf)){Vg=this.Kad(kf.Children,nb,!1);Ef=Vg.yvb;
var Kg=Vg.M3a;ff=Vg.isRichPivotFieldList;Vg=Vg.returnValue;kf.ShowCheckBox||(kf.IsChecked=Kg)}}else if(2!==kf.Image&&this.yvb(kf.Name,this.l6)&&(ke=Qf=!0,nb&&kf.IsCollapsible&&kf.IsCollapsed&&(5!==kf.TypeTag||kf.Children.length?kf.IsCollapsed=!1:(Array.add(this.cW,kf),Dc=!0))),nb&&Wb&&kf.IsCollapsible&&kf.IsCollapsed&&(5!==kf.TypeTag||kf.Children.length?kf.IsCollapsed=!1:(Array.add(this.cW,kf),Dc=!0)),kf.IsCollapsible&&kf.Children&&0<kf.Children.length){Vg=this.Kad(kf.Children,nb,Qf||Wb);Ef=Vg.yvb;
Kg=Vg.yHa;var yh=Vg.M3a;ff=Vg.isRichPivotFieldList;Vg=Vg.returnValue;kf.ShowCheckBox||(kf.IsChecked=yh);Ef&&(ke=!0,nb&&(kf.IsCollapsed=!1));Kg&&(Dc=!0)}this.ndf&&(ff||66===kf.TypeTag)&&(hd=!0);kf.IsChecked&&(zb=!0);if(""===this.l6||Qf||Ef||Wb)ff=new Pc,ff.id=kf.ClientId,ff.name=kf.Name,ff.type=kf.TypeTag,ff.isCollapsible=kf.IsCollapsible,ff.showCheckBox=kf.ShowCheckBox,ff.isMoreFields=2===kf.Image,ff.canDrag=kf.CanDrag&&7!==kf.TypeTag,ff.showSeparator=kf.ShowSeparator,ff.showMenu=this.EZf(kf),ff.isCollapsed=
kf.IsCollapsed,ff.isChecked=kf.IsChecked,ff.isBolded=kf.IsBolded,ff.children=Vg,Array.add(He,ff)}return{returnValue:He,yvb:ke,yHa:Dc,M3a:zb,isRichPivotFieldList:hd}};Kb.prototype.nTe=function(la){var nb=this,Wb;var Dc=Wb=!1;for(var zb=Array(la.length),hd={},ke=0;ke<la.length;hd={iy:hd.iy,ONb:hd.ONb,JNb:hd.JNb},ke++){hd.iy=la[ke];var He=new Pc;He.id=hd.iy.ClientId;He.name=hd.iy.Name;He.type=hd.iy.TypeTag;He.isCollapsible=hd.iy.IsCollapsible;He.isCollapsed=hd.iy.IsCollapsed;He.showCheckBox=hd.iy.ShowCheckBox;
He.isMoreFields=2===hd.iy.Image;He.canDrag=hd.iy.CanDrag&&7!==hd.iy.TypeTag;He.showSeparator=hd.iy.ShowSeparator;He.showMenu=this.EZf(hd.iy);hd.JNb=!1;this.mMa(hd.iy)&&(hd.ONb=void 0,He.children=function(df){return function(){var kf=nb.nTe(df.iy.Children);df.ONb=kf.M3a;df.JNb=kf.isRichPivotFieldList;return kf}}(hd)().returnValue,hd.iy.ShowCheckBox||(hd.iy.IsChecked=hd.ONb));this.ndf&&(hd.JNb||66===hd.iy.TypeTag)&&(Dc=!0);hd.iy.IsChecked&&(Wb=!0);He.isChecked=hd.iy.IsChecked;He.isBolded=hd.iy.IsBolded;
zb[ke]=He}return{returnValue:zb,M3a:Wb,isRichPivotFieldList:Dc}};Kb.prototype.d9b=function(la){for(var nb=Array(la.length),Wb=0;Wb<la.length;Wb++){var Dc=la[Wb],zb=new Hc;zb.id=Dc.ClientId;zb.name=Dc.Name;nb[Wb]=zb}return nb};Kb.prototype.jcj=function(){this.IRf(this.xi.FieldListItems,"")};Kb.prototype.pli=function(){this.Rhf(this.xi.FieldListItems,"")};Kb.prototype.ria=function(la,nb){return la.Name+"_"+la.UniqueName+"_"+la.TypeTag+"_"+(nb||this.Nha)};Kb.prototype.IRf=function(la,nb){if(la)for(var Wb=
0,Dc=la.length;Wb<Dc;Wb++){var zb=la[Wb],hd="";if(zb.IsCollapsible||zb.Children)hd=this.ria(zb,nb),zb.IsCollapsible&&(this.T4c[hd]=!!zb.IsCollapsed),zb.Children&&this.IRf(zb.Children,hd);this.cPa&&zb.ClientId===this.cPa.ClientId&&(this.dFb=hd||this.ria(zb,nb))}};Kb.prototype.Rhf=function(la,nb){if(la)for(var Wb=0,Dc=la.length;Wb<Dc;Wb++){var zb=la[Wb],hd="";if(zb.IsCollapsible||zb.Children)hd=this.ria(zb,nb),zb.IsCollapsible&&hd in this.T4c&&(zb.IsCollapsed=mb.a.ug(this.T4c,hd)),zb.Children&&this.Rhf(zb.Children,
hd);this.dFb&&Zf.a.equals(this.dFb,hd||this.ria(zb,nb),!1)&&(this.cPa=zb,this.dFb="")}};Kb.prototype.N9f=function(la){if(this.Uj=la)this.currentState.eQ=this.Uj.FieldWellVersion,this.gba=Ga(this.Uj.FilterAxis,-1,this.gba),this.gba=Ga(this.Uj.ColumnAxis,-1,this.gba),this.gba=Ga(this.Uj.RowAxis,-1,this.gba),this.gba=Ga(this.Uj.DataAxis,-1,this.gba);this.cQ?Array.clear(this.cQ):this.cQ=[];if(this.Uj&&(Array.add(this.cQ,this.Uj.FilterAxis),Array.add(this.cQ,this.Uj.ColumnAxis),Array.add(this.cQ,this.Uj.RowAxis),
Array.add(this.cQ,this.Uj.DataAxis),this.Mu)){if(!this.Bf){this.K0b();return}la=-1;var nb=0;if(this.$ta&&this.m6){switch(this.m6){case 1:0<this.Uj.RowAxis.length&&(la=this.Uj.RowAxis[0].ClientId,nb=3);break;case 2:0<this.Uj.ColumnAxis.length&&(la=this.Uj.ColumnAxis[0].ClientId,nb=3);break;case 4:0<this.Uj.FilterAxis.length&&(la=this.Uj.FilterAxis[0].ClientId,nb=3);break;case 8:0<this.Uj.DataAxis.length&&(la=this.Uj.DataAxis[0].ClientId,nb=3)}this.K0b()}var Wb=new Eb;Wb.filtersWellItems=this.d9b(this.Uj.FilterAxis);
Wb.columnsWellItems=this.d9b(this.Uj.ColumnAxis);Wb.rowsWellItems=this.d9b(this.Uj.RowAxis);Wb.valuesWellItems=this.d9b(this.Uj.DataAxis);this.sia.Bw(this.cA,1,null,Wb,!1,-1,!1,nb,la,!1,null)}if(!this.Mu){this.w9i();if(la=this.fieldList.z9i(this.cn===this.fieldList.domElement))this.cn=this.fieldList.domElement,this.$ta=!1;if(la||this.$ta)this.wt=this.uk=null;this.$ta&&((this.cn=this.OUh(this.E4c))?this.Oma(!0):this.Kab(!0,!0),this.$ta=!1,this.E4c=0)}};Kb.prototype.uMb=function(){var la=this.isVisible&&
!this.jka;this.iNb&&la!==this.eif&&(ed.DOMElementExtensions.setVisible(this.iNb,la),la?(this.zV.jAa(),this.iNb.style.cursor="wait"):(this.zV.NRa(),this.iNb.style.cursor="default"),this.eif=la)};Kb.prototype.fJj=function(){this.jya&&(this.jya.innerText=this.currentState.GZ?gb.a.instance.ea(1133):this.titleText);this.Mu&&this.gFb&&(this.gFb.innerText=this.currentState.GZ?gb.a.instance.ea(1133):this.titleText);this.jpb&&(this.jpb.innerText=this.currentState.GZ?gb.a.instance.ea(1138):gb.a.instance.ea(1136));
this.fHb&&(this.fHb.innerText=this.currentState.GZ?gb.a.instance.ea(1139):gb.a.instance.ea(1137))};Kb.prototype.zsc=function(la){if(!this.Mu&&this.cA){if(la)for(var nb=Kb.eL;nb<=Kb.eS;nb++)this.hC[nb].scrollTop=this.u9c[nb];else for(nb=Kb.eL;nb<=Kb.eS;nb++)this.u9c[nb]=this.hC[nb].scrollTop;this.fieldList&&this.fieldList.zsc(la)}};Kb.prototype.refresh=function(){if(!this.Mu||this.fEd){var la=$a.create(this.$,this.fieldList,this.kFb);this.XJf(la)}};Kb.prototype.XJf=function(la,nb){nb=void 0===nb?!1:
nb;if(this.isVisible&&(this.rV&&this.Mu||this.cA)){la=la||$a.create(this.$,this.fieldList,this.kFb);var Wb=this.currentState;this.Mu&&this.xi&&this.jcj();this.currentState=la;if($a.Jgi(Wb,la)||nb){if(this.eob=!1,this.bQ.vl=la.D5a,Kb.lY(this.bQ),$a.mef(Wb,la)||nb)this.dQ.vl=la.D5a,Kb.lY(this.dQ),this.W9f(null),this.N9f(null),this.fJj(),this.vPa(!0)}else Wb.wJ<la.wJ?(this.bQ.vl=!0,Kb.lY(this.bQ)):this.currentState.wJ=Wb.wJ,Wb.eQ<la.eQ?(this.eob=!1,this.dQ.vl=!0,Kb.lY(this.dQ),this.cn===this.ZHa&&this.vPa(!0)):
this.currentState.eQ=Wb.eQ}this.uMb();ae.a.instance.create(this.Lga,0,Uf.a.Kth,!0,!0)};Kb.prototype.wIb=function(la,nb){this.applyPivotFieldManagerHiddenState(la,nb);this.kg=ge.HelperMethods.QN(la,this.kg,4);this.refresh();this.raiseEvent(Kb.qsb);this.rV&&this.$.Gf()};Kb.prototype.applyPivotFieldManagerHiddenState=function(la,nb){var Wb=this;this.$.userOperationManager.ic(new af.a(144,0,function(Dc,zb,hd){var ke=rf.o(id.g(Wb.$).ha.va.activeCell,Wb.$),He=Wb.$.qa.ta,df=He.Oa(9);df.hidden=la;df.activeCell=
ke;return Ce.i(He,"ApplyPivotFieldManagerHiddenStateV2",df,Dc,zb,hd,null,0)},16),nb)};Kb.prototype.KEf=function(la,nb,Wb){if(!Wb.request||nb!==Wb.correlationId)return!1;Wb.request=null;return Zg.a.hh(la.Errors)?(this.$.fa.Yo(la.Errors),!1):!0};Kb.prototype.Gsf=function(la,nb){var Wb=cg.a.yg(la.data);this.$.fa.Yo(Wb);nb.request=null;10!==la.data.status&&(nb.vl=!1);this.Lga()};Kb.prototype.applyPivot=function(la,nb,Wb,Dc,zb,hd,ke,He,df,kf,ff){var Ef=this;0<df.getRangeInformation(df.ha.va.activeCell).length?
this.eob=!0:(this.bQ.vl=!0,this.dQ.vl=!0);this.uMb();la.Nfc&&(this.AFa=la.pivotTableName);var Qf=Kb.fqb(la),Vg={FieldListType:1};Vg.FieldListVersion=la.wJ;Vg.FieldWellVersion=la.eQ;Vg.SourceAxis=nb;Vg.SourceAxisPosition=Wb;Vg.ItemType=Dc;Vg.ItemIndex=zb;Vg.DestinationAxis=hd;Vg.DestinationAxisPosition=ke;this.Mu&&this.YKj(ff,nb,hd);nb=new af.a(145,0,function(Kg,yh,fh){var If=Ef.$.qa.ta;Kg=Of.b(Kg,Ef.Vyi);var eh=Ce.mb(If,la.Pt,la.externalSourceIndex,Qf);eh.pivotFieldApplyData=Vg;return Ce.i(If,"ApplyPivot",
eh,Kg,yh,fh,null,0)},4,function(){return new wd(Ef.pivotName,Vg,kf,la.Pt)});this.$.userOperationManager.ic(nb,He);this.E4c=hd};Kb.prototype.YKj=function(la,nb,Wb){if(this.xi&&this.Uj)if(nb)if(Wb)this.m6=Wb;else switch(this.m6=0,this.eFb=!0,nb){case 1:1<this.Uj.RowAxis.length&&(this.m6=1);break;case 2:1<this.Uj.ColumnAxis.length&&(this.m6=2);break;case 4:1<this.Uj.FilterAxis.length&&(this.m6=4);break;case 8:1<this.Uj.DataAxis.length&&(this.m6=8)}else this.m6=0,this.cPa=la};Kb.prototype.expandPivotFieldListLevels=
function(la){var nb=this,Wb=Kb.fqb(la);this.p_b=!0;this.uMb();this.$.userOperationManager.ic(new af.a(146,0,function(Dc,zb,hd){var ke=nb.$.qa.ta;Dc=Of.b(Dc,nb.yCi);var He=Ce.mb(ke,la.Pt,la.externalSourceIndex,Wb);He.type=1;return Ce.i(ke,"ExpandPivotFieldListLevels",He,Dc,zb,hd,null,0)}),null)};Kb.prototype.m1e=function(la){return this.DZ?this.isRtl?0:Kb.rrb:la===Kb.$Xd||la===Kb.eL?this.isRtl?Kb.rrb:0:this.isRtl?0:Kb.rrb};Kb.prototype.w9i=function(){if(this.hC)for(var la=Kb.eL;la<=Kb.eS;la++){var nb=
this.hC[la];if(this.cQ[la]){var Wb=wb(this.m1e(la),this.isRtl);nb.innerHTML=String.format(Kb.nQj,this.L2b(this.cQ[la],la),Wb)}else nb.innerHTML=""}this.vab()};Kb.prototype.vab=function(){if(this.hC)for(var la=Kb.eL;la<=Kb.eS;la++){var nb=this.m1e(la),Wb=this.hC[la];if(0<Wb.scrollWidth){var Dc=Wb.scrollWidth-(Kb.Iuh+nb),zb=Wb.getElementsByTagName("label");if(zb&&!this.DZ)for(var hd=0,ke=zb.length;hd<ke;hd++)rc(zb[hd],Dc);rc(this.EPe[la],Wb.offsetWidth-(Kb.uCj+nb))}}this.jya&&this.cA&&0<this.cA.offsetWidth&&
(rc(this.jya,this.$.Yj?this.cA.offsetWidth:this.cA.offsetWidth-Kb.QOi),this.DZ||ed.DOMElementExtensions.shrinkToFit(this.jya,this.jya,!1))};Kb.prototype.Pfd=function(la){return this.H7b[la]};Kb.prototype.Y$b=function(la){return Kb.Ztd+this.Pfd(la)};Kb.prototype.Ofd=function(la){var nb=Kb.lBc;for(var Wb=Kb.eL;Wb<=Kb.eS;Wb++)if(1===la.indexOf(this.Pfd(Wb)))return nb=Wb,{returnValue:this.cQ[Wb],kBc:nb};return{returnValue:null,kBc:nb}};Kb.prototype.u9b=function(la,nb){for(var Wb,Dc,zb=Kb.eL;zb<=Kb.eS;zb++){var hd=
this.cQ[zb];for(Wb=hd.length-1;0<=Wb;Wb--)if(Dc=hd[Wb],Dc.PivotCacheIndex===la&&(-1===nb||Dc.PivotTableIndex===nb))return la=this.qZe(zb),Dc=Dc.PivotTableIndex,{returnValue:!0,axis:la,pos:Wb,yDf:Dc}}return{returnValue:!1,axis:0,pos:-1,yDf:-1}};Kb.prototype.Vgc=function(la,nb){if(la&&la.id)for(var Wb=Kb.eL;Wb<=Kb.eS;Wb++)if(la.id.indexOf(this.H7b[Wb])===(nb?1:0))return!0;return!1};Kb.prototype.Ahi=function(la){return la&&la.id&&la.id.startsWith(Kb.Ztd)&&this.Vgc(la,!0)||la.classList.contains(Ha.Hkh)&&
(la=la.getElementsByTagName("input")[0])&&la.id&&la.id.startsWith(Kb.Ztd)&&this.Vgc(la,!0)?la:null};Kb.prototype.L2b=function(la,nb){var Wb="";if(la)if(0<la.length)for(var Dc=this.DZ?Kb.ewj:Kb.dwj,zb=0,hd=la.length;zb<hd;zb++){var ke=la[zb],He=ke.Name?Jf.a.If(ke.Name):"",df=String.format(Dc,Ha.FKe,He,bb(ke,this.Pfd(nb))),kf=zd.a.Be(9);He=String.format(Kb.cwj,bb(ke,this.Y$b(nb)),He,Ad.a.PLe+" "+Ha.DKe,kf,Pd.a.mYa);Wb+=String.format(Kb.Rzb,bb(ke,Kb.Xgc),df,He)}else Wb+=Kb.Qfh;return Wb};Kb.prototype.O$b=
function(la){return this.Vgc(la,!1)?la:la.id.startsWith(Kb.Xgc)||la.classList.contains(Ha.FKe)?(la=la.getElementsByTagName("label")[0])&&this.Vgc(la,!1)?la:null:null};Kb.prototype.fGe=function(la,nb,Wb){this.rbb(null,"");var Dc=this.WVe(nb);if(this.UVe(la,Dc,Wb)&&!(Dc===Kb.lBc||Wb&&Dc===Kb.jBc)){var zb=Wb=0;Dc!==Kb.jBc&&Dc!==Kb.mBc&&(Wb=this.LPe[Dc],this.cQ[Dc]&&(zb=Kb.LHh(this.hC[Dc],nb)));this.xG(la,Wb,zb,null,null)}};Kb.prototype.lbh=function(la,nb){var Wb=la.getElementsByTagName("li");if(Wb&&
0<Wb.length){la=Wb.length;for(var Dc=0;Dc<la;Dc++){var zb=Wb[Dc];if(Df.a.EA(ed.DOMElementExtensions.getBounds(zb),nb)){zb.classList.contains(Kb.krb)||this.rbb(zb,Kb.krb);return}}0<la&&(Wb=Wb[Wb.length-1],la=ed.DOMElementExtensions.getBounds(Wb),nb.y>la.y+la.height&&(Wb.classList.contains(Kb.D5c)||this.rbb(Wb,Kb.D5c)))}else this.rbb(la.getElementsByTagName("div")[0],Kb.krb)};Kb.prototype.rbb=function(la,nb){this.YHa&&(this.YHa.classList.remove(this.YHa.classList.contains(Kb.krb)?Kb.krb:Kb.D5c),this.YHa===
this.wt&&this.wt.classList.add("ewa-flp-elementWithFocus"));this.YHa=null;la&&(this.YHa=la,this.YHa===this.wt&&this.wt.classList.remove("ewa-flp-elementWithFocus"),la.classList.add(nb))};Kb.prototype.Zef=function(la){return la>=Kb.eL&&la<=Kb.eS};Kb.prototype.WVe=function(la){for(var nb=Kb.eL;nb<=Kb.eS;nb++)if(Df.a.EA(ed.DOMElementExtensions.getBounds(this.hC[nb]),la))return nb;return this.fieldList.Hhi(la)?Kb.jBc:Df.a.EA(ed.DOMElementExtensions.getBounds(this.parentElement),la)?Kb.mBc:Kb.lBc};Kb.prototype.UVe=
function(la,nb,Wb){if(!Wb&&!la.TypeTag){if(!this.currentState.R4||this.xi.IsPpm||nb===Kb.mBc)return!0;Wb=this.u9b(la.PivotCacheIndex,la.PivotTableIndex).axis;var Dc=this.qZe(nb);return la.PivotTableIndex===Kb.INj&&(4===Dc||8===Dc)||la.IsSet&&nb===Kb.eL?!1:!Dc||8===Wb&&8===Dc||8!==Wb&&8!==Dc}Dc=5===la.TypeTag||7===la.TypeTag;var zb=17===la.TypeTag||this.xi.IsPpm;switch(nb){case Kb.eL:return(Dc||zb)&&!la.IsSet;case Kb.Scg:case Kb.$Xd:return Dc||zb||la.IsSet;case Kb.eS:return(!Dc||zb)&&!la.IsSet;case Kb.mBc:return!Wb;
case Kb.jBc:return!0;default:return!1}};Kb.prototype.MIa=function(la,nb,Wb,Dc){if(Dc=ka(Wb,Dc,!1)){this.kda(Dc,nb);this.wK=tb(this.getElementById(bb(Dc,Kb.Xgc)),this.wK,this.wK===this.wt);var zb=new Rf.a(-1453503574,0,this.$.ed,30,null),hd={};this.currentState.GZ?(hd.AnchorType=8,hd.ChartId=this.currentState.chartId):hd.AnchorType=9;hd.AnchorValue1=Dc.PivotTableIndex;hd.AnchorValue2=Dc.PivotCacheIndex;var ke=this.u9b(Dc.PivotCacheIndex,Dc.PivotTableIndex);nb=ke.axis;ke=ke.pos;var He={};this.$.Ka.Zb(zb,
(He.domElement=la,He.cell=this.currentState.Pt,He.externalSourceIndex=this.externalSourceIndex,He.fieldItem=Dc,He.zoneCount=Wb.length,He.sourceAxis=nb,He.sourceAxisPos=ke,He.optionalPivotMenuAnchorParameter=hd,He.isOlap=this.currentState.R4,He.isPpm=this.xi.IsPpm,He.versionkey=this.uHa,He))}};Kb.prototype.k3=function(){if(this.Sk){var la=this.parentElement;la.removeChild(this.Sk.domElement);this.Sk.dGb(this.bCb);this.Sk.eGb(this.cCb);this.Sk.nMf(this.aCb);ad.a.Fa(this.Sk);this.Sk=null;la.style.cursor=
"default"}};Kb.prototype.clear=function(){this.currentState=$a.G2b();this.refresh()};Kb.prototype.I3e=function(la){this.D8f();this.cn?(la=this.Oma(la),la||(this.cn=null)):la=this.Bxh(la);la||this.A0i();return la};Kb.prototype.A0i=function(){var la=this.domElement.querySelectorAll(ed.DOMElementExtensions.Ep);this.jE=ed.DOMElementExtensions.zl(la);this.sH=ed.DOMElementExtensions.Ry(la);gg.a.instance.pa(Vd.a.focus,this.jE,this.Kmc);gg.a.instance.pa(Vd.a.focus,this.sH,this.Kmc)};Kb.prototype.D8f=function(){this.jE&&
gg.a.instance.za(Vd.a.focus,this.jE,this.Kmc);this.sH&&gg.a.instance.za(Vd.a.focus,this.sH,this.Kmc);this.sH=this.jE=null};Kb.prototype.Bxh=function(la){var nb=!0;la?(this.cn=this.QT,ed.DOMElementExtensions.setFocus(this.QT)):(this.cn=this.ZHa,nb=this.Oma(la));return nb};Kb.prototype.vPa=function(la){this.Mu||(this.wt&&this.wt.classList.remove("ewa-flp-elementWithFocus"),(this.cn===this.fieldList.domElement||la)&&this.fieldList.setFocus(!0,la),la&&(this.uk=this.wt=this.cn=null))};Kb.prototype.kda=
function(la,nb){this.vPa(!1);this.uk=la;this.Ssb=nb;this.cn=this.hC[nb];nb=this.getElementById(bb(la,this.Y$b(this.Ssb)));ed.DOMElementExtensions.setFocus(nb);this.wt=this.getElementById(bb(la,Kb.Xgc));this.wt.classList.add("ewa-flp-elementWithFocus")};Kb.prototype.Ojj=function(la,nb,Wb){var Dc=la?la.length:0;if(!Dc)return!1;var zb=null;if(this.uk)for(var hd=0;hd<Dc;hd++){if(la[hd]===this.uk){if(Wb&&hd===Dc-1||!Wb&&!hd)return this.uk=null,!1;zb=la[Wb?hd+1:hd-1];break}}else zb=Wb?la[0]:la[Dc-1];if(!zb)return!1;
this.kda(zb,nb);return!0};Kb.prototype.Kab=function(la,nb){var Wb=!0;la?nb&&ed.DOMElementExtensions.isVisible(this.bsa)?(this.cn=this.QT,ed.DOMElementExtensions.setFocus(this.QT)):(this.cn=this.fieldList.domElement,this.Oma(nb)):nb?(this.cn=this.srb,Wb=this.Oma(nb)):ed.DOMElementExtensions.isVisible(this.bsa)?(this.cn=this.QT,ed.DOMElementExtensions.setFocus(this.QT)):(this.cn=this.ZHa,Wb=this.Oma(nb));return Wb};Kb.prototype.Oma=function(la){var nb=!0;if(this.cn===this.QT)la?(this.cn=this.fieldList.domElement,
nb=this.Oma(la)):nb=!1;else if(this.cn===this.fieldList.domElement)this.fieldList.Kab(la)||(nb=this.Kab(!1,la));else for(var Wb=Kb.eL;Wb<=Kb.eS;Wb++)if(this.cn===this.hC[Wb]&&!this.Ojj(this.cQ[Wb],Wb,la)){la&&Wb<Kb.eS?(this.cn=this.hC[Wb+1],nb=this.Oma(la)):!la&&Wb>Kb.eL?(this.cn=this.hC[Wb-1],nb=this.Oma(la)):(this.vPa(!1),nb=la?!1:this.Kab(!0,la));break}return nb};Kb.prototype.qZe=function(la){return this.Zef(la)?this.LPe[la]:0};Kb.prototype.OUh=function(la){return 4===la?this.hC[Kb.eL]:2===la?
this.hC[Kb.Scg]:1===la?this.hC[Kb.$Xd]:8===la?this.hC[Kb.eS]:null};Kb.prototype.wFb=function(la,nb){la&&(this.AFa=null);this.refresh();nb&&(this.rV?!this.Bf&&this.Jp()&&this.fn()?this.showTaskPane():!this.Bf||this.fn()&&this.Jp()||this.hideTaskPane():this.raiseEvent(Kb.qsb))};Kb.prototype.bCh=function(){var la=id.g(this.$),nb=null;la=la.getRangeInformation(la.ha.va.activeCell);for(var Wb=0,Dc=la.length;Wb<Dc;++Wb){var zb=la[Wb];if(Object(Xd.a)(sc.PivotTableRange,zb)){nb=zb.pivotTableName;break}}return nb};
Kb.prototype.X9f=function(la){var nb=id.g(this.$),Wb=nb.Ca.jl(la);if(Wb){if(this.AFa){la=Wb.ranges;if(!la)return;for(Wb=la.length-1;0<=Wb;--Wb){var Dc=la[Wb];if(Object(Xd.a)(sc.PivotTableRange,Dc)&&Zf.a.equals(Dc.pivotTableName,this.AFa,!1)){la=this.bCh();la&&Zf.a.equals(la,this.AFa,!1)||(la=rf.v(Dc.topLeft,this.$),nb.yi(la,null,null,null,0,gc.a.Nth));this.AFa=null;break}}}id.g(this.$).Cq||this.refresh()}else Ac.ULS.sendTraceTag(537162690,0,15,"Block {0} was removd from BlockManager",la)};Kb.prototype.GK=
function(){this.clear()};Kb.yHg=function(la,nb,Wb){var Dc=Ie.a(la);if(!Dc){var zb=document.getElementById(la.Ib+Pd.a.HPe);zb?Dc=la.da.Ha(16,new Kb(zb,la,nb,Wb)):Ac.ULS.sendTraceTag(537162688,0,15,"FieldManagerPane creation fails: FieldManagerPaneDiv is null.")}return Dc};Kb.fqb=function(la){var nb={};nb.AnchorType=la.anchorType;7===la.anchorType&&(nb.ChartId=la.chartId,nb.AnchorValue1=nb.AnchorValue2=-1);return nb};Kb.lY=function(la){la.request&&(me.AFrameworkApplication.Hd.Zt(la.request.kt),la.request=
null)};Kb.LHh=function(la,nb){var Wb=0;if(la=la.getElementsByTagName("li"))for(var Dc=la.length;Wb<Dc&&!Df.a.EA(ed.DOMElementExtensions.getBounds(la[Wb]),nb);Wb++);return Wb};tl.Object.defineProperties(Kb.prototype,{pivotName:{configurable:!0,enumerable:!0,get:function(){return this.currentState.pivotTableName}},chartId:{configurable:!0,enumerable:!0,get:function(){return this.currentState.chartId}},Pt:{configurable:!0,enumerable:!0,get:function(){return this.currentState.Pt}},R4:{configurable:!0,
enumerable:!0,get:function(){return this.currentState.R4}},GZ:{configurable:!0,enumerable:!0,get:function(){return this.currentState.GZ}},confirmationRequiredForDataOps:{configurable:!0,enumerable:!0,get:function(){return this.currentState.confirmationRequiredForDataOps}},externalSourceIndex:{configurable:!0,enumerable:!0,get:function(){return this.currentState.externalSourceIndex}},wJ:{configurable:!0,enumerable:!0,get:function(){return this.currentState.wJ}},eQ:{configurable:!0,enumerable:!0,get:function(){return this.currentState.eQ}},
uHa:{configurable:!0,enumerable:!0,get:function(){return this.currentState.uHa}},isRtl:{configurable:!0,enumerable:!0,get:function(){return this.fj}},DZ:{configurable:!0,enumerable:!0,get:function(){return this.wmg}},eOd:{configurable:!0,enumerable:!0,get:function(){return this.ZXa&&!this.$.Yj}},jka:{configurable:!0,enumerable:!0,get:function(){return!(!this.isVisible||this.bQ.vl||this.dQ.vl||this.p_b||this.eob)}},parentElement:{configurable:!0,enumerable:!0,get:function(){return this.$.Yj?ue.a(this.cA):
this.$.domElement}},Jb:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},isVisible:{configurable:!0,enumerable:!0,get:function(){return Object(qb.a)(Kb.prototype,this,"isVisible")},set:function(la){la=this.$Xa&&la;!la||this.cA||this.y5a||this.R3h();la!==Object(qb.a)(Kb.prototype,this,"isVisible")&&(la||this.zsc(!1),Object(qb.b)(Kb.prototype,this,"isVisible",la),la&&this.zsc(!0),this.raiseEvent(Kb.qsb));this.XJf(null,la)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},
Zd:{configurable:!0,enumerable:!0,get:function(){return ee.a.Lth}},tg:{configurable:!0,enumerable:!0,get:function(){return 1}},Vj:{configurable:!0,enumerable:!0,get:function(){return Ad.a.Qoh}},oC:{configurable:!0,enumerable:!0,get:function(){return gb.a.instance.ea(1019)}},El:{configurable:!0,enumerable:!0,get:function(){return this.$.Yj?this.C9c:this.J7b}},isResizable:{configurable:!0,enumerable:!0,get:function(){return!!this.$&&qf.EwaSettings.isChangeGateEnabled("OfficeVSO:4512903_EnableBIPanesResizable")}},
titleText:{configurable:!0,enumerable:!0,get:function(){return gb.a.instance.ea(1132)}},sYi:{configurable:!0,enumerable:!0,get:function(){return this.Nbe}},fieldList:{configurable:!0,enumerable:!0,get:function(){return this.iGc}},hI:{configurable:!0,enumerable:!0,get:function(){var la=this;return this.taskPaneManager.lua(this.Jb,this.titleText,this.El,this.isResizable,function(){la.isVisible=!0},function(){la.isVisible=!1},function(){la.isVisible=!0},function(){la.isVisible=!1},this.El)}},ZXa:{configurable:!0,
enumerable:!0,get:function(){return this.$.lc.n2(36896)&&this.$Xa}},$Xa:{configurable:!0,enumerable:!0,get:function(){var la=new mc.a(this.$.xa);return this.$.isEditMode&&la.te(8192)||!la.ik}},Nha:{configurable:!0,enumerable:!0,get:function(){return(this.pivotName||"")+(this.chartId||"")}}});Kb.iI="FieldManagerTaskPane";Kb.Jth="m_fieldManagerPane_";Kb.qsb="fieldListPaneVisibilityChanged";Kb.G7b="FieldListPaneChanging";Kb.u1a="FieldListPaneChanged";Kb.IPe="FieldManagerRemovePaneEventKey";Kb.Xgc="flzi_";
Kb.Dhi="flzlf_";Kb.Chi="flzlc_";Kb.Ehi="flzlr_";Kb.Fhi="flzlv_";Kb.Ztd="m";Kb.KPe="m_washout";Kb.JPe="m_flpTitle";Kb.YXd="m_fldzFilterTitle";Kb.WXd="m_fldzColumnTitle";Kb.ZXd="m_fldzRowTitle";Kb.aYd="m_fldzValueTitle";Kb.krb="ewa-flp-dzDragDropLandSiteAbove";Kb.D5c="ewa-flp-dzDragDropLandSiteBelow";Kb.tRe="ewa-flp-nov2";Kb.GPe="ewa-flp-border-rtl";Kb.FPe="ewa-flp-border-ltr";Kb.eL=0;Kb.Scg=1;Kb.$Xd=2;Kb.eS=3;Kb.jBc=4;Kb.mBc=5;Kb.lBc=-1;Kb.INj=-2;Kb.Iuh=24;Kb.uCj=24;Kb.rrb=8;Kb.QOi=60;Kb.ech='<div ID="{0}" class="ewa-flp-washout"></div>';
Kb.cch='<div class="ewa-flp-title"><div ID="{1}" class="ewa-flp-description">{0}</div></div>';Kb.dch='<div class="ewa-flp-title-new"><div ID="{1}" class="ewa-flp-description">{0}</div></div>';Kb.Sbh='<div ID="{0}" class="ewa-flp-close"><div class="clip16x16" style="display: inline-block"><input ID="{1}" class="ewaboot_pivotFieldListClose16" src="{2}" type="image" title="{3}" tabindex="0"/></div></div>';Kb.aGe='<div class="ewa-flp-dropzonerow {0}">{1}{2}</div>';Kb.c5b='<div class="ewa-flp-dropzoneQuadrant {5}" ><div class="ewa-flp-dropzoneTitleDiv" {6}><div class="clip16x16 ewa-flp-dropzoneimage"><img class="{0}" src="{3}" alt="{1}"/></div><span ID="{4}" class="ewa-flp-dropzonetitle">{1}</span></div><div ID="{2}" class="ewa-flp-dropzone ewa-scrollbars"></div></div>';
Kb.d5b='<div class="ewa-flp-dropzoneQuadrant-new"><div class="ewa-flp-dropzoneTitleDiv" {5}><div class="clip16x16 ewa-flp-dropzoneimage"><img class="{0}" src="{3}" alt="{1}"/></div><span ID="{4}" class="ewa-flp-dropzonetitle">{1}</span></div><div ID="{2}" class="ewa-flp-dropzone ewa-scrollbars"></div></div>';Kb.Tbh='<div ID="{0}" class="ewa-flp-dropzones"><div class="ewa-flp-dropzoneareatopseparator"></div><div class="ewa-flp-dropzonedescriptionearea"><span class="ewa-flp-dropzonedescription">{1}</span></div><div class="ewa-flp-dropzonebucketarea">{2}{3}</div></div>';
Kb.Ubh='<div ID="{0}" class="ewa-flp-dropzones-new"><div class="ewa-flp-dropzonedescriptionearea-new"><div class="ewa-flp-dropzonedescription-new">{1}</div></div><div class="ewa-flp-dropzonebucketarea-new">{2}{3}{4}{5}</div></div>';Kb.Wbh='<div ID="{0}" class="ewa-flp-fieldmanager">{1}</div>';Kb.Xbh='<div ID="{0}" class="ewa-flp-fieldmanager-new">{1}</div>';Kb.nQj='<ul class="ewa-flp-unorderedlist ewa-flp-zonelist" {1}>{0}</ul>';Kb.Rzb='<li id="{0}" class="ewa-flp-dzlistitem">{1}{2}</li>';Kb.Qfh=
'<div id="dzempty" class="ewa-flp-dzemptylistitem"></div>';Kb.dwj='<span class="{0}" title="{1}"><label id="{2}" class="ewa-flp-dzlistitemlabel">{1}</label></span>';Kb.ewj='<span class="{0}" title="{1}"><label id="{2}" class="ewa-flp-dzlistitemlabel" style="max-width: calc(100% - 24px)">{1}</label></span>';Kb.cwj='<span class="ewa-flp-dropzonespanfiltermenu"><div class="clip5x3"><input id="{0}" class="{2}" type="image" title="{1}" alt="{1}" src="{3}" tabindex="0" role="{4}"/></div></span>';Kb.JYi=
"FieldListReactPaneHeaderId";Kb.EYi="FieldListReactPaneBodyId";Kb.LYi="FieldListReactPaneTitleId";Kb.FYi="FieldListReactPaneCloseButtonId";Kb.HYi="ewa-flp-react-pane";Kb.IYi="ewa-flp-react-header";Kb.KYi="cui-taskPaneTitle ewa-flp-react-title";Kb.DYi="ewa-flp-react-body";Kb.GYi="ewa-flp-react-close-button";Object(cc.a)(Kb,"FieldManagerPane",oc.a,[330,331,3,257,100]);var dd=le.a;vm(xb,dd);xb.prototype.create=function(){var la=this,nb=rd.GetServiceTaskFactory.Xa(this.$.da,12,477,this.tb),Wb=jc.a(this.$),
Dc=[nb,Wb];if(!Zc.a.Gd(this.$)){var zb=rd.GetServiceTaskFactory.create(this.$.da,203,this.ma,this.tb),hd=rd.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.tb);Array.add(Dc,zb);Array.add(Dc,hd)}je.TaskExtensions.Ba(je.TaskExtensions.ve(Dc,this.ma),function(){var ke=Kb.yHg(la.$,Wb.result,nb.result);ke&&(Zc.a.Gd(la.$)||Wb.result.rQ(ke),ke.R5());la.Fb(ke)},this.ma,3)};xb.prototype.dispose=function(){this.$=null;dd.prototype.dispose.call(this)};xb.ja=function(la){la.da.Ha(74,new xb(la))};Object(cc.a)(xb,
"FieldManagerTaskPaneFactory",le.a,[]);var Kd=b(139),yd=b(86),ze=b(519);Object(cc.a)(Ja,"SelectedRangeForPivot",null,[]);var te=b(185),lf=b(303),bf=b(140),xf=b(156);tl.Object.defineProperties(Lb,{xf:{configurable:!0,enumerable:!0,get:function(){return bf.a.jj(Lb.v6h,xf.a.ea(66),xf.a.ea(67),xf.a.ea(68),xf.a.ea(69),xf.a.ea(70),xf.a.ea(71),xf.a.ea(72))}}});Lb.v6h="<div class='DataSourceDiv' id='DataSourceDiv'> <div class='WACDialogRow' id='dataAnalyzeTitle'> <label id='dataChoice' class='WACDialogLabel' >{0}</label> </div> <div class='WACDialogRowNoBreak' id='sourceRadio'> <label id='sourceSelectLabel' class='WACDialogLabel' >{1}</label> </div> <div class='ewa-insertpt-dlg-sourceRange WACDialogRowNoBreak' id='sourceRangeText'> <label id='tableOrRange' class='ewa-insertpt-dlg-label' for='SourceRange' >{2}</label> <input type='text' id='sourceRange' class='WACDialogInput ewa-insertpt-dlg-input' aria-describedby=\"dataChoice . sourceSelectLabel\" maxlength=\"1024\" spellcheck=\"false\" autocomplete=\"off\" autocomplete=\"off\"/> </div> </div> <div class='PivotDestinationDiv' id='PivotDestinationDiv'> <div class='WACDialogRow' id='destinationTitle'> <label id='destinationLabel' class='WACDialogLabel' >{3}</label> </div> <div class='WACDialogRowNoBreak' id='destinationPickNewWorksheet'> <input type='radio' id='newWorksheet' name='destinationRadio' class='WACDialogRadio ewa-insertpt-label' alt='{4}' aria-describedby=destinationLabel title='{4}'></input> <label id='newWorksheetLabel' class='WACDialogLabel' for='newWorksheet' >{4}</label> </div> <div class='WACDialogRowNoBreak' id='destinationPickExistingWorksheet'> <input type='radio' id='existingWorksheet' name='destinationRadio' class='WACDialogRadio ewa-insertpt-label' alt='{5}' aria-describedby=destinationLabel title='{5}'></input> <label id='existingWorksheetLabel' class='WACDialogLabel' for='existingWorksheet' >{5}</label> <div class='WACDialogRowNoBreak' id='destinationRangeText'> <label id='Location' class='ewa-insertpt-dlg-label' for='DestinationRange' >{6}</label> <input type='text' id='destinationRange' class='WACDialogInput ewa-insertpt-dlg-input' maxlength=\"1024\" spellcheck=\"false\" autocomplete=\"off\" autocomplete=\"off\"/> </div> </div>";
Object(cc.a)(Lb,"InsertPivotTableDialogHtml",null,[]);var Og=b(164),mf=b(368);Ra.prototype.bindAction=function(la){this.h$a&&la&&(this.bpc=la,this.h$a.Czg(this.bpc))};Ra.prototype.BGj=function(){this.h$a&&this.bpc&&this.h$a.V3i(this.bpc)};Ra.prototype.isValid=function(){return!!this.h$a&&!!this.textBox};tl.Object.defineProperties(Ra.prototype,{textBox:{configurable:!0,enumerable:!0,get:function(){return this.AVb}},h$a:{configurable:!0,enumerable:!0,get:function(){return this.Npg}}});Object(cc.a)(Ra,
"TextBoxRadioButtonPair",null,[355]);var bg=b(1019),Wf=b(278);Object(cc.a)(Sa,"DialogData",null,[]);Object(cc.a)(sa,"MacroRecorderPivotTableCreatedPayload",null,[116]);var zf=b(382),tg=b(153),Hf=b(210),xc=zf.a;vm(xa,xc);xa.prototype.$2a=function(la){var nb=xc.prototype.$2a.call(this,la);var Wb=nb.ygc;nb=nb.returnValue;if(!nb){var Dc=Object(Jd.a)(Hf.a,this.$.xb);Dc&&Dc.tj(la)&&(nb=(la=Dc.getItemByName(la))&&1!==la.type?2===la.type?tg.a(la):la.usedRange:null,Wb=2===la.type)}return{returnValue:nb,ygc:Wb}};
Object(cc.a)(xa,"PivotTableRangeHighlightPolicy",zf.a,[]);var bd=lf.a;vm(ta,bd);ta.prototype.dispose=function(){Ac.ULS.sendTraceTag(537155782,0,50,"InsertPivotTableDialog.Dispose");this.dzc();bd.prototype.dispose.call(this)};ta.prototype.fZ=function(){var la;return la=new te.a,la.add(ta.xwc),la.add(ta.u4b),la};ta.prototype.r$g=function(){var la=!1;2!==this.vu&&(la=ta.t$g(this.FRa.value));la||1===this.vu||(la=ta.s$g(this.J$.checked,this.destinationRange.value));return la};ta.prototype.Cva=function(la){Ac.ULS.sendTraceTag(537155779,
0,50,"InsertPivotTableDialog.InitAndShow");var nb=this.kHh();this.xf=nb.xf;var Wb="";2!==this.vu&&(Wb=ta.yAd(la.rda,this.$.xa));var Dc=ta.kQ(Wb,la.v4b);1===this.vu?this.Zvj=Wb:2===this.vu&&(this.zEe=la.v4b);this.KJb(!1,!1);this.initializeAndShow(nb.title,this.w8e,Dc);this.rRd();this.Fij();this.TAa();Ac.ULS.sendTraceTag(537155778,0,50,"InsertPivotTableDialog.InitAndShow completed.")};ta.prototype.Yvj=function(la,nb){nb=(new xa(nb)).$2a(la);la=nb.ygc;nb=nb.returnValue;return!!nb&&nb.bba&&!la};ta.prototype.TAa=
function(){this.Tnb.disabled=this.r$g()};ta.prototype.rRd=function(){this.Iu.pa(Vd.a.change,this.yxa,this.glc);this.Iu.pa(Vd.a.change,this.J$,this.glc);this.Iu.pa(Vd.a.Vd,this.FRa,this.Xzf);this.Iu.pa(Vd.a.Vd,this.destinationRange,this.Lsf);this.rke(this.ar);this.qAa=!0};ta.prototype.dzc=function(){this.qAa&&(this.Iu.za(Vd.a.change,this.yxa,this.glc),this.Iu.za(Vd.a.change,this.J$,this.glc),this.Iu.za(Vd.a.Vd,this.FRa,this.Xzf),this.Iu.za(Vd.a.Vd,this.destinationRange,this.Lsf),this.$Lf(this.ar),
this.qAa=!1)};ta.prototype.Fij=function(){2===this.vu?this.destinationRange.focus():this.FRa.focus()};ta.prototype.k3f=function(){var la=new Wf.a(this.destinationRange),nb=new bg.a(this.J$,!1);this.GSd=new Ra(la,nb);this.tRd(this.GSd)};ta.prototype.R8f=function(){this.ZUd(this.GSd)};ta.prototype.Vk=function(){bd.prototype.Vk.call(this);Ac.ULS.sendTraceTag(537155777,0,50,"InsertPivotTableDialog.InitializeDialogElements");this.FRa=document.getElementById(ta.xwc);this.yxa=document.getElementById(ta.jof);
this.J$=document.getElementById(ta.L8c);this.destinationRange=document.getElementById(ta.u4b);switch(this.vu){case 0:case 2:this.destinationRange.value?ta.$Wf(this.J$,this.yxa):(this.destinationRange.disabled=!0,ta.$Wf(this.yxa,this.J$));Ae.k(this.$.kg)&&(this.yxa.checked=!1,this.yxa.disabled=!0,this.destinationRange.value="",this.J$.checked=!0);if(2===this.vu){this.FRa.disabled=!0;var la=document.getElementById(ta.D7g);la.style.visibility="hidden";la.style.display="none"}break;case 1:this.destinationRange.disabled=
!0,this.yxa.disabled=!0,this.J$.disabled=!0,la=document.getElementById(ta.RQi),la.style.visibility="hidden",la.style.display="none"}};ta.prototype.P5h=function(la,nb){var Wb=this;Ac.ULS.sendTraceTag(537155744,0,50,"InsertPivotTableDialog.InitiateInsertPivotTableOperation");var Dc=this.$.qa.ta,zb=1,hd=Dc.Xb(),ke=rf.o(id.g(this.$).ha.va.activeCell,this.$),He=null,df=null;switch(this.vu){case 0:zb=132;He=function(kf,ff,Ef){kf=Of.b(kf,Wb.nyd);var Qf=Dc.Oa(41,void 0===hd?null:hd);Qf.sheetRange=la;Qf.destinationRange=
nb;return Ce.i(Dc,"InsertPivotTable",Qf,kf,ff,Ef,null,0)};df=function(){return new sa(la,nb)};break;case 2:zb=219;He=function(kf,ff,Ef){return Yb(Dc,ke,nb,!1,Of.b(kf,Wb.nyd),ff,Ef,null,hd)};break;case 1:zb=219,He=function(kf,ff,Ef){return Yb(Dc,ke,la,!0,Of.b(kf,Wb.nyd),ff,Ef,null,hd)}}mf.a(this.$.userOperationManager,He,function(kf){return new af.a(zb,0,kf,void 0,df)},null)};ta.prototype.kHh=function(){var la=0;switch(this.vu){case 0:la=65;break;case 1:la=2086;break;case 2:la=2082}return new Sa(gb.a.instance.ea(la),
Lb.xf)};ta.prototype.uij=function(){var la=this.$.da.Aa(16);la&&la.Nvc(!1,null,!0)};ta.prototype.KJb=function(la,nb){var Wb=!la,Dc=this.$.da.Aa(183);Dc&&Dc.C_f(Wb,nb);la&&this.gridView.Bh&&this.gridView.Bh.Rt(Pd.a.taa)};ta.kQ=function(la,nb){var Wb=!nb,Dc={};return Dc[ta.xwc]=la,Dc[ta.u4b]=nb,Dc[ta.jof]=Wb,Dc[ta.L8c]=!Wb,Dc};ta.$Wf=function(la,nb){la.tabIndex=ta.Kxh;nb.tabIndex=ta.Ovi};ta.yAd=function(la,nb){la=la.startsWith("=")?la.substring(1,la.length):la;var Wb=rf.Z(la,nb);var Dc=Wb.sheetName;
var zb=Wb.range;Wb.returnValue&&zb&&(Dc||(Dc=nb.oa.name),la=rf.x(zb,Dc,!1,!0));return la};ta.t$g=function(la){return Zf.a.xn(la)};ta.s$g=function(la,nb){return la&&Zf.a.xn(nb)};tl.Object.defineProperties(ta.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"InsertPivotTableDialog"}},cellPickerSupportOnlyRanges:{configurable:!0,enumerable:!0,get:function(){return!0},set:function(la){Object(qb.b)(ta.prototype,this,"cellPickerSupportOnlyRanges",la)}},Kue:{configurable:!0,enumerable:!0,
get:function(){return!0}},Jue:{configurable:!0,enumerable:!0,get:function(){return!0}},onCommitDialogHandler:{configurable:!0,enumerable:!0,get:function(){var la=this;return function(){if(qf.EwaSettings.isChangeGateEnabled("OfficeVSO:5552557_CommitInsertPivotTableOnEnter")){var nb=la.destinationRange.value;1!==la.vu&&la.destinationRange.disabled&&(nb="");la.w8e(1,ta.kQ(la.FRa.value,nb))}}},set:function(la){Object(qb.b)(ta.prototype,this,"onCommitDialogHandler",la)}}});ta.eIe="";ta.Kxh=0;ta.Ovi=-1;
ta.xwc="sourceRange";ta.u4b="destinationRange";ta.jof="newWorksheet";ta.L8c="existingWorksheet";ta.D7g="DataSourceDiv";ta.RQi="PivotDestinationDiv";Object(cc.a)(ta,"InsertPivotTableDialog",lf.a,[]);Fb.prototype.Xc=function(){return!1};Fb.prototype.executeCommand=function(la,nb,Wb){var Dc=this;la=je.TaskExtensions.om();var zb=nb.command,hd=new Kd.a,ke=this.gridView.ha.va;switch(zb){case 2137617149:nb="StartingRanges"in Wb?Array.isArray(Wb.StartingRanges)?Wb.StartingRanges:null:ke.selectedRanges;this.sPh(nb,
hd);if(this.$.ig.get(29)&&qf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.Ideas",!1)&&this.wid){var He=new Kd.a;hd.task.CWR(function(Ef){Wb.SourceSelection=be.b(Ef)&&Ef.result&&Ef.result.rda?Ef.result.rda:"";return Dc.$.Ce(-1444574190,0,0,Wb).continueWith(function(Qf){be.b(Qf)&&Qf.result||(df=new ta(Dc.$,zb),df.Cva(Ef.result));He.setResult(!0)})});la=He.task}else{var df=new ta(this.$,zb);la=hd.task.continueWith(function(){df.Cva(hd.task.result)})}break;case -1128516639:var kf=this.$.qa.ta.Xb(),
ff=rf.o(ke.activeCell,this.$);nb=function(Ef,Qf,Vg){return lb(Dc.$.qa.ta,ff,Of.b(Ef,function(Kg){Dc.quf(Kg,hd,!1)}),Of.a(Qf,function(){Fb.puf(hd,Dc.$)}),Vg,null,kf)};nb=qf.EwaSettings.tc()?new af.a(554,0,nb,88):new ze.a(554,0,nb,24);nb.Qza(function(){return!0});this.$.userOperationManager.ic(nb,null);df=new ta(this.$,zb);la=hd.task.continueWith(function(){df.Cva(hd.task.result)});break;case -63037693:nb=new Ja;if(la=this.gridView.Vb.nq(ke.activeCell))la=og.Range.ld(la.IQf+1,la.left),nb.v4b=rf.h(la,
this.$,!0,void 0,!0);hd.setResult(nb);df=new ta(this.$,zb);la=hd.task.continueWith(function(){df.Cva(hd.task.result)})}return la};Fb.prototype.quf=function(la,nb,Wb){var Dc=la.Result,zb=new Ja;if(Wb||Dc){var hd=this.gridView.ha.va.Dh;Lf.a(la)?hd&&(zb.rda=this.gridView.ha.u_e(!0)):(zb.rda=Dc,hd&&Wb&&this.Tfh()&&!this.gridView.Vb.vk(this.gridView.ha.va.Qd)&&(zb.v4b=this.gridView.ha.Wad(!0,!0)))}else if(la=this.gridView.Vb.nq(this.gridView.ha.va.activeCell))zb.rda=la.dataSource;nb.setResult(zb)};Fb.prototype.Tfh=
function(){var la=this.gridView.ha.va.activeCell;la=new og.Range(la.top,la.left,la.top+1,la.left+1,!1,!1);la=this.gridView.sl("InsertPivotTableCommandHandler.EmptySquareAdjToActiveCell",la);try{for(la.$$rst();la.$$mn();)if(la.$$cu().text)return!1}finally{la&&la.dispose()}return!0};Fb.prototype.sPh=function(la,nb){var Wb=this;if(1!==la.length)nb.setResult(Object.assign(new Ja,{rda:""}));else{la=la[0];var Dc=this.gridView.Vb.vk(la);if(Dc)nb.setResult(Object.assign(new Ja,{rda:Dc.name,sourceRange:Dc.usedRange}));
else{var zb=this.$.qa.ta.Xb(),hd=rf.o(la,this.$),ke=rf.v(la,this.$);la=function(He,df,kf){function ff(Ef){return Ef(Wb.$.qa.ta,ke,hd,Of.b(He,function(Qf){Wb.quf(Qf,nb,!0)}),Of.a(df,function(){Fb.puf(nb,Wb.$)}),kf,null,zb)}return qf.EwaSettings.isChangeGateEnabled("OfficeVSO:5991641_PTPSExpandRange")?rd.GetServiceTaskFactory.Xa(Wb.$.da,482,483,1).CWR(function(Ef){be.b(Ef)&&ff(Ef.result.getExpandedRangeForPivotTable)}):ff(Fa)};la=qf.EwaSettings.tc()?new af.a(511,0,la,88):new ze.a(511,0,la,24);la.Qza(function(){return!0});
this.$.userOperationManager.ic(la,null)}}};Fb.prototype.Gc=function(la,nb){la=!1;switch(nb.command){case -1128516639:case -63037693:la=qf.EwaSettings.la(321);break;case 2137617149:la=!0}return la};Fb.prototype.fd=function(){return!1};Fb.puf=function(la,nb){Ac.ULS.sendTraceTag(537155786,0,50,"OnGetExpandedRangeForPivotTableFailedCallback: Failure. failing over to the selected range.");id.g(nb).ha.va.Dh?la.setResult(Object.assign(new Ja,{rda:id.g(nb).ha.Lha})):la.setResult(Object.assign(new Ja,{rda:""}))};
Fb.E6e="ExcelIdeas";Object(cc.a)(Fb,"InsertPivotTableCommandHandler",null,[237]);var Bd=Bc.a;vm(Qb,Bd);Qb.prototype.Md=function(){var la=this,nb=rd.GetServiceTaskFactory.create(this.$.da,128,this.ma,this.tb);je.TaskExtensions.Ba(je.TaskExtensions.ve([nb],this.ma),function(){la.Ed([new Fb(la.$)])},this.ma,3)};Qb.ja=function(la){Bc.a.de(91,new Qb(la))};Object(cc.a)(Qb,"InsertPivotTableCommandHandlerFactory",Bc.a,[]);var Ld=b(521),Od=Ld.a;vm(Gb,Od);Gb.prototype.I$g=function(la){var nb=this;je.TaskExtensions.Ba(rd.GetServiceTaskFactory.Xa(this.$.da,
103,104,0),function(Wb){var Dc=Wb.result,zb=id.g(nb.$),hd=Dc.teb(zb);if(hd){var ke=hd.gf;Wb=ke.Wf.top;ke=ke.Wf.left;Dc=hd.rI.x;hd=hd.rI.y}else Wb=ke=1,hd=Dc.$Ja(zb),Dc=hd.x,hd=hd.y;zb=0;for(var He=yl(la),df=He.next();!df.done;df=He.next())nb.y6h(parseInt(df.value),Wb,ke,Dc+zb,hd+zb),zb+=22},this.$.ma,8)};Gb.prototype.y6h=function(la,nb,Wb,Dc,zb){var hd=this,ke=new af.a(203,0,function(He,df,kf){var ff=hd.$.qa.ta.Xb();return Ce.M(hd.$.qa.ta,hd.D9a,hd.pivotTableName,la,0,nb,Wb,Dc,zb,He,df,kf,ff)},void 0,
function(){return new dg.a(hd.D9a,hd.pivotTableName,la,0)});this.$.userOperationManager.ic(ke,null)};Gb.prototype.Q5h=function(){var la=this,nb=new af.a(596,0,function(Wb,Dc,zb){var hd=la.$.qa.ta.Xb();return Ce.x(la.$.qa.ta,la.pivotTableName,la.D9a,Of.b(Wb,la.VDi),Dc,zb,hd)},16);this.$.userOperationManager.ic(nb,null)};tl.Object.defineProperties(Gb.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"InsertSlicerDialog"}}});Object(cc.a)(Gb,"InsertSlicerDialog",Ld.a,[]);hb.prototype.Xc=
function(){return!1};hb.prototype.executeCommand=function(la,nb){la=je.TaskExtensions.om();nb=nb.command;this.activeCell=this.ha.va.activeCell;switch(nb){case -1924368815:(this.Wc=id.g(this.$).Vb.nq(this.activeCell))&&!this.Wc.isOlap&&new Gb(this.$,this.Wc.pivotTableName,this.$.xa.oa.sheetName)}return la};hb.prototype.Gc=function(la,nb){la=!1;switch(nb.command){case -1924368815:la=!0}return la};hb.prototype.fd=function(){return!1};Object(cc.a)(hb,"InsertSlicerCommandHandler",null,[237]);var ef=Bc.a;
vm(ya,ef);ya.prototype.Md=function(){this.Ed([new hb(this.$)])};ya.ja=function(la){Bc.a.de(353,new ya(la))};Object(cc.a)(ya,"InsertSlicerCommandHandlerFactory",Bc.a,[]);var ag=b(77),lg=b(373),$f=b(685),Aa=b(322),Ob=b(30),Ec=b(610),md=b(57),Md=b(180),Me=b(113);da.prototype.executeCommand=function(la,nb){return vd.Task.Ta(this.interactiveReportView.refreshSelectedConnection(nb))};da.prototype.Gc=function(la,nb){return 32===la&&2054778433===nb.command};da.prototype.fd=function(){return!1};da.prototype.Xc=
function(la,nb){return 32===la&&(1588554917===nb||1891435765===nb||2054778433===nb&&!this.interactiveReportView.$fc)};da.ja=function(la,nb){la.Ka.b2(new da(nb))};Object(cc.a)(da,"InteractiveReportCommandHandler",null,[237]);var Qe=b(121);Tb.prototype.IQa=function(){};Tb.prototype.setVisible=function(la){this.iframe&&this.iframe.style&&(this.iframe.style.visibility=la?"visible":"hidden")};Tb.prototype.dispose=function(){ad.a.Fa(this.hia);this.hia=null};tl.Object.defineProperties(Tb.prototype,{XL:{configurable:!0,
enumerable:!0,get:function(){return this.iframe}},P7e:{configurable:!0,enumerable:!0,get:function(){return 1}},contentWindow:{configurable:!0,enumerable:!0,get:function(){return this.iframe.contentWindow}}});Object(cc.a)(Tb,"IFrameContentElement",null,[347,3]);Sb.prototype.IQa=function(la){this.o4a&&(this.o4a.src="data:image/png;charset=utf-8;base64,"+la,ed.DOMElementExtensions.setVisible(this.o4a,!0))};Sb.prototype.setVisible=function(la){ed.DOMElementExtensions.setVisible(this.g5b,la)};Sb.prototype.dispose=
function(){};tl.Object.defineProperties(Sb.prototype,{XL:{configurable:!0,enumerable:!0,get:function(){return this.g5b}},P7e:{configurable:!0,enumerable:!0,get:function(){return 7}},contentWindow:{configurable:!0,enumerable:!0,get:function(){return null}}});Object(cc.a)(Sb,"ImageContentElement",null,[347,3]);Xa.prototype.IQa=function(la){this.PF.IQa(la)};Xa.prototype.Zna=function(){this.interactiveReportView.isVisible&&this.XL&&this.XL.style&&(ed.DOMElementExtensions.HF(this.XL,this.interactiveReportView.domElement.clientHeight),
ed.DOMElementExtensions.Gq(this.XL,this.interactiveReportView.domElement.clientWidth))};Xa.prototype.n4f=function(){Nb.a.Af&&ed.DOMElementExtensions.co(this.interactiveReportView.domElement)===this.XL&&this.interactiveReportView.focus()};Xa.prototype.setVisible=function(la){la||this.n4f();this.PF.setVisible(la)};Xa.prototype.Agh=function(){ad.a.Fa(this.boc);this.boc=ae.a.instance.create(this.rRi,2E3,Uf.a.$6h)};Xa.prototype.dispose=function(){ed.DOMElementExtensions.Sf(this.PF.XL);ad.a.pc([this.boc,
this.PF]);this.M5d=this.PF=this.boc=null};tl.Object.defineProperties(Xa.prototype,{interactiveReportView:{configurable:!0,enumerable:!0,get:function(){return this.M5d}},Jva:{configurable:!0,enumerable:!0,get:function(){return this.dmg}},OPj:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext.WorkbookUri}},XL:{configurable:!0,enumerable:!0,get:function(){return this.PF.XL}},contentWindow:{configurable:!0,enumerable:!0,get:function(){return this.PF.contentWindow}}});Object(cc.a)(Xa,
"InteractiveReportFrameInfo",null,[3]);Object(cc.a)(Cb,"InteractiveReportSheetData",null,[]);Object(cc.a)(ob,"SheetVisibilityStateData",null,[]);var sf=b(39),Vf=b(53),Da=b(6),rb=b(38),$b=Aa.a;vm(Ma,$b);Ma.prototype.n6a=function(){return!0};Ma.prototype.dispose=function(){if(this.$){var la=this.$;la.xa.kF(this.ko);la.xb.kF(this.ko);la.xb.rg(this.Oe);la.xa.rg(this.Oe);sf.a(la).zq(this.Fxf);la.RC(this.aj);la.Ab.Wqc(this.W5);la.Ab.Vqc(this.V5);la.Ka.UGd(this.wCb);la.Ka.X$a(this.Jt);this.XGb.UC(this.wyf);
this.XGb=null}this.x4a&&(this.x4a.Zo(this.Pe),this.x4a.LH(this.Hm));qf.EwaSettings.tc()&&this.Us(this.Kxa);Array.contains(Ma.Qja,this)&&Array.remove(Ma.Qja,this);this.clearCache();ad.a.pc([this.LRa,this.x4a,this.Ki]);this.Ki=this.x4a=this.LRa=null;ed.DOMElementExtensions.Sf(this.domElement);this.Nuc.clear();this.d3.clear();this.o_b=this.businessBar=this.jzb=this.Msa=this.W_a=this.AGb=null;$b.prototype.dispose.call(this)};Ma.prototype.refreshSelectedConnection=function(la){var nb=this.q_e();if(nb){var Wb=
nb.IsEmbedded?-1:nb.SourceIndex;De.a(this.$).z$a(nb.ConnectionName,Wb,la);return!0}return!1};Ma.prototype.y9b=function(la){var nb=this;Ac.ULS.sendTraceTag(537155663,0,50,"InteractiveReportView.GetBootstrapData()");var Wb=this.$,Dc=this.AGb;if(Vf.c(Wb))Ac.ULS.sendTraceTag(537155662,0,50,"InteractiveReportView.GetBootstrapData: During RenderCachedContent");else if(mh.a(Wb).ui.activityName!==Da.a.idle)this.Byc=!0;else{this.Byc=!1;var zb=function(hd,ke,He){var df=Wb.qa.ta.Xb(),kf=Wb.qa.ta;hd=Of.b(hd,
nb.rDi);df=kf.Oa(1,df);df.connectionsOnly=!!Dc;return Ce.i(kf,"GetInteractiveReportBootstrapData",df,hd,ke,He,la,0)};qf.EwaSettings.tc()?Wb.userOperationManager.ic(new af.a(512,0,zb,64),null):Wb.userOperationManager.ic(new ze.a(512,0,zb),null)}};Ma.prototype.q_e=function(){for(var la=0;la<this.d3.count;++la)for(var nb=this.d3.ag(la),Wb=yl(nb.SlidesIds),Dc=Wb.next();!Dc.done;Dc=Wb.next())if(Dc.value===this.Msa)return nb;return null};Ma.prototype.Uvg=function(la,nb){this.hashCode=this.Ca.hga(la,nb,
this.hashCode)};Ma.prototype.clearCache=function(){this.Ca.$ya(this.hashCode);this.hashCode=null};Ma.prototype.w9e=function(){this.G6c();var la=this.$.oa;return this.isVisible=!!la&&Rc.j(la)};Ma.prototype.Twg=function(){Array.contains(Ma.Qja,this)||Array.add(Ma.Qja,this)};Ma.prototype.xQg=function(){ad.a.Fa(this.LRa);this.LRa=null};Ma.prototype.KRa=function(la){var nb=this;this.w9e()&&(this.Twg(),this.xQg(),je.TaskExtensions.Ba(this.vne,function(){var Wb=6===nb.vne.status;Wb&&!nb.PJe&&(nb.U6h(),nb.PJe=
!0);nb.w9e()&&(nb.ili(la||!Wb),Wb||nb.LWi(),nb.$.Daa||nb.focus())},this.Dxj,0))};Ma.prototype.G6c=function(){var la=this.$.workbookContext.WorkbookFileVersionId;la&&(this.jzb||(this.jzb=la),this.jzb!==la&&this.R0b())};Ma.prototype.LJf=function(la){this.W_a=la.DataSources;la=yl(la.DataConnections);for(var nb=la.next();!nb.done;nb=la.next()){nb=nb.value;var Wb=nb.ConnectionName.toLowerCase(),Dc=this.d3.getItem(Wb);Dc&&(Dc.ConnectionString!==nb.ConnectionString||new Date(Dc.RefreshTimestampUTC)<new Date(nb.RefreshTimestampUTC))&&
(nb.IsEmbedded&&this.GZi(nb.SecurityToken),this.Q_i(nb.DataSourceName),this.d3.remove(Wb));this.d3.add(Wb,nb)}this.XLa(8)&&this.isVisible&&this.Tdb(this.Ki,null)};Ma.prototype.GZi=function(la){if(this.pwa){var nb=me.AFrameworkApplication.Hd.C6a,Wb=this.$.fa.sessionId;try{InteractiveReportAPI.Rebind(this.Ki.contentWindow,this.Ki.Jva,this.W_a,la,nb,Wb)}catch(Dc){Ac.ULS.sendTraceTag(537155657,0,10,"RebindInteractiveReport: Failed to call Rebind: {0}",Dc.message)}}};Ma.prototype.Q_i=function(la){if(this.pwa){var nb=
me.AFrameworkApplication.Hd.C6a,Wb=this.$.fa.sessionId;try{InteractiveReportAPI.Refresh(this.Ki.contentWindow,this.Ki.Jva,0,la,nb,Wb)}catch(Dc){Ac.ULS.sendTraceTag(537155655,0,10,"RefreshInteractiveReport: Failed to call Refresh: {0}",Dc.message)}}};Ma.prototype.Qma=function(la){if(la.$c.block.oa.active){la=la.$c.block.qe;var nb=new Cb(la.SlideId,la.FallbackImage);this.Nuc.add(this.HWb,nb);this.Ki.interactiveReportContent||(this.Ki.interactiveReportContent=la);this.Tdb(this.Ki,nb)}};Ma.prototype.bki=
function(la){if(this.pwa)try{InteractiveReportAPI.LeaveSlide(this.Ki.contentWindow,this.Ki.Jva)}catch(nb){Ac.ULS.sendTraceTag(537155651,0,10,"LeaveInteractiveReport(): Failed to call LeaveSlide: {0}",nb.message)}this.Msa=null;la&&(this.Ki.setVisible(!1),this.$.isEditMode&&this.IDd(!0))};Ma.prototype.R0b=function(){ad.a.Fa(this.Ki);this.Ki=null;this.d3.clear();this.Nuc.clear();this.AGb=this.W_a=this.Msa=null;this.Byc=this.ZMb=!1;this.jzb=this.$.workbookContext.WorkbookFileVersionId;this.clearCache()};
Ma.prototype.VLb=function(){if(this.Ki&&this.ZMb&&Rc.j(this.$.oa))try{InteractiveReportAPI.UnHideWindowedElements(this.Ki.contentWindow,this.Ki.Jva),this.ZMb=!1}catch(la){Ac.ULS.sendTraceTag(537155618,0,10,"UnHideInteractiveReport: UnHideWindowedElements failed - {0}",la.message)}};Ma.prototype.jcc=function(){if(this.Ki&&!this.ZMb&&Rc.j(this.$.oa))try{this.Ki.n4f(),InteractiveReportAPI.HideWindowedElements(this.Ki.contentWindow,this.Ki.Jva),this.ZMb=!0}catch(la){Ac.ULS.sendTraceTag(537155617,0,10,
"HideInteractiveReport: HideWindowedElements failed - {0}",la.message)}};Ma.prototype.ili=function(la){var nb=this.$;if(this.Ki)this.VLb(),this.Ki.Zna(),this.Ki.setVisible(!0);else{try{InteractiveReportAPI.ClearState()}catch(hd){}var Wb=this.domElement.id+"_irframe",Dc=document.getElementById(Wb);Dc&&this.domElement.removeChild(Dc);Dc=nb.lc;la=la||!(Dc.allowFiltering&&Dc.allowSorting&&Dc.allowInteractivity);var zb=this.d7h;zb&&(Dc.allowHyperlinks||(zb+=Ma.Y6h),Dc.inEmbedView&&(zb+=Ma.Z6h),Dc.isBiPreviewOverride&&
(zb+=Ma.V6h));this.Ki=new Xa(this,Wb,zb,la||!this.msb,nb);this.domElement.appendChild(this.Ki.XL);la||this.msb||(this.Ki.sZ=8)}(this.pwa||this.XLa(1)||this.XLa(7))&&this.Tdb(this.Ki,this.GWb);this.Uvg(nb.oa,md.a.Gqb)};Ma.prototype.Mye=function(la){var nb=this;la.sZ=2;De.a(this.$).pu(!0,function(Wb){la.sZ=8;Wb&&(nb.msb=!0,nb.R0b(),nb.KRa(!1))})};Ma.prototype.KNi=function(la){for(var nb=this.d3.count,Wb=Array(nb),Dc=0;Dc<nb;++Dc){var zb=this.d3.ag(Dc),hd={};hd.Name=zb.ConnectionName;hd.Connection=zb.ConnectionString;
hd.SecurityToken=zb.SecurityToken;hd.DataSourceName=zb.DataSourceName;hd.IsEmpty=0>zb.SourceIndex&&zb.IsEmbedded;Wb[Dc]=hd}nb=me.AFrameworkApplication.Hd.C6a;Dc=this.$.fa.sessionId;zb=this.GWb.owc;try{InteractiveReportAPI.OpenReport(la.contentWindow,la.Jva,this.AGb,null,zb,this.W_a,Wb,la.OPj,nb,Dc),this.$.isEditMode&&this.IDd()}catch(ke){Ac.ULS.sendTraceTag(537155605,0,10,"OnGetBootstrapDataSuccess: Failed to call OpenReport: {0}",ke.message);return}la.sZ=5;this.Msa=zb;this.Tdb(la,null)};Ma.prototype.Tdb=
function(la,nb){switch(la.sZ){case 6:this.IQa(this.Ki,nb);break;case 1:this.msb?(this.y9b(la),la.sZ=3):this.Mye(la);break;case 4:la.J8e&&la.interactiveReportContent&&this.KNi(la);break;case 5:this.Nui(la,nb);break;case 8:this.SUf(nb);this.Mye(la);break;case 7:this.SUf(nb)}};Ma.prototype.U6h=function(){try{InteractiveReportAPI.RegisterEvent("Initialized",Ma.c7h),InteractiveReportAPI.RegisterEvent("UserInteractivity",Ma.h7h),InteractiveReportAPI.RegisterEvent("GetFallbackImage",Ma.a7h),InteractiveReportAPI.RegisterEvent("HostKeyPressed",
Ma.b7h),qf.EwaSettings.la(34)&&InteractiveReportAPI.RegisterEvent("UserModifiedPV",Ma.X6h)}catch(la){}};Ma.prototype.YMb=function(la){return!!this.Ki&&!!this.Ki.XL&&this.Ki.contentWindow===la};Ma.prototype.NFi=function(la){this.YMb(la)&&(this.Ki.J8e=!0,this.XLa(5)?this.Ki.sZ=4:this.XLa(6)&&(this.Ki.sZ=1),this.isVisible&&this.Tdb(this.Ki,this.GWb))};Ma.prototype.OFi=function(la){if(this.isVisible&&this.YMb(la)&&Me.a(Oc.a.Ra,this.tzb)>=Ma.xii&&this.$.fa.oc){this.tzb=Oc.a.Ra.Kb;la=this.$.qa.ta;var nb=
this.zEi,Wb=la.Oa(1,null);Ce.i(la,"GetSessionInformation",Wb,nb,null,null,null,4)}};Ma.prototype.LFi=function(la,nb){if(this.YMb(la)){var Wb=this.$,Dc=nb.SessionId;nb.ContentChanged&&(la=function(zb,hd,ke){var He=Wb.qa.ta.Xb(),df=Wb.qa.ta;zb=Of.b(zb);He=df.Oa(9,He);He.sessionId=Dc;return Ce.i(df,"InteractiveReportDataWasModified",He,zb,hd,ke,null,0)},qf.EwaSettings.tc()?Wb.userOperationManager.ic(new af.a(513,0,la,64),null):Wb.userOperationManager.ic(new ze.a(513,0,la),null))}};Ma.prototype.iFi=function(la,
nb){if(this.YMb(la)&&nb){la=[];nb.ModifierCtrl&&Array.add(la,"Control");nb.ModifierMeta&&Array.add(la,"Meta");nb.ModifierAlt&&Array.add(la,"Alt");nb.ModifierShift&&Array.add(la,"Shift");var Wb=document.createEvent("KeyboardEvent");Wb.initKeyboardEvent("keypress",!0,!0,null,String.fromCharCode(nb.KeyCode),0,la.join(" "),!1);nb=new Sys.UI.DomEvent(Wb);nb=this.$.shortcutKeyManager.xt(nb);this.executeRibbonCommand(nb)}};Ma.prototype.executeRibbonCommand=function(la){1461300262!==la&&(la=new Rf.a(la,1,
1,6,null),this.$.Ka.Zb(la))};Ma.prototype.MFi=function(la){this.YMb(la)&&(this.Ki.sZ=6,this.IQa(this.Ki,this.GWb))};Ma.prototype.SUf=function(la){this.isVisible&&la&&la.x7b&&this.Ki.IQa(la.x7b)};Ma.prototype.IQa=function(la,nb){if(this.isVisible&&nb&&nb.x7b)try{InteractiveReportAPI.SetFallbackImage(la.contentWindow,la.Jva,nb.x7b)}catch(Wb){}};Ma.prototype.Nui=function(la,nb){if(this.isVisible){if(nb&&(!this.Msa||nb.owc!==this.Msa)){var Wb=me.AFrameworkApplication.Hd.C6a,Dc=this.$.fa.sessionId;try{this.$.isEditMode&&
this.IDd(),InteractiveReportAPI.Navigate(la.contentWindow,la.Jva,nb.owc,Wb,Dc)}catch(zb){Ac.ULS.sendTraceTag(537155593,0,10,"NavigateToActiveSheetSlide: Failed to call InteractiveReportApi.Navigate: {0}",zb.message);return}this.Msa=nb.owc}this.YEb(!0)}};Ma.prototype.XLa=function(la){return!!this.Ki&&this.Ki.sZ===la};Ma.prototype.IDd=function(la){var nb=this;la=void 0===la?!1:la;this.businessBar?la?this.businessBar.removeEntry(19):this.businessBar.hg(19,null):this.o_b&&je.TaskExtensions.Ba(this.o_b.value,
function(Wb){Wb=Wb.result;nb.businessBar=Wb;nb.o_b=null;la?Wb.removeEntry(19):Wb.hg(19,null)},this.$.ma)};Ma.IFa=function(la){if(!la.da.Aa(36)){var nb=new $f.a(function(){return rd.GetServiceTaskFactory.Xa(la.da,5,4,1)}),Wb=rd.GetServiceTaskFactory.create(la.da,168,la.ma,1);je.TaskExtensions.Ba(Wb,function(){var Dc=la.Ue;Dc=new Ma(la,Dc.appendChild(Dc.ownerDocument.createElement("div")),Wb.result,nb);la.da.Ha(36,Dc)},la.ma)}};Ma.X6h=function(la,nb){Ma.Qja.forEach(function(Wb){Wb.LFi(la,nb)})};Ma.c7h=
function(la){Ma.Qja.forEach(function(nb){nb.NFi(la)})};Ma.h7h=function(la){Ma.Qja.forEach(function(nb){nb.OFi(la)})};Ma.a7h=function(la){Ma.Qja.forEach(function(nb){nb.MFi(la)})};Ma.b7h=function(la,nb){Ma.Qja.forEach(function(Wb){Wb.iFi(la,nb)})};Ma.S_g=function(la){la=qf.EwaSettings.la(24)?Ma.Z4g(la.workbookContext.FullDocumentInfo.InteractiveReportsApiUrl).task:zd.a.loadScript(57,4,1,!0);return je.TaskExtensions.Ba(la,function(){try{InteractiveReportAPI.InitScript(rb.c,rb.b)}catch(nb){throw nb;
}},zd.a.ma)};Ma.Z4g=function(la){var nb=new Kd.a;if(!la)return Ac.ULS.sendTraceTag(537155588,0,10,"InteractiveReportView.CreateApiLoadAndInitializeTask: interactive report api url is null"),nb.setException(Error.create("apiUrl is null")),nb;lg.a.JIe(la,function(Wb,Dc){Dc.succeeded?nb.setResult(!0):(nb.setException(Error.create("Network")),Ac.ULS.sendTraceTag(537155585,0,10,"InteractiveReportView.CreateApiLoadAndInitializeTask: script {0} failed to load successfully",la))},4,!0);return nb};tl.Object.defineProperties(Ma.prototype,
{Ca:{configurable:!0,enumerable:!0,get:function(){return this.x4a}},Te:{configurable:!0,enumerable:!0,get:function(){return 32}},$fc:{configurable:!0,enumerable:!0,get:function(){if(this.pwa){var la=this.q_e();return!!la&&-1!==la.SourceIndex}return!1}},Dxj:{configurable:!0,enumerable:!0,get:function(){this.LRa=this.LRa||new Md.a;return this.LRa.token}},vne:{configurable:!0,enumerable:!0,get:function(){return this.NZd||(this.NZd=Ma.S_g(this.$))}},HWb:{configurable:!0,enumerable:!0,get:function(){return this.$.oa.index.toString()}},
GWb:{configurable:!0,enumerable:!0,get:function(){return this.Nuc.getItem(this.HWb)}},d7h:{configurable:!0,enumerable:!0,get:function(){if(qf.EwaSettings.la(24)){var la=ag.a.fT(this.$.workbookContext.FullDocumentInfo.InteractiveReportsServiceUrl,Ma.j7h,this.$.workbookContext.FullDocumentInfo.WorkbookPath);la=ag.a.fT(la,Ma.e7h,Ma.f7h);la=ag.a.fT(la,Ma.W6h,this.$.ya.DataCultureTag);return la=ag.a.fT(la,Ma.g7h,this.$.ya.UICultureTag)}return zd.a.current.vK.InteractiveReportServiceUrl}},pwa:{configurable:!0,
enumerable:!0,get:function(){return this.XLa(5)}}});Ma.Y6h="&EnableHyperlinks=false";Ma.Z6h="&EmbeddedView=true";Ma.V6h="&BIPreview=true";Ma.j7h="WORKBOOKURL";Ma.e7h="ServiceName";Ma.f7h="ExcelServices";Ma.W6h="culture";Ma.g7h="uiculture";Ma.xii=3E4;Ma.Qja=[];Object(cc.a)(Ma,"InteractiveReportView",Aa.a,[]);var vc=b(111),sb=b(1130),ec=b(201),ce=b(79),Rd=vc.a;vm(Ia,Rd);Ia.prototype.execute=function(la){var nb=Object(Jd.a)(8,la.Ge),Wb=zd.a.current.vK;la.activityState[ce.a.zL]=ce.a.F7a;la.activityState[ce.a.W1]=
Ia.q1g(nb,Wb.OfferPowerBiTrialUrl,Wb.OfferPowerBiTrialCompleteSignUpParameter);la.activityState[ce.a.SRc]=!0;nb.Mk.ty("PowerBiTrial");return 3};Ia.q1g=function(la,nb,Wb){la=new Sys.StringBuilder(la.isEditMode?la.workbookContext.FullDocumentInfo.HostEditUrl:la.workbookContext.FullDocumentInfo.HostViewUrl);ec.a.Vf(la,sb.a.dWi,"1");la=encodeURIComponent(la.toString());return String.format("{0}&{1}={2}{3}",nb,"ru",Wb,encodeURIComponent(String.format("?{0}={1}","returnUrl",la)))};Object(cc.a)(Ia,"OfferPowerBiTrialActivity",
vc.a,[]);var Ne=le.a;vm(pa,Ne);pa.prototype.create=function(){this.Fb(new Ia(Da.a.LQd,Da.a.f_))};pa.ja=function(la){la.da.Ha(79,new pa)};Object(cc.a)(pa,"OfferPowerBiTrialFactory",le.a,[]);var Be=b(1276),sd=b(78),cf=b(52),Dd=b(601);ma.UQi=function(){return bf.a.jj(ma.Tj,xf.a.ea(2088),xf.a.ea(2089),xf.a.ea(2090),xf.a.ea(2091))};ma.WQi=function(la,nb,Wb,Dc,zb){return bf.a.jj(ma.lAj,zb,la?"checked":"unchecked",nb,Wb,Dc)};ma.Tj="<div class='FilterConnectionsDiv' id='FilterConnectionsDiv'> <div class='WACDialogRow' id='filterConnectionsDialogInstructions'> <label id='filterConnectionsDialogInstructionsText' class='WACDialogLabel' >{0}</label> </div> <hr class='ewa-filterconnections-dlg-hr' /> </div> <table id='filterConnectionsDialogTable' class='ewa-filterconnections-dlg-table ewa-scrollbars' cellpadding=5 width='100%' role='presentation'> <thead> <tr> <th class='ewa-filterconnections-dlg-level'> </th> <th class='ewa-filterconnections-dlg-column'> <span id='thCaption' class='WACDialogSpan'>{1}</span> </th> <th class='ewa-filterconnections-dlg-column ewa-dlg-unselectable'> <span id='thName' class='WACDialogSpan'>{2}</span> </th> <th class='ewa-filterconnections-dlg-column ewa-dlg-unselectable' colspan='2'> <span id='thSheet' class='WACDialogSpan'>{3}</span> </th> </tr> </thead> <tbody> </tbody> <tfoot> </tfoot> </table>";
ma.lAj="<tr> <th class='ewa-filterconnections-dlg-level ewa-dlg-unselectable'> <input type='checkbox' id='{0}' class='checkclassname ewa-dlg-unselectable' {1} aria-label='{2}'}></input> </th> <td class='ewa-filterconnections-dlg-column'> {2} </td> <td class='ewa-filterconnections-dlg-column'> {3} </td> <td class='ewa-filterconnections-dlg-column'> {4} </td> </tr>";Object(cc.a)(ma,"PivotTableFilterConnectionsDialogHtml",null,[]);var tf=lf.a;vm(wa,tf);wa.prototype.Kh=function(){var la=this,nb=this.$.qa.ta.Xb(),
Wb=new af.a(584,0,function(Dc,zb,hd){var ke=la.$.qa.ta,He=la.pivotTableName,df=la.D9a;Dc=Of.b(Dc,la.rEi);zb=Of.a(zb,la.qEi);var kf=ke.Oa(1,void 0===nb?null:nb);kf.pivotTableName=He;kf.sheetName=df;return Ce.i(ke,"GetPivotTableConnectionsInfo",kf,Dc,zb,hd,null,0)},16);this.$.userOperationManager.ic(Wb,null)};wa.prototype.FRi=function(la){for(var nb=0;nb<this.jsa.length;nb++){var Wb=this.jsa[nb],Dc="filterConnectionsCheckbox"+Wb.SlicerCacheIndex.toString();la.insertRow().innerHTML=ma.WQi(Wb.IsConnected,
Wb.ConnectionCaption,Wb.ConnectionName,Wb.ConnectionSheet,Dc)}};wa.prototype.L5h=function(){for(var la={},nb=0;nb<this.jsa.length;nb++){var Wb=this.jsa[nb];la["filterConnectionsCheckbox"+Wb.SlicerCacheIndex.toString()]=Wb.IsConnected}return la};wa.prototype.f6g=function(la){for(var nb=Array(this.jsa.length),Wb=0;Wb<this.jsa.length;Wb++){var Dc=this.jsa[Wb],zb=Dc.SlicerCacheIndex,hd={};hd.IsConnected=la["filterConnectionsCheckbox"+Dc.SlicerCacheIndex.toString()];hd.SlicerCacheIndex=zb;nb[Wb]=hd}return nb};
tl.Object.defineProperties(wa.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"PivotTableFilterConnectionsDialog"}}});Object(cc.a)(wa,"PivotTableFilterConnectionsDialog",lf.a,[]);Z.prototype.Xc=function(){return!1};Z.prototype.executeCommand=function(la,nb,Wb){var Dc=this;la=je.TaskExtensions.om();var zb=nb.command,hd=this.$.qa.ta,ke=null,He=1,df=this.$.qa.ta.Xb();this.activeCell=rf.o(this.ha.va.activeCell,this.$);this.Wc=id.g(this.$).Vb.nq(this.ha.va.activeCell);switch(zb){case 498319061:Ac.ULS.sendTraceTag(537154699,
0,50,"PivotCommand.ExecuteCommand: PivotTableShowExpandButton is triggered");if(!this.Wc)return la;ke=function(kf,ff,Ef){var Qf=Dc.activeCell,Vg=!Dc.Wc.showDrillIndicators,Kg=hd.Oa(41,void 0===df?null:df);Kg.activeCell=Qf;Kg.showDrillInIndicator=Vg;return Ce.i(hd,"PivotTableShowExpandButton",Kg,kf,ff,Ef,null,0)};He=218;break;case 1529441790:je.TaskExtensions.Ba(rd.GetServiceTaskFactory.Xa(this.$.da,441,442,0),function(kf){(kf=kf.result)&&kf.xsj()},this.$.ma,3);break;case -596850665:this.Wc&&(new wa(this.$,
this.Wc.pivotTableName,this.$.xa.oa.sheetName)).Kh();break;case -1556797033:this.Wc&&this.ded(this.jEi,this.iEi);break;case -1611233597:this.Wc&&this.ded(this.lEi,this.kEi);break;case 786260386:this.Wc&&(Wb=Number.parseInvariant(Wb.MenuItemId),this.ded(this.hEi,this.gEi,Wb));break;case 1771091375:this.showDetails();break;default:la=Sc.a(zb)}ke&&(la=mf.a(this.$.userOperationManager,ke,function(kf){return new af.a(He,0,kf,void 0,null)},nb));return la};Z.prototype.Gc=function(la,nb){la=!1;switch(nb.command){case 498319061:la=
qf.EwaSettings.la(321);break;case 1529441790:la=qf.EwaSettings.la(324);break;case -596850665:la=qf.EwaSettings.la(440);break;case -1556797033:la=!0;break;case 786260386:case -1611233597:la=!0;break;case 1771091375:la=qf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)}return la};Z.prototype.fd=function(){return!1};Z.prototype.dispose=function(){this.$=null};Z.prototype.showDetails=function(){var la=this;mf.a(this.$.userOperationManager,function(nb,Wb,Dc){var zb=
la.$.qa.ta,hd=la.activeCell;nb=Of.b(nb,Object(Bg.a)(la,la.CKi,"onShowDetailsDone"));var ke=zb.Oa(41,null);ke.activeCell=hd;return Ce.i(zb,"PivotTableShowDetails",ke,nb,Wb,Dc,null,0)},function(nb){return new af.a(262,0,nb,void 0,null)},null)};Z.prototype.CKi=function(la){Lf.a(la)||(la=this.$.xa.getItemByName(la.Result.toString()))&&la.activate()};Z.prototype.ded=function(la,nb,Wb){var Dc=this;Wb=void 0===Wb?0:Wb;this.$.userOperationManager.ic(new af.a(1016,0,function(zb,hd,ke){return Ce.A(Dc.$.qa.ta,
Dc.activeCell,Dc.Wc.externalSourceIndex,Dc.Wc.pivotTableName,Dc.$.domElement.id,Dc.$.isChromeRtl,Dc.$.workbookContext.NovMode,Of.b(zb,la),Of.a(hd,nb),ke,Wb||null,null,!0)},16),null)};Z.prototype.Rqd=function(la){if(this.gpd(la))if(this.hpd(la)){var nb=la.PivotFields[0];if(this.cpd(nb)){var Wb={};Wb.FieldId=nb.IdString;Wb.Location=this.activeCell;Wb.DataSourceIndex=this.Wc.externalSourceIndex;Wb.SelectedFieldIndex=nb.SortByValueIndex;var Dc=nb.DisplayString;Dc.length>Be.n&&(Dc=Dc.substring(0,Be.n)+
"...");Wb.ColumnName=Jf.a.If(Dc);Wb.SortAscend=nb.IsSortedAscending&&nb.IsSortedByValue;la=Object.assign(new Dd.a,{pivotName:this.Wc.pivotTableName,kKb:Wb,Qsa:this.Sia(la.PivotDataItems,!1),Rsa:this.Sia(la.PivotDataItems,!0)});nb={};this.$.Ce(-1681601147,sd.a.Wb,0,(nb.launchSortByValueDialogCommandData=la,nb))}else this.ri(156,"AutoFilterSortByValueIncorrectSelection")}else this.ri(734,"SortByValueNoDataFields")};Z.prototype.Sqd=function(la){if(this.gpd(la))if(this.hpd(la)){var nb=la.PivotFields[0];
if(this.cpd(nb)){var Wb={};Wb.FilterType=Be.e;Wb.AdvancedFilter=la.AdvancedFiltering;Wb.Location=this.activeCell;Wb.DataSourceIndex=this.Wc.externalSourceIndex;Wb.MaxCount=Be.a;Wb.Title=nb.DisplayString;Wb.IsPivotFilter=!0;Wb.FieldId=nb.IdString;Wb.AnchorType=0;(nb=nb.FilterParameter)?(Wb.Count=0<nb.FilterValue?nb.FilterValue.toString():"",Wb.Top=nb.IsTopFilter,Wb.Type=nb.FilterType,Wb.SelectedFieldIndex=Be.g(la.PivotDataFields,nb.DataFieldId)):(Wb.Count=Be.b,Wb.Top=!0,Wb.Type=1,Wb.SelectedFieldIndex=
Be.o);nb=new Rf.a(856841605,sd.a.Wb,this.$.ed,0,null);Wb={Top10FilterParameters:Wb};Wb.PivotName=this.Wc.pivotTableName;Wb.DataFieldIds=this.Sia(la.PivotDataFields,!1);Wb.DataFieldNames=this.Sia(la.PivotDataFields,!0);la={};la[sd.a.Kg]=cf.a.Hc(Wb);this.$.Ka.Zb(nb,la)}}else this.ri(244,"ValueFilterNoDataFields")};Z.prototype.gpd=function(la){return 1===la.PivotFields.length};Z.prototype.hpd=function(la){return 0<la.PivotDataFields.length&&0<la.PivotDataItems.length};Z.prototype.cpd=function(la){return!la.IsDataField&&
!la.IsFieldInPageFilterArea};Z.prototype.Oqd=function(la,nb){if(this.gpd(la))if(Be.m(nb)&&!this.hpd(la))this.ri(244,"ValueFilterNoDataFields");else{var Wb=la.PivotFields[0];if(this.cpd(Wb)){var Dc=this.svh(Wb.PivotFilterParameters,nb),zb={};zb.ActiveCompareType=this.d7g(nb);zb.ShowDataFields=Be.m(nb);zb.FilterType=this.NIh(nb);zb.ValueTypeText=Be.j(nb);zb.Location=this.activeCell;zb.ColumnName=Wb.DisplayString;zb.IsPivotFilter=!0;zb.IsTimeSlicer=!1;zb.NonNumericCaptionFilteringEnabled=Wb.IsNonnumericCaptionFilteringEnabled;
zb.FieldId=Wb.IdString;zb.AnchorType=0;zb.ControlGroupOrder=Be.h();zb.ShowWholeDays=Wb.IsDateField&&!Be.m(nb);zb.EnabledWholeDays=Wb.IsEnabledWholeDays;zb.WholeDays=Wb.IsWholeDays;zb.MemberProperties=!1;zb.SelectedFieldIndex=Be.o;Dc&&(Be.m(nb)||Wb.IsDataField?(zb.Value1=Dc.FilterValue1.toString(),zb.Value2=Dc.FilterValue2.toString(),Be.m(nb)&&(zb.SelectedFieldIndex=Be.g(la.PivotDataFields,Dc.DataFieldId))):(zb.Value1=Dc.FilterString1,zb.Value2=Dc.FilterString2));nb=new Rf.a(-2042011094,sd.a.Wb,this.$.ed,
0,null);zb={CustomFilterParameters:zb};zb.FieldId=Wb.IdString;zb.PivotName=this.Wc.pivotTableName;zb.DataFieldIds=this.Sia(la.PivotDataFields,!1);zb.DataFieldNames=this.Sia(la.PivotDataFields,!0);la={};la[sd.a.Kg]=cf.a.Hc(zb);this.$.Ka.Zb(nb,la)}}};Z.prototype.Sia=function(la,nb){for(var Wb=[],Dc=0;Dc<la.length;++Dc)nb?Wb.push(la[Dc].DisplayString):Wb.push(la[Dc].IdString);return Wb};Z.prototype.d7g=function(la){switch(la){case 4:case 18:case 26:return 0;case 5:case 19:case 62:return 1;case 6:return 2;
case 7:return 3;case 8:return 4;case 9:return 5;case 10:return 6;case 11:return 7;case 12:case 20:case 28:return 8;case 13:case 21:case 64:return 9;case 14:case 22:case 27:return 10;case 15:case 23:case 63:return 11;case 16:case 24:case 29:return 12;case 17:case 25:case 65:return 13}return 14};Z.prototype.NIh=function(la){return Be.j(la)?Be.c:Be.m(la)?Be.f:Be.k(la)?Be.d:""};Z.prototype.svh=function(la,nb){for(var Wb=0;Wb<la.length;++Wb)if(la[Wb].FilterType===nb)return la[Wb];return null};Z.prototype.ri=
function(la,nb){la=Zg.a.jd(1,0,0,la,0,0,nb);sf.a(this.$).ri(la)};Object(cc.a)(Z,"PivotCommandHandler",null,[237,3]);var vf=Bc.a;vm(na,vf);na.prototype.Md=function(){var la=this,nb=rd.GetServiceTaskFactory.create(this.$.da,128,this.ma,this.tb);this.$.rE(function(){qf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)?je.TaskExtensions.Ba(je.TaskExtensions.ve([nb],la.ma),function(){la.Ed([new Z(la.$)])},la.ma,3):la.Ed([new Z(la.$)])})};na.ja=function(la){la.da.Ha(345,
new na(la))};Object(cc.a)(na,"PivotCommandHandlerFactory",Bc.a,[]);Y.prototype.getActiveCell=function(){return this.activeCell};Object(cc.a)(Y,"MacroRecorderPivotTableSettingsPaneOperationsPayload",null,[116]);Object(cc.a)(S,"PivotTableSettingsPaneOperationsUserContext",null,[]);Object(cc.a)(ca,"PivotTableSettingsTaskPaneProps",null,[]);ba.prototype.tF=function(la){var nb=this;Ze.UISurfaces.Hk().then(function(Wb){Wb.showTaskPane("PivotTableSettingsTaskPane",nb.Lv(null,la,!1,!1,!1,null,!1));return null})};
ba.prototype.Bw=function(la,nb,Wb,Dc,zb,hd,ke){var He=this;Ze.UISurfaces.Hk().then(function(df){df.updateTaskPane("PivotTableSettingsTaskPane",He.Lv(la,nb,Wb,Dc,zb,hd,ke));return null})};ba.prototype.xM=function(){Ze.UISurfaces.Hk().then(function(la){la.hideTaskPane("PivotTableSettingsTaskPane",2);return null})};ba.prototype.Lv=function(la,nb,Wb,Dc,zb,hd,ke){var He=this;la=Object.assign(new ca,{type:"PivotTableSettingsTaskPaneProps",settingsInfo:la,isRangeChanged:Wb,isNativePivotTable:Dc,expandAllByDefault:!0,
hasLessThanTwoRowFields:zb,sectionCollapseStates:this.pivotTableSettingsPaneManager.sectionCollapseStates,needFocusOnFirstElement:ke,onSaveSectionCollapseState:function(df,kf){He.pivotTableSettingsPaneManager.onSaveSectionCollapseState(df,kf)},onSettingChange:function(df,kf,ff){He.pivotTableSettingsPaneManager.jIi(df,kf,ff,hd)}});if(Zc.a.Gd(this.$))return Object.assign(new hg.a,{contentProps:la,onOpen:function(){He.pivotTableSettingsPaneManager.Mx()},onClose:function(){He.pivotTableSettingsPaneManager.RA()},
onManualClose:function(){He.pivotTableSettingsPaneManager.Pyd()},title:gb.a.instance.ea(1028),width:320,enableResize:!0,minResizeWidth:320,maxResizeWidth:900});nb=Object.assign(new qh.a,{type:"ExcelLegacyTaskPaneProps",container:nb,paneProps:la});return Object.assign(new hg.a,{contentProps:nb,onOpen:function(){He.pivotTableSettingsPaneManager.Mx()}})};Object(cc.a)(ba,"PivotTableSettingsReactTaskPane",null,[356]);Object(cc.a)(O,"PivotTableSettingsInfo",null,[]);Object(cc.a)(Q,"SlicerConnectionItem",
null,[]);I.prototype.xsj=function(){var la=this;if(Zc.a.Gd(this.$))this.Bf?(this.Hr=!1,this.hideTaskPane(!0)):(this.Hr=!0,this.showTaskPane(!0)),this.$.Gf();else if(this.pivotTableSettingsTaskPane)this.pivotTableSettingsTaskPane.Lf(!this.Bf),this.Bf?this.hideTaskPane(!0):this.showTaskPane(!0);else{var nb=rd.GetServiceTaskFactory.Xa(this.$.da,346,347,0),Wb=jc.a(this.$);je.TaskExtensions.Ba(je.TaskExtensions.ve([nb,Wb],this.$.ma),function(){la.pivotTableSettingsTaskPane=nb.result;Wb.result.rQ(la.pivotTableSettingsTaskPane);
la.R5();la.pivotTableSettingsTaskPane.Lf(!0);la.showTaskPane(!0)},this.$.ma,3)}};I.prototype.onSaveSectionCollapseState=function(la,nb){this.vL&&0<=la&&la<this.vL.length&&(this.vL[la]=nb)};I.prototype.jIi=function(la,nb,Wb,Dc){function zb(kf,ff,Ef){var Qf=new S;Qf.zDf=la;Qf.ADf=Dc;var Vg=ke.$.qa.ta,Kg=He,yh=nb;kf=Of.b(kf,ke.kIi);var fh=Vg.Oa(41,null);fh.activeCell=Kg;fh.option=la;fh.userInputText=yh;fh.userInputInt=Wb;return Ce.i(Vg,"PivotTableSettingsPaneOperations",fh,kf,ff,Ef,Qf,0)}function hd(){return new Y(He,
df.pivotTableName,la,nb,Wb)}var ke=this,He=this.o3b,df=this.X2;if(!df||Dc!==df.fca)if(this.Ola&&Dc===this.Ola.fca)df=this.Ola,He=this.VEf;else{Ac.ULS.sendTraceTag(537154690,0,50,"OnPivotTableSettingsChanged Cannot Find PivotTable for opType: {0}",la);return}switch(la){case 1:this.oca=df.pivotTableName;nb=255<nb.length?nb.substring(0,255):nb;df.pivotTableName=nb;break;case 2:this.Aya=df.rwGrandTotalOn;df.rwGrandTotalOn=!!Wb;break;case 3:this.Aya=df.colGrandTotalOn;df.colGrandTotalOn=!!Wb;break;case 6:df.autoFormatOnUpdate=
!!Wb;break;case 7:df.showDrillIndicators=!!Wb;break;case 8:df.showItemsWithNoDataOnRw=!!Wb;break;case 9:df.showItemsWithNoDataOnCol=!!Wb;break;case 10:df.displayErrorString=!!Wb;break;case 11:df.displayNullString=!!Wb;break;case 12:this.oca=df.errorString;df.errorString=nb;break;case 13:this.oca=df.nullString;df.nullString=nb;break;case 14:this.Aya=df.saveSourceDataWithFile;df.saveSourceDataWithFile=!!Wb;break;case 15:this.Aya=df.refreshOnLoad;df.refreshOnLoad=!!Wb;break;case 16:this.oca=df.altText;
df.altText=nb;break;case 17:this.oca=df.altTextSummary;df.altTextSummary=nb;break;case 20:this.WEf=df.indentIncrement,df.indentIncrement=Wb}Ac.ULS.sendTraceTag(595125196,0,50,"OnPivotTableSettingsChanged for opType: {0}",la);qf.EwaSettings.tc()?this.$.userOperationManager.ic(new af.a(225,0,zb,64,hd),null):this.$.userOperationManager.ic(new ze.a(225,0,zb,void 0,hd),null)};I.prototype.d5h=function(la){this.jEb=new ba(la,this)};I.prototype.R5=function(){this.Vnc=this.pivotTableSettingsTaskPane.ZL();
this.pivotTableSettingsTaskPane.CL(this.LCb)};I.prototype.dispose=function(){this.ha.vN(this.hla);this.gridView.lF(this.hla);this.gridView.wN(this.Ms);this.$=this.gridView=this.ha=null;this.hideTaskPane();this.pivotTableSettingsTaskPane&&(this.pivotTableSettingsTaskPane.xN(this.LCb),this.pivotTableSettingsTaskPane=this.Vnc=null);this.vL=this.jEb=null};I.prototype.Mx=function(){this.o3b=rf.o(this.ha.va.activeCell,this.$);this.X2=this.eja();this.updateTaskPane(this.eja())};I.prototype.RA=function(){this.hideTaskPane()};
I.prototype.Pyd=function(){this.Hr=!1;this.hideTaskPane(!0);this.$.Gf()};I.prototype.fn=function(){return this.ZXa&&this.Hr};I.prototype.Jp=function(){var la=id.g(this.$).Vb.nq(this.ha.va.activeCell);return!(this.ha.Te&470)&&!!la&&!la.i6a(!0)&&this.Hr};I.prototype.showTaskPane=function(la){if(void 0===la?0:la)this.uNa=!0,Ac.ULS.sendTraceTag(537154659,0,50,"PivotTable settings pane is opened by the user.");this.Bf=!0;this.jEb.tF(this.Vnc)};I.prototype.updateTaskPane=function(la,nb){nb=void 0===nb?
!1:nb;if(this.Bf&&la&&!la.i6a(!0)){var Wb=new O;Wb.pivotTableName=la.TDd;Wb.colGrandTotalOn=la.colGrandTotalOn;Wb.rwGrandTotalOn=la.rwGrandTotalOn;Wb.indentIncrement=la.indentIncrement;Wb.autoFormatOnUpdate=la.autoFormatOnUpdate;Wb.showDrillIndicators=la.showDrillIndicators;Wb.showItemsWithNoDataOnRw=la.showItemsWithNoDataOnRw;Wb.showItemsWithNoDataOnCol=la.showItemsWithNoDataOnCol;Wb.displayErrorString=la.displayErrorString;Wb.errorString=la.errorString;Wb.displayNullString=la.displayNullString;
Wb.nullString=la.nullString;Wb.saveSourceDataWithFile=la.saveSourceDataWithFile;Wb.refreshOnLoad=la.refreshOnLoad;Wb.altText=la.altText;Wb.altTextSummary=la.altTextSummary;Wb.slicerConnections=this.Yuj(la.slicerConnections);this.jEb.Bw(Wb,this.Vnc,nb,!la.isOlap,!la.JK||2>la.JK.length,la.fca,this.uNa);this.uNa=!1}};I.prototype.hideTaskPane=function(la){la=void 0===la?!1:la;this.Bf=!1;this.jEb.xM();la&&Ac.ULS.sendTraceTag(537154658,0,50,"PivotTable settings pane is closed by the user.")};I.prototype.Yuj=
function(la){var nb=new te.a;if(la)for(var Wb=0;Wb<la.length;Wb++){var Dc=la[Wb],zb=new Q;zb.name=Dc.Name;zb.caption=Dc.Caption;zb.sheet=Dc.WorksheetName;zb.enabled=Dc.Enabled||!1;nb.add(zb)}return nb.toArray()};I.prototype.eja=function(){return this.gridView.Vb.nq(this.ha.va.activeCell)};I.prototype.dAc=function(){this.fn()&&this.Jp()?this.Bf?this.X2!==this.Ola&&this.X2&&this.updateTaskPane(this.eja(),!0):this.showTaskPane():this.Bf&&this.hideTaskPane()};I.prototype.s9f=function(){this.VEf=this.o3b;
this.Ola=this.X2;this.o3b=rf.o(this.ha.va.activeCell,this.$);this.X2=this.eja()};tl.Object.defineProperties(I.prototype,{sectionCollapseStates:{configurable:!0,enumerable:!0,get:function(){return this.vL}},ZXa:{configurable:!0,enumerable:!0,get:function(){return this.$.lc.n2(4128)&&this.$Xa}},$Xa:{configurable:!0,enumerable:!0,get:function(){var la=new mc.a(this.$.xa);return this.$.isEditMode&&la.te(8192)||!la.ik}}});Object(cc.a)(I,"PivotTableSettingsPaneManager",null,[328,3]);var eg=le.a;vm(R,eg);
R.prototype.create=function(){this.Fb(this.$.da.Aa(441)||this.$.da.Ha(441,new I(this.$)))};R.ja=function(la){la.da.Ha(442,new R(la))};Object(cc.a)(R,"PivotTableSettingsPaneManagerFactory",le.a,[]);var jg=oc.a;vm(W,jg);W.prototype.hG=function(la){this.get_events().addHandler("PivotTableSettingsTaskPaneRemoved",la)};W.prototype.MH=function(la){this.get_events().removeHandler("PivotTableSettingsTaskPaneRemoved",la)};W.prototype.CL=function(la){this.addHandler("PivotTableSettingsTaskPaneClosed",la)};
W.prototype.xN=function(la){this.removeHandler("PivotTableSettingsTaskPaneClosed",la)};W.prototype.Xv=function(){};W.prototype.$B=function(){};W.prototype.fn=function(){return this.ZXa&&this.Hr};W.prototype.Jp=function(){var la=id.g(this.$).Vb.nq(this.ha.va.activeCell);return!(this.ha.Te&470)&&!!la&&!la.i6a(!0)&&this.Hr};W.prototype.bF=function(){};W.prototype.ji=function(){};W.prototype.Vh=function(){};W.prototype.VG=function(){return!1};W.prototype.dispose=function(){this.$&&this.$.Fn(this.qd);
this.ke&&(nc.a.instance.za(Vd.a.click,this.ke,this.Zj),Fd.KeyInputManager.instance.jv(this.ke,this.$we));this.ke=this.taskPaneManager=this.$=null;jg.prototype.dispose.call(this)};W.prototype.Qe=function(la,nb){if(!nb){la=ed.DOMElementExtensions.getElementById(this.domElement,"PivotTableName");if(!la&&(la=ed.DOMElementExtensions.zl(this.domElement.querySelectorAll(ed.DOMElementExtensions.Ep)),!la))return!1;ed.DOMElementExtensions.setFocus(la)}return!nb};W.prototype.zh=function(la){return ed.DOMElementExtensions.Ye(this.Jb,
la)};W.prototype.Lf=function(la){this.Hr=la;var nb=this.taskPaneManager;this.isVisible=la;this.taskPaneManager.ap();var Wb=!!this.taskPaneManager.xg&&14===this.taskPaneManager.xg.taskPane.tg;la&&0<nb.zz.length&&(!Wb||nb.isCollapsed)&&nb.WC(this,!0);this.$.Gf()};W.prototype.ZL=function(){var la=document.getElementById(this.$.Ib+Pd.a.gBd),nb=this.sG();la.appendChild(nb);nb=Pa.b("div","PivotTableSettingsPaneBodyId","ewa-ptsp-body");la.appendChild(nb);return nb};W.prototype.sG=function(){var la=Pa.b("div",
"PivotTableSettingsPaneHeaderId","ewa-ptsp-header"),nb=Pa.b("span","PivotTableSettingsPaneTitleId","cui-taskPaneTitle ewa-ptsp-title");nb.innerText=this.titleText;this.ke=ud.a.yb("PivotTableSettingsPaneCloseButtonId","ewa-ptsp-close-button",gb.a.instance.ea(10),"ClosePaneGlyph_16x16x32",!1);this.ke.classList.add(me.AFrameworkApplication.isRtl?Pd.a.X$:Pd.a.Y$);nc.a.instance.pa(Vd.a.click,this.ke,this.Zj);this.$we=Fd.KeyInputManager.instance.Ur(this.ke,this.Zj,$e.a.$h);la.appendChild(nb);la.appendChild(this.ke);
return la};W.ja=function(la,nb){var Wb=la.Ib,Dc=document.getElementById(Wb+Pd.a.gBd);Dc||(Dc=document.createElement("div"),Dc.id=la.Ib+Pd.a.gBd,Dc.classList.add("ewa-ptsp-pane"),document.getElementById(Wb+Pd.a.YQ).appendChild(Dc));Wb=la.da;return Wb.Aa(346)||Wb.Ha(346,new W(Dc,la,nb))};tl.Object.defineProperties(W.prototype,{isVisible:{configurable:!0,enumerable:!0,get:function(){return Object(qb.a)(W.prototype,this,"isVisible")},set:function(la){Object(qb.a)(W.prototype,this,"isVisible")!==la&&Object(qb.b)(W.prototype,
this,"isVisible",la)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},Zd:{configurable:!0,enumerable:!0,get:function(){return ee.a.YQi}},tg:{configurable:!0,enumerable:!0,get:function(){return 14}},Vj:{configurable:!0,enumerable:!0,get:function(){return Ad.a.uNe}},oC:{configurable:!0,enumerable:!0,get:function(){return gb.a.instance.ea(1028)}},titleText:{configurable:!0,enumerable:!0,get:function(){return gb.a.instance.ea(1028)}},El:{configurable:!0,enumerable:!0,
get:function(){return 320}},isResizable:{configurable:!0,enumerable:!0,get:function(){return!!this.$&&qf.EwaSettings.isChangeGateEnabled("OfficeVSO:4512903_EnableBIPanesResizable")}},Jb:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},height:{configurable:!0,enumerable:!0,get:function(){return this.taskPaneManager.YK.offsetHeight}},ZXa:{configurable:!0,enumerable:!0,get:function(){return this.$.lc.n2(4128)&&this.$Xa}},$Xa:{configurable:!0,enumerable:!0,get:function(){var la=
new mc.a(this.$.xa);return this.$.isEditMode&&la.te(8192)||!la.ik}}});Object(cc.a)(W,"PivotTableSettingsTaskPane",oc.a,[327,3,257,100]);var Xe=le.a;vm(ia,Xe);ia.prototype.create=function(){var la=this,nb=rd.GetServiceTaskFactory.create(this.$.da,203,this.ma,this.tb),Wb=rd.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.tb);je.TaskExtensions.Ba(je.TaskExtensions.ts(je.TaskExtensions.ve([nb,Wb],this.ma),function(){return la.GC},this.ma),function(){la.Fb(la.$g)},this.ma,3)};ia.prototype.dispose=
function(){this.$g=this.ti=this.$=null;Xe.prototype.dispose.call(this)};ia.ja=function(la){la.da.Ha(347,new ia(la))};tl.Object.defineProperties(ia.prototype,{GC:{configurable:!0,enumerable:!0,get:function(){var la=this;this.ti||(this.ti=je.TaskExtensions.Ba(jc.a(this.$),function(nb){la.$g=W.ja(la.$,nb.result)},this.ma,3));return this.ti}}});Object(cc.a)(ia,"PivotTableSettingsTaskPaneFactory",le.a,[]);var wg=Bc.a;vm(P,wg);P.prototype.Md=function(){var la=this;je.TaskExtensions.Ba(rd.GetServiceTaskFactory.create(this.$.da,
472,this.ma,this.tb),function(){var nb=la.$.da.Aa(13);la.Ed([nb])},this.$.ma,3)};P.ja=function(la){Bc.a.de(78,new P(la))};Object(cc.a)(P,"BICommandHandlerFactory",Bc.a,[]);var mg=b(687),td=b(36),wf=b(961),Oh=b(312),Jg=b(431),oh=b(411);Object(cc.a)(N,"MacroRecorderPivotTableRefreshedPayload",null,[116]);var kd=b(392),sg=kd.a;vm(U,sg);tl.Object.defineProperties(U.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return qf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryWebAsyncRefresh",
!1)?4:Object(qb.a)(U.prototype,this,"operationWorkingState")}},kHb:{configurable:!0,enumerable:!0,get:function(){var la=qf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryWebAsyncRefresh",!1);Ac.ULS.shipAssertTag(537166555,0,!la||!!(this.flags&64),"DepartableRefreshWebMethodOperation run async should run with non blocking UI.");return la}}});Object(cc.a)(U,"DepartableRefreshWebMethodOperation",kd.a,[]);var lh=b(148),Ye=lh.ErrorDialog;vm(B,Ye);B.prototype.lm=function(){Ye.prototype.lm.call(this);
this.FAa=String.format(gb.a.instance.Va(7),null)};B.iQ=function(la){var nb=Zg.a.jd(12,1,0,0,0,1243883867,"ConfirmDataRefresh");nb.Description=la;nb.HelpDescription=gb.a.instance.ea(1273);nb.HelpTopicId=wf.a.p0c;return nb};Object(cc.a)(B,"DataRefreshConfirmationDialog",lh.ErrorDialog,[]);var Rg=b(337),jh=od.a;vm(G,jh);G.prototype.zle=function(la){this.Ma.addHandler("refreshCompleted",la)};G.prototype.Rle=function(la){this.Ma.addHandler("singleRefreshStarted",la)};G.prototype.dNf=function(la){this.Ma.removeHandler("singleRefreshStarted",
la)};G.prototype.Qle=function(la){this.Ma.addHandler("singleRefreshCompleted",la)};G.prototype.cNf=function(la){this.Ma.removeHandler("singleRefreshCompleted",la)};G.prototype.yle=function(la){this.Ma.addHandler("refreshAllStarted",la)};G.prototype.QMf=function(la){this.Ma.removeHandler("refreshAllStarted",la)};G.prototype.xle=function(la){this.Ma.addHandler("refreshAllCompleted",la)};G.prototype.PMf=function(la){this.Ma.removeHandler("refreshAllCompleted",la)};G.prototype.Xc=function(){return!1};
G.prototype.executeCommand=function(la,nb,Wb,Dc){la=nb.command;switch(la){case -1193102612:this.GJf(!1,nb,"m_excelWebRenderer_ewaCtl_DataSourceDirtinessButton"===Wb.SourceControlId);break;case 2054778433:this.refreshSelected(nb,Dc);break;default:return Sc.a(la)}return vd.Task.Ta(!0)};G.prototype.Gc=function(la,nb){la=!1;switch(nb.command){case 2054778433:case -1193102612:la=!0}return la};G.prototype.fd=function(){return!1};G.prototype.dispose=function(){if(this.$){var la=id.g(this.$),nb=la.ha;nb.DK(this.kd);
nb.aza(this.kd);la.Ca.Zo(this.d8a);la.Ca.Q$a(this.d8a);fd.a(this.$).Ca.Zo(this.d8a);this.$.da.Aa(36)&&this.$.da.Aa(36).Ca.Zo(this.d8a);this.$.fa&&this.$.fa.kk(this.Zc)}this.clear();ad.a.pc([this.Snc,this.Ma]);this.$=this.Ma=null;jh.prototype.dispose.call(this)};G.prototype.z$a=function(la,nb,Wb){var Dc=this;this.$.fa.oc&&this.pu(!0,function(zb){if(zb){zb=null;if(Dc.Nya&&Object(Xd.a)(sc.PivotTableRange,Dc.Nya)){var hd=Dc.Nya;zb=function(){return new N(hd.fca,hd.pivotTableName)}}var ke=4|(qf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryWebAsyncRefresh",
!1)?64:0);Dc.$.userOperationManager.ic(new U(50,0,function(He,df,kf,ff){var Ef=Dc.$.qa.ta.Xb();Ef.FlightHolder=Dc.$.ya.FlightHolder;var Qf=Dc.$.qa.ta;df=Of.b(df,Dc.LPh(la));var Vg=1|(qf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryWebAsyncRefresh",!1)?0:8);Ef=Qf.Oa(Vg,Ef);Vg=Ef.context;Vg.RequestId=He;Vg.CompleteResponseTimeout=2E3;Ef.connectionName=la;Ef.externalSourceIndex=nb;return Ce.i(Qf,"Refresh",Ef,df,kf,ff,null,0)},ke,250,zb),Wb);Dc.MKi(la)}},G.std)};G.prototype.pu=
function(la,nb,Wb){var Dc=this;Wb=void 0===Wb?null:Wb;if(this.confirmationRequired&&la)if(this.y$a)nb(!0);else if(Wb=Wb||G.std,qf.EwaSettings.az()){la=Zg.a.jd(12,1,0,0,0,1243883867,"ConfirmDataRefresh");la.Caption=gb.a.instance.Va(7);la.Description=Wb;la.HelpDescription=gb.a.instance.ea(1273);la.HelpTopicId=wf.a.p0c;var zb=new Rg.a(this.$,la);zb.$O(function(){Dc.y$a=2===zb.returnValue;nb(Dc.y$a)})}else{var hd=new B(this.$,Wb);hd.$O(function(){hd.hide();Dc.y$a=2===hd.returnValue;nb(Dc.y$a)});hd.mf()}else nb(!0)};
G.prototype.PJa=function(){if(!this.bFd){var la=id.g(this.$);la=la.getRangeInformation(la.ha.va.activeCell);for(var nb=0,Wb=la.length;nb<Wb;++nb){var Dc=la[nb];if(Object(Xd.a)(Jg.a,Dc)){this.Nya=Dc;break}}this.bFd=!0}return this.Nya};G.prototype.Yzc=function(){if(qf.EwaSettings.isChangeGateEnabled("OfficeVSO:5697254_ApplyPowerBiLabel")){var la=this.$.qa.ta.Xb(),nb=this.$.qa.ta,Wb=this.yEi,Dc=this.xEi;la=nb.Oa(1,la);Ce.i(nb,"GetSensitivityLabelsForPowerBIDatasets",la,Wb,Dc,null,null,4)}};G.prototype.Xye=
function(){if(qf.EwaSettings.la(130)){var la=this.$.lc;if(!la||la.inEmbedView||la.inWebPart||la.inViewerFromWebPart)return!1;la=id.g(this.$);for(var nb=la.ha.va.selectedRanges,Wb=0;Wb<nb.length;Wb++)if(la.Vb.Pnd(nb[Wb]))return!0}return!1};G.prototype.$sj=function(){var la=Zg.a.jd(1,0,0,1451,0,-853845742,"ErrorConnectingToDataSource");sf.a(this.$).St([la])};G.prototype.GJf=function(la,nb,Wb){var Dc=this;if(this.$.fa.oc){this.r2i();if(this.$.workbookContext.HasLegacyConnections){var zb=Zg.a.jd(32,2,
1597,1610,0,-73730134,"BB_LegacyConnectionsWarning");zb.HelpDescription=gb.a.instance.ea(1592);zb.HelpTopicId=Oh.a.hki;var hd=rd.GetServiceTaskFactory.Xa(this.$.da,5,4,0);je.TaskExtensions.Ba(hd,function(){var ke=hd.result;ke&&ke.hg(33,zb)},this.$.ma,3)}la?(la=this.$.qa.ta.Xb(),this.A9a=w(this.$.qa.ta,!0,null,0,Of.b(this.eIi,this.Yxf),this.fIi,null,null,la),qf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryWebAsyncRefreshAll",!1)||this.RCb()):this.pu(!0,function(ke){ke&&(ke=4|
(qf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryWebAsyncRefresh",!1)?64:0),Dc.$.userOperationManager.ic(new U(51,0,function(He,df,kf,ff){var Ef=Dc.$.qa.ta.Xb();Ef.FlightHolder=Dc.$.ya.FlightHolder;var Qf=null;Wb&&(Qf={});return w(Dc.$.qa.ta,!1,He,2E3,Of.b(df,Dc.Yxf),kf,ff,Qf,Ef)},ke,250,function(){return new oh.a}),nb),qf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryWebAsyncRefreshAll",!1)||Dc.RCb())},G.std)}};G.prototype.refreshSelected=function(la,
nb){if(this.$.fa.oc&&Rc.i(this.$.oa)&&!this.exb()){var Wb=this.PJa();if(!this.Xye()||Wb&&Object(Xd.a)(sc.PivotTableRange,Wb))Wb?this.z$a(this.Nya.PXg,this.Nya.externalSourceIndex,la):this.$sj();else{var Dc;la=rd.GetServiceTaskFactory.Xa(this.$.da,271,272,nb.gja());je.TaskExtensions.Ba(la,function(zb){(Dc=zb.result)&&Dc.refreshLinkedEntitiesInRange()},this.$.ma,3)}}};G.prototype.clear=function(){this.wMd(0);this.y$a=!1;this.YAd=-1;G.ZKc=null;this.A9a&&(me.AFrameworkApplication.Hd.Zt(this.A9a.kt),this.A9a=
null)};G.prototype.jei=function(){var la=!1,nb=id.g(this.$).ha;2===nb.Te&&(la=nb.Qa.nc,nb=(null===la||void 0===la?0:la.floatingObject)?la.floatingObject.Yc:null,la=la.sz&&!!nb&&!!(nb.Attributes&4));return la};G.prototype.exb=function(){return 2===id.g(this.$).ha.Te};G.prototype.Z8e=function(){this.bFd=!1;this.Nya=null};G.prototype.wMd=function(la){var nb=0<la;!nb||this.$.fa.oc&&this.$.lc.allowPeriodicDataRefresh||(nb=!1);ad.a.Fa(this.Snc);this.Snc=null;nb&&(this.Snc=ae.a.instance.XB(this.DPg,la,Uf.a.A7g))};
G.prototype.ayf=function(la){la.RequestId||this.Ma.raiseEvent("refreshCompleted",la,this);this.Yzc()};G.prototype.LPh=function(la){var nb=this;return function(Wb){nb.ayf(Wb);Wb&&(Wb.DepartableWebMethodOperationCompleted||Wb.Errors&&0<Wb.Errors.length)&&(Array.remove(nb.QTb,la),Wb.Result=la,nb.Ma.raiseEvent("singleRefreshCompleted",Wb,nb))}};G.prototype.MKi=function(la){Array.contains(this.QTb,la)||Array.add(this.QTb,la);this.Ma.raiseEvent("singleRefreshStarted",la,this)};G.prototype.RCb=function(){this.SEd=
!0;this.Ma.raiseEvent("refreshAllStarted",null,this)};G.prototype.b7f=function(la,nb,Wb){var Dc=this,zb=rd.GetServiceTaskFactory.Xa(this.$.da,274,275,0),hd=!1;Wb.TJ?Ac.ULS.sendTraceTag(537163297,306,50,"DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: Task was cancelled."):je.TaskExtensions.Ba(zb,function(){if(function(){var He=zb.result.GVc(la,hd);hd=He.xLa;return He}().returnValue)Ac.ULS.sendTraceTag(537163293,306,50,"DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: Completed successfully on the {0} attempt.",
nb);else if(hd&&3>nb)if(Wb.TJ)Ac.ULS.sendTraceTag(537163296,306,50,"DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: Task was cancelled before waiting.");else{var ke=Dc.$.ya.TimeToWaitForApplyingSensitivityLabels;Ac.ULS.sendTraceTag(537163295,306,100,"DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: retry async call to AutoApplyOrRecommendPowerBILabel after {0} ms on the {0} attempt.",ke,nb);ae.a.instance.create(function(){Dc.b7f(la,nb+1,Wb)},ke,Uf.a.B7g,!0,!0)}else Ac.ULS.sendTraceTag(537163294,
306,50,"DataRefreshManager::TryAutoApplyOrRecommendPowerBILabel: No Sensitivity Labels applied on the {0} attempt.  Not scheduling anymore retries.",nb)},Wb,3)};G.prototype.uVc=function(la){la.gq(this.d8a);la=la.wQi;0<la&&this.zWf(la)};G.prototype.zWf=function(la){var nb=this.$.fa.rf;nb>this.YAd&&(this.YAd=nb,this.wMd(1E3*la))};G.prototype.r2i=function(){var la=rd.GetServiceTaskFactory.Xa(this.$.da,5,4,0);je.TaskExtensions.Ba(la,function(){var nb=la.result;nb&&nb.Y4a(56)&&nb.removeEntry(56)},this.$.ma,
3)};G.ja=function(la){la.da.Ha(13,new G(la))};tl.Object.defineProperties(G.prototype,{$fc:{configurable:!0,enumerable:!0,get:function(){return!!this.PJa()||this.Xye()||this.jei()}},IJf:{configurable:!0,enumerable:!0,get:function(){return this.SEd}},ZJf:{configurable:!0,enumerable:!0,get:function(){return this.QTb}},confirmationRequired:{configurable:!0,enumerable:!0,get:function(){return qf.EwaSettings.isChangeGateEnabled("OfficeVSO:5782795_DontWarnOnManualRefreshV2")?!1:this.$.lc.refreshConfirmationRequired}}});
tl.Object.defineProperties(G,{std:{configurable:!0,enumerable:!0,get:function(){return G.ZKc||(G.ZKc=gb.a.instance.Va(8)+"<br /><br />"+gb.a.instance.Va(10))}}});G.ZKc=null;Object(cc.a)(G,"DataRefreshManager",od.a,[13,237]);var Fg=Bc.a;vm(r,Fg);r.prototype.Md=function(){var la=this;je.TaskExtensions.Ba(rd.GetServiceTaskFactory.Xa(this.$.da,470,471,this.tb),function(nb){la.Ed([nb.result])},this.$.ma,3)};r.ja=function(la){Bc.a.de(472,new r(la))};Object(cc.a)(r,"PowerQueryManagerCommandHandlerFactory",
Bc.a,[]);var Ki=b(1020);z.prototype.UCg=function(la){this.Ma.addHandler("OnUpdatePowerQueryDataKeySucceeded",la)};z.prototype.G6i=function(la){this.Ma.removeHandler("OnUpdatePowerQueryDataKeySucceeded",la)};z.prototype.nwa=function(la){if(this.C_.wb(la)){if(la=this.C_.getItem(la),1!==la.FillObjectType&&!la.LoadedToDataModel)return!0}else Ac.ULS.sendTraceTag(537154446,0,10,"Query not presesnt in the queryNameToQueryInfo dictionary");return!1};z.prototype.o9c=function(){var la=this,nb=new Kd.a;this.$.userOperationManager.ic(new af.a(587,
0,function(Wb,Dc,zb){return Ki.b(la.$.qa.ta,Of.b(Wb,la.hKj,la.lMi,function(){nb.setResult(!0)}),Of.a(Dc,la.lCb,la.kMi,function(){nb.setResult(!0)}),zb,null)},80,function(){return new oh.a}),null);return nb.task};z.prototype.VJf=function(la){qf.EwaSettings.isChangeGateEnabled("OfficeVSO:5842290_HandlePowerQueryRefreshFailedErrors")&&!this.bQg(la)||!this.yK.wb(la)||(la=this.yK.getItem(la),De.a(this.$).z$a(la.ConnectionName,la.ExternalSourceIndex,null))};z.prototype.fd=function(){return!1};z.prototype.Xc=
function(){return!1};z.prototype.executeCommand=function(la,nb){la=je.TaskExtensions.om();return-1193102612===nb.command?(this.G_i(),la):Sc.a(nb.command)};z.prototype.Gc=function(la,nb){la=!1;switch(nb.command){case -1193102612:la=qf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryWebAsyncDepartedOperation",!1)}return la};z.prototype.dispose=function(){ad.a.pc([this.Ma])};z.prototype.Zrj=function(la,nb){var Wb=Zg.a.jd(1,2,2138,0,0,la,"PowerQueryRefreshValidationFailed");switch(la){case -1543585732:Wb.MessageIdName=
"PowerQueryRefreshProtectedSheetFailed";Wb.Description=String.format(gb.a.instance.Va(695),nb,gb.a.instance.ea(2139));break;case 165156185:Wb.MessageIdName="PowerQueryRefreshSheetViewFailed";Wb.Description=String.format(gb.a.instance.Va(695),nb,gb.a.instance.ea(2140));break;default:Ac.ULS.sendTraceTag(529069344,0,10,"PowerQueryManager.showEwaErrorDialog: unhandled error id {0}",la)}qf.EwaSettings.az()?new Rg.a(this.$,Wb):(la=new lh.ErrorDialog(this.$,Wb),la.initialize(),la.mf())};z.prototype.bQg=
function(la){var nb=this.C_.getItem(la);return nb?(nb=this.lIh(nb))?(this.Zrj(nb,la),!1):!0:(Ac.ULS.sendTraceTag(529069343,0,10,"PowerQueryManager.getErrorMessageIdForQueryRefresh: Query not in the queryNameToQueryInfo dictionary"),!1)};z.prototype.lIh=function(la){if((la=this.yRh(la))&&la.ik)return-1543585732;if(la&&la.ye.sC)return 165156185};z.prototype.yRh=function(la){var nb=void 0,Wb=void 0;3===la.FillObjectType||2===la.FillObjectType?nb=la.FillObjectName.split("!")[0]:0==la.FillObjectType&&
(la=this.$.xb.getItemByName(la.FillObjectName),qf.EwaSettings.isChangeGateEnabled("OfficeVSO:5951254_FixGetSheetFromLoadDestinationJSCrash")?la?nb=la.sheetName:Ac.ULS.sendTraceTag(527743194,0,15,"PowerQueryManager.getSheetFromLoadDestination: cannot find namedObject for query"):nb=la.sheetName);nb&&(Wb=this.$.xa.getItemByName(nb));return Wb};z.prototype.G_i=function(){var la=this;this.fDe?this.HJf(this.queries):this.o9c().continueWith(function(nb){nb.result?la.HJf(la.queries):Ac.ULS.sendTraceTag(537154445,
0,10,"PowerQueryManager.RefreshAllQueries failed to fatch queries")})};z.prototype.HJf=function(la){la=yl(la);for(var nb=la.next();!nb.done;nb=la.next())nb=nb.value.Name,this.nwa(nb)&&this.VJf(nb)};tl.Object.defineProperties(z.prototype,{queries:{configurable:!0,enumerable:!0,get:function(){return this.C_.values}},groups:{configurable:!0,enumerable:!0,get:function(){return this.Ahb}},yK:{configurable:!0,enumerable:!0,get:function(){return this.jNc}}});Object(cc.a)(z,"PowerQueryManager",null,[329,
237,3]);var ti=le.a;vm(t,ti);t.prototype.create=function(){this.Fb(this.$.da.Aa(470)||this.$.da.Ha(470,new z(this.$)))};t.ja=function(la){la.da.Ha(471,new t(la))};Object(cc.a)(t,"PowerQueryManagerFactory",le.a,[]);var th;(function(la){la[la.null=-1]="null";la[la.table=0]="table";la[la.connectionOnly=1]="connectionOnly";la[la.pivotTable=2]="pivotTable";la[la.pivotChart=3]="pivotChart"})(th||(th={}));Object(cc.b)("FillObjectType",th);var Pg=b(308),hi=b(340),ah=b(106);Object(cc.a)(x,"GroupInfo",null,
[]);Object(cc.a)(A,"PowerQueryTaskPaneCallbacks",null,[]);Object(cc.a)(m,"PowerQueryTaskPaneProps",null,[]);Object(cc.a)(v,"QueryInfo",null,[]);u.prototype.tF=function(la){var nb=this;this.isVisible=!0;Ze.UISurfaces.Hk().then(function(Wb){Wb.showTaskPane("PowerQueryTaskPane",nb.C1c(la));return null})};u.prototype.Bw=function(la,nb,Wb,Dc){var zb=this;Wb=void 0===Wb?null:Wb;Dc=void 0===Dc?null:Dc;if(this.isVisible){var hd=this.C1c(la,nb,Wb,Dc);Ze.UISurfaces.Hk().then(function(ke){ke.updateTaskPane("PowerQueryTaskPane",
hd||zb.C1c(la,nb,Wb,Dc));return null})}else this.gag(nb,Wb)};u.prototype.xM=function(){this.isVisible=!1;Ze.UISurfaces.Hk().then(function(la){la.hideTaskPane("PowerQueryTaskPane",2);return null})};u.prototype.TQd=function(la){if(!Pg.a.yj(la)){for(var nb=yl(this.A_),Wb=nb.next();!Wb.done;Wb=nb.next())Wb=Wb.value,Array.contains(la,Wb.name)&&(this.oPa.add(Wb.name,Wb),this.fFd[Wb.name]=++this.KJf,Ac.ULS.sendTraceTag(537154401,0,50,"Refresh started for query #: {0}",this.KJf));this.Bw(null,null,null)}};
u.prototype.B2f=function(la){if(!Pg.a.yj(la)){for(var nb=yl(this.A_),Wb=nb.next();!Wb.done;Wb=nb.next())Wb=Wb.value,Array.contains(la,Wb.name)&&(Wb.name in this.fFd&&Ac.ULS.sendTraceTag(537154400,0,50,"Refresh stoped for query #: {0}",this.fFd[Wb.name]),this.oPa.remove(Wb.name)||qf.EwaSettings.isChangeGateEnabled("OfficeVSO:5830384_StopRefreshIndicationOnLastUpdateChangesV2")||Ac.ULS.sendTraceTag(537145560,0,10,"Query not presesnt in the queryNameToQueryInfo dictionary"));this.Bw(null,null,null)}};
u.prototype.gag=function(la,nb){la=void 0===la?null:la;nb=void 0===nb?null:nb;qf.EwaSettings.Acf()&&nb&&nb.length&&la?(this.KJ.clear(),this.bva.clear(),this.v3a.clear(),this.A_=[],this.w3a=[],this.nTi(nb),this.uTi(la),this.w3a=this.a2c("root",-1).children,this.w3a=this.w3a.concat(this.a2c("Other Queries",0))):la&&(this.KJ.clear(),this.bva.clear(),this.v3a.clear(),this.w3a=this.A_=null,this.A_=this.UBe(la,0));this.vTi()};u.prototype.C1c=function(la,nb,Wb,Dc){var zb=this;Dc=void 0===Dc?null:Dc;this.gag(void 0===
nb?null:nb,void 0===Wb?null:Wb);nb=Object.assign(new A,{onQuerySelected:Object(Bg.a)(this.Nla,this.Nla.onQuerySelected,"onQuerySelected"),onQueryRefresh:Object(Bg.a)(this.Nla,this.Nla.onQueryRefresh,"onQueryRefresh"),handleQueryGroupOperation:this.handleQueryGroupOperation});Dc=Object.assign(new m,{type:"PowerQueryTaskPaneProps",callbacks:nb,queries:this.A_,groups:this.w3a,selectedQueryKey:Dc});if(Zc.a.Gd(this.$))return Object.assign(new hg.a,{contentProps:Dc,onOpen:function(){zb.Nla.Mx()},onClose:function(){zb.Nla.RA()},
width:320,title:gb.a.instance.ea(2130)});la=Object.assign(new qh.a,{container:la,paneProps:Dc});return Object.assign(new hg.a,{contentProps:la,onOpen:function(){zb.Nla.Mx()}})};u.prototype.vTi=function(){if(this.A_)for(var la=0;la<this.A_.length;la++){var nb=!1,Wb=this.A_[la];if(qf.EwaSettings.isChangeGateEnabled("OfficeVSO:5830384_StopRefreshIndicationOnLastUpdateChangesV2")){var Dc=this.oPa.getItem(Wb.name);null!=Dc&&(nb=new Date(Wb.lastRefresh),(nb=(new Date(Dc.lastRefresh)).getTime()===nb.getTime())||
this.oPa.remove(Dc.name))}else nb=this.oPa.wb(Wb.name);Wb.inRefresh=nb;Wb.refreshEnabled=this.Nla.yK.wb(Wb.name)}};u.prototype.nTi=function(la){la=yl(la);for(var nb=la.next();!nb.done;nb=la.next()){nb=nb.value;var Wb=nb.HasParent?nb.ParentId:"root";this.bva.add(nb.Id,nb);this.One(nb,Wb)}la={};la.Name=gb.a.instance.ea(2133);la.Id="Other Queries";la.Order=hi.a.hS;this.bva.add("Other Queries",la);this.bva.add("root",{Name:"root",Id:"root",Order:0})};u.prototype.uTi=function(la){la=yl(la);for(var nb=
la.next();!nb.done;nb=la.next()){var Wb=nb.value;nb=Wb.GroupID||"Other Queries";var Dc=this.KJ.getItem(nb);if("Other Queries"!==nb&&Dc&&Dc.length){Dc="SubGroupOtherQueries-"+nb;if(!this.bva.wb(Dc)){var zb={Name:Dc,Id:Dc};zb.Order=hi.a.hS;this.bva.add(Dc,zb);this.One(zb,nb)}nb=Dc;Wb.GroupID=Dc}Wb=[Wb];this.v3a.wb(nb)&&(Wb=Wb.concat(this.v3a.getItem(nb)));this.v3a.add(nb,Wb)}};u.prototype.One=function(la,nb){la=[la];this.KJ.wb(nb)&&(la=la.concat(this.KJ.getItem(nb)));this.KJ.add(nb,la)};u.prototype.a2g=
function(la,nb){var Wb=[];if(this.KJ.wb(la)){la=this.KJ.getItem(la);la.sort(function(zb,hd){return ge.HelperMethods.xC(zb.Order,hd.Order)});la=yl(la);for(var Dc=la.next();!Dc.done;Dc=la.next())Wb=Wb.concat(this.a2c(Dc.value.Id,nb+1))}return Wb};u.prototype.a2c=function(la,nb){var Wb=this.bva.getItem(la),Dc=this.v3a.getItem(la),zb=Object.assign(new x,{});zb.key=Wb.Id;zb.name=Wb.Name;zb.data=Wb.Description;Wb=this.a2g(la,nb);zb.children=this.Hwe(Wb);zb.level=nb;zb.count=0;zb.children.length&&(zb.startIndex=
zb.children[0].startIndex,zb.count+=ah.g(zb.children,function(hd){return hd.count}));Dc&&(zb.startIndex=this.A_.length,zb.count+=Dc.length,this.A_=this.A_.concat(this.UBe(Dc,la.includes("SubGroupOtherQueries-")?nb:nb+1)));return zb};u.prototype.UBe=function(la,nb){var Wb=[];la=yl(la);for(var Dc=la.next();!Dc.done;Dc=la.next())Dc=Dc.value,Dc=this.oPa.wb(Dc.Name)&&!qf.EwaSettings.isChangeGateEnabled("OfficeVSO:5830384_StopRefreshIndicationOnLastUpdateChangesV2")?this.oPa.getItem(Dc.Name):this.n4g(Dc,
nb),Wb.push(Dc);return Wb};u.prototype.n4g=function(la,nb){var Wb=new v;Wb.name=la.Name;Wb.rowsLoaded=la.RowsLoaded;Wb.lastRefresh=la.LastRefresh;Wb.fillObjectType=la.FillObjectType;Wb.loadedToDataModel=la.LoadedToDataModel;Wb.queryError=la.QueryError;Wb.nestingDepth=nb;Wb.rowsWithError=la.RowsWithError;return Wb};u.prototype.Hwe=function(la){var nb=[];la=yl(la);for(var Wb=la.next();!Wb.done;Wb=la.next()){Wb=Wb.value;var Dc=Object.assign(new x,{});Dc.key=Wb.key;Dc.name=Wb.name;Dc.count=Wb.count;Dc.startIndex=
Wb.startIndex;Dc.data=Wb.data;Dc.children=this.Hwe(Wb.children);Dc.level=Wb.level;nb.push(Dc)}return nb};Object(cc.a)(u,"PowerQueryReactTaskPane",null,[354]);f.prototype.Dmj=function(la){this.Ahb=la};f.prototype.stj=function(){var la=this;if(Zc.a.Gd(this.$))this.showTaskPane();else if(this.powerQueryTaskPane||this.sEf)this.powerQueryTaskPane&&(this.powerQueryTaskPane.Lf(!0),this.showTaskPane());else{this.sEf=!0;var nb=rd.GetServiceTaskFactory.Xa(this.$.da,408,409,0),Wb=jc.a(this.$);je.TaskExtensions.Ba(je.TaskExtensions.ve([nb,
Wb],this.$.ma),function(){la.powerQueryTaskPane=nb.result;Wb.result.rQ(la.powerQueryTaskPane);la.R5();la.powerQueryTaskPane.Lf(!0);la.showTaskPane()},this.$.ma,3)}};f.prototype.onQuerySelected=function(la){if(qf.EwaSettings.isChangeGateEnabled("OfficeVSO:5138260_ActivateQueryTargetWhenQuerySelected"))for(var nb=yl(this.queries),Wb=nb.next();!Wb.done;Wb=nb.next())if(Wb=Wb.value,Wb.FillObjectName&&Wb.Name===la){3!==Wb.FillObjectType&&2!==Wb.FillObjectType||Zf.a.contains(Wb.FillObjectName,"!",!0)||Ac.ULS.sendTraceTag(537154438,
0,15,"PowerQueryPaneManager.OnQuerySelected: Selection Query of type : {0} and no ! on FillObjectName",th[Wb.FillObjectType]);3===Wb.FillObjectType?(la=Wb.PivotChartSheetRange,la.SheetName=Wb.FillObjectName.split("!")[0],nb=Wb.FillObjectName.split("!")[1],id.g(this.$).ha.Qa.kGa(la,nb,0).continueWith(function(Dc){Dc.result||Ac.ULS.sendTraceTag(537154437,0,15,"PowerQueryPaneManager.OnQuerySelected: Selection of PivotChart Failed")})):(la=2===Wb.FillObjectType?Wb.FillObjectName.split("!")[1]:Wb.FillObjectName,
(la=this.$.xb.getItemByName(la))&&la.activate());break}};f.prototype.e5h=function(la){this.kca=new u(la,this)};f.prototype.R5=function(){this.poc=this.powerQueryTaskPane.ZL();this.powerQueryTaskPane.CL(this.KCb)};f.prototype.dispose=function(){this.$.fa.mw(this.Kf);De.a(this.$).cNf(this.lmc);De.a(this.$).dNf(this.cyf);qf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryWebAsyncRefreshAll",!1)||(De.a(this.$).QMf(this.$xf),De.a(this.$).PMf(this.Zxf));this.Lla&&this.powerQueryManager.G6i(this.Fuf);
this.$=null;this.hideTaskPane();this.powerQueryTaskPane&&(this.powerQueryTaskPane.xN(this.KCb),this.powerQueryTaskPane=this.poc=null);this.kca=null};f.prototype.Mx=function(){this.Lla?this.powerQueryManager.o9c():this.zTf();qf.EwaSettings.isChangeGateEnabled("OfficeVSO:5138260_ActivateQueryTargetWhenQuerySelected")&&this.$.xb.Pf(this.Oe);Zc.a.Gd(this.$)||qf.EwaSettings.isChangeGateEnabled("OfficeVSO:5159002_FixPowerQueryPaneFocusOnOpen")||this.powerQueryTaskPane.Qe(!0,!1)};f.prototype.RA=function(){this.Bf=
!1};f.prototype.onQueryRefresh=function(la){this.Lla?this.powerQueryManager.VJf(la):this.yK.wb(la)&&(la=this.yK.getItem(la),De.a(this.$).z$a(la.ConnectionName,la.ExternalSourceIndex,null))};f.prototype.handleQueryGroupOperation=function(la,nb){var Wb=this;mf.a(this.$.userOperationManager,function(Dc,zb,hd){return Ki.a(Wb.$.qa.ta,la,nb,Dc,zb,hd,null)},function(Dc){return new af.a(1021,0,Dc)},null)};f.prototype.showTaskPane=function(){this.Bf||(qf.EwaSettings.isChangeGateEnabled("OfficeVSO:5252502_AddHealthMetricsForPQTP")&&
(this.Dxc=this.$.Ub.Fc("UserAction","PowerQueryTaskPaneInitialLoadTime")),this.Bf=!0,this.kca.tF(this.poc))};f.prototype.updateTaskPane=function(la,nb,Wb){this.kca.Bw(this.poc,la,nb,Wb);this.Dxc&&qf.EwaSettings.isChangeGateEnabled("OfficeVSO:5252502_AddHealthMetricsForPQTP")&&(this.Dxc.stop(),this.Dxc=null);for(la=0;la<this.queries.length;la++)nb=this.queries[la],nb.FillObjectType||this.iSd.add(nb.FillObjectName,nb.Name),nb.LastRefresh||Ac.ULS.sendTraceTag(537154436,0,15,"PowerQueryPaneManager.UpdateTaskPane: Invalid date for last refreshed.")};
f.prototype.hideTaskPane=function(){this.Bf=!1;this.kca.xM()};f.prototype.zTf=function(){function la(){return new oh.a}function nb(Dc,zb,hd){return Ki.b(Wb.$.qa.ta,Of.b(Dc,Wb.$xd),Of.a(zb,Wb.lCb),hd,null)}var Wb=this;qf.EwaSettings.tc()?this.$.userOperationManager.ic(new af.a(587,0,nb,80,la),null):this.$.userOperationManager.ic(new ze.a(587,0,nb,16,la),null)};f.prototype.Euf=function(){this.updateTaskPane(this.queries,this.groups,null);this.kCf||(De.a(this.$).IJf&&!qf.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerQueryWebAsyncRefreshAll",
!1)?this.RCb():this.hHi(De.a(this.$).ZJf),this.kCf=!0)};f.prototype.RCb=function(){for(var la=[],nb=yl(this.yK.values),Wb=nb.next();!Wb.done;Wb=nb.next())Wb=Wb.value.QueryName,this.nwa(Wb)&&Array.add(la,Wb);this.kca.TQd(la)};f.prototype.hHi=function(la){var nb=[];la=yl(la);for(var Wb=la.next();!Wb.done;Wb=la.next()){Wb=Wb.value;for(var Dc=yl(this.yK.values),zb=Dc.next();!zb.done;zb=Dc.next())if(zb=zb.value,Wb===zb.ConnectionName&&(zb=zb.QueryName,this.nwa(zb))){Array.add(nb,zb);break}}this.kca.TQd(nb)};
f.prototype.nwa=function(la){if(this.Lla)return this.powerQueryManager.nwa(la);if(this.C_.wb(la)){if(la=this.C_.getItem(la),1!==la.FillObjectType&&!la.LoadedToDataModel)return!0}else Ac.ULS.sendTraceTag(537154402,0,10,"Query not presesnt in the queryNameToQueryInfo dictionary");return!1};tl.Object.defineProperties(f.prototype,{queries:{configurable:!0,enumerable:!0,get:function(){return this.Lla?this.powerQueryManager.queries:this.C_.values}},groups:{configurable:!0,enumerable:!0,get:function(){return this.Lla?
this.powerQueryManager.groups:this.Ahb}},yK:{configurable:!0,enumerable:!0,get:function(){return this.Lla?this.powerQueryManager.yK:this.jNc}}});Object(cc.a)(f,"PowerQueryPaneManager",null,[344]);l.prototype.fd=function(){return!1};l.prototype.Xc=function(){return!1};l.prototype.executeCommand=function(la,nb){this.qoc||(this.qoc=new f(this.$,this.KSi));la=je.TaskExtensions.om();return 1156885807===nb.command?(this.qoc.stj(),la):Sc.a(nb.command)};l.prototype.dispose=function(){this.$=this.qoc=null};
l.prototype.Gc=function(la,nb){la=!1;switch(nb.command){case 1156885807:la=qf.EwaSettings.E5a()}return la};Object(cc.a)(l,"PowerQueryPaneCommandHandler",null,[237,3]);var qi=Bc.a;vm(n,qi);n.prototype.Md=function(){var la=this;this.$.rE(function(){qf.EwaSettings.isChangeGateEnabled("OfficeVSO:5751619_PowerQueryManagerWebClient")?je.TaskExtensions.Ba(rd.GetServiceTaskFactory.Xa(la.$.da,470,471,1),function(nb){la.Ed([new l(la.$,nb.result)])},la.$.ma,3):la.Ed([new l(la.$,null)])})};n.ja=function(la){Bc.a.de(407,
new n(la))};Object(cc.a)(n,"PowerQueryPaneCommandHandlerFactory",Bc.a,[]);var Ch=b(123),gh=oc.a;vm(k,gh);k.prototype.hG=function(la){this.get_events().addHandler("PQTPR",la)};k.prototype.MH=function(la){this.get_events().removeHandler("PQTPR",la)};k.prototype.CL=function(la){this.addHandler("PQTPC",la)};k.prototype.xN=function(la){this.removeHandler("PQTPC",la)};k.prototype.Xv=function(){};k.prototype.$B=function(){};k.prototype.fn=function(){return this.ep};k.prototype.Jp=function(){return this.ep};
k.prototype.bF=function(){};k.prototype.VG=function(){return!1};k.prototype.ji=function(){};k.prototype.Vh=function(){};k.prototype.dispose=function(){this.$&&this.$.Fn(this.qd);this.ke&&(nc.a.instance.za(Vd.a.click,this.ke,this.Zj),Fd.KeyInputManager.instance.jv(this.ke,this.Xwe));this.ke=this.taskPaneManager=this.$=null;gh.prototype.dispose.call(this)};k.prototype.Qe=function(la,nb){nb||(la=ed.DOMElementExtensions.getElementById(this.domElement,"PowerQueryContainerId-1"),la||(la=this.ke),ed.DOMElementExtensions.setFocus(la));
return!nb};k.prototype.zh=function(la){return ed.DOMElementExtensions.Ye(this.Jb,la)};k.prototype.Lf=function(la){this.ep=la;var nb=this.taskPaneManager;this.isVisible=la;this.taskPaneManager.ap();la&&0<nb.zz.length&&(!nb.xg||17!==nb.xg.taskPane.tg||nb.isCollapsed)&&nb.WC(this,!0)};k.prototype.ZL=function(){var la=document.getElementById(this.$.Ib+Pd.a.KBd);la.setAttribute(Ch.a.ariaLabel,gb.a.instance.ea(2130));var nb=this.sG();la.appendChild(nb);nb=Pa.b("div","PowerQueryPaneBodyId","ewa-pqtp-body");
la.appendChild(nb);return nb};k.prototype.sG=function(){var la=Pa.b("div","PowerQueryPaneHeaderId","ewa-pqtp-header"),nb=Pa.b("span","PowerQueryPaneTitleId","ewa-pqtp-title");nb.innerText=this.titleText;this.ke=ud.a.yb("PowerQueryPaneCloseButtonId","StandardButton ewa-pqtp-close-button",gb.a.instance.ea(10),"ClosePaneGlyph_16x16x32",!1);this.ke.classList.add(me.AFrameworkApplication.isRtl?Pd.a.X$:Pd.a.Y$);nc.a.instance.pa(Vd.a.click,this.ke,this.Zj);this.Xwe=Fd.KeyInputManager.instance.Ur(this.ke,
this.Zj,$e.a.$h);la.appendChild(nb);la.appendChild(this.ke);return la};k.ja=function(la,nb){var Wb=la.Ib,Dc=document.getElementById(Wb+Pd.a.KBd);Dc||(Dc=document.createElement("div"),Dc.id=la.Ib+Pd.a.KBd,Zc.a.Gd(la)||document.getElementById(Wb+Pd.a.YQ).appendChild(Dc));Dc.classList.add("ewa-pqtp-pane");Wb=la.da;return Wb.Aa(408)||Wb.Ha(408,new k(Dc,la,nb))};tl.Object.defineProperties(k.prototype,{isVisible:{configurable:!0,enumerable:!0,get:function(){return Object(qb.a)(k.prototype,this,"isVisible")},
set:function(la){Object(qb.a)(k.prototype,this,"isVisible")!==la&&Object(qb.b)(k.prototype,this,"isVisible",la)}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},Zd:{configurable:!0,enumerable:!0,get:function(){return ee.a.JSi}},tg:{configurable:!0,enumerable:!0,get:function(){return 17}},Vj:{configurable:!0,enumerable:!0,get:function(){return Ad.a.aph}},oC:{configurable:!0,enumerable:!0,get:function(){return gb.a.instance.ea(2130)}},titleText:{configurable:!0,
enumerable:!0,get:function(){return gb.a.instance.ea(2130)}},El:{configurable:!0,enumerable:!0,get:function(){return 320}},Jb:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},height:{configurable:!0,enumerable:!0,get:function(){return this.taskPaneManager.YK.offsetHeight}},isResizable:{configurable:!0,enumerable:!0,get:function(){return!1}}});Object(cc.a)(k,"PowerQueryTaskPane",oc.a,[325,3,257,100]);var yi=le.a;vm(c,yi);c.prototype.create=function(){var la=this,nb=rd.GetServiceTaskFactory.create(this.$.da,
203,this.ma,this.tb),Wb=rd.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.tb);je.TaskExtensions.Ba(je.TaskExtensions.ts(je.TaskExtensions.ve([nb,Wb],this.ma),function(){return la.GC},this.ma),function(){la.Fb(la.$g)},this.ma,3)};c.prototype.dispose=function(){this.$g=this.ti=this.$=null;yi.prototype.dispose.call(this)};c.ja=function(la){la.da.Ha(409,new c(la))};tl.Object.defineProperties(c.prototype,{GC:{configurable:!0,enumerable:!0,get:function(){var la=this;this.ti||(this.ti=je.TaskExtensions.Ba(jc.a(this.$),
function(nb){la.$g=k.ja(la.$,nb.result)},this.ma,3));return this.ti}}});Object(cc.a)(c,"PowerQueryTaskPaneFactory",le.a,[]);d.prototype.getExpandedRangeForPivotTable=function(la,nb,Wb,Dc,zb,hd,ke,He){He=la.Oa(1,void 0===He?null:He);He.sheetRange=nb;He.activeCell=Wb;return Ce.i(la,"GetExpandedRangeForPivotTable",He,Dc,zb,hd,ke,0)};Object(cc.a)(d,"ExpandRange",null,[324]);var ii=le.a;vm(a,ii);a.ja=function(la){la.da.Ha(483,new a(la))};a.prototype.create=function(){var la;this.Fb(null!==(la=this.$.da.Aa(482))&&
void 0!==la?la:this.$.da.Ha(482,new d))};Object(cc.a)(a,"ExpandRangeFactory",le.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.InsertPivotTable");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PivotCommand");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.PowerQuery");Type.registerNamespace("_Ewa");pb.a.Yi(".ewa-insertpt-dlg-input{position:relative;width:50%;padding-left:3px}.ewa-insertpt-dlg-label{margin-left:50px;margin-right:5px}.ewa-insertpt-label{vertical-align:text-top}.ewa-insertpt-dlg-sourceRange{white-space:nowrap}");
pb.a.Yi('.ewa-ptsp-pane{background:#edebe9;height:100%;display:flex;flex-direction:column;overflow:hidden}.ewa-ptsp-header{position:relative;overflow:hidden;padding:16px;background:#edebe9}.ewa-ptsp-title{position:relative;display:inline-block;text-overflow:ellipsis;overflow:hidden;height:22px;font-weight:normal;font-size:16px;color:#252423;font-family:"Segoe UI Semibold","Segoe UI Web Semibold","Arial Semibold","Verdana Semibold","sans-serif Semibold";background:#edebe9}.ewa-ptsp-body{background:#edebe9;padding:0 16px;height:100%;display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;overflow-y:auto;overflow-x:hidden}.ewa-ptsp-close-button{display:inline-block;padding:1px;font-size:16px}.ewa-filterconnections-dlg-hr{margin:8px -14px 0 -14px;border:none;height:1.5px;background-color:#e1e1e1}.ewa-filterconnections-dlg-table{border-spacing:1px}.ewa-filterconnections-dlg-table thead tr{display:block;cursor:default;pointer-events:none}.ewa-filterconnections-dlg-table tbody{border:1px solid #e1e1e1;display:block;max-height:120px;overflow-y:auto}.ewa-filterconnections-dlg-table td{text-align:left;width:100px}.ewa-filterconnections-dlg-table tbody tr{display:block}.ewa-filterconnections-dlg-level{width:20px}.ewa-filterconnections-dlg-column{width:100px}');
pb.a.Yi('.ewa-pqtp-pane{height:100%;display:flex;flex-direction:column;overflow:hidden;background-color:#f5f5f5}.ewa-pqtp-header{position:relative;overflow:hidden;padding:16px}.ewa-pqtp-title{height:22px;display:inline-block;color:#252423;font-size:16px;font-family:"Segoe UI Semibold","Segoe UI Web",Arial,Verdana,sans-serif}.ewa-pqtp-body{height:100%;display:flex;flex-direction:column;justify-content:flex-start;align-items:stretch;overflow-x:hidden;overflow-y:auto}.ewa-pqtp-close-button{height:22px;width:22px;color:#252423;display:inline-block}.ewa-pqtp-close-button .clip16x16{top:2px;left:2px}');
(function(){Jc.a.Ga(function(la){je.TaskExtensions.Ba(rd.GetServiceTaskFactory.Xa(la.da,12,477,1),function(nb){Za.ja(la,nb.result)},la.ma)})})();(function(){Jc.a.Ga(function(la){xb.ja(la);kb.ja(la);Xb.ja(la)})})();Jc.a.Ga(Qb.ja);(function(){Jc.a.Ga(function(la){ya.ja(la)})})();Jc.a.Ga(Ma.IFa);Jc.a.Ga(pa.ja);(function(){Jc.a.Ga(function(la){na.ja(la);ia.ja(la);R.ja(la)})})();(function(){Jc.a.Ga(function(la){G.ja(la);P.ja(la)})})();(function(){Jc.a.Ga(function(la){n.ja(la);r.ja(la);c.ja(la);t.ja(la)})})();
(function(){Jc.a.Ga(function(la){a.ja(la)})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.bi.js.map/fc32cbceb84ec8fc13430247cf74e6b4/EwaDS.bi.js.map