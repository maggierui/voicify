(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[28],{1270:function(y,D,b){function a(){var A=m.call(this)||this;A.Omf=3E4;A.Knd=void 0;A.VW={};A.aXd={};A.Lnb={};A.Ldf=!1;return A}function d(A){var x=u.call(this)||this;x.$=A;x.dc();return x}b.r(D);y=b(0);var c=b(13),k=b(1),n=b(74),l=b(8),f=b(216),u=f.a;vm(d,u);d.prototype.create=function(){var A=b(1270).RenderingFidelityTracker,x=this.$.da.Aa(462);x||(x=this.$.da.Ha(462,new A));this.Fb(x)};Object(y.a)(d,"RenderingFidelityTrackerFactory",
f.a,[]);var v=b(46);b.d(D,"RenderingFidelityTracker",function(){return a});var m=n.a;vm(a,m);a.prototype.HEg=function(A,x,t,z){void 0===this.Knd&&(this.Knd=k.EwaSettings.isChangeGateEnabled("OfficeVSO:5839331_RFMetricPhase4"));this.Knd?this.IEg(A,x,t,z):this.JEg(A,x,t,z)};a.ja=function(A){A.da.Ha(463,new d(A))};a.prototype.JEg=function(A,x,t,z){var r=this;if(!(v.PageLoadTrackingInfo.instance.oaa(new Date)<this.Omf||this.Ldf)){var G=l.HelperMethods.Ska(function(){for(var w=gridRenderer.CanvasRendererGlobals.analyzeLowRenderingFidelity(x),
B=Object.keys(w),U=r.Lnb[A],N=0;N<B.length;N++){var P=B[N];(null===U||void 0===U?0:U[P])&&r.VW[P]&&(r.VW[P]-=U[P])}r.Lnb[A]=w;for(U=0;U<B.length;U++)if(N=B[U],P=w[N],r.VW[N]&&(P+=r.VW[N]),gridRenderer.CanvasRendererGlobals.hasRenderingFidelityThresholdExceeded(N,P)){r.Ldf=!0;r.VW={};r.Lnb={};c.ULS.sendTraceTag(529065378,0,50,"Session Vetoed because of : { key:"+N+", isHC:"+t+", scaleFactor:"+z+"}");break}else r.VW[N]=P});1<G&&c.ULS.sendTraceTag(537151041,1,50,"RenderingFidelityTracker.AnalyzeModelForLowFidelity: Duration for AnalyzeModelForLowFidelity the model, duration={0}",
G)}};a.prototype.IEg=function(A,x,t,z){var r=this;if(!(v.PageLoadTrackingInfo.instance.oaa(new Date)<this.Omf)){var G=l.HelperMethods.Ska(function(){for(var w=gridRenderer.CanvasRendererGlobals.analyzeLowRenderingFidelity(x),B=Object.keys(w),U=r.Lnb[A],N=0;N<B.length;N++){var P=B[N];r.aXd[P]||(null===U||void 0===U?0:U[P])&&r.VW[P]&&(r.VW[P]-=U[P])}r.Lnb[A]=w;for(U=0;U<B.length;U++)if(N=B[U],!r.aXd[N])if(P=w[N],r.VW[N]&&(P+=r.VW[N]),gridRenderer.CanvasRendererGlobals.hasRenderingFidelityThresholdExceeded(N,
P)){r.aXd[N]=!0;c.ULS.sendTraceTag(527472324,0,50,"Session Vetoed because of : { key:"+N+", isHC:"+t+", scaleFactor:"+z+"}");break}else r.VW[N]=P});1<G&&c.ULS.sendTraceTag(527472323,1,50,"RenderingFidelityTracker.AnalyzeModelForLowFidelity: Duration for AnalyzeModelForLowFidelity the model, duration={0}",G)}};Object(y.a)(a,"RenderingFidelityTracker",n.a,[725,3])},1382:function(y,D,b){function a(Ca){var ra=this;this.a8a=function(){ra.eDf(ra.mRe)};this.Hg=function(){ra.eDf(ra.UJg)};this.$=Ca;this.UJg=
new eg.a;this.mRe=new eg.a;jg.g(this.$).Ca.np(this.Hg);jg.g(this.$).Ca.oke(this.a8a)}function d(Ca,ra,yb){this.DNj=Ca;this.wU=ra;this.name=yb}function c(Ca,ra,yb,Hd,ye,Cf){ra=void 0===ra?null:ra;yb=void 0===yb?null:yb;Hd=void 0===Hd?null:Hd;ye=void 0===ye?null:ye;Cf=void 0===Cf?!1:Cf;var Bf=eh.call(this)||this;Bf.Lrh=[Pa.a.qre,Pa.a.RJe,Pa.a.SJe,Pa.a.hdc,Pa.a.cic,Pa.a.aif,Pa.a.renderCachedContent,Pa.a.renderServerContent,Pa.a.f3b,Pa.a.TRf,Pa.a.URf,Pa.a.VRf,Pa.a.igj];Bf.Wee=null;Bf.TVa=null;Bf.Aqe=
null;Bf.S8d=null;Bf.feb=null;Bf.FMb=null;Bf.sCa=null;Bf.bkb=null;Bf.nre=!1;Bf.$Cf=!1;Bf.Ubg=null;Bf.fId=null;Bf.dbg=null;Bf.abg=null;Bf.bbg=null;Bf.lyf=function(ch,Tg){for(ch=0;ch<Tg.entries.length;ch++){var fe=Tg.entries[ch];fe.url=Yf.a.removeParameter(fe.url,Uf.AFrameworkApplication.YO);var Ih=Yf.a.Eca(fe.url);Bf.mei(fe.url,Ih)&&(fe.behavior=1);if("img"===fe.Xt.initiatorType&&Ih.endsWith(df.a.eHe)){var Th=Yf.a.dja(fe.url,df.a.R5c),h=Yf.a.dja(fe.url,df.a.S5c);fe.r$=fe.r$+"imageID="+Th+", imgStateID="+
h}Th=fe.Xt[Pa.a.transferSize];h=null;void 0!==Th&&null!==Th&&(h=!Th);Kd.PageLoadTrackingInfo.instance.Uxg(Ih,Math.round(fe.Xt.fetchStart),Math.round(fe.Xt.responseEnd),h,Bf.Ifi);rg.a.contains(Ih,Pa.a.richTextEditor,!0)&&(Ih=yi.TextEditorTelemetry.instance,Ih.CD(Pa.a.y$i,Math.round(fe.Xt.fetchStart)),Ih.CD(Pa.a.A$i,Math.round(fe.Xt.responseEnd)))}};Bf.IV=function(){var ch=Bf.c7,Tg;for(Tg in ch)ch[Tg].h=!0};Bf.userSessionId=Ca;Bf.u_a=ra=ra||new Vg.a;Bf.Pg=yb||sf.a.Ra;Bf.lyj=Hd||Bf;Bf.ef=ye;Bf.Ifi=Cf;
Bf.GDe=ra.m7a();Bf.ef&&Bf.ef.aFa(Bf.IV);return Bf}function k(){}function n(){}function l(){}function f(){}function u(){}function v(){}function m(Ca,ra){this.KJd=void 0===ra?1:ra;this.total=Ca}function A(){var Ca=fh.call(this)||this;Ca.ivi=0;Ca.operation="DOMUpdate";Ca.target=null;Ca.sender=null;return Ca}function x(Ca,ra){function yb(Cf,Bf){null!=Bf&&(Hd[Cf]=Bf)}var Hd={},ye=null;switch(Ca){case 0:ye="Actions";yb("Id",ra.a);yb("Operation",null==ra.b?null:ra.b);yb("Target",ra.c);yb("StartTime",null==
ra.d?null:ra.d.toString());yb("Duration",null==ra.e?null:ra.e.toString());yb("CorrelationId",ra.f);yb("ParentAction",ra.g);yb("DocumentHidden",null==ra.h?null:ra.h.toString());break;case 1:ye="CorrelationStart";yb("CorrelationId",ra.a);yb("UserSessionId",ra.b);yb("UserAction",ra.c);break;case 2:ye="ReorderSheetOp";yb("UserSessionId",ra.a);yb("IsDragReorder",null==ra.b?null:ra.b.toString());yb("DocumentUp",null==ra.c?null:ra.c.toString());yb("OldIndex",null==ra.d?null:ra.d.toString());yb("NewIndex",
null==ra.e?null:ra.e.toString());yb("TotalSheets",null==ra.f?null:ra.f.toString());break;case 3:ye="FormatCellOp";yb("UserSessionId",ra.a);yb("TaskId",null==ra.b?null:ra.b.toString());yb("NumberOfRanges",null==ra.c?null:ra.c.toString());yb("Ranges",ra.d);yb("ActiveCell",ra.e);yb("ActionId",null==ra.f?null:ra.f.toString());yb("CommandParameters",ra.g);yb("UserActionStopwatchId",ra.h);break;case 4:ye="CopyOp";yb("UserSessionId",ra.a);yb("IsChrome",null==ra.b?null:ra.b.toString());yb("IsIE",null==ra.c?
null:ra.c.toString());yb("IsFromUI",null==ra.d?null:ra.d.toString());yb("IsCopyInLoadedRange",null==ra.e?null:ra.e.toString());yb("IsRepeatedCopy",null==ra.f?null:ra.f.toString());yb("IsClipboarAccessSupported",null==ra.g?null:ra.g.toString());yb("IsClipboarAccessInstallationSupported",null==ra.h?null:ra.h.toString());yb("RibbonCommand",null==ra.i?null:ra.i.toString());yb("CutCopyPasteFlags",null==ra.j?null:ra.j.toString());yb("IsDrag",null==ra.k?null:ra.k.toString());yb("IsIeBeforeAlowDenyPopUp",
null==ra.l?null:ra.l.toString());yb("IsPasteMatchCopy",ra.m);yb("WaitMessageInClipboard",ra.n);yb("CallCount",null==ra.o?null:ra.o.toString());break;case 5:ye="PasteOp";yb("UserSessionId",ra.a);yb("IsChrome",null==ra.b?null:ra.b.toString());yb("IsIE",null==ra.c?null:ra.c.toString());yb("IsCopyActive",null==ra.d?null:ra.d.toString());yb("IsFromUI",null==ra.e?null:ra.e.toString());yb("IsClipboarAccessSupported",null==ra.f?null:ra.f.toString());yb("IsClipboarAccessInstallationSupported",null==ra.g?null:
ra.g.toString());yb("RibbonCommand",null==ra.h?null:ra.h.toString());yb("CutCopyPasteFlags",null==ra.i?null:ra.i.toString());yb("WaitMessageInClipboard",ra.j);yb("PopupDialog",ra.k);yb("SimplePopupMessage",ra.l);yb("DialogCloseButton",ra.m);yb("UserPressedInstallLink",ra.n);yb("CallCount",null==ra.o?null:ra.o.toString());break;case 6:ye="GetNumberViewModelDataOp";yb("UserSessionId",ra.a);yb("NumberFormatOptionsPreviousOutputJson",ra.b);yb("NumberFormatOptionsNewInputJson",ra.c);break;case 7:ye="InstantaneousSetData";
yb("Id",ra.a);yb("WasEmpty",null==ra.b?null:ra.b.toString());yb("ValueNotChanged",null==ra.c?null:ra.c.toString());yb("Source",ra.d);yb("ProcessingCompleted",null==ra.e?null:ra.e.toString());break;case 8:ye="ImmediateSetData";yb("ClientStopwatchId",ra.a);yb("Operation",ra.b);yb("Parameters",ra.c);yb("WasUpdatedByImmediate",null==ra.d?null:ra.d.toString());yb("areHtmlElementsEqualClientComparison",null==ra.e?null:ra.e.toString());yb("WasDecisionMadeByHtmlComparison",null==ra.f?null:ra.f.toString());
yb("IsNumeric",null==ra.g?null:ra.g.toString());yb("IsDateTime",null==ra.h?null:ra.h.toString());yb("HasCurrencySymbol",null==ra.i?null:ra.i.toString());yb("HasPercentSymbol",null==ra.j?null:ra.j.toString());yb("IsFunc",null==ra.k?null:ra.k.toString());yb("DiffInWrappingWhitespace",null==ra.l?null:ra.l.toString());yb("ImmediatePattern",ra.m);yb("TextAlignmentMatch",null==ra.n?null:ra.n.toString());yb("FontColorMatch",null==ra.o?null:ra.o.toString());yb("FormulaTextMatch",null==ra.p?null:ra.p.toString());
yb("isFormula",null==ra.q?null:ra.q.toString());yb("FormulaText",ra.r);yb("InstantaneousPattern",ra.s);yb("AreHtmlInnerTextElementsEqualClientComparison",null==ra.t?null:ra.t.toString());yb("HtmlComparisonDecision",ra.u);break;case 9:ye="DependentCellsCalc";yb("CalcStatus",ra.a);yb("SuccessfullyCalculatedRanges",null==ra.b?null:ra.b.toString());yb("RangesSkipped",null==ra.c?null:ra.c.toString());yb("TotalErrors",null==ra.d?null:ra.d.toString());yb("Partial",null==ra.e?null:ra.e.toString());yb("Canceled",
null==ra.f?null:ra.f.toString());yb("Aggregate",null==ra.g?null:ra.g.toString());yb("Unknown",null==ra.h?null:ra.h.toString());yb("UnavailableData",null==ra.i?null:ra.i.toString());yb("Cycle",null==ra.j?null:ra.j.toString());yb("NotImplemented",null==ra.k?null:ra.k.toString());yb("InvalidInput",null==ra.l?null:ra.l.toString());yb("AreDepCells",null==ra.m?null:ra.m.toString());break;case 10:ye="DependentCellsGraphStat";yb("ParsedFormulas",null==ra.a?null:ra.a.toString());yb("GraphNodes",null==ra.b?
null:ra.b.toString());yb("GraphArcs",null==ra.c?null:ra.c.toString());yb("AnalyzedBlocks",null==ra.d?null:ra.d.toString());yb("IterationId",null==ra.e?null:ra.e.toString());yb("UniqueId",ra.f);yb("Aborted",null==ra.g?null:ra.g.toString());break;case 11:ye="DependentCellsGraphSectionStat";yb("IterationId",null==ra.a?null:ra.a.toString());yb("BlockHash",ra.b);yb("Functions",ra.c);yb("Operators",ra.d);yb("CrossDocRefs",null==ra.e?null:ra.e.toString());yb("CrossSheetRefs",null==ra.f?null:ra.f.toString());
yb("ErrRefs",null==ra.g?null:ra.g.toString());yb("LargeRanges",null==ra.h?null:ra.h.toString());yb("NameRefs",null==ra.i?null:ra.i.toString());yb("ParserErrors",null==ra.j?null:ra.j.toString());yb("RowRefs",null==ra.k?null:ra.k.toString());yb("ColumnRefs",null==ra.l?null:ra.l.toString());yb("TableRefs",null==ra.m?null:ra.m.toString());yb("UniqueId",ra.n);yb("UnreachableReferences",null==ra.o?null:ra.o.toString());break;case 12:ye="GetRangeContentPrefetchFailures";yb("UserSessionId",ra.a);yb("ClientStopwatchId",
ra.b);yb("StateId",null==ra.c?null:ra.c.toString());break;case 13:ye="GridBlockUpdates";yb("UserSessionId",ra.a);yb("CorrelationId",ra.b);yb("Operation",ra.c);yb("PerformanceType",null==ra.d?null:ra.d.toString());yb("BlockHash",ra.e);yb("DurationInMs",null==ra.f?null:ra.f.toString());break;case 14:ye="BrowserAppStart";yb("ScriptExecutionStart",null==ra.a?null:kf.a.qsa(ra.a.getTime()));yb("UserSessionId",ra.b);yb("ClockMechanism",ra.c);yb("ScreenDPI",null==ra.d?null:ra.d.toString());yb("NavigationToScriptExecutionDelta",
null==ra.e?null:ra.e.toString());break;case 15:ye="LinkedObjects";yb("ChildId",ra.a);yb("ParentId",ra.b);yb("ChildTable",ra.c);yb("ParentTable",ra.d);break;case 16:ye="LongFrames";yb("StartTime",null==ra.a?null:kf.a.qsa(ra.a.getTime()));yb("DurationInMs",null==ra.b?null:ra.b.toString());break;case 17:ye="Task";yb("StopwatchId",ra.a);yb("Status",null==ra.b?null:ra.b.toString());yb("CreateTime",null==ra.c?null:ra.c.toString());yb("TaskId",null==ra.d?null:ra.d.toString());break;case 18:ye="ConflictInEditing";
yb("OtherUserState",ra.a);yb("UserSessionId",ra.b);yb("ConflictTime",null==ra.c?null:kf.a.qsa(ra.c.getTime()));break;case 19:ye="IncomingPresenceData";yb("UserSessionId",ra.a);yb("UserId",ra.b);yb("Disconnected",null==ra.c?null:ra.c.toString());yb("ReceivedTime",null==ra.d?null:kf.a.qsa(ra.d.getTime()));break;case 20:ye="EditorTableDelay";yb("UserSessionId",ra.a);yb("UserId",ra.b);yb("Received",null==ra.c?null:ra.c.toString());yb("DurationInMs",null==ra.d?null:ra.d.toString());yb("NotAloneAtLogTime",
null==ra.e?null:ra.e.toString());yb("Time",null==ra.f?null:kf.a.qsa(ra.f.getTime()));break;case 21:ye="PresenceStartup";yb("UserSessionId",ra.a);yb("EverReceived",null==ra.b?null:ra.b.toString());yb("NotAloneOnOpen",null==ra.c?null:ra.c.toString());yb("NotAloneAtLogTime",null==ra.d?null:ra.d.toString());yb("EditorCount",null==ra.e?null:ra.e.toString());yb("WorkbookOpenToFirstReceivedInMs",null==ra.f?null:ra.f.toString());break;case 22:ye="PresenceDelete";yb("UserSessionId",ra.a);yb("UserId",ra.b);
yb("Context",ra.c);yb("Reason",ra.d);yb("Time",null==ra.e?null:kf.a.qsa(ra.e.getTime()));break;case 23:ye="EditorEvent";yb("UserSessionId",ra.a);yb("UserId",ra.b);yb("Context",ra.c);yb("Time",null==ra.d?null:kf.a.qsa(ra.d.getTime()));break;case 24:ye="EditorTime";yb("UserSessionId",ra.a);yb("UserId",ra.b);yb("DurationInMs",null==ra.c?null:ra.c.toString());break;case 25:ye="GridScreenReaderOps";yb("UserSessionId",ra.a);yb("CommandTaskId",ra.b);yb("CommandId",null==ra.c?null:ra.c.toString());yb("ClientSideOnly",
null==ra.d?null:ra.d.toString());yb("DurationInMS",null==ra.e?null:ra.e.toString());yb("ReachedMaxReadoutCells",null==ra.f?null:ra.f.toString());yb("RequstedCellCount",null==ra.g?null:ra.g.toString());yb("NonEmptyCellCount",null==ra.h?null:ra.h.toString());yb("Succeeded",null==ra.i?null:ra.i.toString());yb("Canceled",null==ra.j?null:ra.j.toString());yb("ErrorType",ra.k);break;case 26:ye="SendPresenceToService";yb("UserSessionId",ra.a);yb("TotalCount",null==ra.b?null:ra.b.toString());yb("SendCount",
null==ra.c?null:ra.c.toString());break;case 27:ye="IME";yb("UserSessionId",ra.a);break;case 28:ye="FreezePaneFloatingObjects";yb("UserSessionId",ra.a);yb("ObjectType",null==ra.b?null:ra.b.toString());yb("ObjectID",ra.c);yb("SpannedPanesCount",null==ra.d?null:ra.d.toString());break;case 29:ye="CustomizeStatusBar";yb("UserSessionId",ra.a);yb("UIControlName",ra.b);yb("IsControlVisible",null==ra.c?null:ra.c.toString());break;case 30:ye="ClientWebRequests";yb("Path",ra.a);yb("ProxyStopwatchId",ra.b);yb("RequestStatus",
ra.c);yb("ResponseSizeInBytes",null==ra.d?null:ra.d.toString());yb("ClientRequestId",ra.e);yb("StateId",null==ra.f?null:ra.f.toString());break;case 31:ye="ShowCommentTaskPane";yb("UserSessionId",ra.a);yb("IsFromKeyboardShortcut",null==ra.b?null:ra.b.toString());yb("IsShowPane",null==ra.c?null:ra.c.toString());yb("ShowForDeepLink",null==ra.d?null:ra.d.toString());yb("DeepLinkFound",null==ra.e?null:ra.e.toString());break;case 32:ye="ApplyThreadedCommentChange";yb("UserSessionId",ra.a);yb("Operation",
null==ra.b?null:ra.b.toString());yb("CommentId",ra.c);yb("CommentsCount",null==ra.d?null:ra.d.toString());break;case 33:ye="UpgradeLegacyCommentsChange";yb("UserSessionId",ra.a);yb("OperationSuccessful",null==ra.b?null:ra.b.toString());break;case 34:ye="FindNextOrPreviousComment";yb("UserSessionId",ra.a);yb("Succeeded",null==ra.b?null:ra.b.toString());break;case 35:ye="Goto";yb("UserSessionId",ra.a);yb("IsSucceeded",null==ra.b?null:ra.b.toString());yb("IsNOVMode",null==ra.c?null:ra.c.toString());
break;case 36:ye="LaunchOfficeAddInDialog";yb("UserSessionId",ra.a);yb("SourceId",ra.b);yb("SourceLabel",ra.c);yb("Flight",ra.d);yb("Experiment",ra.e);yb("UICultureTag",ra.f);yb("UICultureTagLcid",null==ra.g?null:ra.g.toString());yb("WacHostId",null==ra.h?null:ra.h.toString());break;case 37:ye="RichApiInvocation";yb("UserSessionId",ra.a);yb("Succeeded",null==ra.b?null:ra.b.toString());yb("ErrorType",ra.c);yb("ResultInfo",ra.d);yb("Source",ra.e);break;case 38:ye="FxLibrary";yb("EntityName",ra.a);yb("EntryPoint",
null==ra.b?null:ra.b.toString());yb("Action",null==ra.c?null:ra.c.toString());yb("InsertLocation",null==ra.d?null:ra.d.toString());break;case 39:ye="EmbeddedApiSession";yb("UserSessionId",ra.a);break;case 40:ye="NumberFormattingCalculator";yb("Id",ra.a);yb("CounterName",ra.b);yb("Values",ra.c);break;case 41:ye="RequestDataAfterSend";yb("ClientStopwatchId",ra.a);yb("RequestStatus",ra.b);yb("SendDuration",null==ra.c?null:ra.c.toString());yb("RequestId",null==ra.d?null:ra.d.toString());break;case 42:ye=
"FloatingObjectsStopwatchData";yb("StopMessage",ra.a);yb("Type",null==ra.b?null:ra.b.toString());yb("GUID",ra.c);yb("Pane",null==ra.d?null:ra.d.toString());yb("IsAboveGrid",null==ra.e?null:ra.e.toString());yb("StartCorrelation",ra.f);yb("LoadImageCorrelation",ra.g);yb("SkippedGetEffectsExtents",null==ra.h?null:ra.h.toString());yb("Version",null==ra.i?null:ra.i.toString());break;case 43:ye="Copy";yb("UserSessionId",ra.a);yb("Trigger",ra.b);yb("RibbonCommandName",ra.c);yb("SourceItem",ra.d);yb("SourceRangeCellCount",
null==ra.e?null:ra.e.toString());yb("ClientSideStopwatchId",ra.f);yb("CopyOperationId",ra.g);yb("IsAsync",null==ra.h?null:ra.h.toString());yb("IsFromCache",null==ra.i?null:ra.i.toString());yb("IsSuccessiveCopy",null==ra.j?null:ra.j.toString());yb("IsSelectionAllowed",null==ra.k?null:ra.k.toString());yb("IsSuccess",null==ra.l?null:ra.l.toString());yb("IsExpectedError",null==ra.m?null:ra.m.toString());yb("ExpectedErrorReason",ra.n);yb("ErrorMessage",ra.o);yb("ClientSideCopyTimeInMs",null==ra.p?null:
ra.p.toString());yb("TotalTimeInMs",null==ra.q?null:ra.q.toString());yb("PlainTextPayloadSize",null==ra.r?null:ra.r.toString());yb("CopyPasteTargetType",ra.s);yb("ShadowWorkbookPayloadSize",null==ra.t?null:ra.t.toString());yb("HtmlPayloadSize",null==ra.u?null:ra.u.toString());yb("HtmlSizeExceedsLimit",null==ra.v?null:ra.v.toString());yb("CopyTotalSizeExceedsLimit",null==ra.w?null:ra.w.toString());yb("ErrorReason",null==ra.x?null:ra.x.toString());yb("ErrorName",ra.y);yb("IsSucceededWithAlert",null==
ra.z?null:ra.z.toString());yb("EncounteredDeploymentErrors",null==ra.ba?null:ra.ba.toString());yb("ShadowWorkbookSizeExceedsLimit",null==ra.bb?null:ra.bb.toString());yb("CopyPasteTargetName",ra.bc);yb("CCPSliceName",ra.bd);yb("SyncClipboardItemsKeys",ra.be);yb("AsyncClipboardItemsKeys",ra.bf);yb("CopyPasteHandlerName",ra.bg);yb("SucceededPopulatingSystemClipboardSync",ra.bh);yb("SucceededPopulatingSystemClipboardAsync",ra.bi);yb("Location",ra.bj);yb("CopyContextId",ra.bk);yb("ServerRequestTimeInMs",
null==ra.bl?null:ra.bl.toString());yb("EcsOperationDuration",null==ra.bm?null:ra.bm.toString());yb("EcsRequestDuration",null==ra.bn?null:ra.bn.toString());yb("WfeRequestDuration",null==ra.bo?null:ra.bo.toString());yb("OriginalSourceRangesCountExceedsLimit",null==ra.bp?null:ra.bp.toString());yb("UploadToClipServiceAttempted",null==ra.bq?null:ra.bq.toString());yb("FloatingObjectType",null==ra.br?null:ra.br.toString());break;case 44:ye="Paste";yb("UserSessionId",ra.a);yb("Trigger",ra.b);yb("RibbonCommandName",
ra.c);yb("PasteTypeFlagValue",null==ra.d?null:ra.d.toString());yb("PasteOperationId",ra.e);yb("CopyOperationId",ra.f);yb("ClientSideStopwatchId",ra.g);yb("OriginalDestinationRange",ra.h);yb("ExpandDestinationRange",ra.i);yb("SourceItem",ra.j);yb("SourceRangeCellCount",null==ra.k?null:ra.k.toString());yb("IsSuccess",null==ra.l?null:ra.l.toString());yb("IsExpectedError",null==ra.m?null:ra.m.toString());yb("ClipboardFormatReadTimeInMs",ra.n);yb("ClipboardFormatReadStatus",ra.o);yb("ClipboardReadPermissionPromptShown",
null==ra.p?null:ra.p.toString());yb("AsyncApiReadTimedOut",null==ra.q?null:ra.q.toString());yb("ExpectedErrorReason",ra.r);yb("ErrorMessage",ra.s);yb("TotalTimeInMs",null==ra.t?null:ra.t.toString());yb("PlainTextPayloadSize",null==ra.u?null:ra.u.toString());yb("ShadowWorkbookPayloadSize",null==ra.v?null:ra.v.toString());yb("HtmlPayloadSize",null==ra.w?null:ra.w.toString());yb("CopyPasteTargetType",ra.x);yb("IsLastCopyWasExternal",null==ra.y?null:ra.y.toString());yb("IsClipboardDataContainShadowWorkbook",
null==ra.z?null:ra.z.toString());yb("IsShadowWorkbookParsedSuccessfully",null==ra.ba?null:ra.ba.toString());yb("ActiveSelectionType",ra.bb);yb("PasteResult",ra.bc);yb("ErrorReason",null==ra.bd?null:ra.bd.toString());yb("ErrorName",ra.be);yb("IsSucceededWithAlert",null==ra.bf?null:ra.bf.toString());yb("IsAfterCut",null==ra.bg?null:ra.bg.toString());yb("EncounteredDeploymentErrors",null==ra.bh?null:ra.bh.toString());yb("IsCrossSession",null==ra.bi?null:ra.bi.toString());yb("ShadowWorkbookSizeExceedsLimit",
null==ra.bj?null:ra.bj.toString());yb("ClipboardContainXLOPayload",null==ra.bk?null:ra.bk.toString());yb("CopyPasteTargetName",ra.bl);yb("ChromeExtensionId",ra.bm);yb("PayloadOrigin",ra.bn);yb("PayloadType",ra.bo);yb("CCPSliceName",ra.bp);yb("ClipboardItemsKeys",ra.bq);yb("CopyPasteHandlerName",ra.br);yb("IsSourceItemOriginSameSession",null==ra.bs?null:ra.bs.toString());yb("Location",ra.bt);yb("ExternalAppSource",ra.bu);yb("PasteContextId",ra.bv);yb("ServerRequestTimeInMs",null==ra.bw?null:ra.bw.toString());
yb("IndicationDisplayScheduled",null==ra.bx?null:ra.bx.toString());yb("PasteIndicationDisplayStatus",ra.by);yb("PasteRecoveryUIDisplayed",null==ra.bz?null:ra.bz.toString());yb("IsFromPasteRecoveryUI",null==ra.ca?null:ra.ca.toString());yb("EcsOperationDuration",null==ra.cb?null:ra.cb.toString());yb("EcsRequestDuration",null==ra.cc?null:ra.cc.toString());yb("WfeRequestDuration",null==ra.cd?null:ra.cd.toString());yb("OriginalSourceRangesCountExceedsLimit",null==ra.ce?null:ra.ce.toString());yb("PasteRecoveryUndoStopwatchId",
ra.cf);yb("PasteRecoveryUndoTimeInMs",null==ra.cg?null:ra.cg.toString());yb("PasteCSEPerformed",null==ra.ch?null:ra.ch.toString());yb("CSEStatus",null==ra.ci?null:ra.ci.toString());yb("IsFromEnterShortcut",null==ra.cj?null:ra.cj.toString());yb("pasteDestinationHasMergedCells",null==ra.ck?null:ra.ck.toString());break;case 45:ye="DragDrop";yb("UserSessionId",ra.a);yb("Trigger",ra.b);yb("RibbonCommandName",ra.c);yb("OperationId",ra.d);yb("ClientSideStopwatchId",ra.e);yb("SourceRange",ra.f);yb("DestinationRange",
ra.g);yb("CutCopyType",ra.h);yb("IsShiftKeyDown",null==ra.i?null:ra.i.toString());yb("IsDragInsert",null==ra.j?null:ra.j.toString());yb("IsSuccess",null==ra.k?null:ra.k.toString());yb("IsExpectedError",null==ra.l?null:ra.l.toString());yb("ExpectedErrorReason",ra.m);yb("ErrorMessage",ra.n);yb("TotalTimeInMs",null==ra.o?null:ra.o.toString());yb("ErrorName",ra.p);yb("IsSucceededWithAlert",null==ra.q?null:ra.q.toString());yb("CopyPasteTargetType",ra.r);yb("EncounteredDeploymentErrors",null==ra.s?null:
ra.s.toString());break;case 46:ye="ClearCopyState";yb("UserSessionId",ra.a);yb("ClientSideStopwatchId",ra.b);yb("Trigger",ra.c);yb("IsClearClipboard",null==ra.d?null:ra.d.toString());yb("IsExplicit",null==ra.e?null:ra.e.toString());yb("IsSuccess",null==ra.f?null:ra.f.toString());yb("ErrorMessage",ra.g);yb("ErrorName",ra.h);yb("TotalTimeInMs",null==ra.i?null:ra.i.toString());yb("CopyPasteTargetType",ra.j);break;case 47:ye="WebWorkerRecalcStats";yb("SuccessCount",null==ra.a?null:ra.a.toString());yb("FailureCount",
null==ra.b?null:ra.b.toString());yb("ValueTypeMismatchCount",null==ra.c?null:ra.c.toString());yb("CellValueMismatchCount",null==ra.d?null:ra.d.toString());yb("IfmtMismatchCount",null==ra.e?null:ra.e.toString());yb("FormattedTextMismatchCount",null==ra.f?null:ra.f.toString());yb("CellValueStringMismatchCount",null==ra.g?null:ra.g.toString());yb("CellValueNumberMismatchCount",null==ra.h?null:ra.h.toString());yb("CellValueBooleanMismatchCount",null==ra.i?null:ra.i.toString());yb("CellValueBlankMismatchCount",
null==ra.j?null:ra.j.toString());yb("CellValueErrorMismatchCount",null==ra.k?null:ra.k.toString());yb("FormattedTextStringMismatchCount",null==ra.l?null:ra.l.toString());yb("FormattedTextNumberMismatchCount",null==ra.m?null:ra.m.toString());yb("FormattedTextBooleanMismatchCount",null==ra.n?null:ra.n.toString());yb("FormattedTextBlankMismatchCount",null==ra.o?null:ra.o.toString());yb("FormattedTextErrorMismatchCount",null==ra.p?null:ra.p.toString());yb("StringMismatchCount",null==ra.q?null:ra.q.toString());
yb("NumericMismatchCount",null==ra.r?null:ra.r.toString());yb("ErrorMismatchCount",null==ra.s?null:ra.s.toString());yb("StringValuesCount",null==ra.t?null:ra.t.toString());yb("NumericValuesCount",null==ra.u?null:ra.u.toString());yb("BooleanValuesCount",null==ra.v?null:ra.v.toString());yb("BlankValuesCount",null==ra.w?null:ra.w.toString());yb("ErrorValuesCount",null==ra.x?null:ra.x.toString());yb("NumericValuesDiffAverage",null==ra.y?null:ra.y.toString());yb("NumericEvaluatedValuesMismatchSamples",
ra.z);yb("NumericFormattedTextMismatchSamples",ra.ba);yb("NumericMismatchSamples",ra.bb);yb("CellValueTypeMismatchSamples",ra.bc);yb("IfmtMismatchSamples",ra.bd);yb("BlockHashCode",ra.be);break;case 48:ye="DataValidationEditOpenDialog";yb("ServerCommand",ra.a);yb("SubDialogOpened",null==ra.b?null:ra.b.toString());yb("SubDialogButtonClicked",ra.c);yb("DialogOpened",null==ra.d?null:ra.d.toString());yb("RuleType",ra.e);yb("ConditionType",ra.f);yb("LowerBoundaryFilled",null==ra.g?null:ra.g.toString());
yb("UpperBoundaryFilled",null==ra.h?null:ra.h.toString());yb("IgnoreBlank",null==ra.i?null:ra.i.toString());yb("InCellDropdown",null==ra.j?null:ra.j.toString());yb("ShowInputMessage",null==ra.k?null:ra.k.toString());yb("InputTitleFilled",null==ra.l?null:ra.l.toString());yb("InputMessageFilled",null==ra.m?null:ra.m.toString());yb("ShowErrorAlert",null==ra.n?null:ra.n.toString());yb("AlertBlocking",null==ra.o?null:ra.o.toString());yb("AlertTitleFilled",null==ra.p?null:ra.p.toString());yb("AlertMessageFilled",
null==ra.q?null:ra.q.toString());yb("StopWatchId",ra.r);break;case 49:ye="DataValidationEditSubmitRule";yb("RuleType",ra.a);yb("ConditionType",ra.b);yb("LowerBoundaryFilled",null==ra.c?null:ra.c.toString());yb("UpperBoundaryFilled",null==ra.d?null:ra.d.toString());yb("IgnoreBlank",null==ra.e?null:ra.e.toString());yb("InCellDropdown",null==ra.f?null:ra.f.toString());yb("ShowInputMessage",null==ra.g?null:ra.g.toString());yb("InputTitleFilled",null==ra.h?null:ra.h.toString());yb("InputMessageFilled",
null==ra.i?null:ra.i.toString());yb("ShowErrorAlert",null==ra.j?null:ra.j.toString());yb("AlertBlocking",null==ra.k?null:ra.k.toString());yb("AlertTitleFilled",null==ra.l?null:ra.l.toString());yb("AlertMessageFilled",null==ra.m?null:ra.m.toString());yb("ClearAllPressed",null==ra.n?null:ra.n.toString());yb("ActionStatus",ra.o);yb("Error",ra.p);yb("StopWatchId",ra.q);break;case 50:ye="CustomSort";yb("RangeType",ra.a);yb("HasHeaders",null==ra.b?null:ra.b.toString());yb("SortTopToBottom",null==ra.c?null:
ra.c.toString());yb("ColumnCount",null==ra.d?null:ra.d.toString());yb("RowCount",null==ra.e?null:ra.e.toString());yb("RangeLimitExceeded",null==ra.f?null:ra.f.toString());yb("CaseSensitive",null==ra.g?null:ra.g.toString());yb("GetSortInfoDuration",null==ra.h?null:ra.h.toString());yb("LevelCount",null==ra.i?null:ra.i.toString());yb("SortOnValuesCount",null==ra.j?null:ra.j.toString());yb("SortOnCellColorCount",null==ra.k?null:ra.k.toString());yb("SortOnFontColorCount",null==ra.l?null:ra.l.toString());
yb("SortOnIconCount",null==ra.m?null:ra.m.toString());yb("CustomOrderCount",null==ra.n?null:ra.n.toString());yb("AvgCellColorCount",null==ra.o?null:ra.o.toString());yb("MaxCellColorCount",null==ra.p?null:ra.p.toString());yb("AvgFontColorCount",null==ra.q?null:ra.q.toString());yb("MaxFontColorCount",null==ra.r?null:ra.r.toString());yb("AvgIconsCount",null==ra.s?null:ra.s.toString());yb("MaxIconsCount",null==ra.t?null:ra.t.toString());yb("Executed",null==ra.u?null:ra.u.toString());break;case 51:ye=
"NamedSheetViewUserAction";yb("UserSessionId",ra.a);yb("UserActionName",ra.b);yb("UserActionSource",null==ra.c?null:ra.c.toString());yb("UserActionData",ra.d);yb("OtherData",ra.e);break;case 52:ye="NamedSheetViewTeachingCallout";yb("UserSessionId",ra.a);yb("TeachingCalloutSequence",null==ra.b?null:ra.b.toString());yb("TeachingCalloutIndex",null==ra.c?null:ra.c.toString());yb("UserActionName",null==ra.d?null:ra.d.toString());yb("UserActionData",ra.e);yb("DurationInMs",null==ra.f?null:ra.f.toString());
break;case 53:ye="NamedSheetViewTeachingDialog";yb("UserSessionId",ra.a);yb("UserActionName",ra.b);yb("ButtonClicked",ra.c);yb("DurationInMs",null==ra.d?null:ra.d.toString());yb("IsNewTeachingDialog",null==ra.e?null:ra.e.toString());break;case 54:ye="NamedSheetViewOptionsDialog";yb("UserSessionId",ra.a);yb("OptionsAction",null==ra.b?null:ra.b.toString());yb("OptionsActionData",ra.c);yb("OptionsOtherData",ra.d);yb("DurationInMs",null==ra.e?null:ra.e.toString());break;case 55:ye="NamedSheetViewTempViewApplyDialog";
yb("UserSessionId",ra.a);yb("TriggeredFrom",ra.b);yb("ButtonClicked",ra.c);yb("DurationInMs",null==ra.d?null:ra.d.toString());break;case 56:ye="NamedSheetViewTempViewSaveDialog";yb("UserSessionId",ra.a);yb("TriggeredFrom",ra.b);yb("ButtonClicked",ra.c);yb("NameUpdated",null==ra.d?null:ra.d.toString());yb("DurationInMs",null==ra.e?null:ra.e.toString());break;case 57:ye="TemporaryViewStartedDataRestore";yb("UserSessionId",ra.a);yb("CountOfTempViews",null==ra.b?null:ra.b.toString());break;case 58:ye=
"TemporaryViewFetchedVersion";yb("UserSessionId",ra.a);yb("NumberOfBytes",null==ra.b?null:ra.b.toString());break;case 59:ye="RaiseEventsAndGenerateBlockRequests";yb("ReturnContentStatus",null==ra.a?null:ra.a.toString());yb("CacheState",null==ra.b?null:ra.b.toString());yb("FromXhrCallback",null==ra.c?null:ra.c.toString());yb("AreGeneralErrorsPresent",null==ra.d?null:ra.d.toString());yb("BlockCacheItemHash",ra.e);yb("StopwatchId",ra.f);yb("BlockCacheItemProcessingStopwatchId",ra.g);yb("StateId",null==
ra.h?null:ra.h.toString());yb("IsHighPriority",null==ra.i?null:ra.i.toString());yb("CalcComplete",null==ra.j?null:ra.j.toString());yb("EditedCellsUpdatedByCse",null==ra.k?null:ra.k.toString());yb("DependentCellsUpdatedByCse",null==ra.l?null:ra.l.toString());yb("Revision",null==ra.m?null:ra.m.toString());yb("SheetProcessedDataVersion",null==ra.n?null:ra.n.toString());yb("RefCount",null==ra.o?null:ra.o.toString());yb("ExistsInView",null==ra.p?null:ra.p.toString());yb("ContentSource",null==ra.q?null:
ra.q.toString());break;case 60:ye="LaunchMakerCodeEditor",yb("SessionId",ra.a),yb("Command",ra.b),yb("IsPreviewGallery",null==ra.c?null:ra.c.toString()),yb("MenuItemId",ra.d),yb("ScriptId",ra.e),yb("ShareId",ra.f),yb("IsOwner",null==ra.g?null:ra.g.toString()),yb("PublishedScriptCount",null==ra.h?null:ra.h.toString()),yb("RecentScriptCount",null==ra.i?null:ra.i.toString()),yb("WorkbookScriptCount",null==ra.j?null:ra.j.toString())}Hd.Table=ye;return Sys.Serialization.JavaScriptSerializer.serialize(Hd)}
function t(){this.ipa=new z}function z(){}function r(Ca){var ra=zb.call(this)||this;ra.$=Ca;ra.dc();return ra}function G(Ca){var ra=Dc.call(this)||this;ra.Kmb=-1;ra.lqd=0;ra.Mwa=new Date(0);ra.jY=null;ra.Kha={};ra.vta=new eg.a;ra.F6a=!1;ra.XId=!1;ra.V1a=null;ra.N7a=0;ra.Sxc=0;ra.EKa=0;ra.isSynthetic=!1;ra.oSe=function(){var yb=new Date,Hd=yb.getMinutes(),ye=yb.getSeconds();ra.vzb&&yb.getTime()-ra.vzb.getTime()>ra.tBj?(ra.stop(),ra.r$c(yb)):(Hd!==ra.lqd&&(ra.r$c(yb),ra.lqd=Hd),ra.F6a&&(ra.ef.kj?ra.jY[ye]=
G.M4b:(ra.kFe(ye),ra.F6a=!1,ra.vta.clear(),ra.Kha={})),ra.jY[ye]!==G.M4b&&(ra.jY[ye]++,Hd=yb.getTime()-ra.Mwa.getTime(),Hd>ra.Gjf&&ra.uni(ra.Mwa,Hd)),ra.Kmb=window.requestAnimationFrame(ra.oSe),ra.Mwa=yb)};ra.IV=function(){ra.F6a=!0};ra.zqf=function(){ra.pause()};ra.Bqf=function(){ra.XId&&ra.resume()};ra.Hg=function(){ra.Ca.cH()&&ra.rKj()};ra.vzb=new Date;ra.ef=new R;ra.ef.aFa(ra.IV);Uf.AFrameworkApplication.SSc(ra.zqf);Uf.AFrameworkApplication.TSc(ra.Bqf);ra.$=Ca;ra.Gjf=Ca.ya.LongFrameThresholdMs;
ra.Uoi="MoreThan_"+ra.Gjf.toString()+"_Ms";ra.sBj=Ca.ya.ThresholdToEndOperationTrackingSeconds;ra.tBj=Ca.ya.ThresholdToStopFPSTrackingMS;ra.Ca=jg.g(ra.$).Ca;Uf.AFrameworkApplication.Gb&&Uf.AFrameworkApplication.Gb.IsSynthetic&&(ra.isSynthetic=rg.a.compare(Uf.AFrameworkApplication.Gb[tg.a.isSynthetic],"True",!0)?!1:!0);ra.Ca.np(ra.Hg);ra.rId();ra.vni=ra.$.dwa&&af.EwaSettings.la(614);return ra}function w(Ca,ra,yb,Hd,ye,Cf,Bf,ch,Tg,fe){this.Op=null;this.Min=this.Max=this.Avg=this.end=this.start=this.count=
0;this.LFrame=null;this.tfAppInt=this.coauth=this.longFrameCount=0;this.Props=null;this.Op=void 0===Ca?null:Ca;this.count=void 0===ra?0:ra;this.start=void 0===yb?-1:yb;this.end=void 0===Hd?-1:Hd;this.Avg=void 0===ye?0:ye;this.Max=void 0===Cf?-1:Cf;this.Min=la.a.ueg;this.longFrameCount=void 0===Bf?0:Bf;this.coauth=(void 0===ch?-1:ch)||1;this.tfAppInt=void 0===Tg?-1:Tg;this.Props=void 0===fe?null:fe;this.LFrame=null}function B(Ca,ra){this.duration=this.startSecond=0;this.startSecond=void 0===Ca?-1:
Ca;this.duration=void 0===ra?-1:ra}function U(){this.f=null}function N(Ca){var ra=this;this.Vzd={};this.vga=null;this.Wdb=function(yb,Hd){yb.longFramesOverThresholdOps++;yb.maxLongFrameDuration=Math.max(yb.maxLongFrameDuration,Hd)};this.lf=new P;this.B3g();Ca.da.Za(276,function(){dd.a(Ca).g9(ra.lf)})}function P(){this._reportName=null;this.operationsGroups=[];this._reportName="FramePerformanceCanvas"}function ia(Ca){this.name=null;this.count=0;this.minFPS=-1;this.maxFPS=0;this.l1FramePerformanceData=
new W;this.l2FramePerformanceData=new W;this.l3FramePerformanceData=new W;this.name=Ca}function W(){this.longFramesOverThresholdOpsPercentage=this.longFramesOverThresholdOps=this.fpsUnderThresholdOpsPercentage=this.fpsUnderThresholdOps=0;this.maxLongFrameDuration=-1}function R(){var Ca=ii.call(this)||this;Ca.rL=!1;Ca.L7d=null;Ca.M7d=null;Ca.Gxd=function(){Ca.n$f()};Ca.XHi=function(){Wf.a.Fa(Ca.NY);Wf.a.Fa(Ca.nk)};Ca.NY=Rg.a.instance.ysa();Ca.nk=Rg.a.instance.VD();Ca.NY.ja("visibilitychange",Ca.Gxd);
Ca.nk.ja("pagehide",Ca.XHi);Ca.n$f();return Ca}function I(Ca){var ra=this;this.MDe=!1;this.ODe=null;this.kd=function(){ra.zbj();jg.g(ra.$).ha&&jg.g(ra.$).ha.DK(ra.kd)};this.Yh=function(yb,Hd){Hd.oa&&!ra.DSd.has(Hd.oa.name)&&(ra.DSd.add(Hd.oa.name),jg.g(ra.$).ha&&(jg.g(ra.$).ha.DK(ra.kd),jg.g(ra.$).ha.iG(ra.kd)))};this.$=Ca;this.P4f=new Set;this.DSd=new Set;this.$.xa&&this.$.xa.oa&&this.DSd.add(this.$.xa.oa.name);jg.g(this.$).ha.iG(this.kd);this.$.xa.Pf(this.Yh)}function Q(Ca){ae.ULS.sendTraceTag(537151049,
0,50,"CpuMeterTaskEventRegistrationManager.RegisterCpuMeterTaskEvent: Starting RegisterCpuMeterTaskEvent");bf.TaskExtensions.Ba(hi.a.Fq(we.a.instance.mc("Common.ICpuMeterProvider")),function(ra){ae.ULS.sendTraceTag(537151048,0,50,"CpuMeterTaskEventRegistrationManager.RegisterCpuMeterTaskEvent: CpuMeterProvider resolved");bf.TaskExtensions.Ba(ra.result.Sl.task,function(yb){ae.ULS.sendTraceTag(537151047,0,50,"CpuMeterTaskEventRegistrationManager.RegisterCpuMeterTaskEvent: CpuMeter resolved");var Hd=
new O(Ca);yb.result.jSc(0,Object(gc.a)(Hd,Hd.Luh,"filterTaskEvent"),Object(gc.a)(Hd,Hd.IDj,"traceTaskEvent"))},Ca.ma,3)},Ca.ma,3)}function O(Ca){var ra=this;this.ef=null;this.WSd=Ca.ya.TimeToReportOnLongWaitingTaskInMsAsWarning;this.VSd=Ca.ya.TimeToReportOnLongWaitingTaskInMsAsMedium;this.USd=Ca.ya.TimeToReportOnLongRunningTaskInMsAsWarning;this.TSd=Ca.ya.TimeToReportOnLongRunningTaskInMsAsMedium;this.fa=Ca.fa;Ca.da.Za(291,function(yb){ra.ef=yb});ae.ULS.sendTraceTag(537151046,0,50,"TaskEventProcessor initialized with TimeToReportOnLongWaitingTaskInMsAsMedium = {0}, TimeToReportOnLongWaitingTaskInMsAsWarning = {1}, TimeToReportOnLongRunningTaskInMsAsMedium = {2}, TimeToReportOnLongRunningTaskInMsAsWarning = {3}",
this.VSd,this.WSd,this.TSd,this.USd)}function ba(Ca){this.Nra=[];this.JYc=null;this.Msi=100;this.documentVisibilityObserver=null;this.Lsi=Ca}function ca(Ca,ra){this.C8c=0;this.gOe=this.startTime=tf.HelperMethods.jc();this._name=Ca;this.AB=ra}function S(Ca,ra){this.stopped=!1;this.chainedCallsTracer=Ca;this.Dhg=ra}function Y(Ca){var ra=this;this.CUc="AppUnloadInfo";this.nk=this.$=this.workbookHashedId=this.vy=null;this.MZd=this.o2d=!1;this.Df=null;this.d7e=0;this.Uba=function(yb,Hd){ra.d7e=Hd.ayc};
this.XAf=function(yb,Hd){Hd.AWd.length&&ra.$.CE&&(ra.vy.dataLossInfo=new na(Hd),ra.vy.wasDataLostDuringUnload=!0,ra.Qab())};this.Rg=function(){ra.DTf();ra.$.fa.hr(ra.Rg)};this.GNa=function(){ra.vy.wasUpdatedOnBeforeUnload=!0;ra.vy.inactivityDurationBeforeUnloadSeconds=ra.Df.bdb<Y.Jri?ra.d7e:ra.Df.bdb;ra.w$f()};this.lDb=function(){ra.vy.wasUpdatedOnUnload=!0;ra.w$f();Sys.Application.remove_unload(ra.lDb)};this.LKi=function(){ra.vy.lastSilentReopenStartTime=sf.a.Ra.Kb;ra.vy.lastSilentReopenEndTime=
null;ra.Qab();ra.$.Rk(ra.Nzf)};this.Nzf=function(){ra.vy.lastSilentReopenEndTime=sf.a.Ra.Kb;ra.Qab();ra.$.ml(ra.Nzf)};this.localStorage=new oh.a;this.aOf=af.EwaSettings.isChangeGateEnabled("OfficeVSO:5618594_OfflineModeUXEnabled");this.localStorage.og()&&(this.$=Ca,this.workbookHashedId=ti.a(this.$),this.vy=new Z(this.workbookHashedId,this.$.ya.UserSessionId),this.nk=Rg.a.instance.VD(),this.nk.ja("beforeunload",this.GNa),this.$.userOperationManager.WCg(this.XAf),Ca.fa.Mh?this.DTf():this.$.fa.sn(this.Rg),
this.Df=this.$.fa.Df,this.Df.dra(this.Uba),Sys.Application.add_unload(this.lDb),af.EwaSettings.isChangeGateEnabled("OfficeVSO:5470513_trackSilentReopenUnloads")&&this.$.fa.LTc(this.LKi))}function na(Ca){this.lostOperationsCount=0;this.mostCommonOperationName=null;this.mostCommonOperationCount=0;this.dataLossReason=null;this.lostOperationsCount=Ca.kxe+Ca.a8f;this.dataLossReason=Ca.qte;this.ROg(Ca.AWd)}function Z(Ca,ra){this.hadConnectivityIssuesDuringUnload=this.wasOfflineDuringUnload=!1;this.timestamp=
0;this.dataLossInfo=null;this.wasDataLostDuringUnload=!1;this.inactivityDurationBeforeUnloadSeconds=0;this.workbookHashedId=null;this.apiBeforeCloseNotificationEnabledOnUnload=this.dialogPromptedOnUnload=!1;this.wacSessionId=null;this.timeFromLastStatusCode0=this.timeFromLastDisconnectionStart=this.timeFromLastConnectivity=0;this.wasUpdatedOnBeforeUnload=this.wasUpdatedOnUnload=!1;this.lastSilentReopenEndTime=this.lastSilentReopenStartTime=this.disconnectionSource=null;this.workbookHashedId=Ca;this.wasUpdatedOnUnload=
this.wasDataLostDuringUnload=this.apiBeforeCloseNotificationEnabledOnUnload=this.dialogPromptedOnUnload=!1;this.wacSessionId=ra}function wa(Ca){var ra=kd.call(this)||this;ra.Cla=null;ra.ima=null;ra.YCe=Array(1);ra.Esd=null;ra.VKc=null;ra.Zh=function(yb,Hd){af.EwaSettings.la(41)&&(ra.ima=ra.ima||new Xa(ra.$,ra.ZH,ra.Yka),ra.ima.Zh(yb,Hd))};ra.Xo=function(yb,Hd){af.EwaSettings.la(41)&&(ra.ima=ra.ima||new Xa(ra.$,ra.ZH,ra.Yka),ra.ima.Xo(yb,Hd))};ra.qd=function(yb,Hd){af.EwaSettings.la(41)&&ra.ZH.qd(yb,
Hd)};ra.Rg=function(yb,Hd){af.EwaSettings.la(41)&&ra.ZH.Rg(yb,Hd)};ra.Lgc=function(yb,Hd){af.EwaSettings.la(41)&&ra.ZH.Lgc(yb,Hd)};ra.$=Ca;if(!af.EwaSettings.la(41))return ra;ec.a.u3h(ra.$);ra.QM=new Fa(ra.$);ra.O2g();af.EwaSettings.la(615)&&ra.$6a&&(ra.Esd=new ta(ra.$,ra.$6a));ra.ZH=new ma(ra.$);ra.Yka=new Qb(ra.$);ra.$.Vl(ra.qd);ra.$.qa.us(ra.Zh);ra.$.qa.FB(ra.Xo);ra.$.fa.Uke(ra.Lgc);af.EwaSettings.isChangeGateEnabled("OfficeVSO:5638214_UMIIsLinkable")&&ra.$.fa.sn(ra.Rg);return ra}function ma(Ca){this.dirtySessionOnLastRecordedRequest=
this.xQd=!1;this.Phf=0;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.$=Ca;this.plb={};this.olb={};this.B3c={}}function pa(Ca,ra,yb,Hd,ye,Cf,Bf,ch){this.mode=null;this.dirtySessionOnLastRecordedRequest=this.endedBySplashScreen=this.ocsCapable=!1;this.maxCoauthorsCount=this.loadOnDemandCount=0;this.everConnectedToOcs=!1;this.requests=null;this.mode=Ca;this.ocsCapable=ra;this.endedBySplashScreen=yb;this.dirtySessionOnLastRecordedRequest=Hd;this.loadOnDemandCount=ye;this.maxCoauthorsCount=
Cf;this.everConnectedToOcs=Bf;Ca=[];for(var Tg in ch)ra=ch[Tg],ra.N9c(),Ca.push(ra.data);this.requests=Ca}function Ia(Ca){this.data=new Ma;this.data.requestName=Ca;this.data.totalCount=0;this.mab=[];this.JTd=this.ATd=this.BTd=this.GTd=0;this.data.successfulCalls=0;this.data.unsuccessfulCalls=0;this.data.callsDuringEcsFreeze=0;this.data.longestRequest=null;this.data.requestDurationPercentile25=-1;this.data.requestDurationPercentile50=-1;this.data.requestDurationPercentile75=-1;this.data.requestDurationPercentile95=
-1}function Ma(){this.requestName=null;this.averageWfeDuration=this.averageEcsDuration=this.averageEcsOperationDuration=this.averageDuration=this.callsDuringLoadOnDemand=this.callsDuringEcsFreeze=this.unsuccessfulCalls=this.successfulCalls=this.totalCount=0;this.longestRequest=null;this.requestDurationPercentile95=this.requestDurationPercentile75=this.requestDurationPercentile50=this.requestDurationPercentile25=0}function ob(Ca,ra){this.data=new Cb;this.data.operationName=Ca;this.data.isUserOperation=
ra;this.data.totalCount=0;this.d2f=[];this.e2f=[];this.data.longestStartToNextFrame=-1;this.data.longestStartToResponse=-1;this.data.startToNextFramePercentiles="";this.data.startToResponsePercentiles=""}function Cb(){this.operationName=null;this.isUserOperation=!1;this.longestStartToResponse=this.longestStartToNextFrame=this.totalCount=0;this.startToResponsePercentiles=this.startToNextFramePercentiles=null}function Xa(Ca,ra,yb){this.$=Ca;this.ZH=ra;this.Yka=yb}function Sb(){}function Tb(Ca,ra,yb,
Hd,ye,Cf,Bf,ch,Tg,fe,Ih,Th,h,Bb,ic,Nc,pd){this.requestName=null;this.isPromotedUTRRequest=this.isFullyLoggedKPIRequest=this.isUserTriggeredRequest=!1;this.TimeFromLastEcsFreeze=this.WfeRequestDuration=this.EcsRequestDuration=this.ecsOperationDuration=this.requestInvokedTime=this.requestTimeInQueue=this.totalOperationDuration=this.requestDuration=0;this.DuringLoadOnDemand=!1;this.errors=this.correlationID=null;this.httpStatus=0;this.requestResourceTiming=null;this.communicationErrorRetryCount=0;this.isDocumentHidden=
this.successfulCall=!1;this.responseSize=this.coauthorsCount=0;this.networkInfoData=null;this.responseToCallbackTime=0;this.requestName=Ca;this.isUserTriggeredRequest=Tb.aLh(Ca);this.isFullyLoggedKPIRequest=Tb.YKh(Ca);this.isPromotedUTRRequest=Tb.ZKh(Ca);this.requestDuration=ra;this.totalOperationDuration=yb;this.requestTimeInQueue=Hd;this.requestInvokedTime=ye;this.ecsOperationDuration=Cf.EcsOperationDuration;this.EcsRequestDuration=Cf.EcsRequestDuration;this.WfeRequestDuration=Cf.WfeRequestDuration;
this.TimeFromLastEcsFreeze=Cf.TimeFromLastEcsFreeze;this.DuringLoadOnDemand=Cf.DuringLoadOnDemand;this.correlationID=Bf;this.errors=Tb.dYg(ch);this.httpStatus=Tg;this.requestResourceTiming=fe;this.communicationErrorRetryCount=Ih;this.successfulCall=Th;this.isDocumentHidden=h;this.coauthorsCount=Bb;this.responseSize=ic;this.networkInfoData=Nc;this.responseToCallbackTime=pd}function da(Ca,ra){this.messageIdName=null;this.errorCause=0;this.messageIdName=Ca;this.errorCause=ra}function ya(Ca,ra,yb,Hd){var ye=
this;this.framePerformanceTracker=this.wGb=this.q_=this.q0=null;this.f8i=function(){ye.wUc=-1;var Cf=tf.HelperMethods.jc();ye.wLj(Cf);af.EwaSettings.la(378)&&(ye.JHb&&(ae.ULS.sendTraceTag(537153878,1,50,"GroupDetector: Setting current frame operations render duration due to rendering without additional blocks."),ye.wMb(ye.XD,Cf),ye.JHb=!1),ye.efc&&(ye.wMb(ye.FC,Cf),ye.JHb||ye.wMb(ye.XD,Cf)));window.setTimeout(ye.$mi,0)};this.$mi=function(){for(var Cf=new eg.a,Bf=ye.$.ya.OperationToPrevOperationThreshold,
ch=0;ch<ye.XD.count;ch++){var Tg=ye.XD.na(ch);ch<Bf&&Cf.add(Tg);ye.FC.add(Tg)}jg.g(ye.$)&&jg.g(ye.$).Ca?((ch=ye.sessionStatisticsManager.Wbd(0))?ae.ULS.sendTraceTag(237798547,1,50,"DOM count: ({0}, {1}, {2}), long tasks: {3}, operations count: {4}, operations: {5}",ch.Rsi,ch.QIg,ch.vri,ye.hAb,ye.XD.count,Cf):ae.ULS.sendTraceTag(537153876,1,50,"Report Manager NumberOfDomElements does not exist"),ye.XD.count>Bf&&ae.ULS.sendTraceTag(537153875,1,50,"More than {0} operations are in the operationsList. count: {1}",
Bf,ye.XD.count),ye.XD.clear(),ye.hAb.clear()):ae.ULS.sendTraceTag(537153877,1,10,"Grid == null or BlockManager == null")};this.Plc=function(Cf,Bf){ye.Woi(Bf.nJe)};this.$=Ca;this.ZH=ra;this.Pg=this.Pg||sf.a.Ra;this.FC=new eg.a;this.XD=new eg.a;this.wUc=this.z6a=-1;this.hAb=new eg.a;this.operationsGroupDetector=new hb;this.JHb=this.efc=!1;this.x3h();this.c3h();this.b3h();this.sessionStatisticsManager=yb;this.QM=Hd;this.QM.ele(this.Plc);this.$.da.Za(263,function(Cf){ye.framePerformanceTracker=Cf})}function hb(){this.operationsGroups=
null;this.a3h()}function Gb(Ca,ra,yb,Hd,ye,Cf,Bf,ch,Tg,fe){this.name=null;this.startToResponseRenderEnd=this.startToNextFrame=this.startTime=0;this.isPartOfGroup=this.isGroupBreaking=this.isUserOperation=this.wasHidden=!1;this.operationThatLedToLogging=null;this.startToOperationThatLedToLogging=0;this.name=void 0===Ca?"":Ca;this.startTime=void 0===ra?-1:ra;this.startToNextFrame=void 0===yb?-1:yb;this.startToResponseRenderEnd=void 0===Hd?-1:Hd;this.wasHidden=void 0===ye?!1:ye;this.isUserOperation=
void 0===Cf?!0:Cf;this.isGroupBreaking=void 0===Bf?!0:Bf;this.operationThatLedToLogging=void 0===Tg?"":Tg;this.startToOperationThatLedToLogging=void 0===fe?-1:fe;this.isPartOfGroup=void 0===ch?!1:ch}function Qb(Ca){var ra=vf.call(this)||this;ra.statusBarManager=null;ra.xSc=!1;ra.Tof=function(){ra.raiseEvent("NetworkInformation")};ra.$=Ca;if(!af.EwaSettings.isChangeGateEnabled("OfficeVSO:3539919_AddNetworkInformationTelemetry"))return ra;ra.g_=ra.mUd("connection")||ra.mUd("mozConnection")||ra.mUd("webkitConnection");
ra.g_&&af.EwaSettings.la(490)&&Ca.da.Za(29,function(yb){ra.statusBarManager=yb;yb.$I(ra);ra.g_.addEventListener("change",ra.Tof);ra.xSc=!0});return ra}function Fb(){this.rttMs=this.bandwidthMps=0;this.effectiveConnection=this.connectionType=null;this.downlinkMaxMps=0}function ta(Ca,ra){var yb=Dd.call(this)||this;yb.ef=null;yb.statusBarManager=null;yb.ewf=function(Hd,ye){ye.Bsd&&ye.Bsd.duration>=yb.Yoi&&(yb.Jjf++,yb.mgf=ye.Bsd.duration)};yb.$=Ca;yb.$.da.Za(29,function(Hd){yb.statusBarManager=Hd;Hd.$I(yb)});
yb.$.da.Za(291,function(Hd){yb.ef=Hd});yb.Jjf=0;yb.mgf=0;yb.Yoi=Ca.ya.LongTaskThresholdMs;yb.$6a=ra;yb.$6a.eBg(yb.ewf);return yb}function xa(Ca,ra){var yb=this;this.Ma=new $f.a;this.oMa=this.o5=this.dS=this.ef=null;this.Rff=this.LOd=this.Kgc=!1;this.XMa=null;this.maxUsersCount=0;this.Plc=function(Hd,ye){Hd=ye.nJe.getEntriesByType(tg.a.Asd);Hd=yl(Hd);for(ye=Hd.next();!ye.done;ye=Hd.next())if(ye=ye.value,!yb.ef.eH(ye.duration)&&!Uf.AFrameworkApplication.$5a){yb.dS.bke(ye.duration);yb.Ma.raiseEvent("lttek",
new sa(ye));var Cf={};Cf.LongTaskDuration=ye.duration;Cf.LongTaskStartTime=ye.startTime;ae.ULS.sendTraceTag(187982418,0,50,JSON.stringify(Cf))}};this.Rg=function(){yb.LOd=!0;yb.Lwc()};this.IH=function(Hd,ye){ye&&(yb.maxUsersCount=Math.max(yb.maxUsersCount,ye.BWd));yb.o5.maxUsersCount=yb.maxUsersCount};this.od=function(){yb.Lwc()};this.qd=function(){yb.E2f()};this.dwf=function(Hd,ye){ye.rdc&&yb.Lwc()};this.Ajf=function(){yb.dS.MSc(Qe.getElapsedMilliseconds(yb.oMa,sf.a.Ra.Kb));yb.CQd(!0);var Hd=!1;
yb.o5.postBootWindowData.activeSessionDuration?(!yb.Rff&&af.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&(yb.Zag&&qb.b().rOf(2),Rc.Health.instance.recordKpiUsage(cf.a.longJsTask,0,sd.a.oii,null),yb.Rff=!0),!yb.o5.isVetoSession&&yb.dS.fhi(yb.Ibg)&&(yb.o5.isVetoSession=!0,af.EwaSettings.isChangeGateEnabled("OfficeVSO:4606533_CreateKpi2ForLongJsTask")&&(yb.Zag&&qb.b().sOf(2,yb.Voi),Rc.Health.instance.recordKpiFailure(cf.a.longJsTask,"SessionVetoedJsLoadTooSlow",!1,!0,
null))),yb.o5.worstWindowData.Dsd<=yb.dS.Dsd&&(yb.o5.worstWindowData=yb.dS),yb.o5.entireSessionData.Gyg(yb.dS)):(yb.o5.postBootWindowData=new Yb(yb.dS.activeSessionDuration,yb.dS.longTaskDuration),Hd=!0);var ye={};ye.LastWindowScore=yb.dS;ye.postBootWindow=Hd;ye.CoauthersNumber=yb.$.fa.Em.length;Hd=JSON.stringify(ye);ae.ULS.sendTraceTag(20779346,0,50,Hd);yb.dS=new Yb};this.Kkc=function(){yb.ef.kj||Uf.AFrameworkApplication.$5a||yb.CQd(!1)};this.Jkc=function(){yb.dS.MSc(Qe.getElapsedMilliseconds(yb.oMa,
sf.a.Ra.Kb));yb.oMa=null;yb.XMa.cancel()};this.$=Ca;this.Ibg=Ca.ya.LongTaskPerformanceVetoThreshold;this.Voi="PercentageOver_"+this.Ibg.toString();this.Csd=Ca.ya.LongTaskPerformanceWindowDurationInMs;this.QM=ra;this.Zag=af.EwaSettings.isChangeGateEnabled("OfficeVSO:5142056_use_UTR_in_LongJsTask");this.$.da.Za(291,function(Hd){yb.ef=Hd;yb.Lwc()});this.$.fa.Mh?this.Rg(this,Sys.EventArgs.Empty):this.$.fa.sn(this.Rg);this.QM.dBg(this.dwf);this.$.Rk(this.od);this.$.Vl(this.qd)}function sa(Ca){var ra=Be.call(this)||
this;ra.Bsd=Ca;return ra}function lb(Ca,ra,yb,Hd,ye){this.isVetoSession=!1;this.postBootWindowData=this.worstWindowData=this.entireSessionData=null;this.maxUsersCount=0;this.isVetoSession=Ca;this.entireSessionData=ra;this.worstWindowData=yb;this.postBootWindowData=Hd;this.maxUsersCount=ye}function Yb(Ca,ra){this.longTaskDuration=this.activeSessionDuration=0;this.activeSessionDuration=void 0===Ca?0:Ca;this.longTaskDuration=void 0===ra?0:ra}function Fa(Ca){var ra=this;this.Ma=new $f.a;this.oIc=!1;this.Rg=
function(){if(Lf.a.Po){try{void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&((new PerformanceObserver(ra.Xoi)).observe(new Lb([tg.a.Asd])),ra.oIc=!0)}catch(yb){ra.oIc=!1,ae.ULS.sendTraceTag(537153885,0,10,"Exception related to PerformanceObserver: {0}",yb)}ra.Ma.raiseEvent("ltpoiek",new Sa(ra.rdc))}};this.Xoi=function(yb){ra.Ma.raiseEvent("ltoek",new Ra(yb))};this.$=Ca;this.$.fa.Mh?this.Rg(this,Sys.EventArgs.Empty):this.$.fa.sn(this.Rg)}function Sa(Ca){var ra=Rd.call(this)||
this;ra.rdc=Ca;return ra}function Ra(Ca){var ra=ce.call(this)||this;ra.nJe=Ca;return ra}function Lb(Ca,ra){this.entryTypes=null;this.buffered=!1;this.entryTypes=Ca;this.buffered=void 0===ra?!1:ra}function Ja(Ca,ra){var yb=sb.call(this)||this;yb.EGb=!1;yb.Qgd=!1;yb.cZf=!0;yb.Ma=new $f.a;yb.YEc=!1;yb.qd=function(){var Hd=rb.a(yb.$).nd.activityState,ye=Ec.a.ug(Hd,Da.a.tie);Ec.a.ug(Hd,Da.a.Ilb)||ye||yb.upload()};yb.$=Ca;yb.Stb=ra;yb.fa=Ca.fa;yb.$.Vl(yb.qd);yb.i8f=new Kb;yb.uOa=new Hc(og.a.fKd,Ca.ya.PageGenerationMetrics.TimeToCompleteFirstFlush);
yb.qAc=new xb(yb);return yb}function xb(Ca){this.s1b=[];this.lFg=null;this.sqmManager=Ca}function Kb(){this.xsd=null;this.OVg=Kb.w0g();this.qPf()}function Eb(Ca,ra,yb){this.sPc=Ca.keyCode;this.kIb(Ca.ctrlKey,1);this.kIb(Ca.shiftKey,2);this.kIb(Ca.altKey,4);this.kIb(Vf.b(Ca),8);this.kIb(yb,16);this.sPc=this.ycb|ra<<24}function Hc(Ca,ra){this.qPb=null;this.U3b=this.Uhd=!1;this.pde=this.qde=null;this.a4a=this.$3a=0;this.ySf=Ca;this.yae=ra}function Xc(Ca){var ra=Md.call(this)||this;ra.sU=Ca;return ra}
function Pc(Ca){var ra=Od.call(this)||this;ra.$=Ca;ra.dc();return ra}function wd(Ca){var ra=this;this.PIa=new Set;this.FKb=null;this.u3f=!1;this.Rg=function(){ra.hmi();ra.FKb=Hf.a.instance.create(function(){ra.cAb()},wd.Yyj,Bg.a.cAb)};this.qd=function(){ra.cAb()};this.xDb=function(yb,Hd){yb=ra.Mnb.blockedActions.length;var ye=Hd.details?Hd.actionName+"_"+Hd.details:Hd.actionName;Hd=Object.assign(new Ta,{order:yb+1,name:ye,componentName:Hd.componentName,timeFromNavigationStart:Hd.timeFromNavigationStart});
Array.add(ra.Mnb.blockedActions,Hd)};this.Mnb=new fb;this.Mnb.hasBlockedActions=!1;this.Jcb=new Tc;this.vuh();this.$=Ca;this.$.fa.sn(this.Rg);this.$.Vl(this.qd)}function Tc(){this.successfulActions=[]}function ub(){var Ca=Ta.call(this)||this;Ca.inputMethod=null;Ca.isCommand=!1;return Ca}function fb(){this.hasBlockedActions=!1;this.blockedActions=[]}function Ta(){this.order=0;this.componentName=this.name=null;this.timeFromNavigationStart=0}function eb(Ca){var ra=Bd.call(this)||this;ra.$=Ca;ra.dc();
return ra}function tb(Ca,ra){this.interactivityTrackerService=this.Y1f=this.dDd=this.Z9a=this.eDd=this.kGf=this.lGf=null;this.mVi=new Set([1,0]);ae.ULS.sendTraceTag(537155528,0,50,"JsSelfProfilerManager.Ctor: creating new JsSelfProfilerManager");this.$=Ca;this.interactivityTrackerService=ra;this.i5h();this.h5h();this.pii=this.$.ya.JsProfilingSampleIntervalInMs;this.profilingIntervalInMs=af.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingWindowDurationInMs",1E4);this.kze=af.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilingIdleIntervalInMs",
3E5);this.yxj()}function rc(){this.shouldMakeSerializedCallTreesFullyReconstructible=this.shouldKeepQueryParamsInResourceURLs=this.shouldProcessProfileCapturedWhileUserIsIdle=this.shouldSendProfilesForDeobfuscationImmediately=this.canUseMultipleWebWorkers=this.shouldUseInMemoryLogger=this.featureEnabledChecker=this.deObfuscationRequestQueryParamsRetriever=this.deObfuscationRequestBodyPropertiesRetriever=this.durationThresholdInMsToLogOperationData=this.shouldAlwaysLogOperationsData=this.shouldUseSendBeaconForSendingCallTrees=
this.shouldSendAllCallTreesFromProfileInASingleRequest=this.frameTotalExecutionTimeFilteringThresholdInMs=this.shouldCompressSerializedCallTrees=this.shouldRecordExpandedTimeStamps=this.profilerTraceProcessingWebWorkerSourceURL=this.useMainEventLoopForProfilerTraceProcessing=this.shouldKeepSamplesOutsideOfProfilingInterval=this.shouldProfilingStartInAHiddenDocument=this.shouldProcessProfileCapturedInAHiddenDocument=this.callTreeFilteringThresholdInMs=this.deObfuscationEndpoint=this.ulsInstance=this.buildVersion=
this.appName=null}function wb(){this.samplingIntervalInMs=0;this.idleIntervalInMs=this.profilingIntervalInMs=this.maximumNumberOfSamplesToTake=null}function E(Ca,ra){this.XKi=Ca;this.ZKi=ra}function Mb(){}function ka(){}function bb(){this.customProperties=new Map}function Ga(Ca){this.uvj=Ca}function Ha(Ca){var ra=bg.call(this)||this;ra.$=Ca;ra.dc();return ra}function Ua(Ca){var ra=this;this.tQ=null;if(Ua.hbf)ae.ULS.sendTraceTag(537155545,0,50,"InteractivityTrackerService: instance was already created once. skipping initialization.");
else{if(af.EwaSettings.isChangeGateEnabled("OfficeVSO:5960700_ShouldCreateProfilerAfterInteractivityTracker"))this.initialize(Ca);else{var yb=lf.GetServiceTaskFactory.Xa(Ca.da,283,284,1);bf.TaskExtensions.Ba(yb,function(){bf.TaskExtensions.Ba(Og.c(yb.result.wo.loadScript("interactivity")),function(){ae.ULS.sendTraceTag(537155544,0,50,"Interactivity slice is loaded");ra.initialize(Ca)},Ca.ma,3)},Ca.ma,3)}Ua.hbf=!0}}function kb(){this.events=null;this.durationThresholdInMs=0;this.patchTaskScheduling=
this.callbacks=null}function $a(Ca){this.$=Ca}function Xb(){this.coAuthCount=this.appState=null}function dc(Ca){var ra=te.call(this)||this;ra.K8e=0;ra.eRe=!1;ra.nqd=Array(dc.r7a);ra.A3b=0;ra.$=Ca;ra.Rxb=af.EwaSettings.la(78);ra.pef=af.EwaSettings.isChangeGateEnabled("OfficeVSO:3683664_AddTelemetryForNonCommandActions");ra.fdi=af.EwaSettings.isChangeGateEnabled("OfficeVSO:5893585_PageLoadEngagementInfo");ra.T8h=af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AsyncLogInteractivityRecord",
!1);ra.ASj=ng.a.ONh();ra.z4={};dc.wWb||(dc.wWb=new be.a(Rf.a.Ik()),dc.A3h(dc.wWb));Za.o4h();if(af.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback"))for(Ca=0;Ca<dc.r7a;Ca++)ra.nqd[Ca]="NA";return ra}function Za(){this.commandSurface=this.triggerMethod=ng.a.Ldb}function Wa(Ca,ra,yb){Ca=Ba.call(this,Ca.operation,Ca.properties,Ca.correlations)||this;Ca.timeFromAppInteractive=0;Ca.timeFromNavigationStart=0;Ca.timeFromAppInteractive=ra;Ca.timeFromNavigationStart=yb;return Ca}
function Ba(Ca,ra,yb){this.correlations=this.properties=this.operation=null;this.operation=Ca;this.properties=ra;this.correlations=yb}function db(Ca){var ra=Zf.call(this)||this;ra.vye=!1;ra.$=Ca;return ra}function Zb(Ca,ra,yb){var Hd=Ng.call(this,ra,yb)||this;Hd.Ma=new Cg.a;Hd.F0h=function(ye){if(af.EwaSettings.isChangeGateEnabled("OfficeVSO:3449424_AgaveValidateHost")){var Cf=ye.Values.m_Origin;Uf.AFrameworkApplication.wopiHostOriginFromPostMessage||(Uf.AFrameworkApplication.wopiHostOriginFromPostMessage=
Cf)}switch(ye.MessageId){case me.a.$hd:cg.a(Hd.$).e3e(ye);break;case me.a.Crd:gg.a.ltas(null);break;case me.a.Ccc:Hd.lFi();break;case me.a.eid:Hd.kFi(ye)}};Hd.$=Ca;yb!==Ie.a.s9&&Hd.TEa(yb);Hd.k5h();Hd.y4h();Ca=Hd.F0h;Hd.Km(me.a.$hd,Ca);Hd.Km(me.a.Crd,Ca);Hd.Km(me.a.Ccc,Ca);Hd.Km(me.a.eid,Ca);return Hd}function Jb(){}function Ic(){}function uc(Ca){this.Nw=[];this.aQb=[];this._count=void 0===Ca?1:Ca}function za(Ca){this.ogb=null;this.Sl=new se.a;this.mL=Ca}function pb(Ca,ra,yb,Hd,ye){this.sEa=0;this.$F=
null;this.qUb=this.Pee=0;this.bde=!1;this.GUa=0;this.$hb=!1;this.bqa=null;this.xRb=0;this.V$d=new Cg.a;this.wVb=[];this.mL=Ca;this.WKc=ra;this.QGc=yb;this.c9d=Hd;Uf.AFrameworkApplication.ga&&Uf.AFrameworkApplication.ga.ra("WrapSetTimeoutForTelemetryIsEnabled")&&this.Rpd();this.Vjg=ye;this.RGc=new Qd(100);this.Jng=Ac.i2a(1,5,new cc)}function cc(Ca){Ca=void 0===Ca?null:Ca;this.Sm=null;this.reset();this.hkb=Ca}function Ac(Ca,ra,yb,Hd,ye,Cf,Bf){Cf=void 0===Cf?!0:Cf;Bf=void 0===Bf?null:Bf;this.tX=this.cfe=
this.p7d=!1;this.je=null;if(!Ca)throw Sc.a.argument("taskManagerLazy");if(!ye)throw Sc.a.argument("dataAggregator");this.Gsg=Ca;this.aMc=ra;this._id=yb;this.O5d=6E4*Hd;this.SPb=ye;this.pce=Cf;this.hkb=Bf;ad.UUh().wb(this._id.toString())&&(this.tX=!0)}function ad(){}function Jd(){}function Xd(){}function od(Ca){var ra=cb.call(this)||this;ra.bof=Ca;return ra}function Je(){}function bc(){}function Qd(Ca,ra){var yb=this;this.eIc=!1;this.WCa={};this.oSb=void 0===Ca?0:Ca;this.ySb=void 0===ra?0:ra;this.AQc=
0;Bc.a.addHandler(window.self,Jc.a.aEg,function(){yb.eIc=!0});Bc.a.addHandler(window.self,Jc.a.bEg,function(){yb.eIc=!1})}function Vd(){this.S=this.T=this.M=this.C=0}function de(){this.iUa=[];this.t1d=this.VEc=0;this.Aea=null;this.Ya=new Cg.a}function pe(Ca,ra){var yb=fd.call(this)||this;yb.uBj=Ca;yb.actualValue=ra;return yb}function Ad(){this.rb=null}function Pd(Ca,ra,yb,Hd,ye){yb=void 0===yb?null:yb;Hd=void 0===Hd?null:Hd;ye=void 0===ye?100:ye;this.zJc=!1;this.Ri=null;this.pgb=0;this.Ya=new Cg.a;
this.ufb=null;this.BX=!1;this.Sfe=0;this.je=Ca;this.W1d=0;this.gWd=this;this.EFc=new id(yb);this.NI=ra;Hd&&(this.ufb=new Jf(null,Hd,ye))}function Ce(Ca){var ra=Ee.call(this)||this;ra.entries=Ca;return ra}function Jf(Ca,ra,yb){this.TZd=Ca;this.jVb=void 0===ra?null:ra;this.qfb={};this.Ahg=void 0===yb?100:yb}function oc(Ca,ra){this.r$=null;this.nQc=Ca;this.behavior=ra;this.url=this.Xt.name}function ed(Ca,ra,yb){this.ai=Ca;this.gWd=this;this.Pkg=(void 0===ra?null:ra)||function(){return window.location.href};
this.EFc=new id(void 0===yb?null:yb)}function wc(Ca,ra){function yb(Cf,Bf){null!=Bf&&(Hd[Cf]=Bf)}var Hd={},ye=null;switch(Ca){case 0:ye="ResourceTiming";yb("Url",ra.a);yb("InitiatorType",ra.b);yb("RedirectStart",null==ra.c?null:ra.c.toString());yb("RedirectEnd",null==ra.d?null:ra.d.toString());yb("FetchStart",null==ra.e?null:ra.e.toString());yb("DomainLookupStart",null==ra.f?null:ra.f.toString());yb("DomainLookupEnd",null==ra.g?null:ra.g.toString());yb("ConnectStart",null==ra.h?null:ra.h.toString());
yb("ConnectEnd",null==ra.i?null:ra.i.toString());yb("SecureConnectionStart",null==ra.j?null:ra.j.toString());yb("RequestStart",null==ra.k?null:ra.k.toString());yb("ResponseStart",null==ra.l?null:ra.l.toString());yb("ResponseEnd",null==ra.m?null:ra.m.toString());yb("CustomText",ra.n);yb("DecodedBodySize",null==ra.o?null:ra.o.toString());yb("EncodedBodySize",null==ra.p?null:ra.p.toString());yb("TransferSize",null==ra.q?null:ra.q.toString());break;case 1:ye="PerformanceTiming",yb("Url",ra.a),yb("NavigationStart",
null==ra.b?null:ra.b.toString()),yb("UnloadEventStart",null==ra.c?null:ra.c.toString()),yb("UnloadEventEnd",null==ra.d?null:ra.d.toString()),yb("RedirectStart",null==ra.e?null:ra.e.toString()),yb("RedirectEnd",null==ra.f?null:ra.f.toString()),yb("FetchStart",null==ra.g?null:ra.g.toString()),yb("DomainLookupStart",null==ra.h?null:ra.h.toString()),yb("DomainLookupEnd",null==ra.i?null:ra.i.toString()),yb("ConnectStart",null==ra.j?null:ra.j.toString()),yb("ConnectEnd",null==ra.k?null:ra.k.toString()),
yb("SecureConnectionStart",null==ra.l?null:ra.l.toString()),yb("RequestStart",null==ra.m?null:ra.m.toString()),yb("ResponseStart",null==ra.n?null:ra.n.toString()),yb("ResponseEnd",null==ra.o?null:ra.o.toString()),yb("DomLoading",null==ra.p?null:ra.p.toString()),yb("DomInteractive",null==ra.q?null:ra.q.toString()),yb("DomContentLoadedEventStart",null==ra.r?null:ra.r.toString()),yb("DomContentLoadedEventEnd",null==ra.s?null:ra.s.toString()),yb("DomComplete",null==ra.t?null:ra.t.toString()),yb("LoadEventStart",
null==ra.u?null:ra.u.toString()),yb("LoadEventEnd",null==ra.v?null:ra.v.toString()),yb("CustomText",ra.w)}Hd.Table=ye;return Sys.Serialization.JavaScriptSerializer.serialize(Hd)}function gb(Ca,ra){this.r$=null;this.nQc=Ca;this.url=ra}function id(Ca){this.ICc=Ca}function ib(){}function nc(){}function Nb(){this.Version=this.Name=null}function mb(){this.WinOrientation=this.DocElemClientHeight=this.DocElemClientWidth=this.DocElemOffsetHeight=this.DocElemOffsetWidth=this.ScreenAvailWidth=this.ScreenAvailHeight=
this.ScreenLogicalYdpi=this.ScreenLogicalXdpi=this.ScreenDeviceYdpi=this.ScreenDeviceXdpi=this.CalculatedDevicePixelRatio=this.WinDevicePixelRatio=this.WinOuterWidth=this.WinOuterHeight=this.WinInnerHeight=this.WinInnerWidth=this.ScreenHeight=this.ScreenWidth=0;this.SupportsTouch=!1;this.Error=this.NavLanguage=this.NavAppVersion=this.NavAppName=this.NavPlatform=this.NavUserAgent=this.NavPlugins=null}function Lc(Ca){Ca=Ca.replace(/-.*/g,function(){return""});Ca=xf.get(Ca);return null!==Ca&&void 0!==
Ca?Ca:"other"}function zd(Ca){return Ca[0].toUpperCase()+Ca.slice(1).replace(/_[a-z]/g,function(ra){return ra[1].toUpperCase()})}function jd(Ca){Yd(Ca,rd)}function ge(Ca){Yd(Ca,je)}function Yd(Ca,ra){var yb,Hd,ye=null===(yb=null===Ca||void 0===Ca?void 0:Ca.actionProps)||void 0===yb?void 0:yb.name;Ca=null===(Hd=null===Ca||void 0===Ca?void 0:Ca.actionProps)||void 0===Hd?void 0:Hd.appState;if(ye&&Ca){var Cf=Lc(ye);"other"!==Cf&&"steady"===Ca&&(af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InteractivityMetricKpiUseRequestIdleCallback",
!1)?window.requestIdleCallback(function(){ra(Cf)},mf):ra(Cf))}else ae.ULS.sendTraceTag(526463695,0,15,"InteractivityTrackerService.reportResponsivenessMetricKpi action or appState are undefined")}function rd(Ca){Rc.Health.instance.recordKpiFailure("NonResponsiveActions"+zd(Ca),"SlowAction",!1,!0,null)}function je(Ca){Rc.Health.instance.recordKpiUsage("NonResponsiveActions"+zd(Ca),0,"xloint",null)}b.r(D);var re=b(0),ae=b(13);Object(re.a)(mb,"BrowserInfo",null,[]);Object(re.a)(Nb,"PluginInfo",null,
[]);var Uf=b(5),Lf=b(23);nc.jni=function(){if(Uf.AFrameworkApplication.ga.ra("LogBrowserInfoIsEnabled")){var Ca=nc.Jzh();try{var ra=JSON.stringify(Ca);ae.ULS.sendTraceTag(6903563,102,50,ra)}catch(yb){ae.ULS.sendTraceTag(6903564,102,15,yb.message)}}else ae.ULS.sendTraceTag(6903562,102,50,"Detailed browser info logging is turned off")};nc.pOh=function(){var Ca=window.navigator.plugins;if(!Ca||!Ca.length)return null;for(var ra=[],yb=0;yb<Ca.length;yb++){var Hd=Ca[yb].name,ye=Ca[yb].version;Array.add(ra,
Object.assign(new Nb,{Name:Hd,Version:ye}))}return ra};nc.Jzh=function(){var Ca=new mb,ra=new Sys.StringBuilder;nc.Fs(function(yb){Ca.DocElemClientHeight=yb},function(){return document.documentElement.clientHeight},ra);nc.Fs(function(yb){Ca.DocElemClientWidth=yb},function(){return document.documentElement.clientWidth},ra);nc.Fs(function(yb){Ca.DocElemOffsetHeight=yb},function(){return document.documentElement.offsetHeight},ra);nc.Fs(function(yb){Ca.DocElemOffsetWidth=yb},function(){return document.documentElement.offsetWidth},
ra);nc.Fs(function(yb){Ca.ScreenAvailHeight=yb},function(){return window.screen.availHeight},ra);nc.Fs(function(yb){Ca.ScreenAvailWidth=yb},function(){return window.screen.availWidth},ra);nc.Fs(function(yb){Ca.ScreenWidth=yb},function(){return window.screen.width},ra);nc.Fs(function(yb){Ca.ScreenHeight=yb},function(){return window.screen.height},ra);nc.Fs(function(yb){Ca.ScreenLogicalXdpi=yb},function(){return window.screen.logicalXDPI},ra);nc.Fs(function(yb){Ca.ScreenLogicalYdpi=yb},function(){return window.screen.logicalYDPI},
ra);nc.Fs(function(yb){Ca.ScreenDeviceXdpi=yb},function(){return window.screen.deviceXDPI},ra);nc.Fs(function(yb){Ca.ScreenDeviceYdpi=yb},function(){return window.screen.deviceYDPI},ra);nc.Fs(function(yb){Ca.WinInnerHeight=yb},function(){return window.self.innerHeight},ra);nc.Fs(function(yb){Ca.WinInnerWidth=yb},function(){return window.self.innerWidth},ra);nc.Fs(function(yb){Ca.WinOuterHeight=yb},function(){return window.self.outerHeight},ra);nc.Fs(function(yb){Ca.WinOuterWidth=yb},function(){return window.self.outerWidth},
ra);nc.Fs(function(yb){Ca.WinOrientation=yb},function(){return window.self.orientation},ra);nc.Fs(function(yb){Ca.WinDevicePixelRatio=yb},function(){return window.self.devicePixelRatio},ra);nc.Fs(function(yb){Ca.SupportsTouch=yb},function(){return Lf.a.mxc},ra);nc.Fs(function(yb){Ca.NavAppName=yb},function(){return window.navigator.appName},ra);nc.Fs(function(yb){Ca.NavAppVersion=yb},function(){return window.navigator.appVersion},ra);nc.Fs(function(yb){Ca.NavLanguage=yb},function(){return window.navigator.browserLanguage||
window.navigator.language},ra);nc.Fs(function(yb){Ca.NavUserAgent=yb},function(){return window.navigator.userAgent},ra);nc.Fs(function(yb){Ca.NavPlatform=yb},function(){return window.navigator.platform},ra);nc.Fs(function(yb){Ca.NavPlugins=yb},nc.pOh,ra);nc.Fs(function(yb){Ca.CalculatedDevicePixelRatio=yb},function(){return nc.devicePixelRatio},ra);Ca.Error=ra.toString();return Ca};nc.Fs=function(Ca,ra,yb){try{var Hd=ra();Ca(Hd)}catch(ye){yb.isEmpty()||yb.append(" | "),yb.append(ye.message||"null")}};
tl.Object.defineProperties(nc,{devicePixelRatio:{configurable:!0,enumerable:!0,get:function(){var Ca=window.devicePixelRatio;return isNaN(Ca)?window.screen.deviceXDPI/window.screen.logicalXDPI:Ca}}});Object(re.a)(nc,"BrowserInfoLogger",null,[]);var Of=b(274);ib.prototype.di=function(){};ib.prototype.init=function(){nc.jni()};ib.prototype.dispose=function(){};ib.main=function(){Of.a.instance.mj(new ib)};tl.Object.defineProperties(ib.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.BrowserInfoLogger"}}});
Object(re.a)(ib,"BrowserInfoLoggerPackage",null,[4,5]);var Yf=b(77);id.prototype.L$e=function(Ca){if(!this.ICc)return!0;Ca=Yf.a.Ycd(Ca);if(!Ca)return!1;Ca=Ca.toLowerCase();for(var ra=0;ra<this.ICc.length;ra++)if(Ca.endsWith(this.ICc[ra]))return!0;return!1};Object(re.a)(id,"DomainAllowListManager",null,[]);gb.prototype.iTd=function(){var Ca={},ra=this.Xt;Ca.a=this.hWd;Ca.b=this.round(ra.navigationStart);Ca.c=this.round(ra.unloadEventStart);Ca.d=this.round(ra.unloadEventEnd);Ca.e=this.round(ra.redirectStart);
Ca.f=this.round(ra.redirectEnd);Ca.g=this.round(ra.fetchStart);Ca.h=this.round(ra.domainLookupStart);Ca.i=this.round(ra.domainLookupEnd);Ca.j=this.round(ra.connectStart);Ca.k=this.round(ra.connectEnd);Ca.l=void 0!==ra.secureConnectionStart&&null!==ra.secureConnectionStart?this.round(ra.secureConnectionStart):0;Ca.m=this.round(ra.requestStart);Ca.n=this.round(ra.responseStart);Ca.o=this.round(ra.responseEnd);Ca.q=this.round(ra.domInteractive);Ca.r=this.round(ra.domContentLoadedEventStart);Ca.s=this.round(ra.domContentLoadedEventEnd);
Ca.t=this.round(ra.domComplete);Ca.u=this.round(ra.loadEventStart);Ca.v=this.round(ra.loadEventEnd);Ca.w=this.r$;return Ca};gb.prototype.round=function(Ca){return Math.round(1E3*Ca)/1E3};tl.Object.defineProperties(gb.prototype,{hWd:{configurable:!0,enumerable:!0,get:function(){return Yf.a.Eca(this.url)}},Xt:{configurable:!0,enumerable:!0,get:function(){return this.nQc}}});Object(re.a)(gb,"PerformanceTimingEntry",null,[]);var vg=b(54),Af=b(213),rf=b(315);ed.prototype.run=function(){if(ed.mP(window.performance))try{var Ca=
this.Pkg();if(ed.rtg.exec(Ca)&&this.EFc.L$e(Ca)){var ra=new gb(window.performance.timing,Ca);rf.a.instance.YZi(ra.Xt.fetchStart);rf.a.instance.ZZi(ra.Xt.navigationStart);rf.a.instance.FAb(vg.a.Fyh,"connectStart","requestStart");rf.a.instance.FAb(vg.a.Oyh,"requestStart","responseStart");rf.a.instance.FAb(vg.a.Ryh,"responseStart","responseEnd");this.gWd.Ne(1,ra.iTd());this.ai.qn(vg.a.T1a,ra.Xt.fetchStart);this.ai.qn(vg.a.Kyh,ra.Xt.domainLookupStart);this.ai.qn(vg.a.Jyh,ra.Xt.domainLookupEnd);this.ai.qn(vg.a.Hyh,
ra.Xt.connectStart);this.ai.qn(vg.a.Syh,ra.Xt.secureConnectionStart);this.ai.qn(vg.a.Gyh,ra.Xt.connectEnd);this.ai.qn(vg.a.Pyh,ra.Xt.requestStart);this.ai.qn(vg.a.jad,ra.Xt.responseStart);this.ai.qn(vg.a.Lyh,ra.Xt.responseEnd-ra.Xt.responseStart);this.ai.qn(vg.a.Qyh,ra.Xt.responseStart-ra.Xt.requestStart);var yb=0,Hd=0,ye=0,Cf=this.HFj(Ca);yb=Cf.transferSize;Hd=Cf.s6c;ye=Cf.a4c;Cf.returnValue&&(this.ai.qn(vg.a.Tyh,yb),this.ai.qn(vg.a.Iyh,ye),this.ai.qn(vg.a.Myh,Hd));this.ai.qn(vg.a.Nyh,ra.Xt.navigationStart)}}catch(Bf){ae.ULS.sendTraceTag(4551814,
306,10,"Exception caught in PerformanceTimingLogger.Run: {0}",Bf)}};ed.prototype.HFj=function(Ca){var ra,yb;var Hd=yb=ra=-1;if(void 0===window.performance.getEntriesByName||null===window.performance.getEntriesByName)return{returnValue:!1,transferSize:ra,s6c:yb,a4c:Hd};Ca=window.performance.getEntriesByName(Ca,"navigation");if(void 0===Ca||null===Ca||1!==Ca.length)return{returnValue:!1,transferSize:ra,s6c:yb,a4c:Hd};Ca=Ca[0];var ye=Ca.transferSize;void 0!==ra&&null!==ra&&(ra=ye);ye=Ca.decodedBodySize;
void 0!==ye&&null!==ye&&(Hd=ye);Ca=Ca.encodedBodySize;void 0!==Ca&&null!==Ca&&(yb=Ca);return{returnValue:!0,transferSize:ra,s6c:yb,a4c:Hd}};ed.prototype.Ne=function(Ca,ra){ae.ULS.sendTraceTag(4551815,306,50,wc(Ca,ra))};ed.mP=function(Ca){return!(void 0===Ca||null===Ca)&&!(void 0===Ca.timing||null===Ca.timing)};tl.Object.defineProperties(ed,{instance:{configurable:!0,enumerable:!0,get:function(){return ed.Na||(ed.Na=new ed(Af.a.instance,null,Uf.AFrameworkApplication.ga.ra("PerfTimingLoggerFilterDomainsIsEnabled")?
Uf.AFrameworkApplication.ga.Tv("ResourceLoggerDomainAllowList"):null))}}});ed.Na=null;ed.rtg=RegExp("^https?://.*","i");Object(re.a)(ed,"PerformanceTimingLogger",null,[752]);var Cg=b(94),sc=b(84);oc.prototype.iTd=function(){var Ca={},ra=this.Xt;Ca.a=this.hWd;Ca.b=ra.initiatorType;Ca.c=this.round(ra.redirectStart);Ca.d=this.round(ra.redirectEnd);Ca.e=this.round(ra.fetchStart);Ca.f=this.round(ra.domainLookupStart);Ca.g=this.round(ra.domainLookupEnd);Ca.h=this.round(ra.connectStart);Ca.i=this.round(ra.connectEnd);
Ca.j=void 0!==ra.secureConnectionStart&&null!==ra.secureConnectionStart?this.round(ra.secureConnectionStart):0;Ca.k=this.round(ra.requestStart);Ca.l=this.round(ra.responseStart);Ca.m=this.round(ra.responseEnd);Ca.o=this.round(oc.b3a(ra,"decodedBodySize"));Ca.p=this.round(oc.b3a(ra,"encodedBodySize"));Ca.q=this.round(oc.b3a(ra,"transferSize"));Ca.n=this.r$;return Ca};oc.prototype.round=function(Ca){return Math.round(1E3*Ca)/1E3};oc.b3a=function(Ca,ra){return Ca[ra]};tl.Object.defineProperties(oc.prototype,
{hWd:{configurable:!0,enumerable:!0,get:function(){return 2===this.behavior?this.url:Yf.a.Eca(this.url)}},Xt:{configurable:!0,enumerable:!0,get:function(){return this.nQc}}});Object(re.a)(oc,"ResourceTimingEntry",null,[784]);var Rc=b(93),Qc=b(38),ee=b(110),ue=b(178);Jf.prototype.bFj=function(Ca){var ra=Ca.name.toLowerCase(),yb=Yf.a.Nua(ra);this.B$i(yb,ra)&&(yb in this.qfb?ae.ULS.sendTraceTag(51652509,306,50,"AppStaticResourceManager: file downloaded multiple times {0}",yb):(ra={},ra.fetchstart=Ca.fetchStart,
ra.responseend=Ca.responseEnd,ra.iscached=this.wgi(Ca),ra.encodedsize=oc.b3a(Ca,"encodedBodySize"),ra.decodedsize=oc.b3a(Ca,"decodedBodySize"),this.qfb[yb]=ra))};Jf.prototype.B$i=function(Ca,ra){if(this.TZd)return Array.contains(this.TZd,Ca);if(this.jVb)for(Ca=Yf.a.oM(ra),ra=0;ra<this.jVb.length;ra++)if(this.jVb[ra]&&Ca.endsWith(this.jVb[ra]))return!0;return!1};Jf.prototype.wgi=function(Ca){try{var ra=oc.b3a(Ca,"transferSize");if(ra)return!ra;ae.ULS.sendTraceTag(51652510,306,50,"AppStaticResourceManager: No transfersize found, basing cache status from duration");
return Ca.responseEnd-Ca.fetchStart<this.Ahg}catch(yb){ae.ULS.sendTraceTag(51652511,306,50,"AppStaticResourceManager: Error attempting to get cache value of resource [error: {0}]",yb.message)}return!1};Jf.prototype.r_i=function(){if(ee.a.yj(this.qfb))ae.ULS.sendTraceTag(575931855,306,15,"Aggregated Static Resource Metric Dictionary is null or empty");else{var Ca=Uf.AFrameworkApplication.yJ?Uf.AFrameworkApplication.yJ.split(";"):[],ra=Object.assign(new ue.a,{extendedProperties:this.rIh()});ra.extendedProperties.set("Flights",
Qc.c(Ca));this.qni(ra,this.qfb,Rc.Health.instance)}};Jf.prototype.rIh=function(){try{return new Map}catch(Ca){return null}};Jf.prototype.qni=function(Ca,ra,yb){if(ra){var Hd=0,ye=0,Cf=0,Bf=0,ch=0,Tg=0,fe=0,Ih=0,Th=0,h=0,Bb=0,ic;for(ic in ra){var Nc=ra[ic];try{var pd=Object(sc.a)(Object,Nc);if(pd){var xe=pd.iscached?Boolean.parse(pd.iscached.toString()):!1,Ue=pd.fetchstart?this.parseFloat(pd.fetchstart.toString()):0,qe=(pd.responseend?this.parseFloat(pd.responseend.toString()):0)-Ue,ja=pd.encodedsize?
this.parseFloat(pd.encodedsize.toString()):0,Ka=pd.decodedsize?this.parseFloat(pd.decodedsize.toString()):0;Hd+=qe;Bf+=ja;fe+=Ka;h++;xe?(Cf+=qe,Tg+=ja,Th+=Ka,Bb++):(ye+=qe,ch+=ja,Ih+=Ka)}}catch(qc){ae.ULS.sendTraceTag(575931856,306,10,"AppStaticResourceManager: Error attempting to log KPI [error: {0}]",qc.message)}}Ca.extendedProperties.set("StaticResources",Qc.c(ra));Ca.extendedProperties.set("TotalResourceDownloadLatency",Hd.toString());Ca.extendedProperties.set("TotalResourceDownloadLatencyForCacheMiss",
ye.toString());Ca.extendedProperties.set("TotalResourceDownloadLatencyForCacheHit",Cf.toString());Ca.extendedProperties.set("TotalSizeOfEncodedDataDownloaded",Bf.toString());Ca.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheMiss",ch.toString());Ca.extendedProperties.set("TotalSizeOfEncodedDataDownloadedForCacheHit",Tg.toString());Ca.extendedProperties.set("TotalSizeOfDecodedDataDownloaded",fe.toString());Ca.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheMiss",Ih.toString());
Ca.extendedProperties.set("TotalSizeOfDecodedDataDownloadedForCacheHit",Th.toString());Ca.extendedProperties.set("TotalNumberOfResourcesDownloaded",h.toString());Ca.extendedProperties.set("TotalNumberOfCachedResourcesDownloaded",Bb.toString());yb.recordKpiUsageForAlertableKpi("StaticResourceDownloadLatencyAggregated","wacbootmonitoring",null);yb.recordKpiSuccess("StaticResourceDownloadLatencyAggregated",Ca)}};Jf.prototype.parseFloat=function(Ca){if(!Ca)return 0;Ca=parseFloat(Ca);return isNaN(Ca)?
0:Ca};Object(re.a)(Jf,"AppStaticResourceManager",null,[]);var Ee=Sys.EventArgs;vm(Ce,Ee);Object(re.a)(Ce,"EntriesAvailableEventArgs",Sys.EventArgs,[]);var De=b(109);Pd.prototype.dAg=function(Ca){this.Ya.addHandler(Pd.V6c,Ca)};Pd.prototype.t4i=function(Ca){this.Ya.removeHandler(Pd.V6c,Ca)};Pd.prototype.di=function(Ca,ra){var yb=this.$Sd!==Ca;this.Sfe=Ca;this.isActive&&this.je&&yb&&(this.Bp(),this.fh());this.W1d=ra};Pd.prototype.activate=function(){!this.isActive&&this.Mre&&(this.fh(),this.BX=!0)};
Pd.prototype.deactivate=function(Ca){this.isActive&&(this.Bp(),Ca&&this.flush(),this.BX=!1)};Pd.prototype.flush=function(){if(this.isActive&&this.Mre)try{var Ca=window.performance.getEntriesByType("resource");0<Ca.length-this.pgb&&ae.ULS.sendTraceTag(19506833,306,100,"ResourceTimingLogger.Flush: Start executing command. Number of new entries to flash: {0}",Ca.length-this.pgb);var ra=!(void 0===window.performance.clearResourceTimings||null===window.performance.clearResourceTimings);ra&&(window.performance.clearResourceTimings(),
this.pgb=0);for(var yb=[],Hd=this.pgb;Hd<Ca.length;Hd++)this.EFc.L$e(Ca[Hd].name)&&(this.ufb&&this.ufb.bFj(Ca[Hd]),yb.push(new oc(Ca[Hd],this.v8g)));ra||(this.pgb=Ca.length);this.Ya.raiseEvent(Pd.V6c,new Ce(yb));for(Ca=0;Ca<yb.length;Ca++)yb[Ca].behavior&&2!==yb[Ca].behavior||this.gWd.Ne(0,yb[Ca].iTd());0<yb.length&&ae.ULS.sendTraceTag(19506834,306,100,"ResourceTimingLogger.Flush: Successfully ended. Number of new logged entries: {0}",yb.length)}catch(ye){ae.ULS.sendTraceTag(4310803,306,10,"Exception caught in ResourceTimingLogger.Flush: {0}",
ye)}};Pd.prototype.Ne=function(Ca,ra){ae.ULS.sendTraceTag(4310804,306,50,wc(Ca,ra))};Pd.prototype.XZi=function(){this.ufb.r_i()};Pd.prototype.fh=function(){var Ca=this;this.je&&0<this.$Sd&&(this.Ri=new De.a(3,2,1E3*this.$Sd,function(){Ca.flush()},5),this.je.fh(this.Ri),this.zJc=!0)};Pd.prototype.Bp=function(){this.zJc&&(this.je.Bp(this.Ri),this.Ri=null,this.zJc=!1)};tl.Object.defineProperties(Pd.prototype,{Mre:{configurable:!0,enumerable:!0,get:function(){try{return!(void 0===this.NI||null===this.NI)&&
!(void 0===this.NI.getEntriesByType||null===this.NI.getEntriesByType)}catch(Ca){return ae.ULS.sendTraceTag(50873240,306,10,"Exception caught in ResourceTimingLogger.BrowserSupportsPerformanceTimeline: {0}",Ca),!1}}},v8g:{configurable:!0,enumerable:!0,get:function(){return this.W1d}},isActive:{configurable:!0,enumerable:!0,get:function(){return this.BX}},$Sd:{configurable:!0,enumerable:!0,get:function(){return this.Sfe}}});Pd.V6c="EntriesAvailable";Object(re.a)(Pd,"ResourceTimingLogger",null,[727,
752]);var ne=b(157);Ad.prototype.init=function(){this.rb.resolve("Common.NetworkTiming.IResourceTimingLogger");ed.instance.run()};Ad.prototype.dispose=function(){};Ad.prototype.di=function(Ca){this.rb=Ca;var ra=null;if(Uf.AFrameworkApplication.ga.ra("ResourceLoggerFilterDomainsIsEnabled"))try{ra=Uf.AFrameworkApplication.ga.Tv("ResourceLoggerDomainAllowList")}catch(ye){ae.ULS.sendTraceTag(51652512,306,50,"ResourceTimingPackage - failed to get logger domain allowlist")}var yb=[];yb.push(Yf.a.oM(ne.a.LW).toLowerCase());
yb.push(Yf.a.oM(ne.a.Ibb).toLowerCase());var Hd=Uf.AFrameworkApplication.ga.zd("AppStaticResourceMonitorCacheThresholdInMs",100);Ca.register(727,"Common.NetworkTiming.IResourceTimingLogger").zc().Ic(function(){return new Pd(Uf.AFrameworkApplication.oj,window.performance,ra,yb,Hd)})};Ad.main=function(){Of.a.instance.mj(new Ad)};tl.Object.defineProperties(Ad.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.ResourceTiming"}}});Object(re.a)(Ad,"ResourceTimingPackage",null,[4,
5]);var gc=b(80),fd=Sys.EventArgs;vm(pe,fd);Object(re.a)(pe,"CpuMeterMonitorThresholdExceededEventArgs",Sys.EventArgs,[]);var vd=b(167);de.prototype.init=function(Ca,ra,yb){this.Aea=Ca;this.VEc=ra;this.t1d=yb;this.Aea.mle(Object(gc.a)(this,this.lBi,"onCpuMeterFrameAvailable"));this.uBg(Object(gc.a)(this,this.i_g,"cpuPercentThresholdExceeded"))};de.prototype.lBi=function(Ca,ra){ra.bof&&(Array.enqueue(this.iUa,ra.bof.CP),this.iUa.length>this.t1d&&(Array.dequeue(this.iUa),this.pSg()))};de.prototype.pSg=
function(){for(var Ca=this.iUa.length,ra=0,yb=0;yb<Ca;yb++){var Hd=Array.dequeue(this.iUa);ra+=Hd;Array.enqueue(this.iUa,Hd)}Ca=ra/Ca;Ca>this.VEc&&this.Ya.raiseEvent("CPTTE",new pe(this.VEc,Ca))};de.prototype.i_g=function(Ca,ra){vd.a(16782158,306,50,"CpuMeter KPI Average Threshold Exceeded: [{0}]",this.j1g(ra.uBj,ra.actualValue))};de.prototype.uBg=function(Ca){this.Ya.addHandler("CPTTE",Ca)};de.prototype.j1g=function(Ca,ra){var yb={};yb.ThresholdValue=Ca;yb.ActualValue=ra;return yb};Object(re.a)(de,
"CpuMeterMonitor",null,[757]);var se=b(139);Object(re.a)(Vd,"ProfileInformation",null,[]);var Jc=b(12),Bc=b(40),Ae=b(259);Qd.prototype.Jme=function(Ca,ra,yb){var Hd=Qd.generateKey(ra,yb);Hd in this.WCa?ra=this.WCa[Hd]:(ra=new Vd,ra.S=yb?1:0,this.WCa[Hd]=ra,this.AQc++);ra.C++;ra.M=Ca>ra.M?Ca:ra.M;ra.T+=Ca};Qd.prototype.WXa=function(Ca,ra){this.Jme(Ca,ra,!1);this.eIc&&this.Jme(Ca,ra,!0)};Qd.prototype.getData=function(){if(0<this.ySb&&this.AQc>this.ySb)return this.qGh();var Ca=0<this.oSb,ra={},yb=this.WCa,
Hd;for(Hd in yb){var ye=Hd,Cf=yb[Hd];this.DQf(Cf);Ca&&Cf.T>=this.oSb&&(ra[ye]=Cf)}return Ca?ee.a.yj(ra)?null:ra:this.WCa};Qd.prototype.qGh=function(){var Ca=0<this.oSb,ra=[],yb=this.WCa;for(Cf in yb){var Hd={key:Cf,value:yb[Cf]},ye=Hd.value;(!Ca||ye.T>=this.oSb)&&Array.add(ra,Hd)}if(ra.length>this.ySb)ra.sort(function(Bf,ch){return ch.value.T-Bf.value.T}),ra=ra.slice(0,this.ySb);else if(!ra.length)return null;Ca={};ra=yl(ra);for(yb=ra.next();!yb.done;yb=ra.next()){yb=yb.value;var Cf=yb.value;this.DQf(Cf);
Ca[yb.key]=Cf}return Ca};Qd.prototype.DQf=function(Ca){Ca.M=Ae.a.U_(Ca.M,0);Ca.T=Ae.a.U_(Ca.T,0)};Qd.prototype.reset=function(){this.WCa={};this.AQc=0};Qd.generateKey=function(Ca,ra){return ra?Ca+" [it]":Ca};Object(re.a)(Qd,"FunctionCallAggregator",null,[754]);bc.jJg="BatchedOperation";bc.replication="Replication";bc.jGj="25";bc.J7i="9_"+bc.jJg+"_"+bc.replication;Object(re.a)(bc,"CpuMeterConstants",null,[]);Object(re.a)(Je,"CpuMeterFrame",null,[]);var cb=Sys.EventArgs;vm(od,cb);Object(re.a)(od,"CpuMeterFrameAvailableEventArgs",
Sys.EventArgs,[]);Object(re.a)(Xd,"MiniTaskItemInfo",null,[]);Object(re.a)(Jd,"TaskItemInfo",null,[]);var mc=b(685),Oc=b(101);ad.UUh=function(){if(!ad.EOb&&(ad.EOb=new Oc.a,Uf.AFrameworkApplication.ga&&Uf.AFrameworkApplication.ga.Dy("AggregatorIdDisabledList")))for(var Ca=Uf.AFrameworkApplication.ga.Tv("AggregatorIdDisabledList"),ra=0;ra<Ca.length;ra++)ad.EOb.ia(Ca[ra],!0);return ad.EOb};ad.EOb=null;Object(re.a)(ad,"DisabledAggregatorListStore",null,[]);var Sc=b(262);Ac.prototype.track=function(Ca,
ra){ra=void 0===ra?null:ra;this.tX||(this.ohh(),this.Ycj(),this.SPb.WXa(Ca,ra))};Ac.prototype.Ycj=function(){!this.p7d&&0<this.O5d&&(this.p7d=!0,this.rSf())};Ac.prototype.rSf=function(){var Ca=this,ra=new De.a(5,1,this.O5d,function(){Ca.gfj()},19,this._id.toString());this.taskManager.fh(ra)};Ac.prototype.gfj=function(){!this.hkb||this.hkb.toj()?this.vTf():this.pce&&this.SPb.reset();this.rSf()};Ac.prototype.vTf=function(){var Ca=this.SPb.getData();if(Ca){var ra=parseInt(String(Ca.length));if(isNaN(ra)||
0<ra)this.rtc(Ca),this.pce&&this.SPb.reset()}};Ac.prototype.rtc=function(Ca){var ra={};ae.ULS.sendTraceTag(7079840,335,50,"Aggregator: {0}",(ra.ID=this._id.toString(),ra.Data=Ca,ra))};Ac.prototype.ohh=function(){var Ca=this;this.cfe||(this.aMc(function(){Ca.vTf()}),this.cfe=!0)};Ac.AU=function(Ca,ra,yb,Hd,ye){return new Ac(new mc.a(function(){return Uf.AFrameworkApplication.oj}),Uf.AFrameworkApplication.CKb,Ca,ra,yb,Hd,ye)};Ac.i2a=function(Ca,ra,yb){return Ac.AU(Ca,ra,yb,!0,null)};tl.Object.defineProperties(Ac.prototype,
{taskManager:{configurable:!0,enumerable:!0,get:function(){return this.je||(this.je=this.Gsg.value)}}});Object(re.a)(Ac,"Aggregator",null,[755]);cc.prototype.WXa=function(Ca,ra){if(!this.hkb||this.hkb.toj())ra in this.Sm||(this.Sm[ra]=[]),this.Sm[ra].push(Ca)};cc.prototype.getData=function(){return ee.a.count(this.Sm)?this.Sm:null};cc.prototype.reset=function(){this.Sm={}};Object(re.a)(cc,"NamedValuesAggregator",null,[754]);var $c=b(308);pb.prototype.mle=function(Ca){this.V$d.addHandler("OnCpuMeterFrameAvailable",
Ca)};pb.prototype.Y9a=function(Ca,ra,yb,Hd){yb=(Hd=void 0===Hd?null:Hd)?Hd.priority:7;var ye=this.mL();this.start(ra,yb);try{Ca()}finally{this.stop(ra,Hd),Ca=this.mL()-ye,this.c9d.track(Ca,ra)}};pb.prototype.g6=function(Ca,ra){var yb=this.mL();try{Ca()}finally{Ca=this.mL()-yb,this.QGc.WXa(Ca,ra),0<this.sEa&&this.RGc.WXa(Ca,ra),this.c9d.track(Ca,ra)}};pb.prototype.vzd=function(Ca){var ra=new Jd;ra.TN=Ca.xic;ra.TP=Ca.priority;this.OHf(1,ra)};pb.prototype.o7a=function(Ca){this.xRb|=Ca};pb.prototype.start=
function(Ca,ra){if(!this.sEa){this.RGc.reset();var yb=this.Mef(Ca);yb&&this.ytd(1);this.$F=new Jd;this.$F.TN=Ca;this.$F.TP=ra;this.$F.ST=(new Date).toISOString();this.$F.STS=Ae.a.U_(this.mL(),2);yb?this.$F.UI=1:this.Fci(Ca)?this.$F.UI=2:this.$F.UI=0}this.sEa++};pb.prototype.ytd=function(Ca){this.GUa|=Ca};pb.prototype.zZc=function(Ca,ra){this.GUa=void 0===Ca||Ca?0:this.GUa&~(void 0===ra?0:ra)};pb.prototype.stop=function(Ca,ra){ra=void 0===ra?null:ra;this.sEa--;if(0>=this.sEa&&this.$F){var yb=this.mL()-
this.$F.STS;this.qUb+=yb;this.WKc.WXa(yb,Ca);this.Mef(Ca)&&this.zZc(!1,1);this.$F.TRT=Ae.a.U_(yb,2);ra&&(this.$F.TQT=Ae.a.U_(ra.wWi,2),this.$F.TDT=Ae.a.U_(ra.$ff,2));this.Vjg&&(this.OHf(0,this.$F),this.q8i());this.sEa=0}0<=Ca.indexOf(bc.jGj)&&this.o7a(2);0<=Ca.indexOf(bc.J7i)&&this.o7a(4);1===(this.GUa&1)&&this.o7a(1);2===(this.GUa&2)&&this.o7a(8)};pb.prototype.q8i=function(){var Ca=this.$F.TRT;if(750<Ca){var ra=this.RGc.getData();if(ra){var yb={},Hd;for(Hd in ra){var ye=ra[Hd],Cf=Hd;Cf.startsWith("SiOp_")||
(yb[Cf]=Ae.a.U_(100*ye.T/Ca,2))}ra=yb}Ca=Object.assign(new Xd,{T:Ca,S:ra});this.Jng.track(Ca,this.$F.TN)}};pb.prototype.Kvj=function(){var Ca=this.mL()-this.Pee,ra=Ae.a.U_(this.qUb/Ca*100,2);Ca=new Je;Ca.CP=ra;Ca.II=this.xRb;ra=this.WKc.getData();ee.a.count(ra)&&(Ca.LRT=ra);ra=this.QGc.getData();ee.a.count(ra)&&(Ca.FP=ra);this.V$d.raiseEvent("OnCpuMeterFrameAvailable",new od(Ca));this.R1f()};pb.prototype.R1f=function(){this.WKc.reset();this.QGc.reset();this.qUb=this.sEa=0;this.Pee=this.mL();this.xRb=
0;this.$F=null};pb.prototype.run=function(){this.bde?this.Kvj():(this.R1f(),this.bde=!0);this.bqa?this.bqa(Object(gc.a)(this,this.run,"run"),1E3):window.setTimeout(Object(gc.a)(this,this.run,"run"),1E3)};pb.prototype.jSc=function(Ca,ra,yb){var Hd=Array(2);Hd[0]=ra;Hd[1]=yb;this.wVb[Ca]||(this.wVb[Ca]=[]);this.wVb[Ca].push(Hd)};pb.prototype.OHf=function(Ca,ra){Ca=this.wVb[Ca];if(!$c.a.yj(Ca))for(var yb=0;yb<Ca.length;yb++){var Hd=Ca[yb],ye=Hd[0];Hd=Hd[1];ye&&!ye(ra)||Hd(ra)}};pb.prototype.Rpd=function(){if(!this.$hb){var Ca=
window.setTimeout;this.bqa=function(ra,yb){return Ca(ra,yb)};this.$hb=!0}};pb.prototype.Mef=function(Ca){return Ca.startsWith("key")||Ca.startsWith("input")};pb.prototype.Fci=function(Ca){return Ca.startsWith("click")||Ca.startsWith("mouse")||Ca.startsWith("pointer")};Object(re.a)(pb,"CpuMeter",null,[93]);za.prototype.initialize=function(Ca,ra,yb,Hd){this.ogb||(this.ogb=new pb(this.mL,Ca,ra,yb,void 0===Hd?!1:Hd),this.Sl.setResult(this.ogb));return this.ogb};Object(re.a)(za,"CpuMeterProvider",null,
[756]);uc.prototype.yvh=function(){for(var Ca=0,ra=0;ra<this.Nw.length;ra++)this.Nw[ra]<this.Nw[Ca]&&(Ca=ra);return Ca};uc.prototype.WXa=function(Ca,ra){Ca=Ae.a.U_(Ca,2);if(this.Nw.length<this._count)Array.add(this.Nw,Ca),Array.add(this.aQb,ra);else{var yb=this.yvh();Ca>this.Nw[yb]&&(this.Nw[yb]=Ca,this.aQb[yb]=ra)}};uc.prototype.getData=function(){if(!this.Nw.length)return null;var Ca={};return Ca.Vals=this.Nw,Ca.Desc=this.aQb,Ca};uc.prototype.reset=function(){this.Nw=[];this.aQb=[]};Object(re.a)(uc,
"MaxDataAggregator",null,[754]);var le=b(47),we=b(86);Ic.prototype.di=function(Ca){Ca.register(za,"Common.App.CpuMeter.CpuMeterProvider").as("Common.ICpuMeterProvider").zc().Ic(function(){return new za(le.a.se)});Ca.register(de,"Common.App.CpuMeter.CpuMeterMonitor").as("Common.App.CpuMeter.ICpuMeterMonitor").zc().Ic(function(){return new de})};Ic.prototype.init=function(){var Ca=Uf.AFrameworkApplication.ga;if(Ca.ra("CpuMeterIsEnabled")){var ra=we.a.instance.resolve("Common.App.CpuMeter.CpuMeterProvider");
rf.a.instance.dFg.continueWith(function(){Ic.b4h(Ca,ra)})}};Ic.prototype.dispose=function(){};Ic.b4h=function(Ca,ra){var yb=Ac.i2a(10,5,new Qd(Ca.zd("TaskManagerLoggingThreshold",0),Ca.zd("CpuMeterMaximumEntriesToLog",0)));ra=ra.initialize(new uc(5),new Qd,yb,Ca.ra("CPUMeterExposeTaskDetailsIsEnabled"));ra.run();Ca.ra("CpuMeterMonitorIsEnabled")&&we.a.instance.resolve("Common.App.CpuMeter.ICpuMeterMonitor").init(ra,Ca.Tia("CpuMeterAverageCpuPercentThreshold",80),Ca.zd("CpuMeterRollingAverageFramesCount",
15));vd.a(16827671,306,50,"Initializing CpuMeter")};Ic.main=function(){Of.a.instance.mj(new Ic)};tl.Object.defineProperties(Ic.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.CpuMeter"}}});Object(re.a)(Ic,"CpuMeterPackage",null,[4,5]);var jc=b(1085);Jb.prototype.di=function(){};Jb.prototype.init=function(){jc.a.instance.init()};Jb.prototype.dispose=function(){};Jb.main=function(){Of.a.instance.mj(new Jb)};tl.Object.defineProperties(Jb.prototype,{name:{configurable:!0,
enumerable:!0,get:function(){return"Common.App.EventsCachePackage"}}});Object(re.a)(Jb,"EventsCachePackage",null,[4,5]);var Zc=b(10),ud=b(216),Fd=b(1254),me=b(170),$e=b(371),Df=b(197),gg=b(150),og=b(57),dg=b(92),af=b(1),rg=b(19),cg=b(166),Ie=b(889),Ng=Fd.a;vm(Zb,Ng);Zb.prototype.dispose=function(){this.$=null;Ng.prototype.dispose.call(this)};Zb.prototype.k5h=function(){this.Qn(me.a.ste);this.Qn(me.a.$hd);this.Qn(me.a.Ccc);this.Qn(me.a.eid);this.cSc(me.a.Crd);this.Qn(me.a.did)};Zb.prototype.y4h=function(){this.gga(me.a.nlb);
this.gga(me.a.dta);this.gga("App_CloseTab");this.gga(me.a.gTa);this.gga(me.a.hTa);this.gga(me.a.Whd);this.gga(me.a.zcc)};Zb.prototype.lFi=function(){var Ca={};Ca.hostMessageReceived=(new Date).getTime();ae.ULS.sendTraceTag(537162883,0,50,"EwaHostMessenger.OnHostUnload");Uf.AFrameworkApplication.wod=!0;Ca.appUnloadStart=(new Date).getTime();Ca.sendBeaconFlight=Uf.AFrameworkApplication.ga.ra("SendBeaconOnShuttingDownRequestsEnabled");Ca.sendBeaconSupported=og.a.eda();og.a.Kne();Ca.appUnloadEnd=(new Date).getTime();
Ca.appMessageSent=(new Date).getTime();this.Qj(me.a.mFg,Ca)};Zb.prototype.kFi=function(Ca){ae.ULS.sendTraceTag(537162882,0,50,"EwaHostMessenger.OnHostSwitchMode");Ca.Values&&$e.a.wvd in Ca.Values&&rg.a.equals(Ca.Values[$e.a.wvd],Df.a.edit,!0)&&!this.$.isEditMode&&(ae.ULS.sendTraceTag(537162881,0,50,"EwaHostMessenger.OnHostSwitchMode: Switching to {0}",Ca.Values[$e.a.wvd]),Ca=new dg.a(-8805455,0,1,0,null),this.$.Ka.Zb(Ca))};Object(re.a)(Zb,"EwaHostMessenger",Fd.a,[883,242,3]);var Zf=ud.a;vm(db,Zf);
db.prototype.create=function(){var Ca=this,ra=this.$.da,yb=we.a.instance;if(!this.vye){this.vye=!0;var Hd=af.EwaSettings.isChangeGateEnabled("OfficeVSO:5135167_PostMessageOriginFixup")?this.$.ya.DocumentHostInfo.PostMessageOrigin||Ie.a.s9:Uf.AFrameworkApplication.FBd||Ie.a.s9;yb.register(Zb,"Microsoft.Office.Excel.WebUI.Client.PostMessage.EwaHostMessenger").as("Postmessage.IHostPostmessenger").zc().Ic(function(){return new Zb(Ca.$,window.parent,Hd,Uf.AFrameworkApplication.ga.ra("HostSendReadyToAcceptPostMessage"))})}this.Fb(ra.Aa(21)||
ra.Ha(21,yb.resolve("Postmessage.IHostPostmessenger")))};Object(re.a)(db,"HostMessengerFactory",ud.a,[]);var ng=b(116),Ff=b(143),be=b(805),Rf=b(574),Re=b(74),Ze=b(125),hg=b(457),Bg=b(42),qh=b(459),Zg=b(350),qf=b(353),mh=b(496),Pa=b(4),qb=b(48);Ba.Rsh=function(Ca,ra,yb){var Hd={},ye=qb.b();switch(Ca.command){case -1537138325:Hd.Action=ra.LabelText;break;case -1104934572:Hd.PrevTab=ye.pi(parseInt(ra.OldContextCommand));Hd.NextTab=ye.pi(parseInt(ra.NewContextCommand));break;case 802602464:Hd.Origin=
ra[Pa.a.O$];break;case -1027730316:case -1059615499:Hd.MenuType=ra.launcherId;break;case -236759591:case 1650812936:case 1970784898:case 1378078823:case -400966242:case 467002767:af.EwaSettings.isChangeGateEnabled("OfficeVSO:5197543_AddColorPickerMenuSectionInfoToLogs")&&"SqmControlId"in ra&&(Hd.SqmControlId=ra.SqmControlId)}Hd.InputMethod=Zg.a[Ca.method];Hd.Location=qf.a[Ca.df];Hd.Mode=mh.a[Ca.mode];Hd.IsSystemInitiated="IsSystemInitiated"in ra?ra.IsSystemInitiated:!1;Hd.NoReporting="NoReporting"in
ra?ra.NoReporting:!1;Ca=yl(Object.keys(yb));for(ra=Ca.next();!ra.done;ra=Ca.next())ra=ra.value,Hd[ra]=yb[ra];return Hd};Object(re.a)(Ba,"InteractivityRecord",null,[]);vm(Wa,Ba);Object(re.a)(Wa,"FirstUserInteractivityRecord",Ba,[]);var tc=b(686);Za.o4h=function(){Za.D1a||(Za.D1a=new tc.a(Rf.a.Ik()),Za.D1a.add("InputMethod"),Za.D1a.add("Location"),Za.D1a.add("Mode"))};Za.D1a=null;Object(re.a)(Za,"ExcelUserAction",null,[]);var dd=b(208),Kd=b(46),yd=b(429),ze=b(250),te=Re.a;vm(dc,te);dc.prototype.dispose=
function(){this.$=this.z4=null;te.prototype.dispose.call(this)};dc.prototype.$Nf=function(Ca,ra,yb){if(this.Rxb){var Hd=qb.b().pi(Ca.command);Hd||ae.ULS.sendTraceTag(537155555,3,50,"InteractivityLogger.ReportCommand: command name is null or empty. commandName: {0}, command: {1}, commandInfo: {2}",Hd,Ca.command,Ca);ra=Ba.Rsh(Ca,ra,yb);yb=!!ra&&(!("IsSystemInitiated"in ra)||!ra.IsSystemInitiated);this.$&&this.$.fa.Mh&&yb&&jc.a.instance.eJf("OtelUserAction",new yd.a(Hd,Ca.tabName,Date.now()));this.oOf(Hd,
ra,null,!0,!0)}};dc.prototype.ae=function(Ca,ra,yb,Hd){this.Rxb&&this.oOf(Ca,ra,void 0===yb?null:yb,!1,void 0===Hd?!1:Hd)};dc.prototype.PQd=function(Ca){if(this.Rxb)if(this.z4){++this.K8e;this.z4[Ca]||(this.z4[Ca]=[]);var ra=this.K8e.toString();this.z4[Ca].push(ra);ae.ULS.sendTraceTag(537155553,0,50,"StartInteractivityCorrellation - '{0}', correlation={1}",Ca,ra)}else ae.ULS.shipAssertTag(537155554,0,!1,"StartInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[{0}] == null",
Ca)};dc.prototype.bRd=function(Ca){if(this.Rxb)if(this.z4&&this.z4[Ca]){var ra=this.z4[Ca],yb=ra.pop().toString();ra.length||delete this.z4[Ca];ae.ULS.sendTraceTag(537155551,0,50,"StopInteractivityCorrellation - '{0}', correlation={1}",Ca,yb)}else ae.ULS.shipAssertTag(537155552,0,!1,"StopInteractivityCorrellation - InteractivityCorrelations  is null or InteractivityCorrelations[{0}] == null",Ca)};dc.prototype.IP=function(Ca,ra,yb){var Hd=this;yb=void 0===yb?!1:yb;return this.Rxb?qh.a(function(ye){Hd.ae(Ca,
ye(),void 0,yb)},dc.wBj,this.ma,Bg.a.k7h,!1,!ra):null};dc.prototype.NHd=function(){for(var Ca="",ra=0;ra<dc.r7a;ra++)Ca+=this.nqd[(this.A3b+dc.r7a-ra-1)%dc.r7a]+",";ae.ULS.sendTraceTag(557188890,0,15,"Last operations {0}",Ca)};dc.prototype.bKj=function(Ca){Ca&&(this.nqd[this.A3b]=Ca,this.A3b=(this.A3b+1)%dc.r7a)};dc.prototype.Qif=function(Ca,ra,yb){Uf.AFrameworkApplication.l6b();var Hd=Ca.operation,ye=Ca.properties;void 0!==yb?hg.a(this.$,432,433,0,function(Cf){Cf.s_i(Hd,ye,yb)}):this.qGj(Ca);this.rGj(Ca);
this.aOi(ra,ye,Hd)};dc.prototype.qGj=function(Ca){this.Juj(Ca)||(this.eRe=!0,Ca=new Wa(Ca,Kd.PageLoadTrackingInfo.instance.oaa(new Date),Kd.PageLoadTrackingInfo.sE()),Ca=Sys.Serialization.JavaScriptSerializer.serialize(Ca),ae.ULS.sendTraceTag(458261331,0,50,"{0}",Ca))};dc.prototype.Juj=function(Ca){var ra=Ca.properties;Ca=Ca.operation;return this.eRe||void 0===Ca||null===Ca||Ca===Ze.a.IRc||Ca===Ze.a.PKd||Ca===Ze.a.eCd||og.a.Jnd(Ca)||!!ra&&"IsSystemInitiated"in ra&&ra.IsSystemInitiated};dc.prototype.rGj=
function(Ca){af.EwaSettings.isChangeGateEnabled("OfficeVSO:5151293_ReportLastOperationsOnFeedback")&&this.bKj(Ca.operation);Ca=Sys.Serialization.JavaScriptSerializer.serialize(Ca);ae.ULS.sendTraceTag(21542793,0,50,"{0}",Ca)};dc.prototype.aOi=function(Ca,ra,yb){ng.a.tka()&&(ra?"NoReporting"in ra&&ra.NoReporting||"IsSystemInitiated"in ra&&ra.IsSystemInitiated||!Ca&&!this.pef||((Ca=ng.a.Fk(ra,dc.wWb,Za.D1a))?(ra=dc.Ysh(ra))?Ff.a.sendUserActionEvent(ng.a.d3b(yb,null,ra.triggerMethod,ra.commandSurface,
Ca)):ae.ULS.sendTraceTag(537155550,0,50,"user action was null"):ae.ULS.sendTraceTag(537155549,0,15,"OtelUtils.DictionaryToDataFields returned null")):ae.ULS.sendTraceTag(537155548,0,50,"Not logging action telemetry because adction data was null, actionName: {0}",yb))};dc.prototype.oOf=function(Ca,ra,yb,Hd,ye){var Cf=this,Bf=dd.a(this.$);if(this.pef){var ch=null;rg.a.equals(Ca,Ze.a.etc,!0)&&ra&&"InputMethod"in ra&&(ch=Ze.a.aSe(Ca,ra.InputMethod));Bf.CGb(ch||Ca,yb)}else rg.a.equals(Ca,Ze.a.etc,!0)&&
ra&&"InputMethod"in ra&&(Ca=Ze.a.aSe(Ca,ra.InputMethod)),Bf.CGb(Ca,yb);ra&&(ra.IsCommand=Hd);var Tg=void 0;this.fdi&&(Tg="ActionRelativeTime"in ra?ra.ActionRelativeTime:Kd.PageLoadTrackingInfo.sE());this.T8h?Object(ze.b)(function(){var fe=new Ba(Ca,ra,Cf.z4);Cf.Qif(fe,ye,Tg)},this.$.ma,50):(yb=new Ba(Ca,ra,this.z4),this.Qif(yb,ye,Tg))};dc.Ysh=function(Ca){if(!Ca)return null;var ra=new Za;"InputMethod"in Ca&&(ra.triggerMethod=Ca.InputMethod);"Location"in Ca&&(ra.commandSurface=Ca.Location);return ra};
dc.A3h=function(Ca){Ca?(Ca.add("Origin",2),Ca.add("InputMethod",2),Ca.add("ButtonType",2),Ca.add("selectedRange",2),Ca.add("SelectedRanges",2),Ca.add("editRange",2),Ca.add("Location",2),Ca.add("Mode",2),Ca.add("CurrentSelectionMode",2),Ca.add("Action",2),Ca.add("type",2),Ca.add("floatingObjectType",2),Ca.add("PrevTab",2),Ca.add("NextTab",2),Ca.add("DialogName",2),Ca.add("dx",3),Ca.add("dy",3),Ca.add("NumberOfSelectedRanges",3),Ca.add("IsCommand",1),Ca.add("IsInFormulaBarEdit",1),Ca.add("isLink",1),
Ca.add("isSheetRef",1),Ca.add("isEmptyText",1),Ca.add("isFormula",1),Ca.add("IsResizingHiddenHeader",1)):ae.ULS.sendTraceTag(537155547,0,15,"InitTypeSpecifier was passed in a null dictionary")};dc.wBj=1E3;dc.r7a=40;dc.wWb=null;Object(re.a)(dc,"InteractivityLogger",Re.a,[12]);var lf=b(56),bf=b(35);Object(re.a)(Xb,"CurrentAppInfo",null,[]);var xf=new Map;[{name:"keyboard_selection",actions:new Set("move_down move_left move_right move_up extend_down extend_left extend_right extend_up cell_text_move_down cell_text_move_left cell_text_move_right cell_text_move_up cell_text_extend_down cell_text_extend_left cell_text_extend_right cell_text_extend_up formulaBar_extend_left formulaBar_extend_right formulaBar_extend_down formulaBar_extend_up formulaBar_move_right formulaBar_move_down formulaBar_move_left formulaBar_move_up commit_down commit_right formulaBar_commit_down formulaBar_commit_right cell_text_commit_right cell_text_commit_down".split(" "))},
{name:"cell_edit",actions:new Set("commit_down_end_edit commit_right_end_edit formulaBar_commit_down_end_edit formulaBar_commit_right_end_edit cell_text_commit_down_end_edit cell_text_commit_right_end_edit cell_text_edit_end cell_text_edit_type cell_text_edit_typing cell_text_start_edit cell_text_start_edit_replace formulaBar_start_edit_replace formulaBar_start_edit formulaBar_end_edit_ok_cancel_btn cell_text_end_edit_ok_cancel_btn formulaBar_end_edit_sheet_changed cell_text_end_edit_sheet_changed move_down_end_edit move_left_end_edit move_right_end_edit move_up_end_edit extend_down_end_edit extend_left_end_edit extend_right_end_edit extend_up_end_edit cell_text_move_down_end_edit cell_text_move_left_end_edit cell_text_move_right_end_edit cell_text_move_up_end_edit cell_text_extend_down_end_edit cell_text_extend_left_end_edit cell_text_extend_right_end_edit cell_text_extend_up_end_edit active_cell_selection_change_end_edit cell_text_active_cell_selection_change_end_edit formulaBar_active_cell_selection_change_end_edit formulaBar_edit_type formulaBar_move_left_end_edit formulaBar_move_down_end_edit formulaBar_extend_left_end_edit formulaBar_move_right_end_edit formulaBar_move_up_end_edit formulaBar_extend_up_end_edit formulaBar_extend_right_end_edit formulaBar_extend_down_end_edit".split(" "))},
{name:"grid_menu",actions:new Set(["mouse_grid_context_menu_open","open_menu_auto_filter","open_menu_pivot_table"])},{name:"active_cell_selection",actions:new Set(["active_cell_selection_change","cell_text_active_cell_selection_change","formulaBar_active_cell_selection_change"])}].forEach(function(Ca){Ca.actions.forEach(function(ra){xf.set(ra,Ca.name)})});$a.prototype.getAppState=function(){var Ca=Kd.PageLoadTrackingInfo.instance.oaa(new Date);return-1===Ca?"boot":3E4>Ca?"postboot":"steady"};$a.prototype.isChangeGateEnabled=
function(Ca){return af.EwaSettings.isChangeGateEnabled(Ca)};$a.prototype.getCurrentAppInfo=function(){return Object.assign(new Xb,{appState:this.getAppState(),coAuthCount:this.$.fa.Em.length})};$a.prototype.sendBeaconTraceTag=function(Ca,ra,yb,Hd){this.$.sendBeaconTraceTag(Ca,ra,yb,Hd)};$a.prototype.getActionBucket=function(Ca){return Lc(Ca)};Object(re.a)($a,"InteractivityTrackerCallbacks",null,[777]);Object(re.a)(kb,"InteractivityTrackerOptions",null,[]);var Og=b(335),mf={timeout:2E3};Ua.prototype.initialize=
function(Ca){ae.ULS.sendTraceTag(555360983,0,15,"InteractivityTrackerService: starting InteractivityTracker");if(this.tQ=interactivity.InteractivityTrackerFactoryGlobal.create()){var ra=new kb;af.EwaSettings.isChangeGateEnabled("OfficeVSO:5738340_TrackDblClick")&&Ua.B3f.push("dblclick");ra.events=Ua.B3f;ra.durationThresholdInMs=Ua.durationThresholdInMs;ra.callbacks=new $a(Ca);ra.patchTaskScheduling=af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PatchClientTaskScheduling",!1);Ca=this.tQ.start(ra);
Ca.started?ae.ULS.sendTraceTag(537155543,0,50,"InteractivityTrackerService: InteractivityTracker started"):ae.ULS.sendTraceTag(537155542,0,15,"InteractivityTrackerService InteractivityTracker start failed: "+Ca.failureReason);af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InteractivityMetricKpi",!1)&&(this.tQ.addEventListener(1,jd),this.tQ.addEventListener(0,ge))}else ae.ULS.sendTraceTag(537155541,0,15,"InteractivityTrackerService: InteractivityTracker not created")};Ua.prototype.Jna=
function(Ca,ra){this.tQ?this.tQ.track(Ca,ra):ae.ULS.sendTraceTag(537155540,0,50,"InteractivityTrackerService.TrackInputEventPerf: interactivityTracker not initialized. Discarding userAction: {0}",ra)};Ua.prototype.fCe=function(){return this.tQ?this.tQ.createActionsRetriever():(ae.ULS.sendTraceTag(537155539,0,15,"InteractivityTrackerService.CreateSlowActionsRetriever: interactivityTracker not initialized."),null)};Ua.prototype.dispose=function(){this.tQ&&(this.tQ.stop(),this.tQ=null,af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InteractivityMetricKpi",
!1)&&(this.tQ.removeEventListener(1,jd),this.tQ.removeEventListener(0,ge)))};Ua.durationThresholdInMs=100;Ua.B3f=["click","mousedown","contextmenu","keypress","keydown"];Ua.hbf=!1;Object(re.a)(Ua,"InteractivityTrackerService",null,[490]);var bg=ud.a;vm(Ha,bg);Ha.prototype.create=function(){var Ca=this;if(af.EwaSettings.isChangeGateEnabled("OfficeVSO:5960700_ShouldCreateProfilerAfterInteractivityTracker")){var ra=lf.GetServiceTaskFactory.Xa(this.$.da,283,284,this.tb);bf.TaskExtensions.Ba(ra,function(){bf.TaskExtensions.Ba(Og.c(ra.result.wo.loadScript("interactivity")),
function(){Ca.Fb(Ca.$.da.Aa(443)||new Ua(Ca.$))},Ca.$.ma,3)},this.$.ma,3)}else this.Fb(this.$.da.Aa(443)||this.$.da.Ha(443,new Ua(this.$)))};Ha.ja=function(Ca){Ca.da.Ha(444,new Ha(Ca))};Object(re.a)(Ha,"InteractivityTrackerServiceFactory",ud.a,[]);var Wf=b(88),zf=b(384),tg=b(9),Hf=b(44),xc=b(211),bd=b(52);Ga.prototype.getCustomProperties=function(Ca){var ra=new Map;if(Ca.hasOwnProperty("startTimeInMs")&&Ca.hasOwnProperty("totalExecutionTimeInMs")){var yb=Ca.startTimeInMs;Ca=this.uvj.retrieveSlowActionsBetweenTimeRange(yb,
yb+Ca.totalExecutionTimeInMs);ra.set("actions",bd.a.Hc(Ca))}return ra};Object(re.a)(Ga,"CallTreeCustomPropertiesRetriever",null,[807]);bb.prototype.addCustomProperty=function(Ca,ra){this.customProperties.set(Ca,ra)};bb.prototype.getCustomProperties=function(){return this.customProperties};Object(re.a)(bb,"CustomPropertiesRetriever",null,[782]);ka.prototype.isFeatureEnabled=function(Ca,ra){return af.EwaSettings.getBooleanFeatureGate(Ca,ra)};Object(re.a)(ka,"ExcelFeatureChecker",null,[781]);Mb.prototype.isProfilingEnabled=
function(){return!0};Object(re.a)(Mb,"ExcelProfilingFeatureChecker",null,[780]);E.prototype.onProfilerEvent=function(Ca){switch(Ca.eventId){case 1:this.XKi(af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.KeepOldCollectedActions",!1));break;case 0:this.ZKi();break;default:ae.ULS.sendTraceTag(537155529,0,15,"JSCPUIJSCPUProfilerObserver.OnProfilerEvent: got unhandled profilerEventId {0}",Ca.eventId)}};Object(re.a)(E,"JSCPUProfilerObserver",null,[779]);Object(re.a)(wb,"JSCPUProfilerInitOptions",
null,[]);Object(re.a)(rc,"JSCPUProfilingPackageInitOptions",null,[]);tb.prototype.dispose=function(){ae.ULS.sendTraceTag(537155527,0,50,"JsSelfProfilerManager.Dispose");Wf.a.Fa(this.Y1f);this.dDd=this.$=null;this.eDd.clear();this.Z9a.clear()};tb.prototype.Pwj=function(){var Ca=this,ra=Math.random()*this.kze;ae.ULS.sendTraceTag(537155526,0,50,"JsSelfProfilerManager.Ctor: starting ContinuousSessionProfiler in: {0}",ra);this.Y1f=Hf.a.instance.create(function(){Ca.Tdd("ExcelOnlineContinuousSessionProfiler",
2).start()},ra,Bg.a.Mnj,!0)};tb.prototype.axj=function(){ae.ULS.sendTraceTag(537155525,0,50,"JsSelfProfilerManager.StartFullSessionProfiler: Starting a new profiler");this.Tdd("ExcelOnlineFullSessionProfiler",3).start()};tb.prototype.hxj=function(Ca){var ra=void 0===ra?1E4:ra;ae.ULS.sendTraceTag(537155524,0,50,"JsSelfProfilerManager.StartManualProfiler: Starting a new profiler");this.Icf(Ca)?this.Tdd(Ca,0,ra).start():ae.ULS.shipAssertTag(537155523,0,!1,"JsSelfProfilerManager.StartManualProfiler: Profiler name is invalid.")};
tb.prototype.dyj=function(Ca){this.Icf(Ca)?(Ca=this.CZe(Ca))&&Ca.stop():ae.ULS.shipAssertTag(537155522,0,!1,"JsSelfProfilerManager.StopManualProfiler: Profiler name is invalid.")};tb.prototype.cDd=function(Ca){return this.Z9a.has(Ca)};tb.prototype.yxj=function(){af.EwaSettings.d_e()||(af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FullSessionJSProfiler",!1)?this.axj():this.Pwj())};tb.prototype.createProfiler=function(Ca,ra,yb,Hd,ye,Cf){ae.ULS.sendTraceTag(537155521,0,50,"JsSelfProfilerManager.CreateProfiler: Creating a new profiler");
var Bf=new wb;Bf.samplingIntervalInMs=ra;Bf.maximumNumberOfSamplesToTake=yb;Bf.idleIntervalInMs=Hd;Bf.profilingIntervalInMs=ye;return this.j4g(Ca,Cf,Bf)};tb.prototype.h5h=function(){var Ca=new Mb,ra=new rc;ra.ulsInstance=new zf.a;ra.deObfuscationEndpoint="ProfilerReporting.ashx";ra.shouldCompressSerializedCallTrees=!1;ra.shouldKeepSamplesOutsideOfProfilingInterval=!1;ra.shouldSendAllCallTreesFromProfileInASingleRequest=!af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldSendEachCallTreeIndividuallyFromProfile",
!1);ra.shouldUseSendBeaconForSendingCallTrees=af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldUseSendBeaconForSendingCallTrees",!1);ra.callTreeFilteringThresholdInMs=af.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.JsProfilerCallTreeFilteringThresholdInMs",50);ra.deObfuscationRequestQueryParamsRetriever=this.Y0g();ra.deObfuscationRequestBodyPropertiesRetriever=this.X0g();ra.featureEnabledChecker=new ka;ra.useMainEventLoopForProfilerTraceProcessing=!1;ra.profilerTraceProcessingWebWorkerSourceURL=
this.$.ya.JSProfilerProcessingWebWorkerJsScriptUrl;ra.shouldProcessProfileCapturedWhileUserIsIdle=af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShouldProcessProfileCapturedWhileUserIsIdle",!0);this.dDd=this.lGf.retrievePackage(Ca,ra).retrieveProfilerFactory()};tb.prototype.Y0g=function(){var Ca=new bb;Ca.addCustomProperty(tg.a.TGf,Uf.AFrameworkApplication.userType);Ca.addCustomProperty(Uf.AFrameworkApplication.ieb,Uf.AFrameworkApplication.userSessionId);Ca.addCustomProperty(tg.a.rof,
this.$.ya.SkipAuthentication?tg.a.sof:null);Ca.addCustomProperty(tg.a.xDd,this.$.ya.MachineCluster);return Ca};tb.prototype.X0g=function(){var Ca=new bb;Ca.addCustomProperty("appName","Excel");Ca.addCustomProperty("buildVersion",Uf.AFrameworkApplication.buildVersion);Ca.addCustomProperty("shouldUseSourceMaps","true");af.EwaSettings.isChangeGateEnabled("OfficeVSO:5619353_profilerFilterSensitiveResources")&&Ca.addCustomProperty("shouldFilterSensitiveResources","true");af.EwaSettings.isChangeGateEnabled("OfficeVSO:5636639_UseNewDeobfForProfiler")&&
Ca.addCustomProperty("shouldUseJSSelfProfilerSpecificDeobfuscator","true");return Ca};tb.prototype.j4g=function(Ca,ra,yb){var Hd=new bb;Hd.addCustomProperty("ProfilerName",Ca);this.kGf.set(Ca,Hd);ra=this.dDd.createProfiler(ra,yb,Hd);this.Z9a.set(Ca,ra);af.EwaSettings.isChangeGateEnabled("OfficeVSO:5786153_JsProfilerAddSlowActionsRetriever")&&(Ca=this.A2g(Ca),ra.subscribeProfilerObserver(Ca,this.mVi));return ra};tb.prototype.CZe=function(Ca){return this.cDd(Ca)?this.Z9a.get(Ca):(ae.ULS.shipAssertTag(537155520,
0,!1,"JsSelfProfilerManager.GetProfiler: Profiler with such name ({0}) does not exist",Ca),null)};tb.prototype.Tdd=function(Ca,ra,yb){yb=void 0===yb?null:yb;if(this.cDd(Ca))return this.CZe(Ca);var Hd=this.pii;return this.createProfiler(Ca,Hd,null!=yb&&0<Hd?yb/Hd:2E6,2===ra?this.kze:null,ra?this.profilingIntervalInMs:null,ra)};tb.prototype.A2g=function(Ca){var ra=af.EwaSettings.isChangeGateEnabled("OfficeVSO:5960700_ShouldCreateProfilerAfterInteractivityTracker")?this.interactivityTrackerService:xc.b(this.$);
if(ra){var yb=ra.fCe();if(yb){ra=this.Z9a.get(Ca);var Hd=new Ga(yb);ra.subscribeCallTreeCustomPropertiesRetriever(Hd);ra=new E(function(ye){yb.startCollectingSlowActions(ye)},Object(gc.a)(yb,yb.stopCollectingSlowActions,"stopCollectingSlowActions"));this.eDd.set(Ca,ra);return ra}ae.ULS.sendTraceTag(537155491,0,15,"JsSelfProfilerManager.CreateInteractivityTrackerObserver: CreateSlowActionsRetriever returned null");return null}ae.ULS.sendTraceTag(537155490,0,15,"JsSelfProfilerManager.CreateInteractivityTrackerObserver: call to InteractivityTracker returned null");
return null};tb.prototype.i5h=function(){this.lGf=officeOnlineCpuProfiling.getJSCPUProfilingPackageRetriever();this.kGf=new Map;this.eDd=new Map;this.Z9a=new Map};tb.prototype.Icf=function(Ca){return!!Ca};Object(re.a)(tb,"JsSelfProfilerManager",null,[750,3]);var Bd=ud.a;vm(eb,Bd);eb.prototype.create=function(){var Ca=this;ae.ULS.sendTraceTag(537155489,0,50,"JsSelfProfilerManagerFactory.Create: loading officeOnlineCpuProfiling script");var ra=lf.GetServiceTaskFactory.Xa(this.$.da,283,284,this.tb);
bf.TaskExtensions.Ba(ra,function(){af.EwaSettings.isChangeGateEnabled("OfficeVSO:5960700_ShouldCreateProfilerAfterInteractivityTracker")?Ca.$.da.Za(443,function(yb){Ca.iBe(ra.result,yb)}):Ca.iBe(ra.result)},this.$.ma,3)};eb.prototype.iBe=function(Ca,ra){var yb=this;bf.TaskExtensions.Ba(Og.c(Ca.wo.loadScript("officeOnlineCpuProfiling")),function(){yb.Fb(yb.$.da.Aa(437)||new tb(yb.$,ra))},this.$.ma,3)};eb.ja=function(Ca){Ca.da.Ha(438,new eb(Ca))};Object(re.a)(eb,"JsSelfProfilerManagerFactory",ud.a,
[]);Object(re.a)(Ta,"ActionData",null,[]);Object(re.a)(fb,"BlockedEngagementInfo",null,[]);vm(ub,Ta);Object(re.a)(ub,"SuccessfulActionData",Ta,[]);Object(re.a)(Tc,"SuccessfulEngagementInfo",null,[]);var Ld=b(39);wd.prototype.dispose=function(){this.$.fa&&this.$.fa.hr(this.Rg);this.$.Fn(this.qd);Wf.a.Fa(this.FKb);this.$=this.FKb=null};wd.prototype.s_i=function(Ca,ra,yb){if(void 0!==Ca&&null!==Ca&&ra){var Hd=this.Jcb.successfulActions.length+1,ye="InputMethod"in ra?ra.InputMethod:"",Cf="IsCommand"in
ra&&ra.IsCommand;Hd>wd.Jlf||!this.Ogi(Ca,ra,ye,Cf)||(Ca=Object.assign(new ub,{order:Hd,name:Ca,componentName:"Location"in ra?ra.Location:"",timeFromNavigationStart:yb,inputMethod:ye,isCommand:Cf}),Array.add(this.Jcb.successfulActions,Ca),1===Hd?this.Umi():Hd===wd.Jlf&&this.cAb())}};wd.prototype.e_i=function(Ca){Ld.a(this.$).QXb(this.xDb);this.Mnb.hasBlockedActions=!0;this.xDb(null,Ca)};wd.prototype.hmi=function(){ae.ULS.sendTraceTag(254546634,0,50,"{0}",Qc.c(this.Mnb))};wd.prototype.Umi=function(){Kd.PageLoadTrackingInfo.instance.oaa(new Date)>
wd.Huh?ae.ULS.sendTraceTag(537154758,0,50,"First user interaction was filtered: {0}",Qc.c(this.Jcb.successfulActions[0])):ae.ULS.sendTraceTag(254563592,0,50,"{0}",Qc.c(this.Jcb.successfulActions[0]))};wd.prototype.cAb=function(){!this.u3f&&this.Jcb.successfulActions.length&&(this.u3f=!0,Wf.a.Fa(this.FKb),this.FKb=null,this.$.sendBeaconTraceTag(254559496,50,!1,Qc.c(this.Jcb)))};wd.prototype.vuh=function(){this.PIa.add(Ze.a.IRc);this.PIa.add(Ze.a.PKd);this.PIa.add(Ze.a.eCd);this.PIa.add(Ze.a.MEf);this.PIa.add(Ze.a.OEf);
this.PIa.add(Ze.a.QEf)};wd.prototype.Ogi=function(Ca,ra,yb,Hd){yb=!yb||"unknown"===yb;var ye="IsSystemInitiated"in ra&&ra.IsSystemInitiated;ra="NoReporting"in ra&&ra.NoReporting;var Cf=this.PIa.has(Ca);Ca=rg.a.equals(Ca,Ze.a.etc,!0)&&yb;return!ye&&!ra&&!Cf&&!Ca&&!(Hd&&yb)};wd.Jlf=10;wd.Huh=6E4;wd.Yyj=12E4;Object(re.a)(wd,"PageLoadEngagementInfo",null,[748]);var Od=ud.a;vm(Pc,Od);Pc.prototype.create=function(){this.Fb(this.$.da.Aa(432)||this.$.da.Ha(432,new wd(this.$)))};Pc.ja=function(Ca){Ca.da.Ha(433,
new Pc(Ca))};Object(re.a)(Pc,"PageLoadEngagementInfoFactory",ud.a,[]);var ef=b(49),ag=b(144),lg=b(518),$f=b(36),Aa=b(73),Ob=b(374),Ec=b(32),md=b(226),Md=Sys.EventArgs;vm(Xc,Md);Object(re.a)(Xc,"ErrorDataArgs",Sys.EventArgs,[]);var Me=b(691),Qe=b(107),sf=b(26);Hc.prototype.dlj=function(Ca){this.U3b||(this.qde=Ca,this.pde=Qe.toUtc(this.DHb))};Hc.prototype.L0h=function(Ca){if(Ca.Values&&(!this.$3a||!this.a4a))try{$e.a.d6e in Ca.Values&&(this.$3a=parseInt(Ca.Values[$e.a.d6e].toString()));$e.a.e6e in Ca.Values&&
(this.a4a=parseInt(Ca.Values[$e.a.e6e].toString()));var ra=rf.a.instance;0<this.$3a&&(this.Oif(this.$3a,"PageLoadFromHostClick"),ra.u_i(this.$3a));0<this.a4a&&(this.Oif(this.a4a,"PageLoadFromHostFrameCreation"),ra.v_i(this.a4a));var yb=Ca.Values[$e.a.O0h]||0,Hd=Ca.Values[$e.a.M0h]||Ca.Values[$e.a.N0h]||0;0<Hd&&ra.g_i(Hd);ra.h_i(yb)}catch(ye){}};Hc.prototype.V9i=function(){this.ySf=this.Dwe=sf.a.Ra.Kb;this.yae=0;this.Uhd=this.U3b=!1};Hc.prototype.lte=function(Ca){var ra=this.Dwe.getTime();return ra>=
Ca?0:Ca-ra+this.cCf};Hc.prototype.Oif=function(Ca,ra){if(Ca){var yb=qb.b();yb.rKb("UserAction",ra,ra,sf.a.wAb(Ca),Me.EcmaDateClock.instance.appStart);yb.Hrb(ra,Qe.toTimestamp(this.DHb))}};tl.Object.defineProperties(Hc.prototype,{cCf:{configurable:!0,enumerable:!0,get:function(){return this.yae}},DHb:{configurable:!0,enumerable:!0,get:function(){return this.qde}},xSf:{configurable:!0,enumerable:!0,get:function(){return this.pde}},nii:{configurable:!0,enumerable:!0,get:function(){return this.lte(this.ySf.getTime())}},
OOi:{configurable:!0,enumerable:!0,get:function(){return this.lte(this.xSf.getTime())}},aZf:{configurable:!0,enumerable:!0,get:function(){return!(this.U3b||void 0===window.bsqmXLSPageLoadStartTime)}},Dwe:{configurable:!0,enumerable:!0,get:function(){try{return this.qPb||(this.qPb=Qe.toUtc(window.bsqmXLSPageLoadStartTime)),this.qPb}catch(Ca){return null}},set:function(Ca){this.qPb=Ca}}});Object(re.a)(Hc,"PageLoadPerfInfo",null,[]);var Vf=b(69);Eb.prototype.kIb=function(Ca,ra){Ca&&(this.sPc=this.ycb|
ra<<16)};tl.Object.defineProperties(Eb.prototype,{ycb:{configurable:!0,enumerable:!0,get:function(){return this.sPc}},keyCode:{configurable:!0,enumerable:!0,get:function(){return this.ycb&65535}}});Object(re.a)(Eb,"ShortcutSqmData",null,[]);Kb.prototype.IQg=function(Ca,ra,yb){yb||(yb=this.OVg[ra.toString()]);return Kb.$Yf(Ca,yb)&&(Ca=new Eb(Ca,yb,Lf.a.isMac),!Ec.a.ug(this.xsd,Ca.ycb.toString()))?(this.xsd[Ca.ycb.toString()]=!0,Ca):null};Kb.prototype.qPf=function(){this.xsd={}};Kb.w0g=function(){var Ca=
{};return Ca["1"]=1,Ca["2"]=2,Ca["4"]=3,Ca["8"]=4,Ca["16"]=5,Ca["32"]=6,Ca};Kb.abi=function(Ca){return 112<=Ca&&123>=Ca||61440<=Ca&&61451>=Ca};Kb.qci=function(Ca){return 17!==Ca&&18!==Ca&&16!==Ca&&91!==Ca&&93!==Ca};Kb.$Yf=function(Ca,ra){var yb=Ca.ctrlKey||Ca.altKey||Vf.b(Ca);Ca=Ca.keyCode;yb=Kb.abi(Ca)||yb;yb=Kb.qci(Ca)&&yb;return!!ra&&yb};Object(re.a)(Kb,"UnhandledShortcutLogger",null,[]);xb.prototype.cXb=function(Ca){Array.add(this.s1b,Ca)};xb.prototype.tba=function(Ca,ra,yb){try{if(ra)ra.endTime=
yb,this.sqmManager.Rie(ra);else{ra=0;for(var Hd=this.s1b.length;ra<Hd;ra++){var ye=this.s1b[ra];Ca?(ye.endTime=ye.startTime,ye.Jxe=0):ye.endTime=yb;this.sqmManager.Rie(ye)}}}catch(Cf){}finally{Array.clear(this.s1b)}};Object(re.a)(xb,"UserInteractionPerfInfo",null,[]);var Da=b(33),rb=b(64),$b=b(99),vc=b(225),sb=Re.a;vm(Ja,sb);Ja.prototype.bTc=function(Ca){this.Ma.addHandler("EREK",Ca)};Ja.prototype.HGd=function(Ca){this.Ma.removeHandler("EREK",Ca)};Ja.prototype.dispose=function(){this.W6g&&Uf.AFrameworkApplication.Pm&&
Uf.AFrameworkApplication.Pm.disable();this.$&&this.$.Fn(this.qd);this.$=this.qAc=this.uOa=this.uT=null;sb.prototype.dispose.call(this)};Ja.prototype.e3e=function(Ca){this.uOa.L0h(Ca);this.dni()};Ja.prototype.yLd=function(Ca){this.setDw(9415,Ca)};Ja.prototype.cXb=function(Ca){this.qAc.cXb(Ca)};Ja.prototype.tba=function(Ca,ra,yb){this.qAc.tba(Ca,ra,yb)};Ja.prototype.asd=function(Ca){if(this.y2){var ra=this.fa.isNamedObjectViewMode&&1===this.workbookContext.NovMode;Ca=this.$.isEditMode||Ca&&this.fa.workbookContext.Options&
512?2:ra?9:this.fa.lc.inEmbedView?14:1;this.setDw(8721,Ca);this.Cwh(Ca);this.YEc=!1}};Ja.prototype.$if=function(){var Ca=this.uOa;this.y2&&Ca.aZf&&(this.setDw(9450,Ca.cCf),this.setDw(9085,Ca.nii))};Ja.prototype.ajf=function(Ca){if(!this.EGb){this.EGb=!0;var ra=this.uOa,yb=0;this.y2&&ra.aZf?(ra.dlj(Ca),this.qAc.lFg=ra.xSf,this.setDw(9086,ra.OOi),ra.U3b=!0,yb=this.uOa.DHb.getTime()):yb=Ca.getTime();bf.TaskExtensions.Ba(this.Stb.value,function(Hd){var ye={};Hd.result.Qj(me.a.eFg,(ye[$e.a.fFg]=yb,ye))},
this.ma,3)}};Ja.prototype.Rie=function(Ca){this.y2&&Ca&&1!==Ca.vda&&this.mga(8327,md.b(Ca),md.n(Ca),md.a(Ca),2,Ca.Jxe,md.o(Ca),md.d(Ca),md.e(Ca))};Ja.prototype.KHd=function(Ca,ra){Ca&&Ca.MessageIdHash&&this.JHd(Ca.MessageIdHash,Ca.MessageIdName,Ca.MessageId,Ca.ErrorCause?Ca.ErrorCause:ef.a.Uyc,!1,ra,Ca,null)};Ja.prototype.JHd=function(Ca,ra,yb,Hd,ye,Cf,Bf,ch){Ja.appEncounteredFirstError||(Ja.appEncounteredFirstError=!0,ag.a.get_instance().isCompleted(13)||(ag.a.get_instance().sw(13),ae.ULS.sendTraceTag(537151323,
0,50,"App encountered its first error so updating app init status")));Ca=this.Prb(Ca);var Tg=!!Bf,fe={};fe.ErrorName=ra;fe.ErrorHashCode=Ca.toString();fe.ErrorId=yb.toString();fe.ErrorCause=Hd.toString();fe.ErrorType=Cf?"BusinessBar":"ErrorDialog";fe.BusinessBarEntryName=ch||"null";fe.ServerCorrelationId=Tg?Bf.CorrelationId:"null";fe.WebMethodName=Tg?Bf.WebMethodName:"null";fe.SessionHostingEcs=this.fa.workbookContext?this.fa.workbookContext.EcsServerName:"null";fe.EcsServerId=Tg?Bf.EcsServerId:"null";
fe.WfeServerId=Tg?Bf.WfeServerId:"null";ra=bd.a.Hc(fe);this.Ma.raiseEvent("EREK",new Xc(fe));ae.ULS.sendTraceTag(1881314,0,15,ra);this.y2&&($b.a.gJf(Ca.toString()),this.mga(9134,Ca,Hd,ef.a.JUd),this.fa.Dt||ye||(this.setDw(10459,Ca),this.asd(!0),this.Qgd=!0,this.upload(),this.T7e()))};Ja.prototype.Prb=function(Ca){return 5439488|(Ca>>>16^Ca&65535)&65535};Ja.prototype.psd=function(Ca,ra,yb){Ca=this.i8f.IQg(Ca,ra,yb);this.y2&&Ca&&this.mga(11007,Ca.ycb)};Ja.prototype.upload=function(){!this.y2||!this.EGb&&
!this.Qgd||Lf.a.zf&&Uf.AFrameworkApplication.Gg?Lf.a.zf&&Uf.AFrameworkApplication.Gg&&ae.ULS.sendTraceTag(537151320,0,15,"SqmManager.Upload: skipped UploadWsaData"):(this.uT.DMb(),this.YEc=!0);Uf.AFrameworkApplication.Pm=this.uT=null;this.uOa.V9i();this.EGb=!1;Uf.AFrameworkApplication.Pm=this.uT=this.MIe();this.i8f.qPf()};Ja.prototype.dni=function(){var Ca=this.uOa;if(this.y2&&!Ca.Uhd){var ra=Ca.$3a,yb=Ca.a4a,Hd=Ca.DHb.getTime();Uf.AFrameworkApplication.SP=Ca.DHb;ra&&this.setDw(10324,ra>Hd?0:Hd-ra);
yb&&this.setDw(10325,yb>Hd?0:Hd-yb);Ca.Uhd=!0}};Ja.prototype.mga=function(Ca,ra){for(var yb=[],Hd=1;Hd<arguments.length;++Hd)yb[Hd-1]=arguments[Hd];this.y2&&this.uT.mga.apply(this.uT,[Ca].concat(Fl(yb)))};Ja.prototype.setDw=function(Ca,ra){this.y2&&this.uT.setDw(Ca,ra)};Ja.prototype.MIe=function(){Ob.a.jJe(this.$.ya);return Uf.AFrameworkApplication.Pm};Ja.prototype.Cwh=function(Ca){try{var ra=Object(sc.a)(Object,bd.a.li(Uf.AFrameworkApplication.ga.appSettings.SessionStartInfoJson))}catch(ye){ae.ULS.sendTraceTag(537151311,
0,15,"Couldn't parse SessionStartInfoJson. Message: {0}",ye.message);return}if(ra){var yb=Object(sc.a)(String,ra.ApplicationModeExtended),Hd=Object(sc.a)(String,ra.ApplicationMode);yb&&Hd&&(yb=yb.toUpperCase(),2!==Ca&&16!==Ca||"VIEW"!==yb&&"UNIFIED"!==yb?1!==Ca||"EDIT"!==yb&&"UNIFIED"!==yb||(yb="VIEW",Hd="View"):(yb="EDIT",Hd="Edit"),ra.ApplicationModeExtended=yb,ra.ApplicationMode=Hd,Uf.AFrameworkApplication.ga.appSettings.SessionStartInfoJson=bd.a.Hc(ra))}};Ja.prototype.T7e=function(){var Ca=this.$.ya;
this.uT.pV=!0;this.uT.vMb(Ca.BWsaStartTime);this.setDw(59,83);this.EGb=!1;if(this.y2){var ra=Ca.DocumentHostInfo;this.z5g();this.setDw(8491,this.$.pI);this.setDw(9236,Ca.RequestedUILcid);this.setDw(8473,Ca.WacHostId);this.setDw(9902,md.c(ra.ClusterId));af.EwaSettings.la(472)?this.uT.oVf(""):this.uT.oVf(Ca.FlightHolder?Ca.FlightHolder.FlightId:"");this.yLd(this.fa.lc.inEmbedView?1:0);this.Qgd=!1;this.setDw(9104,md.c(ra.FileSourceId));this.setDw(10309,this.R6h);this.fnj();Uf.AFrameworkApplication.Eb.rKf(lg.a.getInstance(!1))}};
Ja.prototype.fnj=function(){rf.a.instance.G3h(this.uT);if(this.cZf){var Ca=rf.a.instance;Ca.b_i();Ca.q_i();Ca.p_i();Ca.o_i();Ca.k_i();this.cZf=!1}};Ja.prototype.z5g=function(){this.createStream(8327,1,vc.a.R8g,vc.a.c0a);this.createStream(9134,1,3,vc.a.c0a);this.createStream(11007,1,1,vc.a.c0a)};Ja.prototype.createStream=function(Ca,ra,yb,Hd){this.uT.createStream(Ca,ra,yb,Hd)};tl.Object.defineProperties(Ja.prototype,{W6g:{configurable:!0,enumerable:!0,get:function(){return this.YEc}},R6h:{configurable:!0,
enumerable:!0,get:function(){return this.$.frame.KZ?tg.a.T6h:tg.a.S6h}},workbookContext:{configurable:!0,enumerable:!0,get:function(){return this.$.workbookContext}},uT:{configurable:!0,enumerable:!0,get:function(){Ja.Cfb||(Ja.Cfb=this.MIe());Ja.PWc||(Ja.PWc=!0,this.T7e());return Ja.Cfb},set:function(Ca){Ja.Cfb=Ca;Ja.Cfb||(Ja.PWc=!1)}},y2:{configurable:!0,enumerable:!0,get:function(){return Aa.a(this.$.ya,3)}}});Ja.Cfb=null;Ja.PWc=!1;Ja.appEncounteredFirstError=!1;Object(re.a)(Ja,"SqmManager",Re.a,
[147,724]);var ec=b(879);Object(re.a)(Lb,"PerformanceObserverInit",null,[]);var ce=Sys.EventArgs;vm(Ra,ce);Object(re.a)(Ra,"LongTaskObservedEventArgs",Sys.EventArgs,[]);var Rd=Sys.EventArgs;vm(Sa,Rd);Object(re.a)(Sa,"LongTaskPerformanceObserverInitializedEventArgs",Sys.EventArgs,[]);Fa.prototype.ele=function(Ca){this.Ma.addHandler("ltoek",Ca)};Fa.prototype.i5i=function(Ca){this.Ma.removeHandler("ltoek",Ca)};Fa.prototype.dBg=function(Ca){this.Ma.addHandler("ltpoiek",Ca)};Fa.prototype.j5i=function(Ca){this.Ma.removeHandler("ltpoiek",
Ca)};Fa.prototype.dispose=function(){this.$.fa.hr(this.Rg);Wf.a.Fa(this.Ma);this.$=this.Ma=null};tl.Object.defineProperties(Fa.prototype,{rdc:{configurable:!0,enumerable:!0,get:function(){return this.oIc}}});Object(re.a)(Fa,"LongTaskPerformanceObserver",null,[3]);var Ne=b(186);Yb.prototype.fhi=function(Ca){return 100*this.Dsd>Ca};Yb.prototype.Gyg=function(Ca){this.bke(Ca.longTaskDuration);this.MSc(Ca.activeSessionDuration)};Yb.prototype.bke=function(Ca){this.longTaskDuration+=Ca};Yb.prototype.MSc=
function(Ca){this.activeSessionDuration+=Ca};tl.Object.defineProperties(Yb.prototype,{Dsd:{configurable:!0,enumerable:!0,get:function(){return this.activeSessionDuration?this.longTaskDuration/this.activeSessionDuration:0}}});Object(re.a)(Yb,"LongTaskPerformanceData",null,[]);tl.Object.defineProperties(lb.prototype,{reportName:{configurable:!0,enumerable:!0,get:function(){return"LongTaskPerformance"}}});tl.Object.defineProperties(lb,{Sfh:{configurable:!0,enumerable:!0,get:function(){return new lb(!1,
new Yb,new Yb,new Yb,0)}}});Object(re.a)(lb,"LongTaskPerformanceDataStatistics",null,[359]);var Be=Sys.EventArgs;vm(sa,Be);Object(re.a)(sa,"LongTaskTrackedEventArgs",Sys.EventArgs,[]);var sd=b(458),cf=b(375);xa.prototype.eBg=function(Ca){this.Ma.addHandler("lttek",Ca)};xa.prototype.k5i=function(Ca){this.Ma.removeHandler("lttek",Ca)};xa.prototype.dispose=function(){this.LOd=!1;this.E2f();this.$.ml(this.od);this.$.Fn(this.qd);this.QM.j5i(this.dwf);Wf.a.Fa(this.XMa);this.QM=this.$=this.XMa=null;void 0!==
this.ef&&null!==this.ef&&Wf.a.Fa(this.ef)};xa.prototype.Lwc=function(){void 0===this.ef||null===this.ef?ae.ULS.sendTraceTag(537153884,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but visibilityObserver is not ready yet"):this.QM.rdc?this.Kgc?ae.ULS.sendTraceTag(537153882,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we already tracking"):this.LOd?(this.Kgc=!0,this.o5=lb.Sfh,this.dS=new Yb,this.$.fa.rga(this.IH),
this.maxUsersCount=this.$.fa.Em.length,this.QM.ele(this.Plc),this.ef.aFa(this.Jkc),this.ef.hmb(this.Kkc),Uf.AFrameworkApplication.SSc(this.Jkc),Uf.AFrameworkApplication.TSc(this.Kkc),this.XMa=Hf.a.instance.create(this.Ajf,this.Csd,Bg.a.Tif,!1),dd.a(this.$).g9(this.o5),this.ef.kj||Uf.AFrameworkApplication.$5a||this.CQd(!0),ae.ULS.sendTraceTag(537153880,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: Start tracking")):ae.ULS.sendTraceTag(537153881,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but we still not ready to start tracking"):
ae.ULS.sendTraceTag(537153883,0,50,"LongTaskPerformanceTracker:StartTrackingIfEnabled: StartTrackingIfEnabled was called but longTaskPerformanceObserver InitializedSuccessfully")};xa.prototype.E2f=function(){this.Kgc&&(this.Kgc=!1,this.$.fa.hr(this.Rg),this.QM.i5i(this.Plc),this.$.fa.Pca(this.IH),void 0!==this.ef&&null!==this.ef&&(this.ef.T$a(this.Jkc),this.ef.cGb(this.Kkc)),Uf.AFrameworkApplication.TLf(this.Jkc),Uf.AFrameworkApplication.ULf(this.Kkc),this.XMa.cancel(),this.oMa=this.dS=this.o5=null,
this.maxUsersCount=0)};xa.prototype.CQd=function(Ca){Ca||void 0===this.oMa||null===this.oMa?(this.oMa=sf.a.Ra.Kb,this.XMa=Ne.AsyncMethodContext.F3g(this.Ajf,Ca?this.Csd:this.Csd-this.dS.activeSessionDuration,Bg.a.Tif,this.XMa)):ae.ULS.sendTraceTag(589875356,0,15,"LongTaskPerformanceTracker:StampLastAppAwakeAndDocumentUnhiddenEcmaDateAndRestartTimer lastAppAwakeAndDocumentUnhiddenEcmaDate is not null when resuming a window")};Object(re.a)(xa,"LongTaskPerformanceTracker",null,[3]);var Dd=$f.a;vm(ta,
Dd);ta.prototype.iq=function(Ca){this.addHandler("LTSCEK",Ca)};ta.prototype.zq=function(Ca){this.removeHandler("LTSCEK",Ca)};ta.prototype.gz=function(){this.gn("QueryLongTasksCount")&&this.raiseEvent("LTSCEK")};ta.prototype.Jr=function(Ca,ra){if("QueryLongTasksCount"!==Ca)return!1;this.iYh(ra);return!0};ta.prototype.gn=function(){return af.EwaSettings.la(615)};ta.prototype.dispose=function(){this.statusBarManager&&(this.statusBarManager.iF(this),this.statusBarManager=null);this.$6a.k5i(this.ewf);
Dd.prototype.dispose.call(this)};ta.prototype.iYh=function(Ca){Ca.Value=String.format("Long Tasks: {0} | Last Task Duration: {1}ms",this.Jjf,Math.round(this.mgf))};Object(re.a)(ta,"LongTasksStatusBarManager",$f.a,[3,281,233]);var tf=b(8);Object(re.a)(Fb,"NetworkInfoData",null,[]);var vf=$f.a;vm(Qb,vf);Qb.prototype.iq=function(Ca){this.addHandler("NetworkInformation",Ca)};Qb.prototype.zq=function(Ca){this.removeHandler("NetworkInformation",Ca)};Qb.prototype.O2a=function(){return this.g_?Object.assign(new Fb,
{bandwidthMps:this.g_.downlink,rttMs:this.g_.rtt,connectionType:this.g_.type,effectiveConnection:this.g_.effectiveType,downlinkMaxMps:this.g_.downlinkMax}):null};Qb.prototype.Jr=function(Ca,ra){if("QueryNetworkInformation"!==Ca)return!1;this.jYh(ra);return!0};Qb.prototype.gn=function(){return this.xSc};Qb.prototype.dispose=function(){this.xSc&&(this.statusBarManager&&(this.statusBarManager.iF(this),this.statusBarManager=null),this.g_&&this.g_.removeEventListener("change",this.Tof));this.$=null;vf.prototype.dispose.call(this)};
Qb.prototype.mUd=function(Ca){return tf.HelperMethods.fm(window.navigator,Ca)?window.navigator[Ca]:null};Qb.prototype.jYh=function(Ca){Ca.Value="Network: "+this.g_.downlink.toString()+" Mbps, "+this.g_.rtt.toString()+" ms"};Object(re.a)(Qb,"NetworkInformationManager",$f.a,[281,233]);var eg=b(185),jg=b(20);Object(re.a)(Gb,"OperationStatisticsData",null,[]);var Xe=b(72);hb.prototype.isGroup=function(Ca,ra,yb){var Hd=new eg.a;Hd.addRange(Ca);Hd.addRange(ra);for(var ye=0;ye<this.operationsGroups.count;ye++)if(this.zdi(this.operationsGroups.na(ye),
Hd,yb))return ae.ULS.sendTraceTag(595194768,1,50,"OperationsGroupDetector: Operation '{0}' is part of a group ( operationsList: {1} , frameOperationsList: {2})",yb,this.OBf(Ca),this.OBf(ra)),!0;ae.ULS.sendTraceTag(595194767,1,50,"OperationsGroupDetector: Operation '{0}' is NOT part of a group.",yb);return!1};hb.prototype.zdi=function(Ca,ra,yb){for(var Hd=0,ye=0;ye<ra.count;ye++)if(ra.na(ye).isGroupBreaking){if(Ca.count<=Hd||!rg.a.equals(ra.na(ye).name,Ca.na(Hd),!0))return!1;Hd++}return Ca.count>Hd&&
rg.a.equals(yb,Ca.na(Hd),!0)};hb.prototype.OBf=function(Ca){Ca=Xe.select(Ca,function(ra){return ra.name});return String.format("[{0}]",Xe.toArray(Ca).join(", "))};hb.prototype.a3h=function(){this.operationsGroups=new eg.a;var Ca;this.sXa((Ca=new eg.a,Ca.add("Paste"),Ca.add("SelectingRange_unknown"),Ca));var ra;this.sXa((ra=new eg.a,ra.add("AutoSum"),ra.add("SelectingRange_unknown"),ra));var yb;this.sXa((yb=new eg.a,yb.add("ChangeSheetDirection"),yb.add("ActiveItemChanged"),yb));var Hd;this.sXa((Hd=
new eg.a,Hd.add("InsertSheet"),Hd.add("ActiveItemChanged"),Hd.add("SelectingRange_unknown"),Hd));var ye;this.sXa((ye=new eg.a,ye.add("DeleteSheet"),ye.add("DialogButtonClick"),ye.add("ActiveItemChanged"),ye.add("SelectingRange_unknown"),ye));var Cf;this.sXa((Cf=new eg.a,Cf.add("EditBoxEndEdit"),Cf.add("SetCell"),Cf.add("SelectingRange_keyboard"),Cf.add("MoveDownWithinSelectionOrCommitEdit"),Cf))};hb.prototype.sXa=function(Ca){this.operationsGroups.add(Ca)};Object(re.a)(hb,"OperationsGroupDetector",
null,[]);var wg=b(29);ya.prototype.CGb=function(Ca,ra){var yb=tf.HelperMethods.jc(),Hd=af.EwaSettings.la(378)?this.operationsGroupDetector.isGroup(this.FC,this.XD,Ca):!1;this.efc=this.jcf(Ca);af.EwaSettings.la(378)?this.efc&&0<this.FC.count&&!Hd&&(this.BKj(),this.B$f(Ca,yb),this.vRe()):0<this.FC.count&&this.jcf(Ca)&&(this.B$f(Ca,yb),this.vRe());this.z6a=-1;if(jg.g(this.$)&&jg.g(this.$).Ca){var ye=!this.q0.contains(Ca);yb=new Gb(Ca,yb,void 0,void 0,void 0,ye,this.efc,Hd);this.XD.add(yb);this.framePerformanceTracker&&
this.framePerformanceTracker.pxj(yb.name,ra);af.EwaSettings.la(378)&&!this.JHb&&this.wGb.contains(Ca)&&(this.JHb=!0);-1===this.wUc&&(this.wUc=window.requestAnimationFrame(this.f8i))}else ae.ULS.sendTraceTag(537153879,1,10,"Grid == null or BlockManager == null")};ya.prototype.mrc=function(){this.z6a=tf.HelperMethods.jc()};ya.prototype.urc=function(){this.FC.count||this.XD.count?(this.wMb(this.XD,this.z6a),this.wMb(this.FC,this.z6a)):ae.ULS.sendTraceTag(0,1,50,"ReportOnBlockCacheConsistant when no operations in the list. Last block render time: {0}",
this.z6a);this.z6a=-1};ya.prototype.jcf=function(Ca){return!this.q_.contains(Ca)&&!Ca.includes("Menu")&&!Ca.includes("TellMe")};ya.prototype.vRe=function(){for(var Ca=0;Ca<this.FC.count;Ca++){var ra=this.FC.na(Ca);this.ZH.Eug(ra);this.Gni(ra)}this.FC.clear()};ya.prototype.wLj=function(Ca){for(var ra=0;ra<this.XD.count;ra++)this.XD.na(ra).startToNextFrame=this.Ndd(this.XD.na(ra).startTime,Ca),this.XD.na(ra).wasHidden=ec.a.eH(this.XD.na(ra).startToNextFrame)};ya.prototype.B$f=function(Ca,ra){for(var yb=
0;yb<this.FC.count;yb++)-1===this.FC.na(yb).startToResponseRenderEnd&&(this.FC.na(yb).operationThatLedToLogging=Ca,this.FC.na(yb).startToOperationThatLedToLogging=this.Ndd(this.FC.na(yb).startTime,ra))};ya.prototype.BKj=function(){for(var Ca=!1,ra=yl(this.FC),yb=ra.next();!yb.done;yb=ra.next())if(yb.value.isPartOfGroup){Ca=!0;break}if(Ca)for(Ca=0;Ca<this.FC.count;Ca++)this.FC.na(Ca).isPartOfGroup=this.FC.na(Ca).isGroupBreaking};ya.prototype.wMb=function(Ca,ra){for(var yb=0;yb<Ca.count;yb++)Ca.na(yb).startToResponseRenderEnd=
this.Ndd(Ca.na(yb).startTime,ra),Ca.na(yb).wasHidden=ec.a.eH(Ca.na(yb).startToResponseRenderEnd)};ya.prototype.Gni=function(Ca){ae.ULS.sendTraceTag(2020372336,1,50,"{0}",Ca)};ya.prototype.Ndd=function(Ca,ra){return-1===Ca?-1:-1===ra?-2:ra-Ca};ya.prototype.Woi=function(Ca){Ca=Ca.getEntriesByType(tg.a.Asd);for(var ra=0;ra<Ca.length;ra++)if(30>this.hAb.count)if(this.XD.count)this.hAb.add(this.uQi(Ca[ra]));else{var yb=Ca[ra];if(null===yb||void 0===yb?0:yb.attribution)void 0!==yb.attribution.containerSrc&&
null!==yb.attribution.containerSrc&&(yb.attribution.containerSrc=""),void 0!==yb.attribution.containerId&&null!==yb.attribution.containerId&&(yb.attribution.containerId=""),void 0!==yb.attribution.containerName&&null!==yb.attribution.containerName&&(yb.attribution.containerName="");ae.ULS.sendTraceTag(40777251,1,50,"LongTaskObserverAction: long task occur when operations list was empty. {0}",yb)}else{ae.ULS.sendTraceTag(537153874,1,50,"More then {0} long tasks are in the longTaskList. entries length: {1} First long task: {2}",
30,Ca.length,this.hAb.na(0));break}};ya.prototype.uQi=function(Ca){return String.format("name:{0}, startTime:{1}, duration:{2}",Ca.name,Ca.startTime,Ca.duration)};ya.prototype.x3h=function(){this.q0||(this.q0=new tc.a(Rf.a.Ik()),this.q0.add("ActiveItemChanged"),this.q0.add(qb.b().pi(-1398645260)),this.q0.add(qb.b().pi(722290388)),this.q0.add(qb.b().pi(974713501)),this.q0.add(wg.a.mQ(wg.a.g1b)),this.q0.add(wg.a.mQ(wg.a.f1b)),this.q0.add(wg.a.mQ(wg.a.gpb)),this.q0.add(wg.a.mQ(wg.a.BGf)),this.q0.add(wg.a.mQ(wg.a.oma)))};
ya.prototype.c3h=function(){this.q_||(this.q_=new tc.a(Rf.a.Ik()),this.q_.add("PromptEditInBrowser"),this.q_.add(qb.b().pi(-1398645260)),this.q_.add(qb.b().pi(722290388)),this.q_.add(qb.b().pi(974713501)),this.q_.add(wg.a.mQ(wg.a.g1b)),this.q_.add(wg.a.mQ(wg.a.f1b)),this.q_.add(wg.a.mQ(wg.a.gpb)),this.q_.add(wg.a.mQ(wg.a.BGf)),this.q_.add(wg.a.mQ(wg.a.oma)))};ya.prototype.b3h=function(){this.wGb||(this.wGb=new tc.a(Rf.a.Ik()),this.wGb.add("SelectingRange_keyboard"),this.wGb.add("SelectingRange_mouse"))};
Object(re.a)(ya,"OperationStatistics",null,[]);var mg=b(599);Object(re.a)(da,"RequestError",null,[]);Tb.dYg=function(Ca){if(!Ca)return[];var ra=[];Ca=yl(Ca);for(var yb=Ca.next();!yb.done;yb=Ca.next())yb=yb.value,ra.push(new da(yb.MessageIdName,yb.ErrorCause));return ra};Tb.aLh=function(Ca){return!Tb.Qvi.contains(Ca)};Tb.jNh=function(){var Ca=new tc.a(Rf.a.Ik());Ca.add("CheckPersistedContentUpdate");Ca.add("GetContentBundle");Ca.add("GetSessionStatus");Ca.add("GetStatusBarAggregates");Ca.add("PollSessionStatus");
Ca.add("UpdatePresenceUsers");Ca.add("UploadLatencyTelemetry");return Ca};Tb.YKh=function(Ca){return Tb.gzh.contains(Ca)};Tb.ZKh=function(Ca){return Tb.sVi.contains(Ca)};Tb.JJh=function(){var Ca=new tc.a(Rf.a.Ik());Ca.add("SetRichTextCell");Ca.add("Copy");Ca.add("FormatCells");Ca.add("PasteRange");Ca.add("FindCell");Ca.add("ApplyToRangesV2");Ca.add("ResizeRowsColumns");Ca.add("InsertDeleteCells");Ca.add("FillRange");Ca.add("PasteHtmlContent");Ca.add("ApplyFilter");Ca.add("PasteString");Ca.add("Undo");
Ca.add("LineageUpdateView");Ca.add("FindAll");Ca.add("ApplyHyperlink");Ca.add("AutoFit");Ca.add("GetPrintSettings");Ca.add("GetEdgeCell");Ca.add("Paste");Ca.add("MoveAndResizeFloatingObject");Ca.add("FindRange");Ca.add("SetCustomFilter");Ca.add("RenameSheet");Ca.add("ApplyThreadedComment");Ca.add("SortFilterColumn");Ca.add("InsertCopiedCutCells");Ca.add("InsertSheet");Ca.add("ToggleAutoFilter");Ca.add("ReorderSheets");Ca.add("SetOutlineLevel");Ca.add("RefreshAll");Ca.add("LineageOpenPaneOrChangeFilter");
Ca.add("ApplySlicerSelection");Ca.add("GetCardViewCardByCell");Ca.add("AutoSum");Ca.add("LineageClosePane");Ca.add("Sort");Ca.add("ClearAutoFilter");Ca.add("DeleteSheet");Ca.add("Redo");af.EwaSettings.isChangeGateEnabled("OfficeVSO:5317483_AdditionalOperationsInXlreqKPI")&&(Ca.add("RemovePageBreak"),Ca.add("InsertPageBreak"),Ca.add("SetPrintArea"),Ca.add("ClearPrintArea"));return Ca};Tb.$Kh=function(){var Ca=new tc.a(Rf.a.Ik());Ca.add("DeleteConditionalFormattingRules");Ca.add("GetConditionalFormattingRules");
Ca.add("AddConditionalFormattingRule");Ca.add("QuickEditConditionalFormattingRule");Ca.add("GetPrintSettings");Ca.add("UpdatePresenceUsers");Ca.add("GetThemeInfo");af.EwaSettings.isChangeGateEnabled("OfficeVSO:5738374_UTR_xlreq_lineage")&&(Ca.add("LineageOpenPaneOrChangeFilter"),Ca.add("LineageUpdateView"),Ca.add("LineageRefreshView"),Ca.add("LineageLoadMore"));return Ca};Tb.Qvi=Tb.jNh();Tb.gzh=Tb.JJh();Tb.sVi=Tb.$Kh();Object(re.a)(Tb,"RequestStatisticsData",null,[]);var td;Sb.GWg=(td=new eg.a,td.add(tg.a.Z2a),
td.add(tg.a.Pua),td.add("GetSessionStatus"),td.add("SetCell"),td.add("FindRange"),td.add("FindAll"),td.add("FindCell"),td.add("PollSessionStatus"),td);var wf={};Sb.gcg=(wf.GetPrintSettings=sd.a.Lxc,wf.UpdatePresenceUsers=sd.a.presence,wf.GetThemeInfo=sd.a.Lxc,wf);Object(re.a)(Sb,"WebRequestsKpi",null,[]);Xa.prototype.yrc=function(Ca,ra,yb,Hd,ye,Cf,Bf,ch,Tg,fe,Ih,Th,h,Bb){Th=mg.a(Th);Ca=new Tb(Ca,ra,yb,Hd,ye,Cf,Bf,ch,Tg,Th,fe,Ih,ec.a.eH(ra),this.pdd(null),h,this.Yka.O2a(),Bb);this.ZHd(Ca)};Xa.prototype.Zh=
function(Ca,ra){Ca="UnknownMethodName";var yb=-1;void 0!==ra.context&&null!==ra.context&&(Ca=ra.context.methodName,yb=ra.context.communicationErrorRetryCount);var Hd={EcsOperationDuration:-1,EcsRequestDuration:-1,WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1};if(ra.yd){var ye=ra.yd.Errors||[];this.ZH.W7i(ra.yd.EditSessionIsDirty);void 0!==ra.yd.RequestTelemetryData&&null!==ra.yd.RequestTelemetryData&&(Hd=ra.yd.RequestTelemetryData)}else ye=[];var Cf=ra.duration,Bf=mg.a(ra.url);
ra=new Tb(Ca,Cf,ra.totalOperationDuration,ra.PSd,ra.AE,Hd,ra.lLd,ye,ra.httpStatus,Bf,yb,!0,ec.a.eH(Cf),this.pdd(ra.yd),ra.responseSize,this.Yka.O2a(),ra.responseToCallbackTime);this.ZHd(ra)};Xa.prototype.Xo=function(Ca,ra){Ca="UnknownMethodName";var yb=-1;void 0!==ra.context&&null!==ra.context&&(Ca=ra.context.methodName,yb=ra.context.communicationErrorRetryCount);var Hd=ra.duration,ye=mg.a(ra.url);ra=new Tb(Ca,Hd,ra.totalOperationDuration,ra.PSd,ra.AE,{EcsOperationDuration:-1,EcsRequestDuration:-1,
WfeRequestDuration:-1,TimeFromLastEcsFreeze:-1,DuringLoadOnDemand:!1},ra.lLd,ra.errors||[],ra.httpStatus,ye,yb,!1,ec.a.eH(Hd),this.pdd(null),-1,this.Yka.O2a(),ra.responseToCallbackTime);this.ZHd(ra)};Xa.prototype.ZHd=function(Ca){this.ZH.dEg(Ca);if(af.EwaSettings.la(230)){var ra=Ca.requestName;if(ra!==tg.a.Pua&&"SetCell"!==ra&&"FindRange"!==ra&&"FindAll"!==ra&&"FindCell"!==ra)return}ra=af.EwaSettings.isChangeGateEnabled("OfficeVSO:5514802_UTRBasedOnULS_xlreq")&&!(void 0===Ca.requestName||null===Ca.requestName)&&
Ca.isPromotedUTRRequest;Xa.Fdh(Ca,ra);af.EwaSettings.isChangeGateEnabled("OfficeVSO:5158052_AddInfraToRecordKpiForWebRequests")&&Xa.j_i(Ca);this.ZH.Fug(Ca)};Xa.prototype.pdd=function(Ca){var ra;if(null===(ra=null===Ca||void 0===Ca?void 0:Ca.CollaborationResult)||void 0===ra?0:ra.Users)return Ca.CollaborationResult.Users.length;Ca=this.$.fa.Em.length;return 0<Ca?Ca:1};Xa.Fdh=function(Ca,ra){ra?qb.b().stc(388829456,0,15,Ca):(ra=Sys.Serialization.JavaScriptSerializer.serialize(Ca),ae.ULS.sendTraceTag(388829456,
0,50,ra));if(af.EwaSettings.isChangeGateEnabled("OfficeVSO:5294200_ReportXlreqKPI")&&void 0!==Ca.requestName&&null!==Ca.requestName&&Ca.isFullyLoggedKPIRequest){ra=new Map;ra.set("isUserTriggeredRequest",Ca.isUserTriggeredRequest.toString());ra.set("requestDuration",Ca.requestDuration.toString());ra.set("totalOperationDuration",Ca.totalOperationDuration.toString());ra.set("requestTimeInQueue",Ca.requestTimeInQueue.toString());ra.set("requestInvokedTime",Ca.requestInvokedTime.toString());ra.set("ecsOperationDuration",
Ca.ecsOperationDuration.toString());ra.set("ecsRequestDuration",Ca.EcsRequestDuration.toString());ra.set("wfeRequestDuration",Ca.WfeRequestDuration.toString());ra.set("timeFromLastEcsFreeze",Ca.TimeFromLastEcsFreeze.toString());ra.set("duringLoadOnDemand",Ca.DuringLoadOnDemand.toString());ra.set("correlationID",Ca.correlationID);ra.set("errors",Ca.errors.toString());ra.set("httpStatus",Ca.httpStatus.toString());if(Ca.networkInfoData){var yb=Ca.networkInfoData;ra.set("networkInfoData_bandwidthMps",
void 0===yb.bandwidthMps||null===yb.bandwidthMps?"NA":yb.bandwidthMps.toString());ra.set("networkInfoData_rttMs",void 0===yb.rttMs||null===yb.rttMs?"NA":yb.rttMs.toString());ra.set("networkInfoData_effectiveConnection",void 0===yb.effectiveConnection||null===yb.effectiveConnection?"NA":yb.effectiveConnection)}Ca.requestResourceTiming&&(yb=Ca.requestResourceTiming,ra.set("requestResourceTiming_fetchStart",void 0===yb.downloadDuration||null===yb.downloadDuration?"NA":yb.downloadDuration.toString()));
ra.set("communicationErrorRetryCount",Ca.communicationErrorRetryCount.toString());ra.set("successfulCall",Ca.successfulCall.toString());ra.set("isDocumentHidden",Ca.isDocumentHidden.toString());ra.set("coauthorsCount",Ca.coauthorsCount.toString());ra.set("responseSize",Ca.responseSize.toString());ra.set("responseToCallbackTime",Ca.responseToCallbackTime.toString());qb.b().vrc(Ca.requestName,Ca.successfulCall,ra)}};Xa.j_i=function(Ca){var ra=Ca.requestName;if(!Sb.GWg.contains(ra))if(!tf.HelperMethods.EZ&&
!Xa.mbf)ae.ULS.sendTraceTag(537153872,0,15,"RequestStatistics.RecordKpiForRequest: Failed to record KPI since usage is not supported."),Xa.mbf=!0;else if(ra in Sb.gcg){var yb=new Map,Hd=ra+"WebRequest";yb.set("IsUserTriggeredRequest",Ca.isUserTriggeredRequest.toString());yb.set("RequestDuration",Ca.requestDuration.toString());yb.set("TotalOperationDuration",Ca.totalOperationDuration.toString());yb.set("RequestTimeinQueue",Ca.requestTimeInQueue.toString());yb.set("EcsOperationDuration",Ca.ecsOperationDuration.toString());
yb.set("WfeRequestDuration",Ca.WfeRequestDuration.toString());yb.set("ResponseSize",Ca.responseSize.toString());yb.set("IsSuccessfulCall",Ca.successfulCall.toString());yb.set("EcsRequestDuration",Ca.EcsRequestDuration.toString());yb.set("ResponseToCallbackTime",Ca.responseToCallbackTime.toString());Rc.Health.instance.recordKpiUsage(Hd,0,Sb.gcg[ra].toString(),yb)}};Xa.mbf=!1;Object(re.a)(Xa,"RequestStatistics",null,[]);var Oh=b(199),Jg=b(81),oh=b(304);Object(re.a)(Cb,"OperationTypeStatisticsData",
null,[]);ob.prototype.ae=function(Ca){this.data.totalCount<ob.N5c&&(Array.add(this.d2f,Ca.startToNextFrame),Array.add(this.e2f,Ca.startToResponseRenderEnd));this.data.totalCount++;this.data.longestStartToNextFrame<Ca.startToNextFrame&&(this.data.longestStartToNextFrame=Ca.startToNextFrame);this.data.longestStartToResponse<Ca.startToResponseRenderEnd&&(this.data.longestStartToResponse=Ca.startToResponseRenderEnd)};ob.prototype.N9c=function(){0<this.data.totalCount&&(this.data.startToNextFramePercentiles=
this.kZe(this.d2f),this.data.startToResponsePercentiles=this.kZe(this.e2f))};ob.prototype.kZe=function(Ca){Ca.sort(tf.HelperMethods.xC);var ra="("+ec.a.xua(Ca,25).toString();ra=ra+", "+ec.a.xua(Ca,50).toString();ra=ra+", "+ec.a.xua(Ca,75).toString();ra=ra+", "+ec.a.xua(Ca,95).toString();return ra+")"};ob.N5c=1E3;Object(re.a)(ob,"OperationTypeStatistics",null,[]);Object(re.a)(Ma,"RequestTypeStatisticsData",null,[]);Ia.prototype.C8i=function(Ca){this.data.totalCount<Ia.N5c&&Array.add(this.mab,Ca.requestDuration);
this.data.totalCount++;this.GTd+=Ca.requestDuration;this.BTd+=Ia.$ad(Ca.ecsOperationDuration);this.ATd+=Ia.$ad(Ca.EcsRequestDuration);this.JTd+=Ia.$ad(Ca.WfeRequestDuration);0<Ca.TimeFromLastEcsFreeze&&Ca.TimeFromLastEcsFreeze<Ia.Xyh&&this.data.callsDuringEcsFreeze++;Ca.successfulCall?this.data.successfulCalls++:this.data.unsuccessfulCalls++;Ca.DuringLoadOnDemand&&this.data.callsDuringLoadOnDemand++;if(void 0===this.data.longestRequest||null===this.data.longestRequest||this.data.longestRequest.requestDuration<
Ca.requestDuration)this.data.longestRequest=Ca};Ia.prototype.N9c=function(){0<this.data.totalCount&&(this.data.averageDuration=Math.floor(this.GTd/this.data.totalCount),0<this.data.successfulCalls?(this.data.averageEcsOperationDuration=Math.floor(this.BTd/this.data.successfulCalls),this.data.averageEcsDuration=Math.floor(this.ATd/this.data.successfulCalls),this.data.averageWfeDuration=Math.floor(this.JTd/this.data.successfulCalls)):(this.data.averageEcsOperationDuration=0,this.data.averageEcsDuration=
0,this.data.averageWfeDuration=0),this.mab.sort(tf.HelperMethods.xC),this.data.requestDurationPercentile25=ec.a.xua(this.mab,25),this.data.requestDurationPercentile50=ec.a.xua(this.mab,50),this.data.requestDurationPercentile75=ec.a.xua(this.mab,75),this.data.requestDurationPercentile95=ec.a.xua(this.mab,95))};Ia.$ad=function(Ca){return 0>Ca?0:Ca};Ia.Xyh=3E3;Ia.N5c=1E3;Object(re.a)(Ia,"RequestTypeStatistics",null,[]);Object(re.a)(pa,"SessionStatisticsData",null,[]);ma.prototype.qd=function(){var Ca=
this.y6g();og.a.eda()?this.$.Dma(Oh.a.aQj,{xlendJson:Ca},!1):Jg.pb(this.$.qa.ta,Ca,null,null,null,null,null);Ca=this.z6g();og.a.eda()?this.$.Dma(Oh.a.bQj,{xlenoJson:Ca},!1):ae.ULS.sendTraceTag(388776782,0,50,Ca);af.EwaSettings.la(69)&&(Ca=this.U0g(),og.a.eda()?this.$.Dma(Oh.a.$Pj,{xlencJson:Ca},!1):ae.ULS.sendTraceTag(388776770,0,50,Ca));this.j9i()};ma.prototype.Lgc=function(){this.everConnectedToOcs=this.$.fa.j6a||this.everConnectedToOcs;Rc.Health.instance&&Rc.Health.instance.addOrUpdatePartCDimension("IsOcsSession",
this.everConnectedToOcs.toString())};ma.prototype.Rg=function(){var Ca=new oh.a,ra="",yb=!this.$.isAnonymousUser(),Hd=Ca.og();if(Hd){if(yb){Ca.muc("UMI_Linkable","true");return}ra=Ca.K2a("UMI_Linkable")}yb||ae.ULS.sendTraceTag(537153870,0,50,"SessionStatistics.OnCommandUIGeneratedAndGridInteractive: IsLocalStorageSupported:{0}, UMIIsLinkable:{1}",Hd,!!ra)};ma.prototype.jab=function(){this.xQd=!0};ma.prototype.W7i=function(Ca){this.dirtySessionOnLastRecordedRequest=Ca};ma.prototype.dEg=function(Ca){this.maxCoauthorsCount=
Math.max(this.maxCoauthorsCount,Ca.coauthorsCount);Rc.Health.instance&&Rc.Health.instance.addOrUpdatePartCDimension("MaxNumEditors",this.maxCoauthorsCount.toString())};ma.prototype.Fug=function(Ca){if(!(Ca.requestName in this.plb)){var ra=new Ia(Ca.requestName);this.plb[Ca.requestName]=ra}this.plb[Ca.requestName].C8i(Ca)};ma.prototype.Eug=function(Ca){if(!(Ca.name in this.olb)){var ra=new ob(Ca.name,Ca.isUserOperation);this.olb[Ca.name]=ra}this.olb[Ca.name].ae(Ca)};ma.prototype.g9=function(Ca){this.B3c[Ca.reportName]=
Ca};ma.prototype.j9i=function(){this.dirtySessionOnLastRecordedRequest=this.xQd=!1;this.Phf=this.$.fa.yrd;this.maxCoauthorsCount=1;this.everConnectedToOcs=!1;this.plb={};this.olb={};this.B3c={}};ma.prototype.y6g=function(){var Ca=new pa(this.$.isEditMode?"edit":"view",this.$.fa.ocsCapable,this.xQd,this.dirtySessionOnLastRecordedRequest,this.$.fa.yrd-this.Phf,this.maxCoauthorsCount,this.everConnectedToOcs,this.plb);return Sys.Serialization.JavaScriptSerializer.serialize(Ca)};ma.prototype.z6g=function(){var Ca=
new eg.a,ra=this.olb,yb;for(yb in ra){var Hd=ra[yb];Hd.N9c();Ca.add(Hd.data)}Ca=Ca.toArray();return Sys.Serialization.JavaScriptSerializer.serialize(Ca)};ma.prototype.U0g=function(){return Sys.Serialization.JavaScriptSerializer.serialize(this.B3c)};Object(re.a)(ma,"SessionStatistics",null,[]);var kd=Re.a;vm(wa,kd);wa.prototype.dispose=function(){this.$&&af.EwaSettings.la(41)&&(this.$.Fn(this.qd),this.$.qa.Lt(this.Zh),this.$.qa.VC(this.Xo),this.$.fa.zMf(this.Lgc),af.EwaSettings.isChangeGateEnabled("OfficeVSO:5638214_UMIIsLinkable")&&
this.$.fa.hr(this.Rg));Wf.a.Fa(this.Yka);Wf.a.Fa(this.$6a);this.VKc=null;Wf.a.Fa(this.QM);this.QM=null;Wf.a.Fa(this.Esd);this.$=this.Esd=null;kd.prototype.dispose.call(this)};wa.prototype.jab=function(){af.EwaSettings.la(41)&&this.ZH.jab()};wa.prototype.yrc=function(Ca,ra,yb,Hd,ye,Cf,Bf,ch,Tg,fe,Ih,Th,h,Bb){af.EwaSettings.la(41)&&(this.ima=this.ima||new Xa(this.$,this.ZH,this.Yka),this.ima.yrc(Ca,ra,yb,Hd,ye,Cf,Bf,ch,Tg,fe,Ih,Th,h,Bb))};wa.prototype.CGb=function(Ca,ra){af.EwaSettings.la(41)&&(this.Cla=
this.Cla||new ya(this.$,this.ZH,this,this.QM),this.Cla.CGb(Ca,ra))};wa.prototype.mrc=function(){af.EwaSettings.la(41)&&(this.Cla=this.Cla||new ya(this.$,this.ZH,this,this.QM),this.Cla.mrc())};wa.prototype.urc=function(){af.EwaSettings.la(41)&&(this.Cla=this.Cla||new ya(this.$,this.ZH,this,this.QM),this.Cla.urc())};wa.prototype.g9=function(Ca){af.EwaSettings.la(41)&&this.ZH.g9(Ca)};wa.prototype.Wbd=function(Ca){return af.EwaSettings.la(41)?this.YCe[Ca]:null};wa.prototype.$Uf=function(Ca){Ca&&(this.YCe[Ca.type]=
Ca)};wa.prototype.O2a=function(){return this.Yka.O2a()};wa.prototype.O2g=function(){Lf.a.Po&&void 0!==window.PerformanceObserver&&null!==window.PerformanceObserver&&(this.VKc=new xa(this.$,this.QM))};tl.Object.defineProperties(wa.prototype,{$6a:{configurable:!0,enumerable:!0,get:function(){return this.VKc}}});Object(re.a)(wa,"SessionStatisticsManager",Re.a,[718]);var sg=b(102),lh=b(1216),Ye=b(113),Rg=b(121);Z.prototype.BCj=function(){return bd.a.Hc(this)};Object(re.a)(Z,"AppUnloadInfo",null,[]);var jh=
b(816),Fg=b(120),Ki=b(584);na.prototype.ROg=function(Ca){var ra=new jh.a(Ki.a.JJ()),yb=0,Hd=0;Ca=yl(Ca);for(var ye=Ca.next();!ye.done;ye=Ca.next()){ye=ye.value;ra.wb(ye)||ra.ia(ye,0);var Cf=ra.ia(ye,ra.na(ye)+1);Cf>yb&&(yb=Cf,Hd=ye)}yb>this.mostCommonOperationCount&&(this.mostCommonOperationName=Fg.a(Hd),this.mostCommonOperationCount=yb)};Object(re.a)(na,"DataLossInfo",null,[]);var ti=b(53);Y.prototype.dispose=function(){this.$&&this.$.userOperationManager&&this.$.userOperationManager.H6i(this.XAf);
this.Df&&(this.Df.eza(this.Uba),this.Df=null);this.nk.kA();this.$=this.nk=null};Y.prototype.w$f=function(){this.Xlj();this.Qab()};Y.prototype.Xlj=function(){this.vy.wasOfflineDuringUnload=this.$.uf.kV;this.vy.timeFromLastConnectivity=Ye.a(sf.a.Ra,this.$.uf.Lgf);this.vy.timeFromLastDisconnectionStart=Ye.a(sf.a.Ra,this.$.uf.Xii);this.vy.disconnectionSource=Enum.toString(lh.a,this.$.uf.disconnectionSource);this.aOf&&(this.vy.hadConnectivityIssuesDuringUnload=this.$.uf.Zja,this.vy.timeFromLastStatusCode0=
Ye.a(sf.a.Ra,this.$.uf.Kgf))};Y.prototype.Qab=function(){this.vy.timestamp=Date.now();this.localStorage.muc(this.CUc,this.vy.BCj())};Y.prototype.DTf=function(){var Ca=this.localStorage.K2a(this.CUc);if(Ca)try{var ra=bd.a.li(Ca);this.localStorage.cGd(this.CUc);var yb=this.hqi(ra);ae.ULS.sendTraceTag(574677456,0,50,yb)}catch(Hd){ae.ULS.sendTraceTag(537151056,0,15,"AppUnloadTelemetryManager.SendLogFromLocalStorage: Exception message: {0}",Hd.message)}else ae.ULS.sendTraceTag(574677457,0,50,"AppUnloadTelemetryManager.SendLogFromLocalStorage: No previous app-unload information")};
Y.prototype.hqi=function(Ca){var ra={};ra.WACSessionID=Ca.wacSessionId;ra.wasRefreshed=this.GSg(Ca,this.$.ya.MaxAppReloadDurationIndicatingRefresh);ra.closedWithDialogConfirmation=Ca.dialogPromptedOnUnload;ra.wasOfflineDuringUnload=Ca.wasOfflineDuringUnload;ra.TimeFromLastConnectivityMs=Ca.timeFromLastConnectivity;ra.TimeFromLastDisconnectionStart=Ca.timeFromLastDisconnectionStart;ra.wasDataLostDuringUnload=Ca.wasDataLostDuringUnload;ra.DataLossInfo=Ca.dataLossInfo;ra.flushedOnUnload=Ca.wasUpdatedOnUnload;
ra.flushedOnBeforeUnload=Ca.wasUpdatedOnBeforeUnload;ra.InactivityDurationBeforeUnload=Ca.inactivityDurationBeforeUnloadSeconds;ra.DisconnectionSource=Ca.disconnectionSource;af.EwaSettings.isChangeGateEnabled("OfficeVSO:5144186_LogBeforeCloseNotificationApiStatusOnUnload")&&(ra.ApiBeforeCloseNotificationEnabledOnUnload=Ca.apiBeforeCloseNotificationEnabledOnUnload);this.aOf&&(ra.hadConnectivityIssuesDuringUnload=Ca.hadConnectivityIssuesDuringUnload,ra.TimeFromLastStatusCode0=Ca.timeFromLastStatusCode0);
af.EwaSettings.isChangeGateEnabled("OfficeVSO:5470513_trackSilentReopenUnloads")&&(ra.LastSilentReopenStartTime=Ca.lastSilentReopenStartTime,ra.LastSilentReopenEndTime=Ca.lastSilentReopenEndTime);return Qc.c(ra)};Y.prototype.GSg=function(Ca,ra){var yb=window.performance.timing.navigationStart-Ca.timestamp;(Ca=this.workbookHashedId===Ca.workbookHashedId&&yb<ra)&&ae.ULS.sendTraceTag(537151055,0,50,"AppUnloadTelemetryManager.CheckRefresh: Session is after refresh");return Ca};Y.ja=function(Ca){Ca.fa.lc.inWebPart||
Ca.da.Ha(410,new Y(Ca))};tl.Object.defineProperties(Y.prototype,{dialogPromptedOnUnload:{configurable:!0,enumerable:!0,get:function(){return this.o2d},set:function(Ca){this.o2d=Ca;this.vy?(this.vy.dialogPromptedOnUnload=Ca,this.Qab()):this.localStorage.og()&&ae.ULS.sendTraceTag(537151058,0,10,"AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: {0}",this.localStorage.og())}},apiBeforeCloseNotificationEnabledOnUnload:{configurable:!0,enumerable:!0,
get:function(){return this.MZd},set:function(Ca){this.MZd=Ca;this.vy?(this.vy.apiBeforeCloseNotificationEnabledOnUnload=Ca,this.Qab()):this.localStorage.og()&&ae.ULS.sendTraceTag(537151057,0,10,"AppUnloadTelemetryManager.DialogPromptedOnUnload.set: AppUnloadInfo is null. isLocalStorageSupported: {0}",this.localStorage.og())}}});Y.Jri=10;Object(re.a)(Y,"AppUnloadTelemetryManager",null,[728,3]);var th=b(179),Pg=b(106);S.prototype.x2f=function(){ae.ULS.shipAssertTag(537151050,1,!this.stopped,"ChainedCallsTracer.CallMeasureContext.StopMeasuring: Calling stop after object was already stopped.");
this.stopped||(this.stopped=!0,this.chainedCallsTracer.eyj(this))};S.prototype.dispose=function(){this.x2f()};tl.Object.defineProperties(S.prototype,{call:{configurable:!0,enumerable:!0,get:function(){return this.Dhg}}});Object(re.a)(S,"CallMeasureContext",null,[753,3]);ca.prototype.JYg=function(){this.gOe=tf.HelperMethods.jc()};ca.prototype.t2f=function(){this.C8c+=tf.HelperMethods.jc()-this.gOe};ca.prototype.HKh=function(){return tf.HelperMethods.jc()-this.startTime};ca.prototype.Yxj=function(){this.t2f();
return this.C8c};tl.Object.defineProperties(ca.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}},type:{configurable:!0,enumerable:!0,get:function(){return this.AB}}});Object(re.a)(ca,"MeasuredCall",null,[]);ba.prototype.V1f=function(Ca,ra){this.l3g();this.ayj();Ca=new ca(Ca,ra);this.Nra.push(Ca);return new S(this,Ca)};ba.prototype.l3g=function(){0<this.Nra.length?ae.ULS.shipAssertTag(537151054,1,!!this.JYc,"ChainedCallsTracer.CreateNewChainIdIfNeeded: callsChain has items but chainId is null or empty."):
this.JYc=th.a.create().toString()};ba.prototype.eyj=function(Ca){var ra=this.Nra.pop();if(Ca.call!==ra)ae.ULS.sendTraceTag(537151053,0,10,"ChainedCallsTracer.StopMeasuringCall: Popped call is not the same as the topmost call in the chain. Popped call ID: {0} Topmost in the chain: {1}",Ca.call.name,ra?ra.name:"null"),this.Nra=[];else{Ca=ra.HKh();var yb=ra.Yxj();ae.ULS.shipAssertTag(537151052,1,!!this.documentVisibilityObserver,"ChainedCallsTracer.IsInProximityToDocumentHidden: documentVisibilityObserver is null");
var Hd=this.documentVisibilityObserver?this.documentVisibilityObserver.eH(Ca+this.Msi):null;this.Nmi(ra,Ca,yb,Hd);this.KYg()}};ba.prototype.ayj=function(){var Ca=this.IXe();Ca&&Ca.t2f()};ba.prototype.KYg=function(){var Ca=this.IXe();Ca&&Ca.JYg()};ba.prototype.IXe=function(){return this.Nra.length?this.Nra[this.Nra.length-1]:null};ba.prototype.Nmi=function(Ca,ra,yb,Hd){if(!(ra<this.Lsi)){var ye=Pg.f(this.Nra,function(Cf){return Cf.name}).join();ae.ULS.sendTraceTag(537151051,0,50,"ChainedCallsTracer: Inclusive duration: {0} Exclusive duration: {1} Chain ID: {2} Call ID: {3} Type: {4} Document hidden: {5} Call chain: {6}",
ra.toFixed(2),yb.toFixed(2),this.JYc,Ca.name,Ca.type,Hd,ye)}};ba.ja=function(Ca){if(af.EwaSettings.la(713)){var ra=new ba(Ca.ya.ChainedCallsTracerMinThresholdToLogInMs);Ca.da.Za(291,function(yb){ra.documentVisibilityObserver=yb});Ca.da.Ha(425,ra);$f.a.qhj(ra)}};Object(re.a)(ba,"ChainedCallsTracer",null,[726]);var hi=b(524);O.prototype.IDj=function(Ca){var ra={};ra=(ra.TaskName=Ca.TN,ra.TotalRunInMs=Ca.TRT,ra.TotalDelayInMs=Ca.TDT,ra.TotalQueueInMs=Ca.TQT,ra.TaskPriority=Ca.TP,ra.CoauthorsCount=this.fa.Em.length,
ra);Ca.TDT>this.WSd||Ca.TRT>this.USd?ae.ULS.sendTraceTag(321938518,0,15,ee.a.toJSON(ra)):(Ca.TDT>this.VSd||Ca.TRT>this.TSd)&&ae.ULS.sendTraceTag(321938508,0,50,ee.a.toJSON(ra))};O.prototype.Luh=function(Ca){return this.ef.eH(Ca.TRT+Ca.TQT+3E3)?!1:Ca.TDT>Math.min(this.VSd,this.WSd)||Ca.TRT>Math.min(this.TSd,this.USd)};Object(re.a)(O,"TaskEventProcessor",null,[]);var ah=b(14);I.prototype.dispose=function(){this.$=null};I.prototype.zbj=function(){this.ODe||this.YOg();var Ca=jg.c(jg.g(this.$));if(!this.MDe){var ra=
ah.a.instance.Va(279).split(",");Array.addRange(Ca,ra);this.MDe=!0}Ca=yl(Ca);for(ra=Ca.next();!ra.done;ra=Ca.next())(ra=ra.value)&&!this.P4f.has(ra)&&(this.Xmi(ra),this.P4f.add(ra))};I.prototype.Xmi=function(Ca){this.VPg(Ca)};I.prototype.YOg=function(){this.ODe=I.E2a("monospace");I.E2a("sans-serif");I.E2a("serif")};I.prototype.VPg=function(Ca){I.E2a(String.format("{0},{1}",Ca,"monospace"));I.E2a(String.format("{0},{1}",Ca,"sans-serif"));I.E2a(String.format("{0},{1}",Ca,"serif"))};I.ja=function(Ca){if(af.EwaSettings.la(62)){var ra=
new I(Ca);Ca.da.Ha(210,ra)}};I.E2a=function(Ca){var ra=document.createElement("div"),yb=document.createElement("div");ra.style.cssText="position: absolute; overflow: auto; visibility: hidden;";I.Hlj(yb,Ca);document.body.appendChild(ra);ra.appendChild(yb);yb.innerHTML="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ01234567890~!@#$%^&*()-+";Ca=yb.offsetWidth+"x"+yb.offsetHeight;document.body.removeChild(yb.parentNode);return Ca};I.Hlj=function(Ca,ra){Ca.style.cssText="display: inline; visibility: hidden;";
Ca.style.fontSize="100px";Ca.style.fontWeight="normal";Ca.style.fontStyle="normal";Ca.style.letterSpacing="normal";Ca.style.lineHeight="normal";Ca.style.whiteSpace="nowrap";Ca.style.fontFamily=ra};Object(re.a)(I,"FontTelemetryManager",null,[3]);var qi=b(229),Ch=b(164),gh;(function(Ca){Ca[Ca.legacyMultiLineRibbon=0]="legacyMultiLineRibbon";Ca[Ca.reactSingleLineRibbon=1]="reactSingleLineRibbon";Ca[Ca.reactMultiLineRibbon=2]="reactMultiLineRibbon";Ca[Ca.invalid=3]="invalid"})(gh||(gh={}));Object(re.b)("RibbonMode",
gh);var yi=b(104),ii=$f.a;vm(R,ii);R.prototype.aFa=function(Ca){this.addHandler("ekdh",Ca)};R.prototype.T$a=function(Ca){this.removeHandler("ekdh",Ca)};R.prototype.hmb=function(Ca){this.addHandler("ekduh",Ca)};R.prototype.cGb=function(Ca){this.removeHandler("ekduh",Ca)};R.prototype.eH=function(Ca){return this.kj?!0:this.phc?Qe.getElapsedMilliseconds(this.phc,sf.a.Ra.Kb)<Ca:!1};R.prototype.dispose=function(){Wf.a.Fa(this.NY);Wf.a.Fa(this.nk);ii.prototype.dispose.call(this)};R.prototype.n$f=function(){this.rL=
"hidden"===window.document.visibilityState;this.kj?(this.raiseEvent("ekdh"),this.L7d=sf.a.Ra.Kb):(this.raiseEvent("ekduh"),this.M7d=sf.a.Ra.Kb)};tl.Object.defineProperties(R.prototype,{kj:{configurable:!0,enumerable:!0,get:function(){return this.rL}},agf:{configurable:!0,enumerable:!0,get:function(){return this.L7d}},phc:{configurable:!0,enumerable:!0,get:function(){return this.M7d}}});Object(re.a)(R,"DocumentVisibilityObserver",$f.a,[808,3]);Object(re.a)(W,"FramePerformanceData",null,[]);Object(re.a)(ia,
"FramePerformanceDataGroup",null,[]);tl.Object.defineProperties(P.prototype,{reportName:{configurable:!0,enumerable:!0,get:function(){return this._reportName}}});Object(re.a)(P,"FramePerformanceSessionEndsReport",null,[359]);N.prototype.B3g=function(){this.vga=new ia("AllGridOperationsData");this.lf.operationsGroups.push(this.vga);this.$pb("Selection","SelectingRange_keyboard SelectingRange_mouse WidgetSelectAll SelectAll ExtendDown ExtendEnd ExtendLeft ExtendRight ExtendRowEnd ExtendRowStart ExtendScreenDown ExtendScreenUp ExtendSelectionToA1 ExtendSelectionToUsedRangeEnd ExtendStart ExtendToBottomEdge ExtendToLeftEdge ExtendToRightEdge ExtendToTopEdge ExtendUp MoveRight MoveUp MoveLeft MoveDown MoveToRightEdge MoveToLeftEdge MoveToBottomEdge Goto GotoA1 GotoRowStart GotoUsedRangeEnd MoveRightWithinSelectionOrFunctionAutoComplete MoveLeftWithinSelection".split(" "));
this.$pb("DragScroll",["DragScroll"]);this.$pb("Scroll",["ViewportVerticalScroll","ViewportHorizontalScroll"]);this.$pb("Typing",["GridTypingKeyPressed","FormulaBarTypingKeyPressed","EditBoxStartEdit"]);this.$pb("FloatingObjects",["SelectingFloatingObject","FloatingObjectMove","FloatingObjectResize"])};N.prototype.v8i=function(Ca,ra,yb,Hd){var ye=this.FJh(Ca);ye&&(Pg.b(this.lf.operationsGroups,function(Cf){return rg.a.equals(Cf.name,ye.name,!1)})||this.lf.operationsGroups.push(ye),ye.count++,this.Nzc(ra,
ye),this.Jzc(yb,ye),this.vga.count++,this.Nzc(ra,this.vga),this.Jzc(yb,this.vga),0<Hd&&this.iKj(Hd,ye),0<=ra&&this.DJj(ra,ye))};N.prototype.KKj=function(){for(var Ca=yl(this.lf.operationsGroups),ra=Ca.next();!ra.done;ra=Ca.next())N.JJj(ra.value)};N.prototype.$pb=function(Ca,ra){Ca=new ia(Ca);ra=yl(ra);for(var yb=ra.next();!yb.done;yb=ra.next())this.Vzd[yb.value]=Ca};N.prototype.FJh=function(Ca){return Ca in this.Vzd?this.Vzd[Ca]:null};N.prototype.DJj=function(Ca,ra){30>Ca&&this.eVd(function(yb){yb.l1FramePerformanceData.fpsUnderThresholdOps++},
ra);15>Ca&&this.eVd(function(yb){yb.l2FramePerformanceData.fpsUnderThresholdOps++},ra);5>Ca&&this.eVd(function(yb){yb.l3FramePerformanceData.fpsUnderThresholdOps++},ra)};N.prototype.iKj=function(Ca,ra){100<=Ca&&(this.Xdb(ra.l1FramePerformanceData,Ca,this.Wdb),this.Xdb(this.vga.l1FramePerformanceData,Ca,this.Wdb));300<=Ca&&(this.Xdb(ra.l2FramePerformanceData,Ca,this.Wdb),this.Xdb(this.vga.l2FramePerformanceData,Ca,this.Wdb));600<=Ca&&(this.Xdb(ra.l3FramePerformanceData,Ca,this.Wdb),this.Xdb(this.vga.l3FramePerformanceData,
Ca,this.Wdb))};N.prototype.eVd=function(Ca,ra){ra&&(Ca(ra),Ca(this.vga))};N.prototype.Xdb=function(Ca,ra,yb){Ca&&yb(Ca,ra)};N.prototype.Nzc=function(Ca,ra){ra.minFPS=-1===ra.minFPS?Ca:Math.min(ra.minFPS,Ca)};N.prototype.Jzc=function(Ca,ra){ra.maxFPS=Math.max(ra.maxFPS,Ca)};N.JJj=function(Ca){N.DVd(Ca.l1FramePerformanceData,Ca.count);N.DVd(Ca.l2FramePerformanceData,Ca.count);N.DVd(Ca.l3FramePerformanceData,Ca.count)};N.DVd=function(Ca,ra){Ca.fpsUnderThresholdOpsPercentage=100*Ca.fpsUnderThresholdOps/
ra;Ca.longFramesOverThresholdOpsPercentage=100*Ca.longFramesOverThresholdOps/ra};Object(re.a)(N,"FramePerformanceSessionEndsReportManager",null,[]);Object(re.a)(U,"FpsDataWrapper",null,[]);Object(re.a)(B,"LongFrameData",null,[]);var la=b(340);Object(re.a)(w,"OperationFPSData",null,[]);var nb=b(34),Wb=b(924),Dc=Re.a;vm(G,Dc);G.prototype.start=function(){this.XId=!0;this.resume()};G.prototype.stop=function(){this.XId=!1;this.pause()};G.prototype.dispose=function(){this.stop();this.ef.T$a(this.IV);Uf.AFrameworkApplication.TLf(this.zqf);
Uf.AFrameworkApplication.ULf(this.Bqf);Wf.a.Fa(this.ef);this.Ca.yq(this.Hg);Dc.prototype.dispose.call(this)};G.prototype.pxj=function(Ca,ra){var yb=Ca in this.Kha?this.Kha[Ca]:null;this.vzb=new Date;this.start();var Hd=this.vzb.getSeconds(),ye=Hd+this.sBj;yb&&Hd<=yb.end?(yb.count++,yb.end=ye):(yb&&Hd>yb.end&&this.vta.add(yb),this.Kha[Ca]=new w(Ca,1,Hd,ye,void 0,void 0,void 0,this.$.fa.Em.length,Kd.PageLoadTrackingInfo.instance.oaa(this.vzb),ra))};G.prototype.R1g=function(){this.V1a||(this.r$c(new Date),
this.V1a=new N(this.$))};G.prototype.resume=function(){this.jaf()||!this.Ca.NH||this.isSynthetic||(this.F6a=this.ef.kj,this.Mwa=new Date,this.lqd=this.Mwa.getMinutes(),this.rId(),this.kFe(this.Mwa.getSeconds()),this.Kmb=window.requestAnimationFrame(this.oSe))};G.prototype.jaf=function(){return 0<=this.Kmb};G.prototype.pause=function(){this.jaf()&&(this.F6a||(this.lFe((new Date).getSeconds()),ae.ULS.sendTraceTag(21280654,0,50,"FPS : {0}",this.jY.toString())),window.cancelAnimationFrame(this.Kmb),this.Kmb=
-1)};G.prototype.r$c=function(Ca){if(Ca.getTime()-this.Mwa.getTime()<G.Jsi&&(this.F6a&&this.lFe(this.Mwa.getSeconds()),this.kgh(),0<this.vta.count&&(Ca={},Ca.NonEmptyCellsCount=this.N7a,Ca.TextCellsCount=this.Sxc,Ca.xlfpsJson=Object.assign(new U,{f:this.vta.toArray()}),Ca.memoryInfo=this.Wri(),Ca.zoom=nb.a(this.$)?nb.a(this.$).zoom:1,Ca.HtmlOverlayDomCount=this.EKa,af.EwaSettings.isChangeGateEnabled("OfficeVSO:4941972_AddRibbonModeToXLFPS")&&(Ca.RibbonMode=Ch.a(this.$)?gh[Ch.a(this.$).R_]:G.invalid),
Ca.deviceMemory=navigator.deviceMemory||0,Ca.hardwareConcurrency=navigator.hardwareConcurrency||0,Ca=JSON.stringify(Ca),ae.ULS.sendTraceTag(537151044,0,50,"FPS : {0}",this.jY.toString()),!this.isSynthetic))){og.a.eda()?this.$.Dma(Oh.a.cQj,{xlfpsJson:Ca},!1):ae.ULS.sendTraceTag(388781010,0,50,"{0}",Ca);if(this.vni)for(var ra=yl(this.vta),yb=ra.next();!yb.done;yb=ra.next()){yb=yb.value;var Hd=1E3>=this.N7a?"0_1000":3E3>=this.N7a?"1000_3000":"3000_inf",ye=new Map;ye.set("Operation",yb.Op);ye.set("BucketOfRenderedCells",
Hd);Rc.Health.instance.recordKpiUsage(cf.a.longFrame,0,sd.a.canvas,ye);0<yb.longFrameCount&&Rc.Health.instance.recordKpiFailure(cf.a.longFrame,"LongFrame",!1,!0,Object.assign(new ue.a,{extendedProperties:ye}));3E4<yb.tfAppInt&&(0<yb.longFrameCount?qb.b().pOf(0,this.Uoi,ye):qb.b().qOf(0,ye))}ae.ULS.sendTraceTag(537151043,0,50,"Operations message length: {0}",Ca.length)}this.reset()};G.prototype.Wri=function(){var Ca={};if(window.performance){var ra=window.performance.memory;ra&&(Ca.jsHeapSizeLimit=
ra.jsHeapSizeLimit,Ca.usedJSHeapSize=ra.usedJSHeapSize,Ca.totalJSHeapSize=ra.totalJSHeapSize)}return Ca};G.prototype.reset=function(){this.vta.clear();this.Kha={};this.rId()};G.prototype.kgh=function(){var Ca=!0;Ca=void 0===Ca?!0:Ca;if(this.jY){for(var ra=yl(Wb.a(this.Kha)),yb=ra.next();!yb.done;yb=ra.next())yb=this.Kha[yb.value],yb.end=Math.min(this.jY.length-1,yb.end),this.vta.add(yb);this.jPg(this.vta,this.jY,Ca)}};G.prototype.jPg=function(Ca,ra,yb){yb=void 0===yb?!0:yb;Ca=yl(Ca);for(var Hd=Ca.next();!Hd.done;Hd=
Ca.next()){Hd=Hd.value;var ye=0,Cf=0;if(Hd.end<ra.length){for(var Bf=Hd.start;Bf<=Hd.end;Bf++){var ch=ra[Bf];0<=ch&&(Hd.Max=Math.round(Math.max(Hd.Max,ch)),Hd.Min=Math.round(Math.min(Hd.Min,ch)),ye+=ch,Cf++)}0<Cf&&(Hd.Avg=Math.round(ye/Cf));yb&&this.V1a&&this.V1a.v8i(Hd.Op,Hd.Min,Hd.Max,Hd.LFrame?Hd.LFrame.duration:-1);Hd.Props&&(this.GFj(Hd),Hd.Props=null)}}yb&&this.V1a&&this.V1a.KKj()};G.prototype.rId=function(){this.jY=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,
0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]};G.prototype.kFe=function(Ca){Ca++;for(var ra=0;ra<Ca;ra++)this.jY[ra]=G.M4b};G.prototype.lFe=function(Ca){for(;60>Ca;Ca++)this.jY[Ca]=G.M4b};G.prototype.uni=function(Ca,ra){Ca=Ca.getSeconds();var yb=Wb.a(this.Kha);if(0<yb.length){yb=yl(yb);for(var Hd=yb.next();!Hd.done;Hd=yb.next())if(Hd=this.Kha[Hd.value],Ca>=Hd.start&&Ca<Hd.end)Hd.LFrame?Hd.LFrame.duration<ra&&(Hd.LFrame.startSecond=Ca,Hd.LFrame.duration=ra,Hd.longFrameCount++):(Hd.LFrame=new B(Ca,
ra),Hd.longFrameCount++)}};G.prototype.rKj=function(){this.EKa=this.Sxc=this.N7a=0;for(var Ca=yl(jg.g(this.$).jn),ra=Ca.next();!ra.done;ra=Ca.next()){ra=ra.value.nBa;for(var yb in ra){var Hd=this.Ca.jl(ra[yb].hashCode);if(null===Hd||void 0===Hd?0:Hd.tk)this.N7a+=Hd.qe.NonEmptyCellsCount,this.Sxc+=Hd.qe.TextValueCellsCount,this.EKa+=Hd.EKa}}};G.prototype.GFj=function(Ca){var ra=Ca.Props;if(Pa.a.nJb in ra&&ra[Pa.a.nJb]&&Pa.a.eLb in ra){var yb;(yb=Object(sc.a)(qi.a,ra[Pa.a.eLb]))&&yb.continueWith(function(Hd){yi.TextEditorTelemetry.instance.Uwg(Ca.Op,
Ca.Min,!!Ca.LFrame,Ca.LFrame?Ca.LFrame.duration:0,Hd.result)})}};G.M4b=-1;G.Jsi=6E4;G.invalid="Invalid";Object(re.a)(G,"FramePerformanceTracker",Re.a,[749,3]);var zb=ud.a;vm(r,zb);r.prototype.create=function(){var Ca=this.$.da.Aa(263);Ca||(Ca=this.$.da.Ha(263,new G(this.$)));this.Fb(Ca)};r.ja=function(Ca){Ca.da.Ha(264,new r(Ca))};Object(re.a)(r,"FramePerformanceTrackerFactory",ud.a,[]);var hd=b(1270),ke=b(1073);z.prototype.Xh=function(Ca,ra){return new ke.a(Ca,ra)};z.prototype.Fc=function(Ca,ra){Ca=
this.Xh(Ca,ra);Ca.start();return Ca};Object(re.a)(z,"DefaultStopwatchBuilder",null,[153]);t.prototype.Xh=function(Ca,ra){return this.ipa.Xh(Ca,ra)};t.prototype.Fc=function(Ca,ra){return this.ipa.Fc(Ca,ra)};Object(re.a)(t,"StopwatchBuilder",null,[153]);var He=b(408),df=b(926),kf=b(1059),ff;(function(Ca){Ca[Ca.actions=0]="actions";Ca[Ca.correlationStart=1]="correlationStart";Ca[Ca.reorderSheetOp=2]="reorderSheetOp";Ca[Ca.formatCellOp=3]="formatCellOp";Ca[Ca.copyOp=4]="copyOp";Ca[Ca.pasteOp=5]="pasteOp";
Ca[Ca.getNumberViewModelDataOp=6]="getNumberViewModelDataOp";Ca[Ca.instantaneousSetData=7]="instantaneousSetData";Ca[Ca.immediateSetData=8]="immediateSetData";Ca[Ca.dependentCellsCalc=9]="dependentCellsCalc";Ca[Ca.dependentCellsGraphStat=10]="dependentCellsGraphStat";Ca[Ca.dependentCellsGraphSectionStat=11]="dependentCellsGraphSectionStat";Ca[Ca.getRangeContentPrefetchFailures=12]="getRangeContentPrefetchFailures";Ca[Ca.gridBlockUpdates=13]="gridBlockUpdates";Ca[Ca.browserAppStart=14]="browserAppStart";
Ca[Ca.linkedObjects=15]="linkedObjects";Ca[Ca.longFrames=16]="longFrames";Ca[Ca.task=17]="task";Ca[Ca.conflictInEditing=18]="conflictInEditing";Ca[Ca.incomingPresenceData=19]="incomingPresenceData";Ca[Ca.editorTableDelay=20]="editorTableDelay";Ca[Ca.presenceStartup=21]="presenceStartup";Ca[Ca.presenceDelete=22]="presenceDelete";Ca[Ca.editorEvent=23]="editorEvent";Ca[Ca.editorTime=24]="editorTime";Ca[Ca.gridScreenReaderOps=25]="gridScreenReaderOps";Ca[Ca.sendPresenceToService=26]="sendPresenceToService";
Ca[Ca.IME=27]="IME";Ca[Ca.freezePaneFloatingObjects=28]="freezePaneFloatingObjects";Ca[Ca.customizeStatusBar=29]="customizeStatusBar";Ca[Ca.clientWebRequests=30]="clientWebRequests";Ca[Ca.showCommentTaskPane=31]="showCommentTaskPane";Ca[Ca.applyThreadedCommentChange=32]="applyThreadedCommentChange";Ca[Ca.upgradeLegacyCommentsChange=33]="upgradeLegacyCommentsChange";Ca[Ca.findNextOrPreviousComment=34]="findNextOrPreviousComment";Ca[Ca.goto=35]="goto";Ca[Ca.launchOfficeAddInDialog=36]="launchOfficeAddInDialog";
Ca[Ca.richApiInvocation=37]="richApiInvocation";Ca[Ca.fxLibrary=38]="fxLibrary";Ca[Ca.embeddedApiSession=39]="embeddedApiSession";Ca[Ca.numberFormattingCalculator=40]="numberFormattingCalculator";Ca[Ca.requestDataAfterSend=41]="requestDataAfterSend";Ca[Ca.floatingObjectsStopwatchData=42]="floatingObjectsStopwatchData";Ca[Ca.copy=43]="copy";Ca[Ca.paste=44]="paste";Ca[Ca.dragDrop=45]="dragDrop";Ca[Ca.clearCopyState=46]="clearCopyState";Ca[Ca.webWorkerRecalcStats=47]="webWorkerRecalcStats";Ca[Ca.dataValidationEditOpenDialog=
48]="dataValidationEditOpenDialog";Ca[Ca.dataValidationEditSubmitRule=49]="dataValidationEditSubmitRule";Ca[Ca.customSort=50]="customSort";Ca[Ca.namedSheetViewUserAction=51]="namedSheetViewUserAction";Ca[Ca.namedSheetViewTeachingCallout=52]="namedSheetViewTeachingCallout";Ca[Ca.namedSheetViewTeachingDialog=53]="namedSheetViewTeachingDialog";Ca[Ca.namedSheetViewOptionsDialog=54]="namedSheetViewOptionsDialog";Ca[Ca.namedSheetViewTempViewApplyDialog=55]="namedSheetViewTempViewApplyDialog";Ca[Ca.namedSheetViewTempViewSaveDialog=
56]="namedSheetViewTempViewSaveDialog";Ca[Ca.temporaryViewStartedDataRestore=57]="temporaryViewStartedDataRestore";Ca[Ca.temporaryViewFetchedVersion=58]="temporaryViewFetchedVersion";Ca[Ca.raiseEventsAndGenerateBlockRequests=59]="raiseEventsAndGenerateBlockRequests";Ca[Ca.launchMakerCodeEditor=60]="launchMakerCodeEditor"})(ff||(ff={}));Object(re.b)("UsageTable",ff);var Ef=b(415),Qf=b(475),Vg=b(644),Kg=b(692),yh=b(263),fh=Sys.EventArgs;vm(A,fh);Object(re.a)(A,"CalculatedAverageUpdatedEventArgs",Sys.EventArgs,
[]);m.prototype.GVg=function(Ca){return new m(this.total+Ca.total,this.KJd+Ca.KJd)};m.oMg=function(Ca,ra){return String.format("{0}_{1}",Ca,ra)};tl.Object.defineProperties(m.prototype,{average:{configurable:!0,enumerable:!0,get:function(){return this.total/this.KJd}}});Object(re.a)(m,"StopwatchAverage",null,[]);var If;(function(Ca){Ca[Ca.longFrame=0]="longFrame";Ca[Ca.longGetRange=1]="longGetRange";Ca[Ca.longJsTask=2]="longJsTask";Ca[Ca.viewportCalculationLoops=3]="viewportCalculationLoops"})(If||
(If={}));Object(re.b)("UtrKpiVeto",If);v.h3a=function(Ca){return Enum.toString(If,Ca)};v.YSa="UTR";Object(re.a)(v,"KpiConstants",null,[]);u.fbg="UTRVetoName";u.Yag="UTRErrorName";u.QMj="UTROperationName";u.EWd="UTRDuration";u.RMj="UTREndedInPhase";u.cbg="UTRMessage";u.ebg="UtrUnavailabilityType";u.operationName="OperationName";u.duration="Duration";u.message="Message";Object(re.a)(u,"UtrAdditionalData",null,[]);f.aOj="VetoLike";f.keh="E2EOperationPerf";f.$8i="RequestPerf";f.yGj="UnavailabilityDurations";
Object(re.a)(f,"UtrTypes",null,[]);l.prototype.BGb=function(Ca,ra,yb){yb=void 0===yb?null:yb;af.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(yb=yb?Object.assign(new ue.a,{extendedProperties:yb}):null,Ca=v.h3a(Ca),Rc.Health.instance.recordKpiImpliedFailure("UTR_Veto_"+Ca,ra,!1,!0,"",yb))};l.prototype.cIb=function(Ca,ra,yb,Hd,ye,Cf){Cf[v.YSa]=f.aOj;Cf[u.fbg]=v.h3a(Hd);Cf[u.Yag]=ye;ae.ULS.sendTraceTag(Ca,ra,yb,bd.a.Hc(Cf));delete Cf[v.YSa];delete Cf[u.fbg];delete Cf[u.Yag]};
Object(re.a)(l,"UtrKpiVetoReporter",null,[]);n.prototype.M8i=function(Ca){var ra=null;ra=void 0===ra?null:ra;af.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||Rc.Health.instance.recordKpiUsage("UTR_Veto_Usage_"+v.h3a(Ca),0,"",ra)};n.prototype.BGb=function(Ca,ra,yb){yb=void 0===yb?null:yb;af.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(Ca=v.h3a(Ca),Rc.Health.instance.recordKpiFailure("UTR_Veto_Usage_"+Ca,ra,!1,!0,this.x1c(yb)))};n.prototype.j8i=function(Ca,
ra){ra=void 0===ra?null:ra;af.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||Rc.Health.instance.recordKpiImpliedSuccess("UTR_Veto_Usage_"+v.h3a(Ca),"",this.x1c(ra))};n.prototype.i8i=function(Ca,ra,yb){yb=void 0===yb?null:yb;af.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(Ca=v.h3a(Ca),Rc.Health.instance.recordKpiImpliedFailure("UTR_Veto_Usage_"+Ca,ra,!1,!0,"",this.x1c(yb)))};n.prototype.x1c=function(Ca){return Ca?Object.assign(new ue.a,{extendedProperties:Ca}):
null};Object(re.a)(n,"UtrKpiVetoUsageReporter",null,[]);k.prototype.nrc=function(Ca,ra,yb){yb=void 0===yb?null:yb;af.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||Rc.Health.instance.recordKpiImpliedSuccess("UTR_Perf_E2EOperation_"+Ca,"",Object.assign(new ue.a,{extendedProperties:yb,durationMs:ra}))};k.prototype.vrc=function(Ca,ra,yb){yb=void 0===yb?null:yb;af.EwaSettings.isChangeGateEnabled("OfficeVSO:5617248_DisableLegacyUTR")||(ra?Rc.Health.instance.recordKpiImpliedSuccess("UTR_Perf_Request_"+
Ca,"",Object.assign(new ue.a,{extendedProperties:yb})):Rc.Health.instance.recordKpiImpliedFailure("UTR_Perf_Request_"+Ca,"",!1,!1,"",Object.assign(new ue.a,{extendedProperties:yb})))};k.prototype.$Hb=function(Ca,ra,yb,Hd,ye,Cf,Bf,ch){for(var Tg=[],fe=7;fe<arguments.length;++fe)Tg[fe-7]=arguments[fe];Tg=String.format.apply(null,[Bf].concat(Tg));fe={};fe[v.YSa]=f.keh;fe[u.QMj]=Hd;fe[u.RMj]=ye;fe[u.EWd]=Cf;fe[u.cbg]=Tg;ae.ULS.sendTraceTag(Ca,ra,yb,bd.a.Hc(fe))};k.prototype.bIb=function(Ca,ra,yb,Hd,ye,
Cf){this.gXf(Cf,Hd,ye);ae.ULS.sendTraceTag(Ca,ra,yb,bd.a.Hc(Cf));this.I9g(Cf)};k.prototype.aIb=function(Ca,ra,yb,Hd,ye,Cf,Bf){for(var ch=[],Tg=6;Tg<arguments.length;++Tg)ch[Tg-6]=arguments[Tg];ch=String.format.apply(null,[Cf].concat(ch));Tg={};this.gXf(Tg,Hd,ye,ch);ae.ULS.sendTraceTag(Ca,ra,yb,bd.a.Hc(Tg))};k.prototype.stc=function(Ca,ra,yb,Hd){Hd[v.YSa]=f.$8i;ae.ULS.sendTraceTag(Ca,ra,yb,bd.a.Hc(Hd));delete Hd[v.YSa]};k.prototype.gXf=function(Ca,ra,yb,Hd){Hd=void 0===Hd?null:Hd;Ca[v.YSa]=f.yGj;Ca[u.ebg]=
ra;Ca[u.EWd]=yb;Hd&&(Ca[u.cbg]=Hd)};k.prototype.I9g=function(Ca){delete Ca[v.YSa];delete Ca[u.ebg];delete Ca[u.EWd]};Object(re.a)(k,"UtrOperationPerfReporter",null,[]);var eh=$f.a;vm(c,eh);c.prototype.RQd=function(Ca,ra,yb){this.rKb(Ca,ra,yb,sf.a.wAb(sf.a.Ra.Kb.getTime()))};c.prototype.rKb=function(Ca,ra,yb,Hd,ye){ye=void 0===ye?null:ye;if(this.c7[yb])throw Error.invalidOperation("The specified stopwatchId is already in use.");this.c7[yb]=this.iCe(Ca,ra,yb,Hd,ye)};c.prototype.A6c=function(Ca){this.Hrb(Ca,
sf.a.wAb(sf.a.Ra.Kb.getTime()))};c.prototype.Hrb=function(Ca,ra){var yb=this.c7[Ca];yb&&(this.sye(yb,ra),this.kIj(yb),delete this.c7[Ca])};c.prototype.HLf=function(Ca){delete this.c7[Ca]};c.prototype.f2f=function(Ca,ra){this.feb||this.X1f(Ca,ra)};c.prototype.S1f=function(){this.f2f(c.fgd,this.Pg.re)};c.prototype.EIe=function(Ca,ra){ra=void 0===ra?!1:ra;if(this.feb){if(this.sCa===c.oAd||this.sCa===c.fgd){var yb=rf.a.instance;yb.userSessionId=this.userSessionId;if(this.sCa===c.oAd){this.nre||(this.uba(Ca.m,
Object(gc.a)(yb,yb.a_i,"recordContentFetchEnd")),this.nre=!0);if(ra){this.$Cf||(this.uba(Ca.m,Object(gc.a)(yb,yb.l_i,"recordPerceivedContentDisplayed")),this.$Cf=!0);return}this.uba(Ca.m,Object(gc.a)(yb,yb.$Zi,"recordContentDisplayed"))}else this.sCa===c.fgd&&(ra=this.c7[this.FMb])&&this.uba(yh.a(Ca,ra.s),Object(gc.a)(yb,yb.i_i,"recordInteractivityContentDisplayed"),!1)}this.Hrb(this.FMb,Ca);this.FMb=this.sCa=this.feb=null}};c.prototype.uba=function(Ca,ra,yb){yb=void 0===yb?!0:yb;rf.a.mP&&Object(He.a)(Kg.PerformanceClock,
sf.a.Ra)&&yb&&(Ca+=window.performance.timing.navigationStart);ra(Ca)};c.prototype.pi=function(Ca){return Ef.a(Ca)};c.prototype.Ne=function(Ca,ra,yb){yb=void 0===yb?!1:yb;try{this.Ejf[ff[Ca]]=!0,yb&&ae.ULS.sendTraceTag(3704927,0,50,x(Ca,ra))}catch(Hd){ae.ULS.sendTraceTag(3704928,0,10,"Error when serializing usage table: {0} exception: {1}",Ca,Hd)}};c.prototype.y6c=function(Ca,ra,yb){if(this.Pnc){var Hd=this.TVa[Ca+ra];Hd&&(Hd.e=yb,this.O9c(Hd));delete this.TVa[Ca+ra]}};c.prototype.Mrd=function(Ca,
ra){ff[Ca]in this.Ejf||this.Ne(Ca,ra)};c.prototype.EQi=function(){this.Pg.appStart&&this.X1f(c.oAd,this.Pg.appStart)};c.prototype.yoi=function(Ca){var ra={};ra.a=Ca.i;ra.b=Ca.o;ra.c=Ca.t;ra.d=yh.a(Ca.s,Ca.p||this.Pg.appStart);ra.e=yh.a(Ca.e,Ca.s);ra.f=Ca.c;ra.g=Ca.a;ra.h=Ca.h;this.Ne(0,ra,this.bdi(ra.b,ra.c))};c.prototype.bdi=function(Ca,ra){return Array.contains(["CommandTask","QueuedTask","Task"],Ca)&&!Array.contains(this.Lrh,ra)?!1:!0};c.prototype.CB=function(Ca,ra,yb,Hd,ye){if(Ca&&ra){var Cf=
{};Cf.a=Ca;Cf.b=ra;Cf.c=yb.toString();Cf.d=Hd.toString();this.Ne(15,Cf,void 0===ye?!0:ye)}};c.prototype.rjf=function(Ca,ra,yb,Hd){var ye={};Ca&&(ye.c=yh.a(Ca,this.Pg.appStart));ye.b=ra;ye.a=yb;ye.d=Hd;this.Ne(17,ye)};c.prototype.dispose=function(){var Ca=this;this.NPa.execute(function(ra){ra.deactivate(!0);ra.t4i(Ca.lyf)});this.ef&&this.ef.T$a(this.IV);eh.prototype.dispose.call(this)};c.prototype.g1e=function(){return this.Ubg=this.Ubg||new t};c.prototype.iCe=function(Ca,ra,yb,Hd,ye){var Cf={};Cf.o=
Ca;Cf.t=ra;Cf.p=void 0===ye?null:ye;Cf.s=(void 0===Hd?null:Hd)||this.Pg.re;this.Ljd(Cf,void 0===yb?null:yb);return Cf};c.prototype.sye=function(Ca,ra){Ca&&(Ca.e=(void 0===ra?null:ra)||this.Pg.re,Ca.i=Ca.i||this.u_a.m7a(),Ca.c=Ca.c||this.MCe,Ca.a=Ca.a||this.TCe,Ca.h=void 0!==Ca.h&&null!==Ca.h?Ca.h:this.ef?this.ef.kj:!1,this.O9c(Ca))};c.prototype.zjf=function(Ca){var ra=Ca.context;Ca.duration>c.Odh&&(ra.methodName===tg.a.Z2a||ra.methodName===tg.a.Pua)&&this.rrc(1,c.rPh);if("GetSessionStatus"!==ra.methodName){var yb=
{};yb.a=ra.methodName;yb.b=ra.stopwatch.id;yb.c=Ca.Erc;yb.d=Ca.responseSize;yb.e=ra.Z0b;yb.f=Ca.yd?Ca.yd.StateId:tg.a.FUd;this.Ne(30,yb,!0);this.CB(yb.b,Ca.yd.ServerCorrelationId,"clientWebRequests","ServerActions")}};c.prototype.H2f=function(){if(this.Pnc){var Ca=this.TVa.LoadingUIShownSplashScreen;Ca&&Kd.PageLoadTrackingInfo.instance.Cjj(Ca.s)}};c.prototype.rrc=function(Ca,ra){this.$ag.BGb(Ca,ra,null)};c.prototype.qOf=function(Ca,ra){this.tAc.j8i(Ca,void 0===ra?null:ra)};c.prototype.pOf=function(Ca,
ra,yb){this.tAc.i8i(Ca,ra,void 0===yb?null:yb)};c.prototype.rOf=function(Ca){this.tAc.M8i(Ca)};c.prototype.sOf=function(Ca,ra){this.tAc.BGb(Ca,ra,null)};c.prototype.nrc=function(Ca,ra,yb){this.jeb.nrc(Ca,ra,void 0===yb?null:yb)};c.prototype.vrc=function(Ca,ra,yb){this.jeb.vrc(Ca,ra,void 0===yb?null:yb)};c.prototype.sendDNMTraceTag=function(Ca,ra,yb,Hd,ye){for(var Cf=[],Bf=4;Bf<arguments.length;++Bf)Cf[Bf-4]=arguments[Bf];af.EwaSettings.la(218)&&ae.ULS.sendTraceTag.apply(null,[Ca,ra,yb,Hd].concat(Cf))};
c.prototype.$Hb=function(Ca,ra,yb,Hd,ye,Cf,Bf,ch){for(var Tg=[],fe=7;fe<arguments.length;++fe)Tg[fe-7]=arguments[fe];var Ih;(Ih=this.jeb).$Hb.apply(Ih,[Ca,ra,yb,Hd,ye,Cf,Bf].concat(Tg))};c.prototype.bIb=function(Ca,ra,yb,Hd,ye,Cf){this.jeb.bIb(Ca,ra,yb,Hd,ye,Cf)};c.prototype.aIb=function(Ca,ra,yb,Hd,ye,Cf,Bf){for(var ch=[],Tg=6;Tg<arguments.length;++Tg)ch[Tg-6]=arguments[Tg];var fe;(fe=this.jeb).aIb.apply(fe,[Ca,ra,yb,Hd,ye,Cf].concat(ch))};c.prototype.cIb=function(Ca,ra,yb,Hd,ye,Cf){this.$ag.cIb(Ca,
ra,yb,Hd,ye,Cf)};c.prototype.stc=function(Ca,ra,yb,Hd){this.jeb.stc(Ca,ra,yb,Hd)};c.prototype.O9c=function(Ca){this.lyj.yoi(Ca)};c.prototype.FQi=function(){if(this.Pnc){Stw.swpc=null;var Ca=this.Pnc,ra;for(ra in Ca)this.Ljd(Ca[ra])}};c.prototype.Tuh=function(){var Ca=this,ra=window[Qf.a.namespace];if(ra){var yb=ra[Qf.a.zxe];yb&&(delete ra[Qf.a.zxe],yb.forEach(function(Hd){Ca.Ljd(Hd);Ca.O9c(Hd)}))}};c.prototype.mei=function(Ca,ra){if("about:blank"===Ca||"renamehandler.ashx"===ra&&"2"===Yf.a.tA(Ca,
"u"))return!0;for(Ca=0;Ca<this.fId.length;Ca++)if(ra.endsWith(this.fId[Ca]))return!0;return!1};c.prototype.imi=function(){var Ca=this;this.NPa.execute(function(ra){ra.di(c.CIg,0);ra.dAg(Ca.lyf);ra.activate()})};c.prototype.bmi=function(){var Ca={};Ca.a=new Date(Me.EcmaDateClock.instance.appStart.m);Ca.b=this.userSessionId;Ca.c=this.Pg.E5f;Ca.d=c.w8g*nc.devicePixelRatio;Ca.e=sf.a.Ra.appStart.m;this.Ne(14,Ca,!0);this.uba(sf.a.Ra.appStart.m,Object(gc.a)(rf.a.instance,rf.a.instance.TZi,"recordAppInitStart"))};
c.prototype.X1f=function(Ca,ra){this.feb=this.u_a.m7a();this.FMb=this.u_a.m7a();this.sCa=Ca;this.rKb("UserAction",Ca,this.FMb,ra);this.Aif(Ca,this.feb)};c.prototype.uAj=function(){var Ca=this,ra=window[Qf.a.namespace];ra&&!c.GAe&&(ra[Qf.a.jxj]=function(yb,Hd){return Ca.iCe(yb,Hd)},ra[Qf.a.mgh]=function(yb){Ca.sye(yb)},c.GAe=!0)};c.prototype.kIj=function(Ca){var ra=m.oMg(Ca.o,Ca.t),yb=new m(yh.a(Ca.e,Ca.s)),Hd=ra in this.gRd?this.gRd[ra].GVg(yb):yb;this.gRd[ra]=Hd;if(yb===Hd||yb.average!==Hd.average)Ca=
Object.assign(new A,{operation:Ca.o,target:Ca.t,ivi:Hd.average,sender:this}),this.raiseEvent(ra,Ca)};c.prototype.Aif=function(Ca,ra){var yb={};yb.a=ra;yb.b=this.userSessionId;yb.c=Ca;this.Ne(1,yb,!0)};c.prototype.l4h=function(){this.fId=["RemoteUls.ashx","GetSessionStatus",tg.a.Pua,"Collector/3.0/","CheckCollabServiceContentUpdate","UpdatePresenceUsers","GetNumberFormatCategory","GetObjectMetadata","SetCell","GetSheetProcessedData","UploadLatencyTelemetry","PollSessionStatus","GetStatusBarAggregates",
"GetRichValueFieldListContextList","GetInstantaneousSupportInformation"]};c.prototype.Ljd=function(Ca,ra){Ca.i=(void 0===ra?null:ra)||this.u_a.m7a();Ca.a=this.TCe;Ca.c=this.MCe;Ca.h=this.ef?this.ef.kj:!1};c.ja=function(Ca){var ra=new R;Ca.da.Ha(291,ra);ra=new c(Ca.ya.UserSessionId,void 0,void 0,void 0,ra,!0);ra.Aif(c.qof,ra.GDe);ae.ULS.sendTraceTag(19481687,0,50,"TelemetryManager: Activating BrowserResourceTiming Telemetry logs");ra.imi();ra.uAj();ra.EQi();ra.bmi();ra.Tuh();ra.FQi();ra.l4h();c.xhj(Ca);
sg.a.Xi.Ha(41,ra)};c.xhj=function(Ca){var ra=nc.devicePixelRatio;1<ra&&Ca.lc.tw(!0,2<=ra?8388608:4194304)};tl.Object.defineProperties(c.prototype,{c7:{configurable:!0,enumerable:!0,get:function(){return this.Wee||(this.Wee={})}},MCe:{configurable:!0,enumerable:!0,get:function(){return this.feb||this.GDe}},TCe:{configurable:!0,enumerable:!0,get:function(){return this.sCa||c.qof}},gRd:{configurable:!0,enumerable:!0,get:function(){return this.Aqe=this.Aqe||{}}},Pnc:{configurable:!0,enumerable:!0,get:function(){return this.TVa||
"undefined"===typeof Stw?this.TVa:this.TVa=Stw.swpc}},Ejf:{configurable:!0,enumerable:!0,get:function(){return this.S8d=this.S8d||{}}},NPa:{configurable:!0,enumerable:!0,get:function(){return this.bkb||(this.bkb=we.a.instance.mc("Common.NetworkTiming.IResourceTimingLogger"))}},$ag:{configurable:!0,enumerable:!0,get:function(){return this.abg||(this.abg=new l)}},jeb:{configurable:!0,enumerable:!0,get:function(){return this.dbg||(this.dbg=new k)}},tAc:{configurable:!0,enumerable:!0,get:function(){return this.bbg||
(this.bbg=new n)}}});c.qof="UnassignedUserAction";c.oAd="PageLoad";c.fgd="GridUpdateOperation";c.Odh=5E3;c.rPh="MoreThan_5000_Ms";c.w8g=96;c.CIg=30;c.GAe=!1;Object(re.a)(c,"TelemetryManager",$f.a,[720,721,722,723]);var Qh=b(188),xi=b(103);Object(re.a)(d,"Validation",null,[]);a.prototype.rSc=function(Ca,ra,yb,Hd,ye){if(Ca&&Hd){var Cf=Qh.a.Jy(ra,yb);this.gXb(function(){return!!xi.a(Ca).Hp(Cf)},Hd.StateId,ye)}};a.prototype.gXb=function(Ca,ra,yb){this.Qyg(this.mRe,Ca,ra,yb)};a.prototype.Qyg=function(Ca,
ra,yb,Hd){Ca&&ra&&yb!==tg.a.Se&&Ca.add(new d(ra,yb,Hd))};a.prototype.eDf=function(Ca){if(Ca){for(var ra=new eg.a,yb=yl(Ca),Hd=yb.next();!Hd.done;Hd=yb.next()){Hd=Hd.value;if(Hd.wU===this.$.fa.rf)try{Hd.DNj()||ae.ULS.sendTraceTag(537151010,0,15,"ValidationTelemetryManager.PerformAndRemoveValidations: Validation result is false. Validation Name: [{0}]",Hd.name)}catch(ye){ae.ULS.sendTraceTag(537151009,0,10,"ValidationTelemetryManager.PerformAndRemoveValidations: Validation has caused an exception to be thrown. Validation Name: [{0}]. Exception: [{1}]",
Hd.name,ye)}ra.add(Hd)}ra=yl(ra);for(Hd=ra.next();!Hd.done;Hd=ra.next())Ca.remove(Hd.value)}else ae.ULS.shipAssertTag(537151011,0,!!Ca,"ValidationTelemetryManager.PerformAndRemoveValidations: Validation list is null")};a.prototype.dispose=function(){jg.g(this.$)&&jg.g(this.$).Ca&&(jg.g(this.$).Ca.yq(this.Hg),jg.g(this.$).Ca.yGd(this.a8a));this.$=null};a.ja=function(Ca){var ra=new a(Ca);Ca.da.Ha(277,ra)};Object(re.a)(a,"ValidationTelemetryManager",null,[719,3]);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.BrowserInfoLogger");
ib.main();Type.registerNamespace("CNT");Ad.main();Type.registerNamespace("CACPU");Ic.main();Type.registerNamespace("Common.App.EventsCacheManager");Jb.main();(function(){Zc.a.Ga(function(Ca){Ca.da.Ha(137,new db(Ca))})})();(function(){Zc.a.Ga(function(Ca){Ca.da.Ha(37,new dc(Ca))})})();(function(){Zc.a.Ga(function(Ca){Ha.ja(Ca)})})();(function(){Zc.a.Ga(function(Ca){eb.ja(Ca)})})();(function(){Zc.a.Ga(function(Ca){Pc.ja(Ca)})})();(function(){Zc.a.Ga(function(Ca){Ca.da.Ha(40,new Ja(Ca,new mc.a(function(){return lf.GetServiceTaskFactory.create(Ca.da,
137,Ca.ma,1)})))})})();(function(){Zc.a.Ga(function(Ca){Ca.da.Ha(276,new wa(Ca))})})();(function(){Zc.a.Ga(function(Ca){sg.a.Xi.Za(135,function(){c.ja(Ca);I.ja(Ca);a.ja(Ca);r.ja(Ca);af.EwaSettings.la(415)&&Q(Ca);Y.ja(Ca);ba.ja(Ca);af.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RenderingFidelityMetric",!1)&&hd.RenderingFidelityTracker.ja(Ca)})})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.tm.js.map/1fd51e1737a66579176f907169eb8910/EwaDS.tm.js.map