(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[8],{1014:function(y,D,b){function a(){this.OKa=0;this.Wga=this.buttonText=this.description=this.title=this.id=null;this.errorCode=0;this.qcc=!1;this.J6e=this.Tha=null}b.d(D,"a",function(){return a});y=b(0);Object(y.a)(a,"AddInCommandsNotificationParameters",null,[])},1070:function(y,D,b){function a(){}function d(){}function c(Q,O,ba,ca,S,Y){Q=k.call(this,Q,O,ba,ca,S,void 0===Y?null:Y)||this;Q.OSb=null;return Q}function k(Q,O,
ba,ca,S,Y){Q=n.call(this,Q,ba,S.OW,void 0===Y?null:Y)||this;Q.G9d=0;Q.Q0=Q.vMh(ca);Q.MWa=O;Q.Ie=S;Q.rCj=7;Q.el=Q.MWa.ownerDocument.createElement("div");Q.el.className="ModalCalloutControlOverlay";Q.el.tabIndex=0;Q.MWa.insertBefore(Q.el,Q.MWa.firstChild);return Q}function n(Q,O,ba,ca){var S=A.call(this,document.createElement("div"))||this;S.dqa=null;S.Foa=null;S.WF=null;S.PF=null;S.Dw=null;S.lS=null;S.mS=null;S.qpa=!1;S.Chb=!1;S.lp=null;S.content=null;S.Q0=0;S.Hqe=null;S.sT=0;S.Ezf=null;S.xfe=Q;S.Cae=
O;S.IO=ba;S.sGa=ca;S.vg=O.ownerDocument;S.Uhb=!1;S.Gu=!1;S.ghd=!1;return S}y=b(0);var l=b(13),f=b(80),u=b(369),v=b(12),m=b(89),A=Sys.UI.Control;vm(n,A);n.prototype.show=function(){this.Uhb||(this.n1g(),this.Gj(),this.Cae.appendChild(this.OV),this.OV.style.display="Block",this.Alj(),this.Uhb=!0,this.Ezf&&this.Ezf())};n.prototype.dismiss=function(){this.Uhb&&(this.hU(),this.Cae.removeChild(this.OV),this.Uhb=!1,this.sGa&&this.sGa())};n.prototype.dispose=function(){this.dismiss();this.lS=this.Dw=this.PF=
this.Foa=this.WF=this.dqa=null;Sys.Component.prototype.dispose.call(this)};n.prototype.mi=function(Q){return this.get_element().id+Q};n.prototype.n1g=function(){this.WF=this.vg.createElement("div");this.WF.id=this.mi("WACCalloutHeader");this.WF.className="WACCalloutHeader";this.Gu&&this.Qie();this.ghd&&this.Zje();this.PF=this.vg.createElement("div");this.PF.id=this.mi("WACCalloutContent");this.PF.className="WACCalloutContent";this.PF.style.width=190<this.Q0?this.Q0-26+"px":"164px";this.PF.appendChild(this.content);
this.OV.appendChild(this.MZb);this.OV.appendChild(this.WF);this.OV.appendChild(this.PF)};n.prototype.Qie=function(){this.Dw=this.vg.createElement("a");this.Dw.className="WACCalloutCloseAnchor";this.Dw.id=this.mi("WACCalloutCloseAnchor");this.Dw.href="#";this.WF.appendChild(this.Dw);var Q=u.createClusteredImage(16,16,"ClosePaneGlyph_16x16x32","WACCalloutCloseIcon",!0,CommonUIStrings.l_DialogClose);this.Dw.appendChild(Q)};n.prototype.Zje=function(){this.lS=this.vg.createElement("div");this.lS.className=
"WACCalloutTitle UIFontBold";this.lS.style.width=190<this.Q0?this.Q0-30+"px":"160px";this.lS.id=this.mi("WACCalloutTitle");this.lS.innerText=this.title;this.WF.contains(this.Dw)?this.WF.insertBefore(this.lS,this.Dw):this.WF.appendChild(this.lS)};n.prototype.Alj=function(){var Q=this.xfe;if(1===this.sT){var O=this.Hqe.y+16;var ba=-16}else 2!==this.sT&&3!==this.sT&&this.sT?(O=Q.y-this.OV.clientHeight-15-2,ba=this.OV.clientHeight-1):(O=Q.y+Q.height+15,ba=-15);this.OV.style.top=O+"px";this.MZb.style.top=
ba+"px";1===this.sT?(Q=this.Hqe.x-16,this.OV.style.left="50%",this.OV.style.marginLeft=-this.Q0/2+"px",O=Sys.UI.DomElement.getBounds(this.OV),this.MZb.style.left=Q-O.x+"px"):(O=Q.x+this.xfe.width/2,2===this.sT||5===this.sT?(Q=20,O-=36):this.sT&&4!==this.sT?(Q=this.Q0-20-32,O=O-this.Q0+36):(Q=this.Q0/2-16,O-=this.Q0/2),this.OV.style.left=O+"px",this.MZb.style.left=Q+"px")};n.prototype.Gj=function(){this.Gu&&!this.mS&&(this.mS=Object(f.a)(this,this.V9,"closeHandler"),this.IO.pa(v.a.click,this.Dw,this.mS,
null))};n.prototype.hU=function(){this.Gu&&this.mS&&(this.IO.za(v.a.click,this.Dw,this.mS),this.mS=null)};n.prototype.V9=function(){this.dismiss();return!0};tl.Object.defineProperties(n.prototype,{OV:{configurable:!0,enumerable:!0,get:function(){this.dqa||(this.dqa=this.vg.createElement("div"),this.dqa.id=this.mi("WACCalloutOuter"),this.dqa.className="WACCalloutOuter",this.dqa.setAttribute(m.a.Sd,m.a.kYa),this.dqa.style.width=this.Q0+"px");return this.dqa}},MZb:{configurable:!0,enumerable:!0,get:function(){if(!this.Foa){this.Foa=
this.vg.createElement("div");this.Foa.id=this.mi("WACCalloutBeakContainer");this.Foa.className="WACCalloutBeakContainer";var Q="CalloutBeakTopFilled_32x16x32";if(5===this.sT||6===this.sT||4===this.sT)Q="CalloutBeakBottomFilled_32x16x32";Q=u.createClusteredImage(32,16,Q,"WACCalloutBeak",!0,"");this.Foa.appendChild(Q)}return this.Foa},set:function(Q){this.Foa=Q}},tLa:{configurable:!0,enumerable:!0,get:function(){return this.Uhb}},title:{configurable:!0,enumerable:!0,get:function(){return this.lp},set:function(Q){this.lp!==
Q&&(this.lp=Q,this.lS&&(this.lS.innerText=this.lp))}},Gu:{configurable:!0,enumerable:!0,get:function(){return this.qpa},set:function(Q){this.qpa!==Q&&(this.qpa=Q,this.WF&&(this.WF.contains(this.Dw)&&!this.qpa?this.WF.removeChild(this.Dw):!this.WF.contains(this.Dw)&&this.qpa&&this.Qie()))}},ghd:{configurable:!0,enumerable:!0,get:function(){return this.Chb},set:function(Q){this.Chb!==Q&&(this.Chb=Q,this.WF&&(this.WF.contains(this.lS)&&!this.Chb?this.WF.removeChild(this.lS):!this.WF.contains(this.lS)&&
this.Chb&&this.Zje()))}}});Object(y.a)(n,"Callout",Sys.UI.Control,[225]);vm(k,n);k.prototype.show=function(){this.tLa||(this.Ie.yEb(),this.Ie.jP(!1),this.el.style.zIndex=String(this.Ie.T1),n.prototype.show.call(this),this.ak(),this.G9d=window.setTimeout(Object(f.a)(this,this.dismiss,"dismiss"),1E3*this.rCj))};k.prototype.dismiss=function(){this.tLa&&(this.Ie.eM(!1),this.mm(),this.MWa&&this.MWa.contains(this.el)&&this.MWa.removeChild(this.el),n.prototype.dismiss.call(this),window.clearTimeout(this.G9d))};
k.prototype.ak=function(){this.Ie.cra(Object(f.a)(this,this.dismiss,"dismiss"));this.Ie.fy.pa(v.a.click,this.el,Object(f.a)(this,this.Vc,"onClick"))};k.prototype.mm=function(){this.Ie.Y$a(Object(f.a)(this,this.dismiss,"dismiss"));this.Ie.fy.za(v.a.click,this.el,Object(f.a)(this,this.Vc,"onClick"))};k.prototype.Vc=function(){this.dismiss();return!0};k.prototype.vMh=function(Q){var O=0;switch(Q){case 0:O=190;break;case 1:O=250;break;case 2:O=300;break;case 3:O=360}return O};Object(y.a)(k,"ModalCallout",
n,[]);var x=b(582),t=b(187);vm(c,k);c.prototype.show=function(){var Q=this;if(!this.tLa){var O=Object.assign(new x.a,{onShow:function(){k.prototype.show.call(Q)}});t.UISurfaces.pM().then(function(ba){var ca=ba.externalNotification();Q.OSb=ba.addNotification(ca,O);return null},function(ba){l.ULS.sendTraceTag(593352345,383,15,"Failed to GetNotificationsAPIAsync: {0}",ba);return null})}};c.prototype.dismiss=function(){var Q=this;this.tLa&&this.OSb&&(t.UISurfaces.pM().then(function(O){O.removeNotification(Q.OSb);
return Q.OSb=null},function(O){l.ULS.sendTraceTag(593352344,383,15,"Failed to GetNotificationsAPIAsync: {0}",O);return null}),k.prototype.dismiss.call(this))};Object(y.a)(c,"ReactManagedModalCallout",k,[]);var z=b(5);d.$2g=function(Q,O,ba,ca){var S=void 0===S?null:S;return z.AFrameworkApplication.sa.Pa.nH?new c(Q,O,ba,ca,z.AFrameworkApplication.sa,S):new k(Q,O,ba,ca,z.AFrameworkApplication.sa,S)};Object(y.a)(d,"ModalCalloutControlFactory",null,[]);var r=b(49),G=b(1002),w=b(595),B=b(1003),U=b(128),
N=b(87),P=b(47),ia=b(86),W=b(942),R=b(830),I=b(818);b.d(D,"a",function(){return a});a.y1c=function(Q,O,ba,ca,S,Y){a.KI&&a.KI.tLa&&a.KI.dismiss();a.KI=d.$2g(O,Q,Q,S);a.KI.content=ba;I.b(ca)||(a.KI.title=ca,a.KI.ghd=!0);Q=new Sys.UI.Bounds(0,0,N.a.j3a(),N.a.Qac());a.KI.sT=a.tEh(Q,O,a.KI.Q0,Y);a.KI.show();a.jZb&&a.jZb.sendNotification(ba.innerText,!0)};a.A1c=function(Q,O,ba,ca){ca=void 0===ca?null:ca;t.UISurfaces.pM().then(function(S){var Y=null;a.Qjb&&(S.removeNotification(a.Qjb),a.Qjb=null);var na=
S.callout(Object.assign(new G.a,{target:Q,title:O,content:ba,showCloseIcon:!0,hasDynamicSizing:!0,jumpToCalloutTargetButtonEnabled:!0,calloutProps:Object.assign(new B.a,{onDismiss:function(){S.removeNotification(Y)},directionalHint:null!=ca?ca:null})})),Z=Object.assign(new x.a,{expirationOptions:Object.assign(new w.a,{displayTimeoutSeconds:7,onExpire:function(){S.removeNotification(a.Qjb)}})});Y=a.Qjb=S.addNotification(na,Z);return null},function(S){l.ULS.sendTraceTag(593352342,383,15,"Failed to GetNotificationsAPIAsync: {0}",
S);return null})};a.Bvc=function(Q,O){O=void 0===O?null:O;a.KI&&a.KI.tLa&&a.KI.dismiss();var ba=new U.StandardDialog;ba.rRa=!1;ba.kc=0;ba.xz(r.a.mji,CommonUIStrings.l_DialogError,I.b(Q)?a.NVe():Q,O)};a.QOd=function(Q){a.KI&&a.KI.tLa&&a.KI.dismiss();l.ULS.sendTraceTag(17425951,220,10,String.format("AddinCommandsActivationError : error code {0}.",Q.errorCode));var O=I.b(Q.description)?a.NVe():Q.description,ba=new U.StandardDialog,ca=null;Q.Wga?(ba.kc=1,ba.Cc(1,Q.buttonText),ba.Kma(1)):ba.kc=0;ca=function(S){1===
S?Q.Wga():Q.Tha&&Q.Tha()};ba.rRa=!1;0===Q.OKa?ba.xz(Q.errorCode,Q.title?Q.title:CommonUIStrings.l_DialogError,O,ca):1===Q.OKa?ba.HW(Q.title?Q.title:CommonUIStrings.l_DialogWarning,O,ca):ba.cAa(Q.title?Q.title:CommonUIStrings.l_DialogInfo,O,ca)};a.tEh=function(Q,O,ba,ca){var S=ca?4:0,Y=Q.x+Q.width-O.x-O.width;O.x-Q.x+O.width/2<=ba/2?S=ca?5:2:Y+O.width/2<=ba/2&&(S=ca?6:3);return S};a.zrj=function(Q,O,ba,ca,S,Y){Y=void 0===Y?!1:Y;var na=z.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoLaunchAddinEnabled",
!1),Z=z.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SkipTeachingCalloutEnabled",!1);if(a.qWd)(O=W.a.htb(ca))&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn&&appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(O,function(pa){pa&&(na&&Z&&Y||a.A1c(pa,S,ba,5))});else if(Q)if(ca&&ca.tabs.count){ca=ca.tabs.na(0);var wa=ca.XRa[R.a.id],ma=ca.KJ.na(0).ava[R.a.id];Q.GKd(wa)&&(Q=ca.isOfficeTab?Q.cKh(wa,ma):Q.GSh(wa))&&(Q.x+Q.width/2>N.a.j3a()&&(Q=new Sys.UI.Bounds(N.a.j3a(),
Q.y+Q.height,0,0)),na&&Z&&Y||a.y1c(O,Q,a.jse(ba),S,2,0))}else l.ULS.sendTraceTag(17326355,220,50,"There is no tab or group added to ribbon !");else l.ULS.sendTraceTag(594830283,220,50,"ribbonRoot is null, preventing finding the tab or group to which the callout should point.")};a.$Zf=function(Q,O,ba,ca,S){S=void 0===S?!1:S;a.zrj(Q,O,ca.startedNode?ca.startedNode.description:String.format(CommonUIStrings.l_NewAddInLoadedContent,ba),ca,ca.startedNode?ca.startedNode.title:String.format(CommonUIStrings.l_NewAddInLoadedTitle,
ba),S)};a.yrj=function(Q,O,ba,ca){if(a.qWd)Q=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentOuterString,String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,ba,ca,CommonUIStrings.l_InsertionDialogRefresh)),a.A1c(O,Q,CommonUIStrings.l_ErrorLoadingAddInsTitle,1);else{O=P.a.vn(O);var S=CommonUIStrings.l_ErrorLoadingAddInsContentOuterString.split("{0}"),Y=document.createElement("span");Y.innerText=S[0];var na=document.createElement("span");na.innerText=String.format(CommonUIStrings.l_ErrorLoadingAddInsContentInnerString,
ba,ca,CommonUIStrings.l_InsertionDialogRefresh);na.className="UIFontBold";ba=document.createElement("span");ba.innerText=S[1];ca=document.createElement("div");Sys.UI.DomElement.addCssClass(ca,"ModalCalloutControl");ca.appendChild(Y);ca.appendChild(na);ca.appendChild(ba);a.y1c(Q,O,ca,CommonUIStrings.l_ErrorLoadingAddInsTitle,3,1)}};a.Vsj=function(Q,O){var ba=CommonUIStrings.l_InstallingCustomFunctionsErrorCalloutMsg,ca=CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg;a.qWd?a.A1c(O,ba,ca):
(O=P.a.vn(O),a.y1c(Q,O,a.jse(ca),ba,3,1))};a.jse=function(Q){var O=document.createElement("div");Sys.UI.DomElement.addCssClass(O,"ModalCalloutControl");O.innerText=Q;return O};a.NVe=function(){return CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive};tl.Object.defineProperties(a,{jZb:{configurable:!0,enumerable:!0,get:function(){return a.vea||(a.vea=ia.a.instance.Hh("Common.Utils.IAriaNotifier"))}},qWd:{configurable:!0,enumerable:!0,get:function(){return z.AFrameworkApplication.sa.Pa.Li&&
z.AFrameworkApplication.sa.Pa.nH}}});a.KI=null;a.Qjb=null;a.vea=null;Object(y.a)(a,"AddInCommandsNotificationFactory",null,[])},1079:function(y,D,b){function a(t,z,r,G,w){this.ms=t;this.AI=r;this.f1=G;this.Kd=w;this.jgb=this.AI.Gi;this.ly=this.jgb.getOsfControl(z);this.Nng=this.ly.getManifest()}function d(t,z,r,G){this._id=t;this.ms=z;this.f1=r;this.Kd=G}function c(t,z,r,G){this.Mz=!1;this._id=t;this.ms=z;this.f1=r;this.Kd=G}b.r(D);y=b(0);var k=b(13),n=b(1417),l=b(143),f=b(116),u=b(846),v=b(859),
m=b(338);c.prototype.setEnabled=function(){};c.prototype._OnAccess=function(){};c.prototype.getTypeName=function(){return"Microsoft.DynamicRibbon.RibbonButton"};c.prototype.invokePropertyGet=function(t){switch(t){case 3:return this.enabled;case 2:return this.id;case 4:return this.label}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);};c.prototype.invokePropertyGetAsync=function(t){t=this.invokePropertyGet(t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)};
c.prototype.invokePropertySet=function(t,z){switch(t){case 3:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(z,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);};c.prototype.invokePropertySetAsync=function(t,z){this.invokePropertySet(t,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};c.prototype.invokeMethod=function(t,z){switch(t){case 5:return this.kij(z);case 1:return this.LBa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);
};c.prototype.invokeMethodAsync=function(t,z){t=this.invokeMethod(t,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)};c.prototype.kij=function(t){t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");this.setEnabled(t);return null};c.prototype.LBa=function(){this._OnAccess();return null};tl.Object.defineProperties(c.prototype,{enabled:{configurable:!0,enumerable:!0,get:function(){return this.Mz},set:function(t){var z=b(1079).DynamicRibbon,r=this.Kd.OwnerAddinStoreType,
G=this.Kd.PrimaryMarketplace.MarketplaceRef,w={};w=(w.addinAssetId=Telemetry.PrivacyRules.GetAssetId(r,G,this.ms),w.ownerAddinAssetId=Telemetry.PrivacyRules.GetAssetId(r,G,this.Kd.OwnerAddinAssetId),w.ownerAddinStoreType=r,w.ribbonControlType="Button",w.toggle=t,w);l.a.sendTelemetryEvent(Object.assign(new m.a,{name:z.Kxc+"ControlUpdate",dataFields:f.a.Fk(w)}));this.Mz=t;t={};r=(t.DynamicAddinCommandsMethodDispatchId=1,t.SolutionId=this.ms,t.PrivacyCompliantSolutionId=Telemetry.PrivacyRules.GetAssetId(r,
G,this.ms),t.SourceControlId=this.id,t.MethodData=this.Mz,t);this.f1.LJ(-1014260128,r)}},id:{configurable:!0,enumerable:!0,get:function(){return this._id}},label:{configurable:!0,enumerable:!0,get:function(){return null}}});Object(y.a)(c,"RibbonButton",null,[]);d.prototype.setVisibility=function(t){var z=b(1079).DynamicRibbon,r=this.Kd.OwnerAddinStoreType,G=this.Kd.PrimaryMarketplace.MarketplaceRef,w={};w=(w.addinAssetId=Telemetry.PrivacyRules.GetAssetId(r,G,this.ms),w.ownerAddinAssetId=Telemetry.PrivacyRules.GetAssetId(r,
G,this.Kd.OwnerAddinAssetId),w.ownerAddinStoreType=r,w.ribbonControlType="Tab",w.toggle=t,w);l.a.sendTelemetryEvent(Object.assign(new m.a,{name:z.Kxc+"ControlUpdate",dataFields:f.a.Fk(w)}));z={};t=(z.DynamicAddinCommandsMethodDispatchId=2,z.SolutionId=this.ms,z.PrivacyCompliantSolutionId=Telemetry.PrivacyRules.GetAssetId(r,G,this.ms),z.StoreType=r,z.SourceControlId=this.id,z.MethodData=t,z);this.f1.LJ(-1014260128,t)};d.prototype._OnAccess=function(){};d.prototype.getTypeName=function(){return"Microsoft.DynamicRibbon.RibbonTab"};
d.prototype.invokePropertyGet=function(t){switch(t){case 2:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);};d.prototype.invokePropertyGetAsync=function(t){t=this.invokePropertyGet(t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)};d.prototype.invokePropertySet=function(t){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);};d.prototype.invokePropertySetAsync=function(t,z){this.invokePropertySet(t,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
d.prototype.invokeMethod=function(t,z){switch(t){case 3:return this.dmj(z);case 1:return this.LBa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);};d.prototype.invokeMethodAsync=function(t,z){t=this.invokeMethod(t,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)};d.prototype.dmj=function(t){t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"boolean");this.setVisibility(t);return null};d.prototype.LBa=function(){this._OnAccess();return null};
tl.Object.defineProperties(d.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}}});Object(y.a)(d,"RibbonTab",null,[]);var A=b(1122),x=b(156);b.d(D,"DynamicRibbon",function(){return a});a.prototype.executeRequestCreate=function(t){try{var z={},r=(z.addinAssetId=Telemetry.PrivacyRules.GetAssetId(this.Kd.OwnerAddinStoreType,this.Kd.PrimaryMarketplace.MarketplaceRef,this.ms),z.ownerAddinAssetId=Telemetry.PrivacyRules.GetAssetId(this.Kd.OwnerAddinStoreType,this.Kd.PrimaryMarketplace.MarketplaceRef,
this.Kd.OwnerAddinAssetId),z.ownerAddinStoreType=this.Kd.OwnerAddinStoreType,z.ribbonControlType="Ribbon",z);l.a.sendTelemetryEvent(Object.assign(new m.a,{name:a.Kxc+"ExecuteRequestCreate",dataFields:f.a.Fk(r)}));var G=x.a.li(t);t={};z={};z[u.a.$Ha]=this.ly;z[u.a.aIa]=G;z[u.a.Q5c]=this.Kd;t[u.a.vrb]=3;t[u.a.u3]=this.ms;t[u.a.K5b]=Telemetry.PrivacyRules.GetAssetId(this.Kd.OwnerAddinStoreType,this.Kd.PrimaryMarketplace.MarketplaceRef,this.ms);t[u.a.t3]=z;this.f1.LJ(-1014260128,t);var w=a.h9b("ExecuteRequestCreate",
!0,"");k.ULS.sendTraceTag(538572826,0,50,w)}catch(B){G=a.h9b("ExecuteRequestCreate",!1,B.toString()),k.ULS.sendTraceTag(538572825,0,50,G)}return null};a.prototype.executeRequestUpdate=function(t){try{var z=null,r=null;z=this.Kd.OwnerAddinStoreType;r=this.Kd.PrimaryMarketplace.MarketplaceRef;var G={},w=(G.addinAssetId=Telemetry.PrivacyRules.GetAssetId(z,r,this.ms),G.ownerAddinAssetId=Telemetry.PrivacyRules.GetAssetId(z,r,this.Kd.OwnerAddinAssetId),G.ownerAddinStoreType=this.Kd.OwnerAddinStoreType,
G.ribbonControlType="Ribbon",G);l.a.sendTelemetryEvent(Object.assign(new m.a,{name:a.Kxc+"ExecuteRequestUpdate",dataFields:f.a.Fk(w)}));var B=x.a.li(t);t={};G={};G[u.a.$Ha]=this.ly;G[u.a.aIa]=B;G[u.a.Q5c]=this.Kd;t[u.a.vrb]=3;t[u.a.u3]=this.ms;t[u.a.K5b]=Telemetry.PrivacyRules.GetAssetId(z,r,this.ms);t[u.a.t3]=G;this.f1.LJ(-1014260128,t);var U=a.h9b("ExecuteRequestUpdate",!0,"");k.ULS.sendTraceTag(538572824,0,50,U)}catch(N){z=a.h9b("ExecuteRequestUpdate",!1,N.toString()),k.ULS.sendTraceTag(538572823,
0,50,z)}return null};a.prototype.getButton=function(t){var z=null;if(!this.S$e())return this.pAe();if(t&&0<t.length){if(!this.Cve(t))return this.IAe(t);z=new c(t,this.ms,this.f1,this.Kd)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(z)};a.prototype.getTab=function(t){var z=null;if(!this.S$e())return this.pAe();if(this.ly.getOwnerAddinControlRecreated())return this.n2g();if(t&&0<t.length){if(!this.Cve(t))return this.IAe(t);z=new d(t,this.ms,this.f1,this.Kd)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(z)};
a.prototype._OnAccess=function(){};a.prototype.getTypeName=function(){return"Microsoft.DynamicRibbon.DynamicRibbon"};a.prototype.invokePropertyGet=function(t){switch(t){case 4:return this.buttons}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);};a.prototype.invokePropertyGetAsync=function(t){t=this.invokePropertyGet(t);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)};a.prototype.invokePropertySet=function(t){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);
};a.prototype.invokePropertySetAsync=function(t,z){this.invokePropertySet(t,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};a.prototype.invokeMethod=function(t){switch(t){case 1:return this.LBa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(t);};a.prototype.invokeMethodAsync=function(t,z){switch(t){case 7:return this.ash(z);case 6:return this.bsh(z);case 3:return this.cEh(z);case 5:return this.FSh(z)}t=this.invokeMethod(t,z);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(t)};
a.prototype.ash=function(t){t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return this.executeRequestCreate(t)};a.prototype.bsh=function(t){t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return this.executeRequestUpdate(t)};a.prototype.cEh=function(t){t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");return this.getButton(t)};a.prototype.FSh=function(t){t=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(t,0,"string");
return this.getTab(t)};a.prototype.LBa=function(){this._OnAccess();return null};a.prototype.IAe=function(t){return A.a(v.a.RYg,x.a.ea(1714)+t)};a.prototype.pAe=function(){return A.a(v.a.qaj,x.a.ea(1710))};a.prototype.n2g=function(){return A.a(v.a.hostRestartNeeded,x.a.ea(1715))};a.prototype.S$e=function(){var t=this.ly.getSharedRuntimeId();t=!!t&&0<t.length;k.ULS.sendTraceTag(538572822,0,15,String.format("IsDynamicRibbonApiAvailable check. hasSharedRuntimeId:{0}.",t));return t};a.prototype.Cve=function(t){var z=
this.Nng.getRibbonExtensionControlMap();return t in z||this.rSg(t)};a.prototype.rSg=function(t){var z=this.Lvh();if(z){z=yl(z.hHe.tabs);for(var r=z.next();!r.done;r=z.next()){r=r.value;if(r.id===t)return!0;r=yl(r.groups);for(var G=r.next();!G.done;G=r.next()){G=yl(G.value.controls);for(var w=G.next();!w.done;w=G.next()){w=w.value;if(w.id===t)return!0;if("Menu"===w.type){w=yl(w.items);for(var B=w.next();!B.done;B=w.next())if(B.value.id===t)return!0}}}}}return!1};a.prototype.Lvh=function(){return n.a.getInstance().L3(this.Kd.PrimaryMarketplace.MarketplaceType,
this.Kd.PrimaryMarketplace.SolutionId,1)};a.h9b=function(t,z,r){var G={};G.methodName="DynamicRibbon."+t;G.result=z?"Succeeded":"Failed";G.message=r;return x.a.Hc(G)};tl.Object.defineProperties(a.prototype,{buttons:{configurable:!0,enumerable:!0,get:function(){return null}}});a.Kxc="Office.Online.Extensibility.Ribbon.";Object(y.a)(a,"DynamicRibbon",null,[])},1100:function(y,D,b){function a(){}b.d(D,"a",function(){return a});y=b(0);a.n7b="extId";a.wye="ComponentType";a.GGa="ComponentId";a.bid="HostProps";
a.iya="OptionalProps";Object(y.a)(a,"ActionPropertyNames",null,[])},1119:function(y,D,b){function a(d,c){var k=!1;d&&(d=c.osfControl,(c=d.getManifest())&&c.getSharedRuntimeForCustomFunctions("Workbook")&&!d.getIsUpgrading()&&(k=!0));return k}b.d(D,"a",function(){return a})},1121:function(y,D,b){function a(){this.token=null;this.errorCode=0;this.expiresOn=this.Iga=this.mSa=this.Zcd=this.rfd=this.Tub=this.ySd=null}b.d(D,"a",function(){return a});y=b(0);Object(y.a)(a,"AppsForOfficeOauthResult",null,
[])},1122:function(y,D,b){function a(d,c){return OfficeExtension.WacRuntime.Utility.createPromise(function(k,n){n(OfficeExtension.WacRuntime.Utility.createRichApiException(d,c))})}b.d(D,"a",function(){return a})},1237:function(y,D,b){function a(da,ya,hb){this.$va=!1;this.zE={};this.$=da;this.rh=ya;this.ckd().tma();this.indexedDB=hb;this.indexedDB.og()&&(this.$va=!0,this.indexedDB.initialize(a.fjd,a.gjd))}function d(da,ya){this.KOc=da;this._message=ya}function c(){}function k(){}function n(da){switch(da){case 0:return"Medium";
case 1:return"Unexpected";case 2:return"Verbose";default:return""}}function l(da,ya){x(b(1237).CustomFunctionsInstaller.QXe("CustomFunctionsRuntimeLogging"),function(hb){if(hb.result&&window.console)switch(hb=n(da.severity)+" "+da.message+ya,da.severity){case 2:window.console.log&&window.console.log(hb);break;case 0:window.console.info&&window.console.info(hb);break;case 1:window.console.error&&window.console.error(hb)}return!0},"CustomFunctionsInstaller::LogEvent failed due to GetLocalCacheItemSafeFromLocalStorage failed")}
function f(da,ya,hb,Gb,Qb){hb=da.CWCT(function(){ya(da)},hb,3,Gb);hb.continueWith(function(){U.ULS.sendTraceTag(537163459,0,10,Qb)},4);return hb}function u(da,ya,hb){return f(da,ya,na.a.none,Z.a.current,hb)}function v(da,ya,hb,Gb,Qb){hb=da.CWRCT(function(){return ya(da)},hb,3,Gb);hb.continueWith(function(){U.ULS.sendTraceTag(537163460,0,10,Qb)},4);return ba.TaskExtensions.izc(hb)}function m(da,ya,hb){return v(da,ya,na.a.none,Z.a.current,hb)}function A(da,ya,hb,Gb,Qb){hb=da.CWRCT(function(){return ya(da)},
hb,3,Gb);hb.continueWith(function(){U.ULS.sendTraceTag(537163461,0,10,Qb)},4);return hb}function x(da,ya,hb){return A(da,ya,na.a.none,Z.a.current,hb)}function t(da,ya,hb,Gb,Qb){hb=da.CWRCT(function(){return ya(da)},hb,3,Gb);hb.continueWith(function(){U.ULS.sendTraceTag(537163462,0,10,Qb)},4);return ba.TaskExtensions.izc(hb)}function z(da,ya,hb){return t(da,ya,na.a.none,Z.a.current,hb)}function r(da,ya,hb,Gb,Qb){hb=da.CWCT(function(){ya(da)},hb,3,Gb);hb.continueWith(function(){U.ULS.sendTraceTag(537163463,
0,10,Qb)},4);return hb}function G(da,ya,hb){return r(da,ya,na.a.none,Z.a.current,hb)}function w(){}function B(da){da=da.split("|");this.ms=da[1];this.pPc=da[2];this.lRd=da[3]}b.r(D);y=b(0);var U=b(13),N=b(5),P=b(139),ia=b(185),W=b(84),R=b(519),I=b(163),Q=b(81),O=b(56),ba=b(35),ca=b(222),S=b(126),Y=b(554);tl.Object.defineProperties(B.prototype,{solutionId:{configurable:!0,enumerable:!0,get:function(){return this.ms}},solutionVersion:{configurable:!0,enumerable:!0,get:function(){return this.pPc}},needToRestoreManifest:{configurable:!0,
enumerable:!0,get:function(){return this.lRd===OSF.StoreTypeEnum.Registry.toString()}}});Object(y.a)(B,"AddinStoreInfo",null,[]);Object(y.a)(w,"CustomFunctionRegistrationInfos",null,[]);var na=b(200),Z=b(60),wa=b(1119);Object(y.a)(k,"InstallationInfo",null,[]);Object(y.a)(c,"UninstallationInfo",null,[]);var ma=b(26),pa=b(92),Ia=b(32),Ma=b(27),ob=b(1),Cb=b(19),Xa=b(273),Sb=b(913),Tb=b(55);tl.Object.defineProperties(d.prototype,{severity:{configurable:!0,enumerable:!0,get:function(){return this.KOc}},
message:{configurable:!0,enumerable:!0,get:function(){return this._message}}});Object(y.a)(d,"CustomFunctionLog",null,[]);b.d(D,"CustomFunctionsInstaller",function(){return a});a.prototype.D8e=function(da,ya,hb,Gb){var Qb=this;if(Gb.invariantNamespace)for(var Fb=0;Fb<Gb.invariantNamespace.length;++Fb){var ta=Gb.invariantNamespace.charAt(Fb);if("."!==ta&&"_"!==ta&&"a">ta&&"z"<ta&&"A">ta&&"Z"<ta&&"0">ta&&"9"<ta)throw U.ULS.sendTraceTag(537163552,0,10,"CustomFunctionsInstaller::InstallAsync: InvariantNamespace validation failed. Character='{0}', Position={1}.",
ta,Fb),Error.create("InvariantNamespace validation failed");}return z(this.IOg(hb,Gb.manifest),function(){return z(Qb.lEd(da),function(xa){var sa=xa.result;return(null===sa||void 0===sa?0:sa.isDynamicMetadata)?Qb.qFd(da,ya,sa,!1,!1,!1):z(Qb.ZPj(da,ya,Gb),function(lb){var Yb;sa=(Yb=new k,Yb.addinId=hb,Yb.locale=Gb.locale,Yb.addinInvariantNamespace=Gb.invariantNamespace,Yb.addinNamespace=Gb.namespace,Yb.addinTitle=Gb.title,Yb.isXllCompatible=Gb.isXllCompatible,Yb.metadataContent=JSON.stringify(JSON.parse(lb.result)),
Yb);return Qb.qFd(da,ya,sa,!1,a.cth(Gb.osfControl.getStoreType()),wa.a(Qb.$,Gb))},"CustomFunctionsInstaller::InstallAsync failed due to XhrGetMetadataAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to ReadInstallationInfoAsync failed")},"CustomFunctionsInstaller::InstallAsync failed due to CacheManifestAsync failed")};a.prototype.F8e=function(da,ya,hb,Gb){var Qb=this;if(!a.epd(hb))throw U.ULS.sendTraceTag(537163551,0,10,"CustomFunctionsInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),
Error.create("Invalid Metadata JSON");return z(this.lEd(da),function(Fb){Fb=Fb.result;if(!Fb&&(Fb=Ia.a.Ec(Qb.eV,da),!Fb))throw U.ULS.sendTraceTag(537163550,0,10,String.format("CustomFunctionsInstaller::InstallDynamicFunctionsAsync: Unexpected error, the addin with solutionId {0} hasn't been installed yet.",Telemetry.PrivacyRules.GetAssetId(ya,null,da))),Error.create("Customfunctions dynamic registration failed");Fb.metadataContent=JSON.stringify(JSON.parse(hb));Fb.isDynamicMetadata=!0;return Qb.qFd(da,
ya,Fb,!0,!0,Gb)},"CustomFunctionsInstaller::InstallDynamicFunctionsAsync failed due to ReadInstallationInfoAsync failed")};a.prototype.m8f=function(da,ya){var hb=this;this.rh.cia();var Gb=Object.assign(new c,{solutionId:da}),Qb=String.format("CustomFunctionsInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: {0}.",Telemetry.PrivacyRules.GetAssetId(ya,null,da));return z(this.aGd(da),function(){return z(hb.hGd(da),function(){return hb.PUd(hb.rh,da,ya,Gb)},"CustomFunctionsInstaller.UninstallAsync failed due to RemoveManifestAsync failed")},
Qb)};a.prototype.ZPj=function(da,ya,hb){var Gb=new P.a;OSF.OUtil.xhrGet(hb.metadataUrl,function(Qb){Qb?Gb.setResult(Qb):Gb.setException(Error.create("Invalid manifest"))},function(Qb){U.ULS.sendTraceTag(537163548,0,10,"CustomFunctionsInstaller.XhrGetMetadataAsync: Failed to download Custom Functions metadata for solution {0}. ErrorCode: {1}.",Telemetry.PrivacyRules.GetAssetId(ya,null,da),Qb);Gb.setException(Error.create("Failed to download manifest"))});return Gb.task};a.prototype.ckd=function(){var da=
this;return z(this.rpc(),function(ya){var hb=ya.result;if(!hb.length)return Tb.Task.Ta(!0);U.ULS.sendTraceTag(537163547,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");ya=new ia.a;for(var Gb=[],Qb={},Fb=0;Fb<hb.length;Qb={aOb:Qb.aOb},Fb++)Qb.aOb=Object(W.a)(String,hb[Fb]),ya.add(x(da.lEd(Qb.aOb),function(ta){return function(xa){if(xa=xa.result){var sa=Ia.a.Ec(da.zE,xa.addinId);sa&&sa===xa.metadataContent||(da.zE[xa.addinId]=xa.metadataContent,
da.eV[ta.aOb]=xa,Array.add(Gb,xa))}return!0}}(Qb),"CustomFunctionsInstaller::InstallFromCacheAsync failed due to ReadInstallationInfoAsync failed"));return m(Tb.Task.WAE(ya),function(){if(Gb.length){var ta,xa=(ta=new w,ta.registrationInfos=Gb,ta);return da.LZb(da.rh,hb,xa)}U.ULS.sendTraceTag(537163546,0,50,"CustomFunctionsInstaller.InstallFromCacheAsync: There is no custom function to register from cache");return Tb.Task.Ta(!0)},"CustomFunctionsInstaller::InstallFromCacheAsync failed due to getInstallationInfoTasks failed")},
"CustomFunctionsInstaller::InstallFromCacheAsync failed")};a.prototype.G8e=function(){var da=this,ya=new P.a;new ia.a;var hb=[],Gb=[];Object.keys(this.eV).forEach(function(Qb){Qb=Object(W.a)(String,Qb);var Fb=Ia.a.Ec(da.eV,Qb);Array.add(hb,Fb);Array.add(Gb,Qb)});if(!Gb.length)return ya.setResult(!0),ya.task;ya=Object.assign(new w,{registrationInfos:hb});return this.LZb(this.rh,Gb,ya)};a.prototype.rpc=function(){return x(this.tdd(Y.a.QXa),function(da){da=da.result;return Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(da||
"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(da||"[]"):null},"CustomFunctionsInstaller::ReadSolutionIdsLowerCaseAsync failed due to GetLocalCacheItemSafeAsync failed")};a.prototype.Ocg=function(da){return this.oMd(Y.a.QXa,Sys.Serialization.JavaScriptSerializer.serialize(da))};a.prototype.lEd=function(da){return z(this.tdd(Y.a.N2a(da)),function(ya){ya=ya.result||"";return 0<ya.length?Tb.Task.Ta(Sys.Serialization.JavaScriptSerializer.deserialize(ya,!0)):Tb.Task.Ta(null)},"CustomFunctionsInstaller::ReadInstallationInfoAsync failed due to GetLocalCacheItemSafeAsync failed")};
a.prototype.SPj=function(da,ya){var hb=this;return z(this.OIe(da),function(){return z(hb.oMd(Y.a.N2a(da),Sys.Serialization.JavaScriptSerializer.serialize(ya)),function(){return a.pMd(Y.a.Wgd,"true")},"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to SetLocalCacheItemSafeAsync failed")},"CustomFunctionsInstaller::WriteInstallationInfoAsync failed due to EnsureCacheEntryForAddinAsync failed")};a.prototype.aGd=function(da){var ya=this;return z(this.bLf(da),function(){return z(ya.tLf(Y.a.N2a(da)),
function(){return z(ya.rpc(),function(hb){return hb.result.length?Tb.Task.Ta(!0):a.pMd(Y.a.Wgd,"false")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due update ReadSolutionIdsLowerCaseAsync failed")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveLocalCacheItemSafeAsync failed")},"CustomFunctionsInstaller::RemoveInstallationInfoAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")};a.prototype.IIf=function(da){return this.tdd(Y.a.M2a(da))};a.prototype.Lcg=
function(da,ya){var hb=this;return z(this.OIe(da),function(){return hb.oMd(Y.a.M2a(da),ya)},"CustomFunctionsInstaller::WriteManifestAsync failed due to EnsureCacheEntryForAddinAsync failed")};a.prototype.hGd=function(da){var ya=this;return z(this.bLf(da),function(){return ya.tLf(Y.a.M2a(da))},"CustomFunctionsInstaller::RemoveManifestAsync failed due to RemoveCacheEntryForAddinSafeAsync failed")};a.prototype.OIe=function(da){var ya=this;return z(this.rpc(),function(hb){hb=hb.result;var Gb=da.toLowerCase();
if(Array.contains(hb,Gb))return Tb.Task.Ta(!0);hb.push(Gb);return ya.Ocg(hb)},"CustomFunctionsInstaller::EnsureCacheEntryForAddinAsync failed due to ReadSolutionIdsLowerCaseAsync failed")};a.prototype.bLf=function(da){var ya=this;return z(this.rpc(),function(hb){hb=hb.result;var Gb=da.toLowerCase();return Array.contains(hb,Gb)?(hb.splice(Array.indexOf(hb,Gb),1),ya.Ocg(hb)):Tb.Task.Ta(!0)},"CustomFunctionsInstaller::RemoveCacheEntryForAddinSafeAsync failed due to ReadSolutionIdsLowerCaseAsync failed")};
a.prototype.IOg=function(da,ya){if(ob.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix"))return da=new OSF.AddinIdInfo(da),da.needToRestoreManifest()?this.Lcg(da.getSolutionId(),ya):Tb.Task.Ta(!0);da=new B(da);return da.needToRestoreManifest?this.Lcg(da.solutionId,ya):Tb.Task.Ta(!0)};a.prototype.P$i=function(da){var ya=this;if(ob.EwaSettings.isChangeGateEnabled("OfficeVSO:5024811_AddinIdInfoDevCatalogCrashFix")){var hb=new OSF.AddinIdInfo(da);return hb.needToRestoreManifest()?
x(this.IIf(hb.getSolutionId()),function(Qb){(Qb=Qb.result)&&OSF.OsfManifestManager.cacheManifestFromXml(hb.getSolutionId(),hb.getSolutionVersion(),Qb,ya.$.ya.UICultureTag);return!0},"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):Tb.Task.Ta(!0)}var Gb=new B(da);return Gb.needToRestoreManifest?x(this.IIf(Gb.solutionId),function(Qb){(Qb=Qb.result)&&OSF.OsfManifestManager.cacheManifestFromXml(Gb.solutionId,Gb.solutionVersion,Qb,ya.$.ya.UICultureTag);return!0},
"CustomFunctionsInstaller::RestoreManifestAsync failed due to ReadManifestAsync failed"):Tb.Task.Ta(!0)};a.prototype.tLf=function(da){return this.$va?this.indexedDB.z4c(da):a.Z2i(da)};a.prototype.oMd=function(da,ya){return this.$va?this.indexedDB.Rab(new Sb.a(da,ya)):a.pMd(da,ya)};a.prototype.tdd=function(da){return this.$va?this.indexedDB.CJa(da):a.QXe(da)};a.prototype.qFd=function(da,ya,hb,Gb,Qb,Fb){var ta=this,xa=String.format("CustomFunctionsInstaller.RegisterFunctionsAsync: Failed to register Custom Functions for solution: {0}.",
Telemetry.PrivacyRules.GetAssetId(ya,null,da));return ba.TaskExtensions.izc(x(this.rFd(this.rh,da,ya,hb,!1,Gb,Fb),function(){return Qb?ta.SPj(da,hb):Tb.Task.Ta(!0)},xa))};a.prototype.rFd=function(da,ya,hb,Gb,Qb,Fb,ta){var xa=this;if(!Fb&&(Fb=Ia.a.Ec(this.zE,Gb.addinId))&&Fb===Gb.metadataContent)return Tb.Task.Ta(!0);this.zE[Gb.addinId]=Gb.metadataContent;this.eV[ya]=Gb;ta||da.PFb(ya);da.cia();return z(this.F0i(ya,hb,Gb),function(){return xa.ZCd(Gb.addinId,Qb)},"Failed to register functions for customfunction addin")};
a.prototype.F0i=function(da,ya,hb){var Gb=this,Qb=new P.a,Fb=this.aob(hb);return this.kia(function(ta){ob.EwaSettings.la(257)&&l(a.Aqb,da);(ta=ta.Result)&&204===ta.ResponseStatusCode?Qb.setResult(!0):(delete Gb.zE[hb.addinId],delete Gb.eV[da],G(Gb.aGd(da),function(){G(Gb.hGd(da),function(){Gb.k_f()},"Failed to show customfunctions installation error info")},String.format("CustomFunctionsInstaller: Failed to register Custom Functions for solution: {0}. Received status code {1}.",da,ta?ta.ResponseStatusCode.toString():
"Unknown")),Qb.setResult(!1))},function(ta){ta=S.a.yg(ta.data);U.ULS.sendTraceTag(537163544,0,10,"CustomFunctionsInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}. Errors: {1}.",Telemetry.PrivacyRules.GetAssetId(ya,null,da),Ma.a.Uc(ta));ob.EwaSettings.la(257)&&l(a.zqb,da);delete Gb.zE[hb.addinId];delete Gb.eV[da];Qb.setResult(!1)},Fb,Qb,!0)};a.prototype.LZb=function(da,ya,hb){var Gb=this,Qb=new P.a,Fb=ma.a.Ra.re.m;ya.forEach(function(xa){xa=Object(W.a)(String,
xa);da.gve(xa)});da.cia();var ta=this.SWc(hb);return this.kia(function(xa){ob.EwaSettings.la(257)&&l(a.Aqb,Sys.Serialization.JavaScriptSerializer.serialize(ya));xa=xa.Result;var sa=!0,lb=Sys.Serialization.JavaScriptSerializer.deserialize(xa.ResponseBody.toString());lb=Array.isArray(lb.value)?lb.value:null;for(var Yb=new ia.a,Fa={mea:0};Fa.mea<lb.length;Fa={mea:Fa.mea},Fa.mea++)if(!lb[Fa.mea]){sa=!1;var Sa=String.format("CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Received status code {0}.",
xa.ResponseStatusCode);Yb.add(z(Gb.aGd(ya[Fa.mea]),function(Ra){return function(){delete Gb.zE[hb.registrationInfos[Ra.mea].addinId];delete Gb.eV[ya[Ra.mea]];return Gb.hGd(ya[Ra.mea])}}(Fa),Sa))}u(Tb.Task.WAE(Yb),function(){G(Gb.ZCd("",!1),function(){U.ULS.sendTraceTag(537163542,0,50,"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync takes {0} Millisecond.",ma.a.Ra.re.m-Fb);sa?Qb.setResult(sa):u(Gb.k_f(),function(){Qb.setResult(sa)},"Failed to show customfunctions installation error info")},
String.format("CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"))},"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to get registration information")},function(xa){xa=S.a.yg(xa.data);U.ULS.sendTraceTag(537163541,0,10,"CustomFunctionsInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions. Errors: {0}.",Ma.a.Uc(xa));ob.EwaSettings.la(257)&&l(a.zqb,Sys.Serialization.JavaScriptSerializer.serialize(ya));
for(xa=0;xa<hb.registrationInfos.length;xa++)delete Gb.zE[hb.registrationInfos[xa].addinId],delete Gb.eV[ya[xa]];Qb.setResult(!1)},ta,Qb,!0)};a.prototype.PUd=function(da,ya,hb,Gb){var Qb=this;return z(this.kHj(da,ya,hb,Gb),function(){return Qb.ZCd(Gb.solutionId,!1)},"Failed to unregister functions for customfunction addin")};a.prototype.kHj=function(da,ya,hb,Gb){var Qb=new P.a;da.PFb(ya);(da=Ia.a.Ec(this.eV,ya))&&delete this.zE[da.addinId];delete this.eV[ya];Gb=this.cXc(Gb);return this.kia(function(){ob.EwaSettings.la(257)&&
l(a.x3c,ya);Qb.setResult(!0)},function(Fb){Fb=S.a.yg(Fb.data);U.ULS.sendTraceTag(537163539,0,10,"CustomFunctionsInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}. Errors: {1}.",Telemetry.PrivacyRules.GetAssetId(hb,hb,ya),Ma.a.Uc(Fb));ob.EwaSettings.la(257)&&l(a.w3c,ya);Qb.setResult(!1)},Gb,Qb,!1)};a.prototype.kia=function(da,ya,hb,Gb,Qb){function Fb(){function Fa(Lb,Ja,xb){ob.EwaSettings.la(257)&&l(Qb?a.v3c:a.y3c,Sa.RequestBody);return Q.i(xa.ta,"ExecuteRichApiRequest",
hb,Xa.b(Lb,da),Xa.a(Ja,ya),xb,null,0)}if(ta.MGa()||0<xa.ta.I3||0<xa.Ek.I3)return!1;sa&&ta.pz(sa);lb&&xa.Lt(lb);Yb&&xa.VC(Yb);var Sa=hb.request,Ra=0;ob.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?Sa.RequestFlags&1&&256!==(Sa.RequestFlags&256)||(Ra=16):Ra=Sa.RequestFlags&1?0:16;ob.EwaSettings.tc()?ta.tt(new I.a(507,0,Fa,Ra|64)):ta.tt(new R.a(507,0,Fa,Ra));return!0}var ta=this.$.userOperationManager,xa=this.$.qa,sa=null,lb=null,Yb=null;Fb()||(sa=function(){Fb()},
lb=function(){Fb()},Yb=function(){Fb()},ta.uy(sa),xa.us(lb),xa.FB(Yb));return Gb.task};a.prototype.aob=function(da){var ya={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};ya.RequestBody=JSON.stringify(da);ya.RequestFlags=1;ob.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(ya.RequestFlags|=256);da=this.$.qa.ta.Oa(1);da.request=ya;return da};a.prototype.SWc=function(da){var ya={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",
RequestHeaders:null};ya.RequestBody=JSON.stringify(da);ya.RequestFlags=1;ob.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(ya.RequestFlags|=256);da=this.$.qa.ta.Oa(1);da.request=ya;return da};a.prototype.cXc=function(da){var ya={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};ya.RequestBody=JSON.stringify(da);ya.RequestFlags=1;ob.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(ya.RequestFlags|=
256);da=this.$.qa.ta.Oa(1);da.request=ya;return da};a.prototype.ZCd=function(da,ya){var hb=this,Gb=O.GetServiceTaskFactory.create(this.$.da,153,this.$.ma,1);return t(Gb,function(){Gb.result.jId();return da&&ya?hb.P$i(da):Tb.Task.Ta(!0)},this.$.ma,ca.a.instance,"CustomFunctionsInstaller::ProcessPostRegistrationActionsAsync failed due to create IFunctionInfoManager failed")};a.prototype.k_f=function(){var da=new pa.a(1949669462,0,this.$.ed,0,null);return this.$.Ka.Zb(da)};a.QXe=function(da){try{return Tb.Task.Ta(localStorage.getItem(da))}catch(ya){return U.ULS.sendTraceTag(537163537,
0,50,"CustomFunctionsInstaller.GetLocalCacheItemSafe: Failed to get data from the localStorage. Reason: {0}",ya.message||"Unknown"),Tb.Task.Ta(null)}};a.pMd=function(da,ya){try{return localStorage.setItem(da,ya),Tb.Task.Ta(!0)}catch(hb){return U.ULS.sendTraceTag(537163536,0,50,"CustomFunctionsInstaller.SetLocalCacheItemSafe: Failed to set data into the localStorage. Reason: {0}",hb.message||"Unknown"),Tb.Task.Ta(!1)}};a.Z2i=function(da){try{return localStorage.removeItem(da),Tb.Task.Ta(!0)}catch(ya){return U.ULS.sendTraceTag(537163535,
0,50,"CustomFunctionsInstaller.RemoveLocalCacheItemSafeAsync: Failed to set data into the localStorage. Reason: {0}",ya.message||"Unknown"),Tb.Task.Ta(!1)}};a.cth=function(da){return Cb.a.equals(da,"registry",!0)||Cb.a.equals(da,"uploadfiledevcatalog",!0)||N.AFrameworkApplication.userNameUnknown||N.AFrameworkApplication.limitedEdit};a.epd=function(da){if(!da)return!1;try{JSON.parse(da)}catch(ya){return!1}return!0};tl.Object.defineProperties(a.prototype,{eV:{configurable:!0,enumerable:!0,get:function(){return this.rh.eV}}});
a.fjd="CustomFunctionCache";a.gjd="CustomFunction";a.v3c=new d(2,"CustomFunctions [Registration] [Begin] SolutionId=");a.Aqb=new d(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");a.zqb=new d(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");a.y3c=new d(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");a.x3c=new d(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");a.w3c=new d(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(y.a)(a,
"CustomFunctionsInstaller",null,[798])},1239:function(y,D,b){function a(ca){this.zE={};this.$=ca;this.ckd().tma()}function d(ca,S){this.KOc=ca;this._message=S}function c(){}function k(){}function n(ca){switch(ca){case 0:return"Medium";case 1:return"Unexpected";case 2:return"Verbose";default:return""}}function l(ca,S){if(b(1239).CustomFunctionsLegacyInstaller.lub("CustomFunctionsRuntimeLogging")&&window.console)switch(S=n(ca.severity)+" "+ca.message+S,ca.severity){case 2:window.console.log&&window.console.log(S);
break;case 0:window.console.info&&window.console.info(S);break;case 1:window.console.error&&window.console.error(S)}}function f(){}function u(ca){ca=ca.split("|");this.ms=ca[1];this.pPc=ca[2];this.lRd=ca[3]}b.r(D);y=b(0);var v=b(13),m=b(1070),A=b(139),x=b(84),t=b(519),z=b(163),r=b(81),G=b(56),w=b(35),B=b(126),U=b(554),N=b(1119);tl.Object.defineProperties(u.prototype,{solutionId:{configurable:!0,enumerable:!0,get:function(){return this.ms}},solutionVersion:{configurable:!0,enumerable:!0,get:function(){return this.pPc}},
needToRestoreManifest:{configurable:!0,enumerable:!0,get:function(){return this.lRd===OSF.StoreTypeEnum.Registry.toString()}}});Object(y.a)(u,"AddinStoreInfo",null,[]);Object(y.a)(f,"CustomFunctionRegistrationInfos",null,[]);Object(y.a)(k,"InstallationInfo",null,[]);Object(y.a)(c,"UninstallationInfo",null,[]);var P=b(147),ia=b(32),W=b(27),R=b(1),I=b(14),Q=b(273),O=b(1014),ba=b(55);tl.Object.defineProperties(d.prototype,{severity:{configurable:!0,enumerable:!0,get:function(){return this.KOc}},message:{configurable:!0,
enumerable:!0,get:function(){return this._message}}});Object(y.a)(d,"CustomFunctionLog",null,[]);b.d(D,"CustomFunctionsLegacyInstaller",function(){return a});a.prototype.D8e=function(ca,S,Y,na){var Z=this,wa=new A.a;if(na.invariantNamespace)for(S=0;S<na.invariantNamespace.length;++S){var ma=na.invariantNamespace.charAt(S);if("."!==ma&&"_"!==ma&&"a">ma&&"z"<ma&&"A">ma&&"Z"<ma&&"0">ma&&"9"<ma)return v.ULS.sendTraceTag(537163530,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: InvariantNamespace validation failed. Character='{0}', Position={1}.",
ma,S),wa.setResult(!1),wa.task}a.cacheManifest(Y,na.manifest);var pa=a.mEd(ca);(null===pa||void 0===pa?0:pa.isDynamicMetadata)?this.pFd(ca,pa,wa,!1,!1):OSF.OUtil.xhrGet(na.metadataUrl,function(Ia){pa=Object.assign(new k,{addinId:Y,locale:na.locale,addinInvariantNamespace:na.invariantNamespace,addinNamespace:na.namespace,addinTitle:na.title,isXllCompatible:na.isXllCompatible,metadataContent:JSON.stringify(JSON.parse(Ia))});Z.pFd(ca,pa,wa,!1,N.a(Z.$,na))},function(Ia){v.ULS.sendTraceTag(537163528,0,
10,"CustomFunctionsLegacyInstaller.InstallAsync: Failed to download Custom Functions metadata for solution {0}. ErrorCode: {1}.",ca,Ia);wa.setResult(!1)});return wa.task};a.prototype.F8e=function(ca,S,Y,na){S=new A.a;if(!a.epd(Y))return v.ULS.sendTraceTag(537163527,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Invalid metadata JSON."),S.setResult(!1),S.task;var Z=a.mEd(ca);if(!Z)return v.ULS.sendTraceTag(537163526,0,10,"CustomFunctionsLegacyInstaller.InstallDynamicFunctionsAsync: Unexpected error, could not read existing solution cache info."),
S.setResult(!1),S.task;Z.metadataContent=JSON.stringify(JSON.parse(Y));Z.isDynamicMetadata=!0;this.pFd(ca,Z,S,!0,na);return S.task};a.prototype.m8f=function(ca){var S=this,Y=new A.a,na=G.GetServiceTaskFactory.create(this.$.da,106,this.$.ma,1);w.TaskExtensions.Ba(na,function(){var Z=na.result;Z.cia();var wa=Object.assign(new c,{solutionId:ca});a.bGd(ca);a.iGd(ca);w.TaskExtensions.Ba(S.PUd(Z,ca,wa),function(ma){P.b(ma)?Y.setResult(ma.result):(ma.jg?v.ULS.sendTraceTag(537163524,0,10,"CustomFunctionsLegacyInstaller.UninstallAsync: Failed to uninstall Custom Functions for solution: {0}.",
ca):ma.Ch&&v.ULS.sendTraceTag(537163523,0,10,"CustomFunctionsLegacyInstaller.UninstallAsync: Uninstall Custom Functions is canceled for solution: {0}.",ca),Y.setResult(!1))},S.$.ma,0)},this.$.ma,3);return Y.task};a.prototype.ckd=function(){var ca=this,S=new A.a,Y=a.qEd();0<Y.length&&v.ULS.sendTraceTag(537163522,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Custom Functions registration from cache attempted.");var na=[];Y.forEach(function(wa){wa=Object(x.a)(String,wa);if(wa=a.mEd(wa)){var ma=
ia.a.Ec(ca.zE,wa.addinId);ma&&ma===wa.metadataContent||(ca.zE[wa.addinId]=wa.metadataContent,Array.add(na,wa))}});if(!na.length)return S.setResult(!0),v.ULS.sendTraceTag(537163521,0,50,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: There is no custom function to register from cache"),S.task;var Z=G.GetServiceTaskFactory.create(this.$.da,106,this.$.ma,1);w.TaskExtensions.Ba(Z,function(){var wa=Z.result,ma=Object.assign(new f,{registrationInfos:na});w.TaskExtensions.Ba(ca.LZb(wa,Y,ma),function(pa){P.b(pa)?
S.setResult(pa.result):(pa.jg?v.ULS.sendTraceTag(537163491,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Failed to register Custom Functions."):pa.Ch&&v.ULS.sendTraceTag(537163490,0,10,"CustomFunctionsLegacyInstaller.InstallFromCacheAsync: Registering Custom Functions is canceled."),S.setResult(!1))},ca.$.ma,0)},this.$.ma,3);return S.task};a.prototype.O$i=function(ca){ca=new u(ca);if(ca.needToRestoreManifest){var S=a.cZi(ca.solutionId);OSF.OsfManifestManager.cacheManifestFromXml(ca.solutionId,
ca.solutionVersion,S,this.$.ya.UICultureTag)}};a.prototype.pFd=function(ca,S,Y,na,Z){var wa=this,ma=G.GetServiceTaskFactory.create(this.$.da,106,this.$.ma,1);w.TaskExtensions.Ba(ma,function(){w.TaskExtensions.Ba(wa.rFd(ma.result,ca,S,!1,na,Z),function(pa){P.b(pa)?((pa=pa.result)&&a.TPj(ca,S),Y.setResult(pa)):(pa.jg?v.ULS.sendTraceTag(537163488,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: Failed to register Custom Functions for solution: {0}.",ca):pa.Ch&&v.ULS.sendTraceTag(537163487,0,10,"CustomFunctionsLegacyInstaller.InstallAsync: Registering Custom Functions is canceled for solution: {0}.",
ca),Y.setResult(!1))},wa.$.ma,0)},this.$.ma,3)};a.prototype.rFd=function(ca,S,Y,na,Z,wa){var ma=this;if(!Z&&(Z=ia.a.Ec(this.zE,Y.addinId))&&Z===Y.metadataContent)return ba.Task.Ta(!0);this.zE[Y.addinId]=Y.metadataContent;var pa=new A.a;wa||ca.PFb(S);ca.cia();ca=this.aob(Y);return this.kia(function(Ia){R.EwaSettings.la(257)&&l(a.Aqb,S);var Ma=Ia.Result;204===Ma.ResponseStatusCode?w.TaskExtensions.Ba(ma.YCd(pa,Y.addinId,na),function(ob){ob.jg?S?v.ULS.sendTraceTag(537163485,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}.",
S):v.ULS.sendTraceTag(537163484,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for addinId {0}.",Y.addinId):ob.Ch&&(S?v.ULS.sendTraceTag(537163483,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for solution {0}.",S):v.ULS.sendTraceTag(537163482,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Registering Custom Functions is canceled for addinId {0}.",Y.addinId));
pa.setResult(!1)},ma.$.ma,4):(Ia=function(){delete ma.zE[Y.addinId];a.bGd(S);a.iGd(S);v.ULS.sendTraceTag(537163481,0,10,"CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solution: {0}. Received status code {1}.",S,Ma.ResponseStatusCode);pa.setResult(!1)},Ia=Object.assign(new O.a,{OKa:OSF.InfoType.Error,title:Y.addinTitle,description:String.format(I.a.instance.Cb(152),I.a.instance.ea(1833)),buttonText:I.a.instance.ea(4),Wga:Ia,qcc:!1,Tha:Ia,errorCode:OSF.ErrorStatusCodes.WAC_CustomFunctionsRegistrationError}),
m.a.QOd(Ia))},function(Ia){Ia=B.a.yg(Ia.data);v.ULS.sendTraceTag(537163480,0,10,"CustomFunctionsLegacyInstaller.RegisterFunctionsForAddinAsync: Failed to register Custom Functions for solution {0}. Errors: {1}.",S,W.a.Uc(Ia));R.EwaSettings.la(257)&&l(a.zqb,S);delete ma.zE[Y.addinId];pa.setResult(!1)},ca,pa,!0)};a.prototype.LZb=function(ca,S,Y){var na=this,Z=new A.a;S.forEach(function(ma){ma=Object(x.a)(String,ma);ca.gve(ma)});ca.cia();var wa=this.SWc(Y);return this.kia(function(ma){R.EwaSettings.la(257)&&
l(a.Aqb,Sys.Serialization.JavaScriptSerializer.serialize(S));ma=ma.Result;var pa=!0,Ia=Sys.Serialization.JavaScriptSerializer.deserialize(ma.ResponseBody.toString());Ia=Array.isArray(Ia.value)?Ia.value:null;for(var Ma=0;Ma<Ia.length;Ma++)Ia[Ma]||(pa=!1,delete na.zE[Y.registrationInfos[Ma].addinId],a.bGd(S[Ma]),a.iGd(S[Ma]),v.ULS.sendTraceTag(537163478,0,10,"CustomFunctionsLegacyInstaller: Failed to register Custom Functions for solutionId: {0}. Received status code {1}.",S[Ma],ma.ResponseStatusCode));
w.TaskExtensions.Ba(na.YCd(Z,"",!1),function(ob){ob.jg?v.ULS.sendTraceTag(537163477,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to Batch register Custom Functions"):ob.Ch&&v.ULS.sendTraceTag(537163476,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Batch register Custom Functions is canceled");Z.setResult(!1)},na.$.ma,4);Z.setResult(pa)},function(ma){ma=B.a.yg(ma.data);v.ULS.sendTraceTag(537163475,0,10,"CustomFunctionsLegacyInstaller.BatchRegisterFunctionsForAddinAsync: Failed to register Custom Functions for solutionIds {0}. Errors: {1}.",
Sys.Serialization.JavaScriptSerializer.serialize(S),W.a.Uc(ma));R.EwaSettings.la(257)&&l(a.zqb,Sys.Serialization.JavaScriptSerializer.serialize(S));ma=yl(Y.registrationInfos);for(var pa=ma.next();!pa.done;pa=ma.next())delete na.zE[pa.value.addinId];Z.setResult(!1)},wa,Z,!0)};a.prototype.PUd=function(ca,S,Y){var na=this,Z=new A.a;ca.PFb(S);ca=this.cXc(Y);return this.kia(function(){R.EwaSettings.la(257)&&l(a.x3c,S);w.TaskExtensions.Ba(na.YCd(Z,Y.solutionId,!1),function(wa){wa.jg?S&&v.ULS.sendTraceTag(537163473,
0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}.",S):wa.Ch&&S&&v.ULS.sendTraceTag(537163472,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Unregistering Custom Functions is canceled for solution {0}.",S);Z.setResult(!1)},na.$.ma,4)},function(wa){wa=B.a.yg(wa.data);v.ULS.sendTraceTag(537163471,0,10,"CustomFunctionsLegacyInstaller.UnregisterFunctionsForAddinAsync: Failed to unregister Custom Functions for solution {0}. Errors: {1}.",
S,W.a.Uc(wa));R.EwaSettings.la(257)&&l(a.w3c,S);Z.setResult(!1)},ca,Z,!1)};a.prototype.kia=function(ca,S,Y,na,Z){function wa(){function Cb(Tb,da,ya){R.EwaSettings.la(257)&&l(Z?a.v3c:a.y3c,Xa.RequestBody);return r.i(pa.ta,"ExecuteRichApiRequest",Y,Q.b(Tb,ca),Q.a(da,S),ya,null,0)}if(ma.MGa()||0<pa.ta.I3||0<pa.Ek.I3)return!1;Ia&&ma.pz(Ia);Ma&&pa.Lt(Ma);ob&&pa.VC(ob);var Xa=Y.request,Sb=Xa.RequestFlags&1?0:16;R.EwaSettings.tc()?ma.tt(new z.a(507,0,Cb,Sb|64)):ma.tt(new t.a(507,0,Cb,Sb));return!0}var ma=
this.$.userOperationManager,pa=this.$.qa,Ia=null,Ma=null,ob=null;wa()||(Ia=function(){wa()},Ma=function(){wa()},ob=function(){wa()},ma.uy(Ia),pa.us(Ma),pa.FB(ob));return na.task};a.prototype.aob=function(ca){var S={HttpMethod:"POST",PathAndQuery:"RegisterCustomFunctions",RequestHeaders:null};S.RequestBody=JSON.stringify(ca);S.RequestFlags=1;ca=this.$.qa.ta.Oa(1);ca.request=S;return ca};a.prototype.SWc=function(ca){var S={HttpMethod:"POST",PathAndQuery:"BatchRegisterCustomFunctions",RequestHeaders:null};
S.RequestBody=JSON.stringify(ca);S.RequestFlags=1;ca=this.$.qa.ta.Oa(1);ca.request=S;return ca};a.prototype.cXc=function(ca){var S={HttpMethod:"POST",PathAndQuery:"UnregisterCustomFunctions",RequestHeaders:null};S.RequestBody=JSON.stringify(ca);S.RequestFlags=1;ca=this.$.qa.ta.Oa(1);ca.request=S;return ca};a.prototype.YCd=function(ca,S,Y){var na=this,Z=G.GetServiceTaskFactory.create(this.$.da,153,this.$.ma,1);w.TaskExtensions.Ba(Z,function(){Z.result.jId();S&&Y&&na.O$i(S);ca.setResult(!0)},this.$.ma,
3);return Z};a.prototype.G8e=function(){return ba.Task.Ta(!0)};a.qEd=function(){return(Array.isArray(Sys.Serialization.JavaScriptSerializer.deserialize(a.lub(U.a.QXa)||"[]"))?Sys.Serialization.JavaScriptSerializer.deserialize(a.lub(U.a.QXa)||"[]"):null)||[]};a.Pcg=function(ca){a.qMd(U.a.QXa,Sys.Serialization.JavaScriptSerializer.serialize(ca))};a.mEd=function(ca){ca=a.lub(U.a.N2a(ca))||"";return 0<ca.length?Sys.Serialization.JavaScriptSerializer.deserialize(ca,!0):null};a.TPj=function(ca,S){a.NIe(ca);
a.qMd(U.a.N2a(ca),Sys.Serialization.JavaScriptSerializer.serialize(S))};a.bGd=function(ca){a.aLf(ca);a.uLf(U.a.N2a(ca))};a.cZi=function(ca){return a.lub(U.a.M2a(ca))};a.UPj=function(ca,S){a.NIe(ca);a.qMd(U.a.M2a(ca),S)};a.iGd=function(ca){a.aLf(ca);a.uLf(U.a.M2a(ca))};a.NIe=function(ca){var S=a.qEd();ca=ca.toLowerCase();Array.contains(S,ca)||(S.push(ca),a.Pcg(S))};a.aLf=function(ca){var S=a.qEd();ca=ca.toLowerCase();Array.contains(S,ca)&&(S.splice(Array.indexOf(S,ca),1),a.Pcg(S))};a.cacheManifest=
function(ca,S){ca=new u(ca);ca.needToRestoreManifest&&a.UPj(ca.solutionId,S)};a.lub=function(ca){try{return localStorage.getItem(ca)}catch(S){return v.ULS.sendTraceTag(537163469,0,50,"CustomFunctionsLegacyInstaller.GetLocalStorageItemSafe: Failed to get data from the localStorage. Reason: {0}",S.message||"Unknown"),null}};a.qMd=function(ca,S){try{localStorage.setItem(ca,S)}catch(Y){v.ULS.sendTraceTag(537163468,0,50,"CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: {0}",
Y.message||"Unknown")}};a.uLf=function(ca){try{localStorage.removeItem(ca)}catch(S){v.ULS.sendTraceTag(537163467,0,50,"CustomFunctionsLegacyInstaller.SetLocalStorageItemSafe: Failed to set data into the localStorage. Reason: {0}",S.message||"Unknown")}};a.epd=function(ca){if(!ca)return!1;try{JSON.parse(ca)}catch(S){return!1}return!0};a.v3c=new d(2,"CustomFunctions [Registration] [Begin] SolutionId=");a.Aqb=new d(0,"CustomFunctions [Registration] [End] [Success] SolutionId=");a.zqb=new d(1,"CustomFunctions [Registration] [End] [Failure] SolutionId=");
a.y3c=new d(2,"CustomFunctions [Unregistration] [Begin] SolutionId=");a.x3c=new d(0,"CustomFunctions [Unregistration] [End] [Success] SolutionId=");a.w3c=new d(1,"CustomFunctions [Unregistration] [End] [Failure] SolutionId=");Object(y.a)(a,"CustomFunctionsLegacyInstaller",null,[798])},1250:function(y,D,b){function a(W,R,I,Q,O){this.Ma=null;this.PTc="AddinActivated";this.$=W;this.Ve=R;this.ownerAddinInfo=I;this.ee=void 0===O?null:O;this.UPa=(void 0===Q?null:Q)||P.Task.Ta(!0);this.Ma=new m.a;return this}
function d(W){var R=N.call(this)||this;R.uCa="AddInCommandsDialog";R.Me=R.uCa;R.kc=5;R.dialogWidth=695;R.dialogHeight=438;R.lYg="100%";R.iYg="408px";R.jYg="15px";R.kYg="0";R.Dog=W;return R}function c(W,R,I,Q,O,ba){var ca=W.Oa(9);ca.sharedInfo=R;return x.i(W,"InsertAgaveTaskpane",ca,I,Q,O,ba,0)}function k(){}y=b(0);var n=b(200),l=b(13),f=b(5);Object(y.a)(k,"AddinCommandsHost",null,[]);var u=b(1292),v=b(1369),m=b(36),A=b(950),x=b(81),t=b(519),z=b(368),r=b(163),G=b(35),w=b(1),B=b(273),U=b(140),N=U.a;
vm(d,N);d.prototype.KC=function(){N.prototype.KC.call(this);this.fp.style.width=this.lYg;this.fp.style.height=this.iYg;this.fp.style.marginTop=this.jYg;this.fp.style.padding=this.kYg};d.prototype.WN=function(){N.prototype.WN.call(this);this.Lb.style.width=String.format("{0}px",this.dialogWidth);this.Lb.style.height=String.format("{0}px",this.dialogHeight)};d.prototype.dispose=function(){N.prototype.dispose.call(this);this.Dog()};tl.Object.defineProperties(d.prototype,{containerDiv:{configurable:!0,
enumerable:!0,get:function(){return this.fp}}});Object(y.a)(d,"AddInCommandsDialog",U.a,[]);var P=b(55),ia=b(60);U=b(101);b.d(D,"a",function(){return a});vm(a,k);a.prototype.$yg=function(W){this.Ma.addHandler(this.PTc,W)};a.prototype.ZOa=function(){f.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowExcelAddinSurveyEnabled",!1)&&(l.ULS.sendTraceTag(0,220,50,"survey addin {0} is used.",Telemetry.PrivacyRules.GetAssetId(this.ownerAddinInfo.storeType,this.ownerAddinInfo.storeId,
this.ownerAddinInfo.solutionId)),this.Ma.raiseEvent(this.PTc,this.ownerAddinInfo.solutionId))};a.prototype.eYg=function(){var W=this.UPa;this.UPa=P.Task.Ta(!0);return W};a.prototype.disposeHost=function(W){this.Ve.xPa(W)};a.prototype.setOwnerAddinEToken=function(W){this.ownerAddinInfo.eToken=W};a.prototype.showTaskpane=function(W,R,I){var Q=this;l.ULS.sendTraceTag(537170642,220,50,"ShowTaskpane action called.");var O=null,ba=!1,ca=(new u.a("m_excelWebRenderer_ewaCtl_",this.ownerAddinInfo.solutionId,
new A.a,!0)).$Ce(W.solutionId.substr(this.ownerAddinInfo.solutionId.length));O=R.getSharedRuntimeForTaskpane("Workbook",ca);ba=!!O&&1===O.LifeTime;this.Ve.jve(ba?this.ownerAddinInfo.solutionId:W.solutionId,ba?O:null,null)?this.ZOa():(this.mjf(ba,!0),this.UPa=this.akd(W,O,function(S,Y){S?(ba&&(S.PrimaryMarketplace.SolutionId=Q.ownerAddinInfo.solutionId,S.SharedRuntime=O),S.WebExtensionOsfControlType=3,Q.Ve.z_a(S),I(S.InstanceId,Y),Q.ZOa(),Q.mjf(ba,!1)):(l.ULS.sendTraceTag(17306640,220,10,"ShowTaskpane: instance id is null."),
I(null,Y),Q.ZOa())}))};a.prototype.getSettings=function(W,R){var I=this.Ve.U$(W.solutionId);I?R(this.Ve.YY(I).OsfPropertyBag):this.UPa=this.akd(W,null,function(Q){Q?R(Q.OsfPropertyBag):l.ULS.sendTraceTag(537170641,220,10,"GetSettings: insertData is null.")})};a.prototype.showDialog=function(W,R,I){function Q(Y,na,Z){return c(ca,S,B.b(Y,O),na,Z,null)}function O(Y){var na=Y.Result,Z=na?na.AgaveData:null;Z?(ba.Ve.YBe(Z,function(){var wa=new d(function(){ba.disposeHost(Z.InstanceId)});wa.initializeAndShow("",
null,null);ba.ZOa();return wa.containerDiv}),I(Z.InstanceId,0),ba.ZOa()):(l.ULS.sendTraceTag(537170638,220,10,"ShowDialog: instance id is null."),I(null,Y.Errors?Y.Errors[0].ErrorCause:5001))}var ba=this;l.ULS.sendTraceTag(537170640,220,50,"ShowDialog action called.");var ca=this.$.qa.ta,S=a.kqb(W,this.ownerAddinInfo);w.EwaSettings.tc()?this.UPa=z.a(this.$.userOperationManager,Q,function(Y){return new r.a(500,0,Y,64)},this.ee):this.UPa=z.a(this.$.userOperationManager,Q,function(Y){return new t.a(500,
0,Y)},this.ee)};a.prototype.createUILessSandbox=function(W,R,I){var Q=this;l.ULS.sendTraceTag(537170637,220,50,"UILess action called.");var O=R.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"),ba=!!O&&1===O.LifeTime;(R=this.Ve.Pvh(ba?this.ownerAddinInfo.solutionId:W.solutionId,ba?O:null))?(I(R,0),this.ZOa()):this.UPa=this.akd(W,O,function(ca,S){ca?(ba?(ca.PrimaryMarketplace.SolutionId=Q.ownerAddinInfo.solutionId,ca.SharedRuntime=O,ca.TaskpaneVisible=!1,ca.WebExtensionOsfControlType=3,Q.Ve.z_a(ca)):
(ca.WebExtensionOsfControlType=4,Q.Ve.YBe(ca,function(){a.Hdb.ia(ca.InstanceId,new v.a);return a.Hdb.na(ca.InstanceId).k0a})),I(ca.InstanceId,S),Q.ZOa()):(l.ULS.sendTraceTag(537170636,220,10,"UILess: instance id is null."),I(null,S))})};a.prototype.akd=function(W,R,I){function Q(ma,pa,Ia){return c(S,Y,B.b(ma,O),pa,Ia,null)}function O(ma){var pa=ma.Result;(ca=pa?pa.AgaveData:null)||I(null,ma.Errors?ma.Errors[0].ErrorCause:5001)}var ba=this,ca=null,S=this.$.qa.ta,Y=a.kqb(W,this.ownerAddinInfo);R&&(l.ULS.sendTraceTag(537170634,
220,50,"Shared runtime agave is inserted."),Y.SharedRuntimeId=R.Resid);var na=500,Z=0;void 0===Y.IsToBePersisted||null===Y.IsToBePersisted||Y.IsToBePersisted||(na=538,Q=function(ma,pa,Ia){l.ULS.sendTraceTag(537170633,220,50,"Web Method ShowAgaveTaskpane is called, CurrentStoreType {0}, StoreId {1}, AssetId {2}.",Y.CurrentStoreType,Y.StoreId,Telemetry.PrivacyRules.GetAssetId(Y.CurrentStoreType,Y.StoreId,Y.AssetId));ma=B.b(ma,O);var Ma=S.Oa(9,null);Ma.sharedInfo=Y;return x.i(S,"ShowAgaveTaskpane",Ma,
ma,pa,Ia,null,0)},Z=16);if(w.EwaSettings.tc()){Z|=64;var wa=z.a(this.$.userOperationManager,Q,function(ma){return new r.a(na,0,ma,Z)},this.ee)}else wa=z.a(this.$.userOperationManager,Q,function(ma){return new t.a(na,0,ma,Z)},this.ee);return G.TaskExtensions.ts(wa,function(){return ca?ba.Ard(S,ca.InstanceId,function(ma,pa){if(ma){R||(ca.PrimaryMarketplace.MarketplaceType=W.storeType);ca.OwnerAddinSolutionId=ba.ownerAddinInfo.solutionId;ca.OwnerAddinAssetId=ba.ownerAddinInfo.assetId;ca.OwnerAddinStoreType=
ba.ownerAddinInfo.storeType;ca.OsfPropertyBag=[];for(pa=0;pa<ma.Settings.length;pa++){var Ia=[];Ia[0]=ma.Settings[pa].Name;Ia[1]=ma.Settings[pa].Value;ca.OsfPropertyBag[pa]=Ia}I(ca,0)}else I(null,pa.Errors?pa.Errors[0].ErrorCause:5001)}):P.Task.Ta(!1)},n.a.none,3,ia.a.current)};a.prototype.Ard=function(W,R,I){function Q(ba,ca,S){ba=B.b(ba,O);var Y=W.Oa(1);Y.controlId=R;return x.i(W,"DdaLoadSettings",Y,ba,ca,S,null,0)}function O(ba){I(ba.Result,ba)}return w.EwaSettings.tc()?z.a(this.$.userOperationManager,
Q,function(ba){return new r.a(501,0,ba,80)},this.ee):z.a(this.$.userOperationManager,Q,function(ba){return new t.a(501,0,ba,16)},this.ee)};a.prototype.mjf=function(W,R){var I;W&&(null===(I=window.performance)||void 0===I?0:I.memory)&&l.ULS.sendTraceTag(537170630,220,50,"Shared runtime memory usage: before={0}, jsHeapSizeLimit={1}, totalJSHeapSize={2}, usedJSHeapSize={3}",R,window.performance.memory.jsHeapSizeLimit,window.performance.memory.totalJSHeapSize,window.performance.memory.usedJSHeapSize)};
a.showUILessDialog=function(W){a.Hdb.wb(W)&&a.Hdb.na(W).initializeAndShowWithTitle()};a.hideUILessDialog=function(W){a.Hdb.wb(W)&&a.Hdb.na(W).hide()};a.kqb=function(W,R){var I={};I.SolutionId=W.solutionId;I.Version=W.version;I.StoreType=R.storeType;I.StoreId=W.storeId;I.AssetId=W.solutionId;I.AssetStoreId="omex";I.TargetType=1;I.Width=350;I.OwnerAddinSolutionId=R.solutionId;I.OwnerAddinStoreType=R.storeType;I.SharedRuntimeId=null;I.Preload=!1;I.Id=W.solutionId;I.AppVersion=W.version;I.CurrentStoreType=
R.storeType;I.OwnerAddinAssetId=R.assetId;return I};a.Hdb=new U.a;Object(y.a)(a,"WACExcelAddinCommandsHost",k,[])},1285:function(y,D,b){function a(d,c,k,n){this._id=d;this.jsg=c;this.Yee=k;this.MTa=n}b.d(D,"a",function(){return a});y=b(0);a.prototype.getId=function(){return this._id};a.prototype.getStoreId=function(){return this.jsg};a.prototype.getStoreType=function(){return this.Yee};Object(y.a)(a,"ExtensionIdentity",null,[149])},1286:function(y,D,b){function a(d,c,k){this.I8d=k}b.d(D,"a",function(){return a});
y=b(0);Object(y.a)(a,"HostProperties",null,[])},1287:function(y,D,b){function a(){this.ni={};this.Sq={}}b.d(D,"a",function(){return a});y=b(0);Object(y.a)(a,"ExtensionLaunchProperties",null,[])},1288:function(y,D,b){function a(){this.La=f.AFrameworkApplication.Eb}b.d(D,"a",function(){return a});y=b(0);var d=b(1285),c=b(1287),k=b(1100),n=b(1290),l=b(1286),f=b(5),u=b(592),v=b(29);a.prototype.CMa=function(m,A,x,t,z){this.Aji(m,A,x,t,z)};a.prototype.Aji=function(m,A,x,t,z){var r=b(1289).ExtensionComponentInstance,
G={};G[k.a.n7b]=m;G[k.a.wye]=A;G[k.a.GGa]=x;G[k.a.bid]=t;G[k.a.iya]=z;t=8;f.AFrameworkApplication.Xei(m.getId())&&(t=A===n.a.action?this.La.ze(v.a.iOe,2,G):this.La.ze(v.a.s_f,2,G));32===t?(t=u.a.create().toString(),z.ni.InstanceToken&&(t=z.ni.InstanceToken),m=new r(m,A,x,t),a.uv[t]=m):m=new r(m,A,x,null);m.Mgj(G)};a.prototype.zji=function(m){var A=m.ExtId,x=m.ComponentType,t=m.ComponentId,z=m.HostProps;m=m.OptionalProps;A=new d.a(A.Id,A.StoreId,A.StoreType,A.AppVersion);z=new l.a(z.HostType,z.FormFactor,
z.Locale);var r=new c.a;r.ni=m.OptionalProperties;r.Sq=m.DevProperties;a.instance.CMa(A,x,t,z,r)};a.prototype.getInstance=function(m){return a.uv[m]};a.prototype.V2i=function(m){delete a.uv[m]};tl.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){a.ZFc||(a.ZFc=new a);return a.ZFc}}});a.ZFc=null;a.uv={};Object(y.a)(a,"ExtensionLifeCycleManager",null,[148])},1289:function(y,D,b){function a(n,l,f,u){this.MTa=this.LF=null;this._id=n;this.pig=f;this.bmg=u;this.La=c.AFrameworkApplication.Eb?
c.AFrameworkApplication.Eb:null}b.r(D);b.d(D,"ExtensionComponentInstance",function(){return a});y=b(0);var d=b(1288),c=b(5),k=b(29);a.prototype.Kbd=function(){return this.pig};a.prototype.Mgj=function(n){this.LF=n};a.prototype.stop=function(){var n=this.La.ze(k.a.RUg,2,this.LF);d.a.instance.V2i(this.bmg);return 32===n};a.prototype.Prc=function(){this.La.ze(k.a.QPf,2,this.LF)};tl.Object.defineProperties(a.prototype,{appVersion:{configurable:!0,enumerable:!0,get:function(){return this.MTa}}});Object(y.a)(a,
"ExtensionComponentInstance",null,[180])},1290:function(y,D,b){function a(){}b.d(D,"a",function(){return a});y=b(0);a.taskpane="Taskpane";a.action="Action";Object(y.a)(a,"ComponentTypeNames",null,[])},1292:function(y,D,b){function a(k,n,l,f){this.PPc=this.ljb=this.RPc=null;this.LDa=k;c.AFrameworkApplication.ga.ra("AddInCommandsMissingTabIsEnabled")?(this.RPc=l.qMh(),this.ljb=l.d9a,this.PPc=l.fti):(this.RPc=l.uxc,this.PPc=this.ljb=null);this.eDc=this.ms=n;this.rrg=f}b.d(D,"a",function(){return a});
y=b(0);var d=b(13),c=b(5);a.prototype.wua=function(k){k=this.tNa+this.solutionId+k;return this.pOd?(k in a.gYb||(a.gYb[k]="AddinControl"+a.gDg++),a.gYb[k]):k};a.prototype.$Ce=function(k){if(this.pOd){var n=a.gYb,l;for(l in n){var f=l;if(k===n[l])return f.substr(this.tNa.length+this.solutionId.length)}}return k};a.prototype.efd=function(k){k=this.tNa+this.solutionId+k;return this.pOd?(k in a.UTc||(a.UTc[k]="AddinTab"+a.oDg++),a.UTc[k]):k};a.prototype.xNh=function(k){return k.toLowerCase()in this.uxc?
(d.ULS.sendTraceTag(17306646,220,50,"Tab id: {0}.",k.toLowerCase()),this.tNa+this.uxc[k.toLowerCase()]):null};a.prototype.KNh=function(){if(!this.d9a)return null;for(var k=[],n=yl(this.d9a),l=n.next();!l.done;l=n.next())k.push(this.tNa+l.value);return k};a.prototype.oLh=function(k){k=this.bUe(k);return null===k?null:k[1]};a.prototype.mLh=function(k){k=this.bUe(k);return null===k?null:k[2]};a.prototype.bUe=function(k){return this.aSd&&k.toLowerCase()in this.aSd?(d.ULS.sendTraceTag(21017039,220,50,
"Get attributes for Tab id: {0}.",k.toLowerCase()),this.aSd[k.toLowerCase()]):null};tl.Object.defineProperties(a.prototype,{tNa:{configurable:!0,enumerable:!0,get:function(){return this.LDa}},uxc:{configurable:!0,enumerable:!0,get:function(){return this.RPc}},solutionId:{configurable:!0,enumerable:!0,get:function(){return this.ms}},assetId:{configurable:!0,enumerable:!0,get:function(){return this.eDc}},d9a:{configurable:!0,enumerable:!0,get:function(){return this.ljb}},aSd:{configurable:!0,enumerable:!0,
get:function(){return this.PPc}},pOd:{configurable:!0,enumerable:!0,get:function(){return this.rrg}}});a.gYb={};a.UTc={};a.oDg=0;a.gDg=0;Object(y.a)(a,"DefaultRibbonNamingProvider",null,[829])},1346:function(y,D,b){function a(x){var t=this;this.jA=null;this.n6f={};this.p6f={};this.c$c={};this.Svd={};this.Hgd=function(z,r){z=t.$.Ub.Fc("Task","DdaEventDispatch.HandleServerEvent");r=r.UTf;for(var G=0;G<r.length;G++)switch(r[G].EventType){case 2:var w=r[G],B={};B.Name=w.Name;B.BindingType=w.BindingType;
B.ColCount=w.ColCount;B.RowCount=w.RowCount;t.eva(w.InstanceId,OSF.DDA.EventDispId.dispidBindingDataChangedEvent,B,null);break;case 4:t.eva(r[G].InstanceId,OSF.DDA.EventDispId.dispidSettingsChangedEvent,null,null);break;case 8:if(w=r[G],w.InstanceId){B=Array(w.Entries.length);for(var U=0;U<w.Entries.length;U++)B[U]=a.tac(w.Entries[U],w.IsRemoteOverride);0<w.Entries.length&&1===w.Entries[0].Category?t.HUi(w.InstanceId,B):w.InstanceId&&t.eva(w.InstanceId,OSF.DDA.EventDispId.dispidRichApiMessageEvent,
null,B)}else{t.c$c={};t.Svd={};for(B=0;B<w.Entries.length;B++)t.JFe(w.Entries[B],w.IsRemoteOverride);d.ULS.sendTraceTag(537170593,0,50,"Number of Fired event: {0}, Number of Not Fired event: {1}, Total Number of Fired event: {2}, Total Number of Not Fired event: {3}",t.c$c,t.Svd,t.n6f,t.p6f)}}z.stop()};this.RHb=function(z,r){t.eva(z,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,r)};this.$=x;this.xtc=this.Hgd}b.r(D);y=b(0);var d=b(13),c=b(84),k;(function(x){x[x.none=0]="none";x[x.testEvent=1]=
"testEvent";x[x.test1Event=2]="test1Event";x[x.worksheetDataChangedEvent=10]="worksheetDataChangedEvent";x[x.worksheetActivatedEvent=11]="worksheetActivatedEvent";x[x.worksheetDeactivatedEvent=12]="worksheetDeactivatedEvent";x[x.worksheetAddedEvent=13]="worksheetAddedEvent";x[x.worksheetSelectionChangedEvent=14]="worksheetSelectionChangedEvent";x[x.worksheetDeletedEvent=15]="worksheetDeletedEvent";x[x.worksheetCalculatedEvent=16]="worksheetCalculatedEvent";x[x.worksheetFilteredEvent=17]="worksheetFilteredEvent";
x[x.worksheetFormatChangedEvent=18]="worksheetFormatChangedEvent";x[x.worksheetRowSortedEvent=19]="worksheetRowSortedEvent";x[x.worksheetColumnSortedEvent=20]="worksheetColumnSortedEvent";x[x.worksheetSingleClickedEvent=21]="worksheetSingleClickedEvent";x[x.worksheetRowHiddenChangedEvent=22]="worksheetRowHiddenChangedEvent";x[x.worksheetFormulaChangedEvent=23]="worksheetFormulaChangedEvent";x[x.worksheetProtectionChangedEvent=24]="worksheetProtectionChangedEvent";x[x.worksheetNameChangedEvent=25]=
"worksheetNameChangedEvent";x[x.worksheetVisibilityChangedEvent=26]="worksheetVisibilityChangedEvent";x[x.worksheetMovedEvent=27]="worksheetMovedEvent";x[x.worksheetNavigationObjectChangedEvent=28]="worksheetNavigationObjectChangedEvent";x[x.worksheetRowHeightChangedEvent=29]="worksheetRowHeightChangedEvent";x[x.workbookFormulaReferenceStyleChangedEvent=30]="workbookFormulaReferenceStyleChangedEvent";x[x.chartAddedEvent=50]="chartAddedEvent";x[x.chartActivatedEvent=51]="chartActivatedEvent";x[x.chartDeactivatedEvent=
52]="chartDeactivatedEvent";x[x.chartDeletedEvent=53]="chartDeletedEvent";x[x.tableSelectionChangedEvent=100]="tableSelectionChangedEvent";x[x.tableDataChangedEvent=101]="tableDataChangedEvent";x[x.tableAddedEvent=102]="tableAddedEvent";x[x.tableDeletedEvent=103]="tableDeletedEvent";x[x.tableFilteredEvent=104]="tableFilteredEvent";x[x.agaveVisualUpdateEvent=150]="agaveVisualUpdateEvent";x[x.customFunctionExecutionBeginEvent=200]="customFunctionExecutionBeginEvent";x[x.customFunctionExecutionEndEvent=
201]="customFunctionExecutionEndEvent";x[x.commentAddedEvent=250]="commentAddedEvent";x[x.commentDeletedEvent=251]="commentDeletedEvent";x[x.commentChangedEvent=252]="commentChangedEvent";x[x.invocationMessage=1E3]="invocationMessage";x[x.cancellationMessage=1001]="cancellationMessage";x[x.metadataMessage=1002]="metadataMessage";x[x.visualSelectionChangedEvent=2E3]="visualSelectionChangedEvent";x[x.visualChangeEvent=2001]="visualChangeEvent";x[x.visualTrackerModelChangedEvent=2002]="visualTrackerModelChangedEvent";
x[x.shapeSelectionChangedEvent=2100]="shapeSelectionChangedEvent";x[x.shapeActivatedEvent=2101]="shapeActivatedEvent";x[x.shapeDeactivatedEvent=2102]="shapeDeactivatedEvent";x[x.shapeAddedEvent=2103]="shapeAddedEvent";x[x.shapeDeletedEvent=2104]="shapeDeletedEvent";x[x.workbookAutoSaveSettingChangedEvent=2200]="workbookAutoSaveSettingChangedEvent";x[x.wacOperationEvent=2201]="wacOperationEvent";x[x.recordingStateChangedEvent=2202]="recordingStateChangedEvent";x[x.workbookActivatedEvent=2203]="workbookActivatedEvent";
x[x.workbookNavigationObjectChangedEvent=2204]="workbookNavigationObjectChangedEvent";x[x.ribbonCommandExecutedEvent=2300]="ribbonCommandExecutedEvent";x[x.linkedDataTypeRefreshRequestCompletedEvent=2500]="linkedDataTypeRefreshRequestCompletedEvent";x[x.linkedDataTypeRefreshModeChangedEvent=2501]="linkedDataTypeRefreshModeChangedEvent";x[x.linkedDataTypeLinkedDataTypeAddedEvent=2502]="linkedDataTypeLinkedDataTypeAddedEvent";x[x.linkedWorkbookWorkbookLinksChangedEvent=2600]="linkedWorkbookWorkbookLinksChangedEvent";
x[x.linkedWorkbookRefreshCompletedEvent=2601]="linkedWorkbookRefreshCompletedEvent";x[x.rangePickerSelectionChangedEvent=2700]="rangePickerSelectionChangedEvent";x[x.lineageActivityUpdateAvailableEvent=2800]="lineageActivityUpdateAvailableEvent";x[x.lineageActivityFilterUpdatedEvent=2801]="lineageActivityFilterUpdatedEvent";x[x.lineageActivityLoadCompletedEvent=2802]="lineageActivityLoadCompletedEvent";x[x.pivotTableAddedEvent=2900]="pivotTableAddedEvent";x[x.pivotTableDeletedEvent=2901]="pivotTableDeletedEvent";
x[x.namedItemAddedEvent=3E3]="namedItemAddedEvent";x[x.namedItemDeletedEvent=3001]="namedItemDeletedEvent";x[x.guidedReapplyManagerUpdateAvailableEvent=3100]="guidedReapplyManagerUpdateAvailableEvent";x[x.appRuntimeVisibilityChangedEvent=65539]="appRuntimeVisibilityChangedEvent";x[x.beforeCloseNotifiactionCancelledEvent=65540]="beforeCloseNotifiactionCancelledEvent"})(k||(k={}));Object(y.b)("MessageType",k);var n=b(895),l=b(234),f=b(861),u=b(52),v=b(35),m=b(147),A=b(1);b.d(D,"DdaEventDispatch",function(){return a});
a.prototype.MXb=function(x){x&&(this.cia(),Array.add(this.jA,x))};a.prototype.Kqc=function(x){this.jA&&(Array.remove(this.jA,x),this.jA.length||(this.$.wantServerEvents=!1,this.$.l6i(this.xtc),this.jA=null))};a.prototype.HUi=function(x,t){var z=this,r=Object(c.a)(f.DdaFacade,l.a(this.$));v.TaskExtensions.Ba(r.HNh(x),function(G){if(m.b(G)){var w=G.result;G=r.an(w);if(w)if(G.ind)z.eva(w,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,t);else if(G.u3c)for(w=0;w<t.length;w++)Array.add(G.u3c,t[w]);
else G.u3c=t}else G.jg?d.ULS.sendTraceTag(537170591,0,10,"DdaEventDispatch.HandleServerEvent: Failed to get or create Custom Functions sandbox."):G.Ch&&d.ULS.sendTraceTag(537170590,0,10,"DdaEventDispatch.HandleServerEvent: Getting or creating Custom Functions sandbox is cancelled.")},this.$.ma,0)};a.prototype.cVi=function(x,t){var z=Object(c.a)(f.DdaFacade,l.a(this.$)),r=z.nCh(x);r?OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(r,t,this.RHb):z.q_g(x,t)};a.prototype.JFe=function(x,
t){var z=!1,r=parseInt(x.Type),G=x.Target,w=Object(c.a)(f.DdaFacade,l.a(this.$));if((G=w.dj.NNh(r,G))&&0<Object.keys(G).length){z=!0;for(var B in G)if(G=B,w.dj.cZb(G)){var U=Array(1);U[0]=a.tac(x,t);if(A.EwaSettings.isChangeGateEnabled("OfficeVSO:5379862_RichApiEventsTriggerSource")){var N=U[0][3];if(void 0!==N&&null!==N&&(N=Object(c.a)(Object,u.a.li(N)))&&void 0!==N.triggerControlId&&null!==N.triggerControlId&&void 0!==N.triggerSource&&null!==N.triggerSource){var P=!1;t?(N.triggerSource="Unknown",
P=!0):w.ich(N.triggerControlId,G)&&(N.triggerSource="ThisLocalAddin",P=!0);P&&(U[0][3]=u.a.Hc(N))}}this.eva(G,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,U)}}z?(this.cdc(k[r],this.c$c),this.cdc(k[r],this.n6f)):(this.cdc(k[r],this.Svd),this.cdc(k[r],this.p6f))};a.prototype.cia=function(){this.jA||(this.jA=[],this.$.Lle(this.xtc),this.$.wantServerEvents=!0)};a.prototype.cdc=function(x,t){x in t||(t[x]=0);t[x]+=1};a.prototype.jM=function(x,t,z){var r={};r.Target=t;r.Category=65536;r.Type=x;r.Message=
z;r.Id=-1;this.JFe(r,!1)};a.prototype.dwh=function(x,t){var z={Target:"",Category:2,Type:1E3};z.Message=t;z.Id=0;t=Array(1);t[0]=a.tac(z,!1);this.cVi(x,t)};a.prototype.f8b=function(x,t,z,r){var G={};G.Target=z;G.Category=65536;G.Type=t;G.Message=r;G.Id=-1;t=Array(1);t[0]=a.tac(G,!1);this.eva(x,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,t)};a.prototype.cwh=function(x,t){this.eva(x,OSF.DDA.EventDispId.dispidRichApiMessageEvent,null,t)};a.prototype.eva=function(x,t,z,r){if(this.jA){var G=Object(c.a)(f.DdaFacade,
l.a(this.$));if(!G||t!==OSF.DDA.EventDispId.dispidBindingDataChangedEvent&&t!==OSF.DDA.EventDispId.dispidSettingsChangedEvent||G.dj.cZb(x))for(x=new n.a(t,x,z,r),t=0,z=this.jA.length;t<z;t++)(r=this.jA[t])&&r(x)}};a.tac=function(x,t){var z=Array(6);z[0]=x.Category;z[1]=x.Type;z[2]=x.Target;z[3]=x.Message;z[4]=x.Id;z[5]=t;return z};Object(y.a)(a,"DdaEventDispatch",null,[])},1369:function(y,D,b){function a(){var k=c.call(this,void 0,void 0,void 0,!0)||this;k.uCa="AddinCommandsUILessDialog";k.qQc="WACDialogTitleText";
k.gUa="0";k.xCa=380;k.Hgb=190;k.Me=k.uCa;k.kc=5;k.wig=String.format("{0}px",k.xCa);k.fUa=String.format("{0}px",k.Hgb);k.Gu=!1;k.Y3e=!1;k.KC();return k}b.d(D,"a",function(){return a});y=b(0);D=b(140);var d=b(89),c=D.a;vm(a,c);a.prototype.KC=function(){c.prototype.KC.call(this);this.fp.style.width=this.wig;this.fp.style.height=this.fUa;this.fp.style.padding=this.gUa};a.prototype.$u=function(k){this.WN();document.getElementById(this.mi(this.qQc)).innerText=k};a.prototype.WN=function(){c.prototype.WN.call(this);
this.Lb.style.width=String.format("{0}px",this.xCa);this.Lb.style.height=String.format("{0}px",this.Hgb);this.Lb.removeAttribute(d.a.Sd);this.Lb.removeAttribute(d.a.JD)};a.prototype.hide=function(){this.Xvb()};a.prototype.initializeAndShowWithTitle=function(){this.initializeAndShow(CommonUIStrings.l_NotificationUITitle,null,null)};tl.Object.defineProperties(a.prototype,{k0a:{configurable:!0,enumerable:!0,get:function(){return this.fp}}});Object(y.a)(a,"AddinCommandsUILessDialog",D.a,[836])},1375:function(y,
D,b){function a(F){return Vk.call(this,F)||this}function d(F,fa,Qa){this.rangePicker=null;this.$=F;this.Ve=fa;this.we=new O(F.fa);this.Ez=new N(F,this.we);this.cof=Qa;this.w7b=new Map}function c(F,fa,Qa,Ab,Cc){this.VQc=null;this.MOb=F;this.Rz=fa;this.AI=Qa;this.vb=Ab;this.aug=Cc}function k(){}function n(){this.Kfa=null}function l(F){if(!F)throw OfficeExtension.WacRuntime.Utility.createRichApiException("InvalidArgument","wacApiDelegates parameter is null");this.ntd=F}function f(F,fa,Qa){return function(Ab){return function(Cc,
Vc){Wg.TaskExtensions.Ba(Zi.GetServiceTaskFactory.create(fa.da,279,fa.ma,1),function(qd){qd=qd.result;var Gd=!1,ve=Qa.Gi.getOsfControl(F),jf=null;ve&&(jf=ve.getStoreType(),(ve=ve.getManifest())&&ve.getSharedRuntimeForCustomFunctions("Workbook")&&(Gd=!0));Wg.TaskExtensions.Ba(qd.F8e(F,jf,Ab,Gd),function(gf){Sk.b(gf)?gf.result?Cc(null):Vc(OfficeExtension.WacRuntime.Utility.createRichApiException(Xi.a.invalidArgument,Fe.a.instance.ea(1712))):Vc(OfficeExtension.WacRuntime.Utility.createRichApiException(Xi.a.generalException,
Fe.a.instance.ea(1708)))},fa.ma,3)},fa.ma,3)}}}function u(F,fa){this.uO=hh.a.instance.mc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper");this.Rz=F;this.AI=fa;this.Pog=this.AI.Gi.getOsfControl(this.Rz)}function v(F,fa,Qa,Ab){this.W_d="";this.HQb=0;this.uO=F;this._id=fa;this.Rz=Qa;this.AI=Ab}function m(F,fa,Qa){this.fmg=F;this.gmg=fa;this.Ypg=Qa}function A(){this.Zee=this.$9d=this.Mz=!1}function x(F,fa,Qa,Ab){this.ms=F;this.f1=Qa;this.ly=Ab.Gi.getOsfControl(fa)}function t(F,fa){this.AI=
fa;this.Rz=F}function z(F){this.Rz=F}function r(F){this.THa={};this.sri=F}function G(F,fa){var Qa=this;Qa.Rdf=function(Ab,Cc){Ab=G.hZg(Ab,Cc);if(!Kj.a(Qa.$,Ab))return!0;Ab=Qa.$.shortcutKeyManager.P_e(Ab);return!!Ab&&0<Ab.length};Qa.addinId=F;Qa.$=fa;return Qa}function w(){}function B(){}function U(F,fa,Qa,Ab){this.Wth=F;this.fileSize=fa;this.Vuj=Ab}function N(F,fa){var Qa=this;this.JH=function(Ab,Cc){Qa.ZP.jJa(C.a.internalError,Cc)};this.$=F;this.ZP=fa}function P(F,fa,Qa,Ab){Qa=jj.call(this,576,0,
Qa,Ab)||this;Qa.pJd=new W("576",F,fa);return Qa}function ia(F,fa,Qa,Ab,Cc,Vc,qd,Gd){fa=Hh.call(this,10,0,fa,Gd)||this;fa.Mkb=Qa;fa.bhb=Ab;fa.f3=Cc;fa.DEa=Vc;fa.request=qd;fa.pJd=new W("10",F,qd);return fa}function W(F,fa,Qa){this.parentName=F;this.$=fa;this.request=Qa}function R(F,fa){this.source=F;this.eventId=fa}function I(F,fa,Qa,Ab,Cc,Vc){var qd=F.Oa(1);qd.request=fa;return Oi.i(F,"ExecuteRichApiRequest",qd,Qa,Ab,Cc,Vc,0)}function Q(F,fa,Qa){this.$=F;this.ZP=fa;this.Ez=Qa}function O(F){this.fa=
F}function ba(F,fa,Qa,Ab){F=Wd.call(this,F,"Select Data")||this;F.Jnb=null;F.qDe=fa;F.W3c=Qa;F.callback=Ab;return F}function ca(F){this.vb=F}function S(F){F.add("InternalTest","PreviewExecutionMethod",Y)}function Y(F,fa){console.log("InternalTestPreviewExecution.PreviewExecutionMethod: typeof(objectId)="+typeof F+", objectId="+F+", value="+fa);return null}function na(F,fa){this.Ong=F;this.mog=fa}function Z(F){var fa=F.addType("Microsoft.Office.ActionService","{b9b4137f-8502-4b7a-9f64-d9b7c69bf883}",
"{df562add-0bb3-47cb-9780-0bd6c054e5e8}",3,0);var Qa=fa.addMethod("AreShortcutsInUse",3,"Object[]",1,0,"AreShortcutsInUse",0);Qa.addParameter("shortcuts","String[]",1,null,0);fa.addMethod("GetShortcuts",1,"Object",1,1,"Shortcuts",0);Qa=fa.addMethod("ReplaceShortcuts",2,"Void",0,0,"ReplaceShortcuts",0);Qa.addParameter("shortcuts","Object",1,null,0);fa=F.addType("Microsoft.Office.SharedFilePicker","{209dd80f-a169-43dd-be1e-504a1a11a736}","{3f72536f-72cd-42d9-b4fd-eb8f8561e1f5}",3,0);Qa=fa.addMethod("GetSharedFilePickerResponse",
1,"Object",1,1,"SharedFilePickerResponse",0);Qa.addParameter("pickerCustomizationJsonString","String",1,null,0);fa=F.addType("Microsoft.ExcelServices.WacWorkbook","{79eea901-609d-4204-a8f6-9f40f367a679}","",3,0);Qa=fa.addMethod("CreateAndOpenWorkbook",1,"Void",0,1,"CreateAndOpenWorkbook",0);Qa.addParameter("base64File","String",1,null,0);fa=F.addType("Microsoft.ExcelServices.AppRuntimeService","{21351f4a-8ee5-42e7-9776-62f23a567703}","",3,0);fa.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",
1,1,"AppRuntimeState",0);Qa=fa.addMethod("SetAppRuntimeState",1,"Void",0,1,"SetAppRuntimeState",0);Qa.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);fa=F.addType("Microsoft.ExcelServices.CustomFunctionManager","{158db0d2-762c-449f-9917-b7c4778971ef}","{1a8cbe28-44d1-4b9a-9cd2-69311e909c1a}",3,0);fa.addProperty("Status",2,"Microsoft.ExcelServices.CustomFunctionEngineStatus",2,!0,null,0);Qa=fa.addMethod("Register",1,"Void",0,0,"Register",0);Qa.addParameter("metadata",
"String",1,null,0);Qa.addParameter("javascript","String",1,null,0);fa=F.addType("Microsoft.ExcelServices.CustomFunctionEngineStatus","{22864d76-d53e-416b-b496-23e5bb38ebd0}","",2,0);fa.addProperty("Enabled",1,"Boolean",1,!1,null,0);fa.addProperty("NativeRuntime",3,"Boolean",1,!1,null,0);fa.addProperty("StreamingEnabled",2,"Boolean",1,!1,null,0);fa=F.addEnumType("Microsoft.Authentication.IdentityType");fa.addEnumField("OrganizationAccount",0);fa.addEnumField("MicrosoftAccount",1);fa=F.addEnumType("Microsoft.Authentication.AuthorityType");
fa.addEnumField("External",0);fa.addEnumField("Msa",1);fa.addEnumField("Aad",2);fa=F.addType("Microsoft.Authentication.OfficeIdentityInfo","{4c070280-74b4-4850-adfd-178c6c287817}","{8b83e3cb-6183-4206-bbcf-cc019d857327}",2,0);fa.addProperty("DisplayName",4,"String",1,!1,null,0);fa.addProperty("Email",3,"String",1,!1,null,0);fa.addProperty("FederationProvider",2,"String",1,!1,null,0);fa.addProperty("IdentityType",1,"Microsoft.Authentication.IdentityType",1,!1,null,0);fa=F.addType("Microsoft.Authentication.AuthContext",
"{fd7bb67b-838a-4e86-84df-43023e360260}","{14d05e71-cb07-4eb7-bb51-93bc432750f9}",2,0);fa.addProperty("AppId",4,"String",1,!1,null,0);fa.addProperty("Authority",2,"String",1,!1,null,0);fa.addProperty("AuthorityType",3,"Microsoft.Authentication.AuthorityType",1,!1,null,0);fa.addProperty("IsAnonymous",5,"Boolean",1,!1,null,0);fa.addProperty("TenantId",6,"String",1,!1,null,0);fa.addProperty("Upn",1,"String",1,!1,null,0);fa=F.addType("Microsoft.Authentication.AuthenticationService","{3084014c-8862-4ad3-adf6-fb105947dd9a}",
"{799af6f3-8bf5-4859-8aca-7dd712862fca}",3,0);fa.addProperty("RoamingSettings",99,"Microsoft.Authentication.RoamingSettingCollection",3,!0,null,0);Qa=fa.addMethod("GetAccessToken",1,"Microsoft.Authentication.SingleSignOnToken",2,1,"AccessToken",4);Qa.addParameter("tokenParameters","Microsoft.Authentication.TokenParameters",2,null,0);fa.addMethod("GetAuthContext",3,"Microsoft.Authentication.AuthContext",2,1,"AuthContext",0);fa.addMethod("GetPrimaryIdentityInfo",2,"Microsoft.Authentication.OfficeIdentityInfo",
2,1,"PrimaryIdentityInfo",4);fa=F.addType("Microsoft.Authentication.TokenParameters","{d9b0bca1-16af-48a6-b707-3b2bc97b082e}","{6e979115-496c-4ded-8ffb-b21d9ae45a6c}",2,0);fa.addProperty("AuthChallenge",3,"String",1,!1,null,0);fa.addProperty("CorrelationId",7,"String",1,!1,null,0);fa.addProperty("Policy",4,"String",1,!1,null,0);fa.addProperty("Resource",2,"String",1,!1,null,0);fa.addProperty("Scope",5,"String",1,!1,null,0);fa.addProperty("SilentLogin",6,"Boolean",1,!1,null,0);fa=F.addType("Microsoft.Authentication.SingleSignOnToken",
"{dd692cad-089f-4adf-b070-bb12a957fef1}","{21e799a6-33ec-4ec7-8e74-fe7c4765a59f}",2,0);fa.addProperty("AccessToken",2,"String",1,!1,null,0);fa.addProperty("TokenIdenityType",3,"Microsoft.Authentication.IdentityType",1,!1,null,0);fa=F.addType("Microsoft.Authentication.RoamingSetting","{4f7e9fad-cbd7-4d76-8dab-9a2f7dc00141}","",3,0);fa.addProperty("Id",1,"String",1,!0,null,0);fa.addProperty("Value",2,"Object",1,!1,null,0);fa=F.addType("Microsoft.Authentication.RoamingSettingCollection","{f9e004e4-a087-42ec-b22d-51ac584551a9}",
"",3,0);Qa=fa.addMethod("GetItem",1,"Microsoft.Authentication.RoamingSetting",3,1,"Item",0);Qa.addParameter("id","String",1,null,0);Qa=fa.addMethod("GetItemOrNullObject",2,"Microsoft.Authentication.RoamingSetting",3,1,"ItemOrNullObject",0);Qa.addParameter("id","String",1,null,0);fa=F.addType("Microsoft.AppRuntime.AppRuntimeService","{a9f1fc0a-741e-4882-87e1-025d6f8024e7}","{43a4559c-806b-4e89-914e-da9256212148}",3,0);fa.addMethod("GetAppRuntimeState",2,"Microsoft.AppRuntime.AppRuntimeState",1,1,"AppRuntimeState",
0);Qa=fa.addMethod("SetAppRuntimeState",1,"Void",0,0,"SetAppRuntimeState",0);Qa.addParameter("appRuntimeState","Microsoft.AppRuntime.AppRuntimeState",1,null,0);fa=F.addEnumType("Microsoft.AppRuntime.AppRuntimeState");fa.addEnumField("Inactive",0);fa.addEnumField("Background",1);fa.addEnumField("Visible",2);fa=F.addEnumType("Microsoft.AppRuntime.Visibility");fa.addEnumField("Hidden",1);fa.addEnumField("Visible",2);fa=F.addType("Microsoft.DynamicRibbon.DynamicRibbon","{967ecb27-5cdb-41a1-8383-04fc1d6e118f}",
"{a652fd4a-c501-486a-8cb6-ed52946eca50}",3,0);fa.addProperty("Buttons",4,"Microsoft.DynamicRibbon.RibbonButtonCollection",3,!0,null,0);Qa=fa.addMethod("ExecuteRequestCreate",7,"Void",0,1,"ExecuteRequestCreate",0);Qa.addParameter("jsonCreate","String",1,null,0);Qa=fa.addMethod("ExecuteRequestUpdate",6,"Void",0,1,"ExecuteRequestUpdate",0);Qa.addParameter("jsonUpdate","String",1,null,0);Qa=fa.addMethod("GetButton",3,"Microsoft.DynamicRibbon.RibbonButton",3,1,"Button",0);Qa.addParameter("id","String",
1,null,0);Qa=fa.addMethod("GetTab",5,"Microsoft.DynamicRibbon.RibbonTab",3,1,"Tab",0);Qa.addParameter("id","String",1,null,0);fa.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);fa=F.addType("Microsoft.DynamicRibbon.RibbonTab","{c68e16e8-67dd-48cf-b92f-46b40ca336ee}","",3,0);fa.addProperty("Id",2,"String",1,!0,null,0);Qa=fa.addMethod("SetVisibility",3,"Void",0,0,"SetVisibility",0);Qa.addParameter("visibility","Boolean",1,null,0);fa.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);fa=F.addType("Microsoft.DynamicRibbon.RibbonButton",
"{88e27ee2-4787-4d0d-8ff7-788a8be7c8c5}","",3,0);fa.addProperty("Enabled",3,"Boolean",1,!1,null,0);fa.addProperty("Id",2,"String",1,!0,null,0);fa.addProperty("Label",4,"String",1,!0,null,0);Qa=fa.addMethod("SetEnabled",5,"Void",0,0,"SetEnabled",0);Qa.addParameter("enabled","Boolean",1,null,0);fa.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);fa=F.addType("Microsoft.DynamicRibbon.RibbonButtonCollection","{208b41cf-a38c-47cd-83fc-0ff0c4848ec3}","",3,0);fa.addMethod("GetCount",3,"Int32",1,1,"Count",
0);Qa=fa.addIndexerMethod(2,"Microsoft.DynamicRibbon.RibbonButton",3,0);Qa.addParameter("key","String",1,null,0);fa.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0);fa.setCollectionInfo("Microsoft.DynamicRibbon.RibbonButton",!0);fa=F.addEnumType("Microsoft.Office.Licensing.LicenseFeatureTier");fa.addEnumField("Unknown",0);fa.addEnumField("Basic",1);fa.addEnumField("Premium",2);fa=F.addType("Microsoft.Office.Licensing.License","{db7c13ab-8285-4ff7-88d6-c9e7b2ca9b12}","{89df9b4a-85de-42d7-89d1-de8bc29e6df0}",
3,0);Qa=fa.addMethod("GetFeatureTier",2,"Microsoft.Office.Licensing.LicenseFeatureTier",1,1,"FeatureTier",0);Qa.addParameter("feature","String",1,null,0);Qa.addParameter("fallbackValue","Microsoft.Office.Licensing.LicenseFeatureTier",1,null,0);Qa=fa.addMethod("GetLicenseFeature",5,"Microsoft.Office.Licensing.LicenseFeature",3,1,"LicenseFeature",0);Qa.addParameter("feature","String",1,null,0);Qa=fa.addMethod("IsFeatureEnabled",1,"Boolean",1,1,"IsFeatureEnabled",0);Qa.addParameter("feature","String",
1,null,0);Qa.addParameter("fallbackValue","Boolean",1,null,0);fa.addMethod("IsFreemiumUpsellEnabled",3,"Boolean",1,1,"IsFreemiumUpsellEnabled",0);Qa=fa.addMethod("LaunchUpsellExperience",4,"Void",0,1,"LaunchUpsellExperience",0);Qa.addParameter("experienceId","String",1,null,0);Qa=fa.addMethod("_TestFireStateChangedEvent",6,"Void",0,0,"_TestFireStateChangedEvent",4);Qa.addParameter("feature","String",1,null,0);fa=F.addType("Microsoft.Office.Licensing.LicenseFeature","{5af0b996-137f-447f-99be-8749e73546c8}",
"",3,0);fa.addProperty("Id",5,"String",1,!0,null,0);fa.addMethod("_RegisterStateChange",6,"Void",0,1,"_RegisterStateChange",0);fa.addMethod("_UnregisterStateChange",7,"Void",0,1,"_UnregisterStateChange",0);fa=F.addType("Microsoft.InternalService.AddinInternalService","{4ddc0abf-728b-44e0-b834-138c166e2651}","{16374866-b755-4a62-8e65-ad23696872b0}",3,0);fa.addMethod("NotifyActionHandlerReady",1,"Void",0,1,"NotifyActionHandlerReady",0);fa=F.addType("Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification",
"{d689e1c3-2ec7-4e8d-9327-7d6703cde2c5}","{bc4e14a3-3463-425f-8e52-07b578e4c4b7}",3,0);fa.addMethod("Disable",3,"Void",0,1,"Disable",0);fa.addMethod("Enable",2,"Void",0,1,"Enable",0);fa.addMethod("_OnAccess",1,"Void",0,1,"_OnAccess",0)}function wa(F,fa,Qa,Ab){this.menuItemId=F;this.bI=fa;this.wyj=Qa;this.fuh=Ab}function ma(F){this.Opi=F}function pa(F){this.cxa=F;this.Djg=kg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AppForOfficeSSOV2MSA",!1)}function Ia(){}function Ma(){}
function ob(){}function Cb(F,fa){this.jgb=fa;this.Rz=F}function Xa(){this.f_d=null;this.nde=this.bUb=this.nD="";this.Aee=!0;this.options=null}function Sb(F,fa){this.hfb=F;this.Lhb=fa}function Tb(){}function da(){this.D3d=this.U2d=this.Iea=null;this.Lhb=0}function ya(F){var fa=el.call(this)||this;fa.$=F;fa.dc();return fa}function hb(F,fa,Qa){this.wgg=null;this.ygg=0;this.ub=F;this.Og=fa;this.C0d=Qa}function Gb(){}function Qb(F,fa,Qa,Ab,Cc){var Vc=$k.call(this)||this;Vc.Fbb={};Vc.g$c={};Vc.Fva=null;
Vc.L9a=null;Vc.KYh=function(qd,Gd,ve,jf,gf){if(2!==ve)return 32;qd=gf[pk.a.n7b];ve=gf[pk.a.GGa];gf=gf[pk.a.iya];Gd=new Ej.a;Gd.E6h=gf.ni.InstanceToken;Gd.al=gf.ni[le.al];Gd.QR=gf.ni[le.QR];le.taskPaneWidth in gf.ni&&(Gd.taskPaneWidth=gf.ni[le.taskPaneWidth]);Gd.sourceLocationOverrideResourceId=gf.ni[le.sourceLocationOverrideResourceId];Gd.DH=gf.Sq;Gd.onTaskPaneClose=gf.ni[le.onTaskPaneClose];Gd.GGa=ve;ve=new ak.a(-859308420,0,2,0,"");jf=qd.getStoreType()===OSF.StoreType.Sdx;var qg=new Ee;qg.xaa=gf.ni.HeaderCssClass||
Wc.a.tIa;qg.hyc=gf.ni.TitleCssClass;Vc.j0(ve,qd.getId(),Gd,jf,qg);return 32};Vc.vYh=function(qd,Gd,ve,jf,gf){if(2!==ve)return 32;qd=gf[pk.a.n7b].getId();gf=gf[pk.a.iya].ni[le.sourceLocationOverrideResourceId];return qd?(Vc.Ve.Gi.refreshOsfControl(qd,gf),32):8};Vc.xSi=function(qd){qd=qd.Result;if(qd=null===qd?null:qd.SolutionId)Vc.Ve.Wie(qd),gk.a(Vc.$).zma(3,qd)};Vc.lEf=function(qd,Gd){var ve=(qd=qd.Result)?qd.AgaveData:null;if(ve){Se.ULS.shipAssertTag(537170434,0,ve.TaskpaneWidth===Qb.X8g,"Taskpane width is {0}, assetId is {1}.",
ve.TaskpaneWidth,ve.PrimaryMarketplace.SolutionId);var jf=Vc.g$c[ve.PrimaryMarketplace.SolutionId];jf&&(jf.Ixc&&(ve.TaskpaneTitle=jf.Ixc),jf.Gxc&&(ve.TaskpaneIconId=jf.Gxc),jf.uSd&&(ve.TaskpaneButtonTooltip=jf.uSd),0<jf.nr&&(ve.TaskpaneWidth=jf.nr));Gd&&(ve.FocusOnIframeWhenLoaded=Gd.focusOnIframeWhenLoaded,Gd.width&&(ve.TaskpaneWidth=Gd.width),ve.TaskpaneIconCssClass=Gd.Vj,ve.TaskpaneHeaderCssClass=Gd.xaa,ve.TaskpaneTitleCssClass=Gd.hyc);Vc.Fbb[ve.PrimaryMarketplace.SolutionId]&&(ve.OsfPropertyBag=
Vc.cud(ve.OsfPropertyBag,ve.PrimaryMarketplace.SolutionId));dl.a(ve)||(ve.WebExtensionOsfControlType=1);ve&&(Vc.Ve.Wie(qd.SolutionId),Vc.Ve.z_a(ve))}else Se.ULS.sendTraceTag(593285650,220,10,"AgaveCommandHandler.PostInsertAgaveTaskpaneSuccess: failed to return valid response.")};Vc.rth=function(qd){qd&&(Vc.m9c.Dff(qd),Vc.lue())};Vc.nEf=function(qd){qd=qd.toDataURL("image/jpeg");var Gd=Vc.Ve.U$(Qb.f5e+"."+Qb.G1e);OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(Gd,"onScreenshot",{screenshot:qd},
function(){})};Vc.ZWh=function(qd,Gd,ve,jf,gf){if(2!==ve)return 32;if(Bi.a.yj(gf)||gf[pk.a.wye]!==rj.a.action)return 8;Gd=gf[pk.a.iya];return Gd?(qd=(qd=Vc.MNh(gf))?Vc.Ve.U$(qd):null)?(gf=Vc.Ve.n_g(gf[pk.a.GGa],Gd.ni[le.sRc]),Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5295210_SdxTaskpaneTitleOverrideNew")&&(ve=Vc.Ve.YY(qd),ve.TaskpaneTitle!==Gd.ni[le.al]&&(ve.TaskpaneTitle=Gd.ni[le.al],ve.TaskpaneIconCssClass=Gd.ni.IconCssClass,ve.TaskpaneIconUrl=Gd.ni.TaskPaneIconUrl,ve.TaskpaneIconId=Gd.ni.TaskPaneIconId,
Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")?(Gd=Vc.Ve.Gi,Gd.changeIframeTitle(qd,ve.TaskpaneTitle),ve=Gd.getOsfControl(qd),Gd.raiseOsfControlStatusChange(ve)):(Gd=Vc.Ve.Gi.getOsfControl(qd),Vc.Ve.Gi.raiseOsfControlStatusChange(Gd)))),OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(qd,gf,Vc.RHb),32):8:8};Vc.RHb=function(qd,Gd){Vc.Ve.Zvh(qd,Gd)};Vc.$=F;Vc.viewBlockContainerHelpers=Qa;Vc.Ve=fa;Vc.m9c=Ab;Vc.Di=Cc;Vc.Di.$b(Jh.a.s_f,mi.a.frame,Vc.KYh);
Vc.Di.$b(Jh.a.QPf,mi.a.frame,Vc.vYh);Vc.Di.$b(Jh.a.iOe,mi.a.frame,Vc.ZWh);return Vc}function Fb(){var F=Rk.call(this)||this;F.fUa="calc(100% - 46px)";F.APb="15px";F.gUa="0";F.pjg="WACDialogPanel";F.xCa=695;F.qjg=462;F.Hgb="80%";F.fhg=350;F.y_d="100%";F.kc=5;F.Me="AppsForOfficeInsertionDialog";F.OFc=!!kg.AFrameworkApplication.ga&&kg.AFrameworkApplication.ga.ra("OfficeAddinEnableInsertDialogAccessibilityFix");return F}function ta(){var F=xa.call(this)||this;F.isTable=!1;F.isPivotTable=!1;F.hasTableHeaders=
!1;F.tableName=null;F.userSelectedPivotTable=!1;return F}function xa(){this.addressWithSheet=this.address=this.sheetName=this.sheetId=null;this.columnIndex=this.columnCount=this.rowIndex=this.rowCount=0;this.isSheetEmpty=!1;this.selectionType=null}function sa(){this.uSd=this.Ixc=null;this.nr=0;this.Gxc=null}function lb(){var F=this;this.Ve=null;this.d$a=function(fa,Qa,Ab,Cc,Vc){if(2===Ab){fa=Vc?Vc:{};Qa=fa.callback;if(!Qa)return 16;F.Ve.tDd(Qa,fa.refresh?fa.refresh:!1)}return 32};this.h1i=function(fa,
Qa,Ab,Cc,Vc){2===Ab&&(fa=Vc?Vc.callback:null)&&F.Ve.Pzg(fa);return 32}}function Yb(F,fa){this.Mjb=fa}function Fa(F){return Pi.call(this,F)||this}function Sa(F){var fa=sk.call(this)||this;fa.$=F;fa.isFirstLaunch=!1;return fa}function Ra(F){Se.ULS.sendTraceTag(41521353,1313,50,"SmartLookupManager - Initialize");this.Jkf=kg.AFrameworkApplication.ga.ra("IsTellMeUpSellEnterpriseEnabled");this.fpi=kg.AFrameworkApplication.ga.Ua("SmartLookupApprovedOriginPattern");this.k7a=kg.AFrameworkApplication.ga.Ua("SmartLookupShredderServiceEndpoint");
this.Mpi=nk.a.oM(kg.AFrameworkApplication.ga.Ua("AppCatalogUrl")||"");this.j7a=new xb;this.j7a.EnableAllTabV2=!0;this.j7a.EnableIntentService=!0;this.j7a.EnableInDocumentSearch=kg.AFrameworkApplication.ga.ra("SmartLookupEnableInDocumentSearch");this.j7a.EnableLocalSearch=kg.AFrameworkApplication.ga.ra("SmartLookupEnableLocalSearch");this.j7a.IntentServiceEndpoint=Lb.hRh();this.Gpi=new Ja(F,this.k7a)}function Lb(){}function Ja(F,fa,Qa){this.WCj=9E5;this.ZCj=3E5;this.Usd=null;this.ekf="";this.Rsd=0;
this.nDe=Date.now;this.cxa=F;this.k7a=fa;(void 0===Qa||Qa)&&this.fbd()}function xb(){}function Kb(){}function Eb(){}function Hc(){}function Xc(){}function Pc(F,fa,Qa,Ab,Cc,Vc){this.$=F;this.agaveCommandManager=Vc}function wd(F){var fa=Nj.call(this)||this;fa.ddaFacade=null;fa.PIf=null;fa.$=F;F.da.Ha(106,fa);fa.dc();return fa}function Tc(){}function ub(){}function fb(F){this.IEa=F}function Ta(F,fa,Qa){this.iframe=F;this.onSuccess=fa;this.onError=Qa;$addHandler(window,"message",Object(Ri.a)(this,this.u3e,
"handleResponse"))}function eb(F,fa){return Ke.a.zrd(42,function(){return window.OfficeExtension&&window.OfficeExtension.WacRuntime},kg.AFrameworkApplication.ga.zd("MaxRetriesForLoadingScript",0),F,fa)}function tb(F){var fa=Uh.call(this)||this;fa.$=F;fa.dc();return fa}function rc(F,fa){var Qa=this;this.fPa=this.gPa=null;this.Q6f=function(Ab,Cc){var Vc=null,qd=null,Gd=null;Cc?(Object(qj.a)(287,Cc)?(Vc=Cc.qFa,Gd=Cc.instanceId):Object(qj.a)(478,Cc)&&(Vc=Cc.get_element(),Gd=Cc.instanceId),Vc)?(qd=Object(Wi.a)(791,
Ab),qd)?Qa.QIf(Gd,Vc,qd)||Gd in Qa.fPa||(Qa.gPa[Gd]=0,Qa.fPa[Gd]=Yh.a.instance.XB(function(){10<=Qa.gPa[Gd]||Qa.QIf(Gd,Vc,qd)?(delete Qa.gPa[Gd],Qa.fPa[Gd].dispose(),delete Qa.fPa[Gd]):Qa.gPa[Gd]+=1},500,si.a.YDg,!0,!1)):Se.ULS.sendTraceTag(537170624,0,10,"The AgaveOnSelectedReadoutEvent raised from a null object."):Se.ULS.sendTraceTag(537170625,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."):Se.ULS.sendTraceTag(537170626,0,10,"Invalid parameter for ReadoutSelection")};
this.ariaLiveNotifier=F;this.$=fa;this.CVc=!1;this.$.da.Ha(224,this)}function wb(F){var fa=Hi.call(this)||this;fa.$=F;fa.dc();return fa}function E(F){var fa=Ui.call(this,F)||this;fa.handler=null;fa.Xug=function(){Se.ULS.sendTraceTag(38410434,0,50,"AddinUICommandHandlerFactory.ActivateFeature, isEditMode [{0}] ShowCommandUI [{1}]",fa.$.isEditMode,!!(fa.$.Fd&16384));var Qa=new mj.a;fa.$.da.Za(53,function(gf){Se.ULS.sendTraceTag(38410435,0,50,"AddinUICommandHandlerFactory.ActivateFeature success to get service IRibbonManager");
Qa.setResult(gf)});var Ab=Qa.task,Cc=new Af,Vc=Ik.a.getInstance(),qd=new je(fa.$,Vc),Gd=Zi.GetServiceTaskFactory.create(fa.$.da,203,fa.ma,fa.tb),ve=fa.k0i(Cc),jf=Zi.GetServiceTaskFactory.Xa(fa.$.da,349,350,fa.tb);return Wg.TaskExtensions.Ba(Wg.TaskExtensions.ve([Ab,Gd,ve,jf],fa.ma),function(){Se.ULS.sendTraceTag(38942482,0,50,"AddinUICommandHandlerFactory.ActivateFeature, ContinueWith after realated task finished.");Wg.TaskExtensions.Ba(Zi.GetServiceTaskFactory.create(fa.$.da,106,fa.ma,fa.tb),function(gf){fa.handler=
new ka(fa.$,gf.result,Cc,new Lf,Vc,qd,hh.a.instance.Hh("Common.IExternalUICommandDefinitionMapping"));Se.ULS.sendTraceTag(38410436,0,50,"AddinUICommandHandlerFactory.ActivateFeature, OnCommandHandlersCreated");fa.Ed([fa.handler]);fa.$.da.Ha(198,fa.handler)},fa.ma,3)},fa.ma,3)};fa.g8g=function(){void 0!==fa.handler&&null!==fa.handler?(fa.$.Ka.L$a(fa.handler),fa.$.da.gU(198),fa.handler=null):Se.ULS.sendTraceTag(42341715,0,50,"AddinUICommandHandlerFactory.DeactivateFeature: handler is not defined, it might have never been activated.");
fa.$.da.gU(204);$i.a(wi.a,21,fa.$.da,198)};return fa}function Mb(F,fa,Qa,Ab){this.UNd=void 0===F?null:F;this.yRc=void 0===fa?null:fa;this.X3c=void 0===Qa?null:Qa;this.z7b=void 0===Ab?0:Ab}function ka(F,fa,Qa,Ab,Cc,Vc,qd){var Gd=this;qd=void 0===qd?null:qd;this.disposed=!1;this.Ma=new Fj.a;this.xzj=3E5;this.EOd=!0;this.PTc="addinActivated";this.ezi=function(ve,jf){if(jf)if(jf)if(ve=jf.Fg){jf=jf.nl;var gf=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap();if(ve.assetId in gf)jf=
gf[ve.assetId];else if(jf=Gd.WFh(jf),void 0===jf||null===jf){Se.ULS.sendTraceTag(528098434,220,15,"addinCommandControlId is NullOrUndefined");return}gf=new ak.a(Jh.a.d2,0,0,2,null);var qg={};Gd.executeCommand(0,gf,(qg.SourceControlId=jf,qg),null);ve.isAutoLaunched=!0;Se.ULS.sendTraceTag(528098433,220,50,"OnAutoLaunchAddin succeed")}else Se.ULS.sendTraceTag(528098435,220,15,"insertionParam is null");else Se.ULS.sendTraceTag(528098436,220,15,"agaveParams is null");else Se.ULS.sendTraceTag(528098437,
220,15,"No args for OnAutoLaunchAddin event")};this.oGi=function(ve,jf){ve=null;jf&&(ve=jf);(null===ve||void 0===ve?0:ve.nl)&&Gd.Kkj(ve.nl);Gd.$.Gf();Ag.EwaSettings.la(87)&&ve&&ve.Fg&&Gd.GIg(ve.Fg)};this.$=F;Se.ULS.shipAssertTag(537170659,0,!(void 0===fa||null===fa),"AddinUICommandHandler constructor error - ddaFacade param should not be null, stack: {0}",Bh.a.V2());this.Ve=fa;this.hze=Qa;this.dYb=Ab;this.uga=Cc;this.zmb=Vc;this.hl=new Wh.a;this.tga=new rd;this.Z8c=qd;ac.a.Zvb=ac.a.eOe;this.g4c=new Ph.a;
this.p0a=new Ph.a}function bb(F){var fa=this;this.gFa=this.kFa=this.Fg=this.nl=null;this.hqc=0;this.nGi=function(){if(fa.Fg&&fa.gFa){var Qa=new ak.a(Jh.a.d2,0,0,2,null),Ab={};fa.addinUICommandHandler.executeCommand(0,Qa,(Ab.SourceControlId=fa.gFa,Ab),null);Se.ULS.sendTraceTag(537170697,220,50,"Launch addin command has been triggered")}};this.Arj=function(Qa,Ab){Qa=null;if(Ab)if(Qa=Ab,fa.Fg=Qa.Fg,fa.nl=Qa.nl,fa.nl&&fa.nl.pK&&fa.nl.pK.fq&&(fa.kFa=fa.nl.pK.fq.na(0)),fa.kFa&&fa.kFa.id)if(fa.kFa.isOfficeTab)if(Ab=
OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap(),fa.Fg.assetId in Ab?fa.gFa=Ab[fa.Fg.assetId]:(Se.ULS.sendTraceTag(537170695,220,15,"Failed to get button id from controlIdMap for add-in: {0}",Telemetry.PrivacyRules.GetAssetId(fa.Fg.storeType,fa.Fg.storeId,fa.Fg.assetId)),fa.gFa=fa.sCh(fa.nl)),fa.gFa)if(Rj.a.contains(fa.kFa.id,Ni.a.eW,!0))appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(Kf.a.htb(fa.nl),function(){fa.u0f(fa.led(fa.gFa))});else{if(Ab=fa.$.Ka)Ab.Vle(fa.gAf),
Se.ULS.sendTraceTag(537170693,220,50,"ShowCalloutOnAddin registered a tab switched event")}else Se.ULS.sendTraceTag(537170694,220,10,"Failed to get button id for addin"),Ab={},Ab=(Ab.AppTeachingUICalloutAction="NoEnabledButtonFound",Ab["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(fa.Fg.storeType,fa.Fg.storeId,fa.Fg.assetId),Ab.AppTeachingUICalloutGoal="NewAdminDeployment",Ab["SDX.AppInstallOrigin"]="Organization",Ab),Vh.a.sendTelemetryEvent(Object.assign(new ui.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:Kc.a.Fk(Ab)}));else fa.w0f(fa.led(fa.kFa.id),0);else Se.ULS.sendTraceTag(537170696,220,10,"ShowCalloutOnAddin finds that the ribbon extensibility has no tab id"),Ab={},Ab=(Ab.AppTeachingUICalloutAction="NoTabFound",Ab["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(fa.Fg.storeType,fa.Fg.storeId,fa.Fg.assetId),Ab.AppTeachingUICalloutGoal="NewAdminDeployment",Ab["SDX.AppInstallOrigin"]="Organization",Ab),Vh.a.sendTelemetryEvent(Object.assign(new ui.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:Kc.a.Fk(Ab)}))};this.gAf=function(){if(Rj.a.contains(fa.kFa.id,appChrome.selectors.getSelectedTabId(),!0)){var Qa=fa.$.Ka;Qa&&Qa.iNf(fa.gAf);fa.u0f(fa.led(fa.gFa))}};this.$=F.$;this.addinUICommandHandler=F;this.hl=new Wh.a}function Ga(F,fa){this.LDa=F;this.oea=new Jb;this.yea=new Zb(fa)}function Ha(F,fa,Qa,Ab,Cc,Vc){F=kb.call(this,F,fa)||this;F.a8=null;F.Bea=null;F.Eea=null;F.yea=Qa;F.jlg=Ab;F.eDc=Cc;F.V0=Vc;return F}function Ua(F){this.kde=null;if(cj.c(F))throw Se.ULS.sendTraceTag(9041813,
220,10,"ScalingDefinition type should not be null or undefined."),Error.create("ScalingDefinition type should not be null or undefined");this.Qqg=F}function kb(F,fa){this.pfe=new Ph.a;this.Ew=this.qv=null;this.Yib=F;this.oea=fa}function $a(F){this.lde=this.u4d=this.lfe=null;this.isOfficeTab=!1;this.k2e=this.hSf=null;this._id=F;this.XRa[Sg.a.id]=this._id}function Xb(F){this.o1d=this.t4d=this.Rkb=null;if(cj.c(F))throw Se.ULS.sendTraceTag(9041811,220,10,"GroupDefinition id should not be null or undefined."),
Error.create("GroupDefinition id should not be null or undefined");this._id=F;this.ava[Sg.a.id]=this._id}function dc(F,fa,Qa,Ab,Cc,Vc){this.yOb=new Ph.a;this.a8=this.Ew=this.qv=null;this.Yib=F;this.oea=fa;this.yea=Qa;this.ms=Ab;this.V0=Cc;this.r3d=Vc}function Za(){this.groups=this.attributes=this.title=this.id=null;this.visible=this.isOfficeTab=!1;this.insertAfter=this.insertBefore=this.tabType=null;this.autoFocus=!1}function Wa(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.attributes=
null}function Ba(){this.controls=this.title=this.mlrId=this.id=null;this.groupType=0;this.attributes=null}function db(){this.iconLocation=this.title=this.id=null;this.enabled=!1;this.controlType=0;this.attributes=this.menuItems=null}function Zb(F){this.jCa=F}function Jb(){}function Ic(F,fa){this.Rkb=new uc(F,fa)}function uc(F,fa){this.Tsg=F;this.Gig=fa}function za(F){this.LDa=F}function pb(F,fa,Qa){this.zI=this.oUa=null;this.Yib=F;this.yea=fa;this.oea=Qa;this.Ung=new Ph.a}function cc(F){this.Z7=null;
if(cj.c(F))throw Se.ULS.sendTraceTag(9175314,220,10,"OfficeMenuDefinition id should not be null or undefined."),Error.create("OfficeMenuDefinition id should not be null or undefined");this._id=F}function Ac(F){this.lLc=null;if(cj.c(F))throw Se.ULS.sendTraceTag(9175313,220,10,"MenuItemDefinition id should not be null or undefined."),Error.create("MenuItemDefinition id should not be null or undefined");this._id=F;this.RQ[Sg.a.id]=this._id}function ad(F,fa){this.hfa=this.n1d=null;if(cj.c(F)||cj.c(fa))throw Se.ULS.sendTraceTag(9175312,
220,10,"ControlDefinition id or type should not be null or undefined."),Error.create("ControlDefinition id or type should not be null or undefined");this.p1d=fa;this._id=F;this.hA[Sg.a.id]=this._id}function Jd(F,fa,Qa,Ab,Cc,Vc,qd,Gd){Gd=void 0===Gd?null:Gd;this.Ya=new Mc.a;this.zoa=F;this.m1d=fa;this.Ml=Qa;this.Lqa=Ab;this.Q8=Cc;this.CZd=Vc;this.V0=qd;this.P$d=Gd;this.r8=kg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoLaunchAddinEnabled",!1);this.see=kg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowAddinSurveyEnabled",
!1);this.wpa=kg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoLaunchAddinTelemetryEnabled",!1)}function Xd(F,fa,Qa,Ab,Cc,Vc,qd){this.Bda=new Dk.a;this.Fm=F;this.Gi=fa;this.hl=Qa;this.ribbonManager=Ab;this.contextMenuManager=Cc;this.ZA=Vc;this.tga=qd;this.fI=kg.AFrameworkApplication.sa.fD}function od(F,fa,Qa){this.DZd=this.eventBuilder=this.contextMenuBuilder=this.ribbonBuilder=this.actionBuilder=this.commandSurface=null;this.ribbonBuilder=F;this.eventBuilder=fa;
this.contextMenuBuilder=Qa}function Je(F){this.Ijg=F.entitlement}function bc(F,fa,Qa,Ab,Cc){fa=void 0===fa?null:fa;Qa=void 0===Qa?null:Qa;Ab=void 0===Ab?null:Ab;Cc=void 0===Cc?0:Cc;if(cj.c(F)&&cj.c(fa))throw Se.ULS.sendTraceTag(9041814,220,10,"One of parameters out of tab and oneLineRibbonExtensibilityObject should not be null or undefined."),Error.create("One of parameters out of tab and oneLineRibbonExtensibilityObject should not be null or undefined.");this.OX=F;this.Hog=fa;this.bsg=Qa;this.ljb=
Ab;this.Jkg=Cc}function Qd(F){this.K$d=null;if(cj.c(F))throw Se.ULS.sendTraceTag(9175315,220,10,"The agave key should not be null or undefined."),Error.create("The agave key should not be null or undefined");this.ggg=F}function Vd(){}function de(){}function pe(F){this.I7d=null;this.F5d=F}function Ad(F,fa,Qa){this.Ya=F;this.q8=fa;this.EZd=Qa}function Pd(F,fa,Qa,Ab,Cc,Vc,qd){this.Fm=F;this.Fg=fa;this.wR=Qa;this.kad=Ab;this.pSe=Cc;this.displayName=Vc;this.Yff=qd}function Ce(){var F=Nf.call(this)||this;
F.Fg=null;F.nl=null;return F}function Jf(){new oc(of.a.instance)}function oc(F){this.wDa=F}function ed(){this.Ver=1}function wc(){}function gb(F){this.Oog=F}function id(F,fa,Qa){this.Ma=new Mc.a;this.context=new Yd;this.nVc=this.sga=this.Xca=this.BOb=null;this.contextActivationMgr=F;this.hDg=fa;this.eYb=Qa;this.appName=kg.AFrameworkApplication.ga.Ua("WebAppShortName")}function ib(F){var fa=Ud.call(this)||this;fa.solutionId=F.solutionId;fa.assetId=F.assetId;fa.storeType=F.storeType;fa.storeId=F.storeId;
fa.assetStoreId=F.assetStoreId;fa.targetType=F.targetType;fa.width=F.width;fa.height=F.height;fa.displayName=F.displayName;fa.version=F.version;return fa}function nc(){this.addinId=null;this.targetType=0;this.assetId=null}function Nb(F,fa,Qa,Ab){this.aHb=kg.AFrameworkApplication.ga.Ua("RoamingServiceHandlerWebServiceBase");this.appName=F;this.xhb=fa;this.thb=Qa;this.Fjb=void 0===Ab?null:Ab}function mb(F){var fa=Nd.call(this)||this;fa.properties=F;return fa}function Lc(F){var fa=-1;switch(F.toLowerCase()){case "omex":fa=
0;break;case "spcatalog":fa=1;break;case "spapp":fa=2;break;case "filesystem":fa=3;break;case "exchange":fa=4;break;case "registry":fa=6;break;case "inmemory":fa=7;break;case "uploadfiledevcatalog":fa=8;break;case "hardcodedpreinstall":fa=9;break;case "excatalog":fa=10;break;case "wopicatalog":fa=16}return fa}function zd(F){var fa=null;switch(F){case 0:fa="omex";break;case 1:fa="spcatalog";break;case 2:fa="spapp";break;case 3:fa="filesystem";break;case 4:fa="exchange";break;case 6:fa="registry";break;
case 7:fa="inmemory";break;case 8:fa="uploadfiledevcatalog";break;case 9:fa="hardcodedpreinstall";break;case 10:fa="excatalog";break;case 16:fa="wopicatalog"}return fa}function jd(F){var fa={};fa.solutionId=F.solutionId;fa.version=F.version;fa.storeType=F.storeType;fa.storeId=F.storeId;fa.assetId=F.assetId;fa.assetStoreId=F.storeType;fa.targetType=F.targetType;fa.requireConsent=F.requireConsent||!1;fa.isAddinCommands=!0;fa.id=F.solutionId;fa.appVersion=F.version;fa.currentStoreType=F.storeType;return fa}
function ge(){}function Yd(){this.Fm=this.y_=0;this.QTc=null;this.Qoc=this.tyc=0;this.V1b=this.X1a=this.gra=null}function rd(){this.NXa=null}function je(F,fa){var Qa=jb.call(this)||this;Qa.statusBarManager=null;Qa.agaveCommandManager=null;Qa.hwe=function(){Qa.ZA&&Qa.ZA.Rve()};Qa.n2e=function(){Qa.raiseEvent("LAC")};Qa.Zc=function(Ab,Cc){!Ab.oc&&va.b(Cc)&&Qa.statusBarManager&&(Qa.statusBarManager.iF(Qa),Qa.statusBarManager=null)};Qa.ZA=fa;Qa.$=F;Qa.Sxj=F.Ib+"OfficeAddinLabel-Medium14";Qa.$.da.Za(29,
function(Ab){Qa.statusBarManager=Ab;Ab.$I(Qa)});Qa.$.fa.Sj(Qa.Zc);Qa.ZA.fzg(Qa.n2e);Qa.$.da.Za(206,function(Ab){Qa.agaveCommandManager=Ab;Ab.JAg(Qa.hwe)});return Qa}function re(){}function ae(){this.Bi=null;this.visible=!1}function Uf(F,fa){this.Sa=F;this.AYg=fa}function Lf(){this.j_d=this.jCc=null}function Of(F){this.Cce=new Yf(F)}function Yf(F){this.S8=F;this.lUb=this.S8.ribbonBuilder}function vg(){var F=Mj.call(this)||this;F.Sjd=null;F.zjd=null;F.ribbon=null;return F}function Af(){this.Bhg=new Ph.a}
function rf(F){return Gk.call(this,F)||this}function Cg(F){var fa=this;this.Dqb=null;this.G3c=!1;this.RT=this.ee=null;this.$=F;Wg.TaskExtensions.Ba(Zi.GetServiceTaskFactory.Xa(this.$.da,328,327,1),function(Qa){(Qa=Qa.result)?(Se.ULS.sendTraceTag(537163346,0,50,"DataFromPicturePaneCommandManager::Initialize - AugmentationLoopManager instantiated."),fa.Dqb=new sc(F,Qa),fa.G3c&&(fa.Dqb.ZQf(fa.ee,fa.RT),fa.G3c=!1)):Se.ULS.sendTraceTag(537163347,0,10,"DataFromPicturePaneCommandManager::Initialize - Failed to instantiate AugmentationLoopManager.")},
this.$.ma,3)}function sc(F,fa){var Qa=Fk.call(this)||this;Qa.U6e=Rc.getTypeName();Qa.jwb=null;Qa.imageWidth=0;Qa.imageHeight=0;Qa.tableData=null;Qa.errorMessage=null;Qa.mwb=null;Qa.rRc=!1;Qa.gDe=function(Ab){if(Ab){var Cc={};if(function(){var gf=Gh.d(Ab.data);Cc=gf.uu;return gf}().returnValue){var Vc=Object(Wi.a)(Object,Cc);if("."===Vc.DataFromPictureWildcard)if(Vc.SessionId!==Qa.mwb)Se.ULS.sendTraceTag(537163345,0,50,"DataFromPicturePaneCommandManager:DataFromPictureMessageReceivedEventHandler() - SessionID of received message does not match current Session ID.");
else switch(Vc.CmdType){case "ACK":Qa.rRc=!0;Qa.ufj();0<Qa.errorMessage.length?Qa.xTf():0<Qa.tableData.length&&Qa.OTf();break;case "insert_html":Se.ULS.sendTraceTag(537163344,0,50,"DataFromPicturePaneCommandManager:DataFromPictureMessageReceivedEventHandler - Message Received from SDX pane");var qd=Qa.$.qa.ta,Gd={},ve=Xh.g(Qa.$).ha.va.Qd.clone();Gd.PasteId=bj.a.create().toString();Gd.DestinationRanges=Wj.s(Wj.v(ve,Qa.$));Gd.SourceHtml=Vc.Parameters;Gd.CopyOperationId=null;var jf=qd.Oa(1,qd.Xb());
jf.pasteHtmlParameters=Gd;xk.a(Qa.$.userOperationManager,function(gf,qg,Qg){return Oi.i(qd,"pasteHtmlContent",jf,gf,qg,Qg,null,64)},function(gf){return new rk.a(204,0,gf,1)},null)}}}};Qa.O1h=function(Ab,Cc){if(Ab=Cc.bY)if(!Cc.parentPath||1>=Cc.parentPath.length||Cc.parentPath[1]!==Qa.mwb)Se.ULS.sendTraceTag(537163335,0,50,"DataFromPicturePaneCommandManager:ImageToTableAnnotationHandler() - SessionID of received annotation does not match current Session ID.");else{Cc=Ab.errorCode;switch(Cc){case null:case -1:Qa.errorMessage=
Fe.a.instance.ea(2196);break;case 1:Qa.errorMessage=Fe.a.instance.ea(2197);break;case 2:Qa.errorMessage=Fe.a.instance.ea(2198)}0<Qa.errorMessage.length&&Se.ULS.sendTraceTag(537163334,0,10,"DataFromPicturePaneCommandManager:ImageToTableAnnotationHandler() - ErrorCode:{0}.",Cc?Cc.toString():"null");Qa.tableData=Ab.html;Qa.rRc&&(0<Qa.errorMessage.length?Qa.xTf():0<Qa.tableData.length&&Qa.OTf())}else Se.ULS.sendTraceTag(537163336,0,50,"DataFromPicturePaneCommandManager:ImageToTableAnnotationHandler() - Received annotation is null.")};
Qa.$=F;Qa.augmentationLoopManager=fa;Qa.initialize();return Qa}function Rc(){var F=lk.call(this)||this;F.errorCode=null;F.errorDescription=null;F.html=null;F.H_=Object.assign(new Pk.a,{T_:Rc.getTypeName(),B_:Rc.pe()});return F}function Qc(F){var fa=Ok.call(this)||this;fa.$=F;fa.dc();return fa}function ee(F,fa){var Qa=Sc.call(this)||this;Qa.$=F;Qa.eta=new DOMParser;Qa.cache=new fj.a;Qa.indexedDB=fa;fa.og()&&Qa.indexedDB.initialize("Scripts","OfficeScriptingCache");Qa.p4=!1;Qa.Jm=new me([],function(Ab){Sc.q1f(Ab)});
Qa.eg=new me([],function(Ab){Sc.jKb(Ab)});Qa.ir=new me([],function(Ab){Sc.jKb(Ab)});Qa.Lk=new me([],function(){});return Qa}function ue(F,fa,Qa){var Ab=this;this.U5a=!1;this.a8a=function(){Ab.hZf()?(Ab.tEf(),Xh.g(Ab.$).Ca.yGd(Ab.a8a)):Ab.U5a&&Xh.g(Ab.$).Ca.yGd(Ab.a8a)};this.cBi=function(Cc,Vc){Object.getType(Vc)===String&&Vc.toString().endsWith(yf.a.Bub(Ab.$))&&(Ab.U5a=!1)};this.$=F;this.Bra=fa;this.Dv=Qa;this.gnj()}function Ee(){this.focusOnIframeWhenLoaded=!1;this.width=0;this.hyc=this.xaa=this.Vj=
null}function De(F,fa,Qa,Ab,Cc,Vc,qd,Gd,ve,jf){var gf=this;this.Zz=null;this.cache=new fj.a;this.G4d=this.Ube=this.Wbe=this.Tbe=this.Vbe=this.Sbe=this.$va=!1;this.sbe=this.cde=this.$$d=this.Cbe=null;this.pFa={};this.$=F;this.SNc=Qa;this.indexedDB=Ab;this.Anb=Cc;this.Dv=Vc;this.Bra=qd;this.Je=Gd;this.fP=yf.a.xq?ve:new $c(F,this);this.KIg=new $e(this,F);this.Ulg=Mh.a.Ra.Kb;this.G2f="";this.businessBarManager=jf;this.p4=!1;this.Mmj(new me([],function(qg){Sc.q1f(qg)}));this.Lmj(new me([],function(qg){Sc.jKb(qg)}));
this.Pmj(new me([],function(qg){Sc.jKb(qg)}));this.Nmj(new me([],function(){}));Ab.og()&&(this.$va=!0,this.indexedDB.initialize("Scripts","OfficeScriptingCache"));F=!0;if(zh.a.Lre){this.cache.og()&&(fa=this.pbd(yf.a.A9b(this.$)),fa.isSuccess&&(F=li.getElapsedSeconds(fa.timeStamp,Mh.a.Ra.Kb),this.Dv.Gx=new jc(!0,!0),this.Zz=new jc(fa.value,!0),F=this.Zz.value?604800<F:86400<F,this.zvb=this.xJb(!0)));this.Ngi=Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4456527_UseRibbonModeConditionForAutomateGallery");
this.xCh();if("undefined"!==typeof makerstorage&&this.Sef)if(this.G2f=Bc(this.$),mc(this.$))Ae(this.$,"localstorageToken"),this.Dv.Gx=new jc(!0,!0),this.Zz=new jc(!0,!0),this.zvb=this.xJb(!0);else if((fa=yf.a.XXe())&&makerstorage.setStorageEnvironmentOverride(fa),F)try{this.zvb=this.Dv.Ave().then(function(){return gf.Bra.S$b()}).then(function(qg){return gf.mZh(qg)}).then(function(){return gf.xJb(!1)}).catch(function(){return gf.xJb(!1)})}catch(qg){Se.ULS.sendTraceTag(537170314,0,15,"AutomateCommandManager: Something went wrong while trying to check the tab state.  Exception: {0}",
qg.message),this.zvb=Promise.resolve(!1)}Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5925531_useHasShownAutomateTabPromise")&&this.zvb?this.zvb.then(function(qg){return gf.HHd(qg)}):this.HHd(!1)}else Se.ULS.sendTraceTag(537170315,0,15,"IsOfficeScriptingEnabled: Turning off office scripting since fetch api is not supported by current browser."),this.HHd(!1)}function ne(F,fa,Qa,Ab,Cc){this.actionName=F;this.shapeId=fa;this.yza=Qa;this.V0b=Ab;this.aba=Cc}function gc(F,fa,Qa,Ab){this.bid=F;this.zsh=
fa;this.iya=Qa;this.GGa=Ab}function fd(F){return Pf.a.Gd(F)?Wc.a.fLe:Wc.a.eLe}function vd(F){return Pf.a.Gd(F)?F.isChromeRtl?Wc.a.imh:Wc.a.hmh:Wc.a.tIa}function se(F){F=F.qa.ta.Oa(1);F.request={HttpMethod:"Get",PathAndQuery:"customXmlParts/byNamespace(namespaceUri=@v)/onlyItem/xml?@v='http://schemas.microsoft.com/office/extensibility/maker/v1.0'",RequestHeaders:null,RequestBody:"",RequestFlags:256};return F}function Jc(F,fa,Qa,Ab,Cc){function Vc(){function qg(Qg,ph,Nh){return Oi.i(Gd.ta,"ExecuteRichApiRequest",
Ab,oi.b(Qg,fa),oi.a(ph,Qa),Nh,null,0)}if(qd.MGa()||0<Gd.ta.I3||0<Gd.Ek.I3)return!1;ve&&qd.pz(ve);jf&&Gd.Lt(jf);gf&&Gd.VC(gf);Ag.EwaSettings.tc()?qd.tt(new rk.a(507,0,qg,80)):qd.tt(new Aj.a(507,0,qg,16));return!0}var qd=F.userOperationManager,Gd=F.qa,ve=null,jf=null,gf=null;Vc()||(ve=function(){Vc()},jf=function(){Vc()},gf=function(){Vc()},qd.uy(ve),Gd.us(jf),Gd.FB(gf));return Cc.task}function Bc(F){if(mc(F))return Ag.EwaSettings.getBooleanFeatureGate(yf.a.xAb,!1)?"makerservicelocal":"localstorage";
F=yf.a.XXe();return yf.a.fSh(F)}function Ae(F,fa){mc(F)&&(Ag.EwaSettings.getBooleanFeatureGate(yf.a.xAb,!1)||makerstorage.useLocalStorage(!0),makerstorage.setStorageEnvironmentOverride("local"));makerstorage.setSessionId(F.ya.UserSessionId);makerstorage.setUserAccessInfo(new Oc(fa,null));Ag.EwaSettings.getBooleanFeatureGate(yf.a.Jag,!1)&&makerstorage.setFlightValue(makerstorage.restApiVersionFlightKey,"1")}function cb(F,fa){fa.WacTaskPaneInfra=Pf.a.Gd(F);fa.PipeEnableExtractPermission=Ag.EwaSettings.getBooleanFeatureGate(yf.a.PQi,
!1);fa.UseV1ServiceURLs=Ag.EwaSettings.getBooleanFeatureGate(yf.a.Jag,!1);fa.TaskpanelessRFB=Ag.EwaSettings.getBooleanFeatureGate(yf.a.z4f,!1)}function mc(F){return"TestHost"===F.ya.DocumentHostInfo.HostTier}function Oc(F,fa){this.currentUserMlapiToken=this.currentUserToken=null;this.currentUserToken=F;this.currentUserMlapiToken=fa}function Sc(){this.Lk=null;this.p4=this.r6=this.Ss=this.q6=this.Qya=this.r$a=this.nEd=this.uca=this.iva=!1;this.ir=this.eg=this.Jm=null}function $c(F,fa){this.Ux=null;
this.$=F;this.automateCommandManager=fa;return this}function le(){}function we(){this.Gx=null;return this}function jc(F,fa,Qa,Ab,Cc){this.value=F;this.isSuccess=fa;this.timeStamp=void 0===Qa?null:Qa;this.errorCode=void 0===Ab?"":Ab;this.errorMessage=void 0===Cc?"":Cc}function Zc(){this.Gx=null}function ud(F,fa){this.Ux=null;this.$=F;this.Je=fa;return this}function Fd(F){this.j$=Gg.b(F)||{};this.cD=this.cD||null}function me(F,fa){this.scripts=F;this.p1f=fa}function $e(F,fa){this.automateCommandManager=
F;this.$=fa}function Df(){this.Ux=null}function gg(F,fa,Qa){this.$=F;this.oAuthManager=fa;this.Dv=Qa;this.vnb=new og;this.hqe=this.oAuthManager&&null==this.oAuthManager.gLa()?!1:this.oAuthManager.gLa()}function og(){this.token=null;this.timeStamp=0}function dg(F){return Ck.call(this,F)||this}function af(F,fa){this.automateCommandManager=F;this.$=fa}function rg(F){var fa=Mi.call(this)||this;fa.$=F;fa.dc();return fa}function cg(F){this.Db=null;this.$=F}function Ie(){return Sd.call(this)||this}function Ng(){return Sd.call(this)||
this}function Zf(){return Sd.call(this)||this}function ng(){return Sd.call(this)||this}function Ff(){return Sd.call(this)||this}function be(){return Sd.call(this)||this}function Rf(){return Sd.call(this)||this}function Re(){return Sd.call(this)||this}function Ze(){return Sd.call(this)||this}function hg(){return Sd.call(this)||this}function Bg(){return Sd.call(this)||this}function qh(){return Sd.call(this)||this}function Zg(){return Sd.call(this)||this}function qf(){return Sd.call(this)||this}function mh(){return Sd.call(this)||
this}function Pa(){return Sd.call(this)||this}function qb(){return Sd.call(this)||this}function tc(){return Sd.call(this)||this}function dd(){return Sd.call(this)||this}function Kd(){return Sd.call(this)||this}function yd(){return Sd.call(this)||this}function ze(){return Sd.call(this)||this}function te(){return Sd.call(this)||this}function lf(){return Sd.call(this)||this}function bf(){return Sd.call(this)||this}function xf(){return Sd.call(this)||this}function Og(){return Sd.call(this)||this}function mf(){return Sd.call(this)||
this}function bg(){return Sd.call(this)||this}function Wf(){return Sd.call(this)||this}function zf(){return Sd.call(this)||this}function tg(){return Sd.call(this)||this}function Hf(){return Sd.call(this)||this}function xc(){return Sd.call(this)||this}function bd(){return Sd.call(this)||this}function Bd(){return Sd.call(this)||this}function Ld(){return Sd.call(this)||this}function Od(){return Sd.call(this)||this}function ef(){return Sd.call(this)||this}function ag(){return Sd.call(this)||this}function lg(){return Sd.call(this)||
this}function $f(){return Sd.call(this)||this}function Aa(){return Sd.call(this)||this}function Ob(){return Sd.call(this)||this}function Ec(){return Sd.call(this)||this}function md(){return Sd.call(this)||this}function Md(){return Sd.call(this)||this}function Me(){return Sd.call(this)||this}function Qe(){return Sd.call(this)||this}function sf(){return Sd.call(this)||this}function Vf(){return Sd.call(this)||this}function Da(){return Sd.call(this)||this}function rb(){return Sd.call(this)||this}function $b(){return Sd.call(this)||
this}function vc(){return Sd.call(this)||this}function sb(){return Sd.call(this)||this}function ec(){return Sd.call(this)||this}function ce(){return vf.call(this,195,16)||this}function Rd(){return vf.call(this,194,8)||this}function Ne(){return Sd.call(this)||this}function Be(){return vf.call(this,198,2)||this}function sd(){return vf.call(this,197,1)||this}function cf(){return vf.call(this,196,32)||this}function Dd(){return Sd.call(this)||this}function tf(){return vf.call(this,193,4)||this}function vf(F,
fa){var Qa=Sd.call(this)||this;Qa.Pea=F;Qa.FWd=fa;return Qa}function eg(){return Sd.call(this)||this}function jg(){return Sd.call(this)||this}function Xe(){return Sd.call(this)||this}function wg(){return Sd.call(this)||this}function mg(){return Sd.call(this)||this}function td(){return Sd.call(this)||this}function wf(){return eh.call(this,11,16)||this}function Oh(){return eh.call(this,10,128)||this}function Jg(){return Sd.call(this)||this}function oh(){return Sd.call(this)||this}function kd(){return Sd.call(this)||
this}function sg(){return Sd.call(this)||this}function lh(){return Sd.call(this)||this}function Ye(){return Sd.call(this)||this}function Rg(){return Sd.call(this)||this}function jh(){return Sd.call(this)||this}function Fg(){return Sd.call(this)||this}function Ki(){return eh.call(this,9,2)||this}function ti(){return eh.call(this,8,1)||this}function th(){return eh.call(this,7,8)||this}function Pg(){return eh.call(this,6,32)||this}function hi(){return Sd.call(this)||this}function ah(){return Sd.call(this)||
this}function qi(){return Sd.call(this)||this}function Ch(){return Sd.call(this)||this}function gh(){return Sd.call(this)||this}function yi(){return Sd.call(this)||this}function ii(){return Sd.call(this)||this}function la(){return Sd.call(this)||this}function nb(){return Sd.call(this)||this}function Wb(){return Sd.call(this)||this}function Dc(){return Sd.call(this)||this}function zb(){return Sd.call(this)||this}function hd(){return Sd.call(this)||this}function ke(){return Sd.call(this)||this}function He(){return eh.call(this,
4,64)||this}function df(){return Sd.call(this)||this}function kf(){return Sd.call(this)||this}function ff(){return Sd.call(this)||this}function Ef(){return Sd.call(this)||this}function Qf(){return Sd.call(this)||this}function Vg(){return Sd.call(this)||this}function Kg(){return Sd.call(this)||this}function yh(){}function fh(){return Sd.call(this)||this}function If(){return eh.call(this,3,4)||this}function eh(F,fa){var Qa=Sd.call(this)||this;Qa.Pea=F;Qa.FWd=fa;return Qa}function Qh(){return Sd.call(this)||
this}function xi(){return Sd.call(this)||this}function Ca(){return Sd.call(this)||this}function ra(){return Sd.call(this)||this}function yb(){return ha.call(this,185,18)||this}function Hd(){return Sd.call(this)||this}function ye(){return ha.call(this,181,14)||this}function Cf(){return ha.call(this,169,2)||this}function Bf(){return ha.call(this,168,1)||this}function ch(){return Sd.call(this)||this}function Tg(){return ha.call(this,182,15)||this}function fe(){return Sd.call(this)||this}function Ih(){return Sd.call(this)||
this}function Th(){return ha.call(this,180,13)||this}function h(){return ha.call(this,186,19)||this}function Bb(){return ha.call(this,175,8)||this}function ic(){return ha.call(this,176,9)||this}function Nc(){return ha.call(this,187,20)||this}function pd(){return ha.call(this,174,7)||this}function xe(){return ha.call(this,179,12)||this}function Ue(){return ha.call(this,178,11)||this}function qe(){return ha.call(this,177,10)||this}function ja(){return Sd.call(this)||this}function Ka(){return ha.call(this,
170,3)||this}function qc(){return ha.call(this,172,5)||this}function lc(){return ha.call(this,173,6)||this}function Cd(){return ha.call(this,183,16)||this}function pc(){return ha.call(this,184,17)||this}function K(){return ha.call(this,171,4)||this}function ha(F,fa){var Qa=Sd.call(this)||this;Qa.Pea=F;Qa.opType=fa;return Qa}function H(){return Sd.call(this)||this}function aa(){return Sd.call(this)||this}function ea(){return Sd.call(this)||this}function ab(){return Sd.call(this)||this}function Vb(){return Sd.call(this)||
this}function fc(){return Sd.call(this)||this}function Yc(){return Sd.call(this)||this}function Zd(){return Sd.call(this)||this}function oe(){return Sd.call(this)||this}function Ge(){return Sd.call(this)||this}function pf(){return Sd.call(this)||this}function Le(){return Sd.call(this)||this}function ug(){return Sd.call(this)||this}function ig(){return Sd.call(this)||this}function ih(){return Sd.call(this)||this}function $g(){return Sd.call(this)||this}function xh(){return Sd.call(this)||this}function vh(){return Sd.call(this)||
this}function nf(){return Sd.call(this)||this}function dh(){return Sd.call(this)||this}function Dh(){return Sd.call(this)||this}function Eg(){return pg.call(this)||this}function ei(){return Sd.call(this)||this}function Ti(){return Sd.call(this)||this}function Qi(){return Sd.call(this)||this}function hj(){return Sd.call(this)||this}function Ah(){return Sd.call(this)||this}function Ci(){return Sd.call(this)||this}function ni(){return Sd.call(this)||this}function T(){return Sd.call(this)||this}function Oa(){return Sd.call(this)||
this}function Ib(){return Yg.call(this,78,[-105,-106,-107,-108,-109,-110,-111,-112,-113,-114,-127,-116,-117,-118,-119,-120,-121,-122,-123,-125,-124,-126,-216,-217,-218,-219,-221,-222,-220,-129,-130,-131])||this}function hc(){return Yg.call(this,79,[0,1,2,-102])||this}function nd(){return Yg.call(this,75,[-101])||this}function Td(){return Yg.call(this,81,[100,101,102,103,104,105,106])||this}function Ed(){return Sd.call(this)||this}function he(){return Yg.call(this,85,[328,329,330,331,332,333,334,335])||
this}function Pe(){return pg.call(this)||this}function hf(F,fa,Qa){this.response=this.request=this.eventId=this.source=null;F&&(this.source=F.source,this.eventId=F.eventId,this.request=fa,this.response=Qa)}function pg(){return Sd.call(this)||this}function fg(){return Yg.call(this,83,[500,501,502])||this}function Xg(){return Yg.call(this,76,[-100])||this}function yg(){return Yg.call(this,82,[200,201,202,203,204,205,206,207,208,209,210])||this}function Rh(){return Yg.call(this,80,[-104,-103,300,301,
302,303,304,305,306,307,308,309,310,311])||this}function Kh(){return Yg.call(this,84,[348,349,350,351,352,353,354,355,356,357,372,373,374,375])||this}function Yg(F,fa){var Qa=Sd.call(this)||this;Qa.Pea=F;Qa.bNj=fa;return Qa}function ji(){return Sd.call(this)||this}function Di(){return Sd.call(this)||this}function Ei(){return Sd.call(this)||this}function rh(){return Sd.call(this)||this}function Sd(){this.fGc=this.gGc=this.kMc=this.NQc=null}function Bj(F,fa,Qa){var Ab=this;this.d8b=null;this.Spi=function(Cc,
Vc){Ab.iZf()&&Ab.$9c(Vc)};this.ilf=fa;this.hlf=Qa;this.$=F;this.$.Xaa&&this.$.zBg(this.Spi);F.da.Ha(297,this)}function Sf(){}function X(){}function ua(){this.xfb=null}function vb(){this.rb=null}function Rb(F){this._initialized=!1;this.f9a={};this.Vwc={};this.fI=kg.AFrameworkApplication.sa.fD;this.aid=F}function Fc(F,fa,Qa){this.expiration=this.authority=this.accessToken=null;this.accessToken=F;this.authority=fa;this.expiration=Qa}function kc(){this.authority=this.email=this.displayName=null;this.authority=
this.email=this.displayName=""}function Id(){this.authority=this.userId=this.upn=null;this.authorityType=0;this.tenantId=null;this.supportsAuthToken=this.isAnonymous=!1;this.authority=this.userId=this.upn="";this.authorityType=0;this.tenantId="";this.isAnonymous=!0;this.supportsAuthToken=!1}function ie(){}function Ve(F,fa){this.requestCallback=this.requestParameters=null;this.requestParameters=F;this.requestCallback=fa}function Dg(){}b.r(D);var Mg=b(514),Ug=b(1093),$d=b(0),Se=b(13),Ri=b(80),xj;(function(F){F[F.generalException=
0]="generalException";F[F.invalidArgument=1]="invalidArgument";F[F.notAllowed=2]="notAllowed";F[F.apiNotAvailable=3]="apiNotAvailable";F[F.unresolvedPendingRequest=4]="unresolvedPendingRequest";F[F.timeout=5]="timeout";F[F.adalTimeout=6]="adalTimeout";F[F.userNotSignedIn=7]="userNotSignedIn";F[F.userAborted=8]="userAborted";F[F.silentSignInFailed=9]="silentSignInFailed";F[F.invalidResourceUrl=10]="invalidResourceUrl";F[F.invalidGrant=11]="invalidGrant";F[F.connectionLost=12]="connectionLost";F[F.clientError=
13]="clientError";F[F.serverError=14]="serverError"})(xj||(xj={}));Object($d.b)("ErrorCodes",xj);Dg.rBf="OneDriveWOPI";Object($d.a)(Dg,"HostApplicationType",null,[]);Object($d.a)(Ve,"OutstandingRequest",null,[]);ie.Mvi="AADSTS50058";ie.invalidResourceUrl="AADSTS50001";ie.Gvi="AADSTS65001";ie.Xvi="AADSTS70011";ie.userAborted="13002";ie.lSi="Popup Window is null";ie.kSi="Popup Window closed";ie.adalTimeout="Token renewal operation failed due to timeout";ie.$Cj="tokenRevoked";Object($d.a)(ie,"WopiHostErrorType",
null,[]);var kg=b(5),Cj=b(857),sj=b(592),Gh=b(38);Id.kDh=function(F){switch(F){case 0:return"external";case 2:return"aad";case 1:return"msa";default:return"external"}};Object($d.a)(Id,"WopiAuthContext",null,[878]);Object($d.a)(kc,"WopiIdentityInfo",null,[876]);Object($d.a)(Fc,"WopiIdentityToken",null,[875]);var zh=b(23),Vh=b(143),bh=b(371),yj=b(170),Tf=b(75),ui=b(338);Rb.prototype.R0a=function(F){this._initialized||(F.Qn(yj.a.hEf),F.Km(yj.a.hEf,Object(Ri.a)(this,this.LIi,"onReceivedAccessToken")),
this._initialized=!0)};Rb.prototype.getAccessToken=function(F,fa,Qa){var Ab=this;Qa=void 0===Qa?null:Qa;this.VMa(F,fa);return new Promise(function(Cc,Vc){if(Ab.zkd(fa))if(fa in Ab.f9a)Vc("unresolvedPendingRequest");else{var qd=window.setTimeout(function(){var ve={};Se.ULS.sendTraceTag(37856032,344,10,Gh.c((ve.error="Request timeout.",ve.callerId=fa,ve)));Vc("timeout")},12E4);Ab.Rad(F,fa,Qa,function(ve,jf){window.clearTimeout(qd);ve?Cc(ve):(ve={},Se.ULS.sendTraceTag(37856033,369,15,Gh.c((ve.error=
xj[jf],ve))),Vc(jf))})}else{var Gd={};Se.ULS.sendTraceTag(37856034,344,10,Gh.c((Gd.error="Caller is not allowed.",Gd)));Vc("notAllowed")}})};Rb.prototype.getPrimaryIdentityInfo=function(F){var fa=this;return new Promise(function(Qa,Ab){if(fa.zkd(F))fa.NOh(function(Vc,qd){Vc?Qa(Vc):(Vc={},Se.ULS.sendTraceTag(37856064,369,10,Gh.c((Vc.error=qd.toString(),Vc))),Ab(qd))});else{var Cc={};Se.ULS.sendTraceTag(37856065,344,10,Gh.c((Cc.error="Caller is not allowed.",Cc)));Ab("notAllowed")}})};Rb.prototype.getAuthContext=
function(F){var fa=this;return new Promise(function(Qa,Ab){var Cc=fa.getAuthContextSync(F);Cc?Qa(Cc):Ab("notAllowed")})};Rb.prototype.getAuthContextSync=function(F){if(this.zkd(F)){var fa=new Id;fa.upn=kg.AFrameworkApplication.ga.Ua("UserPrincipalName");fa.userId=kg.AFrameworkApplication.ga.Ua("LoggableUserId");fa.authority=kg.AFrameworkApplication.ga.Ua("HostAuthAuthority");fa.tenantId=kg.AFrameworkApplication.ga.Ua("TenantId");fa.isAnonymous=kg.AFrameworkApplication.ga.ra("IsAnonymousUser");fa.supportsAuthToken=
this.P0h(F);F=kg.AFrameworkApplication.ga.Ua("HostAuthType");fa.authorityType="aad"===F.toLowerCase()?2:"msa"===F.toLowerCase()?1:0;return fa}fa={};Se.ULS.sendTraceTag(40751647,344,10,Gh.c((fa.error="Caller is not allowed.",fa)));return null};Rb.prototype.P0h=function(F){var fa=Cj.a.$vb;return zh.a.qka?fa&&Cj.a.E4f?Array.contains(Cj.a.E4f,F.toLowerCase()):!1:fa};Rb.prototype.Rad=function(F,fa,Qa,Ab){var Cc=this,Vc=[];Array.add(Vc,Object.assign(new Tf.a,{name:"CallerId",string:fa}));Array.add(Vc,Object.assign(new Tf.a,
{name:bh.a.zQd,string:F.correlationId}));Vh.a.sendTelemetryEvent(Object.assign(new ui.a,{name:"Office.Online.Extensibility.SSO.FirstPartyRequestTokenFromHost",dataFields:Vc}));Vc=sj.a.create().toString();var qd="getAccessToken_"+Vc,Gd=this.fI.Fc("ComponentAttach",qd);this.Vwc[qd]=Gd;var ve={};ve[bh.a.AQd]=Vc;ve[bh.a.Gwj]=F.resource;ve[bh.a.Hwj]=F.scope;ve[bh.a.G1f]=kg.AFrameworkApplication.ga.Ua("HostAuthType");ve[bh.a.Kwj]=kg.AFrameworkApplication.ga.Ua("UserPrincipalName");ve[bh.a.Iwj]=F.silentLogin;
ve[bh.a.Dwj]=F.options;ve[bh.a.zQd]=F.correlationId;ve[bh.a.Ewj]=fa;Qa&&(ve[bh.a.addinName]=Qa.AddinName,ve[bh.a.Cwj]=Qa.AddinTrustId);this.aid.execute(function(jf){Cc.R0a(jf);jf.Qj(yj.a.getAuthToken,ve)});this.f9a[Vc]=new Ve(F,Ab)};Rb.prototype.NOh=function(F){var fa=kg.AFrameworkApplication.ga.Ua("UserName"),Qa=kg.AFrameworkApplication.ga.Ua("UserPrincipalName"),Ab=kg.AFrameworkApplication.ga.Ua("LoggableUserIdSpace"),Cc=new kc;Cc.email=Qa;Cc.displayName=fa;switch(Ab){case "OrgIdPuid":Cc.authority=
"AzureActiveDirectoryAccount";break;case "MsaCid":case "MsaPuid":Cc.authority="MicrosoftAccount";break;default:Cc.authority=Ab}F(Cc,null)};Rb.prototype.LIi=function(F){var fa=null;try{var Qa=F.Values[bh.a.AQd],Ab=F.Values[bh.a.Bwj],Cc=F.Values[bh.a.G1f],Vc=F.Values[bh.a.Jwj],qd=null,Gd=null,ve=this.f9a[Qa];if("undefined"!==typeof ve&&ve){var jf=[];Array.add(jf,Object.assign(new Tf.a,{name:bh.a.zQd,string:ve.requestParameters.correlationId}));Vh.a.sendTelemetryEvent(Object.assign(new ui.a,{name:"Office.Online.Extensibility.SSO.FirstPartyResponseTokenFromHost",
dataFields:jf}));fa=ve.requestCallback;delete this.f9a[Qa];"undefined"!==typeof Ab&&Ab&&Ab.length?Gd=new Fc(Ab,Cc,Vc):qd=xj[this.Hqi(F)];Qa="getAccessToken_"+Qa;Qa in this.Vwc&&(this.Vwc[Qa].stop(),delete this.Vwc[Qa]);fa(Gd,qd)}else qd={},Se.ULS.sendTraceTag(37856066,344,10,Gh.c((qd.error="No matching outstanding request for request ID.",qd.requestId=Qa,qd)))}catch(gf){F=F.Values[bh.a.AQd],F in this.f9a&&delete this.f9a[F],this.kic(),F={},Se.ULS.sendTraceTag(37856067,344,10,Gh.c((F.error=gf.message,
F.stack=gf.stack,F))),fa&&fa(null,"generalException")}};Rb.prototype.zkd=function(F){var fa=kg.AFrameworkApplication.nVh();F=F.toLowerCase();fa=yl(fa);for(var Qa=fa.next();!Qa.done;Qa=fa.next())if(F===Qa.value.toLowerCase())return!0;fa=Cj.a.AUc;for(var Ab in fa)if(F===fa[Ab].toLowerCase())return!0;return!1};Rb.prototype.Hqi=function(F){F=F.Values[bh.a.Fwj];this.kic();var fa={};Se.ULS.sendTraceTag(39068821,344,15,Gh.c((fa.error=F,fa)));return F?-1<F.indexOf(ie.Mvi)?9:-1<F.indexOf(ie.lSi)||-1<F.indexOf(ie.kSi)?
12:-1<F.indexOf(ie.invalidResourceUrl)?10:-1<F.indexOf(ie.userAborted)?8:-1<F.indexOf(ie.Xvi)||-1<F.indexOf(ie.Gvi)||F===ie.$Cj?11:-1<F.indexOf(ie.adalTimeout)?6:0:13};Rb.prototype.VMa=function(F,fa){F=this.C_i(F.resource);var Qa={};Se.ULS.sendTraceTag(39921882,344,50,Gh.c((Qa.callerId=fa,Qa.resource=F,Qa)))};Rb.prototype.kic=function(){var F={};Se.ULS.sendTraceTag(39068822,344,50,Gh.c((F.userAgent=window.navigator.userAgent,F)))};Rb.prototype.C_i=function(F){return(F?F:"").replace("://","__").replace(RegExp("\\.",
"g"),"_dot_").replace("/","\\")};Object($d.a)(Rb,"WopiIdentityManager",null,[858]);var Yj=b(274);vb.prototype.di=function(F){this.rb=F;F.register(Rb,"Common.App.WopiIdentity.WopiIdentityManager").as("Common.App.WopiIdentity.IWopiIdentity").zc().Ic(function(){return new Rb(F.mc("Postmessage.IHostPostmessenger"))})};vb.prototype.init=function(){kg.AFrameworkApplication.ga&&kg.AFrameworkApplication.ga.$v(Object(Ri.a)(this,this.QA,"onFullAppSettingsReady"))};vb.prototype.QA=function(){try{this.rb.resolve("Common.App.WopiIdentity.IWopiIdentity")}catch(F){Se.ULS.sendTraceTag(571074327,
383,10,"Failed to initialize WopiIdentityPackage with exception: "+F)}};vb.prototype.dispose=function(){};vb.main=function(){Yj.a.instance.mj(new vb)};tl.Object.defineProperties(vb.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.WopiIdentity"}}});Object($d.a)(vb,"WopiIdentityPackage",null,[4,5]);var tj=b(10),ij=b(216),Ph=b(185),Lh=b(604);ua.prototype.$8h=function(F){return this.kJg.contains(F.operation)};ua.prototype.AGj=function(F){for(var fa=[],Qa=yl(F.payload.batchedOperations),
Ab=Qa.next();!Ab.done;Ab=Qa.next())fa.push(new Lh.a(F.operation,Ab.value));return fa};tl.Object.defineProperties(ua.prototype,{kJg:{configurable:!0,enumerable:!0,get:function(){this.xfb||(this.xfb=new Ph.a,this.xfb.add(12),this.xfb.add(11));return this.xfb}}});Object($d.a)(ua,"MacroRecorderBatchedEventList",null,[]);var $h=b(52),lj=b(120),Zj=b(686);X.prototype.equals=function(F,fa){return F===fa};X.prototype.getHashCode=function(F){return F};X.prototype.Via=function(F){return F};Object($d.a)(X,"UserOperationNameComparer",
null,[101,102]);Sf.lVh=function(){Sf.Oc||(Sf.Oc=new Zj.a(new X),Sf.Oc.add(507),Sf.Oc.add(10),Sf.Oc.add(576),Sf.Oc.add(563),Sf.Oc.add(564),Sf.Oc.add(565),Sf.Oc.add(566),Sf.Oc.add(567),Sf.Oc.add(568),Sf.Oc.add(569),Sf.Oc.add(570),Sf.Oc.add(571),Sf.Oc.add(572),Sf.Oc.add(573),Sf.Oc.add(574),Sf.Oc.add(575),Sf.Oc.add(501),Sf.Oc.add(520),Sf.Oc.add(1),Sf.Oc.add(1002),Sf.Oc.add(129),Sf.Oc.add(198),Sf.Oc.add(500),Sf.Oc.add(519),Sf.Oc.add(538),Sf.Oc.add(1E3),Sf.Oc.add(1003),Sf.Oc.add(144),Sf.Oc.add(502),Sf.Oc.add(505),
Sf.Oc.add(179),Sf.Oc.add(205),Sf.Oc.add(134),Sf.Oc.add(230),Sf.Oc.add(103),Sf.Oc.add(110),Sf.Oc.add(112),Sf.Oc.add(113),Sf.Oc.add(124),Sf.Oc.add(133),Sf.Oc.add(154),Sf.Oc.add(162),Sf.Oc.add(168),Sf.Oc.add(172),Sf.Oc.add(201),Sf.Oc.add(222),Sf.Oc.add(227),Sf.Oc.add(513),Sf.Oc.add(534),Sf.Oc.add(539),Sf.Oc.add(545),Sf.Oc.add(547),Sf.Oc.add(555),Sf.Oc.add(558),Sf.Oc.add(562),Sf.Oc.add(585),Sf.Oc.add(1001),Sf.Oc.add(1005),Sf.Oc.add(1008),Sf.Oc.add(1010),Sf.Oc.add(1011),Sf.Oc.add(1012),Sf.Oc.add(1018),
Sf.Oc.add(252),Sf.Oc.add(253),Sf.Oc.add(258),Sf.Oc.add(101),Sf.Oc.add(102),Sf.Oc.add(108),Sf.Oc.add(118),Sf.Oc.add(257),Sf.Oc.add(119),Sf.Oc.add(120),Sf.Oc.add(123),Sf.Oc.add(126),Sf.Oc.add(127),Sf.Oc.add(130),Sf.Oc.add(140),Sf.Oc.add(159),Sf.Oc.add(160),Sf.Oc.add(165),Sf.Oc.add(166),Sf.Oc.add(167),Sf.Oc.add(169),Sf.Oc.add(189),Sf.Oc.add(223),Sf.Oc.add(214),Sf.Oc.add(228),Sf.Oc.add(233),Sf.Oc.add(247),Sf.Oc.add(504),Sf.Oc.add(511),Sf.Oc.add(512),Sf.Oc.add(525),Sf.Oc.add(533),Sf.Oc.add(537),Sf.Oc.add(542),
Sf.Oc.add(544),Sf.Oc.add(548),Sf.Oc.add(550),Sf.Oc.add(551),Sf.Oc.add(552),Sf.Oc.add(554),Sf.Oc.add(577),Sf.Oc.add(584),Sf.Oc.add(586),Sf.Oc.add(587),Sf.Oc.add(588),Sf.Oc.add(592),Sf.Oc.add(1009),Sf.Oc.add(1016),Sf.Oc.add(1017));return Sf.Oc};Sf.Oc=null;Object($d.a)(Sf,"MacroRecorderUnrecognizedEventList",null,[]);Bj.prototype.init=function(F){this.$.Xaa&&(F?this.d8b=F:Se.ULS.sendTraceTag(537155424,0,10,"MacroRecorderEventHandler.Init failed because the function passed in is null."))};Bj.prototype.$9c=
function(F){if(this.iZf())try{if(this.hlf.$8h(F))for(var fa=this.hlf.AGj(F),Qa=yl(fa),Ab=Qa.next();!Ab.done;Ab=Qa.next())this.QQe(Ab.value);else this.QQe(F)}catch(Cc){F=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Error: {0}, Exception: {1}",lj.a(F.operation),Cc.stack),Se.ULS.sendTraceTag(537155423,0,10,F)}};Bj.prototype.QQe=function(F){var fa=this.ilf.VXe(F,!0);fa?(this.d8b(fa.eventId,$h.a.Hc(F.payload)),F=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: {0}",
fa.eventId),Se.ULS.sendTraceTag(537155422,0,50,F)):(fa=this.ilf.VXe(F,!1))?(F=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Matched: {0}, but failed to match filters",fa.eventId),Se.ULS.sendTraceTag(537155421,0,50,F)):Sf.lVh().contains(F.operation)||(this.d8b(0,$h.a.Hc(F.operation)),F=String.format("MacroRecorderEventHandler.FireMacroRecorderEvent: Unrecognized: {0}",lj.a(F.operation)),Se.ULS.sendTraceTag(537155420,0,50,F))};Bj.prototype.iZf=function(){return this.$.gka&&this.d8b&&
this.$.Taa?!0:!1};Object($d.a)(Bj,"MacroRecorderEventHandler",null,[904]);var Ag=b(1);Sd.prototype.ng=function(){};Sd.prototype.cV=function(){};Sd.prototype.xd=function(F){this.yAc.add(F)};Sd.prototype.Tb=function(F){this.operations.contains(F)||this.operations.add(F)};Sd.prototype.Ulb=function(){this.featureGates.add(704)};Sd.prototype.WEa=function(F){this.jPe.add(F)};tl.Object.defineProperties(Sd.prototype,{operations:{configurable:!0,enumerable:!0,get:function(){this.kMc||(this.kMc=new Ph.a,this.fc());
return this.kMc}},yAc:{configurable:!0,enumerable:!0,get:function(){this.NQc||(this.NQc=new Ph.a,this.ng());return this.NQc}},jPe:{configurable:!0,enumerable:!0,get:function(){this.fGc||(this.fGc=new Ph.a);return this.fGc}},featureGates:{configurable:!0,enumerable:!0,get:function(){this.gGc||(this.gGc=new Ph.a,this.cV());return this.gGc}}});Object($d.a)(Sd,"MacroRecorderEventBase",null,[]);vm(rh,Sd);rh.prototype.fc=function(){this.Tb(100)};tl.Object.defineProperties(rh.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 130}}});Object($d.a)(rh,"AccessibilityCheckRunEvent",Sd,[]);vm(Ei,Sd);Ei.prototype.fc=function(){this.Tb(241)};Ei.prototype.ng=function(){this.xd(function(F){return F.addToPrintArea})};tl.Object.defineProperties(Ei.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 160}}});Object($d.a)(Ei,"AddedToPrintAreaEvent",Sd,[]);vm(Di,Sd);Di.prototype.fc=function(){this.Tb(516)};tl.Object.defineProperties(Di.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 65}}});Object($d.a)(Di,"AutoFilterToggledEvent",Sd,[]);vm(ji,Sd);ji.prototype.fc=function(){this.Tb(502)};ji.prototype.ng=function(){this.xd(function(F){return!(F.d3a().FirstColumn===F.d3a().LastColumn&&F.d3a().FirstRow===F.d3a().LastRow)})};tl.Object.defineProperties(ji.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 118}}});Object($d.a)(ji,"AutoSumEvent",Sd,[]);vm(Yg,Sd);Yg.prototype.fc=function(){this.Tb(529);this.Tb(594)};Yg.prototype.ng=function(){var F=
this;this.xd(function(fa){return Array.contains(F.bNj,fa.Pdd())})};tl.Object.defineProperties(Yg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.Pea}}});Object($d.a)(Yg,"ChartPropertyAppliedEventBase",Sd,[]);vm(Kh,Yg);Object($d.a)(Kh,"ChartAxisChangedEvent",Yg,[]);vm(Rh,Yg);Object($d.a)(Rh,"ChartAxisTitleChangedEvent",Yg,[]);vm(yg,Yg);Object($d.a)(yg,"ChartDataLabelsChangedEvent",Yg,[]);vm(Xg,Yg);Object($d.a)(Xg,"ChartDataSelectedEvent",Yg,[]);vm(fg,Yg);Object($d.a)(fg,
"ChartDataTableChangedEvent",Yg,[]);var Gj=b(574),qj=b(408),Wi=b(84);vm(pg,Sd);Object($d.a)(pg,"RichApiRequestExecutedEventBase",Sd,[]);tl.Object.defineProperties(hf.prototype,{isValid:{configurable:!0,enumerable:!0,get:function(){return!(void 0===this.source||null===this.source)&&!(void 0===this.eventId||null===this.eventId)&&!0}}});Object($d.a)(hf,"MacroRecorderRichApiRequestExecutedPayload",null,[116]);vm(Pe,pg);Pe.prototype.FE=function(F){Pe.v6||(Pe.v6=new Zj.a(Gj.a.Ik()),Pe.v6.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),
Pe.v6.add("fa000000014"));return!!F&&Pe.v6.contains(F.toLowerCase())};Pe.prototype.fc=function(){this.Tb(507);this.Tb(10);this.Tb(576)};Pe.prototype.ng=function(){var F=this;this.xd(function(fa){return Object(qj.a)(hf,fa)&&(fa=Object(Wi.a)(hf,fa),fa.isValid&&F.FE(fa.source))?(Se.ULS.sendTraceTag(537155427,0,50,"[RichApiRecorder]: A ChartFormatRichApiRequestExecutedEvent is matched! eventId: {0}",fa.eventId),!0):!1})};tl.Object.defineProperties(Pe.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 117}}});Pe.v6=null;Object($d.a)(Pe,"ChartFormatRichApiRequestExecutedEvent",pg,[]);vm(he,Yg);Object($d.a)(he,"ChartGridlinesChangedEvent",Yg,[]);vm(Ed,Sd);Ed.prototype.fc=function(){this.Tb(528)};tl.Object.defineProperties(Ed.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 66}}});Object($d.a)(Ed,"ChartInsertedEvent",Sd,[]);vm(Td,Yg);Object($d.a)(Td,"ChartLegendChangedEvent",Yg,[]);vm(nd,Yg);Object($d.a)(nd,"ChartRowColumnSwitchedEvent",Yg,[]);vm(hc,Yg);
Object($d.a)(hc,"ChartTitleChangedEvent",Yg,[]);vm(Ib,Yg);Object($d.a)(Ib,"ChartTypeChangedEvent",Yg,[]);vm(Oa,Sd);Oa.prototype.fc=function(){this.Tb(521)};tl.Object.defineProperties(Oa.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 131}}});Object($d.a)(Oa,"ConnectorFloatingObjectResizedEvent",Sd,[]);vm(T,Sd);T.prototype.fc=function(){this.Tb(109)};tl.Object.defineProperties(T.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 129}}});Object($d.a)(T,"EntitySelectedEvent",
Sd,[]);vm(ni,Sd);ni.prototype.fc=function(){this.Tb(149);this.Tb(147)};tl.Object.defineProperties(ni.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 49}}});Object($d.a)(ni,"FindCellEvent",Sd,[]);vm(Ci,Sd);Ci.prototype.fc=function(){this.Tb(122)};tl.Object.defineProperties(Ci.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 96}}});Object($d.a)(Ci,"FloatingObjectAltTextAppliedEvent",Sd,[]);vm(Ah,Sd);Ah.prototype.fc=function(){this.Tb(522)};tl.Object.defineProperties(Ah.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 93}}});Object($d.a)(Ah,"FloatingObjectDeletedEvent",Sd,[]);vm(hj,Sd);hj.prototype.fc=function(){this.Tb(524)};tl.Object.defineProperties(hj.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 94}}});Object($d.a)(hj,"FloatingObjectMovedAndResizedEvent",Sd,[]);vm(Qi,Sd);Qi.prototype.fc=function(){this.Tb(523)};tl.Object.defineProperties(Qi.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 95}}});
Object($d.a)(Qi,"FloatingObjectRotatedEvent",Sd,[]);vm(Ti,Sd);Ti.prototype.fc=function(){this.Tb(543)};tl.Object.defineProperties(Ti.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 100}}});Object($d.a)(Ti,"GroupDetailsShownOrHiddenEvent",Sd,[]);vm(ei,Sd);ei.prototype.fc=function(){this.Tb(125)};tl.Object.defineProperties(ei.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 154}}});Object($d.a)(ei,"HyperlinksRemovedFromRangeEvent",Sd,[]);vm(Eg,pg);Eg.prototype.FE=
function(F){Eg.v6||(Eg.v6=new Zj.a(Gj.a.Ik()),Eg.v6.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),Eg.v6.add("fa000000005"));return!!F&&Eg.v6.contains(F.toLowerCase())};Eg.prototype.fc=function(){this.Tb(507);this.Tb(10);this.Tb(576)};Eg.prototype.ng=function(){var F=this;this.xd(function(fa){return Object(qj.a)(hf,fa)?(fa=Object(Wi.a)(hf,fa),fa.isValid&&F.FE(fa.source)):!1})};tl.Object.defineProperties(Eg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 125}}});Eg.v6=null;Object($d.a)(Eg,
"IdeasRichApiRequestExecutedEvent",pg,[]);vm(Dh,Sd);Dh.prototype.fc=function(){this.Tb(115)};tl.Object.defineProperties(Dh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 136}}});Object($d.a)(Dh,"LinkedEntityConvertedEvent",Sd,[]);vm(dh,Sd);dh.prototype.fc=function(){this.Tb(114)};tl.Object.defineProperties(dh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 148}}});Object($d.a)(dh,"LinkedEntityDisambiguationPaneToggledEvent",Sd,[]);vm(nf,Sd);nf.prototype.fc=
function(){this.Tb(119)};tl.Object.defineProperties(nf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 127}}});Object($d.a)(nf,"MovedToEdgeEvent",Sd,[]);vm(vh,Sd);vh.prototype.fc=function(){this.Tb(191)};vh.prototype.cV=function(){this.Ulb()};tl.Object.defineProperties(vh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 135}}});Object($d.a)(vh,"NamedSheetViewCreatedEvent",Sd,[]);vm(xh,Sd);xh.prototype.fc=function(){this.Tb(200)};xh.prototype.cV=function(){this.Ulb()};
tl.Object.defineProperties(xh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 166}}});Object($d.a)(xh,"NamedSheetViewDeletedEvent",Sd,[]);vm($g,Sd);$g.prototype.fc=function(){this.Tb(192)};$g.prototype.cV=function(){this.Ulb()};tl.Object.defineProperties($g.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 133}}});Object($d.a)($g,"NamedSheetViewExitedEvent",Sd,[]);vm(ih,Sd);ih.prototype.fc=function(){this.Tb(199)};ih.prototype.cV=function(){this.Ulb()};
tl.Object.defineProperties(ih.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 162}}});Object($d.a)(ih,"NamedSheetViewRenamedEvent",Sd,[]);vm(ig,Sd);ig.prototype.fc=function(){this.Tb(195)};ig.prototype.cV=function(){this.Ulb()};tl.Object.defineProperties(ig.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 167}}});Object($d.a)(ig,"NamedSheetViewSwitchedEvent",Sd,[]);vm(ug,Sd);ug.prototype.fc=function(){this.Tb(174)};tl.Object.defineProperties(ug.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 99}}});Object($d.a)(ug,"OutlineLevelSetEvent",Sd,[]);vm(Le,Sd);Le.prototype.fc=function(){this.Tb(244)};tl.Object.defineProperties(Le.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 156}}});Object($d.a)(Le,"PageBreakInsertedEvent",Sd,[]);vm(pf,Sd);pf.prototype.fc=function(){this.Tb(245)};tl.Object.defineProperties(pf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 157}}});Object($d.a)(pf,
"PageBreakRemovedEvent",Sd,[]);vm(Ge,Sd);Ge.prototype.fc=function(){this.Tb(246)};tl.Object.defineProperties(Ge.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 158}}});Object($d.a)(Ge,"PageBreaksAllResetEvent",Sd,[]);vm(oe,Sd);oe.prototype.fc=function(){this.Tb(503)};oe.prototype.ng=function(){this.xd(function(F){return!!F.pasteParameters.ClientEstimationFloatingObjectId&&2===F.pasteParameters.CopyPasteTargetType&&!F.isFromCurrentSession})};tl.Object.defineProperties(oe.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 112}}});Object($d.a)(oe,"PasteArtOtherWorkbookEvent",Sd,[]);vm(Zd,Sd);Zd.prototype.fc=function(){this.Tb(503)};Zd.prototype.ng=function(){this.xd(function(F){return!!F.pasteParameters.ClientEstimationFloatingObjectId&&2===F.pasteParameters.CopyPasteTargetType&&F.isFromCurrentSession})};tl.Object.defineProperties(Zd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 52}}});Object($d.a)(Zd,"PasteArtSameWorkbookEvent",
Sd,[]);vm(Yc,Sd);Yc.prototype.fc=function(){this.Tb(204)};tl.Object.defineProperties(Yc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 110}}});Object($d.a)(Yc,"PasteHtmlEvent",Sd,[]);vm(fc,Sd);fc.prototype.fc=function(){this.Tb(506)};tl.Object.defineProperties(fc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 35}}});Object($d.a)(fc,"PasteRangeEvent",Sd,[]);vm(Vb,Sd);Vb.prototype.fc=function(){this.Tb(503)};Vb.prototype.ng=function(){this.xd(function(F){return 1===
F.pasteParameters.CopyPasteTargetType})};tl.Object.defineProperties(Vb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 111}}});Object($d.a)(Vb,"PasteShadowWorkbookRangeEvent",Sd,[]);vm(ab,Sd);ab.prototype.fc=function(){this.Tb(180)};tl.Object.defineProperties(ab.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 42}}});Object($d.a)(ab,"PasteStringEvent",Sd,[]);vm(ea,Sd);ea.prototype.fc=function(){this.Tb(220)};tl.Object.defineProperties(ea.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 134}}});Object($d.a)(ea,"PendingMergeEvent",Sd,[]);vm(aa,Sd);aa.prototype.fc=function(){this.Tb(510)};tl.Object.defineProperties(aa.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 122}}});Object($d.a)(aa,"PictureInsertedEvent",Sd,[]);vm(H,Sd);H.prototype.fc=function(){this.Tb(161)};tl.Object.defineProperties(H.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 153}}});Object($d.a)(H,"PivotDrillToggledEvent",Sd,[]);vm(ha,
Sd);ha.prototype.fc=function(){this.Tb(225)};ha.prototype.ng=function(){var F=this;this.xd(function(fa){return fa.opType===F.opType})};tl.Object.defineProperties(ha.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.Pea}}});Object($d.a)(ha,"PivotTableSettingsChangedEventBase",Sd,[]);vm(K,ha);Object($d.a)(K,"PivotTableAllItemLabelsRepeatedEvent",ha,[]);vm(pc,ha);Object($d.a)(pc,"PivotTableAltTextDescriptionChangedEvent",ha,[]);vm(Cd,ha);Object($d.a)(Cd,"PivotTableAltTextTitleChangedEvent",
ha,[]);vm(lc,ha);Object($d.a)(lc,"PivotTableAutoFitColumnWidthsOnRefreshToggledEvent",ha,[]);vm(qc,ha);Object($d.a)(qc,"PivotTableBlankLineAfterEachItemToggledEvent",ha,[]);vm(Ka,ha);Object($d.a)(Ka,"PivotTableColumnGrandTotalShownEvent",ha,[]);vm(ja,Sd);ja.prototype.fc=function(){this.Tb(132)};tl.Object.defineProperties(ja.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 98}}});Object($d.a)(ja,"PivotTableCreatedEvent",Sd,[]);vm(qe,ha);Object($d.a)(qe,"PivotTableDisplayErrorStringToggledEvent",
ha,[]);vm(Ue,ha);Object($d.a)(Ue,"PivotTableDisplayNullStringToggledEvent",ha,[]);vm(xe,ha);Object($d.a)(xe,"PivotTableErrorStringChangedEvent",ha,[]);vm(pd,ha);Object($d.a)(pd,"PivotTableExpandCollapseButtonsShownEvent",ha,[]);vm(Nc,ha);Object($d.a)(Nc,"PivotTableIndentChangedEvent",ha,[]);vm(ic,ha);Object($d.a)(ic,"PivotTableItemsWithNoDataOnColumnsShownEvent",ha,[]);vm(Bb,ha);Object($d.a)(Bb,"PivotTableItemsWithNoDataOnRowsShownEvent",ha,[]);vm(h,ha);Object($d.a)(h,"PivotTableLayoutTypeSetEvent",
ha,[]);vm(Th,ha);Object($d.a)(Th,"PivotTableNullStringChangedEvent",ha,[]);vm(Ih,Sd);Ih.prototype.fc=function(){this.Tb(219)};tl.Object.defineProperties(Ih.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 149}}});Object($d.a)(Ih,"PivotTablePivotLocationChangedEvent",Sd,[]);vm(fe,Sd);fe.prototype.fc=function(){this.Tb(145)};tl.Object.defineProperties(fe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 102}}});Object($d.a)(fe,"PivotTablePivotedEvent",Sd,
[]);vm(Tg,ha);Object($d.a)(Tg,"PivotTableRefreshDataOnLoadToggledEvent",ha,[]);vm(ch,Sd);ch.prototype.fc=function(){this.Tb(50)};ch.prototype.ng=function(){this.xd(function(F){return!!F.pivotTableId&&!!F.pivotTableName})};tl.Object.defineProperties(ch.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 104}}});Object($d.a)(ch,"PivotTableRefreshedEvent",Sd,[]);vm(Bf,ha);Object($d.a)(Bf,"PivotTableRenamedEvent",ha,[]);vm(Cf,ha);Object($d.a)(Cf,"PivotTableRowGrandTotalShownEvent",
ha,[]);vm(ye,ha);Object($d.a)(ye,"PivotTableSaveSourceDataWithFileToggledEvent",ha,[]);var Nk=b(652);vm(Hd,Sd);Hd.prototype.fc=function(){this.Tb(131)};Hd.prototype.ng=function(){this.xd(function(F){F=Object(Wi.a)(Nk.a,F);return!!F&&!!F.AJa()&&!!F.hierarchyName})};tl.Object.defineProperties(Hd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 155}}});Object($d.a)(Hd,"PivotTableSortedEvent",Sd,[]);vm(yb,ha);Object($d.a)(yb,"PivotTableSubTotalsVisibilitySettingSetEvent",ha,[]);
vm(ra,Sd);ra.prototype.fc=function(){this.Tb(560)};tl.Object.defineProperties(ra.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 206}}});Object($d.a)(ra,"PivotValueFieldSettingAppliedEvent",Sd,[]);vm(Ca,Sd);Ca.prototype.fc=function(){this.Tb(243)};tl.Object.defineProperties(Ca.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 161}}});Object($d.a)(Ca,"PrintAreaClearedEvent",Sd,[]);vm(xi,Sd);xi.prototype.fc=function(){this.Tb(241)};xi.prototype.ng=function(){this.xd(function(F){return!F.addToPrintArea})};
tl.Object.defineProperties(xi.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 159}}});Object($d.a)(xi,"PrintAreaSetEvent",Sd,[]);vm(Qh,Sd);Qh.prototype.fc=function(){this.Tb(517)};tl.Object.defineProperties(Qh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 57}}});Object($d.a)(Qh,"RangeAutoFilterClearedEvent",Sd,[]);vm(eh,Sd);eh.prototype.fc=function(){this.Tb(11)};eh.prototype.ng=function(){var F=this;this.xd(function(fa){return 16===fa.cellFormat.ValidMembers});
this.xd(function(fa){return fa.cellFormat.Font.ValidMembers===F.FWd})};tl.Object.defineProperties(eh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.Pea}}});Object($d.a)(eh,"RangeFontFormattedEventBase",Sd,[]);vm(If,eh);Object($d.a)(If,"RangeBoldedEvent",eh,[]);vm(fh,Sd);fh.prototype.fc=function(){this.Tb(11)};fh.prototype.ng=function(){this.xd(function(F){return 128===F.cellFormat.ValidMembers})};tl.Object.defineProperties(fh.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 2}}});Object($d.a)(fh,"RangeBorderedEvent",Sd,[]);yh.b9a="Table";yh.bnc="Sheet";Object($d.a)(yh,"MacroRecorderEventConstants",null,[]);vm(Kg,Sd);Kg.prototype.fc=function(){this.Tb(208)};Kg.prototype.ng=function(){this.xd(function(F){return F.getParameters().FilterType===yh.bnc})};tl.Object.defineProperties(Kg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 113}}});Object($d.a)(Kg,"RangeCheckedItemsFilteredEvent",Sd,[]);vm(Vg,Sd);Vg.prototype.fc=function(){this.Tb(106);
this.Tb(105)};tl.Object.defineProperties(Vg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 109}}});Object($d.a)(Vg,"RangeConditionalFormattingChangedEvent",Sd,[]);vm(Qf,Sd);Qf.prototype.fc=function(){this.Tb(221)};tl.Object.defineProperties(Qf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 124}}});Object($d.a)(Qf,"RangeConditionalFormattingRuleDeletedEvent",Sd,[]);vm(Ef,Sd);Ef.prototype.fc=function(){this.Tb(508)};Ef.prototype.ng=function(){this.xd(function(F){return 3===
F.xt()||1===F.xt()||4===F.xt()})};tl.Object.defineProperties(Ef.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 29}}});Object($d.a)(Ef,"RangeContentClearedEvent",Sd,[]);vm(ff,Sd);ff.prototype.fc=function(){this.Tb(104)};tl.Object.defineProperties(ff.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 40}}});Object($d.a)(ff,"RangeCopiedCutCellsInsertedEvent",Sd,[]);vm(kf,Sd);kf.prototype.fc=function(){this.Tb(209)};kf.prototype.ng=function(){this.xd(function(F){return F.getParameters().FilterType===
yh.bnc})};tl.Object.defineProperties(kf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 114}}});Object($d.a)(kf,"RangeCustomFilteredEvent",Sd,[]);vm(df,Sd);df.prototype.fc=function(){this.Tb(121)};tl.Object.defineProperties(df.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 106}}});Object($d.a)(df,"RangeDataValidationChangedEvent",Sd,[]);vm(He,eh);Object($d.a)(He,"RangeDoubleUnderlinedEvent",eh,[]);vm(ke,Sd);ke.prototype.fc=function(){this.Tb(190)};
tl.Object.defineProperties(ke.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 69}}});Object($d.a)(ke,"RangeDuplicatesRemovedEvent",Sd,[]);vm(hd,Sd);hd.prototype.fc=function(){this.Tb(527);this.Tb(12)};tl.Object.defineProperties(hd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 1}}});Object($d.a)(hd,"RangeEditedEvent",Sd,[]);vm(zb,Sd);zb.prototype.fc=function(){Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5347704_WebExternalLinksEnableBreakLinksErrors")?
this.Tb(255):this.Tb(232)};zb.prototype.ng=function(){this.xd(function(F){return 4===F.actionType})};zb.prototype.cV=function(){this.WEa("Microsoft.Office.Excel.WebExternalLinksSupportMacroRecorder")};tl.Object.defineProperties(zb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 164}}});Object($d.a)(zb,"RangeExternalLinksBrokeAllLinksEvent",Sd,[]);vm(Dc,Sd);Dc.prototype.fc=function(){Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5347704_WebExternalLinksEnableBreakLinksErrors")?
this.Tb(255):this.Tb(232)};Dc.prototype.ng=function(){this.xd(function(F){return 3===F.actionType})};Dc.prototype.cV=function(){this.WEa("Microsoft.Office.Excel.WebExternalLinksSupportMacroRecorder")};tl.Object.defineProperties(Dc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 119}}});Object($d.a)(Dc,"RangeExternalLinksBrokeLinkEvent",Sd,[]);vm(Wb,Sd);Wb.prototype.fc=function(){Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5347704_WebExternalLinksEnableBreakLinksErrors")?
this.Tb(256):this.Tb(249)};Wb.prototype.cV=function(){this.WEa("Microsoft.Office.Excel.WebExternalLinksChangeSourceMacroRecorder")};tl.Object.defineProperties(Wb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 205}}});Object($d.a)(Wb,"RangeExternalLinksChangeSourceEvent",Sd,[]);vm(nb,Sd);nb.prototype.fc=function(){this.Tb(553)};nb.prototype.ng=function(){this.xd(function(F){return 1===F.actionType})};nb.prototype.cV=function(){this.WEa("Microsoft.Office.Excel.WebExternalLinksSupportMacroRecorder")};
tl.Object.defineProperties(nb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 163}}});Object($d.a)(nb,"RangeExternalLinksRefreshedAllEvent",Sd,[]);vm(la,Sd);la.prototype.fc=function(){this.Tb(553)};la.prototype.ng=function(){this.xd(function(F){return!F.actionType})};la.prototype.cV=function(){this.WEa("Microsoft.Office.Excel.WebExternalLinksSupportMacroRecorder")};tl.Object.defineProperties(la.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 77}}});
Object($d.a)(la,"RangeExternalLinksRefreshedEvent",Sd,[]);vm(ii,Sd);ii.prototype.fc=function(){this.Tb(224)};ii.prototype.cV=function(){this.WEa("Microsoft.Office.Excel.WebExternalLinksSupportMacroRecorder")};tl.Object.defineProperties(ii.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 165}}});Object($d.a)(ii,"RangeExternalLinksSetAutoRefreshEvent",Sd,[]);vm(yi,Sd);yi.prototype.fc=function(){this.Tb(11)};yi.prototype.ng=function(){this.xd(function(F){return 64===F.cellFormat.ValidMembers})};
tl.Object.defineProperties(yi.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 5}}});Object($d.a)(yi,"RangeFillColoredEvent",Sd,[]);vm(gh,Sd);gh.prototype.fc=function(){this.Tb(155)};tl.Object.defineProperties(gh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 59}}});Object($d.a)(gh,"RangeFilledEvent",Sd,[]);vm(Ch,Sd);Ch.prototype.fc=function(){this.Tb(176)};Ch.prototype.ng=function(){this.xd(function(F){return F.BU().AutoFilterType===yh.bnc&&!!F.BU().CriteriaType})};
tl.Object.defineProperties(Ch.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 115}}});Object($d.a)(Ch,"RangeFilterAppliedEvent",Sd,[]);vm(qi,Sd);qi.prototype.fc=function(){this.Tb(176)};qi.prototype.ng=function(){this.xd(function(F){return F.BU().AutoFilterType===yh.bnc&&!F.BU().CriteriaType})};tl.Object.defineProperties(qi.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 58}}});Object($d.a)(qi,"RangeFilterClearedEvent",Sd,[]);vm(ah,Sd);ah.prototype.fc=
function(){this.Tb(518)};tl.Object.defineProperties(ah.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 41}}});Object($d.a)(ah,"RangeFilterReappliedEvent",Sd,[]);vm(hi,Sd);hi.prototype.fc=function(){this.Tb(150)};tl.Object.defineProperties(hi.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 86}}});Object($d.a)(hi,"RangeFlashFilledEvent",Sd,[]);vm(Pg,eh);Object($d.a)(Pg,"RangeFontColoredEvent",eh,[]);vm(th,eh);Object($d.a)(th,"RangeFontItalicizedEvent",
eh,[]);vm(ti,eh);Object($d.a)(ti,"RangeFontNamedEvent",eh,[]);vm(Ki,eh);Object($d.a)(Ki,"RangeFontSizedEvent",eh,[]);vm(Fg,Sd);Fg.prototype.fc=function(){this.Tb(215)};tl.Object.defineProperties(Fg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 74}}});Object($d.a)(Fg,"RangeFormattedAsTableEvent",Sd,[]);vm(jh,Sd);jh.prototype.fc=function(){this.Tb(188)};tl.Object.defineProperties(jh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 97}}});Object($d.a)(jh,
"RangeGroupedOrUngroupedEvent",Sd,[]);vm(Rg,Sd);Rg.prototype.fc=function(){this.Tb(11)};Rg.prototype.ng=function(){this.xd(function(F){return 2===F.cellFormat.ValidMembers})};tl.Object.defineProperties(Rg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 60}}});Object($d.a)(Rg,"RangeHorizontallyAlignedEvent",Sd,[]);vm(Ye,Sd);Ye.prototype.fc=function(){this.Tb(526)};tl.Object.defineProperties(Ye.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 43}}});Object($d.a)(Ye,
"RangeHyperlinkAppliedEvent",Sd,[]);vm(lh,Sd);lh.prototype.fc=function(){this.Tb(11)};lh.prototype.ng=function(){this.xd(function(F){return 256===F.cellFormat.ValidMembers})};tl.Object.defineProperties(lh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 63}}});Object($d.a)(lh,"RangeIndentChangedEvent",Sd,[]);vm(sg,Sd);sg.prototype.fc=function(){this.Tb(156)};sg.prototype.ng=function(){this.xd(function(F){return 2===F.xt()||5===F.xt()||6===F.xt()||7===F.xt()})};tl.Object.defineProperties(sg.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 53}}});Object($d.a)(sg,"RangeMergedEvent",Sd,[]);vm(kd,Sd);kd.prototype.fc=function(){this.Tb(216)};tl.Object.defineProperties(kd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 107}}});Object($d.a)(kd,"RangeNamedCellStyleAppliedEvent",Sd,[]);vm(oh,Sd);oh.prototype.fc=function(){this.Tb(11)};oh.prototype.ng=function(){this.xd(function(F){return 32===F.cellFormat.ValidMembers})};tl.Object.defineProperties(oh.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 12}}});Object($d.a)(oh,"RangeNumberFormattedEvent",Sd,[]);var ek=b(1094);vm(Jg,Sd);Jg.prototype.fc=function(){this.Tb(141)};Jg.prototype.ng=function(){this.xd(function(F){return Object(qj.a)(ek.a,F)})};tl.Object.defineProperties(Jg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 108}}});Object($d.a)(Jg,"RangeSortedEvent",Sd,[]);vm(Oh,eh);Object($d.a)(Oh,"RangeStrikedThroughEvent",eh,[]);vm(wf,eh);Object($d.a)(wf,
"RangeUnderlinedEvent",eh,[]);vm(td,Sd);td.prototype.fc=function(){this.Tb(11)};td.prototype.ng=function(){this.xd(function(F){return 1===F.cellFormat.ValidMembers})};tl.Object.defineProperties(td.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 61}}});Object($d.a)(td,"RangeVerticallyAlignedEvent",Sd,[]);vm(mg,Sd);mg.prototype.fc=function(){this.Tb(11)};mg.prototype.ng=function(){this.xd(function(F){return 8===F.cellFormat.ValidMembers})};tl.Object.defineProperties(mg.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 62}}});Object($d.a)(mg,"RangeWrapTextToggledEvent",Sd,[]);vm(wg,Sd);wg.prototype.fc=function(){this.Tb(51)};tl.Object.defineProperties(wg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 103}}});Object($d.a)(wg,"RefreshedAllEvent",Sd,[]);vm(Xe,Sd);Xe.prototype.fc=function(){this.Tb(148)};tl.Object.defineProperties(Xe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 47}}});Object($d.a)(Xe,"ReplaceAllEvent",
Sd,[]);vm(jg,Sd);jg.prototype.fc=function(){this.Tb(532)};jg.prototype.ng=function(){this.xd(function(F){return 95!==F.getShapeType()&&96!==F.getShapeType()&&97!==F.getShapeType()&&98!==F.getShapeType()&&100!==F.getShapeType()&&102!==F.getShapeType()&&103!==F.getShapeType()})};tl.Object.defineProperties(jg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 91}}});Object($d.a)(jg,"ShapeInsertedEvent",Sd,[]);vm(eg,Sd);eg.prototype.fc=function(){this.Tb(531)};tl.Object.defineProperties(eg.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 92}}});Object($d.a)(eg,"ShapeStyleSetEvent",Sd,[]);var Yi=b(946);vm(vf,Sd);vf.prototype.fc=function(){this.Tb(581)};vf.prototype.ng=function(){var F=this;this.xd(function(fa){return Object(qj.a)(Yi.a,fa)&&4===fa.getShapeTextFormat().ValidMembers});this.xd(function(fa){return Object(qj.a)(Yi.a,fa)&&fa.getShapeTextFormat().Font.ValidMembers===F.FWd})};tl.Object.defineProperties(vf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return this.Pea}}});
Object($d.a)(vf,"ShapeTextFontFormattedEventBase",Sd,[]);vm(tf,vf);Object($d.a)(tf,"ShapeTextBoldedEvent",vf,[]);var Lj=b(1096);vm(Dd,Sd);Dd.prototype.fc=function(){this.Tb(581)};Dd.prototype.ng=function(){this.xd(function(F){return Object(qj.a)(Lj.a,F)})};tl.Object.defineProperties(Dd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 191}}});Object($d.a)(Dd,"ShapeTextChangedEvent",Sd,[]);vm(cf,vf);Object($d.a)(cf,"ShapeTextFontColorChangedEvent",vf,[]);vm(sd,vf);Object($d.a)(sd,
"ShapeTextFontNameChangedEvent",vf,[]);vm(Be,vf);Object($d.a)(Be,"ShapeTextFontSizeChangedEvent",vf,[]);vm(Ne,Sd);Ne.prototype.fc=function(){this.Tb(581)};Ne.prototype.ng=function(){this.xd(function(F){return Object(qj.a)(Yi.a,F)&&2===F.getShapeTextFormat().ValidMembers})};tl.Object.defineProperties(Ne.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 199}}});Object($d.a)(Ne,"ShapeTextHorizontallyAlignedEvent",Sd,[]);vm(Rd,vf);Object($d.a)(Rd,"ShapeTextItalicizedEvent",vf,[]);
vm(ce,vf);Object($d.a)(ce,"ShapeTextUnderlinedEvent",vf,[]);vm(ec,Sd);ec.prototype.fc=function(){this.Tb(581)};ec.prototype.ng=function(){this.xd(function(F){return Object(qj.a)(Yi.a,F)&&1===F.getShapeTextFormat().ValidMembers})};tl.Object.defineProperties(ec.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 200}}});Object($d.a)(ec,"ShapeTextVerticallyAlignedEvent",Sd,[]);vm(sb,Sd);sb.prototype.fc=function(){this.Tb(138)};tl.Object.defineProperties(sb.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 13}}});Object($d.a)(sb,"SheetAddedEvent",Sd,[]);var uj=b(9);vm(vc,Sd);vc.prototype.fc=function(){this.Tb(237)};vc.prototype.ng=function(){this.xd(function(F){return!!F.insertDeleteMultiRangeParameters});this.xd(function(F){return!F.insertDeleteMultiRangeParameters.IsTableCommand});this.xd(function(F){F=F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0>F.DeltaColumn&&!F.DeltaRow&&(!!F.InsertDeleteRange.FirstRow||F.InsertDeleteRange.LastRow!==
uj.a.dz)||!F.DeltaColumn&&0>F.DeltaRow&&(!!F.InsertDeleteRange.FirstColumn||F.InsertDeleteRange.LastColumn!==uj.a.ew)})};tl.Object.defineProperties(vc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 142}}});Object($d.a)(vc,"SheetCellsDeletedEvent",Sd,[]);vm($b,Sd);$b.prototype.fc=function(){this.Tb(237)};$b.prototype.ng=function(){this.xd(function(F){return!!F.insertDeleteMultiRangeParameters});this.xd(function(F){return!F.insertDeleteMultiRangeParameters.IsTableCommand});
this.xd(function(F){F=F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0];return 0<F.DeltaColumn&&!F.DeltaRow&&(!!F.InsertDeleteRange.FirstRow||F.InsertDeleteRange.LastRow!==uj.a.dz)||!F.DeltaColumn&&0<F.DeltaRow&&(!!F.InsertDeleteRange.FirstColumn||F.InsertDeleteRange.LastColumn!==uj.a.ew)})};tl.Object.defineProperties($b.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 143}}});Object($d.a)($b,"SheetCellsInsertedEvent",Sd,[]);vm(rb,Sd);rb.prototype.fc=function(){this.Tb(237)};
rb.prototype.ng=function(){this.xd(function(F){return!!F.insertDeleteMultiRangeParameters});this.xd(function(F){return!F.insertDeleteMultiRangeParameters.IsTableCommand});this.xd(function(F){return 0>F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.xd(function(F){return!F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.xd(function(F){return!F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow});this.xd(function(F){return F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===
uj.a.dz})};tl.Object.defineProperties(rb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 139}}});Object($d.a)(rb,"SheetColumnDeletedEvent",Sd,[]);vm(Da,Sd);Da.prototype.fc=function(){this.Tb(237)};Da.prototype.ng=function(){this.xd(function(F){return!!F.insertDeleteMultiRangeParameters});this.xd(function(F){return!F.insertDeleteMultiRangeParameters.IsTableCommand});this.xd(function(F){return 0<F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.xd(function(F){return!F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});
this.xd(function(F){return!F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstRow});this.xd(function(F){return F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastRow===uj.a.dz})};tl.Object.defineProperties(Da.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 138}}});Object($d.a)(Da,"SheetColumnInsertedEvent",Sd,[]);vm(Vf,Sd);Vf.prototype.fc=function(){this.Tb(137)};tl.Object.defineProperties(Vf.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return 14}}});Object($d.a)(Vf,"SheetDeletedEvent",Sd,[]);vm(sf,Sd);sf.prototype.fc=function(){this.Tb(185)};tl.Object.defineProperties(sf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 137}}});Object($d.a)(sf,"SheetDirectionChangedEvent",Sd,[]);vm(Qe,Sd);Qe.prototype.fc=function(){this.Tb(139)};tl.Object.defineProperties(Qe.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 54}}});Object($d.a)(Qe,"SheetDuplicatedEvent",Sd,
[]);vm(Me,Sd);Me.prototype.fc=function(){this.Tb(207)};tl.Object.defineProperties(Me.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 15}}});Object($d.a)(Me,"SheetNameEditedEvent",Sd,[]);vm(Md,Sd);Md.prototype.fc=function(){this.Tb(151)};tl.Object.defineProperties(Md.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 90}}});Object($d.a)(Md,"SheetPaneFrozenEvent",Sd,[]);vm(md,Sd);md.prototype.fc=function(){this.Tb(226)};tl.Object.defineProperties(md.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 120}}});Object($d.a)(md,"SheetPrintSettingsSavedEvent",Sd,[]);var Pj=b(997);vm(Ec,Sd);Ec.prototype.fc=function(){this.Tb(507)};Ec.prototype.cV=function(){this.WEa("Microsoft.Office.Excel.SheetProtectionMacroRecording")};Ec.prototype.ng=function(){this.xd(function(F){return Object.getType(F)===Pj.a})};tl.Object.defineProperties(Ec.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 215}}});Object($d.a)(Ec,"SheetProtectionPausedResumedEvent",
Sd,[]);vm(Ob,Sd);Ob.prototype.fc=function(){this.Tb(557)};tl.Object.defineProperties(Ob.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 64}}});Object($d.a)(Ob,"SheetReorderedEvent",Sd,[]);vm(Aa,Sd);Aa.prototype.fc=function(){this.Tb(237)};Aa.prototype.ng=function(){this.xd(function(F){return!!F.insertDeleteMultiRangeParameters});this.xd(function(F){return!F.insertDeleteMultiRangeParameters.IsTableCommand});this.xd(function(F){return!F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});
this.xd(function(F){return 0>F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.xd(function(F){return!F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn});this.xd(function(F){return F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===uj.a.ew})};tl.Object.defineProperties(Aa.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 141}}});Object($d.a)(Aa,"SheetRowDeletedEvent",Sd,
[]);vm($f,Sd);$f.prototype.fc=function(){this.Tb(237)};$f.prototype.ng=function(){this.xd(function(F){return!!F.insertDeleteMultiRangeParameters});this.xd(function(F){return!F.insertDeleteMultiRangeParameters.IsTableCommand});this.xd(function(F){return!F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.xd(function(F){return 0<F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow});this.xd(function(F){return!F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.FirstColumn});
this.xd(function(F){return F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].InsertDeleteRange.LastColumn===uj.a.ew})};tl.Object.defineProperties($f.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 140}}});Object($d.a)($f,"SheetRowInsertedEvent",Sd,[]);vm(lg,Sd);lg.prototype.fc=function(){this.Tb(135)};tl.Object.defineProperties(lg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 39}}});Object($d.a)(lg,"SheetRowsColumnsAutoFitEvent",Sd,[]);
vm(ag,Sd);ag.prototype.fc=function(){this.Tb(136)};tl.Object.defineProperties(ag.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 36}}});Object($d.a)(ag,"SheetRowsColumnsResizedEvent",Sd,[]);vm(ef,Sd);ef.prototype.fc=function(){this.Tb(183)};tl.Object.defineProperties(ef.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 68}}});Object($d.a)(ef,"SheetShowGridlinesToggledEvent",Sd,[]);vm(Od,Sd);Od.prototype.fc=function(){this.Tb(184)};tl.Object.defineProperties(Od.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 67}}});Object($d.a)(Od,"SheetShowHeadingsToggledEvent",Sd,[]);vm(Ld,Sd);Ld.prototype.fc=function(){this.Tb(213)};tl.Object.defineProperties(Ld.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 89}}});Object($d.a)(Ld,"SheetSpellCheckedEvent",Sd,[]);vm(Bd,Sd);Bd.prototype.fc=function(){this.Tb(515)};tl.Object.defineProperties(Bd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 70}}});Object($d.a)(Bd,
"SheetTabColoredEvent",Sd,[]);vm(bd,Sd);bd.prototype.fc=function(){this.Tb(157)};tl.Object.defineProperties(bd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 71}}});Object($d.a)(bd,"SheetVisibilityChangedEvent",Sd,[]);vm(xc,Sd);xc.prototype.fc=function(){this.Tb(239)};tl.Object.defineProperties(xc.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 126}}});Object($d.a)(xc,"SheetsVisibilityChangedEvent",Sd,[]);vm(Hf,Sd);Hf.prototype.fc=function(){this.Tb(203)};
tl.Object.defineProperties(Hf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 188}}});Object($d.a)(Hf,"SlicerInsertedEvent",Sd,[]);vm(tg,Sd);tg.prototype.fc=function(){this.Tb(173)};tg.prototype.ng=function(){this.xd(function(F){return!F.clearFilter})};tl.Object.defineProperties(tg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 189}}});Object($d.a)(tg,"SlicerSelectionAppliedEvent",Sd,[]);vm(zf,Sd);zf.prototype.fc=function(){this.Tb(173)};zf.prototype.ng=
function(){this.xd(function(F){return F.clearFilter})};tl.Object.defineProperties(zf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 190}}});Object($d.a)(zf,"SlicerSelectionClearedEvent",Sd,[]);vm(Wf,Sd);Wf.prototype.fc=function(){this.Tb(208)};Wf.prototype.ng=function(){this.xd(function(F){return F.getParameters().FilterType===yh.b9a})};tl.Object.defineProperties(Wf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 27}}});Object($d.a)(Wf,"TableCheckedItemsFilteredEvent",
Sd,[]);vm(bg,Sd);bg.prototype.fc=function(){this.Tb(237)};bg.prototype.ng=function(){this.xd(function(F){return!!F.insertDeleteMultiRangeParameters});this.xd(function(F){return F.insertDeleteMultiRangeParameters.IsTableCommand});this.xd(function(F){return 0>F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.xd(function(F){return!F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};tl.Object.defineProperties(bg.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 144}}});Object($d.a)(bg,"TableColumnDeletedEvent",Sd,[]);vm(mf,Sd);mf.prototype.fc=function(){this.Tb(237)};mf.prototype.ng=function(){this.xd(function(F){return!!F.insertDeleteMultiRangeParameters});this.xd(function(F){return F.insertDeleteMultiRangeParameters.IsTableCommand});this.xd(function(F){return 0<F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.xd(function(F){return!F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};
tl.Object.defineProperties(mf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 145}}});Object($d.a)(mf,"TableColumnInsertedEvent",Sd,[]);var zj=b(1095);vm(Og,Sd);Og.prototype.fc=function(){this.Tb(141)};Og.prototype.ng=function(){this.xd(function(F){return Object(qj.a)(zj.a,F)})};tl.Object.defineProperties(Og.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 121}}});Object($d.a)(Og,"TableColumnSortedEvent",Sd,[]);vm(xf,Sd);xf.prototype.fc=function(){this.Tb(193)};
tl.Object.defineProperties(xf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 105}}});Object($d.a)(xf,"TableConvertedToRangeEvent",Sd,[]);vm(bf,Sd);bf.prototype.fc=function(){this.Tb(206)};tl.Object.defineProperties(bf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 16}}});Object($d.a)(bf,"TableCreatedEvent",Sd,[]);vm(lf,Sd);lf.prototype.fc=function(){this.Tb(209)};lf.prototype.ng=function(){this.xd(function(F){return F.getParameters().FilterType===
yh.b9a})};tl.Object.defineProperties(lf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 30}}});Object($d.a)(lf,"TableCustomFilteredEvent",Sd,[]);vm(te,Sd);te.prototype.fc=function(){this.Tb(187)};te.prototype.ng=function(){this.xd(function(F){return 1===F.options.OperationType})};tl.Object.defineProperties(te.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 25}}});Object($d.a)(te,"TableCustomSortedEvent",Sd,[]);vm(ze,Sd);ze.prototype.fc=function(){this.Tb(176)};
ze.prototype.ng=function(){this.xd(function(F){return F.BU().AutoFilterType===yh.b9a});this.xd(function(F){return!F.BU().CriteriaType})};tl.Object.defineProperties(ze.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 28}}});Object($d.a)(ze,"TableFilterClearedEvent",Sd,[]);vm(yd,Sd);yd.prototype.fc=function(){this.Tb(176)};yd.prototype.ng=function(){this.xd(function(F){return F.BU().AutoFilterType===yh.b9a});this.xd(function(F){var fa=new Ph.a;fa.add(1);fa.add(2);fa.add(8);fa.add(9);
fa.add(10);fa.add(11);fa.add(12);fa.add(13);fa.add(14);fa.add(15);fa.add(16);fa.add(17);fa.add(18);fa.add(19);fa.add(20);fa.add(21);fa.add(22);fa.add(23);fa.add(24);fa.add(25);fa.add(26);fa.add(27);fa.add(28);fa.add(29);fa.add(30);fa.add(31);fa.add(32);fa.add(33);fa.add(34);fa.add(35);fa.add(36);fa.add(37);fa.add(38);fa.add(39);return fa.contains(F.BU().CriteriaType)})};tl.Object.defineProperties(yd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 32}}});Object($d.a)(yd,"TableItemFilteredEvent",
Sd,[]);vm(Kd,Sd);Kd.prototype.fc=function(){this.Tb(217)};tl.Object.defineProperties(Kd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 101}}});Object($d.a)(Kd,"TableRenamedEvent",Sd,[]);vm(dd,Sd);dd.prototype.fc=function(){this.Tb(211)};tl.Object.defineProperties(dd.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 73}}});Object($d.a)(dd,"TableResizedEvent",Sd,[]);vm(tc,Sd);tc.prototype.fc=function(){this.Tb(514)};tl.Object.defineProperties(tc.prototype,
{eventId:{configurable:!0,enumerable:!0,get:function(){return 44}}});Object($d.a)(tc,"TableRowColumnRearrangedEvent",Sd,[]);vm(qb,Sd);qb.prototype.fc=function(){this.Tb(237)};qb.prototype.ng=function(){this.xd(function(F){return!!F.insertDeleteMultiRangeParameters});this.xd(function(F){return F.insertDeleteMultiRangeParameters.IsTableCommand});this.xd(function(F){return!F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.xd(function(F){return 0>F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};
tl.Object.defineProperties(qb.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 146}}});Object($d.a)(qb,"TableRowDeletedEvent",Sd,[]);vm(Pa,Sd);Pa.prototype.fc=function(){this.Tb(237)};Pa.prototype.ng=function(){this.xd(function(F){return!!F.insertDeleteMultiRangeParameters});this.xd(function(F){return F.insertDeleteMultiRangeParameters.IsTableCommand});this.xd(function(F){return!F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaColumn});this.xd(function(F){return 0<
F.insertDeleteMultiRangeParameters.InsertDeleteRangeItems[0].DeltaRow})};tl.Object.defineProperties(Pa.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 147}}});Object($d.a)(Pa,"TableRowInsertedEvent",Sd,[]);vm(mh,Sd);mh.prototype.fc=function(){this.Tb(177)};mh.prototype.ng=function(){this.xd(function(F){return F.BU().AutoFilterType===yh.b9a})};tl.Object.defineProperties(mh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 26}}});Object($d.a)(mh,"TableSortedEvent",
Sd,[]);vm(qf,Sd);qf.prototype.fc=function(){this.Tb(212)};tl.Object.defineProperties(qf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 87}}});Object($d.a)(qf,"TableStyleAppliedEvent",Sd,[]);vm(Zg,Sd);Zg.prototype.fc=function(){this.Tb(196)};tl.Object.defineProperties(Zg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 88}}});Object($d.a)(Zg,"TableStyleOptionToggledEvent",Sd,[]);vm(qh,Sd);qh.prototype.fc=function(){this.Tb(210)};qh.prototype.ng=function(){this.xd(function(F){return F.getParameters().FilterType===
yh.b9a})};tl.Object.defineProperties(qh.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 31}}});Object($d.a)(qh,"TableTop10FilteredEvent",Sd,[]);vm(Bg,Sd);Bg.prototype.fc=function(){this.Tb(238)};tl.Object.defineProperties(Bg.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 207}}});Object($d.a)(Bg,"TextToColumnsEvent",Sd,[]);vm(hg,Sd);hg.prototype.fc=function(){this.Tb(559)};tl.Object.defineProperties(hg.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 128}}});Object($d.a)(hg,"ValuesSortedEvent",Sd,[]);vm(Ze,Sd);Ze.prototype.fc=function(){this.Tb(197)};tl.Object.defineProperties(Ze.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 55}}});Object($d.a)(Ze,"WorkbookCalculationModeSetEvent",Sd,[]);vm(Re,Sd);Re.prototype.fc=function(){this.Tb(181)};Re.prototype.ng=function(){this.xd(function(F){return!!F.parentCommentId})};tl.Object.defineProperties(Re.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 34}}});
Object($d.a)(Re,"WorkbookCommentRepliedEvent",Sd,[]);vm(Rf,Sd);Rf.prototype.fc=function(){this.Tb(181)};Rf.prototype.ng=function(){this.xd(function(F){return!F.parentCommentId})};tl.Object.defineProperties(Rf.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 33}}});Object($d.a)(Rf,"WorkbookCommentedEvent",Sd,[]);vm(be,Sd);be.prototype.fc=function(){this.Tb(128)};tl.Object.defineProperties(be.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 56}}});Object($d.a)(be,
"WorkbookRecalculatedEvent",Sd,[]);vm(Ff,Sd);Ff.prototype.fc=function(){this.Tb(171)};tl.Object.defineProperties(Ff.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 46}}});Object($d.a)(Ff,"WorkbookRedoEvent",Sd,[]);vm(ng,Sd);ng.prototype.fc=function(){this.Tb(170)};tl.Object.defineProperties(ng.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 45}}});Object($d.a)(ng,"WorkbookUndoEvent",Sd,[]);vm(Zf,Sd);Zf.prototype.fc=function(){this.Tb(507);this.Tb(576);
this.Tb(10)};Zf.prototype.ng=function(){this.xd(function(F){if(Object(qj.a)(hf,F)&&(F=Object(Wi.a)(hf,F),void 0!==F.source&&null!==F.source&&void 0!==F.eventId&&null!==F.eventId))return Se.ULS.sendTraceTag(537155426,0,50,"[RichApiRecorder]: received a valid but unhandled event: source: {0}; eventId: {1}.",F.source,F.eventId),!0;Se.ULS.sendTraceTag(537155425,0,50,"[RichApiRecorder]: an invalid event was ignored.");return!1})};tl.Object.defineProperties(Zf.prototype,{eventId:{configurable:!0,enumerable:!0,
get:function(){return 116}}});Object($d.a)(Zf,"DefaultRichApiRequestExecutedEvent",Sd,[]);vm(Ng,Sd);Ng.prototype.fc=function(){this.Tb(1022)};tl.Object.defineProperties(Ng.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 216}}});Object($d.a)(Ng,"TablelAltTextEditedEvent",Sd,[]);vm(Ie,Sd);Ie.prototype.fc=function(){this.Tb(263)};tl.Object.defineProperties(Ie.prototype,{eventId:{configurable:!0,enumerable:!0,get:function(){return 217}}});Object($d.a)(Ie,"FloatingObjectZOrderChangedEvent",
Sd,[]);cg.prototype.VXe=function(F,fa){var Qa=this.WXe(F,this.macroRecorderEvents,fa);Qa||(Qa=this.WXe(F,cg.gVh(),fa),!Qa&&this.Gbf(F,cg.UDe,fa)&&(Qa=cg.UDe));return Qa};cg.prototype.WXe=function(F,fa,Qa){var Ab=new Ph.a;fa=yl(fa);for(var Cc=fa.next();!Cc.done;Cc=fa.next())Cc=Cc.value,this.Gbf(F,Cc,Qa)&&Ab.add(Cc);return 1===Ab.count?Ab.na(0):1<Ab.count?cg.zDh(Ab):null};cg.prototype.Gbf=function(F,fa,Qa){var Ab=cg.SNi(F,fa);return Qa?Ab&&cg.HNj(F,fa):Ab};cg.prototype.C2i=function(){for(var F=new Ph.a,
fa=yl(this.Db),Qa=fa.next();!Qa.done;Qa=fa.next()){Qa=Qa.value;for(var Ab=!1,Cc=yl(Qa.featureGates),Vc=Cc.next();!Vc.done;Vc=Cc.next())if(!Ag.EwaSettings.la(Vc.value)){F.add(Qa);Ab=!0;break}if(!Ab)for(Ab=yl(Qa.jPe),Cc=Ab.next();!Cc.done;Cc=Ab.next())if(!Ag.EwaSettings.getBooleanFeatureGate(Cc.value,!1)){F.add(Qa);break}}F=yl(F);for(fa=F.next();!fa.done;fa=F.next())this.Db.remove(fa.value)};cg.gVh=function(){cg.uAb||(cg.uAb=new Ph.a,cg.uAb.add(new Pe),cg.uAb.add(new Eg));return cg.uAb};cg.SNi=function(F,
fa){return fa.operations.contains(F.operation)};cg.HNj=function(F,fa){var Qa=fa.yAc;if(!Qa.count)return!0;fa=!0;Qa=yl(Qa);for(var Ab=Qa.next();!Ab.done;Ab=Qa.next())if(Ab=Ab.value,!Ab(F.payload)){fa=!1;break}return fa};cg.zDh=function(F){var fa=F.na(0);F=yl(F);for(var Qa=F.next();!Qa.done;Qa=F.next())Qa=Qa.value,Qa.yAc.count>fa.yAc.count&&(fa=Qa);return fa};tl.Object.defineProperties(cg.prototype,{macroRecorderEvents:{configurable:!0,enumerable:!0,get:function(){this.Db||(this.Db=new Ph.a,this.Db.add(new hd),
this.Db.add(new fh),this.Db.add(new If),this.Db.add(new He),this.Db.add(new yi),this.Db.add(new Pg),this.Db.add(new th),this.Db.add(new ti),this.Db.add(new Ki),this.Db.add(new Oh),this.Db.add(new wf),this.Db.add(new oh),this.Db.add(new sb),this.Db.add(new Vf),this.Db.add(new Me),this.Db.add(new bf),this.Db.add(new bg),this.Db.add(new mf),this.Db.add(new qb),this.Db.add(new Pa),this.Db.add(new Da),this.Db.add(new rb),this.Db.add(new $f),this.Db.add(new Aa),this.Db.add(new te),this.Db.add(new mh),this.Db.add(new Wf),
this.Db.add(new ze),this.Db.add(new Ef),this.Db.add(new lf),this.Db.add(new qh),this.Db.add(new yd),this.Db.add(new Rf),this.Db.add(new Re),this.Db.add(new fc),this.Db.add(new ag),this.Db.add(new vc),this.Db.add(new $b),this.Db.add(new lg),this.Db.add(new ff),this.Db.add(new ah),this.Db.add(new Ye),this.Db.add(new ab),this.Db.add(new tc),this.Db.add(new Ff),this.Db.add(new ng),this.Db.add(new Xe),this.Db.add(new ni),this.Db.add(new Zd),this.Db.add(new sg),this.Db.add(new Qe),this.Db.add(new Ze),this.Db.add(new be),
this.Db.add(new Qh),this.Db.add(new qi),this.Db.add(new gh),this.Db.add(new Rg),this.Db.add(new td),this.Db.add(new mg),this.Db.add(new lh),this.Db.add(new Ob),this.Db.add(new Di),this.Db.add(new Ed),this.Db.add(new Od),this.Db.add(new ef),this.Db.add(new ke),this.Db.add(new bd),this.Db.add(new Bd),this.Db.add(new dd),this.Db.add(new Fg),this.Db.add(new nd),this.Db.add(new Xg),this.Db.add(new la),this.Db.add(new Ib),this.Db.add(new hc),this.Db.add(new Rh),this.Db.add(new Td),this.Db.add(new yg),this.Db.add(new fg),
this.Db.add(new Kh),this.Db.add(new he),this.Db.add(new hi),this.Db.add(new qf),this.Db.add(new Zg),this.Db.add(new Ld),this.Db.add(new Md),this.Db.add(new jg),this.Db.add(new eg),this.Db.add(new Ah),this.Db.add(new hj),this.Db.add(new Qi),this.Db.add(new Ci),this.Db.add(new jh),this.Db.add(new ja),this.Db.add(new ug),this.Db.add(new Ti),this.Db.add(new Kd),this.Db.add(new fe),this.Db.add(new wg),this.Db.add(new ch),this.Db.add(new xf),this.Db.add(new df),this.Db.add(new kd),this.Db.add(new Jg),this.Db.add(new Vg),
this.Db.add(new Yc),this.Db.add(new Vb),this.Db.add(new oe),this.Db.add(new Kg),this.Db.add(new kf),this.Db.add(new Ch),this.Db.add(new ji),this.Db.add(new aa),this.Db.add(new Dc),this.Db.add(new md),this.Db.add(new Og),this.Db.add(new Qf),this.Db.add(new xc),this.Db.add(new nf),this.Db.add(new hg),this.Db.add(new T),this.Db.add(new rh),this.Db.add(new Oa),this.Db.add(new $g),this.Db.add(new ea),this.Db.add(new vh),this.Db.add(new Dh),this.Db.add(new sf),this.Db.add(new dh),this.Db.add(new Ih),this.Db.add(new H),
this.Db.add(new ei),this.Db.add(new Hd),this.Db.add(new Le),this.Db.add(new pf),this.Db.add(new Ge),this.Db.add(new xi),this.Db.add(new Ei),this.Db.add(new Ca),this.Db.add(new ih),this.Db.add(new nb),this.Db.add(new zb),this.Db.add(new ii),this.Db.add(new xh),this.Db.add(new ig),this.Db.add(new Bf),this.Db.add(new Cf),this.Db.add(new Ka),this.Db.add(new K),this.Db.add(new qc),this.Db.add(new lc),this.Db.add(new pd),this.Db.add(new Bb),this.Db.add(new ic),this.Db.add(new qe),this.Db.add(new Ue),this.Db.add(new xe),
this.Db.add(new Th),this.Db.add(new ye),this.Db.add(new Tg),this.Db.add(new Cd),this.Db.add(new pc),this.Db.add(new yb),this.Db.add(new h),this.Db.add(new Nc),this.Db.add(new Hf),this.Db.add(new tg),this.Db.add(new zf),this.Db.add(new Dd),this.Db.add(new tf),this.Db.add(new Rd),this.Db.add(new ce),this.Db.add(new cf),this.Db.add(new sd),this.Db.add(new Be),this.Db.add(new Ne),this.Db.add(new ec),this.Db.add(new Wb),this.Db.add(new ra),this.Db.add(new Bg),this.Db.add(new Ec),this.Db.add(new Ng),this.Db.add(new Ie),
Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4825267_RemoveDisabledEvents")&&this.C2i());return this.Db}}});cg.uAb=null;cg.UDe=new Zf;Object($d.a)(cg,"MacroRecorderEventList",null,[]);var Mi=ij.a;vm(rg,Mi);rg.prototype.create=function(){this.Fb(this.$.da.Aa(297)||new Bj(this.$,new cg(this.$),new ua))};rg.ja=function(F){F.da.Ha(298,new rg(F))};Object($d.a)(rg,"MacroRecorderEventHandlerFactory",ij.a,[]);var xd=b(817),Te=b(78),Wg=b(35);af.prototype.Xc=function(){return!1};af.prototype.executeCommand=
function(F,fa,Qa){F=Wg.TaskExtensions.om();fa=fa.command;switch(fa){case 1845457202:case -1342227603:case -45542983:case 1904816141:case 1606046412:case 971811139:this.$.Ce(2045014907,-1,0,null),this.automateCommandManager.Rji(fa,1904816141===fa?Qa[Te.a.hd].toString():null)}return F};af.prototype.Gc=function(F,fa){F=!1;switch(fa.command){case 1845457202:case -45542983:case -1342227603:case 971811139:case 1904816141:case 1606046412:F=this.$.Xaa}return F};af.prototype.fd=function(F,fa,Qa){return"PopulateAutomateGalleryMenu"===
fa&&this.$.Xaa?(this.automateCommandManager.fd(fa,Qa),!0):!1};Object($d.a)(af,"AutomateCommandHandler",null,[237]);var Vj=b(457),Ck=xd.a;vm(dg,Ck);dg.prototype.Md=function(){var F=this;Vj.a(this.$,374,375,this.tb,function(){var fa=F.$.da.Aa(352);fa?F.Ed([new af(fa,F.$)]):Se.ULS.sendTraceTag(537170316,0,15,"AutomateCommandManager should already been initialized before AutomateCommandHandler.")})};dg.ja=function(F){F.da.Ha(308,new dg(F))};Object($d.a)(dg,"AutomateCommandHandlerFactory",xd.a,[]);Object($d.a)(og,
"AuthContext",null,[]);var yf=b(577),ai=b(125),li=b(107),Mh=b(26),Hj=b(947),fi=b(176);gg.prototype.getAuthContext=function(){return this.vnb};gg.prototype.S$b=function(){function F(Vc,qd){return(new Promise(function(Gd){window.setTimeout(function(){Gd(Vc)},qd)})).then(function(Gd){Ab.push(Object.assign(new Tf.a,{name:"Error"+Cc,string:Gd.ErrorMessage}));Ab.push(Object.assign(new Tf.a,{name:"ErrorCode"+Cc,string:Gd.ErrorCode}));Cc++;return fa.p7f()})}var fa=this,Qa=Mh.a.Ra.Kb,Ab=[];if(this.oAuthManager)Ab.push(Object.assign(new Tf.a,
{name:"IsAuthSupported",bool:this.hqe}));else return this.u7b(Ab,Qa,"need_OAuthManager","No OAuthManager");if(!this.Dv.Gx||!this.Dv.Gx.value)return this.u7b(Ab,Qa,"need_license","No License");if(kg.AFrameworkApplication.ga.ra("IsAnonymousUser"))return this.u7b(Ab,Qa,"need_user","Anonymous User");if(33E5>Date.now()-this.vnb.timeStamp)return Ab.push(Object.assign(new Tf.a,{name:"UsedCachedToken",bool:!0})),fi.a(ai.a.Dwd,!0,0,Ab),Promise.resolve(Object.assign(new Hj.a,{IsSuccess:!0,Token:this.vnb.token}));
Ab.push(Object.assign(new Tf.a,{name:"UsedCachedToken",bool:!1}));var Cc=1;return this.p7f().catch(function(Vc){return F(Vc,200)}).catch(function(Vc){return F(Vc,400)}).then(function(Vc){Vc.IsSuccess?(fa.vnb.token=Vc.Token,fa.vnb.timeStamp=Date.now()):(Ab.push(Object.assign(new Tf.a,{name:"Error"+Cc,string:Vc.ErrorMessage})),Ab.push(Object.assign(new Tf.a,{name:"ErrorCode"+Cc,string:Vc.ErrorCode})));Ab.push(Object.assign(new Tf.a,{name:"Attempts",int64:Cc}));Ab.push(Object.assign(new Tf.a,{name:"Error",
string:Vc.ErrorMessage}));Ab.push(Object.assign(new Tf.a,{name:"ErrorCode",string:Vc.ErrorCode}));fi.a(ai.a.Dwd,Vc.IsSuccess,li.getElapsedMilliseconds(Qa,Mh.a.Ra.Kb),Ab);return Promise.resolve(Vc)}).catch(function(Vc){Ab.push(Object.assign(new Tf.a,{name:"Error"+Cc,string:Vc.ErrorMessage}));Ab.push(Object.assign(new Tf.a,{name:"ErrorCode"+Cc,string:Vc.ErrorCode}));Ab.push(Object.assign(new Tf.a,{name:"Attempts",int64:Cc}));return fa.u7b(Ab,Qa,Vc.ErrorCode,Vc.ErrorMessage)})};gg.prototype.u7b=function(F,
fa,Qa,Ab){F.push(Object.assign(new Tf.a,{name:"Error",string:Ab}));F.push(Object.assign(new Tf.a,{name:"ErrorCode",string:Qa}));fi.a(ai.a.Dwd,!1,li.getElapsedMilliseconds(fa,Mh.a.Ra.Kb),F);return Promise.resolve(Object.assign(new Hj.a,{IsSuccess:!1,ErrorMessage:Ab,ErrorCode:Qa}))};gg.prototype.p7f=function(){var F=this,fa=yf.a.lTh(),Qa=0;fa=this.oAuthManager.YR("Maker",fa).then(function(Ab){if(Ab)return!Ab.IsSuccess&&F.Zpj(Ab)?Promise.reject(Ab):Promise.resolve(Ab);Ab=Object.assign(new Hj.a,{IsSuccess:!1,
ErrorMessage:"Missing result object",ErrorCode:"need_result"});return Promise.reject(Ab)}).catch(function(Ab){var Cc=new Hj.a;Object.getType(Ab)===Object.getType(Cc)?Cc=Ab:(Cc.ErrorMessage=Ab.toString(),Cc.ErrorCode="exception");return Promise.reject(Cc)});return Promise.race([fa,new Promise(function(Ab,Cc){Qa=window.setTimeout(function(){Cc(Object.assign(new Hj.a,{IsSuccess:!1,ErrorCode:"Timeout",ErrorMessage:"Timed out waiting auth token promise"}))},2E4)})]).then(function(Ab){window.clearTimeout(Qa);
return Ab})};gg.prototype.Zpj=function(F){return"interaction_required"===F.ErrorCode||"InitFailed"===F.ErrorCode||"invalid_resource"===F.ErrorCode||"login_required"===F.ErrorCode&&F.ErrorMessage.startsWith("AADSTS500341")?!1:!0};Object($d.a)(gg,"AutomateCommandAuth",null,[907]);var Dj=b(948);Object($d.a)(Df,"AutomateCommandGalleryBase",null,[]);var L=b(845),Ea=b(28),Pb=b(864),yc=b(1368),Wc=b(16),Ke=b(51),Fe=b(14),uf=b(823),Mf=b(999);$e.prototype.lBh=function(F){var fa=this.automateCommandManager.Sa.zp().JB(),
Qa=$e.XT(F,Fe.a.instance.ea(2072));this.JSc(Qa,yf.a.CLi,this.automateCommandManager.eg,yf.a.jxi,Fe.a.instance.ea(2068),this.automateCommandManager.Sa);Array.add(fa.MenuSectionList,Qa);Qa=$e.XT(F,Fe.a.instance.ea(2073));this.JSc(Qa,yf.a.lui,yf.a.iK?this.automateCommandManager.Lk.HQe(this.automateCommandManager.eg):this.automateCommandManager.Jm.HQe(this.automateCommandManager.eg),yf.a.qpf,Fe.a.instance.ea(2069),this.automateCommandManager.Sa);Array.add(fa.MenuSectionList,Qa);Qa=$e.XT(F,Fe.a.instance.ea(2074));
this.JSc(Qa,yf.a.Obj,this.automateCommandManager.ir,yf.a.qpf,"",this.automateCommandManager.Sa);Array.add(fa.MenuSectionList,Qa);Qa=Object.assign(new L.a,{Id:yf.a.Kme,ExternalId:yf.a.Kme,Command:"1606046412",LabelText:Fe.a.instance.ea(2065),Alt:Fe.a.instance.ea(2066),Image16by16:Ke.a.Be(16),Image16by16Class:Wc.a.ALe,Visible:!0});F=$e.XT(F,null);F.ControlsId="myScriptsSection.Controls";Array.add(F.ControlList,Qa);Array.add(fa.MenuSectionList,F);return fa};$e.prototype.JSc=function(F,fa,Qa,Ab,Cc,Vc){if(Qa&&
0<Qa.length){fa=Vc.iA(fa,1,"Size150by20").i_b();Cc={};Vc={};Vc.root=$e.Asa(320,30);Vc.flexContainer={display:"flex",height:"100%",flexWrap:"nowrap",justifyContent:"left",alignItems:"left",lineHeight:"normal"};Vc.label={margin:"0px 3px"};Cc.galleryButtonInExpanded=Vc;fa.GalleryStyle=Cc;for(Cc=0;Cc<Qa.length&&Cc<Ab;Cc++)Vc=Qa.IJ(Cc),Array.add(fa.GalleryItems,$e.O2b(Vc.id,Vc,!1));Array.add(F.ControlList,fa)}else Qa=Object.assign(new Mf.a,{Id:fa,ExternalId:fa,LabelText:Cc}),F.ControlsId=Qa.Id+".Controls",
Array.add(F.ControlList,Qa)};$e.dTe=function(F){if(F){var fa=String.format(yf.a.$5h,F.isShared?yf.a.M6f:yf.a.zSf,Ke.a.Be(16));F=String.format(yf.a.a6h,Ea.a.If(F.name));return String.format(yf.a.Z5h,fa,F)}return""};$e.XT=function(F,fa){return Object.assign(new Pb.a,{Id:F,Title:fa,MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,ShowMenuSectionTitleIcon:!0,ControlList:[]})};$e.O2b=function(F,fa,Qa){var Ab=Qa?yf.a.sEj:yf.a.rEj,Cc=Qa?yf.a.fdj:yf.a.edj,Vc=Qa?yf.a.M6f:yf.a.tEj,qd=Qa?yf.a.zSf:
yf.a.gdj;return fa?$e.cBe(fa.cD||fa.id,fa.name,Qa,fa.isShared?Ab:Cc,F,F,fa.isShared?Vc:qd):$e.cBe("","",Qa,"",F,F)};$e.cBe=function(F,fa,Qa,Ab,Cc,Vc,qd){Cc=void 0===Cc?null:Cc;Vc=void 0===Vc?null:Vc;qd=void 0===qd?null:qd;var Gd=void 0===Gd?null:Gd;var ve={},jf={};Qa?(ve.root=$e.Asa(32,32),jf.root=$e.Asa(32,32)):(ve.root=$e.Asa(20,20),jf.root=$e.Asa(20,20));return Object.assign(new yc.a,{Id:F,ExternalId:Cc||F,MenuItemId:Vc||F,Command:"1904816141",Icon:Ab,Image:Ke.a.Be(16),ImageClass:qd,LabelText:fa,
FullIconStyle:ve,PreviewIconStyle:jf,Alt:Gd||fa})};$e.Asa=function(F,fa){var Qa={};Qa.width=F;Qa["min-width"]=F;Qa.height=fa;return Qa};Object($d.a)($e,"AutomateCommandRenderer",null,[]);me.prototype.UJa=function(F){for(var fa=0;fa<this.scripts.length;fa++)if(this.scripts[fa].id===F||this.scripts[fa].cD===F)return fa;return-1};me.prototype.sort=function(){this.p1f(this.scripts)};me.prototype.Rn=function(F){return-1===this.UJa(F.id)?(this.scripts.push(F),!0):!1};me.prototype.uXa=function(F){return-1===
this.UJa(F.id)?(this.scripts=[F].concat(this.scripts),!0):!1};me.prototype.inf=function(F){F=this.UJa(F.id);if(-1!==F){for(var fa=this.scripts[F].lha();0<F;)this.scripts[F]=this.scripts[F-1],F--;this.scripts[0]=fa}};me.prototype.Xda=function(F){var fa=this.UJa(F.id);if(-1!==fa){var Qa=this.scripts[fa].cD;this.scripts[fa]=F;this.scripts[fa].cD=Qa}};me.prototype.ufc=function(F){var fa=this.UJa(F.id);return-1!==fa?F.name===this.scripts[fa].name:!1};me.prototype.Qha=function(F){F=this.UJa(F);return-1!==
F?(this.scripts.splice(F,1),!0):!1};me.prototype.clear=function(){this.scripts=[]};me.prototype.getScripts=function(){return this.scripts};me.prototype.Ty=function(F){F=this.UJa(F);return-1!==F?this.scripts[F]:null};me.prototype.IJ=function(F){return 0<=F&&this.length>F?this.scripts[F]:null};me.prototype.HQe=function(F){for(var fa=new me([],this.p1f),Qa=0;Qa<this.scripts.length;Qa++){var Ab=this.scripts[Qa];F.Ty(Ab.id)||fa.Rn(Ab)}return fa};me.prototype.ddb=function(){for(var F=[],fa=yl(this.scripts),
Qa=fa.next();!Qa.done;Qa=fa.next())F.push(Qa.value.gTd());return F};tl.Object.defineProperties(me.prototype,{length:{configurable:!0,enumerable:!0,get:function(){return this.scripts.length}}});Object($d.a)(me,"ScriptCollection",null,[]);var Gg=b(181);Fd.prototype.lha=function(){return new Fd(this.j$)};Fd.prototype.gTd=function(){return this.j$};tl.Object.defineProperties(Fd.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this.j$.id}},cD:{configurable:!0,enumerable:!0,get:function(){return this.j$.shareId},
set:function(F){this.j$.shareId=F||null}},name:{configurable:!0,enumerable:!0,get:function(){return this.j$.name}},mDe:{configurable:!0,enumerable:!0,get:function(){return this.j$.dateLastPublished}},body:{configurable:!0,enumerable:!0,get:function(){return this.j$.body}},description:{configurable:!0,enumerable:!0,get:function(){return this.j$.description}},s$e:{configurable:!0,enumerable:!0,get:function(){return this.j$.isCreator}},isShared:{configurable:!0,enumerable:!0,get:function(){return!!this.cD&&
0<this.cD.length}}});Object($d.a)(Fd,"ScriptCore",null,[]);var wh=b(57),Pf=b(41);vm(ud,Df);ud.prototype.yac=function(F){switch(F){case "1":case "2":case "3":return this.Ux.IJ(parseInt(F)-1);default:return this.Je.Lk.Ty(F)||this.Je.Jm.Ty(F)||this.Je.eg.Ty(F)||this.Je.ir.Ty(F)}};ud.prototype.z$b=function(F,fa,Qa){var Ab=null;if(this.Je.oKa)switch(F){case "1":case "2":case "3":Ab=this.Ux.IJ(parseInt(F)-1);break;default:Ab=this.Ux.Ty(F)}Pf.a.isReactRibbonEnabled()?(Qa=Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4456527_UseRibbonModeConditionForAutomateGallery")?
2===Qa:!wh.a.Qf.uC,fa[Dj.a.GalleryButtonProps]=$e.O2b(F,Ab,Qa)):fa[Dj.a.InnerHTML]=$e.dTe(Ab);fa[Dj.a.Alt]=Ab?Ab.name:""};ud.prototype.WA=function(F){this.Ux=this.mFb();this.$.Gf();var fa=[];fa.push(Object.assign(new Tf.a,{name:"Operation",string:F}));fa.push(Object.assign(new Tf.a,{name:"HasReadRecentCachedScripts",bool:this.Je.iva}));fa.push(Object.assign(new Tf.a,{name:"ReadScriptsDone",bool:this.Je.qKa}));fa.push(Object.assign(new Tf.a,{name:"ReadSamplesScriptsDone",bool:this.Je.r6}));fa.push(Object.assign(new Tf.a,
{name:"SamplesScriptCount",int64:this.Je.ir.length}));fa.push(Object.assign(new Tf.a,{name:"ReadRecentScriptsDone",bool:this.Je.uca}));fa.push(Object.assign(new Tf.a,{name:"RecentScriptCount",int64:this.Je.Lk.length}));fa.push(Object.assign(new Tf.a,{name:"ReadWorkbookScriptsDone",bool:this.Je.Ss}));fa.push(Object.assign(new Tf.a,{name:"WorkbookScriptCount",int64:this.Je.eg.length}));fi.a(ai.a.Cwd,!0,0,fa)};ud.prototype.Abc=function(F){var fa=!1,Qa="",Ab=new Fd(F.scriptMetadata),Cc={Operation:"HandleRefreshRibbonGallery"};
Cc.RefreshOperation=F.operationName;switch(F.operationName){case yf.a.aFd:F=this.ivb(Ab);Qa=F.message;fa=F.returnValue;break;case yf.a.ZEd:F=this.gvb(Ab);Qa=F.message;fa=F.returnValue;break;case yf.a.YEd:F=this.fvb(Ab);Qa=F.message;fa=F.returnValue;break;case yf.a.$Ed:F=this.hvb(Ab);Qa=F.message;fa=F.returnValue;break;case yf.a.UJf:F=this.Ggd(Ab),Qa=F.message,fa=F.returnValue}(Cc.GalleryUpdated=fa)?(Se.ULS.sendTraceTag(537170322,0,50,"AutomateCommandGallery: Calling UpdateToolbarsAndRibbons. Message: {0}",
Qa),this.WA("RefreshGallery")):Se.ULS.sendTraceTag(537170321,0,15,"AutomateCommandGallery: Something went wrong while trying to refresh ribbon gallery.  Message: {0}",Qa);Cc.Message=Qa;Se.ULS.sendTraceTag(537170320,0,50,Gh.c(Cc))};ud.prototype.mFb=function(){for(var F=new me([],function(){}),fa=this.Je.eg?this.Je.eg.length:0,Qa=this.Je.Lk?this.Je.Lk.length:0,Ab=this.Je.ir?this.Je.ir.length:0,Cc=0,Vc=0;Vc<yf.a.kCd;Vc++)if(Vc<fa)F.Rn(this.Je.eg.IJ(Vc));else if(Vc-fa+Cc<Qa){var qd=this.Je.Lk.IJ(Vc-fa+
Cc);this.Je.eg.Ty(qd.id)?(Cc++,Vc--):F.Rn(qd)}else Vc-fa-Qa+Cc<Ab&&F.Rn(this.Je.ir.IJ(Vc-fa+Cc-Qa));return F};ud.prototype.ivb=function(F){if(this.Je.Lk.uXa(F))var fa="";else{fa="";var Qa=F.lha();this.Je.eg.Xda(Qa);this.Je.eg.sort();this.Je.Lk.Xda(F)}return{returnValue:!0,message:fa}};ud.prototype.gvb=function(F){this.Je.eg.Qha(F.id);return this.Je.Lk.Qha(F.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in recent script collection."}};ud.prototype.fvb=
function(F){var fa=F.lha();fa.cD=null;this.Je.Lk.uXa(fa);return this.Je.eg.Rn(F)?(this.Je.eg.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}};ud.prototype.hvb=function(F){return this.Je.eg.Qha(F.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}};ud.prototype.Ggd=function(F){var fa=F.lha(),Qa=!1;this.Je.eg.ufc(fa)&&(this.Je.eg.Xda(fa),this.Je.eg.sort(),
Qa=!0);this.Je.Lk.uXa(F)?Qa=!0:this.Je.Lk.ufc(F)&&(this.Je.Lk.Xda(F),this.Je.Lk.inf(F),Qa=!0);return{returnValue:Qa,message:""}};Object($d.a)(ud,"AutomateCommandGallery",Df,[]);var hh=b(86);Object($d.a)(Zc,"AutomateCommandLicensingBase",null,[]);Object($d.a)(jc,"BoolResultWrapper",null,[]);vm(we,Zc);we.prototype.Ave=function(){var F=this,fa=Mh.a.Ra.Kb,Qa=[];return new Promise(function(Ab){hh.a.instance.mc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Cc){Cc.isFeatureEnabled("ExcelOfficeScripting",
!1).then(function(Vc){Qa.push(Object.assign(new Tf.a,{name:"IsLicensed",bool:Vc}));fi.a(ai.a.Upf,!0,li.getElapsedMilliseconds(fa,Mh.a.Ra.Kb),Qa);F.Gx=new jc(Vc,!0);Ab(Vc)}).catch(function(Vc){Qa.push(Object.assign(new Tf.a,{name:"IsLicensed",bool:!1}));Qa.push(Object.assign(new Tf.a,{name:"Error",string:Vc.toString()}));Qa.push(Object.assign(new Tf.a,{name:"ErrorCode",string:"exception"}));fi.a(ai.a.Upf,!1,li.getElapsedMilliseconds(fa,Mh.a.Ra.Kb),Qa);F.Gx=new jc(!1,!1,void 0,"exception",Vc.toString());
Ab(!1)})})})};Object($d.a)(we,"AutomateCommandLicensing",Zc,[]);var zi=b(1288),vi=b(1286),Ai=b(1285),kj=b(1287);le.taskPaneWidth="TaskPaneWidth";le.sourceLocationOverrideResourceId="SourceLocationOverrideResourceId";le.al="TaskPaneTitle";le.Vj="IconCssClass";le.pSd="TaskPaneIconUrl";le.QR="TaskPaneIconId";le.DH="NonPersistedSettings";le.onTaskPaneClose="OnTaskPaneClose";le.sRc="ActionArgs";Object($d.a)(le,"PropertyNames",null,[]);var mj=b(139),bj=b(179),fj=b(304),Ni=b(4);vm($c,Df);$c.prototype.yac=
function(F){switch(F){case "1":case "2":case "3":return this.Ux.IJ(parseInt(F)-1);default:return this.automateCommandManager.Lk.Ty(F)||this.automateCommandManager.eg.Ty(F)||this.automateCommandManager.ir.Ty(F)}};$c.prototype.z$b=function(F,fa,Qa){var Ab=null;if(this.automateCommandManager.oKa)switch(F){case "1":case "2":case "3":Ab=this.Ux.IJ(parseInt(F)-1);break;default:Ab=this.Ux.Ty(F)}Pf.a.isReactRibbonEnabled()?(Qa=Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4456527_UseRibbonModeConditionForAutomateGallery")?
2===Qa:!wh.a.Qf.uC,fa[Dj.a.GalleryButtonProps]=$e.O2b(F,Ab,Qa)):fa[Dj.a.InnerHTML]=$e.dTe(Ab);fa[Dj.a.Alt]=Ab?Ab.name:""};$c.prototype.WA=function(F){this.Ux=this.mFb();this.$.Gf();var fa=[];fa.push(Object.assign(new Tf.a,{name:"Operation",string:F}));fa.push(Object.assign(new Tf.a,{name:"HasReadRecentCachedScripts",bool:this.automateCommandManager.iva}));fa.push(Object.assign(new Tf.a,{name:"ReadScriptsDone",bool:this.automateCommandManager.qKa}));fa.push(Object.assign(new Tf.a,{name:"ReadSamplesScriptsDone",
bool:this.automateCommandManager.r6}));fa.push(Object.assign(new Tf.a,{name:"SamplesScriptCount",int64:this.automateCommandManager.ir.length}));fa.push(Object.assign(new Tf.a,{name:"ReadRecentScriptsDone",bool:this.automateCommandManager.uca}));fa.push(Object.assign(new Tf.a,{name:"RecentScriptCount",int64:this.automateCommandManager.Lk.length}));fa.push(Object.assign(new Tf.a,{name:"ReadWorkbookScriptsDone",bool:this.automateCommandManager.Ss}));fa.push(Object.assign(new Tf.a,{name:"WorkbookScriptCount",
int64:this.automateCommandManager.eg.length}));fi.a(ai.a.Cwd,!0,0,fa)};$c.prototype.Abc=function(F){var fa=!1,Qa="",Ab=new Fd(F.scriptMetadata),Cc={Operation:"HandleRefreshRibbonGallery"};Cc.RefreshOperation=F.operationName;switch(F.operationName){case yf.a.aFd:F=this.ivb(Ab);Qa=F.message;fa=F.returnValue;break;case yf.a.ZEd:F=this.gvb(Ab);Qa=F.message;fa=F.returnValue;break;case yf.a.YEd:F=this.fvb(Ab);Qa=F.message;fa=F.returnValue;break;case yf.a.$Ed:F=this.hvb(Ab);Qa=F.message;fa=F.returnValue;
break;case yf.a.UJf:F=this.Ggd(Ab),Qa=F.message,fa=F.returnValue}(Cc.GalleryUpdated=fa)?(Se.ULS.sendTraceTag(537170319,0,50,"AutomateCommandManager: Calling UpdateToolbarsAndRibbons. Message: {0}",Qa),this.WA("RefreshGallery")):Se.ULS.sendTraceTag(537170318,0,15,"AutomateCommandManager: Something went wrong while trying to refresh ribbon gallery.  Message: {0}",Qa);Cc.Message=Qa;Se.ULS.sendTraceTag(537170317,0,50,Gh.c(Cc))};$c.prototype.mFb=function(){for(var F=new me([],function(){}),fa=this.automateCommandManager.eg?
this.automateCommandManager.eg.length:0,Qa=this.automateCommandManager.Lk?this.automateCommandManager.Lk.length:0,Ab=this.automateCommandManager.ir?this.automateCommandManager.ir.length:0,Cc=0,Vc=0;Vc<yf.a.kCd;Vc++)if(Vc<fa)F.Rn(this.automateCommandManager.eg.IJ(Vc));else if(Vc-fa+Cc<Qa){var qd=this.automateCommandManager.Lk.IJ(Vc-fa+Cc);this.automateCommandManager.eg.Ty(qd.id)?(Cc++,Vc--):F.Rn(qd)}else Vc-fa-Qa+Cc<Ab&&F.Rn(this.automateCommandManager.ir.IJ(Vc-fa+Cc-Qa));return F};$c.prototype.ivb=
function(F){if(this.automateCommandManager.Lk.uXa(F))var fa="";else{fa="";var Qa=F.lha();this.automateCommandManager.eg.Xda(Qa);this.automateCommandManager.eg.sort();this.automateCommandManager.Lk.Xda(F)}return{returnValue:!0,message:fa}};$c.prototype.gvb=function(F){this.automateCommandManager.eg.Qha(F.id);return this.automateCommandManager.Lk.Qha(F.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in recent script collection."}};$c.prototype.fvb=
function(F){var fa=F.lha();fa.cD=null;this.automateCommandManager.Lk.uXa(fa);return this.automateCommandManager.eg.Rn(F)?(this.automateCommandManager.eg.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}};$c.prototype.hvb=function(F){return this.automateCommandManager.eg.Qha(F.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}};$c.prototype.Ggd=function(F){var fa=
F.lha(),Qa=!1;this.automateCommandManager.eg.ufc(fa)&&(this.automateCommandManager.eg.Xda(fa),this.automateCommandManager.eg.sort(),Qa=!0);this.automateCommandManager.Lk.uXa(F)?Qa=!0:this.automateCommandManager.Lk.ufc(F)&&(this.automateCommandManager.Lk.Xda(F),this.automateCommandManager.Lk.inf(F),Qa=!0);return{returnValue:Qa,message:""}};Object($d.a)($c,"AutomateCommandGalleryOld",Df,[]);var Rj=b(19);Sc.q1f=function(F){F.sort(function(fa,Qa){return Qa.mDe-fa.mDe})};Sc.jKb=function(F){F.sort(function(fa,
Qa){return Rj.a.compare(fa.name,Qa.name,!0)})};Sc.$_e=function(F){var fa;var Qa=fa=null;if(F){var Ab=F.indexOf(":");if(-1!==Ab)return fa=F.substr(0,Ab),Qa=F.substr(Ab+1),{returnValue:!0,hRd:fa,cD:Qa}}return{returnValue:!1,hRd:fa,cD:Qa}};Sc.fRh=function(F,fa){var Qa={};Qa[yf.a.Hcg]=encodeURIComponent(F.workbookContext.WorkbookFileName);Qa[yf.a.CSf]=fa.ddb();return Gh.c(Qa)};Sc.MIf=function(F,fa){return Wg.TaskExtensions.zha(fa.CJa(yf.a.Ceb),function(Qa){Qa=Qa.result;if(""!==Qa){Qa=Gh.b(Qa);var Ab=
Qa[yf.a.CSf];if(Qa[yf.a.Hcg]===encodeURIComponent(F.workbookContext.WorkbookFileName)){Qa=new me([],function(Vc){Sc.jKb(Vc)});Ab=yl(Ab);for(var Cc=Ab.next();!Cc.done;Cc=Ab.next())Qa.Rn(new Fd(Cc.value));Qa.sort();return Qa}}},F.ma,3)};tl.Object.defineProperties(Sc.prototype,{oKa:{configurable:!0,enumerable:!0,get:function(){var F=yf.a.iK?this.iva:this.p4;return this.r6||F||this.qKa}},qKa:{configurable:!0,enumerable:!0,get:function(){return(yf.a.iK?this.uca:this.q6)&&this.Ss&&this.r6}}});Object($d.a)(Sc,
"AutomateCommandStorageBase",null,[]);Object($d.a)(Oc,"UserInfo",null,[]);var Aj=b(519),rk=b(163),Oi=b(81),oi=b(273);Object($d.a)(gc,"LaunchSDXParams",null,[]);Object($d.a)(ne,"RunfromButtonParameters",null,[]);var Qk=b(164),fk=b(126),Zk=b(27),uk=b(913),Ij=b(48),Dk=b(101),Ek=b(46),vk=b(168);De.prototype.Mmj=function(F){yf.a.xq?this.Je.Jm=F:this.Cbe=F};De.prototype.Lmj=function(F){yf.a.xq?this.Je.eg=F:this.$$d=F};De.prototype.Pmj=function(F){yf.a.xq?this.Je.ir=F:this.cde=F};De.prototype.Nmj=function(F){this.Je.Lk=
F};De.prototype.xJb=function(F){var fa=kg.AFrameworkApplication.ga.ra("IsO365CommercialHost"),Qa="",Ab="",Cc=!1;var Vc=!(this.Dv.Gx&&this.Dv.Gx.isSuccess&&this.Dv.Gx.value&&(!this.Zz||!this.Zz.isSuccess));this.Dv.Gx&&!this.Dv.Gx.isSuccess?(Ab=this.Dv.Gx.errorCode,Qa=this.Dv.Gx.errorMessage):this.Zz&&!this.Zz.isSuccess&&(Ab=this.Zz.errorCode,Qa=this.Zz.errorMessage);var qd=[];qd.push(Object.assign(new Tf.a,{name:"IsScriptingEnabled",bool:this.aba}));qd.push(Object.assign(new Tf.a,{name:"IsValidHost",
bool:fa}));qd.push(Object.assign(new Tf.a,{name:"IsUserLicensed",bool:this.Dv.Gx?this.Dv.Gx.value:!1}));qd.push(Object.assign(new Tf.a,{name:"IsAdminSwitchOn",bool:this.Zz?this.Zz.value:!1}));qd.push(Object.assign(new Tf.a,{name:"ShowTab",bool:this.aba}));qd.push(Object.assign(new Tf.a,{name:"ServiceChecked",bool:!F}));this.aba&&Pf.a.mwa(this.$)&&(F=Qk.a(this.$),(null===F||void 0===F?0:F.Lm)?(qd.push(Object.assign(new Tf.a,{name:"RibbonType",string:"React"})),F.Lm.Mtj(Ni.a.hFb),fa=["AutomateRecorder",
"AutomateNewScript","AutomateGallery","AutomateAllScripts"],Ag.EwaSettings.getBooleanFeatureGate(yf.a.yof,!1)?F.Lm.HIb(["AutomateAutomateTask"],!yf.a.Xpf):(F.Lm.HIb(fa,!1),yf.a.Xpf&&F.Lm.HIb(["AutomateAutomateTask"],!1)),Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&!Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&(Cc=!0)):(Ab="ribbon_manager_error",Qa="The RibbonManager or RibbonUser is null"));qd.push(Object.assign(new Tf.a,
{name:"Error",string:Qa}));qd.push(Object.assign(new Tf.a,{name:"ErrorCode",string:Ab}));fi.a(ai.a.ayi,Vc,li.getElapsedMilliseconds(this.initTime,Mh.a.Ra.Kb),qd);return Promise.resolve(Cc)};De.prototype.fd=function(F,fa){if(!fa)return!1;fa.MenuItems=this.KIg.lBh(fa.MenuId);return!0};De.prototype.ARi=function(){var F=this;if(this.$va)if(yf.a.iK)this.Je.JIf(this.fP).continueWith(function(Ab){Ab.result&&F.fP.WA(yf.a.kPa)});else if(yf.a.xq)this.Je.kZi(this.fP);else{var fa=Mh.a.Ra.Kb,Qa=[];Wg.TaskExtensions.Ba(this.indexedDB.CJa(yf.a.VOa),
function(Ab){var Cc=!F.q6||!F.Jm.length;Ab=Ab.result;Qa.push(Object.assign(new Tf.a,{name:"ExistingScriptCount",int64:F.Jm.length}));if(""!==Ab)if(Ab=Gh.b(Ab),Qa.push(Object.assign(new Tf.a,{name:"CachedScriptCount",int64:Ab.length})),Cc){for(var Vc=yl(Ab),qd=Vc.next();!qd.done;qd=Vc.next())F.Jm.Rn(new Fd(qd.value));F.Jm.sort();F.p4=!0;F.r$a=0<Ab.length;fi.a(ai.a.GBb,Cc,li.getElapsedMilliseconds(fa,Mh.a.Ra.Kb),Qa);F.WA("CachedScripts")}else fi.a(ai.a.GBb,Cc,li.getElapsedMilliseconds(fa,Mh.a.Ra.Kb),
Qa);else fi.a(ai.a.GBb,Cc,li.getElapsedMilliseconds(fa,Mh.a.Ra.Kb),Qa)},this.$.ma,3)}mc(this.$)?this.k_e(Object.assign(new Hj.a,{IsSuccess:!0,Token:"FakeToken"})):this.Bra.S$b().then(function(Ab){F.k_e(Ab)})};De.prototype.z$b=function(F,fa,Qa){if(yf.a.iK)this.fP.z$b(F,fa,Qa);else{var Ab=null;if(this.oKa)switch(F){case "1":case "2":case "3":Ab=this.Ux.IJ(parseInt(F)-1);break;default:Ab=this.Ux.Ty(F)}fa[Dj.a.GalleryButtonProps]=$e.O2b(F,Ab,this.Ngi?2===Qa:!wh.a.Qf.uC);fa[Dj.a.Alt]=Ab?Ab.name:""}};De.prototype.Abc=
function(F){if(yf.a.iK)this.fP.Abc(F);else{var fa=!1,Qa="",Ab=new Fd(F.scriptMetadata),Cc={Operation:"HandleRefreshRibbonGallery"};Cc.RefreshOperation=F.operationName;switch(F.operationName){case yf.a.aFd:F=this.ivb(Ab);Qa=F.message;fa=F.returnValue;break;case yf.a.ZEd:F=this.gvb(Ab);Qa=F.message;fa=F.returnValue;break;case yf.a.YEd:F=this.fvb(Ab);Qa=F.message;fa=F.returnValue;break;case yf.a.$Ed:F=this.hvb(Ab),Qa=F.message,fa=F.returnValue}(Cc.GalleryUpdated=fa)?(Se.ULS.sendTraceTag(537170313,0,
50,"AutomateCommandManager: Calling UpdateToolbarsAndRibbons. Message: {0}",Qa),this.WA("RefreshGallery")):Se.ULS.sendTraceTag(537170312,0,15,"AutomateCommandManager: Something went wrong while trying to refresh ribbon gallery.  Message: {0}",Qa);Cc.Message=Qa;Se.ULS.sendTraceTag(537170311,0,50,Gh.c(Cc))}};De.prototype.HYh=function(F,fa,Qa){this.$.xs(null,!1,1023)&&(F=new ne(yf.a.Abj,F,fa,Qa,this.aba),this.Anb.jvb(F),Ag.EwaSettings.getBooleanFeatureGate(yf.a.z4f,!1)&&this.yJb(fa,Qa.toString()))};
De.prototype.A3e=function(F,fa,Qa){F=new ne(yf.a.lOj,F,fa,Qa,this.aba);this.Anb.jvb(F)};De.prototype.yWh=function(F){this.Anb.kgd(yf.a.Ztj,F)};De.prototype.xWh=function(F){this.Anb.kgd(yf.a.fYg,F)};De.prototype.zWh=function(F){this.Anb.kgd(yf.a.fyj,F)};De.prototype.Rji=function(F,fa){var Qa=Ij.b().pi(F),Ab=[];Ab.push(Object.assign(new Tf.a,{name:"SessionId",string:this.$.ya.UserSessionId}));Ab.push(Object.assign(new Tf.a,{name:"MenuItemId",string:fa}));Ab.push(Object.assign(new Tf.a,{name:"WorkbookScriptCount",
int64:this.eg.length}));Ab.push(Object.assign(new Tf.a,{name:"PublishedScriptCount",int64:this.Jm.length}));Ab.push(Object.assign(new Tf.a,{name:"RecentScriptCount",int64:this.Lk.length}));Ab.push(Object.assign(new Tf.a,{name:"Command",string:Qa}));fa=fa?this.yac(fa):null;if(Qa=this.zLh(F,Qa,fa))Ab.push(Object.assign(new Tf.a,{name:yf.a.T9,string:Qa.iya.Sq[yf.a.T9]})),zi.a.instance.CMa(Qa.zsh,"Taskpane",Qa.GGa,Qa.bid,Qa.iya),1904816141===F&&(Ab.push(Object.assign(new Tf.a,{name:"ScriptId",string:fa.id})),
Ab.push(Object.assign(new Tf.a,{name:"ShareId",string:fa.cD})),Ab.push(Object.assign(new Tf.a,{name:"IsPreviewGallery",bool:yf.a.iK?!!this.fP.Ux.Ty(fa.id):!!this.Ux.Ty(fa.id)})),Ab.push(Object.assign(new Tf.a,{name:"IsOwner",bool:fa.s$e||!!this.Jm.Ty(fa.id)})),this.$.Gf());fi.a(ai.a.Yxi,void 0,void 0,Ab)};De.prototype.zLh=function(F,fa,Qa){var Ab=null,Cc=yf.a.nr,Vc=new vi.a(yf.a.$5e,yf.a.ZRe,yf.a.locale),qd=new Ai.a(yf.a.assetId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,yf.a.Qsc),Gd=new kj.a;Gd.Sq.AdminPolicyForFeedback=
Gh.c(this.pFa);Gd.Sq.DocumentHostInfo=$h.a.Hc(this.$.ya.DocumentHostInfo);Gd.Sq.CodeEditorUrl=yf.a.Otb(this.$);Gd.Sq.MakerTestService=Ag.EwaSettings.getBooleanFeatureGate(yf.a.xAb,!1);Gd.Sq[yf.a.tQf]=yf.a.j2a(this.$);Gd.Sq.StorageModePreference=this.G2f||"";Gd.Sq.Source="Ribbon";Gd.Sq.IsTeams=zh.a.qka;Gd.Sq[yf.a.y4f]=$h.a.Hc(Cc);Gd.Sq[yf.a.$qe]=this.$.Tpf?"true":"false";Gd.Sq[yf.a.T9]=bj.a.create().toString();var ve=vd(this.$),jf=fd(this.$);Gd.ni.HeaderCssClass=ve;Gd.ni.TitleCssClass=jf;Gd.Sq[yf.a.Y4e]=
ve;Gd.Sq[yf.a.F5f]=jf;ve={};ve.ribbonCommand=fa;ve[yf.a.F2f]=this.Bra.getAuthContext();ve[yf.a.VOa]=this.r$a?this.Jm.ddb():null;ve[yf.a.Ceb]=this.Qya?this.eg.ddb():null;yf.a.iK&&(ve[yf.a.kPa]=this.Je.nEd?this.Lk.ddb():null);Gd.Sq[yf.a.$8e]=$h.a.Hc(ve);fa={};cb(this.$,fa);Gd.Sq[yf.a.jRe]=$h.a.Hc(fa);switch(F){case -45542983:Gd.Sq.Script="";Gd.Sq.Destination="Editor";Gd.Sq.IsOwner=!0;Gd.ni[le.al]=Fe.a.instance.ea(2061);Gd.ni[le.taskPaneWidth]=Cc;Gd.ni[le.sourceLocationOverrideResourceId]=yf.a.Otb(this.$);
Ab=yf.a.u_c;break;case -1342227603:Gd.ni[le.al]=Fe.a.instance.ea(2063);Gd.ni[le.taskPaneWidth]=Cc;Gd.ni[le.sourceLocationOverrideResourceId]=yf.a.zOh(this.$);break;case 971811139:case 1606046412:Gd.Sq.Script="";Gd.Sq.Destination="BackStage";Gd.Sq.IsOwner=!0;Gd.ni[le.al]=Fe.a.instance.ea(2061);Gd.ni[le.taskPaneWidth]=Cc;Gd.ni[le.sourceLocationOverrideResourceId]=yf.a.Otb(this.$);Ab=yf.a.u_c;break;case 1845457202:Gd.ni[le.al]=Fe.a.instance.ea(2062);Gd.ni[le.taskPaneWidth]=Cc;Gd.ni[le.sourceLocationOverrideResourceId]=
yf.a.OZe(this.$);Ab=yf.a.ldj;break;case 1904816141:if(Qa)Gd.Sq.Script=$h.a.Hc(Qa.gTd()),Gd.Sq.Destination="Details",Gd.Sq.IsOwner=Qa.s$e||!!this.Jm.Ty(Qa.id),Gd.ni[le.al]=Fe.a.instance.ea(2061),Gd.ni[le.taskPaneWidth]=Cc,Gd.ni[le.sourceLocationOverrideResourceId]=yf.a.Otb(this.$),Ab=yf.a.u_c;else return null;break;default:return null}return new gc(Vc,qd,Gd,Ab)};De.prototype.xCh=function(){var F=this;hh.a.instance.mc("Common.App.ApplicationFeatureHelper.ICloudPolicySettingsHelper").execute(function(fa){F.pFa.FeedbackEnabled=
!0;F.pFa.ScreenshotEnabled=!0;F.pFa.EmailEnabled=!0;fa.AJ("Enabled").then(function(Qa){F.pFa.FeedbackEnabled=Qa},function(){});fa.AJ("IncludeScreenshot").then(function(Qa){F.pFa.ScreenshotEnabled=Qa},function(){});fa.AJ("IncludeEmail").then(function(Qa){F.pFa.EmailEnabled=Qa},function(){})})};De.prototype.mZh=function(F){var fa=this,Qa=Mh.a.Ra.Kb,Ab=[];if(!F||!F.IsSuccess){var Cc=F?F.ErrorCode:"need_token";F=F?F.ErrorMessage:"No Access Token";Ab.push(Object.assign(new Tf.a,{name:"ServiceChecked",
bool:!1}));Ab.push(Object.assign(new Tf.a,{name:"Error",string:F}));Ab.push(Object.assign(new Tf.a,{name:"ErrorCode",string:Cc}));fi.a(ai.a.Awd,!1,li.getElapsedMilliseconds(Qa,Mh.a.Ra.Kb),Ab);this.Zz=new jc(!1,!1,void 0,Cc,F);return Promise.resolve(!1)}Ab.push(Object.assign(new Tf.a,{name:"ServiceChecked",bool:!0}));Ae(this.$,F.Token);return makerstorage.getUserPermissions(this.$.ya.UserSessionId).then(function(Vc){fa.Zz=new jc(Vc.OfficeScriptingEnabled,!0);fa.tXc(yf.a.A9b(fa.$),Vc.OfficeScriptingEnabled);
Ab.push(Object.assign(new Tf.a,{name:"IsEnabled",bool:fa.Zz.value}));fi.a(ai.a.Awd,!0,li.getElapsedMilliseconds(Qa,Mh.a.Ra.Kb),Ab);return Promise.resolve(fa.Zz.value)}).catch(function(Vc){Object.getType(Vc)===makerstorage.StorageServiceError?(Ab.push(Object.assign(new Tf.a,{name:"Error",string:Vc.message})),Ab.push(Object.assign(new Tf.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",Vc.errorCode.toString(),Vc.status.toString())}))):(Ab.push(Object.assign(new Tf.a,{name:"Error",string:Vc.toString()})),
Ab.push(Object.assign(new Tf.a,{name:"ErrorCode",string:"exception"})));fi.a(ai.a.Awd,!1,li.getElapsedMilliseconds(Qa,Mh.a.Ra.Kb),Ab);fa.Zz=new jc(!1,!1,void 0,"exception",Vc.toString());return Promise.resolve(!1)})};De.prototype.oEd=function(F){var fa=this;if(yf.a.xq)return this.Je.oEd(F,this.fP);var Qa=new mj.a,Ab=se(this.$);return Jc(this.$,function(Cc){if((Cc=Cc.Result)&&200===Cc.ResponseStatusCode)Cc=JSON.parse(Cc.ResponseBody.join("")),F(fa.CAd(Cc.value)),Qa.setResult(!0);else{Cc=Cc?"RichApi_"+
Cc.ResponseStatusCode:"RichApiError";var Vc=[];Vc.push(Object.assign(new Tf.a,{name:"Error",string:"Failed to read shared script ids from document"}));Vc.push(Object.assign(new Tf.a,{name:"ErrorCode",string:Cc}));fa.Ss=!0;fa.NT(Mh.a.Ra.Kb,0,Vc);Qa.setResult(!1)}},function(Cc){Cc=fk.a.yg(Cc.data);Se.ULS.sendTraceTag(537170310,0,15,"REST API failed to fetch the CustomXmlPart for Automate Gallery. {0}",Zk.a.Uc(Cc));var Vc=[];Vc.push(Object.assign(new Tf.a,{name:"Error",string:"Failure using rich api: "+
Cc}));Vc.push(Object.assign(new Tf.a,{name:"ErrorCode",string:"RichApiFailure"}));fa.Ss=!0;fa.NT(Mh.a.Ra.Kb,0,Vc);Qa.setResult(!1)},Ab,Qa)};De.prototype.k_e=function(F){var fa=this;this.yed();yf.a.iK?this.Je.GPh(F,this.fP,this.cache):this.ePh(F);this.oEd(function(Qa){fa.Led(Qa,F)})};De.prototype.yed=function(){if(yf.a.xq)this.Je.yed(this.fP);else{var F={id:"samples-2"};F.name=Fe.a.instance.ea(2075);this.ir.Rn(new Fd(F));F.id="samples-4";F.name=Fe.a.instance.ea(2076);this.ir.Rn(new Fd(F));F.id="samples-5";
F.name=Fe.a.instance.ea(2077);this.ir.Rn(new Fd(F));this.r6=!0;this.WA("SampleScripts")}};De.prototype.ePh=function(F){var fa=this,Qa=Mh.a.Ra.Kb,Ab=[];if(F&&F.IsSuccess){Ae(this.$,F.Token);var Cc=sj.a.create().toString();Ab.push(Object.assign(new Tf.a,{name:"CorrelationId",string:Cc}));makerstorage.getScripts(Cc).then(function(Vc){Ab.push(Object.assign(new Tf.a,{name:"HasReadCachedScripts",bool:fa.p4}));fa.Jm.clear();Vc=yl(Vc);for(var qd=Vc.next();!qd.done;qd=Vc.next())fa.Jm.Rn(new Fd(qd.value));
fa.Jm.sort();fa.r$a=!0;fa.q6=!0;fa.$va&&(Vc=$h.a.Hc(fa.Jm.ddb()),fa.indexedDB.Rab(new uk.a(yf.a.VOa,Vc)));Ab.push(Object.assign(new Tf.a,{name:"ScriptCount",int64:fa.Jm.length}));fi.a(ai.a.HBb,!0,li.getElapsedMilliseconds(Qa,Mh.a.Ra.Kb),Ab);fa.WA(yf.a.VOa)}).catch(function(Vc){Object.getType(Vc)===makerstorage.StorageServiceError?(Ab.push(Object.assign(new Tf.a,{name:"Error",string:Vc.message})),Ab.push(Object.assign(new Tf.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",Vc.errorCode.toString(),
Vc.status.toString())})),17===Vc.errorCode&&fa.cache.cGd(yf.a.A9b(fa.$))):(Ab.push(Object.assign(new Tf.a,{name:"Error",string:Vc.toString()})),Ab.push(Object.assign(new Tf.a,{name:"ErrorCode",string:"exception"})));fi.a(ai.a.HBb,!1,li.getElapsedMilliseconds(Qa,Mh.a.Ra.Kb),Ab);fa.q6=!0;fa.WA(yf.a.VOa)})}else Cc=F?F.ErrorCode:"need_token",F=F?F.ErrorMessage:"No Access Token",Ab.push(Object.assign(new Tf.a,{name:"ServiceChecked",bool:!1})),Ab.push(Object.assign(new Tf.a,{name:"Error",string:F})),Ab.push(Object.assign(new Tf.a,
{name:"ErrorCode",string:Cc})),fi.a(ai.a.HBb,!1,li.getElapsedMilliseconds(Qa,Mh.a.Ra.Kb),Ab),this.q6=!0,this.WA(yf.a.VOa)};De.prototype.Led=function(F,fa){var Qa=this;if(yf.a.xq)this.Je.Led(F,fa,this.fP);else{var Ab=Mh.a.Ra.Kb,Cc=0,Vc=0;this.Ss=Cc===F.count;var qd=[];qd.push(Object.assign(new Tf.a,{name:"ScriptIds",int64:F.count}));if(F.count)if(fa&&fa.IsSuccess){Ae(this.$,fa.Token);var Gd={};fa=yl(F);for(var ve=fa.next();!ve.done;Gd={Neb:Gd.Neb},ve=fa.next())ve=ve.value,Gd.Neb=sj.a.create().toString(),
makerstorage.getSharedScript(ve.value,Gd.Neb).then(function(jf){return function(gf){var qg=[];qg.push(Object.assign(new Tf.a,{name:"BodySize",int64:gf.body.length}));qg.push(Object.assign(new Tf.a,{name:"CorrelationId",string:jf.Neb}));fi.a(ai.a.Ckc,!0,li.getElapsedMilliseconds(Ab,Mh.a.Ra.Kb),qg);Cc++;gf=new Fd(gf);gf.cD=F.na(gf.id);Qa.eg.Rn(gf);Qa.Ss=Cc===F.count;Qa.Qya=!0;Qa.NT(Ab,Vc,qd)}}(Gd)).catch(function(jf){return function(gf){var qg=[];Object.getType(gf)===makerstorage.StorageServiceError?
(qd.push(Object.assign(new Tf.a,{name:"Error",string:gf.message})),qd.push(Object.assign(new Tf.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",gf.errorCode.toString(),gf.status.toString())}))):(qg.push(Object.assign(new Tf.a,{name:"Error",string:gf.toString()})),qg.push(Object.assign(new Tf.a,{name:"ErrorCode",string:"exception"})));qg.push(Object.assign(new Tf.a,{name:"CorrelationId",string:jf.Neb}));fi.a(ai.a.Ckc,!1,li.getElapsedMilliseconds(Ab,Mh.a.Ra.Kb),qg);Cc++;Vc++;Qa.Ss=Cc===
F.count;Qa.NT(Ab,Vc,qd)}}(Gd))}else Gd=fa?fa.ErrorCode:"need_token",fa=fa?fa.ErrorMessage:"No Access Token",qd.push(Object.assign(new Tf.a,{name:"Error",string:fa})),qd.push(Object.assign(new Tf.a,{name:"ErrorCode",string:Gd})),this.Ss=!0,this.NT(Ab,Vc,qd);else this.Ss=this.Qya=!0,this.NT(Ab,Vc,qd)}};De.prototype.NT=function(F,fa,Qa){this.Ss&&(Qa.push(Object.assign(new Tf.a,{name:"ScriptCount",int64:this.eg.length})),Qa.push(Object.assign(new Tf.a,{name:"ScriptErrorCount",int64:fa})),fi.a(ai.a.Wpf,
!fa,li.getElapsedMilliseconds(F,Mh.a.Ra.Kb),Qa),this.eg.sort(),this.WA(yf.a.Ceb))};De.prototype.CAd=function(F){var fa=new Dk.a;if(F=De.eta.parseFromString(F,"text/xml").querySelector('[id="script-ids-node-id"]')){F=F.getElementsByTagName("scriptId");for(var Qa={},Ab=0;Ab<F.length;Qa={fOb:Qa.fOb,cOb:Qa.cOb,XNb:Qa.XNb},Ab++)Qa.fOb=F[Ab].getAttribute("id"),Qa.fOb&&(Qa.cOb=void 0,Qa.XNb=void 0,function(Cc){return function(){var Vc=Sc.$_e(Cc.fOb);Cc.cOb=Vc.hRd;Cc.XNb=Vc.cD;return Vc}}(Qa)().returnValue&&
fa.ia(Qa.cOb,Qa.XNb))}return fa};De.prototype.yac=function(F){if(yf.a.iK)return this.fP.yac(F);switch(F){case "1":case "2":case "3":return this.Ux.IJ(parseInt(F)-1);default:return this.Jm.Ty(F)||this.eg.Ty(F)||this.ir.Ty(F)}};De.prototype.ivb=function(F){if(this.Jm.Rn(F)){this.Jm.sort();var fa=""}else{fa="";var Qa=F.lha();this.eg.Xda(Qa);this.eg.sort();this.Jm.Xda(F);this.Jm.sort()}return{returnValue:!0,message:fa}};De.prototype.gvb=function(F){this.eg.Qha(F.id);return this.Jm.Qha(F.id)?{returnValue:!0,
message:""}:{returnValue:!1,message:"Deleting a script but script could not be found in published collection."}};De.prototype.fvb=function(F){var fa=F.lha();fa.cD=null;this.Jm.Rn(fa)&&this.Jm.sort();return this.eg.Rn(F)?(this.eg.sort(),{returnValue:!0,message:""}):{returnValue:!1,message:"Could not attach a script that is already attached."}};De.prototype.hvb=function(F){return this.eg.Qha(F.id)?{returnValue:!0,message:""}:{returnValue:!1,message:"Detaching a script but the script could not be found in the collection."}};
De.prototype.WA=function(F){if(yf.a.iK)this.fP.WA(F);else{this.mFb();this.$.Gf();var fa=[];fa.push(Object.assign(new Tf.a,{name:"Operation",string:F}));fa.push(Object.assign(new Tf.a,{name:"HasReadCachedScripts",bool:this.p4}));fa.push(Object.assign(new Tf.a,{name:"ReadScriptsDone",bool:this.qKa}));fa.push(Object.assign(new Tf.a,{name:"ReadSamplesScriptsDone",bool:this.r6}));fa.push(Object.assign(new Tf.a,{name:"SamplesScriptCount",int64:this.ir.length}));fa.push(Object.assign(new Tf.a,{name:"ReadPublishedScriptsDone",
bool:this.q6}));fa.push(Object.assign(new Tf.a,{name:"PublishedScriptCount",int64:this.Jm.length}));fa.push(Object.assign(new Tf.a,{name:"ReadWorkbookScriptsDone",bool:this.Ss}));fa.push(Object.assign(new Tf.a,{name:"WorkbookScriptCount",int64:this.eg.length}));fi.a(ai.a.Cwd,!0,0,fa)}};De.prototype.mFb=function(){this.Ux=new me([],function(){});for(var F=this.eg?this.eg.length:0,fa=this.Jm?this.Jm.length:0,Qa=this.ir?this.ir.length:0,Ab=0,Cc=0;Cc<yf.a.kCd;Cc++)if(Cc<F)this.Ux.Rn(this.eg.IJ(Cc));else if(Cc-
F+Ab<fa){var Vc=this.Jm.IJ(Cc-F+Ab);this.eg.Ty(Vc.id)?(Ab++,Cc--):this.Ux.Rn(Vc)}else Cc-F-fa+Ab<Qa&&this.Ux.Rn(this.ir.IJ(Cc-F+Ab-fa))};De.prototype.tXc=function(F,fa){if(yf.a.xq)this.Je.tXc(F,fa);else if(this.cache.og()){var Qa={};Qa.TimeStamp=Mh.a.Ra.Kb;Qa.IsEnabled=fa;this.cache.muc(F,$h.a.Hc(Qa))}};De.prototype.pbd=function(F){if(yf.a.xq)return this.Je.pbd(F);var fa=!1,Qa=!1,Ab=null;this.cache.og()&&(F=Gh.b(this.cache.K2a(F)))&&(Qa=F.IsEnabled,Ab=new Date(F.TimeStamp),fa=!0);return new jc(Qa,
fa,Ab)};De.prototype.yJb=function(F,fa){this.businessBarManager.zje(63,{Zca:"preparing",yza:F,V0b:fa})};De.prototype.HHd=function(F){Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PageloadMetrics",!1)&&!Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GeneralizedRibbonTTVRReporting",!1)&&(F?(Ek.PageLoadTrackingInfo.instance.gma(Ni.a.vR,["automateTab"]),Ek.PageLoadTrackingInfo.instance.N_(Ni.a.vR,["automateTab"]),Ek.PageLoadTrackingInfo.instance.pW(Ni.a.vR,["automateTab"])):
(Ek.PageLoadTrackingInfo.instance.GPa(Ni.a.vR,["automateTab"]),Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CacheAutomateVisibility",!1)&&vk.c()&&appChrome.api.dispatch(appChrome.actions.deactivateRibbonTab(Ni.a.hFb))))};tl.Object.defineProperties(De.prototype,{Jm:{configurable:!0,enumerable:!0,get:function(){return yf.a.xq?this.Je.Jm:this.Cbe}},eg:{configurable:!0,enumerable:!0,get:function(){return yf.a.xq?this.Je.eg:this.$$d}},ir:{configurable:!0,enumerable:!0,get:function(){return yf.a.xq?
this.Je.ir:this.cde}},Lk:{configurable:!0,enumerable:!0,get:function(){return this.Je.Lk}},Sa:{configurable:!0,enumerable:!0,get:function(){return this.SNc}},r6:{configurable:!0,enumerable:!0,get:function(){return yf.a.xq?this.Je.r6:this.Ube},set:function(F){yf.a.xq?this.Je.r6=F:this.Ube=F}},Ss:{configurable:!0,enumerable:!0,get:function(){return yf.a.xq?this.Je.Ss:this.Wbe},set:function(F){yf.a.xq?this.Je.Ss=F:this.Wbe=F}},uca:{configurable:!0,enumerable:!0,get:function(){return this.Je.uca}},iva:{configurable:!0,
enumerable:!0,get:function(){return this.Je.iva}},qKa:{configurable:!0,enumerable:!0,get:function(){return yf.a.xq?this.Je.qKa:(yf.a.iK?this.uca:this.q6)&&this.Ss&&this.r6}},oKa:{configurable:!0,enumerable:!0,get:function(){return yf.a.xq?this.Je.oKa:(yf.a.iK?this.iva:this.p4)||this.qKa}},Ux:{configurable:!0,enumerable:!0,get:function(){return yf.a.xq||yf.a.iK?this.fP.Ux:this.sbe},set:function(F){yf.a.xq||yf.a.iK?this.fP.Ux=F:this.sbe=F}},initTime:{configurable:!0,enumerable:!0,get:function(){return this.Ulg}},
aba:{configurable:!0,enumerable:!0,get:function(){var F=!!this.Dv.Gx&&this.Dv.Gx.isSuccess&&this.Dv.Gx.value,fa=!!this.Zz&&!this.Zz.isSuccess,Qa=!!this.Zz&&this.Dv.Gx.isSuccess&&this.Zz.value;return this.Sef&&F&&(Qa||fa&&!zh.a.uwa(11))}},r$a:{configurable:!0,enumerable:!0,get:function(){return yf.a.xq?this.Je.r$a:this.Sbe},set:function(F){yf.a.xq?this.Je.r$a=F:this.Sbe=F}},Qya:{configurable:!0,enumerable:!0,get:function(){return yf.a.xq?this.Je.Qya:this.Vbe},set:function(F){yf.a.xq?this.Je.Qya=F:
this.Vbe=F}},p4:{configurable:!0,enumerable:!0,get:function(){return yf.a.xq?this.Je.p4:this.G4d},set:function(F){yf.a.xq?this.Je.p4=F:this.G4d=F}},q6:{configurable:!0,enumerable:!0,get:function(){return yf.a.xq?this.Je.q6:this.Tbe},set:function(F){yf.a.xq?this.Je.q6=F:this.Tbe=F}},Sef:{configurable:!0,enumerable:!0,get:function(){var F="TestHost"===this.$.ya.DocumentHostInfo.HostTier,fa=kg.AFrameworkApplication.ga.Ua("UserPrincipalName");fa=!kg.AFrameworkApplication.ga.ra("IsAnonymousUser")&&!!fa&&
!fa.includes("ext#")&&!fa.includes("guest#");return!zh.a.fwa&&(F||this.Bra.hqe&&fa)}}});De.eta=new DOMParser;Object($d.a)(De,"AutomateCommandManager",null,[906]);var Ej=b(1343),rj=b(1290),Jj=b(234);Ee.key="InsertAgaveClientSideParametersKey";Object($d.a)(Ee,"InsertAgaveClientSideParameters",null,[]);var Zi=b(56),gk=b(103),Xh=b(20);ue.prototype.jvb=function(F){if(F.aba){var fa=[];fa.push(Object.assign(new Tf.a,{name:"isSharedRuntimeInstanceInitialized",bool:this.U5a}));fa.push(Object.assign(new Tf.a,
{name:"actionName",string:F.actionName}));fa.push(Object.assign(new Tf.a,{name:yf.a.T9,string:F.V0b.toString()}));this.U5a?this.sTf(F):this.fXh(F);fi.a(ai.a.Zxi,void 0,void 0,fa)}};ue.prototype.kgd=function(F,fa){var Qa={};Qa[yf.a.T9]=fa;this.$Kd(F,Qa)};ue.prototype.gnj=function(){this.hZf()?this.tEf():Xh.g(this.$).Ca.oke(this.a8a)};ue.prototype.hZf=function(){if(this.U5a||mc(this.$))return!1;var F=gk.a(this.$);return Xh.g(this.$).Ca.zYb&&F.P8h()};ue.prototype.tEf=function(){var F=this;this.Dv.Gx?
this.Dv.Gx.value&&this.Bra.S$b():this.Dv.Ave().then(function(fa){fa&&F.Bra.S$b()});fi.a(ai.a.Vxi)};ue.prototype.wfj=function(){var F=bj.a.create().toString(),fa={};cb(this.$,fa);var Qa={};Qa[yf.a.F2f]=this.Bra.getAuthContext();var Ab={};Ab[yf.a.jRe]=$h.a.Hc(fa);Ab[yf.a.$8e]=$h.a.Hc(Qa);Ab[yf.a.Fch]=$h.a.Hc(this.$.ya.DocumentHostInfo);Ab[yf.a.myj]=Bc(this.$);Ab[yf.a.y4f]=$h.a.Hc(yf.a.nr);Ab[yf.a.$qe]=this.$.Tpf?"true":"false";Ab[yf.a.tQf]=yf.a.j2a(this.$);Ab[yf.a.Y4e]=vd(this.$);Ab[yf.a.F5f]=fd(this.$);
Ab[yf.a.T9]=F;fa=[];fa.push(Object.assign(new Tf.a,{name:yf.a.T9,string:F}));fi.a(ai.a.Xxi,void 0,void 0,fa);this.$Kd(yf.a.M3h,Ab)};ue.prototype.fXh=function(F){var fa=this;mc(this.$)&&Ae(this.$,"localstorage");Wg.TaskExtensions.Ba(Zi.GetServiceTaskFactory.Xa(this.$.da,374,375,1),function(Qa){fa.uli(Qa.result).continueWith(function(){fa.vfj(F)});fa.U5a=!0},this.$.ma,3)};ue.prototype.uli=function(F){var fa={};fa.SolutionId=yf.a.assetId;fa.Version=yf.a.Qsc;fa.StoreType=OSF.StoreType.Sdx;fa.StoreId=
OSF.StoreType.Sdx;fa.AssetId=yf.a.assetId;fa.AssetStoreId=OSF.StoreType.Sdx;fa.TargetType=1;fa.SharedRuntimeId=yf.a.Bub(this.$);fa.SourceLocationOverrideResourceId=yf.a.Bub(this.$);fa.IsToBePersisted=!1;fa.Id=yf.a.assetId;fa.AppVersion=yf.a.Qsc;fa.CurrentStoreType=OSF.StoreType.Sdx;var Qa=new Ej.a;Qa.al=Fe.a.instance.ea(2081);Qa.taskPaneWidth=yf.a.nr;var Ab=new Ee;Ab.hyc=fd(this.$);Ab.xaa=vd(this.$);return F.$Jd(fa,Qa,void 0,void 0,Ab)};ue.prototype.vfj=function(F){this.wfj();Jj.a(this.$)&&Jj.a(this.$).Bke(this.cBi);
this.sTf(F)};ue.prototype.sTf=function(F){var fa={};fa[yf.a.Cbj]=F.shapeId;fa[yf.a.Bbj]=F.yza;fa[yf.a.T9]=F.V0b.toString();this.$Kd(F.actionName,fa)};ue.prototype.$Kd=function(F,fa){var Qa=new Ai.a(yf.a.assetId,OSF.StoreType.Sdx,OSF.StoreType.Sdx,yf.a.Qsc),Ab=new vi.a(yf.a.$5e,yf.a.ZRe,this.$.ya.UICultureTag),Cc=new kj.a;Cc.ni[le.al]=Fe.a.instance.ea(2081);Cc.ni[le.sourceLocationOverrideResourceId]=yf.a.Bub(this.$);Cc.ni[le.sRc]=fa;Cc.ni[le.taskPaneWidth]=yf.a.nr;zi.a.instance.CMa(Qa,rj.a.action,
F,Ab,Cc)};Object($d.a)(ue,"AutomateCommandRunFromButton",null,[903]);vm(ee,Sc);ee.prototype.tXc=function(F,fa){if(this.cache.og()){var Qa={};Qa.TimeStamp=Mh.a.Ra.Kb;Qa.IsEnabled=fa;this.cache.muc(F,$h.a.Hc(Qa))}};ee.prototype.pbd=function(F){var fa=!1,Qa=!1,Ab=null;this.cache.og()&&(F=Gh.b(this.cache.K2a(F)))&&(Qa=F.IsEnabled,Ab=new Date(F.TimeStamp),fa=!0);return new jc(Qa,fa,Ab)};ee.prototype.JIf=function(F){var fa=this,Qa=Mh.a.Ra.Kb,Ab=[];return Wg.TaskExtensions.zha(this.indexedDB.CJa(yf.a.kPa),
function(Cc){var Vc=!fa.uca||!fa.Lk.length;Cc=Cc.result;Ab.push(Object.assign(new Tf.a,{name:"ExistingScriptCount",int64:fa.Lk.length}));if(""!==Cc&&(Cc=Gh.b(Cc),Ab.push(Object.assign(new Tf.a,{name:"CachedScriptCount",int64:Cc.length})),Vc)){for(var qd=yl(Cc),Gd=qd.next();!Gd.done;Gd=qd.next())fa.Lk.Rn(new Fd(Gd.value));fa.iva=!0;fa.nEd=0<Cc.length;fi.a(ai.a.Vpf,Vc,li.getElapsedMilliseconds(Qa,Mh.a.Ra.Kb),Ab);fa.WEd(F);return!0}fi.a(ai.a.Vpf,Vc,li.getElapsedMilliseconds(Qa,Mh.a.Ra.Kb),Ab);return!1},
this.$.ma,3)};ee.prototype.kZi=function(F){Ag.EwaSettings.getBooleanFeatureGate(yf.a.QVc,!1)&&this.nZi(F);yf.a.iK?this.JIf(F):this.jZi(F)};ee.prototype.GPh=function(F,fa,Qa){var Ab=this,Cc=Mh.a.Ra.Kb,Vc=[];if(F&&F.IsSuccess){Ae(this.$,F.Token);var qd=sj.a.create().toString();Vc.push(Object.assign(new Tf.a,{name:"CorrelationId",string:qd}));makerstorage.getRecentScripts(qd).then(function(Gd){Vc.push(Object.assign(new Tf.a,{name:"HasReadCachedScripts",bool:Ab.iva}));Ab.Lk.clear();Gd=yl(Gd);for(var ve=
Gd.next();!ve.done;ve=Gd.next())Ab.Lk.Rn(new Fd(ve.value));Ab.nEd=!0;Ab.uca=!0;Ab.indexedDB.og()&&(Gd=$h.a.Hc(Ab.Lk.ddb()),Ab.indexedDB.Rab(new uk.a(yf.a.kPa,Gd)));Vc.push(Object.assign(new Tf.a,{name:"ScriptCount",int64:Ab.Lk.length}));fi.a(ai.a.HBb,!0,li.getElapsedMilliseconds(Cc,Mh.a.Ra.Kb),Vc);fa.WA(yf.a.kPa)}).catch(function(Gd){Object.getType(Gd)===makerstorage.StorageServiceError?(Vc.push(Object.assign(new Tf.a,{name:"Error",string:Gd.message})),Vc.push(Object.assign(new Tf.a,{name:"ErrorCode",
string:String.format("makerstorage_{0}_{1}",Gd.errorCode.toString(),Gd.status.toString())})),17===Gd.errorCode&&Qa.cGd(yf.a.A9b(Ab.$))):(Vc.push(Object.assign(new Tf.a,{name:"Error",string:Gd.toString()})),Vc.push(Object.assign(new Tf.a,{name:"ErrorCode",string:"exception"})));fi.a(ai.a.Wxi,!1,li.getElapsedMilliseconds(Cc,Mh.a.Ra.Kb),Vc);Ab.uca=!0;fa.WA(yf.a.kPa)})}else qd=F?F.ErrorCode:"need_token",F=F?F.ErrorMessage:"No Access Token",Vc.push(Object.assign(new Tf.a,{name:"ServiceChecked",bool:!1})),
Vc.push(Object.assign(new Tf.a,{name:"Error",string:F})),Vc.push(Object.assign(new Tf.a,{name:"ErrorCode",string:qd})),fi.a(ai.a.HBb,!1,li.getElapsedMilliseconds(Cc,Mh.a.Ra.Kb),Vc),this.uca=!0,fa.WA(yf.a.kPa)};ee.prototype.oEd=function(F,fa){var Qa=this,Ab=new mj.a,Cc=se(this.$);return Jc(this.$,function(Vc){if((Vc=Vc.Result)&&200===Vc.ResponseStatusCode)Vc=JSON.parse(Vc.ResponseBody.join("")),F(Qa.CAd(Vc.value)),Ab.setResult(!0);else{Vc=Vc?"RichApi_"+Vc.ResponseStatusCode:"RichApiError";var qd=[];
qd.push(Object.assign(new Tf.a,{name:"Error",string:"Failed to read shared script ids from document"}));qd.push(Object.assign(new Tf.a,{name:"ErrorCode",string:Vc}));Qa.Ss=!0;Qa.NT(fa,Mh.a.Ra.Kb,0,qd);Ab.setResult(!1)}},function(Vc){Vc=fk.a.yg(Vc.data);Se.ULS.sendTraceTag(537170309,0,15,"REST API failed to fetch the CustomXmlPart for Automate Gallery.");var qd=[];qd.push(Object.assign(new Tf.a,{name:"Error",string:"Failure using rich api: "+Vc}));qd.push(Object.assign(new Tf.a,{name:"ErrorCode",string:"RichApiFailure"}));
Qa.Ss=!0;Qa.NT(fa,Mh.a.Ra.Kb,0,qd);Ab.setResult(!1)},Cc,Ab)};ee.prototype.Led=function(F,fa,Qa){var Ab=this,Cc=Mh.a.Ra.Kb,Vc=0,qd=0;this.Ss=Vc===F.count;var Gd=[];Gd.push(Object.assign(new Tf.a,{name:"ScriptIds",int64:F.count}));if(F.count)if(fa&&fa.IsSuccess){Ae(this.$,fa.Token);var ve={};fa=yl(F);for(var jf=fa.next();!jf.done;ve={Oeb:ve.Oeb},jf=fa.next())jf=jf.value,ve.Oeb=sj.a.create().toString(),makerstorage.getSharedScript(jf.value,ve.Oeb).then(function(gf){return function(qg){var Qg=[];Qg.push(Object.assign(new Tf.a,
{name:"BodySize",int64:qg.body.length}));Qg.push(Object.assign(new Tf.a,{name:"CorrelationId",string:gf.Oeb}));fi.a(ai.a.Ckc,!0,li.getElapsedMilliseconds(Cc,Mh.a.Ra.Kb),Qg);Vc++;qg=new Fd(qg);qg.cD=F.na(qg.id);Ab.eg.Rn(qg);Ab.Ss=Vc===F.count;Ab.Qya=!0;Ab.NT(Qa,Cc,qd,Gd)}}(ve)).catch(function(gf){return function(qg){var Qg=[];Object.getType(qg)===makerstorage.StorageServiceError?(Gd.push(Object.assign(new Tf.a,{name:"Error",string:qg.message})),Gd.push(Object.assign(new Tf.a,{name:"ErrorCode",string:String.format("makerstorage_{0}_{1}",
qg.errorCode.toString(),qg.status.toString())}))):(Qg.push(Object.assign(new Tf.a,{name:"Error",string:qg.toString()})),Qg.push(Object.assign(new Tf.a,{name:"ErrorCode",string:"exception"})));Qg.push(Object.assign(new Tf.a,{name:"CorrelationId",string:gf.Oeb}));fi.a(ai.a.Ckc,!1,li.getElapsedMilliseconds(Cc,Mh.a.Ra.Kb),Qg);Vc++;qd++;Ab.Ss=Vc===F.count;Ab.NT(Qa,Cc,qd,Gd)}}(ve)).finally(function(){if(Ag.EwaSettings.getBooleanFeatureGate(yf.a.QVc,!1)&&Ab.indexedDB.og()&&Ab.Ss){var gf=Sc.fRh(Ab.$,Ab.eg);
Ab.indexedDB.Rab(new uk.a(yf.a.Ceb,gf))}})}else ve=fa?fa.ErrorCode:"need_token",fa=fa?fa.ErrorMessage:"No Access Token",Gd.push(Object.assign(new Tf.a,{name:"Error",string:fa})),Gd.push(Object.assign(new Tf.a,{name:"ErrorCode",string:ve})),this.Ss=!0,this.NT(Qa,Cc,qd,Gd);else this.Ss=this.Qya=!0,this.NT(Qa,Cc,qd,Gd),Ag.EwaSettings.getBooleanFeatureGate(yf.a.QVc,!1)&&Wg.TaskExtensions.zha(Sc.MIf(this.$,this.indexedDB),function(gf){gf.result&&(Ab.indexedDB.z4c(yf.a.Ceb),Ab.eg.clear(),Qa.WA("CachedScripts"))},
this.$.ma,3)};ee.prototype.yed=function(F){var fa={id:"samples-6"};fa.name=Fe.a.instance.ea(2078);this.ir.Rn(new Fd(fa));fa.id="samples-8";fa.name=Fe.a.instance.ea(2079);this.ir.Rn(new Fd(fa));fa.id="samples-2";fa.name=Fe.a.instance.ea(2075);this.ir.Rn(new Fd(fa));fa.id="samples-4";fa.name=Fe.a.instance.ea(2076);this.ir.Rn(new Fd(fa));fa.id="samples-5";fa.name=Fe.a.instance.ea(2077);this.ir.Rn(new Fd(fa));this.r6=!0;F.WA("SampleScripts")};ee.prototype.CAd=function(F){var fa=new Dk.a;if(F=this.eta.parseFromString(F,
"text/xml").querySelector('[id="script-ids-node-id"]')){F=F.getElementsByTagName("scriptId");for(var Qa={},Ab=0;Ab<F.length;Qa={gOb:Qa.gOb,dOb:Qa.dOb,YNb:Qa.YNb},Ab++)Qa.gOb=F[Ab].getAttribute("id"),Qa.gOb&&(Qa.dOb=void 0,Qa.YNb=void 0,function(Cc){return function(){var Vc=Sc.$_e(Cc.gOb);Cc.dOb=Vc.hRd;Cc.YNb=Vc.cD;return Vc}}(Qa)().returnValue&&fa.ia(Qa.dOb,Qa.YNb))}return fa};ee.prototype.nZi=function(F){var fa=this,Qa=Mh.a.Ra.Kb,Ab=[];Wg.TaskExtensions.zha(Sc.MIf(this.$,this.indexedDB),function(Cc){var Vc=
Cc.result;Ab.push(Object.assign(new Tf.a,{name:"ExistingScriptCount",int64:fa.eg.length}));if(Vc){Ab.push(Object.assign(new Tf.a,{name:"CachedScriptCount",int64:Vc.length}));if(Cc=!fa.Ss||0===fa.eg.length){Vc=yl(Vc.getScripts());for(var qd=Vc.next();!qd.done;qd=Vc.next())fa.eg.Rn(qd.value);fa.eg.sort();fi.a(ai.a.Bwd,Cc,li.getElapsedMilliseconds(Qa,Mh.a.Ra.Kb),Ab);fa.WEd(F);return!0}fi.a(ai.a.Bwd,Cc,li.getElapsedMilliseconds(Qa,Mh.a.Ra.Kb),Ab)}else fi.a(ai.a.Bwd,!1,li.getElapsedMilliseconds(Qa,Mh.a.Ra.Kb),
Ab);return!1},this.$.ma,3)};ee.prototype.jZi=function(F){var fa=this,Qa=Mh.a.Ra.Kb,Ab=[];Wg.TaskExtensions.zha(this.indexedDB.CJa(yf.a.VOa),function(Cc){var Vc=!fa.q6||!fa.Jm.length;Cc=Cc.result;Ab.push(Object.assign(new Tf.a,{name:"ExistingScriptCount",int64:fa.Jm.length}));if(""!==Cc&&(Cc=Gh.b(Cc),Ab.push(Object.assign(new Tf.a,{name:"CachedScriptCount",int64:Cc.length})),Vc)){Cc=yl(Cc);for(var qd=Cc.next();!qd.done;qd=Cc.next())fa.Jm.Rn(new Fd(qd.value));fa.Jm.sort();fi.a(ai.a.GBb,Vc,li.getElapsedMilliseconds(Qa,
Mh.a.Ra.Kb),Ab);fa.WEd(F);return!0}fi.a(ai.a.GBb,Vc,li.getElapsedMilliseconds(Qa,Mh.a.Ra.Kb),Ab);return!1},this.$.ma,3)};ee.prototype.NT=function(F,fa,Qa,Ab){this.Ss&&(Ab.push(Object.assign(new Tf.a,{name:"ScriptCount",int64:this.eg.length})),Ab.push(Object.assign(new Tf.a,{name:"ScriptErrorCount",int64:Qa})),fi.a(ai.a.Wpf,!Qa,li.getElapsedMilliseconds(fa,Mh.a.Ra.Kb),Ab),this.eg.sort(),F.WA(yf.a.Ceb))};ee.prototype.WEd=function(F){this.p4=!0;F.WA("CachedScripts")};Object($d.a)(ee,"AutomateCommandStorage",
Sc,[]);var Ok=ij.a;vm(Qc,Ok);Qc.prototype.create=function(){var F=this,fa=Zi.GetServiceTaskFactory.Xa(this.$.da,349,350,this.tb),Qa=Ke.a.loadScript(109,4,this.tb,void 0,void 0,351),Ab=Zi.GetServiceTaskFactory.create(this.$.da,102,this.$.ma,this.tb),Cc=Zi.GetServiceTaskFactory.create(this.$.da,396,this.$.ma,this.tb),Vc=Zi.GetServiceTaskFactory.Xa(this.$.da,5,4,this.tb);Wg.TaskExtensions.Ba(Wg.TaskExtensions.ve([fa,Qa,Ab,Cc,Vc],this.ma,3),function(){var qd=fa.result,Gd=Cc.result,ve=Vc.result,jf=new we,
gf=new gg(F.$,qd,jf),qg=new ee(F.$,Gd),Qg=new ud(F.$,qg),ph=new ue(F.$,gf,jf);F.Fb(F.$.da.Aa(352)||new De(F.$,qd,Ab.result,Gd,ph,jf,gf,qg,Qg,ve))},this.ma,3)};Qc.ja=function(F){F&&F.da.Ha(351,new Qc(F))};Object($d.a)(Qc,"AutomateCommandManagerFactory",ij.a,[]);var wk=b(848),Pk=b(821),lk=wk.a;vm(Rc,lk);Rc.getTypeName=function(){return"AugLoop_ImageToTable_DetectedHtmlTableAnnotation"};Rc.pe=function(){return["AugLoop_Core_Annotation"]};Object($d.a)(Rc,"DetectedHtmlTableAnnotation",wk.a,[]);var Fj=
b(36),Wj=b(43),xk=b(368),ak=b(92),Fk=Fj.a;vm(sc,Fk);sc.prototype.dispose=function(){window.removeEventListener("message",this.gDe,!1);Fk.prototype.dispose.call(this)};sc.prototype.ZQf=function(F,fa){this.mwb=bj.a.create().toString();this.jwb="";this.imageHeight=this.imageWidth=0;this.errorMessage=this.tableData="";this.rRc=!1;this.MNi(F,fa);this.eMj()};sc.prototype.eMj=function(){if(this.jwb.length){var F=window.self.atob(this.jwb);for(var fa=Array(F.length),Qa=0;Qa<F.length;Qa++)fa[Qa]=F.charCodeAt(Qa);
this.augmentationLoopManager.dMj(fa,this.mwb,this.imageWidth,this.imageHeight)}else Se.ULS.sendTraceTag(537163343,0,50,"DataFromPicturePaneCommandManager:UploadImageToAugmentationLoop - imageDataBase64 is empty")};sc.prototype.MNi=function(F,fa){fa.SessionID=this.mwb;fa.DataFromPictureURL="ImageToDoc.Dogfood.Url";fa.DataFromPictureAssetId="FA000000050";fa.LoadDataFromPictureTaskpane=!0;F=new ak.a(-859308420,F.method,F.mode,F.df,F.tabName);this.$.Ka.Zb(F,fa)};sc.prototype.ufj=function(){if(this.jwb.length){var F=
Jj.a(this.$).U$("FA000000050.ImageToDoc.Dogfood.Url"),fa={};fa=(fa.DataFromPictureWildcard=".",fa);fa.imageData=this.jwb;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(F,"onCustomMessage",fa,function(Qa){Qa&&Se.ULS.sendTraceTag(537163341,0,50,"DataFromPicturePaneCommandManager:sendImageToTaskPane() - Attempted to send image to Pane - Failed .")})}else Se.ULS.sendTraceTag(537163342,0,50,"DataFromPicturePaneCommandManager:sendImageToTaskPane() - Attempted to send image to Pane - Failed no image Data.")};
sc.prototype.OTf=function(){if(this.tableData.length){var F=Jj.a(this.$).U$("FA000000050.ImageToDoc.Dogfood.Url"),fa={};fa=(fa.DataFromPictureWildcard=".",fa);fa.tableHtml=this.tableData;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(F,"onCustomMessage",fa,function(Qa){Qa&&Se.ULS.sendTraceTag(537163339,0,50,"DataFromPicturePaneCommandManager:sendTableToTaskPane() - Attempted to send table data to Pane - Failed.")})}else Se.ULS.sendTraceTag(537163340,0,50,"DataFromPicturePaneCommandManager:sendTableToTaskPane() - Attempted to send table data to Pane - Failed, No Table Data.")};
sc.prototype.xTf=function(){if(this.errorMessage.length){var F=Jj.a(this.$).U$("FA000000050.ImageToDoc.Dogfood.Url"),fa={};fa=(fa.DataFromPictureWildcard=".",fa);fa.errorMessage=this.errorMessage;OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(F,"onCustomMessage",fa,function(Qa){Qa&&Se.ULS.sendTraceTag(537163337,0,50,"DataFromPicturePaneCommandManager:sendErrorMessageToTaskPane() - Attempted to send ErrorMessage to Pane - Failed .")})}else Se.ULS.sendTraceTag(537163338,0,50,"DataFromPicturePaneCommandManager:sendErrorToTaskPane() - Attempted to send ErrorMessage to Pane - Failed, No valid error message.")};
sc.prototype.initialize=function(){window.addEventListener("message",this.gDe,!1);this.augmentationLoopManager.activateAnnotation(this.U6e);this.augmentationLoopManager.bT(this.U6e,this.O1h)};Object($d.a)(sc,"DataFromPicturePaneCommandManager",Fj.a,[]);var hk=b(175),nj=b(55);Cg.prototype.Xc=function(){return!1};Cg.prototype.executeCommand=function(F,fa,Qa){F=!1;switch(fa.command){case 73979048:this.Dqb?this.Dqb.ZQf(fa,Qa):(this.ee=fa,this.RT=Qa,this.G3c=!0),F=!0}return F?nj.Task.Ta(!0):hk.a(fa.command)};
Cg.prototype.Gc=function(F,fa){return 73979048===fa.command&&Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)};Cg.prototype.fd=function(){return!1};Cg.prototype.dispose=function(){this.Dqb.dispose()};Object($d.a)(Cg,"DataFromPictureCommandHandler",null,[237,3]);var Gk=xd.a;vm(rf,Gk);rf.prototype.Md=function(){this.Ed([new Cg(this.$)])};rf.ja=function(F){xd.a.de(452,new rf(F))};Object($d.a)(rf,"DataFromPictureCommandHandlerFactory",xd.a,[]);var Lg=b(846),Hk=b(819);
Af.prototype.vNh=function(F){Se.ULS.sendTraceTag(17306645,220,50,"Context menu id: {0}",F);for(var fa=new Ph.a,Qa=yl(this.A_b),Ab=Qa.next();!Ab.done;Ab=Qa.next()){Ab=yl(Ab.value.DBb);for(var Cc=Ab.next();!Cc.done;Cc=Ab.next())Cc=Cc.value,Cc.id===F&&fa.add(Cc)}return fa};Af.prototype.Tie=function(F){this.A_b.add(F)};Af.prototype.y2i=function(F){for(var fa=yl(this.A_b),Qa=fa.next();!Qa.done;Qa=fa.next())if(Qa=Qa.value,Qa.Gme===F.Gme){this.A_b.remove(Qa);break}};Af.Cah=function(F,fa,Qa){Qa=void 0===
Qa?null:Qa;F=Af.SFh(F);0<F.length&&(Af.$tc(F,!1),Qa&&Qa(fa,F))};Af.SFh=function(F){var fa=[];if(F&&F.DBb&&0<F.DBb.count){F=yl(F.DBb);for(var Qa=F.next();!Qa.done;Qa=F.next())if(Qa=Qa.value,Qa.controls&&0<Qa.controls.count){Qa=yl(Qa.controls);for(var Ab=Qa.next();!Ab.done;Ab=Qa.next())if(Ab=Ab.value,Ab.menuItems&&0<Ab.menuItems.count){Ab=yl(Ab.menuItems);for(var Cc=Ab.next();!Cc.done;Cc=Ab.next())Array.add(fa,Cc.value.id)}}}return fa};Af.$tc=function(F,fa){if(F.length){F=yl(F);for(var Qa=F.next();!Qa.done;Qa=
F.next())Qa=document.querySelector('[id^="'+Qa.value+'"]'),Hk.a.ida(Qa,fa)}};tl.Object.defineProperties(Af.prototype,{A_b:{configurable:!0,enumerable:!0,get:function(){return this.Bhg}}});Object($d.a)(Af,"ContextMenuExtensibilityCache",null,[832,833]);var Ik=b(1417),yk=b(1014),bk=b(885),Sg=b(830),zk=b(893),Mj=zk.a;vm(vg,Mj);vg.prototype.clone=function(){var F=new vg;F.Sjd=this.Sjd;F.zjd=this.zjd;F.ribbon=this.ribbon;return F};Object($d.a)(vg,"RibbonBuildContext",zk.a,[]);var cj=b(818);Yf.prototype.kga=
function(F,fa,Qa){fa=void 0===fa?null:fa;Qa=void 0===Qa?null:Qa;var Ab=bk.Builder.o2b(F);if(cj.c(Ab))Qa&&Qa(!1);else if(F=new vg,F.zjd=this.S8.homeTab.id,F.Sjd=this.S8.homeTab,F.ribbon=this.S8,Ab=new Sg.a(Ab),Ab=Sg.a.KU(Ab.node,Sg.a.$Yd),cj.c(Ab))Qa&&Qa(!1);else{Ab=Sg.a.Cm(Ab);for(var Cc=0;Cc<Ab.length;Cc++){var Vc=Ab[Cc],qd=(new Sg.a(Vc)).attributes[Sg.a.id];if(this.S8.faa(qd))this.lUb.wRj(qd,Vc,F);else{var Gd=-1;fa&&(Gd=this.zvh(qd,fa));-1!==Gd?this.lUb.wyg(Vc,F,Gd):this.lUb.wyg(Vc,F)}}Qa&&Qa(!0)}};
Yf.prototype.zvh=function(F,fa){F=Array.indexOf(fa,F);if(-1===F)return-1;--F;for(var Qa=-1;0<=F;){Qa=this.IKh(fa[F]);if(-1!==Qa)break;F--}return Qa+1};Yf.prototype.IKh=function(F){for(var fa=0,Qa=!1,Ab=yl(this.S8.children),Cc=Ab.next();!Cc.done;Cc=Ab.next()){Cc=Cc.value;if(Cc.id===F){Qa=!0;break}Cc.visible&&fa++}return Qa?fa:-1};Yf.prototype.N$a=function(F){F=bk.Builder.o2b(F);if(!cj.c(F)&&(F=new Sg.a(F),F=Sg.a.KU(F.node,Sg.a.$Yd),!cj.c(F))){F=Sg.a.Cm(F);for(var fa=0;fa<F.length;fa++){var Qa=F[fa],
Ab=(new Sg.a(Qa)).attributes[Sg.a.id];Qa=Sg.a.KU(Qa,Sg.a.jOb);Qa=Sg.a.Cm(Qa);for(var Cc=0;Cc<Qa.length;Cc++){var Vc=Sg.a.FYe(Qa[Cc],Sg.a.id);cj.c(Vc)||this.lUb.NSj(Ab,Vc)}}}};Object($d.a)(Yf,"RibbonExtensibilityBuilder",null,[]);Of.prototype.kga=function(F,fa){fa=void 0===fa?null:fa;var Qa=F.wTe();this.Cce.kga(Qa,F.d9a,fa)};Of.prototype.N$a=function(F){F=F.wTe();this.Cce.N$a(F)};Of.Lah=function(F,fa,Qa){Qa=void 0===Qa?null:Qa;F=Of.mQh(F);0<F.length&&(Of.$tc(F,!1),Qa&&Qa(fa,F))};Of.mQh=function(F){var fa=
[];if(F){var Qa=F.pK;if(!Qa){if(F.tabs&&0<F.tabs.count)for(F=yl(F.tabs),Qa=F.next();!Qa.done;Qa=F.next())if(Qa=Qa.value,0<Qa.KJ.count){var Ab=yl(Qa.KJ);for(Qa=Ab.next();!Qa.done;Qa=Ab.next())if(Qa=Qa.value,0<Qa.Aha.count){var Cc=yl(Qa.Aha);for(Qa=Cc.next();!Qa.done;Qa=Cc.next())Array.add(fa,Qa.value.id)}}}else if(Qa.fq&&0<Qa.fq.count)for(F=yl(Qa.fq),Qa=F.next();!Qa.done;Qa=F.next())if(Qa=Qa.value,Qa.groups&&0<Qa.groups.length)for(Ab=yl(Qa.groups),Qa=Ab.next();!Qa.done;Qa=Ab.next())if(Qa=Qa.value,
Qa.controls&&0<Qa.controls.length)for(Cc=yl(Qa.controls),Qa=Cc.next();!Qa.done;Qa=Cc.next())Array.add(fa,Qa.value.id)}return fa};Of.$tc=function(F,fa){if(F.length){F=yl(F);for(var Qa=F.next();!Qa.done;Qa=F.next())Qa=document.querySelector('[id^="'+Qa.value+'"]'),Hk.a.ida(Qa,fa)}};Object($d.a)(Of,"RibbonExtensibilityManager",null,[865]);var ck=b(1070);Lf.prototype.getTaskPaneControlIdFromAssetIdRuntimeId=function(F,fa){return OfficeExt.DefaultControlActionBinder.getTaskPaneControlIdFromAssetIdRuntimeId(F,
fa)};Lf.prototype.igd=function(F,fa,Qa,Ab,Cc,Vc,qd){Vc=void 0===Vc?null:Vc;qd=void 0===qd?null:qd;Se.ULS.sendTraceTag(17138449,220,50,"Control id: {0}.",F);if((F=fa.L3(Cc.ownerAddinInfo.storeType,Cc.ownerAddinInfo.solutionId))&&F.Ps&&!F.Ps.getIsUpgrading())if(fa=null,0<F.Ps.getNotificationParams().length&&(fa=this.Yre(F.Ps.getNotificationParams()[0]),kg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoLaunchAddinEnabled",!1)&&fa&&2147758681===fa.errorCode&&(F.isUpgraded=
!0),kg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UpgradeAddinUsageEnabled",!1)&&fa&&2147758681===fa.errorCode&&Se.ULS.sendTraceTag(529278163,220,50,"Upgrade")),2!==F.Ps.getStatus()&&(1!==F.Ps.getStatus()||fa&&2147758681===fa.errorCode))fa&&this.SZf(F,fa,qd);else try{Qa.setOwnerAddinEToken(F.Ps.getEToken()),Cc.action(Qa,Ab.Yba),Vc&&Vc()}catch(Gd){Se.ULS.sendTraceTag(17425949,220,10,String.format("HandleAddinCommandsAction error info : {0}.",kg.AFrameworkApplication.ga.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LogStackInfo")?
Gd.stack:Gd.message)),ck.a.Bvc(CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)}};Lf.prototype.SZf=function(F,fa,Qa){var Ab=this;Qa=void 0===Qa?null:Qa;var Cc=F.Ps;if(1===Cc.getNotificationParams().length||fa.qcc){var Vc=fa.Wga,qd=fa.Tha;fa.Wga=function(){Cc.removeFirstNotification();if(0<Cc.getNotificationParams().length){var Gd=Ab.Yre(Cc.getNotificationParams()[0]);Ab.SZf(F,Gd)}2147758681===fa.errorCode&&(Of.Lah(F.nl,Cc,Object(Ri.a)(Ab,Ab.J7e,"initUpgradeStateDetectTask")),
Af.Cah(F.Gpb,Cc,Object(Ri.a)(Ab,Ab.J7e,"initUpgradeStateDetectTask")));Vc&&Vc()};fa.Tha=function(){qd&&qd();Qa&&Qa()};ck.a.QOd(fa)}};Lf.prototype.J7e=function(F,fa){var Qa=null;Qa=function(){F.getIsUpgrading()?window.setTimeout(Qa,1E3):F.getUpgradingFailed()?Of.$tc(fa,!0):kg.AFrameworkApplication.sa.updateCommandUI()};window.setTimeout(Qa,1E3)};Lf.prototype.Yre=function(F){var fa=new yk.a;fa.OKa=F.infoType;fa.id=F.id;fa.title=F.title;fa.description=F.description;fa.buttonText=F.buttonTxt;fa.Wga=F.buttonCallback;
fa.qcc=F.highPriority;fa.Tha=F.dismissCallback;fa.errorCode=F.errorCode;fa.J6e=F.iframeNotificationUrl;return fa};tl.Object.defineProperties(Lf.prototype,{Ahe:{configurable:!0,enumerable:!0,get:function(){return this.jCc||(this.jCc=OfficeExt.DefaultControlActionBinder.retrieveActionContext)},set:function(F){this.jCc=F}},HIg:{configurable:!0,enumerable:!0,get:function(){return this.j_d||(this.j_d=OfficeExt.DefaultControlActionBinder.retrieveAutoShowTaskPaneControlIdMap())}}});Object($d.a)(Lf,"AddinCommandsActionHandler",
null,[830]);Uf.prototype.MAh=function(F){if(void 0!==F&&null!==F&&F===Ni.a.DYg)F="ContextMenuCell";else return null;var fa=this.Sa.Lc();this.dAh(fa,F);return fa};Uf.prototype.dAh=function(F,fa){fa=this.AYg.vNh(fa);fa=yl(fa);for(var Qa=fa.next();!Qa.done;Qa=fa.next()){Qa=yl(Qa.value.controls);for(var Ab=Qa.next();!Ab.done;Ab=Qa.next())this.Rzh(F,Ab.value)}};Uf.prototype.Rzh=function(F,fa){var Qa=fa.hA[Sg.a.id],Ab=fa.hA[Sg.a.ATa],Cc=fa.hA[Sg.a.CTa],Vc="Image16by16",qd=fa.hA[Sg.a.efb];cj.c(Cc)&&(Vc=
"None");0<fa.menuItems.count?(Qa=this.Sa.Kv(Qa,Qa,Ab,798637440),Qa.sIb(Vc,Cc,null),this.KAh(Qa.menu,fa),Array.add(F.buttons,Qa)):Array.add(F.buttons,this.Sa.TGa(Qa,Ab,qd,Cc,Vc,null,!1))};Uf.prototype.KAh=function(F,fa){var Qa,Ab=this.Sa.Lc();fa=yl(fa.menuItems);for(Qa=fa.next();!Qa.done;Qa=fa.next()){var Cc=Qa.value;Qa=Cc.RQ[Sg.a.id];var Vc=Cc.RQ[Sg.a.ATa],qd=Cc.RQ[Sg.a.CTa],Gd="Image16by16";Cc=Cc.RQ[Sg.a.efb];cj.c(qd)&&(Gd="None");Qa=this.Sa.TGa(Qa,Vc,Cc,qd,Gd,null,!1);Array.add(Ab.buttons,Qa)}Array.add(F.yc,
Ab)};Object($d.a)(Uf,"AddInCommandsContextMenuExtensibilityHandler",null,[900]);var V=b(1001);Object($d.a)(ae,"AddinStatusCommandValues",null,[]);re.XVi=function(F){var fa=new ae;fa.Bi=F.PXa;fa.visible=fa.Bi?!0:!1;return fa};re.Qvc=function(F,fa,Qa,Ab,Cc){var Vc=document.getElementById(Qa);Vc?re.Qsj(F,fa,Vc,Ab,Cc):Se.ULS.sendTraceTag(17662423,220,100,String.format("{0} element is not availiable",Qa))};re.Qsj=function(F,fa,Qa,Ab,Cc){Qa?F.PXa===CommonUIStrings.l_ErrorLoadingAddInsTitle?ck.a.yrj(fa,
Qa,Ab,Cc):F.PXa===CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg&&ck.a.Vsj(fa,Qa):Se.ULS.sendTraceTag(543801756,220,100,String.format("addinLabelElement element is not available"))};Object($d.a)(re,"AddinCommandsStatusHandler",null,[]);var va=b(219),jb=Fj.a;vm(je,jb);je.prototype.iq=function(F){this.addHandler("LAC",F)};je.prototype.zq=function(F){this.removeHandler("LAC",F)};je.prototype.Jr=function(F,fa){var Qa=this;if("QueryAddinLabel"!==F)return!1;fa[V.a.LabelText]!==this.ZA.PXa&&
(F=re.XVi(this.ZA),fa[V.a.LabelText]=F.Bi,fa[V.a.Visible]=F.visible,window.setTimeout(function(){Qa.Qvc()},0));return!0};je.prototype.gn=function(){return!0};je.prototype.Qvc=function(){this.$&&re.Qvc(this.ZA,this.$.domElement,this.Sxj,Fe.a.instance.ea(331),Fe.a.instance.ea(332))};je.prototype.dispose=function(){this.$.fa.kk(this.Zc);this.ZA.F3i(this.n2e);this.agaveCommandManager&&(this.agaveCommandManager.T4i(this.hwe),this.agaveCommandManager=null);this.statusBarManager&&(this.statusBarManager.iF(this),
this.statusBarManager=null);this.ZA=this.$=null;jb.prototype.dispose.call(this)};Object($d.a)(je,"AddinCommandsStatusBarManager",Fj.a,[281,233]);var ac=b(1291),Kc=b(116),cd=b(144);rd.prototype.setErrorMessageForAddin=function(F,fa){this.NXa||(this.NXa={});this.NXa[F]=fa};rd.prototype.jWe=function(F){return this.NXa&&F in this.NXa?this.NXa[F]:null};Object($d.a)(rd,"AddinCommandsErrorManager",null,[]);var zc=b(325),Mc=b(94);Object($d.a)(Yd,"AddinCommandsListLoaderContext",null,[]);var ld=b(951);Object($d.a)(ge,
"AppsForOfficeEntitlementQueryInfo",null,[]);var Nd=Sys.EventArgs;vm(mb,Nd);Object($d.a)(mb,"AddinCommandsEntitlementsRetrievedEventArgs",Sys.EventArgs,[]);Nb.prototype.F8c=function(F){var fa=new Sys.StringBuilder(this.aHb);fa.append("RoamingServiceHandler.ashx?action=");fa.append("getAddinTeachingCalloutSettings");fa.append("&");fa.append(this.ked(F));fa.append("&");fa.append(kg.AFrameworkApplication.hj);kg.AFrameworkApplication.Hd.Ul(fa.toString(),1,null,null,!0,2,Object(Ri.a)(this,this.SJa,"getRequestSuccessCallback"),
Object(Ri.a)(this,this.fja,"getRequestFailureCallback"),null)};Nb.prototype.G8c=function(F){var fa=new Sys.StringBuilder(this.aHb);fa.append("RoamingServiceHandler.ashx?action=");fa.append("saveAddinTeachingCalloutSettings");fa.append("&");fa.append(kg.AFrameworkApplication.hj);fa=fa.toString();F=Gh.c(F);kg.AFrameworkApplication.Hd.Ul(fa,2,F,null,!0,4,null,Object(Ri.a)(this,this.JOa,"postRequestFailureCallback"),null)};Nb.prototype.SJa=function(F){var fa=!1,Qa=null;try{if(0<F.data.fe.length){var Ab=
Object(Wi.a)(Object,Gh.a(F.data.fe)),Cc=Ab?Ab[this.appName]:null;Cc&&(Qa=Object(Wi.a)(Object,Gh.a(Cc.toString())))}fa=!0}catch(Vc){this.fja(null)}fa&&this.xhb&&this.xhb(Qa)};Nb.prototype.fja=function(F){this.thb&&this.thb(F?F.data:null)};Nb.prototype.JOa=function(F){this.Fjb&&this.Fjb(F?F.data:null)};Nb.prototype.ked=function(F){for(var fa=new Sys.StringBuilder("requestedsettings="),Qa=0;Qa<F.count;Qa++)fa.append(F.na(Qa)),Qa<F.count-1&&fa.append(";");return fa.toString()};Object($d.a)(Nb,"AddinTeachingUIRoamingRequestHandler",
null,[]);Object($d.a)(nc,"MiniAddinInfo",null,[]);var Ud=Sys.EventArgs;vm(ib,Ud);Object($d.a)(ib,"ShowTeachingCalloutForContentAddinEventArgs",Sys.EventArgs,[]);var Oe=b(940);id.prototype.dzg=function(F){this.Ma.addHandler(Lg.a.fYb,F)};id.prototype.zCg=function(F){this.Ma.addHandler(Lg.a.ZZf,F)};id.prototype.WFj=function(F){var fa=this;null!==F&&(this.context.y_=F[Lg.a.l2],this.context.Fm=F[Lg.a.bJ],this.context.tyc=this.context.Qoc=0,F=Lg.a.iFa in F?F[Lg.a.iFa]:0,-1!==this.context.y_&&this.context.Fm&&
(this.context.gra=new Oe.a,this.context.X1a=new Oe.a,this.context.V1b=new Oe.a,this.context.QTc=this.hDg.createAddinDataProvider(zd(this.context.y_),this.contextActivationMgr),this.context.QTc?this.context.QTc.getEntitlementsAsync(this.contextActivationMgr.Yba,!0,F,function(Qa){fa.CGi(Qa)}):Se.ULS.sendTraceTag(17638145,220,10,"Create AddinDataProvider fails for {0}",this.context.y_)))};id.prototype.CGi=function(F){var fa=this;if(F&&0<F.length){this.context.tyc=F.length;for(var Qa=0;Qa<F.length;Qa++){var Ab=
F[Qa];if(!Ab||1!==Ab.targetType&&-1!==Ab.targetType)this.Owd();else{var Cc={};Cc.marketplaceId=Ab.solutionId;Cc.marketplaceVersion=Ab.version;Cc.storeType=Ab.storeType;Cc.storeId=Ab.storeId;Cc.targetData=Ab;this.contextActivationMgr.isAddinCommandsAsync(Cc,function(Vc,qd,Gd){Vc?(qd&&fa.context.gra.add(Gd.targetData),10===fa.context.y_&&(Vc=Gd.targetData,qd=Vc.targetType,kg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.PropertiesForTeachingUIOfPrivateCatelogEnabled",
!1)&&!cj.c(Gd.targetTypeForExp)&&(qd=Gd.targetTypeForExp,Vc.targetType=qd),kg.AFrameworkApplication.ga.isChangeGateEnabled("TelemetryFixForTeachingUIOnPrivateCatelogEnabled")&&fa.context.X1a.add(Vc),kg.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:5837059_TeachingUIForPrivateCatelogOnContentAddinEnabled")&&0===qd&&fa.context.V1b.add(Vc))):Se.ULS.sendTraceTag(542978528,220,15,"Checking AddinCommands fails for {0} from {1}",Telemetry.PrivacyRules.GetAssetId(Gd.targetData.storeType,Gd.targetData.storeId,
Gd.targetData.assetId),Gd.targetData.storeType);fa.Owd()})}}}else this.Owd()};id.prototype.Owd=function(){var F;(F=this.context).Qoc=F.Qoc+1;this.context.Qoc>=this.context.tyc&&(this.eYb.BLd(this.context.y_,!1),0<this.context.tyc&&10===this.context.y_&&("Excel"===this.appName||"PowerPoint"===this.appName||"Word"===this.appName)?(kg.AFrameworkApplication.ga.isChangeGateEnabled("TelemetryFixForTeachingUIOnPrivateCatelogEnabled")&&this.Xli(),kg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",
!1)?this.tCh(this.context.gra):this.iXb(this.context.gra)):this.iXb(this.context.gra))};id.prototype.iXb=function(F){var fa=new Ph.a;if(F){F=yl(this.context.gra);for(var Qa=F.next();!Qa.done;Qa=F.next())fa.add(jd(Qa.value))}this.context.gra&&1>this.context.gra.count&&ld.a.Fdb(Lg.a.ymb,"false",this.context.y_);F={};fa=(F.ack2=fa,F);fa[Lg.a.l2]=this.context.y_;fa[Lg.a.bJ]=this.context.Fm;this.Ma.raiseEvent(Lg.a.fYb,new mb(fa),this)};id.prototype.rRf=function(F){if(this.appName){var fa={},Qa={};Qa.LastTeachingUIShowTime=
(new Date).toUTCString();Qa.AddinHasShown=F;fa[this.appName]=Gh.c(Qa);this.BOb&&(this.BOb.G8c(fa),Se.ULS.sendTraceTag(539530527,306,50,"Initiating call to save addin teaching callout setting for current user from Roaming Settings Service"))}else Se.ULS.sendTraceTag(539530528,306,10,"Fail to save roaming service since AppName is null")};id.prototype.tCh=function(F){if(this.sga=F)F=new Ph.a,F.add(this.appName),this.BOb=new Nb(this.appName,Object(Ri.a)(this,this.SJa,"getRequestSuccessCallback"),Object(Ri.a)(this,
this.fja,"getRequestFailureCallback"),Object(Ri.a)(this,this.JOa,"postRequestFailureCallback")),this.BOb.F8c(F);else{F=new Ph.a;var fa={};F=(fa.ack2=F,fa);F[Lg.a.l2]=this.context.y_;F[Lg.a.bJ]=this.context.Fm;this.Ma.raiseEvent(Lg.a.fYb,new mb(F),this)}};id.prototype.SJa=function(F){F?this.zqj(F)?(Se.ULS.sendTraceTag(527523845,306,50,"should show teaching UI"),this.Xca="AddinHasShown"in F&&F.AddinHasShown?F.AddinHasShown.toString():null,this.xye()):(Se.ULS.sendTraceTag(538248466,306,50,"Not Show TeachingUI this time"),
this.iXb(this.sga)):(Se.ULS.sendTraceTag(527523844,306,50,"userSettings is null"),this.Xca=null,this.xye())};id.prototype.fja=function(F){Se.ULS.sendTraceTag(539530529,306,10,"GET data from Roaming Settings Service with status: {0}, fallback",F?F.httpStatus:-1);this.iXb(this.sga)};id.prototype.JOa=function(F){Se.ULS.sendTraceTag(539530530,306,10,"failed to POST data to Roaming Settings Service with status: {0}",F?F.httpStatus:-1)};id.prototype.xye=function(){if(kg.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:5837059_TeachingUIForPrivateCatelogOnContentAddinEnabled")){var F=
this.v$g();0===F.targetType?(F.assetId?(this.nVc=F.assetId,this.TVi()):this.sif("NoAssetId"),F.addinId&&this.rRf(this.Xca?this.Xca+","+F.addinId:F.addinId),this.sSc(null)):this.sSc(F.addinId);Se.ULS.sendTraceTag(528023563,306,50,"Show teaching callout for: {0}",F.addinId)}else F=this.u$g(),this.sSc(F),Se.ULS.sendTraceTag(538248464,306,50,"Show teaching callout for taskpane addin: {0}",F)};id.prototype.TVi=function(){var F=this,fa=new ge;fa.callbackFunc=function(Qa){if(Qa.errorCode)F.sif("FailToGetAppDetails");
else if(Qa.value){Qa=yl(Qa.value);for(var Ab=Qa.next();!Ab.done;Ab=Qa.next()){Ab=Ab.value;var Cc=Ab[1];if(Cc===F.nVc){Qa={solutionId:Cc,assetId:Cc};Qa.storeType=Ab[6];Qa.storeId=Ab[11];Qa.assetStoreId=Ab[6];Qa.targetType=Ab[3];Qa.width=Ab[7];Qa.height=Ab[8];Qa.displayName=Ab[0];Qa.version=Ab[4];Qa=new ib(Qa);F.Ma.raiseEvent(Lg.a.ZZf,Qa);break}}}};fa.storeType=OSF.StoreTypeEnum.PrivateCatalog;fa.fromInsertDialog=!1;fa.refresh=!0;this.contextActivationMgr.queryEntitlementDetails(fa)};id.prototype.zqj=
function(F){if("LastTeachingUIShowTime"in F){if(F=+new Date-+new Date(F.LastTeachingUIShowTime.toString()),F<kg.AFrameworkApplication.ga.lQ("AddinShowTeachingUIIntervalInMS",864E5))return Se.ULS.sendTraceTag(538248467,306,50,"ShouldShowTeachingUI: False, Teaching callout is shown {0}MS ago",F),!1}else Se.ULS.sendTraceTag(527523846,306,50,"userSetting has no date key");return!0};id.prototype.u$g=function(){for(var F=new zc.a("",0),fa=new zc.a("",0),Qa=0,Ab=0,Cc=0,Vc=yl(this.sga),qd=Vc.next();!qd.done;qd=
Vc.next())if(qd=qd.value,!("excatalog"!==qd.storeType||cj.c(qd.installTimeInMS)||!qd.installTimeInMS||qd.installTimeInMS<=kg.AFrameworkApplication.ga.lQ("DateTimeInMSForNewAddin",16409664E5))){var Gd=this.abd(qd);if(this.Xca){var ve=this.Xca.split(",");if(0<ve.length&&Array.contains(ve,Gd)){Cc++;Se.ULS.sendTraceTag(538817694,306,50,"This addin has shown teaching UI before");continue}}Gd.startsWith("private_")?(F.value<qd.installTimeInMS&&(F=new zc.a(Gd,qd.installTimeInMS)),Ab++):(fa.value<qd.installTimeInMS&&
(fa=new zc.a(Gd,qd.installTimeInMS)),Qa++)}Se.ULS.sendTraceTag(538817695,306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",Ab,Qa,Cc);return 0<fa.value?fa.key:0<F.value?F.key:null};id.prototype.v$g=function(){var F=new zc.a(new nc,0),fa=new zc.a(new nc,0),Qa=0,Ab=0,Cc=0,Vc=this.sga;if(0<this.context.V1b.count)for(var qd=yl(this.context.V1b),Gd=qd.next();!Gd.done;Gd=qd.next())Vc.add(Gd.value);Vc=yl(Vc);for(qd=Vc.next();!qd.done;qd=Vc.next())if(qd=
qd.value,!("excatalog"!==qd.storeType||cj.c(qd.installTimeInMS)||!qd.installTimeInMS||qd.installTimeInMS<=kg.AFrameworkApplication.ga.lQ("DateTimeInMSForNewAddin",16409664E5))){Gd=this.abd(qd);if(this.Xca){var ve=this.Xca.split(",");if(0<ve.length&&Array.contains(ve,Gd)){Cc++;Se.ULS.sendTraceTag(528345032,306,50,"This addin has shown teaching UI before");continue}}Gd.startsWith("private_")?(F.value<qd.installTimeInMS&&(F=new zc.a(Object.assign(new nc,{addinId:Gd,targetType:qd.targetType,assetId:qd.assetId}),
qd.installTimeInMS)),Ab++):(fa.value<qd.installTimeInMS&&(fa=new zc.a(Object.assign(new nc,{addinId:Gd,targetType:qd.targetType,assetId:qd.assetId}),qd.installTimeInMS)),Qa++)}Se.ULS.sendTraceTag(528345033,306,50,"Number of New CD addins for this user: Private:{0}, Store:{1}. Addin has shown teachingUI:{2}",Ab,Qa,Cc);return 0<fa.value?fa.key:0<F.value?F.key:Object.assign(new nc,{addinId:null,targetType:-1,assetId:null})};id.prototype.sSc=function(F){for(var fa=new Ph.a,Qa=yl(this.sga),Ab=Qa.next();!Ab.done;Ab=
Qa.next()){var Cc=Ab.value;Ab=jd(Cc);F&&(Cc=this.abd(Cc),F===Cc&&(Ab.showCallout=!0,this.rRf(this.Xca?this.Xca+","+F:F)));fa.add(Ab)}this.sga&&1>this.sga.count&&ld.a.Fdb(Lg.a.ymb,"false",this.context.y_);F={};fa=(F.ack2=fa,F);fa[Lg.a.l2]=this.context.y_;fa[Lg.a.bJ]=this.context.Fm;this.Ma.raiseEvent(Lg.a.fYb,new mb(fa),this)};id.prototype.abd=function(F){return Telemetry.PrivacyRules.IsPrivateAddin(F.storeType,F.storeId,F.assetId)?"private_"+F.installTimeInMS:F.assetId};id.prototype.Xli=function(){if(!(this.context.X1a&&
1>this.context.X1a.count))if(this.eYb.mci()){var F=this.eYb.JOh();F?(F=this.wVe(this.context.X1a,F),Se.ULS.sendTraceTag(527523848,306,50,"detect new addins using localStorage")):(F=this.wVe(this.context.X1a,null),Se.ULS.sendTraceTag(527523847,306,50,"no data from cache"));this.eYb.tkj(F)}else Se.ULS.sendTraceTag(528589915,306,50,"Local storage got disabled")};id.prototype.wVe=function(F,fa){var Qa={},Ab=!1;F=yl(F);for(var Cc=F.next();!Cc.done;Cc=F.next()){Cc=Cc.value;var Vc=Telemetry.PrivacyRules.GetAssetId(Cc.storeType,
Cc.storeId,Cc.assetId);Vc&&(!fa||Vc in fa||(this.Xwa(Cc,Vc),Se.ULS.sendTraceTag(527523849,306,50,"New addin detected,log to AppInstall")),"private"===Vc.toLowerCase()?Ab||(Ab=!0,Qa[Vc]=null):Qa[Vc]=null)}return Qa};id.prototype.Xwa=function(F,fa){var Qa=F.installTimeInMS?(new Date(F.installTimeInMS)).toISOString():"",Ab={};Qa=(Ab["SDX.Id"]=fa,Ab["SDX.AppInstallOrigin"]="Organization",Ab["SDX.TargetType"]=F.targetType,Ab["SDX.AdminDeploymentTime"]=Qa,Ab);Vh.a.sendTelemetryEvent(Object.assign(new ui.a,
{name:"Office.Extensibility.Host.AppInstall",dataFields:Kc.a.Fk(Qa)}));1===F.targetType&&(F={},fa=(F["SDX.Id"]=fa,F["SDX.AppInstallOrigin"]="Organization",F["SDX.CommandPlacement"]="Ribbon",F),Vh.a.sendTelemetryEvent(Object.assign(new ui.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:Kc.a.Fk(fa)})))};id.prototype.sif=function(F){var fa={};F=(fa.AppTeachingUICalloutAction=F,fa["SDX.Id"]=this.nVc,fa.AppTeachingUICalloutGoal="NewAdminDeployment",fa["SDX.AppInstallOrigin"]="Organization",fa);
Vh.a.sendTelemetryEvent(Object.assign(new ui.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kc.a.Fk(F)}))};Object($d.a)(id,"AddInCommandsListLoader",null,[]);gb.prototype.insertOsfControl=function(F){return this.Yba.insertOsfControl(F)};gb.prototype.getManifestInvaildErrorString=function(){return this.Yba.getManifestInvaildErrorString()};gb.prototype.isAddinCommandsAsync=function(F,fa){this.Yba.isAddinCommandsAsync(F,fa)};gb.prototype.ownerAddinControlRecreated=function(F,fa){this.Yba.ownerAddinControlRecreated(F,
fa)};gb.prototype.queryEntitlementDetails=function(F){this.Yba.queryEntitlementDetails(F)};tl.Object.defineProperties(gb.prototype,{Yba:{configurable:!0,enumerable:!0,get:function(){return this.Oog}}});Object($d.a)(gb,"ContextActivationMgrWrapper",null,[828]);wc.prototype.createAddinDataProvider=function(F,fa){return OfficeExt.AddinDataProviderFactory.createAddinDataProvider(F,fa.Yba)};tl.Object.defineProperties(wc,{instance:{configurable:!0,enumerable:!0,get:function(){wc.Na||(wc.Na=new wc);return wc.Na}}});
wc.Na=null;Object($d.a)(wc,"OSFAddinDataProviderFactory",null,[827]);Object($d.a)(ed,"CacheItem",null,[]);oc.prototype.jl=function(F){kg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)&&Se.ULS.sendTraceTag(526989510,220,15,"GetCacheItem");var fa=this.wDa.getItem(F);if(fa){var Qa=new ed;try{Qa=Sys.Serialization.JavaScriptSerializer.deserialize(fa,!0)}catch(Ab){return this.wDa.removeItem(F),null}return Qa.Data?Qa.Data:Qa.data}return null};oc.prototype.$ya=
function(F){kg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)&&Se.ULS.sendTraceTag(526989512,220,15,"RemoveCacheItem");this.wDa.removeItem(F)};Object($d.a)(oc,"AppsDataCacheManager",null,[800]);var of=b(952);Jf.prototype.BLd=function(F,fa){F=Lg.a.DWe()+F;of.a.instance.setItem(F,fa.toString())};Jf.prototype.JOh=function(){var F=Lg.a.BZe();Se.ULS.sendTraceTag(527523850,306,50,"set cache key:{0}",F);F=of.a.instance.getItem(F);return Gh.a(F)};
Jf.prototype.tkj=function(F){var fa=Lg.a.BZe();Se.ULS.sendTraceTag(527523851,306,50,"get cache key:{0}",fa);of.a.instance.setItem(fa,Gh.c(F))};Jf.prototype.mci=function(){return!!of.a.instance.localStorage};tl.Object.defineProperties(Jf,{instance:{configurable:!0,enumerable:!0,get:function(){Jf.Na||(Jf.Na=new Jf);return Jf.Na}}});Jf.Na=null;Object($d.a)(Jf,"AddInCommandsCacheManager",null,[831]);var Nf=Sys.EventArgs;vm(Ce,Nf);Object($d.a)(Ce,"InsertionParamEventArgs",Sys.EventArgs,[]);Object($d.a)(Pd,
"PostLaunchAddinCommandsParameters",null,[]);Ad.prototype.vwg=function(){window.addEventListener?(window.addEventListener("LaunchAddinTaskpane",Object(Ri.a)(this,this.pGi,"onLaunchButtonClickedEventHandler"),!0),window.addEventListener("DismissCallout",Object(Ri.a)(this,this.MBi,"onDismissButtonClickedEventHandler"),!0),window.addEventListener("CloseCallout",Object(Ri.a)(this,this.sAi,"onCloseButtonClickedEventHandler"),!0)):Se.ULS.sendTraceTag(539353218,306,15,"AddEventListenerForTeachingCallout failed to get Window")};
Ad.prototype.pGi=function(){var F=this,fa={};fa=(fa.AppTeachingUICalloutAction="ClickOnLaunch",fa["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.q8.storeType,this.q8.storeId,this.q8.assetId),fa.AppTeachingUICalloutGoal="NewAdminDeployment",fa["SDX.AppInstallOrigin"]="Organization",fa);Vh.a.sendTelemetryEvent(Object.assign(new ui.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kc.a.Fk(fa)}));this.EZd?appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(this.EZd,function(){var Qa=
new Ce;Qa.Fg=F.q8;F.Ya.raiseEvent(Lg.a.Ugf,Qa)}):Se.ULS.sendTraceTag(539353219,306,10,"onLaunchButtonClickedEventHandler failed to get a valid addinObj")};Ad.prototype.sAi=function(){var F={};F=(F.AppTeachingUICalloutAction="ClickOnClose",F["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.q8.storeType,this.q8.storeId,this.q8.assetId),F.AppTeachingUICalloutGoal="NewAdminDeployment",F["SDX.AppInstallOrigin"]="Organization",F);Vh.a.sendTelemetryEvent(Object.assign(new ui.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:Kc.a.Fk(F)}))};Ad.prototype.MBi=function(){var F={};F=(F.AppTeachingUICalloutAction="ClickOnDismiss",F["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.q8.storeType,this.q8.storeId,this.q8.assetId),F.AppTeachingUICalloutGoal="NewAdminDeployment",F["SDX.AppInstallOrigin"]="Organization",F);Vh.a.sendTelemetryEvent(Object.assign(new ui.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kc.a.Fk(F)}))};Object($d.a)(Ad,"PrivateCatalogTeachingCalloutHandler",null,[]);pe.prototype.kga=
function(F,fa){this.F5d.kga(F,void 0===fa?null:fa);this.I7d=F};pe.prototype.N$a=function(F){this.F5d.N$a(F)};tl.Object.defineProperties(pe.prototype,{kba:{configurable:!0,enumerable:!0,get:function(){return this.I7d}}});Object($d.a)(pe,"RibbonExtensibilityManagerWithChangeDetection",null,[865]);var Kf=b(942);de.prototype.kga=function(F,fa){fa=void 0===fa?null:fa;if(F=Kf.a.htb(F)){appChrome.addInApi.dispatchActionsToInstallAddIn(F,fa);fa=yl(F.tabs);for(var Qa=fa.next();!Qa.done;Qa=fa.next())if(Qa.value.autoFocus){appChrome.addInApi.dispatchActionsToSwitchToTabForAddIn(F,
function(){});break}}};de.prototype.N$a=function(F){(F=Kf.a.htb(F))&&appChrome.addInApi.dispatchActionsToRemoveAddIn(F)};Object($d.a)(de,"OneLineRibbonExtensibilityManager",null,[865]);var zg=b(1013);Vd.mXe=function(F){var fa=new Ph.a;if(Vd.kye)for(var Qa=yl(Vd.kye),Ab=Qa.next();!Ab.done;Ab=Qa.next())fa.add(Ab.value);Ab=null;switch(F){case "Workbook":Ab=Vd.EPj;break;case "Document":Ab=Vd.Ech;break;case "Presentation":Ab=Vd.LTi}if(Ab)for(F=yl(Ab),Ab=F.next();!Ab.done;Ab=F.next())fa.add(Ab.value);return fa};
Vd.kye=["PrimaryCommandSurface","ContextMenu"];Vd.EPj=null;Vd.Ech=null;Vd.LTi=null;Object($d.a)(Vd,"ExtensionPointType",null,[]);tl.Object.defineProperties(Qd.prototype,{DBb:{configurable:!0,enumerable:!0,get:function(){return this.K$d||(this.K$d=new Ph.a)}},Gme:{configurable:!0,enumerable:!0,get:function(){return this.ggg}}});Object($d.a)(Qd,"ContextMenuExtensibility",null,[839]);bc.prototype.wTe=function(){for(var F=new Sys.StringBuilder,fa=yl(this.OX),Qa=fa.next();!Qa.done;Qa=fa.next())F.append(Qa.value.l7());
return this.Wxg(F.toString())};bc.prototype.Wxg=function(F){var fa=new Sys.StringBuilder;fa.append("<Ribbon><Tabs>");fa.append(F);fa.append("</Tabs></Ribbon>");return fa.toString()};tl.Object.defineProperties(bc.prototype,{tabs:{configurable:!0,enumerable:!0,get:function(){return this.OX}},pK:{configurable:!0,enumerable:!0,get:function(){return this.Hog}},startedNode:{configurable:!0,enumerable:!0,get:function(){return this.bsg}},d9a:{configurable:!0,enumerable:!0,get:function(){return this.ljb}},
HBh:{configurable:!0,enumerable:!0,get:function(){return this.Jkg}}});Object($d.a)(bc,"RibbonExtensibility",null,[891]);Je.prototype.createActionContext=function(F,fa){F={};F.ownerAddinInfo=this.entitlement;F.action=fa;return F};tl.Object.defineProperties(Je.prototype,{entitlement:{configurable:!0,enumerable:!0,get:function(){return this.Ijg}}});Object($d.a)(Je,"AddInCommandsContextProvider",null,[]);od.prototype.M0g=function(F){return new Je(F)};od.prototype.createActionBuilder=function(F,fa){return OfficeExt.DefaultControlActionBinder.createActionBuilder(F,
fa.entitlement,fa.manifest)};od.prototype.startApplyAddin=function(F){this.DZd=F;var fa=this.M0g(F);this.actionBuilder=this.createActionBuilder(fa,F)};od.prototype.endApplyAddin=function(){};od.prototype.Lad=function(F,fa,Qa){Qa=void 0===Qa?0:Qa;return this.ribbonBuilder.vxc&&0<this.ribbonBuilder.vxc.count||this.ribbonBuilder.fq&&0<this.ribbonBuilder.fq.count?new bc(this.ribbonBuilder.vxc,this.WAh(F,fa),this.dme.startedNode,this.ribbonBuilder.y5.KNh(),Qa):null};od.prototype.TSe=function(){var F=void 0===
F?null:F;if(this.contextMenuBuilder.vjc&&0<this.contextMenuBuilder.vjc.count){F||(F=this.dme.entitlement.solutionId);F=new Qd(F);for(var fa=yl(this.contextMenuBuilder.vjc),Qa=fa.next();!Qa.done;Qa=fa.next())F.DBb.add(Qa.value);return F}return null};od.prototype.WAh=function(F,fa){return this.ribbonBuilder.fq&&0<this.ribbonBuilder.fq.count?new Kf.a(this.ribbonBuilder.fq,F,fa):null};tl.Object.defineProperties(od.prototype,{dme:{configurable:!0,enumerable:!0,get:function(){return this.DZd}}});Object($d.a)(od,
"AddinCommandsBuilder",null,[]);Xd.prototype.BMa=function(F,fa,Qa,Ab,Cc,Vc,qd){function Gd(Qg,ph,Nh,Fh){Cc(Qg,ph,Nh,Fh);Qg=zg.a[ve.Fm]+ph.assetId;Nh=ve.Bda.Ec(Qg);ph=Nh.value;Nh.returnValue&&(ph.stop(),ve.Bda.remove(Qg))}var ve=this;if(this.Fm&&F)for(Se.ULS.sendTraceTag(17326351,220,50,"Addin count {0}.",F.count),4===this.Fm&&(Se.ULS.sendTraceTag(17586256,220,100,String.format("Refresh AddinCommands for dataprovider : {0}",Ab)),this.qTg(F,Ab),Vc()),F=yl(F),Ab=F.next();!Ab.done;Ab=F.next())if(Ab=Ab.value,
Ab.solutionId=Ab.solutionId||Ab.assetId,Ab.storeType=Ab.storeType||Ab.currentStoreType,Ab.version=Ab.version||Ab.appVersion,Se.ULS.sendTraceTag(17638144,220,50,String.format("{0}: Install addin {1}",this.hl.xx,Telemetry.PrivacyRules.GetAssetId(Ab.storeType,Ab.storeId,Ab.solutionId))),this.TWd(Ab))if(qd&&Ab.requireConsent)qd(Ab,function(Qg){try{if(ve.fI){var ph=zg.a[ve.Fm]+Qg.solutionId,Nh=ve.fI.Fc("ComponentAttach",ph);ve.Bda.ia(ph,Nh)}var Fh=ve.ZA.L3(Qg.storeType,Qg.solutionId);6!==ve.Fm&&(Fh&&(ve.J0b(Fh),
Fh.Ps.purge(!1)),ve.Gi.insertOsfControl(ve.zEb(Qg,fa,Qa,Gd)),Fh&&ve.Gi.ownerAddinControlRecreated(Qg.solutionId,Qg.storeType))}catch(Zh){Se.ULS.sendTraceTag(572839882,220,10,String.format("{0}: AddinCommands SolutionId={1} Version={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",ve.hl.xx,Telemetry.PrivacyRules.GetAssetId(Qg.storeType,Qg.storeId,Qg.solutionId),Qg.version,Qg.storeType,Qg.storeId,Zh.message)),Gd(!1,Qg,null,null)}});else try{if(this.fI){var jf=zg.a[this.Fm]+Ab.solutionId,
gf=this.fI.Fc("ComponentAttach",jf);this.Bda.ia(jf,gf)}var qg=this.ZA.L3(Ab.storeType,Ab.solutionId);6!==this.Fm&&(qg&&(this.J0b(qg),qg.Ps.purge(!1)),this.Gi.insertOsfControl(this.zEb(Ab,fa,Qa,Gd)),qg&&this.Gi.ownerAddinControlRecreated(Ab.solutionId,Ab.storeType))}catch(Qg){Se.ULS.sendTraceTag(17388185,220,10,String.format("{0}: AddinCommands SolutionId={1} AppVersion={2} StoreType={3} StoreId={4} failed to install. Error message : {5}.",this.hl.xx,Telemetry.PrivacyRules.GetAssetId(Ab.storeType,
Ab.storeId,Ab.solutionId),Ab.version,Ab.storeType,Ab.storeId,Qg.message)),Gd(!1,Ab,null,null)}else Gd(!1,Ab,null,null)};Xd.prototype.wji=function(F,fa,Qa,Ab,Cc,Vc){var qd=this;if(kg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)){var Gd=function(Fh,Zh,ki,gj){Vc(Fh,Zh,ki,gj);Fh=zg.a[qd.Fm]+Zh.solutionId;ki=qd.Bda.Ec(Fh);Zh=ki.value;ki.returnValue&&(Zh.stop(),qd.Bda.remove(Fh))};if(6===this.Fm&&F)if(F.solutionId=F.solutionId||F.assetId,F.storeType=
F.storeType||F.currentStoreType,F.version=F.version||F.appVersion,Se.ULS.sendTraceTag(592290762,220,50,String.format("{0}: Install dynamic ribbon {1}",this.hl.xx,Telemetry.PrivacyRules.GetAssetId(F.storeType,F.storeId,F.solutionId))),this.TWd(F))try{if(this.fI){var ve=zg.a[this.Fm]+F.solutionId,jf=this.fI.Fc("ComponentAttach",ve);this.Bda.ia(ve,jf)}var gf=this.ZA.L3(F.storeType,F.solutionId);gf||Gd(!1,F,null,null);kg.AFrameworkApplication.sa&&kg.AFrameworkApplication.sa.Pa.delayInstallAddInIsEnabled?
this.g9b(F,fa,Ab,Cc,Qa,function(Fh){Gd(Fh,F,Qa,gf.displayName)}):(this.g9b(F,fa,Ab,Cc,Qa),Gd(!0,F,Qa,gf.displayName))}catch(Fh){Se.ULS.sendTraceTag(592290764,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",this.hl.xx,Telemetry.PrivacyRules.GetAssetId(F.storeType,F.storeId,F.solutionId),F.version,F.storeType,F.storeId,Fh.message)),Gd(!1,F,null,null)}else Gd(!1,F,null,null)}else{var qg=function(Fh,
Zh,ki,gj){Vc(Fh,Zh,ki,gj);Fh=zg.a[qd.Fm]+Zh.assetId;ki=qd.Bda.Ec(Fh);Zh=ki.value;ki.returnValue&&(Zh.stop(),qd.Bda.remove(Fh))};if(6===this.Fm&&F)if(F.solutionId=F.solutionId||F.assetId,F.storeType=F.storeType||F.currentStoreType,F.version=F.version||F.appVersion,Se.ULS.sendTraceTag(527279813,220,50,String.format("{0}: Install dynamic ribbon {1}",this.hl.xx,Telemetry.PrivacyRules.GetAssetId(F.storeType,F.storeId,F.solutionId))),this.TWd(F))try{if(this.fI){var Qg=zg.a[this.Fm]+F.assetId,ph=this.fI.Fc("ComponentAttach",
Qg);this.Bda.ia(Qg,ph)}var Nh=this.ZA.L3(F.currentStoreType,F.id);Nh||qg(!1,F,null,null);kg.AFrameworkApplication.sa&&kg.AFrameworkApplication.sa.Pa.delayInstallAddInIsEnabled?this.g9b(F,fa,Ab,Cc,Qa,function(Fh){qg(Fh,F,Qa,Nh.displayName)}):(this.g9b(F,fa,Ab,Cc,Qa),qg(!0,F,Qa,Nh.displayName))}catch(Fh){Se.ULS.sendTraceTag(527279815,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to launch dynamic commands. Error message : {5}.",this.hl.xx,Telemetry.PrivacyRules.GetAssetId(F.currentStoreType,
F.storeId,F.assetId),F.appVersion,F.currentStoreType,F.storeId,Fh.message)),qg(!1,F,null,null)}else qg(!1,F,null,null)}};Xd.prototype.Ayi=function(F,fa,Qa,Ab,Cc,Vc){if(kg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1))if(Vc)if(Vc._isAddinCommandsManifest(this.hl.xx))try{kg.AFrameworkApplication.sa&&kg.AFrameworkApplication.sa.Pa.delayInstallAddInIsEnabled?this.f9b(F,fa,Qa,Cc,Vc,function(qd){Ab(qd,F,Vc,Vc.getDefaultDisplayName())}):(this.f9b(F,
fa,Qa,Cc,Vc),Ab(!0,F,Vc,Vc.getDefaultDisplayName()))}catch(qd){Se.ULS.sendTraceTag(17586257,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.hl.xx,Telemetry.PrivacyRules.GetAssetId(F.storeType,F.storeId,F.solutionId),F.version,F.storeType,F.storeId,qd.message)),Ab(!1,F,Vc,Vc.getDefaultDisplayName())}else Se.ULS.sendTraceTag(17586258,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",
this.hl.xx,Telemetry.PrivacyRules.GetAssetId(F.storeType,F.storeId,F.solutionId),F.version,F.storeType,F.storeId)),Ab(!1,F,null,null);else Se.ULS.sendTraceTag(17586259,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",this.hl.xx,Telemetry.PrivacyRules.GetAssetId(F.storeType,F.storeId,F.solutionId),F.version,F.storeType,F.storeId)),Ab(!1,F,null,null);else if(Vc)if(Vc._isAddinCommandsManifest(this.hl.xx))try{kg.AFrameworkApplication.sa&&
kg.AFrameworkApplication.sa.Pa.delayInstallAddInIsEnabled?this.f9b(F,fa,Qa,Cc,Vc,function(qd){Ab(qd,F,Vc,Vc.getDefaultDisplayName())}):(this.f9b(F,fa,Qa,Cc,Vc),Ab(!0,F,Vc,Vc.getDefaultDisplayName()))}catch(qd){Se.ULS.sendTraceTag(527279818,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to generate ui extensibility. Error message : {5}.",this.hl.xx,Telemetry.PrivacyRules.GetAssetId(F.currentStoreType,F.storeId,F.assetId),F.appVersion,F.currentStoreType,
F.storeId,qd.message)),Ab(!1,F,Vc,Vc.getDefaultDisplayName())}else Se.ULS.sendTraceTag(527279819,220,10,String.format("{0}: Regular content/taskpane addin AssetId={1} AppVersion={2} StoreType={3} StoreId={4} is not supported for addincommands.",this.hl.xx,Telemetry.PrivacyRules.GetAssetId(F.currentStoreType,F.storeId,F.assetId),F.appVersion,F.currentStoreType,F.storeId)),Ab(!1,F,null,null);else Se.ULS.sendTraceTag(527279820,220,10,String.format("{0}: AddinCommands AssetId={1} AppVersion={2} StoreType={3} StoreId={4} failed to get manifest.",
this.hl.xx,Telemetry.PrivacyRules.GetAssetId(F.currentStoreType,F.storeId,F.assetId),F.appVersion,F.currentStoreType,F.storeId)),Ab(!1,F,null,null)};Xd.prototype.zEb=function(F,fa,Qa,Ab){var Cc=this,Vc={},qd=document.createElement("div");qd.setAttribute("visible","false");Vc.div=qd;Vc.id=F.solutionId||F.id;Vc.solutionId=F.solutionId||F.id;Vc.version=F.version||F.appVersion;Vc.storeType=F.storeType||F.currentStoreType;Vc.storeId=F.storeId;Vc.assetId=F.assetId;Vc.assetStoreId=F.assetStoreId;Vc.isvirtualOsfControl=
!0;Vc.virtualOsfControlActivationCallback=function(Gd,ve){var jf=Cc.ZA.L3(F.storeType||F.currentStoreType,F.solutionId||F.id);jf&&(jf.isUpgraded&&(F.isUpgraded=!0),Cc.J0b(jf));Cc.Ayi(F,fa,Qa,Ab,Gd,ve)};Vc.reason=3===this.Fm?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.DocumentOpened;Vc.marketplaceID=F.id;Vc.marketplaceVersion=F.appVersion;Vc.store=F.storeId;return Vc};Xd.prototype.f9b=function(F,fa,Qa,Ab,Cc,Vc){Vc=void 0===Vc?null:
Vc;var qd={};qd.solutionId=Ab.getSolutionId();qd.version=Ab.getVersion();qd.storeType=Ab.getStoreType();qd.storeId=Ab.getStoreId();qd.assetId=Ab.getSolutionId();qd.assetStoreId=Ab.getAssetStoreId();qd.targetType=Ab.getOsfControlType();qd.appVersion=Ab.getMarketplaceVersion();var Gd=null,ve=null;if(kg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1))Gd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.hl.xx,this.hl.formFactor)).parseExtensions(qd,
Cc,this.tga),ve=Vd.mXe(this.hl.xx);else try{Gd=(new OfficeExt.Parser.AddinCommandsManifestParser(this.hl.xx,this.hl.formFactor)).parseExtensions(qd,Cc,this.tga),ve=Vd.mXe(this.hl.xx)}catch(Ji){throw Se.ULS.sendTraceTag(538752131,220,10,"Exception encounter while parsing manifest. Exception: "+Ji.message),Ji;}if(ve&&0<ve.count){if(kg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFGenerateUIExtensibilityParseBuildLoggingKill",!1)){var jf=fa(F);var gf=Qa(F);Qa=!!kg.AFrameworkApplication.ga&&
kg.AFrameworkApplication.ga.ra("AddinCommandsMultipleCustomTabsEnabled");jf=new od(jf,null,gf);ve=yl(ve);for(gf=ve.next();!gf.done;gf=ve.next())jf.commandSurface=gf.value,Gd.apply(jf,this.tga,Qa)}else try{var qg=fa(F),Qg=Qa(F),ph=!!kg.AFrameworkApplication.ga&&kg.AFrameworkApplication.ga.ra("AddinCommandsMultipleCustomTabsEnabled");jf=new od(qg,null,Qg);var Nh=yl(ve);for(gf=Nh.next();!gf.done;gf=Nh.next())jf.commandSurface=gf.value,Gd.apply(jf,this.tga,ph)}catch(Ji){throw Se.ULS.sendTraceTag(538752132,
220,10,"Exception encounter while building ribbon. Exception: "+Ji.message),Ji;}if(OSF.OUtil.checkFlight(14))try{var Fh=jf.Lad(F.solutionId||F.id,Cc.getDefaultDisplayName()),Zh=jf.TSe();Fh&&this.ribbonManager.kga(Fh,Vc);Zh&&this.contextMenuManager.Tie(Zh);this.ZA.tje(Ab,Fh,Zh,Cc.getDefaultDisplayName());Se.ULS.sendTraceTag(17326353,220,100,"Add-in name: {0}.",Cc.getDefaultDisplayName())}catch(Ji){throw OfficeExt.DevConsole.log(Ji),Se.ULS.sendTraceTag(539870850,220,10,"Error generating ribbon extensibility. Exception: "+
Ji.message),Ji;}else try{var ki=jf.Lad(F.solutionId||F.id,Cc.getDefaultDisplayName()),gj=jf.TSe();ki&&this.ribbonManager.kga(ki);gj&&this.contextMenuManager.Tie(gj);this.ZA.tje(Ab,ki,gj,Cc.getDefaultDisplayName());Se.ULS.sendTraceTag(579376721,220,100,"Add-in name: {0}.",Cc.getDefaultDisplayName())}catch(Ji){throw Se.ULS.sendTraceTag(539870851,220,10,"Error generating ribbon extensibility. Exception: "+Ji.message),Ji;}}};Xd.prototype.g9b=function(F,fa,Qa,Ab,Cc,Vc){Vc=void 0===Vc?null:Vc;var qd={};
qd.solutionId=F.solutionId||F.assetId;qd.version=F.version||F.appVersion;qd.storeType=F.storeType||F.currentStoreType;qd.storeId=F.assetStoreId;qd.assetId=F.assetId;qd.assetStoreId=F.assetStoreId;qd.targetType=F.targetType;qd.appVersion=F.appVersion;var Gd=new OfficeExt.JsonParser.AddinCommandsJsonParser(this.hl.xx,this.hl.formFactor);try{var ve=fa.getManifest(),jf=Gd.parse(qd,ve,Cc,this.tga,fa.getSharedRuntimeId()),gf=Qa(F),qg=Ab(F),Qg=new od(gf,null,qg);Qg.commandSurface="PrimaryCommandSurface";
jf.apply(Qg,this.tga,!0);if(Qg.ribbonBuilder.fq&&0<Qg.ribbonBuilder.fq.count){var ph=Qg.Lad(F.solutionId||F.id,fa.getManifest().getDefaultDisplayName(),1);kg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.RibbonExtensibilityNullCheckKillSwitch",!1)?this.ribbonManager.kga(ph,Vc):ph&&this.ribbonManager.kga(ph,Vc);this.ZA.lxg(fa,ph,Cc,fa.getManifest().getDefaultDisplayName());Se.ULS.sendTraceTag(592290767,220,100,"Add-in name: {0}.",fa.getManifest().getDefaultDisplayName())}}catch(Nh){Se.ULS.sendTraceTag(592290768,
220,15,"Failed to generate dynamic Add-in commands. Add-in name: {0}. Error: {1}",fa.getManifest().getDefaultDisplayName(),Nh.toString()),OSF.OUtil.checkFlight(14)&&OfficeExt.DevConsole.log(Nh)}};Xd.prototype.J0b=function(F){F.nl&&this.ribbonManager.N$a(F.nl);F.Gpb&&this.contextMenuManager.y2i(F.Gpb);kg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?this.ZA.VKf(F.Ps.getStoreType(),F.Ps.getSolutionId()):this.ZA.VKf(F.Ps.getStoreType(),F.Ps.getMarketplaceID())};
Xd.prototype.qTg=function(F,fa){fa=zd(fa);for(var Qa=yl(this.ZA.TKa),Ab=Qa.next();!Ab.done;Ab=Qa.next())if(Ab=Ab.value,Ab.Ps.getStoreType()===fa){for(var Cc=!0,Vc=yl(F),qd=Vc.next();!qd.done;qd=Vc.next())if((qd=qd.value)&&Ab.udf(qd.storeType||qd.currentStoreType,qd.solutionId||qd.id)){Cc=!1;break}Cc&&(this.J0b(Ab),Ab.Ps.purge(!1))}};Xd.prototype.TWd=function(F){F.solutionId!==F.assetId&&Se.ULS.sendTraceTag(540379092,220,50,"VerifyInsertAgaveParameter solutionId != AssetId");F.id!==F.assetId&&Se.ULS.sendTraceTag(540379093,
220,50,"VerifyInsertAgaveParameter Id != AssetId");return!!F&&!!F.solutionId&&!!F.version&&!!F.storeType&&!!F.storeId};Object($d.a)(Xd,"AddInCommandsIntegration",null,[]);var uh=b(862);Jd.prototype.ezg=function(F){this.Ya.addHandler(Lg.a.cme,F)};Jd.prototype.YAg=function(F){this.Ya.addHandler(Lg.a.Ugf,F)};Jd.prototype.yCg=function(F){this.Ya.addHandler(Lg.a.b_f,F)};Jd.prototype.kzg=function(F){this.Ya.addHandler(Lg.a.MVc,F)};Jd.prototype.BMa=function(F,fa,Qa){var Ab=this,Cc=Qa[Lg.a.hFa],Vc=void 0===
Qa[Lg.a.bJ]?0:Qa[Lg.a.bJ];if(Cc&&Vc)if(0>=Cc.count&&4!==Vc)this.koc(new Pd(Vc,null,null,F,fa,null,!0));else{var qd=Cc.count,Gd=new pe(new Of(F));Qa=void 0===Qa[Lg.a.l2]?-1:Qa[Lg.a.l2];(new Xd(Vc,this.Ml,this.zoa,Gd,this.m1d,this.Q8,this.V0)).BMa(Cc,function(ve){return kg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?Ab.Lqa.ese(ve.solutionId,Ab.V0,Ab.zoa):Ab.Lqa.ese(ve.assetId,Ab.V0,Ab.zoa)},function(ve){return kg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",
!1)?Ab.Lqa.h_b(ve.solutionId):Ab.Lqa.h_b(ve.assetId)},Qa,function(ve,jf,gf,qg){qd--;gf=new Pd(Vc,jf,Gd,F,fa,qg,0>=qd);ve&&jf?Ab.koc(gf):(Ab.wpa&&(3===Vc||jf&&jf.isUpgraded)&&(ve="",jf&&(ve=kg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?Telemetry.PrivacyRules.GetAssetId(jf.storeType,jf.storeId,jf.solutionId):Telemetry.PrivacyRules.GetAssetId(jf.currentStoreType,jf.storeId,jf.assetId)),jf={},jf=(jf.SDX_AppInstallOrigin="User",jf.SDX_IsAutoLaunchEnabled=
Ab.r8,jf.SDX_AppInstallErrorCode="onAddinCompleted.fail",jf.SDX_Id=ve,jf),Vh.a.sendTelemetryEvent(Object.assign(new ui.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Kc.a.Fk(jf)}))),Ab.joc(gf))},function(){Ab.qBb();0>=Cc.count&&4===Vc&&Ab.Q8.auc()},this.P$d)}else this.wpa&&(Qa={},Qa=(Qa.SDX_AppInstallOrigin="User",Qa.SDX_IsAutoLaunchEnabled=this.r8,Qa.SDX_AppInstallErrorCode="LaunchAddinCommands.fail",Qa.SDX_Id="",Qa),Vh.a.sendTelemetryEvent(Object.assign(new ui.a,{name:"Office.Extensibility.Host.AppInstall",
dataFields:Kc.a.Fk(Qa)}))),Se.ULS.sendTraceTag(17638115,220,10,String.format("{0}: parameters are invalid for LaunchAddinCommands.",this.zoa.xx)),this.joc(new Pd(Vc,null,null,F,fa,null,!0))};Jd.prototype.Nji=function(F,fa,Qa){var Ab=this,Cc=Qa[Lg.a.hFa],Vc=void 0===Qa[Lg.a.bJ]?0:Qa[Lg.a.bJ];if(Cc&&Vc)if(0>=Cc.count&&4!==Vc)this.koc(new Pd(Vc,null,null,null,fa,null,!0));else{var qd=Cc.count,Gd=new pe(new de),ve=void 0===Qa[Lg.a.l2]?-1:Qa[Lg.a.l2],jf=new Xd(Vc,this.Ml,this.zoa,Gd,this.m1d,this.Q8,this.V0),
gf=function(Fh){return kg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?Ab.Lqa.Zre(Fh.solutionId,Ab.V0,Ab.zoa,F):Ab.Lqa.Zre(Fh.assetId,Ab.V0,Ab.zoa,F)},qg=function(Fh){return kg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?Ab.Lqa.h_b(Fh.solutionId):Ab.Lqa.h_b(Fh.assetId)},Qg=function(Fh,Zh,ki){qd--;ki=new Pd(Vc,Zh,Gd,null,fa,ki,0>=qd);Fh&&Zh?Ab.koc(ki):(Ab.wpa&&(3===Vc||Zh&&Zh.isUpgraded)&&
(Fh="",Zh&&(Fh=kg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?Telemetry.PrivacyRules.GetAssetId(Zh.storeType,Zh.storeId,Zh.solutionId):Telemetry.PrivacyRules.GetAssetId(Zh.currentStoreType,Zh.storeId,Zh.assetId)),Zh={},Zh=(Zh.SDX_AppInstallOrigin="User",Zh.SDX_IsAutoLaunchEnabled=Ab.r8,Zh.SDX_AppInstallErrorCode="onAddinCompletedBase.fail",Zh.SDX_Id=Fh,Zh),Vh.a.sendTelemetryEvent(Object.assign(new ui.a,{name:"Office.Extensibility.Host.AppInstall",
dataFields:Kc.a.Fk(Zh)}))),Ab.joc(ki));qd||kg.AFrameworkApplication.sa.updateCommandUI()},ph=function(Fh,Zh,ki,gj){Qg(Fh,Zh,gj)},Nh=function(){Ab.qBb();0>=Cc.count&&4===Vc&&Ab.Q8.auc()};6===Vc?(ve=Qa[Lg.a.$Ha],Qa=Qa[Lg.a.aIa],jf.wji(Cc.na(0),ve,Qa,gf,qg,function(Fh,Zh,ki,gj){Qg(Fh,Zh,gj)})):jf.BMa(Cc,gf,qg,ve,ph,Nh,this.P$d)}else this.wpa&&(jf={},jf=(jf.SDX_AppInstallOrigin="User",jf.SDX_IsAutoLaunchEnabled=this.r8,jf.SDX_AppInstallErrorCode="LaunchOneLineRibbonAddinCommands.fail",jf.SDX_Id="",jf),
Vh.a.sendTelemetryEvent(Object.assign(new ui.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Kc.a.Fk(jf)}))),Se.ULS.sendTraceTag(24786637,220,10,String.format("{0}: parameters are invalid for LaunchOnlineAddinCommands.",this.zoa.xx)),this.joc(new Pd(Vc,null,null,null,fa,null,!0))};Jd.prototype.joc=function(F){this.qBb(F);this.T_f(!1,F)};Jd.prototype.koc=function(F){if(kg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)){var fa=F.Fg,
Qa=null;null!==fa&&(Qa=fa.storeType||fa.currentStoreType,Qa=Qa.toLowerCase());if(this.wpa&&fa&&"omex"===fa.storeType&&F&&(3===F.Fm||fa.isUpgraded)){var Ab={};Ab=(Ab.SDX_AppInstallOrigin="User",Ab.SDX_IsAutoLaunchEnabled=this.r8,Ab.SDX_AppInstallErrorCode="0",Ab.SDX_Id=Telemetry.PrivacyRules.GetAssetId(Qa,fa.storeId,fa.solutionId),Ab);Vh.a.sendTelemetryEvent(Object.assign(new ui.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Kc.a.Fk(Ab)}))}this.qBb(F);this.see&&fa&&"omex"===fa.storeType&&
3===F.Fm&&"hardcodedpreinstall"!==Qa&&(Ab=new Ce,Ab.Fg=fa,this.Ya.raiseEvent(Lg.a.VZf,Ab));this.r8&&fa&&"omex"===fa.storeType&&F.wR&&(3===F.Fm&&"hardcodedpreinstall"!==Qa||fa.isUpgraded)&&(Ab=new Ce,Ab.Fg=fa,Ab.nl=F.wR.kba,this.Ya.raiseEvent(Lg.a.MVc,Ab));fa&&(Jf.instance.BLd(Lc(Qa),!0),"uploadfiledevcatalog"===Qa&&(Ab=this.CZd.createAddinDataProvider(Qa,this.Ml))&&Ab.localCacheAddinCommands(this.Ml.Yba,fa.solutionId||fa.id,fa.version||fa.appVersion,fa.storeId),this.eSf(F.wR.kba,Qa,F.Fm,F.kad),ld.a.Fdb(Lg.a.ymb,
"true",Lc(Qa)))}else fa=F.Fg,this.wpa&&fa&&"omex"===fa.storeType&&F&&(3===F.Fm||fa.isUpgraded)&&(Qa={},Qa=(Qa.SDX_AppInstallOrigin="User",Qa.SDX_IsAutoLaunchEnabled=this.r8,Qa.SDX_AppInstallErrorCode="0",Qa.SDX_Id=Telemetry.PrivacyRules.GetAssetId(fa.currentStoreType,fa.storeId,fa.assetId),Qa),Vh.a.sendTelemetryEvent(Object.assign(new ui.a,{name:"Office.Extensibility.Host.AppInstall",dataFields:Kc.a.Fk(Qa)}))),this.qBb(F),this.see&&fa&&"omex"===fa.storeType&&3===F.Fm&&"hardcodedpreinstall"!==fa.currentStoreType&&
(Qa=new Ce,Qa.Fg=fa,this.Ya.raiseEvent(Lg.a.VZf,Qa)),this.r8&&fa&&"omex"===fa.storeType&&F.wR&&(3===F.Fm&&"hardcodedpreinstall"!==fa.currentStoreType||fa.isUpgraded)&&(Qa=new Ce,Qa.Fg=fa,Qa.nl=F.wR.kba,this.Ya.raiseEvent(Lg.a.MVc,Qa)),fa&&(Jf.instance.BLd(Lc(fa.currentStoreType.toLowerCase()),!0),"uploadfiledevcatalog"===fa.currentStoreType.toLowerCase()&&(Qa=this.CZd.createAddinDataProvider(fa.currentStoreType.toLowerCase(),this.Ml))&&Qa.localCacheAddinCommands(this.Ml.Yba,fa.solutionId||fa.id,fa.version||
fa.appVersion,fa.storeId),this.eSf(F.wR.kba,fa.currentStoreType,F.Fm,F.kad),ld.a.Fdb(Lg.a.ymb,"true",Lc(fa.currentStoreType.toLowerCase())));this.T_f(!0,F)};Jd.prototype.T_f=function(F,fa){if(F)if(kg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)&&fa.wR&&5===fa.Fm&&fa.wR.kba&&void 0!==fa.Fg.showCallout&&null!==fa.Fg.showCallout&&fa.Fg.showCallout)(new Ad(this.Ya,fa.Fg,Kf.a.htb(fa.wR.kba))).vwg(),F=new Ce,F.nl=fa.wR.kba,F.Fg=fa.Fg,
this.Ya.raiseEvent(Lg.a.b_f,F);else if(3!==fa.Fm)fa.Yff&&this.Q8.auc();else{if(fa.wR&&fa.wR.kba)if(F=Object(Wi.a)(uh.Ribbon,fa.kad),kg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)){if("hardcodedpreinstall"!==fa.Fg.storeType){var Qa=!1;this.r8&&(Qa=fa.Fg.isAutoLaunched);ck.a.$Zf(F,fa.pSe,fa.displayName,fa.wR.kba,Qa)}}else"hardcodedpreinstall"!==fa.Fg.currentStoreType&&(Qa=!1,this.r8&&(Qa=fa.Fg.isAutoLaunched),ck.a.$Zf(F,fa.pSe,fa.displayName,
fa.wR.kba,Qa))}else 3===fa.Fm?kg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?fa.Fg&&"uploadfiledevcatalog"===fa.Fg.storeType.toLowerCase()?(fa=this.V0.jWe(fa.Fg.solutionId),ck.a.Bvc(fa?fa:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):this.Q8.XLd():fa.Fg&&"uploadfiledevcatalog"===fa.Fg.currentStoreType.toLowerCase()?(fa=this.V0.jWe(fa.Fg.assetId),ck.a.Bvc(fa?fa:CommonUIStrings.l_InternalError+" "+CommonUIStrings.l_InternalError_Directive)):
this.Q8.XLd():fa.Yff&&this.Q8.auc()};Jd.prototype.qBb=function(F){var fa=(F=void 0===F?null:F)?F.Fg:null,Qa=new Ce;if(Qa.Fg=fa){var Ab=6===F.Fm?1:0;kg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?(Ab=this.Q8.L3(fa.storeType||fa.currentStoreType,fa.solutionId||fa.id,Ab))&&Ab.nl&&(Qa.nl=Ab.nl,this.wpa&&3===F.Fm&&"hardcodedpreinstall"!==fa.storeType)&&(F="",Ab.nl.pK&&Ab.nl.pK.fq&&(Ab=Ab.nl.pK.fq.na(0))&&(F=Ab.id),Ab={},fa=(Ab.SDX_CommandPlacement=
F,Ab.SDX_PinningAction="Pinning",Ab.SDX_PinningActionErrorCode="0",Ab.SDX_Id=Telemetry.PrivacyRules.GetAssetId(fa.storeType,fa.storeId,fa.solutionId),Ab),Vh.a.sendTelemetryEvent(Object.assign(new ui.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:Kc.a.Fk(fa)}))):(Ab=this.Q8.L3(fa.storeType||fa.currentStoreType,fa.solutionId||fa.id,Ab))&&Ab.nl&&(Qa.nl=Ab.nl,this.wpa&&3===F.Fm&&"hardcodedpreinstall"!==fa.currentStoreType)&&(F="",Ab.nl.pK&&Ab.nl.pK.fq&&(Ab=Ab.nl.pK.fq.na(0))&&(F=Ab.id),Ab=
{},fa=(Ab.SDX_CommandPlacement=F,Ab.SDX_PinningAction="Pinning",Ab.SDX_PinningActionErrorCode="0",Ab.SDX_Id=Telemetry.PrivacyRules.GetAssetId(fa.currentStoreType,fa.storeId,fa.assetId),Ab),Vh.a.sendTelemetryEvent(Object.assign(new ui.a,{name:"Office.Extensibility.Host.AppPinning",dataFields:Kc.a.Fk(fa)})))}this.Ya.raiseEvent(Lg.a.cme,Qa)};Jd.prototype.eSf=function(F,fa,Qa,Ab){Ab=Object(Wi.a)(uh.Ribbon,Ab);F&&Ab&&(F=F.tabs.na(0).XRa[Sg.a.id],3===Qa&&"hardcodedpreinstall"!==fa&&Ab.GKd(F),Ab.$ei(F)&&
Ab.Icj())};Object($d.a)(Jd,"LaunchAddinCommandsHandler",null,[838]);b(914);b(892);ad.prototype.l7=function(){return uf.k(this.p1d,this.psi(),this.hA)};ad.prototype.psi=function(){var F=null;if(this.hfa){F=new Sys.StringBuilder('<Menu><MenuSection DisplayMode="Menu16"><Controls>');for(var fa=yl(this.hfa),Qa=fa.next();!Qa.done;Qa=fa.next())F.append(Qa.value.l7());F.append("</Controls></MenuSection></Menu>")}return F?F.toString():""};tl.Object.defineProperties(ad.prototype,{id:{configurable:!0,enumerable:!0,
get:function(){return this._id||""}},hA:{configurable:!0,enumerable:!0,get:function(){return this.n1d||(this.n1d={})}},controlType:{configurable:!0,enumerable:!0,get:function(){return this.p1d||""}},menuItems:{configurable:!0,enumerable:!0,get:function(){return this.hfa||(this.hfa=new Ph.a)}}});Object($d.a)(ad,"ControlDefinition",null,[835]);Ac.prototype.l7=function(){return uf.k(Sg.a.button,null,this.lLc)};tl.Object.defineProperties(Ac.prototype,{RQ:{configurable:!0,enumerable:!0,get:function(){return this.lLc||
(this.lLc={})}},id:{configurable:!0,enumerable:!0,get:function(){return this._id||""}}});Object($d.a)(Ac,"MenuItemDefinition",null,[880]);cc.prototype.l7=function(){var F=null;if(this.Z7){F=new Sys.StringBuilder;for(var fa=yl(this.Z7),Qa=fa.next();!Qa.done;Qa=fa.next())F.append(Qa.value.l7())}return F?F.toString():""};tl.Object.defineProperties(cc.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}},controls:{configurable:!0,enumerable:!0,get:function(){return this.Z7||(this.Z7=
new Ph.a)}}});Object($d.a)(cc,"OfficeMenuDefinition",null,[834]);var Jh=b(29);pb.prototype.addButton=function(F){Se.ULS.sendTraceTag(17085952,220,50,"ContextMenu button actiontype: {0}.",F.actionType);this.zI=new ad(this.nP(F.id),Sg.a.button);this.zI.hA[Sg.a.kOb]=F.label;this.zI.hA[Sg.a.ATa]=F.label;this.zI.hA[Sg.a.CTa]=F.icon["16"];this.Dra(this.zI.hA[Sg.a.id],F.action);this.Z1(this.zI.hA);this.oUa.controls.add(this.zI);this.zI=null};pb.prototype.startBuildMenu=function(F){if(cj.c(this.oUa))this.oUa=
new cc(F.id);else{var fa=this.nP(F.id);this.zI=new ad(fa,Sg.a.O3);this.Qga(this.zI.hA,F);this.zI.hA[Sg.a.CTa]=F.icon["16"];this.zI.hA[Sg.a.efb]=Jh.a.alwaysEnabled}};pb.prototype.addMenuItem=function(F){Se.ULS.sendTraceTag(17085953,220,50,"ContextMenu menu item actiontype: {0}.",F.actionType);var fa=new Ac(this.nP(F.id));this.Qga(fa.RQ,F);F.icon&&(fa.RQ[Sg.a.CTa]=F.icon["16"]);this.Dra(fa.RQ[Sg.a.id],F.action);this.Z1(fa.RQ);this.zI.menuItems.add(fa)};pb.prototype.endBuildMenu=function(){cj.c(this.zI)?
(this.vjc.add(this.oUa),this.oUa=null):(this.oUa.controls.add(this.zI),this.zI=null)};pb.prototype.Dra=function(F,fa){this.qlb.bindAction(F,fa)};pb.prototype.Z1=function(F){this.zGa.Z1(F)};pb.prototype.nP=function(F){return this.y5.wua(F)};pb.prototype.Qga=function(F,fa){F[Sg.a.kOb]=fa.label;F[Sg.a.ATa]=fa.label};tl.Object.defineProperties(pb.prototype,{y5:{configurable:!0,enumerable:!0,get:function(){return this.Yib}},zGa:{configurable:!0,enumerable:!0,get:function(){return this.yea}},qlb:{configurable:!0,
enumerable:!0,get:function(){return this.oea}},vjc:{configurable:!0,enumerable:!0,get:function(){return this.Ung}}});Object($d.a)(pb,"ContextMenuExtensibilityCreator",null,[867,861]);za.prototype.wua=function(F){return this.tNa+F};tl.Object.defineProperties(za.prototype,{tNa:{configurable:!0,enumerable:!0,get:function(){return this.LDa}}});Object($d.a)(za,"DefaultContextMenuNamingProvider",null,[866]);uc.prototype.ZFh=function(F){return this.SYg+F};tl.Object.defineProperties(uc.prototype,{PAj:{configurable:!0,
enumerable:!0,get:function(){return this.Tsg}},SYg:{configurable:!0,enumerable:!0,get:function(){return this.Gig}}});Object($d.a)(uc,"DefaultRibbonGroupTemplate",null,[879]);tl.Object.defineProperties(Ic.prototype,{Wcb:{configurable:!0,enumerable:!0,get:function(){return this.Rkb}}});Object($d.a)(Ic,"DefaultRibbonGroupTemplateResolver",null,[862]);var ci=b(1292);Jb.prototype.bindAction=function(F,fa){OfficeExt.DefaultControlActionBinder.bindAction(F,fa)};Object($d.a)(Jb,"DefaultUIControlActionBinder",
null,[863]);Zb.prototype.Z1=function(F){F[Sg.a.efb]=this.command};tl.Object.defineProperties(Zb.prototype,{command:{configurable:!0,enumerable:!0,get:function(){return this.jCa}}});Object($d.a)(Zb,"DefaultUIControlCommandBinder",null,[864]);var Gi=b(31);Object($d.a)(db,"AddInControl",null,[]);Object($d.a)(Ba,"AddInGroup",null,[]);Object($d.a)(Wa,"AddInMenuItem",null,[]);Object($d.a)(Za,"AddInTab",null,[]);dc.prototype.startBuildTab=function(F){var fa=F.isOfficeTab?F.id:this.y5.efd(F.id),Qa=F.isOfficeTab?
null:F.label;this.qv=Object.assign(new Za,{id:fa,title:Qa,isOfficeTab:F.isOfficeTab,visible:F.visible,groups:[],tabType:F.tabType,insertBefore:F.insertBefore,insertAfter:F.insertAfter,autoFocus:F.autoFocus})};dc.prototype.startBuildGroup=function(F){var fa=this.nP(F.id);this.Ew=Object.assign(new Ba,{id:fa,mlrId:F.mlrId,title:F.label,controls:[],groupType:0})};dc.prototype.addNativeGroup=function(F){this.Ew=Object.assign(new Ba,{id:F.id,mlrId:F.mlrId,title:F.label,controls:[],groupType:1});this.qv.groups.push(this.Ew)};
dc.prototype.addButton=function(F){var fa=this.nP(F.id);fa&&(this.Dra(fa,F.action),Se.ULS.sendTraceTag(24786640,220,50,"AddInDataTransferObject button actiontype: {0}.",F.actionType),F=Object.assign(new db,{id:fa,title:F.label,iconLocation:this.$cd(F),enabled:F.enabled,controlType:0,attributes:this.Qga()}),this.r3d.Fie(new Gi.a(fa,this.zGa.command.toString())),this.Ew.controls.push(F))};dc.prototype.addNativeControl=function(F){F.id&&(Se.ULS.sendTraceTag(590709920,220,50,"AddInDataTransferObject button actiontype: {0}.",
F.actionType),F=Object.assign(new db,{id:F.id,title:"",iconLocation:"",enabled:F.enabled,controlType:2,attributes:this.Qga()}),this.Ew.controls.push(F))};dc.prototype.startBuildMenu=function(F){var fa=this.nP(F.id);fa&&(this.a8=Object.assign(new db,{id:fa,title:F.label,iconLocation:this.$cd(F),controlType:1,attributes:{},menuItems:[]}))};dc.prototype.addMenuItem=function(F){var fa=this.nP(F.id);fa&&(this.Dra(fa,F.action),Se.ULS.sendTraceTag(24786642,220,50,"AddInDataTransferObject menu item actiontype: {0}.",
F.actionType),F=Object.assign(new Wa,{id:fa,title:F.label,iconLocation:this.$cd(F),enabled:F.enabled,attributes:this.Qga()}),this.r3d.Fie(new Gi.a(fa,this.zGa.command.toString())),this.a8.menuItems.push(F))};dc.prototype.endBuildMenu=function(){cj.c(this.a8.id)||this.Ew.controls.push(this.a8);this.a8=null};dc.prototype.endBuildGroup=function(){cj.c(this.Ew.id)||this.qv.groups.push(this.Ew);this.Ew=null};dc.prototype.endBuildTab=function(){cj.c(this.qv.id)||this.yOb.add(this.qv);this.qv=null};dc.prototype.Qga=
function(){var F={};this.Z1(F);return F};dc.prototype.$cd=function(F){return F.icon["80"]?F.icon["80"]:F.icon["32"]};dc.prototype.Z1=function(F){this.zGa.Z1(F)};dc.prototype.nP=function(F){return this.y5.wua(F)};dc.prototype.Dra=function(F,fa){this.qlb.bindAction(F,fa)};tl.Object.defineProperties(dc.prototype,{y5:{configurable:!0,enumerable:!0,get:function(){return this.Yib}},fq:{configurable:!0,enumerable:!0,get:function(){return this.yOb}},vxc:{configurable:!0,enumerable:!0,get:function(){return null}},
qlb:{configurable:!0,enumerable:!0,get:function(){return this.oea}},zGa:{configurable:!0,enumerable:!0,get:function(){return this.yea}}});Object($d.a)(dc,"OneLineRibbonExtensibilityCreator",null,[860,861]);Xb.prototype.l7=function(){for(var F=new Ph.a,fa=yl(this.Aha),Qa=fa.next();!Qa.done;Qa=fa.next())F.add(Qa.value.l7());F=uf.e.apply(null,[Sg.a.ffb,null].concat(F.toArray()));return uf.e(Sg.a.GROUP,this.ava,F)};tl.Object.defineProperties(Xb.prototype,{Wcb:{configurable:!0,enumerable:!0,get:function(){return this.Rkb},
set:function(F){this.Rkb=F;this.ava[Sg.a.pfg]=this.Rkb}},ava:{configurable:!0,enumerable:!0,get:function(){return this.t4d||(this.t4d={})}},Aha:{configurable:!0,enumerable:!0,get:function(){return this.o1d||(this.o1d=new Ph.a)}}});Object($d.a)(Xb,"GroupDefinition",null,[]);$a.prototype.l7=function(){for(var F=new Ph.a,fa=new Ph.a,Qa=yl(this.XJd),Ab=Qa.next();!Ab.done;Ab=Qa.next())F.add(Ab.value.l7());Qa=yl(this.KJ);for(Ab=Qa.next();!Ab.done;Ab=Qa.next())fa.add(Ab.value.l7());fa=this.lse(Sg.a.jOb,
this.k2e,fa.toArray());F=this.lse(Sg.a.XYd,this.hSf,F.toArray());return uf.e(Sg.a.nfg,this.XRa,F,fa)};$a.prototype.lse=function(F,fa,Qa){var Ab={};Ab[Sg.a.id]=fa;return uf.e.apply(null,[F,Ab].concat(Qa))};tl.Object.defineProperties($a.prototype,{tAa:{configurable:!0,enumerable:!0,get:function(){return this._id}},XRa:{configurable:!0,enumerable:!0,get:function(){return this.lfe||(this.lfe={})}},KJ:{configurable:!0,enumerable:!0,get:function(){return this.u4d||(this.u4d=new Ph.a)}},XJd:{configurable:!0,
enumerable:!0,get:function(){return this.lde||(this.lde=new Ph.a)}}});Object($d.a)($a,"TabDefinition",null,[]);kb.prototype.startBuildTab=function(F){F=F.isOfficeTab?this.y5.xNh(F.id):this.y5.efd(F.id);this.qv=new $a(F)};kb.prototype.startBuildGroup=function(F){F=this.nP(F.id);this.Ew=new Xb(F)};kb.prototype.addButton=function(F){var fa=this.nP(F.id);this.Dra(fa,F.action)};kb.prototype.startBuildMenu=function(){};kb.prototype.addMenuItem=function(F){var fa=this.nP(F.id);this.Dra(fa,F.action)};kb.prototype.endBuildMenu=
function(){};kb.prototype.endBuildGroup=function(){this.qv.KJ.add(this.Ew);this.Ew=null};kb.prototype.endBuildTab=function(){cj.c(this.qv.tAa)||this.pfe.add(this.qv);this.qv=null};kb.prototype.Dra=function(F,fa){this.qlb.bindAction(F,fa)};kb.prototype.nP=function(F){return this.y5.wua(F)};tl.Object.defineProperties(kb.prototype,{fq:{configurable:!0,enumerable:!0,get:function(){return null}},y5:{configurable:!0,enumerable:!0,get:function(){return this.Yib}},qlb:{configurable:!0,enumerable:!0,get:function(){return this.oea}},
vxc:{configurable:!0,enumerable:!0,get:function(){return this.pfe}}});Object($d.a)(kb,"RibbonExtensibilityCreatorBase",null,[860,861]);Ua.prototype.l7=function(){return uf.k(this.Qqg,null,this.V_)};tl.Object.defineProperties(Ua.prototype,{V_:{configurable:!0,enumerable:!0,get:function(){return this.kde||(this.kde={})}}});Object($d.a)(Ua,"ScalingDefinition",null,[]);vm(Ha,kb);Ha.prototype.startBuildTab=function(F){kb.prototype.startBuildTab.call(this,F);this.qv.isOfficeTab=F.isOfficeTab;if(!this.qv.isOfficeTab)this.qv.XRa[Sg.a.noa]=
this.c6b(F.label);else if(this.qv.tAa){var fa=this.y5.oLh(F.id);fa&&(this.qv.XRa[Sg.a.noa]=fa);(F=this.y5.mLh(F.id))&&(this.qv.XRa[Sg.a.Meg]=F)}F=this.qv.tAa;this.qv.hSf=F+"."+Sg.a.XYd;this.qv.k2e=F+"."+Sg.a.jOb};Ha.prototype.startBuildGroup=function(F){kb.prototype.startBuildGroup.call(this,F);this.Ew.ava[Sg.a.noa]=this.c6b(F.label)};Ha.prototype.addButton=function(F){kb.prototype.addButton.call(this,F);Se.ULS.sendTraceTag(17085954,220,50,"RibbonExtensibility button actiontype: {0}.",F.actionType);
var fa=this.vT(F,Sg.a.button);this.Z1(fa.hA);fa.hA[Sg.a.BTa]=F.enabled;this.Ew.Aha.add(fa)};Ha.prototype.startBuildMenu=function(F){this.a8=this.vT(F,Sg.a.O3)};Ha.prototype.addMenuItem=function(F){kb.prototype.addMenuItem.call(this,F);Se.ULS.sendTraceTag(17085955,220,50,"RibbonExtensibility menu item actiontype: {0}.",F.actionType);var fa=this.nP(F.id);fa=new Ac(fa);this.Qga(fa.RQ,F);this.Z1(fa.RQ);fa.RQ[Sg.a.BTa]=F.enabled;this.a8.menuItems.add(fa)};Ha.prototype.endBuildMenu=function(){this.Ew.Aha.add(this.a8);
this.a8=null};Ha.prototype.endBuildGroup=function(){this.UMg();this.qv.XJd.add(this.Bea);this.Eea&&(this.qv.XJd.add(this.Eea),this.Eea=null);this.Bea=null;kb.prototype.endBuildGroup.call(this)};Ha.prototype.Z1=function(F){this.zGa.Z1(F)};Ha.prototype.vT=function(F,fa){var Qa=this.nP(F.id);fa=new ad(Qa,fa);this.Qga(fa.hA,F);return fa};Ha.prototype.Qga=function(F,fa){F[Sg.a.kOb]=this.c6b(fa.label);F[Sg.a.ATa]=this.c6b(fa.label);F[Sg.a.CTa]=fa.icon["16"];F[Sg.a.Ieg]=fa.icon["32"]};Ha.prototype.UMg=function(){var F=
this.lWh.Wcb;this.Ew.Wcb=F.PAj;var fa=this.Ew.Aha.count;Se.ULS.sendTraceTag(17085956,220,50,"Control count: {0}.",fa);var Qa=this.Ew.ava[Sg.a.id];this.Bea=new Ua(Sg.a.SYd);this.Bea.V_[Sg.a.id]=Qa+".Scaling."+Sg.a.SYd;this.Bea.V_[Sg.a.MYd]=this.Ew.ava[Sg.a.id];2<fa&&(this.Eea=new Ua(Sg.a.WYd),this.Eea.V_[Sg.a.id]=Qa+".Scaling."+Sg.a.WYd,this.Eea.V_[Sg.a.MYd]=this.Ew.ava[Sg.a.id]);this.alj(fa,F)};Ha.prototype.alj=function(F,fa){var Qa=1;switch(F){case 1:case 2:this.Bea.V_[Sg.a.KBa]=Sg.a.LARGE;break;
case 3:this.Bea.V_[Sg.a.KBa]=Sg.a.LARGE;this.Eea.V_[Sg.a.KBa]=Sg.a.XBc;break;case 4:this.Bea.V_[Sg.a.KBa]=Sg.a.XBc+"TwoRow";this.Eea.V_[Sg.a.KBa]=Sg.a.SMALL+"TwoRow";break;case 5:case 6:this.Bea.V_[Sg.a.KBa]=Sg.a.XBc;this.Eea.V_[Sg.a.KBa]=Sg.a.SMALL;break;default:throw Se.ULS.sendTraceTag(9041819,220,10,"Addin commands does not support {0} controls.",F),this.V0.setErrorMessageForAddin(this.eDc,CommonUIStrings.l_AddinManifestInvalid_Message),Error.create(String.format("AddinManifestError: Addin commands does not support {0} controls",
F));}for(var Ab=yl(this.Ew.Aha),Cc=Ab.next();!Cc.done;Cc=Ab.next())Cc.value.hA[Sg.a.qfg]=fa.ZFh(Qa),Qa+=3!==F?1:2};Ha.prototype.c6b=function(F){return F?(F=Ea.a.replaceAll(F,"&","&amp;"),F=Ea.a.replaceAll(F,"'","&apos;"),F=Ea.a.replaceAll(F,'"',"&quot;"),F=Ea.a.replaceAll(F,">","&gt;"),F=Ea.a.replaceAll(F,"<","&lt;")):null};tl.Object.defineProperties(Ha.prototype,{lWh:{configurable:!0,enumerable:!0,get:function(){return this.jlg}},zGa:{configurable:!0,enumerable:!0,get:function(){return this.yea}}});
Object($d.a)(Ha,"RibbonExtensibilityCreator",kb,[]);Ga.prototype.h_b=function(F){F=new za(F);return new pb(F,this.yea,this.oea)};Ga.prototype.ese=function(F,fa,Qa){Qa=new ci.a(this.LDa,F,Qa,!0);var Ab=new Ic(this.LDa+"Ribbon.Templates.AddInCommandsControlGroup","addinControl");return new Ha(Qa,this.oea,this.yea,Ab,F,fa)};Ga.prototype.Zre=function(F,fa,Qa,Ab){Qa=new ci.a(this.LDa,F,Qa,!0);return new dc(Qa,this.oea,this.yea,F,fa,Ab)};Object($d.a)(Ga,"UIExtensibilityFactory",null,[826]);var Wh=b(950);
bb.prototype.D1i=function(F){this.Fo=F;window.addEventListener&&(window.addEventListener("LaunchContentAddin",Object(Ri.a)(this,this.qGi,"onLaunchButtonClicked_ContentAddin"),!0),window.addEventListener("DismissCallout",Object(Ri.a)(this,this.NBi,"onDismissButtonClicked_ContentAddin"),!0),window.addEventListener("CloseCallout",Object(Ri.a)(this,this.tAi,"onCloseButtonClicked_ContentAddin"),!0))};bb.prototype.led=function(F){return"[id="+F+"]"};bb.prototype.w0f=function(F,fa){var Qa=this;fa>kg.AFrameworkApplication.ga.zd("AddinMaxDOMElementDetectionTimesForTeachingUI",
10)?(window.clearTimeout(this.hqc),this.v0f("[data-unique-id='pivotOverflowButton']"),Se.ULS.sendTraceTag(537170692,220,50,"ShowTeachingCalloutWithPoll did not find the DOM element in time")):document.querySelector("button"+F)?this.v0f(F):this.hqc=window.setTimeout(function(){Qa.w0f(F,fa+1)},1E3)};bb.prototype.u0f=function(F){var fa=document.querySelector("button[data-unique-id='RightPaddle']");if(fa)F={},F=(F.AppTeachingUICalloutAction="RightPaddlePresent",F["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Fg.storeType,
this.Fg.storeId,this.Fg.assetId),F.AppTeachingUICalloutGoal="NewAdminDeployment",F["SDX.AppInstallOrigin"]="Organization",F),Vh.a.sendTelemetryEvent(Object.assign(new ui.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kc.a.Fk(F)}));else if(fa=document.querySelector("button"+F),!fa&&(fa=document.querySelector("button[id='RibbonOverflowMenu-overflow']"),!fa)){fa={};fa=(fa.AppTeachingUICalloutAction="NoAnchor",fa["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Fg.storeType,this.Fg.storeId,
this.Fg.assetId),fa.AppTeachingUICalloutGoal="NewAdminDeployment",fa["SDX.AppInstallOrigin"]="Organization",fa);Vh.a.sendTelemetryEvent(Object.assign(new ui.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kc.a.Fk(fa)}));Se.ULS.sendTraceTag(537170691,220,15,"ShowTeachingCallout failed to get an anchorElement");return}this.N6f(fa,"ShowTeachingUIForAddinButton")};bb.prototype.v0f=function(F){F=document.querySelector("button"+F);if(!F&&(F=document.querySelector("button[data-unique-id='pivotOverflowButton']"),
!F)){F={};F=(F.AppTeachingUICalloutAction="NoAnchor",F["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Fg.storeType,this.Fg.storeId,this.Fg.assetId),F.AppTeachingUICalloutGoal="NewAdminDeployment",F["SDX.AppInstallOrigin"]="Organization",F);Vh.a.sendTelemetryEvent(Object.assign(new ui.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kc.a.Fk(F)}));Se.ULS.sendTraceTag(537170690,220,15,"ShowTeachingCalloutToAddinTab failed to get an anchorElement");return}this.N6f(F,"ShowTeachingUIForAddinTab")};
bb.prototype.N6f=function(F,fa){F.setAttribute("lpp-id","latestAddin");var Qa=hh.a.instance.mc("Common.ISystemInitiatedFeedback");Qa&&F?(Qa.execute(function(Ab){Ab.logActivity(fa,null)}),F={},F=(F.AppTeachingUICalloutAction="Show",F["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Fg.storeType,this.Fg.storeId,this.Fg.assetId),F.AppTeachingUICalloutGoal="NewAdminDeployment",F["SDX.AppInstallOrigin"]="Organization",F),Vh.a.sendTelemetryEvent(Object.assign(new ui.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",
dataFields:Kc.a.Fk(F)})),Se.ULS.sendTraceTag(537170688,220,50,"ShowTeachingCalloutToAddinTab triggered an LPP activity")):(Se.ULS.sendTraceTag(537170689,220,15,"ShowTeachingCalloutToAddinTab failed to get a sifFuture"),F={},F=(F.AppTeachingUICalloutAction="NoSifFutureObject",F["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Fg.storeType,this.Fg.storeId,this.Fg.assetId),F.AppTeachingUICalloutGoal="NewAdminDeployment",F["SDX.AppInstallOrigin"]="Organization",F),Vh.a.sendTelemetryEvent(Object.assign(new ui.a,
{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kc.a.Fk(F)})))};bb.prototype.sCh=function(F){if(!F)return null;F=F.pK;if((null===F||void 0===F?0:F.fq)&&0<F.fq.count){F=yl(F.fq);for(var fa=F.next();!fa.done;fa=F.next())if(fa=fa.value,fa.groups&&0<fa.groups.length){fa=yl(fa.groups);for(var Qa=fa.next();!Qa.done;Qa=fa.next())if(Qa=Qa.value,Qa.controls&&0<Qa.controls.length){Qa=yl(Qa.controls);for(var Ab=Qa.next();!Ab.done;Ab=Qa.next()){Ab=Ab.value;if(Ab.attributes&&!Ab.controlType&&
Ab.enabled)return Ab.id;if(Ab.menuItems)for(var Cc=yl(Ab.menuItems),Vc=Cc.next();!Vc.done;Vc=Cc.next())if(Vc=Vc.value,Vc.attributes&&Vc.enabled)return Ab.id}}}}return null};bb.prototype.auj=function(){var F=document.querySelector("button[data-unique-id = 'Ribbon-InsertAppsForOffice']");if(null==F){F=document.querySelector("button[data-unique-id = 'Overflow-RibbonOverflowMenu-overflow']");if(null==F){F={};F=(F.AppTeachingUICalloutAction="NoAnchor",F["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Fo.storeType,
this.Fo.storeId,this.Fo.assetId),F.AppTeachingUICalloutGoal="NewAdminDeployment",F["SDX.AppInstallOrigin"]="Organization",F);Vh.a.sendTelemetryEvent(Object.assign(new ui.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kc.a.Fk(F)}));Se.ULS.sendTraceTag(527286668,220,15,"ShowTeachingCalloutToContentAddin failed to get an anchorElement");return}Se.ULS.sendTraceTag(527286667,220,15,"Callout show on Overflow button")}else Se.ULS.sendTraceTag(527286666,220,15,"Callout show on OfficeAddin Button");
var fa=hh.a.instance.mc("Common.ISystemInitiatedFeedback");null==fa||null==F?(F={},F=(F.AppTeachingUICalloutAction="NoSifFutureObject",F["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Fo.storeType,this.Fo.storeId,this.Fo.assetId),F.AppTeachingUICalloutGoal="NewAdminDeployment",F["SDX.AppInstallOrigin"]="Organization",F),Vh.a.sendTelemetryEvent(Object.assign(new ui.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kc.a.Fk(F)})),Se.ULS.sendTraceTag(527286665,220,15,"ShowTeachingCalloutToContentAddin failed to get a sifFuture")):
(fa.execute(function(Qa){Qa.logActivity("ShowTeachingUIForContentAddin",null)}),F={},F=(F.AppTeachingUICalloutAction="Show",F["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Fo.storeType,this.Fo.storeId,this.Fo.assetId),F.AppTeachingUICalloutGoal="NewAdminDeployment",F["SDX.AppInstallOrigin"]="Organization",F),Vh.a.sendTelemetryEvent(Object.assign(new ui.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kc.a.Fk(F)})),Se.ULS.sendTraceTag(527286664,220,50,"ShowTeachingCalloutToContentAddin triggered an LPP activity"))};
bb.prototype.qGi=function(){var F={};F=(F.AppTeachingUICalloutAction="ClickOnLaunch",F["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Fo.storeType,this.Fo.storeId,this.Fo.assetId),F.AppTeachingUICalloutGoal="NewAdminDeployment",F["SDX.AppInstallOrigin"]="Organization",F);Vh.a.sendTelemetryEvent(Object.assign(new ui.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kc.a.Fk(F)}));var fa={};fa[Te.a.Kg]=this.Fo;F={};F.solutionId=this.Fo.solutionId;F.assetId=this.Fo.assetId;F.assetStoreId=
this.Fo.assetStoreId;F.height=0!=this.Fo.height?this.Fo.height:600;F.storeId=this.Fo.storeId;F.storeType=this.Fo.storeType;F.targetType=this.Fo.targetType;F.width=0!=this.Fo.width?this.Fo.width:600;F.displayName=this.Fo.displayName;F.version=this.Fo.version;F.isAddinCommands=!1;fa[Lg.a.OXa]=F;var Qa=new ak.a(-741808261,0,0,2,null);Wg.TaskExtensions.Ba(Zi.GetServiceTaskFactory.Xa(this.$.da,374,375,1),function(Ab){Ab=Ab.result;null!=Ab&&Ab.insertAgave(fa,Qa)},this.$.ma,3)};bb.prototype.tAi=function(){var F=
{};F=(F.AppTeachingUICalloutAction="ClickOnClose",F["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Fo.storeType,this.Fo.storeId,this.Fo.assetId),F.AppTeachingUICalloutGoal="NewAdminDeployment",F["SDX.AppInstallOrigin"]="Organization",F);Vh.a.sendTelemetryEvent(Object.assign(new ui.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kc.a.Fk(F)}))};bb.prototype.NBi=function(){var F={};F=(F.AppTeachingUICalloutAction="ClickOnDismiss",F["SDX.Id"]=Telemetry.PrivacyRules.GetAssetId(this.Fo.storeType,
this.Fo.storeId,this.Fo.assetId),F.AppTeachingUICalloutGoal="NewAdminDeployment",F["SDX.AppInstallOrigin"]="Organization",F);Vh.a.sendTelemetryEvent(Object.assign(new ui.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kc.a.Fk(F)}))};Object($d.a)(bb,"AddinTeachingCalloutHandler",null,[]);var bi=b(1250),kh=b(374),Eh=b(8),Bh=b(37);ka.prototype.dispose=function(){void 0!==this.zmb&&null!==this.zmb&&(this.zmb.dispose(),this.zmb=null);this.Ve=this.$=null;this.disposed=!0};ka.prototype.BKi=
function(F){var fa=this;if(void 0!==F&&this.EOd&&isNullOrUndefined(this.PRd)){var Qa=F.solutionId;Se.ULS.sendTraceTag(526509831,220,50,"Start monitor addin {0}.",Telemetry.PrivacyRules.GetAssetId(F.storeType,F.storeId,Qa));this.PRd=Qa;this.hqc=window.setTimeout(function(){fa.EOd&&(hh.a.instance.mc("Common.ISystemInitiatedFeedback").execute(function(Ab){Ab.logActivity("Office_Excel_Addins_NoActivationFloodgate",null)}),fa.EOd=!1)},this.xzj)}};ka.prototype.r3i=function(F){kg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowExcelAddinSurveyEnabled",
!1)&&this.PRd===F&&(window.clearTimeout(this.hqc),this.PRd=void 0)};ka.prototype.Xoj=function(F,fa){switch(F){case Jh.a.d2:F=this.Joj(fa);break;default:F=!1}return F};ka.prototype.Xc=function(){return!1};ka.prototype.executeCommand=function(F,fa,Qa){var Ab=this;F=Wg.TaskExtensions.om();fa=fa.command;switch(fa){case 843847158:break;case -2025863019:ck.a.Bvc(Qa[Lg.a.RTc].toString(),function(){Xh.g(Ab.$).focus()});break;case -1777565636:bi.a.showUILessDialog(Qa[Lg.a.Amb].toString());this.Ve.Prj(Qa[Lg.a.Amb].toString());
break;case 1592314317:bi.a.hideUILessDialog(Qa[Lg.a.Amb].toString());this.Ve.P_h(Qa[Lg.a.Amb].toString());break;case Jh.a.d2:F=this.igd(Qa);break;case Jh.a.Ezb:this.BMa(Qa);break;case Jh.a.oma:this.oma(Qa);break;case Jh.a.POd:this.zmb.Qvc();break;case Jh.a.refreshAddinCommands:this.E_i();break;case 1949669462:this.uga.XLd(!0);break;case -1014260128:F=this.executeDynamicAddInCommandsAPI(Qa);break;default:F=hk.a(fa)}return F};ka.prototype.Gc=function(F,fa){F=!1;switch(fa.command){case 843847158:case -2025863019:case -1777565636:case 1592314317:case Jh.a.oma:case Jh.a.POd:case Jh.a.refreshAddinCommands:case 1949669462:case Jh.a.Ezb:case -1014260128:F=
!0;break;case Jh.a.d2:F=!kg.AFrameworkApplication.protectedFile}return F};ka.prototype.fd=function(){return!1};ka.prototype.WFh=function(F){if(!F)return Se.ULS.sendTraceTag(528098432,220,10,"Failed to get button id for addin"),null;if((F=F.pK)&&F.fq&&0<F.fq.count){F=yl(F.fq);for(var fa=F.next();!fa.done;fa=F.next()){fa=fa.value;if(fa.groups&&1===fa.groups.length){var Qa=fa.groups[0];if(Qa.controls&&1===Qa.controls.length){var Ab=Qa.controls[0];if(Ab.attributes&&!Ab.controlType&&Ab.enabled)return Ab.id}Qa.controls&&
Se.ULS.sendTraceTag(528098403,220,15,"It has multiple buttons")}fa.groups&&Se.ULS.sendTraceTag(528098402,220,15,"It has multiple groups")}}return null};ka.prototype.E_i=function(){if(this.uga.Drd()){this.uga.Rve();var F=this.jbd();if(F&&0<F.count){F=yl(F);for(var fa=F.next();!fa.done;fa=F.next()){var Qa={};fa=(Qa[Lg.a.l2]=fa.value,Qa[Lg.a.bJ]=4,Qa[Lg.a.iFa]=(new Date).getTime(),Qa);this.oma(fa)}}}};ka.prototype.oma=function(F){var fa=this;Se.ULS.sendTraceTag(537170657,220,50,"Launch AddinCommands entitlements list, LaunchOperationType {0}, DataProvider {1}.",
F[Lg.a.bJ],F[Lg.a.l2]);this.uga.ehj();window.setTimeout(function(){if(void 0===fa.Ve||null===fa.Ve)Se.ULS.sendTraceTag(537170656,220,10,String.format("AddinUICommandHandler RetrieveAddInCommandsEntitlementsList error - DdaFacadeService should not be null, stack: {0}",Bh.a.V2()));else{var Qa=new id(new gb(fa.Ve.Gi),wc.instance,Jf.instance);Qa.dzg(function(Ab,Cc){fa.BMa(Cc.properties)});kg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",
!1)&&kg.AFrameworkApplication.ga.isChangeGateEnabled("OfficeVSO:5837059_TeachingUIForPrivateCatelogOnContentAddinEnabled")&&Qa.zCg(function(Ab,Cc){null==Cc?(Ab={},Ab=(Ab.AppTeachingUICalloutAction="InvalidEventArgs",Ab.AppTeachingUICalloutGoal="NewAdminDeployment",Ab["SDX.AppInstallOrigin"]="Organization",Ab),Vh.a.sendTelemetryEvent(Object.assign(new ui.a,{name:"Office.Extensibility.Host.AppTeachingUICallout",dataFields:Kc.a.Fk(Ab)}))):(fa.A4f=new bb(fa),fa.A4f.D1i(Cc),Ab=fa.$.Ka,null!=Ab&&(Ab.Vle(Object(Ri.a)(fa,
fa.y8e,"onTabSwitched")),Se.ULS.sendTraceTag(527286663,220,50,"Register tab switched event")))});Qa.WFj(F)}},0)};ka.prototype.y8e=function(F,fa){"Insert"==fa.tabName&&(F=this.$.Ka,null!=F&&(F.iNf(Object(Ri.a)(this,this.y8e,"onTabSwitched")),Se.ULS.sendTraceTag(527286662,220,50,"Remove insertTabSwitched handler")),this.A4f.auj())};ka.prototype.BMa=function(F){var fa=this;if(!this.disposed){Se.ULS.sendTraceTag(537170655,220,50,"LaunchOperationType {0}.",F[Lg.a.bJ]);if(kg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.ShowExcelAddinSurveyEnabled",
!1))try{var Qa=F[Lg.a.hFa],Ab=F[Lg.a.bJ];if(Qa&&0<Qa.count&&3==Ab){var Cc=Qa.na(0);Cc.storeType==OSF.StoreType.OMEX&&this.BKi(Cc)}}catch(qg){Se.ULS.sendTraceTag(526509830,220,10,String.format("Monitor survey error message : {0}.",qg.message))}try{if(Ag.EwaSettings.la(186)){var Vc=F[Lg.a.hFa];if(Vc&&0<Vc.count){var qd=Vc.count;for(Qa=qd-1;0<=Qa;Qa--){var Gd=Vc.na(Qa);Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5624783_BiserverUseIsFirstPartyAPI")?OSF.OsfControl.isFirstPartyStoreString(Gd.currentStoreType)||
Vc.remove(Vc.na(Qa)):Gd.currentStoreType.toLowerCase()!==OSF.StoreType.FirstParty.toLowerCase()&&Vc.remove(Vc.na(Qa))}if(Vc.count<qd){var ve=Zi.GetServiceTaskFactory.Xa(this.$.da,5,4,0);Wg.TaskExtensions.Ba(ve,function(){ve.result.hg(35,null)},this.$.ma,3)}if(!Vc.count)return}}if(void 0===this.Ve||null===this.Ve)Se.ULS.sendTraceTag(537170654,220,10,String.format("LaunchAddinCommands error - this.DdaFacadeService should not be null, stack: {0}",Bh.a.V2()));else{var jf=null;jf=kg.AFrameworkApplication.ga.ra("HostInstallAddInsIsEnabled")?
new Jd(this.hl,this.hze,new gb(this.Ve.Gi),new Ga(this.$.Ib,Jh.a.d2),this.uga,wc.instance,this.tga,function(qg,Qg){var ph={};ph.InstanceId=sj.a.create().toString();ph.PrimaryMarketplace={};ph.PrimaryMarketplace.MarketplaceRef=qg.storeId;ph.PrimaryMarketplace.MarketplaceType=qg.currentStoreType;ph.PrimaryMarketplace.SolutionId=qg.assetId;ph.PrimaryMarketplace.SolutionVersion=qg.appVersion;ph.WebExtensionType=1;fa.Ve.guj(ph,function(){Qg(qg)})}):new Jd(this.hl,this.hze,new gb(this.Ve.Gi),new Ga(this.$.Ib,
Jh.a.d2),this.uga,wc.instance,this.tga);kg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoLaunchAddinOnExcelWacEnabled",!1)&&jf.kzg(this.ezi);jf.ezg(this.oGi);if(kg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.TeachingUIForPrivateCatelogEnabled",!1)){var gf=new bb(this);jf.YAg(gf.nGi);jf.yCg(gf.Arj)}this.$.da.Aa(53).Lm&&cd.a.get_instance().xl(5,null).continueWith(function(){fa.disposed||jf.Nji(fa.Z8c,fa.$.domElement,F)})}}catch(qg){Se.ULS.sendTraceTag(537170653,
220,10,String.format("LaunchAddinCommands error message : {0}.",qg.message))}}};ka.prototype.igd=function(F){var fa=this,Qa=Wg.TaskExtensions.om();F=F[this.hl.Bha];var Ab=this.dYb.Ahe(F),Cc=new bi.a(this.$,this.Ve,Ab.ownerAddinInfo,Qa);Cc.$yg(function(){fa.r3i(Ab.ownerAddinInfo.solutionId)});return this.m2e(Qa,F,Ab,Cc)};ka.prototype.m2e=function(F,fa,Qa,Ab){var Cc=this;this.dYb.igd(fa,this.uga,Ab,new gb(this.Ve.Gi),Qa,function(){F=Ab.eYg()},function(){Xh.g(Cc.$).focus()});return F};ka.prototype.GIg=
function(F){var fa=this,Qa=Wg.TaskExtensions.om(),Ab=this.Ve.U$(F.assetId);if(Ab){var Cc=this.Ve.YY(Ab);if(Eh.HelperMethods.Vv(Cc)&&Cc.SharedRuntime.State)return}Cc=this.dYb.HIg;var Vc=F.assetId in Cc?Cc[F.assetId]:null;if(Vc){var qd=this.dYb.Ahe(Vc),Gd=new bi.a(this.$,this.Ve,qd.ownerAddinInfo,Qa);Cc=function(jf){if(jf){var gf={};jf=yl(jf);for(var qg=jf.next();!qg.done;qg=jf.next())qg=qg.value,gf[qg[0]]=qg[1];(gf=Lg.a.bme in gf?gf[Lg.a.bme]:null)&&"true"===gf.toLowerCase()&&(Se.ULS.sendTraceTag(537170652,
220,50,"Auto-Show AddinCommands TaskPane, CurrentStoreType {0}, StoreId {1}, AssetId {2}.",F.currentStoreType,F.storeId,Telemetry.PrivacyRules.GetAssetId(null!==qd.ownerAddinInfo?qd.ownerAddinInfo.storeType:F.currentStoreType,F.storeId,F.assetId)),fa.m2e(Qa,Vc,qd,Gd))}};Se.ULS.sendTraceTag(537170651,220,50,"Check Auto-Show AddinCommands TaskPane, CurrentStoreType {0}, StoreId {1}, AssetId {2}.",F.currentStoreType,F.storeId,Telemetry.PrivacyRules.GetAssetId(null!==qd.ownerAddinInfo?qd.ownerAddinInfo.storeType:
F.currentStoreType,F.storeId,F.assetId));if(Ab)Cc(this.Ve.YY(Ab).OsfPropertyBag);else if(Ab=this.$.fa.workbookContext.WebExtensions){Ab=yl(Ab);for(var ve=Ab.next();!ve.done;ve=Ab.next())if(ve=ve.value,(1===ve.WebExtensionType?OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent)===F.targetType&&ve.PrimaryMarketplace.MarketplaceType.toLowerCase()===F.currentStoreType.toLowerCase()&&ve.PrimaryMarketplace.MarketplaceRef.toLowerCase()===F.storeId.toLowerCase()&&ve.PrimaryMarketplace.SolutionId.toLowerCase()===
F.assetId.toLowerCase()){Cc(ve.OsfPropertyBag);break}}}};ka.prototype.PKb=function(F,fa,Qa){F&&(void 0===Qa||!Qa||fa||this.g4c.contains(F)||this.g4c.add(F),(Qa=this.p0a.contains(F))&&fa&&this.p0a.remove(F),Qa||fa||this.p0a.add(F))};ka.prototype.Kkj=function(F){var fa=F.pK;if(fa){if(fa.fq)for(F=yl(fa.fq),fa=F.next();!fa.done;fa=F.next())if(fa=fa.value,fa.groups){fa=yl(fa.groups);for(var Qa=fa.next();!Qa.done;Qa=fa.next())if(Qa=Qa.value,Qa.controls){var Ab=yl(Qa.controls);for(Qa=Ab.next();!Qa.done;Qa=
Ab.next())if(Qa=Qa.value,this.PKb(Qa.id,Qa.enabled,!0),1===Qa.controlType&&Qa.menuItems){var Cc=yl(Qa.menuItems);for(Qa=Cc.next();!Qa.done;Qa=Cc.next())Qa=Qa.value,this.PKb(Qa.id,Qa.enabled,!0)}}}}else if(F.tabs)for(F=yl(F.tabs),fa=F.next();!fa.done;fa=F.next())if(fa=fa.value,fa.KJ)for(fa=yl(fa.KJ),Qa=fa.next();!Qa.done;Qa=fa.next())if(Qa=Qa.value,Qa.Aha)for(Ab=yl(Qa.Aha),Qa=Ab.next();!Qa.done;Qa=Ab.next())if(Qa=Qa.value,this.PKb(Qa.id,Sg.a.BTa in Qa.hA?Qa.hA[Sg.a.BTa]:!0,!0),Qa.controlType===Sg.a.O3&&
Qa.menuItems)for(Cc=yl(Qa.menuItems),Qa=Cc.next();!Qa.done;Qa=Cc.next())Qa=Qa.value,this.PKb(Qa.id,Sg.a.BTa in Qa.RQ?Qa.RQ[Sg.a.BTa]:!0,!0)};ka.prototype.jbd=function(){var F=new Ph.a;Ag.EwaSettings.la(53)&&(this.$.fa.ih.get(27)&&(F.add(0),F.add(16)),this.$.fa.ih.get(33)&&F.add(1),F.add(8));return F};ka.prototype.executeDynamicAddInCommandsAPI=function(F){var fa=!0;if(void 0===F||null===F||void 0===F[Lg.a.vrb]||null===F[Lg.a.vrb])return nj.Task.Ta(!1);switch(F[Lg.a.vrb]){case 1:fa=this.RIj(F);break;
case 2:fa=this.Okj(F);break;case 4:this.p0a.clear();this.p0a.addRange(this.g4c);break;case 3:fa=this.installContextualTab(F);break;default:fa=!1}return nj.Task.Ta(fa)};ka.prototype.Joj=function(F){return F&&this.hl.Bha in F?(F=F[this.hl.Bha])?this.p0a.contains(F):!1:!1};ka.prototype.RIj=function(F){var fa=null,Qa=null,Ab=null,Cc=!0;void 0!==F[Lg.a.u3]&&null!==F[Lg.a.u3]&&void 0!==F[this.hl.Bha]&&null!==F[this.hl.Bha]&&void 0!==F[Lg.a.t3]&&null!==F[Lg.a.t3]&&(fa=F[Lg.a.u3],Qa=F[Lg.a.K5b],Ab=F[this.hl.Bha],
Cc=F[Lg.a.t3]);if(!fa||!Ab)return Se.ULS.sendTraceTag(537170649,220,15,"UpdateControlEnableState failed to get solutionId or controlId."),!1;F=(new ci.a(this.$.Ib,fa,this.hl,!0)).wua(Ab);fa={DynamicAddinCommandsApiName:"UpdateControlEnableState"};fa.AssetId=Qa;fa.MaskedTabId=F;fa.IsToEnable=Cc;Se.ULS.sendTraceTag(537170648,220,15,$h.a.Hc(fa));this.PKb(F,Cc);kh.a.sy.updateCommandUI();return!0};ka.prototype.Okj=function(F){var fa,Qa,Ab=null,Cc=null,Vc=null,qd=null,Gd=!0;void 0!==F[Lg.a.P5c]&&null!==
F[Lg.a.P5c]&&void 0!==F[Lg.a.u3]&&null!==F[Lg.a.u3]&&void 0!==F[this.hl.Bha]&&null!==F[this.hl.Bha]&&void 0!==F[Lg.a.t3]&&null!==F[Lg.a.t3]&&(Ab=F[Lg.a.P5c],Cc=F[Lg.a.u3],Vc=F[Lg.a.K5b],qd=F[this.hl.Bha],Gd=F[Lg.a.t3]);if(!Ab||!Cc||!qd)return Se.ULS.sendTraceTag(537170647,220,15,"SetRibbonTabVisible failed to get storeType or solutionId or tabId."),!1;F=(new ci.a(this.$.Ib,Cc,this.hl,!0)).efd(qd);qd={DynamicAddinCommandsApiName:"SetRibbonTabVisible"};qd.StoreType=Ab;qd.AssetId=Vc;qd.MaskedTabId=F;
qd.IsToShow=Gd;Se.ULS.sendTraceTag(537170646,220,15,$h.a.Hc(qd));Cc=this.uga.L3(Ab,Cc,1);Ab=!1;if(null===(Qa=null===(fa=null===Cc||void 0===Cc?void 0:Cc.nl)||void 0===fa?void 0:fa.pK)||void 0===Qa?0:Qa.fq)for(fa=yl(Cc.nl.pK.fq),Qa=fa.next();!Qa.done;Qa=fa.next())if(Qa.value.id===F){Ab=!0;break}if(!Ab)return Se.ULS.sendTraceTag(537170645,220,15,"SetRibbonTabVisible failed to get contextual tabs"),!1;fa=[];Gd?appChrome.selectors.getSelectedTabId()!==F&&fa.push(appChrome.actions.activateRibbonTab(F)):
(appChrome.selectors.getSelectedTabId()===F&&fa.push(appChrome.actions.setCurrentTab(Ni.a.eW)),fa.push(appChrome.actions.deactivateRibbonTab(F)));appChrome.api.dispatch(fa);return!0};ka.prototype.installContextualTab=function(F){var fa=null,Qa=null,Ab=null,Cc=null;if(void 0!==F[Lg.a.u3]&&null!==F[Lg.a.u3]&&void 0!==F[Lg.a.t3]&&null!==F[Lg.a.t3]){var Vc=F[Lg.a.t3];fa=F[Lg.a.u3];void 0!==Vc[Lg.a.$Ha]&&null!==Vc[Lg.a.$Ha]&&void 0!==Vc[Lg.a.aIa]&&null!==Vc[Lg.a.aIa]&&(Qa=Vc[Lg.a.$Ha],Ab=Vc[Lg.a.aIa],
Cc=Vc[Lg.a.Q5c])}if(!(fa&&Ab&&Qa&&Cc))return Se.ULS.sendTraceTag(537170644,220,15,"InstallContextualTab failed to invalid parameters"),!1;F=this.uga.L3(Cc.PrimaryMarketplace.MarketplaceType,Cc.PrimaryMarketplace.SolutionId,1);if(null===F||void 0===F?0:F.nl)return Se.ULS.sendTraceTag(537170643,220,15,"InstallContextualTab was called multiple times"),!1;F={};F.solutionId=Cc.PrimaryMarketplace.SolutionId;F.version=Cc.PrimaryMarketplace.SolutionVersion;F.storeType=Cc.PrimaryMarketplace.MarketplaceType;
F.storeId=Cc.PrimaryMarketplace.MarketplaceRef;F.assetId=Cc.PrimaryMarketplace.SolutionId;F.assetStoreId=Cc.PrimaryMarketplace.MarketplaceRef;F.targetType=Cc.WebExtensionOsfControlType;F.width=Cc.TaskpaneWidth;F.height=0;F.isAddinCommands=!0;F.id=F.assetId;F.appVersion=Cc.PrimaryMarketplace.SolutionVersion;F.currentStoreType=Cc.PrimaryMarketplace.MarketplaceType;Cc=new Ph.a;Cc.add(F);F={};F[Lg.a.hFa]=Cc;F[Lg.a.bJ]=6;F[Lg.a.$Ha]=Qa;F[Lg.a.aIa]=Ab;this.BMa(F);return!0};Object($d.a)(ka,"AddinUICommandHandler",
null,[885,237,3]);var pi=b(70);Mb.prototype.eJb=function(){return this.UNd()};Mb.prototype.activate=function(){return this.yRc()};Mb.prototype.deactivate=function(){this.X3c()};Mb.prototype.dispose=function(){this.X3c=this.yRc=this.UNd=null};Object($d.a)(Mb,"FeatureActivator",null,[45,3]);var wi=b(21),$i=b(17),Ui=xd.a;vm(E,Ui);E.prototype.Md=function(){var F=this;Se.ULS.sendTraceTag(38410432,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync");pi.a(this.$).add(Object.assign(new Mb,{UNd:function(){var fa=
F.$.fa.KE&&F.$.fa.oc&&!!(F.$.Fd&16384)&&F.$.isEditMode;F.$.fa.oc&&Se.ULS.sendTraceTag(38410433,0,50,"AddinUICommandHandlerFactory.CreateCommandHandlersAsync FeatureActivator: shouldActivate [{0}] IsSessionFullyLoaded [{1}] IsSessionActive [{2}] ShowCommandUI [{3}] IsEditMode [{4}]",fa,F.$.fa.KE,F.$.fa.oc,!!(F.$.Fd&16384),F.$.isEditMode);return fa},yRc:this.Xug,X3c:this.g8g,z7b:2}))};E.prototype.k0i=function(F){var fa=this,Qa=Zi.GetServiceTaskFactory.create(this.$.da,102,this.ma,this.tb);return Wg.TaskExtensions.Ba(Qa,
function(){Se.ULS.sendTraceTag(38942483,0,50,"AddinUICommandHandlerFactory.RegisterContextMenuExtensibilityService ribbonControlManagerTask finished.");fa.$.da.Ha(204,new Uf(Qa.result,F))},this.ma,3)};E.ja=function(F){xd.a.de(199,new E(F))};Object($d.a)(E,"AddinUICommandHandlerFactory",xd.a,[]);var gi=b(1237),ri=b(1239),Hi=ij.a;vm(wb,Hi);wb.prototype.create=function(){var F=this,fa;if(Ag.EwaSettings.la(412)){var Qa=Zi.GetServiceTaskFactory.create(this.$.da,106,this.$.ma,this.tb),Ab=Zi.GetServiceTaskFactory.create(this.$.da,
396,this.$.ma,this.tb);Wg.TaskExtensions.Ba(nj.Task.WAA(Qa,Ab),function(){F.Fb(F.$.da.Aa(278)||new gi.CustomFunctionsInstaller(F.$,Qa.result,Ab.result))},this.$.ma,3)}else(fa=this.$.da.Aa(278))||(fa=this.$.da.Ha(278,new ri.CustomFunctionsLegacyInstaller(this.$))),this.Fb(fa)};wb.ja=function(F){F.da.Ha(279,new wb(F))};Object($d.a)(wb,"CustomFunctionsInstallerFactory",ij.a,[]);var Ii=b(88),Yh=b(44),si=b(42);rc.prototype.ja=function(F){this.CVc?Se.ULS.sendTraceTag(537170629,0,10,"The instance AgaveOnSelectedReadoutHandler should not attach multiple times."):
(this.CVc=!0,this.fPa={},this.gPa={},F?F.Qzg(this.Q6f):Se.ULS.sendTraceTag(537170628,0,10,"The AgaveOnSelectedReadoutHandler should not attach to a null object."))};rc.prototype.detach=function(F){if(F){F.h4i(this.Q6f);F=this.fPa;for(var fa in F)Ii.a.Fa(F[fa]);this.gPa=this.fPa=null;this.CVc=!1}else Se.ULS.sendTraceTag(537170627,0,10,"The AgaveOnSelectedReadoutHandler should not detach from a null object.")};rc.prototype.QIf=function(F,fa,Qa){if(this.E8h(Qa,F))return!1;F=fa.querySelector("iframe");
if(!F)return Se.ULS.sendTraceTag(537170595,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;F=F.title;if(!F||!F.length)return Se.ULS.sendTraceTag(537170594,0,10,"The AgaveOnSelectedReadoutHandler attach to an invalid agave containter."),!0;this.ariaLiveNotifier.readText(F);return!0};rc.prototype.E8h=function(F,fa){return(F=F.Gi.getOsfControl(fa))?F.getPageStatus()!==OSF.OsfControlPageStatus.Ready:!0};Object($d.a)(rc,"AgaveOnSelectedReadoutHandler",null,[792]);var Uh=
ij.a;vm(tb,Uh);tb.prototype.create=function(){var F=this,fa=this.$.da;Wg.TaskExtensions.Ba(Zi.GetServiceTaskFactory.Xa(fa,211,212,this.tb),function(Qa){Qa=fa.Aa(224)||new rc(Qa.result,F.$);F.Fb(Qa)},this.ma,3)};tb.ja=function(F){F.da.Ha(225,new tb(F))};Object($d.a)(tb,"AgaveOnSelectedReadoutHandlerFactory",ij.a,[]);var nh=b(861),dj=b(233);Ta.prototype.u3e=function(F){try{if(F&&F.rawEvent&&F.rawEvent.origin&&this.iframe&&this.iframe.id){var fa=this.FCf(F.rawEvent.origin),Qa=this.FCf(document.domain);
if(Gj.a.Ik().equals(Qa,fa))if(F.rawEvent.source&&F.rawEvent.source.frameElement&&F.rawEvent.source.frameElement.id&&Gj.a.Ik().equals(F.rawEvent.source.frameElement.id,this.iframe.id)){fa=null;try{fa=JSON.parse(F.rawEvent.data)}catch(Ab){Se.ULS.sendTraceTag(39112971,344,50,"AuthenticationProxy.HandleResponse: The received response is malformed or not intended for the privateCatalogIframe: {0}",Ab.message)}fa?(fa.statusCode!==dj.a.sO||void 0!==fa.error&&fa.error?(Se.ULS.sendTraceTag(23707648,344,50,
"Authentication proxy returned a result but the operation failed. statusCode '{0}', Error: '{1}'",fa.statusCode,fa.error),this.onError()):(Se.ULS.sendTraceTag(23705827,344,100,"Received response from authentication proxy."),this.onSuccess(fa.authorizationCode?fa.authorizationCode:fa.signInUrl)),$removeHandler(window,"message",Object(Ri.a)(this,this.u3e,"handleResponse")),this.iframe?document.body.contains(this.iframe)?document.body.removeChild(this.iframe):Se.ULS.sendTraceTag(24978499,344,15,"The iframe is not a child of Body."):
Se.ULS.sendTraceTag(24978500,344,15,"The iframe is null.")):Se.ULS.sendTraceTag(575976219,344,50,"AuthenticationProxy.HandleResponse: this was not our message, just wait for right one.")}else Se.ULS.sendTraceTag(51451614,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Event does not originate from expected iFrame.");else Se.ULS.sendTraceTag(51451613,344,50,"AuthenticationProxy ResponseHandler skipped processing for event. Failed validate event origin.")}else Se.ULS.sendTraceTag(51418200,
344,50,"AuthenticationProxy ResponseHandler skipped processing for event.")}catch(Ab){Se.ULS.sendTraceTag(23707649,344,10,"Exception in authentication proxy message handler: {0}.",Ab.message)}};Ta.prototype.FCf=function(F){var fa="";try{F&&(fa=-1<F.indexOf("//")?F.split("/")[2]:F.split("/")[0])&&(fa=fa.split(":")[0],fa=fa.split("?")[0])}catch(Qa){Se.ULS.sendTraceTag(51451615,344,10,"Failed to parse host name from url: {0}",Qa.message)}return fa};Ta.ja=function(F,fa,Qa){new Ta(F,fa,Qa)};Object($d.a)(Ta,
"ResponseHandler",null,[]);var dk=b(277);fb.prototype.tryAuthenticate=function(F,fa){this.y9a(fb.Ilg,function(){F()},fa)};fb.prototype.tryAuthorize=function(F,fa){this.y9a(fb.Rgg,F,fa)};fb.prototype.getSignInUrl=function(F,fa){this.y9a(fb.yee,F,fa)};fb.prototype.signOut=function(F,fa){this.y9a(fb.Nrg,F,fa)};fb.prototype.y9a=function(F,fa,Qa){var Ab=new dk.QueryStringBuilder("AuthenticationProxyHandler.aspx");Ab.Ei("responseType",F);kg.AFrameworkApplication.Plb(Ab);Ab=String.format("{0}{1}&{2}",this.IEa,
Ab.toString(),kg.AFrameworkApplication.hj);var Cc=document.createElement("iframe");Cc.setAttribute("id","privateCatalogIframe");Cc.setAttribute("name","privateCatalogIframe");Cc.setAttribute("style","display: none");Gj.a.Ik().equals(F,fb.yee)||Cc.setAttribute("sandbox","allow-scripts allow-forms allow-same-origin allow-popups allow-pointer-lock");Ta.ja(Cc,fa,Qa);Cc.setAttribute("src",Ab);document.body.appendChild(Cc)};fb.Rgg="authcode";fb.Ilg="identitytoken";fb.yee="signinurl";fb.Nrg="signout";Object($d.a)(fb,
"AuthenticationProxy",null,[]);ub.getUserId="getUserId";ub.getLastStoreUpdate="laststoreupdate";ub.getEntitlement="getEntitlements";ub.getEToken="getEToken";ub.getManifest="getManifest";ub.getAppState="getAppState";ub.getKilledApps="getRemovedAddins";ub.getAppDetails="getAppDetails";ub.removeApps="removeAddin";ub.getLastPrivateCatalogUpdate="getLastPrivateCatalogUpdate";ub.getPrivateCatalogAddIns="getAddIns";ub.getPrivateCatalogManifests="getAppManifests";ub.isStoreDisabled="isStoreDisabled";Object($d.a)(ub,
"S2SWebRequestActions",null,[]);var mk=b(597);Tc.prototype.getUserId=function(F,fa){var Qa=new Ph.a;Qa.add(new zc.a("corr",F));this.zW(ub.getUserId,Qa,1,fa)};Tc.prototype.getLastStoreUpdate=function(F,fa,Qa){var Ab=new Ph.a;Ab.add(new zc.a("lc",F));Ab.add(new zc.a("corr",fa));this.zW(ub.getLastStoreUpdate,Ab,1,Qa)};Tc.prototype.getEntitlement=function(F,fa,Qa,Ab){F=new Ph.a;F.add(new zc.a("av",fa));F.add(new zc.a("corr",Qa));this.zW(ub.getEntitlement,F,1,Ab)};Tc.prototype.getEToken=function(F,fa,
Qa,Ab,Cc,Vc){var qd=new Ph.a;qd.add(new zc.a("cmu",F));qd.add(new zc.a("cmf",fa));qd.add(new zc.a("assetid",Qa));qd.add(new zc.a("expver",Ab));qd.add(new zc.a("corr",Cc));this.zW(ub.getEToken,qd,1,Vc)};Tc.prototype.getManifest=function(F,fa,Qa,Ab){var Cc=new Ph.a;Cc.add(new zc.a("cmu",F));Cc.add(new zc.a("assetid",fa));Cc.add(new zc.a("corr",Qa));this.zW(ub.getManifest,Cc,1,Ab)};Tc.prototype.getAppState=function(F,fa,Qa){var Ab=new Ph.a;Ab.add(new zc.a("ma",F));Ab.add(new zc.a("corr",fa));this.zW(ub.getAppState,
Ab,1,Qa)};Tc.prototype.getKilledApps=function(F,fa){var Qa=new Ph.a;Qa.add(new zc.a("corr",F));this.zW(ub.getKilledApps,Qa,1,fa)};Tc.prototype.getAppDetails=function(F,fa,Qa,Ab){var Cc=new Ph.a;Cc.add(new zc.a("cmo",F));Cc.add(new zc.a("corr",Qa));this.ebb(ub.getAppDetails,Cc,fa,2,Ab,!1)};Tc.prototype.removeApps=function(F,fa,Qa){var Ab=new Ph.a;Ab.add(new zc.a("corr",fa));this.ebb(ub.removeApps,Ab,F,2,Qa,!1)};Tc.prototype.getLastPrivateCatalogUpdate=function(F,fa,Qa,Ab,Cc,Vc){var qd=new Ph.a;qd.add(new zc.a("catalog",
"privatecatalog"));qd.add(new zc.a("clientCode",F));qd.add(new zc.a("clientVersion",fa));qd.add(new zc.a("corr",Cc));F=String.format("authorizationCode={0}&refreshToken={1}",Qa?Ea.a.pf(Qa):"",Ab?Ea.a.pf(Ab):"");this.ebb(ub.getLastPrivateCatalogUpdate,qd,F,2,Vc,!0)};Tc.prototype.getPrivateCatalogAddIns=function(F,fa,Qa,Ab,Cc,Vc){var qd=new Ph.a;qd.add(new zc.a("catalog","privatecatalog"));qd.add(new zc.a("clientCode",F));qd.add(new zc.a("clientVersion",fa));qd.add(new zc.a("corr",Cc));F=String.format("authorizationCode={0}&refreshToken={1}",
Qa?Ea.a.pf(Qa):"",Ab?Ea.a.pf(Ab):"");this.ebb(ub.getPrivateCatalogAddIns,qd,F,2,Vc,!0)};Tc.prototype.getPrivateCatalogManifests=function(F,fa,Qa,Ab,Cc){var Vc=new Ph.a;Vc.add(new zc.a("catalog","privatecatalog"));Vc.add(new zc.a("corr",Ab));F=String.format("extensionIds={0}&authorizationCode={1}&refreshToken={2}",Ea.a.pf(F),fa?Ea.a.pf(fa):"",Qa?Ea.a.pf(Qa):"");this.ebb(ub.getPrivateCatalogManifests,Vc,F,2,Cc,!0)};Tc.prototype.isStoreDisabled=function(F,fa){var Qa=new Ph.a;Qa.add(new zc.a("corr",F));
this.zW(ub.isStoreDisabled,Qa,2,fa)};Tc.prototype.zW=function(F,fa,Qa,Ab){this.ebb(F,fa,null,Qa,Ab,!1)};Tc.prototype.ebb=function(F,fa,Qa,Ab,Cc,Vc){var qd=new dk.QueryStringBuilder("AddinServiceHandler.ashx");qd.Ei("action",F);qd.Ei("app",mk.a[kg.AFrameworkApplication.sa.Pa.Lj]);fa=yl(fa);for(var Gd=fa.next();!Gd.done;Gd=fa.next())Gd=Gd.value,qd.Ei(Gd.key,Gd.value);qd=String.format("{0}{1}&{2}",kg.AFrameworkApplication.sa.Pa.h_,qd.toString(),kg.AFrameworkApplication.hj);kg.AFrameworkApplication.Hd.Ul(qd,
Ab,Qa,null,!1,2,function(ve){var jf=null;ve&&ve.data&&(ve.data.responseHeaders["X-BlockedForMinor"]&&"1"===ve.data.responseHeaders["X-BlockedForMinor"].toString()&&(ve.data.httpStatus=451),jf=ve.data.fe);Cc(ve.data.httpStatus,jf)},function(ve){var jf=null;Vc&&ve&&ve.data&&ve.data.fe&&(jf=ve.data.fe);Cc(ve.data.httpStatus,jf);if(kg.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OEP.AddinServiceHandlerTelemetry",!0)){jf={message:"AddinServiceHandler request failed"};jf.code=
ve.data.httpStatus;jf.action=F;if(ve.data.request||ve.data.request.get_headers())jf["X-UserSessionId"]=ve.data.request.get_headers()["X-UserSessionId"];408===ve.data.httpStatus||503===ve.data.httpStatus?Se.ULS.sendTraceTag(538784582,220,10,JSON.stringify(jf)):Se.ULS.sendTraceTag(18392345,220,50,JSON.stringify(jf))}else Se.ULS.sendTraceTag(538736349,220,50,"S2S web request failed with {0}.",ve.data.httpStatus)},null,void 0,void 0,void 0,void 0,"AddinServiceHandler_"+F)};Object($d.a)(Tc,"S2SWebRequestManager",
null,[]);var Nj=ij.a;vm(wd,Nj);wd.prototype.create=function(){var F=this;Se.ULS.sendTraceTag(537170507,0,50,"DdaFacadeServiceFactory:Create.");kg.AFrameworkApplication.disableWholeAppsForOfficeFeature?Se.ULS.sendTraceTag(537170506,0,50,"DdaFacadeServiceFactoryError.Create not creating DdaFacadeService : DisableWholeAppsForOfficeFeature [{0}]",kg.AFrameworkApplication.disableWholeAppsForOfficeFeature):Ag.EwaSettings.la(417)?hh.a.instance.mc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(fa){fa.isFeatureEnabled("mso_officeStore",
!0).then(function(Qa){nh.DdaFacade.P0c=Qa;F.hBe();return null})}):this.hBe()};wd.prototype.hBe=function(){var F=this,fa=Zi.GetServiceTaskFactory.Xa(this.$.da,224,225,this.tb),Qa=Ke.a.zrd(41,function(){return!(void 0===window.OSF||null===window.OSF)},this.$.ya.MaxRetriesForLoadingScript,this.$.ma,this.tb,106),Ab=eb(this.ma,this.tb);Wg.TaskExtensions.Ba(Wg.TaskExtensions.ve([fa,Qa,Ab],this.$.ma),function(){"undefined"===typeof OfficeExt||"undefined"===typeof OSF?Se.ULS.sendTraceTag(537170505,0,15,"DdaFacadeServiceFactoryError.Create not creating DdaFacadeService. OfficeExt/OSF shouldn't be undefined. Stack: {0}",
Bh.a.V2()):F.l3h();Se.ULS.sendTraceTag(537170504,0,50,"DdaFacadeServiceFactoryError.Create: DdaFacadeService created");F.PIf=fa.result;F.Fb(F.Ve);Se.ULS.sendTraceTag(537170503,0,50,"VSO#2693929: ServiceCreatedEvent is registered.")},this.ma,3)};wd.prototype.l3h=function(){Ag.EwaSettings.la(64)&&OfficeExt.S2SOmexCatalogService.initRequestHandler(new Tc);this.$.ig.get(35)&&OfficeExt.PrivateCatalogService.initRequestHandler(new Tc,new fb(kg.AFrameworkApplication.ga.appSettings.WebServiceBase),Ag.EwaSettings.la(71),
Ag.EwaSettings.la(448))};wd.prototype.dispose=function(){Ii.a.Fa(this.ddaFacade);this.$=this.ddaFacade=null;Nj.prototype.dispose.call(this)};wd.ja=function(F){new wd(F)};tl.Object.defineProperties(wd.prototype,{Ve:{configurable:!0,enumerable:!0,get:function(){return this.ddaFacade||(this.ddaFacade=new nh.DdaFacade(this.$,this.PIf))}}});Object($d.a)(wd,"DdaFacadeServiceFactory",ij.a,[]);Pc.prototype.fd=function(){return!1};Pc.prototype.Xc=function(){return!1};Pc.prototype.Gc=function(F,fa,Qa,Ab){var Cc=
!1;switch(fa.command){case -684355545:Cc=!0;break;case -741808261:Cc=!!Qa;break;case -859308420:Cc=!!Ab&&1===Ab.eA;break;case 418618014:Cc=1===F&&!!Ab&&1===Ab.eA;break;case -515602470:fa=Ag.EwaSettings.la(235)&&2===F;Cc=(1===F||fa)&&!!Ab&&1===Ab.eA;break;case 2086613372:Cc=Ag.EwaSettings.la(235)&&2===F&&!!Ab&&1===Ab.eA;break;case -1336341324:Cc=Ag.EwaSettings.la(500)&&1===F&&!!Ab&&1===Ab.eA;break;case -1444574190:case -336193495:Cc=1===F&&!!Ab&&1===Ab.eA;break;case 1296389134:Cc=1===F&&!!Ab&&1===
Ab.eA;break;case 1221897806:Cc=Ag.EwaSettings.la(166)&&2===F;break;case -1753056834:Cc=Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",!1);break;case 932597253:Cc=!0;break;case 301511274:Cc=Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.NavigationPaneWeb",!1);break;case 515196233:Cc=Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OptimizeCellTableBigHammer",!1)&&this.$.isEditMode;break;case 1723441034:Cc=this.$.isEditMode&&this.$.fa.aJb}return Cc};
Pc.prototype.executeCommand=function(F,fa,Qa){var Ab=Wg.TaskExtensions.om(),Cc=fa.command;switch(fa.command){case 1296389134:this.agaveCommandManager.fxj(Qa.SourceControlId,Qa.LabelText);break;case -684355545:this.agaveCommandManager.$Xc();break;case -741808261:Ab=this.agaveCommandManager.insertAgave(Qa,fa);break;case -1336341324:Ag.EwaSettings.la(500)&&(Ab=this.agaveCommandManager.Q2e(Qa,F,fa));break;case -859308420:case -515602470:case 2086613372:case -336193495:case -1444574190:case 418618014:case 1221897806:case -1753056834:case 932597253:case 301511274:case 515196233:case 1723441034:Ab=
this.agaveCommandManager.Q2e(Qa,F,fa);break;default:Ab=hk.a(Cc)}return Ab};Object($d.a)(Pc,"AgaveCommandHandler",null,[237]);Object($d.a)(Xc,"Selection",null,[]);Object($d.a)(Hc,"SmartLookupApplicationInterface",null,[]);Object($d.a)(Eb,"ApplicationProperties",null,[]);Object($d.a)(Kb,"EnterpriseUserInfo",null,[]);Object($d.a)(xb,"FeatureGates",null,[]);Ja.prototype.HRh=function(){var F=void 0===F?!0:F;var fa=this.nDe();if(fa<this.Rsd+this.WCj)return fa>this.Rsd+this.ZCj&&this.fbd(),this.ekf;F&&this.fbd();
return""};Ja.prototype.fbd=function(){var F=this;this.Usd=this.Usd||new Promise(function(fa){F.IRh().then(function(Qa){F.ekf=Qa;F.Rsd=F.nDe();F.Usd=null;fa(Qa)})})};Ja.prototype.IRh=function(){var F=this;return this.k7a&&this.k7a.length?new Promise(function(fa){F.cxa.YR("SmartLookup",F.k7a).then(function(Qa){Qa.IsSuccess?Qa.Token||(fa(""),Se.ULS.sendTraceTag(51446545,1313,15,"SmartLookupManager - The AAD token is empty")):(Se.ULS.sendTraceTag(51446544,1313,15,"SmartLookupManager - Failed to get AAD token with error: "+
Qa.ErrorCode+": "+Qa.ErrorMessage),fa(""));fa(Qa.Token)}).catch(function(Qa){Qa=Gh.c(Qa);Se.ULS.sendTraceTag(51446546,1313,15,"SmartLookupManager - Failed to get AAD token with exception: "+Qa);fa("")})}):(Se.ULS.sendTraceTag(51446543,1313,10,"SmartLookupManager - Missing service endpoint: "),Promise.resolve(""))};Object($d.a)(Ja,"SmartLookupAuthenticationManager",null,[222]);Lb.eIh=function(){switch(Object(Wi.a)(String,kg.AFrameworkApplication.Gb.AudienceGroup)||""){case "Dogfood":if(kg.AFrameworkApplication.ga){var F=
kg.AFrameworkApplication.ga.Ua("UserPrincipalName");F=Ea.a.Kl(F);var fa=kg.AFrameworkApplication.ga.Dy("SmartLookupINTEnabledForSKITeam")?kg.AFrameworkApplication.ga.Tv("SmartLookupINTEnabledForSKITeam"):[];return 0<=Array.indexOf(fa,F)?"INT":"EDOG"}return"EDOG";default:return"PROD"}};Lb.hRh=function(){switch(kg.AFrameworkApplication.ga.ra("IntentSvcEnableEdogSourceLocationOverride")?"EDOG":kg.AFrameworkApplication.ga.ra("IntentSvcEnableProdSourceLocationOverride")?"PROD":kg.AFrameworkApplication.ga.ra("IntentSvcEnableIntSourceLocationOverride")?
"INT":Lb.eIh()){case "INT":return"wss://augmentation.osi.office-int.net/officeaugmentation/searchendpoint/";case "EDOG":return"wss://augmentation.osi.officeppe.net/officeaugmentation/searchendpoint/";default:return"wss://augmentation.osi.office.net/officeaugmentation/searchendpoint/"}};Object($d.a)(Lb,"Utils",null,[]);var nk=b(77),Ak=b(579);Ra.prototype.VCh=function(){return Promise.resolve(this.WCh())};Ra.prototype.WCh=function(){var F=new Eb;F.anid="";F.applicationVersion=kg.AFrameworkApplication.buildVersion;
F.appCorrelationId=bj.a.create().toString();F.themePlatform=Ra.LOj;F.lcid=kg.AFrameworkApplication.lcid;F.launchUtcTime=(new Date).toUTCString();F.featureGates=this.j7a;var fa=Ak.a.DJ(kg.AFrameworkApplication.lcid);fa=fa?fa.name:null;F.market=this.a$b(fa);F.uiLanguage=fa;F.sessionId=kg.AFrameworkApplication.userSessionId;F.themeId=0;F.parentalControl=Ra.gPi;var Qa=new Kb;Qa.CountryCode=this.a$b(fa);Qa.ServiceEndpoint=this.k7a;Qa.IsGoLocal=!1;Qa.IsEnabled=this.Jkf;Qa.IsEnterpriseEnabled=this.Jkf;Qa.TenantRoot=
this.Mpi;F.enterpriseUserInfo=Qa;F.accessToken=this.Gpi.HRh();return F};Ra.prototype.a$b=function(F){F=F.split("-");return F[F.length-1]};tl.Object.defineProperties(Ra.prototype,{approvedOriginPattern:{configurable:!0,enumerable:!0,get:function(){return this.fpi}}});Ra.LOj="web";Ra.gPi="yes";Object($d.a)(Ra,"SmartLookupManager",null,[171]);var sk=Fj.a;vm(Sa,sk);Sa.prototype.fd=function(){return!1};Sa.prototype.Xc=function(){return!1};Sa.prototype.Gc=function(F,fa){F=Ag.EwaSettings.la(134);return-983891024===
fa.command&&F};Sa.prototype.executeCommand=function(F,fa){F=Wg.TaskExtensions.om();-983891024===fa.command&&this.xji();return F};Sa.prototype.xji=function(){var F=this,fa=new Ra(null),Qa={},Ab=Xh.g(this.$).sc(null).originalText;Ab=Object.assign(new Xc,{neighborhood:Ab,mentionStart:0,mentionLength:Ab?Ab.length:0});var Cc=Object.assign(new Hc,{selection:Ab,entryPoint:0});fa.VCh().then(function(qd){qd.applicationName=Sa.appName;qd.isFirstLaunch=F.isFirstLaunch;qd.themeId=5;Qa[Sa.smartLookupApplicationInterface]=
JSON.stringify(Cc);Qa[Sa.kFg]=JSON.stringify(qd);F.isFirstLaunch=!1});fa=new vi.a("ExcelOnline","Web","en-Us");Ab=new Ai.a("FA000000006",OSF.StoreType.FirstParty,OSF.StoreType.FirstParty,"1.0.0.0");var Vc=new kj.a;Vc.ni[le.al]=Fe.a.instance.ea(1753);Vc.ni[le.taskPaneWidth]=350;Vc.ni[le.sourceLocationOverrideResourceId]="WAC.PROD.URL";Vc.Sq=Qa;zi.a.instance.CMa(Ab,"Taskpane","SmartLookupSDXTaskpane",fa,Vc)};Sa.kFg="AppProperties";Sa.appName="Excel";Sa.smartLookupApplicationInterface="SmartLookupApplicationInterface";
Object($d.a)(Sa,"SmartLookupCommandHandler",Fj.a,[237]);var Pi=xd.a;vm(Fa,Pi);Fa.prototype.Md=function(){var F=this;Vj.a(this.$,374,375,this.tb,function(fa){F.Ed([new Pc(F.$,null,null,null,null,fa),new Sa(F.$)])})};Fa.ja=function(F){xd.a.de(76,new Fa(F))};Object($d.a)(Fa,"AgaveCommandHandlerFactory",xd.a,[]);Object($d.a)(function(){},"AppInfoDetail",null,[]);b(1080);Object($d.a)(function(){},"AppsForOfficeUtils",null,[]);Object($d.a)(Yb,"AppsDataManager",null,[38]);var Vi=b(1294),mi=b(108);lb.prototype.initialize=
function(F){lb.initialized||(this.Ve=F,this.Mg(),lb.initialized=!0)};lb.prototype.Mg=function(){kg.AFrameworkApplication.Eb.hf(Jh.a.d$a,mi.a.frame,this.d$a,96);kg.AFrameworkApplication.Eb.$b(Jh.a.b0i,mi.a.frame,this.h1i)};tl.Object.defineProperties(lb,{instance:{configurable:!0,enumerable:!0,get:function(){lb.Na||(lb.Na=new lb);return lb.Na}}});lb.Na=null;lb.initialized=!1;Object($d.a)(lb,"AgaveCommandActor",null,[]);var Bi=b(110),oj=b(353),Oj=b(350),jk=b(1264),ok=b(340);Object($d.a)(sa,"FirstPartyAddinTaskpaneOverrides",
null,[]);Object($d.a)(xa,"IdeasSelectionContext",null,[]);vm(ta,xa);Object($d.a)(ta,"IdeasTableSelectionContext",xa,[]);var Xj=b(59),Tk=b(153),dl=b(587),il=b(127),cl=b(140),Bk=b(172),Rk=cl.a;vm(Fb,Rk);Fb.prototype.KC=function(){Rk.prototype.KC.call(this);this.fp.style.width=this.y_d;this.fp.style.height=this.fUa;this.fp.style.marginTop=this.APb;this.fp.style.padding=this.gUa};Fb.prototype.bPa=function(){this.fp.style.width=this.y_d;this.fp.style.height=this.fUa;this.fp.style.marginTop=this.APb;this.fp.style.padding=
this.gUa;this.xCa>Bk.a.k9a?(this.Lb.style.width=String.format("{0}px",Bk.a.k9a),this.Lb.style.overflowX="scroll",kg.AFrameworkApplication.isRtl?this.Lb.style.right="0":this.Lb.style.left="0"):(this.Lb.style.width=String.format("{0}px",this.xCa),this.Lb.style.overflowX="hidden");this.Lb.offsetHeight>Bk.a.j9a||this.qjg+50>Bk.a.j9a?(this.Lb.style.height=String.format("{0}px",Bk.a.j9a),this.Lb.style.overflowY="scroll",this.Lb.style.top="0",kg.AFrameworkApplication.isRtl?this.Lb.style.right="0":this.Lb.style.left=
"0",this.OFc||(this.Lb.style.marginTop="-48px"),this.fp.style.minHeight=String.format("{0}px",this.fhg)):(this.Lb.style.overflowY="hidden",this.Lb.style.top="10%",this.Lb.style.height=this.Hgb);this.zZa()};Fb.prototype.zZa=function(){if(this.Lb){var F=this.Lb.style.zIndex;this.Lb.style.zIndex="-9999";if(this.xCa>Bk.a.k9a)kg.AFrameworkApplication.isRtl?this.Lb.style.marginRight="0":this.Lb.style.marginLeft="0";else{var fa=String.format("{0}px",Math.floor(-this.Lb.offsetWidth/2));kg.AFrameworkApplication.isRtl?
this.Lb.style.marginRight=fa:this.Lb.style.marginLeft=fa;kg.AFrameworkApplication.isRtl?this.Lb.style.right="50%":this.Lb.style.left="50%"}this.Lb.style.zIndex=String(F)}else Se.ULS.sendTraceTag(19976784,306,10,"_divMessageBox is null in CenterDialog()")};Fb.prototype.WN=function(){Rk.prototype.WN.call(this);var F=document.getElementById(this.mi(this.pjg));F.style.width=String.format("{0}px",this.xCa);F.style.height=this.Hgb};tl.Object.defineProperties(Fb.prototype,{k0a:{configurable:!0,enumerable:!0,
get:function(){return this.fp}}});Object($d.a)(Fb,"AppsForOfficeInsertionDialog",cl.a,[811]);var pk=b(1100),$k=Fj.a;vm(Qb,$k);Qb.prototype.JAg=function(F){this.addHandler(Qb.Qzd,F)};Qb.prototype.T4i=function(F){this.removeHandler(Qb.Qzd,F)};Qb.prototype.dispose=function(){Ii.a.Fa(this.Fva);this.Fva=null;$k.prototype.dispose.call(this)};Qb.prototype.$Xc=function(){this.Fva.hide()};Qb.prototype.fxj=function(F,fa){if(F){this.raiseEvent(Qb.Qzd);var Qa=F.split("|");this.sni(F,fa,Qa);this.Fva=new Fb;this.Fva.initializeAndShow("",
null,null);this.Ve.Pji(this.Fva.k0a,Qa)}};Qb.prototype.Q2e=function(F,fa,Qa){var Ab=Wg.TaskExtensions.om();if(-515602470===Qa.command||-336193495===Qa.command||2086613372===Qa.command||-1444574190===Qa.command||-1336341324===Qa.command)Ab=this.sXh(F,fa,Qa);418618014===Qa.command&&(fa=new Ej.a,fa.al=Fe.a.instance.ea(1764),Ab=this.j0(Qa,Qb.B_h,fa,!0));if((Qa.tabName===this.$.Ib+Ni.a.kQf||Qa.tabName===Ni.a.dW)&&2===Qa.df||-1!==Array.indexOf("A0 A1 Help ContactSupport WhatsNew GiveFeedback".split(" "),
F[Te.a.hd])||F[Te.a.hd]===Ni.a.XU)return this.b3e(F,Qa);if(7===Qa.df&&F.SourceControlId===this.$.Ib+Ni.a.dbc)return F.MenuItemId=Ni.a.sEd,this.b3e(F,Qa);1221897806===Qa.command&&(Ab=this.Grj(Qa));-1753056834===Qa.command&&(Ab=this.Osj(Qa));932597253===Qa.command&&(Se.ULS.sendTraceTag(537170445,0,50,"InsertPowerBIPivotTable - addin launch requested"),fi.c(932597253,!0),fa=new Ej.a,fa.al=Fe.a.instance.ea(2092),fa.sourceLocationOverrideResourceId=Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PowerBIUseDevURL",
!1)?Qb.HSi:Qb.ISi,fa.focusOnIframeWhenLoaded=!0,fa.taskPaneWidth=Qb.F6e,Ab={},Ab.LaunchSource=Object(Wi.a)(String,F.SourceControlId),Ab.LaunchMode="Default",fa.DH=Ab,Ab=this.j0(Qa,Qb.GSi,fa,!0));301511274===Qa.command&&(Ab=this.Ysj(Qa));515196233===Qa.command&&((fa=this.$.da.Aa(465))&&fa.o5e(),fa=new Ej.a,fa.al=Fe.a.instance.ea(2161),Ab={},Ab.SourceUILocation=oj.a[Qa.df],fa.DH=Ab,Ab=new Ee,Ab.xaa=Wc.a.tIa,Ab=this.j0(Qa,Qb.TNi,fa,!0,Ab,void 0,fa.al));1723441034===Qa.command&&(fa=new Ej.a,fa.al=Fe.a.instance.ea(2173),
fa.focusOnIframeWhenLoaded=!0,fa.taskPaneWidth=Qb.BVi,Ab=new Ee,Ab.xaa=Wc.a.Ikh,Ab=this.j0(Qa,Qb.AVi,fa,!0,Ab));Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataFromPictureOnXLO",!1)&&F.LoadDataFromPictureTaskpane&&(fa={},Ab=new Ej.a,Ab.al="Data From Picture",Ab.sourceLocationOverrideResourceId=F.DataFromPictureURL?F.DataFromPictureURL:"",fa.SessionID=F.SessionID,Ab.DH=fa,Ab.focusOnIframeWhenLoaded=!0,Ab=this.j0(Qa,F.DataFromPictureAssetId,Ab));return Ab};Qb.prototype.insertAgave=
function(F,fa){var Qa=this,Ab=Wg.TaskExtensions.om(),Cc=this.$,Vc=F[Lg.a.OXa];if("SourceControlId"in F){var qd={};var Gd=F.SourceControlId.split("|");if(8!==Gd.length||!(Gd[0]&&Gd[1]&&Gd[2]&&!isNaN(parseInt(Gd[2]))&&Gd[3]&&!isNaN(parseInt(Gd[3]))&&Gd[4]&&Gd[5]&&!isNaN(parseInt(Gd[5]))&&Gd[6]&&Gd[7]))return Wg.TaskExtensions.g4();Vc={};Vc.version=qd.Version=Gd[0];Vc.assetId=qd.AssetId=Gd[1];Vc.solutionId=qd.SolutionId=Gd[1];Vc.height=qd.Height=parseInt(Gd[2]);Vc.width=qd.Width=parseInt(Gd[3]);Vc.storeId=
qd.StoreId=Gd[4];Vc.targetType=qd.TargetType=parseInt(Gd[5]);Vc.assetStoreId=qd.AssetStoreId=Gd[6];Vc.storeType=qd.StoreType=Gd[7];Vc.appVersion=Gd[0];Vc.currentStoreType=Gd[7];Vc.id=Gd[1]}else qd=F[Te.a.Kg];Gd=null;Ee.key in F&&(Gd=F[Ee.key]);this.Fva&&this.Fva.hide();if(!qd||!Vc)return Se.ULS.sendTraceTag(537170444,220,10,"Inserting addin needs inserted agave parameters"),Ab;this.$.U4&&Ni.a.Ana in F&&(qd.EnabledInViewMode=F[Ni.a.Ana]);F=this.tFh(fa.command);if(!qd.EnabledInViewMode&&!Cc.xs(null,
!1,F))return Ab;var ve=void 0===qd.IsToBePersisted||null===qd.IsToBePersisted||qd.IsToBePersisted?0:16;if(1===qd.TargetType)Ab=this.A6h(qd,Vc,fa,Gd,ve);else{Vc=Xh.g(Cc);Ab=this.viewBlockContainerHelpers.teb(Vc);var jf=Cc.fa.isNamedObjectViewMode?Cc.oa.sheetName:Cc.oa.name;if(Ab){Vc=Ab.gf;var gf=Vc.Wf.top;var qg=Vc.Wf.left;var Qg=Ab.rI.x;var ph=Ab.rI.y}else gf=qg=1,Ab=this.viewBlockContainerHelpers.$Ja(Vc),Qg=Ab.x,ph=Ab.y;var Nh=this.$.qa.ta.Xb();Ab=function(Fh,Zh,ki){var gj=Cc.qa.ta,Ji=qd,tk=gf,Sj=
qg,kk=Qg,Tj=ph;Fh=oi.b(Fh,Qa.xSi);var ik=gj.Oa(9,Nh);ik.sharedInfo=Ji;ik.sheetName=jf;ik.positionRow=tk;ik.positionCol=Sj;ik.positionOffsetX=kk;ik.positionOffsetY=Tj;return Oi.i(gj,"InsertWebExtension",ik,Fh,Zh,ki,null,0)};Ag.EwaSettings.tc()?(ve|=64,Ab=xk.a(this.$.userOperationManager,Ab,function(Fh){return new rk.a(534,0,Fh,ve)},fa)):Ab=xk.a(this.$.userOperationManager,Ab,function(Fh){return new Aj.a(534,0,Fh,ve)},fa)}return Ab};Qb.prototype.XXg=function(){var F=hh.a.instance.mc("Common.App.ICustomerFeedbackUiWrapper"),
fa=hh.a.instance.mc("Common.App.CustomerFeedback.ICustomerFeedbackResourceDownloadManager");this.m9c?this.m9c.jib?this.lue():fa.instance.x5c(this.rth):Se.ULS.sendTraceTag(537170443,1302,15,"feedbackFormManager is undefined");fa={};kg.AFrameworkApplication.ga.nje(fa);F=F.instance.getContext(fa);fa={};"telemetryGroup"in F&&(fa=F.telemetryGroup);fa.processSessionId=F.sessionId;fa.officeBuild=F.build;F.telemetryGroup=fa;F.feedbackType=-1;F.userVoiceEnabled=!1;"disableIncludeScreenshot"in F||(F.disableIncludeScreenshot=
!1);"screenshot"in F||(F.screenshot=!1);F.disableScreenshotPreview=!1;F.includeScreenshotSelectedDefault=!0;return F};Qb.prototype.VSi=function(F){if(!this.L9a&&Ag.EwaSettings.la(737)&&Ag.EwaSettings.getBooleanFeatureGate(Qb.s1h,!1)){var fa=Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?"Insights.Https.PPE.Bundle":"Insights.Https.Bundle";fa=this.Sre(fa);var Qa=new Ee;Qa.Vj=Wc.a.i8c;this.L9a=this.$Jd(fa,null,!1,null,Qa);fa={};il.b(this.$).ae(ai.a.WSi,(fa.Location=
oj.a[F.df],fa.InputMethod=Oj.a[F.method],fa),void 0,!0)}};Qb.prototype.lVf=function(F){var fa=this.$.fa.ih.get(17);hh.a.instance.mc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Qa){Qa.isFeatureEnabled("mso_sendASmile",fa).then(function(Ab){F.FeedbackEnabled=fa&&Ab;return null})})};Qb.prototype.Grj=function(F){var fa=Xh.g(this.$),Qa=new Ej.a,Ab={ActiveTab:"Format"};Ab.DatapaneFlighting=Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneData",
!1);Ab.RangePickerFlighting=Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartTaskPaneDataRangePicker",!1);Ab.AceFlighting=!0;Ab.ChartNewSDXRecording=Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OfficeScriptingChartTaskPaneNewRecording",!1);Ab.ThemeColorsFlighting=Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5732064_ThemeColorsInChartsTaskpaneEnabled");Ab.UOMirror=Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UOMirror",
!1);this.lVf(Ab);Ab.startTimeMs=Date.now();Ab.UserSessionId=this.$.ya.UserSessionId;(fa=fa.ha.Qa.Up)&&(Ab.SubSelection=fa);Se.ULS.sendTraceTag(592524688,0,50,"Chart task pane launched. UserSessionId: {0}, UILocation: {1}, SubSelection: {2}",Ab.UserSessionId,void 0===F.df||null===F.df?"Null":oj.a[F.df],fa||"ChartRoot");Qa.DH=Ab;Qa.al=Fe.a.instance.ea(950);Ab=new Ee;Ab.xaa=Wc.a.tIa;return this.j0(F,Qb.RRg,Qa,!0,Ab)};Qb.prototype.Osj=function(F){var fa=new Ej.a;fa.DH={};fa.al=Fe.a.instance.ea(1752);
fa.QR=Qb.zhf;var Qa=new Ee;Qa.xaa=Wc.a.tIa;return this.j0(F,Qb.zhf,fa,!0,Qa,void 0,fa.al)};Qb.prototype.Ysj=function(F){var fa=new Ej.a;fa.DH={};fa.al=Fe.a.instance.ea(2116);var Qa=new Ee;Qa.xaa=Wc.a.tIa;return this.j0(F,Qb.Yui,fa,!0,Qa)};Qb.prototype.b3e=function(F,fa){var Qa=Qb.f5e,Ab=F[Te.a.hd].toString(),Cc={},Vc=new Ej.a;Vc.al=Fe.a.instance.ea(9);switch(Ab){case "A0":Cc.query=(F[Te.a.Kg]||"").split("|").slice(2,ok.a.hS).join("|");break;case "A1":Cc.query=F.CommandValueId;break;case "Help":Cc.gwdropdownflightinfo=
Ag.EwaSettings.la(240);Cc.query="";break;case Ni.a.sEd:Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?(Vc.al=Fe.a.instance.ea(1718),Vc.sourceLocationOverrideResourceId=Qb.G1e,Cc.feedback=this.XXg()):Cc.query=Ab;break;case "HelpArticle":Cc.query=F[Te.a.Kg];break;case "ContactSupport":case "ShowTraining":case "WhatsNew":Cc.query=Ab;break;default:return nj.Task.Ta(!0)}Vc.DH=Cc;Ab=new Ee;Ab.xaa=Wc.a.tIa;return this.j0(fa,Qa,Vc,!1,Ab,F[Ni.a.Ana]||!1)};
Qb.prototype.Sre=function(F){var fa={Version:"0.0.0.0"};fa.AssetId=Qb.zva;fa.SolutionId=Qb.zva;fa.AssetStoreId="";fa.StoreType=OSF.StoreType.Sdx;fa.Height=0;fa.Width=0;fa.StoreId=OSF.StoreType.Sdx;fa.TargetType=OSF.OsfControlTarget.TaskPane;fa.IsToBePersisted=!1;fa.SourceLocationOverrideResourceId=F;fa.SharedRuntimeId=F;fa.Id=Qb.zva;fa.CurrentStoreType=OSF.StoreType.Sdx;fa.AppVersion="0.0.0.0";return fa};Qb.prototype.sXh=function(F,fa,Qa){var Ab=this,Cc=new Ej.a,Vc=new Ee,qd={};this.lVf(qd);qd.LaunchSource=
"";qd.StartTimeMs=Date.now();qd.CorrelationId=bj.a.create().toString();Cc.DH=qd;Cc.focusOnIframeWhenLoaded=!0;Cc.taskPaneWidth=Qb.F6e;Vc.xaa=Wc.a.gmh;Vc.hyc=Wc.a.dLe;switch(Qa.command){case -1444574190:var Gd,ve;qd.LaunchMode="RecommendedPivotTables";qd.SelectionContext="";qd.LaunchSource="PivotTableHandRaise"===Object(Wi.a)(String,F.SourceControlId)?"PivotTableHandRaise":"InsertPivotTable";if(this.$&&Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4618462_PassSourceSelectionToIdeas")&&F.SourceSelection){var jf=
F.SourceSelection.split(",")[0];fa=Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4701499_IdeasSelectionIndexing")?-1:0;if(function(){var Qg=Wj.Z(jf,Ab.$.xa);Gd=Qg.sheetName;ve=Qg.bFb;gf=Qg.range;return Qg}().returnValue&&!Xh.g(this.$).Vb.S4(gf))F=this.$.xa.getItemByName(Gd),qd.SelectionContext=JSON.stringify(Object.assign(new xa,{address:ve,addressWithSheet:Gd+"!"+gf.qE(!1),sheetId:Xj.d(F),sheetName:Gd,isSheetEmpty:!1,columnCount:gf.width,rowCount:gf.height,columnIndex:gf.left+fa,rowIndex:gf.top+
fa,selectionType:"Continuous"}));else if((F=this.$.xb.getItemByName(Object(Wi.a)(String,F.SourceSelection)))&&Xj.o(F)){var gf=Tk.a(F,!0);var qg=this.$.xa.getItemByName(F.sheetName);qd.SelectionContext=JSON.stringify(Object.assign(new ta,{tableName:F.name,hasTableHeaders:Tk.d(F),isPivotTable:!1,isTable:!0,userSelectedPivotTable:!1,address:gf.qE(!1),addressWithSheet:qg.name+"!"+gf.qE(!1),sheetId:Xj.d(qg),sheetName:qg.name,isSheetEmpty:!1,columnCount:gf.width,rowCount:gf.height,columnIndex:gf.left+fa,
rowIndex:gf.top+fa,selectionType:"Continuous"}))}}Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Cc.sourceLocationOverrideResourceId="RecommendPivotTables.PPE.Bundle":Cc.sourceLocationOverrideResourceId="RecommendPivotTables.Bundle";Cc.al=Fe.a.instance.ea(1762);Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5995559_IdeasReactSvgIcons")&&(Cc.QR=Qb.ZQi);Cc.Vj=Wc.a.vNe;Vc.Vj=Wc.a.vNe;break;case -336193495:qd.LaunchMode="RecommendedCharts";Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",
!1)?Cc.sourceLocationOverrideResourceId="RecommendCharts.PPE.Bundle":Cc.sourceLocationOverrideResourceId="RecommendCharts.Bundle";Cc.al=Fe.a.instance.ea(1761);Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5995559_IdeasReactSvgIcons")&&(Cc.QR=Qb.QZi);Cc.Vj=Wc.a.wNe;Vc.Vj=Wc.a.wNe;break;case -1336341324:if(!Ag.EwaSettings.la(500))return nj.Task.Ta(!1);qd.LaunchMode="NL";Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5995559_IdeasReactSvgIcons")&&(Cc.QR=Qb.tUc);Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",
!1)?Cc.sourceLocationOverrideResourceId="IdeasNL.PPE.Bundle":Cc.sourceLocationOverrideResourceId="IdeasNL.Bundle";switch(Ag.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:Cc.al=Fe.a.instance.ea(1766);qd.NLLaunchModeBrandingCandidatesIndex=1;break;case 2:Cc.al=Fe.a.instance.ea(1767);qd.NLLaunchModeBrandingCandidatesIndex=2;break;default:Cc.al=Fe.a.instance.ea(1765),qd.NLLaunchModeBrandingCandidatesIndex=0}break;case 2086613372:if(!Ag.EwaSettings.la(235))return nj.Task.Ta(!1);
qd.LaunchMode="ChartDesigner";qd.LaunchSelectionMode=fa.toString();Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Cc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":Cc.sourceLocationOverrideResourceId="Insights.Https.Bundle";Cc.al=Fe.a.instance.ea(1768);Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5995559_IdeasReactSvgIcons")&&(Cc.QR=Qb.tUc);break;default:qd.LaunchMode="Default",Ag.EwaSettings.la(235)&&(qd.LaunchSelectionMode=fa.toString()),Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",
!1)?Cc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":Cc.sourceLocationOverrideResourceId="Insights.Https.Bundle",Cc.al=Fe.a.instance.ea(1763),Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5995559_IdeasReactSvgIcons")&&(Cc.QR=Qb.tUc),Cc.Vj=Wc.a.i8c,Vc.Vj=Wc.a.i8c}return Ag.EwaSettings.la(737)?(Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.InsightsUsePPE",!1)?Cc.sourceLocationOverrideResourceId="Insights.Https.PPE.Bundle":Cc.sourceLocationOverrideResourceId="Insights.Https.Bundle",
this.L9a?this.L9a.CWR(function(){return Ab.rTf(qd,Cc)}):this.K4h(Qa,Cc,Vc,qd)):this.j0(Qa,Qb.zva,Cc,!0,Vc)};Qb.prototype.K4h=function(F,fa,Qa,Ab){var Cc=this;this.L9a=this.$Jd(this.Sre(fa.sourceLocationOverrideResourceId),fa,!1,F,Qa,!1);return this.L9a.CWR(function(){return Cc.rTf(Ab,fa)})};Qb.prototype.rTf=function(F,fa){var Qa=this.Ve.U$(this.Ve.kJa(Qb.zva,fa.sourceLocationOverrideResourceId));if(Qa){this.Fbb[Qb.zva]=F;var Ab=this.cud(this.Ve.YY(Qa).OsfPropertyBag,Qb.zva);this.Ve.YY(Qa).OsfPropertyBag=
Ab}this.CMa(Qb.zva,"LaunchIdeasAction",F,fa);return nj.Task.Ta(!0)};Qb.prototype.j0=function(F,fa,Qa,Ab,Cc,Vc,qd){Qa=void 0===Qa?null:Qa;Ab=void 0===Ab?!1:Ab;Cc=void 0===Cc?null:Cc;Vc=void 0===Vc?!1:Vc;qd=void 0===qd?null:qd;Wg.TaskExtensions.om();Qa||(Qa=new Ej.a);var Gd={Version:"0.0.0.0"};Gd.AssetId=fa;Gd.SolutionId=fa;Gd.AssetStoreId="";Gd.StoreType=Ab?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;Gd.Height=0;Gd.Width=0;Gd.StoreId=Ab?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;Gd.TargetType=OSF.OsfControlTarget.TaskPane;
Gd.IsToBePersisted=!1;Gd.SourceLocationOverrideResourceId=Qa.sourceLocationOverrideResourceId;Gd.AppVersion="0.0.0.0";Gd.Id=fa;Gd.CurrentStoreType=Ab?OSF.StoreType.Sdx:OSF.StoreType.FirstParty;if(Qa.al||qd)this.g$c[fa]=Object.assign(new sa,{Ixc:Qa.al,uSd:qd,Gxc:Qa.QR});Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.UseApplicationFeatureHelperAPIForFeedbackAndSurvey",!1)?(Qa.DH||(Qa.DH={}),Qa.DH.ShowFeedback=this.$.isFeedbackEnabled,this.Fbb[fa]=Qa.DH):Qa.DH&&(this.Fbb[fa]=Qa.DH);
fa={};fa[Te.a.Kg]=Gd;qd={};qd.id=Gd.Id;qd.solutionId=Gd.SolutionId;qd.version=Gd.Version;qd.storeType=Gd.StoreType;qd.storeId=Gd.StoreId;qd.assetId=Gd.AssetId;qd.assetStoreId=Gd.AssetStoreId;qd.height=Gd.Height;qd.targetType=Gd.TargetType;qd.width=Gd.Width;qd.isAddinCommands=!Ab;qd.appVersion=Gd.AppVersion;qd.currentStoreType=Gd.CurrentStoreType;fa[Lg.a.OXa]=qd;Cc||(Cc=new Ee);Cc.focusOnIframeWhenLoaded=Qa.focusOnIframeWhenLoaded;Cc.width=Qa.taskPaneWidth;fa[Ee.key]=Cc;fa[Ni.a.Ana]=Vc;return this.insertAgave(fa,
F)};Qb.prototype.A6h=function(F,fa,Qa,Ab,Cc){function Vc(gf){Se.ULS.sendTraceTag(537170440,220,50,"Insert addincommands for {0} from {1}.",Telemetry.PrivacyRules.GetAssetId(gf.storeType,gf.storeId,gf.solutionId),gf.storeType);var qg={},Qg=new Ph.a;Qg.add(gf);qg[Lg.a.hFa]=Qg;qg[Lg.a.bJ]=3;gf=new ak.a(Jh.a.Ezb,0,Gd.$.ed,0,null);return Gd.$.Ka.Zb(gf,qg)}function qd(gf,qg){var Qg=gf.SolutionId;var ph=gf.StoreType;Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5624783_BiserverUseIsFirstPartyAPI")?OSF.OsfControl.isFirstPartyStoreString(ph)&&
gf.SourceLocationOverrideResourceId&&(Qg=Gd.Ve.kJa(Qg,gf.SourceLocationOverrideResourceId)):ph!==OSF.StoreType.FirstParty&&ph!==OSF.StoreType.Sdx||!gf.SourceLocationOverrideResourceId||(Qg=Gd.Ve.kJa(Qg,gf.SourceLocationOverrideResourceId));var Nh=Gd.Ve.jve(Qg,null,gf.SharedRuntimeId);if(Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5624783_BiserverUseIsFirstPartyAPI")?OSF.OsfControl.isFirstPartyStoreString(ph):ph===OSF.StoreType.FirstParty||ph===OSF.StoreType.Sdx)Ag.EwaSettings.la(299)&&Nh&&(ph=Gd.Ve.U$(Qg))&&
(Qg=null,Qg=Gd.cud(Gd.Ve.YY(ph).OsfPropertyBag,gf.SolutionId),(ph=Gd.Ve.Gi.getOsfControl(ph))&&ph.setSettings(Qg)),gf.SharedRuntimeId&&Nh||Gd.Ve.Gi.refreshOsfControl(gf.SolutionId,gf.SourceLocationOverrideResourceId);if(!Nh){var Fh=Gd.$.qa.ta.Xb(),Zh=519;Nh=function(ki,gj,Ji){var tk=Gd.$.qa.ta;ki=oi.b(ki,Gd.lEf);var Sj=tk.Oa(9,Fh);Sj.sharedInfo=gf;return Oi.i(tk,"InsertAgaveTaskpane",Sj,ki,gj,Ji,Ab,0)};void 0===gf.IsToBePersisted||null===gf.IsToBePersisted||gf.IsToBePersisted||(Zh=538,Nh=function(ki,
gj,Ji){Se.ULS.sendTraceTag(537170442,220,50,"Web Method ShowAgaveTaskpane is called, CurrentStoreType {0}, StoreId {1}, AssetId {2}.",gf.StoreType,gf.StoreId,Telemetry.PrivacyRules.GetAssetId(gf.StoreType,gf.StoreId,gf.SolutionId));var tk=Gd.$.qa.ta;ki=oi.b(ki,Gd.lEf);var Sj=tk.Oa(9,void 0===Fh?null:Fh);Sj.sharedInfo=gf;return Oi.i(tk,"ShowAgaveTaskpane",Sj,ki,gj,Ji,Ab,0)});return Ag.EwaSettings.tc()?(Cc|=64,xk.a(Gd.$.userOperationManager,Nh,function(ki){return new rk.a(Zh,0,ki,Cc)},qg)):xk.a(Gd.$.userOperationManager,
Nh,function(ki){return new Aj.a(Zh,0,ki,Cc)},qg)}return Wg.TaskExtensions.g4()}var Gd=this;if(!Ag.EwaSettings.la(53)||F.StoreId===OSF.StoreType.FirstParty)return qd(F,Qa,Ab);if(fa.isAddinCommands)return Vc(fa);var ve=new mj.a,jf={};jf.marketplaceId=F.SolutionId;jf.marketplaceVersion=F.Version;jf.storeType=F.StoreType;jf.storeId=F.StoreId;jf.targetData=F;Ag.EwaSettings.la(93)&&(jf.clearCache=!0);this.Ve.Gi.isAddinCommandsAsync(jf,function(gf,qg,Qg){ve.setResult(qg);gf||(gf=Qg.targetData,Se.ULS.sendTraceTag(537170438,
220,10,"Judging AddinCommands failed for {0} from {1} during addin inserting",Telemetry.PrivacyRules.GetAssetId(gf.StoreType,gf.StoreId,gf.SolutionId),gf.StoreType))});return Wg.TaskExtensions.ts(ve.task,function(gf){return gf.result?Vc(fa):qd(F,Qa,Ab)},this.$.ma)};Qb.prototype.cud=function(F,fa){if(!this.Fbb[fa])return F;var Qa={};if(F){F=yl(F);for(var Ab=F.next();!Ab.done;Ab=F.next())Ab=Ab.value,Qa[Ab[0]]=Ab[1]}F=this.Fbb[fa];Ab=yl(Object.keys(F));for(fa=Ab.next();!fa.done;fa=Ab.next())fa=fa.value,
fa===Qb.tth&&Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)?Qa[fa]=Sys.Serialization.JavaScriptSerializer.serialize(F[fa]):Qa[fa]=Sys.Serialization.JavaScriptSerializer.serialize(F[fa].toString());fa=Object.keys(Qa).length;F=Array(fa);Ab=0;var Cc=yl(Object.keys(Qa));for(fa=Cc.next();!fa.done;fa=Cc.next())fa=fa.value,F[Ab]=[fa,Qa[fa].toString()],Ab++;return F};Qb.prototype.sni=function(F,fa,Qa){var Ab=this.$.ya.UserSessionId,Cc=this.$.ya.UICultureTag,
Vc=this.$.ya.UICultureTagLcid,qd=this.$.ya.WacHostId,Gd="",ve="";5<=Qa.length&&(Gd=Qa[3],ve=Qa[4]);this.tni(Gd,ve,F,fa,Cc,Vc,Ab,qd)};Qb.prototype.tni=function(F,fa,Qa,Ab,Cc,Vc,qd,Gd){var ve={};ve.a=qd;ve.b=Qa;ve.c=Ab;ve.d=F;ve.e=fa;ve.f=Cc;ve.g=Vc;ve.h=Gd;Ij.b().Ne(36,ve)};Qb.prototype.lue=function(){if(jk.a.Mpf())Se.ULS.sendTraceTag(537170433,1302,15,"OBF is undefined");else{try{OfficeBrowserFeedback.createScreenshot(document.body).then(this.nEf);return}catch(F){Se.ULS.sendTraceTag(537170432,1302,
15,"Failed to use createScreenshot "+(F?F.toString():null))}try{OfficeBrowserFeedback.html2canvas(document.body,null)().then(this.nEf)}catch(F){Se.ULS.sendTraceTag(537170403,1302,15,"Failed to use html2canvas"+(F?F.toString():null))}}};Qb.prototype.$Jd=function(F,fa,Qa,Ab,Cc,Vc){fa=void 0===fa?null:fa;Qa=void 0===Qa?!1:Qa;Ab=void 0===Ab?null:Ab;Cc=void 0===Cc?null:Cc;Vc=void 0===Vc?!0:Vc;var qd=F.SolutionId,Gd=nj.Task.Ta(!1);F&&qd&&F.SharedRuntimeId&&(Ab=Ab||new ak.a(-859308420,0,2,0,""),qd={},qd.id=
F.Id,qd.solutionId=F.SolutionId,qd.version=F.Version,qd.storeType=F.StoreType,qd.storeId=F.StoreId,qd.assetId=F.AssetId,qd.assetStoreId=F.AssetStoreId,qd.height=F.Height,qd.targetType=F.TargetType,qd.width=0,qd.isAddinCommands=!1,qd.sharedRuntimeId=F.SharedRuntimeId,F.Preload=Vc,qd.appVersion=F.AppVersion,qd.currentStoreType=F.CurrentStoreType,Cc=Cc?Cc:new Ee,Cc.width=0,fa&&(Cc.focusOnIframeWhenLoaded=fa.focusOnIframeWhenLoaded,Vc=new sa,fa.al&&(Vc.Ixc=fa.al),0<fa.taskPaneWidth&&(Vc.nr=fa.taskPaneWidth),
fa.QR&&Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5995559_IdeasReactSvgIcons")&&(Vc.Gxc=fa.QR),this.g$c[F.SolutionId]=Vc),fa={},fa[Te.a.Kg]=F,fa[Lg.a.OXa]=qd,fa[Ee.key]=Cc,fa[Ni.a.Ana]=Qa,Gd=this.insertAgave(fa,Ab));return Gd};Qb.prototype.CMa=function(F,fa,Qa,Ab){Ab=void 0===Ab?null:Ab;if(F&&fa){F=new Ai.a(F,OSF.StoreType.Sdx,OSF.StoreType.Sdx,"1.0.0.0");var Cc=new vi.a("ExcelOnline","Web",this.$.ya.UICultureTag),Vc=new kj.a;Vc.ni[le.sRc]=Qa;Ab&&(Qa=Ab,Qa.sourceLocationOverrideResourceId&&(Vc.ni[le.sourceLocationOverrideResourceId]=
Qa.sourceLocationOverrideResourceId),Qa.al&&(Vc.ni[le.al]=Qa.al),Qa.Vj&&(Vc.ni.IconCssClass=Qa.Vj),Qa.pSd&&(Vc.ni.TaskPaneIconUrl=Qa.pSd),Qa.QR&&(Vc.ni.TaskPaneIconId=Qa.QR));zi.a.instance.CMa(F,rj.a.action,fa,Cc,Vc)}};Qb.prototype.MNh=function(F){if(!Bi.a.yj(F)){var fa=F[pk.a.n7b];if(fa&&(fa=fa.getId(),F=F[pk.a.iya],fa&&F))return this.kJa(fa,F.ni[le.sourceLocationOverrideResourceId])}return null};Qb.prototype.kJa=function(F,fa){fa=void 0===fa?null:fa;return F&&fa?String.format("{0}.{1}",F,fa):F};
Qb.prototype.tFh=function(F){switch(F){case 1221897806:return 2;case -515602470:case 2086613372:return Ag.EwaSettings.la(235)?1023:1;case 1723441034:return 1023;case -859308420:return 1023;case 515196233:return 1023;default:return 1}};Qb.s1h="Microsoft.Office.Excel.IdeasXLOPreload";Qb.Qzd="IDS";Qb.f5e="FA000000012";Qb.zva="FA000000005";Qb.B_h="HelloWorld";Qb.RRg="FA000000014";Qb.G1e="Help.GiveFeedback.Url";Qb.tth="feedback";Qb.zhf="FA000000066";Qb.ISi="PowerBi.Url";Qb.HSi="PowerBi.DevUrl";Qb.GSi=
"FA000000054";Qb.Yui="FA000000064";Qb.TNi="FA000000075";Qb.AVi="FA000000080";Qb.tUc="AnalyzeDataTaskPane";Qb.QZi="RecommendedChartsTaskPane";Qb.ZQi="PivotTableTaskPane";Qb.X8g=350;Qb.F6e=320;Qb.BVi=320;Object($d.a)(Qb,"AgaveCommandManager",Fj.a,[793,794]);tl.Object.defineProperties(Gb,{instance:{configurable:!0,enumerable:!0,get:function(){return Gb.Na}}});Gb.Na=new Gb;Object($d.a)(Gb,"AppsDataManagerFactory",null,[]);Object($d.a)(function(F,fa){this.httpStatus=F;this.data=fa},"AppData",null,[]);
hb.prototype.Vwb=function(F){this.wgg(this.ygg,F)};hb.prototype.zW=function(F,fa,Qa,Ab){F?(fa={},Se.ULS.sendTraceTag(6070477,344,15,"The request datatype is not supported.  {0}",(fa.dataType=F,fa))):this.ub&&this.Og&&fa?this.Og.Ul(String.format("{0}AppsForOfficeProxy.ashx?lcid={1}&syslcid={1}&uilcid={1}&rt=xml&client={2}&cv=16.1.0.0",this.ub.appSettings.WebServiceBase,kg.AFrameworkApplication.lcid,fa),1,"",null,!0,2,Qa,Ab,null):Se.ULS.sendTraceTag(6070476,344,10,"The request objects are not available")};
Object($d.a)(hb,"AppsDataProvider",null,[797]);var el=ij.a;vm(ya,el);ya.prototype.create=function(){var F=this,fa=this.$.da,Qa=Zi.GetServiceTaskFactory.create(fa,106,this.ma,this.tb),Ab=Zi.GetServiceTaskFactory.create(fa,104,this.ma,this.tb),Cc=Ke.a.loadScript(36,0,this.tb,void 0,void 0,375);Wg.TaskExtensions.Ba(Wg.TaskExtensions.ve([Ab,Qa,Cc],this.ma),function(){var Vc=new oc(of.a.instance),qd=new hb(kg.AFrameworkApplication.ga,kg.AFrameworkApplication.Hd,"WAC_Excel");new Yb(Vc,qd,"PreinstalledAppsData_Excel");
Vc=null;Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FeedbackTaskPaneExperienceEnabled",!1)&&(Vc=hh.a.instance.mc("Common.App.CustomerFeedback.ICustomerFeedbackFormManager").instance);lb.instance.initialize(Qa.result);Vc=new Qb(F.$,Qa.result,Ab.result,Vc,kg.AFrameworkApplication.Eb);fa.Ha(206,Vc);F.Fb(fa.Aa(374)||fa.Ha(374,Vc))},this.ma,3);hh.a.instance.register(Vi.a,"Common.Utils.AriaNotifier").as("Common.Utils.IAriaNotifier").zc().Ic(function(){return new Vi.a(F.$.Ey)})};ya.ja=function(F){F.da.Ha(375,
new ya(F))};Object($d.a)(ya,"AgaveCommandManagerFactory",ij.a,[]);var Xi=b(859);da.prototype.getTypeName=function(){return"Microsoft.Authentication.OfficeIdentityInfo"};da.prototype.invokePropertyGet=function(F){switch(F){case 4:return this.displayName;case 3:return this.email;case 2:return this.federationProvider;case 1:return this.identityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};da.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};
da.prototype.invokePropertySet=function(F,fa){switch(F){case 4:this.displayName=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(fa,0,"string");return;case 3:this.email=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(fa,0,"string");return;case 2:this.federationProvider=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(fa,0,"string");return;case 1:this.identityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(fa,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
};da.prototype.invokePropertySetAsync=function(F,fa){this.invokePropertySet(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};da.prototype.invokeMethod=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};da.prototype.invokeMethodAsync=function(F,fa){F=this.invokeMethod(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};da.T1g=function(F){var fa=new da;fa.displayName=F.displayName;fa.email=F.email;switch(F.authority){case Dg.rBf:fa.identityType=
1;break;default:fa.identityType=0}fa.federationProvider="";return fa};tl.Object.defineProperties(da.prototype,{displayName:{configurable:!0,enumerable:!0,get:function(){return this.Iea},set:function(F){this.Iea=F}},email:{configurable:!0,enumerable:!0,get:function(){return this.U2d},set:function(F){this.U2d=F}},federationProvider:{configurable:!0,enumerable:!0,get:function(){return this.D3d},set:function(F){this.D3d=F}},identityType:{configurable:!0,enumerable:!0,get:function(){return this.Lhb},set:function(F){this.Lhb=
F}}});Object($d.a)(da,"OfficeIdentityInfo",null,[]);Tb.p$b=function(F){return F in Tb.uJe?Tb.uJe[F].toString():F};tl.Object.defineProperties(Tb,{uJe:{configurable:!0,enumerable:!0,get:function(){return Tb.Mjg}}});Tb.map=null;var vj={};Tb.Mjg=(vj.GeneralException=Xi.a.generalException,vj.AccessDenied=Xi.a.oRc,vj.ApiNotAvailable=Xi.a.apiNotAvailable,vj.UserNotSignedIn=Xi.a.userNotSignedIn,vj.UserAborted=Xi.a.userAborted,vj.UnsupportedUserIdentity=Xi.a.XHj,vj.InvalidResourceUrl=Xi.a.invalidResourceUrl,
vj.InvalidGrant=Xi.a.invalidGrant,vj.AddinIsAlreadyRequestingToken=Xi.a.jDg,vj.ResourceNotAllowed=Xi.a.z$i,vj.ClientError=Xi.a.clientError,vj.ServerError=Xi.a.serverError,vj);Object($d.a)(Tb,"SingleSignOnErrorCodeMap",null,[]);Sb.prototype.getTypeName=function(){return"Microsoft.Authentication.SingleSignOnToken"};Sb.prototype.invokePropertyGet=function(F){switch(F){case 2:return this.accessToken;case 3:return this.tokenIdenityType}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
};Sb.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};Sb.prototype.invokePropertySet=function(F,fa){switch(F){case 2:this.accessToken=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(fa,0,"string");return;case 3:this.tokenIdenityType=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(fa,0,"int");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};Sb.prototype.invokePropertySetAsync=
function(F,fa){this.invokePropertySet(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};Sb.prototype.invokeMethod=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};Sb.prototype.invokeMethodAsync=function(F,fa){F=this.invokeMethod(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};tl.Object.defineProperties(Sb.prototype,{accessToken:{configurable:!0,enumerable:!0,get:function(){return this.hfb},set:function(F){this.hfb=
F}},tokenIdenityType:{configurable:!0,enumerable:!0,get:function(){return this.Lhb},set:function(F){this.Lhb=F}}});Object($d.a)(Sb,"SingleSignOnToken",null,[]);Xa.prototype.getTypeName=function(){return"Microsoft.Authentication.TokenParameters"};Xa.prototype.invokePropertyGet=function(F){switch(F){case 3:return this.authChallenge;case 7:return this.correlationId;case 4:return this.policy;case 2:return this.resource;case 5:return this.scope;case 6:return this.silentLogin}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
};Xa.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};Xa.prototype.invokePropertySet=function(F,fa){switch(F){case 3:this.authChallenge=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(fa,0,"string");return;case 7:this.correlationId=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(fa,0,"string");return;case 4:this.policy=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(fa,0,"string");
return;case 2:this.resource=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(fa,0,"string");return;case 5:this.scope=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(fa,0,"string");return;case 6:this.silentLogin=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(fa,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};Xa.prototype.invokePropertySetAsync=function(F,fa){this.invokePropertySet(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
Xa.prototype.invokeMethod=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};Xa.prototype.invokeMethodAsync=function(F,fa){F=this.invokeMethod(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};tl.Object.defineProperties(Xa.prototype,{authChallenge:{configurable:!0,enumerable:!0,get:function(){return this.f_d},set:function(F){this.f_d=F}},correlationId:{configurable:!0,enumerable:!0,get:function(){return this.nD},set:function(F){this.nD=F}},
policy:{configurable:!0,enumerable:!0,get:function(){return null},set:function(){}},resource:{configurable:!0,enumerable:!0,get:function(){return this.bUb},set:function(F){this.bUb=F}},scope:{configurable:!0,enumerable:!0,get:function(){return this.nde},set:function(F){this.nde=F}},silentLogin:{configurable:!0,enumerable:!0,get:function(){return this.Aee},set:function(F){this.Aee=F}}});Object($d.a)(Xa,"TokenParameters",null,[647]);Cb.prototype.getAccessToken=function(F){var fa=this,Qa=this.jgb.getOsfControl(this.Rz),
Ab=Qa.getManifest(),Cc=Ab.getMarketplaceID();this.VMa(F,Cc);return OfficeExtension.WacRuntime.Utility.createPromise(function(Vc,qd){Qa.isFirstParty()&&fa.jgb._enableFirstPartySSO?fa.V8h(Ab,F)?hh.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAccessToken(F,Cc).then(function(Gd){Vc(Gd)},function(Gd){qd(Gd)}):qd(Xi.a.oRc):qd(Xi.a.apiNotAvailable)}).then(function(Vc){switch(Vc.authority){case Dg.rBf:var qd=1;break;default:qd=0}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(new Sb(Vc.accessToken,
qd))},function(Vc){fa.logErrorResponse(F,Cc,Vc);return Vc?OfficeExtension.WacRuntime.Utility.createPromise(function(qd,Gd){Gd(OfficeExtension.WacRuntime.Utility.createRichApiException(Vc,Tb.p$b(Vc)))}):OfficeExtension.WacRuntime.Utility.createPromise(function(qd,Gd){Gd(OfficeExtension.WacRuntime.Utility.createRichApiException(Xi.a.generalException,Tb.p$b(Xi.a.generalException)))})})};Cb.prototype.getAuthContext=function(){return null};Cb.prototype.getPrimaryIdentityInfo=function(){var F=this.jgb.getOsfControl(this.Rz);
F.getManifest();var fa=F.getManifest().getMarketplaceID();return OfficeExtension.WacRuntime.Utility.createPromise(function(Qa,Ab){hh.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getPrimaryIdentityInfo(fa).then(function(Cc){Qa(Cc)},function(Cc){Ab(Cc.toString())})}).then(function(Qa){Qa=da.T1g(Qa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(Qa)},function(Qa){return Qa?OfficeExtension.WacRuntime.Utility.createPromise(function(Ab,Cc){Cc(OfficeExtension.WacRuntime.Utility.createRichApiException(Qa,
Tb.p$b(Qa)))}):OfficeExtension.WacRuntime.Utility.createPromise(function(Ab,Cc){Cc(OfficeExtension.WacRuntime.Utility.createRichApiException(Xi.a.generalException,Tb.p$b(Xi.a.generalException)))})})};Cb.prototype.getTypeName=function(){return"Microsoft.Authentication.AuthenticationService"};Cb.prototype.invokePropertyGet=function(F){switch(F){case 99:return this.roamingSettings}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};Cb.prototype.invokePropertyGetAsync=function(F){F=
this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};Cb.prototype.invokePropertySet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};Cb.prototype.invokePropertySetAsync=function(F,fa){this.invokePropertySet(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};Cb.prototype.invokeMethod=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};Cb.prototype.invokeMethodAsync=
function(F,fa){switch(F){case 1:return this.SBh(fa);case 3:return this.iDh();case 2:return this.MOh()}F=this.invokeMethod(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};Cb.prototype.SBh=function(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,Xa);return this.getAccessToken(F)};Cb.prototype.iDh=function(){return this.getAuthContext()};Cb.prototype.MOh=function(){return this.getPrimaryIdentityInfo()};Cb.prototype.V8h=function(F,fa){var Qa=!1,Ab=F.getWebApplicationAuthorizations();
F=null;Ab=yl(Ab);for(var Cc=Ab.next();!Cc.done;Cc=Ab.next())if(Cc=Cc.value,Cc.getResource().toLowerCase()===fa.resource.toLowerCase()){F=Cc;Qa=!0;break}if(!Qa)return!1;fa=fa.scope.split(" ,+");fa=yl(fa);for(Qa=fa.next();!Qa.done;Qa=fa.next())if((Qa=Qa.value)&&Qa.length){Ab=!1;Cc=yl(F.getScopes());for(var Vc=Cc.next();!Vc.done;Vc=Cc.next())Qa.toLowerCase()===Vc.value.toLowerCase()&&(Ab=!0);if(!Ab)return!1}return!0};Cb.prototype.VMa=function(F,fa){F=this.Fpf(F.resource);var Qa={};Se.ULS.sendTraceTag(538572831,
369,50,"{0}",(Qa.manifestId=fa,Qa.resource=F,Qa))};Cb.prototype.logErrorResponse=function(F,fa,Qa){F=this.Fpf(F.resource);var Ab={};Se.ULS.sendTraceTag(538572830,369,10,"{0}",(Ab.manifestId=fa,Ab.resource=F,Ab.error=Qa,Ab))};Cb.prototype.Fpf=function(F){return F.replace("://","__").replace(RegExp("\\.","g"),"_dot_").replace("/","\\")};tl.Object.defineProperties(Cb.prototype,{roamingSettings:{configurable:!0,enumerable:!0,get:function(){return null}}});Object($d.a)(Cb,"AuthenticationService",null,
[]);ob.prototype.create=function(F,fa){return new Cb(F,fa)};Object($d.a)(ob,"AuthenticationServiceFactory",null,[]);var J=b(989),oa=b(1121),Va=b(1083);Ma.generalException="generalException";Ma.invalidArgument="invalidArgument";Ma.notAllowed="notAllowed";Ma.apiNotAvailable="apiNotAvailable";Ma.unresolvedPendingRequest="unresolvedPendingRequest";Ma.timeout="timeout";Ma.adalTimeout="adalTimeout";Ma.userNotSignedIn="userNotSignedIn";Ma.userAborted="userAborted";Ma.silentSignInFailed="silentSignInFailed";
Ma.invalidResourceUrl="invalidResourceUrl";Ma.invalidGrant="invalidGrant";Ma.connectionLost="connectionLost";Ma.clientError="clientError";Ma.serverError="serverError";Object($d.a)(Ma,"WopiHostErrorCodes",null,[]);Object($d.a)(Ia,"OAuthCallerMetadata",null,[]);pa.prototype.Iug=function(F,fa,Qa,Ab,Cc,Vc){var qd=this;if(!this.cxa)return Ab=new oa.a,Ab.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,Promise.resolve(Ab);var Gd=new Ia;Gd.AddinName=Cc;Gd.AddinTrustId=Vc;var ve=-1;Vc=null;
if(Ab&&this.gbf())Vc=this.cxa.u7f(Lg.a.Xxc,F,Ab,pa.DZe(Cc),Gd);else{var jf=Date.now();Vc=this.cxa.YR(Lg.a.Xxc,F,Gd).then(function(gf){ve=Date.now()-jf;var qg=(fa||Qa)&&"login_required"===gf.ErrorCode;return(fa&&("interaction_required"===gf.ErrorCode||"consent_required"===gf.ErrorCode||"invalid_grant"===gf.ErrorCode)||qg)&&qd.gbf()?qd.cxa.u7f(Lg.a.Xxc,F,null,pa.DZe(Cc),Gd):Promise.resolve(gf)})}return Vc.then(function(gf){var qg=new oa.a;gf.IsSuccess?(qg.token=gf.Token,gf.Telemetry&&(qg.mSa=gf.Telemetry.fromCache,
qg.expiresOn=gf.Telemetry.expiresOn)):(qg.errorCode=qd.Gqi(gf),qg.ySd=qd.iPi(gf));return qg}).catch(function(){var gf=new oa.a;gf.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;return Promise.resolve(gf)}).then(function(gf){gf.Iga="OauthManager";0<=ve&&(gf.Tub=ve);return gf})};pa.prototype.dai=function(F){var fa=(kg.AFrameworkApplication.ga.Ua(kg.AFrameworkApplication.Pna)||"").toLowerCase();return(zh.a.qka||"teams"===fa&&Cj.a.$vb)&&!pa.I$h(F)||!this.cxa||!this.cxa.gLa()?!1:!0};pa.prototype.gbf=
function(){return this.Djg||1!==Va.a.s9b()};pa.prototype.Gqi=function(F){switch(F.ErrorCode){case "UserCancelled":case "interaction_required":F=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted;break;case "consent_required":case "invalid_grant":F=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant;break;case "login_required":F=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform;break;case "invalid_client":case "invalid_application_ID":F=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;
break;case "invalid_resource":F=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl;break;case "popup_window_error":F=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost;break;default:F=F.ErrorCode===Ma.userAborted?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUserAborted:F.ErrorCode===Ma.silentSignInFailed?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform:F.ErrorCode===Ma.invalidResourceUrl?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl:F.ErrorCode===Ma.invalidGrant?
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant:F.ErrorCode===Ma.connectionLost?OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOConnectionLost:OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError}return F};pa.prototype.iPi=function(F){var fa="";(F=RegExp("AADSTS(\\d+)").exec(F.ErrorMessage))&&1<F.length&&(fa=F[1]);return fa};pa.DZe=function(F){return String.format(CommonUIStrings.l_SSOSignInNeededNotification_Description_Text_Addins,F)};pa.I$h=function(F){if(!F)return!1;F=F.toLowerCase();for(var fa=
yl(J.AppsForOfficeSingleSignOnManager.XQe),Qa=fa.next();!Qa.done;Qa=fa.next())if(Qa.value===F)return!0;return!1};Object($d.a)(pa,"AppsforOfficeTokenFromOauthManager",null,[190]);ma.Nna=function(){if(kg.AFrameworkApplication.ga.ra("AppForOfficeSSOV2IsEnabled")){var F=null;try{F=hh.a.instance.resolve("Common.App.OAuth.IOAuthManager")}catch(fa){Se.ULS.sendTraceTag(592061330,1300,10,"Unable to resolve IOAuthManager: "+fa)}F=new pa(F);ma.Na=new ma(F)}};ma.getInstance=function(){ma.x5d||(ma.Nna(),ma.x5d=
!0);return ma.Na};ma.Na=null;ma.x5d=!1;Object($d.a)(ma,"AppsForOfficeOauthManagerFactory",null,[166]);var Ub=b(128);Object($d.a)(wa,"NewDocumentParameters",null,[]);var e=b(156);na.prototype.createAndOpenWorkbook=function(F){var fa=this;if(F&&F.length>this.Ong)throw Se.ULS.sendTraceTag(538572821,0,15,"Too large base64 stream size:{0}",F.length),OfficeExtension.WacRuntime.Utility.createRichApiException(Xi.a.invalidArgument,e.a.ea(1712));var Qa=new wa("blank","agave",F?"streamBase64":"streamEmpty",
F),Ab=null;return OfficeExtension.WacRuntime.Utility.createPromise(function(Cc,Vc){var qd=new Ub.StandardDialog;qd.kc=4;qd.Kk(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,function(Gd){2!==Gd&&Gd?(Ab=window.open(""),fa.mog.create(Cc,Vc,Qa).y_a()):Vc("Cancelled")})}).then(function(Cc){if(!Cc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(Xi.a.generalException,e.a.ea(1708));try{Ab.top.location.href=Cc}catch(Vc){Se.ULS.sendTraceTag(538572820,
0,10,"CreateWorkbook API - exception while trying to change Window.Top.Location.Href, isChrome:{0}, exception:{1}",zh.a.Po,Vc),Se.ULS.sendTraceTag(538572819,0,50,"CreateWorkbook API: calling self Window.Location.Replace instead of Window.Top.Location.Replace"),Ab.location.replace(Cc)}return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)},function(Cc){if("Cancelled"===Cc)throw OfficeExtension.WacRuntime.Utility.createRichApiException(Xi.a.Tzd,e.a.ea(1711));Ab.close();fa.CBj();return null})};
na.prototype.getTypeName=function(){return"Microsoft.ExcelServices.WacWorkbook"};na.prototype.invokePropertyGet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};na.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};na.prototype.invokePropertySet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};na.prototype.invokePropertySetAsync=function(F,
fa){this.invokePropertySet(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};na.prototype.invokeMethod=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};na.prototype.invokeMethodAsync=function(F,fa){switch(F){case 1:return this.G_g(fa)}F=this.invokeMethod(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};na.prototype.G_g=function(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");return this.createAndOpenWorkbook(F)};
na.prototype.CBj=function(){throw OfficeExtension.WacRuntime.Utility.createRichApiException(Xi.a.generalException,e.a.ea(1708));};Object($d.a)(na,"WacWorkbook",null,[]);var C=b(858),M=b(868);tl.Object.defineProperties(ca.prototype,{$:{configurable:!0,enumerable:!0,get:function(){return this.vb}}});Object($d.a)(ca,"RichApiPreviewExecutionContext",null,[]);var qa=b(24),Na=b(1015),Hb=b(201),Gc=b(203),gd=b(114),Uc=b(11),Wd=Gc.a;vm(ba,Wd);ba.prototype.start=function(F,fa){var Qa="<div class='"+gd.a.qjh+
" "+Wc.a.Ir+"'><label for='{1}'>{0}</label></div>\r\n<div><input type='text' id='{1}' maxlength='388' class='"+gd.a.vU+"' /></div>";Qa=String.format(Qa,Ea.a.If(this.W3c.DdaBindingsMethod.PromptText.substr(0,200)),"bindingText");this.Ob.innerHTML=Qa;this.Jnb=Uc.DOMElementExtensions.getElementById(this.Ob,"bindingText");F=fa?F.z1a(fa,this.W3c.DdaBindingsMethod.BindingId):null;(null===F||void 0===F?0:F.IsValidRef)?(fa=new qa.Range(F.Reference.FirstRow+1,F.Reference.FirstColumn+1,F.Reference.LastRow+
1,F.Reference.LastColumn+1,!1,!1),this.Jnb.value=F.Reference.SheetName+"!"+fa):(F=Xh.g(this.$).ha,this.Jnb.value=Xj.f(this.$.oa)||!F.va.Dh?"":F.Lha);this.initialize();this.mf()};ba.prototype.lm=function(){this.uZc();this.addButton(0);this.addButton(1);Wd.prototype.lm.call(this)};ba.prototype.setFocus=function(){Uc.DOMElementExtensions.setFocus(this.Jnb)};ba.prototype.validate=function(){return!0};ba.prototype.commit=function(){var F=this.Jnb.value.trim(),fa=F.indexOf("!");-1!==fa&&(F=this.ARh(F.substring(0,
fa))+F.substr(fa));this.qDe.addBinding(this.W3c,F,0,this.callback);return!0};ba.prototype.dGa=function(){this.qDe.ZP.vf(C.a.internalError,this.callback);Wd.prototype.dGa.call(this)};ba.prototype.ARh=function(F){F=Rj.a.trimStart(F.trim(),"=");return F.length?F.startsWith("'")&&F.endsWith("'")?F:Eh.HelperMethods.x6b(F):""};tl.Object.defineProperties(ba.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"DdaBindingPrompt"}}});Object($d.a)(ba,"DdaBindingPrompt",Gc.a,[]);O.prototype.vf=
function(F,fa){if(fa){var Qa={};Qa.Error=F;Qa.Version=this.fa.rf;fa(Qa)}};O.prototype.jJa=function(F,fa){this.vf(F,fa)};O.prototype.JG=function(F,fa){this.vf(C.a.sSe(F.Errors[0].MessageId),fa)};O.prototype.Au=function(F){F&&F(this.BP())};O.prototype.BP=function(){var F={Error:0};F.Version=this.fa.rf;return F};Object($d.a)(O,"DdaErrorGenerator",null,[]);var We=b(302),Gf=b(105);Q.prototype.Zud=function(F,fa){function Qa(Gd){var ve=Ab.$.xa.getItemByName(Gd.SheetName);(null===ve||void 0===ve?0:ve.visible)?
(Xh.g(Ab.$).yi(Gd,null,null,null,3,Gf.a.c8g,void 0,void 0,void 0,void 0,!0),Ab.ZP.Au(fa)):Ab.ZP.vf(C.a.CQg,fa)}var Ab=this,Cc=F.DdaGoToByIdMethod.GoToType,Vc=F.DdaGoToByIdMethod.SelectionMode,qd=F.DdaGoToByIdMethod.Id.toString().trim();Cc?1===Cc?this.Sui(qd,Vc,Qa,fa):this.ZP.vf(C.a.UHj,fa):this.Oui(qd,Vc,F.DdaMethod.ControlId,Qa,fa)};Q.prototype.Oui=function(F,fa,Qa,Ab,Cc){var Vc=this;this.Ez.ddaGetBinding(Qa,F,function(qd){if(!We.a(qd)&&qd.Result&&qd.Result.Reference){qd=qd.Result;var Gd={};Gd.SheetName=
qd.Reference.SheetName;Gd.FirstRow=qd.Reference.FirstRow;Gd.FirstColumn=qd.Reference.FirstColumn;Gd.LastRow=qd.Reference.LastRow;Gd.LastColumn=qd.Reference.LastColumn;Q.gUc(Gd,fa);1!==qd.BindingType?Ab(Gd):Vc.Ez.ddaGetBindingData(Qa,F,1,0,2,0,0,-1,-1,function(ve){We.a(ve)||!ve.Result?Vc.ZP.JG(ve,Cc):(ve=ve.Result,2!==fa&&(Gd.FirstRow-=ve.Headers.length,0>Gd.FirstRow&&(Gd.FirstRow=0)),Ab(Gd))},Cc)}else Vc.ZP.jJa(C.a.x1f,Cc)},Cc)};Q.prototype.Sui=function(F,fa,Qa,Ab){var Cc=this,Vc=Wj.z(F);Vc?(Vc=Wj.v(Vc,
this.$),Q.gUc(Vc,fa),Qa(Vc)):this.$.fa.isNamedObjectViewMode&&this.$.xb.tj(F)?this.$.xb.oa=this.$.xb.getItemByName(F):(Vc=function(qd){We.a(qd)||!qd.Result?Cc.$.xa.contains(F)?(qd={},qd.SheetName=F,qd.FirstRow=0,qd.FirstColumn=0,qd.LastRow=0,qd.LastColumn=0,Qa(qd)):Cc.ZP.jJa(C.a.x1f,Ab):(qd=qd.Result,Q.gUc(qd,fa),Qa(qd))},this.$.xa.oa?this.Ez.parseRangeForGoto(F,this.$.xa.oa.name,Vc,Ab):this.Ez.parseRange(F,Vc,Ab))};Q.gUc=function(F,fa){F.LastRow=2===fa?F.FirstRow:F.LastRow;F.LastColumn=2===fa?F.FirstColumn:
F.LastColumn};Object($d.a)(Q,"DdaNavigator",null,[]);var xg=b(287),Hg;(function(F){F[F.unsupported=0]="unsupported";F[F.surface=1]="surface";F[F.combo=2]="combo";F[F.column=3]="column";F[F.column3D=4]="column3D";F[F.bar=5]="bar";F[F.bar3D=6]="bar3D";F[F.line=7]="line";F[F.line3D=8]="line3D";F[F.pie=9]="pie";F[F.pie3D=10]="pie3D";F[F.scatter=11]="scatter";F[F.bubble=12]="bubble";F[F.area=13]="area";F[F.area3D=14]="area3D";F[F.doughnut=15]="doughnut";F[F.radar=16]="radar";F[F.stock=17]="stock";F[F.waterfall=
18]="waterfall";F[F.funnel=19]="funnel";F[F.treemap=20]="treemap";F[F.sunburst=21]="sunburst";F[F.boxWhisker=22]="boxWhisker";F[F.histogram=23]="histogram";F[F.pareto=24]="pareto";F[F.regionMap=25]="regionMap";F[F.noVisibleSeries=26]="noVisibleSeries";F[F.complexDataSource=27]="complexDataSource";F[F.pivotChart=28]="pivotChart"})(Hg||(Hg={}));Object($d.b)("ChartCategory",Hg);Object($d.a)(R,"MacroRecorderEventData",null,[]);W.prototype.aQh=function(F){var fa;if(void 0===F||null===F||void 0===F.RequestBody||
null===F.RequestBody)return null;var Qa=JSON.parse(F.RequestBody);if(void 0!==F.ActiveChartId&&null!==F.ActiveChartId){Qa.ActiveChartId=F.ActiveChartId;var Ab=Xh.g(this.$).ha.Qa.nc;if(null===(fa=null===Ab||void 0===Ab?void 0:Ab.floatingObject)||void 0===fa?0:fa.Yc)Qa.ActiveChartType=Hg[Ab.floatingObject.Yc.ChartCategory]}void 0!==F.SheetMultiRange&&null!==F.SheetMultiRange&&(Qa.SheetName=F.SheetMultiRange.SheetName);return Qa};W.prototype.iQh=function(F){if(void 0===F||null===F||void 0===F.Result||
null===F.Result)return null;F=F.Result;return void 0===F.ResponseBody||null===F.ResponseBody||F.ResponseBody[0].startsWith('{"Error":')?null:JSON.parse(F.ResponseBody.join(""))};W.prototype.eei=function(F){return!!F&&!(void 0===F.eventId||null===F.eventId)&&0<F.eventId.length};W.prototype.Wl=function(F){var fa=this;return function(){if(fa.$.Taa){var Qa=fa.MMg(fa.request);if(fa.eei(Qa)){var Ab=fa.aQh(fa.request),Cc=fa.iQh(F);if(Ab&&!Bi.a.isEmpty(Ab)&&Cc&&!Bi.a.isEmpty(Cc))return Se.ULS.sendTraceTag(537163164,
0,50,"[RichApiRecorder]: Creating a MacroRecorderRichApiRequestExecutedPayload object."),new hf(Qa,Ab,Cc);Qa=String.format("requestInfo: {0}; responseInfo: {1}",Ab?"(not null)":"(null)",Cc?"(not null)":"(null)");Se.ULS.sendTraceTag(537163163,0,50,"[RichApiRecorder]: Failed due to bad data: {0}",Qa)}}return new hf(null,null,null)}};W.prototype.MMg=function(F){var fa=this.fei(F.SolutionId),Qa=W.IPh(F);if(Qa&&fa)return fa={},Se.ULS.sendTraceTag(537163162,0,50,"[RichApiRecorder][{0}]: {1}",this.parentName,
(fa.recorderEventId=Qa,fa["request.SolutionId"]=F.SolutionId,fa)),new R(F.SolutionId,Qa);var Ab={};Se.ULS.sendTraceTag(537163161,0,50,"[RichApiRecorder][{0}]: {1}",this.parentName,(Ab.recorderEventId=Qa,Ab.isRecorderAwareAddin=fa,Ab["request.SolutionId"]=F.SolutionId,Ab));return null};W.prototype.fei=function(F){if(!F)return!1;F=F.toLowerCase();return W.iVh().contains(F)};W.iVh=function(){W.Sya||(W.Sya=new Zj.a(Gj.a.Ik()),W.Sya.add("f438b4e6-2b49-466f-9a91-b75f473eba96"),W.Sya.add("fa000000005"),
W.Sya.add("907dd90f-a82f-4bbf-b4f2-fcd4868a5e14"),W.Sya.add("fa000000014"),W.Sya.add("c5daabb3-e185-4e8c-adfc-1a7b7283fb6f"));return W.Sya};W.IPh=function(F){var fa=null,Qa=RegExp('"Name":"EnableOfficeScriptRecording".*?Arguments":\\[.*?"(.*?)"',"mi");if(Qa.test(F.RequestBody))fa=Qa.exec(F.RequestBody)[1];else{F=F.RequestHeaders;if(!F)return fa;Qa=uj.a.Sxi.toLowerCase();for(var Ab=0;Ab<F.length;Ab++)if(F[Ab].Name.toLowerCase()===Qa){fa=F[Ab].Value;break}}return fa};W.Sya=null;Object($d.a)(W,"DdaRichApiRequestRecorder",
null,[]);var Ig=b(63),Hh=xg.a;vm(ia,Hh);ia.prototype.u2=function(F){return Hh.prototype.u2.call(this,F)||this.yPg(F)};ia.prototype.Wl=function(){return this.pJd.Wl(this.yd)};ia.prototype.edb=function(){var F={OperationType:3};F.RichApiRequest=this.request;return F};ia.prototype.yPg=function(F){var fa=this;return function(Qa,Ab,Cc){return I(F,fa.request,oi.b(Qa,fa.Mkb),oi.a(Ab,fa.bhb),Cc,fa.f3)}};tl.Object.defineProperties(ia.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return Ag.EwaSettings.tc()?
Object(Ig.a)(ia.prototype,this,"operationWorkingState"):2}},lAc:{configurable:!0,enumerable:!0,get:function(){return this.DEa}},lr:{configurable:!0,enumerable:!0,get:function(){return this.Mkb}},J3:{configurable:!0,enumerable:!0,get:function(){return this.bhb}}});Object($d.a)(ia,"DdaRichApiRequestBatchOperation",xg.a,[]);var jj=rk.a;vm(P,jj);P.prototype.Wl=function(){return this.pJd.Wl(this.yd)};tl.Object.defineProperties(P.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return Ag.EwaSettings.tc()?
Object(Ig.a)(P.prototype,this,"operationWorkingState"):0}}});Object($d.a)(P,"DdaRichApiRequestOperation",rk.a,[]);N.prototype.ddaAddBinding=function(F,fa,Qa,Ab,Cc,Vc,qd){var Gd=this;this.tJ(function(ve,jf,gf){var qg=Gd.$.qa.ta,Qg=Gd.Qia();ve=oi.b(ve,Vc);jf=oi.a(jf,Gd.JH);var ph=qg.Oa(9);ph.controlId=F;ph.bindingId=fa;ph.bindingType=Qa;ph.currentSheetName=Qg;ph.formula=Ab;ph.options=Cc;return Oi.i(qg,"DdaAddBinding",ph,ve,jf,gf,qd,0)},qd,563)};N.prototype.ddaReleaseBinding=function(F,fa,Qa,Ab){var Cc=
this;this.tJ(function(Vc,qd,Gd){var ve=Cc.$.qa.ta;Vc=oi.b(Vc,Qa);qd=oi.a(qd,Cc.JH);var jf=ve.Oa(9);jf.controlId=F;jf.bindingId=fa;return Oi.i(ve,"DdaReleaseBinding",jf,Vc,qd,Gd,Ab,0)},Ab,564)};N.prototype.ddaGetBinding=function(F,fa,Qa,Ab){var Cc=this;this.tJ(function(Vc,qd,Gd){var ve=Cc.$.qa.ta;Vc=oi.b(Vc,Qa);qd=oi.a(qd,Cc.JH);var jf=ve.Oa(1);jf.controlId=F;jf.bindingId=fa;return Oi.i(ve,"DdaGetBinding",jf,Vc,qd,Gd,Ab,0)},Ab,565,16)};N.prototype.ddaGetAllBindings=function(F,fa,Qa){var Ab=this;this.tJ(function(Cc,
Vc,qd){var Gd=Ab.$.qa.ta;Cc=oi.b(Cc,fa);Vc=oi.a(Vc,Ab.JH);var ve=Gd.Oa(1);ve.controlId=F;return Oi.i(Gd,"DdaGetAllBindings",ve,Cc,Vc,qd,Qa,0)},Qa,566,16)};N.prototype.ddaGetBindingData=function(F,fa,Qa,Ab,Cc,Vc,qd,Gd,ve,jf,gf){var qg=this;this.tJ(function(Qg,ph,Nh){var Fh=qg.$.qa.ta,Zh=qg.Qia();Qg=oi.b(Qg,jf);ph=oi.a(ph,qg.JH);var ki=Fh.Oa(1);ki.controlId=F;ki.bindingId=fa;ki.coerceType=Qa;ki.valueFormat=Ab;ki.filterType=Cc;ki.startRow=Vc;ki.startCol=qd;ki.rowCount=Gd;ki.colCount=ve;ki.currentSheetName=
Zh;return Oi.i(Fh,"DdaGetBindingData",ki,Qg,ph,Nh,gf,0)},gf,567,16)};N.prototype.ddaSetBindingData=function(F,fa,Qa,Ab,Cc,Vc,qd){var Gd=this;this.tJ(function(ve,jf,gf){var qg=Gd.$.qa.ta,Qg=Gd.Qia();ve=oi.b(ve,Vc);jf=oi.a(jf,Gd.JH);var ph=qg.Oa(9);ph.controlId=F;ph.bindingId=fa;ph.startRow=Qa;ph.startCol=Ab;ph.currentSheetName=Qg;ph.bindingData=Cc;return Oi.i(qg,"DdaSetBindingData",ph,ve,jf,gf,qd,0)},qd,568)};N.prototype.ddaGetSelectedData=function(F,fa,Qa,Ab,Cc,Vc,qd){var Gd=this;this.tJ(function(ve,
jf,gf){var qg=Gd.$.qa.ta,Qg=Gd.Qia();ve=oi.b(ve,Vc);jf=oi.a(jf,Gd.JH);var ph=qg.Oa(1);ph.controlId=F;ph.coerceType=fa;ph.valueFormat=Qa;ph.filterType=Ab;ph.currentSheetName=Qg;ph.formula=Cc;return Oi.i(qg,"DdaGetSelectedData",ph,ve,jf,gf,qd,0)},qd,569,16)};N.prototype.ddaSetSelectedData=function(F,fa,Qa,Ab,Cc){var Vc=this;this.tJ(function(qd,Gd,ve){var jf=Vc.$.qa.ta,gf=Vc.Qia();qd=oi.b(qd,Ab);Gd=oi.a(Gd,Vc.JH);var qg=jf.Oa(9);qg.controlId=F;qg.currentSheetName=gf;qg.formula=fa;qg.bindingData=Qa;return Oi.i(jf,
"DdaSetSelectedData",qg,qd,Gd,ve,Cc,0)},Cc,570)};N.prototype.ddaLoadSettings=function(F,fa,Qa){var Ab=this;this.tJ(function(Cc,Vc,qd){var Gd=Ab.$.qa.ta;Cc=oi.b(Cc,fa);Vc=oi.a(Vc,Ab.JH);var ve=Gd.Oa(1);ve.controlId=F;return Oi.i(Gd,"DdaLoadSettings",ve,Cc,Vc,qd,Qa,0)},Qa,501,16)};N.prototype.ddaSaveSettings=function(F,fa,Qa,Ab,Cc){var Vc=this;this.tJ(function(qd,Gd,ve){var jf=Vc.$.qa.ta;qd=oi.b(qd,Ab);Gd=oi.a(Gd,Vc.JH);var gf=jf.Oa(9);gf.controlId=F;gf.settings=fa;gf.overwriteIfStale=Qa;return Oi.i(jf,
"DdaSaveSettings",gf,qd,Gd,ve,Cc,0)},Cc,571)};N.prototype.ddaAddRowsColumns=function(F,fa,Qa,Ab,Cc,Vc){var qd=this;this.tJ(function(Gd,ve,jf){var gf=qd.$.qa.ta,qg=qd.Qia();Gd=oi.b(Gd,Cc);ve=oi.a(ve,qd.JH);var Qg=gf.Oa(9);Qg.controlId=F;Qg.bindingId=fa;Qg.isRow=Qa;Qg.currentSheetName=qg;Qg.bindingData=Ab;return Oi.i(gf,"DdaAddRowsColumns",Qg,Gd,ve,jf,Vc,0)},Vc,572)};N.prototype.ddaDeleteAllDataValues=function(F,fa,Qa,Ab){var Cc=this;this.tJ(function(Vc,qd,Gd){var ve=Cc.$.qa.ta,jf=Cc.Qia();Vc=oi.b(Vc,
Qa);qd=oi.a(qd,Cc.JH);var gf=ve.Oa(9);gf.controlId=F;gf.bindingId=fa;gf.currentSheetName=jf;return Oi.i(ve,"DdaDeleteAllDataValues",gf,Vc,qd,Gd,Ab,0)},Ab,573)};N.prototype.ddaClearBindingFormats=function(F,fa,Qa,Ab){var Cc=this;this.tJ(function(Vc,qd,Gd){var ve=Cc.$.qa.ta,jf=Cc.Qia();Vc=oi.b(Vc,Qa);qd=oi.a(qd,Cc.JH);var gf=ve.Oa(9);gf.controlId=F;gf.bindingId=fa;gf.currentSheetName=jf;return Oi.i(ve,"DdaClearBindingFormats",gf,Vc,qd,Gd,Ab,0)},Ab,574)};N.prototype.ddaSetBindingFormats=function(F,fa,
Qa,Ab,Cc,Vc){var qd=this;this.tJ(function(Gd,ve,jf){var gf=qd.$.qa.ta,qg=qd.Qia();Gd=oi.b(Gd,Cc);ve=oi.a(ve,qd.JH);var Qg=gf.Oa(9);Qg.controlId=F;Qg.bindingId=fa;Qg.currentSheetName=qg;Qg.bindingData=Qa;Qg.isSetFormats=Ab;return Oi.i(gf,"DdaSetBindingFormats",Qg,Gd,ve,jf,Vc,0)},Vc,575)};N.prototype.parseRange=function(F,fa,Qa){var Ab=this;this.tJ(function(Cc,Vc,qd){var Gd=Ab.$.qa.ta.Xb();return Oi.P(Ab.$.qa.ta,F,-1,oi.b(Cc,fa),oi.a(Vc,Ab.JH),qd,Qa,Gd)},Qa,162,16)};N.prototype.parseRangeForGoto=function(F,
fa,Qa,Ab){var Cc=this;this.tJ(function(Vc,qd,Gd){var ve=Cc.$.qa.ta.Xb();return Oi.Q(Cc.$.qa.ta,F,fa,oi.b(Vc,Qa),oi.a(qd,Cc.JH),Gd,Ab,ve)},Ab,562,16)};N.prototype.executeRichApiRequest=function(F,fa,Qa){var Ab=this;Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")&&(F.RequestFlags&=8191);if(Ag.EwaSettings.la(259))this.esh(this.$.qa.ta.Xb(),fa,function(){Ab.ZP.jJa(C.a.internalError,Qa)},Qa,F);else{var Cc=nh.DdaFacade.Odd(F);!Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||
!this.$.Ab.XJ||Cc&16?(Ag.EwaSettings.tc()&&(Cc|=64),this.$.userOperationManager.tt(new P(this.$,F,function(Vc,qd,Gd){return I(Ab.$.qa.ta,F,oi.b(Vc,fa),oi.a(qd,Ab.JH),Gd,Qa)},Cc))):(this.ZP.jJa(C.a.iBc,Qa),Se.ULS.sendTraceTag(537163160,0,50,"Write operation is not allowed"))}};N.prototype.Qia=function(){return this.$.fa.isNamedObjectViewMode?this.$.oa.sheetName:this.$.activeItemName};N.prototype.tJ=function(F,fa,Qa,Ab){Ab=void 0===Ab?0:Ab;!Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||
!this.$.Ab.XJ||Ab&16?Ag.EwaSettings.tc()?this.$.userOperationManager.tt(new rk.a(Qa,0,F,Ab|64)):this.$.userOperationManager.tt(new Aj.a(Qa,0,F,Ab)):(this.ZP.jJa(C.a.iBc,fa),Se.ULS.sendTraceTag(537163159,0,50,"Write operation is not allowed"))};N.prototype.esh=function(F,fa,Qa,Ab,Cc){var Vc=nh.DdaFacade.Odd(Cc);if(!Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")||!this.$.Ab.XJ||Vc&16){var qd=this.$.Ub.Fc("UserAction","Rich Api request");Ag.EwaSettings.tc()&&
(Vc|=64);this.$.userOperationManager.ic(new ia(this.$,F,fa,Qa,Ab,qd,Cc,Vc),null)}else this.ZP.jJa(C.a.iBc,Ab),Se.ULS.sendTraceTag(537163158,0,50,"Write operation is not allowed")};Object($d.a)(N,"DdaWebServiceHelper",null,[]);Object($d.a)(U,"DocumentFile",null,[]);B.generalException="GeneralException";B.$Eg="ApiNotFound";B.Tzd="OperationCancelled";B.invalidArgument="InvalidArgument";Object($d.a)(B,"ErrorCodes",null,[]);w.prototype.replaceShortcuts=function(){return Promise.reject("ReplaceShortcuts method is not overridden")};
w.prototype.getShortcuts=function(){return Promise.reject("GetShortcuts method is not overridden")};w.prototype.checkShortcutsInUse=function(){return Promise.reject("CheckShortcutsInUse method is not overridden")};Object($d.a)(w,"WacApiDelegates",null,[]);var Kj=b(661);vm(G,w);G.prototype.replaceShortcuts=function(F){return OfficeExt.ShortcutKeyDispatchManager.replaceShortcuts(this.addinId,F,this.Rdf)};G.prototype.getShortcuts=function(){return OfficeExt.ShortcutKeyDispatchManager.getShortcuts(this.addinId)};
G.prototype.checkShortcutsInUse=function(F){return OfficeExt.ShortcutKeyDispatchManager.checkShortcutsInUse(F,this.Rdf)};G.C2g=function(F,fa){var Qa=document.createEvent("KeyboardEvent");if(zh.a.ME)Qa.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,!!(F&8),!!(F&32),!!(F&4),!!(F&256));else{var Ab=[];F&4&&Ab.push("Shift");F&8&&Ab.push("Control");F&32&&Ab.push("Alt");Qa.initKeyboardEvent("keydown",!1,!1,window.self,"A",0,Ab,!1,"en-US")}F=new Sys.UI.DomEvent(Qa);F.keyCode=fa;return F};G.hZg=function(F,
fa){if(zh.a.zf)switch(fa){case 189:fa=173;break;case 187:fa=61;break;case 186:fa=59}return G.C2g(F,fa)};Object($d.a)(G,"ExcelWacApiDelegates",w,[]);r.prototype.rwg=function(F,fa){this.Lbc(F)||(this.THa[F]={});if(this.H$h(F))return Se.ULS.sendTraceTag(537163157,344,50,"App {0} has reach the limit of number of cached files.",F),C.a.Zri;this.THa[F][fa.Wth.toString()]=fa;return C.a.success};r.prototype.EHh=function(F,fa){var Qa=null;this.Lbc(F)&&(Qa=this.THa[F][fa.toString()]);Qa||Se.ULS.sendTraceTag(537163156,
344,15,"File cache for [agave:{0}, fileHandler:{1}] doesn't exist",F,fa);return Qa};r.prototype.Lbc=function(F){return F in this.THa};r.prototype.$1i=function(F,fa){if(this.Lbc(F)){var Qa=this.THa[F];delete Qa[fa.toString()];1>Object.keys(Qa).length&&delete this.THa[F];return fa.toString()in Qa?C.a.internalError:C.a.success}return C.a.internalError};r.prototype.H$h=function(F){return this.Lbc(F)?Object.keys(this.THa[F]).length>=this.sri:!1};r.getInstance=function(F){return F.da.Aa(200)||F.da.Ha(200,
new r(r.tri))};r.yvi=function(){return++r.OOg};r.Zqi=4194304;r.tri=1;r.OOg=0;Object($d.a)(r,"GetFileApiHelper",null,[]);z.prototype.notifyActionHandlerReady=function(){OfficeExt.ShortcutKeyDispatchManager.sendQueuedActions(this.Rz)};z.prototype.getTypeName=function(){return"Microsoft.InternalService.AddinInternalService"};z.prototype.invokePropertyGet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};z.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);
return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};z.prototype.invokePropertySet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};z.prototype.invokePropertySetAsync=function(F,fa){this.invokePropertySet(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};z.prototype.invokeMethod=function(F){switch(F){case 1:return this.gwi()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};z.prototype.invokeMethodAsync=
function(F,fa){F=this.invokeMethod(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};z.prototype.gwi=function(){this.notifyActionHandlerReady();return null};Object($d.a)(z,"AddinInternalService",null,[]);t.prototype.getAppRuntimeState=function(){return this.AI.getAppRuntimeState(this.Rz)?2:1};t.prototype.setAppRuntimeState=function(F){switch(F){case 2:F=!0;break;case 1:F=!1;break;default:throw OfficeExtension.WacRuntime.Utility.createRichApiException(Xi.a.invalidArgument,
e.a.ea(1712));}this.AI.setAppRuntimeState(this.Rz,F)};t.prototype.getTypeName=function(){return"Microsoft.AppRuntime.AppRuntimeService"};t.prototype.invokePropertyGet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};t.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};t.prototype.invokePropertySet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
};t.prototype.invokePropertySetAsync=function(F,fa){this.invokePropertySet(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};t.prototype.invokeMethod=function(F,fa){switch(F){case 2:return this.XCh();case 1:return this.Wgj(fa)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};t.prototype.invokeMethodAsync=function(F,fa){F=this.invokeMethod(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};t.prototype.XCh=function(){return this.getAppRuntimeState()};
t.prototype.Wgj=function(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"int");this.setAppRuntimeState(F);return null};Object($d.a)(t,"AppRuntimeService",null,[]);var Qj=b(1122);x.prototype.disable=function(){try{if(!e.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.qAe();if(!this.tdf())return this.rAe();this.f1.bHj(this.ms)}catch(F){return Se.ULS.sendTraceTag(538572829,0,15,"BeforeDocumentCloseNotification.Disable() Failed. reason: {0}",
F.message||"Unknown"),this.oAe()}return null};x.prototype.enable=function(){try{if(!e.a.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled"))return this.qAe();if(!this.tdf())return this.rAe();this.f1.g0i(this.ms)}catch(F){return Se.ULS.sendTraceTag(538572828,0,15,"BeforeDocumentCloseNotification.Enable() Failed. reason: {0}",F.message||"Unknown"),this.oAe()}return null};x.prototype._OnAccess=function(){};x.prototype.getTypeName=function(){return"Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification"};
x.prototype.invokePropertyGet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};x.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};x.prototype.invokePropertySet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};x.prototype.invokePropertySetAsync=function(F,fa){this.invokePropertySet(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
x.prototype.invokeMethod=function(F){switch(F){case 1:return this.LBa()}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};x.prototype.invokeMethodAsync=function(F,fa){switch(F){case 3:return this.Hah();case 2:return this.agh()}F=this.invokeMethod(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};x.prototype.Hah=function(){return this.disable()};x.prototype.agh=function(){return this.enable()};x.prototype.LBa=function(){this._OnAccess();return null};
x.prototype.qAe=function(){return Qj.a(Xi.a.notImplemented,e.a.ea(1713))};x.prototype.rAe=function(){return Qj.a(Xi.a.sharedRuntimeNotAvailable,e.a.ea(1717))};x.prototype.oAe=function(){return Qj.a(Xi.a.generalException,e.a.ea(1708))};x.prototype.tdf=function(){var F=this.ly.getSharedRuntimeId();return!!F&&0<F.length};Object($d.a)(x,"BeforeDocumentCloseNotification",null,[]);A.prototype.getTypeName=function(){return"Microsoft.ExcelServices.CustomFunctionEngineStatus"};A.prototype.invokePropertyGet=
function(F){switch(F){case 1:return this.enabled;case 3:return this.nativeRuntime;case 2:return this.streamingEnabled}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};A.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};A.prototype.invokePropertySet=function(F,fa){switch(F){case 1:this.enabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(fa,0,"boolean");return;case 3:this.nativeRuntime=
OfficeExtension.WacRuntime.Utility.getAndValidateArgument(fa,0,"boolean");return;case 2:this.streamingEnabled=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(fa,0,"boolean");return}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};A.prototype.invokePropertySetAsync=function(F,fa){this.invokePropertySet(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};A.prototype.invokeMethod=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
};A.prototype.invokeMethodAsync=function(F,fa){F=this.invokeMethod(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};tl.Object.defineProperties(A.prototype,{enabled:{configurable:!0,enumerable:!0,get:function(){return this.Mz},set:function(F){this.Mz=F}},nativeRuntime:{configurable:!0,enumerable:!0,get:function(){return this.$9d},set:function(F){this.$9d=F}},streamingEnabled:{configurable:!0,enumerable:!0,get:function(){return this.Zee},set:function(F){this.Zee=F}}});Object($d.a)(A,
"CustomFunctionEngineStatus",null,[]);m.prototype.register=function(F){return OfficeExtension.WacRuntime.Utility.createPromise(this.Ypg(F))};m.prototype.getTypeName=function(){return"Microsoft.ExcelServices.CustomFunctionManager"};m.prototype.invokePropertyGet=function(F){switch(F){case 2:return this.status}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};m.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};
m.prototype.invokePropertySet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};m.prototype.invokePropertySetAsync=function(F,fa){this.invokePropertySet(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};m.prototype.invokeMethod=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};m.prototype.invokeMethodAsync=function(F,fa){switch(F){case 1:return this.W0i(fa)}F=this.invokeMethod(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};
m.prototype.W0i=function(F){var fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,1,"string");return this.register(fa,F)};tl.Object.defineProperties(m.prototype,{status:{configurable:!0,enumerable:!0,get:function(){var F=new A;F.enabled=this.fmg;F.streamingEnabled=this.gmg;F.nativeRuntime=!1;return F}}});Object($d.a)(m,"CustomFunctionManager",null,[]);var Jk=b(1079);v.prototype._RegisterStateChange=function(){var F=
this;this.HQb||this.uO.execute(function(fa){F.W_d=fa.Vya(F._id,function(Qa){F.AI.bwh(F.Rz,F._id,JSON.stringify(Qa))})});this.HQb++;return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};v.prototype._UnregisterStateChange=function(){var F=this;this.HQb--;this.HQb||this.uO.execute(function(fa){fa.WFd(F._id,F.W_d)});return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};v.prototype.getTypeName=function(){return"Microsoft.Office.Licensing.LicenseFeature"};v.prototype.invokePropertyGet=
function(F){switch(F){case 5:return this.id}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};v.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};v.prototype.invokePropertySet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};v.prototype.invokePropertySetAsync=function(F,fa){this.invokePropertySet(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};
v.prototype.invokeMethod=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};v.prototype.invokeMethodAsync=function(F,fa){switch(F){case 6:return this.Ofg();case 7:return this.Qfg()}F=this.invokeMethod(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};v.prototype.Ofg=function(){return this._RegisterStateChange()};v.prototype.Qfg=function(){return this._UnregisterStateChange()};tl.Object.defineProperties(v.prototype,{id:{configurable:!0,enumerable:!0,
get:function(){return this._id}}});Object($d.a)(v,"LicenseFeature",null,[]);u.prototype.getFeatureTier=function(F,fa){var Qa=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Ab){var Cc=1===fa?1:2===fa?2:0;Qa.uO.execute(function(Vc){Vc.getFeatureTier(F,Cc).then(function(qd){Ab(Qa.JLh(qd))},function(){Ab(fa)})})})};u.prototype.getLicenseFeature=function(F){F=new v(this.uO,F,this.Rz,this.AI);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};u.prototype.isFeatureEnabled=
function(F,fa){var Qa=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Ab){Qa.uO.execute(function(Cc){Cc.isFeatureEnabled(F,fa).then(function(Vc){Ab(Vc)},function(){Ab(fa)})})})};u.prototype.isFreemiumUpsellEnabled=function(){var F=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(fa){F.uO.execute(function(Qa){Qa=Qa.isFreemiumUpsellEnabled();fa(Qa)})})};u.prototype.launchUpsellExperience=function(F){var fa=this;if(this.Pog.isFirstParty())return OfficeExtension.WacRuntime.Utility.createPromise(function(){fa.uO.execute(function(Qa){Qa.launchUpsellExperience(F)})});
throw OfficeExtension.WacRuntime.Utility.createRichApiException(Xi.a.oRc,"");};u.prototype._TestFireStateChangedEvent=function(){};u.prototype.getTypeName=function(){return"Microsoft.Office.Licensing.License"};u.prototype.invokePropertyGet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};u.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};u.prototype.invokePropertySet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
};u.prototype.invokePropertySetAsync=function(F,fa){this.invokePropertySet(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};u.prototype.invokeMethod=function(F,fa){switch(F){case 6:return this.Pfg(fa)}throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};u.prototype.invokeMethodAsync=function(F,fa){switch(F){case 2:return this.yIh(fa);case 5:return this.ILh(fa);case 1:return this.uai(fa);case 3:return this.Yai();case 4:return this.Xji(fa)}F=this.invokeMethod(F,
fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};u.prototype.yIh=function(F){var fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,1,"int");return this.getFeatureTier(fa,F)};u.prototype.ILh=function(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");return this.getLicenseFeature(F)};u.prototype.uai=function(F){var fa=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,
0,"string");F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,1,"boolean");return this.isFeatureEnabled(fa,F)};u.prototype.Yai=function(){return this.isFreemiumUpsellEnabled()};u.prototype.Xji=function(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");return this.launchUpsellExperience(F)};u.prototype.Pfg=function(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");this._TestFireStateChangedEvent(F);return null};u.prototype.JLh=function(F){switch(F){case 1:return 1;
case 2:return 2;default:return 0}};Object($d.a)(u,"License",null,[]);var Sk=b(147);l.prototype.areShortcutsInUse=function(F){var fa=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Qa,Ab){fa.ntd.checkShortcutsInUse(F).then(function(Cc){Qa(Cc)}).catch(function(Cc){Ab(Cc)})})};l.prototype.getShortcuts=function(){var F=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(fa,Qa){F.ntd.getShortcuts().then(function(Ab){fa(Ab)}).catch(function(Ab){Qa(Ab)})})};l.prototype.replaceShortcuts=
function(F){var fa=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Qa,Ab){fa.ntd.replaceShortcuts(F).then(function(){Qa(null)}).catch(function(Cc){Ab(Cc)})})};l.prototype.getTypeName=function(){return"Microsoft.Office.ActionService"};l.prototype.invokePropertyGet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};l.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};
l.prototype.invokePropertySet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};l.prototype.invokePropertySetAsync=function(F,fa){this.invokePropertySet(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};l.prototype.invokeMethod=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};l.prototype.invokeMethodAsync=function(F,fa){switch(F){case 3:return this.KGg(fa);case 1:return this.ERh();case 2:return this.D7i(fa)}F=
this.invokeMethod(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};l.prototype.KGg=function(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"Array<string>");return this.areShortcutsInUse(F)};l.prototype.ERh=function(){return this.getShortcuts()};l.prototype.D7i=function(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"any");return this.replaceShortcuts(F)};Object($d.a)(l,"ActionService",null,[]);var al=b(524);n.prototype.uRh=function(){this.Kfa||
(this.Kfa=al.a.Fq(hh.a.instance.mc("Common.App.SharedFilePicker.ISharedFilePicker")));return this.Kfa};n.prototype.getSharedFilePickerResponse=function(F){var fa=this;return OfficeExtension.WacRuntime.Utility.createPromise(function(Qa,Ab){try{var Cc=fa.uRh();nj.Task.WAA.call(null,Cc).continueWith(function(){var Vc=Cc.result;if(Vc){var qd={};(function(){var Gd=Gh.d(F);qd=Gd.uu;return Gd})().returnValue?Vc.u$b(qd).then(function(Gd){Gd&&0<Gd.length?Qa(Gd):Ab(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException",
"The picker returned null or an empty array."))}).catch(function(Gd){Ab(Gd)}):Ab(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The dialog customazation json string can not be deserialized."))}else Ab(OfficeExtension.WacRuntime.Utility.createRichApiException("GeneralException","The picker is resolved as null."))})}catch(Vc){Ab(Vc)}})};n.prototype.getTypeName=function(){return"Microsoft.Office.SharedFilePicker"};n.prototype.invokePropertyGet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
};n.prototype.invokePropertyGetAsync=function(F){F=this.invokePropertyGet(F);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};n.prototype.invokePropertySet=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);};n.prototype.invokePropertySetAsync=function(F,fa){this.invokePropertySet(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(null)};n.prototype.invokeMethod=function(F){throw OfficeExtension.WacRuntime.Utility.createApiNotFoundException(F);
};n.prototype.invokeMethodAsync=function(F,fa){switch(F){case 1:return this.tRh(fa)}F=this.invokeMethod(F,fa);return OfficeExtension.WacRuntime.Utility.createPromiseFromResult(F)};n.prototype.tRh=function(F){F=OfficeExtension.WacRuntime.Utility.getAndValidateArgument(F,0,"string");return this.getSharedFilePickerResponse(F)};Object($d.a)(n,"SharedFilePicker",null,[]);k.prototype.createInstance=function(F,fa){switch(F){case "Microsoft.Office.ActionService":return new l(fa);case "Microsoft.Office.SharedFilePicker":return new n}return null};
Object($d.a)(k,"WacApiHost",null,[]);c.prototype.hostName=function(){return"ExcelOnline"};c.prototype.appId=function(){return this.MOb};c.prototype.createInstance=function(F){switch(F){case "Microsoft.Authentication.AuthenticationService":return hh.a.instance.resolve("Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").create(this.Rz,this.AI.Gi);case "Microsoft.Authentication.TokenParameters":return new Xa;case "Microsoft.ExcelServices.CustomFunctionManager":F=this.vb.la(121);
var fa=this.vb.la(122);return new m(F,fa,f(this.MOb,this.vb,this.AI));case "Microsoft.AppRuntime.AppRuntimeService":return new t(this.Rz,this.AI);case "Microsoft.BeforeDocumentCloseNotification.BeforeDocumentCloseNotification":return F=Jj.a(this.vb),new x(this.MOb,this.Rz,F,this.AI);case "Microsoft.DynamicRibbon.DynamicRibbon":return F=Jj.a(this.vb),new Jk.DynamicRibbon(this.MOb,this.Rz,this.AI,F,F.an(this.Rz).cl);case "Microsoft.Office.Licensing.License":return new u(this.Rz,this.AI);case "Microsoft.InternalService.AddinInternalService":return new z(this.Rz);
default:if(this.VQc||(this.VQc=new k),fa=this.VQc.createInstance(F,this.aug))return fa}Se.ULS.sendTraceTag(537163155,0,10,"Typename: {0} is an invalid parameter for the RichApiHost.CreateInstance method.",F);throw OfficeExtension.WacRuntime.Utility.createRichApiException(Xi.a.generalException,Xi.a.generalException);};Object($d.a)(c,"RichApiHost",null,[]);var fl=b(382),gl=b(113),bl=b(32),kl=b(95),Uk=b(278),hl=b(39),jl=b(246),ll=b(6),ol=b(64),ml=b(193);d.prototype.dispose=function(){this.$=this.w7b=
null};d.prototype.Xc=function(){return!1};d.prototype.fd=function(){return!1};d.prototype.executeCommand=function(F,fa,Qa){F=fa.command;switch(F){case 451041795:this.we.vf(Qa[Te.a.Kg],Qa[Te.a.f3]);break;case 974713501:this.IXh(Qa[Te.a.Kg],Qa[Te.a.f3]);break;case 1237877382:this.we.Au(Qa[Te.a.f3]);break;default:return hk.a(F)}return nj.Task.Ta(!0)};d.prototype.Gc=function(F,fa,Qa){if(F=!!Qa)switch(fa.command){case 974713501:case 1237877382:case 451041795:break;default:F=!1}return F};d.prototype.IXh=
function(F,fa){var Qa=F.DdaMethod;if("undefined"===typeof Qa.DispatchId)this.we.vf(C.a.internalError,fa);else if(d.B$h(F)||this.$.Fd&1){if(Qa.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromPromptMethod?(new ba(this.$,this,F,fa)).start(this.Ve,F.DdaMethod.ControlId):Qa.DispatchId===OSF.DDA.MethodDispId.dispidGetSelectedDataMethod?this.TQh(F,fa):Qa.DispatchId===OSF.DDA.MethodDispId.dispidSetSelectedDataMethod?this.olj(F,fa):Qa.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromSelectionMethod?
this.addBinding(F,this.Vbd(F.DdaMethod.ControlId),0,fa):Qa.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingDataMethod?this.BDh(F,fa):Qa.DispatchId===OSF.DDA.MethodDispId.dispidSetBindingDataMethod?this.fhj(F,fa):Qa.DispatchId===OSF.DDA.MethodDispId.dispidGetBindingMethod?this.ADh(F,fa):Qa.DispatchId===OSF.DDA.MethodDispId.dispidReleaseBindingMethod?this.Z1i(F,fa):Qa.DispatchId===OSF.DDA.MethodDispId.dispidGetAllBindingsMethod?this.BCh(F,fa):Qa.DispatchId===OSF.DDA.MethodDispId.dispidLoadSettingsMethod?
this.Ard(F,fa):Qa.DispatchId===OSF.DDA.MethodDispId.dispidSaveSettingsMethod?this.saveSettings(F,fa):Qa.DispatchId===OSF.DDA.MethodDispId.dispidAddRowsMethod?(F.DdaAddRowsColumns.IsRow=!0,this.Nje(F,fa)):Qa.DispatchId===OSF.DDA.MethodDispId.dispidAddColumnsMethod?(F.DdaAddRowsColumns.IsRow=!1,this.Nje(F,fa)):Qa.DispatchId===OSF.DDA.MethodDispId.dispidClearAllRowsMethod?this.q9g(F,fa):Qa.DispatchId===OSF.DDA.MethodDispId.dispidClearFormatsMethod?this.vTg(F,fa):Qa.DispatchId===OSF.DDA.MethodDispId.dispidSetFormatsMethod?
(F.DdaSetBindingFormats.IsSetFormats=!0,this.xUf(F,fa)):Qa.DispatchId===OSF.DDA.MethodDispId.dispidSetTableOptionsMethod?(F.DdaSetBindingFormats.IsSetFormats=!1,this.xUf(F,fa)):Qa.DispatchId===OSF.DDA.MethodDispId.dispidAddBindingFromNamedItemMethod?this.addBinding(F,F.DdaBindingsMethod.ItemName,F.DdaBindingsMethod.FailOnCollision?2:1,fa):Qa.DispatchId===OSF.DDA.MethodDispId.dispidGetFilePropertiesMethod?this.CIh(fa):Qa.DispatchId===OSF.DDA.MethodDispId.dispidNavigateToMethod?this.Zud(F,fa):Qa.DispatchId===
OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod?this.executeRichApiRequest(F,fa):Qa.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyMethod?this.BHh(F,fa):Qa.DispatchId===OSF.DDA.MethodDispId.dispidGetDocumentCopyChunkMethod?this.CHh(F,fa):Qa.DispatchId===OSF.DDA.MethodDispId.dispidReleaseDocumentCopyMethod?this.a2i(F,fa):Qa.DispatchId===OSF.DDA.MethodDispId.dispidAppCommandInvocationCompletedMethod?(OfficeExt.AddinCommandsRuntimeManager.invocationCompleted(F.DdaMethod.ControlId,F),this.we.Au(fa)):
Qa.DispatchId===OSF.DDA.MethodDispId.dispidMessageParentMethod?Ag.EwaSettings.la(24)?this.we.vf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,fa):this.Gsi(F,fa):Qa.DispatchId===OSF.DDA.MethodDispId.dispidSendMessageMethod?Ag.EwaSettings.la(24)?this.we.vf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,fa):this.Csi(F,fa):Qa.DispatchId===OSF.DDA.MethodDispId.dispidGetAccessTokenMethod?this.getAccessToken(F,fa):Qa.DispatchId===OSF.DDA.MethodDispId.dispidGetAuthContextMethod?
this.getAuthContext(F,fa):this.we.vf(C.a.Wzd,fa),Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5649666_AddLogForExcelOnlineCommonAPIUsage")&&Qa.DispatchId!==OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod){F=this.Ve.YY(F.DdaMethod.ControlId);fa="";if(F){fa=nh.DdaFacade.getSolutionId(F,this.$);var Ab=F.PrimaryMarketplace.MarketplaceType;Ab===OSF.StoreType.InMemory?F.OwnerAddinAssetId&&F.AssetMarketplace&&(Ab=F.AssetMarketplace.MarketplaceType):Ab===OSF.StoreType.WopiCatalog&&(Ab=OSF.StoreType.OMEX);
fa=Telemetry.PrivacyRules.GetAssetId(Ab,F.PrimaryMarketplace.MarketplaceRef,fa)}Se.ULS.sendTraceTag(537163224,344,50,"DDA method Id: {0}, AppID: {1}",Qa.DispatchId,fa)}}else this.we.vf(C.a.nGe,fa)};d.prototype.BDh=function(F,fa){var Qa=this;F.DdaGetBindingData.CoerceType=d.h1b(F.DdaGetBindingData.CoerceType);F.DdaGetBindingData.FilterType=d.fQe(F.DdaGetBindingData.FilterType);F.DdaGetBindingData.ValueFormat=d.rbg(F.DdaGetBindingData.ValueFormat);if(this.Mgc(F.DdaGetBindingData.CoerceType,fa)){if(F.DdaGetBindingData){var Ab=
F.DdaGetBindingData;Ab.FilterType||(Ab.FilterType=2);Ab.StartCol|=0;Ab.StartRow|=0;Ab.ColCount=void 0===Ab.ColCount?-1:Ab.ColCount;Ab.RowCount=void 0===Ab.RowCount?-1:Ab.RowCount}this.Ez.ddaGetBindingData(F.DdaMethod.ControlId,F.DdaGetBindingData.BindingId,F.DdaGetBindingData.CoerceType,F.DdaGetBindingData.ValueFormat,F.DdaGetBindingData.FilterType,F.DdaGetBindingData.StartRow,F.DdaGetBindingData.StartCol,F.DdaGetBindingData.RowCount,F.DdaGetBindingData.ColCount,function(Cc){if(We.a(Cc)||!Cc.Result)Qa.we.JG(Cc,
fa);else{var Vc=Qa.we.BP();Vc.Data=d.Qre(Cc.Result);fa(Vc)}},fa)}};d.prototype.fhj=function(F,fa){var Qa=this;F.DdaSetBindingData.CoerceType=d.h1b(F.DdaSetBindingData.CoerceType);if(this.Mgc(F.DdaSetBindingData.CoerceType,fa)){var Ab=d.TWc(F.DdaSetBindingData.CoerceType,F.DdaSetBindingData.Data);d.Vdc(Ab)?this.we.vf(C.a.fzc,fa):(1===Ab.CoerceType&&(Ab.CellFormat||(Ab.CellFormat=F.DdaSetBindingData.CellFormat),Ab.TableOptions||(Ab.TableOptions=F.DdaSetBindingData.TableOptions)),F.DdaSetBindingData&&
(F.DdaSetBindingData.StartCol|=0,F.DdaSetBindingData.StartRow|=0),this.Ez.ddaSetBindingData(F.DdaMethod.ControlId,F.DdaSetBindingData.BindingId,F.DdaSetBindingData.StartRow,F.DdaSetBindingData.StartCol,Ab,function(Cc){We.a(Cc)?Qa.we.JG(Cc,fa):Qa.we.Au(fa)},fa))}};d.prototype.TQh=function(F,fa){var Qa=this;F.DdaGetBindingData.CoerceType=d.h1b(F.DdaGetBindingData.CoerceType);F.DdaGetBindingData.ValueFormat=d.rbg(F.DdaGetBindingData.ValueFormat);F.DdaGetBindingData.FilterType=d.fQe(F.DdaGetBindingData.FilterType);
if(this.Mgc(F.DdaGetBindingData.CoerceType,fa)){var Ab=this.Vbd(F.DdaMethod.ControlId);Ab?this.Ez.ddaGetSelectedData(F.DdaMethod.ControlId,F.DdaGetBindingData.CoerceType,F.DdaGetBindingData.ValueFormat,F.DdaGetBindingData.FilterType,Ab,function(Cc){if(We.a(Cc))Qa.we.JG(Cc,fa);else{var Vc=Qa.we.BP();Vc.Data=d.Qre(Cc.Result);fa(Vc)}},fa):this.we.vf(C.a.w_e,fa)}};d.prototype.BHh=function(F,fa){var Qa=this;if(zh.a.Bmd)this.we.vf(C.a.UKg,fa);else{var Ab=F[OSF.DDA.Marshaling.File.ParameterKeys.FileType.toString()],
Cc=F[OSF.DDA.Marshaling.File.ParameterKeys.SliceSize.toString()],Vc=F.DdaMethod.ControlId,qd=r.getInstance(this.$);if(0>=Cc)Se.ULS.sendTraceTag(537163221,344,15,"Invalid slice size. It should be greater than 0."),this.we.vf(C.a.A7h,fa);else if(Cc>r.Zqi)Se.ULS.sendTraceTag(537163220,344,15,"Invalid slice size. It should be not greater than 4MB."),this.we.vf(C.a.GVe,fa);else{var Gd=null;switch(Ab){case 1:Gd="Compressed";break;case 0:Gd="Text";break;case 2:Gd="Pdf";break;default:Se.ULS.sendTraceTag(537163219,
344,15,"Requested file type {0} is not supported.",Ab);this.we.vf(C.a.TPe,fa);return}if("Text"===Gd)Se.ULS.sendTraceTag(537163218,344,15,"Requested file type {0} is not supported.",Gd),this.we.vf(C.a.TPe,fa);else{Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4182305_AddWholeWorkbookPrintOptionToGetFileAPI")?(F=new Sys.StringBuilder,F.append(Na.a(this.$,Gd)),"Pdf"===Gd&&Hb.a.Vf(F,uj.a.wDd,"WholeWorkbook"),F=F.toString()):F=Na.a(this.$,Gd);var ve=null,jf=new XMLHttpRequest;jf.onreadystatechange=function(){if(4===
jf.readyState)if(200===jf.status){var gf=jf.response;if(gf){ve=new Uint8Array(gf);gf=Qa.we.BP();for(var qg=ve.length,Qg=r.yvi(),ph={},Nh=0,Fh=0;Fh<qg;Fh+=Cc){for(var Zh=[],ki=Fh+Cc<qg?Fh+Cc:qg,gj=0,Ji=Fh;Ji<ki;gj++,Ji++)Zh[gj]=ve[Ji];ph[(Nh++).toString()]=Zh}ph=new U(Qg,qg,Cc,ph);ph=qd.rwg(Vc,ph);ph!==C.a.success?Qa.we.vf(ph,fa):(gf[OSF.DDA.Marshaling.File.FilePropertiesKeys.Handle.toString()]=Qg,gf[OSF.DDA.Marshaling.File.FilePropertiesKeys.FileSize.toString()]=qg,Se.ULS.sendTraceTag(537163216,344,
50,"GetFileAsync get file successfully for file type {0}, the file size is {1}",Gd,qg),fa(gf))}else Se.ULS.sendTraceTag(537163217,344,15,"Request is successful, but respone have no data for file type {0}.",Gd),Qa.we.vf(C.a.internalError,fa)}else 500===jf.status?Qa.we.vf(C.a.sSe(parseInt(jf.statusText)),fa):(Se.ULS.sendTraceTag(537163215,344,15,"Request failed to obtain the file for type {0}.",Gd),Qa.we.vf(C.a.gvi,fa))};jf.open("GET",F,!0);jf.responseType="arraybuffer";jf.setRequestHeader("If-Modified-Since",
"0");jf.send(null)}}}};d.prototype.CHh=function(F,fa){var Qa=F[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()],Ab=F[OSF.DDA.Marshaling.File.ParameterKeys.SliceIndex.toString()];F=F.DdaMethod.ControlId;(Qa=r.getInstance(this.$).EHh(F,Qa))?(Qa=Qa.Vuj,0>Ab||Ab>=Object.keys(Qa).length?this.we.vf(C.a.p2h,fa):(Ab=Qa[Ab.toString()],Qa=this.we.BP(),Qa[OSF.DDA.Marshaling.File.SlicePropertiesKeys.Data.toString()]=Ab,Qa[OSF.DDA.Marshaling.File.SlicePropertiesKeys.SliceSize.toString()]=Ab.length,fa(Qa))):
this.we.vf(C.a.internalError,fa)};d.prototype.a2i=function(F,fa){var Qa=F[OSF.DDA.Marshaling.File.ParameterKeys.Handle.toString()];F=F.DdaMethod.ControlId;Qa=r.getInstance(this.$).$1i(F,Qa);Qa===C.a.success?this.we.Au(fa):this.we.vf(Qa,fa)};d.prototype.olj=function(F,fa){var Qa=this;F.DdaSetBindingData.CoerceType=d.h1b(F.DdaSetBindingData.CoerceType);if(this.Mgc(F.DdaSetBindingData.CoerceType,fa)){var Ab=this.Vbd(F.DdaMethod.ControlId);if(Ab){var Cc=d.TWc(F.DdaSetBindingData.CoerceType,F.DdaSetBindingData.Data),
Vc=Xh.g(this.$).ha;1===Cc.CoerceType&&(!Cc.Data&&Vc.va.oV&&(Cc.Headers||(Cc.Headers=[]),Cc.Headers.length||Array.add(Cc.Headers,[]),Cc.Headers[0].length||Array.add(Cc.Headers[0],"")),d.Vdc(Cc)||(Cc.CellFormat||(Cc.CellFormat=F.DdaSetBindingData.CellFormat),Cc.TableOptions||(Cc.TableOptions=F.DdaSetBindingData.TableOptions)));if(d.Vdc(Cc))this.we.vf(C.a.fzc,fa);else{var qd=Vc.va.Qd.clone(),Gd=Vc.va.activeCell.clone();this.Ez.ddaSetSelectedData(F.DdaMethod.ControlId,Ab,Cc,function(ve){var jf;if(We.a(ve))Qa.we.JG(ve,
fa);else{ve=qd.clone();var gf=Cc.Headers?Cc.Headers[0].length:Cc.Data[0].length;1!==Cc.CoerceType||Cc.Data?1===Cc.CoerceType&&(null===(jf=Cc.TableOptions)||void 0===jf?0:jf.length)&&0==Cc.TableOptions[0]?(ve.top+=1,ve.bottom=ve.top+Cc.Data.length-1):ve.bottom=ve.top+Cc.Data.length-(1===Cc.CoerceType?0:1):ve.bottom=ve.top+1;ve.right=ve.left+gf-1;jf=ve.contains(Gd)?Gd:ve.topLeft;Vc.updateSelection(ve,jf,0);Qa.we.Au(fa)}},fa)}}else this.we.vf(C.a.iue,fa)}};d.prototype.addBinding=function(F,fa,Qa,Ab){var Cc=
this;fa?this.Ez.ddaAddBinding(F.DdaMethod.ControlId,F.DdaBindingsMethod.BindingId,F.DdaBindingsMethod.BindingType,fa,Qa,function(Vc){if(We.a(Vc))Cc.we.JG(Vc,Ab);else{var qd=Cc.we.BP();qd.Bindings=Array(1);qd.Bindings[0]=Cc.Ve.QZb(Vc.Result);Ab(qd)}},Ab):this.we.vf(C.a.Aej,Ab)};d.prototype.ADh=function(F,fa){var Qa=this;this.Ez.ddaGetBinding(F.DdaMethod.ControlId,F.DdaBindingsMethod.BindingId,function(Ab){if(We.a(Ab)||!Ab.Result)Qa.we.JG(Ab,fa);else{var Cc=Qa.we.BP();Cc.Bindings=Array(1);Cc.Bindings[0]=
Qa.Ve.QZb(Ab.Result);fa(Cc)}},fa)};d.prototype.CIh=function(F){var fa=this.we.BP(),Qa={};Qa[OSF.DDA.Marshaling.FilePropertiesKeys.Url.toString()]=this.$.workbookContext.ClientUrl;fa[OSF.DDA.Marshaling.FilePropertiesKeys.Properties.toString()]=Qa;F(fa)};d.prototype.Z1i=function(F,fa){var Qa=this;this.Ez.ddaReleaseBinding(F.DdaMethod.ControlId,F.DdaBindingsMethod.BindingId,function(Ab){We.a(Ab)?Qa.we.JG(Ab,fa):Qa.we.Au(fa)},fa)};d.prototype.BCh=function(F,fa){var Qa=this;this.Ez.ddaGetAllBindings(F.DdaMethod.ControlId,
function(Ab){if(We.a(Ab))Qa.we.JG(Ab,fa);else{var Cc=Qa.we.BP();if(Ab.Result){Ab=Ab.Result;Cc.Bindings=Array(Ab.length);for(var Vc=0;Vc<Ab.length;Vc++)Cc.Bindings[Vc]=Qa.Ve.QZb(Ab[Vc])}else Cc.Bindings=null;fa(Cc)}},fa)};d.prototype.Ard=function(F,fa){var Qa=this;this.Ez.ddaLoadSettings(F.DdaMethod.ControlId,function(Ab){if(We.a(Ab))Qa.we.JG(Ab,fa);else{var Cc=Qa.we.BP();Cc.Properties=Ab.Result;fa(Cc)}},fa)};d.prototype.saveSettings=function(F,fa){for(var Qa=this,Ab={Settings:[]},Cc=0;Cc<F.DdaSettingsMethod.Properties.length;Cc++){var Vc=
{};Vc.Name=F.DdaSettingsMethod.Properties[Cc][0];Vc.Value=F.DdaSettingsMethod.Properties[Cc][1];Ab.Settings[Cc]=Vc}this.Ez.ddaSaveSettings(F.DdaMethod.ControlId,Ab,F.DdaSettingsMethod.OverwriteIfStale,function(qd){We.a(qd)?Qa.we.JG(qd,fa):Qa.we.Au(fa)},fa)};d.prototype.Nje=function(F,fa){var Qa=this,Ab=d.TWc(1,F.DdaAddRowsColumns.Data);d.Vdc(Ab)?this.we.vf(C.a.fzc,fa):this.Ez.ddaAddRowsColumns(F.DdaMethod.ControlId,F.DdaAddRowsColumns.BindingId,F.DdaAddRowsColumns.IsRow,Ab,function(Cc){We.a(Cc)?Qa.we.JG(Cc,
fa):Qa.we.Au(fa)},fa)};d.prototype.q9g=function(F,fa){var Qa=this;this.Ez.ddaDeleteAllDataValues(F.DdaMethod.ControlId,F.DdaBindingsMethod.BindingId,function(Ab){We.a(Ab)?Qa.we.JG(Ab,fa):Qa.we.Au(fa)},fa)};d.prototype.vTg=function(F,fa){var Qa=this;this.Ez.ddaClearBindingFormats(F.DdaMethod.ControlId,F.DdaClearBindingFormats.BindingId,function(Ab){We.a(Ab)?Qa.we.JG(Ab,fa):Qa.we.Au(fa)},fa)};d.prototype.xUf=function(F,fa){var Qa=this,Ab={},Cc=F.DdaSetBindingFormats.IsSetFormats;Cc?Ab.CellFormat=F.DdaSetBindingFormats.CellFormat:
Ab.TableOptions=F.DdaSetBindingFormats.TableOptions;this.Ez.ddaSetBindingFormats(F.DdaMethod.ControlId,F.DdaSetBindingFormats.BindingId,Ab,Cc,function(Vc){We.a(Vc)?Qa.we.JG(Vc,fa):Qa.we.Au(fa)},fa)};d.prototype.executeRichApiRequest=function(F,fa){var Qa=this,Ab=F.ArrayData,Cc={},Vc=Xh.g(this.$).ha;if(Ab){if("WacPartition"===Ab[0]){this.Orh(F,fa);return}var qd=Object(Wi.a)(nh.DdaFacade,Jj.a(this.$));if("SetOsfControlContainerReadyForCustomFunctions"===Ab[0]){var Gd=qd.an(F.DdaMethod.ControlId);Gd&&
(Gd.ind=!0,Gd.dGf())}Cc.HttpMethod=Ab[1];Cc.PathAndQuery=Ab[2];Cc.RequestHeaders=d.cXe(Ab[3]);Cc.RequestBody=Ab[4];Cc.AppPermission=Ab[5];Gd=Ab[6];Cc.RequestFlags=Gd;var ve=0;if(Xj.i(this.$.oa))switch(Vc.Te){case 1:ve=2;break;case 2:ve=3;break;case 128:ve=4;break;default:ve=1}var jf=null;Vc.Qa.ZB&&(jf=Vc.Qa.ZB.pj);Cc.SheetMultiRange=Wj.r(Vc.va.selectedRanges,this.$);Cc.ActiveCell=Wj.v(Vc.va.activeCell,this.$);Cc.ActiveChartId=jf;Cc.SelectionState=ve;ve=this.Ve.YY(F.DdaMethod.ControlId);Cc.InstanceId=
ve?ve.InstanceId:"";if(ve&&ve.PrimaryMarketplace){jf=nh.DdaFacade.getSolutionId(ve,this.$);var gf=ve.PrimaryMarketplace.MarketplaceType;if(gf===OSF.StoreType.InMemory){if(!ve.OwnerAddinSolutionId){this.we.vf(C.a.Swb,fa);return}if(ve.AssetMarketplace)gf=ve.AssetMarketplace.MarketplaceType;else{this.we.vf(C.a.Swb,fa);return}}else gf===OSF.StoreType.WopiCatalog&&(gf=OSF.StoreType.OMEX);var qg=Telemetry.PrivacyRules.GetAssetId(gf,ve.PrimaryMarketplace.MarketplaceRef,jf);Cc.CompliantSolutionId=qg;Cc.SolutionId=
jf;Cc.MarketplaceType=gf;Cc.SolutionVersion=ve.PrimaryMarketplace.SolutionVersion;Cc.StoreLocation=ve.PrimaryMarketplace.MarketplaceRef}else Cc.SolutionId=Cc.MarketplaceType="",Cc.CompliantSolutionId="";Cc.IsEventsEnabled=void 0===qd||null===qd||qd.dj.cZb(Cc.InstanceId);Cc.RequestGuid=bj.a.create().toString();qd=Cc.RequestBody.length;if(Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4444309_RichApiPayloadSizeLimit")&&qd>this.$.ya.ExcelRichApiMaxAllowedRequestPayloadSize){this.we.vf(C.a.Z8i,fa);Se.ULS.sendTraceTag(537163213,
0,50,"Request payload size:{0} exceeded the limit",qd);return}Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5079365_RichApiPreviewExecution")&&Gd&4096&&(qd=new ca(this.$),OfficeExtension.WacRuntime.RichApi.previewExecute(qd,S,Ab),Cc.RequestBody=Ab[4])}var Qg=d.c_e(Cc.RequestHeaders);d.OAd++;var ph=Mh.a.Ra.Kb;Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4316383_RichApiLogRequestBodySize")&&Cc&&Cc.RequestBody&&Se.ULS.sendTraceTag(537163212,0,50,String.format("Richapi json request body size is {0}",
Cc.RequestBody.length));this.Ez.executeRichApiRequest(Cc,function(Nh){var Fh;Qa.ITf(ph,!0,Nh.ServerCorrelationId);var Zh=null,ki=null,gj=Nh.ServerCorrelationId;if(null===(Fh=null===Nh||void 0===Nh?void 0:Nh.Errors)||void 0===Fh?0:Fh[0])Zh=Nh.Errors[0].MessageIdName,ki=Nh.Errors[0].Description,Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4513856_NotShowApiExceptionOnUI")&&ol.a(Qa.$).nd.AD(Nh.Errors[0].MessageId);if(We.a(Nh)||!Nh.Result)Qa.UMa(gj,Qg,"Server error",Zh,ki),Qa.we.JG(Nh,fa);else{var Ji=
null;if(Ag.EwaSettings.la(259))if((Fh=Nh.Result)&&Fh.length){for(var tk=0;tk<Fh.length;tk++)if(Fh[tk].RequestGuid===Cc.RequestGuid){Ji=Fh[tk];break}Ji||Qa.we.JG(Nh,fa)}else Ji=Nh.Result;else Ji=Nh.Result;if(!Zh&&Ji&&Ji.ResponseBody&&Ji.ResponseBody[0])if(Nh=Ji.ResponseBody[0],Nh.startsWith('{"Error":')){1<Ji.ResponseBody.length&&(Nh=Nh.substring(0,Nh.indexOf("}")+1),Nh+="}");try{var Sj=$h.a.li(Nh);Sj.Error&&Qa.UMa(gj,Qg,"Pipeline error",Sj.Error.Code,Sj.Error.Message)}catch(aj){Qa.UMa(gj,Qg,"Json deserialize error",
null,"Error info cannot be deserialized.")}}else Qa.UMa(gj,Qg);else Qa.UMa(gj,Qg,"Server error",Zh,ki);var kk=(Sj=Ji.SheetMultiRange)?Sj.SheetName:null;Nh=Ji.ActiveChartId;var Tj=Ji.SelectionState;Zh=5===Tj&&!!Sj||6===Tj||7===Tj||8===Tj;if(Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4015037_EnableRichApiRequestWhenWacDialogOpen")&&Qa.$.Ab.XJ&&Zh)Qa.we.vf(C.a.iBc,fa),Se.ULS.sendTraceTag(537163211,0,50,String.format("{0} is not allowed",Tj.toString()));else if(5===Tj&&Sj){if(Qa.$.xa&&kk)if(Qa.$.xa.tj(kk))Qa.MRc(kk);
else{var ik=null;ik=function(){Qa.$.xa.tj(kk)&&(Se.ULS.sendTraceTag(537163210,0,50,"Sheets item add event handler called"),Qa.MRc(kk),Qa.$.xa.W$a(ik))};Qa.$.xa.FXa(ik);if(Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:3973943_RichApiFixSheetActivateOnNewWorkbookEnabled")){var Kk=null;Kk=function(){Qa.$.xa.tj(kk)&&(Qa.MRc(kk),Qa.$.xa.dma(Kk))};Qa.$.xa.pga(Kk)}}}else if(6===Tj||7===Tj||8===Tj||9===Tj){if(Sj){var Wk=Wj.g(Sj.Ranges);if(kk&&Wj.cb(Wk,!0))if(Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4211161_RichApiUpdateSelectionWithoutExistsWorksheet")&&
!Qa.$.xa.tj(kk)){var Xk=null;Xk=function(){Qa.T$f(Vc,Wk,kk,Tj);Qa.$.xa.dma(Xk)};Qa.$.xa.pga(Xk)}else Qa.T$f(Vc,Wk,kk,Tj)}7===Tj?(Nh="38.{"+ml.c(Nh)+"}",gk.a(Qa.$).zma(0,Nh,!0)):8===Tj&&gk.a(Qa.$).zma(2,Nh,!0);9===Tj&&(Qa.$.ya.ApiCallToSetPageLayout=!0)}Ji.PostProcessActions?Qa.$.Kcf?(gj=$h.a.li(Ji.PostProcessActions),Qa.CSi(gj).then(function(){Qa.cbb(Ji,fa);Qa.a$c(F.DdaMethod.ControlId,Cc);return Promise.resolve(null)},function(aj){Qa.cbb(Ji,fa,aj);return Promise.reject(aj)})):(Qa.UMa(gj,Qg,"Promise not supported",
null,"Promise is not supported on this browser."),Qa.we.vf(C.a.internalError,fa)):Qa.cbb(Ji,fa)}},function(Nh){Qa.ITf(ph,!1,null);Qa.UMa(null,Qg,"Web service error");fa(Nh)})};d.prototype.a$c=function(F,fa){var Qa=Object(Wi.a)(nh.DdaFacade,Jj.a(this.$));(null===Qa||void 0===Qa?0:Qa.oJd)&&Qa.an(F)&&d.fpj(fa.RequestHeaders)&&(Se.ULS.sendTraceTag(537163209,0,50,"ExecuteRichApiRequest(PostProcess): fire a RecordingStateChanged event to ControlId: {0}; SolutionId: {1}.",F,fa.SolutionId),Qa.oJd.ihh(F))};
d.prototype.Orh=function(F,fa){var Qa=this,Ab=this.Ve.YY(F.DdaMethod.ControlId),Cc=nh.DdaFacade.getSolutionId(Ab,this.$),Vc=null;Vc=nh.DdaFacade.nua(Ab,this.$);Vc=new G(Vc,this.$);Vc=new c(Cc,F.DdaMethod.ControlId,this.Ve,this.$,Vc);var qd={ResponseHeaders:[]};qd.ResponseBody=Array(1);Ab=d.cXe(F.ArrayData[3]);var Gd=d.c_e(Ab);Ab=new na(this.$.ya.CreateWorkbookMaxAllowedBase64Size,this.cof);OfficeExtension.WacRuntime.RichApi.executeRichApiRequest(Vc,Z,Ab,F.ArrayData).then(function(ve){if(!ve)return Qa.jsd(!1,
"The rich api executor call failed",Gd),Se.ULS.sendTraceTag(537163208,0,10,"The rich api executor call failed"),qd.ResponseStatusCode=500,Qa.cbb(qd,fa),null;Qa.jsd(!0,"The rich api executor call succeeded",Gd);qd.ResponseStatusCode=ve[0];qd.ResponseBody[0]=ve[2];Qa.cbb(qd,fa);return null},function(ve){qd.ResponseStatusCode=400;qd.ResponseBody[0]=ve.toString();Qa.jsd(!1,"The rich api executor call failed",Gd);Se.ULS.sendTraceTag(537163207,0,10,"A Excel Rich API batch execution was failed, AppId:{0}",
Cc);Qa.cbb(qd,fa);return null})};d.prototype.ITf=function(F,fa,Qa){d.OAd--;F=gl.a(Mh.a.Ra,F);Se.ULS.sendTraceTag(36763356,0,50,"Rich Api perf log -- total milliseconds used:{0}, requests pending:{1}, request result:{2}, server correlationid: {3}.",F,d.OAd,fa?"success":"false",Qa)};d.prototype.cbb=function(F,fa,Qa){Qa=void 0===Qa?null:Qa;var Ab=Array(3);Ab[0]=F.ResponseStatusCode;Ab[1]=d.iSh(F.ResponseHeaders);var Cc=[],Vc=!1;if(Qa&&F.ResponseBody){var qd=$h.a.li(F.ResponseBody.join(""));qd.Error||
(Vc={},Vc.Error=Qa,Vc.TraceIds=qd.TraceIds,Vc.ProcessedResults={},Vc.ProcessedResults.Results=qd.Results,Cc[0]=$h.a.Hc(Vc),Vc=!0)}Ab[2]=Vc?Cc:F.ResponseBody;F=this.we.BP();F.Data=Ab;fa(F)};d.prototype.Zud=function(F,fa){(new Q(this.$,this.we,this.Ez)).Zud(F,fa)};d.prototype.Gsi=function(F,fa){Se.ULS.sendTraceTag(537163206,0,50,"MessageParent API called!");var Qa=F[OSF.DDA.Marshaling.MessageParentKeys.MessageToParent],Ab=F[Lg.a.STc],Cc=F[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];F=this.$.da.Aa(232).l0a.Hsi(F.DdaMethod.ControlId,
Qa,Ab,Cc);F===C.a.success?this.we.Au(fa):(Se.ULS.sendTraceTag(537163205,0,10,"MessageParent API Failed!"),this.we.vf(F,fa))};d.prototype.Csi=function(F,fa){Se.ULS.sendTraceTag(537163204,0,50,"MessageChild API called!");var Qa=F[OSF.DDA.Marshaling.SendMessageKeys.MessageContent],Ab=F[Lg.a.STc],Cc=F[OSF.DDA.Marshaling.MessageParentKeys.TargetOrigin];this.$.da.Aa(232).l0a.Afj(F.DdaMethod.ControlId,Qa,Ab,Cc);this.we.Au(fa)};d.prototype.getAccessToken=function(F,fa){function Qa(Vc,qd){if(Vc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)Vc=
Ab.we.BP(),Vc[OSF.DDA.Marshaling.SingleSignOn.AccessTokenResultKeys.AccessToken]=qd.accessToken,fa(Vc);else{qd=Ab.Ve.YY(F.DdaMethod.ControlId);var Gd=null!==qd.OwnerAddinSolutionId?qd.OwnerAddinSolutionId:qd.PrimaryMarketplace.MarketplaceType,ve={};Se.ULS.sendTraceTag(537163202,0,10,"{0}.",(ve.errorCode=Vc.toString(),ve.appId=Telemetry.PrivacyRules.GetAssetId(Gd,qd.PrimaryMarketplace.MarketplaceRef,nh.DdaFacade.getSolutionId(qd,Ab.$)),ve.storeType=Gd,ve));Ab.we.vf(Vc,fa)}}var Ab=this;Se.ULS.sendTraceTag(537163203,
0,50,"GetAccessToken API called!");var Cc=!Ag.EwaSettings.la(24);Wg.TaskExtensions.Ba(Zi.GetServiceTaskFactory.create(this.$.da,137,this.$.ma,1),function(Vc){var qd=Ab.Ve.Gi,Gd=ma.getInstance();J.AppsForOfficeSingleSignOnManager.getInstance(qd,Vc.result,Gd).getAccessToken(F.DdaMethod.ControlId,Cc,F,Qa)},this.$.ma)};d.prototype.getAuthContext=function(F,fa){var Qa=this;Wg.TaskExtensions.Ba(Zi.GetServiceTaskFactory.create(this.$.da,137,this.$.ma,1),function(){var Ab=Qa.Ve.Gi.getOsfControl(F.DdaMethod.ControlId);
if(!Ag.EwaSettings.getBooleanFeatureGate("Microsoft.Office.OEP.Block3PGetAuthContext",!0)||Ab.isFirstParty()){Ab=Ab.getManifest();var Cc=Ab.getMarketplaceID(),Vc=Ab.getWebApplicationId(),qd=Ab.getWebApplicationMsaId();hh.a.instance.resolve("Common.App.WopiIdentity.WopiIdentityManager").getAuthContext(Cc).then(function(Gd){var ve=Qa.we.BP(),jf={};jf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=Vc;jf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=qd||Vc;jf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=
Gd.upn;jf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=Gd.userId;jf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=Gd.authority;jf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=Id.kDh(Gd.authorityType);jf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=Gd.isAnonymous;jf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=Gd.tenantId;jf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=Gd.supportsAuthToken;
ve[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=jf;fa(ve)},function(Gd){var ve=Qa.we.BP(),jf={},gf=new Id;jf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AppId]=Vc;jf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.MsaAppId]=qd||Vc;jf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Upn]=gf.upn;jf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.UserId]=gf.userId;jf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Authority]=gf.authority;jf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthorityType]=
gf.authorityType;jf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.IsAnonymous]=gf.isAnonymous;jf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.TenantId]=gf.tenantId;jf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.Error]=Gd;jf[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.SupportsAuthToken]=gf.supportsAuthToken;ve[OSF.DDA.Marshaling.WebAuth.GetAuthContextResultKeys.AuthContext]=jf;ve.Error=1;fa(ve)})}},this.$.ma)};d.prototype.r$h=function(F){var fa=Xh.g(this.$).ha;return 16===
fa.Te&&!!fa.Qa.nc&&!!fa.Qa.nc.floatingObject&&Rj.a.equals(fa.Qa.nc.floatingObject.id,F,!0)};d.prototype.Vbd=function(F){var fa=Xh.g(this.$).ha;return fa.va.Dh?1===fa.Te||this.r$h(F)?fa.Lha:null:null};d.prototype.Mgc=function(F,fa){return 1!==F&&2!==F&&3!==F?(this.we.vf(C.a.vxe,fa),!1):!0};d.prototype.jsd=function(F,fa,Qa){var Ab={};Ab.a=this.$.ya.UserSessionId;Ab.b=F;Ab.c=fa;Ab.d=null;Ab.e=Qa;Ij.b().Ne(37,Ab)};d.prototype.UMa=function(F,fa,Qa,Ab,Cc){Qa=void 0===Qa?null:Qa;Ab=void 0===Ab?null:Ab;Cc=
void 0===Cc?null:Cc;var Vc={};F&&(Vc.ServerCorrelationId=F);void 0!==fa&&null!==fa&&(Vc.Source=fa);Qa&&(Vc.ErrorType=Qa);Ab&&(Vc.MessageId=Ab);Cc&&(Vc.StatusDescription=Cc);Se.ULS.sendTraceTag(50688452,0,50,$h.a.Hc(Vc))};d.prototype.CSi=function(F){for(var fa=new Promise(function(Ab){Ab(null)}),Qa=0;Qa<F.length;Qa++)fa=this.BSi(fa,F[Qa]);return fa};d.prototype.BSi=function(F,fa){var Qa=this;if(!fa)return Se.ULS.sendTraceTag(537163201,0,10,"Null PostProcessAction."),F.then(function(){return Promise.reject(d.d2a(B.generalException,
Fe.a.instance.ea(1708),null))});switch(fa.actionType){case 1:case 2:F=F.then(function(){var Ab=Object(Wi.a)(nh.DdaFacade,Jj.a(Qa.$));if(Ab.an(fa.controlId))switch(Ab.dj.YWh(fa),fa.messageType){case 14:case 100:Ab.nJd.yZb(fa);break;case 11:case 12:Ab.Naj.snb(fa);break;case 51:case 52:Ab.Laj.snb(fa);break;case 2101:case 2102:Ab.Maj.snb(fa);break;case 2E3:Ab.Oaj.yZb(fa);break;case 2201:Qa.$.gka&&Ab.oJd.GHg(fa);break;case 2203:Ab.Paj.HHg(fa);break;case 2700:Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&
Ab.mJd.yZb(fa)}else Se.ULS.sendTraceTag(537163171,0,10,"OsfControl with instanceId[{0}] doesn't exist.",fa.controlId);return Promise.resolve(null)});break;case 3:F=F.then(function(){Qa.MWh(fa);return Promise.resolve(null)});break;case 15:Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:4251858_RangePicker")&&(F=F.then(function(){Qa.mYh(fa);return Promise.resolve(null)}));break;case 4:F=F.then(function(){if(Ag.EwaSettings.la(104)){var Ab=Xh.g(Qa.$).ha.va.activeCell;Ab.top!==fa.row+1&&Ab.left!==fa.column+
1&&(Ab=Wj.v(qa.Range.ld(fa.row+1,fa.column+1),Qa.$),Xh.g(Qa.$).yi(Ab,null,null,null,3,Gf.a.a8g));Vj.a(Qa.$,243,242,0,function(Cc){Cc.AJb(fa.row+1,fa.column+1,1,!1,!1)})}return Promise.resolve(null)});break;case 7:F=F.then(function(){Object(Wi.a)(nh.DdaFacade,Jj.a(Qa.$)).dj.kIe(fa.controlId,fa.isEnableEvents);return Promise.resolve(null)});break;case 5:F=F.then(function(){return Qa.w6g(fa)});break;case 6:F=F.then(function(){return Qa.NNi(fa)});break;case 8:F=F.then(function(){Ag.EwaSettings.isChangeGateEnabled("OfficeVSO:5333368_ClearBeforeCloseRegistrationsInWorkbookCloseApi")&&
Object(Wi.a)(nh.DdaFacade,Jj.a(Qa.$)).uTg();var Ab=new jl.a(ll.a.Ck,5,null);hl.a(Qa.$).Rs(Ab);return Promise.resolve(null)});break;case 9:F=F.then(function(){return Qa.ihj(fa)});break;case 10:F=F.then(function(){return Qa.LPj(fa)});break;case 11:F=F.then(function(){return Qa.KPj()});break;case 12:F=F.then(function(){return Qa.HPj()});break;case 13:F=F.then(function(){return Qa.IPj(fa)});break;case 14:F=F.then(function(){return Qa.JPj(fa)});break;case 16:F=F.then(function(){return Promise.resolve(fa)});
break;case 17:F=F.then(function(){return Qa.zdj(fa,Object(Wi.a)(nh.DdaFacade,Jj.a(Qa.$)))});break;case 18:Xh.g(this.$).focus();break;case 19:this.r2e(fa.entryType,!1,fa.options);break;case 20:this.r2e(fa.entryType,!0,fa.options);break;default:F=F.then(function(){return Promise.reject(d.d2a(B.$Eg,Fe.a.instance.ea(1709),null))})}return F};d.prototype.mYh=function(F){var fa=Object(Wi.a)(nh.DdaFacade,Jj.a(this.$)).an(F.controlId);if(fa&&!(!F.operationType^!fa.Wca)){Xh.g(this.$).fgc=!0;switch(F.operationType){case 0:var Qa=
new Uk.a(document.createElement("input"));Qa.text=F.range;fa.o5h(Xh.g(this.$).Bh.R4g(Qa,new fl.a(this.$)));fa.Wca.startEdit(!0);break;case 1:fa.ELf();this.rangePicker=null;break;case 2:fa.Wca.iag(F.range);break;case 3:fa.Wca.iag(F.startingRange);fa=F.expandSelection;Qa=F.getNextDataRegionCell;var Ab=0;switch(F.keyboardDirectionValue){case 2:Ab=38;F=fa&&Qa?105288353:fa?-31900117:Qa?542791952:137938150;break;case 3:Ab=40;F=fa&&Qa?-1297307319:fa?-1603798598:Qa?1713663844:-798660877;break;case 0:Ab=37;
F=fa&&Qa?-403586027:fa?2039316657:Qa?-2012742350:-1470715894;break;case 1:Ab=39;F=fa&&Qa?784916030:fa?589730764:Qa?1324884057:-1231471547;break;default:F=1461300262}fa=this.R2b("keydown",Ab,fa,Qa);Xh.g(this.$).cHb(fa,new ak.a(F,1,0,8,null))}Xh.g(this.$).fgc=!1}};d.prototype.R2b=function(F,fa,Qa,Ab){var Cc=document.createEvent("KeyboardEvent");if(zh.a.ME)Cc.initKeyboardEvent(F,!1,!1,window.self,"A",0,Ab,!1,Qa,!1);else{var Vc="";Qa&&(Vc+="Shift");Ab&&(Vc+=0<Vc.length?" Control":"Control");Cc.initKeyboardEvent(F,
!1,!1,window.self,"A",0,Vc,!1,"en-US")}F=new Sys.UI.DomEvent(Cc);F.keyCode=fa;return F};d.prototype.MWh=function(F){switch(F.operationType){case 1:Wg.TaskExtensions.Ba(Zi.GetServiceTaskFactory.create(this.$.da,153,this.$.ma,1),function(fa){fa.result.jId()},this.$.ma,3);break;case 2:if(F=Object(Wi.a)(nh.DdaFacade,Jj.a(this.$)).an(F.controlId))F.ind=!0,F.dGf()}};d.prototype.w6g=function(F){var fa=this,Qa=F.fileBase64;return Qa&&Qa.length>this.$.ya.CreateWorkbookMaxAllowedBase64Size?Promise.reject(d.d2a(B.invalidArgument,
Fe.a.instance.ea(1712),"Application.CreateWorkbook")):(new Promise(function(Ab,Cc){var Vc=new Ub.StandardDialog;Vc.kc=4;Vc.Kk(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_NewFileAPIConsentMessage,1,function(qd){2!==qd&&qd||Cc(d.d2a(B.Tzd,Fe.a.instance.ea(1711),"Application.CreateWorkbook"));qd=new wa("blank","agave",Qa?"streamBase64":"streamEmpty",Qa);fa.cof.create(Ab,Cc,qd).y_a()})})).then(function(Ab){fa.w7b.set(F.fakeFileId,Ab);return Promise.resolve(null)},function(Ab){return Ab?
Promise.reject(Ab):Promise.reject(d.d2a(B.generalException,Fe.a.instance.ea(1708),"Application.CreateWorkbook"))})};d.prototype.NNi=function(F){var fa=this;return new Promise(function(Qa,Ab){if(fa.w7b.has(F.fakeFileId)){var Cc=fa.w7b.get(F.fakeFileId);Ab=new Ub.StandardDialog;Ab.kc=4;Ab.Kk(CommonUIStrings.l_GeneralAddInMessageDialogTitle,CommonUIStrings.l_OpenWindowConsentMessage,1,function(Vc){1===Vc&&Eh.HelperMethods.sf(Cc,void 0,void 0,"DdaMethodHandler.fileUrl");Qa(null)})}else Ab(d.d2a(B.generalException,
Fe.a.instance.ea(1708),"Document.Open"))})};d.prototype.ihj=function(F){var fa=this;return new Promise(function(Qa){Object(Wi.a)(nh.DdaFacade,Jj.a(fa.$)).pQf=F.runtimeCalculationMode;var Ab=fa.$.da.Aa(268);Ab&&Ab.Zvd(3===F.runtimeCalculationMode);Qa(null)})};d.prototype.LPj=function(F){Pf.a.Qyb(this.$)&&this.$.da.Aa(331).dbb(0,F.urlStr,!0,!0,null);return Promise.resolve(null)};d.prototype.KPj=function(){Pf.a.Qyb(this.$)&&this.$.da.Aa(331).dbb(1,null,!0,!0,null);return Promise.resolve(null)};d.prototype.HPj=
function(){Pf.a.Qyb(this.$)&&this.$.da.Aa(331).hIe();return Promise.resolve(null)};d.prototype.IPj=function(F){Pf.a.Qyb(this.$)&&this.$.da.Aa(331).dbb(5,F.urlStr,!0,!0,null);return Promise.resolve(null)};d.prototype.JPj=function(F){if(Pf.a.Qyb(this.$)){var fa=this.$.da.Aa(331);fa=yl(fa.K$);for(var Qa=fa.next();!Qa.done;Qa=fa.next())Qa=Qa.value,Qa.IsActive&&Qa.HostEditUrl&&Qa.UrlStr===F.hostEditUrlStr&&Eh.HelperMethods.sf(Qa.HostEditUrl,"_blank")}return Promise.resolve(null)};d.prototype.zdj=function(F,
fa){var Qa=M.a.vW;F=$h.a.li(F.payload);var Ab={};"eventId"in F&&"payload"in F&&(Ab.eventId=F.eventId,Ab.payload=F.payload);fa.jM(2201,Qa,$h.a.Hc(Ab));return Promise.resolve(null)};d.prototype.r2e=function(F,fa,Qa){var Ab=this.$.da.Aa(5);Ab&&(F=this.aEh(F))&&(fa?Ab.removeEntry(F):Ab.zje(F,Qa))};d.prototype.aEh=function(F){switch(F){case 0:return 63}};d.prototype.MRc=function(F){F=Object(Wi.a)(kl.a,this.$.xa.getItemByName(F));(null===F||void 0===F?0:F.visible)&&F.activate(!0)};d.prototype.T$f=function(F,
fa,Qa,Ab){var Cc=F.va.wA,Vc=Cc<fa.length&&fa[Cc].contains(F.va.activeCell);F=Vc?F.va.activeCell:fa[0].topLeft;Cc=Vc?Cc:0;Xh.g(this.$).PU(fa,Cc,Qa,null,F,null,null,3,Gf.a.b8g,void 0,void 0,void 0,6===Ab)};d.cXe=function(F){if(!F||!F.length)return null;for(var fa=Array(F.length/2),Qa=0;Qa<F.length/2;Qa++)fa[Qa]={},fa[Qa].Name=F[2*Qa],fa[Qa].Value=F[2*Qa+1];return fa};d.iSh=function(F){if(!F||!F.length)return null;for(var fa=Array(2*F.length),Qa=0;Qa<F.length;Qa++)fa[2*Qa]=F[Qa].Name,fa[2*Qa+1]=F[Qa].Value;
return fa};d.n$c=function(F){if(!F||!F.length)return null;for(var fa=Array(F.length),Qa=0,Ab=F.length;Qa<Ab;Qa++){var Cc=F[Qa].length;if(Cc){fa[Qa]=Array(Cc);for(var Vc=0;Vc<Cc;Vc++)fa[Qa][Vc]=null==F[Qa][Vc]?null:F[Qa][Vc].toString()}else return null}return fa};d.h1b=function(F){return"string"===typeof F?bl.a.Kn(d.X7g,F,0):F};d.fQe=function(F){return"string"===typeof F?bl.a.Kn(d.$7g,F,0):F};d.rbg=function(F){return"string"===typeof F?bl.a.Kn(d.d8g,F,0):F};d.B$h=function(F){switch(F.DdaMethod.DispatchId){case 68:case 74:case 70:case 77:case 80:case 64:case 75:case 81:return!0}return!1};
d.TWc=function(F,fa){var Qa={};Qa.CoerceType=F;1===Qa.CoerceType?(Qa.Data=d.n$c(fa.Rows),Qa.Headers=d.n$c(fa.Headers)):Qa.Data=d.n$c(fa);return Qa};d.Qre=function(F){if(1===F.CoerceType){var fa={};return fa.Headers=F.Headers,fa.Rows=F.Data,fa}return F.Data};d.Vdc=function(F){return 1===F.CoerceType?!F.Data&&!F.Headers:!F.Data};d.c_e=function(F){var fa="Unknown";if(!F)return fa;for(var Qa=0;Qa<F.length;Qa++)if(F[Qa].Name.toLowerCase()===uj.a.Qaj){fa=F[Qa].Value;break}return fa};d.fpj=function(F){if(!F)return!1;
for(var fa=uj.a.Txi.toLowerCase(),Qa=0;Qa<F.length;Qa++)if(F[Qa].Name.toLowerCase()===fa)return!0;return!1};d.d2a=function(F,fa,Qa){var Ab={};Ab.Code=F;Ab.Message=fa;Ab.Location=Qa;Ab.ActionIndex=0;return Ab};tl.Object.defineProperties(d.prototype,{ZP:{configurable:!0,enumerable:!0,get:function(){return this.we}}});tl.Object.defineProperties(d,{X7g:{configurable:!0,enumerable:!0,get:function(){d.Woa||(d.Woa={},d.Woa[Microsoft.Office.WebExtension.CoercionType.Table]=1,d.Woa[Microsoft.Office.WebExtension.CoercionType.Text]=
2,d.Woa[Microsoft.Office.WebExtension.CoercionType.Matrix]=3,d.Woa[Microsoft.Office.WebExtension.CoercionType.Html]=4,d.Woa[Microsoft.Office.WebExtension.CoercionType.Ooxml]=5);return d.Woa}},$7g:{configurable:!0,enumerable:!0,get:function(){d.wgb||(d.wgb={},d.wgb[Microsoft.Office.WebExtension.FilterType.All]=1,d.wgb[Microsoft.Office.WebExtension.FilterType.OnlyVisible]=2);return d.wgb}},d8g:{configurable:!0,enumerable:!0,get:function(){d.xgb||(d.xgb={},d.xgb[Microsoft.Office.WebExtension.ValueFormat.Unformatted]=
2,d.xgb[Microsoft.Office.WebExtension.ValueFormat.Formatted]=1);return d.xgb}}});d.Woa=null;d.wgb=null;d.xgb=null;d.OAd=0;Object($d.a)(d,"DdaMethodHandler",null,[237,3]);var Vk=xd.a;vm(a,Vk);a.prototype.Md=function(){var F=this,fa=Zi.GetServiceTaskFactory.create(this.$.da,106,this.ma,this.tb),Qa=Zi.GetServiceTaskFactory.create(this.$.da,165,this.ma,this.tb),Ab=eb(this.ma,this.tb);Wg.TaskExtensions.Ba(Wg.TaskExtensions.ve([fa,Qa,Ab],this.ma),function(){var Vc=fa.result,qd=hh.a.instance.resolve("Common.App.NewAndOpen.UX.INewDocumentFromStreamOperationFactory");
F.Ed([new d(F.$,Vc,qd)])},this.ma,3);var Cc=hh.a.instance;Wg.TaskExtensions.Ba(Zi.GetServiceTaskFactory.create(this.$.da,137,this.$.ma,this.tb),function(){Cc.register(ob,"Microsoft.Office.Excel.WebUI.Client.WebExtension.AuthenticationServiceFactory").zc().Ic(function(){return new ob})},this.$.ma)};a.ja=function(F){xd.a.de(82,new a(F))};Object($d.a)(a,"DdaCommandHandlerFactory",xd.a,[]);Type.registerNamespace("Microsoft.AppRuntime");Type.registerNamespace("Microsoft.InternalService");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.Agave");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.WebExtension");Type.registerNamespace("_Ewa");Mg.a.Yi("");Mg.a.Yi(".ewa-wx-disabled-div{position:absolute;height:100%;width:100%}.ewa-wx-container-div{position:relative}.ewa-ptp-nov2-flex .ewa-wx-container-div{flex:1}");Type.registerNamespace("Common.App.AppsForOffice");window.Common.App.AppsForOffice.AddinShortcutsPreferenceSettingHelper=Ug.a;Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.WopiIdentity");
vb.main();(function(){tj.a.Ga(function(F){rg.ja(F)})})();Type.registerNamespace("Common.App.AppsForOfficeCommon");Type.registerNamespace("Common.App.AppsForOfficeCommon");(function(){tj.a.Ga(function(F){dg.ja(F);Qc.ja(F)})})();(function(){tj.a.Ga(function(F){rf.ja(F)})})();Type.registerNamespace("CommandUI.AddInCommands");(function(){tj.a.Ga(function(F){Ag.EwaSettings.la(53)&&E.ja(F)})})();(function(){tj.a.Ga(function(F){Ag.EwaSettings.la(121)&&wb.ja(F)})})();tj.a.Ga(tb.ja);tj.a.Ga(wd.ja);Type.registerNamespace("Common.App.AppsForOfficeOauth");
Type.registerNamespace("Common.App.SmartLookup");(function(){tj.a.Ga(function(F){Fa.ja(F);ya.ja(F)})})();tj.a.Ga(a.ja)},1417:function(y,D,b){function a(){this.zCc=null;this.gHc=0;this.NIc=!1;this.Ya=new k.a;this.$lg=new c.a}function d(){this.hHe=this.displayName=this.Gpb=this.nl=this.Ps=null;this.isUpgraded=!1}y=b(0);var c=b(185),k=b(94),n=b(5);d.prototype.udf=function(l,f){return n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?this.Ps.getStoreType().toLowerCase()===
l.toLowerCase()&&this.Ps.getSolutionId().toLowerCase()===f.toLowerCase():this.Ps.getStoreType().toLowerCase()===l.toLowerCase()&&this.Ps.getMarketplaceID().toLowerCase()===f.toLowerCase()};Object(y.a)(d,"AddinCommandsResourceItem",null,[]);b.d(D,"a",function(){return a});a.prototype.fzg=function(l){this.Ya.addHandler("AddinCommandsLoadingMessageChanged",l)};a.prototype.F3i=function(l){this.Ya.removeHandler("AddinCommandsLoadingMessageChanged",l)};a.prototype.Dbb=function(l){l!==this.zCc&&(this.zCc=
l,this.Ya.raiseEvent("AddinCommandsLoadingMessageChanged"))};a.prototype.ehj=function(){this.gHc++;this.PXa||this.Dbb(CommonUIStrings.l_LoadingAddInsTitle)};a.prototype.auc=function(){this.gHc--;this.Drd()&&(this.NIc?this.PXa!==CommonUIStrings.l_ErrorLoadingAddInsTitle&&this.Dbb(CommonUIStrings.l_ErrorLoadingAddInsTitle):this.Dbb(null))};a.prototype.XLd=function(l){this.NIc=!0;this.Dbb((void 0===l?0:l)?CommonUIStrings.l_InstallingCustomFunctionsErrorStatusBarMsg:CommonUIStrings.l_ErrorLoadingAddInsTitle)};
a.prototype.Rve=function(){this.NIc=!1;this.Drd()?this.Dbb(null):this.Dbb(CommonUIStrings.l_LoadingAddInsTitle)};a.prototype.Drd=function(){return 0>=this.gHc};a.prototype.L3=function(l,f,u){u=void 0===u?0:u;for(var v=yl(this.TKa),m=v.next();!m.done;m=v.next())if(m=m.value,m.udf(l,f)&&(!m.nl||m.nl.HBh===u))return m;return null};a.prototype.tje=function(l,f,u,v){var m=new d;m.Ps=l;m.nl=f;m.Gpb=u;m.displayName=v;this.TKa.add(m)};a.prototype.lxg=function(l,f,u,v){var m=new d;m.Ps=l;m.nl=f;m.Gpb=null;
m.hHe=u;m.displayName=v;this.TKa.add(m)};a.prototype.VKf=function(l,f){for(var u=0,v=yl(this.TKa),m=v.next();!m.done;m=v.next())m=m.value,n.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?m.Ps.getStoreType()===l&&m.Ps.getSolutionId()===f?this.TKa.removeAt(u):u++:m.Ps.getStoreType()===l&&m.Ps.getMarketplaceID()===f?this.TKa.removeAt(u):u++};a.getInstance=function(){a.Na||(a.Na=new a);return a.Na};tl.Object.defineProperties(a.prototype,{PXa:{configurable:!0,
enumerable:!0,get:function(){return this.zCc}},TKa:{configurable:!0,enumerable:!0,get:function(){return this.$lg}}});a.Na=null;Object(y.a)(a,"AddinCommandsResourceManager",null,[])},858:function(y,D,b){function a(){}b.d(D,"a",function(){return a});y=b(0);var d=b(32);a.sSe=function(c){return d.a.Kn(a.Esi,c.toString(),a.internalError)};tl.Object.defineProperties(a,{Esi:{configurable:!0,enumerable:!0,get:function(){var c={};return a.x9d||(a.x9d=(c["-2002156328"]=a.vxe,c["-1954750170"]=a.w_e,c["317650254"]=
a.kVg,c["-1005263101"]=a.t7h,c["1353664579"]=a.Tej,c["159671765"]=a.u7h,c["1446690022"]=a.GVe,c["1150069548"]=a.fzc,c["-1409306331"]=a.iue,c["338507772"]=a.hDe,c["-457159301"]=a.HOi,c["-1037701970"]=a.w7g,c["-1893322318"]=a.z7h,c["965579896"]=a.y7g,c["93287890"]=a.x7g,c["358088857"]=a.Qhj,c["-1223650923"]=a.hDe,c["2007306190"]=a.jRg,c["1549955423"]=a.Wqe,c["-1275974171"]=a.y7h,c["382101082"]=a.QNi,c["-898776235"]=a.rui,c["335464256"]=a.gui,c["1677378049"]=a.x7h,c["-261992848"]=a.VGj,c["-980820954"]=
a.Wqe,c["-931375837"]=a.PNi,c["929186550"]=a.Geh,c["-982144310"]=a.zVi,c["-785741187"]=a.r7h,c["2125217573"]=a.B7h,c["299124955"]=a.s7h,c["1669853884"]=a.cbj,c["-1515932330"]=a.lVg,c["314621024"]=a.gyh,c["-300049690"]=a.nRg,c["14766835"]=a.Ymj,c["-1251992761"]=a.nGe,c["-2087635043"]=a.invalidOrTimedOutSession,c["2100961153"]=a.invalidOrTimedOutSession,c["-1218744139"]=a.invalidSheetName,c["-1468309555"]=5006,c["-315732528"]=a.invalidOrTimedOutSession,c["611268539"]=a.invalidOrTimedOutSession,c["1531005923"]=
5006,c["1593924569"]=5006,c["299476328"]=a.PEa,c["49173765"]=a.PEa,c["-907155566"]=a.PEa,c["-1201603824"]=a.PEa,c["1541165282"]=a.PEa,c["-1347753427"]=a.PEa,c["134912532"]=a.PEa,c["1780971550"]=a.responsePayloadSizeLimitExceeded,c))}}});a.success=0;a.vxe=1E3;a.w_e=1001;a.kVg=1002;a.t7h=1003;a.Tej=1004;a.u7h=1005;a.GVe=1008;a.TPe=1009;a.invalidSheetName=1014;a.fzc=2E3;a.iue=2001;a.hDe=2002;a.HOi=2003;a.w7g=2004;a.z7h=2005;a.y7g=2007;a.x7g=2008;a.Qhj=2009;a.jRg=2014;a.Aej=3E3;a.Wqe=3002;a.y7h=3004;
a.QNi=3005;a.rui=3006;a.gui=3007;a.x7h=3008;a.VGj=3009;a.PNi=3010;a.Ymj=4002;a.Wzd=5E3;a.internalError=5001;a.nGe=5002;a.Swb=5004;a.UHj=5007;a.p2h=5008;a.UKg=5009;a.invalidOrTimedOutSession=5012;a.iBc=5016;a.PEa=5102;a.Z8i=5103;a.responsePayloadSizeLimitExceeded=5104;a.CQg=7001;a.x1f=7002;a.Geh=8E3;a.zVi=8001;a.r7h=8010;a.B7h=8011;a.s7h=8012;a.cbj=8020;a.lVg=8021;a.gyh=8022;a.nRg=8023;a.Zri=11E3;a.gvi=11001;a.A7h=11002;a.x9d=null;Object(y.a)(a,"DdaErrorIds",null,[])},859:function(y,D,b){function a(){}
b.d(D,"a",function(){return a});y=b(0);a.generalException="GeneralException";a.invalidArgument="InvalidArgument";a.notImplemented="NotImplemented";a.oRc="AccessDenied";a.notSupported="NotSupported";a.apiNotAvailable="ApiNotAvailable";a.notAllowed="NotAllowed";a.Tzd="OperationCancelled";a.userNotSignedIn="UserNotSignedIn";a.userAborted="UserAborted";a.XHj="UnsupportedUserIdentity";a.invalidResourceUrl="InvalidResourceUrl";a.invalidGrant="InvalidGrant";a.jDg="AddinIsAlreadyRequestingToken";a.z$i="ResourceNotAllowed";
a.clientError="ClientError";a.serverError="ServerError";a.RYg="ControlIdNotFound";a.qaj="RibbonApiNotAvailable";a.hostRestartNeeded="HostRestartNeeded";a.invalidRibbonDefinition="InvalidRibbonDefinition";a.sharedRuntimeNotAvailable="SharedRuntimeNotAvailable";Object(y.a)(a,"ErrorCodes",null,[])},861:function(y,D,b){function a(cb,mc){var Oc=Ae.call(this)||this;Oc.fa=null;Oc.Ml=null;Oc.Uh=null;Oc.Cf=[];Oc.hIa=null;Oc.OCe=!1;Oc.rNb=!1;Oc.initialized=!1;Oc.disposed=!1;Oc.rBa=null;Oc.enc=[];Oc.JCe=[];
Oc.yOa=[];Oc.$_a=null;Oc.ZAd=new Pc.a(wd.a.Ik());Oc.cYb=new Tc.a(wd.a.Ik());Oc.YDb=[];Oc.kDf=[];Oc.g4b=350;Oc.vea=null;Oc.Fwa=null;Oc.ZQc=!1;Oc.Hce=null;Oc.Ece=null;Oc.Ice=null;Oc.Gce=null;Oc.Kce=null;Oc.Aqg=null;Oc.Fce=null;Oc.Jce=null;Oc.Lce=null;Oc.Mce=null;Oc.Nce=null;Oc.Kf=function(){Oc.rBa=Oc.fa.zn.WebExtensions;for(var Sc=Oc.Cf.length-1;0<=Sc;--Sc){var $c=Oc.Cf[Sc],le;if(le=!Oc.Vvh($c.controlId))le=$c,le=$a.EwaSettings.la(121)?!le.rHa:!0;le&&($c.flc(),Array.removeAt(Oc.Cf,Sc))}if(Oc.rBa)for(Sc=
0,$c=Oc.rBa.length;Sc<$c;Sc++){le=Oc.rBa[Sc];var we=Oc.an(le.WebExtensionId);we&&we.Dyd(le)}};Oc.wla=function(Sc){Oc.raiseEvent("csc",Sc.getID())};Oc.Wwf=function(Sc,$c,le){if($a.EwaSettings.isChangeGateEnabled("OfficeVSO:4841553_AddinKeyboardShortcutsInTaskpane")&&$c===OSF.AgaveHostAction.KeyboardShortcuts){var we=Object(ub.a)(Object,le);$c={};$c.keyCode=we.keyCode;$c.type="keydown";$c.ctrlKey=we.ctrlKey;$c.shiftKey=we.shiftKey;$c.altKey=we.altKey;$c.metaKey=we.metaKey;Sc=Oc.an(Sc);we=Sc.Ega;$c.srcElement=
Object(fb.a)(287,we)?we.qFa:Xb.g(Oc.$).Jb;$c=new Sys.UI.DomEvent($c);Sc={focusedAddinId:a.nua(Sc.cl,Oc.$)};we=new Ac.a(1461300262,1,Oc.$.ed,6,null);Xb.g(Oc.$).cHb($c,we,Sc)}else if($c===OSF.AgaveHostAction.Select)Oc.o2e(!0);else if($c===OSF.AgaveHostAction.UnSelect)Oc.o2e(!1);else if($c===OSF.AgaveHostAction.CancelDialog)Oc.LJ(-684355545,null);else if($c===OSF.AgaveHostAction.InsertAgave)Sc={},le&&(Sc[Ja.a.OXa]=le,Sc[bb.a.Kg]=a.kqb(le),Oc.LJ(-741808261,Sc));else if($c===OSF.AgaveHostAction.InsertDevManifest)Sc=
{},le&&(Sc[Ja.a.OXa]=le,Sc[bb.a.Kg]=a.kqb(le),Oc.LJ(-741808261,Sc));else if($c===OSF.AgaveHostAction.InsertDevManifestError)Sc=Object(ub.a)(Object,le),$c={},Sc=($c[Ja.a.RTc]=Oc.Ml.getDevManifestInvalidUrlErrorString(Sc.manifestUrl),$c),Oc.LJ(-2025863019,Sc);else if($c===OSF.AgaveHostAction.NotifyHostError)Sc={},Sc=(Sc[Ja.a.RTc]=Oc.Ml.getManifestInvaildErrorString(),Sc),Oc.LJ(-2025863019,Sc);else if($c===OSF.AgaveHostAction.RefreshAddinCommands)$a.EwaSettings.la(53)&&Oc.LJ(Bc.a.refreshAddinCommands,
null);else if($c===OSF.AgaveHostAction.CtrlF6Exit||$c===OSF.AgaveHostAction.CtrlF6ExitShift){if(we=Oc.$.da.Aa(15)){(Sc=Oc.an(Sc).Ega)&&Sc.Rwc();Gb.a.zf&&document.activeElement.blur();var jc={keyCode:117,type:"keydown",ctrlKey:!0};jc.shiftKey=$c===OSF.AgaveHostAction.CtrlF6ExitShift;jc.srcElement=Object(fb.a)(287,Sc)?Sc.qFa:Xb.g(Oc.$).Jb;Sc=new Sys.UI.DomEvent(jc);we.JV(Sc)}}else if($c===OSF.AgaveHostAction.PageIsReady){if((Sc=Oc.an(Sc).Ega)&&Sc.VXa===OSF.OsfControlTarget.TaskPane&&(Sc=Oc.$.da.Aa(183))&&
Oc.Cf)for($c=Ic.a.Gd(Oc.$),we=yl(Oc.Cf),jc=we.next();!jc.done;jc=we.next())a.nLa(jc.value.WT)&&($c?Sc.Qe(!0,!1):Sc.setFocusOnToolbarFirstElement())}else if($c===OSF.AgaveHostAction.TabExit){$c=Oc.an(Sc);var Zc=$c.Ega;if(Zc)if(Zc.VXa===OSF.OsfControlTarget.InContent)Zc.Mff();else{if(Zc.VXa===OSF.OsfControlTarget.TaskPane)if(Ic.a.Gd(Oc.$))Gb.a.zf&&document.activeElement.blur(),xb.UISurfaces.Hk().then(function(me){var $e=Object(fb.a)(287,Zc)?Zc:null;$e?$e.isResizable?me.focusResizeHandle():me.focusTabbedTaskPaneArea():
me.focusTabbedTaskPaneArea();return null});else if(Sc=Oc.$.da.Aa(183))Gb.a.zf&&document.activeElement.blur(),($c=document.getElementById(Oc.$.Ib+rc.a.skc))&&ad.DOMElementExtensions.isVisible($c)?ad.DOMElementExtensions.setFocus($c):Sc.setFocusOnToolbarFirstElement()}else $c&&4===$c.osfControlType&&Oc.Ml.notifyAgave(Sc,OSF.AgaveHostAction.TabIn)}else if($c===OSF.AgaveHostAction.TabExitShift)($c=Oc.an(Sc),we=$c.Ega)?we.VXa===OSF.OsfControlTarget.InContent?we.Nff():we.VXa===OSF.OsfControlTarget.TaskPane&&
(Sc=Object(fb.a)(287,we)?we:null)&&(Gb.a.zf&&document.activeElement.blur(),Sc.tVf()):$c&&4===$c.osfControlType&&Oc.Ml.notifyAgave(Sc,OSF.AgaveHostAction.TabIn);else if($c===OSF.AgaveHostAction.EscExit||$c===OSF.AgaveHostAction.ExitNoFocusable||$c===OSF.AgaveHostAction.ExitNoFocusableShift)if(we=Oc.an(Sc).Ega)we.Rwc();else{if($c===OSF.AgaveHostAction.EscExit){$c=null;we=yl(ba.TUh());for(jc=we.next();!jc.done;jc=we.next())if(jc=jc.value,jc.value.Me===Sc){jc.value.dialog.hide();$c=jc.key;break}$c&&(Sc=
Oc.an($c))&&4!==Sc.osfControlType&&Oc.Gi.notifyAgave($c,OSF.AgaveHostAction.TabIn)}}else if($c===OSF.AgaveHostAction.InstallCustomFunctions)if($a.EwaSettings.la(121)){sc.a(Oc.$).SRe(function(){return!1});var ud=Oc.$.da;uc.TaskExtensions.Ba(Zb.GetServiceTaskFactory.Xa(ud,278,279,1),function(me){me=me.result;ud.Aa(278)||ud.Ha(278,me);var $e=le.osfControl.getStoreType();me.D8e(le.osfControl.getSolutionId(),$e,a.GGh(le.osfControl),le).tma()},Oc.ma,3)}else Cb.ULS.sendTraceTag(537170577,0,10,"DdaFacade.OnOsfNotifyHost: Cannot install Custom Functions because this feature is not enabled.");
else if($c===OSF.AgaveHostAction.UninstallCustomFunctions)if($a.EwaSettings.la(121)){sc.a(Oc.$).SRe(function(){return!1});var Fd=Oc.$.da;uc.TaskExtensions.Ba(Zb.GetServiceTaskFactory.Xa(Fd,278,279,1),function(me){me=me.result;Fd.Aa(278)||Fd.Ha(278,me);me.m8f(le.solutionId,le.storeType).tma()},Oc.ma,3)}else Cb.ULS.sendTraceTag(537170574,0,10,"DdaFacade.OnOsfNotifyHost: Cannot uninstall Custom Functions because this feature is not enabled.");else $c===OSF.AgaveHostAction.SendTelemetryEvent?c(le):$c===
OSF.AgaveHostAction.SendCustomerContent?d(le):$c===OSF.AgaveHostAction.LaunchExtensionComponent?Xa.a.instance.zji(le):$c===OSF.AgaveHostAction.RefreshRibbonGallery?(Sc=Oc.$.da.Aa(352))&&Sc.Abc(le):$c===OSF.AgaveHostAction.RemoveAppCommandsAddin?(Oc.h3i(le.assetId),Ic.a.Gd(Oc.$)||(Sc=Oc.$.da.Aa(183))&&Sc.ap()):$c===OSF.AgaveHostAction.GetOriginalControlId&&(Sc=new Sa.a(Oc.$.Ib,le.ownerAssetId,new wb.a,!0),le.originalControlId=Sc?Sc.$Ce(le.controlId):le.controlId)};Oc.GMi=function(){Oc.$.oa&&jd.p(Oc.$.oa)&&
Oc.$.da.Aa(34).Ejd()};Oc.od=function(){Oc.Mhf()};Oc.cR=function(Sc,$c){var le,we;1===$c.Wx&&(Sc=$c.Sg)&&($c=new n(Cg.toTimestamp(Sc.enqueueUtcTime),Cg.toTimestamp(Sc.processUtcTime),Cg.toTimestamp(Sc.dequeueUtcTime),Cg.getElapsedMilliseconds(Sc.enqueueUtcTime,Sc.processUtcTime),Cg.getElapsedMilliseconds(Sc.processUtcTime,Sc.dequeueUtcTime),Sc.operationCount,(null===(we=null===(le=Sc.operation)||void 0===le?void 0:le.yd)||void 0===we?0:we.ServerCorrelationId)?Sc.operation.yd.ServerCorrelationId:null,
Sc.operation?Enum.toString(Uf.a,Sc.operation.operationName):null,ne.a.eH(Cg.getElapsedMilliseconds(Sc.enqueueUtcTime,Rc.a.Ra.Kb))),le=Sys.Serialization.JavaScriptSerializer.serialize($c),Cb.ULS.sendTraceTag(50872916,0,50,le))};Oc.Zc=function(Sc,$c){!Oc.fa.oc&&je.a($c)?(Array.forEach(Oc.Cf,Oc.Hsf),Array.clear(Oc.Cf),Oc.rNb=!1):($c.aH&&(Cb.ULS.sendTraceTag(537170516,0,50,"Silent Reload require reset osf controls."),Oc.sPf()),Oc.GK(),$a.EwaSettings.isChangeGateEnabled("OfficeVSO:4058224_ResetWorkbookContextLoadedAfterSilentReload")&&
(Oc.rNb=!1))};Oc.vq=function(){$a.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(Cb.ULS.sendTraceTag(537170515,0,50,"Load on demand occurred require reset osf controls."),Oc.sPf());Oc.GK();$a.EwaSettings.isChangeGateEnabled("OfficeVSO:4441876_ResetOsfControlsAfterServerReload")&&(Oc.rNb=!1)};Oc.Hsf=function(Sc){Sc.flc();Oc.raiseEvent("cd",Sc.controlId)};Oc.vb=cb;Oc.kUc=mc;Oc.initialize();W.ja(Oc);Oc.pQf=0;(cb=(cb=!(Gb.a.Pr||Gb.a.fwa))&&(!$a.EwaSettings.isChangeGateEnabled("OfficeVSO:5763473_DisableAddinKeyboardShortcutsInFirefox")||
!Gb.a.zf))&&OfficeExt.ShortcutKeyDispatchManager.init();Oc.amg={};return Oc}function d(cb){fd.a.sendOtelCustomerContent(Object.assign(new vd.a,{otelEvent:cb}))}function c(cb){fd.a.sendOtelEvent(Object.assign(new vd.a,{otelEvent:cb}))}function k(cb,mc,Oc){var Sc=rd.call(this,Oc,cb)||this;Sc.hashCode=null;Sc.Xua=null;Sc.X1b=!1;Sc.Hm=function($c,le){le.$c.hash===Sc.hashCode&&Sc.Xua&&Object(ub.a)(b(861).DdaFacade,Sc.$.da.Aa(35)).usj(Sc.Xua.InstanceId)};Sc.Pe=function($c,le){switch(le.$c.block.state){case 1:case 3:case 5:Sc.Qma(le)}};
Sc.Hg=function(){Sc.YEb(!0)};Sc.ko=function($c,le){Sc.isVisible&&Sc.CSa(le.xK);Sc.clearCache()};Sc.Oe=function($c,le){Sc.KRa(le.oa,!!le.xK)};Sc.iN=function(){Sc.$.fa.Ala()};Sc.kTa=mc;Sc.domElement.classList.add(nc.a.U6b);Sc.domElement.classList.add(Nb.a.Ir);Oc.tabIndex=0;Sc.KRa(Sc.$.oa,!1);Sc.wc.ja("mousedown",Sc.iN);Sc.wc.ja("contextmenu",function($c){Yd.g($c)});Sc.$.xa.aJ(Sc.ko);Sc.$.xb.aJ(Sc.ko);Sc.$.xb.Pf(Sc.Oe);Sc.$.xa.Pf(Sc.Oe);Sc.Ca.gq(Sc.Pe);Sc.Ca.gG(Sc.Hm);Sc.Ca.np(Sc.Hg);$a.EwaSettings.tc()&&
Sc.Nq(Sc.Kxa);return Sc}function n(cb,mc,Oc,Sc,$c,le,we,jc,Zc){this.dequeueUtcTime=this.processUtcTime=this.enqueueUtcTime=null;this.operationCount=this.executionDurationInMS=this.inQueueDurationInMS=0;this.UserOperationName=this.ServerCorrelationId=null;this.IsDocumentHidden=!1;this.enqueueUtcTime=cb;this.processUtcTime=mc;this.dequeueUtcTime=Oc;this.inQueueDurationInMS=Sc;this.executionDurationInMS=$c;this.operationCount=le;this.ServerCorrelationId=we;this.UserOperationName=jc;this.IsDocumentHidden=
Zc}function l(cb,mc,Oc){this.$=cb;this.dj=mc;this.runtimeCalculationMode=Oc}function f(){}function u(cb,mc,Oc){var Sc=this;this.UBf=null;this.$9c=function($c,le){var we=bc.a.vW,jc={};jc.eventId=$c;jc.payload=le;Sc.dj.CZ(2201,we)&&Sc.Uh.jM(2201,we,Je.a.Hc(jc))};this.$=cb;this.dj=mc;this.Uh=Oc;this.T4h()}function v(cb,mc,Oc){var Sc=this;this.HFb=0;this.Icg=!0;this.w8b=0;this.Vnd=!0;this.uve=function(){var $c=document.hasFocus();if(Sc.Icg!==$c){if($c){var le=Je.a.Hc({});Sc.Uh.jM(2203,bc.a.vW,le)}Sc.Icg=
$c}};this.vve=function($c){(0<$c.timeRemaining()||$c.didTimeout)&&Sc.uve();window.requestIdleCallback(Sc.vve)};this.$=cb;this.dj=mc;this.Uh=Oc;window.requestIdleCallback||(this.Vnd=!1)}function m(cb,mc,Oc){var Sc=this;this.GFb=0;this.J9a=this.Q9a=null;this.dBf=function(){var $c=Xb.g(Sc.$).ha.Qa.ZB;if($c)if(Sc.Wef($c)){var le=Sc.Ria();Sc.b$c(le);Sc.Q9a=$c.floatingObject.id;Sc.J9a=le}else Sc.Q9a&&(Sc.b$c(Sc.J9a),Sc.Q9a=null,Sc.J9a=null);else Sc.Q9a&&(Sc.b$c(Sc.J9a),Sc.Q9a=null,Sc.J9a=null)};this.$=
cb;this.dj=mc;this.Uh=Oc}function A(cb,mc,Oc){var Sc=this;this.Y0b=null;this.Hgc=!1;this.onPointerDown=function($c){var le;Sc.fbi?3===$c.zb?(function(){var we=Sc.gridView.E9b($c.clientPoint);le=we.oGa;return we}(),Sc.Hgc=!!le&&Sc.gridView.ha.va.t5c(le)):Sc.Hgc=!1:(function(){var we=Sc.gridView.E9b($c.clientPoint);le=we.oGa;return we}(),Sc.Hgc=3===$c.zb&&!!le&&Sc.gridView.ha.va.t5c(le));Sc.Y0b=$c.clientPoint;return!1};this.Vc=function($c){if(Sc.gridView.inRangePicker||Sc.gridView.zi||Sc.Hgc||$c.shiftKey||
$c.ctrlKey||$c.Ea.button||!Sc.Y0b||!$c.clientPoint||$c.clientPoint.x!==Sc.Y0b.x||$c.clientPoint.y!==Sc.Y0b.y)return!1;var le=Sc.gridView.E9b($c.clientPoint);$c=le.oGa;le=le.returnValue;var we=Object(ub.a)(de.a,Sc.$.xa.oa);if(le&&we&&!we.$H){if(!Sc.gridView.ha.va.U3.contains($c))return!1;$c=new x(we,$c,Jd.HelperMethods.hBd(le.x),Jd.HelperMethods.hBd(le.y));Sc.bNi($c)}return!1};this.$=cb;this.gridView=Xb.g(cb);this.dj=mc;this.Uh=Oc;this.fbi=$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GetCellOffSetPointFromEventPointOptimization",
!1);this.G1i()}function x(cb,mc,Oc,Sc){var $c=wc.call(this)||this;$c.sheet=cb;$c.gRg=mc;$c.offsetX=Oc;$c.offsetY=Sc;return $c}function t(cb,mc,Oc){var Sc=this;this.GKf=this.FKf=this.HKf=this.EKf=0;this.YMi=function($c,le){$c=Object(ub.a)(de.a,le.oa);Sc.l6a($c)&&(le={},le.worksheetId=$c.sheetId,le=Je.a.Hc(le),Sc.wia(11,$c.sheetId,le))};this.aNi=function($c,le){$c=Object(ub.a)(de.a,le.xK);Sc.l6a($c)&&(le={},le.worksheetId=$c.sheetId,le=Je.a.Hc(le),Sc.wia(12,$c.sheetId,le))};this.ZMi=function($c,le){$c=
Object(ub.a)(de.a,le.oa);Sc.l6a($c)&&(le={},le.worksheetId=$c.sheetId,$c=Je.a.Hc(le),Sc.wia(11,null,$c,!0))};this.$Mi=function($c,le){$c=Object(ub.a)(de.a,le.xK);Sc.l6a($c)&&(le={},le.worksheetId=$c.sheetId,$c=Je.a.Hc(le),Sc.wia(12,null,$c,!0))};this.$=cb;this.dj=mc;this.Uh=Oc}function z(cb,mc,Oc){var Sc=this;this.sPa=this.rPa=0;this.ZFa=this.Zga=null;this.Ttf=function(){var $c=Xb.g(Sc.$).ha.Qa.ZB;if(0<Sc.sPa&&Sc.Zga&&Sc.ZFa){var le={};le.shapeId=Sc.Zga;le.worksheetId=Sc.ZFa;le=Je.a.Hc(le);Sc.fireEvent(2102,
Sc.Zga,le)}Sc.nfi($c)?(Sc.Zga=Sc.uFj($c),Sc.ZFa=Sc.Ria(),Sc.Zga&&Sc.ZFa)?0<Sc.rPa&&($c={},$c.shapeId=Sc.Zga,$c.worksheetId=Sc.ZFa,$c=Je.a.Hc($c),Sc.fireEvent(2101,Sc.Zga,$c)):Cb.ULS.sendTraceTag(537170458,344,10,"Something goes wrong, we got invalid shape id: '{0}', or worksheet id: '{1}' from a Floating object or gridview.",Sc.Zga,Sc.ZFa):(Sc.Zga=null,Sc.ZFa=null)};this.$=cb;this.dj=mc;this.Uh=Oc}function r(cb,mc,Oc){cb=G.call(this,cb,mc,Oc)||this;cb.jgf=null;cb.igf=null;return cb}function G(cb,
mc,Oc){var Sc=Pd.call(this)||this;Sc.Yya=0;Sc.jU=0;Sc.kd=function($c,le){if(Sc.enabled&&!(Sc.jbf()||null!==le&&void 0!==le&&le.wef)&&($c=Object(ub.a)(de.a,Sc.$.xa.oa))&&!$c.$H){var we=$c.sheetId,jc=Sc.AVe(),Zc=null,ud=null;Sc.dj.kef()&&(Zc=Sc.grid.Vb.vk(Sc.grid.ha.va.activeCell),ud=we in Sc.uhc?Sc.uhc[we]:null);Sc.cpe(we,jc)&&uc.TaskExtensions.Ba(Ad.Task.Ta(!0),function(){Sc.hZh(we,jc);Sc.SYh(we,jc,Zc,ud)},Sc.ma);Sc.iGe(we,jc,Zc)}};Sc.$=cb;Sc.dj=mc;Sc.Uh=Oc;Sc.grid=Xb.g(cb);Sc.sMa={};Sc.uhc={};return Sc}
function w(cb,mc,Oc){var Sc=this;this.DKf=this.CKf=0;this.$Ib=this.T9a=null;this.Qzi=function(){var $c=Xb.g(Sc.$).ha.Qa.ZB;if(Sc.Xkd($c)&&($c=Sc.H9b($c))){var le={chartId:$c};le.worksheetId=Sc.Ria();le=Je.a.Hc(le);Sc.wia(51,$c,le);Sc.wia(51,Sc.Ria(),le)}};this.Rzi=function(){if(Sc.T9a){var $c={};$c.chartId=Sc.T9a;$c.worksheetId=Sc.$Ib;$c=Je.a.Hc($c);Sc.wia(52,Sc.T9a,$c);Sc.wia(52,Sc.$Ib,$c)}$c=Xb.g(Sc.$).ha.Qa.ZB;Sc.Xkd($c)?(Sc.T9a=Sc.H9b($c),Sc.$Ib=Sc.Ria()):(Sc.T9a=null,Sc.$Ib=null)};this.$=cb;
this.dj=mc;this.Uh=Oc}function B(){this.RXa={}}function U(cb,mc,Oc,Sc){Sc=void 0===Sc?!1:Sc;var $c=od.call(this)||this;$c.gbb=0;$c.aE=null;$c.uva=!1;$c.Hoc=null;$c.jU=0;$c.e_d=null;$c.eFc=null;$c.qUa=null;$c.P3b=null;$c.U6d=!1;$c.vXd=null;$c.Wca=null;$c.lMc=null;$c.kd=function(){$c.enabled&&($c.Kfj(),$c.Hoc=db.d(Xb.g($c.$).ha.va.selectedRanges))};$c.z2e=function(le){le.controlId===$c.Kd.InstanceId&&Array.forEach($c.aE,function(we){we.Xqi(le)&&we.K_b(le)})};$c.wqf=function(le){if((le=Object(ub.a)(287,
le))&&!le.Jp())if(!$c.Kd||OSF.OsfControl.isFirstPartyStoreString($c.Kd.PrimaryMarketplace.MarketplaceType)||$c.$.Aga){le.qf=$c.Kd;le.rh=$c.Wg;$c.vXd=le;$c.suc(le.qFa);var we=$a.EwaSettings.isChangeGateEnabled("OfficeVSO:5947100_createHiddenTaskpanePreload")&&Ic.a.Gd($c.$)&&Jd.HelperMethods.Vv($c.Kd)&&$c.Kd.Preload&&!$c.Kd.TaskpaneVisible;we?le.lyd():$a.EwaSettings.isChangeGateEnabled("OfficeVSO:5550690_FixHiddenStartupStateUnderReactPaneInfra")?(le.lyd(),($c.Kd.SharedRuntime&&1===$c.Kd.SharedRuntime.LifeTime||
$c.Kd.SharedRuntimeId)&&!$c.Kd.TaskpaneVisible&&le.Lf(!1)):(($c.Kd.SharedRuntime&&1===$c.Kd.SharedRuntime.LifeTime||$c.Kd.SharedRuntimeId)&&!$c.Kd.TaskpaneVisible&&le.Lf(!1),le.lyd());$c.F4a||(Ic.a.Gd($c.$)?we||le.fR():Jb.a($c.$).result.WC(le,!0));$c.$.da.Aa(77).VLf($c.wqf);$c.Ega=Object(ub.a)(297,le)}else Cb.ULS.sendTraceTag(537170464,0,50,"Taskpane web add-in disabled by doc IRM")};$c.onFloatingObjectControlAdded=function(le,we){3===we.control.floatingObject.type&&we.control.floatingObject.cl.InstanceId===
$c.P0.WebExtensionId&&($c.Ega=Object(ub.a)(297,we.control),$c.suc(we.control.Pd.firstChild),Xd.a($c.$).IGd($c.onFloatingObjectControlAdded))};$c.vb=cb.$;$c.Wg=cb;$c.Kd=Oc;$c.Kd.InstanceId=Oc.SrcLocationOverrideResourceId?cb.kJa(Oc.InstanceId,Oc.SrcLocationOverrideResourceId):Oc.InstanceId;$c.Uh=mc;$c.P0={};$c.P0.WebExtensionId=Oc.InstanceId;$c.TBf="osfControl_"+Oc.InstanceId;$c.X4c="disabled_"+Oc.InstanceId;$c.P0.BindingData=Oc.BindingData;$c.F4a=$c.Wg.F4a(Oc.InstanceId);$c.Odc=$c.Wg.Odc(Oc.InstanceId);
$c.pae=Oc.WebExtensionOsfControlType;$c.ZEf=Sc;return $c}function N(cb,mc,Oc,Sc,$c,le,we,jc){cb=Za.call(this,cb,mc,Oc)||this;cb.startRow=0;cb.startColumn=0;cb.rowCount=0;cb.columnCount=0;cb.startColumn=le-Sc.Reference.FirstColumn;cb.columnCount=jc;le=Math.max($c,Sc.Reference.FirstRow);$c=Math.min($c+we-1,Sc.Reference.LastRow);le>$c?cb.startRow=cb.rowCount=void 0:(cb.startRow=le-Sc.Reference.FirstRow,cb.rowCount=$c-le+1);return cb}function P(cb){var mc=this;this.aE=null;this.uva=!1;this.kd=function(){mc.aE.forEach(function(Oc){Oc.eventId===
OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&Oc.K_b(new Ha.a(Oc.eventId,"",null))})};this.Wg=cb}function ia(cb,mc){this.jA=null;this.Pea=cb;this.Dsg=mc}function W(cb){var mc=this;this.Gi=this.RUc=null;this.$Gi=function(Oc,Sc){mc.handlers.wb(Sc.controlId)&&(Oc=new I(OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent,Sc.controlId,null,Sc.messageType,Sc.messageContent,Sc.messageOrigin,Sc.targetOrigin),mc.handlers.na(Sc.controlId)(Oc),Sc.messageType===OSF.DialogMessageType.DialogClosed&&
mc.handlers.remove(Sc.controlId))};this.ZGi=function(Oc,Sc){mc.xjc.wb(Sc.controlId)&&(Oc=new R(OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent,Sc.controlId,null,Sc.messageType,Sc.messageContent,Sc.messageOrigin,Sc.targetOrigin),mc.xjc.na(Sc.controlId)(Oc))};this.handlers=new Yb.a;this.xjc=new Yb.a;this.Wg=cb;this.l0a.CBg(this.$Gi);this.l0a.BBg(this.ZGi)}function R(cb,mc,Oc,Sc,$c,le,we){cb=kb.call(this,cb,mc,Oc)||this;cb.messageType=0;cb.messageContent=null;cb.messageOrigin=null;cb.targetOrigin=
null;cb.messageType=Sc;cb.messageContent=$c;cb.messageOrigin=le;cb.targetOrigin=we;return cb}function I(cb,mc,Oc,Sc,$c,le,we){cb=Ua.call(this,cb,mc,Oc)||this;cb.messageType=0;cb.messageContent=null;cb.messageOrigin=null;cb.targetOrigin=null;cb.messageType=Sc;cb.messageContent=$c;cb.messageOrigin=le;cb.targetOrigin=we;return cb}function Q(cb,mc){var Oc=Ga.call(this)||this;Oc.requests=[];Oc.d0b=!1;Oc.disposed=!1;Oc.Rh=function(){if(!Oc.disposed){Oc.grid.Kc.Rp(Oc.Rh);Oc.d0b=!1;var Sc=Oc.requests;Oc.requests=
[];Sc=yl(Sc);for(var $c=Sc.next();!$c.done;$c=Sc.next())$c=$c.value,Oc.ddaFacade.LJ($c.command,$c.properties)}};Oc.ddaFacade=cb;Oc.grid=mc;return Oc}function O(){this.command=0;this.properties=null}function ba(cb){this.Ya=new Tb.a;this.Ml=cb}function ca(cb,mc,Oc,Sc,$c){Oc=void 0===Oc?null:Oc;Sc=void 0===Sc?"":Sc;$c=void 0===$c?"":$c;var le=ta.call(this)||this;le.controlId=cb;le.messageType=mc;le.messageContent=Oc;le.messageOrigin=Sc;le.targetOrigin=$c;return le}function S(cb,mc,Oc,Sc,$c){Oc=void 0===
Oc?null:Oc;Sc=void 0===Sc?"":Sc;$c=void 0===$c?"":$c;var le=Fb.call(this)||this;le.controlId=cb;le.messageType=mc;le.messageContent=Oc;le.messageOrigin=Sc;le.targetOrigin=$c;return le}function Y(){this.height=this.width=0;this.Me=this.controlId=this.pageUrl=null;this.pcc=this.c5c=!1}function na(){}function Z(){this.dialog=this.Me=null}function wa(cb,mc,Oc){var Sc=Qb.call(this)||this;Sc.X8=null;Sc.qQc="WACDialogTitleText";Sc.gUa="0";Sc.APb="15px";Sc.vig="0px";Sc.fUa="calc(100% - 30px)";Sc.uig="100%";
Sc.fce=0;Sc.Ya=new Tb.a;Sc.cgg=new pa;Sc.kc=5;Sc.uCa=Oc;Sc.Me=Oc;Sc.AFc=cb;Sc.j2d=mc;Sc.OFc=!!ya.AFrameworkApplication.ga&&ya.AFrameworkApplication.ga.ra("OfficeAddinEnableInsertDialogAccessibilityFix");return Sc}function ma(){}function pa(){}function Ia(cb,mc){cb=Ma.call(this,1,cb,mc)||this;cb.j9e=OfficeExt.CommandInvokeMode.ExclusiveForNew;return cb}function Ma(cb,mc,Oc){this._id=cb;this.agg=mc;this.gig=Oc;this.j9e=OfficeExt.CommandInvokeMode.Default}b.r(D);var ob=b(0),Cb=b(13),Xa=b(1288),Sb=b(80),
Tb=b(94);Ma.prototype.execute=function(cb,mc,Oc){var Sc=this;Oc=Oc||{};Oc.commandMode=this.j9e;mc.invokeAppCommand(this.iDg,this.NVg,Oc,function(){cb.kHi(Sc.id)})};tl.Object.defineProperties(Ma.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this._id}},iDg:{configurable:!0,enumerable:!0,get:function(){return this.agg}},NVg:{configurable:!0,enumerable:!0,get:function(){return this.gig}}});Object(ob.a)(Ma,"AddinNativeActionBase",null,[143]);vm(Ia,Ma);Object(ob.a)(Ia,"AddinTakeSnapshotAction",
Ma,[]);pa.prototype.r_g=function(cb){return new Ma(3,cb,this.qCh().getNativeActionName(3))};pa.prototype.qCh=function(){return OfficeExt.AddinNativeActionRuntimeManager.getInstance()};Object(ob.a)(pa,"AddinNativeActionManager",null,[124]);var da=b(140);ma.prototype.invokeAppCommand=function(cb,mc,Oc,Sc){OfficeExt.AddinCommandsRuntimeManager.invokeAppCommand(cb,mc,Oc,Sc)};ma.getInstance=function(){ma.Na||(ma.Na=new ma);return ma.Na};ma.Na=null;Object(ob.a)(ma,"OSFAddinCommandsRuntimeManager",null,
[125]);var ya=b(5),hb=b(172),Gb=b(23),Qb=da.a;vm(wa,Qb);wa.prototype.vBg=function(cb){this.Ya.addHandler("OnDialogClosedEventKey",cb)};wa.prototype.Ijj=function(){this.EDa=null};wa.prototype.KC=function(){Qb.prototype.KC.call(this);this.fp.style.width="100%";this.fp.style.height=this.Qbc?this.fUa:this.uig;this.fp.style.marginTop=this.Qbc?this.APb:this.vig;this.fp.style.padding=this.gUa};wa.prototype.WN=function(){Qb.prototype.WN.call(this);this.Lb.style.width=String.format("{0}px",this.AFc*window.innerWidth/
100);this.Lb.style.height=String.format("{0}px",this.j2d*window.innerHeight/100);this.Lb.style.minWidth="0px";this.OFc&&ya.AFrameworkApplication.isRtl&&100===this.AFc&&(this.Lb.style.right="0px",this.Lb.style.marginRight="0px");this.X8=document.getElementById(this.mi(this.qQc));this.X8.style.position="absolute";this.X8.style.whiteSpace="nowrap";this.X8.style.textOverflow="ellipsis";ya.AFrameworkApplication.isRtl?(this.X8.style.right="14px",this.X8.style.left="44px"):(this.X8.style.right="44px",this.X8.style.left=
"14px")};wa.prototype.$u=function(cb){Qb.prototype.$u.call(this,cb);this.X8&&this.X8.setAttribute("title",cb)};wa.prototype.pId=function(){this.Lb.style.width=String.format("{0}px",this.AFc*window.innerWidth/100);this.Lb.style.height=String.format("{0}px",this.j2d*window.innerHeight/100);this.Lb.style.overflowY="hidden";this.Lb.style.overflowX="hidden";this.Lb.style.marginTop="";this.Lb.style.top="";Gb.a.AQ&&ya.AFrameworkApplication.isRtl?(this.Lb.style.right="",this.Lb.style.marginRight=""):(this.Lb.style.left=
"",this.Lb.style.marginLeft="")};wa.prototype.hide=function(){var cb=this;this.cgg.r_g(this.uCa).execute(this,ma.getInstance(),{});this.fce=window.setTimeout(function(){cb.Ya.raiseEvent("OnDialogClosedEventKey",cb.uCa);hb.a.prototype.hide.call(cb)},500)};wa.prototype.kHi=function(cb){3===cb&&(window.clearTimeout(this.fce),this.Ya.raiseEvent("OnDialogClosedEventKey",this.uCa),Qb.prototype.hide.call(this))};tl.Object.defineProperties(wa.prototype,{k0a:{configurable:!0,enumerable:!0,get:function(){return this.fp}}});
Object(ob.a)(wa,"AppsForOfficeDialog",da.a,[105,106]);Object(ob.a)(Z,"DialogInfo",null,[]);na.url="url";na.height="height";na.width="width";na.c5c="displayInIframe";na.pcc="hideTitle";Object(ob.a)(na,"DialogSettings",null,[]);Object(ob.a)(Y,"DisplayDialogParams",null,[]);var Fb=Sys.EventArgs;vm(S,Fb);Object(ob.a)(S,"OnMessageDialogEventArgs",Sys.EventArgs,[]);var ta=Sys.EventArgs;vm(ca,ta);Object(ob.a)(ca,"OnMessageParentEventArgs",Sys.EventArgs,[]);var xa=b(38),sa=b(28),lb=b(179),Yb=b(101);ba.prototype.CBg=
function(cb){this.Ya.addHandler("OnMessageParentEventKey",cb)};ba.prototype.BBg=function(cb){this.Ya.addHandler("OnMessageDialogEventKey",cb)};ba.prototype.showDialog=function(cb,mc,Oc,Sc){if(ba.J7.wb(mc))Cb.ULS.sendTraceTag(18896285,344,100,"ShowDialog: agave dialog map already has dialog info for this control."),Oc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError);else try{var $c=xa.b(cb),le=$c[na.url];if(this.Ml.getOsfControl(mc).checkAppDomains(le)){var we=new Y;we.width=$c[na.width];we.height=
$c[na.height];we.pageUrl=le;we.c5c=$c[na.c5c];we.pcc=$c[na.pcc];we.controlId=mc;we.Me=lb.a.create().toString();var jc=new Z;jc.Me=we.Me;var Zc=this.Ml.getOsfControl(we.controlId).getManifest().getDefaultDisplayName(),ud=this.Ml.getOsfControl(we.controlId).getStoreType().toLowerCase();cb=null;cb=4===ya.AFrameworkApplication.sa.Pa.Lj&&"hardcodedpreinstall"===ud&&we.pcc?this.createAndShowAppsForOfficeDialog(we.width,we.height,we.Me,!0,Zc):this.createAndShowAppsForOfficeDialog(we.width,we.height,we.Me,
!1,Zc);var Fd=this.Ml.getOsfControl(we.controlId),me=Fd.getManifest();mc={};ya.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?(mc.id=we.Me,mc.solutionId=Fd.getSolutionId(),mc.version=Fd.getVersion(),mc.storeType=ud,mc.storeId=Fd.getStoreId()):(mc.id=we.Me,mc.solutionId=me.getMarketplaceID(),mc.version=me.getMarketplaceVersion(),mc.storeType=ud,mc.storeId=Fd.getStoreLocator());mc.assetId=Fd.getAssetId();mc.assetStoreId=Fd.getAssetStoreId();
mc.ownerAddinSolutionId=Fd.getOwnerAddinSolutionId();mc.ownerAddinStoreType=Fd.getOwnerAddinStoreType();mc.appDomains=me.getAppDomains();mc.dialogUrl=le;mc.osfControlType=1;mc.marketplaceID=me.getMarketplaceID();mc.marketplaceVersion=me.getMarketplaceVersion();mc.store=Fd.getStoreLocator();mc.ownerAddinAssetId=Fd.getOwnerAddinAssetId();mc.agaveName=Zc;mc.div=cb.k0a;ya.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?Cb.ULS.sendTraceTag(542978531,
344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetAssetId(null!==mc.ownerAddinStoreType?mc.ownerAddinStoreType:mc.storeType,mc.storeId,mc.solutionId),sa.a.lu(we.pageUrl)):Cb.ULS.sendTraceTag(527279822,344,50,"ShowDialog: asset id {0}, url hash code {1}",Telemetry.PrivacyRules.GetAssetId(null!==mc.ownerAddinStoreType?mc.ownerAddinStoreType:mc.storeType,mc.store,mc.solutionId),sa.a.lu(we.pageUrl));this.Ml.insertDialogControl(mc);cb.vBg(Object(Sb.a)(this,this.HBi,"onDialogClosed"));
jc.dialog=cb;ba.J7.ia(we.controlId,jc);Sc&&Sc(mc);Oc(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}else Cb.ULS.sendTraceTag(19940611,344,10,"ShowDialog: dialog url not in app domains list."),Oc(OSF.DDA.ErrorCodeManager.errorCodes.ooeAppDomains)}catch($e){Cb.ULS.sendTraceTag(18371104,344,10,"ShowDialog: action failed. Exception message: {0}",$e.message),Oc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}};ba.prototype.Hsi=function(cb,mc,Oc,Sc){ya.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.MessageParentOriginLeaveTargetOrigin",
!1)||""===Sc&&(Sc=Oc);try{var $c=this.wua(cb);$c&&this.Ya.raiseEvent("OnMessageParentEventKey",new ca($c,OSF.DialogMessageType.DialogMessageReceived,mc,Oc,Sc))}catch(le){return Cb.ULS.sendTraceTag(555238219,344,10,"MessageParentOrigin: action failed. Exception message: {0}",le.message),OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError}return OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess};ba.prototype.i_c=function(cb,mc){if(ba.J7.wb(cb))try{var Oc=ba.J7.na(cb);Oc.dialog&&Oc.dialog.hide();this.Ml.purgeDialogControl(Oc.Me);
ba.J7.remove(cb);mc(OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess)}catch(Sc){Cb.ULS.sendTraceTag(18371106,344,10,"CloseDialog: action failed. Exception message: {0}",Sc.message),mc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}else Cb.ULS.sendTraceTag(18896286,344,10,"CloseDialog: agave dialog map does not has dialog info for this control."),mc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)};ba.prototype.Afj=function(cb,mc,Oc,Sc){ya.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.SendMessageOriginLeaveTargetOrigin",
!1)||""===Sc&&(Sc=Oc);if(ba.J7.wb(cb)&&(cb=ba.J7.na(cb),cb.dialog))try{this.Ya.raiseEvent("OnMessageDialogEventKey",new S(cb.Me,OSF.DialogMessageType.DialogParentMessageReceived,mc,Oc,Sc))}catch($c){Cb.ULS.sendTraceTag(555045763,344,10,"SendMessageOrigin: action failed. Exception message: {0}",$c.message)}};ba.prototype.wua=function(cb){for(var mc=null,Oc=yl(ba.J7),Sc=Oc.next();!Sc.done;Sc=Oc.next())if(Sc=Sc.value,Sc.value.Me===cb){mc=Sc.key;break}return mc};ba.prototype.HBi=function(cb,mc){if(cb=
this.wua(mc))this.Ml.purgeDialogControl(mc),ba.J7.remove(cb),this.Ya.raiseEvent("OnMessageParentEventKey",new ca(cb,OSF.DialogMessageType.DialogClosed,null,null,"*"))};ba.prototype.createAndShowAppsForOfficeDialog=function(cb,mc,Oc,Sc,$c){cb=new wa(cb,mc,Oc);$c=Sc?"":String.format(CommonUIStrings.l_ShowDialogApiInlineDialogTitle,$c);Sc&&(cb.Qbc=!1,cb.Gu=!1);cb.initializeAndShow($c,null,null);cb.Ijj();return cb};ba.TUh=function(){return ba.J7};ba.getInstance=function(cb){ba.Na||(ba.Na=new ba(cb));
return ba.Na};ba.Na=null;ba.J7=new Yb.a;Object(ob.a)(ba,"AppsForOfficeDialogManager",null,[36]);var Fa=b(989),Sa=b(1292),Ra=b(1369),Lb=b(1070),Ja=b(846),xb=b(187),Kb=b(1294),Eb=b(157),Hc=b(86),Xc=b(88),Pc=b(686),wd=b(574),Tc=b(805),ub=b(84),fb=b(408),Ta=b(139),eb=b(185),tb=b(36),rc=b(4),wb=b(950),E=b(1250),Mb=b(74);Object(ob.a)(O,"DdaRequestInfo",null,[]);var ka=b(858),bb=b(78),Ga=Mb.a;vm(Q,Ga);Q.prototype.g9g=function(cb,mc){this.disposed||(this.d0b||(this.grid.Kc.hq(this.Rh),this.d0b=!0),this.requests.push(Object.assign(new O,
{command:cb,properties:mc})))};Q.prototype.dispose=function(){if(!this.disposed){this.disposed=!0;this.d0b&&this.grid.Kc.Rp(this.Rh);var cb=this.requests;this.requests=null;cb=yl(cb);for(var mc=cb.next();!mc.done;mc=cb.next())mc=mc.value,(mc=mc.properties?mc.properties[bb.a.f3]:null)&&this.ddaFacade.vf(ka.a.Swb,mc);this.ddaFacade=this.grid=null;Ga.prototype.dispose.call(this)}};Q.QVg=function(cb,mc){var Oc=!1;974713501===cb&&(mc=(cb=mc?mc[bb.a.Kg]:null)?cb.DdaMethod:null)&&mc.DispatchId===OSF.DDA.MethodDispId.dispidExecuteRichApiRequestMethod&&
(Oc=cb.ArrayData,Oc=!!Oc&&64===(Oc[6]&64));return Oc};Object(ob.a)(Q,"DdaCellEditDelayRequestHandler",Mb.a,[]);var Ha=b(895),Ua=Ha.a;vm(I,Ua);Object(ob.a)(I,"DialogMessageReceivedEventArgs",Ha.a,[]);var kb=Ha.a;vm(R,kb);Object(ob.a)(R,"DialogParentMessageReceivedEventArgs",Ha.a,[]);var $a=b(1);W.prototype.addHandler=function(cb,mc,Oc,Sc){var $c=this;if($a.EwaSettings.la(24))this.Wg.vf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Oc);else{Cb.ULS.sendTraceTag(537170502,0,50,"DialogMessageReceivedEventManager.AddHandler called!");
var le=function(we){we===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?($c.handlers.ia(cb,mc),$c.Wg.Au(Oc)):(Cb.ULS.sendTraceTag(537170501,0,10,"DialogMessageReceivedEventManager.AddHandler failed!"),$c.Wg.vf(we,Oc))};this.handlers.wb(cb)?le(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError):this.showDialog(cb,Sc,le)}};W.prototype.dxg=function(cb,mc,Oc){$a.EwaSettings.la(24)?this.Wg.vf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Oc):(Cb.ULS.sendTraceTag(537170500,0,50,"DialogMessageReceivedEventManager.AddMessageChildHandler called!"),
this.xjc.ia(cb,mc),this.Wg.Au(Oc))};W.prototype.removeHandler=function(cb,mc){var Oc=this;$a.EwaSettings.la(24)?this.Wg.vf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,mc):this.handlers.wb(cb)?(Cb.ULS.sendTraceTag(537170499,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.l0a.i_c(cb,function(Sc){Oc.handlers.remove(cb);Sc===OSF.DDA.ErrorCodeManager.errorCodes.ooeSuccess?Oc.Wg.Au(mc):(Cb.ULS.sendTraceTag(537170498,0,10,"DialogMessageReceivedEventManager.RemoveHandler failed!"),
Oc.Wg.vf(Sc,mc))})):this.Wg.vf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,mc)};W.prototype.a3i=function(cb,mc){$a.EwaSettings.la(24)?this.Wg.vf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,mc):(Cb.ULS.sendTraceTag(537170497,0,50,"DialogMessageReceivedEventManager.RemoveHandler called!"),this.xjc.remove(cb),this.Wg.Au(mc))};W.prototype.showDialog=function(cb,mc,Oc){var Sc=this;try{this.l0a.showDialog(mc,cb,Oc,function($c){Sc.Wg.uxg(Sc.GNg($c))})}catch($c){Cb.ULS.sendTraceTag(537170496,
0,10,"DialogMessageReceivedEventManager: show dialog failed. Exception message: {0}",$c.message),Oc(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError)}};W.prototype.GNg=function(cb){var mc={};mc.InstanceId=cb.id;mc.WebExtensionType=cb.osfControlType===OSF.OsfControlTarget.InContent?0:1;mc.PrimaryMarketplace={};mc.PrimaryMarketplace.SolutionId=cb.solutionId;mc.PrimaryMarketplace.SolutionVersion=cb.version;mc.PrimaryMarketplace.MarketplaceRef=cb.storeId;mc.PrimaryMarketplace.MarketplaceType=cb.storeType;
return mc};W.ja=function(cb){if(!cb.$.da.Aa(232)){var mc=new W(cb);cb.$.da.Ha(232,mc)}};tl.Object.defineProperties(W.prototype,{l0a:{configurable:!0,enumerable:!0,get:function(){this.RUc||(this.RUc=ba.getInstance(this.contextActivationMgr));return this.RUc}},contextActivationMgr:{configurable:!0,enumerable:!0,get:function(){!this.Gi&&this.Wg&&(this.Gi=this.Wg.Gi);return this.Gi}}});Object(ob.a)(W,"DialogMessageReceivedEventManager",null,[842]);ia.prototype.MXb=function(cb){cb&&(this.jA||(this.jA=
[]),Array.add(this.jA,cb))};ia.prototype.Kqc=function(cb){this.jA&&Array.remove(this.jA,cb)};ia.prototype.Xqi=function(cb){return this.eventId!==cb.dispid?!1:this.eventId===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||this.eventId===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent?this.targetId===cb.ddaBinding.Name:!0};ia.prototype.K_b=function(cb){this.jA&&Array.forEach(this.jA,function(mc){mc(cb)})};ia.prototype.ama=function(){this.jA=[]};tl.Object.defineProperties(ia.prototype,{eventId:{configurable:!0,
enumerable:!0,get:function(){return this.Pea}},targetId:{configurable:!0,enumerable:!0,get:function(){return this.Dsg}},LZh:{configurable:!0,enumerable:!0,get:function(){return 0<this.jA.length}}});Object(ob.a)(ia,"DdaEventRegistration",null,[]);var Xb=b(20);P.prototype.invokeDdaMethod=function(cb,mc){var Oc={};Oc[bb.a.Kg]=cb;Oc[bb.a.f3]=mc;this.Wg.LJ(974713501,Oc)};P.prototype.registerDdaEventAsync=function(cb,mc,Oc,Sc,$c){P.xxb(cb)?(P.nld(cb)&&this.Phd(),this.aE||(this.aE=[]),mc=this.usb(cb,Oc),
mc||(mc=new ia(cb,Oc),Array.add(this.aE,mc)),mc.MXb(Sc),this.Wg.Au($c)):this.Wg.vf(-1,$c)};P.prototype.unregisterDdaEventAsync=function(cb,mc,Oc,Sc,$c){P.xxb(cb)?((cb=this.usb(cb,Oc))&&cb.Kqc(Sc),this.Wg.Au($c)):this.Wg.vf(-1,$c)};P.prototype.Phd=function(){this.uva||(Xb.g(this.Wg.$).ha.iG(this.kd),this.uva=!0)};P.prototype.usb=function(cb,mc){if(!this.aE)return null;for(var Oc=0;Oc<this.aE.length;Oc++){var Sc=this.aE[Oc];if(Sc.eventId===cb&&Sc.targetId===mc)return Sc}return null};P.xxb=function(cb){return cb===
OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};P.nld=function(cb){return cb===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};Object(ob.a)(P,"EmbeddingPage",null,[818]);var dc=b(195),Za=Ha.a;vm(N,Za);N.prototype.getStartRow=function(){return this.startRow};N.prototype.getStartColumn=function(){return this.startColumn};N.prototype.getRowCount=function(){return this.rowCount};N.prototype.getColumnCount=function(){return this.columnCount};Object(ob.a)(N,"DdaBindingSelectionEventArgs",
Ha.a,[]);var Wa=b(188),Ba=b(24),db=b(43),Zb=b(56),Jb=b(409),Ic=b(41),uc=b(35),za=b(587),pb=b(106),cc=b(51),Ac=b(92),ad=b(11),Jd=b(8),Xd=b(103),od=dc.a;vm(U,od);U.prototype.o5h=function(cb){this.Wca||(this.Wca=cb)};U.prototype.ELf=function(){this.Wca&&(this.Wca.dispose(),this.Wca=null)};U.prototype.pjd=function(){var cb=this;if(!OSF.OsfControl.isFirstPartyStoreString(this.Kd.PrimaryMarketplace.MarketplaceType)&&$a.EwaSettings.la(186)){var mc=Zb.GetServiceTaskFactory.Xa(this.$.da,5,4,0);uc.TaskExtensions.Ba(mc,
function(){mc.result.hg(35,null)},this.ma,3);return this}if(1===this.Kd.WebExtensionType)uc.TaskExtensions.Ba(Jb.a(this.$),function($c){$c.result.Zpb(cb.$.da,77,6,cb.wqf,1)},this.ma,3);else{var Oc=this.mQe(),Sc=Xd.a(this.$);Oc||(Oc={Type:3},Oc.Id=this.P0.WebExtensionId,Oc.WebExtensionData=this.Kd,Oc.ContentHtml="<div/>",Oc.Version=0,Oc.AbsoluteLeft=0,Oc.AbsoluteTop=0,Oc.AbsoluteRight=0,Oc.AbsoluteBottom=0,Oc.Width=0,Oc.Height=0,Oc.ZOrder=0,Oc.OriginDeltaX=0,Oc.OriginDeltaY=0,Oc=new Wa.a(Oc),Sc.x2b(Oc,
null),Oc=Sc.Hp(Oc.Eg()));Oc?(this.suc(Oc.Pd.firstChild),this.Ega=Object(ub.a)(297,Oc)):Sc.cTc(this.onFloatingObjectControlAdded)}return this};U.prototype.D7e=function(cb){this.suc(cb);return this};U.prototype.flc=function(){this.ZEf||this.Wg.Gi.purgeOsfControl(this.controlId,!1);this.j8f(!0);var cb=this.mQe();cb&&Xd.a(this.$).deleteFloatingObject(cb);this.Wg.dj.K2i(this.controlId);this.Wg.dj.kIe(this.controlId,!0);this.lMc=null};U.prototype.Dyd=function(cb){this.P0=cb};U.prototype.invokeDdaMethod=
function(cb,mc){if($a.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled){var Oc={};Oc[bb.a.Kg]=cb;Oc[bb.a.f3]=mc;this.Wg.LJ(974713501,Oc)}else this.Wg.vf(ka.a.Swb,mc)};U.prototype.m0i=function(cb,mc,Oc,Sc){if($a.EwaSettings.isChangeGateEnabled("OfficeVSO:3614837_disableDragCheck")||this.enabled)if(!U.Nch(cb)||void 0!==mc&&null!==mc&&void 0!==this.z1a(mc)&&null!==this.z1a(mc))if(Cb.ULS.sendTraceTag(36444195,0,50,"eventId: {0}, targetId: {1}",cb,mc),U.F$e(cb)&&this.z0h(),
U.nld(cb)&&this.Phd(),U.D$e(cb))$a.EwaSettings.la(24)?this.Wg.vf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Sc):this.Wg.$.da.Aa(232).addHandler(this.controlId,Oc,Sc,mc);else if(U.E$e(cb))$a.EwaSettings.la(24)?this.Wg.vf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Sc):this.Wg.$.da.Aa(232).dxg(this.controlId,Oc,Sc);else{U.C$e(cb)&&this.B2e(-1777565636,Sc);this.aE||(this.aE=[]);var $c=this.usb(cb,mc);$c||($c=new ia(cb,mc),Array.add(this.aE,$c));$c.ama();$c.MXb(Oc);
this.Wg.Au(Sc);cb===OSF.DDA.EventDispId.dispidRichApiMessageEvent&&this.qUa&&(this.P3b=Oc)}else this.Wg.vf(3002,Sc);else this.Wg.vf(-1,Sc)};U.prototype.fHj=function(cb,mc,Oc,Sc){U.D$e(cb)?$a.EwaSettings.la(24)?this.Wg.vf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Sc):this.Wg.$.da.Aa(232).removeHandler(this.controlId,Sc):U.E$e(cb)?$a.EwaSettings.la(24)?this.Wg.vf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,Sc):this.Wg.$.da.Aa(232).a3i(this.controlId,Sc):(U.C$e(cb)&&
this.B2e(1592314317,Sc),mc=this.usb(cb,mc),this.enabled?(mc&&(mc.Kqc(Oc),mc.LZh||Array.remove(this.aE,mc),this.aE.length?U.F$e(cb)&&this.k8f(!1):this.j8f(!1)),this.Wg.Au(Sc)):this.Wg.vf(-1,Sc))};U.prototype.ja=function(cb){ad.DOMElementExtensions.getElementById(cb,this.TBf)||cb.appendChild(ad.DOMElementExtensions.Sf(this.Px))};U.prototype.showHide=function(cb){ad.DOMElementExtensions.setVisible(this.Px,cb)};U.prototype.resize=function(cb,mc){ad.DOMElementExtensions.Gq(this.Px,cb);ad.DOMElementExtensions.HF(this.Px,
mc)};U.prototype.fFe=function(cb){if(!this.jU&&!ad.DOMElementExtensions.getElementById(this.Px,this.X4c)&&this.Px){var mc=document.createElement("div");mc.id=this.X4c;mc.className="ewa-wx-disabled-div";mc.style.backgroundImage="url("+cc.a.current.eo(81)+")";mc.style.opacity=cb?"1":"0";mc.style.backgroundRepeat="no-repeat";mc.style.backgroundPosition="center";this.Px.insertBefore(mc,this.Px.firstChild)}this.jU++};U.prototype.Yfh=function(){0<this.jU&&this.jU--;this.jU||(ad.DOMElementExtensions.Sf(ad.DOMElementExtensions.getElementById(this.Px,
this.X4c)),this.uva&&!db.Q(this.Hoc,Xb.g(this.$).ha.va.selectedRanges)&&this.kd(null,null))};U.prototype.z1a=function(cb){if(!this.P0||!this.P0.BindingData)return null;for(var mc=0;mc<this.P0.BindingData.length;mc++)if(this.P0.BindingData[mc].Name===cb)return this.P0.BindingData[mc];return null};U.prototype.getDefaultIconUrl=function(){var cb=this.aZe();return cb?cb.getDefaultIconUrl():null};U.prototype.getDefaultDisplayName=function(){if(this.Kd.TaskpaneTitle)return this.Kd.TaskpaneTitle;var cb=
this.aZe();return cb?cb.getDefaultDisplayName():null};U.prototype.dGf=function(){if(this.qUa&&this.P3b){var cb=new Ha.a(OSF.DDA.EventDispId.dispidRichApiMessageEvent,this.controlId,null,this.qUa);this.P3b(cb);this.P3b=this.qUa=null}};U.prototype.Lf=function(cb){this.vXd&&this.vXd.Lf(cb)};U.prototype.Dhj=function(){var cb=this;this.$.fa.isNamedObjectViewMode&&this.Gdi()&&(this.$.da.Aa(34).Chj(this.Px),this.showHide(!1));if(this.Wg.YOj){if(!this.ZEf){var mc={};mc.div=this.Px;mc.id=this.Kd.InstanceId;
mc.solutionId=this.Kd.PrimaryMarketplace.SolutionId;mc.version=this.Kd.PrimaryMarketplace.SolutionVersion;mc.storeId=this.Kd.PrimaryMarketplace.MarketplaceRef;mc.storeType=this.Kd.PrimaryMarketplace.MarketplaceType;mc.ownerAddinSolutionId=this.Kd.OwnerAddinSolutionId;mc.ownerAddinStoreType=this.Kd.OwnerAddinStoreType;this.Kd.AssetMarketplace&&(mc.assetId=this.Kd.AssetMarketplace.SolutionId,mc.assetStoreId=this.Kd.AssetMarketplace.MarketplaceRef,mc.alternateReference={},mc.alternateReference.marketplaceID=
this.Kd.AssetMarketplace.SolutionId,mc.alternateReference.marketplaceVersion=this.Kd.AssetMarketplace.SolutionVersion,mc.alternateReference.store=this.Kd.AssetMarketplace.MarketplaceRef,mc.alternateReference.storeType=this.Kd.AssetMarketplace.MarketplaceType);mc.marketplaceID=this.Kd.PrimaryMarketplace.SolutionId;mc.marketplaceVersion=this.Kd.PrimaryMarketplace.SolutionVersion;mc.store=this.Kd.PrimaryMarketplace.MarketplaceRef;mc.ownerAddinAssetId=this.Kd.OwnerAddinAssetId;mc.settings=this.Kd.OsfPropertyBag;
$a.EwaSettings.isChangeGateEnabled("OfficeVSO:5022710_EnableAgaveInitReasonControlActivation")?mc.reason=this.F4a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:this.Odc?Microsoft.Office.WebExtension.InitializationReason.Inserted:Microsoft.Office.WebExtension.InitializationReason.ControlActivation:mc.reason=this.F4a?Microsoft.Office.WebExtension.InitializationReason.DocumentOpened:Microsoft.Office.WebExtension.InitializationReason.Inserted;mc.osfControlType=this.Kd.WebExtensionType?
OSF.OsfControlTarget.TaskPane:OSF.OsfControlTarget.InContent;mc.isForUILessAction=4===this.Kd.WebExtensionOsfControlType;mc.sourceLocationOverrideResourceId=this.Kd.SrcLocationOverrideResourceId;mc.focusOnIframeWhenLoaded=this.Kd.FocusOnIframeWhenLoaded;za.a(this.Kd)&&(mc.featureGates=ya.AFrameworkApplication.ga.aJh(mc.solutionId));mc.hostInfoFlags=0;this.rHa&&(mc.hostInfoFlags|=2);Jd.HelperMethods.Vv(this.Kd)&&(mc.hostInfoFlags|=1);this.$.Aga||(Cb.ULS.sendTraceTag(537170466,0,50,"Content web add-in disabled by doc IRM"),
mc.hostInfoFlags|=4);$a.EwaSettings.la(664)&&(mc.hostInfoFlags|=8);$a.EwaSettings.la(53)&&$a.EwaSettings.la(93)&&!this.eFc&&(mc.virtualOsfControlActivationCallback=function(){cb.Wg.Azd(cb.Kd)});mc.sharedRuntimeId=this.Kd.SharedRuntime?this.Kd.SharedRuntime.Resid:this.Kd.SharedRuntimeId;!Jd.HelperMethods.Vv(this.Kd)||this.Kd.Preload||za.a(this.Kd)||this.Wg.Gi.getOsfControl(b(861).DdaFacade.getSolutionId(this.Kd,this.$))||($a.EwaSettings.isChangeGateEnabled("OfficeVSO:5707326_FixBackgroundAppCrashInViewMode")?
this.$.isEditMode&&this.Wg.Azd(this.Kd):this.Wg.Azd(this.Kd));mc.initialDisplayMode=this.Kd.TaskpaneVisible?2:1;$a.EwaSettings.isChangeGateEnabled("OfficeVSO:5793296_SDXIframeTitleOverride")&&(mc.titleOverride=this.cl.TaskpaneTitle);this.Wg.Gi.insertOsfControl(mc)}this.jU=0}else this.fFe(!0)};U.prototype.j8f=function(cb){this.k8f(cb);this.OGj()};U.prototype.z0h=function(){this.gbb||this.Uh.MXb(this.z2e);this.gbb++};U.prototype.k8f=function(cb){0<this.gbb&&(cb?this.gbb=0:this.gbb--,this.gbb||this.Uh.Kqc(this.z2e))};
U.prototype.Phd=function(){if(!this.uva){var cb=Xb.g(this.$).ha;this.Hoc=db.d(Xb.g(this.$).ha.va.selectedRanges);cb.iG(this.kd);this.uva=!0}};U.prototype.OGj=function(){this.uva&&(Xb.g(this.$).ha.DK(this.kd),this.uva=!1)};U.prototype.Bej=function(cb){var mc=new Ba.Range(cb.Reference.FirstRow+1,cb.Reference.FirstColumn+1,cb.Reference.LastRow+1,cb.Reference.LastColumn+1,!1,!1);1===cb.BindingType&&(cb.HasHeaders&&--mc.top,cb.HasTotals&&(mc.bottom+=1));var Oc=Xb.g(this.$).ha.va.selectedRanges;cb=mc.Rwb(this.Hoc);
Oc=mc.Rwb(Oc);return(mc=mc.Jf(Xb.g(this.$).ha.va.activeRange))&&(pb.e(cb)&&!pb.e(Oc)||!pb.e(cb)&&!pb.e(Oc)&&!db.Q(cb,Oc))?mc:null};U.prototype.Kfj=function(){var cb=this;Array.forEach(this.aE,function(mc){if(mc.eventId!==OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent&&mc.eventId!==OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||cb.Wg.dj.cZb(cb.controlId))if(mc.eventId===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent)mc.K_b(new Ha.a(mc.eventId,cb.controlId,null));else if(mc.eventId===
OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent){var Oc=cb.z1a(mc.targetId);if((null===Oc||void 0===Oc?0:Oc.IsValidRef)&&(cb.$.fa.isNamedObjectViewMode?cb.$.xb.oa.sheetName:cb.$.xa.oa.name)===Oc.Reference.SheetName){var Sc=cb.Bej(Oc);Sc&&mc.K_b(new N(mc.eventId,cb.controlId,cb.Wg.QZb(Oc),Oc,Sc.top-1,Sc.left-1,Sc.height,Sc.width))}}})};U.prototype.usb=function(cb,mc){if(!this.aE)return null;for(var Oc=0;Oc<this.aE.length;Oc++){var Sc=this.aE[Oc];if(Sc.eventId===cb&&Sc.targetId===mc)return Sc}return null};
U.prototype.mQe=function(){for(var cb=Xd.a(this.$).Py,mc=cb.length-1;0<=mc;--mc){var Oc=cb[mc];if(3===Oc.floatingObject.type&&Oc.floatingObject.cl.InstanceId===this.P0.WebExtensionId)return Oc}return null};U.prototype.Gdi=function(){for(var cb=0;cb<this.$.xb.count;cb++)if(this.$.xb.getItem(cb).Eja===this.P0.WebExtensionId)return!0;return!1};U.prototype.suc=function(cb){this.lMc=cb;this.Px.id=this.TBf;this.Px.className="ewa-wx-container-div";this.Px.dir=this.$.isChromeRtl?"rtl":"ltr";this.Dhj()};U.prototype.aZe=
function(){if(!this.enabled)return null;var cb=za.a(this.cl)?"":this.cl.PrimaryMarketplace.SolutionVersion;return OSF.OsfManifestManager.getCachedManifest(this.cl.PrimaryMarketplace.SolutionId,cb)};U.prototype.B2e=function(cb,mc){if($a.EwaSettings.la(24))this.Wg.vf(OSF.DDA.ErrorCodeManager.errorCodes.ooeBrowserAPINotSupported,mc);else try{if(Cb.ULS.sendTraceTag(537170462,0,50,"HandleDialogNotificationShownInAddinEvent called!"),4!==this.pae)this.Wg.vf(OSF.DDA.ErrorCodeManager.errorCodes.ooeNotUILessDialog,
mc);else{var Oc={};Oc[Ja.a.Amb]=this.controlId;var Sc=new Ac.a(cb,0,this.$.isEditMode?2:1,0,null);this.$.Ka.Zb(Sc,Oc);this.Wg.Au(mc)}}catch($c){Cb.ULS.sendTraceTag(537170461,0,10,"HandleDialogNotificationShownInAddinEvent called. Error message: {0}.",$c.message),this.Wg.vf(OSF.DDA.ErrorCodeManager.errorCodes.ooeInternalError,mc)}};U.Nch=function(cb){return cb===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||cb===OSF.DDA.EventDispId.dispidBindingDataChangedEvent};U.F$e=function(cb){return cb===
OSF.DDA.EventDispId.dispidBindingDataChangedEvent||cb===OSF.DDA.EventDispId.dispidSettingsChangedEvent||cb===OSF.DDA.EventDispId.dispidRichApiMessageEvent};U.nld=function(cb){return cb===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||cb===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent};U.D$e=function(cb){return cb===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent};U.E$e=function(cb){return cb===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent};U.C$e=function(cb){return cb===
OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent};tl.Object.defineProperties(U.prototype,{controlId:{configurable:!0,enumerable:!0,get:function(){return this.Kd.InstanceId}},controlType:{configurable:!0,enumerable:!0,get:function(){return this.Kd.WebExtensionType}},ownerAddinAssetId:{configurable:!0,enumerable:!0,get:function(){return this.Kd.OwnerAddinAssetId}},ownerAddinSolutionId:{configurable:!0,enumerable:!0,get:function(){return this.Kd.OwnerAddinSolutionId}},$:{configurable:!0,
enumerable:!0,get:function(){return this.vb}},enabled:{configurable:!0,enumerable:!0,get:function(){return!this.jU}},Px:{configurable:!0,enumerable:!0,get:function(){return this.lMc}},WT:{configurable:!0,enumerable:!0,get:function(){return this.Kd.SrcLocationOverrideResourceId?this.Wg.kJa(this.Kd.PrimaryMarketplace.SolutionId,this.Kd.SrcLocationOverrideResourceId):this.Kd.PrimaryMarketplace.SolutionId}},sourceLocationOverrideResourceId:{configurable:!0,enumerable:!0,get:function(){return this.Kd.SrcLocationOverrideResourceId}},
cl:{configurable:!0,enumerable:!0,get:function(){return this.Kd}},Ega:{configurable:!0,enumerable:!0,get:function(){return this.e_d},set:function(cb){this.e_d=cb}},osfControlType:{configurable:!0,enumerable:!0,get:function(){return this.pae}},rHa:{configurable:!0,enumerable:!0,get:function(){return this.eFc},set:function(cb){this.eFc=cb}},u3c:{configurable:!0,enumerable:!0,get:function(){return this.qUa},set:function(cb){this.qUa=cb}},focusOnIframeWhenLoaded:{configurable:!0,enumerable:!0,get:function(){return this.Kd.FocusOnIframeWhenLoaded}},
ind:{configurable:!0,enumerable:!0,get:function(){return this.U6d},set:function(cb){this.U6d=cb}}});Object(ob.a)(U,"OsfControl",dc.a,[841]);B.prototype.add=function(cb){this.RXa[cb]=!0};B.prototype.remove=function(cb){delete this.RXa[cb]};B.prototype.clear=function(){for(var cb=yl(Object.keys(this.RXa)),mc=cb.next();!mc.done;mc=cb.next())delete this.RXa[mc.value]};B.prototype.T3e=function(){return 0<Object.keys(this.RXa).length};B.prototype.pCh=function(){return Object.keys(this.RXa)};Object(ob.a)(B,
"RichApiBeforeDocumentCloseNotificationRegistrationManager",null,[]);var Je=b(52);w.prototype.snb=function(cb){51===cb.messageType?this.CKf=this.HFa(cb.actionType,this.CKf,this.Qzi):52===cb.messageType&&(this.DKf=this.HFa(cb.actionType,this.DKf,this.Rzi))};w.prototype.HFa=function(cb,mc,Oc){if(1===cb)mc||Xb.g(this.$).ha.Qa.dTc(Oc),mc++,this.nlj();else if(2===cb){if(1>mc)return mc;1===mc&&Xb.g(this.$).ha.Qa.JGd(Oc);mc--}return mc};w.prototype.wia=function(cb,mc,Oc){mc&&this.dj.CZ(cb,mc)&&this.Uh.jM(cb,
mc,Oc)};w.prototype.H9b=function(cb){return cb&&cb.floatingObject?(cb=cb.floatingObject.id.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}")))&&1===cb.length?cb[0]:null:null};w.prototype.Ria=function(){var cb=this.$.xa.oa;return!cb||cb.$H?null:cb.sheetId};w.prototype.nlj=function(){var cb=Xb.g(this.$).ha.Qa.ZB;this.Xkd(cb)&&(this.T9a=this.H9b(cb),this.$Ib=this.Ria())};w.prototype.Xkd=function(cb){return!!cb&&!!cb.floatingObject&&!cb.floatingObject.type};Object(ob.a)(w,"RichApiEventChartActivatedDeactivatedHandler",
null,[]);var bc=b(868),Qd=b(181),Vd=b(657),de=b(95),pe=b(339),Ad=b(55),Pd=Mb.a;vm(G,Pd);G.prototype.yZb=function(cb){Object(ub.a)(pe.a,this.$.xa);1===cb.actionType?(this.Yya||this.grid.ha.iG(this.kd),this.Yya++):2!==cb.actionType||1>this.Yya||(1===this.Yya&&this.grid.ha.DK(this.kd),this.Yya--)};G.prototype.Ytc=function(cb){cb?this.jU++:(0<this.jU&&this.jU--,this.jU||this.kd(null,new Vd.a(!1)))};G.prototype.AVe=function(){return this.grid.ha.va.selectedRanges};G.prototype.cpe=function(cb,mc){return $a.EwaSettings.isChangeGateEnabled("OfficeVSO:4233860_EnableSelectionChangedEventForFirstTimeOnOpenSheet")?
(!!cb&&Qd.e(this.sMa)||cb in this.sMa)&&!db.Q(this.sMa[cb],mc):cb in this.sMa&&!db.Q(this.sMa[cb],mc)};G.prototype.iGe=function(cb,mc,Oc){this.sMa[cb]=db.d(mc);this.uhc[cb]=Oc};G.prototype.jbf=function(){return this.grid.isEditing||this.grid.zi};G.prototype.MQe=function(cb,mc){this.dj.CZ(14,cb)&&this.Uh.jM(14,cb,mc);this.dj.CZ(14,bc.a.vW)&&this.Uh.jM(14,bc.a.vW,mc)};G.prototype.hZh=function(cb,mc){var Oc={};Oc.worksheetId=cb;Oc.address=this.oed(mc);mc=Je.a.Hc(Oc);this.MQe(cb,mc)};G.prototype.SYh=
function(cb,mc,Oc,Sc){if(this.dj.kef()){var $c="",le="";Sc&&($c=Sc.pj);Oc&&(le=Oc.pj);Sc?Oc?(mc=Oc.usedRange.Rwb(mc),$c!==le&&this.g8b($c,"",cb),this.g8b(le,this.oed(mc),cb)):this.g8b($c,"",cb):Oc&&($c=Oc.usedRange.Rwb(mc),this.g8b(le,this.oed($c),cb))}};G.prototype.g8b=function(cb,mc,Oc){if(this.dj.CZ(100,cb)){var Sc={};Sc.address=mc;Sc.worksheetId=Oc;this.Uh.jM(100,cb,Je.a.Hc(Sc))}};G.prototype.oed=function(cb){return db.i(cb,",",this.$,!1)};G.prototype.dispose=function(){0<this.Yya&&this.grid.ha.DK(this.kd);
this.uhc=this.sMa=null;this.Yya=0;this.Uh=this.dj=this.$=this.grid=null};tl.Object.defineProperties(G.prototype,{enabled:{configurable:!0,enumerable:!0,get:function(){return!this.jU&&0<this.Yya}}});Object(ob.a)(G,"RichApiEventSelectionChangedHandler",Mb.a,[]);var Ce=b(336);vm(r,G);r.prototype.AVe=function(){return Ce.a.aHa(this.grid.ha.rangePicker.uK)};r.prototype.cpe=function(cb,mc){return this.jgf!==cb||!db.Q(this.igf,mc)};r.prototype.iGe=function(cb,mc){this.jgf=cb;this.igf=db.d(mc)};r.prototype.jbf=
function(){return!this.grid.isEditing&&!this.grid.zi};r.prototype.MQe=function(cb,mc){this.dj.CZ(2700,bc.a.vW)&&this.Uh.jM(2700,bc.a.vW,mc)};Object(ob.a)(r,"RichApiEventPickedRangesChangedHandler",G,[]);z.prototype.snb=function(cb){var mc=Xb.g(this.$).ha;1===cb.actionType?(this.rPa||this.sPa||mc.Qa.dTc(this.Ttf),2101===cb.messageType?this.rPa++:2102===cb.messageType&&this.sPa++):2===cb.actionType&&(2101===cb.messageType?this.rPa=0<this.rPa?this.rPa-1:0:2102===cb.messageType&&(this.sPa=0<this.sPa?
this.sPa-1:0),this.rPa||this.sPa||mc.Qa.JGd(this.Ttf))};z.prototype.nfi=function(cb){return!!cb&&!!cb.floatingObject&&(!cb.floatingObject.type||7===cb.floatingObject.type||1===cb.floatingObject.type||3===cb.floatingObject.type||5===cb.floatingObject.type)};z.prototype.uFj=function(cb){if(!cb||!cb.floatingObject)return null;cb=cb.floatingObject.id;var mc=cb.match(RegExp("\\{\\w{8}-\\w{4}-\\w{4}-\\w{4}-\\w{12}\\}"));mc=mc&&1===mc.length?mc[0]:null;return mc?mc:(Cb.ULS.sendTraceTag(537170457,344,10,
"Expect get the guid like shape id from the floating object id: '{0}', but we failed.",cb),null)};z.prototype.Ria=function(){var cb=this.$.xa.oa;return!cb||cb.$H?null:cb.sheetId};z.prototype.fireEvent=function(cb,mc,Oc){mc&&this.dj.CZ(cb,mc)&&this.Uh.jM(cb,mc,Oc)};Object(ob.a)(z,"RichApiEventShapeActivatedDeactivatedHandler",null,[]);t.prototype.snb=function(cb){11===cb.messageType?cb.targetId===bc.a.vW?this.JHg(cb.actionType):this.IHg(cb.actionType):12===cb.messageType&&(cb.targetId===bc.a.vW?this.KHg(cb.actionType):
this.LHg(cb.actionType))};t.prototype.IHg=function(cb){this.EKf=this.HFa(cb,this.EKf,this.YMi)};t.prototype.LHg=function(cb){this.HKf=this.HFa(cb,this.HKf,this.aNi)};t.prototype.JHg=function(cb){this.FKf=this.HFa(cb,this.FKf,this.ZMi)};t.prototype.KHg=function(cb){this.GKf=this.HFa(cb,this.GKf,this.$Mi)};t.prototype.HFa=function(cb,mc,Oc){1===cb?mc=this.AVc(mc,Oc):2===cb&&(mc=this.I4c(mc,Oc));return mc};t.prototype.AVc=function(cb,mc){cb||this.$.xa.Pf(mc);cb++;return cb};t.prototype.I4c=function(cb,
mc){if(1>cb)return cb;1===cb&&this.$.xa.rg(mc);cb--;return cb};t.prototype.l6a=function(cb){return!!cb&&!cb.$H};t.prototype.wia=function(cb,mc,Oc,Sc){mc=(void 0===Sc?0:Sc)?bc.a.vW:mc;this.dj.CZ(cb,mc)&&this.Uh.jM(cb,mc,Oc)};Object(ob.a)(t,"RichApiEventSheetActivatedDeactivatedHandler",null,[]);var Jf=b(169),oc=b(12),ed=b(276),wc=Sys.EventArgs;vm(x,wc);Object(ob.a)(x,"ClickInActiveCellEventArgs",Sys.EventArgs,[]);A.prototype.dispose=function(){this.AHj()};A.prototype.G1i=function(){for(var cb=yl(this.gridView.jn),
mc=cb.next();!mc.done;mc=cb.next())mc=mc.value.domElement,Jf.a.instance.pa(oc.a.pointerDown,mc,this.onPointerDown),ed.a.instance.pa(oc.a.click,mc,this.Vc)};A.prototype.AHj=function(){for(var cb=yl(this.gridView.jn),mc=cb.next();!mc.done;mc=cb.next())mc=mc.value.domElement,Jf.a.instance.za(oc.a.pointerDown,mc,this.onPointerDown),ed.a.instance.za(oc.a.click,mc,this.Vc)};A.prototype.bNi=function(cb){var mc=cb.sheet;if(this.l6a(mc)){var Oc={};Oc.worksheetId=mc.sheetId;Oc.address=cb.gRg.toString();Oc.offsetX=
cb.offsetX;Oc.offsetY=cb.offsetY;cb=mc.sheetId;this.dj.CZ(21,cb)&&(mc=Je.a.Hc(Oc),this.Uh.jM(21,cb,mc));cb=bc.a.vW;this.dj.CZ(21,cb)&&(Oc=Je.a.Hc(Oc),this.Uh.jM(21,cb,Oc))}};A.prototype.l6a=function(cb){return!!cb&&!cb.$H};Object(ob.a)(A,"RichApiEventSingleClickedHandler",null,[]);m.prototype.yZb=function(cb){2E3===cb.messageType&&(1===cb.actionType?(this.GFb||Xb.g(this.$).ha.Qa.dTc(this.dBf),this.GFb++,this.Khj()):2===cb.actionType&&this.GFb&&(1===this.GFb&&Xb.g(this.$).ha.Qa.JGd(this.dBf),this.GFb--))};
m.prototype.b$c=function(cb){var mc,Oc={};Oc.worksheetId=cb;Oc.revisionLoad=!1;if($a.EwaSettings.isChangeGateEnabled("OfficeVSO:5509495_SelectedVisualIdVisualSelectionChangedEventArgs")&&($a.EwaSettings.la(749)||$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChartBRSChartPlayerManualPlacement",!1))){var Sc=Xb.g(this.$).ha.Qa.ZB;(null===(mc=null===Sc||void 0===Sc?void 0:Sc.floatingObject)||void 0===mc?0:mc.Yc)?Oc.selectedVisualId=Sc.floatingObject.Yc.VisualID:Oc.selectedVisualId=null}mc=
Je.a.Hc(Oc);cb&&this.dj.CZ(2E3,cb)&&this.Uh.jM(2E3,cb,mc)};m.prototype.Ria=function(){var cb=this.$.xa.oa;return!cb||cb.$H?null:cb.sheetId};m.prototype.Khj=function(){var cb=Xb.g(this.$).ha.Qa.ZB;this.Wef(cb)&&(this.Q9a=cb.floatingObject.id,this.J9a=this.Ria())};m.prototype.Wef=function(cb){return!!cb&&cb.opd()};Object(ob.a)(m,"RichApiEventVisualSelectionChangedHandler",null,[]);v.prototype.HHg=function(cb){1===cb.actionType?(this.HFb||this.bIg(),this.HFb++):2!==cb.actionType||1>this.HFb||(1===this.HFb&&
this.m$g(),this.HFb--)};v.prototype.bIg=function(){if(this.dj.CZ(2203,bc.a.vW))if(this.Vnd){var cb={};cb.timeout=this.$.ya.CheckFocusTimeout;this.w8b=window.requestIdleCallback(this.vve,cb)}else this.w8b=window.setInterval(this.uve,this.$.ya.CheckFocusTimeInterval)};v.prototype.m$g=function(){this.Vnd?window.cancelIdleCallback(this.w8b):window.clearInterval(this.w8b)};Object(ob.a)(v,"RichApiEventWorkbookActivatedHandler",null,[]);var gb;(function(cb){cb[cb.none=0]="none";cb[cb.registerEvent=1]="registerEvent";
cb[cb.unregisterEvent=2]="unregisterEvent";cb[cb.customFunction=3]="customFunction";cb[cb.showCard=4]="showCard";cb[cb.createWorkbook=5]="createWorkbook";cb[cb.openWorkbook=6]="openWorkbook";cb[cb.enableEvents=7]="enableEvents";cb[cb.closeWorkbook=8]="closeWorkbook";cb[cb.setCalculationMode=9]="setCalculationMode";cb[cb.workbookLinksRequestRefresh=10]="workbookLinksRequestRefresh";cb[cb.workbookLinksRequestRefreshAll=11]="workbookLinksRequestRefreshAll";cb[cb.workbookLinksEnableContent=12]="workbookLinksEnableContent";
cb[cb.workbookLinksFindNextLink=13]="workbookLinksFindNextLink";cb[cb.workbookLinksOpenWorkbook=14]="workbookLinksOpenWorkbook";cb[cb.rangePicker=15]="rangePicker";cb[cb.enableRichApiRecording=16]="enableRichApiRecording";cb[cb.recordAction=17]="recordAction";cb[cb.focus=18]="focus";cb[cb.businessBarShow=19]="businessBarShow";cb[cb.businessBarHide=20]="businessBarHide"})(gb||(gb={}));Object(ob.b)("PostProcessActionType",gb);var id=b(234);u.prototype.GHg=function(cb){1===cb.actionType?(this.$.Taa=
!0,Object(ub.a)(b(861).DdaFacade,id.a(this.$)).a$c(!0)):2===cb.actionType&&(this.$.Taa=!1);this.UBf=cb.controlId;Cb.ULS.sendTraceTag(537170456,0,50,"AttachOrDetachMacroRecorderEventHandler: actionType: {0}; controlId: {1}; this.ewaControl.IsMacroRecorderListening: {2}.",gb[cb.actionType],this.UBf,this.$.Taa)};u.prototype.ihh=function(cb){Object(ub.a)(b(861).DdaFacade,id.a(this.$)).PQe(cb,this.$.Taa)};u.prototype.T4h=function(){var cb=this;this.$.Xaa&&uc.TaskExtensions.Ba(Zb.GetServiceTaskFactory.Xa(this.$.da,
297,298,1),function(mc){(mc=mc.result)&&mc.init(cb.$9c)},this.$.ma,3)};Object(ob.a)(u,"RichApiMacroRecorderEventHandler",null,[]);Object(ob.a)(f,"SessionRecreationInfo",null,[]);l.prototype.$ui=function(){return $a.EwaSettings.la(260)?this.dj.UZh()||!!this.runtimeCalculationMode:!1};l.prototype.RMg=function(){var cb={};cb.eventRegistrationInfos=this.dj.oIh();cb.runtimeCalculationMode=this.runtimeCalculationMode;cb=Object.assign(new f,{runtimeState:cb});var mc={HttpMethod:"POST",PathAndQuery:"RestoreRuntimeState",
RequestHeaders:null};mc.RequestBody=JSON.stringify(cb);mc.RequestFlags=1;return mc};Object(ob.a)(l,"RichApiRuntimeStateHandler",null,[]);Object(ob.a)(n,"UserOperationQueueItemsStatisticsData",null,[]);var ib=b(322),nc=b(30),Nb=b(16),mb=b(286),Lc=b(45),zd=b(610),jd=b(59),ge=b(57),Yd=b(69),rd=ib.a;vm(k,rd);k.prototype.dispose=function(){this.$&&(this.$.xa.kF(this.ko),this.$.xb.kF(this.ko),this.$.xb.rg(this.Oe),this.$.xa.rg(this.Oe));this.kTa&&(this.kTa.Zo(this.Pe),this.kTa.LH(this.Hm),this.kTa.yq(this.Hg));
$a.EwaSettings.tc()&&this.Us(this.Kxa);this.clearCache();Xc.a.Fa(this.kTa);this.kTa=null;ad.DOMElementExtensions.Sf(this.domElement);rd.prototype.dispose.call(this)};k.prototype.Chj=function(cb){ad.DOMElementExtensions.Sf(ad.DOMElementExtensions.getElementById(this.domElement,cb.id));this.domElement.appendChild(cb)};k.prototype.Ejd=function(){if(this.Xua&&!this.X1b){var cb=Object(ub.a)(b(861).DdaFacade,id.a(this.$)).an(this.Xua.InstanceId);cb&&(cb.resize(this.Xua.Width,this.Xua.Height),cb.ja(this.domElement),
cb.showHide(!0),this.X1b=!0)}};k.prototype.n6a=function(){return!0};k.prototype.Qma=function(cb){this.Xua=cb.$c.block.qe;this.X1b=!1;this.Ejd()};k.prototype.CSa=function(cb){this.$.fa.yZ&&cb&&(cb.cu||(cb.cu=new mb.a),cb.cu.Ng=new Lc.a(this.domElement.scrollLeft,this.domElement.scrollTop),cb.cu.rEb=20)};k.prototype.clearCache=function(){this.Ca.$ya(this.hashCode);this.Xua=this.hashCode=null;this.X1b=!1};k.prototype.KRa=function(cb,mc){if(this.isVisible=!!cb&&jd.p(cb))this.hashCode=this.Ca.hga(cb,ge.a.Gqb,
this.hashCode),this.Euc(mc)};k.IFa=function(cb){if(!cb.da.Aa(34)){var mc=cb.Ue;cb.da.Ha(34,new k(cb,new zd.a(cb,cb.fa,cb.qa.Ek,3,0),mc.appendChild(mc.ownerDocument.createElement("div"))))}};tl.Object.defineProperties(k.prototype,{Ca:{configurable:!0,enumerable:!0,get:function(){return this.kTa}}});Object(ob.a)(k,"WebExtensionView",ib.a,[840,369,3]);var je=b(219),re=b(519),ae=b(368),Uf=b(434),Lf=b(163),Of=b(81),Yf=b(126),vg=b(44),Af=b(42),rf=b(147),Cg=b(107),sc=b(70),Rc=b(26),Qc=b(27),ee=b(302),ue=
b(19),Ee=b(14),De=b(273),ne=b(879),gc=b(48),fd=b(143),vd=b(1120),se=b(193),Jc=b(1014),Bc=b(29);b.d(D,"DdaFacade",function(){return a});var Ae=tb.a;vm(a,Ae);a.prototype.Bke=function(cb){this.addHandler("cd",cb)};a.prototype.g4i=function(cb){this.removeHandler("cd",cb)};a.prototype.Cke=function(cb){this.addHandler("csc",cb)};a.prototype.Aqc=function(cb){this.removeHandler("csc",cb)};a.prototype.Ozg=function(cb){this.addHandler("ca",cb)};a.prototype.f4i=function(cb){this.removeHandler("ca",cb)};a.prototype.Pzg=
function(cb){this.addHandler("ci",cb)};a.prototype.Qzg=function(cb){this.addHandler("ekros",cb)};a.prototype.h4i=function(cb){this.removeHandler("ekros",cb)};a.prototype.DAd=function(cb,mc){try{return JSON.parse(cb)[mc].toLowerCase()}catch(Oc){return""}};a.prototype.hoj=function(cb){var mc=this.DAd(cb,"AudienceGroup"),Oc=this.DAd(cb,"SessionOrigin");try{var Sc=parseInt(this.DAd(cb,"Ring"));if("automation"!==mc&&"bluechicken"!==Oc&&-2<=Sc)return!0}catch($c){if("automation"!==mc&&"bluechicken"!==Oc)return!0}return!1};
a.prototype.QZb=function(cb){var mc={};mc.Name=cb.Name;mc.BindingType=cb.BindingType;mc.HasHeaders=cb.HasHeaders;cb.IsValidRef&&(mc.ColCount=cb.Reference.LastColumn-cb.Reference.FirstColumn+1,mc.RowCount=cb.Reference.LastRow-cb.Reference.FirstRow+1);return mc};a.prototype.Pji=function(cb,mc){this.Ml.launchInsertDialog(cb,null,this.XLg(mc))};a.prototype.tDd=function(cb,mc){var Oc={};Oc.callbackFunc=cb;Oc.storeType=OSF.StoreTypeEnum.MarketPlace;Oc.fromInsertDialog=!1;Oc.refresh=mc;this.Ml.queryEntitlementDetails(Oc)};
a.prototype.invokeDdaMethod=function(cb,mc){var Oc=this.an(cb.DdaMethod.ControlId);Oc?Oc.invokeDdaMethod(cb,mc):this.vf(ka.a.internalError,mc)};a.prototype.registerDdaEventAsync=function(cb,mc,Oc,Sc,$c){(mc=this.an(mc))?a.xxb(cb)?mc.m0i(cb,Oc,Sc,$c):this.vf(ka.a.Wzd,$c):this.vf(ka.a.internalError,$c)};a.prototype.unregisterDdaEventAsync=function(cb,mc,Oc,Sc,$c){(mc=this.an(mc))?a.xxb(cb)?mc.fHj(cb,Oc,Sc,$c):this.vf(ka.a.Wzd,$c):this.vf(ka.a.internalError,$c)};a.prototype.dispose=function(){this.disposed||
(this.$.ml(this.od),this.fa.kk(this.Zc),this.fa.mW(this.vq),this.fa.mw(this.Kf),this.kUc.detach(this),this.$.userOperationManager.pz(this.cR),this.enc=this.Cf=this.Uh=this.kUc=this.vb=null,this.hIa&&(this.hIa.dispose(),this.hIa=null),Xc.a.Fa(this.nJd),Xc.a.Fa(this.mJd),this.$_a&&(this.$_a.dispose(),this.$_a=null),Ae.prototype.dispose.call(this),this.disposed=!0,Cb.ULS.sendTraceTag(537170583,0,50,"DdaFacade is disposed"))};a.prototype.e$b=function(cb){return(cb=this.an(cb))?cb.getDefaultIconUrl():
null};a.prototype.Ytc=function(cb){if(this.OCe!==cb){this.OCe=cb;for(var mc=0,Oc=this.Cf.length;mc<Oc;mc++){var Sc=this.Cf[mc];cb?Sc.fFe(!1):Sc.Yfh()}this.nJd.Ytc(cb);this.mJd.Ytc(cb)}};a.prototype.aHh=function(cb){return(cb=this.an(cb))?cb.getDefaultDisplayName():null};a.prototype.vf=function(cb,mc,Oc){var Sc={};Sc[bb.a.Kg]=cb;Sc[bb.a.f3]=mc;this.LJ(451041795,Sc,void 0===Oc?!0:Oc)};a.prototype.Au=function(cb){var mc={};mc[bb.a.f3]=cb;this.LJ(1237877382,mc)};a.prototype.LJ=function(cb,mc,Oc){var Sc=
this;Oc=void 0===Oc?!0:Oc;var $c=new Ac.a(cb,0,this.$.ed,0,null),le=mc?mc[bb.a.f3]:null;this.$_a&&Xb.g(this.$).isEditing&&Q.QVg(cb,mc)?this.$_a.g9g(cb,mc):(cb=this.$.Ka.Zb($c,mc),Oc&&uc.TaskExtensions.Ba(cb,function(we){rf.a(we)?Sc.vf(ka.a.internalError,le,!1):we.result||(Xb.g(Sc.$).isEditing?Sc.vf(ka.a.Swb,le,!1):Sc.vf(ka.a.internalError,le,!1))},this.ma,8))};a.prototype.mYg=function(cb){var mc=this;return!!this.via(function(Oc){return a.getSolutionId(Oc.cl,mc.$)===a.getSolutionId(cb,mc.$)&&Oc.cl.PrimaryMarketplace.MarketplaceType===
cb.PrimaryMarketplace.MarketplaceType&&Oc.cl.PrimaryMarketplace.MarketplaceRef===cb.PrimaryMarketplace.MarketplaceRef&&Oc.cl.PrimaryMarketplace.SolutionVersion===cb.PrimaryMarketplace.SolutionVersion})};a.prototype.an=function(cb){return this.via(function(mc){return mc.controlId.startsWith(cb)})};a.prototype.Ivh=function(cb){return this.via(function(mc){return mc.rHa===cb})};a.prototype.nQe=function(cb){return this.via(function(mc){return mc.WT===cb&&!!mc.rHa})};a.prototype.EQe=function(cb,mc,Oc,
Sc){return this.via(function($c){return $c.WT===cb&&$c.cl.PrimaryMarketplace.MarketplaceRef.toLowerCase()===mc.toLowerCase()&&$c.cl.PrimaryMarketplace.MarketplaceType.toLowerCase()===Oc.toLowerCase()&&!!$c.cl.SharedRuntime&&!!$c.cl.SharedRuntime.Resid&&!!Sc&&!!Sc.Resid&&$c.cl.SharedRuntime.Resid.toLowerCase()===Sc.Resid.toLowerCase()})};a.prototype.tHg=function(cb,mc){if(cb=this.an(cb))cb.ja(mc),cb.showHide(!0)};a.prototype.usj=function(cb){(cb=this.an(cb))&&cb.showHide(!1)};a.prototype.z_a=function(cb){if(1!==
cb.WebExtensionType||this.$.Fd&8388608&&cb.TaskpaneVisible||this.$.Fd&8388608&&!cb.TaskpaneVisible&&Jd.HelperMethods.Vv(cb)){var mc=null;Jd.HelperMethods.Vv(cb)&&(mc=a.nua(cb,this.$),cb.TaskpaneWidth||(cb.TaskpaneWidth=this.g4b));var Oc=(new U(this,this.Uh,cb)).pjd();Cb.ULS.sendTraceTag(51263011,0,50,"DdaFacade::CreateOsfControl: SolutionId: {0}, StoreType: {1}, UseShareRuntime: {2}",Telemetry.PrivacyRules.GetAssetId(cb.PrimaryMarketplace.MarketplaceType,cb.PrimaryMarketplace.MarketplaceRef,cb.PrimaryMarketplace.SolutionId),
cb.PrimaryMarketplace.MarketplaceType,Jd.HelperMethods.Vv(cb));mc&&(Oc.rHa=mc);Array.add(this.Cf,Oc);this.Fwa=null;this.F4a(cb.InstanceId)||(cb=String.format("{0}|{1}|{2}|{3}|{4}",cb.PrimaryMarketplace.SolutionId,cb.PrimaryMarketplace.SolutionVersion,cb.PrimaryMarketplace.MarketplaceRef,cb.PrimaryMarketplace.MarketplaceType,cb.WebExtensionType),this.raiseEvent("ci",cb))}};a.prototype.guj=function(cb,mc){function Oc(){Sc.xPa(le.controlId);Sc.Gi.purgeOsfControl(le.controlId,!1);mc()}var Sc=this;cb.TaskpaneWidth=
this.g4b;cb.TaskpaneVisible=!0;var $c={};$c.SolutionId=cb.PrimaryMarketplace.SolutionId;$c.TargetType=cb.WebExtensionType;$c.Version=cb.PrimaryMarketplace.SolutionVersion;$c.StoreType=cb.PrimaryMarketplace.MarketplaceType;$c.StoreId=cb.PrimaryMarketplace.MarketplaceRef;$c.AssetId=cb.PrimaryMarketplace.SolutionId;$c.AssetStoreId=cb.PrimaryMarketplace.MarketplaceRef;$c.Width=cb.TaskpaneWidth;$c.Id=cb.PrimaryMarketplace.SolutionId;$c.AppVersion=cb.PrimaryMarketplace.SolutionVersion;$c.CurrentStoreType=
cb.PrimaryMarketplace.MarketplaceType;var le=new U(this,this.Uh,cb,!0);le.pjd();Array.add(this.Cf,le);var we=null;we=vg.a.instance.XB(function(){le.Px&&(Xc.a.Fa(we),we=null,Sc.Gi.insertBlankControlWithErrorUX(Sc.zEb(le,$c),Oc))},100,Af.a.Z7g)};a.prototype.T0g=function(cb){var mc=this;if(cb&&cb.length){var Oc=[];cb.forEach(function(Sc){if(Sc.ContainsCustomFunctions){var $c=a.nua(Sc,mc.$);mc.ZAd.contains($c)||(mc.ZAd.add($c),Array.add(mc.kDf,Sc));mc.mYg(Sc)||Array.add(Oc,Sc)}});Oc.length&&this.hAe(Oc)}};
a.prototype.YBe=function(cb,mc){this.an(cb.InstanceId)||(mc=mc(),cb=(new U(this,this.Uh,cb)).D7e(mc),Array.add(this.Cf,cb),this.Fwa=null)};a.prototype.Prj=function(cb){a.S_a.wb(cb)&&a.S_a.na(cb).initializeAndShowWithTitle()};a.prototype.P_h=function(cb){a.S_a.wb(cb)&&a.S_a.na(cb).hide()};a.prototype.HNh=function(cb){var mc=this,Oc=null,Sc,$c=null;var le=a.Mfd(cb,!0);if(!le)return Cb.ULS.sendTraceTag(537170570,0,10,"DdaFacade.GetOrCreateCustomFunctionSandboxAsync: webextension data is null"),Ad.Task.Ta(null);
(Sc=this.Ml.getOsfControl(a.getSolutionId(le,this.$)))&&(Oc=Sc.getManifest())&&($c=Oc.getSharedRuntimeForCustomFunctions("Workbook"));if(Oc=$c&&1===$c.LifeTime?this.EQe(le.PrimaryMarketplace.SolutionId,le.PrimaryMarketplace.MarketplaceRef,le.PrimaryMarketplace.MarketplaceType,$c):this.Ivh(cb))return Ad.Task.Ta(Oc.controlId);var we=new Ta.a;Jd.HelperMethods.Pgc($c)&&(le.SharedRuntime=$c);cb=Sc?Sc.getNotificationParams():[];if(!cb.length)return this.JAe(le);this.UZf(cb,function(){uc.TaskExtensions.Ba(we.task,
function(){mc.JAe(le)},mc.ma,3)},function(){});return we.task};a.prototype.nCh=function(cb){cb=a.Mfd(cb,!1);if(!cb)return Cb.ULS.sendTraceTag(537170569,0,10,"DdaFacade.GetAddinCommandSandbox: webextension data is null"),null;var mc=null,Oc=this.Ml.getOsfControl(a.getSolutionId(cb,this.$));Oc&&(Oc=Oc.getManifest())&&(mc=Oc.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));return Jd.HelperMethods.Pgc(mc)&&(cb=this.EQe(cb.PrimaryMarketplace.SolutionId,cb.PrimaryMarketplace.MarketplaceRef,cb.PrimaryMarketplace.MarketplaceType,
mc))?cb.controlId:null};a.prototype.q_g=function(cb,mc){var Oc=this,Sc=a.Mfd(cb,!1);if(Sc){var $c=null,le=this.Ml.getOsfControl(a.getSolutionId(Sc,this.$));le&&(le=le.getManifest())&&($c=le.getSharedRuntimeForAppCmdsExecuteFunction("Workbook"));if(Jd.HelperMethods.Pgc($c)){Sc.SharedRuntime=$c;var we=Sc.PrimaryMarketplace.SolutionId;le=Sc.PrimaryMarketplace.SolutionVersion;var jc=OSF.OsfManifestManager.getCachedManifest(we,le);if(jc)if(this.cYb.wb(cb))$c=this.cYb.na(cb),uc.TaskExtensions.Ba($c,function(Fd){(Fd=
Fd.result)&&OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Fd,mc,Oc.Uh.RHb)},this.ma,3);else{var Zc={solutionId:we,version:le};Zc.storeType=Sc.PrimaryMarketplace.MarketplaceType;Zc.storeId=Sc.PrimaryMarketplace.MarketplaceRef;Zc.assetId=we;Zc.assetStoreId=null;Zc.targetType=OSF.OsfControlTarget.TaskPane;var ud=new Ta.a;Sc=uc.TaskExtensions.om();Sc=new E.a(this.$,this,Zc,Sc);$c=OSF.OsfManifestManager.getSharedRuntimeManifestCacheKey(we,$c.Resid);OfficeExt.AddinCommandsManifestManager.cacheManifestForAction(jc,
$c,le);Sc.createUILessSandbox(Zc,jc,function(Fd,me){Fd&&!me?(OfficeExt.ShortcutKeyDispatchManager.queueOrSendActionIfControlReady(Fd,mc,Oc.Uh.RHb),ud.setResult(Fd)):ud.setResult(null);Oc.cYb.remove(cb)});this.cYb.ia(cb,ud.task)}}}else Cb.ULS.sendTraceTag(537170568,0,10,"DdaFacade.CreateAddinCommandSandboxAsync: webextension data is null")};a.prototype.gve=function(cb){(cb=this.nQe(cb))&&(cb.cl.SharedRuntime||this.PFb(cb.controlId))};a.prototype.PFb=function(cb){(cb=this.nQe(cb))&&this.xPa(cb.controlId)};
a.prototype.ich=function(cb,mc){if(!this.Cf||!cb||!mc)return!1;if(cb.toLowerCase()===mc.toLowerCase())return!0;for(var Oc=null,Sc=null,$c=0,le=this.Cf.length;$c<le;$c++){var we=this.Cf[$c];if(we.ownerAddinSolutionId&&(we.controlId===cb&&(Oc=we.ownerAddinSolutionId.toLowerCase()),we.controlId===mc&&(Sc=we.ownerAddinSolutionId.toLowerCase()),Oc&&Sc))break}return Oc&&Oc===Sc?!0:!1};a.prototype.uxg=function(cb){this.an(cb.InstanceId)||(cb=new U(this,this.Uh,cb),Array.add(this.Cf,cb),this.Fwa=null)};a.prototype.yLf=
function(cb){if(this.Cf&&0<=cb&&cb<this.Cf.length){var mc=this.Cf[cb],Oc=mc.Px;Array.removeAt(this.Cf,cb);this.Hsf(mc);ad.DOMElementExtensions.Sf(Oc)}};a.prototype.xPa=function(cb){if(this.Cf)for(var mc=0,Oc=this.Cf.length;mc<Oc;mc++)if(this.Cf[mc].controlId===cb){this.yLf(mc);break}};a.prototype.h3i=function(cb){if(this.Cf){cb=cb.toLowerCase();for(var mc=0,Oc=this.Cf.length;mc<Oc;mc++)if(cb===this.Cf[mc].ownerAddinSolutionId.toLowerCase()){this.yLf(mc);break}}};a.prototype.aIg=function(cb){cb.Bt&&
(this.an(cb.floatingObject.cl.InstanceId)||(this.Odc(cb.floatingObject.cl.InstanceId)||Array.add(this.enc,cb.floatingObject.cl.InstanceId),this.z_a(cb.floatingObject.cl)),this.fa.isNamedObjectViewMode&&this.tHg(cb.floatingObject.cl.InstanceId,cb.Pd))};a.prototype.U$=function(cb){if(this.Cf)for(var mc=0,Oc=this.Cf.length;mc<Oc;mc++)if(1===this.Cf[mc].controlType&&ue.a.equals(this.Cf[mc].WT,cb,!0))return this.Cf[mc].controlId;return null};a.prototype.hvh=function(cb){var mc=[];if(this.Cf)for(var Oc=
0,Sc=this.Cf.length;Oc<Sc;Oc++)ue.a.equals(this.Cf[Oc].WT,cb,!0)&&mc.push(this.Cf[Oc].controlId);return mc};a.prototype.Pvh=function(cb,mc){if(!mc||!cb)return null;if(this.Cf)for(var Oc=0,Sc=this.Cf.length;Oc<Sc;Oc++)if(1===this.Cf[Oc].controlType&&ue.a.equals(this.Cf[Oc].WT,cb,!0)&&this.Cf[Oc].cl.SharedRuntime&&ue.a.equals(this.Cf[Oc].cl.SharedRuntime.Resid,mc.Resid,!0))return this.Cf[Oc].controlId;return null};a.prototype.kJa=function(cb,mc){mc=void 0===mc?null:mc;return cb?mc?String.format("{0}.{1}",
cb,mc):cb:""};a.prototype.jve=function(cb,mc,Oc){if(this.Fwa===cb)return!0;this.Fwa=cb;var Sc=null,$c=!1;if(!Sc&&this.Cf)for(var le=0,we=this.Cf.length;le<we;le++)if(1===this.Cf[le].controlType&&ue.a.equals(this.Cf[le].WT,cb,!0)){var jc=!1,Zc=!1;mc?(jc=!0,Zc=!!this.Cf[le].cl.SharedRuntime&&ue.a.equals(this.Cf[le].cl.SharedRuntime.Resid,mc.Resid,!0)):Oc&&(jc=!0,Zc=ue.a.equals(this.Cf[le].cl.SharedRuntimeId,Oc,!0));if(!jc||Zc){Zc&&this.Cf[le].Lf(!0);Sc=this.Cf[le].controlId;$c=!0;this.Fwa=null;break}}Sc&&
this.raiseEvent("ca",Sc);return $c};a.prototype.setAppRuntimeState=function(cb,mc){var Oc;if(cb){var Sc=this.an(cb);if(Sc&&Jd.HelperMethods.Vv(Sc.cl))Sc.Lf(mc),mc&&(this.raiseEvent("ca",cb),(null===(Oc=Sc.Px)||void 0===Oc?0:Oc.firstChild)&&(cb=Sc.Px.firstChild.title)&&0<cb.length&&this.jZb.Cfj(cb));else throw Cb.ULS.sendTraceTag(537170565,0,50,"SetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(Ee.a.instance.ea(2174));}else throw Cb.ULS.sendTraceTag(537170564,0,15,"SetAppRuntimeState: Invalid controlId."),
Error.invalidOperation(Ee.a.instance.ea(2175));};a.prototype.getAppRuntimeState=function(cb){if(cb)if((cb=this.an(cb))&&Jd.HelperMethods.Vv(cb.cl))cb=cb.cl.TaskpaneVisible;else throw Cb.ULS.sendTraceTag(537170563,0,50,"GetAppRuntimeState: run on non-shared runtime app."),Error.invalidOperation(Ee.a.instance.ea(2174));else throw Cb.ULS.sendTraceTag(537170562,0,15,"GetAppRuntimeState: Invalid controlId."),Error.invalidOperation(Ee.a.instance.ea(2175));return cb};a.prototype.z1a=function(cb,mc){return(cb=
this.an(cb))?cb.z1a(mc):null};a.prototype.F4a=function(cb){return this.lve(this.enc,cb)};a.prototype.Odc=function(cb){return this.lve(this.JCe,cb)};a.prototype.Wie=function(cb){Array.add(this.JCe,cb)};a.prototype.YY=function(cb){return(cb=this.an(cb))?cb.cl:null};a.prototype.awd=function(cb){this.raiseEvent("ekros",cb,this)};a.prototype.Azd=function(cb){if(cb){var mc=this.an(cb.InstanceId);mc&&(cb.SharedRuntime||cb.SharedRuntimeId||(this.xPa(mc.controlId),this.Gi.purgeOsfControl(mc.controlId,!1)),
mc={},mc.SolutionId=cb.PrimaryMarketplace.SolutionId,mc.TargetType=cb.WebExtensionType,mc.Version=cb.PrimaryMarketplace.SolutionVersion,mc.StoreType=cb.PrimaryMarketplace.MarketplaceType,mc.StoreId=cb.PrimaryMarketplace.MarketplaceRef,mc.AssetId=cb.PrimaryMarketplace.SolutionId,mc.AssetStoreId=cb.PrimaryMarketplace.MarketplaceRef,mc.Width=cb.TaskpaneWidth,mc.SharedRuntimeId=cb.SharedRuntimeId,mc.Id=cb.PrimaryMarketplace.SolutionId,mc.AppVersion=cb.PrimaryMarketplace.SolutionVersion,mc.CurrentStoreType=
cb.PrimaryMarketplace.MarketplaceType,this.O6f(mc))}};a.prototype.cia=function(){this.Uh.cia()};a.prototype.jM=function(cb,mc,Oc){this.Uh.jM(cb,mc,Oc)};a.prototype.Lfj=function(cb,mc){var Oc=Array(2);Oc[0]=mc;Oc[1]=null;this.Uh.dwh(cb,JSON.stringify(Oc))};a.prototype.PQe=function(cb,mc){mc=a.B4g(mc);cb=this.YY(cb);this.Uh.f8b(cb.InstanceId,2202,bc.a.vW,mc)};a.prototype.a$c=function(cb){for(var mc=0,Oc=this.Cf.length;mc<Oc;mc++)this.PQe(this.Cf[mc].controlId,cb)};a.prototype.$vh=function(cb,mc){mc=
a.W_g(mc);this.Uh.f8b(cb,65539,"",mc)};a.prototype.bwh=function(cb,mc,Oc){this.Uh.f8b(cb,1,mc,Oc)};a.prototype.Zvh=function(cb,mc){this.Uh.cwh(cb,mc)};a.prototype.n_g=function(cb,mc){return[[2,1E3,"",JSON.stringify([cb,mc]),0,!1]]};a.prototype.a9h=function(){return!!this.qma&&this.qma.T3e()};a.prototype.uTg=function(){this.qma&&this.qma.clear()};a.prototype.awh=function(){if(this.qma&&this.qma.T3e()){var cb=this.qma.pCh();cb=yl(cb);for(var mc=cb.next();!mc.done;mc=cb.next()){mc=this.hvh(mc.value);
mc=yl(mc);for(var Oc=mc.next();!Oc.done;Oc=mc.next())this.Uh.f8b(Oc.value,65540,"","{}")}}};a.prototype.g0i=function(cb){this.qma.add(cb)};a.prototype.bHj=function(cb){this.qma.remove(cb)};a.prototype.via=function(cb){if(!this.Cf)return null;for(var mc=yl(this.Cf),Oc=mc.next();!Oc.done;Oc=mc.next())if(Oc=Oc.value,cb(Oc))return Oc;return null};a.prototype.JAe=function(cb){var mc=this,Oc=new Ta.a,Sc=a.nua(cb,this.$);if(Jd.HelperMethods.Vv(cb))Cb.ULS.sendTraceTag(537170531,0,50,"Shared runtime custom function agave is started."),
this.hDf(cb,function(le){le?(cb.InstanceId=le.InstanceId,cb.WebExtensionOsfControlType=3,cb.TaskpaneVisible=!1,mc.z_a(cb),Oc.setResult(cb.InstanceId)):(Cb.ULS.sendTraceTag(537170530,0,10,"InsertAgaveTaskPane for customfunction: {0} failed",Telemetry.PrivacyRules.GetAssetId(cb.PrimaryMarketplace.MarketplaceType,cb.PrimaryMarketplace.MarketplaceRef,cb.PrimaryMarketplace.SolutionId)),Oc.setException(Error.create("Null insert data")))});else{a.S_a.ia(cb.InstanceId,new Ra.a);var $c=a.S_a.na(cb.InstanceId).k0a;
this.S0g(cb,$c,Sc);this.hDf(cb,null);Oc.setResult(cb.InstanceId)}return Oc.task};a.prototype.S0g=function(cb,mc,Oc){this.an(cb.InstanceId)||(cb=new U(this,this.Uh,cb),cb.rHa=Oc,cb.D7e(mc),Array.add(this.Cf,cb),this.Fwa=null)};a.prototype.hDf=function(cb,mc){var Oc=a.nua(cb,this.$);if(!this.ZAd.contains(Oc))this.YDb.push(cb),1<=this.YDb.length&&this.iDf(cb,mc);else if(mc){cb=yl(this.kDf);for(var Sc=cb.next();!Sc.done;Sc=cb.next())if(Sc=Sc.value,a.nua(Sc,this.$)===Oc){mc(Sc,0);break}}};a.prototype.iDf=
function(cb,mc){function Oc(Fd){Fd&&!ee.a(Fd)||Cb.ULS.sendTraceTag(537170527,0,10,"InsertAgaveTaskPane for addin {0} finish with errors: {1}",Telemetry.PrivacyRules.GetAssetId(we.StoreType,we.StoreId,we.SolutionId),Qc.a.Uc(Fd.Errors));$c.YDb.shift();0<$c.YDb.length&&$c.iDf($c.YDb[0],mc)}function Sc(Fd){Fd=Yf.a.yg(Fd.data);Cb.ULS.sendTraceTag(537170528,0,10,"DdaFacade.CreateCustomFunctionSandbox failed on InsertAgaveTaskpane for persistenting CustomFunctions. errors: {0}",Qc.a.Uc(Fd))}var $c=this,
le=null,we={};we.SolutionId=a.getSolutionId(cb,this.$);we.TargetType=cb.WebExtensionType;we.Version=cb.PrimaryMarketplace.SolutionVersion;we.StoreType=cb.PrimaryMarketplace.MarketplaceType;we.StoreId=cb.PrimaryMarketplace.MarketplaceRef;we.AssetId=cb.PrimaryMarketplace.SolutionId;we.AssetStoreId=cb.PrimaryMarketplace.MarketplaceRef;we.Width=cb.TaskpaneWidth;we.ContainsCustomFunctions=!0;we.Id=a.getSolutionId(cb,this.$);we.AppVersion=cb.PrimaryMarketplace.SolutionVersion;we.CurrentStoreType=cb.PrimaryMarketplace.MarketplaceType;
Jd.HelperMethods.Vv(cb)&&(we.SharedRuntimeId=cb.SharedRuntime.Resid);var jc=this.$.qa.ta;cb=this.$.qa.ta.Xb();var Zc=jc.Oa(9,cb);Zc.sharedInfo=we;if(mc){var ud=function(Fd){var me=Fd.Result;(le=me?me.AgaveData:null)||mc(null,Fd.Errors?Fd.Errors[0].ErrorCause:5001);mc(le,0)};cb=function(Fd,me,$e){return Of.i(jc,"InsertAgaveTaskpane",Zc,De.b(Fd,Oc,ud),De.a(me,Sc),$e,null,0)}}else cb=function(Fd,me,$e){return Of.i(jc,"InsertAgaveTaskpane",Zc,De.b(Fd,Oc),De.a(me,Sc),$e,null,0)};$a.EwaSettings.tc()?ae.a(this.$.userOperationManager,
cb,function(Fd){return new Lf.a(519,0,Fd,64)},null):ae.a(this.$.userOperationManager,cb,function(Fd){return new re.a(519,0,Fd)},null)};a.prototype.Zoj=function(){return this.$.ig.get(35)};a.prototype.nGd=function(cb){cb=this.an(cb);(null===cb||void 0===cb?0:cb.Wca)&&cb.ELf()};a.prototype.lwi=function(cb){var mc=this.via(function(Oc){return a.nLa(Oc.WT)});mc&&(mc=this.Gi.getOsfControl(mc.controlId))&&mc.notifyAgave(OSF.AgaveHostAction.SendMessage,cb)};a.prototype.J9h=function(){return!!this.via(function(cb){return 1===
cb.controlType&&a.nLa(cb.WT)})};a.prototype.I9h=function(){var cb=this.via(function(mc){return a.nLa(mc.WT)});return cb?cb.Px?ad.DOMElementExtensions.isVisible(cb.Px):!1:!1};a.prototype.Bij=function(){var cb=this.via(function(mc){return a.nLa(mc.WT)});cb&&(cb.Lf(!0),this.raiseEvent("ca",cb.controlId))};a.prototype.initialize=function(){var cb=b(1346).DdaEventDispatch,mc=void 0===this.$||null===this.$||$a.EwaSettings.la(260);void 0!==this.$&&null!==this.$||Cb.ULS.sendTraceTag(537170525,0,50,"VSO#2693929: Initialize is called. EwaControl is null");
mc&&Cb.ULS.sendTraceTag(537170524,0,50,"VSO#2693929: Initialize is called. this.initialized is "+this.initialized);this.initialized||(k.IFa(this.$),this.fa=this.$.fa,this.Uh=new cb(this.$),this.$.Rk(this.od),this.fa.Sj(this.Zc),this.fa.aP(this.vq),this.fa.jt(this.Kf),this.$.userOperationManager.uy(this.cR),this.Mhf(),this.GGi(),this.g4h(),this.$.da.Ha(35,this),this.kUc.ja(this),mc&&Cb.ULS.sendTraceTag(537170522,0,50,"VSO#2693929: SessionIdChanged event is registered"),this.Hce=new bc.a,mc&&Cb.ULS.sendTraceTag(537170521,
0,50,"VSO#2693929: RichApiEventRegistration is constructed"),this.Kce=new t(this.$,this.dj,this.Uh),this.Aqg=new A(this.$,this.dj,this.Uh),this.Ice=new G(this.$,this.dj,this.Uh),this.Gce=new r(this.$,this.dj,this.Uh),this.Fce=new w(this.$,this.dj,this.Uh),this.Jce=new z(this.$,this.dj,this.Uh),this.Lce=new m(this.$,this.dj,this.Uh),this.Mce=new v(this.$,this.dj,this.Uh),this.$.Xaa&&(this.Nce=new u(this.$,this.dj,this.Uh)),$a.EwaSettings.la(190)&&(this.$_a=new Q(this,Xb.g(this.$))),$a.EwaSettings.isChangeGateEnabled("OfficeVSO:5115360_BeforeDocumentCloseNotificationApiEnabled")&&
(this.Ece=new B),this.initialized=!0,Cb.ULS.sendTraceTag(537170520,0,50,"DdaFacade is initialized"))};a.prototype.Vvh=function(cb){if(!this.rBa)return null;for(var mc=0,Oc=this.rBa.length;mc<Oc;mc++)if(cb.startsWith(this.rBa[mc].WebExtensionId))return this.rBa[mc];return null};a.prototype.Mhf=function(){var cb,mc=this.fa;if(mc.oc&&!this.rNb){if(mc.workbookContext){if(this.ZQc=this.$.fa.ih.get(22),null===(cb=mc.workbookContext.WebExtensions)||void 0===cb?0:cb.length){cb=mc.workbookContext.WebExtensions;
mc=!1;for(var Oc={},Sc=cb.length-1;0<=Sc;Oc={LNb:Oc.LNb},Sc--){if(!this.fa.isNamedObjectViewMode){Array.add(this.enc,cb[Sc].InstanceId);if(1!==cb[Sc].WebExtensionType){Array.removeAt(cb,Sc);continue}if(Jd.HelperMethods.Vv(cb[Sc])&&cb[Sc].SharedRuntime.State)1===cb[Sc].SharedRuntime.State?cb[Sc].TaskpaneVisible=!1:2===cb[Sc].SharedRuntime.State?cb[Sc].TaskpaneVisible=!0:Cb.ULS.sendTraceTag(537170519,0,10,"The sharedRuntime state is invalid");else if(!cb[Sc].ContainsCustomFunctions&&!cb[Sc].TaskpaneVisible&&
!za.a(cb[Sc])){Array.removeAt(cb,Sc);continue}}var $c=OSF.OsfControl.isFirstPartyStoreString(cb[Sc].PrimaryMarketplace.MarketplaceType);$a.EwaSettings.la(186)&&!$c&&(Array.removeAt(cb,Sc),mc||(mc=!0,Oc.LNb=Zb.GetServiceTaskFactory.Xa(this.$.da,5,4,3),uc.TaskExtensions.Ba(Oc.LNb,function(le){return function(){le.LNb.result.hg(35,null)}}(Oc),this.ma,3)));$a.EwaSettings.isChangeGateEnabled("OfficeVSO:3937070_RemoveChartTaskPaneExtensionDuringLoad")&&cb[Sc].PrimaryMarketplace&&a.nLa(cb[Sc].PrimaryMarketplace.SolutionId)&&
(Cb.ULS.sendTraceTag(537170518,0,50,"chart task pane info stored in workbook context webextensions"),Array.removeAt(cb,Sc))}this.hAe(cb)}}else this.ZQc=!1;this.rNb=!0}};a.prototype.o2e=function(cb){var mc=Xb.g(this.$),Oc=mc.ha.Qa.nc;if(Oc&&cb){cb=!1;if(this.Cf)for(var Sc=yl(this.Cf),$c=Sc.next();!$c.done;$c=Sc.next())if($c=$c.value,a.nLa($c.WT)||a.Ebi($c.WT)){cb=!0;break}cb||mc.ha.Qa.wG(Oc)}};a.prototype.GGi=function(){this.Gi&&this.fa.isNamedObjectViewMode&&this.$.oa&&jd.p(this.$.oa)&&(this.$.da.Aa(34).vQ?
this.$.da.Aa(34).Ejd():this.$.da.Aa(34).Nq(this.GMi))};a.prototype.hAe=function(cb){var mc=this,Oc=null;Oc=function(le){function we(){mc.yOa.shift();0<mc.yOa.length&&Oc(mc.yOa[0])}var jc=le.WebExtensionData,Zc=le.IsTaskPane,ud=le.RecordHandler;if(mc.U$(jc.PrimaryMarketplace.SolutionId))we();else{Zc&&(jc.WebExtensionOsfControlType=1);var Fd=za.a(jc);if(!Zc||jc.TaskpaneVisible||Fd||jc.SharedRuntime&&jc.SharedRuntime.State||jc.ContainsCustomFunctions){var me=new U(mc,mc.Uh,jc,!Zc);Cb.ULS.sendTraceTag(537170517,
0,50,"DdaFacade::CreateAllOsfControls: SolutionId: {0}, StoreType: {1}, UseShareRuntime: {2}",Telemetry.PrivacyRules.GetAssetId(jc.PrimaryMarketplace.MarketplaceType,jc.PrimaryMarketplace.MarketplaceRef,jc.PrimaryMarketplace.SolutionId),jc.PrimaryMarketplace.MarketplaceType,Jd.HelperMethods.Vv(jc));me.pjd();Jd.HelperMethods.Vv(jc)&&(me.rHa=a.nua(jc,mc.$),jc.TaskpaneWidth=mc.g4b);Fd&&(jc.WebExtensionToolTip="");Zc&&jc.TaskpaneVisible&&!Fd&&(jc.TaskpaneWidth=mc.g4b);Array.add(mc.Cf,me);var $e=mc.Fwa=
null;$e=vg.a.instance.XB(function(){me.Px&&(Xc.a.Fa($e),$e=null,ud&&ud(le,me),we())},100,Af.a.Y7g)}else we()}};for(var Sc={},$c=0;$c<cb.length;Sc={S0:Sc.S0},$c++)if(!this.an(cb[$c].InstanceId))if(1!==cb[$c].WebExtensionType)this.z_a(cb[$c]);else if(!$a.EwaSettings.la(53))this.ylb(cb[$c],Oc);else if(this.$.Fd&8388608||cb[$c].TaskpaneVisible)Sc.S0={},Sc.S0.marketplaceId=cb[$c].PrimaryMarketplace.SolutionId,Sc.S0.marketplaceVersion=cb[$c].PrimaryMarketplace.SolutionVersion,Sc.S0.storeType=cb[$c].PrimaryMarketplace.MarketplaceType,
Sc.S0.storeId=cb[$c].PrimaryMarketplace.MarketplaceRef,Sc.S0.targetData=cb[$c],this.Gi.isAddinCommandsAsync(Sc.S0,function(le){return function(we,jc,Zc){if(we){var ud=Zc.targetData;if(jc){if($a.EwaSettings.la(87))if(le.S0.storeType.toLowerCase()!==OSF.StoreType.OMEX.toLowerCase())we=le.S0.storeType.toLowerCase()===OSF.StoreType.UploadFileDevCatalog.toLowerCase(),jc=$a.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForPrivateCatalog")&&le.S0.storeType.toLowerCase()===OSF.StoreType.PrivateCatalog.toLowerCase(),
(we||jc)&&Jd.HelperMethods.Vv(ud)&&mc.ylb(ud,Oc);else if($a.EwaSettings.isChangeGateEnabled("OfficeVSO:4484894_FixBackgroundAppNotLoadForUploadFileCatalog"))mc.UXh(Zc,Oc);else{var Fd=!1;mc.tDd(function(me){if(!me.errorCode){if(me.value){me=yl(me.value);for(var $e=me.next();!$e.done&&!Fd;$e=me.next())Fd=se.c($e.value[1])===se.c(ud.PrimaryMarketplace.SolutionId)}Fd?Jd.HelperMethods.Vv(ud)&&mc.ylb(ud,Oc):(me={},me.SolutionId=Zc.marketplaceId,me.TargetType=ud.WebExtensionType,me.Version=Zc.marketplaceVersion,
me.StoreType=ud.PrimaryMarketplace.MarketplaceType,me.StoreId=Zc.storeId,me.AssetId=Zc.marketplaceId,me.AssetStoreId=Zc.storeId,me.Width=ud.TaskpaneWidth,ud.TaskpaneVisible=!0,me.Id=Zc.marketplaceId,me.AppVersion=Zc.marketplaceVersion,me.CurrentStoreType=ud.PrimaryMarketplace.MarketplaceType,mc.Ehe(me,ud,Oc))}},!0)}}else mc.ylb(ud,Oc)}else we=Zc.targetData,Cb.ULS.sendTraceTag(542185164,220,15,"Judging AddinCommands failed for {0} from {1} during document loading",Telemetry.PrivacyRules.GetAssetId(we.PrimaryMarketplace.MarketplaceType,
we.PrimaryMarketplace.MarketplaceRef,we.PrimaryMarketplace.SolutionId),we.PrimaryMarketplace.MarketplaceType)}}(Sc))};a.prototype.UXh=function(cb,mc){var Oc=this,Sc=!1;this.tDd(function($c){var le=cb.targetData;if(!$c.errorCode){if($c.value){$c=yl($c.value);for(var we=$c.next();!we.done&&!Sc;we=$c.next())Sc=se.c(we.value[1])===se.c(le.PrimaryMarketplace.SolutionId)}Sc?Jd.HelperMethods.Vv(le)&&Oc.ylb(le,mc):($c={},$c.SolutionId=cb.marketplaceId,$c.TargetType=le.WebExtensionType,$c.Version=cb.marketplaceVersion,
$c.StoreType=le.PrimaryMarketplace.MarketplaceType,$c.StoreId=cb.storeId,$c.AssetId=cb.marketplaceId,$c.AssetStoreId=cb.storeId,$c.Width=le.TaskpaneWidth,$c.Id=cb.marketplaceId,$c.AppVersion=cb.marketplaceVersion,$c.CurrentStoreType=le.PrimaryMarketplace.MarketplaceType,le.TaskpaneVisible=!0,Oc.Ehe($c,le,mc))}},!0)};a.prototype.ylb=function(cb,mc){var Oc={};Oc.WebExtensionData=cb;Oc.IsTaskPane=!0;this.yOa.push(Oc);1===this.yOa.length&&mc(Oc)};a.prototype.Ehe=function(cb,mc,Oc){var Sc=this,$c={};$c.ActivationInfo=
cb;$c.WebExtensionData=mc;$c.IsTaskPane=!1;$c.RecordHandler=function(le,we){var jc=le.ActivationInfo;Sc.Gi.insertBlankControlWithErrorUX(Sc.zEb(we,jc),function(){Sc.xPa(we.controlId);Sc.Gi.purgeOsfControl(we.controlId,!1);Sc.O6f(jc)})};this.yOa.push($c);1===this.yOa.length&&Oc($c)};a.prototype.O6f=function(cb){var mc={};mc.solutionId=cb.SolutionId;mc.version=cb.Version;mc.storeType=cb.StoreType;mc.storeId=cb.StoreId;mc.assetId=cb.AssetId;mc.assetStoreId=cb.AssetStoreId;mc.targetType=cb.TargetType;
mc.sharedRuntimeId=cb.SharedRuntimeId;mc.id=cb.Id;mc.currentStoreType=cb.CurrentStoreType;mc.appVersion=cb.AppVersion;cb=new eb.a;cb.add(mc);mc={};mc[Ja.a.hFa]=cb;mc[Ja.a.bJ]=3;cb=new Ac.a(Bc.a.Ezb,0,this.$.ed,0,null);this.$.Ka.Zb(cb,mc)};a.prototype.zEb=function(cb,mc){var Oc={};Oc.div=cb.Px;Oc.id=cb.controlId;Oc.solutionId=mc.SolutionId;Oc.version=mc.Version;Oc.storeId=mc.StoreId;Oc.storeType=mc.StoreType;Oc.osfControlType=OSF.OsfControlTarget.TaskPane;Oc.marketplaceID=mc.Id;Oc.marketplaceVersion=
mc.AppVersion;Oc.store=mc.StoreId;return Oc};a.prototype.sPf=function(){var cb=this;if($a.EwaSettings.isChangeGateEnabled("OfficeVSO:3935411_RemoveOsfControlsAferSilentReload")){for(var mc=[],Oc=0;Oc<this.Cf.length;Oc++){var Sc=this.Cf[Oc];Sc.osfControlType&&3!==Sc.osfControlType&&4!==Sc.osfControlType||Array.add(mc,Sc)}Oc=!1;for(Sc=0;Sc<mc.length;Sc++){var $c=mc[Sc];this.xPa($c.controlId);!Oc&&$c&&$c.cl&&(Oc=Jd.HelperMethods.Vv($c.cl))}Oc&&(mc={},mc=(mc.DynamicAddinCommandsMethodDispatchId=4,mc),
this.LJ(-1014260128,mc))}$a.EwaSettings.la(412)&&uc.TaskExtensions.Ba(Zb.GetServiceTaskFactory.Xa(this.$.da,278,279,3),function(le){le&&(le=le.result)&&(cb.$.da.Aa(278)||cb.$.da.Ha(278,le),le.G8e().tma())},this.ma,3)};a.prototype.GK=function(){var cb=this,mc=new l(this.$,this.dj,this.pQf);void 0===this.$||null===this.$?Cb.ULS.sendTraceTag(537170514,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. EwaControl is null"):$a.EwaSettings.la(260)&&Cb.ULS.sendTraceTag(537170513,0,50,"VSO#2693929: ResetStateForWorkbookReload is called. RichAPiEventRegistration is null: "+
(void 0===this.dj||null===this.dj));if(mc.$ui()){var Oc=function(){},Sc=function(we){we=Yf.a.yg(we.data);Cb.ULS.sendTraceTag(537170511,0,10,"ResetStateForWorkbookReload: Failed to recreate event registration information. Errors: {0}.",Qc.a.Uc(we))},$c=mc.RMg();mc=function(we,jc,Zc){return Of.i(cb.$.qa.ta,"ExecuteRichApiRequest",cb.SMg($c),De.b(we,Oc),De.a(jc,Sc),Zc,null,0)};var le=a.Odd($c);$a.EwaSettings.tc()?this.$.userOperationManager.tt(new Lf.a(507,0,mc,le|64)):this.$.userOperationManager.tt(new re.a(507,
0,mc,le))}};a.prototype.SMg=function(cb){var mc=this.$.qa.ta.Oa(1);mc.request=cb;return mc};a.prototype.lve=function(cb,mc){if(cb)for(var Oc=0;Oc<cb.length;Oc++)if(ue.a.equals(cb[Oc],mc,!0))return!0;return!1};a.prototype.XLg=function(cb){var mc={};mc.navigationMode=OSF.OsfNavigationMode.DefaultMode;mc.assetId=null;mc.category=null;if(!cb||3>cb.length)return mc;if(cb[0]){var Oc=parseInt(cb[0]);isNaN(parseInt(Oc))||(mc.navigationMode=Oc)}cb[1]&&(mc.assetId=cb[1]);cb[2]&&(mc.category=cb[2]);return mc};
a.prototype.g4h=function(){if($a.EwaSettings.la(61)){var cb=this.$.workbookContext.FullDocumentInfo.EmbeddingPageOrigin;if(cb&&"*"!==cb.trim()){this.hIa=OsfRuntime.Embedded.createOrReplaceEmbeddingEndpoint(new P(this),cb,this.$.workbookContext.FullDocumentInfo.EmbeddingPageSessionInfo,this.$.ig.get(2));try{this.hIa.init()}catch(mc){try{this.hIa.dispose()}catch(Oc){}this.hIa=null;Cb.ULS.sendTraceTag(537170510,0,10,"EmbeddingEnpoint failed to initialize. Error message: "+mc.message)}cb={};cb.a=this.$.ya.UserSessionId;
gc.b().Ne(39,cb)}}};a.prototype.UZf=function(cb,mc,Oc){var Sc=this,$c=a.kLg(cb[0]),le=$c.Wga,we=$c.Tha;$c.Wga=function(){le&&le();var jc=$c.OKa!==OSF.InfoType.Error?mc:null;cb.shift();cb.length?Sc.UZf(cb,jc,Oc):jc&&jc()};$c.Tha=function(){we&&we();Oc&&$c.OKa!==OSF.InfoType.Error&&Oc()};Lb.a.QOd($c)};a.prototype.uKh=function(){var cb={};cb.AddinRibbonControlsOverriddenByApi=$a.EwaSettings.isChangeGateEnabled("OfficeVSO:4373039_AddinRibbonControlsOverriddenByApi").toString();cb.AddinActionDefinitionHybridMode=
$a.EwaSettings.la(667).toString();cb.UseActionIdForUILessCommand=$a.EwaSettings.la(671).toString();cb.AllowStorageAccessByUserActivationOnIFrame=$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.AllowStorageAccessByUserActivationOnIFrame",!1).toString();cb.RequirementSetRibbonApiOnePointTwo=$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.RequirementSetRibbonApiOnePointTwo",!1).toString();cb.flightingTreatmentVariables=ya.AFrameworkApplication.ga.o8b;cb.ShortcutInfoArrayInUserPreferenceData=
$a.EwaSettings.isChangeGateEnabled("OfficeVSO:5232658_ShortcutInfoArrayInUserPreferenceData").toString();return cb};a.getSolutionId=function(cb){var mc=cb.PrimaryMarketplace.SolutionId;$a.EwaSettings.la(297)&&cb.OwnerAddinSolutionId&&(mc=cb.OwnerAddinSolutionId);return mc};a.Odd=function(cb){var mc=0;$a.EwaSettings.isChangeGateEnabled("OfficeVSO:3274277_RichApiDoesNotMakeWorkbookDirty")?cb.RequestFlags&1&&256!==(cb.RequestFlags&256)||(mc=16):mc=cb.RequestFlags&1?0:16;return mc};a.nua=function(cb,
mc){mc=a.getSolutionId(cb,mc);return a.DVe(mc,cb.PrimaryMarketplace.SolutionVersion,cb.PrimaryMarketplace.MarketplaceType,cb.PrimaryMarketplace.MarketplaceRef)};a.B4g=function(cb){var mc={};cb=(mc.recording=cb,mc);return JSON.stringify(cb)};a.W_g=function(cb){var mc={};mc.visibility=cb?"Visible":"Hidden";return JSON.stringify(mc)};a.GGh=function(cb){var mc=cb.getSolutionId(),Oc=cb.getVersion(),Sc=cb.getStoreType();cb=cb.getStoreId();return a.DVe(mc,Oc,Sc,cb)};a.DVe=function(cb,mc,Oc,Sc){return String.format("{0}|{1}|{2}|{3}|{4}|||",
"2",cb,mc,a.gSh(Oc).toString(),Sc)};a.Mfd=function(cb,mc){var Oc=cb.split("|");if(7>Oc.length)return Cb.ULS.sendTraceTag(537170509,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected customFunctionAddinId."),null;if("2"!==Oc[0])return Cb.ULS.sendTraceTag(537170508,0,10,"DdaEventDispatch.GetWebExtensionDataFromAddinId: Unexpected format='{0}'.",Oc[0]),null;var Sc=Oc[1],$c=Oc[2],le=a.hSh(Oc[3]),we=Oc[4];Oc=Oc[5];Sc&&Sc.length||(Sc=Oc);Oc={};Oc.InstanceId=String.format("{{{0}}}",lb.a.create().toString());
Oc.WebExtensionOsfControlType=4;Oc.WebExtensionType=1;Oc.PrimaryMarketplace={};Oc.PrimaryMarketplace.SolutionId=Sc;Oc.PrimaryMarketplace.SolutionVersion=$c;Oc.PrimaryMarketplace.MarketplaceRef=we;Oc.PrimaryMarketplace.MarketplaceType=le;Oc.ContainsCustomFunctions=mc?!0:!1;mc&&(Oc.OsfPropertyBag=[["customFunctionAddinId",cb]]);return Oc};a.hSh=function(cb){cb=parseInt(cb);return cb===OSF.StoreTypeEnum.MarketPlace?OSF.StoreType.OMEX:cb===OSF.StoreTypeEnum.Catalog?OSF.StoreType.SPCatalog:cb===OSF.StoreTypeEnum.SPApp?
OSF.StoreType.SPApp:cb===OSF.StoreTypeEnum.Exchange?OSF.StoreType.Exchange:cb===OSF.StoreTypeEnum.FileSystem?OSF.StoreType.FileSystem:cb===OSF.StoreTypeEnum.Registry?OSF.StoreType.Registry:cb===OSF.StoreTypeEnum.PrivateCatalog?OSF.StoreType.PrivateCatalog:cb===OSF.StoreTypeEnum.HardCodedPreinstall?OSF.StoreType.HardCodedPreinstall:cb===OSF.StoreTypeEnum.FirstParty?OSF.StoreType.FirstParty:cb===OSF.StoreTypeEnum.UploadFileDevCatalog?OSF.StoreType.UploadFileDevCatalog:cb===OSF.StoreTypeEnum.WopiCatalog?
OSF.StoreType.WopiCatalog:null};a.gSh=function(cb){return cb===OSF.StoreType.OMEX?OSF.StoreTypeEnum.MarketPlace:cb===OSF.StoreType.SPCatalog?OSF.StoreTypeEnum.Catalog:cb===OSF.StoreType.SPApp?OSF.StoreTypeEnum.SPApp:cb===OSF.StoreType.Exchange?OSF.StoreTypeEnum.Exchange:cb===OSF.StoreType.FileSystem?OSF.StoreTypeEnum.FileSystem:cb===OSF.StoreType.Registry?OSF.StoreTypeEnum.Registry:cb===OSF.StoreType.PrivateCatalog?OSF.StoreTypeEnum.PrivateCatalog:cb===OSF.StoreType.HardCodedPreinstall?OSF.StoreTypeEnum.HardCodedPreinstall:
cb===OSF.StoreType.FirstParty?OSF.StoreTypeEnum.FirstParty:cb===OSF.StoreType.UploadFileDevCatalog?OSF.StoreTypeEnum.UploadFileDevCatalog:cb===OSF.StoreType.WopiCatalog?OSF.StoreTypeEnum.WopiCatalog:-1};a.kqb=function(cb){var mc={};mc.Version=cb.appVersion;mc.AssetId=cb.assetId;mc.AssetStoreId=null!==cb.assetStoreId?cb.assetStoreId.toString():null;mc.StoreType=cb.storeType;mc.Height=cb.height;mc.SolutionId=cb.solutionId;mc.StoreId=cb.storeId;mc.TargetType=cb.targetType;mc.Width=1===mc.TargetType?
0:cb.width;mc.SharedRuntimeId=cb.sharedRuntimeId;mc.AppVersion=cb.appVersion;mc.CurrentStoreType=cb.currentStoreType;mc.Id=cb.id;return mc};a.xxb=function(cb){return cb===OSF.DDA.EventDispId.dispidSettingsChangedEvent||cb===OSF.DDA.EventDispId.dispidDocumentSelectionChangedEvent||cb===OSF.DDA.EventDispId.dispidBindingSelectionChangedEvent||cb===OSF.DDA.EventDispId.dispidBindingDataChangedEvent||cb===OSF.DDA.EventDispId.dispidRichApiMessageEvent||cb===OSF.DDA.EventDispId.dispidDialogMessageReceivedEvent||
cb===OSF.DDA.EventDispId.dispidDialogNotificationShownInAddinEvent||cb===OSF.DDA.EventDispId.dispidDialogParentMessageReceivedEvent};a.kLg=function(cb){return Object.assign(new Jc.a,{OKa:cb.infoType,id:cb.id,title:cb.title,description:cb.description,buttonText:cb.buttonTxt,Wga:cb.buttonCallback,qcc:cb.highPriority,Tha:cb.dismissCallback,errorCode:cb.errorCode,J6e:cb.iframeNotificationUrl})};a.nLa=function(cb){var mc="FA000000014"===cb;mc||(mc="907DD90F-A82F-4BBF-B4F2-FCD4868A5E14ButtonId1"===cb);
return mc};a.Ebi=function(cb){return"FA000000005"===cb};tl.Object.defineProperties(a.prototype,{jZb:{configurable:!0,enumerable:!0,get:function(){return this.vea||(this.vea=new Kb.a(this.$.Ey))}},Gi:{configurable:!0,enumerable:!0,get:function(){if(!this.Ml){var cb={},mc=!(this.$.Fd&1),Oc=cc.a.current.vK,Sc=this.$.workbookContext,$c=Eb.a.LW+Eb.a.x1b,le=0;$a.EwaSettings.la(509)&&(le|=2);cb.pageBaseUrl=Oc.LayoutsContentUrlPrefix;cb.appName=OSF.AppName.ExcelWebApp;cb.appVersion="16";cb.appSettings=this.uKh();
cb.singleSignOnSettings=Fa.AppsForOfficeSingleSignOnManager.NRh();cb.clientMode=mc?OSF.ClientMode.ReadOnly:OSF.ClientMode.ReadWrite;cb.appUILocale=this.$.ya.UICultureTag;cb.dataLocale=this.$.ya.DataCultureTag;cb.docUrl=Sc.ClientUrl;cb.hostControl=this;cb.formFactor=OSF.FormFactor.Default;cb.lcid=this.$.pI.toString();cb.localizedScriptsUrl=Eb.a.LW+Eb.a.d0c;cb.localizedImagesUrl=$c;cb.localizedStylesUrl=Eb.a.LW+Eb.a.jye;cb.localizedResourcesUrl=$c;cb.osfOmexBaseUrl=Oc.OsfOmexBaseUrl;cb.firstPartyManifestCDNUrl=
Oc.FirstPartyAddInManifestCDN;cb.sdxAssetsToPrefetchMapping=ya.AFrameworkApplication.ga.Ua("SdxAssetsToPrefetchMapping");cb.sdxCdnUrl=Oc.SdxCdnUrl;cb.sdxDmsUrl=Oc.SdxDmsUrl;cb.devCatalogUrl=Oc.DevCatalogUrl;cb.controlStatusChanged=this.wla;cb.notifyHost=this.Wwf;cb.allowExternalMarketplace=this.$.fa.ih.get(27)&&a.P0c;cb.enableAddinCommands=$a.EwaSettings.la(53);cb.enableBlackForestRedirect=$a.EwaSettings.la(88);cb.enableMyOrg=this.$.fa.ih.get(33);cb.enableMyApps=this.$.fa.ih.get(34);cb.enableDevCatalog=
$a.EwaSettings.la(45);cb.enablePrivateCatalog=this.Zoj();cb.enableTaskpaneUpgradeToAppCommand=$a.EwaSettings.la(93);cb.showSignOutFromPrivateCatalogMessage=this.$.fa.ih.get(36);cb.enableUploadFileDevCatalog=$a.EwaSettings.la(53)&&!$a.EwaSettings.la(285);cb.userNameHashCode=sa.a.lu(ya.AFrameworkApplication.userName);cb.envCode=this.$.ya.OfficeAddinTelemetryDataSourceCode.toString();cb.enableSingleSignOnForAddin=!$a.EwaSettings.la(24)&&ya.AFrameworkApplication.isAppsForOfficeSingleSignOnSupportedOnHost;
cb.enableDisplayBlockedMinorError=$a.EwaSettings.la(183);cb.hideAppsExtensionUrl=ya.AFrameworkApplication.hideAppsExtensionUrl;cb.enableAnonymousUseLegacyCatalogService=$a.EwaSettings.la(173);cb.enableInsertDialogAccessibilityFix=$a.EwaSettings.la(180);cb.disableAppsForOfficeThirdParty=$a.EwaSettings.la(186);cb.enableFirstPartySSO=$a.EwaSettings.la(198);cb.wacSessionId=this.$.ya.UserSessionId;cb.disableLogging=!this.$.ya.AriaLoggingIsEnabled;cb.enableFirstPartySDXErrorMessages=$a.EwaSettings.la(211);
cb.enableRichApiCellEditDelay=$a.EwaSettings.la(190);cb.isHostDocumentDomain=$a.EwaSettings.la(227);cb.loggableUserId=ya.AFrameworkApplication.ga.Ua("LoggableUserId");cb.sessionStartInfoJson=ya.AFrameworkApplication.ga.Ua("SessionStartInfoJson");cb.wopiHostOriginFromPostMessage=ya.AFrameworkApplication.wopiHostOriginFromPostMessage;cb.wopiHostOriginFromWacPropBag=ya.AFrameworkApplication.ga.Ua("PostMessageOrigin");cb.wacIsEmbedded=ya.AFrameworkApplication.ga.ra("IsEmbedded");cb.accessibilityAllowFocusAddinTaskpane=
ya.AFrameworkApplication.ga.ra("AccessibilityAllowFocusAddinTaskpane");cb.enableRemoveAppCommandsAddin=ya.AFrameworkApplication.ga.ra("RemoveAppCommandsAddinIsEnabled");cb.isHostFrameTrustCheckEnabledForAddIns=ya.AFrameworkApplication.ga.ra("HostFrameTrustCheckIsEnabledForAddIns");cb.isHostFrameTrusted=ya.AFrameworkApplication.isHostFrameTrusted;cb.agaveAddinUploadEnabled=$a.EwaSettings.la(47);cb.hostAllowedOfficeStore=ya.AFrameworkApplication.ga.ra("HostAllowedOfficeStore");cb.hostAllowedSdxEmbedding=
ya.AFrameworkApplication.ga.ra("HostAllowedSdxEmbedding");cb.hostInstallAddIns=ya.AFrameworkApplication.ga.Ua("HostInstallAddIns");cb.hostInstallAddInsIsEnabled=ya.AFrameworkApplication.ga.ra("HostInstallAddInsIsEnabled");cb.approvedAddIns=ya.AFrameworkApplication.ga.Ua("ApprovedAddIns");cb.addinEnforceHttpsIsEnabled=this.hoj(cb.sessionStartInfoJson);cb.hostFeatureGateFlag=le;cb.isUpnCheckEnabled=ya.AFrameworkApplication.ga.ra("IsUpnCheckEnabled");cb.wacUpn=ya.AFrameworkApplication.ga.Ua("UserPrincipalName");
cb.isReactRibbonEnabled=Ic.a.isReactRibbonEnabled();cb.enableSetFocusOnTaskpaneOnUserAction=$a.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.SetFocusOnTaskpaneOnUserActionIsEnabled",!1);cb.isSafariWithIndexedDBDisabled=$a.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&Gb.a.N5a;cb.isIndexedDBDisabled=$a.EwaSettings.isChangeGateEnabled("OfficeVSO:5280064_IDBBuggedInSafari")&&Gb.a.N5a||$a.EwaSettings.isChangeGateEnabled("OfficeVSO:5735286_IDBBuggedInFirefox")&&
Gb.a.zf;cb.enableCustomShortcuts=$a.EwaSettings.isChangeGateEnabled("OfficeVSO:5325526_EnableCustomShortcuts");cb.changeGetModifierKeyStringOutputOrder=$a.EwaSettings.isChangeGateEnabled("OfficeVSO:5426302_ChangeGetModifierKeyStringOutputOrder");this.Ml=new OSF.ContextActivationManager(cb);cb={};this.Ml.setIframeAttributeBag((cb.frameborder=0,cb.marginheight=0,cb.marginwidth=0,cb));this.Ml.setWSA(ya.AFrameworkApplication.Pm);this.Ml&&"undefined"!==typeof this.Ml.hostCheckReadyHandler&&ya.AFrameworkApplication.OAg(Object(Sb.a)(this.Ml,
this.Ml.hostCheckReadyHandler,"hostCheckReadyHandler"));try{var we=Hc.a.instance.resolve("Common.App.OAuth.IOAuthManager");this.Ml.setOAuthManager(we)}catch(jc){}}return this.Ml}},YOj:{configurable:!0,enumerable:!0,get:function(){return this.ZQc}},dj:{configurable:!0,enumerable:!0,get:function(){return this.Hce}},qma:{configurable:!0,enumerable:!0,get:function(){return this.Ece}},nJd:{configurable:!0,enumerable:!0,get:function(){return this.Ice}},mJd:{configurable:!0,enumerable:!0,get:function(){return this.Gce}},
Naj:{configurable:!0,enumerable:!0,get:function(){return this.Kce}},Laj:{configurable:!0,enumerable:!0,get:function(){return this.Fce}},Maj:{configurable:!0,enumerable:!0,get:function(){return this.Jce}},Oaj:{configurable:!0,enumerable:!0,get:function(){return this.Lce}},Paj:{configurable:!0,enumerable:!0,get:function(){return this.Mce}},oJd:{configurable:!0,enumerable:!0,get:function(){return this.Nce}},eV:{configurable:!0,enumerable:!0,get:function(){return this.amg}},$:{configurable:!0,enumerable:!0,
get:function(){return this.vb}}});tl.Object.defineProperties(a,{P0c:{configurable:!0,enumerable:!0,get:function(){return a.q1d},set:function(cb){a.q1d=cb}}});a.S_a=new Yb.a;a.q1d=!0;Object(ob.a)(a,"DdaFacade",tb.a,[230,816,791,817,818,3])},868:function(y,D,b){function a(){this.HFd=0;this.lW={};this.nsa={}}b.d(D,"a",function(){return a});y=b(0);var d=b(13),c=b(110);a.prototype.NNh=function(k,n){return this.lW[a.VWc(k,n)]};a.prototype.kIe=function(k,n){n||void 0!==this.nsa[k]&&null!==this.nsa[k]?n&&
void 0!==this.nsa[k]&&null!==this.nsa[k]&&delete this.nsa[k]:this.nsa[k]=1};a.prototype.cZb=function(k){return void 0===this.nsa[k]||null===this.nsa[k]};a.prototype.YWh=function(k){var n=a.VWc(k.messageType,k.targetId);1===k.actionType?this.qYh(k.controlId,k.messageType,n):2===k.actionType&&this.aZh(k.controlId,k.messageType,n)};a.prototype.K2i=function(k){if(k){var n=Object.keys(this.lW);if(!(void 0===n||null===n||0>=n.length)){n=yl(n);for(var l=n.next();!l.done;l=n.next()){l=l.value;var f=this.lW[l];
f[k]&&(delete f[k],Object.keys(f).length||delete this.lW[l])}}}};a.prototype.CZ=function(k,n){k=a.VWc(k,n);k=this.lW[k];return!!k&&0<Object.keys(k).length};a.prototype.UZh=function(){return!c.a.isEmpty(this.lW)};a.prototype.kef=function(){return 0<this.HFd};a.prototype.oIh=function(){var k=[],n=this.lW,l;for(l in n){var f=l,u=n[l],v;for(v in u){u=v;var m={};m.eventType=parseInt(f.split("#")[0]);m.targetId=f.split("#")[1];m.addinId=u;k.push(m)}}return k};a.prototype.qYh=function(k,n,l){if(this.lW[l])l=
this.lW[l],l[k]=l[k]?l[k]+1:1;else{var f={};f[k]=1;this.lW[l]=f}100===n&&this.HFd++};a.prototype.aZh=function(k,n,l){if(this.lW[l]){var f=this.lW[l];if(k){var u=f[k];1===u?(delete f[k],Object.keys(f).length||delete this.lW[l]):f[k]=u-1;100===n&&this.HFd--}else d.ULS.sendTraceTag(537170459,0,50,"The OsfControl[{0}] doesn't register event with key[{1}].",k,l)}else d.ULS.sendTraceTag(537170460,0,50,"The event with key[{0}] that will be unregistered doesn't exist.",l)};a.VWc=function(k,n){return String.format("{0}#{1}",
k,n)};a.vW="Workbook";Object(y.a)(a,"RichApiEventRegistration",null,[])},895:function(y,D,b){function a(d,c,k,n){this.ddaBinding=null;this.dispid=0;this.ArrayData=this.controlId=null;this.dispid=d;this.controlId=c;this.ddaBinding=k;this.ArrayData=void 0===n?null:n}b.d(D,"a",function(){return a});y=b(0);a.prototype.getDispid=function(){return this.dispid};a.prototype.getDdaBinding=function(){return this.ddaBinding};Object(y.a)(a,"DdaEventArgs",null,[])},942:function(y,D,b){function a(c,k,n){this.yOb=
c;this.Yfg=k;this.Zfg=n}function d(){this.title=this.id=this.tabs=null}y=b(0);Object(y.a)(d,"AddInDataTransferObject",null,[]);b.d(D,"a",function(){return a});a.htb=function(c){return(c=c.pK)?Object.assign(new d,{tabs:c.fq.toArray(),id:c.Qwg,title:c.Rwg}):null};tl.Object.defineProperties(a.prototype,{fq:{configurable:!0,enumerable:!0,get:function(){return this.yOb}},Qwg:{configurable:!0,enumerable:!0,get:function(){return this.Yfg}},Rwg:{configurable:!0,enumerable:!0,get:function(){return this.Zfg}}});
Object(y.a)(a,"OneLineRibbonExtensibility",null,[])},950:function(y,D,b){function a(){var c={};this.z8c=(c.tabhome="Ribbon.Home",c.tabinsert="Ribbon.Insert",c.tabdata="Ribbon.Data",c.tabreview="Ribbon.Review",c.tabview="Ribbon.View",c);c={};this.x8c=(c.tabpagelayoutexcel=["Ribbon.PageLayoutExcel",d.a.instance.ea(1581),d.a.instance.ea(1585)],c.tabformulas=["Ribbon.Formulas",d.a.instance.ea(1582),d.a.instance.ea(1586)],c.tabdeveloper=["Ribbon.Developer",d.a.instance.ea(1583),d.a.instance.ea(1587)],
c.tabaddins=["Ribbon.AddIns",d.a.instance.ea(1584),d.a.instance.ea(1588)],c);this.Hrh="Ribbon.Home Ribbon.Insert Ribbon.PageLayoutExcel Ribbon.Formulas Ribbon.Data Ribbon.Review Ribbon.View Ribbon.Developer Ribbon.AddIns".split(" ");this.j1a=null}b.d(D,"a",function(){return a});y=b(0);var d=b(14);a.prototype.qMh=function(){if(this.j1a)return this.j1a;this.j1a={};for(var c=yl(Object.keys(this.z8c)),k=c.next();!k.done;k=c.next())k=k.value,this.j1a[k]=this.z8c[k];c=yl(Object.keys(this.x8c));for(k=c.next();!k.done;k=
c.next())k=k.value,this.j1a[k]=this.x8c[k][0];return this.j1a};tl.Object.defineProperties(a.prototype,{Bha:{configurable:!0,enumerable:!0,get:function(){return"SourceControlId"}},xx:{configurable:!0,enumerable:!0,get:function(){return"Workbook"}},formFactor:{configurable:!0,enumerable:!0,get:function(){return"DesktopFormFactor"}},uxc:{configurable:!0,enumerable:!0,get:function(){return this.z8c}},d9a:{configurable:!0,enumerable:!0,get:function(){return this.Hrh}},fti:{configurable:!0,enumerable:!0,
get:function(){return this.x8c}}});Object(y.a)(a,"AddinCommandsStringProvider",null,[854])},989:function(y,D,b){function a(P,ia){this.yCc=new m.a;this.Ml=P;this.mtg=ia}function d(P,ia,W,R){this.GS=new u.a;this.UF=new u.a;this.Ioa=null;this.Tjb=new u.a;this.e8d=Promise.resolve(null);this.wee=!1;this.bUb=ia;this.Fig=P;this.Yee=W;this.bgg=R}function c(){var P=k.call(this)||this;P.errorCode=0;return P}function k(){this.ePb=new u.a;this.r9=this.q9=!1;this.Fna=this.authChallenge=null;this.startTime=this.retryCount=
0;this.fme=null}function n(){this.token=null;this.expiresOn=0;this.Iga=this.authChallenge=null}function l(){this.accessToken=null}function f(){this.startTime=0;this.callback=null}b.r(D);y=b(0);var u=b(185),v=b(13),m=b(101);Object(y.a)(f,"SSOCallbackInfo",null,[]);Object(y.a)(l,"AccessTokenInformation",null,[123]);var A=b(1121);Object(y.a)(n,"CachedTokenInfo",null,[]);tl.Object.defineProperties(k.prototype,{callbacks:{configurable:!0,enumerable:!0,get:function(){return this.ePb}}});Object(y.a)(k,"SSORequestInfo",
null,[]);vm(c,k);Object(y.a)(c,"SSOFailedRequestInfo",k,[]);var x=b(5);d.prototype.aqj=function(P){if(this.Ioa&&this.Ioa.authChallenge===P.authChallenge){if(Date.now()/1E3+d.jri>this.Ioa.expiresOn)return this.Ioa=null,!1;P=new A.a;P.token=this.Ioa.token;P.expiresOn=this.Ioa.expiresOn;P.Iga=this.Ioa.Iga;P.mSa=!0;P.Tub=0;this.kvb(P);return!0}return!1};d.prototype.Foj=function(P){for(var ia=0;ia<this.UF.count;ia++)if(this.UF.na(ia).authChallenge===P.authChallenge&&this.UF.na(ia).Fna===P.Fna){var W=void 0;
(W=this.UF.na(ia)).retryCount=W.retryCount+1;P.retryCount=this.UF.na(ia).retryCount;if(this.UF.na(ia).retryCount<d.Hri||!this.UF.na(ia).q9&&P.q9||!this.UF.na(ia).r9&&P.r9){if(!this.UF.na(ia).q9&&P.q9||!this.UF.na(ia).r9&&P.r9)P.retryCount=0;this.UF.removeAt(ia);break}P=new A.a;P.errorCode=this.UF.na(ia).errorCode;this.kvb(P);return!0}return!1};d.prototype.Eyg=function(P,ia){for(var W=0;W<this.UF.count;W++)if(this.UF.na(W).Fna===P.Fna&&this.UF.na(W).authChallenge===P.authChallenge)return;this.UF.add(Object.assign(new c,
{q9:P.q9,r9:P.r9,authChallenge:P.authChallenge,Fna:P.Fna,errorCode:ia,retryCount:P.retryCount}))};d.prototype.Qad=function(P,ia,W,R,I,Q){var O=this,ba=b(989).AppsForOfficeSingleSignOnManager;""===W&&(W=null);if(this.wee)ba.m5(Q,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null);else{for(var ca=null,S=yl(this.GS),Y=S.next();!Y.done;Y=S.next())if(Y=Y.value,Y.q9===P&&Y.r9===ia&&Y.authChallenge===W&&Y.Fna===I){ca=Y;break}ca||(ca=Object.assign(new k,{q9:P,r9:ia,authChallenge:W,fme:R,Fna:I,
retryCount:0,startTime:ba.Sv()}),this.GS.add(ca));ca.retryCount=0;ca.callbacks.add(Q);this.e8d=this.e8d.then(function(){var na=b(989).AppsForOfficeSingleSignOnManager;if(0<O.GS.count){var Z=O.GS.na(0);if(O.aqj(Z)||O.Foj(Z))return null;for(var wa=0;wa<O.Tjb.count;)O.Tjb.na(wa)+d.vBj<na.Sv()?O.Tjb.removeAt(wa):wa++;if(O.Tjb.count>=d.Cri||O.GS.count>=d.gri)return Z=new A.a,Z.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOCallThrottled,O.kvb(Z),null;var ma=null;x.AFrameworkApplication.sa&&(na=x.AFrameworkApplication.sa.fD)&&
(ma=na.Fc("ComponentAttach",O.Fig+d.isg));return Z.Fna.Iug(O.resource,Z.q9,Z.r9,Z.authChallenge,O.bgg,Z.fme).then(function(pa){ma&&ma.stop();O.kvb(pa)},function(){ma&&ma.stop();var pa=new A.a;pa.errorCode=OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError;O.kvb(pa)})}return null})}};d.prototype.kvb=function(P){var ia=b(989).AppsForOfficeSingleSignOnManager;try{if(this.GS.count){var W=this.GS.na(0);this.GS.removeAt(0);var R=null;P.errorCode||(R=new l,R.accessToken=P.token);P.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl&&
P.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidGrant&&P.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError&&P.errorCode!==OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOServerError||this.Eyg(W,P.errorCode);var I={};null!=P.Tub&&(I.getTokenSilentTime=P.Tub.toString());null!=P.rfd&&(I.getTokenPopupTime=P.rfd.toString());null!=P.Zcd&&(I.getIDTokenTime=P.Zcd.toString());null!=P.mSa&&(I.tokenCached=P.mSa.toString());P.ySd&&(I.detailedError=P.ySd);P.Iga&&(I.authLibrary=P.Iga);
W.retryCount&&(I.retryCount=W.retryCount);for(var Q=yl(W.callbacks),O=Q.next();!O.done;O=Q.next())ia.m5(O.value,P.errorCode,R,I);null!=P.mSa&&P.mSa||this.Tjb.add(W.startTime);if(!P.errorCode)for(null!=P.expiresOn&&(this.Ioa=Object.assign(new n,{token:P.token,expiresOn:P.expiresOn,authChallenge:W.authChallenge,Iga:P.Iga})),this.UF.clear(),Q=0;Q<this.GS.count;)if(this.GS.na(Q).authChallenge===W.authChallenge){var ba=yl(this.GS.na(Q).callbacks);for(O=ba.next();!O.done;O=ba.next())ia.m5(O.value,P.errorCode,
R,I);this.GS.removeAt(Q)}else Q++}}catch(ca){v.ULS.sendTraceTag(21628945,344,10,"ReceivedAccessTokenHandler: exception message: {0}",ca.message)}};d.prototype.shutdown=function(){this.wee=!0;this.GS.clear()};tl.Object.defineProperties(d.prototype,{resource:{configurable:!0,enumerable:!0,get:function(){return this.bUb}}});d.vBj=6E4;d.Cri=6;d.gri=6;d.Hri=3;d.jri=300;d.isg="GetAccessToken";Object(y.a)(d,"SSOCallbackManager",null,[]);var t=b(846),z=b(857),r=b(116),G=b(77),w=b(23),B=b(28),U=b(143),N=b(338);
b.d(D,"AppsForOfficeSingleSignOnManager",function(){return a});a.prototype.Rad=function(P,ia,W,R,I,Q,O,ba,ca,S){S=Object.assign(new f,{startTime:a.Sv(),callback:S});try{var Y=!!W&&""!==W,na=S.startTime,Z=this.getOsfControl(P),wa=Z.getStoreType()||"",ma=Z.getOwnerAddinStoreType()||"";if(x.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)){var pa=Z.getSolutionId()||"";var Ia=Z.getVersion()||""}else pa=Z.getMarketplaceID()||"",Ia=Z.getMarketplaceVersion()||
"";wa=wa.toLowerCase();ma=ma.toLowerCase();pa=pa.toLowerCase();var Ma=G.a.Ycd(ia)||"",ob=G.a.Ycd(Z.getIframeUrl())||"",Cb=Ma.toLowerCase()===ob.toLowerCase();Ma=wa;"inmemory"===wa&&(Ma=ma);var Xa=x.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.OSFSolutionIdRefactor",!1)?Telemetry.PrivacyRules.GetAssetId(Ma,Z.getStoreId(),pa):Telemetry.PrivacyRules.GetAssetId(Ma,Z.getStoreLocator(),pa);Z={};var Sb=(Z.callInstanceId=na.toString(),Z.controlAssetId=Xa,Z.controlVersion=
Ia,Z.storeType=wa,Z.ownerStoreType=ma,Z.allowConsentPrompt=R.toString(),Z.forMSGraphAccess=I.toString(),Z.allowSignInPrompt=Q.toString(),Z.hasAddinAuthChallenge=Y.toString(),Z.securityOriginEqualsSourceLocation=Cb.toString(),Z.singleSignOnEnabled=O.toString(),Z.accountTypeFilter=ba||"",Z);v.ULS.sendTraceTag(51401115,344,50,"{0}",Sb);U.a.sendTelemetryEvent(Object.assign(new N.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2Start",dataFields:r.a.Fk(Sb)}));na=!0;var Tb=x.AFrameworkApplication.ga.Ua("HostAuthType");
switch(ba){case "aad":na="aad"===Tb;break;case "msa":na="msa"===Tb;break;default:na=!ba||"noFilter"===ba}if(na){ba=null;if(O)for(var da=yl(this.mtg),ya=da.next();!ya.done;ya=da.next()){var hb=ya.value;if(hb.dai(pa)){ba=hb;break}}ba?this.isSSOAddin(P)?(O=!0,"omex"===Ma&&(O=!1),"spapp"===Ma||"spcatalog"===Ma?(v.ULS.sendTraceTag(594043737,344,10,"GetAccessToken: SharePoint catalog add-ins not supported."),a.m5(S,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):I&&!O?(v.ULS.sendTraceTag(51234570,
344,10,"GetAccessToken: Store add-ins do not support tokens for graph access."),a.m5(S,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)):(I&&"exchange"===Ma&&(R=!1),this.Qad(P,ia,W,Ma,R,Q,ca,ba,S))):(v.ULS.sendTraceTag(22402395,344,10,"GetAccessToken: current Addin is not a SSO Addin."),a.m5(S,OSF.DDA.ErrorCodeManager.errorCodes.ooeNotSSOAgave,null,null)):a.m5(S,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedPlatform,null,null)}else a.m5(S,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOUnsupportedUserIdentity,
null,null)}catch(Gb){this.kic(),v.ULS.sendTraceTag(22402397,344,10,"GetAccessToken: action failed. Exception message: {0}",Gb.message),a.m5(S,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOClientError,null,null)}};a.prototype.getAccessToken=function(P,ia,W,R){this.Rad(P,W[t.a.STc]||null,W[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AuthChallenge]||null,W[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowConsentPrompt]||!1,W[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.ForMSGraphAccess]||
!1,W[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AllowSignInPrompt]||!1,ia,W[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AccountTypeFilter]||null,W[OSF.DDA.Marshaling.SingleSignOn.GetAccessTokenKeys.AddinTrustId]||null,R)};a.prototype.Qad=function(P,ia,W,R,I,Q,O,ba,ca){this.yCc.wb(P)?R=this.yCc.na(P):(R=new d(P,this.getWebApplicationResource(P).split(",")[0],R,this.getDefaultDisplayName(P)),this.yCc.add(P,R));var S=R.resource;P=a.hQh(S,this.getWebApplicationId(P));var Y=OfficeExt.WACUtils.getHostSecure(ia);
P&&Y?P.toLowerCase()===Y.toLowerCase()?R.Qad(I,Q,W,O,ba,ca):(a.WMa('SSO Resource "'+S+'" cannot be used from "'+ia+'" origin due to domain mismatch.'),v.ULS.sendTraceTag(22402396,344,10,"GetAccessToken: current Addin's host does not match its Web Application's resource."),a.m5(ca,OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null)):(P||v.ULS.sendTraceTag(594118746,344,10,"Invalid resource URL for SSO."),Y||v.ULS.sendTraceTag(594118745,344,10,"Invalid page URL for SSO."),a.m5(ca,
OSF.DDA.ErrorCodeManager.errorCodes.ooeSSOInvalidResourceUrl,null,null))};a.prototype.kic=function(){var P={};v.ULS.sendTraceTag(39068820,344,50,"Browser information: {0}",(P.UserAgent=window.navigator.userAgent,P))};a.prototype.getOsfControl=function(P){return this.Ml.getOsfControl(P)};a.prototype.isSSOAddin=function(P){return this.getOsfControl(P).getManifest().isSSOAddin()};a.prototype.getWebApplicationId=function(P){return this.getOsfControl(P).getManifest().getWebApplicationId()};a.prototype.getWebApplicationResource=
function(P){return this.getOsfControl(P).getManifest().getWebApplicationResource()};a.prototype.getDefaultDisplayName=function(P){return this.getOsfControl(P).getManifest().getDefaultDisplayName()};a.NRh=function(){try{var P={};w.a.qka&&z.a.$vb&&(P.UiHostSupportsAuthTokenAddinList=a.XQe);P.UiHostSupportsAuthToken=z.a.$vb;return P}catch(ia){v.ULS.sendTraceTag(561860814,344,10,"GetSingleSignOnRuntimeSettings: exception message: {0}",ia.message)}return null};a.getInstance=function(P,ia,W){W=void 0===
W?null:W;a.Na||(ia=new u.a,W&&ia.add(W.Opi),a.Na=new a(P,ia));return a.Na};a.WMa=function(P){window.console.warn&&window.console.warn(P)};a.hQh=function(P,ia){if(!P)return"";ia||(ia="");var W=P.toLowerCase(),R=ia.toLowerCase();RegExp("^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$").test(R)||(a.WMa('SSO App Id "'+ia+'" is not a valid format. It will be rejected from store submission.'),v.ULS.sendTraceTag(590962907,344,10,"App id does not match a GUID."));W.endsWith(R)||(a.WMa('SSO Resource "'+
P+'" does not end with App Id "'+ia+'". It will be rejected from store submission.'),v.ULS.sendTraceTag(590962908,344,10,"Resource does not end with app id."));if(!W.startsWith("https://")&&!W.startsWith("api://"))return a.WMa('SSO Resource "'+P+'" must be https:// or api:// protocol.'),v.ULS.sendTraceTag(590962909,344,10,"Resource not using https or api protocol."),"";for(ia=0;ia<P.length;ia++){R=P.charAt(ia);var I=B.a.charCodeAt(P,ia);if(33>I||126<I||"&"===R||"?"===R||"#"===R||"%"===R||"\\"===R)return a.WMa('SSO Resource "'+
P+'" contains an invalid character "'+R+'".'),v.ULS.sendTraceTag(590962910,344,10,"Invalid character '"+R+"' in resource URI."),""}if(0<=P.indexOf("::"))return a.WMa('SSO Resource "'+P+'" contains an invalid string "::".'),v.ULS.sendTraceTag(590962911,344,10,":: in resource URI."),"";if(120<P.length)return a.WMa('SSO Resource "'+P+'" is '+P.length+" characters and exceeds the max length of 120 characters."),v.ULS.sendTraceTag(590962912,344,10,"Length of resource: "+P.length+"."),"";W.startsWith("api://")&&
(W="https://"+W.substring(6,W.length));return 8===W.length?"":OfficeExt.WACUtils.getHostSecure(W)||""};a.m5=function(P,ia,W,R){var I=P.startTime,Q=0;0<I&&(Q=a.Sv()-I);var O={};I=(O.callInstanceId=I.toString(),O.callDuration=Q.toString(),O.errorCode=ia.toString(),O);if(R)for(var ba in R)I[ba]=R[ba];v.ULS.sendTraceTag(51401116,344,50,"{0}",I);U.a.sendTelemetryEvent(Object.assign(new N.a,{name:"Office.Online.Extensibility.SSO.GetAccessTokenV2End",dataFields:r.a.Fk(I)}));P.callback(ia,W)};a.Sv=function(){try{if(window.performance&&
window.performance.now)return window.performance.now()}catch(P){}return Date.now()};a.XQe="wa200000047 wa104381973 42de5e8d-cfa0-459d-813d-cf777d47ada0 97d94c7b-54e5-4098-8dbb-b486b6c1f049 wa104381526 d98404ac-f9e2-4292-8cb6-eec349559ae5".split(" ");a.Na=null;Object(y.a)(a,"AppsForOfficeSingleSignOnManager",null,[35])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.agave.js.map/04df65f89d1b418b5b2d8087b3d9cd8c/EwaDS.agave.js.map