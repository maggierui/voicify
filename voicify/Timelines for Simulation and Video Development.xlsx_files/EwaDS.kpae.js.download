(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[7],{1046:function(y,D,b){function a(f,u){var v=l.call(this,u.textBox.domElement)||this;v.IVc=null;v.czi=function(){v.Uwd()};v.ktf=function(m,A){v.Rh(m,A)};v.ptf=function(m,A){v.Mj(m,A)};v.vb=f;v.yI=u;u.eP&&(u.eP.add(v),u.wm(v.ptf),u.hq(v.ktf));return v}b.d(D,"a",function(){return a});y=b(0);var d=b(88);D=b(83);var c=b(44),k=b(42),n=b(69),l=D.a;vm(a,l);a.prototype.dispose=function(){var f=this.yI;if(null===f||void 0===f?0:f.eP)f.eP.remove(this),
f.im(this.ptf),f.Rp(this.ktf);d.a.Fa(this.IVc);this.yI=null;l.prototype.dispose.call(this)};a.prototype.ki=function(f,u){switch(u){case -1470715894:case -1231471547:this.OT(!1);break;default:if(this.jDd(f,u))return n.g(f),!0;a.Pci(u)||this.OT(!1)}return!1};a.prototype.OT=function(){d.a.Fa(this.IVc);this.IVc=c.a.instance.create(this.czi,10,k.a.Lki)};a.prototype.Mj=function(){this.OT(!1)};a.Pci=function(f){switch(f){case 137938150:case -798660877:case 742457698:case 2091832999:return!0}return!1};tl.Object.defineProperties(a.prototype,
{$:{configurable:!0,enumerable:!0,get:function(){return this.vb}},qb:{configurable:!0,enumerable:!0,get:function(){return this.yI}}});Object(y.a)(a,"ListAutoCompleteBehavior",D.a,[632,3])},1189:function(y,D,b){function a(v){var m=u.call(this,document.createElement("div"))||this;m.KHa=!1;m.LHa=!1;m.JHa=!1;m.HHa=!1;m.IHa=!1;m.LQ=!1;m.yI=null;m.xlc=function(A,x){m.Ns(A,x)};m.JKa=function(){m.qb.textBox.QJ=!0};m.Zxa=function(){m.wy(!0)};m.Pqf=function(){m.qb.textBox.focus()};m.Gh=function(){l.g(m.$).inRangePicker||
(m.isListVisible=!1)};m.$=v;l.g(v)&&l.g(v).ha&&l.g(m.$).ha.fG(m.Gh);m.Naa=c.a.AM(v)&&k.EwaSettings.isChangeGateEnabled("OfficeVSO:5609548_AddAutocompleteCardInteractionTelemetry");return m}b.d(D,"a",function(){return a});y=b(0);D=b(232);var d=b(4),c=b(41),k=b(1),n=b(8),l=b(20),f=b(34),u=D.a;vm(a,u);a.prototype.Ns=function(){this.XAa(!1);this.mt.Ns()};a.prototype.dispose=function(){this.$&&l.g(this.$)&&l.g(this.$).ha&&l.g(this.$).ha.vN(this.Gh);this.$=null;u.prototype.dispose.call(this)};a.prototype.ki=
function(v,m,A){v=!1;if((this.qqb||(void 0===A?0:A))&&!this.JLa()&&this.get_visible()&&this.isListVisible)switch(this.Naa&&this.nzc(m),m){case 1872288872:this.isListVisible=!1;v=!0;break;case -798660877:this.mt.MA(1);v=!0;break;case 137938150:this.mt.MA(-1);v=!0;break;case 2091832999:this.mt.MA(this.xH-1);v=!0;break;case 742457698:this.mt.MA(-(this.xH-1));v=!0;break;case 125627505:v=this.wy(!1);break;case 267796030:k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnterAutoCompletesSimpleSuggestions",
!1)&&(v=this.wy(!1))}return v};a.prototype.XAa=function(v){if(this.isListVisible||v){var m=l.g(this.$);v=m.domElement;var A=this.yI.textBox.domElement,x=f.a(this.$).Fi(A.offsetHeight),t=f.a(this.$).Fi(A.offsetTop),z=f.a(this.$).Fi(A.offsetWidth);A=f.a(this.$).Fi(A.offsetLeft);m=m.xj;var r=$get(this.$.Ib+d.a.MZa,this.$.domElement),G=new Sys.UI.Point(m?this.mt.O8b:0,m?this.yyh:a.iWh);x=r.offsetTop+G.y+(c.a.GM(this.$)&&m?0:x+t);this.$.J4||(t=$get(d.a.xFa,this.$.domElement),x+=t?t.offsetHeight:0);t=this.domElement;
t.style.top=n.HelperMethods.Qb(x);A=r.offsetLeft+A+G.x;!c.a.GM(this.$)&&this.$.isChromeRtl?t.style.right=n.HelperMethods.Qb(m?this.mt.O8b:v.offsetLeft+v.offsetWidth-A-z):t.style.left=n.HelperMethods.Qb(A)}};a.prototype.QRa=function(v){this.mt&&(v&&!this.LQ?(this.mt.k9(this.Pqf),this.mt.IXb(this.JKa),this.mt.tmb(this.Zxa),this.LQ=!0):this.LQ&&(this.mt.Kca(this.Pqf),this.mt.Hqc(this.JKa),this.mt.qGb(this.Zxa),this.LQ=!1))};a.prototype.nzc=function(v){switch(v){case -798660877:case 137938150:case 2091832999:case 742457698:this.KHa=
!0;break;case 125627505:this.JHa=!0;break;case 267796030:k.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnterAutoCompletesSimpleSuggestions",!1)&&(this.HHa=!0)}};tl.Object.defineProperties(a.prototype,{xH:{configurable:!0,enumerable:!0,get:function(){return this.mt.xH}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return this.mt.isListVisible},set:function(v){this.mt.isListVisible=v}},qb:{configurable:!0,enumerable:!0,get:function(){return this.yI},set:function(v){(this.yI=
v)&&this.yI.fNb.add(this)}},yyh:{configurable:!0,enumerable:!0,get:function(){return c.a.GM(this.$)?-5:-40}}});a.O8b=0;a.iWh=1;Object(y.a)(a,"AutoCompleteControl",D.a,[565])},1190:function(y,D,b){function a(c,k,n,l){k=void 0===k?0:k;n=void 0===n?"":n;l=void 0===l?"":l;var f=d.call(this)||this;f.length=c;f.selectedIndex=k;f.XH=n;f.description=l;return f}b.d(D,"a",function(){return a});y=b(0);var d=Sys.EventArgs;vm(a,d);Object(y.a)(a,"ListEventArgs",Sys.EventArgs,[])},1191:function(y,D,b){function a(z,
r){z=t.call(this,z,r,new x.a(k.a.listItem,k.a.Pzb,k.a.Szb,k.a.Tzb))||this;z.lbc=!1;z.Kr=null;z.pkb=null;z.lSe=!1;z.oAa(!0);z.lSe=v.EwaSettings.isChangeGateEnabled("OfficeVSO:5893822_FixFormulaBarXOffsetCrash");return z}b.d(D,"a",function(){return a});y=b(0);var d=b(13),c=b(23);D=b(978);var k=b(929),n=b(4),l=b(78),f=b(41),u=b(11),v=b(1),m=b(118),A=b(20),x=b(1045),t=D.a;vm(a,t);a.prototype.qxa=function(){var z=460,r=A.g(this.$),G=r.domElement,w=this.nSa.style,B=this.dg.offsetTop+this.Nk.offsetHeight*
this.Nk.sectionRowIndex-this.dg.scrollTop;w.width="auto";w.whiteSpace="nowrap";w.position=c.a.dfc?"relative":"absolute";var U=G.offsetLeft+G.offsetWidth-(this.domElement.offsetLeft+this.dg.offsetLeft+this.dg.offsetWidth+3);G=this.domElement.offsetLeft-3-(G.offsetLeft+this.O8b);z=Math.min(this.nSa.offsetWidth,z,Math.max(U,G));u.DOMElementExtensions.Gq(this.nSa,z);w.whiteSpace="";w.position="absolute";B+3>this.dg.offsetTop+this.dg.offsetHeight||B<this.dg.offsetTop||(z=this.dg.offsetLeft-3-this.nSa.offsetWidth,
w=this.dg.offsetLeft+this.dg.offsetWidth+3,u.DOMElementExtensions.updatePosition(this.nSa,G>U!==r.rtl?z:w,B,!1))};a.prototype.MA=function(z){t.prototype.MA.call(this,z);this.qxa()};a.prototype.Ns=function(){this.qxa()};a.prototype.hra=function(){var z=this.An,r=this.dg,G=3===l.a.Wb||c.a.Pr,w=G?this.BAb:this.xH;this.isListVisible=!0;r.style.height="auto";this.JFa.set_visible(!0);this.Ylb(z,G);this.Kr.length>w?(u.DOMElementExtensions.HF(r,Math.floor(r.offsetHeight*w/this.Kr.length)),r.style.overflowY=
"auto"):(r.style.height="auto",r.style.overflowY="hidden");u.DOMElementExtensions.Gq(r,z.offsetWidth+(this.Kr.length>w?m.a.Sp:0))};tl.Object.defineProperties(a.prototype,{O8b:{configurable:!0,enumerable:!0,get:function(){if(f.a.GM(this.$)){var z=document.getElementById(this.$.Ib+n.a.kSe);return!this.lSe||z?u.DOMElementExtensions.getBoundingClientRect(z).x:0}z=v.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AddNamedRange",!1)?document.getElementById(n.a.Tud):document.getElementById(this.$.Ib+
n.a.Tud+"-"+n.a.Cnf);d.ULS.shipAssertTag(537170323,0,!!z||this.$.mV,"AutoCompleteListBox.FormulaBarXOffset : Can't find the name box combobox element.");return z?z.offsetWidth:0}},oe:{configurable:!0,enumerable:!0,get:function(){return this.pkb},set:function(z){this.pkb=z}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return u.DOMElementExtensions.isVisible(this.dg)&&0<this.Kr.length},set:function(z){u.DOMElementExtensions.setVisible(this.dg,z);u.DOMElementExtensions.setVisible(this.nSa,
z);var r=A.g(this.$).view;z?this.lbc||(r.it(this.JFa.xlc),this.lbc=!0):(Array.clear(this.Kr),this.lbc&&(r.Wr(this.JFa.xlc),this.lbc=!1))}}});Object(y.a)(a,"AutoCompleteListBox",D.a,[])},1244:function(y,D,b){function a(Tc,ub,fb,Ta){var eb=wd.call(this,Tc,"PopulateGridContextMenu",1247109494,-2064931494,a.VVh,!0,!1,a.bHb,ub,fb,!0,Ta)||this;eb.bAa=!1;eb.qva=!1;eb.VY=!1;eb.refresh=!1;eb.expandCollapse=!1;eb.Egc=!1;eb.qBe=!0;eb.grid=Cb.g(Tc);eb.pjc=!0;eb.Yld=Ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5558478_disableHideUnHideRowColumnForMobileWhenEntireGridSelected")&&
Tc.isMobileMode;eb.fld=Ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.GridContextMenuFilterByValue",!1);if(eb.fld){var tb=Tb.GetServiceTaskFactory.Xa(eb.$.da,309,310,3),rc=Tb.GetServiceTaskFactory.create(eb.$.da,18,eb.ma,3);ma.TaskExtensions.Ba(ma.TaskExtensions.ve([tb,rc],eb.ma),function(){eb.$.da.Za(268,function(wb){eb.p3a=new d(Tc,tb.result,rc.result,wb)})},eb.ma,3)}return eb}function d(Tc,ub,fb,Ta){this.MUc=this.fdb=this.hdb=0;this.$=Tc;this.gridView=Cb.g(this.$);this.namedSheetViewPublic=
ub;this.hi=fb;this.instantaneousSupportInformationManager=Ta;this.SLa=xb.a.Fkd()}function c(Tc){this.ranges=null;this.ranges=Tc}function k(Tc,ub,fb,Ta,eb,tb,rc,wb){this.$=ub;this.Sa=fb;this.jm=Ta;this.selectedRanges=eb;this.grid=tb;this.bB=wb;this.Jaa=rc;this.mra=v.a.all(eb,function(E){return E.isRow});this.lra=v.a.all(eb,function(E){return E.Lh});this.mBb=v.a.all(eb,function(E){return!E.isRow&&!E.Lh});ub=tb.Vb.gfd(eb);this.T2b=!!ub;this.VNf=!!ub&&ub.hasActiveFilter;this.menuSection=fb.Lc();Array.add(Tc.yc,
this.menuSection);this.Pja=this.mra||this.lra?this.menuSection:fb.Lc();this.Vsa=this.mra||this.lra?this.menuSection:fb.Lc()}b.r(D);y=b(0);var n=b(13),l=b(269),f=b(97),u=b(47),v=b(308),m=b(571),A=b(5),x=b(84),t=b(408),z=b(843),r=b(9),G=b(30),w=b(16),B=b(58),U=b(4),N=b(921),P=b(1172),ia=b(977),W=b(14);k.prototype.Dad=function(){this.tAh();this.Zzh();var Tc=this.bB.Q5a(this.selectedRanges,this.grid);Array.add(this.menuSection.buttons,this.Sa.yb(Tc?149:148))};k.prototype.yAh=function(){var Tc=0;this.T2b?
this.Jaa.yn(942362098)?Tc=this.bB.yn(this.jm,942362098,this.selectedRanges,this.grid)?161:169:this.VNf&&(Tc=this.bB.yn(this.jm,-1113896058,this.selectedRanges,this.grid)?177:181):this.Jaa.yn(-1113896058)&&(Tc=this.mra?this.bB.yn(this.jm,-1113896058,this.selectedRanges,this.grid)?49:116:this.bB.yn(this.jm,-1113896058,this.selectedRanges,this.grid)?177:181);Tc&&Array.add(this.Pja.buttons,this.Sa.yb(Tc))};k.prototype.uAh=function(){var Tc=0;this.T2b?this.Jaa.yn(622604322)&&(Tc=this.grid.rtl?this.bB.yn(this.jm,
622604322,this.selectedRanges,this.grid)?191:192:this.bB.yn(this.jm,622604322,this.selectedRanges,this.grid)?162:170):this.Jaa.yn(1415868706)&&(Tc=this.lra?this.bB.yn(this.jm,1415868706,this.selectedRanges,this.grid)?50:117:this.bB.yn(this.jm,1415868706,this.selectedRanges,this.grid)?178:182);Tc&&Array.add(this.Pja.buttons,this.Sa.yb(Tc))};k.prototype.sAh=function(){this.Jaa.yn(1035996630)&&(this.bB.yn(this.jm,1035996630,this.selectedRanges,this.grid)?(Array.add(this.Pja.buttons,this.Sa.yb(this.grid.rtl?
187:165)),Array.add(this.Pja.buttons,this.Sa.yb(166))):(Array.add(this.Pja.buttons,this.Sa.yb(this.grid.rtl?188:173)),Array.add(this.Pja.buttons,this.Sa.yb(174))))};k.prototype.tAh=function(){var Tc=b(1244).GridContextMenu,ub=null;this.mBb&&(ub=this.Sa.Kv("ContextMenu.InsertCells",null,W.a.instance.ea(343),1896159024),Array.add(ub.menu.yc,this.Pja));Tc.vAh(this.Pja,this.Sa,this.$);this.yAh();this.uAh();this.sAh();ub&&0<this.Pja.buttons.length&&Array.add(this.menuSection.buttons,ub)};k.prototype.aAh=
function(){var Tc=0;this.T2b?this.Jaa.yn(1405456548)?Tc=this.bB.yn(this.jm,1405456548,this.selectedRanges,this.grid)?163:171:this.VNf&&(Tc=this.bB.yn(this.jm,1554436520,this.selectedRanges,this.grid)?179:183):this.Jaa.yn(1554436520)&&(Tc=this.mra?this.bB.yn(this.jm,1554436520,this.selectedRanges,this.grid)?51:118:this.bB.yn(this.jm,1554436520,this.selectedRanges,this.grid)?179:183);Tc&&Array.add(this.Vsa.buttons,this.Sa.yb(Tc))};k.prototype.$zh=function(){var Tc=0;this.T2b?this.Jaa.yn(284490184)&&
(Tc=this.bB.yn(this.jm,284490184,this.selectedRanges,this.grid)?164:172):this.Jaa.yn(674605324)&&(Tc=this.lra?this.bB.yn(this.jm,674605324,this.selectedRanges,this.grid)?52:119:this.bB.yn(this.jm,674605324,this.selectedRanges,this.grid)?180:184);Tc&&Array.add(this.Vsa.buttons,this.Sa.yb(Tc))};k.prototype.Yzh=function(){this.Jaa.yn(1035996630)&&(this.bB.yn(this.jm,1035996630,this.selectedRanges,this.grid)?(Array.add(this.Vsa.buttons,this.Sa.yb(this.grid.rtl?189:167)),Array.add(this.Vsa.buttons,this.Sa.yb(168))):
(Array.add(this.Vsa.buttons,this.Sa.yb(this.grid.rtl?190:175)),Array.add(this.Vsa.buttons,this.Sa.yb(176))))};k.prototype.Zzh=function(){var Tc=null;this.mBb&&(Tc=this.Sa.Kv("ContextMenu.DeleteCells",null,W.a.instance.ea(403),-1554384558),Array.add(Tc.menu.yc,this.Vsa));this.aAh();this.$zh();this.Yzh();Tc&&0<this.Vsa.buttons.length&&Array.add(this.menuSection.buttons,Tc)};Object(y.a)(k,"CellsContextMenuGenerator",null,[]);Object(y.a)(c,"MacroRecorderRangeHyperlinkRemovedPayload",null,[116]);var R=
b(552),I=b(24),Q=b(96),O=b(78),ba=b(73),ca=b(43),S=b(163),Y=b(81),na=b(650),Z=b(41),wa=b(141),ma=b(35),pa=b(575),Ia=b(578),Ma=b(1),ob=b(175),Cb=b(20),Xa=b(370),Sb=b(34),Tb=b(56),da=b(238),ya=b(19),hb=b(28),Gb=b(1183),Qb=b(1044),Fb=b(125),ta=b(519),xa=b(368),sa=b(153),lb=b(148),Yb=b(337),Fa=b(92),Sa=b(27),Ra=b(302),Lb=b(273),Ja=b(127),xb=b(901),Kb=b(902),Eb=b(132),Hc=b(38),Xc=b(55),Pc;(function(Tc){Tc[Tc.none=0]="none";Tc[Tc.once=1]="once";Tc[Tc.twice=2]="twice"})(Pc||(Pc={}));Object(y.b)("ToggleState",
Pc);d.prototype.hch=function(){var Tc=this.BU(),ub={};Tc=(ub.CommandValueId=Hc.c(Tc),ub);ub=new Fa.a(-2058042992,2,this.$.ed,19,null);n.ULS.sendTraceTag(527500302,0,50,"GridContextMenuFilter::DoClearFilter GridContextMenu ClearFilter command executed");return this.$.Ka.Zb(ub,Tc)};d.prototype.ych=function(){var Tc=new Fa.a(644342024,2,this.$.ed,19,null);n.ULS.sendTraceTag(527500301,0,50,"GridContextMenuFilter::DoReapplyFilter GridContextMenu ReapplyFilter command executed");return this.$.Ka.Zb(Tc)};
d.prototype.nch=function(){var Tc=this.gridView.ha.va.activeCell,ub=this.$.da.Aa(66).Ah;return ub?this.pch(ub,Tc):this.och(Tc)};d.prototype.pch=function(Tc,ub){if(this.fSg(Tc,ub))return n.ULS.sendTraceTag(527500300,0,50,"GridContextMenuFilter::DoFilterByValue Header/Total error dialog raised for FilterByValue in Table"),Xc.Task.Ta(!1);if(Tc.hasAutoFilter)return this.hdb=Pc.none,this.KUc();this.hdb=Pc.once;return this.n5b(Pc.once)};d.prototype.och=function(Tc){var ub=ca.v(this.gridView.ha.va.Qd,this.$);
ub=this.gridView.$.xa.getItemByName(ub.SheetName);var fb=ca.D(ub.i0);if(this.eSg(fb,Tc))return n.ULS.sendTraceTag(527500299,0,50,"GridContextMenuFilter::DoFilterByValue Header/EmptyRange error dialog raised for FilterByValue in Sheet"),Xc.Task.Ta(!1);if(ub.hasAutoFilter){if(fb&&fb.contains(this.gridView.ha.va.activeCell))return this.hdb=Pc.none,this.KUc();this.hdb=Pc.twice;return this.n5b(Pc.twice)}this.hdb=Pc.once;return this.n5b(Pc.once)};d.prototype.n5b=function(Tc){function ub(wb){Ra.a(wb)?n.ULS.sendTraceTag(527500297,
0,50,"GridContextMenuFilter::ToggleFilter service call failed with errors : {}",Sa.a.Uc(wb.Errors)):(n.ULS.sendTraceTag(527500298,0,50,"GridContextMenuFilter::ToggleFilter service call succeeded"),Tc===Pc.twice?Ta.n5b(Pc.once):Ta.KUc())}function fb(){return new Gb.a(eb)}var Ta=this,eb=ca.v(this.gridView.ha.va.Qd,this.$);if(!eb)return Xc.Task.Ta(!1);this.fdb||(this.fdb=Date.now());var tb=new Fa.a(368460465,2,this.$.ed,19,null),rc=this.$.qa.ta.Xb();return Ma.EwaSettings.tc()?xa.a(this.$.userOperationManager,
function(wb,E,Mb){return Y.jb(Ta.$.qa.ta,eb,Lb.b(wb,ub),E,Mb,null,rc)},function(wb){return new S.a(516,0,wb,64,fb)},tb):xa.a(this.$.userOperationManager,function(wb,E,Mb){return Y.jb(Ta.$.qa.ta,eb,Lb.b(wb,ub),E,Mb,null,rc)},function(wb){return new ta.a(516,0,wb,void 0,fb)},tb)};d.prototype.fSg=function(Tc,ub){return sa.d(Tc)&&ub.top===Tc.usedRange.top?(this.cpc(this.$,224),!0):sa.g(Tc)&&ub.top===Tc.usedRange.bottom?(this.cpc(this.$,225),!0):!1};d.prototype.eSg=function(Tc,ub){if(Tc&&Tc.contains(ub)&&
ub.top===Tc.top||!Tc&&this.hRg(ub.top,ub.left))return this.cpc(this.$,226),!0;Tc=new I.Range(ub.top,ub.left,ub.top+1,ub.left+1,!1,!1);return this.gridView.Vb.Xfc(Tc)?(this.cpc(this.$,227),!0):!1};d.prototype.cpc=function(Tc,ub){ub=Sa.a.jd(1,1,735,ub,0,147079615,"ContextMenuFilterByCellValueError");Ma.EwaSettings.az()?new Yb.a(Tc,ub):(Tc=new lb.ErrorDialog(Tc,ub),Tc.initialize(),Tc.mf())};d.prototype.KUc=function(){function Tc(wb){var E={};E=(E.ToggleFilterOperationCount=ub.hdb,E.ApplyFilterTime=ub.MUc?
Date.now()-ub.MUc:-1,E.ToggleAndApplyFilterTime=ub.fdb?Date.now()-ub.fdb:-1,E.FilterByValueType=Ta.AutoFilterType,E);n.ULS.sendTraceTag(527500295,0,50,"GridContextMenuFilter::ApplyFilterByValue Perf Telemetry : {0}",JSON.stringify(E));ub.fdb&&(ub.fdb=0);xb.a.pvc(wb)&&(E=xb.a.t9b(wb),ub.SLa?xb.a.DPa(Kb.a.filterByCellValue,E.MessageIdName,Eb.a.Ara,!0,xb.a.isSessionEndingError(E.MessageId)):n.ULS.sendTraceTag(527500294,0,10,"GridContextMenuFilter::ApplyFilterByValue failed with FilterException -{0}",
E.MessageIdName));Ra.a(wb)?n.ULS.sendTraceTag(527500292,0,50,"GridContextMenuFilter::ApplyFilterByValue service call failed with errors : {}",Sa.a.Uc(wb.Errors)):(n.ULS.sendTraceTag(527500293,0,50,"GridContextMenuFilter::ApplyFilterByValue service call succeeded"),Ja.b(ub.$).ae(Fb.a.muf,ub.dm(),void 0,!0),wb={},wb.FirstRow=ub.MIh(),wb.FirstColumn=Ta.Column,-1!==wb.FirstRow&&(wb=ca.C(wb),ub.ZK(wb)))}var ub=this;this.MUc=Date.now();var fb=this.qUh();if(!fb)return n.ULS.sendTraceTag(527500296,0,50,"GridContextMenuFilter::ApplyFilterByValue . CellValue returned is null"),
Xc.Task.Ta(!1);var Ta=this.BU(),eb={FirstRow:0};eb.FirstColumn=Ta.Column;eb.SheetName=Ta.SheetName;Ja.b(this.$).ae(Fb.a.Eqf,this.dm(),void 0,!0);var tb=this.D1c(Ta,eb),rc=new S.a(208,0,function(wb,E,Mb){return Y.a(ub.$.qa.ta,tb,fb,Lb.b(wb,Tc),E,Mb,null,null)},6,function(){return new Qb.a(fb,tb)});this.namedSheetViewPublic?this.namedSheetViewPublic.dAa().continueWith(function(wb){wb.result&&ub.$.userOperationManager.ic(rc,null)}):this.$.userOperationManager.ic(rc,null);return Xc.Task.Ta(!0)};d.prototype.ZK=
function(Tc){Ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.PivotTableHandRaise",!1)&&ma.TaskExtensions.Ba(Tb.GetServiceTaskFactory.Xa(this.$.da,430,431,1),function(ub){ub.result.Pda(Tc);n.ULS.sendTraceTag(527500291,306,50,"GridContextMenuFilter:TriggerPivotTableHandRaise Trigger hand raise from context menu filterByValue.")},this.$.ma,3)};d.prototype.dm=function(){if(Ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5347991_AddComponentNamesToReport")){var Tc={};return Tc.Location=
"contextMenu",Tc}return{}};d.prototype.BU=function(){var Tc=0,ub=this.$.da.Aa(66).Ah;if(ub){var fb="Table";Tc=ub.objectId}else fb="Sheet";var Ta=this.gridView.ha.va.activeCell.left;ub={};ub.AutoFilterType=fb;ub.Column=Ta;ub.Id=Tc;fb={};this.$.wj(fb);fb.FirstRow=0;fb.FirstColumn=ub.Column;Tc=this.$.fa.isNamedObjectViewMode;ub.NamedObjectView=Tc;ub.SheetName=Tc?fb.NamedObjectName:fb.SheetName;ub.ItemListOptions=null;return ub};d.prototype.hRg=function(Tc,ub){Tc=I.Range.ld(Tc,ub);return this.gridView.Ca.G9(Tc,
this.$.oa.name)&&(Tc=this.gridView.Ca.nub(Tc))&&Tc.autoFilterMenu?!0:!1};d.prototype.qUh=function(){var Tc=null,ub=this.gridView.sc(this.gridView.ha.va.activeCell);if(!ub)return null;var fb=ub.cell.DQd;var Ta=this.instantaneousSupportInformationManager.Cdb(fb,!1).category;if(1===ub.aL.type)if(3===Ta){if(!ub.cell.T7a)return n.ULS.sendTraceTag(527500290,0,15,"GridContextMenuFilter::GetValueForFilter() for category : {0}. NumFmt is null. ",Ta),null;Tc=(ub.cell.T7a.Start+ub.cell.T7a.End).trim()}else if(!Ta&&
(ya.a.n_a(ub.aL.value,"E")||ya.a.n_a(ub.originalText,"E"))){Tc=this.hi.cyh(ub.aL.value,fb,ub.cell.Fsa);if(!Tc.success)return n.ULS.sendTraceTag(527500289,0,50,"GridContextMenuFilter::GetValueForFilter() for category : {0}. Failed to acquire formatted value",Ta),null;Tc=Tc.mM}Tc||(Tc=ub.originalText);return hb.a.jZc(Tc)?["[Blanks]"]:["i"+Tc.trim()]};d.prototype.MIh=function(){var Tc=this.$.da.Aa(66).Ah;if(Tc)return Tc.usedRange.top;Tc=this.$.xa.getItemByName(this.$.oa.sheetName);return(Tc=ca.D(Tc.i0))&&
Tc.contains(this.gridView.ha.va.activeCell)?Tc.top:-1};d.prototype.D1c=function(Tc,ub){var fb={};fb.Location=ub;fb.FieldId=Tc.Id.toString();fb.DataSourceIndex=-1;fb.FilterType=Tc.AutoFilterType;fb.AnchorType=0;fb.ChartId=null;fb.AnchorValue1=-1;fb.AnchorValue2=-1;fb.Property=Tc.RichProperty;return fb};Object(y.a)(d,"GridContextMenuFilter",null,[]);b.d(D,"GridContextMenu",function(){return a});var wd=z.a;vm(a,wd);a.prototype.dispose=function(){wd.prototype.dispose.call(this);this.grid=null};a.prototype.Xc=
function(Tc,ub){Tc=!this.Ynd(Tc,ub);if(!Tc)switch(ub){case -1977666927:Tc=null==this.p3a||this.Moj();break;case 1549396389:Tc=null==this.p3a||this.Soj();break;case 1803952894:Tc=null==this.p3a||!this.$.isEditMode&&!this.A9h()}return Tc};a.prototype.Ynd=function(Tc,ub){var fb=this.grid.ha.va.selectedRanges;return(new wa.a(this.$.xa)).yn(Tc,ub,fb,this.grid)};a.prototype.executeCommand=function(Tc,ub,fb){var Ta=ub.command;Tc=null;switch(Ta){case -1396319072:if(ub=this.grid.sc(null))l.a.instance.aYc(!0),
f.EventHandlerManager.instance.Q$c(),a.mNi(ub);break;case -1253126584:this.removeHyperlinksFromRange(this.grid.ha.va.selectedRanges,ub);break;case 324156914:Tc=this.grid.startEdit(!1,1);break;case 1441131127:this.showGridContextMenu(fb);break;case -1977666927:Tc=this.p3a.hch();break;case 1549396389:Tc=this.p3a.ych();break;case 1803952894:Tc=this.p3a.nch();break;default:Tc=ob.a(Ta)}return Tc||ma.TaskExtensions.g4()};a.prototype.Gc=function(Tc,ub,fb){Tc=!1;switch(ub.command){case -1396319072:case -1253126584:case 324156914:case -1977666927:case 1549396389:case 1803952894:Tc=
!0;break;case 1441131127:Tc=!!fb}return Tc};a.prototype.zY=function(Tc){Tc=void 0===Tc?!1:Tc;var ub=!1,fb=!1,Ta=0;Ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(Ta=u.a.se());var eb=this.Sa.zp(this.menuId),tb=this.grid.ha.va,rc=tb.Dh,wb=rc&&tb.Qd.Lh,E=rc&&tb.Qd.isRow;tb=tb.selectedRanges;var Mb=v.a.all(tb,function(Ha){return Ha.Lh}),ka=v.a.all(tb,function(Ha){return Ha.isRow}),bb=ca.O(tb),Ga=ca.P(tb);this.xcf(wb,E)?(ub=!0,this.aBh(eb)):this.$.isEditMode?
Xa.a(this.$)?this.bBh(eb,wb,E):(this.bAh(eb,!(E||wb||!this.Egc)),this.wAh(eb,tb,Tc),this.mAh(eb,Mb,ka,bb,Ga),this.sTe(eb,rc,wb,E),this.tBh(eb),this.SSe(eb,wb,E),this.SAh(eb,rc,wb,E,tb),this.eAh(eb),this.cAh(eb,tb),this.DAh(eb),this.oBh(eb,rc),Ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImmersiveReader",!1)&&this.qAh(eb)):(fb=!0,Xa.a(this.$)?this.lTe(eb):this.JBh(eb,rc,wb,E,tb));Ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5244620_ContextualUIDetailedTelemetryIsEnabled")&&(Tc=u.a.se()-
Ta,n.ULS.sendTraceTag(537167046,0,50,"GridContextMenu::CreateMenuModel, ExecutionTimeTotal: {0}, isPivotMenu: {1}, isViewMenu: {2}, firstTimeEntry: {3}",Tc,ub,fb,this.qBe));this.qBe=!1;return eb};a.prototype.BJa=function(Tc){var ub=[];if(Xa.a(this.$))return ub;if(3===Tc){Tc=this.grid.ha.va;var fb=Tc.Dh,Ta=fb&&Tc.Qd.Lh,eb=fb&&Tc.Qd.isRow,tb=!1,rc=!1,wb=!1;this.Yld&&(rc=Tc.selectedRanges,tb=ca.O(rc),rc=ca.P(rc));if(fb){var E=Cb.e(this.grid);E&&E.range.contains(Tc.Qd)&&this.iV(E)&&(wb=!0)}this.$.isEditMode?
this.xcf(Ta,eb)?Array.addRange(ub,[ia.a.vDf,ia.a.xDf]):Ta||eb?(Array.add(ub,ia.a.clipboard),eb?Array.add(ub,ia.a.ebj):Ta&&Array.add(ub,ia.a.BVg)):(Array.addRange(ub,[ia.a.edit,ia.a.clipboard]),wb?Array.add(ub,ia.a.hyperlink):Array.add(ub,ia.a.color),fb&&Array.add(ub,ia.a.uIg)):(Array.add(ub,ia.a.copy),wb&&Array.add(ub,ia.a.openHyperlink),!eb||this.Yld&&rc?!Ta||this.Yld&&tb||Array.add(ub,ia.a.iOj):Array.add(ub,ia.a.jOj));Array.add(ub,ia.a.MVh)}else 2===Tc&&Array.add(ub,ia.a.Cue);return ub};a.prototype.xcf=
function(Tc,ub){return(this.bAa||this.qva||this.VY||this.refresh||this.expandCollapse)&&!(Tc||ub)};a.prototype.showGridContextMenu=function(Tc){this.expandCollapse=this.refresh=this.VY=this.qva=this.bAa=!1;var ub=this.$,fb=pa.a(ub).PJa(),Ta=this.grid.ha.va,eb=Ta.Dh,tb=eb&&Ta.Qd.Lh;Ta=eb&&Ta.Qd.isRow;if(fb&&!tb&&!Ta){tb=Ia.a(ub);if(null===tb||void 0===tb?0:tb.eOd)this.bAa=tb=Q.f(ub.kg),this.qva=!tb;tb=ub.lc;this.VY=fb.supportsBIExplore&&!!N.a(ub)&&tb.n2(32768);tb.allowInteractivity&&(ub=this.grid.sc(null),
(null===ub||void 0===ub?0:ub.cell)&&(ub.cell.QXc||ub.cell.zZf)&&(this.expandCollapse=!0),tb.allowManualDataRefresh&&(this.refresh=!0))}ub=null;fb=1;tb=Object(x.a)(m.a,Tc.eventArgs);Tc=Object(x.a)(P.a,Tc.creationParams);Ta=this.RFh();Tc?(ub=Tc.clientPoint,fb=Tc.inputMethod):tb&&1!==tb.zb?(ub=new Sys.UI.Point(tb.clientPoint.x,tb.clientPoint.y),fb=tb.zb):Ta&&(ub=new Sys.UI.Point(Ta.x+(this.$.isChromeRtl?0:Ta.width),Ta.y+Ta.height));O.a.Wb=fb;this.Egc=3===fb;Tc=G.a.gsb;this.so(ub,!tb||tb.Ea.target.className!==
Tc,fb)};a.prototype.removeHyperlinksFromRange=function(Tc,ub){var fb=this;if(!Ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5639309_CheckedProtectedRangeUnlockStateWhenInsertHyperlink")||this.$.xs(Tc,!0)){var Ta=ca.r(Tc,this.$),eb=this.$.qa.ta.Xb();this.$.userOperationManager.ic(new S.a(125,0,function(tb,rc,wb){fb.$.Xu();return Y.c(fb.$.qa.ta,Ta,"","",!0,!1,127,tb,rc,wb,null,eb)},void 0,function(){return new c(Ta)}),ub);this.grid.Bh.qG(!1)}};a.prototype.RFh=function(){var Tc=this.grid.sc(null);if((null===
Tc||void 0===Tc?0:Tc.cell.tk)&&this.Ibf(Tc))return this.grid.getCellBounds(Tc.cell);Tc=this.grid.ha.va.activeCell;return(Tc=this.$7b(new I.Range(Tc.top,Tc.left,r.a.Fh,Tc.left,!1,!1),2,!0)||this.$7b(new I.Range(1,Tc.left,Tc.top,Tc.left,!1,!1),2,!1)||this.$7b(new I.Range(Tc.top,Tc.right,Tc.top,r.a.Qh,!1,!1),1,!0)||this.$7b(new I.Range(Tc.top,1,Tc.top,Tc.right,!1,!1),1,!1)||null)&&Tc.tk?this.grid.getCellBounds(Tc):Sys.UI.DomElement.getBounds(this.grid.Ivb.Jb)};a.prototype.Ibf=function(Tc){var ub=this.grid.rtl,
fb=this.$.isChromeRtl;Tc=Tc.cell;var Ta=Cb.g(this.$).BJ(Tc);return Ta?(Ta=Ta.topLeft,ub=Ta.x+=ub===fb?Tc.offsetWidth:0,fb=Ta.y+=Tc.offsetHeight,this.grid.view.visibleArea.contains(new B.a(ub,fb,0,0))):!1};a.prototype.$7b=function(Tc,ub,fb){Tc=this.grid.sl("GridContextMenu.FindFirstCellInViewportArea",Tc,ub,fb);try{for(Tc.$$rst();Tc.$$mn();){var Ta=Tc.$$cu();if(Ta&&this.Ibf(Ta))return Ta.cell}}finally{Tc&&Tc.dispose()}return null};a.prototype.aBh=function(Tc){var ub=this.Sa,fb=ub.Lc();this.refresh&&
Array.add(fb.buttons,ub.yb(100));this.VY&&Array.add(fb.buttons,ub.yb(99));this.bAa?Array.add(fb.buttons,ub.yb(59)):this.qva&&Array.add(fb.buttons,ub.yb(58));if(this.expandCollapse){var Ta=ub.Kv("ContextMenu.PivotExpandCollapse",null,W.a.instance.ea(1117),589118293);var eb=ub.Lc();Array.add(eb.buttons,ub.yb(243));Array.add(eb.buttons,ub.yb(244));Array.add(eb.buttons,ub.yb(245));Array.add(eb.buttons,ub.yb(246));Array.add(Ta.menu.yc,eb);Ta&&0<eb.buttons.length&&Array.add(fb.buttons,Ta)}Array.add(Tc.yc,
fb)};a.prototype.sTe=function(Tc,ub,fb,Ta){if(ub&&!fb&&!Ta){ub=this.Sa.Lc();this.fld&&!this.$.mV&&this.$Se(ub);this.Mad(ub);this.xBh(ub);if(Ma.EwaSettings.la(500)&&Cb.g(this.$).ha.va.zM()&&Cb.g(this.$).ha.va.oV)switch(Ma.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.Insights.GridContextMenuQnABrandingCandidatesIndex",0)){case 1:Array.add(ub.buttons,this.Sa.yb(237));break;case 2:Array.add(ub.buttons,this.Sa.yb(238));break;default:Array.add(ub.buttons,this.Sa.yb(236))}Array.add(Tc.yc,
ub)}};a.prototype.Mad=function(Tc){if(!Ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5230917_HideSortForProtectedSheetInMobiles")||!this.$.isMobileMode||(new wa.a(this.$.xa)).te(2048)){var ub=this.Sa.Lc();Array.add(ub.buttons,this.Sa.yb(223));Array.add(ub.buttons,this.Sa.yb(224));this.$.isMobileMode||Array.add(ub.buttons,this.Sa.yb(225));var fb=this.Sa.Kv("ContextMenu.sort",null,W.a.instance.ea(228),-864298118);Array.add(fb.menu.yc,ub);Array.add(Tc.buttons,fb)}};a.prototype.$Se=function(Tc){var ub=
this.Sa.Kv("ContextMenu.filter",null,W.a.instance.ea(1903),2045563128),fb=this.Sa.Lc(),Ta=this.nKh(),eb=this.Sa.yb(234);eb.label=Ta;Array.add(fb.buttons,eb);Array.add(fb.buttons,this.Sa.yb(235));Ta=this.Sa.Lc();Array.add(Ta.buttons,this.Sa.yb(233));Array.add(ub.menu.yc,fb);Array.add(ub.menu.yc,Ta);Array.add(Tc.buttons,ub)};a.prototype.xBh=function(Tc){if(Cb.g(this.$).ha.va.zM()){var ub=this.Sa.Lc();Array.add(ub.buttons,this.Sa.yb(232));Ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableMissingContextMenuOptions",
!1)&&(Array.add(ub.buttons,this.Sa.yb(285)),Array.add(ub.buttons,this.Sa.yb(286)));var fb=this.Sa.Kv("ContextMenu.table",null,W.a.instance.ea(1902),-697806646);Array.add(fb.menu.yc,ub);Array.add(Tc.buttons,fb)}};a.prototype.fTe=function(Tc,ub,fb,Ta,eb){if(ub){var tb=ca.K(eb),rc=Cb.e(this.grid);if(rc&&!fb&&!Ta){fb=new wa.a(this.$.xa);if(rc.range.contains(tb)&&this.iV(rc)){(ub=!rc.ELa&&!fb.ik)&&this.$.isEditMode&&Array.add(Tc.buttons,this.Sa.yb(45));rc.waa&&Array.add(Tc.buttons,this.Sa.yb(53));ub&&
this.$.isEditMode&&Array.add(Tc.buttons,this.Sa.yb(47));return}!rc.ELa&&this.$.isEditMode&&(rc=fb.te(128),Array.add(Tc.buttons,this.Sa.yb(rc?46:121)))}}this.XXi(eb)&&Array.add(Tc.buttons,this.Sa.yb(48));ub&&Ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)&&!this.$.fa.isNamedObjectViewMode&&(ub=ca.K(eb),this.WXi(ub)?Array.add(Tc.buttons,this.Sa.yb(276)):ub.Lh||ub.isRow||Array.add(Tc.buttons,this.Sa.yb(275)))};a.prototype.XXi=function(Tc){Tc=yl(Tc);for(var ub=Tc.next();!ub.done;ub=
Tc.next()){ub=this.grid.getRangeInformation(ub.value);for(var fb=0;fb<ub.length;fb++)if(Object(t.a)(R.HyperlinkRange,ub[fb])){var Ta=this.grid.sc(ub[fb]);if(Ta&&this.iV(Ta)&&!Ta.ELa)return!0}}return!1};a.prototype.WXi=function(Tc){if(Cb.g(this.$).ha.va.zM()){var ub=Cb.g(this.$).Vb.vk(Tc);if(ub&&ub.usedRange.equals(Tc))return!0}return!1};a.prototype.SSe=function(Tc,ub,fb){var Ta,eb;if(1===Cb.g(this.$).ha.Te&&!ub&&!fb){ub=Xa.a(this.$);fb=this.Sa;var tb=fb.Lc(),rc=this.$.da.Aa(65);(null===(Ta=null===
rc||void 0===rc?void 0:rc.Cn)||void 0===Ta?0:Ta.uE)&&!ub&&Array.add(tb.buttons,fb.yb(227));rc&&rc.isCommentOperationEnabled(3)&&Array.add(tb.buttons,fb.yb(221));(null===(eb=null===rc||void 0===rc?void 0:rc.Cn)||void 0===eb?0:eb.z4e)&&!ub&&Array.add(tb.buttons,fb.yb(228));(null===rc||void 0===rc?0:rc.hasCommentAtActiveCell)?rc.QB.isResolved||Array.add(tb.buttons,fb.yb(159)):rc&&rc.hasCommentAtActiveCell||(rc&&rc.Cn&&rc.Cn.uE?ub||(Array.add(tb.buttons,fb.yb(229)),Array.add(tb.buttons,fb.yb(230))):(Array.add(tb.buttons,
fb.yb(160)),ub||Array.add(tb.buttons,fb.yb(226))));Array.add(Tc.yc,tb)}};a.prototype.tBh=function(Tc){if(Ma.EwaSettings.la(134)){var ub=this.Sa,fb=ub.Lc();Array.add(fb.buttons,ub.yb(250));Array.add(Tc.yc,fb)}};a.prototype.wAh=function(Tc,ub,fb){if(!fb){fb=this.$.Ka.LG();var Ta=new wa.a(this.$.xa),eb=new na.a(fb,ub,this.grid);(new k(Tc,this.$,this.Sa,fb,ub,this.grid,eb,Ta)).Dad()}};a.prototype.mAh=function(Tc,ub,fb,Ta,eb){var tb=(new wa.a(this.$.xa)).te(8),rc=this.Sa,wb=rc.Lc();ub&&Array.add(wb.buttons,
rc.yb(tb?152:153));fb&&Array.add(wb.buttons,rc.yb(tb?150:151));ub&&(Ta||Array.add(wb.buttons,rc.yb(tb?109:155)),Array.add(wb.buttons,rc.yb(tb?111:157)));fb&&(eb||Array.add(wb.buttons,rc.yb(tb?108:154)),Array.add(wb.buttons,rc.yb(tb?110:156)));Array.add(Tc.yc,wb)};a.prototype.bAh=function(Tc,ub){var fb=this.Sa,Ta=fb.Lc();Array.add(Tc.yc,Ta);ub&&Array.add(Ta.buttons,fb.yb(102));Array.add(Ta.buttons,fb.yb(42));Array.add(Ta.buttons,fb.yb(43));ub=this.YAh(fb);Array.add(Tc.yc,ub)};a.prototype.YAh=function(Tc){var ub=
Tc.Lc();ub.title=W.a.instance.ea(1097);ub.A0f=!1;ub.z0f=!1;ub.G5f=!1;var fb=5,Ta=Z.a.qpd(this.$);Ta&&(fb=6);Tc=Tc.iA("PasteOptionsGallery",fb,"Size24by24",ub.title);Array.add(ub.buttons,Tc);Tc.ht("ContextMenu.Paste",237279923,"QueryAdvancedPasteContextMenuGalleryIcon",1098,void 0,"Paste_24",1,w.a.Nnh);Tc.ht("ContextMenu.PasteValues",-185374993,"QueryAdvancedPasteContextMenuGalleryIcon",1099,void 0,"PasteValues_24",1,w.a.Snh);Tc.ht("ContextMenu.PasteFormulas",1766348718,"QueryAdvancedPasteContextMenuGalleryIcon",
1100,void 0,"PasteFormulas_24",1,w.a.Pnh);Tc.ht("ContextMenu.PasteTranspose",-958589048,"QueryAdvancedPasteContextMenuGalleryIcon",1101,void 0,"PasteTranspose_24",1,w.a.Rnh);Tc.ht("ContextMenu.PasteFormatting",1804571062,"QueryAdvancedPasteContextMenuGalleryIcon",1102,void 0,"PasteFormatting_24",1,w.a.Onh);Ta&&Tc.ht("ContextMenu.PasteLink",42074747,"QueryAdvancedPasteContextMenuGalleryIcon",1103,void 0,"PasteLink_24",1,w.a.Qnh);return ub};a.prototype.JBh=function(Tc,ub,fb,Ta,eb){var tb,rc=this.Sa,
wb=rc.Lc();Array.add(wb.buttons,rc.yb(43));Array.add(Tc.yc,wb);this.fld&&!this.$.mV&&(wb=this.Sa.Lc(),this.$Se(wb),Array.add(Tc.yc,wb));Ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MiniWACInReadOnlyEditMode",!1)&&this.$.fa.lc.isMobileMode&&this.$.fa.lc.isReadOnlyEditMode&&!this.$.ya.IsMeetingLiveSession||(wb=this.Sa.Lc(),this.Mad(wb),Array.add(Tc.yc,wb),n.ULS.sendTraceTag(537167045,0,50,"GridContextMenu::GenerateViewMenuSection, Remove the sort options from right contextual menu in mobile, readonlyeditmode and non-meeting scenario"));
wb=this.$.da.Aa(65);if(null===(tb=null===wb||void 0===wb?void 0:wb.Cn)||void 0===tb?0:tb.uE)tb=this.Sa.Lc(),Array.add(tb.buttons,rc.yb(229)),Array.add(Tc.yc,tb);tb=this.Sa.Lc();this.fTe(tb,ub,fb,Ta,eb);Array.add(Tc.yc,tb);A.AFrameworkApplication.isMobileMode&&!ba.a(this.$.ya,30)&&(ub=rc.Lc(),Array.add(ub.buttons,rc.yb(272)),Array.add(Tc.yc,ub))};a.prototype.SAh=function(Tc,ub,fb,Ta,eb){var tb=this.Sa.Lc();this.TAh(tb);this.fTe(tb,ub,fb,Ta,eb);0<tb.buttons.length&&Array.add(Tc.yc,tb)};a.prototype.TAh=
function(Tc){Array.add(Tc.buttons,this.Sa.yb(135))};a.prototype.qAh=function(Tc){var ub=this.Sa.Lc();Array.add(ub.buttons,this.Sa.yb(185));Array.add(Tc.yc,ub)};a.prototype.oBh=function(Tc,ub){Ma.EwaSettings.la(501)&&ub&&(ub=this.Sa.Lc(),Array.add(ub.buttons,this.Sa.yb(262)),Array.add(Tc.yc,ub))};a.prototype.DAh=function(Tc){var ub=this.grid.ha.va.selectedRanges;if(ub&&ub.length){for(var fb=!1,Ta=0;Ta<ub.length;Ta++)if(this.grid.Vb.YLa(ub[Ta])){fb=!0;break}if(fb){var eb=this.Sa;fb=eb.Lc();Ta=eb.Lc();
for(var tb=1===ub.length&&(ub[0].isSingle||this.grid.Vb.wyb(ub[0])),rc=!1,wb=!1,E=!1,Mb=!1,ka=0;ka<ub.length&&!(rc&&E&&wb&&Mb);ka++)!rc&&this.grid.Vb.Tci(ub[ka])&&(rc=!0),!E&&this.grid.Vb.Abf(ub[ka],!1)&&(E=!0),!wb&&this.grid.Vb.Pnd(ub[ka])&&(wb=!0),!Mb&&this.grid.Vb.C9h(ub[ka])&&(Mb=!0);Ma.EwaSettings.la(104)&&tb&&!this.grid.Vb.Pdc(ub[0])&&(Mb?Array.add(fb.buttons,eb.yb(217)):Array.add(fb.buttons,eb.yb(216)));Mb=rc;Mb=!(new wa.a(this.$.xa)).ik&&Mb;E&&(Ma.EwaSettings.la(130)&&Q.l(this.$.kg)&&(Ma.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.LinkedEntityRefreshMenu",
!1)&&(Ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5695344_showRefreshSettingsOnProtectedSheet")?Array.add(Ta.buttons,eb.yb(220)):Array.add(Ta.buttons,eb.yb(Mb?220:271))),wb&&Array.add(Ta.buttons,eb.yb(Mb?218:269)),tb&&(this.grid.Vb.Pnd(ub[0])||this.grid.Vb.Pdc(ub[0]))&&Array.add(Ta.buttons,eb.yb(Mb?219:270))),Array.add(Ta.buttons,eb.yb(Mb?215:268)));0<Ta.buttons.length&&(ub=eb.Kv(rc?"ContexMenu.LinkedEntitiesFlyOut_EnabledContents":"ContexMenu.LinkedEntitiesFlyOut_DisabledContents",null,W.a.instance.ea(1726),
798637440),Array.add(ub.menu.yc,Ta),Array.add(fb.buttons,ub));0<fb.buttons.length&&Array.add(Tc.yc,fb)}}};a.prototype.cAh=function(Tc,ub){this.grid.Vb.$$e(ub)&&(ub=this.Sa.Lc(),this.grid.ha.va.wwa()?(Array.add(ub.buttons,this.Sa.yb(241)),Array.add(ub.buttons,this.Sa.yb(239))):Array.add(ub.buttons,this.Sa.yb(240)),Array.add(Tc.yc,ub))};a.prototype.iV=function(Tc){return Tc.cell.hasHyperlink};a.prototype.lTe=function(Tc){this.cBh(Tc);var ub=this.Sa.Lc();this.Mad(ub);Array.add(Tc.yc,ub)};a.prototype.bBh=
function(Tc,ub,fb){this.lTe(Tc);this.SSe(Tc,ub,fb)};a.prototype.cBh=function(Tc){if(this.grid.ha.va.Dh&&!this.grid.$a.Zi){var ub=this.Sa,fb=ub.Lc();Sb.a(this.$).IOd()?Array.add(fb.buttons,ub.yb(265)):Array.add(fb.buttons,ub.yb(264));Array.add(Tc.yc,fb)}};a.mNi=function(Tc){var ub=Tc.GJa(a.lid);ub&&ub.ikd&a.lid&&Tc.invoke(a.lid,null)};a.vAh=function(Tc,ub,fb){if(Ma.EwaSettings.isChangeGateEnabled("OfficeVSO:5552180_DontAssertIfCopyPasteInfraNotReadyOnContextMenuOpen")){if(fb=fb.da.Aa(254),!fb){n.ULS.sendTraceTag(537167044,
0,50,"GridContextMenu::GenerateInsertCopiedCutCellsConextMenu, CopyPasteInfrastructure is not ready.");return}}else if(fb=fb.da.Aa(254,!0),!fb)return;fb.wmd()&&fb.tgf()&&Array.add(Tc.buttons,ub.yb(212));fb.wmd()&&fb.xhc()&&Array.add(Tc.buttons,ub.yb(213))};a.prototype.Moj=function(){var Tc=this.grid.ha.va.activeCell;return da.c(this.$,Tc)||!this.B9h(Tc)};a.prototype.B9h=function(Tc){var ub=Tc.left,fb=this.n0e();if(null!=fb&&null!=fb.gQe&&Array.contains(fb.gQe,ub-1))return!0;fb=this.Oed();return null!=
fb&&ca.D(fb).contains(Tc)&&null!=fb.FilteredColumns&&Array.contains(fb.FilteredColumns,ub-1)?!0:!1};a.prototype.Soj=function(){var Tc=this.$.da.Aa(66).Ah;if(null!=Tc)return!Tc.hasAutoFilter||!Tc.ynb;Tc=this.$.xa.getItemByName(this.$.oa.sheetName);return!Tc.hasAutoFilter||!Tc.ynb};a.prototype.A9h=function(){if(null!=this.n0e())return!0;var Tc=ca.D(this.Oed());return null!=Tc&&Tc.contains(this.grid.ha.va.activeCell)?!0:!1};a.prototype.n0e=function(){var Tc=this.$.da.Aa(66);Tc.wn(this.grid.ha.va.activeCell);
return Tc.eUe(this.grid.ha.va.activeCell)};a.prototype.Oed=function(){return this.$.xa.getItemByName(this.$.oa.sheetName).i0};a.prototype.nKh=function(){var Tc=this.grid.ha.va.activeCell,ub=0,fb=!1,Ta=this.$.da.Aa(66).Ah;null!=Ta?(ub=Ta.usedRange.top,fb=!0):(Ta=this.Oed(),null!=Ta&&ca.D(Ta).contains(Tc)&&(ub=Ta.FirstRow+1,fb=!0));return fb?(Tc=Tc.left,ub=I.Range.ld(ub,Tc),ub=this.grid.sc(ub),fb="",null!=ub&&(fb=ub.text),this.JLg(fb,Tc)):W.a.instance.ea(221)};a.prototype.JLg=function(Tc,ub){null==
Tc||ya.a.yj(Tc.trim())?Tc=String.format(W.a.instance.Cb(156),I.Range.sY(ub)):Tc.length>a.TYd?(Tc=Tc.substring(0,a.TYd),Tc=String.format(W.a.instance.Cb(154),Tc)):Tc=String.format(W.a.instance.Cb(155),Tc);return Tc};tl.Object.defineProperties(a.prototype,{Kt:{configurable:!0,enumerable:!0,get:function(){return"PopulateGridContextMenu"}},VA:{configurable:!0,enumerable:!0,get:function(){return U.a.rIf}}});a.bHb="GridContextMenuRootName";a.VVh="gridMenuId";a.lid=192;a.TYd=26;Object(y.a)(a,"GridContextMenu",
z.a,[])},1245:function(y,D,b){function a(pa,Ia){var Ma=ma.call(this,pa)||this;Ma.pCa=null;Ma.EYc=[];Ma.T1d=null;Ma.tva=!1;Ma.ucc=!1;Ma.Wp=null;Ma.B8d=null;Ma.VGe=function(){Ma.mY.NIa(Ma.items,Ma.pCa);Ma.raiseEvent("ACLBUpdated",new x.a(Ma.items.length));Ma.show()};Ma.tableManager=Ia;Ma.domElement.className=m.a.TJe;Ma.domElement.innerHTML="<div id='suggested_cells_list_box' class='ewa-lb ewa-scrollbars' ></div>";W.DOMElementExtensions.setVisible(Ma.domElement,!1);wa.d(Ma.style,Ma.$.isChromeRtl);Ma.xue=
$get(n.bzj,Ma.domElement);Ma.mY=new d(Ma.$,Ma.xue);Ma.QRa(!0);Ma.$.domElement.appendChild(Ma.domElement);Ma.qnb(pa,S.a(pa));Ma.qnb(pa,N.g(pa).Kc);Ma.$.da.Ha(1,Ma);return Ma}function d(pa,Ia){pa=O.call(this,pa,Ia)||this;pa.cellAutoCompleteControl=null;pa.Bqa=null;pa.Kr=[];return pa}function c(pa,Ia){var Ma=P.call(this,pa,Ia)||this;Ma.k0d=null;Ma.hqd=0;Ma.J6a=null;Ma.u0=null;Ma.kLa=!1;Ma.VBb=function(ob,Cb){if(ob=Ma.cellAutoCompleteControl.items)if(1===ob.length&&Ma.cellAutoCompleteControl.qqb.length<
ob[0].zra.length&&Ma.cellAutoCompleteControl.tva&&U.a.eI(ob[0].zra,Ma.cellAutoCompleteControl.qqb)&&(Cb.newValue=ob[0].zra),Ma.qb&&B.EwaSettings.la(135)){var Xa=-1;1<ob.length?Xa=Ma.cellAutoCompleteControl.Fac(Ma.qb.text,!0):1===ob.length&&(Ma.cellAutoCompleteControl.tva||Ma.cellAutoCompleteControl.ucc)&&(Xa=0);if(0<=Xa&&ob.length>Xa&&ob[Xa].HVc){var Sb=w.C(ob[Xa].HVc);Sb&&N.g(Ma.$).Vb.YLa(Sb)&&(Cb.Y9e=!0,Cb.yue=ob[Xa].HVc)}}};Ma.gDb=function(){Ma.kLa&&(Ma.cellAutoCompleteControl.tva=!1)};Ma.qb.BXb(Ma.VBb);
Ma.kLa=B.EwaSettings.isChangeGateEnabled("OfficeVSO:5858567_CellAutoCompletePreserveCase_V3");Ma.kLa&&(Ma.u0=Ma.Nd.Cd(Ma.qb.textBox.domElement),Ma.u0.ja("mousedown",Ma.gDb));return Ma}function k(pa,Ia){this.Tgg=pa;this.Sgg=Ia}function n(){}b.r(D);y=b(0);var l=b(13),f=b(88),u=b(1189),v=b(9),m=b(929);n.bzj="suggested_cells_list_box";Object(y.a)(n,"CssElementIds",null,[]);var A=b(4),x=b(1190);tl.Object.defineProperties(k.prototype,{zra:{configurable:!0,enumerable:!0,get:function(){return this.Tgg}},
HVc:{configurable:!0,enumerable:!0,get:function(){return this.Sgg}}});Object(y.a)(k,"CellAutoCompleteItem",null,[618]);var t=b(5),z=b(84),r=b(1046),G=b(381),w=b(43),B=b(1),U=b(19),N=b(20),P=r.a;vm(c,P);c.prototype.dispose=function(){this.qb.DGd(this.VBb);P.prototype.dispose.call(this)};c.prototype.OT=function(pa){pa&&!this.cellAutoCompleteControl.isListVisible||P.prototype.OT.call(this,pa)};c.prototype.ki=function(pa,Ia){this.cellAutoCompleteControl.qb=this.qb;this.hqd=pa.keyCode;if(this.qb.isEditing){var Ma=
this.qb.text;U.a.equals(this.J6a,Ma,!1)||(this.J6a=Ma)}else this.J6a=null;if(237279923===Ia)return this.cellAutoCompleteControl.isListVisible=!1;B.EwaSettings.la(135)&&17===this.hqd&&this.cellAutoCompleteControl.tva&&(this.cellAutoCompleteControl.ucc=!0);return P.prototype.ki.call(this,pa,Ia)};c.prototype.Uwd=function(){B.EwaSettings.isChangeGateEnabled("OfficeVSO:5172529_CheckForShuttingDownInAutocompletionTimedCallback")&&t.AFrameworkApplication.Gg||(this.cellAutoCompleteControl.qb=this.qb,this.cellAutoCompleteControl.tva=
!1,this.qb.isEditing?U.a.equals(this.J6a,this.qb.text,!0)||this.cellAutoCompleteControl.iHg(this.hqd):this.J6a=null)};c.prototype.Mj=function(){};c.prototype.Rh=function(){this.lV=!1;this.cellAutoCompleteControl.set_visible(!1);this.J6a=null;this.cellAutoCompleteControl.tva=!1;this.cellAutoCompleteControl.ucc=!1;this.cellAutoCompleteControl.S6a&&this.cellAutoCompleteControl.S6a.cancel()};c.prototype.jDd=function(pa,Ia){return this.cellAutoCompleteControl.ki(pa,Ia)};tl.Object.defineProperties(c.prototype,
{pxb:{configurable:!0,enumerable:!0,get:function(){return!1}},lV:{configurable:!0,enumerable:!0,get:function(){return this.cellAutoCompleteControl.isListVisible},set:function(pa){this.cellAutoCompleteControl.isListVisible=pa}},rwb:{configurable:!0,enumerable:!0,get:function(){return!1}},key:{configurable:!0,enumerable:!0,get:function(){return G.a.FYc}},cellAutoCompleteControl:{configurable:!0,enumerable:!0,get:function(){var pa=b(1245).CellAutoCompleteControl;return this.k0d||(this.k0d=Object(z.a)(pa,
this.$.da.Aa(1)))}}});Object(y.a)(c,"CellAutoCompleteListAutoCompleteBehavior",r.a,[]);var ia=b(28);r=b(1191);var W=b(11),R=b(8),I=b(118),Q=b(63),O=r.a;vm(d,O);d.prototype.dispose=function(){O.prototype.dispose.call(this);this.Bqa=null};d.prototype.qxc=function(pa){this.e7(!1);var Ia=""+String.format("<table class='{0}' aria-live='polite'><tbody>",this.rba);for(var Ma=0,ob=this.Kr.length;Ma<ob;Ma++){var Cb=ia.a.If(pa[this.Kr[Ma]].zra);Cb=String.format("<tr><td class='{0}'><span class='{1}' {2}='{3}'>{4}</span></td></tr>",
this.RZ,d.GYc,A.a.ane,Cb,ia.a.b6b(Cb));Ia+=Cb}this.dg.innerHTML=Ia+"</tbody></table>";this.An=W.DOMElementExtensions.vj(this.domElement,this.rba);this.e7(!0);this.hra()};d.prototype.NIa=function(pa,Ia){if(pa&&pa.length){var Ma=[];if(Ia)for(var ob=0,Cb=pa.length;ob<Cb;ob++)U.a.eI(pa[ob].zra,Ia)&&Array.add(Ma,ob);this.Kr=Ma;this.qxc(pa)}else this.isListVisible=!1,this.Bqa=null};d.prototype.qxa=function(){};d.prototype.TOg=function(pa,Ia,Ma){var ob=Math.min(pa,Math.max(200,Ma));Ia&&pa<Ma&&(ob+=I.a.Sp);
W.DOMElementExtensions.Gq(this.dg,ob);Ia&&(ob-=I.a.Sp);return ob};d.prototype.hra=function(){O.prototype.hra.call(this);var pa=W.DOMElementExtensions.vj(this.get_element(),this.rba),Ia=this.Kr.length>this.xH,Ma=N.g(this.$);if(Ma=Ma.sc(Ma.ha.va.activeCell))for(pa=this.TOg(pa.offsetWidth,Ia,Ma.width),Ia=this.dg.getElementsByClassName(d.GYc),Ma=0;Ma<Ia.length;Ma++)Ia[Ma].style.maxWidth=R.HelperMethods.Qb(pa);else l.ULS.sendTraceTag(537167964,0,15,"CellAutoCompleteListBox.AdjustHeightAndWidth: Can't retrive FormattedCell of the Current Active Cell.")};
d.prototype.Glc=function(pa){if(pa=O.prototype.Glc.call(this,pa)){var Ia=N.g(this.$);Ia.Dq(!1);Ia.focus()}return pa};tl.Object.defineProperties(d.prototype,{Nk:{configurable:!0,enumerable:!0,get:function(){return this.Bqa},set:function(pa){this.GAa(this.Nk);this.Bqa=pa;var Ia=this.GAa(this.Nk);this.oe=pa?Ia.innerText:null;this.Lsc(pa)}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return Object(Q.a)(d.prototype,this,"isListVisible")},set:function(pa){Object(Q.b)(d.prototype,this,"isListVisible",
pa);pa||(this.Nk=null)}},nSa:{configurable:!0,enumerable:!0,get:function(){return null}},JFa:{configurable:!0,enumerable:!0,get:function(){return this.cellAutoCompleteControl||(this.cellAutoCompleteControl=this.$.da.Aa(1))}}});d.GYc="ewa-suggested-cell-name";Object(y.a)(d,"CellAutoCompleteListBox",r.a,[]);var ba=b(24),ca=b(59),S=b(119),Y=b(186),na=b(42),Z=b(32),wa=b(247);b.d(D,"CellAutoCompleteControl",function(){return a});var ma=u.a;vm(a,ma);a.prototype.pTc=function(pa){this.addHandler("ACLBUpdated",
pa)};a.prototype.SGd=function(pa){this.removeHandler("ACLBUpdated",pa)};a.prototype.i2=function(pa){this.addHandler("ACLBSelectionChanged",pa)};a.prototype.Mca=function(pa){this.removeHandler("ACLBSelectionChanged",pa)};a.prototype.RAg=function(pa){this.addHandler("ACLBMatchedItem",pa)};a.prototype.W4i=function(pa){this.removeHandler("ACLBMatchedItem",pa)};a.prototype.L2f=function(pa){for(var Ia=0;Ia<pa.length;Ia++){var Ma=pa.charCodeAt(Ia);if(B.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?
U.a.isLetter(Ma):U.a.Imd(Ma))return!0}return!1};a.prototype.JLa=function(){return!this.items};a.prototype.dispose=function(){if(this.$){this.QRa(!1);var pa=N.g(this.$);pa&&pa.view.Wr(this.xlc)}f.a.pc([this.mY,this.S6a]);f.a.pc(this.EYc);this.EYc=this.xue=this.mY=this.qb=null;ma.prototype.dispose.call(this)};a.prototype.ki=function(pa,Ia){var Ma=!1,ob=B.EwaSettings.isChangeGateEnabled("OfficeVSO:5858567_CellAutoCompletePreserveCase_V3");if(this.qqb&&!this.JLa()&&this.get_visible()&&this.isListVisible||
!ob&&267796030===Ia)switch(Ia){case -798660877:if(1===this.items.length&&this.oe)break;this.mt.MA(1);this.raiseEvent("ACLBSelectionChanged",new x.a(this.items.length,this.Fac(this.oe),this.oe));Ma=this.wy(!1);break;case 137938150:if(1===this.items.length&&this.oe)break;this.mt.MA(-1);this.raiseEvent("ACLBSelectionChanged",new x.a(this.items.length,this.Fac(this.oe),this.oe));Ma=this.wy(!1);break;case 2091832999:this.mt.MA(this.xH-1);Ma=this.wy(!1);break;case 742457698:this.mt.MA(-(this.xH-1));Ma=
this.wy(!1);break;case 125627505:this.qb.textBox.caretPosition=this.qb.text.length;this.isListVisible=!1;Ma=!0;break;case 267796030:ob||1!==this.items.length?this.wy(!0):this.Wcc(!0);break;default:Ma=ma.prototype.ki.call(this,pa,Ia)}return Ma};a.prototype.show=function(){this.items&&this.items.length&&(this.mY.Nk=this.oe?this.mt.An.rows[this.Fac(this.oe)]:null,this.isListVisible=0<this.mY.Kr.length,this.XAa(!0),this.mY.qxa())};a.prototype.iHg=function(pa){var Ia=!!this.qb&&!ca.f(this.$.oa);this.ucc=
this.tva=!1;this.qb&&!this.qb.isEditing?this.set_visible(!1):Ia&&!this.J7g(this.activeCell)&&this.Psj(pa)};a.prototype.J7g=function(pa){return!!this.dataValidationControl&&this.dataValidationControl.u5c(pa)};a.prototype.wy=function(pa){if(!this.qb||!this.isListVisible)return!1;var Ia=this.pCa;if(this.oe){var Ma=W.DOMElementExtensions.eZ(W.DOMElementExtensions.vj(this.mY.Nk,d.GYc),A.a.ane,""),ob=Ma.substring(Ia.length,Ma.length);pa?this.qb.text=Ma:this.qb.insertTextAt(ob,Ia.length,this.qb.text.length)}Ma=
N.g(this.$);Ma.xj&&(Ma=Ma.Kc,Ma.text=this.qb.text,Ma.setCaretPosition(this.qb.textBox.caretPosition));pa?this.isListVisible=!1:this.qb.textBox.selectRange(Ia.length,this.qb.text.length);return!0};a.prototype.Fac=function(pa,Ia){Ia=void 0===Ia?!1:Ia;if(!this.mY.An)return-1;for(var Ma=this.mY.An.children[0],ob=Ma.children.length,Cb,Xa=0;Xa<ob;++Xa)if(Cb=Ma.children[Xa],U.a.equals(Cb.innerText.trim(),pa,Ia))return Xa;return-1};a.prototype.Zvg=function(pa,Ia,Ma,ob,Cb,Xa,Sb){var Tb=Ma.originalText.replace(a.Aof,
String.fromCharCode(32)),da=new ba.Range(pa.top-1,pa.left,pa.bottom-1,pa.right,!1,!1),ya=Sb?Sb.wn(Ma.range):null;(!Ma.VJ||Ma.range.left===pa.left)&&1<Tb.length&&!ob.wb(Tb.toUpperCase())&&U.a.eI(Tb,Ia)&&!U.a.equals(Tb,Ia,!0)&&!a.UQe(Ia)&&this.L2f(Tb)&&(!Cb&&!ya||!Cb&&ya.equals(Sb.wn(da))||Cb&&Ma.range.Rd(Xa)&&Ma.range.top!==Xa.top)&&(pa=Ma.formulaBarText,U.a.equals(pa,Ma.text,!1)||!pa)&&(pa={},pa.FirstRow=Ma.range.top-1,pa.FirstColumn=Ma.range.left-1,Ma=new k(Tb,pa),ob.add(Tb.toUpperCase(),Ma))};a.prototype.Psj=
function(pa){this.Wp=this.uSh();this.S6a&&this.S6a.cancel();0<this.qb.text.length&&229!==pa&&pa?this.items&&((1<this.items.length||this.isListVisible)&&this.xdh(),8!==pa&&127!==pa&&46!==pa&&(1===this.items.length?this.Wcc(!1):this.mY.Nk&&this.wy(!1))):this.isListVisible=!1};a.prototype.xdh=function(){this.isListVisible?this.VGe():this.B8d=Y.AsyncMethodContext.Ky(this.VGe,500,na.a.fRg,this.S6a)};a.prototype.Wcc=function(pa){l.ULS.shipAssertTag(537167966,0,!this.JLa()&&1===this.items.length,"Invalid Items");
var Ia=this.items[0].zra,Ma=this.qb.text,ob=Ia.substring(Ma.length,Ia.length);if(pa&&!ob.length)this.qb.text=Ia;else if(!pa&&0<ob.length)this.qb.appendText(ob),this.qb.textBox.selectRange(Ma.length,this.qb.text.length);else return;this.raiseEvent("ACLBMatchedItem",new x.a(this.items.length,0,Ia));this.tva=!0};a.prototype.uSh=function(){this.Wp=null;var pa=new Z.a(!1),Ia=this.activeCell;this.pCa=this.qb.text.replace(a.Aof,String.fromCharCode(32));var Ma=this.tableManager.wn(Ia),ob=Ia.Rd(Ma);if(a.UQe(this.pCa)||
!this.L2f(this.pCa))return this.items;var Cb=new ba.Range(1,Ia.left,Ia.top-1,Ia.left,!1,!1),Xa=new ba.Range(Ia.top+1,Ia.left,v.a.Fh,Ia.left,!1,!1),Sb=N.g(this.$);Xa=Sb.sl("CellAutoCompleteControl.GetSuggestedCells",Xa);try{var Tb=Sb.sl("CellAutoCompleteControl.GetSuggestedCells2",Cb);try{for(var da=yl([Tb,Xa]),ya=da.next();!ya.done;ya=da.next())for(var hb=ya.value;hb.$$mn();){var Gb=hb.$$cu();this.Zvg(Ia,this.pCa,Gb,pa,ob,Ma,this.tableManager)}}finally{Tb&&Tb.dispose()}}finally{Xa&&Xa.dispose()}this.Wp=
Array(pa.values.length);for(Ia=0;Ia<this.items.length;Ia++)this.items[Ia]=pa.values[Ia];this.items.sort(function(Qb,Fb){return Qb.zra.localeCompare(Fb.zra)});return this.items};a.prototype.qnb=function(pa,Ia){pa&&Ia&&Array.add(this.EYc,new c(pa,Ia))};a.UQe=function(pa){pa=0<pa.length?pa.charCodeAt(0):-1;return 35===pa||61===pa||43===pa||45===pa||64===pa};tl.Object.defineProperties(a.prototype,{mt:{configurable:!0,enumerable:!0,get:function(){return this.mY}},qqb:{configurable:!0,enumerable:!0,get:function(){return this.pCa}},
oe:{configurable:!0,enumerable:!0,get:function(){return this.mY.oe}},items:{configurable:!0,enumerable:!0,get:function(){return this.Wp}},S6a:{configurable:!0,enumerable:!0,get:function(){return this.B8d}},activeCell:{configurable:!0,enumerable:!0,get:function(){return N.g(this.$).ha.va.activeCell}},dataValidationControl:{configurable:!0,enumerable:!0,get:function(){return this.T1d||(this.T1d=this.$.da.Aa(14))}}});tl.Object.defineProperties(a,{Aof:{configurable:!0,enumerable:!0,get:function(){return a.j$d||
(a.j$d=new RegExp(String.fromCharCode(160),"g"))}}});a.j$d=null;Object(y.a)(a,"CellAutoCompleteControl",u.a,[580,565,581,3])},1377:function(y,D,b){function a(){this.rb=null;this.Hw=!1}function d(e,C){var M=Ub.call(this)||this;M.vpa=$k.a.MBh;M.SMc=!!window.PointerEvent;M.Yfe=window.hasOwnProperty("ontouchstart");M.hjb=null;M.TUa=null;M.l8=!1;M.AS=new Mj.a;M.Cjb=new Mj.a;M.Lkg=new lc.a;M.Roa=null;M.elb=!1;M.w0d=!1;M.qce=!1;M.JKc=!1;M.bEc=!1;M.q0d=!1;M.dHc=!1;M.YTa=!1;M.Iib=-1;M.BPc=null;M.session=null;
M.handlers=null;M.element=null;M.curRecognizer=null;M.Ud=Fc.EventHandlerManager.instance;M.SMc?(Dd.ULS.sendTraceTag(593893141,310,50,"Using pointer events"),M.hjb=Object(zb.a)(M,M.kmc,"onPointerEvent"),M.TUa=Ve.a.OBh):M.Yfe?(Dd.ULS.sendTraceTag(593893140,310,50,"Using touch events"),M.hjb=Object(zb.a)(M,M.cya,"onTouchEvent"),M.TUa=Ve.a.touchEvents):(Dd.ULS.sendTraceTag(593893139,310,50,"Using mouse events"),M.hjb=Object(zb.a)(M,M.Wlc,"onMouseEvent"),M.TUa=Ve.a.NBh);M.uh=C;M.Kea=e;hd.AFrameworkApplication.ga&&
(M.elb=hd.AFrameworkApplication.ga.ra("UsePointerCaptureIsEnabled"),M.w0d=hd.AFrameworkApplication.ga.ra("ClearCacheOnPrimaryPointerIsEnabled"),M.qce=hd.AFrameworkApplication.ga.ra("ResetHandledBeforeInputHandlerIsEnabled"),M.JKc=hd.AFrameworkApplication.ga.ra("LogCoalescedEventsIsEnabled"),M.bEc=hd.AFrameworkApplication.ga.ra("CheckExistenceOfGetCoalescedEventsIsEnabled"),M.q0d=hd.AFrameworkApplication.ga.ra("CheckIfHammerExistsAfterDownloadIsEnabled"),M.dHc=hd.AFrameworkApplication.ga.ra("HammerJsPerformanceTimersIsEnabled"),
M.YTa=M.elb&&hd.AFrameworkApplication.ga.ra("CancelDragFromGestureInputManagerIsEnabled")&&hd.AFrameworkApplication.ga.ra("UseGestureInputManagerPointerCacheIsEnabled"));return M}function c(){}function k(){this.srcEvent=this.pointerType=this.changedPointers=this.pointers=null;this.maxPointers=this.rotation=this.scale=this.angle=this.distance=this.overallVelocity=this.overallVelocityY=this.overallVelocityX=0;this.additionalEvent=this.center=this.target=null;this.isFinal=this.isFirst=!1;this.deltaTime=
this.timeStamp=this.deltaY=this.deltaX=this.eventType=0;this.offsetDirection=null}function n(e,C,M,qa,Na,Hb,Gc,gd,Uc){e=oa.call(this,e,M,qa,Hb)||this;e.Wfb=C;e.Lfa=Gc;e.pX=gd;e.iRj=Uc;e.Kkg=Na;return e}function l(){this.sFc=null}function f(){this.yca=this.xTe=null}function u(e){var C=pk.call(this)||this;C.$=e;C.dc();return C}function v(e,C,M,qa,Na){var Hb=Rk.call(this)||this;Hb.jO=null;Hb.S_=null;Hb.NEa=null;Hb.Ssc=null;Hb.KLc=null;Hb.uWa=null;Hb.BCc=!1;Hb.Sh=function(){Hb.Nva&&(Hb.gridView?1===Hb.gridView.ha.Te?
(Hb.gridView.ha.va.activeCell.equals(Hb.NEa)||Hb.KM||Hb.wx(),Hb.lnb.Bq()):Hb.wx():Dd.ULS.shipAssertTag(537154141,0,!1,"GridView is null during selection"))};Hb.Mj=function(){Hb.wx()};Hb.od=function(){Hb.EW()};Hb.qd=function(){Hb.wx()};Hb.Vc=function(){Hb.showCallout()};Hb.Oxa=function(){if(Hb.wi.Tk&&Hb.wi.Tk.length)if(Hb.fXc)Hb.wi.Eli||(Hb.BCc=Hb.wi.Tk[0].BlockingDataForExpand),Hb.wi.BIh&&Dd.ULS.sendTraceTag(537154140,0,50,"User clicked pullout launch button before fieldInfo web service returned"),
Hb.showCallout();else if(Hb.gridView.ha.va.Dh){var Gc=Hb.gridView.ha.va.activeCell;if(Gc&&Hb.S_){var gd=Hb.tableManager.wn(Gc);Hb.xJc=!!gd;var Uc=Hb.gridView.ha.va.Qd;gd=Hb.KM&&Hb.S_.Rd(gd);var Wd=Hb.egd&&!Hb.KM&&Uc.equals(Hb.selectedRange);gd||Wd?(Dd.ULS.sendTraceTag(39662912,0,50,"Field TableWidget shown on grid"),Hb.F7b=!0,kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&!Hb.KM&&Hb.tableManager.NJa(Gc)?Dd.ULS.shipAssertTag(537154139,0,!1,"PulloutManager:OnFieldInfoListContextLoaded fetch rich fields for a cell on PivotTable range"):
(kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?Hb.KM?Hb.Nh.aAa(Hb.S_,Hb.KM):Hb.Nh.aAa(Uc,Hb.KM):Hb.Nh.aAa(Hb.S_,Hb.KM),Hb.Frc())):Dd.ULS.shipAssertTag(537154138,0,!1,"PulloutManager:OnFieldInfoListContextLoaded FAILURE")}}};Hb.aj=function(){Hb.v5a()&&Hb.Nh.hide();1===Hb.gridView.ha.Te&&Hb.EW()};Hb.$Q=function(){var Gc=Hb.gridView.ha.Te;Hb.gridView.ha.va.activeCell&&1===Gc&&Hb.EW()};Hb.Ns=function(){if(kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds"))if(Hb.KM){if(Hb.S_&&
Hb.NEa){var Gc=Hb.tableManager.wn(Hb.NEa);Gc&&1<Gc.bottom-Gc.top&&(--Gc.bottom,Hb.gridView.HZ(Gc)&&Hb.lnb.Bq())}}else Hb.gridView.ha.va.Dh&&Hb.gridView.HZ(Hb.gridView.ha.va.Qd)&&Hb.lnb.Bq();else Hb.S_&&Hb.NEa&&Hb.KM&&(Gc=Hb.tableManager.wn(Hb.NEa))&&1<Gc.bottom-Gc.top&&(--Gc.bottom,Hb.gridView.HZ(Gc)&&Hb.lnb.Bq())};Hb.EW=function(){if(Hb.$&&Hb.gridView){if(Hb.F7b&&Hb.KM){var Gc=Hb.gridView.ha.va.activeCell;Hb.S_=Hb.CQe();var gd=!!Hb.Ssc&&Hb.Ssc.contains(Gc);if(Hb.S_&&(Gc.equals(Hb.NEa)||gd)){Hb.Nh.aAa(Hb.S_,
Hb.KM);return}}Hb.F7b=!1;Hb.S_=Hb.CQe();Hb.S_&&Hb.zxa&&Hb.gridView&&Hb.gridView.Ca.Mr(Hb.zxa)?(Hb.fXc=!1,Hb.hZ()):Hb.wi.cYc();Hb.F7b||Hb.Nh.hide()}};Hb.$=e;Hb.tableManager=M;Hb.contextMenuManager=qa;Hb.Nh=new m(e,Hb.Vc,C,Na);Hb.wi=C.T1c(e,M);Hb.fXc=!1;Hb.F7b=!1;Hb.egd=kd.EwaSettings.la(135);Hb.xJc=!0;Hb.gridView=Ye.g(Hb.$);Hb.gridView.Kc.wm(Hb.Mj);Hb.gridView.Nq(Hb.$Q);Hb.$.Rk(Hb.od);Hb.$.Vl(Hb.qd);Hb.$.Yz(Hb.aj);Hb.gridView.view.it(Hb.Ns);Hb.gridView.ha.k2(Hb.Sh);Hb.lnb=Nd.a.instance.create(Hb.EW,
250,Ud.a.EVi);Dd.ULS.sendTraceTag(537154143,0,50,"Feature TableWidget enabled");Hb.wi.GXb(Hb.Oxa);Hb.EW();e.da.Ha(261,Hb);return Hb}function m(e,C,M,qa){var Na=Bk.call(this)||this;Na.isMac=Mf.a.isMac;Na.$=e;Na.ariaLiveNotifier=qa;Na.xp=M.V2b(e,null,C,pc.a.Znh,vh.a.Be(9),fe.a.instance.ea(1684),"PulloutPointerDown");return Na}function A(e){var C=cl.call(this)||this;C.Y2b=null;C.$=e;C.dc();return C}function x(e){var C=dl.call(this)||this;C.$=e;return C}function t(){}function z(e,C,M,qa,Na){M=void 0===
M?null:M;qa=void 0===qa?null:qa;Na=void 0===Na?0:Na;e=G.call(this,e,C)||this;e.OMa=null;e.Vcc=M||vh.a.current.eo(82);e.gif=Na;e.r3c=qa;e.Zwg();return e}function r(e,C,M,qa){e=G.call(this,e,C)||this;e.Yzb=null;e.njg=M;e.I_h=qa;e.$wg();return e}function G(e,C){e=Tk.call(this,e)||this;e.Zzb=null;e.t2h=Math.max(1,C);return e}function w(e,C,M,qa,Na,Hb,Gc,gd){gd=void 0===gd?"":gd;var Uc=ok.call(this)||this;Uc.Eva=null;Uc.j6e=!1;Uc.Jjc=null;Uc.Ijc=null;Uc.buttons={};Uc.JJe={};Uc.$=e;Uc.svgIconProvider=C;
Uc.qAi=M;Uc.Mid=qa;Uc.Lid=Na;Uc.altText=Hb;Uc.lEb=Gc;Uc.buttonText=gd;return Uc}function B(e,C,M,qa,Na,Hb,Gc,gd){function Uc(We){ch.g(We)}var Wd=Oj.call(this,document.createElement("div"))||this;Wd.sgf=null;Wd.MPd=!1;Wd.tRa=null;Wd.cLb=null;Wd.ZE=function(){Wd.raiseEvent("OnObjectButtonMouseOver")};Wd.HH=function(){Wd.raiseEvent("OnObjectButtonMouseOut")};Wd.suj=function(){Wd.Lhe()};Wd.Vc=function(We){Wd.raiseEvent(Wd.lEb,We);Wd.kEb();return!0};Wd.Mxa=function(We){100<nk.a(Xg.a.Ra,Wd.sgf)&&Wd.Bgd(new Sys.UI.Point(Math.round(We.clientX),
Math.round(We.clientY)))};Wd.dN=function(We){ch.g(We.Ea,!1);return!1};Wd.NY=Wd.Nd.ysa();Wd.set_visible(!1);Wd.sgc=Na;Wd.lEb=Hb;Wd.lkc=e;Wd.T0b=C;Wd.sgc&&(Wd.tRa=Nd.a.instance.create(Wd.suj,3E4,"OnObjectButton.ShyTimerFired",!1,!1));e&&Wd.domElement.classList.add(e);Wd.aZa=document.createElement("div");Wd.domElement.appendChild(Wd.aZa);M&&Wd.aZa.classList.add(M);qa&&(Wd.aZa.innerHTML=qa);Gc&&(Wd.cLb=document.createElement("div"),Wd.domElement.appendChild(Wd.cLb),Wd.cLb.classList.add(gd),Wd.cLb.innerText=
Gc,Wd.domElement.style.padding="3px",nj.a.instance.pa(Ve.a.pointerDown,Wd.domElement,Wd.dN));Wd.TYa=new oj.a(Wd.domElement,7);Mg.a.instance.pa(Ve.a.click,Wd.domElement,Wd.Vc);kd.EwaSettings.isChangeGateEnabled("OfficeVSO:4996434_AvoidSelectionFromClickInOOUIPadding")&&nj.a.instance.pa(Ve.a.pointerDown,Wd.domElement,Wd.dN);Wd.wc.ja("mouseup",Uc);Wd.wc.ja("click",Uc);Wd.wc.ja("dblclick",Uc);return Wd}function U(){}function N(e,C,M,qa){var Na=P.call(this,e,C)||this;Na.F0a=null;Na.Htf=function(){Na.Eqc(Na.Htf);
if(Na.Tk&&Na.Tk.length&&Na.contextMenuManager){var Hb=Na.contextMenuManager.Mbd("autoFilterRichFieldList"),Gc=window.document.getElementById(Na.F0a);Hb.VN(null,Gc,Na,null,!0)}};Na.Ugg=M;Na.contextMenuManager=qa;return Na}function P(e,C){var M=Bi.call(this)||this;M.l1=null;M.Utb=null;M.SGb=null;M.DKc=!1;M.HDi=function(qa,Na,Hb){Dd.ULS.sendTraceTag(25264350,0,10,"Call to GetRichValueFieldListContextList failed in: "+Hb);M.SGb&&M.SGb.stop();M.l1=null;M.raiseEvent("GetFieldInfoListContextOperationFailed")};
M.IDi=function(qa){Ch.a(qa)||(M.SGb&&M.SGb.stop(),M.DKc=!1,M.l1=qa.Result,M.l1&&0<M.l1.length&&Dd.ULS.sendTraceTag(25264351,0,50,"Retrieved {0} rich value field list context for autocomplete",M.l1.length),M.GRb=!0,M.nHf())};M.GRb=!1;M.vb=e;M.tableManager=C;return M}function ia(e){var C=Pi.call(this)||this;C.firstElement=null;C.ho=null;C.yLa=!1;C.ds=null;C.moj=Mf.a.zf||Mf.a.xA;C.Ivf=function(M){var qa=M.Ea.keyCode;return qa===Oa.a.$h?C.oCi():qa===Oa.a.hD&&M.Ea.shiftKey?C.jsh(C.firstElement):!1};C.kBf=
function(M){if(!C.yLa||M.Ea.keyCode!==Oa.a.lO)return!1;ia.J5e();Fg.Task.delay(1).CWRCC(function(){C.ho.focus();return!0},C.ma);return!0};C.TMi=function(){document.activeElement&&document.activeElement.id===C.ho.id||(ia.J5e(),Fg.Task.delay(1).CWRCC(function(){C.ho.focus();return!0},C.ma))};C.Otf=function(){C.y6f(C.ho)};C.Hvf=function(M){M.stopPropagation();M.preventDefault();C.yLa&&(C.yLa=!1)};C.$=e;(e=C.$.fa.lc)&&Dd.ULS.sendTraceTag(39350791,0,50,"EmbedViewFocusControl: PermissionSet = {0}; InWebPart = '{1}', InEmbedView = '{2}'",
e.e$,e.inWebPart?"Classic":"Non Classic",e.inEmbedView?"True (+Modern)":"False (not Modern)");e&&(e.inWebPart||e.inEmbedView)?Dd.ULS.sendTraceTag(537153856,0,15,"EwaControl.EmbedViewFocusControl: disable focus grabbing by embedded workbooks and disable some related keyboard navigation. InWebPart = '{0}', InEmbedView = '{1}'",e.inWebPart?"Classic":"Non Classic",e.inEmbedView?"True (+Modern)":"False (not Modern)"):(C.G1g(),C.F2g(),hk.KeyInputManager.instance.pa(Ve.a.Rb,C.$.domElement,C.kBf));C.$.da.Ha(238,
C);return C}function W(e,C,M,qa,Na){Na=void 0===Na?null:Na;var Hb=Ak.call(this)||this;Hb.Emb=null;Hb.hOa=null;Hb.jXc=0;Hb.$mc=null;Hb.vJi=function(){var Gc=Hb.hOa.cWe();Dd.ULS.sendTraceTag(537153861,0,50,"ActionAggregator<{0}>.OnRunningLong: Operation running for more than {1}ms",Hb.Kka,Gc);Hb.$mc=Nd.a.instance.create(Hb.yla,Math.max(Hb.Gse-Gc,0),Ud.a.yhe)};Hb.yla=function(){Dd.ULS.sendTraceTag(537153860,0,50,"ActionAggregator<{0}>.OnTimeout: Operation running for more than {1}ms, timing out. Has pending actions: {2}",
Hb.Kka,Hb.hOa.cWe(),Hb.D4a);Hb.jXc++;Hb.jXc>Hb.Fse&&Dd.ULS.sendTraceTag(537153859,0,50,"ActionAggregator<{0}>.OnTimeout: passed the allowed bypassed count",Hb.Kka);Hb.hOa.Ww.C();Hb.LQe()};Hb.Nxa=function(){Hb.D4a&&Dd.ULS.sendTraceTag(537153858,0,50,"ActionAggregator<{0}>.OnDocumentUnhidden: Start. IsActionOngoing: {1}, AggregatedActionParams not null: {2}",Hb.Kka,Hb.$Ka,Hb.D4a);Hb.lkd()};Hb.Jug=e;Hb.Kug=C;Hb.documentVisibilityObserver=M;Hb.Kka=qa;Hb.aO=Na;M&&Hb.documentVisibilityObserver.hmb(Hb.Nxa);
Hb.iXc=!!M&&kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperation",!1);Hb.Fse=kd.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLimit",3);C=kd.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationThresholdInMs",5E3);Hb.Gse=e.otb(C);e=kd.EwaSettings.getIntFeatureGate("Microsoft.Office.Excel.BypassThrottlingOnOngoingOperationLogThresholdInMs",1E3);Hb.hOg=Math.max(Hb.Gse-C,0)+e;return Hb}
function R(){this.startTime=Xg.a.Ra.Kb;this.Ww=new Kc.a}function I(e){var C=dk.call(this)||this;C.$=e;C.dc();return C}function Q(e,C,M,qa,Na,Hb){var Gc=this;this.$=e;this.functionInfoManager=C;this.calcManager=M;this.pluginScheduler=qa;this.formulaAssistanceUIControl=Na;this.wi=Hb;this.fRa=!0;this.wMa=null;this.vMa=-1;this.Gh=function(){Ye.g(Gc.$).isEditing||Ye.g(Gc.$).zi||Gc.pBb()};this.onFunctionInfoLoaded=function(){Gc.cLj();Gc.jza()};this.Gqf=function(){Gc.fRa=!1};this.Oqf=function(){var gd=Gc.qb,
Uc=gd.text;gd=gd.textBox.caretPosition;ka.instance.Z6(["argumentAssistanceComputation"]);Gc.pluginScheduler.requester().argumentAssistance({content:Uc,caretPosition:gd}).then(function(Wd){0===Wd.kind&&Gc.p2e(Wd.payload)})};this.Rh=function(){Gc.fRa=!0};this.Hg=function(){Gc.J9f()};this.J9f=function(){Gc.pluginScheduler.notifier().setDefinedNamesInfo(Gc.j4b.dEe)};this.$=e;this.functionInfoManager=C;this.formulaAssistanceUIControl=Na;this.pluginScheduler=qa;ka.instance.$=e;this.Xbf=kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest");
this.Maa=kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);this.Yvd=kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");this.Xbf&&(this.j4b=new xb(e),Ye.g(this.$).Ca.np(this.Hg),this.J9f());this.TCa=new S(this.$,this.formulaAssistanceUIControl);this.ppa=new ca(this.$,this.formulaAssistanceUIControl);this.functionInfoManager.lmb(this.onFunctionInfoLoaded);e.da.Ha(464,this);this.calcManager=M;fg.a.bka()&&this.Njd();this.Maa&&
(Ye.g(this.$).rc.hq(this.Rh),this.TCa.Xzg(this.Gqf));this.H4a=kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5724663_OptimizeAutocompleteRenderingUsingCache")}function O(e,C){var M=this;this.wi=e;this.$=C;this.Oxa=function(){M.E7b.resolve(M.wi.Tk);M.b8f();M.ltf||(Ye.g(M.$).rc.hq(M.Rh),M.ltf=!0)};this.ruf=function(){M.E7b.reject(null);M.b8f()};this.Rh=function(){M.wi.sab();Ye.g(M.$).rc.Rp(M.Rh);M.ltf=!1}}function ba(){var e=this;this.promise=new Promise(function(C,M){e.qqg=C;e.$pg=M})}function ca(e,
C){var M=dj.call(this,ca.lJa())||this;M.qb=null;M.Uq=null;M.KHa=!1;M.LHa=!1;M.JHa=!1;M.HHa=!1;M.IHa=!1;M.Cv=null;M.a0=0;M.Aq=null;M.visible=!1;M.bfa=!1;M.vcb=!1;M.fKb=!1;M.eKb=!1;M.TLb=nh.Dismissed;M.dismiss=function(){M.visible=!1;M.Naa&&M.Krd();M.DM&&M.qb.isEditing&&M.Hca();M.Aq=null;M.formulaAssistanceUIControl&&(M.formulaAssistanceUIControl.dismiss(M.domElement),M.Vja&&(M.Uq.canReceiveFocus=!1),M.TLb=nh.Dismissed)};M.jgd=function(){M.ALa&&M.raiseEvent("FAFocusOnSmartSuggestionsCard",null)};M.PBi=
function(){M.dismiss();Ye.g(M.$).Jj.textBox.focus()};M.tQa=function(){var qa={};qa[If.a.O$]="FunctionSuggestions";M.$.Ce(802602464,0,8,qa)};M.vxd=function(qa,Na){M.$db(Na);M.Naa&&(M.LHa=!0)};M.kd=function(){M.set_visible(!1)};M.uxd=function(qa){M.Naa&&(M.IHa=!0);M.f_a(qa.textEdit)};M.Yh=function(){M.dismiss()};M.Ns=function(){void 0!==M.Aq&&null!==M.Aq&&M.Aq()};M.visible=M.get_visible;M.visible=M.set_visible;M.$=e;M.formulaAssistanceUIControl=C;M.Vja=kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5751361_AutocompleteAccessibilityLoop");
M.Vja&&(M.Uq=new Sa(M.$,M.formulaAssistanceUIControl,1,Nf.a.Z$c,M.jgd));Ye.g(M.$).view.it(M.Ns);Ye.g(M.$).ha.jG(M.kd);M.$.xa.Pf(M.Yh);M.AM=fg.a.AM(M.$);M.dmd=kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5523443_FormulaSuggestionsCardUserInteractionTelemetry");M.Jld=M.AM&&kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5543855_EnterCommitsSmartSuggestions");M.Naa=kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5609548_AddAutocompleteCardInteractionTelemetry");M.ALa=kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5793445_FormulaSuggestionsReadout");
M.tld=kd.EwaSettings.isChangeGateEnabled("OfficeVSO:6018145_AutoCompleteDismissFocus");M.zLa=kd.EwaSettings.isChangeGateEnabled("OfficeVSO:6019296_FormulaAutoCompleteShownReadout");return M}function S(e,C){var M=Uh.call(this,S.lJa())||this;M.o2=0;M.Uq=null;M.Aq=null;M.Bka=null;M.visible=!1;M.xQ=!1;M.kd=function(){M.set_visible(!1)};M.onCardModeChange=function(qa){M.cMb(qa);1===qa?ka.instance.Fia.argumentAssistanceCollapseCounter++:ka.instance.Fia.argumentAssistanceExpandCounter++};M.tQa=function(qa){var Na=
{};Na[If.a.O$]="ArgumentAssistanceCard";var Hb={};Hb.FunctionName=qa.functionName;Na[If.a.g9c]=Hb;M.$.Ce(802602464,0,8,Na)};M.Ns=function(){void 0!==M.Aq&&null!==M.Aq&&M.Aq()};M.onDismissClick=function(){ka.instance.Fia.argumentAssistanceDismissCounter++;M.dismiss();M.raiseEvent("DC");M.xQ&&M.VM.clear();kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDefaultToCollapseAfterDismiss",!1)&&!M.o2&&M.cMb(1)};M.Rh=function(){M.xQ&&M.VM.clear()};M.$=e;M.formulaAssistanceUIControl=
C;M.Wm=fg.a.AM(e);M.Maa=kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",!1);M.jMd();M.Uq=new Sa(M.$,M.formulaAssistanceUIControl,0,Nf.a.X$c);Ye.g(M.$).view.it(M.Ns);Ye.g(M.$).ha.jG(M.kd);M.xQ=kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDismiss",!1)&&kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDrag",!1);M.xQ&&(M.VM=new ta(M.formulaAssistanceUIControl),Ye.g(M.$).rc.hq(M.Rh));return M}function Y(e,
C,M,qa,Na,Hb,Gc,gd){var Uc=si.call(this,e)||this;Uc.Zbc=!1;Uc.Uq=null;Uc.KFa=null;Uc.Ah=null;Uc.sV=null;Uc.xpd=null;Uc.c5=null;Uc.Z1a=0;Uc.W8b=0;Uc.p3=0;Uc.uGe=0;Uc.hrb=0;Uc.Pcb=0;Uc.z3b=0;Uc.nvc=!1;Uc.qia=null;Uc.Fnc=null;Uc.columnName="";Uc.v4c=!1;Uc.Tte=!1;Uc.aJa=[];Uc.MP=null;Uc.BRa=[];Uc.Aq=null;Uc.zad=null;Uc.N7=null;Uc.bfa=!1;Uc.vcb=!1;Uc.fKb=!1;Uc.eKb=!1;Uc.wMa=null;Uc.vMa=0;Uc.b_d=null;Uc.Ekd=!1;Uc.jgd=function(){Uc.ALa&&Uc.raiseEvent(Y.F$c,null)};Uc.XPe=function(){Uc.qia=!1;Uc.sV=Uc.qb.text;
Uc.Rf.NIa(Uc.Cv,Uc.sV,!0,Uc.columnName,void 0,!1);1===Uc.Rf.Kr.length&&1===Uc.Rf.YV.length?(Uc.set_visible(!1),Uc.Tte||Uc.Wcc()):Uc.show()};Uc.NEi=function(Wd){if(Ch.a(Wd))-315732528!==Wd.Errors[0].MessageId&&Dd.ULS.sendTraceTag(537162013,0,10,"FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call failed with Unexpected error : {0}",oh.a.Uc(Wd.Errors));else if((Wd=Wd.Result)&&Wd.length){Uc.Ah.r0||(Uc.Ah.r0={},Uc.Ah.r0.HeadersList=[]);Uc.Ah.r0.IsFullTableHeaders=!0;for(var We=0;We<
Wd.length;++We)Uc.Ah.r0.HeadersList[We]={},Uc.Ah.r0.HeadersList[We].Index=We,Uc.Ah.r0.HeadersList[We].Name=Wd[We];Uc.aEf(!0);Uc.sV=Uc.m0e();Uc.Rf.NIa(Uc.Cv,Uc.sV,!0,void 0,void 0,!0);Uc.show()}else Dd.ULS.sendTraceTag(537162012,0,10,"FormulaAssistanceControl.OnGetTableColHeadersSuccess - Webservice call returned no results")};Uc.MEi=function(Wd){Wd=ye.a.yg(Wd.data);Dd.ULS.sendTraceTag(537162011,0,10,"FormulaAssistanceControl.OnGetTableColHeadersFailure - Webservice call failed with Errors: {0}",oh.a.Uc(Wd))};
Uc.Kwd=function(){Ye.g(Uc.$).isEditing||Ye.g(Uc.$).zi||Uc.pBb()};Uc.kd=function(){(kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutocompleteTableColumnHeaders",!1)||Uc.Wm)&&Uc.set_visible(!1)};Uc.juf=function(){Uc.KFa=null;Uc.N7=null};Uc.Yh=function(){Uc.Wm&&Uc.q0a()};Uc.onFunctionInfoLoaded=function(){Uc.inb()};Uc.Oxa=function(){Uc.Hja?(Uc.N7=null,Uc.KFa=null,Uc.inb()):Uc.wi.Tk&&Uc.zpe()};Uc.Qba=function(){Uc.MP&&Mb(Uc.$,Uc.MP.HelpId,Uc.MP.IsDynamicUdf);return!0};Uc.q0a=function(){Uc.Naa&&
Uc.Krd();Uc.DM&&Uc.qb.isEditing&&Uc.Hca();Uc.Aq=null;Uc.formulaAssistanceUIControl&&(Uc.formulaAssistanceUIControl.dismiss(Uc.domElement),Uc.Vja&&(Uc.Uq.canReceiveFocus=!1));Uc.Ekd=!1};Uc.azf=function(){Uc.DM&&Uc.Hca();Uc.f0f();1===Uc.eTf.type&&kd.EwaSettings.ggc()&&!Uc.qb.text.includes("\n")&&(Uc.jCd(Uc.eTf),Uc.fKb=!0)};Uc.onDismiss=function(){Uc.isListVisible=!1;Ye.g(Uc.$).Jj.textBox.focus()};Uc.tQa=function(){var Wd={};Wd[If.a.O$]="FunctionSuggestions";Uc.$.Ce(802602464,0,8,Wd)};Uc.vxd=function(Wd,
We){Uc.Rf.S$f(We);Uc.Naa&&(Uc.LHa=!0)};Uc.uxd=function(Wd){Uc.Naa&&(Uc.IHa=!0);Uc.DM?(Uc.cye(),Ye.g(Uc.$).Jj.endEdit(!0,"FormulaAssistanceControl.OnCompletionItemClicked",0)):Wd.textEdit?Uc.f_a(Wd.textEdit):Uc.wy(!0)};Uc.gridView=Ye.g(e);Uc.functionInfoManager=C;Uc.domElement.className=of.a.TJe;Uc.wi=Hb.T1c(e,M);Uc.j4b=new xb(e);Uc.Csg=M;Uc.formulaAssistanceUIControl=Gc;Uc.pluginScheduler=gd;ka.instance.$=e;Uc.Wm=fg.a.AM(e);Y.hid||(Y.hid=Y.lJa());Uc.domElement.innerHTML=Y.hid;Uc.uwd=RegExp("\\d+");
Vj.d(Uc.style,Uc.$.isChromeRtl);Uc.Dia=new Fb(Uc.$,Uc.domElement,Uc.functionInfoManager,Uc.formulaAssistanceUIControl,Uc.pluginScheduler);C=$get(Za.wad,Uc.domElement);M=$get(Za.rad,Uc.domElement);Hb=$get(Za.yad,Uc.domElement);Uc.Akg=new Xa(Uc.$,C,Hb,M,Uc);Uc.wi.GXb(Uc.Oxa);Uc.functionInfoManager.lmb(Uc.onFunctionInfoLoaded);Uc.functionInfoManager.tAg(Uc.juf);Uc.Wm&&(Uc.$.xa.Pf(Uc.Yh),Uc.Rf.Hle(Uc.azf));Uc.QRa(!0);Uc.n3f(!0);Uc.$.domElement.appendChild(Uc.domElement);Uc.xOc=0;(M=kj.a(e))&&Array.add(Uc.aJa,
new Gb(e,M,Uc));Array.add(Uc.aJa,new Gb(e,Uc.gridView.Kc,Uc));Uc.Ysb=Uc.aJa[0];Uc.Dob=Uc.aJa[Uc.aJa.length-1];e.da.Ha(221,Uc);Uc.calcManager=qa;Uc.instantaneousSupportInformationManager=Na;Uc.instantaneousSupportInformationManager||Uc.$.da.Za(268,function(Wd){Uc.instantaneousSupportInformationManager=Wd});Uc.dPe=kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",!1);Uc.hAa=fg.a.emd();Uc.qwc=fg.a.Ydf();Uc.Yvd=kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5656143_SendCellFormatOnCellChanged");
Uc.tld=kd.EwaSettings.isChangeGateEnabled("OfficeVSO:6018145_AutoCompleteDismissFocus");fg.a.bka()&&Uc.Njd();fg.a.GM(Uc.$)&&C.classList.add("ewa-fb-refactor");Uc.Wm?Ye.g(Uc.$).ha.jG(Uc.kd):Ye.g(Uc.$).ha.k2(Uc.kd);Uc.Vja=kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5751361_AutocompleteAccessibilityLoop");Uc.Vja&&(Uc.Uq=new Sa(Uc.$,Uc.formulaAssistanceUIControl,1,Nf.a.Z$c,Uc.jgd));Uc.ALa=Uc.Wm&&kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5793445_FormulaSuggestionsReadout");Uc.zLa=kd.EwaSettings.isChangeGateEnabled("OfficeVSO:6019296_FormulaAutoCompleteShownReadout");
return Uc}function na(){}function Z(){this.caretPosition=this.content=null}function wa(){this.rowIndex=this.colIndex=0;this.builtIn=this.formatString=this.docName=this.docPath=this.sheetIndex=null}function ma(){this.callbacks=this.completionItems=null;this.activeItemIndex=0}function pa(){this.onDismiss=this.onFeedback=this.onCompletionItemCommitted=this.onCompletionItemSelected=null}function Ia(){this.Y8=this._name=null}function Ma(){this._name=null}function ob(){this._name=null}function Cb(){this.Y8=
this._name=null}function Xa(e,C,M,qa,Na){C=Hi.call(this,e,C)||this;C.Bqa=null;C.dtc=0;C.dKb=0;C.l0c=null;C.DSe=M;C.dtb=qa;C.formulaAssistanceControl=Na;C.Kr=[];C.YV=[];C.Wm=fg.a.AM(e);C.Zbf=C.Wm&&kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5931218_FaAvoidDomOperations");return C}function Sb(){this.textEdit=this.label=null;this.kind=0;this.isPrefixed=this.detail=this.type=null}function Tb(e,C){this.$=e;this.items=C}function da(e,C){this.PTi=e;this.dof=C}function ya(){}function hb(e){this.index=e}
function Gb(e,C,M){var qa=$i.call(this,e,C)||this;qa.uBf=!1;qa.jRa=null;qa.Yid=0;qa.RDc=null;qa.oHa=null;qa.NP=0;qa.formulaAssistanceControl=M;qa.tYa=C.textBox;qa.H4a=kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5724663_OptimizeAutocompleteRenderingUsingCache");qa.Wm=fg.a.AM(e);qa.R2i=kd.EwaSettings.gH();return qa}function Qb(){this.pha=this.csa=this.dsa=!1;this.GBf=40;this.Zwe=41;this.PZa=this.cAd=this.dAd=this.NDb=0;this.Asf=!0;this.Myd=!1;this.VQe=this.uKd=-1}function Fb(e,C,M,qa,Na){var Hb=pi.call(this,
Fb.lJa(fg.a.AM(e)))||this;Hb.B0a=null;Hb.o2=0;Hb.Uq=null;Hb.ZUc=!1;Hb.Aq=null;Hb.Bka=null;Hb.fRa=!0;Hb.xQ=!1;Hb.onCardModeChange=function(Gc){Hb.cMb(Gc);1===Gc?ka.instance.Fia.argumentAssistanceCollapseCounter++:ka.instance.Fia.argumentAssistanceExpandCounter++};Hb.tQa=function(Gc){var gd={};gd[If.a.O$]="ArgumentAssistanceCard";var Uc={};Uc.FunctionName=Gc.functionName;gd[If.a.g9c]=Uc;Hb.$.Ce(802602464,0,8,gd)};Hb.onDismissClick=function(){ka.instance.Fia.argumentAssistanceDismissCounter++;Hb.fRa=
!1;Hb.Vqb();Hb.xQ&&Hb.VM.clear();kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDefaultToCollapseAfterDismiss",!1)&&!Hb.o2&&Hb.cMb(1)};Hb.Rh=function(){Hb.fRa=!0;Hb.xQ&&Hb.VM.clear()};Hb.hDi=function(Gc){!Gc.button&&Gc.target&&(ch.g(Gc),Hb.B0a&&Hb.B0a.ona(Gc))};Hb.Ns=function(){void 0!==Hb.Aq&&null!==Hb.Aq&&Hb.Aq()};Hb.$=e;Hb.Ui=C;Hb.functionInfoManager=M;Hb.formulaAssistanceUIControl=qa;Hb.pluginScheduler=Na;Hb.Wm=fg.a.AM(e);Hb.Maa=Hb.Wm&&kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ArgumentAssistanceDismiss",
!1);Hb.Wm?(Hb.jMd(),Hb.Uq=new Sa(Hb.$,Hb.formulaAssistanceUIControl,0,Nf.a.X$c),Hb.Maa&&Ye.g(Hb.$).rc.hq(Hb.Rh),Hb.xQ=kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDismiss",!1)&&kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FormulaAssistanceDrag",!1)&&!!Hb.formulaAssistanceUIControl,Hb.xQ&&(Hb.VM=new ta(Hb.formulaAssistanceUIControl))):(Hb.B0a=new Yb(Hb.domElement,Hb.$.Ay,void 0,fg.a.GM(Hb.$)),Hb.wc.ja("mousedown",Hb.hDi),e=$get(Za.wad,Hb.Ui),Hb.Ui.insertBefore(Hb.domElement,
e));Ye.g(Hb.$).view.it(Hb.Ns);return Hb}function ta(e){this.Bt=!1;this.M8b=e;this.ZAc=this.M8b.getWindowEdgeBuffer()+1}function xa(){this.content=null;this.caretPosition=0}function sa(){this.callbacks=this.functionRenderingInfo=null;this.cardMode=0}function lb(){this.onDismissClick=this.onFeedback=this.onHelpLink=this.onCardModeChange=null}function Yb(e,C,M,qa){qa=void 0===qa?!1:qa;C=Eh.call(this,e,C,!1,void 0===M?null:M)||this;C.SQa(qa);C.fj=K.a.equals("rtl",e.dir,!0);return C}function Fa(e,C){var M=
bi.call(this)||this;M.Fkg=[];M.Aad={};M.GSe={};M.uS=null;M.k8=[];M.hJa={};M.yuf=function(qa,Na){Dd.ULS.sendTraceTag(537161987,0,50,"FunctionInfoManager.OnGetFunctionListPartialSucceeded");M.kuf(qa,!!Na&&1!==Na.FilterType,!0)};M.xuf=function(){Dd.ULS.sendTraceTag(537161986,0,50,"FunctionInfoManager.OnGetFunctionListPartialFailed -  reset varaible to ensure we will re-issue the webservice call");M.uS=null};M.huf=function(qa){Dd.ULS.sendTraceTag(537161985,0,50,"FunctionInfoManager.OnFullFunctionListLoaded - full list was loaded");
M.VEd(qa.Jia,!0,!1)};M.wuf=function(qa){Dd.ULS.sendTraceTag(537161984,0,50,"FunctionInfoManager.OnGetFunctionListFullSucceeded");M.kuf(qa,!0,!1)};M.UIc=!1;M.SIc=!1;M.vb=e;M.pluginScheduler=C;M.$.da.Ha(19,M);return M}function Sa(e,C,M,qa,Na){this.TXc=!1;this.$=e;this.formulaAssistanceUIControl=C;this.gSe=M;this.cej=qa;this.S2e=void 0===Na?null:Na}function Ra(e,C,M){var qa=ci.call(this)||this;qa.xad=e;qa.JKd=C;qa.XOi=M;return qa}function Lb(e){var C=Jh.call(this)||this;C.JKd=e;return C}function Ja(e,
C){var M=uh.call(this)||this;M.functionName=e;M.xad=C;return M}function xb(e){this.eEe={};this.$=e}function Kb(){this.sheetName=this.namedRange=this.tooltip=this.name=null;this.type=0}function Eb(){this.xS=0;this.h6d=!1;this.SUa=this.D7d=null;this.k7d=!1;this.textEdit=null}function Hc(e){var C=this;this.oqb=this.Yga=this.calcManager=this.qb=null;this.l8a=function(){C.W3a(!1,!1)};this.$=e;this.Xsb=new Pc(e);this.K8b=new Tc(e);this.L8b=new Xc(this);Ye.g(e).Kc.hq(this.l8a);this.$.da.Ha(317,this)}function Xc(e){this.k7=
0;this.Y$c=e}function Pc(e){this.Lpa=this.SRa=this.Z0a=this.zP=this.h$=this.qb=null;this.Zgd=!1;this.Nc=e}function wd(){}function Tc(e){var C=this;this.pri=30;this.calcManager=null;this.Ld=!1;this.iOa=this.$Db=this.w9a=null;this.Nx=function(){C.$ga.uZ()};this.$=e;this.$ga=new fb;this.XOf=-1;this.$.fa.ED(this.Nx)}function ub(e,C,M,qa,Na,Hb,Gc){Gc=e.Oa(1,void 0===Gc?null:Gc);Gc.getPartialCalcResultsParameters=C;return vf.i(e,"GetPartialCalcResults",Gc,M,qa,Na,Hb,4)}function fb(){this.RPa={}}function Ta(e){var C=
ac.call(this)||this;C.$=e;C.dc();return C}function eb(e,C){var M=this;this.gJa=this.dua=this.Eia=null;this.Qxf=function(qa,Na){M.$Yi(Na.functionName,Na.xad)};this.Sxf=function(qa,Na){M.ZYi(Na.xad,Na.JKd,Na.XOi)};this.Rxf=function(qa,Na){qa=[];Na=yl(Na.JKd);for(var Hb=Na.next();!Hb.done;Hb=Na.next())Hb=Hb.value,(!M.G4a||void 0!==Hb&&null!==Hb)&&(Hb=Hb.trim())&&Array.add(qa,Hb);if(!M.G4a||qa.length){Na="";for(Hb=0;Hb<qa.length;Hb++){var Gc=M.$Wc(qa[Hb]),gd=eb.ABd(Hb,qa.length);Na+=Gc+gd;gd&&(Na+=M.ariaLiveNotifier.Zwa)}M.ariaLiveNotifier.readText(Na)}};
this.Txf=function(qa,Na){M.ariaLiveNotifier.bZi(Na.XH,Na.description,Na.selectedIndex.toString(),Na.length.toString(),M.zLa)};this.Mxf=function(qa,Na){M.ariaLiveNotifier.HIf(Na.description,Na.length)};this.duf=function(){M.ariaLiveNotifier.q$a(fe.a.instance.ea(862),If.a.FFa)};this.Xtf=function(){M.ariaLiveNotifier.readText(fe.a.instance.ea(863))};this.$tf=function(){M.ariaLiveNotifier.readText(fe.a.instance.ea(864))};this.$=C;this.ariaLiveNotifier=e;this.$.da.Ha(219,this);this.G4a=fg.a.AM(C);this.ALa=
fg.a.AM(C)&&kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5793445_FormulaSuggestionsReadout");this.zLa=kd.EwaSettings.isChangeGateEnabled("OfficeVSO:6019296_FormulaAutoCompleteShownReadout")}function tb(e){return jb.call(this,e)||this}function rc(e,C,M){var qa=this;this.nzh="FinancialFns LogicalFns TextFns DateTimeFns LookupReferenceFns MathTrigFns StatisticalFns EngineeringFns CubeFns InformationFns".split(" ");this.menuId=null;this.onFunctionInfoLoaded=function(){qa.menuId&&Array.contains(qa.nzh,
qa.menuId)&&qa.frame.Aw(qa.menuId)};this.$=e;this.functionInfoManager=M;this.Sa=C;this.LL={};this.frame=this.$.frame;this.functionInfoManager.lmb(this.onFunctionInfoLoaded)}function wb(e,C){var M=va.call(this,e,fe.a.instance.ea(1E3),void 0,void 0,void 0,kd.EwaSettings.la(406))||this;M.fJa=null;M.Iia=null;M.eJa=null;M.ftb=null;M.ASe=null;M.Hia=null;M.BSe=null;M.ESe=null;M.iif=null;M.etb=null;M.ihd=!1;M.b0b=null;M.v5=null;M.Nvb=null;M.onFunctionInfoLoaded=function(){if(!M.eJa.count){for(var qa=M.functionInfoManager.vSe,
Na=0,Hb=qa.length;Na<Hb;++Na)M.eJa.AL(qa[Na],qa[Na],!1).className=bk.a.Gjh;M.eJa.selectedIndex=0;ff.a.pc([M.b0b,M.v5,M.Nvb]);M.b0b=M.Nd.Cd(M.fJa);M.v5=M.Nd.Cd(M.Iia);M.Nvb=M.Nd.Cd(M.etb);M.b0b.ja("change",M.iuf);M.v5.ja("change",M.iDi);M.v5.ja("dblclick",M.jDi);M.Nvb.ja("click",M.Qba);M.Nvb.ja("keyup",M.gFi);Le.DOMElementExtensions.setVisible(M.Iia,!0);Le.DOMElementExtensions.setVisible(M.ASe,!1);M.$.I3c&&Le.DOMElementExtensions.setVisible(M.iif,!0)}M.iuf(null);M.getButton(0).get_element().disabled=
!1;M.fJa.disabled=!1;M.zIb();M.ihd=!0};M.Qba=function(){M.o$&&Mb(M.$,M.o$.HelpId,M.o$.IsDynamicUdf)};M.gFi=function(qa){13!==qa.keyCode&&32!==qa.keyCode||M.Qba(qa)};M.iuf=function(){var qa=M.functionInfoManager.RWe(M.eJa.oe.value);M.kua(qa);M.Iia.scrollTop=0;M.WUf()};M.iDi=function(){M.WUf()};M.jDi=function(qa){M.o$&&(ch.g(qa),M.close(0))};M.Zc=function(qa,Na){Sg.b(Na)&&M.ou()};M.functionInfoManager=e.da.Aa(19);M.formulaAssistanceControl=e.da.Aa(221);M.cIa=C;M.xYc=C.textBox.caretPosition;return M}
function E(e){var C=Mi.a.Fba,M=e.da.Aa(368);M&&!Ye.g(e).xj&&(C=M.zoom);return C}function Mb(e,C,M){if(e)if(ka.instance.Fia.argumentAssistanceLearnMoreCounter++,M){if(C&&(!C||C.startsWith("http://")||C.startsWith("https://"))){if(e.la(156)&&(e=e.da.Aa(269))&&e.PAa(C))return;ab.HelperMethods.sf(C,"_blank",V.a)}}else{M=new Bf.a(-859308420,eg.a.Wb,e.ed,0,null);var qa={};C=(qa[eg.a.hd]=If.a.XU,qa[eg.a.Kg]="HelpID="+C,qa);e.Ka.Zb(M,C)}}function ka(){var e=this;this.Fia=new dc;this.P8b=new Xb;this.q2=new $a;
this.znb=new kb;this.vb=null;this.Btc=new Ua;this.qd=function(){e.rlj();e.vb.sendBeaconTraceTag(88392384,50,!1,"{0}",e.getJsonForLogging())};this.x9a=new Mj.a}function bb(e){var C=this;this.Hmf=e;this.s_=new Ha;this.I5b=[];this.njc=-1;(this.Gmf=kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5999949_formulaTelemetryMetriThresholds"))&&e&&(this.s_.countAboveThresholds={},e.forEach(function(M){return C.s_.countAboveThresholds[M]=0}))}function Ga(){this.P95=this.P75=this.median=this.max=this.average=0}
function Ha(){this.firstAction=this.failedCount=this.count=0;this.excludingFirstAction=this.includingFirstAction=null}function Ua(){this.smartFormulaBarAutoCompleteFlight=this.autoCompleteUIFlight=this.argumentAssistanceFlight=null}function kb(){this.formulaAssistanceRequestOptimizedCounter=this.formulaAssistanceRequestAttemptedCounter=0}function $a(){this.commitByMouseClickCounter=this.commitByEnterKeyCounter=this.commitByTabKeyCounter=this.selectByMouseHoverCounter=this.selectByArrowKeyCounter=
0}function Xb(){this.smartSuggestionCommittedCounter=this.smartSuggestionSelectedCounter=this.smartSuggestionShownCounter=0}function dc(){this.argumentAssistanceCardInitialMode=null;this.argumentAssistanceDismissCounter=this.argumentAssistanceLearnMoreCounter=this.argumentAssistanceExpandCounter=this.argumentAssistanceCollapseCounter=0}function Za(){}function Wa(e){var C=yk.call(this)||this;C.$=e;C.dc();return C}function Ba(e){var C=Ik.call(this,document.createElement("div"))||this;C.LQ=!1;C.pQ=!1;
C.q_b=!1;C.Eh=null;C.Oh=null;C.z$h=kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataValidationConditionalHideAll",!1);C.A$h=kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataValidationConstButtonWidth",!1);C.oci=kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5862418_LogDataValidationButtonWidth");C.jhi=kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.VisibilityOptimizationOnTaggedElements",!1);C.Kmd=!1;C.Gnd=!1;C.Nkd=!1;C.V3b=[];C.Gh=function(){C.m_f(!1)};
C.VNa=function(qa,Na){C.show(C.CQ,!C.isListVisible,!0,Mf.a.Pr||3===Na.zb||3===eg.a.Wb);C.Axd(null,null)};C.Axd=function(){C.gridView.setFocus()};C.JKa=function(){C.qb.textBox.QJ=!0};C.Ns=function(){C.y$f()};C.onContentReady=function(){C.m_f(C.isListVisible)};C.qd=function(){C.wx()};C.Zxa=function(){C.CQa()};C.itf=function(){C.y$f()};C.$=e;C.gridView=Ye.g(C.$);C.yI=C.gridView.Kc;var M="<div id='dv_reader_description' class='"+fk.a.NKe+"' role='alert' aria-live='polite'></div>\r\n<div id='dv_list_button' class='"+
za.Wjh+" "+pc.a.yu+"'></div>\r\n<div id='dv_list_box' class='"+za.bjh+" "+pc.a.Ir+" "+pc.a.yu+"'></div>\r\n<div id='dv_prompt_box' class='"+za.Ujh+" "+pc.a.yu+"'></div>";C.domElement.className=za.Vjh;C.domElement.innerHTML=M;Vj.d(C.style,C.isGridRtl);C.dg=$get("dv_list_box",C.domElement);C.$V=$get("dv_prompt_box",C.domElement);C.Vga=$get("dv_list_button",C.domElement);C.T6a=$get("dv_reader_description",C.domElement);C.jhi&&(C.domElement.setAttribute(Lg.a.CYa,"true"),C.dg.setAttribute(Lg.a.CYa,"true"),
C.$V.setAttribute(Lg.a.CYa,"true"),C.Vga.setAttribute(Lg.a.CYa,"true"),C.T6a.setAttribute(Lg.a.CYa,"true"));(M=kj.a(e))&&Array.add(C.V3b,new Jb(e,M,C));Array.add(C.V3b,new Jb(e,C.gridView.Kc,C));C.gridView.ha.fG(C.Gh);C.gridView.Nq(C.onContentReady);C.gridView.rc.aAg(C.itf);C.$.Vl(C.qd);M=C.gridView.Ui;M.insertBefore(C.domElement,M.firstChild);C.onContentReady(null,null);e.da.Ha(14,C);return C}function db(e,C,M,qa,Na,Hb,Gc,gd,Uc,Wd){var We=Gk.call(this,document.createElement("a"))||this;We.pl=!1;
We.Vc=function(Gf){We.raiseEvent("ClickButton",Gf);return!0};We.onKeyDown=function(Gf){We.raiseEvent("KeyDown",Gf);return!1};We.hw=function(){We.hovered=!0;We.raiseEvent("PointerOver");return!1};We.kN=function(){We.hovered=!1;We.raiseEvent("PointerOut");return!1};We.onBlur=function(Gf){ch.g(Gf);We.focused=!1;We.raiseEvent("Blur")};We.onFocus=function(Gf){ch.g(Gf);We.focused=!0;We.raiseEvent("Focus")};We.fgh=gd;We.Qah=Uc;We.EI=db.yb(We.domElement,C,M,qa,Na,Hb,Gc,Wd);We.wc.ja("contextmenu",function(Gf){ch.g(Gf)});
We.enable();We.hovered=!1;We.focused=!1;e.appendChild(We.domElement);return We}function Zb(e,C,M){e=ak.call(this,e,C,new xk.a(za.listItem,za.Pzb,za.Szb,za.Tzb))||this;e.qkb=null;e.oe=null;e.bda=null;e.xV=null;e.tHa=null;e.Swa=0;e.CDb=[];e.O9f=kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UpdateDvListHeightUsingItemHeight",!1);e.Fmi=kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5858877_logDvListBoxHeight");e.T6a=M;return e}function Jb(e,C,M){e=Fj.call(this,e,C)||this;e.dataValidationControl=
M;return e}function Ic(e,C,M){var qa=wk.call(this,e)||this;qa.t$=null;qa.sU=null;qa.jdf=!1;qa.errorMessage=null;qa.h5e=null;qa.xm=null;qa.zda=null;qa.lDe=function(Na){var Hb=qa.$,Gc=qa.jdf;qa.hide();var gd=Ye.g(Hb);gd.isEditing&&gd.Kc.endEdit(!1,"DataValidationErrorDialog.DataValidationErrorDialogHandler",0);1===Na&&Gc&&wf.TaskExtensions.Ba(gd.startEdit(!1,1),function(){var Wd=gd.Kc.textBox;Wd.text&&Wd.selectRange(0,Wd.text.length)},qa.ma,11,Te.a.current);if(1===Na&&!Gc){if(Gc=gd.sc(null)){gd.Ca.gV();
var Uc=Object.assign(new Rh.a,{Text:kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5785565_FixDataValidationErrorDialogHandlerBug")?Gc.cell.userInput:Gc.originalText});gd.setCell(Uc,Gc.range,0,63,null)}Hb.Ce(-798660877,eg.a.Wb,8,null)}2===Na&&wf.TaskExtensions.Ba(gd.startEdit(!1,0),function(){var Wd=gd.Kc.textBox;Wd.text&&Wd.selectRange(0,Wd.text.length)},qa.ma,11,Te.a.current)};qa.n8a=function(){ab.HelperMethods.Xba(qa.$.pI,qa.error.HelpTopicId,qa.$.aX)};qa.ZEi=function(){qa.Xvb();qa.$.Ce(802602464,
2,8,qa.sU)};qa.ADi=function(){Dd.ULS.sendTraceTag(537163288,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationFailureCallback, failed to get expected results.")};qa.BDi=function(Na){!Na||Ch.a(Na)?Dd.ULS.sendTraceTag(537163287,0,10,"DataValidationErrorDialog.OnGetDataValidationRuleInformationSuccessCallback, failed to get expected results."):(Na=qa.CQh(Na.Result),qa.t$.errorInformation=Na,qa.zzc(qa.oIa,qa.zed(qa.lDe),qa.t$))};qa.Pxd=function(){qa.show(qa.iQb)};qa.xJe=M;qa.sqmManager=
Ok.a(qa.$);qa.error=Ic.iQ(C,e,M);qa.Ab.Ap=qa;e=e.da.Aa(14);qa.su=e.v2a(qa.xJe);qa.oIa=qa.su&&qa.su.oIa?qa.su.oIa:fe.a.instance.ea(1680);qa.Yhj();qa.initializeAndShow(qa.oIa,qa.lDe,qa.t$);return qa}function uc(e,C,M){var qa=gk.call(this,e,uc.iQ(C,e,M))||this;qa.kd=function(){qa.setFocus()};Ye.g(qa.$).ha.jG(qa.kd);kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5780477_datavalidationListRule")&&(e=e.da.Aa(14).v2a(M))&&e.options&1&&Dd.ULS.sendTraceTag(537163291,0,50,"DataValidationErrorDeprecatedDialog.DataValidationErrorDeprecatedDialogs, Data validation Error opened on a list rule.");
return qa}function za(){}function pb(e){var C=vk.call(this)||this;C.$=e;C.dc();return C}function cc(e,C){var M=this;this.zYa=null;this.Nxf=function(qa,Na){1<Na.length&&(qa=fe.a.instance.ea(837),M.ariaLiveNotifier.HIf(qa,Na.length))};this.Oxf=function(qa,Na){Dd.ULS.shipAssertTag(537167961,0,0<=Na.selectedIndex&&0<=Na.length&&Na.selectedIndex<Na.length,"Invalid ListEventArgs: SelectedIndex/Length");Dd.ULS.shipAssertTag(537167960,0,!!Na.XH,"ListEventArgs: SelectedValue should not be null");M.ariaLiveNotifier.aZi(Na.XH,
Na.selectedIndex+1,Na.length)};this.Pxf=function(qa,Na){M.ariaLiveNotifier.ePa(Na.XH)};this.ariaLiveNotifier=e;C.Ha(213,this)}function Ac(e){var C=Ek.call(this)||this;C.$=e;C.dc();return C}function ad(e){var C=Ij.call(this)||this;C.$=e;C.dc();return C}function Jd(e,C){var M=this;this.xMa=1;this.aga=[];this.active=!1;this.iw=function(){var qa=M.gridView.vfd();if(!(0>=qa||qa===M.xMa||M.gridView.Cq)){for(var Na=!1,Hb=[],Gc=[],gd=M.aga.length-1;0<=gd;gd--){var Uc=M.aga[gd];if(M.ufd(Uc)>qa||Uc.bottom<
qa)Array.add(Hb,Uc),Array.removeAt(M.aga,gd),Na=!0}for(gd=M.tableManager.rangeList.length-1;0<=gd;gd--){Uc=M.tableManager.rangeList[gd];var Wd=M.ufd(Uc);Wd<=qa&&Uc.bottom>=qa&&!(Wd<=M.xMa&&Uc.bottom>=M.xMa)&&Uc.mva&&(Array.add(Gc,Uc),Na=!0)}if(Na)for(Uc=kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ApplyHeaderSnappingOnVerticalFreezePane",!1)?M.gridView.unc:[M.gridView.K2],gd=yl(Uc),Uc=gd.next();!Uc.done;Uc=gd.next())for(Wd=yl(Uc.value),Uc=Wd.next();!Uc.done;Uc=Wd.next()){var We=yl(Uc.value);
for(Uc=We.next();!Uc.done;Uc=We.next()){for(var Gf=Uc.value,xg=Gf.No,Hg=uk.a(Gf.q4),Ig=Hb.length-1;0<=Ig;Ig--)Uc=Hb[Ig],M.jyc(Uc,!1,Hg,xg)&&Array.removeAt(Hb,Ig);for(Ig=Gc.length-1;0<=Ig;Ig--)Uc=Gc[Ig],M.jyc(Uc,!0,Hg,xg)&&Array.add(M.aga,Uc);Na&&Gf.iMd(Hg)}}else Dd.ULS.sendTraceTag(537157657,0,50,"HeaderSnappingFeature:OnVisibleAreaChanged: detected an opportunity for bailing out");M.xMa=qa}};this.Zuf=function(qa,Na){Na.isRow||Na.OTc(M.rKa)};this.$uf=function(qa,Na){Na.isRow||(M.tableManager.rangeList.length||
M.deactivate(),Na.oHd(M.rKa))};this.rKa=function(qa,Na){if(M.te())M.activate();else if(qa=M.active,M.deactivate(),!qa){Dd.ULS.sendTraceTag(537157652,0,50,"HeaderSnappingFeature:HeaderBlockOnUpdatedBlockHtml: detected an opportunity for bailing out");return}(Na=Na.WU)&&M.m1f(Na.No[0],Na.No[Na.No.length-1],Na.q4,Na.No)};this.Hxf=function(qa,Na){!M.gridView.Cq&&(M.te()?M.activate():(qa=M.active,M.deactivate(),qa||Dd.ULS.sendTraceTag(537157651,0,50,"HeaderSnappingFeature:OnRangeListUpdated: detected an opportunity for bailing out")),
Na=Na.WU)&&(qa=uk.a(Na.q4),M.m1f(Na.No[0],Na.No[Na.No.length-1],qa,Na.No)&&Na.iMd(qa))};this.Oe=function(){M.gridView.$a.n4?M.deactivate():M.activate()};this.tableManager=e;this.gridView=C;this.$=C.$;e.wle(this.Hxf);C.zAg(this.Zuf);C.AAg(this.$uf);this.$.xa.Pf(this.Oe);this.$.xb.Pf(this.Oe);this.Poe(function(qa){qa.OTc(M.rKa)});this.te()&&(this.activate(),this.iw(this,null));this.$.da.Ha(68,this)}function Xd(e){return Qk.call(this,e)||this}function od(e,C,M,qa,Na,Hb){var Gc=this;this.LD=null;this.hZa=
1461300262;this.zB=this.dZa=this.t7a=this.J8b=null;this.HFi=function(gd,Uc){if(!Ch.a(gd)&&Uc){var Wd=!!gd&&!!gd.RequestTelemetryData;Ye.g(Gc.$).Ji.Pka(Uc,gd.StateId,Wd?gd.RequestTelemetryData.EcsOperationDuration:0,Wd?gd.RequestTelemetryData.EcsRequestDuration:0,Wd?gd.RequestTelemetryData.WfeRequestDuration:0)}};this.Xob=function(){if(Gc.gridView.c5a){var gd=Gc.$.da.Aa(254,!0);gd&&gd.D5i(Gc.Xob);Gc.gridView.c5a=!1;Gc.gridView.Bh.Rt(If.a.taa);Gc.gridView.ha.L_(Gc.W$c);Ye.g(Gc.$).$.Gf()}};this.W$c=
function(){var gd=Gc.J8b;Gc.J8b=ih.d(Gc.$.xa.oa);if(gd===Gc.J8b)if(Gc.gridView.ha.L_(Gc.W$c),(gd=Gc.$.da.Aa(254,!0))&&gd.SXc(36,Ye.g(Gc.$).ha.va.selectedRanges)){gd=new Bf.a(1804571062,2,2,0,null);var Uc={};Gc.$.Ka.Zb(gd,(Uc[If.a.skipClipboardAccess]=!0,Uc[If.a.xZc]=!0,Uc[If.a.isFormatPainter]=!0,Uc)).continueWith(function(){Gc.Xob()})}else Gc.gridView.Bh.qG(!1)};this.$=e;this.gridView=C;this.hi=M;this.UA=qa;this.borderFormatManager=Na;this.moreColorsHelper=Hb;this.Lxh=new Ce(this.$);this.zg=kd.EwaSettings.zg();
this.wjc=new Je(this.$,M);this.qH=kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)}function Je(e,C){this.$=e;this.hi=C;this.gY=new Yd(Ye.g(this.$).Ca,this.$);this.Ncf=kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5412627_MergeCellRangeBorderScenariosTelemetry");this.kxb=kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5607672_MergeCellCseForOutOfViewPortCells");this.Pmd=kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5658006_MergeCellCSEBugFixesforCellStylesAndRTL");this.ofc=
kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5954689_MergeCellCSEUnmergewithMergeCommand")}function bc(){this.scenario=0;this.RIa=null}function Qd(){this.XPa=this.RFa=this.FMa=this.pSa=0}function Vd(e,C,M,qa){this.targetSheetRange=this.sourceSheetRange=null;this.fillRangeDirection=this.fillRangeType=0;this.sourceSheetRange=e;this.targetSheetRange=C;this.fillRangeType=M;this.fillRangeDirection=qa}function de(e,C,M){var qa=Rj.call(this,e)||this;qa.Xn=null;qa.R4c=0;qa.j6h=function(Na,Hb){if(Na){Na=
{};var Gc="",gd=1035996630;switch(Hb.selectedKey){case 0:Gc=1896159024===qa.$o?"InsertCellsShiftRight":"DeleteCellsShiftLeft";break;case 1:Gc=1896159024===qa.$o?"InsertCellsShiftDown":"DeleteCellsShiftUp";break;case 2:1896159024===qa.$o?(Gc="InsertRows",gd=-1113896058):(Gc="DeleteRows",gd=1554436520);break;case 3:1896159024===qa.$o?(Gc="InsertColumns",gd=1415868706):(Gc="DeleteColumns",gd=674605324)}Dd.ULS.sendTraceTag(574993490,0,50,"InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: Handle RibbonCommand.InsertOrDeleteCells, MenuItemId:{0}",
Gc);Hb=new Bf.a(kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5933270_RespectProtectionSettingsInInsertDeleteDialog")?gd:1035996630,1,2,8,null);Na[eg.a.hd]=Gc;qa.$.Ka.Zb(Hb,Na)}else Dd.ULS.sendTraceTag(574993491,0,50,"InsertDeleteCellsDialog.InsertDeleteCellsDialogHandler: User pressed Cancel")};qa.$o=C;qa.selectedRanges=M;e=Object(qc.a)(ji.a,qa.$.xa.oa);qa.isRtl=e.displayRtl;return qa}function pe(e,C,M,qa,Na,Hb){var Gc=this;this.uYd=!1;this.vYd=null;this.CBc=0;this.ej=null;this._state=0;this.moveNext=
function(){try{for(Gc._state=1;1===Gc._state;)Gc.hu=Gc.hu()}catch(gd){Gc.dispose(),Gc._state=3}};this.wf=e;this.EBa=C;this.DBa=this.iYd=Na;this.yNb=Hb;this.hu=this.fL;this.moveNext()}function Ad(e,C,M,qa,Na,Hb,Gc,gd){var Uc=this;this.zBc=0;this.xYd=this.DBc=!1;this.ej=this.zYd=null;this._state=0;this.moveNext=function(){try{for(Uc._state=1;1===Uc._state;)Uc.hu=Uc.hu()}catch(Wd){Uc.dispose(),Uc._state=3}};this.wf=e;this.EBa=C;this.bdg=Na;this.DBa=this.iYd=Hb;this.yNb=Gc;this.hYd=gd;this.hu=this.fL;
this.moveNext()}function Pd(e,C,M,qa){this.ykg=e;this.zkg=C;this.osg=M;this.eVb=qa}function Ce(e){var C=this;this.qIi=function(M){C.Ccf=!0;C.POg=null;C.$.rE(function(qa){qa.IOa("FontName_New")});Dd.ULS.sendTraceTag(537159511,1,15,String.format("PreviewFont Status is {0}",M))};this.$=e;this.n9h=!!String.fromCodePoint&&!Mf.a.Af&&!!window.gridRenderer&&gridRenderer.CanvasRendererGlobals.isFontLoadApiSupported();this.Ccf=!1;this.POg=null}function Jf(e){this.insertDeleteMultiRangeParameters=null;this.insertDeleteMultiRangeParameters=
e}function oc(e){var C=Fe.call(this)||this;C.$=e;C.dc();return C}function ed(e){return Wc.call(this,e)||this}function wc(e,C){var M=this;this.S8b=this.gDd=null;this.euf=function(){kd.EwaSettings.la(691)||M.Irc();if(M.S8b){var qa=Ea.a(Xg.a.Ra.re,M.S8b);Dd.ULS.sendTraceTag(570949840,5,50,"FreezePanesCommandHandler.OnFreezePanesUpdateCompleted: duration of FreezePane from operation until allBlockUpdated: {0}",qa);M.S8b=null}M.KBf()};this.$=e;this.gridView=Ye.g(e);this.RE=C.B_a(this.$.domElement,500,
null,null);this.hKa=this.gKa=-1}function gb(e){this.freezeOptions=null;this.freezeOptions=e}function id(){}function ib(e){var C=Hj.call(this)||this;C.kdj="formulaAssistance";C.$=e;C.dc();return C}function nc(){this.isFeedbackAllowed=!1;this.zoomLevel=0}function Nb(e){var C=Mh.call(this)||this;C.$=e;C.dc();return C}function mb(e){var C=this;this.gY=this.calcManager=this.Al=this.wRa=null;this.bDi=function(M,qa){if(M&&!Ch.a(M)&&qa){var Na=!!M&&!!M.RequestTelemetryData;Ye.g(C.$).Ji.Pka(qa.toString(),
M.StateId,Na?M.RequestTelemetryData.EcsOperationDuration:0,Na?M.RequestTelemetryData.EcsRequestDuration:0,Na?M.RequestTelemetryData.WfeRequestDuration:0)}};this.$=e;this.$.da.Za(268,function(M){C.Al=M});this.Xxh=new ge(Ye.g(this.$).Ca,this.$);this.x2=new je(this.$,Ye.g(this.$),this);this.$.da.Za(266,function(M){C.calcManager=M});this.aec=kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CSEPlainTextOptimization",!1);this.zg=kd.EwaSettings.Pld();this.xod=kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5841057_SimplifyFormattedTextForPlainText_2")}
function Lc(e,C){this.success=e;this.mM=C}function zd(){this.tbg=this.VOj=!1;this.source=0;this.UKa=this.Vfc=!1}function jd(e,C,M,qa,Na){M=void 0===M?null:M;qa=void 0===qa?null:qa;Na=void 0===Na?null:Na;Dd.ULS.shipAssertTag(537162128,0,!!(!!(null!=M^!(void 0===qa||null===qa))^!(void 0===Na||null===Na))&&!(null!=M&&void 0!==qa&&null!==qa&&void 0!==Na&&null!==Na),"NumberFormatHolder: holder must contain either an ifmt or a format string!");null!=M&&0>M&&(Dd.ULS.sendTraceTag(537162127,0,50,"NumberFormatHolder: ifmt is negative, setting it to null..."),
M=null);this.Al=e;this.Np=C;this.xkg=M;this.W7a=qa;this.$pa=Na}function ge(e,C){this.gY=null;this.Ca=e;this.r1a=C}function Yd(e,C){this.Ca=e;this.r1a=C}function rd(e,C,M){this.success=e;this.wkc=void 0===C?null:C;this.reason=void 0===M?"":M}function je(e,C,M){var qa=this;this.wca=[];this.calcManager=this.jxc=this.lastSetCellInstantaneousOperation=null;this.$=e;this.grid=C;this.hi=M;this.qca=je.TDe;this.$.da.Za(268,function(Na){qa.jxc=Na});this.$.da.Za(266,function(Na){qa.calcManager=Na})}function re(e,
C,M,qa){this.rangeDelta=e;this.stateId=C;this.isFinished=M;this.priorityGroup=qa}function ae(e,C,M,qa,Na,Hb,Gc,gd,Uc,Wd,We,Gf,xg,Hg,Ig,Hh,jj,Kj,Qj,Jk,Sk,al,fl,gl,bl){this.numberOfDependentRecalcedCellsInBatch=this.numberOfEditedRecalcedCellsInBatch=this.newProcessingTimeLimit=this.originalProcessingTimeLimit=this.totalExecutionTime=this.numberOfSkippedCellsDueToMissingLocaleInfo=this.numberOfUnsupportedRichCellTypes=this.numberOfUnsupportedBlankCellTypes=this.numberOfUnsupportedErrorCellTypes=this.numberOfCellsWithNoFormattedCell=
this.numberOfCellsSkippedDueToTimeout=this.numberOfCellsUpdatedAlreadyByServer=this.numberOfUpdatedCells=this.numberOfNonUpdatedCells=this.totalNumberOfCellsInBatch=0;this.isNewTask=!1;this.lastSetCellInstantaneousOperation=null;this.taskId=0;this.numberOfHashFormattedValues=this.numberOfMeasureTextWidthCalls=this.newNumberFormatterFinalizeFailures=this.totalNumberFormatterTime=this.numberOfRecalcedCellsWithoutFormattedValue=this.numberOfRecalcedCellsWithFormattedValue=this.isNewNumberFormatter=null;
this.totalNumberOfCellsInBatch=void 0===e?0:e;this.numberOfNonUpdatedCells=void 0===C?0:C;this.numberOfUpdatedCells=void 0===M?0:M;this.numberOfCellsUpdatedAlreadyByServer=void 0===qa?0:qa;this.numberOfCellsSkippedDueToTimeout=void 0===Na?0:Na;this.numberOfCellsWithNoFormattedCell=void 0===Hb?0:Hb;this.numberOfUnsupportedErrorCellTypes=void 0===Gc?0:Gc;this.numberOfUnsupportedBlankCellTypes=void 0===gd?0:gd;this.numberOfUnsupportedRichCellTypes=void 0===Uc?0:Uc;this.numberOfSkippedCellsDueToMissingLocaleInfo=
void 0===Wd?0:Wd;this.totalExecutionTime=void 0===We?0:We;this.originalProcessingTimeLimit=void 0===Gf?0:Gf;this.newProcessingTimeLimit=void 0===xg?0:xg;this.numberOfEditedRecalcedCellsInBatch=void 0===Hg?0:Hg;this.numberOfDependentRecalcedCellsInBatch=void 0===Ig?0:Ig;this.isNewTask=void 0===Hh?!1:Hh;this.lastSetCellInstantaneousOperation=void 0===jj?"":jj;this.taskId=void 0===Kj?0:Kj;this.isNewNumberFormatter=void 0===Qj?null:Qj;this.numberOfRecalcedCellsWithFormattedValue=void 0===Jk?null:Jk;this.numberOfRecalcedCellsWithoutFormattedValue=
void 0===Sk?null:Sk;this.totalNumberFormatterTime=void 0===al?null:al;this.newNumberFormatterFinalizeFailures=void 0===fl?null:fl;this.numberOfMeasureTextWidthCalls=void 0===gl?null:gl;this.numberOfHashFormattedValues=void 0===bl?null:bl}function Uf(){}function Lf(e,C,M,qa,Na){this.JT=void 0===e?0:e;this.cellValue=void 0===C?"":C;this.ifmt=void 0===M?0:M;this.priorityGroup=void 0===qa?"":qa;this.mM=void 0===Na?"":Na}function Of(e){if(e.priorityGroup===Rc.editCell)return 0;if(e.priorityGroup===Rc.dependentCell)return 1;
Dd.ULS.sendTraceTag(537162183,0,10,"CalcInterfaceAdapter.GetRecalcPriorityGroup: unknown priority group!");return 2}function Yf(e,C){var M=Of(C),qa=!(void 0===C.rangeDelta.data.format||null===C.rangeDelta.data.format);Dd.ULS.shipAssertTag(537162187,0,!M||!qa,"CalcInterfaceAdapter.GetRecalcInferredFormat: Format inference expected for Edited cell only {0}",C.priorityGroup);e=Math.max(e.cell.Gm,0);qa&&(qa=excelOnlineCalc.calc.getCellFormatKind(C.rangeDelta.data.format.format),"number"===qa?e=C.rangeDelta.data.format.format:
"string"===qa?Dd.ULS.sendTraceTag(537162186,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind string"):"Unavailable"===qa?Dd.ULS.sendTraceTag(537162185,0,50,"CalcInterfaceAdapter.GetRecalcInferredFormat: format kind unavailable"):Dd.ULS.shipAssertTag(537162184,0,!1,"CalcInterfaceAdapter.GetRecalcInferredFormat: unknown format kind!"));return e}function vg(e){var C=e.value;switch(e.type){case 2:return void 0===C||null===C?"":C;case 1:return e=parseFloat(C),isNaN(e)?null:e;case 3:return e=
parseFloat(C),isNaN(e)?null:1===e;case 4:return e=parseFloat(C),isNaN(e)?null:excelOnlineCalc.calc.errorValue(e);default:return excelOnlineCalc.calc.blankValue}}function Af(e){e=excelOnlineCalc.calc.getCellValueKind(e.rangeDelta.data.value);var C=0;switch(e){case "number":C=1;break;case "string":C=2;break;case "boolean":C=3;break;case "Error":C=4;break;case "Blank":C=0;break;default:Dd.ULS.shipAssertTag(537162191,0,!1,"CalcInterfaceAdapter.GetCellValueType: Unexpected unsupported type {0}",e)}return C}
function rf(e,C){e=excelOnlineCalc.calc.getCellValueKind(e.rangeDelta.data.value);switch(e){case "number":case "string":case "boolean":return!0;case "Blank":if(kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5477761_Calc_BlankCellValueTypeSupported"))return!0;C.numberOfUnsupportedBlankCellTypes++;return!1;case "Error":if(kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.CalcErrorValueTypeSupported",!1))return!0;C.numberOfUnsupportedErrorCellTypes++;return!1;case "Rich":return C.numberOfUnsupportedRichCellTypes++,
!1;default:return Dd.ULS.shipAssertTag(537162192,0,!1,"CalcInterfaceAdapter.IsCellValueTypeSupported: Unexpected unsupported type {0}",e),!1}}function Cg(e){if(e=e.color){if("String"===Object.getType(e).getName())return zj.a.Gp(e);if("Number"===Object.getType(e).getName())return null}else return null;Dd.ULS.sendTraceTag(537162193,0,10,"CalcInterfaceAdapter.GetFontColorFromFormattedValue: unknown color type!");return null}function sc(e){switch(e.alignment){case "Center":return 2;case "Left":return 1;
case "Right":return 3;default:return Dd.ULS.sendTraceTag(537162194,0,10,"CalcInterfaceAdapter.GetHorizontalAlignmentFromFormattedValue: unknown horizontal alignment!"),0}}function Rc(){}function Qc(e,C,M,qa,Na,Hb,Gc,gd,Uc,Wd,We,Gf,xg){Gf=void 0===Gf?null:Gf;xg=void 0===xg?null:xg;gd=uj.call(this,11,0,gd,We)||this;gd.Wxh=e;gd.V$c=C;gd.format=qa;gd.activeCell=M;gd.Koe=Na;gd.BDf=Hb;gd.wDf=Gc;gd.DEa=Uc;gd.clientCorrelationId=Wd;gd.Mkb=Gf;gd.bhb=xg;return gd}function ee(){}function ue(e){var C=Zj.call(this)||
this;C.JQb=null;C.$=e;C.dc();return C}function Ee(e){var C=lj.call(this)||this;C.jFf=0;C.AG=null;C.qVg=function(M,qa){if(1===M&&C.AG.FileCollectionErrorStateId){M=C.$.qa.ta;var Na=C.AG.MessageId,Hb=C.AG.OriginalEcsServerId,Gc=C.AG.FileCollectionErrorStateId,gd=M.Oa(0);gd.errorMessageId=Na;gd.ecsServerId=Hb;gd.fileCollectionErrorStateId=Gc;gd.userComment=qa;M.LXc("CollectFile",gd,null,null,null,null,0)}C.raiseEvent("fileCollectionComplete",null,C)};C.$=e;return C}function De(e){var C=$h.call(this,
!1,!1,De.gy)||this;C.Zsd=!1;C.Xkf=!0;C.lkf=0;C.kc=1;C.Cc(1,CommonUIStrings.l_Send);C.Cc(0,CommonUIStrings.l_NoThanks);C.xf=ne.Eeg;C.fkf=e;C.Me=De.rOg;return C}function ne(){}function gc(e){return Ph.call(this,e)||this}function fd(){}function vd(e,C,M,qa){var Na=ij.call(this,e)||this;Na.ZAb=null;Na.yjc=null;Na.tdc=null;Na.S2=null;Na.Xja=!1;Na.disposed=!1;Na.lMa=!1;Na.ah=null;Na.zxd=function(Hb){Dd.ULS.sendTraceTag(537163269,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback");
if(Na.disposed)Dd.ULS.sendTraceTag(537163268,0,50,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback: Callback not handled since dialog was already disposed");else{if(Ch.a(Hb)){Dd.ULS.sendTraceTag(537163267,0,15,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - request has expected errors: {0}.",Hb?oh.a.Uc(Hb.Errors):null);if(Hb.Errors&&1===Hb.Errors.length){var Gc=Hb.Errors[0].MessageId,gd=Na.Xbd(Gc);if(gd){Na.Rqj(Gc)?Na.gmj(gd):Na.St(gd);Na.Hka("OkInvalidByServer",
Hb.Errors[0].MessageIdName);return}}Dd.ULS.sendTraceTag(537163266,0,15,"DataValidationEditDialogDeprecated.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: {0}",oh.a.Uc(Hb.Errors))}Na.Hka("OkValid","None");Na.hide()}};Na.J3c=function(Hb){Na.oW(Hb);2!==Hb&&(Na.ah=Na.$.Ub.Fc("UserAction","DataValidationEditTimeToDialogTryClose"));1===Hb?Na.G8a():2===Hb?Na.Lxa():Na.jla()};Na.Sba=function(){Na.EIj();Na.lMa?Na.uwe():Na.I0b();return Na.Xja=!1};Na.selectedRanges=C;Na.hQb=M;Na.command=
qa;3===qa&&(Na.Xja=!0);Na.kc=2;Na.gu=!1;Na.xf=Sc.xf;return Na}function se(e,C){this.options=this.cellRange=null;this.cellRange=e;this.options=C}function Jc(e,C){var M=Yj.call(this,e)||this;M.n9=null;M.Nga=null;M.iTa=null;M.p9=null;M.o9=null;M.Dlc=function(){M.n9.checked?(M.Nga.disabled=!1,M.iTa.disabled=!1,M.p9.disabled=!1,M.o9.disabled=!1):(M.Nga.disabled=!0,M.iTa.disabled=!0,M.p9.disabled=!0,M.o9.disabled=!0);return!1};M.get_visible=M.oja;M.set_visible=M.Uma;M.xk=C;M.Kja();return M}function Bc(e,
C){var M=ui.call(this,e)||this;M.Faa=null;M.r8e=null;M.Haa=null;M.Gaa=null;M.Elc=function(){M.Faa.checked?(M.Haa.disabled=!1,M.Gaa.disabled=!1):(M.Haa.disabled=!0,M.Gaa.disabled=!0);return!1};M.get_visible=M.oja;M.set_visible=M.Uma;M.xk=C;M.Kja();return M}function Ae(){}function cb(e,C,M,qa){var Na=yj.call(this,e)||this;Na.Asb=null;Na.wKd=null;Na.Xja=!1;Na.disposed=!1;Na.lMa=!1;Na.ah=null;Na.nNj=function(Hb,Gc){Na.g$b(Hb);var gd=Na.KWd();Hb=gd.errorString;var Uc=gd.lq;if(gd.returnValue)return Na.C4a(121,
Na.OGh(Na.$,Gc),0,Na.Vaa,!1),"";Na.Hka("OkInvalidByClient",Uc);return Hb};Na.J3c=function(Hb){Na.oW(Hb);Na.ah=Na.$.Ub.Fc("UserAction","DataValidationEditTimeToDialogTryClose");Hb||Na.jla()};Na.selectedRanges=C;Na.hQb=M;Na.command=qa;3===qa&&(Na.Xja=!0);Na.kc=2;Na.gu=!1;return Na}function mc(e,C,M,qa,Na,Hb,Gc,gd){gd=e.Oa(9,void 0===gd?null:gd);gd.selectedRanges=C;gd.ruleOptions=M;return vf.i(e,"CreateOrEditDataValidation",gd,qa,Na,Hb,Gc,0)}function Oc(e,C,M){var qa=Vh.call(this,C)||this;qa.Ava=null;
qa.Xcc=null;qa.nT=null;qa.qK=null;qa.gya=null;qa.hya=null;qa.p4a=null;qa.KMa=null;qa.c9a=null;qa.oOa=null;qa.cnc=null;qa.Xzd=null;qa.nwh=[[12,12,12,12,12,12,12,12],[0,0,2,2,0,1,0,1],[0,0,2,2,0,1,0,1],[3,3,3,3,3,3,3,3],[5,5,7,7,5,6,5,6],[8,8,10,10,8,9,8,9],[0,0,11,11,0,1,0,1],[4,4,4,4,4,4,4,4]];qa.Tdj=[[12,12],[1,1],[1,1],[12,12],[6,6],[9,9],[1,1],[12,12]];qa.Clc=function(Na){var Hb=!1;(null===Na||void 0===Na?0:Na.Ea)&&(Na.Ea.keyCode===Oa.a.iBa||Na.Ea.keyCode===Oa.a.$h)&&(Hb=qa.Sba(Na),qa.nT.blur(),
qa.qK.blur());return Hb};qa.Sba=function(){var Na=qa.nT.selectedIndex,Hb=qa.qK.selectedIndex;qa.cnc.innerText=qa.Vtb(Na,Hb);qa.Xzd.innerText=qa.Eed(Na,Hb);switch(Na){case 0:return qa.qK.disabled=!0,Le.DOMElementExtensions.setVisible(qa.c9a,!1),Le.DOMElementExtensions.setVisible(qa.oOa,!1),Le.DOMElementExtensions.setVisible(qa.p4a,!1),Le.DOMElementExtensions.setVisible(qa.KMa,!1),qa.Ava.disabled=!0,!1;case 3:return qa.qK.disabled=!0,Le.DOMElementExtensions.setVisible(qa.c9a,!0),Le.DOMElementExtensions.setVisible(qa.oOa,
!1),Le.DOMElementExtensions.setVisible(qa.p4a,!0),Le.DOMElementExtensions.setVisible(qa.KMa,!0),qa.Ava.disabled=!1;case 7:return qa.qK.disabled=!0,Le.DOMElementExtensions.setVisible(qa.c9a,!0),Le.DOMElementExtensions.setVisible(qa.oOa,!1),Le.DOMElementExtensions.setVisible(qa.p4a,!1),Le.DOMElementExtensions.setVisible(qa.KMa,!1),qa.Ava.disabled=!1;default:qa.Ava.disabled=!1,Le.DOMElementExtensions.setVisible(qa.c9a,!0),Le.DOMElementExtensions.setVisible(qa.KMa,!1)}switch(Hb){case 0:case 1:Le.DOMElementExtensions.setVisible(qa.oOa,
!0);break;default:Le.DOMElementExtensions.setVisible(qa.oOa,!1)}qa.qK.disabled=!1;qa.cnc.disabled=!1;Le.DOMElementExtensions.setVisible(qa.p4a,!1);Le.DOMElementExtensions.setVisible(qa.KMa,!1);return!1};qa.get_visible=qa.oja;qa.set_visible=qa.Uma;qa.KQ=new lc.a;qa.KQ.add(fe.a.instance.ea(1620));qa.KQ.add(fe.a.instance.ea(1621));qa.KQ.add(fe.a.instance.ea(1624));qa.KQ.add(fe.a.instance.ea(1622));qa.KQ.add(fe.a.instance.ea(1623));qa.KQ.add(fe.a.instance.ea(1625));qa.KQ.add(fe.a.instance.ea(1626));qa.KQ.add(fe.a.instance.ea(1627));
qa.KQ.add(fe.a.instance.ea(1628));qa.KQ.add(fe.a.instance.ea(1629));qa.KQ.add(fe.a.instance.ea(1630));qa.KQ.add(fe.a.instance.ea(1631));qa.KQ.add("");qa.$=e;qa.xk=M;qa.Kja();return qa}function Sc(){}function $c(e,C){var M=this;this.iB=this.X_a=this.selectedRanges=null;this.cHe=!1;this.ah=null;this.zDi=function(qa){Dd.ULS.sendTraceTag(537163284,0,50,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback");!qa||Ch.a(qa)?Dd.ULS.sendTraceTag(537163283,0,10,"DataValidationEditCommandHandler.OnGetDataValidationInitialStateSuccessCallback, failed to get expected results."):
(M.X_a=qa.Result,M.ATi())};this.nsh=function(qa){M.oW("DataValidationEdit.ExpandExisitngDialog",qa);M.iB.c=$c.Rha(qa);1===qa?M.UGa(new le(M.X_a)):2===qa?M.UGa(new le):M.xjf()};this.DOi=function(qa){M.oW("DataValidationEdit.OverrideExisitngDialog",qa);M.iB.c=$c.Rha(qa);1===qa?M.UGa(new le):M.xjf()};this.$=e;this.K3c=C}function le(e){this.K4=(e=void 0===e?null:e)?e.IsIgnoreBlank:!0;this.L4=e?e.IsInCellDropDown:!0;this.nN=e?e.LowerBoundary:"";this.oN=e?e.UpperBoundary:"";this.$A=e?e.ConditionType:0;
this.ruleType=e?e.RuleType:0;this.wZ=e?e.IsAlertBlocking:!0;this.mT=e?e.AlertTitle:"";this.lT=e?e.AlertMessage:"";this.dV=e?e.InputMessage:"";this.yE=e?e.InputTitle:"";this.X4=e?e.IsShowErrorAlert:!0;this.Y4=e?e.IsShowInputMessage:!0}function we(e){switch(e){case 0:e="AnyValue";break;case 1:e="WholeNumber";break;case 2:e="Decimal";break;case 3:e="List";break;case 4:e="Date";break;case 5:e="Time";break;case 6:e="TextLength";break;case 7:e="Custom";break;default:e="Unknown"}return e}function jc(e){switch(e){case 0:e=
"Between";break;case 1:e="NotBetween";break;case 2:e="Equal";break;case 3:e="NotEqual";break;case 4:e="GreaterThan";break;case 5:e="LessThan";break;case 6:e="GreaterThanOrEqual";break;case 7:e="LessThanOrEqual";break;default:e="Unknown"}return e}function Zc(e){var C=Ri.call(this)||this;C.$=e;C.dc();return C}function ud(e,C,M){var qa=this;this.gwc={};this.Ld=!1;this.Zk=function(Na,Hb){qa.showContextMenu(void 0===Hb?null:Hb)};this.wsf=function(Na,Hb){Hb.qsi===ud.NVh&&Ye.g(qa.$).focus()};this.Jxa=function(Na,
Hb){Na=qa.$.Ka.haa(Hb.ee.command);(null===Na||void 0===Na?0:Na.dismissesContextualUI)&&qa.j3()};this.J5=function(){qa.$.da.gU(342);wf.TaskExtensions.Ba(td.GetServiceTaskFactory.create(qa.$.da,338,qa.$.ma,3),function(Na){Na=Na.result;for(var Hb=yl(qa.gwc),Gc=Hb.next();!Gc.done;Gc=Hb.next())Gc.value.hKf(Na)},qa.$.ma)};this.$=e;this.contextMenuController=M;this.J3d=new Fd(this.$);e.da.Ha(8,this);for(M=0;M<C.length;M++)this.gwc[ud.GYg[M]]=C[M];this.ha=Ye.g(e).ha;this.ha.DXb(this.Zk);this.$.Ka.cFa(this.wsf);
ie.a.instance.wlj();kd.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ka.fmb(this.Jxa);kd.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.fa.j9(this.J5)}function Fd(e){this.cQe=null;this.$=e;this.nxa=new Df;kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||(this.cQe=new me(this.$))}function me(e){var C=
this;this.AYa=null;this.tOd=!1;this.Gzb=0;this.m7c=1;this.MJe=0;this.mCb=function(M){C.XGf(M.domElement,M.hashCode)};this.wKf=function(M){for(var qa=0;window.performance.now()-M<C.Zhh&&0<C.AYa.length;)C.Fje(C.AYa.shift()),qa++;Dd.ULS.sendTraceTag(537167052,1,50,"FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Batch number: {0}, Events Registered in this frame: {1}, Events in queue: {2}",C.m7c,qa,C.AYa.length);0<C.AYa.length?C.Gzb=window.requestAnimationFrame(C.wKf):(Dd.ULS.sendTraceTag(537167051,
1,50,"FilterMenuManager.RegisterQueuedAutoFilterEventHandler: Finished batch number: {0}, Total time in MS: {1}",C.m7c,window.performance.now()-C.MJe),C.m7c++,C.Gzb=0)};this.onPointerDown=function(M){pg.a.slim(M.Ea.rawEvent);return!1};this.$=e;this.gridView=Ye.g(this.$);this.L2h();this.Zhh=this.$.ya.AutoFilterEventRegistrationTimeLimit}function $e(){this.Xd=this.qqe=this.cell=null}function Df(){this.Vbc={}}function gg(){this.menuModel=null;this.zCe=0}function og(){this.dictionary=this.ee=null}function dg(e){var C=
Id.call(this)||this;C.I7e=!1;C.rjd=function(){var M;(M=C.$.da.Aa(342))?C.Fb(M):C.$.rE(function(qa){qa.qjd().then(function(Na){(M=C.$.da.Aa(342))?C.Fb(M):(M=new af(C.$,Na),C.Fb(C.$.da.Ha(342,M)))})})};C.$=e;C.dc();return C}function af(e,C){this.Hpb=C;this.$=e}function rg(e){return ua.call(this,e)||this}function cg(e,C,M,qa){e=Sd.call(this,e,"PopulateTimeSlicerLevelMenu",-227942804,1634477200,cg.VBj,!0,!1,cg.bHb,C,M,!1,qa)||this;e.L_a=0;e.Tra=null;e.IJa=null;e.sHe=null;return e}function Ie(e,C,M){this.type=
e;this.FYg=C;this.$o=M}function Ng(e,C,M,qa){return rh.call(this,e,"PopulateSlicerContextMenu",-1920954846,723126814,"SlicerContextMenu",!0,!1,"SlicerContextMenuRootName",C,M,!0,qa)||this}function Zf(e,C,M,qa){e=Di.call(this,e,"PopulateSheetOpsContextMenu",274207288,-1497523576,"SheetOpsContextMenu",!0,!1,"SheetTabContextMenuRootName",C,M,!1,qa)||this;e.Vec=!1;e.tgc=!1;return e}function ng(e,C,M,qa){C=Yg.call(this,e,"PopulateRichTextContextMenu",679816325,1151222423,"RichTextContextMenu",!0,!1,"RichTextContextMenu",
C,M,!0,qa)||this;C.grid=Ye.g(e);return C}function Ff(e,C,M,qa){C=Kh.call(this,e,"PopulateTableFieldListContextMenu",-751848458,-1085236154,"TableFieldListContextMenu",!0,!1,"TableFieldListContextMenuRoot",C,M,!1,qa)||this;C.x3b=null;C.owd=0;C.ETb=null;C.grid=Ye.g(e);return C}function be(){}function Rf(e,C,M,qa){var Na=yg.call(this,e,"PopulatePivotTableContextMenu",-1475408662,1114549926,"PivotTableContextMenu",!0,!1,"PivotTableContextMenuRootName",C,M,!0,qa)||this;Na.Wc=null;Na.activeCell=null;Na.XAc=
null;Na.Egc=!1;Na.Uld=!1;Na.expandCollapse=!1;Na.refresh=!1;Na.VY=!1;Na.Yf=null;Na.Cz=null;Na.q_a=null;Na.Bb=null;Na.O9a=null;Na.Uaa=!1;Na.nEi=function(Hb){Hb&&!oh.a.hh(Hb.Errors)&&Na.Wc&&(Na.Wc.Do=Hb.Result,Na.nIb());Na.showPivotTableContextMenu()};Na.mEi=function(){};Na.dIi=function(){Na.rab()};Na.cIi=function(){Na.rab()};Na.bzi=function(){Na.rab()};Na.azi=function(){Na.rab()};Na.Jt=function(){Na.XUd();Na.Uaa=!1};Na.Ms=function(){if(Na.Uaa){Dd.ULS.sendTraceTag(537167E3,0,50,"PivotTableContextMenu.OnAfterAllBlocksUpdated: Context menu was closed after changes were made by other users");
var Hb=Na.Wc;Na.grid.Vb.nq(Na.grid.ha.va.activeCell)!==Hb&&(Na.rab(),Na.Z_h())}};Na.Tch=new DOMParser;Na.Eoj=!0;Na.grid=Ye.g(e);Na.pjc=!0;return Na}function Re(e,C,M,qa){return lf.call(this,e,"PopulatePivotContextMenu",2123758504,912277356,C,M,qa)||this}function Ze(e,C,M,qa){e=Ed.call(this,e,"PopulateFieldWellContextMenu",1374696078,495005930,"FieldWellContextMenu",!0,!1,"FieldWellContextMenu",C,M,!1,qa)||this;e.cell=null;e.$n=null;e.mo=null;e.externalSourceIndex=-1;e.XXd=-1;e.ERa=0;e.wwc=-1;e.bL=
null;e.isOlap=!1;e.lH=!1;e.t1a=!1;return e}function hg(e,C,M,qa,Na,Hb,Gc,gd,Uc){var Wd=Td.call(this,Na,fe.a.instance.Cb(60),!0,2,!0)||this;Wd.QZf=!0;Wd.Kge=null;Wd.sRa=null;Wd.kfa=null;Wd.Cqb=null;Wd.E3c=null;Wd.KPc=null;Wd.Wyi=function(We){hi.a.any(We.Errors,function(Gf){return-103190598===Gf.MessageId})&&Wd.URa.M$i()};Wd.XEi=function(We){We&&!Ch.a(We)&&(We=We.Result,Wd.E3c.innerHTML=fe.a.instance.ea(1051)+dh.a.If(We.ValueFieldSourceName),Wd.isOlap&&!Wd.lH?(Wd.URa.enabled=!1,Wd.kfa.activeTab=Wd.kfa.txc-
1):(Wd.URa.enabled=!0,Wd.kfa.activeTab=0),Wd.URa.mkj(We.PivotValueFieldSettingsSummarizeValueByInfo),Wd.sRa.nkj(We.PivotValueFieldShowValueAsInitialInfo),Wd.mf())};Wd.cell=e;Wd.mo=C;Wd.externalSourceIndex=M;Wd.pbg=qa;Wd.ee=Hb;Wd.Cha=Gc;Wd.isOlap=gd;Wd.lH=Uc;return Wd}function Bg(e,C,M){M=void 0===M?null:M;this.Okb=this.Ykb=null;this.T0=-1;this.Ci=e;this.OX=(void 0===C?null:C)||new lc.a;this.Bsg=M||new qf;this.uEa=new lc.a;e=0;C=yl(this.OX);for(M=C.next();!M.done;M=C.next()){M=M.value;this.ipd(this.T0)||
(this.T0=e);var qa=e++;this.uEa.add(new qh(document.createElement("li"),M.title,this.v1g(qa)))}}function qh(e,C,M){this.Ci=e;this.lp=C;this.jEc=M;this.$ea=document.createElement("a");hc.a.Ztc(this.$ea,this.lp);Sys.UI.DomElement.addCssClass(this.$ea,Zg.$zj);Sys.UI.DomElement.addCssClass(this.Ci,Zg.Zzj);this.Ci.appendChild(this.$ea);this.$ea.tabIndex=0;this.mzc();T.a.addHandler(this.Ci,"click",this.jEc);T.a.addHandler(this.Ci,"keyup",Object(zb.a)(this,this.R8a,"onTitleKeyUp"))}function Zg(){}function qf(){}
function mh(e){e=Ah.call(this,e)||this;e.Xae=null;e.get_visible=e.oja;e.set_visible=e.Uma;e.Kja();return e}function Pa(){}function qb(e,C,M,qa,Na,Hb,Gc,gd){var Uc=hj.call(this,e)||this;Uc.RE=null;Uc.T3b=null;Uc.KZb=null;Uc.o_d=null;Uc.p_d=null;Uc.Q1d=null;Uc.Dsf=function(){var Wd=parseInt(Uc.e3.oe.value);Uc.eQg(Wd)?(Uc.rT.Hn.disabled=!0,Uc.gP.Hn.disabled=!0,Uc.gP.clear(),qb.M9e(Wd)?(Uc.rT.Hn.disabled=!1,Uc.aMb(!0)):qb.N9e(Wd)?(Uc.rT.Hn.disabled=!1,Uc.gP.Hn.disabled=!1,Uc.aMb(!0),Uc.Ihf()):Uc.aMb(!1)):
(Wd=oh.a.jd(1,0,0,1081,0,7896227,"FormatRequiresBaseFieldsOrBaseItems"),Qi.a(Uc.$).St([Wd]),Uc.e3.Q$i())};Uc.gzi=function(){0>Uc.rT.selectedIndex||Uc.gP.Hn.disabled||(Uc.aMb(!0),Uc.Ihf())};Uc.YEi=function(Wd){Uc.RE.NRa();Uc.gP.Hn.style.overflowY="scroll";if(Wd&&!Ch.a(Wd)){Wd=Wd.Result;Uc.gP.clear();for(var We=yl(Wd.BaseItems),Gf=We.next();!Gf.done;Gf=We.next())Gf=Gf.value,Uc.gP.AL(Gf.DisplayString,Gf.Id.toString(),Gf.Id===Wd.SelectedBaseItem);Uc.aMb(!1)}};Uc.get_visible=Uc.oja;Uc.set_visible=Uc.Uma;
Uc.$=C;Uc.cell=M;Uc.mo=qa;Uc.externalSourceIndex=Na;Uc.ee=Hb;Uc.Cha=Gc;Uc.Oci=gd;Uc.sKj=kd.EwaSettings.isChangeGateEnabled("OfficeVSO:4859461_DisableOKButtonWhenLoadingIndictorIsOn");Uc.Kja();return Uc}function tc(){}function dd(e,C,M,qa,Na){this.externalSourceIndex=0;this.pivotFieldTitle=this.activeCell=null;this.summarizeBy=0;this.showAsValueParameters=null;this.externalSourceIndex=e;this.activeCell=C;this.pivotFieldTitle=M;this.summarizeBy=qa;this.showAsValueParameters=Na}function Kd(e,C,M){this.baseItemIndex=
this.baseFieldIndex=this.dataFormat=0;this.dataFormat=e;this.baseFieldIndex=C;this.baseItemIndex=M}function yd(){}function ze(){}function te(e,C,M,qa){return lf.call(this,e,"PopulateFieldListPivotMenu",-1793121409,1378457149,C,M,qa,"FieldListPivotFilterContextMenu")||this}function lf(e,C,M,qa,Na,Hb,Gc,gd){var Uc=nf.call(this,e,C,M,qa,void 0===gd?"PivotFilterContextMenu":gd,!0,!1,"PivotFilterMenuRootName",Na,Hb,!1,Gc)||this;Uc.s3b=null;Uc.bgf=null;Uc.mlb=null;Uc.pivotData=null;Uc.wwd=null;Uc.Bkc=null;
Uc.BBb=0;Uc.u0b=0;Uc.aY=0;Uc.M_a=null;Uc.bEi=function(Wd,We){if(We)if(Ch.a(Wd))Uc.xtd(We,!1);else if(Wd=Wd.Result){Uc.Zqb=xf.xdd(We,Uc.$,Uc.pivotData.cell,Uc.aY);var Gf=Uc.$td(Wd.MenuModel.Sections);Uc.M_a=Gf;lf.TM.set(Uc.pivotData.cell,We,Gf,Uc.aY);xh.a(Uc.$).oyj(Wd);Uc.xtd(We,!0)}};Uc.aEi=function(Wd,We){Uc.xtd(We,!1)};Uc.Pe=function(Wd,We){lf.TM.qrb(We.$c.hash)};Uc.Hm=function(Wd,We){lf.TM.qrb(We.$c.hash)};Uc.vca=null;Uc.xwd=Uc.BBb=-1;Uc.ave=Uc.u0b=-1;Uc.fne=Uc.aY=0;Uc.aw=kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");
lf.TM||(lf.TM=new xf(Uc.$),Ye.g(Uc.$).Ca.gq(Uc.Pe),Ye.g(Uc.$).Ca.gG(Uc.Hm),Ye.g(Uc.$).Ca.nga(Uc.Pe));return Uc}function bf(){this.cell=null;this.dataSourceIndex=0;this.mo=this.pivotName=null}function xf(e){this.$=e;this.TM={}}function Og(e,C,M,qa){e=ug.call(this,e,"PopulateFieldListContextMenu",-1045020714,-170383950,"FieldListContextMenu",!0,!1,"FieldListContextMenu",C,M,!1,qa)||this;e.$n=null;e.bL=null;e.xZ=!1;e.lH=!1;e.isOlap=!1;e.HRd=!1;return e}function mf(e,C,M,qa){e=bg.call(this,e,C,M,qa,"PopulateChartContextMenu",
-498523270,1640762262,"ChartContextMenu")||this;e.bAa=!1;e.qva=!1;e.VY=!1;e.refresh=!1;e.isPivotChart=!1;return e}function bg(e,C,M,qa,Na,Hb,Gc,gd,Uc,Wd){gd=void 0===gd?If.a.CYg:gd;e=Yc.call(this,e,void 0===Na?"PopulateFloatingObjectContextMenu":Na,void 0===Hb?-2017893763:Hb,void 0===Gc?1350204367:Gc,gd,void 0===Uc?!0:Uc,void 0===Wd?!1:Wd,gd,C,M,!0,qa)||this;e.floatingObject=null;e.zb=0;e.pjc=!0;return e}function Wf(e,C,M,qa){e=H.call(this,e,"PopulateAutoFilterFieldListContextMenu",474690375,216058793,
Wf.Gth,!0,!1,Wf.bHb,C,M,!1,qa)||this;e.am=null;return e}function zf(){}function tg(){}function Hf(e,C){e=xc.call(this,e,2,0,null)||this;e.pqe=C;return e}function xc(e,C,M,qa){this.Xng=e;this.Lig=C;this.Pig=M;this.usg=qa}function bd(){}function Bd(e,C,M,qa){var Na=ja.call(this,e,"PopulateAutoFilterContextMenu",1675506831,1651433993,"AutoFilterContextMenu",!0,!1,"AutoFilterContextMenuRoot",C,M,!1,qa)||this;Na.M_a=null;Na.sheetName=null;Na.qSa=null;Na.LUc=null;Na.dif=!1;Na.w1a=!1;Na.EBd=null;Na.hKb=
null;Na.y8c=null;Na.kac=null;Na.zOa=null;Na.PCe=null;Na.q9a=null;Na.c3c=null;Na.aN=function(){Na.uwc();Na.$.fa.hr(Na.aN)};Na.ODi=function(Hb){function Gc(Hg,Ig,Hh){Na.c3c=vf.t(Na.$.qa.ta,Wd,lh.b(Hg,We),Na.w1a?lh.a(Ig,Gf):Ig,Hh,null,xg);return Na.c3c}Na.w1a||Th.b(Na.$).ae(ra.a.suf,Na.dm(),void 0,!0);var gd={};Na.$.wj(gd);var Uc=Na.$.fa.isNamedObjectViewMode,Wd=xi.a.li(Na.LUc);Wd.SheetName=Uc?gd.NamedObjectName:gd.SheetName;Wd.NamedObjectView=Uc;gd=!!Hb.searchText;Uc=586;Na.w1a&&(gd&&(Wd.ItemListOptions=
Na.e0g(Hb.searchText),Uc=597),Hb={},Th.b(Na.$).ae(ra.a.suf,(Hb.UserOperation=Uc.toString(),Hb),void 0,!0));var We=Na.Zxd(gd),Gf=Na.PDi(),xg=Na.$.qa.ta.Xb();Na.PCe=xg.RequestId;Na.w1a&&Na.kac&&!Na.kac.dequeueUtcTime&&(Na.$.userOperationManager.CHa(Na.kac),Na.qQg());Hb=kd.EwaSettings.tc()?new mg.a(Uc,0,Gc,80):new Xe.a(Uc,0,Gc,16);Na.kac=Na.$.userOperationManager.ic(Hb,null);Na.q9a=Na.c3c;Na.zOa=Na.PCe};Na.onMenuItemClick=function(Hb,Gc,gd){Th.b(Na.$).ae(ra.a.EIi,Na.dm(),void 0,!0);var Uc={};Gc=(Uc.CommandValueId=
Gc,Uc.MenuItemId=Gc,Uc.InputMethod=gd,Uc.TopCellAddress=Na.qSa,Uc);Uc=new Bf.a(Hb,gd,Na.$.isEditMode?2:1,19,null);Na.$.Ka.Zb(Uc,Gc);Dd.ULS.sendTraceTag(537167131,0,50,"AutoFilterContextMenu::OnMenuItemClick {0}, {1}",Hb,gd)};Na.Syi=function(Hb){if(Hb.checkedItems&&Hb.checkedItems.length){Th.b(Na.$).ae(ra.a.Eqf,Na.dm(),void 0,!0);var Gc=xi.a.li(Na.LUc),gd={};Na.$.wj(gd);gd.FirstRow=0;gd.FirstColumn=Gc.Column;var Uc=Na.$.fa.isNamedObjectViewMode;Gc.NamedObjectView=Uc;Gc.SheetName=Uc?gd.NamedObjectName:
gd.SheetName;var Wd=function(xg){if(Bb.a.pvc(xg)){var Hg=Bb.a.t9b(xg);Na.SLa?Bb.a.DPa(ic.a.applyItemFilter,Hg.MessageIdName,Nc.a.Ara,!0,Bb.a.isSessionEndingError(Hg.MessageId)):Dd.ULS.sendTraceTag(537167129,0,10,"AutoFilterContextMenu::OnApplyFilterByValue failed with AutoFilterException -{0}",Hg.MessageIdName)}Ch.a(xg)||(Dd.ULS.sendTraceTag(537167128,0,50,"AutoFilterContextMenu::OnApplyFilterByValue service call succeeded"),Th.b(Na.$).ae(ra.a.muf,Na.dm(),void 0,!0),xg=Object.assign(new Aa,{isSuccess:!0}),
Na.hKb.onApplyFilterByValueFinish(xg),Na.ZK(Na.qSa))},We=Na.D1c(Gc,gd),Gf=new mg.a(208,0,function(xg,Hg,Ig){return vf.a(Na.$.qa.ta,We,Hb.checkedItems,lh.b(xg,Wd),Hg,Ig,null,null)},6,function(){return new Ca.a(Hb.checkedItems,We)});Na.Q_f(function(){Na.$.userOperationManager.ic(Gf,null)})}else Dd.ULS.sendTraceTag(537167130,0,15,"AutoFilterContextMenu::OnApplyFilterByValue Received Zero checked items to apply filter on")};Na.iGg=function(Hb){var Gc=jg.o(Na.qSa,Na.$),gd=jg.v(Na.qSa,Na.$),Uc=Object.assign(new Me,
{SortConditionType:Hb.type,RowColOffset:Gc.FirstColumn-gd.FirstColumn,SortColor:Hb.color,SortIconSet:Hb.icon.IconSet,SortIcon:Hb.icon.Icon,IsAscending:!0}),Wd={SortOptions:Object.assign(new Md,{OperationType:1,ActiveCell:Gc,SelectedRange:gd,SortConditions:[Uc],SortTopToBottom:!0,GuessHeader:!0,IsCaseSensitive:!1}),SelectedRange:gd,OriginalActiveCell:Gc,ShouldRestoreSelection:!1};Dd.ULS.sendTraceTag(537167119,0,50,"AutoFilterContextMenu.ApplySortByColorOrIcon: Aplying Sort, type: {0}",Hb.type);Na.Q_f(function(){var We=
{};Na.$.Ce(1659552324,eg.a.Wb,19,(We.CustomSortCommandData=Wd,We))})};Na.SLa=Bb.a.Fkd();Na.aw=kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest");return Na}function Ld(){this.top=this.left=0}function Od(){this.onMenuItemClick=this.applyFilterByValueRequest=this.getFilterByValueItemsRequest=null;this.autoFilterMenuWidth=0;this.applySortByColorOrIconRequest=null}function ef(){this.autoFilterMenu=this.targetPoint=null}function ag(){this.filterByValueItems=null;this.hasMoreRecords=!1;
this.searchText=null}function lg(){this.selectedSortIcon=this.selectedSortFontColor=this.selectedSortCellColor=this.getColorName=this.icons=this.fontColors=this.cellColors=null}function $f(){this.displayText=null;this.state=0;this.children=this.parent=this.key=null;this.indentationLevel=0;this.expanded=!1}function Aa(){this.isSuccess=!1}function Ob(){this.Title=this.MenuItems=this.Id=null;this.DisplayType=0}function Ec(){this.Disabled=!1;this.RibbonCommand=this.Identifier=this.Type=0;this.SubMenu=
this.Label=this.CommandData=null;this.IsChecked=!1;this.TooltipText=this.Id=this.IconName=null}function md(){this.Sections=this.Id=null}function Md(){this.ActiveCell=this.SelectedRange=null;this.SortTopToBottom=this.IsCaseSensitive=this.GuessHeader=this.HasHeader=this.IsAscending=!1;this.SortInfoMode=this.OperationType=0;this.ExpandSortSelection=this.SortConditions=null;this.ExpandSortSelectionSupported=!1}function Me(){this.RowColOffset=0;this.IsAscending=!1;this.CustomOrder=null;this.SortColor=
this.SortConditionType=0;this.FillGradient=null;this.SortIcon=this.SortIconSet=0;this.RichProperty=null}function Qe(){}function sf(e,C,M,qa){var Na=this;this.L_d=this.Y0=this.Ri=this.pD=this.Q7=null;this.cVb=e;this.zrg=qa;this.cVb.hLa&&(this.Ri=new df.a(3,2,5E3,Object(zb.a)(this,this.mIg,"authenticationCheckTask"),2),hd.AFrameworkApplication.oj.fh(this.Ri),this.Mg(C,M));this.cVb.bmb(function(){Na.Mqf()});this.cVb.zXa(function(){Na.Nqf()})}function Vf(){}function Da(e){return ii.call(this,e)||this}
function rb(e,C,M){var qa=yi.call(this)||this;qa.jAi=function(Na,Hb){if(!Ch.a(Na)&&Hb){var Gc=!!Na&&!!Na.RequestTelemetryData;Ye.g(qa.$).Ji.Pka(Hb.toString(),Na.StateId,Gc?Na.RequestTelemetryData.EcsOperationDuration:0,Gc?Na.RequestTelemetryData.EcsRequestDuration:0,Gc?Na.RequestTelemetryData.WfeRequestDuration:0)}};qa.$=e;qa.tableManager=C;qa.hi=M;return qa}function $b(e,C){this.command=0;this.selectedRanges=null;this.command=e;this.selectedRanges=C}function vc(e){return ti.call(this,e)||this}function sb(e){var C=
Ki.call(this)||this;C.Qqf=function(M){var qa=Ye.g(C.$);if(M=M.Result){var Na=jg.D(M.NewSelection),Hb=jg.D(M.NewActiveCell);if(Na&&Hb)if(!M.Committed&&M.AutoSumFormula){var Gc=qa.sc(Hb);Gc&&(qa.ha.updateSelection(Na,Hb,60),Na=Hb=jg.D(M.MarkedArea),qa.gC=2,ce(qa.rc,Gc,M.AutoSumFormula,!!Na,M.FormulaMarkStart,M.FormulaMarkEnd),Na&&Hb&&qa.ha.updateSelection(Na,Hb,0),qa.rc.Fnd=!1,wf.TaskExtensions.Ba(td.GetServiceTaskFactory.create(C.$.da,153,C.ma,0),function(gd){gd.result.Jrb(null)},C.ma,3))}else qa.ha.updateSelection(Na,
Hb,60)}};C.$=e;return C}function ec(e,C){this.sharedSheetRange=null;this.type=0;this.sharedSheetRange=e;this.type=C}function ce(e,C,M,qa,Na,Hb){if(C){var Gc=e.textBox;e.isEditing||e.startEdit(C,!0);e.Fnd=!0;e.text=M;Gc.caretPosition=Na;Na<Hb&&(qa&&e.kAa(),Gc.selectRange(0,Hb+1),Gc.selectRange(Na,Hb))}}function Rd(e,C,M,qa,Na,Hb,Gc,gd,Uc,Wd){Wd=e.Oa(9,Wd);Wd.selectedRange=C;Wd.activeCell=M;Wd.autoSumType=qa;Wd.topLeftCell=Na;return vf.i(e,"AutoSum",Wd,Hb,Gc,gd,Uc,0)}function Ne(e,C,M,qa,Na,Hb){if(0===
qa)return Object(Wg.a)(li.UnsupportedZeroResize);if(0>qa||0===M.length)return Object(Wg.a)(li.InvalidInput);if(e.ZZh())return Object(Wg.a)(li.UnsupportedSkeletonInView);var Gc=e.tf;if(!Gc)return Object(Wg.a)(li.NullSPD);var gd=Gc.iXe(M);if(gd&&0<gd.length)return Object(Wg.a)(gd.length.toString()+" "+li.UnsupportedHiddenInRange);a:{gd=yl(M);for(var Uc=gd.next();!Uc.done;Uc=gd.next())Uc=Uc.value,Na?Uc.right=Mi.a.Qh:Uc.bottom=Mi.a.Fh;gd=e.m$("EditGridAction.IsMergeCellAcrossBlocksExistInRanges",M);try{for(gd.$$rst();gd.$$mn();)if(gd.Wn.gwj){var Wd=
!0;break a}}finally{gd&&gd.dispose()}Wd=!1}if(Wd)return Object(Wg.a)(li.UnsupportedMergeCell);if(kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase2",!1)&&!Na&&"undefined"!==typeof gridRenderer)for(Wd=yl(M),gd=Wd.next();!gd.done;gd=Wd.next())gridRenderer.CanvasRendererGlobals.resetColWidthCacheByCol(gd.value.left);e=e.Ca;Wd=Pg.a.create().toString();Gc.O$f(M,qa,Na);Hb=e.o9f(Na,Hb);C.B_i(M,Na);e.eHf(Hb,Wd);return Object(Wg.d)(qa)}b.r(D);var Be=b(514),sd=b(0),cf=b(817),
Dd=b(13),tf=b(195),vf=b(81),eg=b(78);ec.prototype.d3a=function(){return this.sharedSheetRange};Object(sd.a)(ec,"MacroRecorderAutoSumPayload",null,[116]);var jg=b(43),Xe=b(519),wg=b(368),mg=b(163),td=b(56),wf=b(35),Oh=b(148),Jg=b(337),oh=b(27),kd=b(1),sg=b(175),lh=b(273),Ye=b(20),Rg=b(154),jh=b(585),Fg=b(55),Ki=tf.a;vm(sb,Ki);sb.prototype.Xc=function(){return!1};sb.prototype.executeCommand=function(e,C,M){e=C.command;switch(e){case 1220954656:C=this.bGe(0,C);break;case -1537138325:C=this.bGe(parseInt(M[eg.a.hd].toString()),
C);break;default:C=sg.a(e)}return C};sb.prototype.Gc=function(e,C){if(e=1===e)switch(C.command){case 1220954656:case -1537138325:break;default:e=!1}return e};sb.prototype.fd=function(){return!1};sb.prototype.bGe=function(e,C){function M(){return new ec(Gc,e)}var qa=this,Na=Ye.g(this.$);Na.Bh.qG(!1);if(!Ye.g(this.$).ha.va.Dh)return Dd.ULS.sendTraceTag(537170308,0,50,"AutoSumCommandHandler.DoAutoSum: Unhandled AutoSum of type {0} due to discontinuous selection. Number of selected ranges is {1}",e,Ye.g(this.$).ha.va.nK),
this.wya(),Fg.Task.Ta(!1);var Hb=Na.QG();if(!Hb)return null;var Gc=jg.v(Na.ha.va.Qd,this.$),gd=jg.o(Na.ha.va.activeCell,this.$),Uc=jg.o(Hb,this.$),Wd=this.$.qa.ta.Xb();return this.$.xs(Na.ha.va.selectedRanges,!0)?kd.EwaSettings.tc()?wg.a(this.$.userOperationManager,function(We,Gf,xg){return Rd(qa.$.qa.ta,Gc,gd,e,Uc,lh.b(We,qa.Qqf),Gf,xg,e,Wd)},function(We){return new mg.a(502,0,We,64,M)},C):wg.a(this.$.userOperationManager,function(We,Gf,xg){return Rd(qa.$.qa.ta,Gc,gd,e,Uc,lh.b(We,qa.Qqf),Gf,xg,e,
Wd)},function(We){return new Xe.a(502,0,We,void 0,M)},C):Fg.Task.Ta(!1)};sb.prototype.wya=function(){kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5352069_ReportDiscontinousCCPErrorsAsQos")&&jh.a(Rg.a.discontinuousSelectionBlocking,["OtherICE"],!0,!0,!1,!1,null);var e=oh.a.jd(1,1,735,2121,0,371863010,"DiscontinuousSelectionBlocking");kd.EwaSettings.az()?new Jg.a(this.$,e):(e=new Oh.ErrorDialog(this.$,e),e.initialize(),e.mf())};Object(sd.a)(sb,"AutoSumCommandHandler",tf.a,[237]);var ti=cf.a;vm(vc,
ti);vc.prototype.Md=function(){this.Ed([new sb(this.$)])};vc.ja=function(e){cf.a.de(96,new vc(e))};Object(sd.a)(vc,"AutoSumCommandHandlerFactory",cf.a,[]);var th=b(10),Pg=b(179),hi=b(308),ah=b(36),qi=b(318);$b.prototype.xt=function(){return this.command};Object(sd.a)($b,"MacroRecorderRangeOperationAppliedPayload",null,[116]);var Ch=b(302),gh=b(67),yi=ah.a;vm(rb,yi);rb.prototype.zzg=function(e){this.addHandler("ekcvc",e)};rb.prototype.T3i=function(e){this.removeHandler("ekcvc",e)};rb.prototype.Xc=
function(){return!1};rb.prototype.executeCommand=function(e,C){e=C.command;switch(e){case -730106152:C=this.ngd(C,3);break;case -1228228458:C=this.ngd(C,4);break;case -848953656:case 2045211913:if(this.Bdi()){C=Fg.Task.Ta(!0);break}C=this.ngd(C,1);break;default:C=sg.a(e)}return C};rb.prototype.Gc=function(e,C){if(e=1===e)switch(C.command){case -730106152:case -1228228458:case -848953656:case 2045211913:break;default:e=!1}return e};rb.prototype.fd=function(){return!1};rb.prototype.ngd=function(e,C){function M(){return new $b(C,
Wd)}function qa(Gf,xg,Hg){Na.$.Xu();return vf.f(Na.$.qa.ta,C,Wd,!1,lh.b(Gf,Na.jAi),xg,Hg,Uc,We)}var Na=this,Hb=Ye.g(this.$),Gc=Hb.ha.va.selectedRanges,gd=e.command,Uc=Pg.a.create().toString();if(!this.$.xs(Gc,!0)&&-730106152!==gd)return Fg.Task.Ta(!0);var Wd=jg.r(Gc,this.$);this.Hsj(gd,Hb,Gc,Uc);kd.EwaSettings.isChangeGateEnabled("OfficeVSO:3371143_RegisterFormulaBarToClearContentEvent")&&this.IWi();var We=this.$.qa.ta.Xb(!0);return kd.EwaSettings.tc()?wg.a(this.$.userOperationManager,qa,function(Gf){return new mg.a(508,
0,Gf,67,M)},e):wg.a(this.$.userOperationManager,qa,function(Gf){return new Xe.a(508,0,Gf,3,M)},e)};rb.prototype.Hsj=function(e,C,M,qa){var Na=this;if(-848953656!==e&&2045211913!==e&&-730106152!==e&&-1228228458!==e)Dd.ULS.sendTraceTag(537167938,0,10,"ClearCommandHandler.ShowInstantaneousClear: Unexpected command {0}.",e);else if(!hi.a.any(M,function(Gc){return 0<C.getRangeInformation(Gc).length})){var Hb=hi.a.any(M,function(Gc){return Na.tableManager.Pod(Gc)});if(-730106152!==e&&-1228228458!==e||!Hb)this.Nwj(C,
e,qa,M),-730106152!==e&&-1228228458!==e||this.hi.gna(C,-730106152,{}),-1228228458!==e&&2045211913!==e&&-848953656!==e||this.hi.$Tg(M,qa),C.Ji.n0(qa,gh.BasicTelemetryCalculator.sQ)}};rb.prototype.Nwj=function(e,C,M,qa){var Na="";switch(C){case -1228228458:Na="ClearAll";break;case 2045211913:case -848953656:Na="ClearContent";break;case -730106152:Na="ClearFormat";break;default:Dd.ULS.sendTraceTag(537167937,0,15,"ClearCommandHandler.StampTimeWithCompatibleDescription: Unexpected command {0}.",C)}C=qa.length;
qa=jg.b(qa);e.Ji.Y6(15,M,Na+(", ranges to clear: "+C+", cells to clear: "+qa))};rb.prototype.IWi=function(){this.raiseEvent("ekcvc",new qi.a)};rb.prototype.Bdi=function(){if(Ye.g(this.$).Xy){var e=this.$.da.Aa(296);return!!e&&e.lU.yA}return!1};Object(sd.a)(rb,"ClearCommandHandler",ah.a,[237,585]);var ii=cf.a;vm(Da,ii);Da.prototype.Md=function(){var e=this,C=td.GetServiceTaskFactory.create(this.$.da,134,this.ma,this.tb),M=td.GetServiceTaskFactory.create(this.$.da,18,this.ma,this.tb);wf.TaskExtensions.Ba(wf.TaskExtensions.ve([C,
M],this.ma),function(){var qa=new rb(e.$,C.result,M.result);e.Ed([qa]);e.$.da.Ha(313,qa)},this.ma,3)};Da.ja=function(e){cf.a.de(101,new Da(e))};Object(sd.a)(Da,"ClearCommandHandlerFactory",cf.a,[]);var la=b(914),nb=b(892),Wb=b(864),Dc=b(1149);Vf.prototype.l4g=function(e,C){if(e&&!(1>e.length)&&C){var M=Object.assign(new Wb.a,{ExternalId:"msPresenceOuter",ControlList:[]});this.K1g(e,M.ControlList);C.push(M)}};Vf.prototype.K1g=function(e,C){var M=Object.assign(new la.a,{ExternalId:"ContextCoauthors",
LabelText:CommonUIStrings.l_PresenceMenuSectionTitle,Menu:Object.assign(new nb.a,{ExternalId:"msPresenceInner",UpdateDynamically:!0,ShouldAutoOpen:!1,MenuSectionList:[]})});Array.add(C,M);C=Object.assign(new Wb.a,{Title:"",ControlList:[]});Array.add(M.Menu.MenuSectionList,C);this.T3g(e,C.ControlList)};Vf.prototype.T3g=function(e,C){for(var M=0;M<e.length;M++){var qa=Object.assign(new Dc.a,{ExternalId:String.format("CoauthorPersona_{0}",M),Command:"336231556",DisplayName:e[M].userName,LabelText:e[M].userName,
ImageBackColor:e[M].color,PersonaId:e[M].email,IsAnonymous:e[M].isAnonymous});Array.add(C,qa)}};Object(sd.a)(Vf,"PresenceContextMenuSectionBuilder",null,[589]);var zb=b(80),hd=b(5),ke=b(171),He=b(581),df=b(109),kf=b(128),ff=b(88),Ef=b(86),Qf=b(108),Vg=b(29);sf.prototype.Mg=function(e,C){var M=hd.AFrameworkApplication.Eb;M.hf(Vg.a.authenticationLost,Qf.a.frame,e,96);M.hf(Vg.a.iqe,Qf.a.frame,C,96);M.$b(Vg.a.due,Qf.a.frame,ke.ActionManager.n5c);M.$b(Vg.a.eue,Qf.a.frame,ke.ActionManager.n5c);M.$b(Vg.a.Qqd,
Qf.a.frame,ke.ActionManager.n5c)};sf.prototype.Mqf=function(){this.showDialog(CommonUIStrings.l_AuthenticationLostMessage);hd.AFrameworkApplication.Eb.processAction(Vg.a.authenticationLost,2)};sf.prototype.Nqf=function(){this.FAj();hd.AFrameworkApplication.Eb.processAction(Vg.a.iqe,2)};sf.prototype.mIg=function(){this.cVb.authenticationCheck()};sf.prototype.FAj=function(){this.pD&&(this.pD.hide(),this.pD.dispose(),this.pD=null);this.Q7&&this.businessBar&&(hd.AFrameworkApplication.Gg||this.businessBar.removeEntry(this.Q7),
this.Q7.dispose(),this.Q7=null)};sf.prototype.showDialog=function(e){ff.a.Fa(this.pD);this.pD=new kf.StandardDialog;this.zrg||(this.pD.Gu=!1,this.pD.kc=0);this.pD.Cc(1,CommonUIStrings.l_SignIn);this.pD.HW(CommonUIStrings.l_DefaultDialogTitle,e,Object(zb.a)(this,this.Ov,"dialogHandler"))};sf.prototype.Ov=function(e){1===e?(He.a.b6(),this.showDialog(CommonUIStrings.l_AuthenticationLostSigninInProgressMessage),hd.AFrameworkApplication.Eb.processAction(Vg.a.Qqd,2)):(this.yJb(),hd.AFrameworkApplication.Eb.processAction(Vg.a.eue,
2))};sf.prototype.yJb=function(){this.businessBar&&this.sse&&(this.Q7=this.sse.create(CommonUIStrings.l_AuthenticationLostTitle,CommonUIStrings.l_AuthenticationLostMessage,null),this.Q7.closeable=!0,this.Q7.addButton(CommonUIStrings.l_SignIn,sf.MNg,""),this.Q7.V9=Object(zb.a)(this,this.PNg,"businessBarEntryCloseHandler"),this.businessBar.BD(this.Q7,!1))};sf.prototype.PNg=function(){this.Oah();hd.AFrameworkApplication.Eb.processAction(Vg.a.due,2)};sf.prototype.Oah=function(){this.Ri&&(hd.AFrameworkApplication.oj.Bp(this.Ri),
this.Ri=null)};sf.prototype.dispose=function(){this.Ri=this.pD=this.Q7=null};sf.MNg=function(){He.a.b6();hd.AFrameworkApplication.Eb.processAction(Vg.a.Qqd,2)};tl.Object.defineProperties(sf.prototype,{businessBar:{configurable:!0,enumerable:!0,get:function(){return this.Y0||(this.Y0=Ef.a.instance.Hh("CommonUI.IBusinessBar"))}},sse:{configurable:!0,enumerable:!0,get:function(){return this.L_d||(this.L_d=Ef.a.instance.Hh("CommonUI.IBusinessBarEntryFactory"))}}});Object(sd.a)(sf,"SignOutResponseUI",
null,[3]);var Kg=b(274);Qe.prototype.di=function(e){e.register(Vf,"Common.App.UI.PresenceContextMenuSectionBuilder").as("Common.App.UI.IPresenceContextMenuSectionBuilder").zc()};Qe.prototype.init=function(){};Qe.prototype.dispose=function(){ff.a.Fa(Qe.D1);Qe.D1=null};Qe.main=function(){Kg.a.instance.mj(new Qe)};tl.Object.defineProperties(Qe.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.UI"}}});Qe.D1=null;Object(sd.a)(Qe,"CommonAppUIPackage",null,[4,5]);var yh=b(142);
Object(sd.a)(Me,"SharedSortCondition",null,[]);Object(sd.a)(Md,"SharedSortOptions",null,[]);var fh=b(843),If=b(4),eh=b(462),Qh=b(589),xi=b(52),Ca=b(1044),ra=b(125),yb=b(876),Hd=b(141),ye=b(126),Cf=b(202),Bf=b(92),ch=b(69),Tg=b(32),fe=b(14),Ih=b(62),Th=b(127),h=b(211),Bb=b(901),ic=b(902),Nc=b(132),pd=b(48),xe=b(34),Ue=b(414);Object(sd.a)(md,"AutoFilterMenu",null,[]);Object(sd.a)(Ec,"MenuItem",null,[]);Object(sd.a)(Ob,"MenuSection",null,[]);Object(sd.a)(Aa,"ApplyFilterByValueResponse",null,[]);Object(sd.a)($f,
"FilterByValueItem",null,[]);Object(sd.a)(lg,"GetColorsAndIconsResponse",null,[]);Object(sd.a)(ag,"GetFilterByValueItemsResponse",null,[]);Object(sd.a)(ef,"ShowSortFilterMenuParams",null,[]);Object(sd.a)(Od,"SortFilterControllerFactoryParams",null,[]);Object(sd.a)(Ld,"TargetPoint",null,[]);var qe=b(335),ja=fh.a;vm(Bd,ja);Bd.prototype.executeCommand=function(e,C,M){var qa=this;e=C.command;switch(e){case 1701016594:fh.a.Rrh(M);break;case 966232027:var Na=M.domEvent;if(ch.e(Na.rawEvent)&&ch.e(Na.rawEvent)&&
(ch.g(Na),Na.target&&(e=new Hd.a(this.$.xa),e.te(4096)||e.te(2048)))){var Hb=xi.a.li(M[eg.a.Kg]);this.oZf(Hb)&&(kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled")?this.dif?(kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5680883_trackInteractivityFilterMenuOnlySync")&&h.b(this.$).Jna(Na.rawEvent,"open_menu_auto_filter"),this.crc(Na,Na.target,Hb,C)):(this.EBd=function(){qa.oZf(Hb)&&(qa.v5h(),qa.crc(Na,Na.target,Hb,C),qa.w1a=kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.FilterByValueSearch",
!1),qa.dif=!0)},this.uwc()):this.VN(Na,Na.target,Hb,C,!0))}break;default:return sg.a(e)}return Fg.Task.Ta(!0)};Bd.prototype.Gc=function(e,C,M){if(e=!!M)switch(C.command){case 1701016594:case 966232027:eh.a(this.$)||(e=!1,Dd.ULS.sendTraceTag(537167137,0,15,"AutoFilterContextMenu.CanExecuteCommand: ContextMenuManager is not ready. RibbonCommand was {0}",pd.b().pi(C.command)));break;default:e=!1}return e};Bd.prototype.VN=function(e,C,M){Dd.ULS.shipAssertTag(537167136,0,!!M,"Attempt at opening AutoFilterContextMenu failed, autoFilterData is null.");
this.M_a=this.pDh(M);this.aw&&!M.IsHeaderSnapped?this.so(fh.a.X9b(this.$,M.Cell,!0),!0):ja.prototype.VN.call(this,e,C,M,null,!0)};Bd.prototype.qBd=function(e){Array.addRange(e.MenuSectionList,this.M_a)};Bd.prototype.v5h=function(){var e=this;Ue.a(function(){e.hKb=sortFilter.SortFilterControllerFactoryGlobal.createSortFilterController(Object.assign(new Od,{getFilterByValueItemsRequest:e.ODi,applyFilterByValueRequest:e.Syi,onMenuItemClick:e.onMenuItemClick,autoFilterMenuWidth:Bd.oqe,applySortByColorOrIconRequest:e.iGg}))});
this.y8c=Ef.a.instance.Hh("Common.IExternalUICommandDefinitionMapping")||new Qh.a(this.$.Ib,this.$)};Bd.prototype.crc=function(e,C,M){Th.b(this.$).ae(ra.a.crc,this.dm(),void 0,!0);Dd.ULS.shipAssertTag(537167135,0,!!M,"Attempt at opening AutoFilterContextMenu failed, autoFilterData is null.");e=this.oDh(M);var qa=Sys.UI.DomElement.getBounds(C),Na=qa.x+qa.width;qa=qa.y;this.aw&&!M.IsHeaderSnapped&&(M=fh.a.X9b(this.$,M.Cell,!0),Na=M.x,qa=M.y);M=Ye.g(this.$).rtl?new Sys.UI.Point(Na-xe.a(this.$).nFa(Bd.oqe),
qa):new Sys.UI.Point(Na,qa);this.ISa(M,C);M=xe.a(this.$).OJa(M);C=Object.assign(new ef,{targetPoint:Object.assign(new Ld,{left:M.x,top:M.y}),autoFilterMenu:e});this.hKb.showSortFilterMenu(C);this.$.Ce(-544117314,-1,0,null)};Bd.prototype.oZf=function(e){return kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5819197_CheckActiveItemBeforeRenderingAutofilterMenu")&&e.Cell.SheetName?Ye.g(this.$).P4?e.Cell.SheetName===this.$.oa.name:e.Cell.SheetName===this.$.oa.sheetName:!0};Bd.prototype.oDh=function(e){return(e=
this.dUe(e))?this.UFf(e):null};Bd.prototype.UFf=function(e){for(var C=[],M=yl(e.Sections),qa=M.next();!qa.done;qa=M.next())qa=this.CUi(qa.value),Array.add(C,qa);return Object.assign(new md,{Id:e.Id,Sections:C})};Bd.prototype.CUi=function(e){for(var C=[],M=yl(e.MenuItems),qa=M.next();!qa.done;qa=M.next())if(qa=qa.value,2===qa.Identifier)this.LUc=qa.CommandData;else switch(qa.Type){case 3:case 2:Array.add(C,this.AUi(qa,2===qa.Type));break;case 1:Array.add(C,this.BUi(qa))}return Object.assign(new Ob,
{MenuItems:C,DisplayType:e.DisplayType,Id:this.NAh(e)})};Bd.prototype.BUi=function(e){var C=this.mTe(e);var M=C.label;var qa=C.HKa;C=this.UFf(e.SubMenu);var Na=this.aTe(e);qa=this.y8c.s$b(qa);M=M||e.Label;return Object.assign(new Ec,{Disabled:e.Disabled,Type:e.Type,Identifier:e.Identifier,Id:Na,CommandData:e.CommandData,Label:M,SubMenu:C,IsChecked:e.IsChecked,IconName:"MissingIcon_20"===qa?null:qa})};Bd.prototype.AUi=function(e,C){var M=this.c9b(e,C&&e.IsChecked);C=M.label;var qa=M.HKa;M=M.$o;var Na=
this.Had(e,C);qa=this.y8c.s$b(qa);return Object.assign(new Ec,{Disabled:e.Disabled,Type:e.Type,Identifier:e.Identifier,Id:Na,RibbonCommand:M,CommandData:e.CommandData,Label:C||e.Label,SubMenu:null,IsChecked:e.IsChecked,IconName:"MissingIcon_20"===qa?null:qa})};Bd.prototype.dUe=function(e){var C;this.qSa=C=jg.C(e.Cell);this.sheetName=this.$.oa.sheetName;if(e.IsHeaderSnapped)C=eh.a(this.$).Q7b.pKh(C);else{var M=Ye.g(this.$).Ca.nub(C);if(!M)return this.SLa?Bb.a.DPa(ic.a.iIf,Rg.a.WVh,Nc.a.BYa,!0,!1):
Dd.ULS.sendTraceTag(537167134,0,10,"AutoFilterContextMenu.GetAutoFilterMenuProps: gridModelCellProxy that is supposed to hold model is null. Range requested {0}, visible range: {1}",C,Ye.g(this.$).view.visibleArea),null;C=M.autoFilterMenu}if(!C)return this.SLa?Bb.a.DPa(ic.a.iIf,Rg.a.lsi,Nc.a.BYa,!0,!1):Dd.ULS.sendTraceTag(537167133,0,10,"AutoFilterContextMenu.GetMenuPropsFromCachedBlock: a cell that's supposed to have an autofilter menu returned a null menu."),null;this.Zqb=e.Cell.FirstRow+"_"+e.Cell.FirstColumn;
return C};Bd.prototype.pDh=function(e){return(e=this.dUe(e))?this.$td(e.Sections):null};Bd.prototype.uwc=function(){var e=this;if(this.$.fa.Mh){var C=td.GetServiceTaskFactory.Xa(this.$.da,283,284,1);wf.TaskExtensions.Ba(C,function(){e.SLa?C.result.wo.loadScript("sortFilter").then(function(){e.EBd()},function(M){Ih.a.km(M,"AutoFilterContextMenu.SortFilterScriptLoad");Bb.a.DPa(ic.a.uwc,Rg.a.Qvj,Nc.a.BYa,!1,!1)}):wf.TaskExtensions.Ba(qe.c(C.result.wo.loadScript("sortFilter")),function(){e.EBd()},e.$.ma,
3)},this.$.ma,3)}else this.$.fa.sn(this.aN)};Bd.prototype.e0g=function(e){var C={};C.SearchText=e;C.Page=1;C.DateNodeType=-1;return C};Bd.prototype.qQg=function(){this.zOa&&(Dd.ULS.sendTraceTag(537167132,0,15,"AutoFilterContextMenu.CancelGetAutoFilterItemListWebRequest Cancelling pending getAutoFilterItemList request with ID={0}",this.zOa),vf.j(this.$.qa.ta,this.zOa,null,null,null),this.zOa=null);this.q9a&&(hd.AFrameworkApplication.Hd.Zt(this.q9a.kt),this.q9a=null)};Bd.prototype.Zxd=function(e){var C=
this;return function(M){C.zOa=null;C.q9a=null;if(Bb.a.pvc(M)){var qa=Bb.a.t9b(M);C.SLa?Bb.a.DPa(e?ic.a.searchAutoFilterItemList:ic.a.getAutoFilterItemList,qa.MessageIdName,Nc.a.BYa,!0,!0):Dd.ULS.sendTraceTag(537167127,0,10,"AutoFilterContextMenu::OnGetFilterByValueItemsSuccessCallback failed with AutoFilterException -{0}",qa.MessageIdName)}if(!Ch.a(M)){Dd.ULS.sendTraceTag(537167126,0,50,"AutoFilterContextMenu::OnGetFilterByValueItems service call succeeded");M=M.Result;qa=new Tg.a(!0);var Na=M.AutoFilterDateNodes?
!0:!1;M.AutoFilterItems&&qa.add("AutoFilterItemsCount",M.AutoFilterItems.length);Na&&qa.add("AutoFilterDateItemsCount",M.AutoFilterDateNodes.length);qa.add("Location","contextMenu");Th.b(C.$).ae(ra.a.Zxd,qa.Nu,void 0,!0);qa=C.w1a?Object.assign(new ag,{filterByValueItems:C.uze(M),hasMoreRecords:M.ItemListMaxExceeded,searchText:M.SearchText}):Object.assign(new ag,{filterByValueItems:C.uze(M),hasMoreRecords:M.ItemListMaxExceeded});C.hKb.onGetFilterByValueItemsFinish(qa);!e&&kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SortByColor",
!1)&&(Dd.ULS.shipAssertTag(529063959,0,null!==M.FontColors&&null!==M.CellColors&&null!==M.Icons&&null!==M.SelectedSortFontColors&&null!==M.SelectedSortCellColors&&null!==M.SelectedSortIcons,"AutoFilterContextMenu.onGetFilterByValueItemsSuccessCallback: SortByColor items should not be null"),M=Object.assign(new lg,{fontColors:M.FontColors,cellColors:M.CellColors,icons:M.Icons,selectedSortFontColor:0<M.SelectedSortFontColors.length?M.SelectedSortFontColors[0]:null,selectedSortCellColor:0<M.SelectedSortCellColors.length?
M.SelectedSortCellColors[0]:null,selectedSortIcon:0<M.SelectedSortIcons.length?M.SelectedSortIcons[0]:null,getColorName:C.getColorName}),C.hKb.onGetColorsAndIconsFinish(M))}}};Bd.prototype.PDi=function(){var e=this;return function(C){e.zOa=null;e.q9a=null;C=ye.a.yg(C.data);Dd.ULS.sendTraceTag(537167125,0,10,"AutoFilterContextMenu.OnGetFilterByValueItemsFailureCallback Errors: [{0}].",oh.a.Uc(C))}};Bd.prototype.uze=function(e){var C=this.VYg(e),M=this.bZg(e.AutoFilterItems),qa=[],Na=0;e.HasBlanks&&
(e=Bd.U1c(fe.a.instance.ea(762),e.IsBlanksSelected?1:0,If.a.nqe),qa[Na++]=e);C=yl(C);for(e=C.next();!e.done;e=C.next())e=e.value,qa[Na++]=e;M=yl(M);for(e=M.next();!e.done;e=M.next())C=e.value,qa[Na++]=C;return qa};Bd.prototype.VYg=function(e){var C=[];if(!e.AutoFilterDateNodes||!e.AutoFilterDateNodes.length)return C;for(var M=[this.L2a(e.YearKeys,e.YearValues),this.L2a(e.MonthKeys,e.MonthValues),this.L2a(e.DayKeys,e.DayValues),this.L2a(e.HourKeys,e.HourValues),this.L2a(e.MinuteKeys,e.MinuteValues),
this.L2a(e.SecondKeys,e.SecondValues)],qa=!1,Na=!1,Hb=0,Gc=null,gd=Array(6),Uc=null,Wd=yl(e.AutoFilterDateNodes),We=Wd.next();!We.done;We=Wd.next()){We=We.value;gd[0]&&(Uc.Year!==We.Year?(qa=!0,Hb=0,Gc=null):Uc.Month!==We.Month?(Na=!0,Hb=1,Gc=gd[0]):Uc.Day!==We.Day?(Hb=2,Gc=gd[1]):e.ShowTime&&(Uc.Hour!==We.Hour?(Hb=3,Gc=gd[2]):Uc.Minute!==We.Minute?(Hb=4,Gc=gd[3]):(Hb=5,Gc=gd[4])));for(;6>Hb;){switch(Hb){case 0:var Gf=We.Year;Uc=M[0].getItem(Gf.toString());break;case 1:Gf=We.Month;Uc=M[1].getItem(Gf.toString());
break;case 2:Gf=We.Day;Uc=M[2].getItem(Gf.toString());break;case 3:Gf=We.Hour;Uc=M[3].getItem(Gf.toString());break;case 4:Gf=We.Minute;Uc=M[4].getItem(Gf.toString());break;case 5:Gf=We.Second;Uc=M[5].getItem(Gf.toString());break;default:throw Error.invalidOperation("Unknown AutoFilterDateNodeType.");}Uc=Bd.U1c(Uc,-1!==We.NodeType&&Hb>=We.NodeType?1:0,Gc?Gc.key+";"+Gf:If.a.KVc+Gf,!1,[]);Gc=Gc?Gc.children:C;Gc=Gc[Gc.length]=Uc;gd[Hb]=Uc;switch(Hb){case 5:Hb=6;break;case 2:Hb=e.ShowTime?Hb+1:6;break;
default:Hb++}}Uc=We}qa||(gd[0].expanded=!0,Na||(gd[1].expanded=!0));return C};Bd.prototype.bZg=function(e){var C=[];if(!e)return C;var M=0;e=yl(e);for(var qa=e.next();!qa.done;qa=e.next())qa=qa.value,C[M++]=Bd.U1c(qa.DisplayString,qa.Selected?1:0,If.a.LVc+qa.DisplayString);return C};Bd.prototype.L2a=function(e,C){var M=new Tg.a(!0);if(!e||!C)return M;for(var qa=e.length<C.length?e.length:C.length,Na=0;Na<qa;Na++)M.add(e[Na].toString(),C[Na]);return M};Bd.prototype.D1c=function(e,C){var M={};M.Location=
C;M.FieldId=e.Id.toString();M.DataSourceIndex=-1;M.FilterType=e.AutoFilterType;M.AnchorType=0;M.ChartId=null;M.AnchorValue1=-1;M.AnchorValue2=-1;M.Property=e.RichProperty;return M};Bd.prototype.ZK=function(e){kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.PivotTableHandRaise",!1)&&wf.TaskExtensions.Ba(td.GetServiceTaskFactory.Xa(this.$.da,430,431,1),function(C){C.result.Pda(e);Dd.ULS.sendTraceTag(537167123,306,50,"AutoFilterContextMenu:TriggerPivotTableHandRaise Trigger hand raise from filter context menu.")},
this.$.ma,3)};Bd.prototype.dm=function(){var e={};return e.Location="contextMenu",e};Bd.prototype.getColorName=function(e){return yb.a.JJa(Cf.a.GG(e))};Bd.prototype.Q_f=function(e){wf.TaskExtensions.Ba(td.GetServiceTaskFactory.Xa(this.$.da,309,310,3),function(C){C.result.dAa().continueWith(function(M){M.result&&e()})},this.$.ma,3)};Bd.U1c=function(e,C,M,qa,Na){e=void 0===e?null:e;C=void 0===C?0:C;M=void 0===M?null:M;qa=void 0===qa?!1:qa;Na=void 0===Na?null:Na;return Object.assign(new $f,{displayText:e?
fh.a.ym(e):e,state:C,key:M,parent:null,children:Na,indentationLevel:0,expanded:qa})};tl.Object.defineProperties(Bd.prototype,{Kt:{configurable:!0,enumerable:!0,get:function(){return"PopulateAutoFilterContextMenu"}},VA:{configurable:!0,enumerable:!0,get:function(){return If.a.gIf}}});Bd.oqe=268;Object(sd.a)(Bd,"AutoFilterContextMenu",fh.a,[]);var Ka=b(850),qc=b(84),lc=b(185),Cd=b(66),pc=b(16);bd.YPe=26;bd.J9c=[229,230,0,98,0,94,93];Object(sd.a)(bd,"Constants",null,[]);tl.Object.defineProperties(xc.prototype,
{wci:{configurable:!0,enumerable:!0,get:function(){return 3===this.g3b}},Rfi:{configurable:!0,enumerable:!0,get:function(){return 4===this.g3b&&!!this.subMenu}},subMenu:{configurable:!0,enumerable:!0,get:function(){return this.usg}},smf:{configurable:!0,enumerable:!0,get:function(){return this.Xng}},g3b:{configurable:!0,enumerable:!0,get:function(){return this.Lig}},s3c:{configurable:!0,enumerable:!0,get:function(){return this.Pig}}});Object(sd.a)(xc,"FiltersMenuData",null,[]);vm(Hf,xc);Object(sd.a)(Hf,
"AutoFilterFiltersMenuData",xc,[]);tg.WAj=[new xc(99,2,0,null),new xc(100,2,1,null),new xc(0,3,0,null),new xc(171,2,2,null),new xc(173,2,4,null),new xc(0,3,0,null),new xc(175,2,6,null),new xc(176,2,7,null),new xc(0,3,0,null),new xc(107,0,0,null)];tg.lxi=[new xc(99,2,0,null),new xc(100,2,1,null),new xc(0,3,0,null),new xc(101,2,8,null),new xc(102,2,10,null),new xc(103,2,12,null),new xc(0,3,0,null),new xc(104,1,0,null),new Hf(105,1),new Hf(106,2),new xc(0,3,0,null),new xc(107,0,0,null)];tg.O7g=[new xc(99,
2,0,null),new xc(0,3,0,null),new xc(111,2,10,null),new xc(112,2,8,null),new xc(103,2,12,null),new xc(0,3,0,null),new Hf(109,8),new Hf(108,9),new Hf(110,10),new xc(0,3,0,null),new Hf(114,11),new Hf(113,12),new Hf(115,13),new xc(0,3,0,null),new Hf(116,14),new Hf(117,15),new Hf(118,16),new xc(0,3,0,null),new Hf(119,17),new Hf(120,18),new Hf(121,19),new xc(0,3,0,null),new Hf(122,20),new Hf(123,21),new Hf(124,22),new xc(0,3,0,null),new Hf(125,23),new xc(126,2,12,[new Hf(127,24),new Hf(128,25),new Hf(129,
26),new Hf(130,27),new xc(0,3,0,null),new Hf(131,28),new Hf(132,29),new Hf(133,30),new Hf(134,31),new Hf(135,32),new Hf(136,33),new Hf(137,34),new Hf(138,35),new Hf(139,36),new Hf(140,37),new Hf(141,38),new Hf(142,39)]),new xc(0,3,0,null),new xc(107,0,0,null)];Object(sd.a)(tg,"Constants",null,[]);var K=b(19);zf.prototype.compare=function(e,C){return K.a.compare(e,C,!0)};Object(sd.a)(zf,"IgnoreCaseComparer",null,[620]);var ha=b(72),H=fh.a;vm(Wf,H);Wf.prototype.executeCommand=function(e,C,M){e=C.command;
switch(e){case -699941697:this.applyAutoFilterFieldList(C,M);break;case 216058793:String.format("TableFieldListContextMenu:AutoFilterFieldListContextMenuClose");break;case -1494291901:break;default:return sg.a(e)}return Fg.Task.Ta(!0)};Wf.prototype.Dbd=function(e,C){return!e||e.length<=C?(Dd.ULS.sendTraceTag(537167117,0,10,"AutoFilterFieldListContextMenu:GetCommandId - incomplete id list"),-1):parseInt(e[C])};Wf.prototype.UCd=function(e,C,M,qa,Na,Hb){var Gc=this.Dbd(Na,Hb);0>Gc&&Dd.ULS.sendTraceTag(537167116,
0,10,"AutoFilterFieldListContextMenu:ProcessCommand - command id not found");switch(bd.J9c[Gc]){case 98:e=new Bf.a(-2058042992,C.method,C.mode,C.df,C.tabName);this.am.lG.ksb(this.$,qa,0,e);break;case 229:e=new Bf.a(504133448,C.method,C.mode,C.df,C.tabName);this.am.lG.ksb(this.$,qa,0,e);break;case 230:e=new Bf.a(-798968736,C.method,C.mode,C.df,C.tabName);this.am.lG.ksb(this.$,qa,0,e);break;case 231:e=new Bf.a(-1677817820,C.method,C.mode,C.df,C.tabName);this.am.lG.ksb(this.$,qa,0,e);break;case 94:this.hGf(e,
C,qa,M,Na,Hb+1);break;case 93:this.am.lG.Cji(this.$,qa)}};Wf.prototype.hGf=function(e,C,M,qa,Na,Hb){var Gc=this.Dbd(Na,Hb);0>Gc&&Dd.ULS.sendTraceTag(537167115,0,10,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand - command id not found");if(!qa||Gc>=qa.length)Dd.ULS.sendTraceTag(537167114,0,15,"AutoFilterFieldListContextMenu:ProcessSubMenuCommand() - no menuData.");else switch(qa=qa[Gc],qa.g3b){case 1:this.am.lG.Uji(this.$,M);break;case 2:(Na=Object(qc.a)(Hf,qa))?(e=new Bf.a(-2058042992,C.method,
C.mode,C.df,C.tabName),this.am.lG.ksb(this.$,M,Na.pqe,e)):this.am.lG.Vgf(this.$,e,M,qa.s3c);break;case 0:this.am.lG.Vgf(this.$,e,M,qa.s3c);break;case 4:this.hGf(e,C,M,qa.subMenu,Na,Hb+1)}};Wf.prototype.applyAutoFilterFieldList=function(e,C){var M=C[Ka.a.bI];if(M)if(M=M.split(Cd.a.kU),3>M.length)Dd.ULS.sendTraceTag(537167112,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - unexpected SourceIdControl string.");else{var qa=this.Dbd(M,1),Na=this.AJa(qa),Hb=this.mmf(qa).returnValue;Hb?
this.UCd(C,e,Hb,Na,M,2):Dd.ULS.sendTraceTag(537167111,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - menu data not found for index "+qa.toString()+Cd.a.kU)}else Dd.ULS.sendTraceTag(537167113,0,15,"AutoFilterFieldListContextMenu:ApplyAutoFilterFieldList() - SourceIdControl string is null.")};Wf.prototype.Gc=function(e,C){if(e=this.$.isEditMode)switch(C.command){case 216058793:break;case -699941697:break;case -1494291901:e=!0;break;default:e=!1}return e};Wf.prototype.VN=function(e,
C,M){this.$.isEditMode&&((this.am=Object(qc.a)(685,M))||Dd.ULS.sendTraceTag(537167110,0,10,"AutoFilterFieldListContextMenu:ShowDropDown() - filterInfoManager not found."),this.zY(),H.prototype.VN.call(this,e,C,null,null,!0))};Wf.prototype.M1c=function(){if(!this.am||!this.am.Tk||1!==this.am.Tk.length)return Dd.ULS.sendTraceTag(537167109,0,15,"AutoFilterFieldListContextMenu:CreateContextMenuItemList() - incorrect fields list."),null;var e=this.am.Tk[0],C=new lc.a;C.add(fe.a.instance.ea(247));C=ha.OBc(ha.concat(C,
ha.select(ha.asEnumerable(e.FieldInfoDataList),function(M){return M.Name})),function(M){return M},new zf);return ha.toArray(C)};Wf.prototype.fieldIndex=function(e){if(!this.am||!this.am.Tk||1!==this.am.Tk.length||!this.am.Tk[0].FieldInfoDataList)return-1;for(var C=0;C<this.am.Tk[0].FieldInfoDataList.length;++C)if(this.am.Tk[0].FieldInfoDataList[C].Name===e)return C;return-1};Wf.prototype.AJa=function(e){return 0>e||!this.am||!this.am.Tk||1!==this.am.Tk.length||!this.am.Tk[0].FieldInfoDataList||this.am.Tk[0].FieldInfoDataList.length<
e?null:this.am.Tk[0].FieldInfoDataList[e].Name};Wf.prototype.zY=function(){var e=this,C=this.M1c();if(!C||!C.length)return null;for(var M=this.Sa,qa=M.Lc(),Na={},Hb=0;Hb<C.length;Na={Teb:Na.Teb},++Hb){var Gc=C[Hb];Na.Teb=0<Hb?this.fieldIndex(Gc):-1;for(var gd=Wf.r1f+Na.Teb.toString()+Cd.a.kU,Uc=null,Wd=this.am.lG.EZh(0<Hb?Gc:null),We=this.X1c(M,Wd,Wf.r1f+Na.Teb.toString(),Gc),Gf={},xg=0;xg<bd.J9c.length;Gf={INb:Gf.INb,Seb:Gf.Seb},++xg){var Hg=bd.J9c[xg],Ig=gd+xg.toString();Uc||(Uc=M.Lc());switch(Hg){case 229:Array.add(Uc.buttons,
M.dd(223,Ig,-699941697,this.am.lG.Dfi(0<Hb?Gc:null)?pc.a.Hta:pc.a.E3,8,229,!1,null));break;case 230:Array.add(Uc.buttons,M.dd(224,Ig,-699941697,this.am.lG.Efi(0<Hb?Gc:null)?pc.a.Ita:pc.a.G3,8,230,!1,null));break;case 231:Array.add(Uc.buttons,M.dd(225,Ig,-699941697,pc.a.P6b,1,231,!1,null));break;case 98:Hg=this.NMg(Gc);Ig=M.TGa(Ig+(Wd?".enabled":".disabled"),Hg,-699941697,null,"None",null,!Wd,void 0,!0);Ig.GR("Image16by16",8,pc.a.g1a);Array.add(Uc.buttons,Ig);break;case 94:Gf.INb=void 0;Gf.Seb=void 0;
var Hh=function(jj,Kj){return function(){var Qj=e.mmf(jj.Teb);Kj.INb=Qj.hQe;Kj.Seb=Qj.isChecked;return Qj}}(Na,Gf)().returnValue;if(!Hh)return null;Hg=this.X1c(M,Gf.Seb&&Wd,Ig,Gf.INb);Ig=this.tTe(Hg.menu,M,Ig+Cd.a.kU,Hh,Gf.Seb&&Wd);Array.add(Hg.menu.yc,Ig);Array.add(Uc.buttons,Hg);break;case 0:Uc&&(Array.add(We.menu.yc,Uc),Uc=null);break;default:Ig=M.TGa(Ig,fe.a.instance.ea(Hg),-699941697,null,"None",null,!1,void 0,!0),this.HUf(Ig,Wd&&93===Hg&&this.am.lG.filter(),fe.a.instance.ea(Hg)),Array.add(Uc.buttons,
Ig)}}Array.add(We.menu.yc,Uc);Array.add(qa.buttons,We)}C=M.zp(this.menuId);Array.add(C.yc,qa);return C};Wf.prototype.tTe=function(e,C,M,qa,Na){for(var Hb=null,Gc=0;Gc<qa.length;++Gc){var gd=qa[Gc],Uc=M+Gc.toString(),Wd=!1;switch(gd.g3b){case 1:Wd=Na&&this.am.lG.Ih.IsTop10;break;case 2:Wd=Object(qc.a)(Hf,gd);Wd=Na&&this.am.lG.o$h(Wd?Wd.pqe:0,gd.s3c);break;case 0:Wd=Na&&this.am.lG.Ih.IsCustomSupportedAndNotPresent}Hb||(Hb=C.Lc());if(gd.wci)Hb&&(Array.add(e.yc,Hb),Hb=null);else if(gd.Rfi){var We=fe.a.instance.ea(gd.smf);
We=this.X1c(C,Wd,Uc,We);Array.add(We.menu.yc,this.tTe(We.menu,C,Uc+Cd.a.kU,gd.subMenu,Wd));Array.add(Hb.buttons,We)}else gd=fe.a.instance.ea(gd.smf),Uc=C.TGa(Uc,gd,-699941697,null,"None",null,!1,void 0,!0),this.HUf(Uc,Wd,gd),Array.add(Hb.buttons,Uc)}return Hb};Wf.prototype.HUf=function(e,C,M){C?e.GR("Image16by16",8,pc.a.jia):e.GR("None",0,null);e.DR(M);e.label=M};Wf.prototype.X1c=function(e,C,M,qa){return C?e.O1c(M,this.menuId,qa,798637440,8,pc.a.jia):e.Kv(M,this.menuId,qa,798637440)};Wf.prototype.yj=
function(e){return!e||!e.length};Wf.prototype.mmf=function(e){var C=0>e?0:this.am.Tk[0].FieldInfoDataList[e].MajorityDataTypeForField;var M=null;e=this.am.lG.DZh(C);switch(C){case 0:M=95;C=tg.WAj;break;case 1:M=94;C=tg.lxi;break;case 2:M=96;C=tg.O7g;break;default:return Dd.ULS.sendTraceTag(537167108,0,10,"AutoFilterFieldListContextMenu:MenuDataForDataType() - unknown data type."),{returnValue:null,hQe:M,isChecked:e}}M=fe.a.instance.ea(M);return{returnValue:C,hQe:M,isChecked:e}};Wf.prototype.NMg=function(e){!e||
this.yj(e.trim())?e=fe.a.instance.ea(97):e.length>bd.YPe?(e=e.substring(0,bd.YPe),e=String.format(fe.a.instance.Cb(154),e)):e=String.format(fe.a.instance.Cb(155),e);return e};tl.Object.defineProperties(Wf.prototype,{Kt:{configurable:!0,enumerable:!0,get:function(){return"PopulateAutoFilterFieldListContextMenu"}},VA:{configurable:!0,enumerable:!0,get:function(){return If.a.hIf}}});Wf.Gth="AutoFilterFieldsContextMenu";Wf.bHb="AutoFilterFieldListContextMenuRoot";Wf.r1f="ApplyAutoFilterFieldList.";Object(sd.a)(Wf,
"AutoFilterFieldListContextMenu",fh.a,[]);var aa=b(571),ea=b(977),ab=b(8),Vb=b(115),fc=b(370),Yc=fh.a;vm(bg,Yc);bg.prototype.executeCommand=function(e,C,M){e=Object(qc.a)(aa.a,M.eventArgs);switch(C.command){case -1372040782:M=Ye.g(this.$).ha.Qa.nc;Dd.ULS.shipAssertTag(537167048,0,!!M);M&&(this.floatingObject=M.floatingObject,this.zb=C.method,C=this.W9b(e),this.so(C,!0,e.zb));break;case 848910589:e&&(C=[ea.a.RXf],e=new Sys.UI.Point(e.Ea.clientX,e.Ea.clientY),this.showFloatie(C,new Sys.UI.Bounds(e.x,
e.y,0,0),2))}return Fg.Task.Ta(!0)};bg.prototype.Gc=function(e,C,M){switch(C.command){case -1372040782:return!!M&&this.fef(e);case 848910589:return e=Ye.g(this.$).ha.Qa.nc,!!M&&!!e&&e.isEditing;default:return!1}};bg.prototype.fef=function(e){switch(e){case 8:case 2:case 64:case 4:case 256:return!0;default:return!1}};bg.prototype.hSc=function(e,C,M){fc.a(this.$)?Ye.g(this.$).$a.Zi||(xe.a(this.$).IOd()?Array.add(M.buttons,e.yb(265)):Array.add(M.buttons,e.yb(264))):(this.$.isEditMode&&3===this.zb&&!this.s8b()&&
Array.add(M.buttons,e.yb(101)),5!==this.floatingObject.type||Vb.a.dH(this.floatingObject.Hb)||this.floatingObject.Hb.IsGroup||(kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&this.hod()?Array.add(M.buttons,e.yb(186)):Array.add(M.buttons,e.yb(147))),this.s8b()||this.hod()||Array.add(M.buttons,e.yb(146)),kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeFOZOrder",!1)&&(this.Pzh(M),this.mBh(M)),kd.EwaSettings.la(166)&&!this.floatingObject.type&&Array.add(M.buttons,
e.yb(249)),5===this.floatingObject.type&&Ye.g(this.$).ha.Qa.nc.V4()&&this.$.gka&&this.$.Aga&&Array.add(M.buttons,e.yb(273)))};bg.prototype.BJa=function(e){var C=[];if(fc.a(this.$))return C;3===e?(e=!!this.$.ig.get(5)&&this.floatingObject.FRd(),this.s8b()||(this.$.isEditMode?(e&&Array.add(C,ea.a.Owh),5===Ye.g(this.$).ha.Qa.ZB.floatingObject.type&&Array.add(C,ea.a.onj)):e&&Array.add(C,ea.a.copy)),Array.add(C,ea.a.Pwh)):2===e&&(kd.EwaSettings.isChangeGateEnabled("OfficeVSO:4840604_JsCrashInGetFloatieGroupsForSelection")?
Ye.g(this.$).ha.Qa.nc&&this.jYe(Ye.g(this.$).ha.Qa.nc,C):this.jYe(Ye.g(this.$).ha.Qa.ZB,C));return C};bg.prototype.zY=function(){var e=this.Sa,C=e.zp(this.menuId),M=fc.a(this.$);if(this.$.isEditMode){var qa=e.Lc();this.hSc(e,C,qa);Array.add(C.yc,qa)}this.$.ig.get(5)&&this.floatingObject.FRd()&&!this.s8b()&&!M&&(qa=e.Lc(),this.mwg(e,qa),Array.add(C.yc,qa));!kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShareExcelSection",!1)||this.floatingObject.type||this.$.fa.isNamedObjectViewMode||
M||(M=e.Lc(),this.fyg(e,M),Array.add(C.yc,M));return C};bg.prototype.W9b=function(e){var C=Ye.g(this.$).ha.Qa.nc;e=e&&1!==e.zb&&e.clientPoint?e.clientPoint:Sys.UI.DomElement.getLocation(C.domElement);var M=this.$.domElement,qa=Ye.g(this.$).rtl;(C=ab.HelperMethods.sA(C.Bg.domElement,M,qa))?(e.y=Math.max(e.y,C.y),e.x=Math.max(e.x,C.x)):Dd.ULS.sendTraceTag(537167047,5,15,"FloatingObjectContextMenu.GetContextMenuClientPoint sheetContentDivLocation is null if the offset parent is null. IsShuttingdown : {0}",
hd.AFrameworkApplication.Gg);return e};bg.prototype.hod=function(){var e=Ye.g(this.$).ha.Qa.nc;return!!e&&e.isEditing};bg.prototype.mwg=function(e,C){if(this.$.isEditMode){Array.add(C.buttons,e.yb(42));Array.add(C.buttons,e.yb(43));var M=this.$.da.Aa(254,!0);(M&&2===M.uzb()||kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&this.hod())&&Array.add(C.buttons,e.yb(44))}else Array.add(C.buttons,e.yb(43))};bg.prototype.fyg=function(e,C){Array.add(C.buttons,e.yb(274))};bg.prototype.s8b=
function(){return kd.EwaSettings.la(486)&&!!Ye.g(this.$).ha.Qa.Up};bg.prototype.jYe=function(e,C){5===e.floatingObject.type?kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5449286_ShapeTextEditContextMenu")&&e.isEditing?Array.add(C,ea.a.RXf):Array.add(C,ea.a.knj):Array.add(C,fh.a.kRe)};bg.prototype.Pzh=function(e){var C=this.Sa.Lc();Array.add(C.buttons,this.Sa.yb(282));Array.add(C.buttons,this.Sa.yb(281));var M=this.Sa.Kv("BringToFront","BringToFrontMenuId",fe.a.instance.ea(802),-1777747317);Array.add(M.menu.yc,
C);Array.add(e.buttons,M)};bg.prototype.mBh=function(e){var C=this.Sa.Lc();Array.add(C.buttons,this.Sa.yb(284));Array.add(C.buttons,this.Sa.yb(283));var M=this.Sa.Kv("SendToBack","SendToBackMenuId",fe.a.instance.ea(803),-1777747317);Array.add(M.menu.yc,C);Array.add(e.buttons,M)};tl.Object.defineProperties(bg.prototype,{Kt:{configurable:!0,enumerable:!0,get:function(){return"PopulateFloatingObjectContextMenu"}},VA:{configurable:!0,enumerable:!0,get:function(){return If.a.pIf}}});Object(sd.a)(bg,"FloatingObjectContextMenu",
fh.a,[]);var Zd=b(921),oe=b(96),Ge=b(578),pf=b(522);vm(mf,bg);mf.prototype.executeCommand=function(e,C,M){var qa=this.$;this.zb=C.method;C=M[mf.WYc];if(!(e&68)){if(!C){if(8===e)C=pf.a(qa).Yc;else{var Na=Ye.g(qa).ha.Qa.nc;if(null===Na||void 0===Na?0:Na.floatingObject)C=Na.floatingObject.Yc}if(!C)return Fg.Task.Ta(!0)}this.isPivotChart=!!(C.Attributes&4)}if(this.isPivotChart||qa.isEditMode)if(this.refresh=this.VY=this.qva=this.bAa=!1,Na=Ye.g(this.$).ha.Qa.nc,Dd.ULS.shipAssertTag(537167107,0,!!Na),Na){this.floatingObject=
Na.floatingObject;Na=Ge.a(qa);if(null===Na||void 0===Na?0:Na.eOd)this.bAa=Na=oe.f(qa.kg),this.qva=!Na;Na=qa.lc;this.VY=!!Zd.a(qa)&&!!C&&!!(C.Attributes&512)&&!(e&8)&&Na.n2(32768);Na.allowManualDataRefresh&&Na.allowInteractivity&&(this.refresh=!0);e=this.W9b(Object(qc.a)(aa.a,M.eventArgs));this.so(e,!0)}return Fg.Task.Ta(!0)};mf.prototype.Gc=function(e,C,M){return-149612405===C.command&&!!M&&this.fef(e)};mf.prototype.hSc=function(e,C,M){this.isPivotChart&&(this.refresh&&Array.add(M.buttons,e.yb(100)),
this.VY&&Array.add(M.buttons,e.yb(99)),this.bAa?Array.add(M.buttons,e.yb(59)):this.qva&&Array.add(M.buttons,e.yb(58)));bg.prototype.hSc.call(this,e,C,M)};tl.Object.defineProperties(mf.prototype,{Kt:{configurable:!0,enumerable:!0,get:function(){return"PopulateChartContextMenu"}},VA:{configurable:!0,enumerable:!0,get:function(){return If.a.jIf}}});tl.Object.defineProperties(mf,{WYc:{configurable:!0,enumerable:!0,get:function(){return"chartMetaData"}}});Object(sd.a)(mf,"ChartContextMenu",bg,[]);var Le=
b(11),ug=fh.a;vm(Og,ug);Og.prototype.executeCommand=function(e,C,M){e=C.command;switch(e){case 330754562:C=M.domElement;this.isOlap=M.isOlap;this.bL=M.versionkey;this.$n=M.fieldItem;this.xZ=M.isChart;this.lH=M.isPpm;this.HRd="supportsImplicitMeasures"in M?M.supportsImplicitMeasures:!1;Ye.g(this.$).Dq(!0);e=Le.DOMElementExtensions.getBounds(C);e=new Sys.UI.Point(e.x+e.width,e.y+e.height/2);this.ISa(e,C);"isKeyboardInput"in M&&M.isKeyboardInput?this.so(e,!1,1):this.so(e,!1);break;case 926905850:this.HRd&&
this.$n&&5===this.$n.TypeTag&&!this.$n.IsCollapsible&&Dd.ULS.sendTraceTag(537167057,0,50,"Add implicit measurement from field list.");Ge.a(this.$).xG(this.$n,8,-1,this.bL,C);break;case -67292059:Ge.a(this.$).xG(this.$n,1,-1,this.bL,C);break;case 745182485:Ge.a(this.$).xG(this.$n,2,-1,this.bL,C);break;case 359279088:Ge.a(this.$).xG(this.$n,4,-1,this.bL,C);break;case 547535945:Ge.a(this.$).pYi(this.$n);break;default:return sg.a(e)}return Fg.Task.Ta(!0)};Og.prototype.Gc=function(e,C,M){e=!1;switch(C.command){case 330754562:e=
!!M;break;case 926905850:case -67292059:case 745182485:case 359279088:case 547535945:e=!0}return e};Og.prototype.zY=function(){var e=this.Sa.zp(this.menuId);this.aSi(e);this.xZ||this.isOlap||this.$Ri(e);return e};Og.prototype.aSi=function(e){var C=this.Sa,M=C.Lc(),qa=!1;kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1)&&(qa=this.isOlap&&!this.lH&&this.HRd&&5===this.$n.TypeTag&&!this.$n.IsCollapsible);3!==this.$n.TypeTag&&37!==this.$n.TypeTag||this.$n.IsSet?17===
this.$n.TypeTag||this.lH?(Array.add(M.buttons,C.yb(79)),Array.add(M.buttons,C.yb(this.xZ?91:80)),Array.add(M.buttons,C.yb(this.xZ?92:81)),Array.add(M.buttons,C.yb(82))):13===this.$n.TypeTag||this.$n.IsSet?(Array.add(M.buttons,C.yb(83)),Array.add(M.buttons,C.yb(this.xZ?91:80)),Array.add(M.buttons,C.yb(this.xZ?92:81)),Array.add(M.buttons,C.yb(86))):(Array.add(M.buttons,C.yb(79)),Array.add(M.buttons,C.yb(this.xZ?91:80)),Array.add(M.buttons,C.yb(this.xZ?92:81)),Array.add(M.buttons,C.yb(qa?82:86))):(Array.add(M.buttons,
C.yb(83)),Array.add(M.buttons,C.yb(this.xZ?93:84)),Array.add(M.buttons,C.yb(this.xZ?94:85)),Array.add(M.buttons,C.yb(82)));Array.add(e.yc,M)};Og.prototype.$Ri=function(e){var C=this.Sa.Lc();Array.add(C.buttons,this.Sa.yb(78));Array.add(e.yc,C)};tl.Object.defineProperties(Og.prototype,{Kt:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldListContextMenu"}},VA:{configurable:!0,enumerable:!0,get:function(){return If.a.bEd}}});Object(sd.a)(Og,"FieldListContextMenu",fh.a,[]);var ig=b(408),
ih=b(59);xf.prototype.get=function(e,C,M){var qa=this.m7f(e,"PivotFilterContextMenuCache.Get");return qa&&this.TM[qa]?this.TM[qa][xf.xdd(C,this.$,e,M)]:null};xf.prototype.set=function(e,C,M,qa){var Na=this.m7f(e,"PivotFilterContextMenuCache.Set");Na&&(this.TM[Na]||(this.TM[Na]={}),this.TM[Na][xf.xdd(C,this.$,e,qa)]=M)};xf.prototype.qrb=function(e){e in this.TM&&this.TM[e]&&(this.TM[e]=null)};xf.prototype.m7f=function(e,C){return ih.f(this.$.oa)?this.$.activeItemName:(e=this.kFj(e,C))?e.Xd:null};xf.prototype.kFj=
function(e,C){e=jg.C(e);e=Ye.g(this.$).Ca.Eua(e,this.$.activeItemName);Dd.ULS.shipAssertTag(537167008,0,!!e,"PivotFilterContextMenuBase.TryGetBlockModelProxyFromCell: Can't query the menuCache as block wasn't found in the BlockManager (returned null). Called from: {0}",C);return e};xf.xdd=function(e,C,M,qa){return kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&!qa?C.oa.index+"_"+e.id+"_"+M.FirstRow.toString()+"_"+M.FirstColumn.toString():C.oa.index+"_"+e.id};Object(sd.a)(xf,
"PivotFilterContextMenuCache",null,[]);Object(sd.a)(bf,"ShowPivotFilterData",null,[]);var $g=b(575),xh=b(1278),vh=b(51),nf=fh.a;vm(lf,nf);lf.prototype.H8c=function(e,C){var M=this,qa=e.rawEvent,Na=e.cell,Hb=e.requiresConfirmation;$g.a(this.$).pu(Hb,function(Gc){if(Gc){Gc=qa?new Sys.UI.DomEvent(qa):null;M.pivotData=new bf;M.pivotData.pivotName=e.pivotName;M.pivotData.dataSourceIndex=e.dataSourceIndex;M.pivotData.cell=Na;M.pivotData.mo=e.optionalPivotMenuAnchorParameter;if(M.pivotData.mo&&0<M.pivotData.mo.AnchorType){M.Bkc=
e.objectId;M.BBb=e.objectVersion;var gd=M.pivotData.mo.AnchorType;if(4===gd||5===gd||6===gd||11===gd||9===gd||10===gd||8===gd)M.mlb=e.location}else M.wwd=M.Bkc=null,M.xwd=M.BBb=-1;Ye.g(M.$).Dq(!0);M.$.wj(Na);M.VN(Gc,Gc?Gc.target:e.domElement,M.pivotData,C,M.rLa())}});return!0};lf.prototype.VN=function(e,C,M,qa){var Na=this;if(Object(ig.a)(bf,M)){this.pivotData=M;this.s3b=C;this.bgf=e;this.u0b=this.pivotData.mo?this.pivotData.mo.AnchorValue1:-1;this.aY=this.pivotData.mo?this.pivotData.mo.AnchorType:
0;var Hb=!1,Gc=null;Gc=lf.TM.get(this.pivotData.cell,C,this.aY);Hb=!!Gc;var gd=!0;switch(this.aY){case 4:case 5:case 6:this.vca=new Sys.UI.Point(this.mlb.x,this.mlb.y);gd=!1;break;case 7:var Uc=Sys.UI.DomElement.getBounds(C);gd=Uc.x+(0<=Uc.x?0:Uc.width);Uc=Uc.y+(0<=Uc.y?0:Uc.height);this.vca=new Sys.UI.Point(0<=gd?gd:0,0<=Uc?Uc:0);gd=!1;break;case 8:case 10:case 9:case 11:this.vca=new Sys.UI.Point(this.mlb.x,this.mlb.y);break;default:this.vca=null}Hb&&this.Bkc===this.wwd&&this.BBb===this.xwd&&this.u0b===
this.ave&&this.aY===this.fne?(Dd.ULS.sendTraceTag(537167042,0,50,"PivotFilterContextMenuBase.ShowDropDown: rendering pivot filter context menu from menu cache"),this.M_a=Gc,this.vca?(this.ISa(this.vca,C),this.so(this.vca,this.rLa())):this.aw?this.so(fh.a.X9b(this.$,this.pivotData.cell,!1),this.rLa()):nf.prototype.VN.call(this,e,C,M,qa,this.rLa())):1!==lf.AIh(C)&&(gd&&(C.parentNode.menuFetchStates=1,this.Ihj(C),this.qUf(!0)),this.$.userOperationManager.ic(new mg.a(126,0,function(Wd,We,Gf){var xg=Na.$;
return vf.z(xg.qa.ta,Na.pivotData.cell,Na.pivotData.dataSourceIndex,Na.pivotData.pivotName,xg.domElement.id,xg.isChromeRtl,xg.workbookContext.NovMode,lh.b(Wd,Na.bEi),lh.a(We,Na.aEi),Gf,C,Na.pivotData.mo)},16),qa))}};lf.prototype.qBd=function(e){Array.addRange(e.MenuSectionList,this.M_a)};lf.prototype.xtd=function(e,C){e.parentNode.menuFetchStates=2;this.qUf(!1);C&&(this.s3b!==e||this.msi()?(this.ISa(this.vca,e),this.so(this.vca,this.rLa())):this.aw&&!this.vca?this.so(fh.a.X9b(this.$,this.pivotData.cell,
!1),this.rLa()):nf.prototype.VN.call(this,this.bgf,e,null,null,this.rLa()),this.wwd=this.Bkc,this.xwd=this.BBb,this.fne=this.aY,this.ave=this.u0b)};lf.prototype.rLa=function(){return 8!==this.aY&&9!==this.aY&&10!==this.aY&&11!==this.aY};lf.prototype.msi=function(){switch(this.pivotData.mo?this.pivotData.mo.AnchorType:0){case 1:case 2:case 3:case 4:case 5:case 6:case 7:return!0;default:return!1}};lf.prototype.qUf=function(e){var C=this.s3b;if(C){if(kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5041973_FixDropdownImageDisappearing")){var M=
Le.DOMElementExtensions.eZ(C,"ewaprevsrc","");M=!!M&&"null"!==M}else M=!!Le.DOMElementExtensions.eZ(C,"ewaprevsrc","");e&&M||!e&&!M||(e?(C.setAttribute("ewaprevsrc",C.src),C.src=vh.a.current.eo(77)):(e=Le.DOMElementExtensions.eZ(C,"ewaprevsrc",""),C.src=e,C.setAttribute("ewaprevsrc",null)))}};lf.prototype.Ihj=function(e){this.s3b=e};lf.AIh=function(e){var C=e.parentNode.menuFetchStates;void 0===C&&(e.parentNode.menuFetchStates=0);return C};lf.TM=null;Object(sd.a)(lf,"PivotFilterContextMenuBase",fh.a,
[]);vm(te,lf);te.prototype.executeCommand=function(e,C,M){return this.H8c(M,C)?Fg.Task.Ta(!0):sg.a(C.command)};te.prototype.Gc=function(e,C,M){return-1065117584===C.command&&!!M};tl.Object.defineProperties(te.prototype,{Kt:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldListPivotMenu"}},VA:{configurable:!0,enumerable:!0,get:function(){return If.a.nIf}}});Object(sd.a)(te,"FieldListPivotContextMenu",lf,[]);var dh=b(28),Dh=b(852);Object(sd.a)(ze,"PivotValueFieldSettingsApplyData",null,
[]);yd.t7g="dataFieldCustomLabel";yd.dDe="dataFieldSourceLabel";yd.muj="showValueAsSelect";yd.kuj="showValueAsBaseFieldSelect";yd.luj="showValueAsBaseItemSelect";yd.NWd="valueFieldsSettingsFieldName";yd.qbg="valueFieldSettingTabs";Object(sd.a)(yd,"CssElementIds",null,[]);var Eg=b(114);Object(sd.a)(Kd,"MacroRecorderPivotFieldShowValueAsParameters",null,[]);dd.prototype.getActiveCell=function(){return this.activeCell};Object(sd.a)(dd,"MacroRecorderPivotValueFieldSettingAppliedPayload",null,[116]);var ei=
b(232);Object(sd.a)(tc,"PivotValueFieldShowValueAsApplyData",null,[]);var Ti=b(853),Qi=b(39),hj=ei.a;vm(qb,hj);qb.prototype.oja=function(){return this.isVisible};qb.prototype.Uma=function(e){return this.isVisible=e};qb.prototype.setFocus=function(){Le.DOMElementExtensions.setFocus(this.e3.Hn)};qb.prototype.render=function(e){e.appendChild(this.domElement)};qb.prototype.dispose=function(){ff.a.pc([this.e3,this.rT,this.gP,this.T3b,this.KZb]);hj.prototype.dispose.call(this)};qb.prototype.nkj=function(e){ff.a.pc([this.T3b,
this.KZb]);this.e3.clear();for(var C=yl(e.DataFormatTypes),M=C.next();!M.done;M=C.next())M=M.value,this.e3.AL(qb.NGh(M),M.toString(),M===e.SelectedDataFormat);this.T3b=this.Nd.Cd(this.e3.domElement);this.T3b.ja("change",this.Dsf);this.rT.clear();C=yl(e.BaseFieldList);for(M=C.next();!M.done;M=C.next())M=M.value,this.rT.AL(M.DisplayString,M.Id.toString(),M.Id===e.SelectedBaseField);this.KZb=this.Nd.Cd(this.e3.domElement);this.KZb.ja("change",this.gzi);this.RE=this.Cha.B_a(this.gP.Hn.parentNode,1E3,
null,"",720);this.Dsf(null)};qb.prototype.qQ=function(e){this.e3.qQ(e);this.rT.qQ(e);this.gP.qQ(e)};qb.prototype.Kja=function(){this.domElement.innerHTML=String.format("<div id='showValueAsControlBody'><label for='showValueAsSelect' class='ewa-dlg-body-sectionlabel valueFielsSettingsControlTitle'>{0}</label><div><select size=1 id='showValueAsSelect' class='ewa-dlg-body-fullLine'></select></div><div class='showValueAsControlSelectRegion'><label for='showValueAsBaseFieldSelect'>{1}</label><div><select size=6 id='showValueAsBaseFieldSelect' class='ewa-dlg-body-fullLine'></select></div></div><div class='showValueAsControlSelectRegionSeparator'></div><div class='showValueAsControlSelectRegion'><label for='showValueAsBaseItemSelect'>{2}</label><div><select size=6 id='showValueAsBaseItemSelect' class='ewa-dlg-body-fullLine'></select></div></div></div>",
fe.a.instance.ea(1070),fe.a.instance.ea(1071),fe.a.instance.ea(1072));this.Q1d=new Ti.a(Le.DOMElementExtensions.getElementById(this.domElement,yd.muj),!1);this.o_d=new Ti.a(Le.DOMElementExtensions.getElementById(this.domElement,yd.kuj),!1);this.p_d=new Ti.a(Le.DOMElementExtensions.getElementById(this.domElement,yd.luj),!1)};qb.prototype.eQg=function(e){return this.Oci||!qb.M9e(e)&&!qb.N9e(e)?!0:!!this.rT.count};qb.prototype.getValueFieldSettingsShowValueAsBaseItemsInfo=function(){var e=this;this.$.userOperationManager.ic(new mg.a(108,
0,function(C,M,qa){var Na=e.$.qa.ta,Hb=parseInt(e.rT.oe.value);C=lh.b.call(null,C,e.YEi);var Gc=vf.mb(Na,e.cell,e.externalSourceIndex,e.mo);Gc.selectedBaseField=Hb;return vf.i(Na,"GetPivotValueFieldSettingsShowValueAsBaseItems",Gc,C,M,qa,null,4)},16),this.ee)};qb.prototype.Ihf=function(){this.gP.clear();this.rT.oe&&(this.RE.jAa(),this.gP.Hn.style.overflowY="hidden",this.getValueFieldSettingsShowValueAsBaseItemsInfo())};qb.prototype.aMb=function(e){var C=document.getElementById("WACDialogActionButton");
this.sKj&&C&&(C.disabled=e)};qb.NGh=function(e){switch(e){case 0:return fe.a.instance.ea(1073);case 1:return fe.a.instance.ea(1074);case 2:return fe.a.instance.ea(1075);case 3:return fe.a.instance.ea(1076);case 4:return fe.a.instance.ea(1077);case 5:return fe.a.instance.ea(1078);case 6:return fe.a.instance.ea(1079);case 7:return fe.a.instance.ea(1080);case 8:return fe.a.instance.ea(1082);case 9:return fe.a.instance.ea(1083);case 10:return fe.a.instance.ea(1084);case 11:return fe.a.instance.ea(1085);
case 12:return fe.a.instance.ea(1086);case 13:return fe.a.instance.ea(1087);case 14:return fe.a.instance.ea(1088);default:return""}};qb.M9e=function(e){return 11===e||12===e||14===e||13===e||4===e};qb.N9e=function(e){return 1===e||3===e||2===e};tl.Object.defineProperties(qb.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return fe.a.instance.ea(1069)}},yub:{configurable:!0,enumerable:!0,get:function(){var e=this.e3.oe?parseInt(this.e3.oe.value):-1,C=this.rT.oe?parseInt(this.rT.oe.value):
-1,M=this.gP.oe?parseInt(this.gP.oe.value):-1;return Object.assign(new tc,{SelectedDataFormat:0<=e?e:-1,SelectedBaseField:C,SelectedBaseItem:M})}},rT:{configurable:!0,enumerable:!0,get:function(){return this.o_d}},gP:{configurable:!0,enumerable:!0,get:function(){return this.p_d}},e3:{configurable:!0,enumerable:!0,get:function(){return this.Q1d}}});Object(sd.a)(qb,"ShowValueAsControl",ei.a,[637,3]);Object(sd.a)(Pa,"PivotValueFieldSummarizeValueByApplyData",null,[]);var Ah=ei.a;vm(mh,Ah);mh.prototype.oja=
function(){return this.isVisible};mh.prototype.Uma=function(e){return this.isVisible=e};mh.prototype.setFocus=function(){Le.DOMElementExtensions.setFocus(this.$k.Hn)};mh.prototype.render=function(e){e.appendChild(this.domElement)};mh.prototype.dispose=function(){ff.a.Fa(this.$k);Ah.prototype.dispose.call(this)};mh.prototype.focus=function(){Le.DOMElementExtensions.setFocus(this.$k.Hn)};mh.prototype.mkj=function(e){this.$k.GQd();for(var C=yl(e.AggregationTypes),M=C.next();!M.done;M=C.next()){M=M.value;
var qa=M===e.SelectedAggregation;this.$k.eSc(mh.zCh(M),M.toString(),qa,"")}this.$k.t6c();this.$k.Hn.disabled=e.AggregationsDisabled};mh.prototype.M$i=function(){this.$k.N$i()};mh.prototype.Kja=function(){this.domElement.innerHTML=String.format("<div id='summarizeValuesByControlBody'><label class='ewa-dlg-body-sectionlabel valueFielsSettingsControlTitle' for='pivotDataFieldSelect'>{0}</label><div id='pivotDataFieldSelectDescription' class='ewa-dlg-body-sectionlabel summarizeValuesByControlDescription'>{1}</div><div><select class='ewa-dlg-body-fullLine' size=6 id='pivotDataFieldSelect' style='width: 100%' aria-describedby='pivotDataFieldSelectDescription'></select></div></div>",
fe.a.instance.ea(1053),fe.a.instance.ea(1054));this.Xae=new Ti.a(Le.DOMElementExtensions.getElementById(this.domElement,mh.rDf),!1)};mh.zCh=function(e){switch(e){case 0:return fe.a.instance.ea(1056);case 1:return fe.a.instance.ea(1057);case 2:return fe.a.instance.ea(1058);case 3:return fe.a.instance.ea(1059);case 4:return fe.a.instance.ea(1060);case 5:return fe.a.instance.ea(1061);case 6:return fe.a.instance.ea(1062);case 7:return fe.a.instance.ea(1063);case 8:return fe.a.instance.ea(1064);case 9:return fe.a.instance.ea(1065);
case 10:return fe.a.instance.ea(1066);case 11:return fe.a.instance.ea(1067);default:return""}};tl.Object.defineProperties(mh.prototype,{yub:{configurable:!0,enumerable:!0,get:function(){var e=this.$k.oe?parseInt(this.$k.oe.value):-1;return Object.assign(new Pa,{Aggregation:0<=e?e:-1})}},title:{configurable:!0,enumerable:!0,get:function(){return fe.a.instance.ea(1068)}},enabled:{configurable:!0,enumerable:!0,get:function(){return!this.$k.Hn.disabled},set:function(e){this.$k.Hn.disabled=!e}},$k:{configurable:!0,
enumerable:!0,get:function(){return this.Xae}}});mh.rDf="pivotDataFieldSelect";Object(sd.a)(mh,"SummarizeValuesByControl",ei.a,[637,3]);var Ci=b(203),ni=b(460);qf.prototype.Fzj=function(e,C){e.set_visible(!1);C.set_visible(!0)};Object(sd.a)(qf,"DefaultTabSwitchBehaviour",null,[649]);Zg.rAj="TabsContainer";Zg.aAj="TabTitlesContainer";Zg.Zzj="TabTitle";Zg.$zj="TabTitleText";Zg.eSd="TabTitleActive";Object(sd.a)(Zg,"MultitabControlStyles",null,[]);var T=b(40),Oa=b(91),Ib=b(89),hc=b(87);qh.prototype.dispose=
function(){T.a.removeHandler(this.Ci,"keyup",Object(zb.a)(this,this.R8a,"onTitleKeyUp"));T.a.removeHandler(this.Ci,"click",this.jEc);this.Ci=this.$ea=null};qh.prototype.setActive=function(e){e?Sys.UI.DomElement.addCssClass(this.Ci,Zg.eSd):Sys.UI.DomElement.removeCssClass(this.Ci,Zg.eSd);this.$ea&&this.$ea.setAttribute(Ib.a.Dga,e)};qh.prototype.R8a=function(e){e.keyCode!==Oa.a.$h&&e.keyCode!==Oa.a.iBa||this.jEc(e)};qh.prototype.mzc=function(){this.Ci.setAttribute(Ib.a.Sd,Ib.a.vs);this.$ea.setAttribute(Ib.a.Bv,
this.lp);this.$ea.setAttribute(Ib.a.Sd,Ib.a.dnb)};tl.Object.defineProperties(qh.prototype,{Jb:{configurable:!0,enumerable:!0,get:function(){return this.Ci}},title:{configurable:!0,enumerable:!0,get:function(){return this.lp}},isActive:{configurable:!0,enumerable:!0,get:function(){return Sys.UI.DomElement.containsCssClass(this.Ci,Zg.eSd)},set:function(e){this.setActive(e)}}});Object(sd.a)(qh,"TabTitleControl",null,[3]);var nd=b(47);Bg.prototype.rNf=function(){this.Ykb=document.createElement("ul");
this.Ykb.className=Zg.aAj;this.Okb=document.createElement("div");this.Okb.className=Zg.rAj;for(var e=0;e<this.txc;++e){var C=this.OX.na(e),M=this.uEa.na(e);C.set_visible(!1);M.isActive=!1;var qa=document.createElement("div");C.render(qa);this.Okb.appendChild(qa);this.Ykb.appendChild(M.Jb)}this.Jb.appendChild(this.Ykb);this.Jb.appendChild(this.Okb);this.ipd(this.T0)&&(this.uEa.na(this.T0).isActive=!0,this.OX.na(this.T0).set_visible(!0))};Bg.prototype.dispose=function(){for(var e=0;e<this.txc;++e)this.OX.na(e).dispose(),
this.uEa.na(e).dispose();this.uEa=this.OX=this.Ci=this.Okb=this.Ykb=null};Bg.prototype.setFocus=function(){this.OX.na(this.T0).setFocus()};Bg.prototype.ipd=function(e){return 0<=e&&e<this.txc};Bg.prototype.V3f=function(e){this.T0!==e&&this.ipd(e)&&(this.Bsg.Fzj(this.OX.na(this.T0),this.OX.na(e)),this.uEa.na(this.T0).isActive=!1,this.uEa.na(e).isActive=!0,this.T0=e,this.setFocus())};Bg.prototype.v1g=function(e){var C=this;return function(){C.V3f(e)}};tl.Object.defineProperties(Bg.prototype,{txc:{configurable:!0,
enumerable:!0,get:function(){return this.OX.count}},activeTab:{configurable:!0,enumerable:!0,get:function(){return this.T0},set:function(e){this.V3f(e)}},Jb:{configurable:!0,enumerable:!0,get:function(){return this.Ci}},visible:{configurable:!0,enumerable:!0,get:function(){return nd.a.isVisible(this.Ci)},set:function(e){this.Ci.style.visibility=e?"visible":"hidden"}}});Object(sd.a)(Bg,"MultitabControl",null,[634,3]);var Td=Dh.a;vm(hg,Td);hg.prototype.dispose=function(){this.E3c=this.Cqb=this.sRa=
this.KPc=null;ff.a.Fa(this.kfa);this.kfa=null;Td.prototype.dispose.call(this)};hg.prototype.initialize=function(){var e="<div id='"+yd.dDe+"' class='"+Eg.a.xu+"'></div><div id='"+yd.t7g+"' class='"+Eg.a.xu+"'><label for='"+yd.NWd+"'>{0}</label><input type='text' id='"+yd.NWd+"' value='{1}' class='"+Eg.a.vU+" UIFont' /></div><div id='"+yd.qbg+"'></div>";e=String.format(e,fe.a.instance.ea(1052),dh.a.If(this.pbg));this.Ob.innerHTML=e;this.Le||(this.f2(),this.Vk());this.Kge=[-103190598];this.pUh();Td.prototype.initialize.call(this)};
hg.prototype.close=function(e){1===e&&(this.QZf=!1);Td.prototype.close.call(this,e)};hg.prototype.iFe=function(e){this.wQ=e;this.domElement.disabled=e;for(var C=["input","option","select"],M=0,qa=C.length;M<qa;++M)for(var Na=this.domElement.getElementsByTagName(C[M]),Hb=0;Hb<Na.length;++Hb)Na[Hb].disabled=e};hg.prototype.Vk=function(){this.Cqb=document.getElementById(yd.NWd);this.E3c=Le.DOMElementExtensions.getElementById(this.Ob,yd.dDe);var e=Le.DOMElementExtensions.getElementById(this.Ob,yd.qbg);
this.KPc=new mh(document.createElement("div"));this.sRa=new qb(document.createElement("div"),this.$,this.cell,this.mo,this.externalSourceIndex,this.ee,this.Cha,!this.isOlap);var C;this.kfa=new Bg(e,(C=new lc.a,C.add(this.URa),C.add(this.sRa),C));this.kfa.rNf()};hg.prototype.ioc=function(){var e=new hg(this.cell,this.mo,this.externalSourceIndex,this.pbg,this.$,this.ee,this.Cha,this.isOlap,this.lH);e.initialize();e.mf()};hg.prototype.ZSa=function(){var e=new ni.a;if(!this.QZf)return e.isValid=!0,e;
this.Cqb.value.length?e.isValid=!0:(this.iFe(!0),e.error=oh.a.jd(1,0,735,750,0,1783218700,"PivotTableValueFieldNoBlank"),this.wQ=!0,this.Le||(this.Zw.disabled=!0),e.isValid=!1);return e};hg.prototype.G2e=function(){this.wQ=!1;this.Le||(this.Zw.disabled=!1);this.iFe(!1)};hg.prototype.Lxa=function(e){var C=new Bf.a(2105621672,0,this.$.ed,30,null);this.$.Ka.Zb(C);this.oW(5,e.zb,"Number Format");return!0};hg.prototype.lm=function(){this.FAa=String.format(fe.a.instance.Cb(60),null);Td.prototype.lm.call(this)};
hg.prototype.setFocus=function(){if(this.Le){var e=Le.DOMElementExtensions.getElementById(this.Ob,mh.rDf);Ci.a.Lyc(e)}else this.kfa.setFocus()};hg.prototype.Wl=function(){var e=this,C=this.sRa.yub,M=new Kd(C.SelectedDataFormat,C.SelectedBaseField,C.SelectedBaseItem);return function(){return new dd(e.externalSourceIndex,e.cell,e.Cqb.value,e.URa.yub.Aggregation,M)}};hg.prototype.Uw=function(){var e=this,C=Object.assign(new ze,{PivotValueFieldSummarizeValueByApplyData:this.URa.yub,PivotValueFieldShowValueAsApplyData:this.sRa.yub,
PivotValueFieldTitle:this.Cqb.value});return function(M,qa,Na){var Hb=e.$.qa.ta;M=lh.b(M,e.Wyi);var Gc=vf.mb(Hb,e.cell,e.externalSourceIndex,e.mo);Gc.pivotValueFieldSettingsApplyData=C;return vf.i(Hb,"ApplyPivotValueFieldSettings",Gc,M,qa,Na,null,0)}};hg.prototype.qQ=function(e){var C=this;this.$.da.Za(40,function(){C.sRa.qQ(e)})};hg.prototype.pUh=function(){var e=this;this.$.userOperationManager.ic(new mg.a(123,0,function(C,M,qa){var Na=e.$.qa.ta;C=lh.b.call(null,C,e.XEi);var Hb=vf.mb(Na,e.cell,
e.externalSourceIndex,e.mo);return vf.i(Na,"GetPivotValueFieldSettingsInitial",Hb,C,M,qa,null,4)},16),this.ee)};tl.Object.defineProperties(hg.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"ValueFieldSettingsDialog"}},bea:{configurable:!0,enumerable:!0,get:function(){return this.Kge}},ZAb:{configurable:!0,enumerable:!0,get:function(){return this.kfa}},URa:{configurable:!0,enumerable:!0,get:function(){return this.KPc}},Cw:{configurable:!0,enumerable:!0,get:function(){return 560}}});
Object(sd.a)(hg,"ValueFieldSettingsDialog",Dh.a,[]);var Ed=fh.a;vm(Ze,Ed);Ze.prototype.executeCommand=function(e,C,M,qa){var Na=this;e=C.command;switch(e){case -1453503574:qa=M.domElement;this.$n=M.fieldItem;this.XXd=M.zoneCount;this.ERa=M.sourceAxis;this.wwc=M.sourceAxisPos;this.mo=M.optionalPivotMenuAnchorParameter;this.bL=M.versionkey;this.isOlap=M.isOlap;this.lH=M.isPpm;this.t1a="fieldItemsupportsImplicitMeasures"in M?M.fieldItemsupportsImplicitMeasures:!1;this.cell=M.cell;this.externalSourceIndex=
M.externalSourceIndex;Ye.g(this.$).Dq(!0);e=Le.DOMElementExtensions.getBounds(qa);var Hb=new Sys.UI.Point(e.x,e.y+e.height);this.$.isChromeRtl&&(Hb.x+=e.width);this.ISa(Hb,qa);"isKeyboardInput"in M&&M.isKeyboardInput?this.so(Hb,!1,1):this.so(Hb,!1);break;case 495005930:Ge.a(this.$).Dah();break;case -1170196828:Ge.a(this.$).xG(this.$n,this.ERa,this.wwc-1,this.bL,C);break;case -889576107:Ge.a(this.$).xG(this.$n,this.ERa,this.wwc+2,this.bL,C);break;case 2033235475:Ge.a(this.$).xG(this.$n,this.ERa,this.XXd,
this.bL,C);break;case 389774337:Ge.a(this.$).xG(this.$n,this.ERa,0,this.bL,C);break;case -96230454:Ge.a(this.$).xG(this.$n,4,-1,this.bL,C);break;case 74086617:Ge.a(this.$).xG(this.$n,1,-1,this.bL,C);break;case 1529312473:Ge.a(this.$).xG(this.$n,2,-1,this.bL,C);break;case 563292088:this.t1a&&Dd.ULS.sendTraceTag(537167056,0,50,"Move a field into values area as implicit measurement.");Ge.a(this.$).xG(this.$n,8,-1,this.bL,C);break;case -1092351914:Ge.a(this.$).xG(this.$n,0,-1,this.bL,C);break;case -2141589616:var Gc=
td.GetServiceTaskFactory.Xa(this.$.da,12,477,qa.gja());return wf.TaskExtensions.Ba(Gc,function(){(new hg(Na.cell,Na.mo,Na.externalSourceIndex,Na.$n.Name,Na.$,C,Gc.result,Na.isOlap,Na.lH)).initialize()},this.ma);default:return sg.a(e)}return Fg.Task.Ta(!0)};Ze.prototype.Gc=function(e,C,M){e=!1;switch(C.command){case -1453503574:e=!!M;break;case 495005930:case -1170196828:case -889576107:case 2033235475:case 389774337:case -96230454:case 74086617:case 1529312473:case 563292088:case -1092351914:case -2141589616:e=
!0}return e};Ze.prototype.zY=function(){var e=this.Sa.zp(this.menuId);this.fSi(e,this.wwc,this.XXd);this.gSi(e,this.ERa);this.hSi(e);8===this.ERa&&this.dSi(e);return e};Ze.prototype.fSi=function(e,C,M){var qa=this.Sa,Na=qa.Lc();C||C!==M-1?!C&&C<M-1?(Array.add(Na.buttons,qa.yb(64)),Array.add(Na.buttons,qa.yb(61)),Array.add(Na.buttons,qa.yb(66)),Array.add(Na.buttons,qa.yb(63))):0<C&&C<M-1?(Array.add(Na.buttons,qa.yb(60)),Array.add(Na.buttons,qa.yb(61)),Array.add(Na.buttons,qa.yb(62)),Array.add(Na.buttons,
qa.yb(63))):0<C&&C===M-1&&(Array.add(Na.buttons,qa.yb(60)),Array.add(Na.buttons,qa.yb(65)),Array.add(Na.buttons,qa.yb(62)),Array.add(Na.buttons,qa.yb(67))):(Array.add(Na.buttons,qa.yb(64)),Array.add(Na.buttons,qa.yb(65)),Array.add(Na.buttons,qa.yb(66)),Array.add(Na.buttons,qa.yb(67)));Array.add(e.yc,Na)};Ze.prototype.gSi=function(e,C){var M=this.Sa,qa=M.Lc(),Na=1!==C&&(!this.isOlap||this.lH||8!==C||this.t1a),Hb=2!==C&&(!this.isOlap||this.lH||8!==C||this.t1a),Gc=8!==C&&-2!==this.$n.PivotTableIndex&&
(!this.isOlap||this.lH||this.t1a);Array.add(qa.buttons,M.yb(4===C||this.$n.IsSet||-2===this.$n.PivotTableIndex||this.isOlap&&!this.lH&&8===C&&!this.t1a?72:68));8===this.mo.AnchorType||10===this.mo.AnchorType?(Array.add(qa.buttons,M.yb(Na?95:97)),Array.add(qa.buttons,M.yb(Hb?96:98))):(Array.add(qa.buttons,M.yb(Na?69:73)),Array.add(qa.buttons,M.yb(Hb?70:74)));Array.add(qa.buttons,M.yb(Gc?71:75));Array.add(e.yc,qa)};Ze.prototype.hSi=function(e){var C=this.Sa.Lc();Array.add(C.buttons,this.Sa.yb(76));
Array.add(e.yc,C)};Ze.prototype.dSi=function(e){var C=this.Sa.Lc();Array.add(C.buttons,this.Sa.yb(77));Array.add(e.yc,C)};tl.Object.defineProperties(Ze.prototype,{Kt:{configurable:!0,enumerable:!0,get:function(){return"PopulateFieldWellContextMenu"}},VA:{configurable:!0,enumerable:!0,get:function(){return If.a.cEd}}});Object(sd.a)(Ze,"FieldWellContextMenu",fh.a,[]);var he=b(1244);vm(Re,lf);Re.prototype.executeCommand=function(e,C,M){var qa=!1,Na=C.command;switch(Na){case 37023044:qa=this.H8c(M,C);
break;case 541421805:case -569786022:qa=this.Kgd(e,C)}return qa?Fg.Task.Ta(!0):sg.a(Na)};Re.prototype.Gc=function(e,C,M){e=!1;switch(C.command){case 37023044:e=!!M;break;case 541421805:case -569786022:e=!0}return e};Re.prototype.Kgd=function(e,C){var M=8===e,qa=this.$,Na=pf.a(qa),Hb=Ye.g(qa).ha.Qa.nc,Gc=e=null;M&&Na?(e=Na.chartId,Gc=Na.Yc):!M&&Hb&&(e=Hb.floatingObject.id,Gc=Hb.floatingObject.Yc);return Re.Zoe(Gc,260)?(M={},qa.wj(M),M.FirstColumn=M.FirstRow=-1,qa={},Gc=(qa.rawEvent=null,qa.pivotName=
null,qa.cell=M,qa.requiresConfirmation=Re.Zoe(Gc,64),qa.dataSourceIndex=Gc.ExternalSourceIndex,qa),Hb?(Na=Hb.floatingObject,Gc.domElement=Hb.domElement,Gc.objectId=Na.id,Gc.objectVersion=Na.version):Na&&(Gc.domElement=Na.Wj,Gc.objectId=Na.chartId,Gc.objectVersion=Na.cve),Hb={AnchorType:7},Hb.ChartId=e,Hb.AnchorValue1=-1,Hb.AnchorValue2=-1,Gc.optionalPivotMenuAnchorParameter=Hb,this.H8c(Gc,C)):!1};Re.Zoe=function(e,C){return(e.Attributes&C)===C};tl.Object.defineProperties(Re.prototype,{Kt:{configurable:!0,
enumerable:!0,get:function(){return"PopulatePivotContextMenu"}},VA:{configurable:!0,enumerable:!0,get:function(){return If.a.tIf}}});Object(sd.a)(Re,"PivotFilterContextMenu",lf,[]);var Pe=b(1276),hf=b(976),pg=b(150),fg=b(41),Xg=b(26),yg=fh.a;vm(Rf,yg);Rf.prototype.executeCommand=function(e,C,M){C=C.command;e=null;this.grid=Ye.g(this.$);this.activeCell=jg.o(this.grid.ha.va.activeCell,this.$);if(this.$.isEditMode&&(this.Wc=this.grid.Vb.nq(this.grid.ha.va.activeCell),!this.Wc))return Dd.ULS.sendTraceTag(537167007,
0,10,"No PivotTable range found."),wf.TaskExtensions.g4();this.XAc=this.$.qa.ta;this.q_a=Object(qc.a)(aa.a,M.eventArgs);switch(C){case 671488277:!this.$.isEditMode||this.Wc.Fec||this.Wc.Afc()&&!this.PYf(!1)?(this.rab(),this.showPivotTableContextMenu()):this.jOh();break;case 1801458190:this.performPivotTableOperation(1801458190,1);break;case -2016405815:this.performPivotTableOperation(-2016405815,6);break;case 671485366:this.performPivotTableOperation(671485366,7);break;case 772221736:this.performPivotTableOperation(772221736,
8);break;case 1600778266:this.performPivotTableOperation(1600778266,2);break;case -556893687:this.performPivotTableOperation(-556893687,3);break;case -1966978671:this.performPivotTableOperation(-1966978671,4);break;case -1951357930:this.performPivotTableOperation(-1951357930,5);break;case -1390365353:this.performPivotTableOperation(-1390365353,9);break;case -1457478532:this.performPivotTableOperation(-1457478532,10);break;case -771066011:this.Cz.PivotValueFieldSummarizeValueByApplyData.Aggregation=
2;this.applyValueFieldSettingsToPivotTable(-771066011,!0);break;case 1746132849:this.Cz.PivotValueFieldSummarizeValueByApplyData.Aggregation=1;this.applyValueFieldSettingsToPivotTable(1746132849,!0);break;case 1475494885:this.Cz.PivotValueFieldSummarizeValueByApplyData.Aggregation=6;this.applyValueFieldSettingsToPivotTable(1475494885);break;case 376946683:this.Cz.PivotValueFieldSummarizeValueByApplyData.Aggregation=11;this.applyValueFieldSettingsToPivotTable(376946683,!0);break;case 835007294:this.Cz.PivotValueFieldSummarizeValueByApplyData.Aggregation=
3;this.applyValueFieldSettingsToPivotTable(835007294,!0);break;case 929115636:this.Cz.PivotValueFieldSummarizeValueByApplyData.Aggregation=4;this.applyValueFieldSettingsToPivotTable(929115636,!0);break;case 1935475057:this.Cz.PivotValueFieldSummarizeValueByApplyData.Aggregation=5;this.applyValueFieldSettingsToPivotTable(1935475057,!0);break;case 588680636:this.Cz.PivotValueFieldSummarizeValueByApplyData.Aggregation=7;this.applyValueFieldSettingsToPivotTable(588680636);break;case -910892852:this.Cz.PivotValueFieldSummarizeValueByApplyData.Aggregation=
8;this.applyValueFieldSettingsToPivotTable(-910892852);break;case -1255320719:this.Cz.PivotValueFieldSummarizeValueByApplyData.Aggregation=0;this.applyValueFieldSettingsToPivotTable(-1255320719,!0);break;case 1668427539:this.Cz.PivotValueFieldSummarizeValueByApplyData.Aggregation=9;this.applyValueFieldSettingsToPivotTable(1668427539);break;case -1751371357:this.Cz.PivotValueFieldSummarizeValueByApplyData.Aggregation=10;this.applyValueFieldSettingsToPivotTable(-1751371357);break;case -841863025:this.VQa(0,
0);this.applyValueFieldSettingsToPivotTable(-841863025);break;case -178796371:this.VQa(7,0);this.applyValueFieldSettingsToPivotTable(-178796371);break;case 786592977:this.VQa(6,0);this.applyValueFieldSettingsToPivotTable(786592977);break;case 767774849:this.VQa(5,0);this.applyValueFieldSettingsToPivotTable(767774849);break;case 282586693:this.VQa(9,0);this.applyValueFieldSettingsToPivotTable(282586693);break;case -1067664355:this.VQa(10,0);this.applyValueFieldSettingsToPivotTable(-1067664355);break;
case -2031744961:M=Number.parseInvariant(M.MenuItemId.split(".")[2]);this.VQa(11,M);this.applyValueFieldSettingsToPivotTable(-2031744961);break;case -1007663920:this.applyPivotSort(1);break;case 234234584:this.applyPivotSort(2);break;case 1194992911:this.$.Ce(-1556797033,eg.a.Wb,8,null);break;case 1514686611:this.Iji();break;case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:M=Number.parseInvariant(M.MenuItemId);this.XTg(M);break;case 1778578888:M=Number.parseInvariant(M.MenuItemId);
this.UFg(M);break;default:e=sg.a(C)}return e||wf.TaskExtensions.g4()};Rf.prototype.Gc=function(e,C){e=!1;switch(C.command){case 671488277:e=hf.f(this.grid);break;case 1801458190:case -2016405815:case 671485366:case 772221736:e=!0;break;case 1600778266:e=!0;break;case -556893687:e=!0;break;case -1966978671:e=!0;break;case -1951357930:e=!0;break;case -1390365353:case -1457478532:e=!0;break;case -249874296:case -771066011:case 1746132849:case 1475494885:case 376946683:case 835007294:case 929115636:case 1935475057:case 588680636:case -910892852:case -1255320719:case 1668427539:case -1751371357:e=
!0;break;case -1128612833:case -841863025:case -178796371:case 767774849:case 786592977:case 282586693:case -1067664355:case -2031744961:e=!0;break;case -1007663920:case 234234584:case 1194992911:e=!0;break;case 1514686611:case 1217404289:case -743135194:case 771421327:case 1015867427:case 1105960559:case 1778578888:e=!0}return e};Rf.prototype.Xc=function(e,C){var M=!1;switch(C){case -1007663920:case 234234584:M=this.Uoj();break;case 1194992911:M=this.Voj();break;case 1217404289:M=!Pe.j(this.Bb.LabelOrDateFilterType);
break;case -743135194:M=!Pe.m(this.Bb.ValueFilterType)&&!Pe.l(this.Bb.ValueFilterType);break;case 771421327:M=!this.Bb.LabelOrDateFilterType&&!this.Bb.ValueFilterType&&!this.Bb.HasManualFilter;break;case 1015867427:M=!Pe.i(this.Bb.LabelOrDateFilterType);break;case 1105960559:M=!Pe.k(this.Bb.LabelOrDateFilterType)}return M||yg.prototype.Xc.call(this,e,C)};Rf.prototype.rab=function(){this.O9a=this.Bb=this.Yf=null};Rf.prototype.qRd=function(){this.grid.hT(this.Ms);this.$.Ka.cFa(this.Jt)};Rf.prototype.XUd=
function(){this.grid.wN(this.Ms);this.$.Ka.X$a(this.Jt)};Rf.prototype.nIb=function(){if(this.Wc&&this.Wc.Do){this.Yf=this.Wc.Do;this.Bb=this.Wc.b$b();if(this.CZf()){var e=this.Wc.JK[4===this.Yf.CellType?this.Wc.H3c-1:this.Yf.CurrentFieldIndex-1];e&&(this.O9a=-2===e.Index?this.Wc.iDe:e.Caption)}this.D3h();this.Bb&&8===this.Yf.CellArea&&(this.Cz.PivotValueFieldSummarizeValueByApplyData.Aggregation=this.Bb.DataFieldAggregationType,this.Cz.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=this.Bb.DataFieldFormatType,
this.Cz.PivotValueFieldShowValueAsApplyData.SelectedBaseField=this.Bb.BaseFieldIndex,this.Cz.PivotValueFieldTitle=this.Bb.Caption)}};Rf.prototype.PYf=function(e){if(!this.Wc)return!1;e=this.Wc.isOlap&&!this.Wc.i6a(!e);return kd.EwaSettings.la(607)&&e};Rf.prototype.bpj=function(){var e=kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ImplicitMeasureSupport",!1);return 1!==this.Bb.MeasureType&&(!this.Wc.adf||e&&2===this.Bb.MeasureType)};Rf.prototype.zY=function(){var e=this.Sa.zp(this.menuId),
C=this.Sa.Lc();if(this.Wc)this.Yf&&this.Wc.Do&&this.Yf!==this.Wc.Do&&Dd.ULS.shipAssertTag(537167006,0,!1,"CurrentCellInfo is out of sync with cell info from PivotTable Range"),this.Bb&&this.Bb!==this.Wc.b$b()&&Dd.ULS.shipAssertTag(537167005,0,!1,"CurrentField is out of sync with field from PivotTable Range");else return e;this.Szh(e);if(this.$.isEditMode){this.refresh&&this.fBh(e);if(this.Yf&&this.Bb){var M=this.Sa.Lc();this.uBh(M);this.gAh(M);Array.add(e.yc,M)}this.VY&&Array.add(C.buttons,this.Sa.yb(99));
this.Yf&&this.Bb&&this.CAh(e);if(this.expandCollapse){M=this.Sa.Kv("ContextMenu.PivotExpandCollapse",null,fe.a.instance.ea(1117),589118293);var qa=this.Sa.Lc();Array.add(qa.buttons,this.Sa.yb(243));Array.add(qa.buttons,this.Sa.yb(244));Array.add(qa.buttons,this.Sa.yb(245));Array.add(qa.buttons,this.Sa.yb(246));Array.add(M.menu.yc,qa);M&&0<qa.buttons.length&&Array.add(C.buttons,M)}this.Yf&&this.gBh(e);this.Yf&&this.Bb&&8===this.Yf.CellArea&&8!==this.Yf.CellType&&(M=this.Sa.Lc(),this.bpj()&&this.wBh(M),
3!==this.Yf.CellType&&this.rBh(M),Array.add(e.yc,M));!this.Wc.Afc()&&this.Yf&&0===this.Yf.CellType&&kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableShowDetails",!1)&&this.qBh(e);kd.EwaSettings.la(324)&&(this.wdi()?Array.add(C.buttons,this.Sa.yb(257)):Array.add(C.buttons,this.Sa.yb(258)));this.Uld?Array.add(C.buttons,this.Sa.yb(59)):Array.add(C.buttons,this.Sa.yb(58))}Array.add(e.yc,C);return e};Rf.prototype.MOd=function(){return this.Bb&&this.Bb.Caption?20<this.Bb.Caption.length:
!1};Rf.prototype.qcd=function(e){return this.Bb&&this.Bb.Caption?e?this.Bb.Caption.substring(0,20)+"...":this.Bb.Caption:""};Rf.prototype.Gua=function(e){return kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5548525_FixLoggingColumnNameInButtonId")?K.a.hashCode(e).toString():e};Rf.prototype.uBh=function(e){if(this.Yf&&this.Bb&&4!==this.Yf.CellArea){var C=this.jua(this.KG("PivotTableContextMenu.Sort",this.Gua(this.Bb.Caption)),-1777747317,0,!!this.Bb.SortInfo,fe.a.instance.ea(228)),M=this.Sa.Lc();Array.add(M.buttons,
this.$d("PivotTableContextMenu.SortAscending",-1007663920,0,1===this.Bb.SortInfo,fe.a.instance.ea(229)));Array.add(M.buttons,this.$d("PivotTableContextMenu.SortDescending",234234584,0,2===this.Bb.SortInfo,fe.a.instance.ea(230)));1!==this.Yf.CellArea&&2!==this.Yf.CellArea||Array.add(M.buttons,this.$d("PivotTableContextMenu.SortByValue",1194992911,0,3===this.Bb.SortInfo||4===this.Bb.SortInfo,fe.a.instance.ea(155)));Array.add(C.menu.yc,M);C&&0<M.buttons.length&&Array.add(e.buttons,C)}};Rf.prototype.gAh=
function(e){if(this.Yf&&this.Bb&&(1===this.Yf.CellArea||2===this.Yf.CellArea)){var C=this.pqj(),M=this.jua(this.KG("PivotTableContextMenu.Filter",this.Gua(this.Bb.Caption)),-1777747317,0,C,fe.a.instance.ea(641)),qa=this.Sa.Lc(),Na="",Hb=this.MOd(),Gc=String.format(fe.a.instance.Cb(155),this.qcd(Hb));Hb&&(Na=String.format(fe.a.instance.Cb(155),this.Bb.Caption));C=this.Gua(this.Bb.Caption)+"."+(C?"enabled":"disabled");Na=this.$d(this.KG("PivotTableContextMenu.ClearFilter",C),771421327,0,!1,Gc,"0",Na,
8,pc.a.g1a);C=this.Gua(this.Bb.Caption)+"."+this.Bb.LabelOrDateFilterType.toString();this.Bb.IsDateField?(Gc=this.jua(this.KG("PivotTableContextMenu.DateFilter",C),-1777747317,0,!!this.Bb.LabelOrDateFilterType,fe.a.instance.ea(96)),this.Vzh(Gc.menu)):(Gc=this.jua(this.KG("PivotTableContextMenu.LabelFilter",C),-1777747317,0,!!this.Bb.LabelOrDateFilterType,fe.a.instance.ea(639)),this.BAh(Gc.menu));C=this.Gua(this.Bb.Caption)+"."+this.Bb.ValueFilterType.toString();C=this.jua(this.KG("PivotTableContextMenu.ValueFilter",
C),-1777747317,0,!!this.Bb.ValueFilterType,fe.a.instance.ea(640));this.IBh(C.menu);Hb=this.Sa.Lc();Array.add(Hb.buttons,this.$d("PivotTableContextMenu.ManualFilter",1514686611,0,this.Bb.HasManualFilter,fe.a.instance.ea(93)));Array.add(qa.buttons,Na);Array.add(qa.buttons,Gc);Array.add(qa.buttons,C);Array.add(M.menu.yc,qa);Array.add(M.menu.yc,Hb);M&&0<qa.buttons.length&&Array.add(e.buttons,M)}};Rf.prototype.Vzh=function(e){Array.add(e.yc,this.A$b(!0,!1));Array.add(e.yc,this.RGh());Array.add(e.yc,this.QGh());
Array.add(e.yc,this.FIh());Array.add(e.yc,this.IIh());Array.add(e.yc,this.GIh());Array.add(e.yc,this.HIh());Array.add(e.yc,this.JIh());Array.add(e.yc,this.KIh());Array.add(e.yc,this.EGh())};Rf.prototype.Mzh=function(e){Array.add(e.yc,this.A$b(!0,!0));Array.add(e.yc,this.fPh());Array.add(e.yc,this.CMh())};Rf.prototype.BAh=function(e){Array.add(e.yc,this.A$b(!0,!1));Array.add(e.yc,this.iWe(!0));Array.add(e.yc,this.uDh());Array.add(e.yc,this.NFh());Array.add(e.yc,this.hVe(!0));Array.add(e.yc,this.mUe(!0))};
Rf.prototype.IBh=function(e){Array.add(e.yc,this.A$b(!1,!1));Array.add(e.yc,this.iWe(!1));Array.add(e.yc,this.hVe(!1));Array.add(e.yc,this.mUe(!1));Array.add(e.yc,this.qTh())};Rf.prototype.qTh=function(){var e=this.Sa.Lc();Array.add(e.buttons,this.$d("PivotTableContextMenu.Top10",-1611233597,0,Pe.l(this.Bb.ValueFilterType),fe.a.instance.ea(104)));return e};Rf.prototype.NFh=function(){var e=this.Sa.Lc();this.Bb&&(Array.add(e.buttons,this.$d("PivotTableContextMenu.Contains",786260386,0,10===this.Bb.LabelOrDateFilterType,
fe.a.instance.ea(642),"10")),Array.add(e.buttons,this.$d("PivotTableContextMenu.DoesNotContain",786260386,0,11===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(643),"11")));return e};Rf.prototype.uDh=function(){var e=this.Sa.Lc();this.Bb&&(Array.add(e.buttons,this.$d("PivotTableContextMenu.BeginsWith",786260386,0,6===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(644),"6")),Array.add(e.buttons,this.$d("PivotTableContextMenu.DoesNotBeginWith",786260386,0,7===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(645),
"7")),Array.add(e.buttons,this.$d("PivotTableContextMenu.EndsWith",786260386,0,8===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(646),"8")),Array.add(e.buttons,this.$d("PivotTableContextMenu.DoesNotEndWith",786260386,0,9===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(647),"9")));return e};Rf.prototype.iWe=function(e){var C=this.Sa.Lc();if(this.Bb){var M=e?Pe.c:Pe.f;Array.add(C.buttons,this.$d(this.KG("PivotTableContextMenu.Equals",M),786260386,0,e?4===this.Bb.LabelOrDateFilterType:18===this.Bb.ValueFilterType,
fe.a.instance.ea(99),e?"4":"18"));Array.add(C.buttons,this.$d(this.KG("PivotTableContextMenu.DoesNotEqual",M),786260386,0,e?5===this.Bb.LabelOrDateFilterType:19===this.Bb.ValueFilterType,fe.a.instance.ea(100),e?"5":"19"))}return C};Rf.prototype.hVe=function(e){var C=this.Sa.Lc();if(this.Bb){var M=e?Pe.c:Pe.f;Array.add(C.buttons,this.$d(this.KG("PivotTableContextMenu.GreaterThan",M),786260386,0,e?12===this.Bb.LabelOrDateFilterType:20===this.Bb.ValueFilterType,fe.a.instance.ea(101),e?"12":"20"));Array.add(C.buttons,
this.$d(this.KG("PivotTableContextMenu.GreaterThanOrEqualTo",M),786260386,0,e?13===this.Bb.LabelOrDateFilterType:21===this.Bb.ValueFilterType,fe.a.instance.ea(648),e?"13":"21"));Array.add(C.buttons,this.$d(this.KG("PivotTableContextMenu.LessThan",M),786260386,0,e?14===this.Bb.LabelOrDateFilterType:22===this.Bb.ValueFilterType,fe.a.instance.ea(102),e?"14":"22"));Array.add(C.buttons,this.$d(this.KG("PivotTableContextMenu.LessThanOrEqualTo",M),786260386,0,e?15===this.Bb.LabelOrDateFilterType:23===this.Bb.ValueFilterType,
fe.a.instance.ea(649),e?"15":"23"))}return C};Rf.prototype.mUe=function(e){var C=this.Sa.Lc();if(this.Bb){var M=e?Pe.c:Pe.f;Array.add(C.buttons,this.$d(this.KG("PivotTableContextMenu.Between",M),786260386,0,e?16===this.Bb.LabelOrDateFilterType:24===this.Bb.ValueFilterType,fe.a.instance.ea(103),e?"16":"24"));Array.add(C.buttons,this.$d(this.KG("PivotTableContextMenu.NotBetween",M),786260386,0,e?17===this.Bb.LabelOrDateFilterType:25===this.Bb.ValueFilterType,fe.a.instance.ea(650),e?"17":"25"))}return C};
Rf.prototype.A$b=function(e,C){var M=this.Sa.Lc();if(this.Bb){var qa=fe.a.instance.ea(97),Na=e?this.Bb.LabelOrDateFilterType.toString():this.Bb.ValueFilterType.toString(),Hb=["PivotTableContextMenu.ClearFilter",this.Gua(this.Bb.Caption),Na];e=e?this.Bb.IsDateField?C?1015867427:1105960559:1217404289:-743135194;Hb.push(e.toString());qa=this.$d(Hb.join("."),e,0,!1,qa,Na,qa,8,pc.a.g1a);Array.add(M.buttons,qa)}return M};Rf.prototype.RGh=function(){var e=this.Sa.Lc();this.Bb&&Array.add(e.buttons,this.$d(this.KG("PivotTableContextMenu.Equals",
Pe.d),786260386,0,26===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(99),"26"));return e};Rf.prototype.QGh=function(){var e=this.Sa.Lc();this.Bb&&(Array.add(e.buttons,this.$d("PivotTableContextMenu.Before",786260386,0,27===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(111),"27")),Array.add(e.buttons,this.$d("PivotTableContextMenu.After",786260386,0,28===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(112),"28")),Array.add(e.buttons,this.$d("PivotTableContextMenu.Between",786260386,0,29===this.Bb.LabelOrDateFilterType,
fe.a.instance.ea(103),"29")));return e};Rf.prototype.FIh=function(){var e=this.Sa.Lc();this.Bb&&(Array.add(e.buttons,this.$d("PivotTableContextMenu.Tomorrow",1778578888,0,30===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(109),"30")),Array.add(e.buttons,this.$d("PivotTableContextMenu.Today",1778578888,0,31===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(108),"31")),Array.add(e.buttons,this.$d("PivotTableContextMenu.Yesterday",1778578888,0,32===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(110),
"32")));return e};Rf.prototype.IIh=function(){var e=this.Sa.Lc();this.Bb&&(Array.add(e.buttons,this.$d("PivotTableContextMenu.NextWeek",1778578888,0,33===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(114),"33")),Array.add(e.buttons,this.$d("PivotTableContextMenu.ThisWeek",1778578888,0,34===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(113),"34")),Array.add(e.buttons,this.$d("PivotTableContextMenu.LastWeek",1778578888,0,35===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(115),"35")));return e};Rf.prototype.GIh=
function(){var e=this.Sa.Lc();this.Bb&&(Array.add(e.buttons,this.$d("PivotTableContextMenu.NextMonth",1778578888,0,36===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(116),"36")),Array.add(e.buttons,this.$d("PivotTableContextMenu.ThisMonth",1778578888,0,37===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(117),"37")),Array.add(e.buttons,this.$d("PivotTableContextMenu.LastMonth",1778578888,0,38===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(118),"38")));return e};Rf.prototype.HIh=function(){var e=
this.Sa.Lc();this.Bb&&(Array.add(e.buttons,this.$d("PivotTableContextMenu.NextQuarter",1778578888,0,39===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(119),"39")),Array.add(e.buttons,this.$d("PivotTableContextMenu.ThisQuarter",1778578888,0,40===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(120),"40")),Array.add(e.buttons,this.$d("PivotTableContextMenu.LastQuarter",1778578888,0,41===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(121),"41")));return e};Rf.prototype.JIh=function(){var e=this.Sa.Lc();
this.Bb&&(Array.add(e.buttons,this.$d("PivotTableContextMenu.NextYear",1778578888,0,42===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(122),"42")),Array.add(e.buttons,this.$d("PivotTableContextMenu.ThisYear",1778578888,0,43===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(123),"43")),Array.add(e.buttons,this.$d("PivotTableContextMenu.LastYear",1778578888,0,44===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(124),"44")));return e};Rf.prototype.KIh=function(){var e=this.Sa.Lc();if(this.Bb){Array.add(e.buttons,
this.$d("PivotTableContextMenu.YearToDate",1778578888,0,45===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(125),"45"));var C=this.jua("PivotTableContextMenu.AllDatesInThePeriod",1778578888,0,Pe.i(this.Bb.LabelOrDateFilterType),fe.a.instance.ea(126));this.Mzh(C.menu);Array.add(e.buttons,C)}return e};Rf.prototype.EGh=function(){var e=this.Sa.Lc();this.Bb&&Array.add(e.buttons,this.$d("PivotTableContextMenu.CustomFilter",786260386,0,this.mqj(this.Bb.LabelOrDateFilterType),fe.a.instance.ea(107),"26"));
return e};Rf.prototype.fPh=function(){var e=this.Sa.Lc();this.Bb&&(Array.add(e.buttons,this.$d("PivotTableContextMenu.Quarter1",1778578888,0,46===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(127),"46")),Array.add(e.buttons,this.$d("PivotTableContextMenu.Quarter2",1778578888,0,47===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(128),"47")),Array.add(e.buttons,this.$d("PivotTableContextMenu.Quarter3",1778578888,0,48===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(129),"48")),Array.add(e.buttons,
this.$d("PivotTableContextMenu.Quarter4",1778578888,0,49===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(130),"49")));return e};Rf.prototype.CMh=function(){var e=this.Sa.Lc();this.Bb&&(Array.add(e.buttons,this.$d("PivotTableContextMenu.January",1778578888,0,50===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(131),"50")),Array.add(e.buttons,this.$d("PivotTableContextMenu.February",1778578888,0,51===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(132),"51")),Array.add(e.buttons,this.$d("PivotTableContextMenu.March",
1778578888,0,52===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(133),"52")),Array.add(e.buttons,this.$d("PivotTableContextMenu.April",1778578888,0,53===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(134),"53")),Array.add(e.buttons,this.$d("PivotTableContextMenu.May",1778578888,0,54===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(135),"54")),Array.add(e.buttons,this.$d("PivotTableContextMenu.June",1778578888,0,55===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(136),"55")),Array.add(e.buttons,this.$d("PivotTableContextMenu.July",
1778578888,0,56===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(137),"56")),Array.add(e.buttons,this.$d("PivotTableContextMenu.August",1778578888,0,57===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(138),"57")),Array.add(e.buttons,this.$d("PivotTableContextMenu.September",1778578888,0,58===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(139),"58")),Array.add(e.buttons,this.$d("PivotTableContextMenu.October",1778578888,0,59===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(140),"59")),Array.add(e.buttons,
this.$d("PivotTableContextMenu.November",1778578888,0,60===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(141),"60")),Array.add(e.buttons,this.$d("PivotTableContextMenu.December",1778578888,0,61===this.Bb.LabelOrDateFilterType,fe.a.instance.ea(142),"61")));return e};Rf.prototype.CAh=function(e){var C=this.Sa.Lc();if(this.CZf()){var M=this.Wc.JK[4===this.Yf.CellType?this.Wc.H3c-1:this.Yf.CurrentFieldIndex-1];if(M&&this.O9a){var qa=this.Sa.Kv("ContextMenu.PivotTableLayout",null,fe.a.instance.ea(637),
-1777747317);var Na=this.Sa.Lc(),Hb=String.format(fe.a.instance.Cb(160),this.O9a),Gc=String.format(fe.a.instance.Cb(161),this.O9a);Array.add(Na.buttons,this.$d("PivotTableContextMenu.LayoutNextColumn",-1457478532,0,!M.IsCompactLayout,Hb));Array.add(Na.buttons,this.$d("PivotTableContextMenu.LayoutSameColumn",-1390365353,0,M.IsCompactLayout,Gc));Array.add(qa.menu.yc,Na);qa&&Array.add(C.buttons,qa)}}if(1===this.Yf.CellArea||2===this.Yf.CellArea)this.Bb.Caption&&(M="",Na=this.MOd(),qa=String.format(fe.a.instance.Cb(158),
this.qcd(Na)),Na&&(M=String.format(fe.a.instance.Cb(158),this.Bb.Caption)),1===this.Yf.CellArea?(M=this.jua("ContextMenu.PivotTableSubtotal",1801458190,0,this.Bb.ShowSubtotal,qa),qa=this.Sa.Lc(),Array.add(qa.buttons,this.Sa.yb(259)),Array.add(qa.buttons,this.$d("ContextMenu.PivotTableSubtotalOnTop",671485366,629,this.Bb.ShowSubtotal&&this.Bb.ShowSubtotalAtTop)),Array.add(qa.buttons,this.$d("ContextMenu.PivotTableSubtotalOnBottom",772221736,630,this.Bb.ShowSubtotal&&!this.Bb.ShowSubtotalAtTop)),Array.add(M.menu.yc,
qa),M&&0<qa.buttons.length&&Array.add(C.buttons,M)):(Na=Na?this.KG("PivotTableContextMenu.Subtotal",this.Gua(qa)):"PivotTableContextMenu.Subtotal",Array.add(C.buttons,this.$d(Na,1801458190,0,this.Bb.ShowSubtotal,qa,null,M)))),Array.add(C.buttons,this.$d("ContextMenu.RepeatItemLabels",-556893687,632,this.Bb.RepeatItemLabels));1===this.Yf.CellArea&&Array.add(C.buttons,this.$d("ContextMenu.PivotBlankLineAfterEachItem",1600778266,631,this.Bb.ShowBlankLineAfterEachItem));Array.add(e.yc,C)};Rf.prototype.qBh=
function(e){var C=this.Sa.Lc();Array.add(C.buttons,this.Sa.yb(247));Array.add(e.yc,C)};Rf.prototype.gBh=function(e){var C="",M="",qa=!1;3===this.Yf.CellType?C=fe.a.instance.ea(634):8===this.Yf.CellType?this.Wc&&(C=String.format(fe.a.instance.Cb(159),this.Wc.iDe)):this.Bb&&((qa=this.MOd())&&(M=String.format(fe.a.instance.Cb(159),this.Bb.Caption)),C=String.format(fe.a.instance.Cb(159),this.qcd(qa)));if(C){var Na=this.Sa.Lc();qa=qa?this.KG("PivotTableContextMenu.RemoveField",this.Gua(C)):"PivotTableContextMenu.RemoveField";
C=this.$d(qa,-1951357930,0,!1,C,null,M,8,pc.a.c8c);Array.add(Na.buttons,C);Array.add(e.yc,Na)}};Rf.prototype.Szh=function(e){var C=this.Sa.Lc();kd.EwaSettings.la(483)&&Array.add(C.buttons,this.Sa.yb(43));this.Bb&&this.Yf&&this.$.isEditMode&&(!this.Yf.CellType||4===this.Yf.CellType)&&Array.add(C.buttons,this.Sa.yb(136));Array.add(e.yc,C)};Rf.prototype.fBh=function(e){var C=this.Sa.Lc();Array.add(C.buttons,this.Sa.yb(100));Array.add(e.yc,C)};Rf.prototype.wBh=function(e){var C=2===this.Bb.MeasureType&&
!this.Bb.IsNumeric,M=this.Sa.Kv("ContextMenu.SummarizeValuesBy",null,fe.a.instance.ea(635),-249874296),qa=this.Sa.Lc();Array.add(qa.buttons,this.$d("ContextMenu.SummarizeValuesBySum",-1255320719,1056,!this.Bb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,C));Array.add(qa.buttons,this.$d("ContextMenu.SummarizeValuesByCount",1746132849,1057,1===this.Bb.DataFieldAggregationType));Array.add(qa.buttons,this.$d("ContextMenu.SummarizeValuesByAverage",-771066011,1058,2===this.Bb.DataFieldAggregationType,
void 0,void 0,void 0,void 0,void 0,C));Array.add(qa.buttons,this.$d("ContextMenu.SummarizeValuesByMax",835007294,1059,3===this.Bb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,C));Array.add(qa.buttons,this.$d("ContextMenu.SummarizeValuesByMin",929115636,1060,4===this.Bb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,C));Array.add(qa.buttons,this.$d("ContextMenu.SummarizeValuesByProduct",1935475057,1061,5===this.Bb.DataFieldAggregationType,void 0,void 0,void 0,void 0,void 0,
this.PYf(!0)||C));2!==this.Bb.MeasureType&&(Array.add(qa.buttons,this.$d("ContextMenu.SummarizeValuesByCountNumbers",1475494885,1062,6===this.Bb.DataFieldAggregationType)),Array.add(qa.buttons,this.$d("ContextMenu.SummarizeValuesByStdDeviation",588680636,1063,7===this.Bb.DataFieldAggregationType)),Array.add(qa.buttons,this.$d("ContextMenu.SummarizeValuesByStdDeviationPercent",-910892852,1064,8===this.Bb.DataFieldAggregationType)),Array.add(qa.buttons,this.$d("ContextMenu.SummarizeValuesByVariant",
1668427539,1065,9===this.Bb.DataFieldAggregationType)),Array.add(qa.buttons,this.$d("ContextMenu.SummarizeValuesByVariantPercent",-1751371357,1066,10===this.Bb.DataFieldAggregationType)));this.Wc&&this.Wc.Afc()&&Array.add(qa.buttons,this.$d("ContextMenu.SummarizeValuesByDistinctCountPPM",376946683,1067,11===this.Bb.DataFieldAggregationType));Array.add(M.menu.yc,qa);Array.add(e.buttons,M)};Rf.prototype.rBh=function(e){var C=this.Sa.Kv("ContextMenu.ShowValuesAs",null,fe.a.instance.ea(636),-1128612833),
M=this.Sa.Lc();Array.add(M.buttons,this.$d("ContextMenu.ShowValuesAsNoCalculation",-841863025,1073,!this.Bb.DataFieldFormatType));Array.add(M.buttons,this.$d("ContextMenu.ShowValuesAsPercentOfGrandTotal",-178796371,1080,7===this.Bb.DataFieldFormatType));Array.add(M.buttons,this.$d("ContextMenu.ShowValuesAsPercentOfColumnTotal",786592977,1079,6===this.Bb.DataFieldFormatType));Array.add(M.buttons,this.$d("ContextMenu.ShowValuesAsPercentOfRowTotal",767774849,1078,5===this.Bb.DataFieldFormatType));Array.add(M.buttons,
this.$d("ContextMenu.ShowValuesAsPercentOfParentRowTotal",282586693,1083,9===this.Bb.DataFieldFormatType));Array.add(M.buttons,this.$d("ContextMenu.ShowValuesAsParentColumnTotal",-1067664355,1084,10===this.Bb.DataFieldFormatType));if(this.Wc&&this.Wc.JK&&0<this.Wc.JK.length||this.Wc.Z9&&0<this.Wc.Z9.length){for(var qa=this.jua("ContextMenu.ShowValuesAsPercentOfParentTotal",-1128612833,1085,11===this.Bb.DataFieldFormatType),Na=this.Sa.Lc(),Hb=this.vBh(),Gc=0;Gc<Hb.length;Gc++){var gd=Hb[Gc];Array.add(Na.buttons,
this.$d("ContextMenu.ShowValuesAsPercentOfParentTotal."+gd.Caption,-2031744961,1085,11===this.Bb.DataFieldFormatType&&this.Bb.BaseFieldIndex===gd.Index,gd.Caption,"ContextMenu.ShowValuesAsPercentOfParentTotal."+gd.Index))}Array.add(qa.menu.yc,Na);Array.add(M.buttons,qa)}Array.add(C.menu.yc,M);Array.add(e.buttons,C)};Rf.prototype.showPivotTableContextMenu=function(){this.Uld=!0;this.expandCollapse=this.VY=this.refresh=!1;var e=this.$,C=Ye.g(e),M=$g.a(e).PJa();if(M){var qa=Ge.a(e);if(null===qa||void 0===
qa?0:qa.eOd)this.Uld=oe.f(e.kg);qa=e.lc;this.VY=M.supportsBIExplore&&!!Zd.a(e)&&qa.n2(32768);qa.allowInteractivity&&(e=C.sc(null),(null===e||void 0===e?0:e.cell)&&(e.cell.QXc||e.cell.zZf)&&(this.expandCollapse=!0),qa.allowManualDataRefresh&&(this.refresh=!0))}e=null;M=1;this.q_a&&1!==this.q_a.zb?(e=new Sys.UI.Point(this.q_a.clientPoint.x,this.q_a.clientPoint.y),M=this.q_a.zb):(C=hf.e(C,this.$))&&(e=new Sys.UI.Point(C.x+(this.$.isChromeRtl?0:C.width),C.y+C.height));eg.a.Wb=M;this.Egc=3===M;this.so(e,
!0,M);this.Uaa=!0;this.qRd()};Rf.prototype.Z_h=function(){var e=new Bf.a(1114549926,0,this.$.ed,19,null);this.$.Ka.Zb(e)};Rf.prototype.jOh=function(){var e=this;if(this.Wc&&this.Wc.Do){var C=this.Wc.Do.CurrentCol;if(this.Wc.Do.CurrentRow===this.activeCell.FirstRow&&C===this.activeCell.FirstColumn){this.nIb();this.showPivotTableContextMenu();return}}C=new mg.a(228,0,function(M,qa,Na){return vf.B(e.$.qa.ta,e.activeCell,lh.b(M,e.nEi),lh.a(qa,e.mEi),Na,null)},16);this.$.userOperationManager.ic(C,null)};
Rf.prototype.wdi=function(){if(fg.a.Gd(this.$)){var e=this.$.da.Aa(441);if(e)return e.Hr}else if(e=this.$.da.Aa(346))return e.Hr;return!1};Rf.prototype.KG=function(e,C){return e+"."+C};Rf.prototype.performPivotTableOperation=function(e,C){var M=this,qa=Xg.a.Ra.Kb;if(!this.Wc||!this.Bb&&this.Yf&&3!==this.Yf.CellType)this.ri();else{var Na=this.Wc.isOlap;$g.a(this.$).pu(Na,function(Hb){Hb&&M.$.ic(e,function(Gc,gd,Uc){if(kd.EwaSettings.la(523)){var Wd=M.XAc,We=M.activeCell,Gf=M.Bb?M.Bb.Caption:null,xg=
M.O9a;Gc=lh.b(Gc,M.dIi);gd=lh.a(gd,M.cIi);var Hg=M.$.qa.ta.Xb();Hg=Wd.Oa(41,void 0===Hg?null:Hg);Hg.activeCell=We;Hg.operationType=C;Hg.fieldCaption=Gf;Hg.prevFieldCaption=xg;Uc=vf.i(Wd,"ExecutePivotTableOperation",Hg,Gc,gd,Uc,null,0)}else Wd=M.XAc,We=M.activeCell,Gf=M.$.qa.ta.Xb(),Gf=Wd.Oa(41,void 0===Gf?null:Gf),Gf.activeCell=We,Gf.operationType=C,Uc=vf.i(Wd,"PerformPivotTableOperation",Gf,Gc,gd,Uc,null,0);return Uc},qa,0,4,229)})}};Rf.prototype.applyValueFieldSettingsToPivotTable=function(e,C){var M=
this;C=void 0===C?!1:C;var qa=Xg.a.Ra.Kb;this.Wc&&this.Bb?(C&&2===this.Bb.MeasureType&&Dd.ULS.sendTraceTag(537167002,0,50,"change aggregation type for an implicit measure from right click context menu."),C=this.Wc.isOlap,$g.a(this.$).pu(C,function(Na){Na&&M.$.ic(e,function(Hb,Gc,gd){var Uc=M.XAc,Wd=M.activeCell,We=M.Cz;Hb=lh.b(Hb,M.bzi);Gc=lh.a(Gc,M.azi);var Gf=M.$.qa.ta.Xb();Gf=Uc.Oa(41,void 0===Gf?null:Gf);Gf.activeCell=Wd;Gf.pivotValueFieldSettingsApplyData=We;return vf.i(Uc,"ApplyValueFieldSettingsToPivotTable",
Gf,Hb,Gc,gd,null,0)},qa,0,4,231)})):this.ri()};Rf.prototype.$d=function(e,C,M,qa,Na,Hb,Gc,gd,Uc,Wd){Na=void 0===Na?null:Na;Hb=void 0===Hb?null:Hb;Gc=void 0===Gc?null:Gc;gd=void 0===gd?8:gd;Uc=void 0===Uc?null:Uc;Wd=void 0===Wd?!1:Wd;qa&&(e+=".Checked");Wd&&(e+=".Disabled");this.Sa.Mkd(e)&&this.Sa.TFd(e);M=Na||fe.a.instance.ea(M);e=this.Sa.TGa(e,M,C,null,"None",Hb,Wd,null);e.Utc(null);Gc&&e.DR(Gc);qa?e.GR("Image16by16",3,pc.a.G$):Uc?e.GR("Image16by16",gd,Uc):e.M0b();return e};Rf.prototype.jua=function(e,
C,M,qa,Na){M=(void 0===Na?null:Na)||fe.a.instance.ea(M);this.Sa.Mkd(e)?this.Sa.TFd(e):this.Sa.TFd(e+".Checked");qa&&(e+=".Checked");this.Eoj&&(M=this.Tch.parseFromString(M,"text/html").body.innerText);e=this.Sa.O1c(e,null,M,C,3,pc.a.G$);e.V6e=qa;!qa&&kd.EwaSettings.isChangeGateEnabled("OfficeVSO:4877664_HidePivotTableContextMenuFlyoutCheckmark")&&e.M0b();return e};Rf.prototype.D3h=function(){this.Cz=Object.assign(new ze,{PivotValueFieldSummarizeValueByApplyData:Object.assign(new Pa,{Aggregation:-1}),
PivotValueFieldShowValueAsApplyData:Object.assign(new tc,{SelectedDataFormat:-1,SelectedBaseField:-1,SelectedBaseItem:-1}),PivotValueFieldTitle:null})};Rf.prototype.VQa=function(e,C){this.Cz.PivotValueFieldShowValueAsApplyData.SelectedDataFormat=e;this.Cz.PivotValueFieldShowValueAsApplyData.SelectedBaseField=C;this.Cz.PivotValueFieldShowValueAsApplyData.SelectedBaseItem=-1};Rf.prototype.vBh=function(){var e=[];if(this.Wc&&this.Wc.Z9&&0<this.Wc.Z9.length)for(var C=yl(this.Wc.Z9),M=C.next();!M.done;M=
C.next())(M=M.value)&&Array.add(e,M);if(this.Wc&&this.Wc.JK&&0<this.Wc.JK.length)for(C=yl(this.Wc.JK),M=C.next();!M.done;M=C.next())(M=M.value)&&Array.add(e,M);e.sort(function(qa,Na){return qa.Index-Na.Index});return e};Rf.prototype.CZf=function(){if(!this.Yf||!this.Wc||!this.Wc.JK)return!1;var e=1===this.Yf.CellArea||4===this.Yf.CellType&&this.Yf.IsRowAxis,C=4===this.Yf.CellType?0<this.Wc.H3c:0<this.Yf.CurrentFieldIndex;return 1<this.Wc.JK.length&&e&&C};Rf.prototype.BJa=function(e){var C=[];3===
e?this.$.isEditMode?Array.addRange(C,[ea.a.vDf,ea.a.xDf,ea.a.TQi]):Array.addRange(C,[ea.a.copy]):2===e&&Array.add(C,ea.a.Cue);return C};Rf.prototype.ri=function(){var e=oh.a.jd(1,0,0,638,0,104573951,"PivotTableContextMenuOperationFailure");Qi.a(this.$).ri(e)};Rf.prototype.pqj=function(){return this.Bb?!!this.Bb.LabelOrDateFilterType||!!this.Bb.ValueFilterType||this.Bb.HasManualFilter:!1};Rf.prototype.mqj=function(e){return 62<=e&&65>=e};Rf.prototype.Iji=function(){if(this.activeCell&&this.Bb&&this.Wc){var e=
{};e.cell=this.activeCell;e.dataSourceIndex=this.Wc.externalSourceIndex;e.fieldId=this.Bb.Index.toString();e.isOlap=this.Wc.isOlap;e.confirmationRequired=this.Wc.confirmationRequiredForDataOps;this.$.Ce(492140419,eg.a.Wb,19,{showPivotFilterDialogCommandData:e})}};Rf.prototype.XTg=function(e){var C=this;this.activeCell&&this.Bb&&this.Wc&&this.$.userOperationManager.ic(new mg.a(153,0,function(M,qa,Na){return vf.W(C.$.qa.ta,C.activeCell,C.Wc.externalSourceIndex,C.Bb.Index.toString(),e,M,qa,Na,null,null)}),
null)};Rf.prototype.UFg=function(e){var C=this;!(30>e||61<e)&&this.activeCell&&this.Bb&&this.Wc&&this.$.userOperationManager.ic(new mg.a(152,0,function(M,qa,Na){return vf.g(C.$.qa.ta,C.activeCell,C.Wc.externalSourceIndex,C.Bb.Index.toString(),e,M,qa,Na,null,null)}),null)};Rf.prototype.applyPivotSort=function(e){var C=this;if(this.Wc&&this.Bb&&this.activeCell&&this.Yf){var M=1===this.Yf.CellArea||2===this.Yf.CellArea;8===this.Yf.CellArea?wg.a(this.$.userOperationManager,function(qa,Na,Hb){return vf.e(C.$.qa.ta,
C.activeCell,e,C.Bb.Caption,qa,Na,Hb,null)},function(qa){return new mg.a(1015,0,qa,void 0,null)},null):M&&(M=1===this.Yf.CellArea?1:2,this.$.la(726)?pg.a.naps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Wc.externalSourceIndex,this.Bb.Index.toString(),this.Bb.Caption,this.Wc.isOlap?"":this.Bb.Caption,M,1===e):pg.a.aps(this.$.domElement,this.activeCell.FirstRow,this.activeCell.FirstColumn,this.Wc.externalSourceIndex,this.Bb.Index.toString(),1===e))}};Rf.prototype.Uoj=
function(){return(this.Yf||this.Wc)&&4!==this.Yf.CellType&&(this.Yf.CellType||8!==this.Yf.CellArea||this.Wc.Z9&&this.Wc.Z9.length||this.Wc.JK&&this.Wc.JK.length)?!1:!0};Rf.prototype.Voj=function(){return this.Yf&&this.Wc&&(1===this.Yf.CellArea||2===this.Yf.CellArea)&&this.Wc.VMb&&this.Wc.VMb.length?!1:!0};tl.Object.defineProperties(Rf.prototype,{Kt:{configurable:!0,enumerable:!0,get:function(){return"PopulatePivotTableContextMenu"}},VA:{configurable:!0,enumerable:!0,get:function(){return If.a.uIf}}});
Object(sd.a)(Rf,"PivotTableContextMenu",fh.a,[]);be.prototype.compare=function(e,C){return(e||"").localeCompare(C||"",void 0,{numeric:!0,sensitivity:"accent"})};Object(sd.a)(be,"DigitsAsNumberComparer",null,[620]);var Rh=b(257),Kh=fh.a;vm(Ff,Kh);Ff.prototype.executeCommand=function(e,C,M){e=C.command;switch(e){case 639960842:this.applyTableFieldList(M);this.aW.Uca();break;case -1085236154:M=String.format("TableFieldListContextMenu:TableFieldListContextMenuClose, ColWithEntities, {0}",this.owd);Dd.ULS.sendTraceTag(537166999,
0,50,M);this.aW.Uca();break;case 1833782813:this.aW.showCallout();break;default:return sg.a(e)}return Fg.Task.Ta(!0)};Ff.prototype.applyTableFieldList=function(e){var C=e.MenuItemId.toString();kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5239502_UpdatePulloutFieldNameContainingSplChars")&&(C=C.replace("'","''"),C=C.replace("[","'["),C=C.replace("]","']"));var M=Object(qc.a)(String,e.SourceControlId),qa={};qa.PulloutField=C;qa.PulloutCardPath=e.SourceCardKeyPath;qa.PulloutCardSourceRow=e.SourceCardRow;
qa.PulloutCardSourceColumn=e.SourceCardColumn;if(this.aW.KM){Dd.ULS.sendTraceTag(38887748,0,50,"Table Pullout operation started");qa.ParameterType=2;e=e.ColumnIndex;if(void 0===e||null===e){if(void 0===M||null===M){Dd.ULS.shipAssertTag(537166998,0,!1,"TableFieldListContextMenu: ApplyTableFieldList, must specifiy ColumnIndex or SourceControlId");return}e=parseInt(M.substring(20+C.length+1,M.length));if(isNaN(e)){C=String.format("TableFieldListContextMenu:ApplyTableFieldListMalformatHTMLAttribute, Attribute, {0}",
M);Dd.ULS.shipAssertTag(537166997,0,!1,C);return}}qa.PulloutRichColumnSourceIndex=e;if(this.ETb.uDg){this.iEg(C,qa);return}}else Dd.ULS.sendTraceTag(38887749,0,50,"Grid Pullout operation started"),qa.ParameterType=4,M=this.aW.selectedRange.right,void 0!==qa.PulloutCardSourceColumn&&null!==qa.PulloutCardSourceColumn&&(M=qa.PulloutCardSourceColumn+1),qa.PulloutRichColumnSourceIndex=M;this.YLd(C,qa)};Ff.prototype.YLd=function(e,C,M){M=void 0===M?0:M;var qa=String.format("TableFieldListContextMenu:ApplyTableFieldList, ColWithEntities, {0}, SelectedColumnIndex, {1}",
this.owd,C.PulloutRichColumnSourceIndex);Dd.ULS.sendTraceTag(537166996,0,50,qa);String.format("TableFieldListContextMenu:ApplyTableFieldList, richValueParameterType, {0}, PulloutRichColumnSourceIndex, {1}",C.ParameterType,C.PulloutRichColumnSourceIndex);e=Object.assign(new Rh.a,{Text:e});this.grid.setCell(e,this.aW.zxa,0,127,C,M);this.grid.focus();this.x3b=null;this.aW.Uca();this.aW.O9i()};Ff.prototype.Gc=function(e,C,M){if(e=this.$.isEditMode&&kd.EwaSettings.la(135)&&!!this.aW)switch(C.command){case -1085236154:break;
case 639960842:e=!!M;break;case 1833782813:e=this.aW.Nva&&this.aW.Fzb;break;default:e=!1}return e};Ff.prototype.VN=function(e,C,M){this.$.isEditMode&&(this.x3b=this.LAh(Object(qc.a)(590,M)),Kh.prototype.VN.call(this,e,C,null,null,!1))};Ff.prototype.zY=function(){return this.x3b};Ff.prototype.M1c=function(e){if(!this.aW||!e||!e.Tk)return Dd.ULS.shipAssertTag(537166994,0,!!this.aW,"TableFieldListContextMenu:CreateContextMenuItemList PulloutManager null"),Dd.ULS.shipAssertTag(537166993,0,!!e,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager null"),
e&&Dd.ULS.shipAssertTag(537166992,0,!!e.Tk,"TableFieldListContextMenu:CreateContextMenuItemList fieldInfoManager.FieldInfoListContextList null"),null;var C=new lc.a;e=yl(e.Tk);for(var M=e.next();!M.done;M=e.next()){var qa=M.value;M=new lc.a;M.add(qa.ColumnName);M.add(qa.ColumnIndex.toString());var Na=new lc.a,Hb=null;Hb=kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5860557_CompareDigitsAsNumberRichDataProperties")?new be:new zf;Na=ha.OBc(ha.concat(Na,ha.select(ha.asEnumerable(qa.FieldInfoDataList),
function(Gc){return Gc.Name})),function(Gc){return Gc},Hb);qa=new lc.a;qa.add(ha.toArray(ha.concat(M,Na)));C=ha.toList(ha.concat(C,qa))}return ha.toArray(C)};Ff.prototype.LAh=function(e){var C=this.M1c(e);if(!C||!C.length)return this.x3b=null;var M=this.Sa;e=M.Lc();var qa=1<C.length;this.owd=C.length;C=yl(C);for(var Na=C.next();!Na.done;Na=C.next()){var Hb=Na.value;qa||(e.title=Hb[0]);Na=M.Lc();for(var Gc=2,gd=Hb.length;Gc<gd;++Gc)Array.add(qa?Na.buttons:e.buttons,M.TGa("ApplyTableFieldList."+Hb[Gc]+
"."+Hb[1],Hb[Gc],639960842,null,"None",Hb[Gc],!1,void 0,!0));qa&&(Hb=M.Kv("ApplyTableFieldList."+Hb[0],this.menuId,Hb[0],798637440),Array.add(Hb.menu.yc,Na),Array.add(e.buttons,Hb))}M=M.zp(this.menuId);Array.add(M.yc,e);return M};Ff.prototype.iEg=function(e,C){var M=this,qa=oh.a.jd(12,1,0,878,0,2007340793,"RichValuePulloutIntoNonEmptyRange");if(kd.EwaSettings.az()){var Na=new Jg.a(this.$,qa);Na.$O(function(){2===Na.returnValue&&M.YLd(e,C,8)})}else{var Hb=new Oh.ErrorDialog(this.$,qa);Hb.$O(function(){2===
Hb.returnValue&&M.YLd(e,C,8)});Hb.mf()}};tl.Object.defineProperties(Ff.prototype,{Kt:{configurable:!0,enumerable:!0,get:function(){return"PopulateTableFieldListContextMenu"}},VA:{configurable:!0,enumerable:!0,get:function(){return If.a.wIf}},aW:{configurable:!0,enumerable:!0,get:function(){this.ETb||(this.ETb=this.$.da.Aa(261));return this.ETb}}});Object(sd.a)(Ff,"PulloutFieldListContextMenu",fh.a,[]);var Yg=fh.a;vm(ng,Yg);ng.prototype.Gc=function(e,C,M){return-1687037502===C.command&&!!M&&this.grid.isEditing};
ng.prototype.executeCommand=function(e,C,M){this.showRichTextFloatie(M);return Fg.Task.Ta(!0)};ng.prototype.BJa=function(){return[ea.a.vRg]};ng.prototype.showRichTextFloatie=function(e){var C=Object(qc.a)(aa.a,e.eventArgs);C&&(e=this.BJa(C.zb),C=new Sys.UI.Point(C.Ea.clientX,C.Ea.clientY),this.showFloatie(e,new Sys.UI.Bounds(C.x,C.y,0,0),2))};tl.Object.defineProperties(ng.prototype,{Kt:{configurable:!0,enumerable:!0,get:function(){return"PopulateRichTextContextMenu"}},VA:{configurable:!0,enumerable:!0,
get:function(){return If.a.QYi}}});Object(sd.a)(ng,"RichTextContextMenu",fh.a,[]);var ji=b(95),Di=fh.a;vm(Zf,Di);Zf.prototype.executeCommand=function(e,C,M){if(fc.a(this.$))return Fg.Task.Ta(!0);this.$.isEditMode&&(e=M[If.a.oYf],e=e.x&&e.y?new Sys.UI.Point(e.x+(this.$.isChromeRtl?10:-10),e.y):Le.DOMElementExtensions.getLocation(M[If.a.pYf]),this.so(e,!1));return Fg.Task.Ta(!0)};Zf.prototype.Gc=function(e,C,M){return-1075099431===C.command&&!!M};Zf.prototype.zY=function(){var e=this.Sa.zp(this.menuId),
C=this.$.isEditMode;this.mLj();this.xAh(e,C);this.nAh(e);this.pBh(e);return e};Zf.prototype.lXb=function(e,C,M,qa){Array.add(e,this.Sa.yb(C?M:qa))};Zf.prototype.xAh=function(e,C){var M=this.Sa,qa=M.Lc();Array.add(qa.buttons,M.yb(54));this.lXb(qa.buttons,this.tgc,127,56);Array.add(qa.buttons,M.yb(55));C&&this.lXb(qa.buttons,this.tgc,126,125);Array.add(qa.buttons,M.yb(158));this.$.fa.aJb&&(C=Object(qc.a)(ji.a,this.$.oa))&&ih.q(C)&&this.$.isEditMode&&(Array.add(qa.buttons,M.yb(277)),C.isLockPausedInSession?
Array.add(qa.buttons,M.yb(279)):C.ik&&Array.add(qa.buttons,M.yb(278)));C=M.Kv("ContextMenu.TabColor",null,fe.a.instance.ea(508),1841703919);M=M.I1c(467002767,1549407384,531,-221093529,this.VA);Array.add(C.menu.yc,M);Array.add(qa.buttons,C);Array.add(e.yc,qa)};Zf.prototype.nAh=function(e){var C=this.Sa.Lc();this.lXb(C.buttons,this.tgc,114,112);this.lXb(C.buttons,!this.Vec,115,113);Array.add(e.yc,C)};Zf.prototype.pBh=function(e){if(kd.EwaSettings.la(501)&&!ih.e(this.$.xa.oa)){var C=this.Sa,M=C.Lc();
Array.add(M.buttons,C.yb(263));Array.add(e.yc,M)}};Zf.prototype.mLj=function(){var e=this.$.o1c();var C=e.p1c;e=e.aAe;this.tgc=1===C;this.Vec=0<e};tl.Object.defineProperties(Zf.prototype,{Kt:{configurable:!0,enumerable:!0,get:function(){return"PopulateSheetOpsContextMenu"}},VA:{configurable:!0,enumerable:!0,get:function(){return If.a.yIf}}});Object(sd.a)(Zf,"SheetOpsContextMenu",fh.a,[]);var Ei=b(523),rh=fh.a;vm(Ng,rh);Ng.prototype.Xc=function(e,C){var M=!0;switch(C){case -231711729:M=!1;break;case -1909381757:M=
this.Bac();M=!!M&&M.zai;break;case 1312363469:M=kd.EwaSettings.la(466)}return!M||rh.prototype.Xc.call(this,e,C)};Ng.prototype.executeCommand=function(e,C,M){if(!this.$.isEditMode)return wf.TaskExtensions.g4();e=C.command;C=this.Bac();var qa=null;switch(e){case 2108047455:C&&C.Awe();break;case -231711729:Dd.ULS.shipAssertTag(537166990,0,!1,"Shouldn't be hitting Slicer Refresh - NYI");break;case -1909381757:C&&C.U0b();break;case 1312363469:this.showSlicerContextMenu(M);break;default:qa=sg.a(e)}return qa||
wf.TaskExtensions.g4()};Ng.prototype.Gc=function(e,C,M){e=!1;switch(C.command){case -231711729:case 2108047455:case -1909381757:e=!0;break;case 1312363469:e=kd.EwaSettings.la(466)&&!!M}return e};Ng.prototype.zY=function(){var e=this.Sa.zp(this.menuId),C=this.Sa.Lc();Array.add(C.buttons,this.Sa.yb(252));kd.EwaSettings.la(504)&&Array.add(C.buttons,this.Sa.yb(253));Array.add(C.buttons,this.Sa.yb(254));Array.add(e.yc,C);C=this.Sa.Lc();this.Bfi()?Array.add(C.buttons,this.Sa.yb(266)):Array.add(C.buttons,
this.Sa.yb(267));Array.add(e.yc,C);return e};Ng.prototype.Bfi=function(){if(fg.a.Gd(this.$)){var e=this.$.da.Aa(439);if(e)return e.Hr}else if(e=this.$.da.Aa(371))return e.Hr;return!1};Ng.prototype.showSlicerContextMenu=function(e){var C=Object(qc.a)(aa.a,e.eventArgs);e=this.W9b(Object(qc.a)(aa.a,e.eventArgs));C=C.zb;eg.a.Wb=C;this.so(e,!1,C)};Ng.prototype.sTe=function(e){var C=this.Sa.Lc(),M=this.Sa.Lc();Array.add(M.buttons,this.Sa.yb(255));Array.add(M.buttons,this.Sa.yb(256));var qa=this.Sa.O1c("ContextMenu.SlicerSort",
null,fe.a.instance.ea(2108),-814639094,0,pc.a.fMe);Array.add(qa.menu.yc,M);Array.add(C.buttons,qa);Array.add(e.yc,C)};Ng.prototype.Fqj=function(e){return kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5103035_SlicerCornerResizePointContextMenuUseOnlyClientPoint")&&e.Sb.className===pc.a.HLe||kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5185773_SlicerShortcutContextMenuSkipFramePoint")&&1===e.zb};Ng.prototype.W9b=function(e){var C=Ye.g(this.$).ha.Qa.nc,M=e&&1!==e.zb&&e.clientPoint?e.clientPoint:Sys.UI.DomElement.getLocation(C.domElement);
if(this.Fqj(e)){var qa=this.Bac();qa&&(e.Sb.className===pc.a.HLe&&(M=ab.HelperMethods.Etb(e.Ea)),1===e.zb&&(M=xe.a(this.$).OJa(Le.DOMElementExtensions.getLocation(qa.frame))))}else if(e=this.Bac())e=this.EJh(e.frame),(qa=ab.HelperMethods.sA(this.$.Ue,this.$.domElement,Ye.g(this.$).rtl,!1))?(e.x=xe.a(this.$).Fi(e.x-qa.x)+qa.x,e.y=xe.a(this.$).Fi(e.y-qa.y)+qa.y):Dd.ULS.sendTraceTag(537166989,0,15,"Cannot get constant pane size."),M.y+=e.y,M.x+=e.x;e=this.$.domElement;qa=Ye.g(this.$).rtl;C=ab.HelperMethods.sA(C.Bg.domElement,
e,qa);M.y=Math.max(M.y,C.y);M.x=Math.max(M.x,C.x);return M};Ng.prototype.Bac=function(){var e=Ye.g(this.$).ha.Qa.nc;Dd.ULS.shipAssertTag(537166988,0,!!e);return Ei.a(this.$).lC(e.floatingObject.id)};Ng.prototype.EJh=function(e){var C=new Sys.UI.Point(e.offsetParent.offsetLeft,e.offsetParent.offsetTop),M=Ye.g(this.$);if(!M)return C;var qa=Ye.g(this.$).rtl;C=ab.HelperMethods.sA(e,this.$.Oq.ownerDocument.body,qa);M.Rze(C);C.x=qa?this.$.Oq.clientWidth-C.x-e.clientWidth:C.x;e=M.view.Rnb;M=qa?-M.FN.Gba(e.x):
e.x;C.x-=M;C.y-=e.y;return C};tl.Object.defineProperties(Ng.prototype,{Kt:{configurable:!0,enumerable:!0,get:function(){return"PopulateSlicerContextMenu"}},VA:{configurable:!0,enumerable:!0,get:function(){return If.a.zIf}}});Object(sd.a)(Ng,"SlicerContextMenu",fh.a,[]);Object(sd.a)(Ie,"TimeSlicerRibbonButtonParameter",null,[]);var Sd=fh.a;vm(cg,Sd);cg.prototype.executeCommand=function(e,C,M){e=C.command;switch(e){case 2000085697:e=M.DOMElement;this.Tra=M.ChangeLevelCallback;this.IJa=M.GetLevelLabelCallback;
this.L_a=M.CurrentLevel;var qa=M.DomEvent;ch.g(qa);var Na=M.location;M=M.levelLabelText;this.sHe=Le.DOMElementExtensions.Yy(document.activeElement,"iframe")&&M?M.parentNode:null;M=Sys.UI.DomElement.getBounds(M);M.x=Na.x;M.y=Na.y;this.VN(qa,e,M,C,!0);break;case -649826274:this.Tra(0);break;case 149600865:this.Tra(1);break;case -2012435159:this.Tra(2);break;case -1979934975:this.Tra(3);break;case 1634477200:Le.DOMElementExtensions.setFocus(this.sHe);break;default:return sg.a(e)}return Fg.Task.Ta(!0)};
cg.prototype.Gc=function(e,C,M){e=!1;switch(C.command){case 2000085697:e=!!M;break;case -649826274:case 149600865:case -2012435159:case -1979934975:case 1634477200:e=!0}return e};cg.prototype.VN=function(e,C,M){e=Sys.UI.DomElement.getBounds(C);M.x=xe.a(this.$).Fi(M.x);M.y=xe.a(this.$).Fi(M.y);e.x=xe.a(this.$).Fi(e.x);e.y=xe.a(this.$).Fi(e.y);e=new Sys.UI.Point(e.x+M.x,e.y+M.y);this.ISa(e,C);this.showContextMenu(new Sys.UI.Bounds(e.x,e.y-M.height,M.width,M.height))};cg.prototype.zY=function(){for(var e=
this.Sa,C=e.zp(this.menuId),M=e.Lc(),qa=0;3>=qa;qa++){var Na=this.IJa(qa),Hb=cg.dEh(qa);Hb=e.B_g(Hb.FYg,Hb.$o,this.L_a===qa,cg.Fve);Hb.label=Na;Hb.DR(Na);this.L_a===qa?Hb.GR("Image16by16",8,cg.Fve):Hb.M0b();Array.add(M.buttons,Hb)}Array.add(C.yc,M);return C};cg.dEh=function(e){var C=null;switch(e){case 0:C=new Ie(87,"ContextMenu.TimeSlicerLevelYear",-649826274);break;case 1:C=new Ie(88,"ContextMenu.TimeSlicerLevelQuater",149600865);break;case 2:C=new Ie(89,"ContextMenu.TimeSlicerLevelMonth",-2012435159);
break;case 3:C=new Ie(90,"ContextMenu.TimeSlicerLevelDay",-1979934975)}return C};tl.Object.defineProperties(cg.prototype,{Kt:{configurable:!0,enumerable:!0,get:function(){return"PopulateTimeSlicerLevelMenu"}},VA:{configurable:!0,enumerable:!0,get:function(){return If.a.CIf}}});cg.VBj="TimeSlicerLevelMenu";cg.bHb="TimeSlicerLevelMenuRootName";cg.Fve="ewamenu_CheckmarkApplied";Object(sd.a)(cg,"TimeSlicerLevelMenu",fh.a,[]);var Bj=b(307),Sf=b(222),X=b(3),ua=cf.a;vm(rg,ua);rg.prototype.Md=function(){var e=
this,C=this.$,M=Sf.a.E_a(pd.b(),this.ma,"Task","IRootUser"),qa=yh.a(C),Na=null;Na=function(gd,Uc){qa.LMf(Na);M.setResult(Uc.e2b)};qa.lle(Na);qa.XYe();var Hb=td.GetServiceTaskFactory.create(C.da,102,C.ma,this.tb),Gc=td.GetServiceTaskFactory.Xa(C.da,342,338,this.tb);wf.TaskExtensions.Ba(wf.TaskExtensions.ve([M.task,Hb,Gc],this.ma),function(){var gd=Hb.result,Uc=M.task.result,Wd=Gc.result;e.Ed([new Bd(C,Uc,gd,Wd),new mf(C,Uc,gd,Wd),new Og(C,Uc,gd,Wd),new te(C,Uc,gd,Wd),new Ze(C,Uc,gd,Wd),new bg(C,Uc,
gd,Wd),new he.GridContextMenu(C,Uc,gd,Wd),new Re(C,Uc,gd,Wd),new Zf(C,Uc,gd,Wd),new cg(C,Uc,gd,Wd),new Ff(C,Uc,gd,Wd),new Wf(C,Uc,gd,Wd),new Rf(C,Uc,gd,Wd),new Ng(C,Uc,gd,Wd),new ng(C,Uc,gd,Wd)])},C.ma,3)};rg.initData=function(){var e=Bj.a.a2;e(2000085697,20479,0,0);e(-227942804,X.a.Jc|24576,0,0);e(1634477200,X.a.Jc|131072,0,0);e(-649826274,4095,0,0);e(149600865,4095,0,0);e(-2012435159,4095,0,0);e(-1979934975,4095,0,0);e(1247109494,X.a.Jc|24576,0,0);e(-2064931494,X.a.Jc|131072,0,0);e(-1396319072,
X.a.Ja,128,0);e(-425234874,X.a.Ja,128,0);e(-1253126584,X.a.Ja,0,0);e(274207288,X.a.Jc|24576,0,0);e(-1497523576,X.a.Jc|131072,0,0);e(-498523270,X.a.Jc|24576,64,0);e(1640762262,X.a.Jc|131072,64,0);e(-2017893763,X.a.Jc|24576,0,0);e(1350204367,X.a.Jc|131072,0,0);e(-889576107,X.a.Gv,128,0);e(-1170196828,X.a.Gv,128,0);e(389774337,X.a.Gv,128,0);e(1529312473,X.a.Gv,128,0);e(2033235475,X.a.Gv,128,0);e(-96230454,X.a.Gv,128,0);e(74086617,X.a.Gv,128,0);e(563292088,X.a.Gv,128,0);e(-1092351914,X.a.Gv,128,0);e(-2141589616,
X.a.Gv|16384,128,0);e(745182485,X.a.Gv,0,0);e(359279088,X.a.Gv,128,0);e(-67292059,X.a.Gv,128,0);e(926905850,X.a.Gv,128,0);e(547535945,X.a.Gv,128,0);e(1374696078,X.a.Jc|24576,0,0);e(495005930,X.a.Jc|212992,0,0);e(-1045020714,X.a.Jc|24576,0,0);e(-170383950,X.a.Jc|212992,0,0);e(324156914,X.a.Ja,0,0);e(-1085236154,X.a.mu,0,0);e(-751848458,X.a.il|16384,0,0);e(216058793,X.a.mu,0,0);e(474690375,X.a.il|16384,0,0);e(-1920954846,X.a.Jc|24576,0,0);e(723126814,X.a.Jc|131072,0,0);e(2108047455,128,128,0);e(-231711729,
128,128,0);e(-1909381757,128,128,0);e(-814639094,128,128,0);e(1701016594,X.a.Jc|3072,128,0);e(-1475408662,X.a.Jc|24576,0,0);e(1114549926,X.a.Jc|131072,32,0)};rg.ja=function(e){cf.a.de(10,new rg(e))};Object(sd.a)(rg,"ContextMenuCommandHandlerFactory",cf.a,[]);var vb=b(216),Rb=b(1372),Fc=b(97),kc=b(250);af.prototype.dispose=function(){};af.prototype.u$=function(){this.Hpb.j3()};af.prototype.bC=function(){this.Hpb.bC()};af.prototype.$Od=function(e,C,M){hf.h(this.$,hf.b);this.Hpb.showContextMenu(Object.assign(new Rb.a,
{x:C.x,y:C.y}),M,e);Fc.EventHandlerManager.instance.Q$c()};af.prototype.Kvc=function(e,C,M){hf.h(this.$,hf.b);this.Hpb.showFloatie(Object.assign(new Rb.a,{x:C.x,y:C.y}),e,M);kc.a(function(){Fc.EventHandlerManager.instance.Q$c()},this.$.ma)};af.prototype.ZOd=function(e,C,M,qa){hf.h(this.$,hf.b);this.Hpb.ZOd(Object.assign(new Rb.a,{x:C.x,y:C.y}),e,M,qa)};Object(sd.a)(af,"ReactContextMenuController",null,[584,3]);var Id=vb.a;vm(dg,Id);dg.prototype.dispose=function(){this.I7e&&this.$&&this.$.fa.hr(this.rjd);
Id.prototype.dispose.call(this)};dg.prototype.create=function(){this.$.fa.Mh?(Dd.ULS.sendTraceTag(537167065,0,50,"ContextMenuControllerFactory.InitReactUISurfacesAndRegisterControllerIfNeeded: GFI = {0}",this.$.fa.Mh),this.rjd(null,null)):(this.I7e=!0,this.$.fa.sn(this.rjd))};dg.ja=function(e){e.da.Ha(338,new dg(e))};Object(sd.a)(dg,"ContextMenuControllerFactory",vb.a,[]);var ie=b(158);Object(sd.a)(og,"RibbonCommandParams",null,[]);Object(sd.a)(gg,"HeaderSnappedAutoFilterMenuCacheEntry",null,[]);
Df.prototype.oEh=function(e){return(e=this.Vbc[e.toString()])?e.menuModel:null};Df.prototype.Mse=function(e,C){this.Vbc[C.toString()]=Object.assign(new gg,{menuModel:e,zCe:ab.HelperMethods.jc()})};Df.prototype.qrb=function(e){this.Vbc[e.toString()]=null};Df.prototype.gTh=function(e){return(e=this.Vbc[e.toString()])?e.zCe:-1};Object(sd.a)(Df,"FilterMenuCache",null,[]);var Ve=b(12),Dg=b(207),Mg=b(276);Object(sd.a)($e,"AutoFilterEventRegistrationArgs",null,[]);var Ug=b(24);me.prototype.dispose=function(){window.cancelAnimationFrame(this.Gzb);
this.gridView&&this.gridView.Gqc(this.mCb);this.gridView=null};me.prototype.L2h=function(){if(this.tOd=ab.HelperMethods.B5a)this.AYa=[];this.Fxg();this.gridView.HXb(this.mCb)};me.prototype.Fxg=function(){for(var e=yl(this.gridView.jn),C=e.next();!C.done;C=e.next()){C=C.value.nBa;for(var M in C){var qa=C[M];this.XGf(qa.domElement,qa.hashCode)}}};me.prototype.XGf=function(e,C){if(Ye.g(this.$).Ca.Hl.u0a(C))if(e){e=e.querySelectorAll('[id^="'+If.a.I9c+'"]');for(var M=0;M<e.length;M++){var qa=e[M],Na=
qa.getAttribute(If.a.Kuh),Hb=qa.getAttribute(If.a.Duh);Dd.ULS.shipAssertTag(537167053,0,!!Na&&!!Hb,"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Row and Column attributes should exist in AF input element. AutoFilterId: {0}, BlockHash: {1}",qa.id,C);Na=Ug.Range.ld(parseInt(Na),parseInt(Hb));qa=Object.assign(new $e,{cell:Na,qqe:qa,Xd:C});this.tOd?(this.AYa.push(qa),this.Gzb||(this.MJe=window.performance.now(),this.Gzb=window.requestAnimationFrame(this.wKf))):this.Fje(qa)}}else Dd.ULS.sendTraceTag(537167054,
0,50,"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block DOM element is null. BlockHash: {0}",C);else Dd.ULS.sendTraceTag(537167055,0,50,"FilterMenuManager.QueuePointerHandlerRegistrationsToFiltersInBlock: Block model does not exist yet. Handlers will be added when block is rendered. BlockHash: {0}",C)};me.prototype.Fje=function(e){var C=this.gridView.Ca.nub(e.cell,e.Xd);C?this.Exg(e.qqe,C):Dd.ULS.sendTraceTag(537167050,1,10,"FilterMenuManager.AddPointerHandlersToAutoFilterInCell: GetModelCellFromRange returned null. BlockHash: {0}, AutoFilter Cell: {1}",
e.Xd,e.cell)};me.prototype.Exg=function(e,C){C.hasAutoFilter?this.Jvg(e,C.H9c):C.o4?this.Cxg(e,C.H9c,C.wcf):Dd.ULS.sendTraceTag(537167049,1,50,"FilterMenuManager.AddPointerEventHandlersToAutoFilter: Cell must have either AutoFilter or PivotFilter if reached here!");ie.a.instance.pa(Ve.a.Ff,e,this.onPointerDown);Dg.a.instance.pa(Ve.a.txa,e,this.onPointerDown)};me.prototype.Jvg=function(e,C){Mg.a.instance.pa(Ve.a.click,e,function(M){C&&pg.a.hrc(M.Ea.rawEvent,966232027,C,null);return kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5465680_FixForAutoFilterClickHandlers")?
!0:!1})};me.prototype.Cxg=function(e,C,M){var qa=xi.a.li(C);Mg.a.instance.pa(Ve.a.click,e,function(Na){M?pg.a.spf(document.getElementById(qa.EwaElementId),qa.Cell,qa.DataSourceIndex,qa.FieldId,qa.IsOlap,qa.RequiresConfirmation,Na.Ea.rawEvent,qa.OptionalPivotMenuAnchor):pg.a.spfm(Na.Ea.rawEvent,qa.RequiresConfirmation,qa.Cell,qa.DataSourceIndex,qa.PivotName,qa.OptionalPivotMenuAnchor);return!1})};Object(sd.a)(me,"FilterMenuPointerEventsManager",null,[3]);Fd.prototype.dispose=function(){kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5858804_CanvasHitTest")&&
kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5035623_autofiltersHitTest")||this.cQe.dispose();this.$=null};Fd.prototype.pKh=function(e){var C=Ye.g(this.$).Ca.G9(e,this.$.activeItemName);return C&&C.blockPresentInViewportTimeStamp>this.nxa.gTh(e.left)?C.Ds(e).autoFilterMenu:this.nxa.oEh(e.left)};Fd.prototype.eFi=function(e,C,M){this.nxa&&(kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5663719_AutoFilterMenusForTablesWithSnappedHeadersAndGroupedColumnsMismatchBugFix")?this.nxa.Mse(e.menuModel[C],M):
this.nxa.Mse(e.menuModel[C],e.left+C))};Fd.prototype.fFi=function(e,C,M){this.nxa&&(kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5663719_AutoFilterMenusForTablesWithSnappedHeadersAndGroupedColumnsMismatchBugFix")?this.nxa.qrb(M):this.nxa.qrb(e.left+C))};Object(sd.a)(Fd,"FilterMenuManager",null,[583,3]);var $d=b(224),Se=b(173);ud.prototype.Mbd=function(e){return Tg.a.Ec(this.gwc,e)};ud.prototype.dispose=function(){this.Ld?Dd.ULS.sendTraceTag(537167062,1,50,"ContextMenuManager.Dispose: Dispose has been called more than once"):
(this.Ld=!0,this.$&&(this.$.ml(ud.od),this.$.da.gU(8),this.ha&&this.ha.zqc(this.Zk),this.$.Ka.X$a(this.wsf),kd.EwaSettings.isChangeGateEnabled("OfficeVSO:4728637_DissmissContextualUIFromContextMenuManager")&&this.$.Ka&&this.$.Ka.S$a(this.Jxa),kd.EwaSettings.isChangeGateEnabled("OfficeVSO:4932179_RemoveControllerRecreationOnModeSwitch")||this.$.fa.w6(this.J5)),this.$=this.ha=null,this.Q7b.dispose(),this.gwc=this.J3d=null)};ud.prototype.showContextMenu=function(e,C,M){C=void 0===C?null:C;M=void 0===
M?null:M;this.lqj(e)&&(hf.h(this.$,hf.i),e=this.L0g(e,C,M),this.$.Ka.Zb(e.ee,e.dictionary))};ud.prototype.j3=function(){this.contextMenuController?this.contextMenuController.u$():Dd.ULS.sendTraceTag(537167061,1,10,"ContextMenuManager.DismissContextualUI: Context menu controller is null.")};ud.prototype.lqj=function(e){return Qi.a(this.$).sq()?(Dd.ULS.sendTraceTag(537167060,1,50,"ContextMenuManager.OnContextMenu: Ignoring ContextMenu event because it is not allowed in partial interactivity mode"),
Qi.a(this.$).D_(Se.a.grid,$d.a.showContextMenu),!1):!this.$.Ka.fsh&&(!e||e.Sb!==Ye.g(this.$).domElement&&!K.a.equals(e.Sb.tagName,"INPUT",!0))};ud.prototype.L0g=function(e,C,M){C=void 0===C?null:C;var qa={};M=(qa.eventArgs=e,qa.creationParams=void 0===M?null:M,qa);e=e?e.zb:-1;qa=this.ha.Qa.nc;var Na=1441131127;qa?(C=qa.floatingObject,Dd.ULS.shipAssertTag(537167059,0,!!C,"floatingObj shouldn't be null."),ud.Dod(C)?Na=1312363469:ud.isPivotChart(C)?(M[mf.WYc]=C?C.Yc:null,Na=-149612405):Na=-1372040782):
ud.vcf(C)?(M[mf.WYc]=C,Na=-149612405):!hf.g(this.$)&&hf.f(Ye.g(this.$))&&(Na=671488277);C=new Bf.a(Na,e,this.$.ed,30,null);return Object.assign(new og,{ee:C,dictionary:M})};ud.ja=function(e){e.Rk(ud.od)};ud.isPivotChart=function(e){return!!e&&!e.type&&ud.vcf(e.Yc)};ud.Dod=function(e){return!!e&&2===e.type};ud.vcf=function(e){return!!e&&!!(e.Attributes&4)};tl.Object.defineProperties(ud.prototype,{Q7b:{configurable:!0,enumerable:!0,get:function(){return this.J3d}}});ud.GYg="autoFilter chart fieldList fieldListPivotFilter fieldWell floatingObject grid pivotFilter sheetOps timeSlicerLevel tableFieldList autoFilterRichFieldList slicer richText".split(" ");
ud.NVh="GridContextMenu";ud.od=function(e){(e=Object(qc.a)(8,e))&&td.GetServiceTaskFactory.create(e.da,9,e.ma,0)};Object(sd.a)(ud,"ContextMenuManager",null,[550,3]);var Ri=vb.a;vm(Zc,Ri);Zc.prototype.create=function(){var e=this,C=this.$,M=C.lc;if(M.allowSelection||M.allowEdits||M.allowFiltering||M.allowSorting||M.allowPivotSpecificOperations){var qa=td.GetServiceTaskFactory.create(C.da,10,C.ma,this.tb),Na=td.GetServiceTaskFactory.Xa(C.da,342,338,this.tb);wf.TaskExtensions.Ba(wf.TaskExtensions.ve([qa,
Na],this.ma),function(){e.Fb(eh.a(C)||new ud(C,qa.result,Na.result))},this.$.ma,3)}else Dd.ULS.sendTraceTag(537167058,0,15,"ContextMenuManagerFactory.Create: no client permissions to allow creating ConetxtMenuManager. Returning null."),C.da.gU(8),this.Fb(null)};Zc.ja=function(e){e.da.Ha(9,new Zc(e))};Object(sd.a)(Zc,"ContextMenuManagerFactory",vb.a,[]);le.prototype.isEqual=function(e){return e?this.K4===e.K4&&this.L4===e.L4&&this.nN===e.nN&&this.oN===e.oN&&this.$A===e.$A&&this.ruleType===e.ruleType&&
this.wZ===e.wZ&&this.mT===e.mT&&this.lT===e.lT&&this.dV===e.dV&&this.yE===e.yE&&this.X4===e.X4&&this.Y4===e.Y4:(Dd.ULS.shipAssertTag(537163233,0,!1,"DataValidationEditDialogState.IsEqual: State should not be Null"),!1)};Object(sd.a)(le,"DataValidationEditDialogState",null,[]);$c.prototype.Xc=function(){return!1};$c.prototype.executeCommand=function(e,C){-1728432249!==C.command&&sg.a(C.command);this.selectedRanges=jg.r(Ye.g(this.$).ha.va.selectedRanges,this.$);Ye.g(this.$).k0(!0);this.getDataValidationInitialState();
this.ah=this.$.Ub.Fc("UserAction","DataValidationEditTimeToDialogOpen");this.cHe?Dd.ULS.sendTraceTag(537163285,0,50,"Open data validation edit dialog - NOT first time in session"):(Dd.ULS.sendTraceTag(23667778,0,50,"Open data validation edit dialog - FIRST time in session"),this.cHe=!0);return Fg.Task.Ta(!0)};$c.prototype.Gc=function(e,C){return-1728432249===C.command};$c.prototype.fd=function(){return!1};$c.prototype.getDataValidationInitialState=function(){var e=this,C=this.$.qa.ta.Xb();wg.a(this.$.userOperationManager,
function(M,qa,Na){return vf.u(e.$.qa.ta,e.selectedRanges,lh.b(M,e.zDi),lh.a(qa),Na,C)},function(M){return new mg.a(120,0,M,16)},null)};$c.prototype.ATi=function(){var e=this.iB={};switch(this.X_a.Command){case 0:var C="CreateNew";break;case 1:C="CreateNewFromRule";break;case 2:C="ExpandExisitng";break;case 3:C="OverrideExisitng";break;default:C="Unknown"}e.a=C;this.ah&&(this.ah.stop(),this.iB.r=this.ah.id);switch(this.X_a.Command){case 0:this.iB.b=!1;this.iB.c="None";this.UGa(new le);break;case 1:this.iB.b=
!1;this.iB.c="None";this.UGa(new le(this.X_a));break;case 2:this.iB.b=!0;this.K3c.K_g(this.$,this.nsh);break;case 3:this.iB.b=!0;this.K3c.M_g(this.$,this.DOi);break;default:Dd.ULS.sendTraceTag(537163282,0,10,"DataValidationEditCommandHandler.PrepareUserDialog, unexpected command type.")}};$c.prototype.UGa=function(e){this.K3c.UGa(this.$,this.selectedRanges,e,this.X_a.Command);this.Noi(e)};$c.prototype.Noi=function(e){$c.Rqb(e,this.iB);this.iB.d=!0;pd.b().Ne(48,this.iB,!0)};$c.prototype.xjf=function(){this.iB.d=
!1;pd.b().Ne(48,this.iB,!0)};$c.prototype.oW=function(e,C){var M={};e=(M.ButtonType=$c.Rha(C),M.DialogName=e,M.Location="dialog",M.NumberOfSelectedRanges=Ye.g(this.$).ha.va.nK,M);Th.b(this.$).ae(ra.a.A4b,e)};$c.Rqb=function(e,C){C.e=we(e.ruleType);C.f=jc(e.$A);C.g=!!e.nN;C.h=!!e.oN;C.i=e.K4;C.j=e.L4;C.k=e.Y4;C.l=!!e.yE;C.m=!!e.dV;C.n=e.X4;C.o=e.wZ;C.p=!!e.mT;C.q=!!e.lT};$c.Rha=function(e){switch(e){case 1:return"Yes";case 2:return"No";case 0:return"Cancel";default:return Dd.ULS.shipAssertTag(537163281,
0,!1,"DataValidationEditCommandHandler.DialogButtonToString: Unknown DialogButton"),"Unknown"}};Object(sd.a)($c,"DataValidationEditCommandHandler",null,[237]);var xj=b(973),kg;(function(e){e[e.between=0]="between";e[e.notBetween=1]="notBetween";e[e.equal=2]="equal";e[e.notEqual=3]="notEqual";e[e.greaterThan=4]="greaterThan";e[e.lessThan=5]="lessThan";e[e.greaterThanOrEqual=6]="greaterThanOrEqual";e[e.lessThanOrEqual=7]="lessThanOrEqual"})(kg||(kg={}));Object(sd.b)("DataValidationRuleConditionType",
kg);var Cj;(function(e){e[e.anyValue=0]="anyValue";e[e.wholeNumber=1]="wholeNumber";e[e.decimal=2]="decimal";e[e.list=3]="list";e[e.date=4]="date";e[e.time=5]="time";e[e.textLength=6]="textLength";e[e.custom=7]="custom"})(Cj||(Cj={}));Object(sd.b)("DataValidationRuleType",Cj);var sj=b(140),Gh=b(156);tl.Object.defineProperties(Sc,{xf:{configurable:!0,enumerable:!0,get:function(){return sj.a.jj(Sc.Tj,"")}},T$g:{configurable:!0,enumerable:!0,get:function(){return sj.a.jj(Sc.X$g,Gh.a.ea(1618),Gh.a.ea(1633),
Gh.a.ea(1634),Gh.a.ea(1635),Gh.a.ea(1636),Gh.a.ea(1637),Gh.a.ea(1638),Gh.a.ea(1639),Gh.a.ea(1640),Gh.a.ea(1619),Gh.a.ea(1643),Gh.a.ea(1644),Gh.a.ea(1645),Gh.a.ea(1646),Gh.a.ea(1647),Gh.a.ea(1648),Gh.a.ea(1649),Gh.a.ea(1650),Gh.a.ea(1620),Gh.a.ea(1621),Gh.a.ea(1641),Gh.a.ea(1642),Gh.a.ea(1632),"255")}},$$g:{configurable:!0,enumerable:!0,get:function(){return sj.a.jj(Sc.Y$g,Gh.a.ea(1655),Gh.a.ea(1659),Gh.a.ea(1660),"255","32")}},dah:{configurable:!0,enumerable:!0,get:function(){return sj.a.jj(Sc.Z$g,
Gh.a.ea(1654),Gh.a.ea(1657),Gh.a.ea(1656),Gh.a.ea(1658),Gh.a.ea(1659),Gh.a.ea(1660),"255","32")}}});Sc.S4f=255;Sc.Tj="<div class='WACDialogRow' id='dataValidationTabsId'> </div> <div class='DataValidationEditErrorMessage WACDialogRowNoBreak' id='ErrorContainer'> <label id='validationErrorMessageId' class='WACDialogLabel' role='alert' >{0}</label> </div>";Sc.X$g="<div class='DataValidationEditTabContent' id='ConditionDivID'> <div class='DataValidationRow' id='allowConditionRow'> <label id='allowConditionSelectionLabelId' class='DataValidationEditElementLabel' for='allowConditionSelectionId'>{0}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='allowConditionSelectionId'> <option value='0'>{1}</option> <option value='1'>{2}</option> <option value='2'>{3}</option> <option value='3'>{4}</option> <option value='4'>{5}</option> <option value='5'>{6}</option> <option value='6'>{7}</option> <option value='7'>{8}</option> </select> </div> <div class='DataValidationRow' id='operatorSelectionDivId'> <label id='operatorSelectionLabelId' class='DataValidationEditElementLabel' for='operatorSelectionId'>{9}</label> <select class='WACDialogList DataValidationEditElement DataValidationEditSelect' id='operatorSelectionId'> <option value='0'>{10}</option> <option value='1'>{11}</option> <option value='2'>{12}</option> <option value='3'>{13}</option> <option value='4'>{14}</option> <option value='5'>{15}</option> <option value='6'>{16}</option> <option value='7'>{17}</option> </select> </div> <div class='DataValidationRow' id='operatorInputDivId1'> <label id='operatorInputLableId1' class='DataValidationEditElementLabel' for='operatorInputId1'>{18}</label> <input type='text' id='operatorInputId1' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='operatorInputDivId2'> <label id='operatorInputLableId2' class='DataValidationEditElementLabel' for='operatorInputId2'>{19}</label> <input type='text' id='operatorInputId2' class='DataValidationEditElement DataValidationEditInput' spellcheck=\"false\" maxlength={23} autocomplete=\"off\"/> </div> <div class='DataValidationNonBorderRow' id='listDescriptionDivId'> <div id='listDescriptionDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='listDescriptionSubDivID'> <label id='listDescriptionLabelId' class='DataValidationEditLabel' for='listDescriptionSubDivID'>{20}</label> </div> </div> <div class='DataValidationNonBorderRow' id='ignoreBlankCheckboxDivID'> <div id='ignoreBlankCheckboxDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='ignoreBlankCheckboxSubDivID'> <input type='checkbox' id='ignoreBlankCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{21}'></input> <label id='\"\"' class='WACDialogLabel' for='ignoreBlankCheckBoxId' >{21}</label> </div> </div> <div class='DataValidationNonBorderRow' id='inCellDropdownDivId'> <div id='inCellDropdownDummyLabelId' class='DataValidationEditElementLabel'></div> <div class='DataValidationEditNoBorderElement' id='inCellDropdownSubDivId'> <input type='checkbox' id='inCellDropdownCheckboxId' class='WACDialogCheckBox DataValidationEditCheckBoxWithText' title='{22}'></input> <label id='\"\"' class='WACDialogLabel' for='inCellDropdownCheckboxId' >{22}</label> </div> </div> </div>";
Sc.Y$g="<div class='DataValidationEditTabContent' id='inputDivID'> <div class='DataValidationNonBorderRow' id='inputMessageCheckBoxDivID'> <label id='showInputCheckBoxLabelId' class='DataValidationEditElementLabel' for='showInputCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='inputMessageCheckBoxSubDivID'> <input type='checkbox' id='showInputCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='inputTitleDivID'> <label id='inputTitleLabelId' class='DataValidationEditElementLabel' for='textForInputTitleId'>{1}</label> <input type='text' id='textForInputTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={4} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='inputMessageDivID'> <label id='inputMessageLabelId' class='DataValidationEditElementLabel' for='textForInputMessageId'>{2}</label> <textarea id='textForInputMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={3} autocomplete=\"off\"></textarea> </div> </div>";
Sc.Z$g="<div class='DataValidationEditTabContent' id='alertDivID'> <div class='DataValidationNonBorderRow' id='showAlertCheckBoxDivID'> <label id='showAlertCheckBoxLabelId' class='DataValidationEditElementLabel' for='showAlertCheckBoxId'>{0}</label> <div class='DataValidationEditNoBorderElement' id='showAlertCheckBoxSubDivID'> <input type='checkbox' id='showAlertCheckBoxId' class='WACDialogCheckBox DataValidationEditCheckBoxNoText'></input> </div> </div> <div class='DataValidationRow' id='blockWarnRadioDivID'> <label id='blockWarnRadioLabelId' class='DataValidationEditElementLabel' for='blockWarnRadioSubDivID'>{1}</label> <div class='DataValidationEditRadio DataValidationEditNoBorderElement' id='blockWarnRadioSubDivID'> <input type='radio' id='blockingId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{2}' title='{2}'></input> <label id='blockingId' class='WACDialogLabel' for='blockingId' >{2}</label> <input type='radio' id='warningId' name='alertType' class='WACDialogRadio DataValidationEditRadio' alt='{3}' title='{3}'></input> <label id='blockingId' class='WACDialogLabel' for='warningId' >{3}</label> </div> </div> <div class='DataValidationRow' id='alertTitleDivID'> <label id='alertTitleLabelId' class='DataValidationEditElementLabel' for='textForAlertTitleId'>{4}</label> <input type='text' id='textForAlertTitleId' class='DataValidationEditElement DataValidationEditInput' maxlength={7} autocomplete=\"off\"/> </div> <div class='DataValidationRow' id='alertMessageDivID'> <label id='alertMessageLabelId' class='DataValidationEditElementLabel' for='textForAlertMessageId'>{5}</label> <textarea id='textForAlertMessageId' class='DataValidationEditElement DataValidationEditTextArea' maxlength={6} autocomplete=\"off\"></textarea> </div> </div>";
Object(sd.a)(Sc,"DataValidationEditDialogHtml",null,[]);var zh=b(576),Vh=ei.a;vm(Oc,Vh);Oc.prototype.Nza=function(e){this.nT.selectedIndex=e.ruleType;this.qK.selectedIndex=e.$A;this.Xcc.checked=e.L4;this.Ava.checked=e.K4;this.gya.value=e.nN;this.hya.value=e.oN;this.Sba(null)};Oc.prototype.job=function(e){e.K4=this.Ava.checked;e.L4=this.Xcc.checked;e.$A=this.qK.selectedIndex;e.ruleType=this.nT.selectedIndex;e.nN=this.gya.value;e.oN=this.hya.value};Oc.prototype.dispose=function(){this.mm();this.xk=
this.Xzd=this.cnc=this.oOa=this.c9a=this.KMa=this.p4a=this.Xcc=this.hya=this.gya=this.qK=this.nT=this.Ava=null;Vh.prototype.dispose.call(this)};Oc.prototype.render=function(e){e.appendChild(this.domElement)};Oc.prototype.oja=function(){return this.isVisible};Oc.prototype.Uma=function(e){return this.isVisible=e};Oc.prototype.setFocus=function(){};Oc.prototype.Vtb=function(e,C){return this.TYe(e,C,this.nwh)};Oc.prototype.Eed=function(e,C){return C&&1!==C?"":this.TYe(e,C,this.Tdj)};Oc.prototype.Kja=
function(){this.domElement.innerHTML=Sc.T$g;this.Ava=Le.DOMElementExtensions.getElementById(this.domElement,"ignoreBlankCheckBoxId");this.nT=Le.DOMElementExtensions.getElementById(this.domElement,"allowConditionSelectionId");this.qK=Le.DOMElementExtensions.getElementById(this.domElement,"operatorSelectionId");this.gya=Le.DOMElementExtensions.getElementById(this.domElement,"operatorInputId1");this.hya=Le.DOMElementExtensions.getElementById(this.domElement,"operatorInputId2");this.cnc=Le.DOMElementExtensions.getElementById(this.domElement,
"operatorInputLableId1");this.Xzd=Le.DOMElementExtensions.getElementById(this.domElement,"operatorInputLableId2");this.p4a=Le.DOMElementExtensions.getElementById(this.domElement,"inCellDropdownDivId");this.KMa=Le.DOMElementExtensions.getElementById(this.domElement,"listDescriptionDivId");this.c9a=Le.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId1");this.oOa=Le.DOMElementExtensions.getElementById(this.domElement,"operatorInputDivId2");this.Xcc=Le.DOMElementExtensions.getElementById(this.domElement,
"inCellDropdownCheckboxId");this.ak()};Oc.prototype.TYe=function(e,C,M){return M.length<e||M[e].length<C?(Dd.ULS.sendTraceTag(537163280,0,10,"DataValidationEditDialog.GetOperatorLabel: wrong parameters conditionOption={0} operatorOption={1}, cannot get label.",e,C),""):this.KQ.na(M[e][C])};Oc.prototype.ak=function(){zh.a.instance.pa(Ve.a.Rb,this.nT,this.Clc);zh.a.instance.pa(Ve.a.Rb,this.qK,this.Clc);zh.a.instance.pa(Ve.a.change,this.nT,this.Sba);zh.a.instance.pa(Ve.a.change,this.qK,this.Sba);zh.a.instance.pa(Ve.a.change,
this.qK,this.xk);zh.a.instance.pa(Ve.a.change,this.nT,this.xk);zh.a.instance.pa(Ve.a.change,this.gya,this.xk);zh.a.instance.pa(Ve.a.Rb,this.gya,this.xk);zh.a.instance.pa(Ve.a.change,this.hya,this.xk);zh.a.instance.pa(Ve.a.Rb,this.hya,this.xk)};Oc.prototype.mm=function(){zh.a.instance.za(Ve.a.Rb,this.nT,this.Clc);zh.a.instance.za(Ve.a.Rb,this.qK,this.Clc);zh.a.instance.za(Ve.a.change,this.nT,this.Sba);zh.a.instance.za(Ve.a.change,this.qK,this.Sba);zh.a.instance.za(Ve.a.change,this.qK,this.xk);zh.a.instance.za(Ve.a.change,
this.nT,this.xk);zh.a.instance.za(Ve.a.change,this.gya,this.xk);zh.a.instance.za(Ve.a.Rb,this.gya,this.xk);zh.a.instance.za(Ve.a.change,this.hya,this.xk);zh.a.instance.za(Ve.a.Rb,this.hya,this.xk)};Oc.fZ=function(){var e;return e=new lc.a,e.add("operatorInputId1"),e.add("operatorInputId2"),e};tl.Object.defineProperties(Oc.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return fe.a.instance.ea(1651)}},nXg:{configurable:!0,enumerable:!0,get:function(){return this.nT.selectedIndex}}});
Object(sd.a)(Oc,"DataValidationEditConditionsControl",ei.a,[637,3,640]);var bh=b(194),yj=xj.a;vm(cb,yj);cb.prototype.LPd=function(){var e={};e=(e.RuleType=this.Dd.ruleType,e.RuleOperatorType=this.Dd.$A,e.OperatorInput1=this.Dd.nN,e.OperatorInput2=this.Dd.oN,e.IsIgnoreBlank=this.Dd.K4,e.IsInCellDropDown=this.Dd.L4,e.IsAlertBlocking=this.Dd.wZ,e.AlertTitle=this.Dd.mT,e.AlertMessage=this.Dd.lT,e.InputTitle=this.Dd.yE,e.InputMessage=this.Dd.dV,e.IsShowErrorAlert=this.Dd.X4,e.IsShowInputMessage=this.Dd.Y4,
e);this.Cc(2,fe.a.instance.ea(1617));var C={};e=(C[cb.Ly]=this.xc,C.validateDialogValues=this.nNj,C.RangePickerController=Ye.g(this.$).Bh.rac(),C.isModal=!1,C.bodyProps=e,C);this.initializeAndShow(fe.a.instance.ea(1616),this.J3c,e);Dd.ULS.sendTraceTag(537163278,0,50,"DataValidationEditDialog dialog opened.")};cb.prototype.dispose=function(){this.disposed||(yj.prototype.dispose.call(this),this.disposed=!0)};cb.prototype.fZ=function(){return Oc.fZ()};cb.prototype.OGh=function(e,C){var M=this;return function(qa,
Na,Hb){var Gc=e.qa.ta.Xb();return mc(M.$.qa.ta,M.selectedRanges,M.FMg(),M.AZa(qa,M.zxd(C)),lh.a(Na),Hb,Gc)}};cb.prototype.zxd=function(e){var C=this;return function(M){Dd.ULS.sendTraceTag(537163277,0,50,"DataValidationEditDialog.OnDataValidationEditSuccessCallback");var qa;Ch.a(M)?(Dd.ULS.sendTraceTag(537163276,0,15,"DataValidationEditDialog.OnDataValidationEditSuccessCallback - request has expected errors: {0}.",M?oh.a.Uc(M.Errors):null),M.Errors&&1===M.Errors.length&&((qa=C.Xbd(M.Errors[0].MessageId))?
C.Hka("OkInvalidByServer",M.Errors[0].MessageIdName):(C.Hka("OkValid","None"),C.hide()),e(qa)),Dd.ULS.sendTraceTag(537163275,0,15,"DataValidationEditDialog.OnDataValidationEditSuccessCallback - Unexpected error, cannot parse: {0}",oh.a.Uc(M.Errors))):C.hide()}};cb.prototype.FMg=function(){var e={};e.Command=this.command;e.RuleType=this.Dd.ruleType;e.ConditionType=this.Dd.$A;e.IsIgnoreBlank=this.Dd.K4;e.IsInCellDropDown=this.Dd.L4;e.LowerBoundary=this.Dd.nN;e.UpperBoundary=this.Dd.oN;e.IsAlertBlocking=
this.Dd.wZ;e.IsShowErrorAlert=this.Dd.X4;e.IsShowInputMessage=this.Dd.Y4;e.AlertTitle=this.Dd.mT;e.AlertMessage=this.Dd.lT;e.InputTitle=this.Dd.yE;e.InputMessage=this.Dd.dV;e.ShouldIgnoreFormulaError=this.lMa;return e};cb.prototype.Xbd=function(e){switch(e){case 1173235830:return fe.a.instance.ea(1666);case 43935303:return fe.a.instance.ea(1667);case -1323438439:return fe.a.instance.ea(1669);case 2112020473:return fe.a.instance.ea(1663);case -219503282:return fe.a.instance.ea(1664);case 1689335445:return fe.a.instance.ea(1665);
case 2146493810:return fe.a.instance.ea(1668);case -2104909922:return String.format(fe.a.instance.Cb(104),this.Asb,this.wKd);case -869372599:return String.format(fe.a.instance.Cb(103),this.Asb);case -1181828368:return fe.a.instance.ea(1671);case -758480861:return fe.a.instance.ea(1672);case -13729088:return fe.a.instance.ea(1673);case -846654055:return fe.a.instance.ea(1674);case 751854001:return fe.a.instance.ea(1675);case -453846397:return fe.a.instance.ea(1676);case 1102013489:return fe.a.instance.ea(1677);
case 835813260:return fe.a.instance.ea(1678);case 1577787509:return fe.a.instance.ea(1679);case 2083564019:return fe.a.instance.ea(1670);default:Dd.ULS.sendTraceTag(537163274,0,15,"DataValidationEditDialog.GetDataValidationServerErrorString - unexpected error: {0}.",e.toString())}return null};cb.prototype.jla=function(){this.Hka("Cancel","None")};cb.prototype.oW=function(e){Dd.ULS.sendTraceTag(537163273,0,50,"DataValidationEditDialog {0} was clicked.",1===e?"Ok":"Cancel");var C={};e=(C.ButtonType=
cb.Rha(e),C.DialogName=this.xc,C.Location="dialog",C.NumberOfSelectedRanges=Ye.g(this.$).ha.va.nK,C);Th.b(this.$).ae(ra.a.A4b,e)};cb.prototype.Hka=function(e,C){var M={};cb.Rqb(this.Dd,M);M.o=e;M.p=C;M.n=this.Xja;this.ah&&(this.ah.stop(),M.q=this.ah.id);pd.b().Ne(49,M,!0)};cb.prototype.g$b=function(e){this.Dd.ruleType=e.RuleType;this.Dd.$A=e.RuleOperatorType;this.Dd.nN=e.OperatorInput1;this.Dd.oN=e.OperatorInput2;this.Dd.wZ=e.IsAlertBlocking;this.Dd.X4=e.IsShowErrorAlert;this.Dd.mT=e.AlertTitle;this.Dd.lT=
e.AlertMessage;this.Dd.Y4=e.IsShowInputMessage;this.Dd.yE=e.InputTitle;this.Dd.dV=e.InputMessage;this.Dd.K4=e.IsIgnoreBlank;this.Dd.L4=e.IsInCellDropDown;this.Asb=e.firstOperatorLabel;this.wKd=e.secondOperatorLabel};cb.prototype.SMb=function(e,C,M){var qa;var Na=qa=null;if(!e)return M?(qa=String.format(fe.a.instance.Cb(104),this.Asb,this.wKd),Na="DataValidationEditNoMinMaxError"):(qa=String.format(fe.a.instance.Cb(103),this.Asb),Na="DataValidationEditNoValueError"),{returnValue:!1,errorString:qa,
lq:Na};if(e.length>Sc.S4f)return qa=fe.a.instance.ea(1670),{returnValue:!1,errorString:qa,lq:Na};if(bh.d(e))return{returnValue:!0,errorString:qa,lq:Na};if(1===C||2===C||6===C){if(!K.a.jV(e))return qa=fe.a.instance.ea(1663),{returnValue:!1,errorString:qa,lq:Na};if(1===C&&!K.a.isInteger(e))return qa=fe.a.instance.ea(1664),{returnValue:!1,errorString:qa,lq:Na};if(6===C){if(!K.a.isInteger(e))return qa=fe.a.instance.ea(1664),{returnValue:!1,errorString:qa,lq:Na};if(0>parseInt(e))return qa=fe.a.instance.ea(1665),
{returnValue:!1,errorString:qa,lq:Na}}}return{returnValue:!0,errorString:qa,lq:Na}};cb.prototype.KWd=function(){var e=this,C;var M=C=null;var qa=this.Dd.nN,Na=this.Dd.oN,Hb=Cj[this.Dd.ruleType],Gc=kg[this.Dd.$A];if(!Hb)return{returnValue:!0,errorString:C,lq:M};var gd=(!Gc||1===Gc)&&3!==Hb&&7!==Hb;return!function(){var Uc=e.SMb(qa,Hb,gd);C=Uc.errorString;M=Uc.lq;return Uc}().returnValue||gd&&!function(){var Uc=e.SMb(Na,Hb,gd);C=Uc.errorString;M=Uc.lq;return Uc}().returnValue?{returnValue:!1,errorString:C,
lq:M}:gd&&(1===Hb||2===Hb||6===Hb)&&!bh.d(qa)&&!bh.d(Na)&&parseFloat(qa)>parseFloat(Na)?(C=fe.a.instance.ea(1668),M="DataValidationEditMaximumLessMinimumError",{returnValue:!1,errorString:C,lq:M}):{returnValue:!0,errorString:C,lq:M}};cb.Rha=function(e){switch(e){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return Dd.ULS.shipAssertTag(537163272,0,!1,"DataValidationEditDialog.DialogButtonToString: Unknown DialogButton"),"Unknown"}};cb.Rqb=function(e,C){C.a=we(e.ruleType);
C.b=jc(e.$A);C.c=!!e.nN;C.d=!!e.oN;C.e=e.K4;C.f=e.L4;C.g=e.Y4;C.h=!!e.yE;C.i=!!e.dV;C.j=e.X4;C.k=e.wZ;C.l=!!e.mT;C.m=!!e.lT};tl.Object.defineProperties(cb.prototype,{Dd:{configurable:!0,enumerable:!0,get:function(){return this.hQb}},xc:{configurable:!0,enumerable:!0,get:function(){return"DataValidationEditDialog"}},f0b:{configurable:!0,enumerable:!0,get:function(){return 3===this.Dd.ruleType}}});Object(sd.a)(cb,"DataValidationEditDialog",xj.a,[]);var Tf=b(303);Ae.I7g="DataValidationDialogPanel";Ae.H7g=
"DataValidationButtonPanel";Ae.G7g="DataValidationButtonClearAll";Object(sd.a)(Ae,"CssClassNames",null,[]);var ui=ei.a;vm(Bc,ui);Bc.prototype.render=function(e){e.appendChild(this.domElement)};Bc.prototype.oja=function(){return this.isVisible};Bc.prototype.Uma=function(e){return this.isVisible=e};Bc.prototype.setFocus=function(){};Bc.prototype.dispose=function(){this.mm();this.xk=this.Haa=this.Gaa=this.r8e=this.Faa=null;ui.prototype.dispose.call(this)};Bc.prototype.Kja=function(){this.domElement.innerHTML=
Sc.$$g;this.Faa=Le.DOMElementExtensions.getElementById(this.domElement,"showInputCheckBoxId");this.r8e=Le.DOMElementExtensions.getElementById(this.domElement,"inputMessageDivID");this.Haa=Le.DOMElementExtensions.getElementById(this.domElement,"textForInputTitleId");this.Gaa=Le.DOMElementExtensions.getElementById(this.domElement,"textForInputMessageId");this.Faa.checked=!0;this.ak();this.Elc(null)};Bc.prototype.Nza=function(e){this.Haa.value=void 0===e.yE||null===e.yE?"":e.yE;this.Gaa.value=void 0===
e.dV||null===e.dV?"":e.dV;this.Faa.checked=e.Y4;this.Elc(null)};Bc.prototype.job=function(e){e.yE=this.Haa.value;e.dV=this.Gaa.value;e.Y4=this.Faa.checked};Bc.prototype.ak=function(){zh.a.instance.pa(Ve.a.change,this.Faa,this.Elc);zh.a.instance.pa(Ve.a.change,this.Faa,this.xk);zh.a.instance.pa(Ve.a.change,this.Haa,this.xk);zh.a.instance.pa(Ve.a.Rb,this.Haa,this.xk);zh.a.instance.pa(Ve.a.change,this.Gaa,this.xk);zh.a.instance.pa(Ve.a.Rb,this.Gaa,this.xk)};Bc.prototype.mm=function(){zh.a.instance.za(Ve.a.change,
this.Faa,this.Elc);zh.a.instance.za(Ve.a.change,this.Faa,this.xk);zh.a.instance.za(Ve.a.change,this.Haa,this.xk);zh.a.instance.za(Ve.a.Rb,this.Haa,this.xk);zh.a.instance.za(Ve.a.change,this.Gaa,this.xk);zh.a.instance.za(Ve.a.Rb,this.Gaa,this.xk)};tl.Object.defineProperties(Bc.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return fe.a.instance.ea(1653)}}});Object(sd.a)(Bc,"DataValidationEditInputControl",ei.a,[637,3,639]);var Yj=ei.a;vm(Jc,Yj);Jc.prototype.render=function(e){e.appendChild(this.domElement)};
Jc.prototype.oja=function(){return this.isVisible};Jc.prototype.Uma=function(e){return this.isVisible=e};Jc.prototype.setFocus=function(){};Jc.prototype.dispose=function(){this.mm();this.xk=this.p9=this.o9=this.iTa=this.Nga=this.n9=null;Yj.prototype.dispose.call(this)};Jc.prototype.Kja=function(){this.domElement.innerHTML=Sc.dah;this.n9=Le.DOMElementExtensions.getElementById(this.domElement,"showAlertCheckBoxId");this.Nga=Le.DOMElementExtensions.getElementById(this.domElement,"blockingId");this.iTa=
Le.DOMElementExtensions.getElementById(this.domElement,"warningId");this.p9=Le.DOMElementExtensions.getElementById(this.domElement,"textForAlertTitleId");this.o9=Le.DOMElementExtensions.getElementById(this.domElement,"textForAlertMessageId");this.n9.checked=!0;this.Nga.checked=!0;this.ak();this.Dlc(null)};Jc.prototype.Nza=function(e){this.Nga.checked=e.wZ;this.iTa.checked=!e.wZ;this.p9.value=void 0===e.mT||null===e.mT?"":e.mT;this.o9.value=void 0===e.lT||null===e.lT?"":e.lT;this.n9.checked=e.X4;this.Dlc(null)};
Jc.prototype.job=function(e){e.mT=this.p9.value;e.lT=this.o9.value;e.wZ=this.Nga.checked;e.X4=this.n9.checked};Jc.prototype.ak=function(){zh.a.instance.pa(Ve.a.change,this.n9,this.Dlc);zh.a.instance.pa(Ve.a.change,this.n9,this.xk);zh.a.instance.pa(Ve.a.change,this.Nga,this.xk);zh.a.instance.pa(Ve.a.change,this.iTa,this.xk);zh.a.instance.pa(Ve.a.change,this.p9,this.xk);zh.a.instance.pa(Ve.a.Rb,this.p9,this.xk);zh.a.instance.pa(Ve.a.change,this.o9,this.xk);zh.a.instance.pa(Ve.a.Rb,this.o9,this.xk)};
Jc.prototype.mm=function(){zh.a.instance.za(Ve.a.change,this.n9,this.Dlc);zh.a.instance.za(Ve.a.change,this.n9,this.xk);zh.a.instance.pa(Ve.a.change,this.Nga,this.xk);zh.a.instance.pa(Ve.a.change,this.iTa,this.xk);zh.a.instance.za(Ve.a.change,this.p9,this.xk);zh.a.instance.za(Ve.a.Rb,this.p9,this.xk);zh.a.instance.za(Ve.a.change,this.o9,this.xk);zh.a.instance.za(Ve.a.Rb,this.o9,this.xk)};tl.Object.defineProperties(Jc.prototype,{title:{configurable:!0,enumerable:!0,get:function(){return fe.a.instance.ea(1652)}}});
Object(sd.a)(Jc,"DataValidationEditMessagesControl",ei.a,[637,3,638]);se.prototype.p2a=function(){return this.cellRange};Object(sd.a)(se,"MacroRecorderRangeDataValidationChangedPayload",null,[116]);var tj=b(63),ij=Tf.a;vm(vd,ij);vd.prototype.LPd=function(){var e={};e=(e.key=this.Dd,e);this.initializeAndShow(fe.a.instance.ea(1616),this.J3c,e);Dd.ULS.sendTraceTag(537163271,0,50,"DataValidationEditDialogDeprecated dialog opened.")};vd.prototype.dispose=function(){this.disposed||(this.tdc=this.yjc=this.S2=
null,ff.a.Fa(this.ZAb),this.ZAb=null,Th.b(this.$)&&Th.b(this.$).bRd("DataValidationDialogCorellation"),ij.prototype.dispose.call(this),this.disposed=!0)};vd.prototype.$u=function(e){ij.prototype.$u.call(this,e);this.Cc(2,fe.a.instance.ea(1617));e=this.CU(2);var C=this.CU(1),M=this.CU(0),qa=C.parentNode;qa.appendChild(e);qa.appendChild(C);qa.appendChild(M);e.parentNode.classList.add(Ae.H7g);e.classList.add(Ae.G7g);e=document.getElementById("dataValidationTabsId");C=new Oc(this.$,document.createElement("div"),
this.Sba);M=new Bc(document.createElement("div"),this.Sba);qa=new Jc(document.createElement("div"),this.Sba);this.C5h(C,M,qa);var Na;this.ZAb=new Bg(e,(Na=new lc.a,Na.add(C),Na.add(M),Na.add(qa),Na));this.ZAb.rNf();this.tU=document.getElementById("validationErrorMessageId");this.Nza();Th.b(this.$)&&Th.b(this.$).PQd("DataValidationDialogCorellation")};vd.prototype.WN=function(){ij.prototype.WN.call(this);document.getElementById(this.mi("WACDialogPanel")).classList.add(Ae.I7g)};vd.prototype.fZ=function(){return Oc.fZ()};
vd.prototype.o$b=function(){return"validationErrorMessageId"};vd.prototype.C5h=function(e,C,M){this.S2=e;this.tdc=C;this.yjc=M};vd.prototype.bfj=function(){function e(){return new se(C.selectedRanges,M)}var C=this,M={};M.IsClearAll=this.Xja;M.Command=this.command;M.RuleType=this.Dd.ruleType;M.ConditionType=this.Dd.$A;M.IsIgnoreBlank=this.Dd.K4;M.IsInCellDropDown=this.Dd.L4;M.LowerBoundary=this.Dd.nN;M.UpperBoundary=this.Dd.oN;M.IsAlertBlocking=this.Dd.wZ;M.IsShowErrorAlert=this.Dd.X4;M.IsShowInputMessage=
this.Dd.Y4;M.AlertTitle=this.Dd.mT;M.AlertMessage=this.Dd.lT;M.InputTitle=this.Dd.yE;M.InputMessage=this.Dd.dV;M.ShouldIgnoreFormulaError=this.lMa;var qa=this.$.qa.ta.Xb();wg.a(this.$.userOperationManager,function(Na,Hb,Gc){return mc(C.$.qa.ta,C.selectedRanges,M,lh.b(Na,C.zxd),lh.a(Hb),Gc,qa)},function(Na){return new mg.a(121,0,Na,void 0,e)},null)};vd.prototype.Rqj=function(e){return 1577787509===e};vd.prototype.gmj=function(e){this.tU.innerText=e;this.uz(this.CU(0));this.lMa=!0};vd.prototype.uwe=
function(){this.lMa=!1;this.tU.innerText=""};vd.prototype.Xbd=function(e){switch(e){case 1173235830:return fe.a.instance.ea(1666);case 43935303:return fe.a.instance.ea(1667);case -1323438439:return fe.a.instance.ea(1669);case 2112020473:return fe.a.instance.ea(1663);case -219503282:return fe.a.instance.ea(1664);case 1689335445:return fe.a.instance.ea(1665);case 2146493810:return fe.a.instance.ea(1668);case -2104909922:return String.format(fe.a.instance.Cb(104),this.S2.Vtb(this.Dd.ruleType,this.Dd.$A),
this.S2.Eed(this.Dd.ruleType,this.Dd.$A));case -869372599:return String.format(fe.a.instance.Cb(103),this.S2.Vtb(this.Dd.ruleType,this.Dd.$A));case -1181828368:return fe.a.instance.ea(1671);case -758480861:return fe.a.instance.ea(1672);case -13729088:return fe.a.instance.ea(1673);case -846654055:return fe.a.instance.ea(1674);case 751854001:return fe.a.instance.ea(1675);case -453846397:return fe.a.instance.ea(1676);case 1102013489:return fe.a.instance.ea(1677);case 835813260:return fe.a.instance.ea(1678);
case 1577787509:return fe.a.instance.ea(1679);case 2083564019:return fe.a.instance.ea(1670);default:Dd.ULS.sendTraceTag(537163265,0,15,"DataValidationEditDialogDeprecated.GetDataValidationServerErrorString - unexpected error: {0}.",e.toString())}return null};vd.prototype.G8a=function(){Dd.ULS.sendTraceTag(537163264,0,50,"DataValidationEditDialogDeprecated 'Ok' was clicked.");this.g$b();var e=this.KWd();var C=e.errorString;var M=e.lq;if(!e.returnValue)return this.St(C),this.Hka("OkInvalidByClient",
M),!1;this.bfj();return!0};vd.prototype.jla=function(){this.g$b();this.Hka("Cancel","None");this.hide()};vd.prototype.Lxa=function(){Dd.ULS.sendTraceTag(537163235,0,50,"DataValidationEditDialogDeprecated 'ClearAll' was clicked.");this.lMa?this.uwe():this.I0b();this.u9i();this.Xja=!0};vd.prototype.oW=function(e){var C={};e=(C.ButtonType=vd.Rha(e),C.DialogName=this.xc,C.Location="dialog",C.NumberOfSelectedRanges=Ye.g(this.$).ha.va.nK,C);Th.b(this.$).ae(ra.a.A4b,e)};vd.prototype.u9i=function(){this.hQb=
new le;this.Nza()};vd.prototype.Nza=function(){this.yjc.Nza(this.Dd);this.tdc.Nza(this.Dd);this.S2.Nza(this.Dd)};vd.prototype.g$b=function(){this.S2.job(this.Dd);this.yjc.job(this.Dd);this.tdc.job(this.Dd)};vd.prototype.Hka=function(e,C){var M={};vd.Rqb(this.Dd,M);M.o=e;M.p=C;M.n=this.Xja;this.ah&&(this.ah.stop(),M.q=this.ah.id);pd.b().Ne(49,M,!0)};vd.prototype.SMb=function(e,C){var M;var qa=M=null;if(!e)return C?(M=String.format(fe.a.instance.Cb(104),this.S2.Vtb(this.Dd.ruleType,this.Dd.$A),this.S2.Eed(this.Dd.ruleType,
this.Dd.$A)),qa="DataValidationEditNoMinMaxError"):(M=String.format(fe.a.instance.Cb(103),this.S2.Vtb(this.Dd.ruleType,this.Dd.$A)),qa="DataValidationEditNoValueError"),{returnValue:!1,errorString:M,lq:qa};if(e.length>Sc.S4f)return M=fe.a.instance.ea(1670),{returnValue:!1,errorString:M,lq:qa};if(bh.d(e))return{returnValue:!0,errorString:M,lq:qa};if(1===this.Dd.ruleType||2===this.Dd.ruleType||6===this.Dd.ruleType){if(!K.a.jV(e))return M=fe.a.instance.ea(1663),{returnValue:!1,errorString:M,lq:qa};if(1===
this.Dd.ruleType&&!K.a.isInteger(e))return M=fe.a.instance.ea(1664),{returnValue:!1,errorString:M,lq:qa};if(6===this.Dd.ruleType){if(!K.a.isInteger(e))return M=fe.a.instance.ea(1664),{returnValue:!1,errorString:M,lq:qa};if(0>parseInt(e))return M=fe.a.instance.ea(1665),{returnValue:!1,errorString:M,lq:qa}}}return{returnValue:!0,errorString:M,lq:qa}};vd.prototype.KWd=function(){var e=this,C;var M=C=null;if(this.Xja||!this.Dd.ruleType)return{returnValue:!0,errorString:C,lq:M};var qa=(!this.Dd.$A||1===
this.Dd.$A)&&3!==this.Dd.ruleType&&7!==this.Dd.ruleType;return!function(){var Na=e.SMb(e.Dd.nN,qa);C=Na.errorString;M=Na.lq;return Na}().returnValue||qa&&!function(){var Na=e.SMb(e.Dd.oN,qa);C=Na.errorString;M=Na.lq;return Na}().returnValue?{returnValue:!1,errorString:C,lq:M}:qa&&(1===this.Dd.ruleType||2===this.Dd.ruleType||6===this.Dd.ruleType)&&!bh.d(this.Dd.nN)&&!bh.d(this.Dd.oN)&&parseFloat(this.Dd.nN)>parseFloat(this.Dd.oN)?(C=fe.a.instance.ea(1668),M="DataValidationEditMaximumLessMinimumError",
{returnValue:!1,errorString:C,lq:M}):{returnValue:!0,errorString:C,lq:M}};vd.Rha=function(e){switch(e){case 0:return"Cancel";case 1:return"Ok";case 2:return"ClearAll";default:return Dd.ULS.shipAssertTag(537163234,0,!1,"DataValidationEditDialogDeprecated.DialogButtonToString: Unknown DialogButton"),"Unknown"}};vd.Rqb=function(e,C){C.a=we(e.ruleType);C.b=jc(e.$A);C.c=!!e.nN;C.d=!!e.oN;C.e=e.K4;C.f=e.L4;C.g=e.Y4;C.h=!!e.yE;C.i=!!e.dV;C.j=e.X4;C.k=e.wZ;C.l=!!e.mT;C.m=!!e.lT};tl.Object.defineProperties(vd.prototype,
{Dd:{configurable:!0,enumerable:!0,get:function(){return this.hQb}},xc:{configurable:!0,enumerable:!0,get:function(){return"DataValidationEditDialog"}},onCommitDialogHandler:{configurable:!0,enumerable:!0,get:function(){var e=this;return function(){e.oW(1);e.G8a()}},set:function(e){Object(tj.b)(vd.prototype,this,"onCommitDialogHandler",e)}},canBePreempted:{configurable:!0,enumerable:!0,get:function(){return!1}},f0b:{configurable:!0,enumerable:!0,get:function(){return 3===this.S2.nXg}}});Object(sd.a)(vd,
"DataValidationEditDialogDeprecated",Tf.a,[]);fd.prototype.UGa=function(e,C,M,qa){kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataValidationReactDialog",!1)?(new cb(e,C,M,qa)).LPd():(new vd(e,C,M,qa)).LPd()};fd.prototype.K_g=function(e,C){var M=new kf.StandardDialog;M.kc=3;M.cAa(e.Ab.dZ,fe.a.instance.ea(1661),C)};fd.prototype.M_g=function(e,C){var M=new kf.StandardDialog;M.kc=1;M.HW(e.Ab.dZ,fe.a.instance.ea(1662),C)};Object(sd.a)(fd,"DataValidationEditDialogFactory",null,[588]);var Ph=
cf.a;vm(gc,Ph);gc.prototype.Md=function(){this.Ed([new $c(this.$,new fd)])};gc.ja=function(e){cf.a.de(245,new gc(e))};Object(sd.a)(gc,"DataValidationEditCommandHandlerFactory",cf.a,[]);ne.Eeg='<div id="WACDialogRow" class="WACDialogRow">\r\n\t\t\t\t\t<div id="WACDialogIconPanel" class="WACDialogIconPanel"></div>\r\n\t\t\t\t\t<div id="WACDialogTextPanel" class="WACDialogTextPanel" style="padding-right: 30px;">\r\n\t\t\t\t\t\t<div id="WACDialogErrorMessage"></div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorReportMessage"> </div>\r\n\t\t\t\t\t\t<br>\r\n\t\t\t\t\t\t<div id="WACDialogErrorTextPrompt" ></div> \r\n\t\t\t\t\t\t<textarea id="WACDialogInput" class="WACDialogInput" rows="5" style="margin-bottom: 10px; margin-top: 9px; overflow: auto;" maxlength="256"></textarea>\r\n\t\t\t\t\t\t<div id = "WACDialogSendFileCheckboxContainer" class="WACDialogRow" >\r\n\t\t\t\t\t\t<input type="checkbox" id="WACDialogSendFileCheckbox">\r\n\t\t\t\t\t\t<span id="WACDialogSendFileCheckboxText">text</span>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<a id="WACDialogPrivacyText"> </a> \r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>';
Object(sd.a)(ne,"FileUploadDialogHTML",null,[]);var Lh=b(369),$h=sj.a;vm(De,$h);De.prototype.ri=function(e,C,M,qa,Na){Na=void 0===Na?!0:Na;this.Zsd=void 0===qa?!1:qa;this.Srj(C);this.lkf=e;Na&&hd.AFrameworkApplication.nF(e)};De.prototype.Srj=function(e){if(De.gy)this.Etj(e);else{var C={};C[De.nOg]=e;C[De.tOg]=CommonUIStrings.l_SendFileErrorReportMessage;C[De.uOg]=CommonUIStrings.l_SendFileErrorReportTextCaption;C[De.sXc]="";C[De.qOg]=CommonUIStrings.l_UserReportLinkText;C[De.w_b]=!0;this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,
Object(zb.a)(this,this.iki,"legacyDialogHandler"),C);this.AW(De.zOg)}};De.prototype.Etj=function(e){var C={},M={},qa={},Na={},Hb={};e=(Hb.id=this.Me,Hb.bodyControls=(Na.reportErrorCheckboxProps=this.Zsd?(C.label=CommonUIStrings.l_UserReportLinkText,C):null,Na.textAreaProps=this.Xkf?{}:null,Na.privacyStatementLinkProps=(qa.text=CommonUIStrings.l_PrivacyStatement,qa.handler=(M.href=hd.AFrameworkApplication.Tla,M.target="_blank",M),qa),Na),Hb.errorMessage=e,Hb.errorReportMessage=CommonUIStrings.l_SendFileErrorReportMessage,
Hb.errorTextPrompt=CommonUIStrings.l_SendFileErrorReportTextCaption,Hb);this.initializeAndShow(CommonUIStrings.l_DefaultDialogTitle,Object(zb.a)(this,this.aEd,"reactDialogHandler"),e)};De.prototype.q8a=function(){if(!De.gy){var e=document.getElementById(De.wOg);e&&(e.className=De.vOg,e.appendChild(Lh.createClusteredImage(32,32,De.sOg,null,!0,CommonUIStrings.l_DialogError)));if(e=document.getElementById(De.xOg))e.innerText=CommonUIStrings.l_PrivacyStatement,e.href=hd.AFrameworkApplication.Tla,T.a.addHandler(e,
"click",Object(zb.a)(this,this.sIi,"onPrivacyClickHandler"));this.Xkf||(e=document.getElementById(De.sXc))&&e.parentNode&&e.parentNode.removeChild(e);this.Zsd||(e=document.getElementById(De.pOg))&&e.parentNode&&e.parentNode.removeChild(e)}};De.prototype.WN=function(){De.gy||($h.prototype.WN.call(this),document.getElementById(this.mi("WACDialogPanel")).style.width=String.format("{0}px",400))};De.prototype.iki=function(e,C){var M=C[De.sXc]||"",qa=!0;void 0!==C[De.w_b]&&null!==C[De.w_b]&&(qa=C[De.w_b]);
this.Ov(e,M,qa)};De.prototype.aEd=function(e,C){this.Ov(e,C.text||"",C.reportErrorChecked)};De.prototype.Ov=function(e,C,M){this.fkf&&(M&&Dd.ULS.sendTraceTag(5768786,306,50,"Error Report sent for errorCode:{0}",this.lkf),this.fkf(e,C,M))};De.prototype.sIi=function(e){hd.AFrameworkApplication.Eb.ze(Vg.a.Eya,2,e)};tl.Object.defineProperties(De.prototype,{canBePreempted:{configurable:!0,enumerable:!0,get:function(){return!1}}});tl.Object.defineProperties(De,{gy:{configurable:!0,enumerable:!0,get:function(){return hd.AFrameworkApplication.sa.Pa.Lu&&
hd.AFrameworkApplication.sa.Pa.Zdi}}});De.nOg="WACDialogErrorMessage";De.tOg="WACDialogErrorReportMessage";De.uOg="WACDialogErrorTextPrompt";De.sXc="WACDialogInput";De.xOg="WACDialogPrivacyText";De.wOg="WACDialogIconPanel";De.sOg="CancelRequest_32x32x32";De.vOg="WACDialogIcon";De.zOg="WACDialogTextPanel";De.w_b="WACDialogSendFileCheckbox";De.pOg="WACDialogSendFileCheckboxContainer";De.qOg="WACDialogSendFileCheckboxText";De.rOg="FileUploadErrorDialog";Object(sd.a)(De,"FileUploadErrorDialog",sj.a,[]);
var lj=ah.a;vm(Ee,lj);Ee.prototype.Kzg=function(e){this.addHandler("fileCollectionComplete",e)};Ee.prototype.b4i=function(e){this.removeHandler("fileCollectionComplete",e)};Ee.prototype.pVg=function(e,C,M){this.jFf=C;this.AG=e;this.Kzg(M);hd.AFrameworkApplication.Tla=this.$.workbookContext.FullDocumentInfo.PrivacyUrl;e=new De(this.qVg);hd.AFrameworkApplication.Eb.$b(Vg.a.Eya,Qf.a.frame,Ee.wUi);e.ri(0,"",null,!1,!1)};Ee.prototype.N2i=function(e){this.b4i(e)};Ee.wUi=function(e,C,M,qa,Na){T.a.nt(Na);
hd.AFrameworkApplication.Tla&&ab.HelperMethods.sf(hd.AFrameworkApplication.Tla,void 0,void 0,"FileCollectionOperation.PrivacyUrl");return 32};Object(sd.a)(Ee,"FileCollectionOperation",ah.a,[587,3]);var Zj=vb.a;vm(ue,Zj);ue.prototype.create=function(){var e=this;wf.TaskExtensions.Ba(td.GetServiceTaskFactory.create(this.$.da,155,this.ma,this.tb),function(){e.Fb(e.Qth)},this.ma,3)};ue.prototype.dispose=function(){ff.a.Fa(this.JQb);this.JQb=null;Zj.prototype.dispose.call(this)};ue.ja=function(e){e.da.Ha(125,
new ue(e))};tl.Object.defineProperties(ue.prototype,{Qth:{configurable:!0,enumerable:!0,get:function(){return this.JQb||(this.JQb=new Ee(this.$))}}});Object(sd.a)(ue,"FileCollectionCommandHandlerFactory",vb.a,[]);var Ag=b(928),Gj=b(177),qj=b(261),Wi=b(1022);ee.Bzh="GalleryGeneral";ee.Dzh="GalleryNumber";ee.zzh="GalleryCurrency";ee.xzh="GalleryAccounting";ee.Gzh="GalleryShortDate";ee.Czh="GalleryLongDate";ee.Izh="GalleryTime";ee.Ezh="GalleryPercentage";ee.Azh="GalleryFraction";ee.Fzh="GalleryScientific";
ee.Hzh="GalleryText";ee.SNg="ButtonComma";ee.buttonPercentage="ButtonPercentage";ee.keyboardNumber="KeyboardNumber";ee.keyboardCurrency="KeyboardCurrency";ee.keyboardDate="KeyboardDate";ee.keyboardTime="KeyboardTime";ee.keyboardPercentage="KeyboardPercentage";Object(sd.a)(ee,"RibbonFormatKind",null,[]);var Nk=b(287),ek=b(665),Yi=b(664),Lj=b(663),uj=Nk.a;vm(Qc,uj);Qc.prototype.u2=function(e){return uj.prototype.u2.call(this,e)||this.Wxh.u2(this.V$c,this.activeCell,this.format,this.Koe,this.BDf,this.wDf,
this.xYb,this.DEa,this.clientCorrelationId,this.Mkb,this.bhb)};Qc.prototype.Wl=function(){var e=[];if(this.kbc)for(var C=yl(this.kbc),M=C.next();!M.done;M=C.next())e.push(Lj.a(M.value));else e.push(new Yi.a(this.format,this.V$c,this.activeCell));return function(){return new ek.a(e)}};Qc.prototype.edb=function(){var e={OperationType:0};e.FormatCellsMultiRange=this.V$c;e.ActiveCell=this.activeCell;e.Format=this.format;e.ApplyFormatOnPivotTableValueField=this.Koe;e.PivotTableXluid=this.BDf;e.PivotTableFieldCaption=
this.wDf;return e};tl.Object.defineProperties(Qc.prototype,{operationWorkingState:{configurable:!0,enumerable:!0,get:function(){return kd.EwaSettings.tc()?Object(tj.a)(Qc.prototype,this,"operationWorkingState"):0}},lr:{configurable:!0,enumerable:!0,get:function(){return this.Mkb}},J3:{configurable:!0,enumerable:!0,get:function(){return this.bhb}},lAc:{configurable:!0,enumerable:!0,get:function(){return this.DEa}}});Object(sd.a)(Qc,"FormatCellsBatchOperation",Nk.a,[]);var Pj=b(201);Rc.editCell="Edited";
Rc.dependentCell="Dependents";Object(sd.a)(Rc,"RecalcPriorityGroupType",null,[]);var zj=b(217),Mi=b(9);Object(sd.a)(Lf,"RecalcAccuracyObject",null,[]);Uf.string="String";Uf.blank="Blank";Uf.general="General";Uf.Fwh="Flexible";Object(sd.a)(Uf,"FormattedUnitKind",null,[]);Object(sd.a)(ae,"RecalcResultProcessingStatistics",null,[]);Object(sd.a)(re,"RecalcedCellInfo",null,[]);var xd=b(106),Te=b(60),Wg=b(586);je.prototype.dispose=function(){this.calcManager=this.jxc=this.hi=this.grid=this.$=null};je.prototype.fGf=
function(e){var C;if(e&&e.rangeDeltas){for(var M=this.wca.length,qa=0;qa<e.rangeDeltas.length;qa++)(null===(C=e.rangeDeltas[qa])||void 0===C?0:C.data)&&void 0!==e.rangeDeltas[qa].data.value&&null!==e.rangeDeltas[qa].data.value&&void 0!==e.rangeDeltas[qa].range&&null!==e.rangeDeltas[qa].range&&Array.add(this.wca,new re(e.rangeDeltas[qa],e.stateId,e.isFinished,e.priorityGroup));Dd.ULS.sendTraceTag(574993422,0,50,"CalcResultProcessor.ProcessResults stateId={0}, priorityGroup={1}, recalcFinished={2}, cellsFromCalc={3}, initialCellsToRender={4}, recalcedCells={5}, lastSetCellInstantaneousOperation={6}",
e.stateId,e.priorityGroup,e.isFinished,e.rangeDeltas.length,M,this.wca.length,this.lastSetCellInstantaneousOperation);!M&&this.wca.length&&this.Vxf(!1,0)}};je.prototype.M9c=function(e,C,M,qa,Na,Hb,Gc){if(!C)return Object(Wg.a)("Null");var gd=excelOnlineCalc.numfmt.renderCallback(qa,function(Wd){return gridRenderer.CanvasRendererGlobals.measureTextWidth(Wd,Na,!0,kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TextWidthClientPhase1",!1))},Gc),Uc=e.renderValue(C,gd);if(!excelOnlineCalc.util.isSuccess(Uc))return Object(Wg.a)("Finalize");
qa=null;if(Gc=excelOnlineCalc.numfmt.isHashesValue(Uc.value)){if(Uc=e.renderHashesValue(Uc.value,gd),!excelOnlineCalc.util.isSuccess(Uc))return Object(Wg.a)("Hashes")}else qa=je.iyh(C,Uc.value);gd=Uc.value;e=excelOnlineCalc.numfmt.renderedValueToString(gd);C=sc(gd);gd=Cg(gd);return Object(Wg.d)({text:e,valueType:M,fontColor:gd,Gm:Hb,T7a:qa,horizontalAlignment:C,isHashesValue:Gc})};je.prototype.Vxf=function(e,C){var M=this;this.$&&this.grid&&this.calcManager&&this.jxc&&this.calcManager.Np?(e&&(this.qca=
this.jxc.H8e),this.$Ui(this.grid,this.calcManager.Np,e,C),!this.qca&&this.wca.length?Fg.Task.delay(0).CWRCT(function(qa){M.Vxf(!0,qa.id);return!0},null,0,Te.a.current):Fg.Task.Ta(!0)):(Dd.ULS.sendTraceTag(537162181,0,50,"CalcResultProcessor.OnRecalcResultsTask: one of the objects required for processing is null. Aborting..."),Fg.Task.Ta(!1))};je.prototype.$Ui=function(e,C,M,qa){var Na=ab.HelperMethods.jc();for(M=new ae(this.wca.length,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,
void 0,this.qca,void 0,void 0,void 0,M,void 0,qa,!0,0,0,0,0,0,0);0<this.wca.length;){qa=ab.HelperMethods.jc()-Na;if(!this.qca||qa>this.qca){M.numberOfCellsSkippedDueToTimeout=this.wca.length;break}qa=Array.dequeue(this.wca);if(rf(qa,M)){var Hb=Ug.Range.ld(qa.rangeDelta.range.row+1,qa.rangeDelta.range.column+1);(Hb=e.sc(Hb))?je.OPg(qa.stateId,Hb.cell)?(je.rkc(e,Hb,qa,M),this.fGg(C,Hb,qa,M)):M.numberOfCellsUpdatedAlreadyByServer++:M.numberOfCellsWithNoFormattedCell++}}qa=Math.round(ab.HelperMethods.jc()-
Na);this.KLj(qa);this.dzj(M,qa);this.B8i(M)};je.prototype.fGg=function(e,C,M,qa){var Na=Yf(C,M),Hb=M.rangeDelta.data.formatted,Gc=Af(M);e=this.M9c(e,Hb,Gc,C.cell.aSa,C.cell.Fsa,Na,!1);if(Object(Wg.c)(e))C.text!==e.value.text&&(this.hi.Umb(C,e.value),(Na=Of(M))?1===Na?Na=2:(Dd.ULS.sendTraceTag(537162182,0,10,"CalcInterfaceAdapter.GetInstantaneousUpdatedCellType: unknown updated cell type!"),Na=0):Na=1,this.hi.qIe(C,this.lastSetCellInstantaneousOperation,2,Na,!0,!0),qa.numberOfUpdatedCells++);else switch(e.reason){case "Null":qa.numberOfRecalcedCellsWithoutFormattedValue=
null==qa.numberOfRecalcedCellsWithoutFormattedValue?0:qa.numberOfRecalcedCellsWithoutFormattedValue+1;break;case "Hashes":qa.numberOfHashFormattedValues=null==qa.numberOfHashFormattedValues?0:qa.numberOfHashFormattedValues+1;break;case "Finalize":qa.newNumberFormatterFinalizeFailures=null==qa.newNumberFormatterFinalizeFailures?0:qa.newNumberFormatterFinalizeFailures+1}Object(Wg.b)(e)&&"Null"!==e.reason&&(qa.numberOfRecalcedCellsWithFormattedValue=null==qa.numberOfRecalcedCellsWithFormattedValue?0:
qa.numberOfRecalcedCellsWithFormattedValue+1);qa=(M=Of(M))?C.formulaBarText:C.cell.userInput;Na=Object(Wg.c)(e)?e.value.text:"";Hb=Object(Wg.b)(e)?e.reason:"";Dd.ULS.sendTraceTag(537162180,0,50,"CalcResultProcessor.ApplyRecalcResultOnCell: ({0}, {1}) 2nd pass formatting, success: {2}, reason: {3}, priority: {4}, ifmt: {5}, input: '{6}', prediction: '{7}',",C.range.top,C.range.left,e.success,Hb,M,C.cell.Gm,qa?K.a.dJ(qa):"null",Na?K.a.dJ(Na):"null")};je.prototype.KLj=function(e){this.qca=Math.max(this.qca-
Math.max(e,1),0)};je.prototype.dzj=function(e,C){e.numberOfNonUpdatedCells=this.wca.length;e.totalExecutionTime=C;e.newProcessingTimeLimit=this.qca;e.lastSetCellInstantaneousOperation=this.lastSetCellInstantaneousOperation};je.prototype.B8i=function(e){e=Sys.Serialization.JavaScriptSerializer.serialize(e);Dd.ULS.sendTraceTag(574993417,0,50,"CalcResultProcessor.ReportRecalcProcessingStatistics:{0}",e)};je.iyh=function(e,C){e=e.units;var M=C.units;if(e.length!==M.length)return Dd.ULS.sendTraceTag(537162179,
0,15,"CalcResultProcessor.FormattedValueToNumberFormatInformation: can't convert to NumberFormatInformation: units and finalized units don't have the same length!"),null;C=[];for(var qa=-1,Na=0;Na<e.length;Na++)switch(e[Na].kind){case Uf.blank:C.push.apply(C,xd.h(" ",M[Na].str.length));break;case Uf.string:C.push(e[Na].str);break;case Uf.Fwh:C.push("");qa=Na;break;case Uf.general:C.push(M[Na].str);break;default:Dd.ULS.sendTraceTag(537162178,0,15,"CalcResultProcessor.ProcessFormattedValue: unknown FormattedUnitKind!")}if(0>=
qa||""===M[qa].str)return null;M={};M.Start=C.slice(0,qa).join("");M.Separator=e[qa].str;M.End=C.slice(qa+1,C.length).join("");return M};je.CEh=function(e){return e&&e&&e.Eu?e.Eu.fJ:Mi.a.Se};je.OPg=function(e,C){if(!C)return!1;C=je.CEh(C);return C===Mi.a.Se||C===e};je.rkc=function(e,C,M,qa){var Na=M.rangeDelta.data.value.toString(),Hb=Af(M),Gc=Yf(C,M);Na=new Lf(Hb,Na,Gc,M.priorityGroup);C.cell.rkc(Na,e.Ca.OE);1===Of(M)?qa.numberOfDependentRecalcedCellsInBatch++:qa.numberOfEditedRecalcedCellsInBatch++};
je.TDe=20;Object(sd.a)(je,"CalcResultProcessor",null,[658,3]);Object(sd.a)(rd,"GetRibbonNumberFormatResult",null,[]);Yd.prototype.lIb=function(e,C,M){var qa=C.Border;C=C.BorderFormat;var Na=0,Hb=!1;if(qa){for(var Gc=0;3>=Gc;Gc++)Yd.voj(e,M,Gc,qa)&&(Na|=ab.HelperMethods.wtb(Gc),this.hVd(e.cell.getRange(),Gc,C),Hb=!0);ab.HelperMethods.zQ(qa,16)&&!bh.c(e,0,M)&&(Na|=2,this.hVd(e.cell.getRange(),0,C),Hb=!0);ab.HelperMethods.zQ(qa,32)&&!bh.c(e,2,M)&&(Na|=4,this.hVd(e.cell.getRange(),2,C),Hb=!0);Hb&&(M=
e.cell.Eu.Wf,ab.HelperMethods.zQ(Na,2)&&this.nZf(e,M,0)&&(Na&=-3),ab.HelperMethods.zQ(Na,1)&&this.mZf(e,M,1)&&(Na&=-2),ab.HelperMethods.zQ(Na,4)&&this.nZf(e,M,2)&&(Na&=-5),ab.HelperMethods.zQ(Na,8)&&this.mZf(e,M,3)&&(Na&=-9),e.cell.setBorders(C,Na,!1))}else e.cell.ZKf(),this.q2i(e.cell.getRange())};Yd.prototype.oua=function(e,C){e=Yd.ITe(e,C);return e.isValidRange?(e=this.Ca.nJa(e))&&e.length?e:null:null};Yd.prototype.q2i=function(e){for(var C=0;3>=C;C++){var M=Yd.ITe(e,C);if(M.isValidRange&&(M=this.Ca.nJa(M))&&
M.length)for(var qa=Yd.UYe(C),Na=0;Na<M.length;Na++)M[Na].OFd(qa)}};Yd.prototype.hVd=function(e,C,M){if(e=this.oua(e,C))for(var qa=Yd.UYe(C),Na=ab.HelperMethods.wtb(qa),Hb=0;Hb<e.length;Hb++){var Gc=e[Hb];this.k9h(Gc,qa)&&Yd.setBorders(Gc,M,Na,C,qa)}};Yd.prototype.k9h=function(e,C){var M=e.Eu.Wf,qa=e.getRange();qa=this.oua(qa,C);var Na=!1,Hb=!1,Gc=!1,gd=!1;qa&&(Na=Yd.q5a(qa,!0),Hb=Yd.q5a(qa,!1),gd=Yd.Qmd(qa),Gc=1===qa.length?!0:!1);switch(C){case 0:return Yd.B8h(e,M,gd,Hb,Gc);case 1:return Yd.y8h(e,
M,gd,Na,Gc);case 2:return Yd.z8h(e,M,gd,Na,Gc);case 3:return Yd.A8h(e,M,gd,Hb,Gc)}return!1};Yd.prototype.nZf=function(e,C,M){if(!e.cell.FM)return!1;var qa=e.range,Na=this.oua(qa,M),Hb=bh.c(e,M,C),Gc=!1;C=M?qa.left<C.left:qa.top<C.top;!Yd.Xxb(e.cell)&&Na&&1!==Na.length&&(Gc=(M?Yd.q5a(Na,!1):Yd.q5a(Na,!0))?!1:!0);return!Hb&&Gc||C?!0:!1};Yd.prototype.mZf=function(e,C,M){var qa=e.cell,Na=this.oua(qa.getRange(),M);e=bh.c(e,M,C);C=!1;if(Na){var Hb=Yd.q5a(Na,!0),Gc=Yd.q5a(Na,!1),gd=Hb&&!Gc;Gc=Gc&&!Hb;1!==
M||Yd.Lyb(qa)?3!==M||Yd.Mxb(qa)||Yd.Coj(qa,Na,Gc,gd)&&(C=!0):Yd.Boj(qa,Na,Hb,Gc)&&(C=!0)}return!e&&C||Yd.Xxb(qa)?!0:!1};Yd.sLg=function(e,C,M){var qa={};qa.LineStyle=Array(4);qa.LineStyle[M]=e.LineStyle[C];qa.Color=Array(4);qa.Color[M]=e.Color[C];return qa};Yd.P9e=function(e,C,M,qa,Na){return ab.HelperMethods.zQ(e,Na)&&bh.c(C,M,qa)};Yd.voj=function(e,C,M,qa){return Yd.P9e(qa,e,M,C,ab.HelperMethods.wtb(M))||Yd.P9e(qa,e,M,C,64)||112===qa};Yd.setBorders=function(e,C,M,qa,Na){C=Yd.sLg(C,qa,Na);e.setBorders(C,
M,!1)};Yd.ITe=function(e,C){switch(C){case 0:return new Ug.Range(e.top-1,e.left,e.top-1,e.right,!1,!1);case 2:return new Ug.Range(e.top,e.left-1,e.bottom,e.left-1,!1,!1);case 1:return new Ug.Range(e.bottom+1,e.left,e.bottom+1,e.right,!1,!1);case 3:return new Ug.Range(e.top,e.right+1,e.bottom,e.right+1,!1,!1)}return e};Yd.UYe=function(e){switch(e){case 0:return 1;case 2:return 3;case 1:return 0;default:return 2}};Yd.q5a=function(e,C){for(var M=0;M<e.length;M++){var qa=e[M];if(qa.FM)return C?Yd.Mxb(qa):
Yd.Lyb(qa)}return!1};Yd.Xxb=function(e){var C=e.Eu.Wf,M=e.getRange();return e.FM&&(M.top<C.top||M.bottom>C.bottom||M.left<C.left||M.right>C.right)?!0:!1};Yd.Qmd=function(e){for(var C=0;C<e.length;C++)if(Yd.Xxb(e[C]))return!0;return!1};Yd.Boj=function(e,C,M,qa){if(!e.FM){if(!M||Yd.Qmd(C))return!0}else if(Yd.Mxb(e)&&(1===C.length&&Yd.zGg(e,C[0])||!M))return!0;return qa};Yd.Coj=function(e,C,M,qa){if(!e.FM){if(!M||Yd.Qmd(C))return!0}else if(Yd.Lyb(e)&&(1===C.length&&Yd.AGg(e,C[0])||!M))return!0;return e.oka||
qa};Yd.B8h=function(e,C,M,qa,Na){var Hb=e.getRange();return Yd.Mxb(e)?Yd.Xxb(e)||Na:C.top===Hb.top||!qa||M};Yd.y8h=function(e,C,M,qa,Na){var Hb=e.getRange();return Yd.Mxb(e)?C.bottom===Hb.bottom&&Na:qa&&!M||C.bottom===Hb.bottom};Yd.z8h=function(e,C,M,qa,Na){var Hb=e.getRange();return Yd.Lyb(e)?Yd.Xxb(e)||Na:C.left===Hb.left||!qa||M};Yd.A8h=function(e,C,M,qa,Na){var Hb=e.getRange();return e.oka?!1:Yd.Lyb(e)?C.right===Hb.right&&Na:qa&&!M||C.right===Hb.right};Yd.Mxb=function(e){return 0<e.getRange().right-
e.getRange().left};Yd.Lyb=function(e){return 0<e.getRange().bottom-e.getRange().top};Yd.AGg=function(e,C){e=e.getRange();C=C.getRange();return e.top===C.top&&e.bottom===C.bottom};Yd.zGg=function(e,C){e=e.getRange();C=C.getRange();return e.left===C.left&&e.right===C.right};Object(sd.a)(Yd,"BorderModelAccessorHelper",null,[]);ge.prototype.qbb=function(e,C,M,qa,Na,Hb){e&&(e.N6(C,M,void 0===Na?!1:Na,void 0===Hb?!1:Hb),e.verticalAlignment=qa)};ge.prototype.lIb=function(e,C,M){this.gY||(this.gY=new Yd(this.Ca,
this.r1a));this.gY.lIb(e,C,M)};Object(sd.a)(ge,"FormatCellsActionModelAccessor",null,[657]);jd.prototype.isValid=function(){return this.Al&&this.Np?!(void 0===this.formatString||null===this.formatString):!1};jd.prototype.DKh=function(){return null!=this.mE?this.mE:this.formatString};tl.Object.defineProperties(jd.prototype,{mE:{configurable:!0,enumerable:!0,get:function(){return this.xkg}},formatString:{configurable:!0,enumerable:!0,get:function(){if(this.W7a)return this.W7a;if(this.$pa)return this.$pa.formatString;
if(!this.Al)return null;if(null!=this.mE){var e=this.mE;return 0>e?(Dd.ULS.shipAssertTag(537162126,0,!1,"NumberFormatHolder.FormatString: ifmt is negative!"),null):(e=this.Al.Jba[e])?this.W7a=e.FormatString:null}return null}},numberFormat:{configurable:!0,enumerable:!0,get:function(){return this.$pa?this.$pa:this.Np&&this.formatString?this.$pa=this.Np.createFormat(this.formatString,this.LNg).value:null}},LNg:{configurable:!0,enumerable:!0,get:function(){if(!this.Al||null==this.mE||0>this.mE)return!1;
var e=this.Al.Jba[this.mE];return e?e.Builtin:!1}}});Object(sd.a)(jd,"NumberFormatHolder",null,[656]);var Vj=b(247);Object(sd.a)(zd,"FormatCellInstantaneousResult",null,[]);Object(sd.a)(Lc,"FormatStringResult",null,[]);var Ck=b(1187),yf=b(525),ai=b(193),li;(function(e){e.InvalidInput="invalid input";e.UnsupportedZeroResize="resizing to 0 - ignore";e.UnsupportedSkeletonInView="skeleton in view - ignore";e.NullSPD="ActiveSheetProcessedData is null";e.UnsupportedHiddenInRange="hiddens in resizeRanges";
e.UnsupportedMergeCell="There's a merge cell across blocks in resizeRanges"})(li||(li={}));Object(sd.b)("InstantaneousRowColumnResizeFailureReason",li);mb.prototype.dispose=function(){ff.a.pc([this.wRa,this.x2]);this.$=this.x2=this.wRa=null};mb.prototype.pRa=function(e,C,M,qa,Na,Hb,Gc,gd,Uc){return this.Isj(e,C,M,void 0===Na?!1:Na,void 0===gd?0:gd,void 0===Hb?"":Hb,void 0===Uc?null:Uc)};mb.prototype.qIe=function(e,C,M,qa,Na,Hb){e.cell.Eu.JP|=qa;mb.bXg(Ye.g(this.$),e,M,Na);this.x2.lastSetCellInstantaneousOperation=
C;Hb&&Ye.g(this.$).Ji.n0(C,gh.BasicTelemetryCalculator.sQ)};mb.prototype.gna=function(e,C,M,qa,Na,Hb){qa=void 0===qa?!1:qa;Na=void 0===Na?null:Na;var Gc=void 0===Gc?null:Gc;Hb=(void 0===Hb?null:Hb)||e.ha.va.selectedRanges;if(!(-1690267012===C&&1<Hb.length)){-1690267012===C&&Dd.ULS.shipAssertTag(537162176,0,1===Hb.length,"FormatCellsAction.ShowInstantaneousFormatting: targetRanges.Length = {0}",Hb.length);var gd=e.m$("FormatCellsAction.ShowInstantaneousFormatting",Hb);try{gd.$$rst();for(var Uc=!1;gd.$$mn();){var Wd=
void 0,We=gd.$$cu().VJ?e.Zsc(gd.$$cu().range):(Wd=new lc.a,Wd.add(gd.$$cu()),Wd);Wd={};for(var Gf=yl(We),xg=Gf.next();!xg.done;Wd={Meb:Wd.Meb},xg=Gf.next()){var Hg=xg.value;if(Ye.g(this.$).Xy&&Hg&&Gc&&-1690267012===C&&(Wd.Meb=Hg.range,Wd.Meb&&Gc.contains(Wd.Meb)&&hi.a.all(Hb,function(Ig){return function(Hh){return!jg.c(Hh,Ig.Meb)}}(Wd))))continue;if(!Hg||gd.gd.contains(Hg.range))if(this.Jsj(C,Hg,M,qa,Na,gd.$$cu().VJ),Uc||(e.Ca.gV(),Uc=!0),Na)break}}}finally{gd&&gd.dispose()}}};mb.prototype.Umb=function(e,
C,M){if(M=void 0===M?null:M)M.UKa=!0;M=!C.text;var qa=K.a.hcf(C.text),Na,Hb=e.VJ?Ye.g(this.$).Zsc(e.range):(Na=new lc.a,Na.add(e),Na);Na=yl(Hb);for(Hb=Na.next();!Hb.done;Hb=Na.next())this.dGg(this.$,Hb.value,C.text,C.horizontalAlignment,C.fontColor,C.Gm,e.cell.Gm,M,qa,C.valueType,C.T7a);e.cell.aAc()};mb.prototype.ZPi=function(e,C,M,qa,Na){Na=void 0===Na?null:Na;try{var Hb=jg.D(C),Gc=jg.D(M);if(e.Vb.r5a(Hb)||e.Vb.r5a(Gc))return 8;if(-185374993!==qa&&this.Ffi(e,Hb,Gc))return 9;if(-185374993!==qa&&(e.Vb.T4(Gc)||
e.Vb.iyb(Hb)))return 10;if(1804571062!==qa&&e.Vb.S4(Gc))return 11;if(this.Pch(Gc))return 12;if(this.tgi(Hb,Gc))return 13;var gd=this.$.Ub.Fc("UserAction","PasteInstantaneous");gd.start();yf.a(gd);Na&&pd.b().CB(gd.id,Na.id,"actions","actions");!Hb.isSingle&&Gc.isSingle&&(Gc=mb.expandRange(Hb,Gc),e.ha.updateSelection(Gc,Gc,0));switch(qa){case 237279923:case 808159687:if(!this.rQi(Hb,Gc))return 14;this.d1c(e,Hb,Gc,!0,!1);break;case 1804571062:this.d1c(e,Hb,Gc,!0,!1);break;case -185374993:this.d1c(e,
Hb,Gc,!1,!0);break;default:return 2}Dd.ULS.sendTraceTag(537162146,0,50,"FormatCellsAction.PasteInstantaneous: Complete processing.");return 1}catch(Uc){return Dd.ULS.sendTraceTag(537162145,0,10,"FormatCellsAction.PasteInstantaneous: failed with the following error: {0}",JSON.stringify(Uc)),15}};mb.prototype.$Tg=function(e,C){e=yl(e);for(var M=e.next();!M.done;M=e.next())this.GZc(M.value,!0,C)};mb.prototype.GZc=function(e,C,M){M=void 0===M?"":M;if(e){var qa=Ye.g(this.$);if(C){if(C=qa.sl("FormatCellsAction.ClearRangeInstantaneous",
e),e=e.isSingle?null:e,C.$$mn()&&void 0!==C.$$cu()&&null!==C.$$cu())for(qa=Object.assign(new Rh.a,{Text:""}),this.pRa(C.$$cu(),qa,!1,void 0,fg.a.Amd(this.$),M,void 0,void 0,e);C.$$mn();)void 0!==C.$$cu()&&null!==C.$$cu()&&this.pRa(C.$$cu(),qa,!1,void 0,!1,M)}else this.gna(qa,-1228228458,{},void 0,void 0,[e])}else Dd.ULS.shipAssertTag(537162144,0,!1,"FormatCellsAction.ClearRangeInstantaneous: targetRange shouldn't be null")};mb.prototype.B_i=function(e,C){if(!C){C=ab.HelperMethods.jc();var M=Ye.g(this.$),
qa=M.m$("FormatCellsAction.ReformatCells",e);try{qa.$$rst();for(var Na=!1;qa.$$mn();){var Hb=qa.$$cu().cell;Hb.JT&&2!==Hb.JT||(this.uLj(Hb,e),Na||(M.Ca.gV(),Na=!0))}}finally{qa&&qa.dispose()}Dd.ULS.sendTraceTag(537162143,0,50,"FormatCellsAction.ReformatCellsAfterGeometryChange: reformatting cells total time: {0}.",ab.HelperMethods.jc()-C)}};mb.prototype.Sgd=function(e,C){if(this.zg){if(e.formulaBarText)return!K.a.equals(C.Text,e.formulaBarText,!1);var M=e.cell.formattedText;this.xod&&(M=Vj.a(M,e.cell.getCellFont()));
return!gridRenderer.CanvasRendererGlobals.compareFormattedTexts(M,C).isEqual}return!K.a.equals(C.Text,e.text,!1)};mb.prototype.dyh=function(e){if(void 0===e||null===e)return new Lc(!1,"1234.56");e=new jd(this.Al,this.Np,void 0,e);if(!e.isValid())return new Lc(!1,"1234.56");e=this.N1a({value:"1234.56",type:1},e,244,"12px sans-serif");return Object(Wg.b)(e)?new Lc(!1,"1234.56"):new Lc(!0,e.value.text)};mb.prototype.Ksj=function(e,C,M,qa){return Ne(e,this,C,M,qa,!0)};mb.prototype.Gsj=function(e,C,M){if(!this.Sgd(C,
M))return Object(Wg.d)("Skip unchanged cell content");C=C.cell;var qa=new jd(this.Al,this.Np,C.Gm);M=this.cSe(M.Text,qa,C.aSa,C.Fsa,!0);Object(Wg.b)(M)?e=M:(M=M.value,qa=C.hasRichValueIcon?"Unsupported rich value icon":C.C7?"Unsupported wrapped text":C.Nyb||null!=C.T4f&&0!==C.T4f?"Unsupported rotated text":!0,!0!==qa?e=Object(Wg.a)(qa):(C.isCellWidthFixed?qa="Skip fixed width cell":(qa=M.valueType,qa=0===qa?"Skip empty cell value":2===qa?"Skip string cell value":C.FM&&!C.zfi?"Skip merged cell":C.awc?
"Skip shrunk to fit":M.isHashesValue?"Skip hashes cell value":!0),!0!==qa?e=Object(Wg.d)(qa):(M=C.xYg(M.text),M>C.offsetWidth?(C=[C.getRange().clone()],e=Ne(e,this,C,M,!1,!1),e=Object(Wg.b)(e)?e:Object(Wg.d)(M)):e=Object(Wg.d)("Column is wide enough"))));return e};mb.prototype.cyh=function(e,C,M){var qa=Number.POSITIVE_INFINITY;C=new jd(this.Al,this.Np,C);if(!C.isValid())return new Lc(!1,e);var Na={};Na.value=e;Na.type=1;M=this.N1a(Na,C,qa,M);return Object(Wg.b)(M)?new Lc(!1,e):new Lc(!0,M.value.text)};
mb.prototype.uLj=function(e,C){var M=e.getRange(),qa=!1;C=yl(C);for(var Na=C.next();!Na.done;Na=C.next())if(M.left===Na.value.left){qa=!0;break}e.DIj(qa)};mb.prototype.Isj=function(e,C,M,qa,Na,Hb,Gc){var gd=void 0;Hb=void 0===Hb?"":Hb;gd=void 0===gd?1:gd;Gc=void 0===Gc?null:Gc;var Uc=new zd;Uc.source=0;Uc.UKa=!1;e.cell.fnc=e.cell.Gm;var Wd=C.Text,We=!Wd,Gf=K.a.hcf(Wd);K.a.xn(Wd)&&(Dd.ULS.shipAssertTag(537162142,0,!((void 0===Wd||null===Wd)&&void 0!==C.TextRuns&&null!==C.TextRuns),"FormatCellsAction.ShowInstantaneousDataEntryOnCellInternal: Text is null but TextRuns isn't"),
C=Object.assign(new Rh.a,{Text:""}),Wd="");e.cell.userInput=Wd;if(!this.Sgd(e,C))return this.xRg(e,Na,We,Gf,Uc);M?this.qRg(e,Wd,this.$.workbookContext.DefaultHyperlinkStyle,Uc):this.kRg(e,C,Wd,We,Gf,qa,Uc,Gc);this.qIe(e,Hb,Na,gd,Uc.Vfc,Uc.UKa);return Uc};mb.prototype.xRg=function(e,C,M,qa,Na){Na.tbg=!0;Na.Vfc=!0;Na.UKa=!1;C||Ye.g(this.$).Ca.gV();e.cell.pOa||(M?e.cell.N6(0,!1):qa&&e.cell.N6(1,!1));return Na};mb.prototype.qRg=function(e,C,M,qa){qa.UKa=!0;e.insertHyperlink(C,Pj.a.m$c(C),M)};mb.prototype.kRg=
function(e,C,M,qa,Na,Hb,Gc,gd){gd=void 0===gd?null:gd;Gc.UKa=!1;var Uc=e.cell;this.Al||(this.Al=this.$.da.Aa(268));this.HEj(this.Al,Uc.Gm);qa||Na?this.mRg(e,qa,Na,Gc):(qa=new jd(this.Al,this.Np,Uc.Gm),qa=this.cSe(M,qa,Uc.aSa,Uc.Fsa,!1),Object(Wg.c)(qa)?(this.Ipj(C.TextRuns,C.Fonts)&&this.oRg(e,C,qa.value),this.Umb(e,qa.value,Gc)):this.uRg(e,C.Text),C=Object(Wg.c)(qa)?qa.value.text:"",Na=Object(Wg.b)(qa)?qa.reason:"",Dd.ULS.sendTraceTag(559724065,0,50,"FormatCellsAction.CellDataEntryCSE: ({0}, {1}) 1st pass formatting, success: {2}, reason: {3}, ifmt: {4}, input: '{5}', prediction: '{6}',",
e.range.top,e.range.left,qa.success,Na,Uc.Gm,K.a.Mmb(Uc.userInput),K.a.Mmb(C)));Uc.formulaBarText=M;Hb&&this.lEj(this.Al,e,M,gd);Gc.Vfc=!0};mb.prototype.mRg=function(e,C,M,qa){qa.UKa=!0;e.text="";e.formulaBarText="";e.cell.userInput="";this.DYc(e,null,null,C,M)};mb.prototype.oRg=function(e,C,M){this.aec&&1===C.TextRuns.length&&e.cell.QFg(C.Fonts[C.TextRuns[0].FontID]);C.Text===M.text&&2===M.valueType&&(this.aec&&1===C.TextRuns.length?e.cell.text=C.Text:e.cell.formattedText=C)};mb.prototype.uRg=function(e,
C){e.text=C;e.formulaBarText=C;this.DYc(e,1)};mb.prototype.DYc=function(e,C,M,qa,Na,Hb){M=void 0===M?null:M;qa=void 0===qa?!1:qa;Na=void 0===Na?!1:Na;Hb=void 0===Hb?!1:Hb;var Gc=e.horizontalAlignment;M=null!=M?M:e.verticalAlignment;!e.cell.pOa&&(null!=C||qa||Na||Hb)&&(qa?Gc=0:Na||Hb?Gc=1:null!=C&&(Gc=C),this.cua.qbb(e,Gc,!1,M,!0))};mb.prototype.HEj=function(e,C){(null===e||void 0===e?0:e.Jba)&&C>=mb.kwh&&C>e.Jba.length-1&&(Dd.ULS.sendTraceTag(537162141,0,50,"FormatCellsAction.TriggerSupportInformationRefresh: The cell has a missing format, ifmt:{0}. Triggering refresh...",
C),e.VRe())};mb.prototype.lEj=function(e,C,M,qa){qa=void 0===qa?null:qa;if(void 0!==e&&null!==e)if(this.Al.fkd)Dd.ULS.sendTraceTag(537162140,0,50,"FormatCellsAction.TriggerCalc: in manual mode - not recalcing");else{var Na=this.$.da.Aa(266);Na&&(this.x2.qca=je.TDe,e&&(this.x2.qca=e.H8e),Na.cPg(C,M,Object(zb.a)(this.x2,this.x2.fGf,"processResults"),qa))}};mb.prototype.N1a=function(e,C,M,qa){var Na=this.$.da.Aa(266);if(!Na)return Object(Wg.a)("calcManager is null");if(!Na.Np)return Object(Wg.a)("calcManager.NumberFormatter is null");
if(!this.Al)return Object(Wg.a)("instantaneousManager is null");if(!C||!C.isValid())return Object(Wg.a)("numberFormatHolder is invalid or null");var Hb=Na.Hdd(C);if(null===Hb)return Object(Wg.a)("cellFormat is null");var Gc=Na.Np,gd=vg(e);if(void 0===gd||null===gd)return Object(Wg.a)("cellValue is null");Na=excelOnlineCalc.calc.cellValueToReadOper(Na.config.mathpack,gd);if(void 0===Na||null===Na)return Object(Wg.a)("readOper is null");Hb=Gc.applyFormat(Hb,Na);return excelOnlineCalc.util.isSuccess(Hb)?
this.x2.M9c(Gc,Hb.value,e.type,M,qa,null!=C.mE?C.mE:-1,!1):Object(Wg.a)("NumberFormatter.ApplyFormat: "+JSON.stringify(Hb.reason.kind))};mb.prototype.cSe=function(e,C,M,qa,Na){var Hb=this.$.da.Aa(266);if(void 0===Hb||null===Hb)return Object(Wg.a)("calcManager is null");if(void 0===Hb.Np||null===Hb.Np)return Object(Wg.a)("calcManager.NumberFormatter is null");if(void 0===this.Al||null===this.Al)return Object(Wg.a)("instantaneousManager is null");if(void 0===C||null===C||!C.isValid())return Object(Wg.a)("numberFormatHolder is invalid or null");
var Gc=Hb.Hdd(C);if(void 0===Gc||null===Gc)return Object(Wg.a)("cellFormat is null");var gd=Hb.Np;e=gd.parseEdit(e,Gc);if(!excelOnlineCalc.util.isSuccess(e))return Object(Wg.a)("ParseEdit failure: "+JSON.stringify(e.reason.kind));if(e.value.kind===Wi.a.formula)return Object(Wg.a)("Main thread - skipping formula edit");Hb=excelOnlineCalc.numfmt.applyValueEdit(gd,Hb.localeInfo,Gc,e.value);if(!excelOnlineCalc.util.isSuccess(Hb))return Object(Wg.a)("NumberFormatter.FormatValueEdit: "+JSON.stringify(Hb.reason.kind));
Gc=e.value;Dd.ULS.shipAssertTag(537162190,0,Gc.kind!==Wi.a.formula,"CalcInterfaceAdapter.GetCellValueTypeFromParsedEdit: given parsed edit must be a value edit!");Gc=excelOnlineCalc.numfmt.getValueEditOperKind(Gc);e=0;switch(Gc){case 0:case 128:e=0;break;case 1:e=1;break;case 2:e=2;break;case 4:e=3;break;case 8:e=4;break;case 16:case 32:case 64:case 256:Dd.ULS.sendTraceTag(537162189,0,15,"CalcInterfaceAdapter.OperKindToCellValueType: can't convert given OperKind {0} to a CellValueType",Gc);break;
default:Dd.ULS.shipAssertTag(537162188,0,!1,"CalcInterfaceAdapter.OperKindToCellValueType: Unexpected oper kind {0}",Gc)}return this.x2.M9c(gd,Hb.value,e,M,qa,null!=C.mE?C.mE:-1,Na)};mb.prototype.Ffi=function(e,C,M){if(C.width<M.width)for(var qa=e.sl("FormatCellsAction.IsSourceRangeLargerAndWithBorders",new Ug.Range(C.top,C.left,C.bottom,C.left,!0,!0));qa.$$mn();){var Na=qa.$$cu();if(Na&&Na.K3a())return Dd.ULS.sendTraceTag(537162139,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),
!0}if(C.height<M.height)for(e=e.sl("FormatCellsAction.IsSourceRangeLargerAndWithBorders2",new Ug.Range(C.top,C.left,C.top,C.right,!0,!0));e.$$mn();)if((C=e.$$cu())&&C.O3a())return Dd.ULS.sendTraceTag(537162138,0,50,"FormatCellsAction.ShowInstantaneousFormattingFromRange: no instantenous."),!0;return!1};mb.prototype.d1c=function(e,C,M,qa,Na){for(var Hb=C.QW().FirstRow,Gc=C.QW().LastRow,gd=M.QW().LastRow,Uc=Hb,Wd=M.QW().FirstRow;Wd<=gd;Wd++,Uc++){Uc>Gc&&(Uc=Hb);var We=C.QW();We.FirstRow=We.LastRow=
Uc;var Gf=M.QW();Gf.FirstRow=Gf.LastRow=Wd;this.MZg(e,Gj.a.fQ(We),Gj.a.fQ(Gf),qa,Na)}};mb.prototype.rQi=function(e,C){var M=this.$.da.Aa(266);return void 0!==M&&null!==M?(M.XOg(e,C.topLeft,Object(zb.a)(this.x2,this.x2.fGf,"processResults")),!0):!1};mb.prototype.tgi=function(e,C){var M=e.right-e.left+1;e=e.bottom-e.top+1;var qa=C.right-C.left+1;C=C.bottom-C.top+1;if(qa>M&&C>e){if(!(qa%M&&C%e))return!0}else if(qa===M&&C>e){if(!(C%e))return!0}else if(qa>M&&C===e&&!(qa%M))return!0;return!1};mb.prototype.Pch=
function(e){if(kd.EwaSettings.la(102)){e=Ye.g(this.$).M0(e).gridView.getRangeInformation(e);e=yl(e);for(var C=e.next();!C.done;C=e.next())if(C=C.value,Object(ig.a)(qj.DynamicArrayRange,C)&&!Object(qc.a)(qj.DynamicArrayRange,C).jkc)return!0}return!1};mb.prototype.MZg=function(e,C,M,qa,Na){if(M){this.wRa&&M.equals(this.wRa.range)||(ff.a.Fa(this.wRa),this.wRa=e.sl("FormatCellsAction.CopyBetweenRows",M));C=e.sl("FormatCellsAction.CopyBetweenRows2",C);M=this.wRa;M.$$rst();for(var Hb=!1;M.$$mn();){C.$$mn()||
(C.$$rst(),C.$$mn());var Gc=C.$$cu(),gd=void 0,Uc=M.$$cu().VJ?e.Zsc(M.$$cu().range):(gd=new lc.a,gd.add(M.$$cu()),gd);gd=yl(Uc);for(var Wd=gd.next();!Wd.done;Wd=gd.next())Wd=Wd.value,Gc&&(qa&&(this.QZg(Wd,Gc),Wd.setCell(!0)),Na&&(Hb=this.WXh(Gc,Wd)),Hb||(e.Ca.gV(),Hb=!0));ha.lastOrDefault(Uc)}}else Dd.ULS.sendTraceTag(537162137,0,50,"FormatCellsAction.CopyBetweenRows: targetRange is null")};mb.prototype.$_f=function(){var e=oh.a.jd(1,0,0,638,0,104573951,"PivotTableContextMenuOperationFailure");Qi.a(this.$).ri(e)};
mb.prototype.Fqi=function(e,C){var M={ValidMembers:32},qa=C.NumberFormat;switch(e){case 1890566896:if(1001===qa||1002===qa||1003===qa){M.NumberFormat=14;M.NumberFormatOptions={};switch(qa){case 1001:M.NumberFormatOptions.TimeType=2;break;case 1002:M.NumberFormatOptions.DateType=7;break;case 1003:M.NumberFormatOptions.DecimalPlaces=0}M.NumberFormatOptions.NumberFormatCategory=this.SFg(qa)}else M.NumberFormat=qa;break;case 1886928607:M.NumberFormat=13;break;case -992833457:M.NumberFormat=11;break;case 218524921:M.NumberFormat=
12;break;case 996232352:M.NumberFormat=14;M.NumberFormatOptions=Object.assign(new Ag.a,{DecimalPlaces:0});M.NumberFormatOptions.NumberFormatCategory=6;break;default:return C}return M};mb.prototype.formatCells=function(e,C,M,qa,Na,Hb,Gc){qa=void 0===qa?null:qa;Na=void 0===Na?null:Na;Hb=void 0===Hb?null:Hb;Gc=void 0===Gc?null:Gc;var gd=this.$.Ub.Fc("UserAction","FormatCellsInstantaneous, command = "+pd.b().pi(e)),Uc=this.$.Ub.Xh("UserAction","FormatCellsInstantaneousFrame");Uc.start();yf.a(Uc);var Wd=
pd.b().pi(e),We=this.$,Gf=Ye.g(We),xg=Gf.ha.va,Hg=Na||xg.selectedRanges,Ig=xd.g(Hg,function(Jk){return Jk.HT});Wd=String.format("{0}, cellCount={1}",Wd,Ig);Ye.g(this.$).Ji.Y6(1,gd.id,Wd);Hg=jg.r(Hg,this.$);xg=xg.activeCell;Wd=-168056295===M.command;var Hh=Ig=null;if(Wd){Hh=Gf.Vb.nq(xg);if(!Hh){this.$_f();return}Ig=Hh.fca.substring(1,Hh.fca.length-1);Hh=Hh.b$b();if(!Hh){this.$_f();return}Hh=Hh.Caption}Gf.Bh.qG(!1,!0);var jj=jg.o(xg,We),Kj=We.qa.ta.Xb(!0),Qj=this.Fqi(M.command,C);Wd||this.gna(Gf,e,
C,!1,qa,Na);gd.stop();Ye.g(this.$).Ji.n0(gd.id,gh.BasicTelemetryCalculator.sQ);M.F6h=Xg.a.Ra.Kb;qa=this.$.Ub.Fc("UserAction","FormatCellsUserAction");this.Ymi(e,M.taskId,C,Hg,xg,qa.id);pd.b().CB(gd.id,qa.id,"actions","actions");pd.b().CB(Uc.id,qa.id,"actions","actions");kd.EwaSettings.tc()?We.userOperationManager.ic(new Qc(this,Hg,jj,Qj,Wd,Ig,Hh,Kj,qa,gd.id,64,Hb,Gc),M):We.userOperationManager.ic(new Qc(this,Hg,jj,Qj,Wd,Ig,Hh,Kj,qa,gd.id,0,Hb,Gc),M)};mb.prototype.u2=function(e,C,M,qa,Na,Hb,Gc,gd,
Uc,Wd,We){var Gf=this,xg=this.$;return function(Hg,Ig,Hh){xg.Xu();Hg=[Hg,Gf.bDi];Ig=[Ig];Wd&&Hg.push(Wd);We&&Ig.push(We);return vf.q(xg.qa.ta,e,C,M,qa,Na,Hb,lh.b.apply(null,Hg),lh.a.apply(null,Ig),Hh,Uc,Gc,gd)}};mb.prototype.Jsj=function(e,C,M,qa,Na,Hb){if(C&&M){var Gc=M.Font,gd=M.HorizontalAlignment,Uc=M.VerticalAlignment;M.ValidMembers&2||(gd=C.horizontalAlignment);M.ValidMembers&1||(Uc=C.verticalAlignment);var Wd=!!gd;mb.G8h(e)&&!gd&&(gd=this.lXe(C));var We=!1;switch(e){case -394785302:this.cua.qbb(C,
gd,Wd,0);break;case 1041132226:this.cua.qbb(C,gd,Wd,1);break;case -571165336:this.cua.qbb(C,gd,Wd,2);break;case -1150205178:case -1142465846:case -286432209:this.cua.qbb(C,gd,Wd,Uc,!1,!1);break;case 1650812936:this.setFillColor(C,M,Hb);break;case -287251124:C.bold=Gc.Bold;break;case -1690267012:Ye.g(this.$).ha.va.Dh&&(Gc=Ye.g(this.$).ha.va.Qd,this.cua.lIb(C,M,Gc));break;case 1970784898:M=zj.a.Gp(C.color,C.backgroundColor);if(Cf.a.compare(M,Cf.a.red)&&(K.a.jV(C.text)||K.a.f4e(C.text)))break;Gc=Cf.a.GG(Gc.FontColor);
C.color=ai.c(zj.a.zF(Gc));break;case -1925065947:C.italic=Gc.Italic;break;case -1293291468:M=kd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");C.eMd(Gc.FontName,M,"ShowInstantaneousFormattingOnCell");break;case 862890474:case 963349338:C.fontSize=Gc.FontSize;this.$.Gf();break;case -1077965542:C.fontSize=Gc.FontSize;break;case 1764140053:C.underline=Gc.Underline;break;case -1685033574:C.doubleUnderline=Gc.DoubleUnderline;break;case -1590502662:C.fontStrikethrough=
Gc.Strikethrough;break;case -848953656:case 2045211913:We=C.Tob();break;case 2105621672:Gc=Object(qc.a)(Ck.a,Na);if(!Gc)break;M=Cf.a.czh(Gc.color);C.color=ai.c(zj.a.zF(M));this.Qoe(C,Gc.W7a);break;case -1409276245:this.Qoe(C,M.NumberFormatOptions.CustomFormatString);break;case 1890566896:this.cGg(C,M);break;case -1228228458:C.Tob();C.clearFormat();this.OUc(C,0);We=!0;break;case -730106152:C.clearFormat();this.OUc(C,0);break;case 932244020:this.phj(C,M,Hb);break;case -1942512156:case -1920201820:this.ijj(C,
M)}qa||(We?C.K$a(!0):C.setCell(!0))}else Dd.ULS.shipAssertTag(537162135,0,!C,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellToFormat"),Dd.ULS.shipAssertTag(537162134,0,!M,"FormatCellsAction.ShowInstantaneousFormattingOnCell empty cellFormat")};mb.prototype.QZg=function(e,C){e&&C?(e.bpb(C),e.a_c(C),this.OUc(e,C.cell.Gm)):Dd.ULS.sendTraceTag(537162133,0,10,"FormatCellsAction.CopyFormattingBetweenCells:cellToFormat & sourceCell should not be null")};mb.prototype.OUc=function(e,C){if(0>
C)this.XZ("ApplyNumberFormatIndexOnCell",e,!1,"ApplyNumberFormatIndexOnCell: negative format index was supplied");else if(C=new jd(this.Al,this.Np,C),C.isValid()){var M=this.N1a(e.aL,C,e.cell.aSa,e.cell.Fsa);Object(Wg.b)(M)?this.XZ("ApplyNumberFormatIndexOnCell",e,!1,M.reason):(this.Umb(e,M.value),this.XZ("ApplyNumberFormatIndexOnCell",e,!0,void 0,M.value,C))}else this.XZ("ApplyNumberFormatIndexOnCell",e,!1,"ApplyNumberFormatIndexOnCell: invalid number format holder")};mb.prototype.Qoe=function(e,
C){if(void 0===C||null===C)this.XZ("ApplyNumberFormatStringOnCell",e,!1,"ApplyNumberFormatStringOnCell: no format string was supplied");else if(C=new jd(this.Al,this.Np,void 0,C),C.isValid()){var M=this.N1a(e.aL,C,e.cell.aSa,e.cell.Fsa);Object(Wg.b)(M)?this.XZ("ApplyNumberFormatStringOnCell",e,!1,M.reason):(this.Umb(e,M.value),this.XZ("ApplyNumberFormatStringOnCell",e,!0,void 0,M.value,C))}else this.XZ("ApplyNumberFormatStringOnCell",e,!1,"ApplyNumberFormatIndexOnCell: invalid number format holder")};
mb.prototype.cGg=function(e,C){if(C=void 0===C?null:C)if(C=this.rQh(e,C),C.success){var M=this.N1a(e.aL,C.wkc,e.cell.aSa,e.cell.Fsa);Object(Wg.b)(M)?this.XZ("ApplyNumberFormatCategoryOnCell",e,!1,M.reason,void 0,C.wkc):(this.Umb(e,M.value),this.XZ("ApplyNumberFormatCategoryOnCell",e,!0,void 0,M.value,C.wkc))}else this.XZ("ApplyNumberFormatCategoryOnCell",e,!1,C.reason,void 0,C.wkc);else this.XZ("ApplyNumberFormatCategoryOnCell",e,!1,"ApplyNumberFormatCategoryOnCell: no format was supplied")};mb.prototype.SFg=
function(e){switch(e){case 1004:return 1;case 5:return-1;case 1002:return 4;case 6:case 1001:return 5;case 7:case 1003:return 6;case 8:return 7;case 9:return 8;case 10:return 9}return 10<e?-1:e};mb.prototype.rQh=function(e,C){if(!this.Al||!this.localeInfo||!C)return e=this.Al?this.localeInfo?"cellFormat is null":"localeInfo is null":"instantaneousManager is null",new rd(!1,void 0,"GetRibbonNumberFormat: "+e);C=C.NumberFormat;switch(C){case 0:e=ee.Bzh;break;case 1:e=ee.Dzh;break;case 2:e=ee.zzh;break;
case 3:e=ee.xzh;break;case 4:e=ee.Gzh;break;case 5:e=ee.Czh;break;case 6:e=ee.Izh;break;case 7:e=ee.Ezh;break;case 8:e=ee.Azh;break;case 9:e=ee.Fzh;break;case 10:e=ee.Hzh;break;case 11:case 12:return this.Al.VRe(),this.UGh(e,C);case 13:e=ee.SNg;break;case 1006:e=ee.buttonPercentage;break;case 1004:e=ee.keyboardNumber;break;case 1005:e=ee.keyboardCurrency;break;case 1002:e=ee.keyboardDate;break;case 1001:e=ee.keyboardTime;break;case 1003:e=ee.keyboardPercentage;break;case 14:return e="GetRibbonNumberFormat: should not be called with NumberFormatDialog!",
Dd.ULS.shipAssertTag(537162132,0,!1,e),new rd(!1,void 0,e);default:return e="GetRibbonNumberFormat: unknown NumberFormatType!",Dd.ULS.shipAssertTag(537162131,0,!1,e),new rd(!1,void 0,e)}if(!e)return new rd(!1,void 0,"GetRibbonNumberFormat: unsupported ribbonFormatKind...");e=excelOnlineCalc.numfmt.getRibbonFormat(this.localeInfo,e);if(!e)return new rd(!1,void 0,"GetRibbonNumberFormat: ExcelOnlineCalcService.NumberFormatter.GetRibbonNumberFormat unable to get ribbon format...");e=new jd(this.Al,this.Np,
void 0,e);return new rd(!0,e)};mb.prototype.UGh=function(e,C){if(!this.calcManager||!this.Np)return C=this.calcManager?"numberFormatter is null":"calcManager is null",new rd(!1,void 0,"GetDecimalChangeNumberFormat: "+C);e=this.calcManager.Hdd(new jd(this.Al,this.Np,e.cell.Gm));if(!e)return new rd(!1,void 0,"GetDecimalChangeNumberFormat: currentFormat is null");C=this.Np.changeFormatDecimals(e,11===C?1:-1);if(!excelOnlineCalc.util.isSuccess(C))return new rd(!1,void 0,"GetDecimalChangeNumberFormat: NumberFormatter.ChangeFormatDecimals failure");
if(void 0===C.value||null===C.value)return new rd(!1,void 0,"GetDecimalChangeNumberFormat: successUndefined result");C=new jd(this.Al,this.Np,void 0,void 0,C.value);return new rd(!0,C)};mb.prototype.XZ=function(e,C,M,qa,Na,Hb){qa=void 0===qa?"":qa;Na=void 0===Na?null:Na;Hb=(Hb=void 0===Hb?null:Hb)?Hb.mE?Hb.mE.toString():K.a.Mmb(Hb.formatString):"null";var Gc=K.a.Mmb(C.aL.value)||"null";Na=Na?K.a.Mmb(Na.text)||"null":"null";e=String.format("FormatCellsAction.LogNumberFormatEdit: {{ caller: '{0}', range: '{1}, {2}', success: '{3}', reason: '{4}', value: '{5}', valueType: '{6}', ifmt: '{7}', prediction: '{8}' }}",
e,C.range.top,C.range.left,M,qa,Gc,C.aL.type,Hb,Na);Dd.ULS.sendTraceTag(537162130,0,50,e)};mb.prototype.dGg=function(e,C,M,qa,Na,Hb,Gc,gd,Uc,Wd,We){gd=void 0===gd?!1:gd;Uc=void 0===Uc?!1:Uc;var Gf=C.cell;Gf.JT=void 0===Wd?0:Wd;Wd=C.text;Wd!==M&&(Gf.text=M);Gf.T7a=void 0===We?null:We;bh.e(Wd)?C.formulaBarText=Wd:C.formulaBarText="";e=Ye.g(e).Vb.Rcf(C.range);this.DYc(C,qa,null,gd,Uc,e);Na&&(C.color=ai.c(zj.a.zF(Na)));C.cell.Gm=Hb;C.cell.fnc=Gc;C.cell.DQd=Hb};mb.prototype.Ymi=function(e,C,M,qa,Na,Hb){var Gc=
{};Gc.a=this.$.ya.UserSessionId;Gc.b=C;Gc.c=qa.Ranges.length;Gc.d=this.N2g(qa.Ranges);Gc.e=Na.toString();Gc.f=e;Gc.h=Hb;1890566896===e?Gc.g=M.NumberFormat.toString():2105621672===e&&(Gc.g=M.NumberFormatOptions.NumberFormatCategory.toString());pd.b().Ne(3,Gc,!0)};mb.prototype.N2g=function(e){if(kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5656060_logRangesAccomulativeDataForFormatCellInvestigation")){for(var C=0,M=0,qa=0,Na=0;Na<e.length;Na++){var Hb=jg.B(e[Na]).HT;C+=Hb;Hb>qa&&(qa=Hb,M=Na)}e=jg.B(e[M]).toString();
return"TotalCellCount:"+C+"; Max range:"+e+"; MaxRangeSize:"+qa+";"}C=Math.min(mb.Ilf,e.length);qa="";for(M=0;M<C;M++)qa+=jg.B(e[M]).toString()+" ; ";e.length>mb.Ilf&&(qa+="and more");return qa};mb.prototype.phj=function(e,C,M){64===(C.ValidMembers&64)&&this.setFillColor(e,C,M);16===(C.ValidMembers&16)&&mb.Oij(e,C);128===(C.ValidMembers&128)&&this.cua.lIb(e,C,e.range);if(2===(C.ValidMembers&2)||1===(C.ValidMembers&1)){M=C.VerticalAlignment;C=C.HorizontalAlignment;var qa=!!C;kd.EwaSettings.isChangeGateEnabled("OfficeVSO:3603507_calculateHorizontalAlignmentOnToggle")&&
!qa&&this.lXe(e);this.cua.qbb(e,C,qa,M)}};mb.prototype.setFillColor=function(e,C,M){(kd.EwaSettings.isChangeGateEnabled("OfficeVSO:3634588_NoFillColorOnConditionalFormattingCell")?e.vaa:e.vaa&&e.Jbc&&!e.rvb&&!e.Nbc)||(C=-1===C.FillColor?M?zj.a.zF(Cf.a.white):null:zj.a.zF(Cf.a.GG(C.FillColor)),e.backgroundColor=C?ai.c(C):null)};mb.prototype.ijj=function(e,C){e.horizontalAlignment&&2!==e.horizontalAlignment||e.N6(1,!1);0<=e.indentation+C.IndentationIncrease&&(e.indentation+=C.IndentationIncrease)};
mb.prototype.lXe=function(e){var C=new jd(this.Al,this.Np,e.cell.Gm);if(!C.isValid())return 0;e=this.N1a(e.aL,C,e.cell.aSa,e.cell.Fsa);return Object(Wg.b)(e)?0:null!=e.value.horizontalAlignment?e.value.horizontalAlignment:0};mb.prototype.skj=function(e,C,M){this.gY||(this.gY=new Yd(Ye.g(this.$).Ca,this.$));this.gY.lIb(e,C,M)};mb.prototype.WXh=function(e,C){var M=new Rh.a;if(e.cell.formulaBarText&&e.cell.formulaBarText.startsWith("'"))M.Text=e.cell.formulaBarText;else{var qa=e.cellValue;qa&&4!==e.cell.JT||
(qa=e.text);M.Text=qa}this.pRa(C,M,!1,void 0,fg.a.Amd(this.$));return!0};mb.prototype.Ipj=function(e,C){return this.zg&&!!e&&!!C};mb.bXg=function(e,C,M,qa){qa&&C.setCell(!0);M||e.Ca.gV()};mb.expandRange=function(e,C){C=C.clone();C.height<e.height&&(C.bottom=C.top+e.height-1);C.width<e.width&&(C.right=C.left+e.width-1);return C};mb.G8h=function(e){switch(e){case -1142465846:case -1150205178:case -286432209:case -571165336:case 1041132226:case -394785302:return!0;default:return!1}};mb.Oij=function(e,
C){C=C.Font;var M=!!(C.ValidMembers&16),qa=!!(C.ValidMembers&16),Na=!!(C.ValidMembers&16);e.bold=!!(C.ValidMembers&4);e.italic=!!(C.ValidMembers&8);M&&(e.underline=M);qa&&(e.doubleUnderline=qa);Na&&(e.fontStrikethrough=Na);M=kd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");e.eMd(C.FontName,M,"SetFont");e.fontSize=C.FontSize;M=zj.a.Gp(e.color,e.backgroundColor);Cf.a.compare(M,Cf.a.red)&&(K.a.jV(e.text)||K.a.f4e(e.text))||(C=Cf.a.GG(C.FontColor),e.color=ai.c(zj.a.zF(C)))};
tl.Object.defineProperties(mb.prototype,{cua:{configurable:!0,enumerable:!0,get:function(){return this.Xxh}},Np:{configurable:!0,enumerable:!0,get:function(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.Np}},localeInfo:{configurable:!0,enumerable:!0,get:function(){return void 0===this.calcManager||null===this.calcManager?null:this.calcManager.localeInfo}}});mb.Ilf=10;mb.kwh=36;Object(sd.a)(mb,"FormatCellsAction",null,[579,3]);var Mh=vb.a;vm(Nb,Mh);Nb.prototype.create=
function(){this.Fb(new mb(this.$))};Nb.ja=function(e){e.da.Ha(18,new Nb(e))};Object(sd.a)(Nb,"FormatCellsActionFactory",vb.a,[]);Object(sd.a)(nc,"FormulaAssistanceUIContext",null,[]);var Hj=vb.a;vm(ib,Hj);ib.prototype.create=function(){var e=this,C=this.$.da.Aa(448);if(C)this.Fb(C);else{var M=td.GetServiceTaskFactory.Xa(this.$.da,283,284,this.tb);wf.TaskExtensions.Ba(M,function(){wf.TaskExtensions.Ba(qe.c(M.result.wo.loadScript(e.kdj)),function(){C=e.$.da.Aa(448);if(!C){var qa=Object.assign(new nc,
{isFeedbackAllowed:e.$.isFeedbackEnabled});C=e.$.da.Ha(448,formulaAssistance.FormulaAssistanceUIFactoryGlobal.create(qa));e.$.tve(function(){var Na={};Na.isFeedbackAllowed=e.$.isFeedbackEnabled;C.updateContext(Na)})}e.Fb(C)},e.$.ma,3)},this.$.ma,3)}};ib.ja=function(e){e.da.Ha(449,new ib(e))};Object(sd.a)(ib,"FormulaAssistanceUIControlFactory",vb.a,[]);var fi=b(690);Object(sd.a)(id,"FreezePanesCommandParameters",null,[]);var Dj=b(174),L=b(386),Ea=b(263),Pb=b(284),yc=b(118);gb.prototype.getSheetName=
function(){return this.freezeOptions.SheetName};Object(sd.a)(gb,"MacroRecorderSheetPaneFrozenPayload",null,[116]);wc.prototype.Xc=function(e,C){var M=!1;switch(C){case 1844679312:M=1!==e&&!this.gridView.$a.n4}return M};wc.prototype.executeCommand=function(e,C){e=this.gridView.$a;var M=this.gridView.Lfd();hd.AFrameworkApplication.sa.Pa.Cx&&this.$.nka&&(1844679312===C.command||340334732===C.command||-806625837===C.command)&&fi.ShyRibbon.tP(1,2);switch(C.command){case 1844679312:return this.setFreezePanes(C,
M,e.Zi);case 340334732:return e.i8b?Fg.Task.Ta(!1):this.Sij(C,M);case -806625837:return e.rSa?Fg.Task.Ta(!1):this.Tij(C,M)}return Fg.Task.Ta(!1)};wc.prototype.Gc=function(e,C){e=!1;switch(C.command){case 1844679312:case 340334732:case -806625837:case 1745254833:e=!0}return e};wc.prototype.fd=function(){return!1};wc.prototype.setFreezePanes=function(e,C,M){if(M)return this.otc(e,!1,0,0,0,0,C,null);var qa=this.gridView.ha.va;M=qa.activeCell.clone();qa=qa.activeRange;qa.Lh&&(Dd.ULS.sendTraceTag(537159585,
0,50,"FreezePanesCommandHandler.SetFreezePanes: activeRange is a column. updating firstUnfreezeCell.Top ({0}) and firstUnfreezeCell.Bottom ({1}) to equal topLeftRange.Top ({2})",M.top,M.bottom,C.top),M.top=M.bottom=C.top);qa.isRow&&(Dd.ULS.sendTraceTag(537159584,0,50,"FreezePanesCommandHandler.SetFreezePanes: activeRange is a row. updating firstUnfreezeCell.Left ({0}) and firstUnfreezeCell.Right ({1}) to equal topLeftRange.Left ({2})",M.left,M.right,C.left),M.left=M.right=C.left);M.top===C.top&&M.left===
C.left&&(M=Ug.Range.ld(M.top+1,M.left));qa=M.top-1;var Na=M.left-1,Hb=qa-(C.top-1),Gc=Na-(C.left-1);return this.pNj(M,Hb,Gc)?this.otc(e,!0,qa,Na,Hb,Gc,C,M):(this.$.Gf(),this.KBf(),Fg.Task.Ta(!0))};wc.prototype.Sij=function(e,C){return this.otc(e,!0,0,C.left,0,1,C,null)};wc.prototype.Tij=function(e,C){return this.otc(e,!0,C.top,0,1,0,C,null)};wc.prototype.pNj=function(e,C,M){var qa=this.gridView.Lg(e),Na=this.gridView.view.visibleArea;return!qa||Na.topLeft.y>qa.bottomRight.y||Na.topLeft.x>qa.bottomRight.x||
Na.bottomRight.y<qa.bottomRight.y||Na.bottomRight.x<qa.bottomRight.x?(Dd.ULS.sendTraceTag(537159583,0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create freeze pane when active cell not in view, range={0}, rangeViewportArea={1}, visibleArea={2}",e,qa?qa.toString():"null",Na.toString()),e=oh.a.jd(1,0,26,1439,0,2105967339,"FreezePaneSelectionNotInViewErr"),kd.EwaSettings.az()?new Jg.a(this.$,e):(e=new Oh.ErrorDialog(this.$,e),e.initialize(),e.mf()),!1):0>=C&&0>=M?(Dd.ULS.sendTraceTag(537159582,
0,50,"FreezePanesCommandHandler.ValidateFreezePanesRange: User tried to create empty freeze pane"),e=Ye.g(this.$).rtl?1441:1440,C=Ye.g(this.$).rtl?-2131054257:-1953454131,e=oh.a.jd(1,0,26,e,0,C,"FreezePaneA1SelectedErr"),kd.EwaSettings.az()?new Jg.a(this.$,e):(e=new Oh.ErrorDialog(this.$,e),e.initialize(),e.mf()),!1):!0};wc.prototype.otc=function(e,C,M,qa,Na,Hb,Gc,gd){function Uc(){return new gb(We)}var Wd=this;this.gDd=Qi.a(this.$).i9(5,"SendFreezePanesRequest","SendFreezePanesRequest");this.gridView.hT(this.euf);
this.RE.jAa();this.gridView.oxj(C?"":"UnsetFreezePane");this.mlj(e,C,this.gridView.$a);var We=Object.assign(new id,{SheetName:this.$.oa.name,Freeze:C,FrozenRows:Na,FrozenColumns:Hb,FirstRow:M,FirstColumn:qa});Dd.ULS.sendTraceTag(573101852,0,50,"FreezePanesCommandHandler.SendFreezePanesRequest: Freeze={0}, FrozenRows={1}, FrozenColumns={2}, FirstRow={3}, FirstColumn={4} ",C,Na,Hb,M,qa);this.S8b=Xg.a.Ra.re;return wg.a(this.$.userOperationManager,function(Gf,xg,Hg){if(kd.EwaSettings.la(60)){var Ig=window.performance;
Ig.clearMarks();Ig.mark("FreezePanes request sent")}Ig=Wd.gridView.ns;Wd.$.la(720)&&Ig?(Ig=Wd.Mhh(We,Ig,Gc,gd),Wd.nEj(Ig)):Wd.$.Xu();Ig=Wd.$.qa.ta;var Hh=Ig.Oa(9,null);Hh.freezeSettings=We;return vf.i(Ig,"FreezeOrUnfreezePanes",Hh,Gf,xg,Hg,C,0)},function(Gf){return new mg.a(151,0,Gf,void 0,Uc)},e)};wc.prototype.Mhh=function(e,C,M,qa){Dd.ULS.shipAssertTag(537159580,1,!!C,"FreezePaneCommandHandler.EstimatePaneViewDataOnPaneRequest: called with null Sheet Processed Data");if(!e.Freeze)return null;var Na=
Pb.a();Na.State=1;Na.IsEstimated=!0;var Hb=!1,Gc=!1,gd=C.DU(Ug.Range.ld(M.top,M.left)),Uc=e.FrozenRows,Wd=e.FrozenColumns;1!==e.FrozenRows||e.FrozenColumns?e.FrozenRows||1!==e.FrozenColumns?(Wd=C.DU(Ug.Range.ld(e.FirstRow+1,e.FirstColumn+1)),C=C.DU(Ug.Range.ld(M.top,M.left)),Na.Width=Wd.Xl-gd.Xl,Na.Height=Wd.Mm-gd.Mm,0<e.FrozenRows&&(Na.AbsoluteTop=Wd.Mm,Gc=!0),0<e.FrozenColumns&&(Na.AbsoluteLeft=Wd.Xl,Hb=!0),Uc=Wd.LK-C.LK,Wd=Wd.lJ-C.lJ):(Na.Width=C.wPh(Dj.a.ld(M.top,M.left)),qa=Ug.Range.ld(M.top,
M.left+1),Na.AbsoluteLeft=gd.Xl+Na.Width,Hb=!0):(Na.Height=C.uPh(Dj.a.ld(M.top,M.left)),qa=Ug.Range.ld(M.top+1,M.left),Na.AbsoluteTop=gd.Mm+Na.Height,Gc=!0);Gc&&(Na.FirstFrozenRow=M.top,Na.FirstScrollableRow=qa.top);Hb&&(Na.FirstFrozenColumn=M.left,Na.FirstScrollableColumn=qa.left);Na.VisibleRows=Uc;Na.VisibleColumns=Wd;return Na};wc.prototype.nEj=function(e){var C=this;Fg.Task.delay(this.$.ya.GetRangeContentPrefetchDelayInMs).continueWith(function(){C.$.oa&&C.$.fa&&(C.$.fa.ZW(Mi.a.Se,"FreezePaneCommandHandler.TriggerDelayActiveItemPaneChange"),
L.b(C.$.oa,e,-1,void 0,!0))})};wc.prototype.mlj=function(e,C,M){if(!kd.EwaSettings.la(691))switch(e.command){case 1844679312:if(C||-1===this.gKa&&-1===this.hKa)this.gKa=M.Pw-M.width+this.gridView.scrollLeft,this.hKa=M.Qw-M.height+this.gridView.scrollTop;break;case 340334732:if(C||-1===this.gKa)this.gKa=M.Pw-M.width+this.gridView.scrollLeft;break;case -806625837:if(C||-1===this.hKa)this.hKa=M.Qw-M.height+this.gridView.scrollTop}};wc.prototype.Irc=function(){var e=this.gridView.$a;0<e.width?this.gridView.scrollLeft=
yc.a.e_b(this.gridView.domElement,Ye.g(this.$).rtl,0):-1!==this.gKa&&(this.gridView.scrollLeft=this.gKa,this.gKa=-1);0<e.height?this.gridView.scrollTop=0:-1!==this.hKa&&(this.gridView.scrollTop=this.hKa,this.hKa=-1)};wc.prototype.KBf=function(){this.RE.NRa();ff.a.Fa(this.gDd);this.gDd=null;this.gridView.wN(this.euf)};Object(sd.a)(wc,"FreezePanesCommandHandler",null,[237]);var Wc=cf.a;vm(ed,Wc);ed.prototype.Md=function(){var e=this;wf.TaskExtensions.Ba(td.GetServiceTaskFactory.Xa(this.$.da,12,477,
this.tb),function(C){e.Ed([new wc(e.$,C.result)])},this.$.ma)};ed.ja=function(e){e.da.Ha(116,new ed(e))};Object(sd.a)(ed,"FreezePanesCommandHandlerFactory",cf.a,[]);var Ke=b(938),Fe=vb.a;vm(oc,Fe);oc.prototype.create=function(){var e=this,C=td.GetServiceTaskFactory.create(this.$.da,18,this.ma,this.tb),M=td.GetServiceTaskFactory.create(this.$.da,102,this.ma,this.tb);wf.TaskExtensions.Ba(wf.TaskExtensions.ve([C,M],this.ma),function(){e.Fb(e.$.da.Aa(296)||e.$.da.Ha(296,new Ke.BorderFormatManager(e.$,
C.result,M.result)))},this.ma,3)};oc.ja=function(e){kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")&&e.da.Ha(468,new oc(e))};Object(sd.a)(oc,"BorderFormatManagerFactory",vb.a,[]);var uf=b(959),Mf=b(23),Gg=b(100),wh=b(275),Pf=b(353),hh=b(350),zi=b(93),vi;(function(e){e[e.insert=1]="insert";e[e.delete=2]="delete";e[e.rows=4]="rows";e[e.columns=8]="columns";e[e.cellsShiftHorizontal=16]="cellsShiftHorizontal";e[e.cellsShiftVertical=32]="cellsShiftVertical";e[e.insertRows=
5]="insertRows";e[e.insertColumns=9]="insertColumns";e[e.insertCellsShiftRight=17]="insertCellsShiftRight";e[e.insertCellsShiftDown=33]="insertCellsShiftDown";e[e.deleteRows=6]="deleteRows";e[e.deleteColumns=10]="deleteColumns";e[e.deleteCellsShiftLeft=18]="deleteCellsShiftLeft";e[e.deleteCellsShiftUp=34]="deleteCellsShiftUp"})(vi||(vi={}));Object(sd.b)("InsertDeleteCellFlags",vi);var Ai=b(415);Object(sd.a)(Jf,"MacroRecorderRangeInsertedOrDeletedPayload",null,[116]);var kj=b(119),mj=b(253),bj=b(1144);
b(823);Ce.prototype.bTe=function(e,C,M){var qa=Object.assign(new nb.a,{Id:"FontDropdownMenu"});qa.MenuSectionList=[];var Na=Object.assign(new Wb.a,{ControlsId:"FontsMenuSectionControl"});Na.ControlList=this.pJh(e,C,M);Array.add(qa.MenuSectionList,Na);return qa};Ce.prototype.pJh=function(e,C,M){var qa=[],Na=this.n9h&&!this.Ccf;Ce.J$c||Ce.v4h();var Hb=Ce.J$c,Gc;for(Gc in Hb){var gd=Gc,Uc=Hb[Gc],Wd=dh.a.Mf(gd),We=dh.a.Mf(ab.HelperMethods.ERd[gd]);gd=dh.a.Mf(gd);Na||(Uc=0);Wd=Object.assign(new bj.a,{MenuItemId:Wd,
CommandValueId:Wd,LabelText:Na&&0<Uc?dh.a.Mf(String.fromCodePoint(Uc)):We,LabelCss:String.format("font-size:12pt;font-family:{0};",Na&&0<Uc?"msofp":gd),Styles:Ce.hac(Na&&0<Uc?"msofp":gd),AriaLabel:We,Alt:We,Command:e.toString(),CommandPreviewId:C.toString(),CommandRevertId:M.toString()});Array.add(qa,Wd)}Na&&gridRenderer.CanvasRendererGlobals.loadPreviewFont(this.qIi);return qa};Ce.v4h=function(){var e={};Ce.J$c=(e["Angsana New"]=983046,e["Arial Black"]=983051,e.Arial=983050,e.Batang=983061,e["Book Antiqua"]=
983077,e["Browallia New"]=983082,e.Calibri=983085,e.Cambria=983089,e.Candara=983091,e.Century=983095,e["Comic Sans MS"]=983100,e.Consolas=983101,e.Constantia=983102,e.Corbel=983106,e["Cordia New"]=983107,e["Courier New"]=983109,e.DilleniaUPC=983121,e.Dotum=983123,e.FangSong=983138,e.Garamond=983154,e.Georgia=983156,e.Gulim=983182,e.GungSuh=983186,e.KaiTi=983222,e.JasmineUPC=983218,e["Malgun Gothic"]=983258,e.Mangal=983262,e.Meiryo=983264,e["Microsoft JhengHei"]=983272,e["Microsoft YaHei"]=983284,
e.MingLiU=983292,e.MingLiU_HKSCS=983296,e["MS Gothic"]=983245,e["MS Mincho"]=983247,e["MS PGothic"]=983249,e["MS PMincho"]=983251,e.PMingliU=983322,e["PMingLiU-ExtB"]=983324,e.SimHei=983382,e.SimSun=983384,e["SimSun-ExtB"]=983386,e["Source Sans Pro"]=983396,e.Tahoma=983405,e.THSarabunPSK=983404,e["Times New Roman"]=983415,e["Trebuchet MS"]=983419,e.Verdana=983443,e["Yu Gothic"]=983464,e["Yu Mincho"]=983474,e)};Ce.hac=function(e){var C={};C["font-family"]=e;C["font-size"]="12pt";return{optionText:C}};
Ce.J$c=null;Object(sd.a)(Ce,"FontDropdownHelper",null,[]);Pd.KMg=function(e,C){return new Pd(e,C,null,null)};Pd.aXc=function(e,C){return new Pd(e,null,C,null)};Pd.LMg=function(e,C){return new Pd(e,null,null,C)};tl.Object.defineProperties(Pd.prototype,{O1a:{configurable:!0,enumerable:!0,get:function(){return this.ykg}},formattedText:{configurable:!0,enumerable:!0,get:function(){return this.zkg}},style:{configurable:!0,enumerable:!0,get:function(){return this.osg}},size:{configurable:!0,enumerable:!0,
get:function(){return this.eVb}}});Object(sd.a)(Pd,"CachedPreviewCellGroup",null,[]);var fj=b(64);Ad.prototype.fL=function(){var e=this;this.DBc=!1;if(Ch.b(this.EBa,514846606)){this.DBc=!0;Dd.ULS.sendTraceTag(537159430,0,50,"Merge cells with multiple values");fj.a(this.wf.$).nd.AD(514846606);if(this.yNb&&this.hYd)window.setTimeout(function(){e.wf.B$(e.wf.gridView,e.DBa,!0,!0)},0);else return this.xYd=Ye.g(this.wf.$).rtl,this.zYd=oh.a.jd(3,2,0,this.xYd?625:624,0,514846606,"MergeCellsLoseData"),this.ej=
Qi.a(this.wf.$).ri(this.zYd).G(),this.ej.isCompleted||(this._state=2,this.ej.cN(this.moveNext)),this.wBc;return this.Feb}return this.R0};Ad.prototype.R0=function(){this.wf.Bif(this.DBc,this.hYd,this.bdg.scenario,this.yNb);this._state=3};Ad.prototype.Feb=function(){return this.R0};Ad.prototype.wBc=function(){if(this.zBc=this.ej.Sy())1===this.zBc&&Dd.ULS.sendTraceTag(537159428,0,50,"MergeCellsLoseData Dialog: Cancel pressed");else return Dd.ULS.sendTraceTag(537159429,0,50,"MergeCellsLoseData Dialog: Ok pressed"),
this.ej=this.wf.B$(this.wf.gridView,this.DBa,!0,!1).g(),this.ej.isCompleted||(this._state=2,this.ej.cN(this.moveNext)),this.xBc;return this.Heb};Ad.prototype.Heb=function(){return this.Feb};Ad.prototype.xBc=function(){this.ej.Sy();return this.Heb};Ad.prototype.dispose=function(){};Object(sd.a)(Ad,"$$sm_Microsoft$Office$Excel$WebUI$Client$GridCommandHandler$OnMergeCellsWebMethodSuccessOld",null,[3]);pe.prototype.fL=function(){return Ch.b(this.EBa,514846606)?(Dd.ULS.sendTraceTag(537159427,0,50,"Merge cells with multiple values"),
fj.a(this.wf.$).nd.AD(514846606),this.uYd=Ye.g(this.wf.$).rtl,this.vYd=oh.a.jd(3,2,0,this.uYd?625:624,0,514846606,"MergeCellsLoseData"),this.ej=Qi.a(this.wf.$).ri(this.vYd).G(),this.ej.isCompleted||(this._state=2,this.ej.cN(this.moveNext)),this.Eeb):this.R0};pe.prototype.R0=function(){this._state=3};pe.prototype.Eeb=function(){if(this.CBc=this.ej.Sy())1===this.CBc&&Dd.ULS.sendTraceTag(537159425,0,50,"MergeCellsLoseData Dialog: Cancel pressed");else return Dd.ULS.sendTraceTag(537159426,0,50,"MergeCellsLoseData Dialog: Ok pressed"),
this.ej=this.wf.B$(this.wf.gridView,this.DBa,!0,this.yNb).g(),this.ej.isCompleted||(this._state=2,this.ej.cN(this.moveNext)),this.mdg;return this.Geb};pe.prototype.Geb=function(){return this.R0};pe.prototype.mdg=function(){this.ej.Sy();return this.Geb};pe.prototype.dispose=function(){};Object(sd.a)(pe,"$$sm_Microsoft$Office$Excel$WebUI$Client$GridCommandHandler$OnMergeCellsWebMethodSuccessOldForNonDataLossCSE",null,[3]);var Ni=b(521),Rj=Ni.a;vm(de,Rj);de.prototype.Kh=function(){1896159024===this.$o?
(this.Xn=fe.a.instance.ea(23),this.R4c=0):(this.Xn=fe.a.instance.ea(22),this.R4c=1);var e=this.selectedRanges[0].Z4&&!this.selectedRanges[0].bba?0:1;this.kc=1;var C={};e=(C[de.Ly]=this.xc,C.dialogToDisplay=this.R4c,C.defaultSelectedKey=e,C.isRtl=this.isRtl,C);this.initializeAndShow(this.Xn,this.j6h,e)};tl.Object.defineProperties(de.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"InsertDeleteCellsDialog"}}});Object(sd.a)(de,"InsertDeleteCellsDialog",Ni.a,[]);Object(sd.a)(Vd,"MacroRecorderRangeFilledPayload",
null,[116]);Object(sd.a)(Qd,"RangeBorders",null,[]);Object(sd.a)(bc,"ScenarioInfo",null,[]);Je.prototype.dispose=function(){this.$=null};Je.prototype.w$h=function(e,C){return!(void 0===C||null===C)&&!!(C.scenario&16384)&&155820588!==e&&this.R9e(C,e)};Je.prototype.bYe=function(){var e=nd.a.se(),C=Ye.g(this.$),M=C.ha.va.selectedRanges,qa=0,Na=0,Hb=M.length,Gc=new bc;if(1<Hb)return Gc.scenario=4,Gc;this.Pmd&&Ye.g(this.$).rtl&&(qa|=65536);if(!C.hka(M[0]))if(this.kxb)qa|=32;else return Gc.scenario=32,
Gc;if(C=C.Ca.G2a(M[0],this.$.activeItemName))for(C=yl(C),Hb=C.next();!Hb.done;Hb=C.next())if(Na+=1,1<Na)return this.kxb?(qa|=256,Gc.scenario=qa):Gc.scenario=256,Gc;Na=Ye.g(this.$).Ca.nJa(M[0]);if(!Na)return Gc.scenario=32768,Gc;C=Na.length;M=M[0];Hb=M.bottom-M.top+1;for(var gd=M.right-M.left+1,Uc=new Qd,Wd=0;Wd<C;Wd++)if(this.Ncf&&this.nPh(Na[Wd],M,Uc),qa=qa|(void 0!==Na[Wd].text&&null!==Na[Wd].text&&""!==Na[Wd].text?1:0)|(Na[Wd].FM?2:0)|(Na[Wd].lKa?8:0)|(Na[Wd].ovb?16:0)|(Na[Wd].MJ?64:0)|(Na[Wd].vaa?
128:0),void 0!==Na[Wd].text&&null!==Na[Wd].text&&""!==Na[Wd].text||Na[Wd].lKa)void 0===Gc.RIa||null===Gc.RIa?Gc.RIa=Ye.g(this.$).sc(Na[Wd].getRange()):qa|=16384;this.Ncf&&(Uc.pSa===gd&&(qa|=512),Uc.RFa===gd&&(qa|=2048),Uc.FMa===Hb&&(qa|=4096),Uc.XPa===Hb&&(qa|=1024),0<Uc.pSa&&Uc.pSa<gd||0<Uc.RFa&&Uc.RFa<gd||0<Uc.FMa&&Uc.FMa<Hb||0<Uc.XPa&&Uc.XPa<Hb)&&(qa|=8192);e=nd.a.se()-e;Dd.ULS.sendTraceTag(537159424,0,50,"Execution time of GetMergeCellScenrio is : {0}",e);Gc.scenario=qa;return Gc};Je.prototype.umf=
function(e,C){e=e.command;if(void 0===C||null===C)C=this.bYe();if(!this.R9e(C,e))return!1;var M=Ye.g(this.$).ha.va.selectedRanges,qa=Ye.g(this.$).Ca.nJa(M[0]);if(!qa)return!1;if(kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5993850_HandleSingleCellMergeScenario")&&1===qa.length&&!qa[0].FM)return-167499203===e?(qa[0].N6(2,!0),!0):!1;qa=Ye.g(this.$).ha.va.wA;var Na=this.$.oa.sheetName;switch(e){case -167499203:2===(C.scenario&2)&&this.ofc?this.q8f(M,e):this.ssi(C,M);break;case 1097660126:this.vmf(C,
M);break;case 155820588:this.q8f(M,e);break;default:return!1}Ye.g(this.$).PU(M,qa,Na,null,M[0],null,null,0,"MergeCellCommandAction");return!0};Je.prototype.R9e=function(e,C){if(-255094134===C||this.Pmd&&65536===(e.scenario&65536))return!1;if(this.Hgi(C,e))return this.Ggi(e);this.kxb&&32===(e.scenario&32)&&(e.scenario&=-33);return 32768===e.scenario||16===(e.scenario&16)||4===e.scenario||256===e.scenario||128===(e.scenario&128)||!this.kxb&&32===e.scenario||void 0!==e.RIa&&null!==e.RIa&&e.RIa.C7?!1:
e.scenario?16384===(e.scenario&16384)?kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1):1!==(e.scenario&1)&&8!==(e.scenario&8)||!kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellContentScenarioCse",!1)?!1:!0:!0};Je.prototype.Hgi=function(e,C){return 155820588===e||-167499203===e&&2===(C.scenario&2)&&this.ofc?!0:!1};Je.prototype.Ggi=function(e){if(!kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellUnmergeWithoutBorderScenariosCse",
!1))return!1;this.kxb&&32===(e.scenario&32)&&(e.scenario&=-33);return 32768===e.scenario||4===e.scenario||256===e.scenario||128===(e.scenario&128)?!1:2===(e.scenario&2)&&512!==(e.scenario&512)&&4096!==(e.scenario&4096)&&1024!==(e.scenario&1024)&&2048!==(e.scenario&2048)?!0:!1};Je.prototype.nPh=function(e,C,M){var qa=e.getRange();if(qa.top===C.top)if(e.O3a)M.pSa+=qa.right-qa.left+1;else{var Na=this.gY.oua(qa,0);if(Na){var Hb=yl(Na);for(Na=Hb.next();!Na.done;Na=Hb.next())Na=Na.value,Na.pvb&&(M.pSa+=
Na.getRange().right-Na.getRange().left+1)}}if(qa.left===C.left)if(e.K3a)M.FMa+=qa.bottom-qa.top+1;else if(Na=this.gY.oua(qa,2))for(Hb=yl(Na),Na=Hb.next();!Na.done;Na=Hb.next())Na=Na.value,Na.xvb&&(M.FMa+=Na.getRange().bottom-Na.getRange().top+1);if(qa.bottom===C.bottom)if(e.pvb)M.RFa+=qa.right-qa.left+1;else if(Na=this.gY.oua(qa,1))for(Hb=yl(Na),Na=Hb.next();!Na.done;Na=Hb.next())Na=Na.value,Na.O3a&&(M.RFa+=Na.getRange().right-Na.getRange().left+1);if(qa.right===C.right)if(e.xvb)M.XPa+=qa.bottom-
qa.top+1;else if(e=this.gY.oua(qa,3))for(e=yl(e),Na=e.next();!Na.done;Na=e.next())C=Na.value,C.K3a&&(M.XPa+=C.getRange().bottom-C.getRange().top+1)};Je.prototype.v2i=function(e){e=Ye.g(this.$).Ca.nJa(e);for(var C=e.length,M=1;M<C;M++){var qa=Ye.g(this.$).sc(e[M].getRange());qa.Tob();qa.clearFormat();qa.cell.x2i();qa.K$a(!0)}};Je.prototype.ILj=function(e,C){e.backgroundColor=C.backgroundColor;e.color=C.color};Je.prototype.jQh=function(e,C,M){C.cell.Hjj(M.bottom-M.top,M.right-M.left);if(void 0!==e&&
null!==e){var qa=e.cell.formattedText,Na=Object.assign(new Rh.a,{TextRuns:qa.TextRuns,Fonts:qa.Fonts});Na.Text=void 0!==e.cell.originalText&&null!==e.cell.originalText?e.cell.originalText:void 0!==e.cell.userInput&&null!==e.cell.userInput?e.cell.userInput:qa.Text;this.hi.pRa(C,Na,!1,null,!0,"MergeCells",void 0,2);this.Pmd?C.bpb(e):this.ILj(C,e);C.cell.OZg(e.cell)}this.v2i(M);C.cell.aAc(!1);return C};Je.prototype.ssi=function(e,C){this.vmf(e,C).N6(2,!0)};Je.prototype.vmf=function(e,C){e=e.RIa;var M=
Ye.g(this.$).sc(C[0]);M=this.jQh(e,M,C[0]);Ye.g(this.$).Ca.G9(C[0],this.$.activeItemName).u$f(C[0],!0);return M};Je.prototype.XGj=function(e,C){for(var M=e.length,qa=0;qa<M;qa++){e[qa].cell.aAc();var Na=e[qa].cell.getRange();Na=Ye.g(this.$).Ca.nJa(Na);var Hb=Na.length;if(-167499203===C&&this.ofc){var Gc=0;2===e[qa].cell.rEd||1===e[qa].cell.JT?Gc=3:2===e[qa].cell.JT&&(Gc=1);e[qa].N6(Gc,!1)}for(Gc=1;Gc<Hb;Gc++)Na[Gc].attachCellToModel(),Na[Gc].bpb(e[qa]),-167499203===C&&this.ofc&&Na[Gc].N6(null,!1)}};
Je.prototype.q8f=function(e,C){var M=Ye.g(this.$).Ca.Eua(e[0],this.$.activeItemName),qa=Ye.g(this.$).Ca.G9(e[0],this.$.activeItemName),Na=[];if(void 0!==M&&null!==M&&(e=Ye.g(this.$).Dua(e[0],M),void 0!==e&&null!==e)){for(M=e.$$ge();M.$$mn();)e=M.$$cu(),e.VJ&&(Na.push(e),e.cell.PTg(),qa.u$f(e.cell.getRange(),!1));0<Na.length&&(qa.yf.resetCellLookup(),this.XGj(Na,C))}};Object(sd.a)(Je,"MergeCellCommandAction",null,[]);var Aj=b(105),rk=b(458),Oi=b(375),oi=b(818);od.prototype.Nbi=function(e){return 1896159024===
e||-1554384558===e||-1113896058===e||1554436520===e||1415868706===e||674605324===e||1035996630===e};od.prototype.Xc=function(e,C){return 2054778433===C&&e&1?!$g.a(this.$).$fc:600686207===C?!1:this.Nbi(C)&&hi.a.any(this.gridView.ha.va.selectedRanges,function(M){return M.Lh||M.isRow})&&!this.Fdf&&!this.Cdf?!0:this.rgc(e,C)};od.prototype.executeCommand=function(e,C,M){return this.Zb(C,M)};od.prototype.Gc=function(e,C,M){if(e=1===e)switch(C.command){case 1457172838:case 2036397036:case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:case 1886928607:case -992833457:case 218524921:case 996232352:case -167499203:case -255094134:case -693675336:case 322710748:case 1097660126:case 155820588:case 1896159024:case -1554384558:case 504848446:case 1504715724:case 1872288872:case 41465729:case -1451655532:case 1972143101:case -475861485:case -978843926:case 2098035706:case -2142700828:case 1405660955:case 1983983164:case 478842689:case -798660877:case -653661711:case 862890474:case 963349338:case 1012765228:case 1597684571:case -1832800737:case -1920201820:case -1942512156:case -600086683:case -208772570:case -987339782:case 748067091:case -381232414:case 1696566924:case 894341014:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:case -1770246794:break;
case -1077965542:case 909774670:case -1904244080:case -1293291468:case 324978188:case -1428968098:case 1970784898:case -803000997:case -128950598:case 1688184685:case 87208751:case -446735083:case 1650812936:case 673562736:case -1690267012:case -236759591:case -1803452024:case -2118943501:case 1890566896:case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:case 886009118:case 165054436:case 1981714220:case -556441918:case 942362098:case 622604322:case 1405456548:case 284490184:case 1256700402:case -1756763834:case -1418159950:e=
!!M;break;case 862825906:case 1532790410:case 46555851:case -1522760979:e=!0;break;default:e=!1}return e};od.prototype.fd=function(e,C,M){switch(C){case "PopulateFontColor":M.MenuItems=this.UA.O9b(1970784898,-803000997,532,null,null,-128950598,2036397036,1688184685,862825906,M.MenuId);break;case "PopulateFillColor":M.MenuItems=this.UA.O9b(1650812936,null,null,87208751,530,673562736,1457172838,-446735083,1532790410,M.MenuId);break;case "PopulateBorderColor":M.MenuItems=this.UA.O9b(-236759591,-1803452024,
532,void 0,void 0,void 0,void 0,void 0,46555851,M.MenuId);break;case "PopulateBorderStyle":this.borderFormatManager.$Xh(M);break;case "PopulateFontDropdown":case "PopulateFontRTFDropdown":M.MenuItems=this.Lxh.bTe(-1293291468,324978188,-1428968098);break;default:return!1}return!0};od.prototype.rgc=function(e,C){var M=Ye.g(this.$).ha.va.selectedRanges;return!(new Hd.a(this.$.xa)).yn(e,C,M,this.gridView)};od.prototype.Zb=function(e,C){var M=this,qa=this.gridView,Na=e.command,Hb=wf.TaskExtensions.om(),
Gc=!0;switch(Na){case -1077965542:Gc=this.V2e(C,e,!1);break;case 909774670:this.kob(Na);Gc=this.V2e(C,e,!0);break;case -1293291468:Gc=this.T2e(C,e,!1);break;case 324978188:kd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&Dd.ULS.sendTraceTag(574650248,0,50,"GridCommandHandler.HandleRibbonCommand: Handle font name preview");this.kob(Na);Gc=this.T2e(C,e,!0);break;case 862890474:case 963349338:Gc=this.vXh(e);break;case -1832800737:Gc=this.tbc(Na,C,!1,e);break;case 1970784898:Gc=
this.tbc(Na,C,!1,e);break;case -803000997:Gc=this.tbc(Na,C,!1,e);break;case -128950598:case 1688184685:this.kob(Na);Gc=this.tbc(Na,C,!0,e);break;case 1597684571:Gc=this.bvb(Na,C,!1,e);break;case 87208751:C.Color="-1";C.IntColor=!0;Gc=this.bvb(Na,C,!1,e);break;case -446735083:this.kob(Na);C.Color="-1";C.IntColor=!0;Gc=this.bvb(Na,C,!0,e);break;case 1650812936:Gc=this.bvb(Na,C,!1,e);break;case 673562736:this.kob(Na);Gc=this.bvb(Na,C,!0,e);break;case -1904244080:case -1428968098:case 1457172838:case 2036397036:kd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&
(e=pd.b().pi(Na),Dd.ULS.sendTraceTag(537159510,0,50,"GridCommandHandler.HandleRibbonCommand: Handle {0}",e));this.UPf(Na);break;case -287251124:case -1925065947:case 1764140053:case -1685033574:case -1590502662:Gc=this.gXh(Na,e);break;case -571165336:case -1142465846:case -1150205178:case 1041132226:case -286432209:case -394785302:case -1116189897:Gc=this.sWh(Na,e);break;case -1803452024:case -236759591:Gc=this.lgd(Na,C,e);break;case -2118943501:Gc=this.borderFormatManager.CWh(C,e);break;case 1012765228:Gc=
this.borderFormatManager.nYh(C,e);break;case 1256700402:Gc=this.borderFormatManager.qgd(e);break;case -1756763834:Gc=this.borderFormatManager.rgd(e);break;case -1418159950:Gc=this.borderFormatManager.F2e(e);break;case -1920201820:case -1942512156:Gc=this.wXh(Na,e);break;case -1690267012:case -600086683:case 165054436:case 1981714220:case -556441918:Gc=this.borderFormatManager.q2e(C,e);break;case 1890566896:case 1886928607:case -992833457:case 218524921:case 996232352:Gc=this.SXh(Na,C,e);break;case -693675336:case 322710748:break;
case 1696566924:Gc=this.hXh(e);break;case -167499203:case -255094134:case 1097660126:case 155820588:Hb=this.handleMergeCellsCommand(this.gridView,e);break;case 1896159024:case -1554384558:C=this.gridView.ha.va.selectedRanges;if(this.sqj(e,C))Dd.ULS.sendTraceTag(574993492,0,50,"GridCommandHandler.HandleRibbonCommand: showing InsertDeleteCellsDialog"),(new de(this.$,Na,C)).Kh(),Gc=!0;else if(hi.a.any(C,function(Uc){return M.gridView.Vb.TLa(Uc)})){qa="";Hb=1461300262;var gd=-1554384558===Na&&this.gridView.Vb.Ldi(C[0]);
C=C[0].height>C[0].width&&!gd;switch(Na){case 1896159024:qa=C?"InsertColumnsTable":"InsertRowsTable";Hb=C?622604322:942362098;break;case -1554384558:qa=C?"DeleteColumnsTable":"DeleteRowsTable",Hb=C?284490184:1405456548}C=Tg.a.Kn(od.Yjd,qa,1);new Bf.a(Hb,1,2,6,null);Hb=this.insertOrDeleteCells(C,e,!0)}else Hb=this.insertOrDeleteCells(1896159024===Na?1:2,e,!1);break;case 942362098:case 622604322:case 1405456548:case 284490184:Hb=this.insertOrDeleteCells(Tg.a.Kn(od.Yjd,C[eg.a.hd],1),e,!0);break;case -1113896058:case 1415868706:case 1554436520:case 674605324:case 1035996630:Hb=
this.insertOrDeleteCells(Tg.a.Kn(od.Yjd,C[eg.a.hd],1),e,!1);break;case 504848446:Hb=qa.startEdit(!1,1,C[If.a.event],void 0,void 0,!0);break;case 1504715724:if(Ye.g(this.$).Xy&&this.borderFormatManager.lU.yA)break;Hb=qa.startEdit(!0,0,C[If.a.event],void 0,void 0,!0);break;case 1872288872:this.Xob();break;case 41465729:Hb=this.fill(qa.ha.va.Qd,null,0,1,e);break;case -1451655532:case 1972143101:Hb=this.fillDownAbsoluteValueAndStartEdit(qa,C[If.a.event],-1451655532===Na);break;case -475861485:Hb=this.fill(qa.ha.va.Qd,
null,qa.rtl?1:2,1,e);break;case -978843926:Hb=this.fill(qa.ha.va.Qd,null,3,1,e);break;case 2098035706:Hb=this.fill(qa.ha.va.Qd,null,qa.rtl?2:1,1,e);break;case -2142700828:Hb=this.fill(qa.ha.sourceRange,qa.ha.va.Qd,od.vWe(qa.ha.va.Qd,qa.ha.sourceRange),2,e);break;case 1405660955:Hb=this.fill(qa.ha.sourceRange,qa.ha.va.Qd,od.vWe(qa.ha.va.Qd,qa.ha.sourceRange),4,e);break;case 1983983164:Hb=this.fill(qa.ha.va.Qd,null,0,0,e);break;case 478842689:(e=this.$.da.Aa(376))?(e.UWi(),Gc=!0):Dd.ULS.sendTraceTag(537159509,
0,15,"gridHighlightBehaviorEventManager is null for TouchAutoFill");break;case -798660877:case -653661711:case 165770524:case 277878202:case -844983198:case -2090948892:case 1690991812:Gc=qa.ha.Zb(null,Na);break;case -208772570:this.NXh();Gc=!0;break;case -987339782:this.KWh();Gc=!0;break;case -1770246794:qa.ha.LWh();Gc=!0;break;case 748067091:case -381232414:this.NWh(Na);Gc=!0;break;case -1522760979:this.gridView.toggleFormulaView();Gc=!0;break;case 886009118:Hb=this.tXh();break;case 894341014:this.yXh();
Gc=!0;break;case 862825906:Hb=this.j3e(1970784898,e);break;case 1532790410:Hb=this.j3e(1650812936,e);break;case 46555851:Hb=this.JXh(e);break;default:Gc=!1}Gc||(Hb=sg.a(Na));return Hb};od.prototype.sqj=function(e,C){var M=this,qa=hi.a.all(C,function(Gc){return!M.gridView.Vb.TLa(Gc)}),Na=1<C.length&&!!this.gridView.Vb.gfd(C),Hb=hi.a.all(C,function(Gc){return!M.gridView.Vb.S4(Gc)});C=!hi.a.any(C,function(Gc){return Gc.isRow||Gc.Lh});return 1===e.method&&6===e.df&&(qa||Na)&&Hb&&C};od.prototype.fillDownAbsoluteValueAndStartEdit=
function(e,C,M){var qa=this,Na=e.ha.va.activeCell,Hb=jg.E(Na,this.gridView.ns);return e.startEdit(!0,0,C).CWR(function(){var Gc=e.sc(Hb),gd=e.sc(Na);if(!Gc||!gd)return Dd.ULS.shipAssertTag(537159507,0,!1,"GridCommandHandler.FillDownAbsoluteValueAndStartEdit Cannot get cells for active cell: {0} and above cell: {1}",Na.toString(),Hb.toString()),Fg.Task.Ta(!1);qa.gridView.Kc.text=M?Gc.C0:Gc.text;qa.gridView.Kc.textBox.setCaretPositionToEnd();return Fg.Task.Ta(!0)})};od.prototype.insertOrDeleteCells=
function(e,C,M){function qa(){return new Jf(Wd)}var Na=this,Hb=Pg.a.create().toString(),Gc=Enum.toString(vi,e);this.gridView.Ji.Y6(17,Hb,Gc);Gc=this.gridView.ha.va.selectedRanges;var gd=this.Fdf,Uc=this.Cdf;if(!this.$.xs(null,!1,void 0,C.df)&&!Uc&&!gd&&5!==e&&9!==e)return Fg.Task.Ta(!0);2===e?e=Uc?10:gd?6:Gc[0].height>Gc[0].width?18:34:1===e?e=Uc?9:gd?5:Gc[0].height>Gc[0].width?17:33:18===e&&gd?e=34:34===e&&Uc&&(e=18);Gc=this.LDg(Gc,e);if(kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5931745_AllowDeleteRowColFromDialog")){if((10===
e||6===e)&&!this.$.xs(Gc,!0,1,C.df))return Fg.Task.Ta(!0)}else if(kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5670217_PromptPasswordDialogForDeleteRowCol")&&(10===e||6===e)&&!this.$.xs(Gc,!0))return Fg.Task.Ta(!0);var Wd={};Wd.InsertDeleteRangeItems=Array(Gc.length);Wd.SheetName=this.$.oa.sheetName;Wd.IsTableCommand=M;for(M=0;M<Gc.length;M++){gd=Gc[M];var We={},Gf=Uc=void 0;e&4?(We.FirstRow=gd.top-1,We.LastRow=Mi.a.dz,We.FirstColumn=0,We.LastColumn=Mi.a.ew,Uc=gd.bottom-gd.top+1,Gf=0,6===e&&(gd.Lh||
(We.FirstRow=gd.bottom),Uc=-Uc)):e&8?(We.FirstRow=0,We.LastRow=Mi.a.dz,We.FirstColumn=gd.left-1,We.LastColumn=Mi.a.ew,Uc=0,Gf=gd.right-gd.left+1,10===e&&(gd.isRow||(We.FirstColumn=gd.right),Gf=-Gf)):e&16?(We.FirstRow=gd.top-1,We.LastRow=gd.bottom-1,We.FirstColumn=gd.left-1,We.LastColumn=Mi.a.ew,Uc=0,Gf=gd.right-gd.left+1,18===e&&(We.FirstColumn=gd.right,Gf=-Gf)):(We.FirstRow=gd.top-1,We.LastRow=Mi.a.dz,We.FirstColumn=gd.left-1,We.LastColumn=gd.right-1,Uc=gd.bottom-gd.top+1,Gf=0,34===e&&(We.FirstRow=
gd.bottom,Uc=-Uc));We={InsertDeleteRange:We};We.DeltaRow=Uc;We.DeltaColumn=Gf;We.AdjustedSelectedRange=jg.j(gd);Wd.InsertDeleteRangeItems[M]=We}this.gridView.Bh.qG(!1);var xg=kd.EwaSettings.isChangeGateEnabled("OfficeVSO:4932761_InsertDeleteCellsDecoupled");Wd.IsDecoupleRecalc=xg;var Hg=this.$.qa.ta.Xb();return wg.a(this.$.userOperationManager,function(Ig,Hh,jj){xg&&!kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5316173_RecoverableFromOOM")||Na.$.Xu();var Kj=Na.$.qa.ta;Ig=lh.b(Ig,Na.HFi);var Qj=Kj.Oa(41,
void 0===Hg?null:Hg);Qj.insertDeleteMultiRangeParameters=Wd;return vf.i(Kj,"InsertDeleteCells",Qj,Ig,Hh,jj,Hb,0)},function(Ig){return new mg.a(237,0,Ig,void 0,qa)},C)};od.prototype.LDg=function(e,C){return C&32?this.TXa(e,function(M){return M.bottom},function(M){return M.top},function(M,qa){M.bottom=qa},!1,!0):C&16?this.gridView.rtl?this.TXa(e,function(M){return M.left},function(M){return M.right},function(M,qa){M.left=qa},!1,!1):this.TXa(e,function(M){return M.right},function(M){return M.left},function(M,
qa){M.right=qa},!1,!1):C&4?this.TXa(e,function(M){return M.bottom},function(M){return M.top},function(M,qa){M.bottom=qa},!0,!0):C&8?this.gridView.rtl?this.TXa(e,function(M){return M.left},function(M){return M.right},function(M,qa){M.left=qa},!0,!1):this.TXa(e,function(M){return M.right},function(M){return M.left},function(M,qa){M.right=qa},!0,!1):e};od.prototype.TXa=function(e,C,M,qa,Na,Hb){e=jg.d(e);e.sort(function(Uc,Wd){return C(Wd)-C(Uc)});if(Na){Na=[];Hb=kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5181014_DeletingLastTwoRowsColsFix")?
Hb?Mi.a.Fh+1:Mi.a.Qh+1:Hb?Mi.a.dz:Mi.a.ew;for(var Gc=0;Gc<e.length;Gc++){var gd=e[Gc];M(gd)<Hb&&(qa(gd,Math.min(C(gd),Hb-1)),Array.add(Na,gd),Hb=M(gd))}e=Na}return e};od.prototype.fill=function(e,C,M,qa,Na){function Hb(){return new Vd(Uc,Wd,qa,M)}var Gc=this,gd=this.$;if(!gd.xs([C],!0))return Fg.Task.Ta(!0);var Uc=jg.v(e,gd),Wd=C?jg.v(C,gd):Uc,We=this.$.qa.ta.Xb();return wg.a(this.$.userOperationManager,function(Gf,xg,Hg){Gc.$.Xu();var Ig=Gc.$.qa.ta,Hh=Ig.Oa(9,We);Hh.sourceRange=Uc;Hh.targetRange=
Wd;Hh.fillDirection=M;Hh.fillType=qa;return vf.i(Ig,"FillRange",Hh,Gf,xg,Hg,null,0)},function(Gf){return new mg.a(155,0,Gf,void 0,Hb)},Na)};od.prototype.SXh=function(e,C,M){var qa={ValidMembers:32};switch(e){case 1890566896:e=parseInt(C[eg.a.hd].toString());if(14===e)return M=new Bf.a(2105621672,M.method,M.mode,M.df,M.tabName),C[eg.a.hd]=null,this.$.Ka.Zb(M,C),Dd.ULS.sendTraceTag(537159506,0,50,"GridCommandHandler.HandleNumberFormatCommand: triggered NumberFormatDialog command, with menu item 14."),
!0;qa.NumberFormat=e;break;case 1886928607:qa.NumberFormat=13;break;case -992833457:qa.NumberFormat=11;break;case 218524921:qa.NumberFormat=12;break;case 996232352:qa.NumberFormat=1006;break;default:return Dd.ULS.shipAssertTag(537159505,0,!1,"Unexpected number formatting command "+pd.b().pi(M.command)),!1}Dd.ULS.sendTraceTag(537159504,0,50,"GridCommandHandler.HandleNumberFormatCommand: triggered {0} command, with menu item {1}.",pd.b().pi(M.command),C[eg.a.hd]);this.hi.formatCells(1890566896,qa,M);
this.$.Gf();return!0};od.prototype.vXh=function(e){var C=this.gridView.sc(this.gridView.ha.va.activeCell);if(this.zg&&this.gridView.isEditing){C=this.gridView.Jj.F2a(C?bh.a(C).Font:null);if(!C)return Dd.ULS.shipAssertTag(537159503,0,!1,"GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: fontType for range {0} is null while editing",this.gridView.ha.va.activeCell.toString()),!1;var M=C.FontSize}else if(C)M=C.fontSize;else return!1;C=e.command;var qa=0;if(862890474===C)for(;qa<od.ZIa.length-
1&&od.ZIa[qa]<=M;)qa++;else if(963349338===C)for(qa=od.ZIa.length-1;0<qa&&od.ZIa[qa]>=M;)qa--;Dd.ULS.sendTraceTag(537159501,0,50,"GridCommandHandler.HandleIncreaseOrDecreaseFontSizeCommand: change font from size {0} to size {1}",M,od.ZIa[qa]);if(M===od.ZIa[qa])return!0;M=od.Ntc(2);M.Font.FontSize=od.ZIa[qa];this.zg&&this.gridView.isEditing?(this.Smb(e,!1,M),this.$.Gf()):this.hi.formatCells(C,M,e);return!0};od.prototype.V2e=function(e,C,M){e=e[e[uf.a.IsFreeForm]?uf.a.Value:eg.a.Kg].toString();if(!od.tSi.test(e))return Dd.ULS.sendTraceTag(537159499,
0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command ({0}) is not a number.",e),kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5115068_FontSizeCommandHandledForInvalidParameter")?!0:!1;e=parseFloat(e);if(8>e||72<e)return Dd.ULS.sendTraceTag(537159497,0,50,"GridCommandHandler.HandleFontSizeCommand: Font size in command ({0}) not within expected limits ({1} - {2}).",e,8,72),kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5115068_FontSizeCommandHandledForInvalidParameter")?!0:!1;var qa=
Math.round(2*e)/2,Na=od.Ntc(2);Na.Font.FontSize=qa;this.zg&&this.gridView.isEditing?(this.Smb(C,M,Na,!0),qa===e||M||this.$.Gf()):M?this.hi.gna(this.gridView,-1077965542,Na,M):(this.hi.formatCells(-1077965542,Na,C),this.KZa());return!0};od.prototype.T2e=function(e,C,M){e=ab.HelperMethods.ERd[e[eg.a.Kg]];if(!e)return!0;var qa=od.Ntc(1);qa.Font.FontName=e;this.zg&&this.gridView.isEditing?(this.Smb(C,M,qa),this.$.Gf()):M?this.hi.gna(this.gridView,-1293291468,qa,M):(this.hi.formatCells(-1293291468,qa,
C),this.KZa());return!0};od.prototype.tbc=function(e,C,M,qa){var Na=-803000997===e||1688184685===e?"black":C.Color;this.moreColorsHelper&&(-1832800737===e?Na=K.a.compare(Na,"WindowText",!0)?this.moreColorsHelper.pFb:"black":M||(this.moreColorsHelper.pFb=Na,this.moreColorsHelper.xca(C,Na,qa)));e=od.Ntc(32);e.Font.FontColor=zj.a.HG(Na,Tg.a.ug(C,"IntColor"));this.zg&&this.gridView.isEditing?this.Smb(qa,M,e,17===qa.df):M?this.hi.gna(this.gridView,1970784898,e,M):(this.qH&&(M=this.getThemeColor(C),C=M.themeColor,
M.returnValue&&(e.Font.ThemeFontColor=C,e.Font.ColorTypeOption=1)),this.hi.formatCells(1970784898,e,qa),this.KZa());return!0};od.prototype.NWh=function(e){var C=(new Date).format(748067091===e?this.$.ya.ShortDateFormat:this.$.ya.ShortTimeFormat),M=this.gridView.xj?kj.a(this.gridView.$):this.gridView.Kc;e=M.textBox;if(this.gridView.isEditing)M.insertText(C);else{var qa=kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ChangeEditingModeAfterInsertDateOrTime",!1)?0:1;this.gridView.startEdit(!0,
qa);M.text=C;C=C.length;e.BQa(C);e.caretPosition=C}};od.prototype.NXh=function(){this.gridView.hka(this.gridView.ha.va.activeCell)||this.gridView.htc||this.gridView.OLa()||this.gridView.yt(this.gridView.ha.va.activeCell,3,Aj.a.Z1e)};od.prototype.KWh=function(){if(!(this.gridView.htc||this.gridView.OLa()||this.gridView.isEditing&&Mf.a.isMac)){var e=this.gridView.ha.va.U3;this.gridView.yi(jg.v(e,this.$),e,null,null,60,Aj.a.Z1e)}};od.prototype.hXh=function(e){var C=this;this.J8b=ih.d(this.$.xa.oa);var M=
this.$.da.Aa(254,!0);if(this.gridView.c5a)return this.gridView.Bh.qG(!1),!!M;if(!M)return Dd.ULS.sendTraceTag(537159494,0,50,"GridCommandHandler.HandleFormatPainter : copyPasteInfrastructure is null"),!1;this.gridView.ha.j2(this.W$c);var qa=String.format(If.a.Nsa,vh.a.current.eo(84));this.gridView.Bh.Rt(qa);e=new Bf.a(-911352779,e.method,e.mode,e.df,e.tabName);qa={};this.$.Ka.Zb(e,(qa[If.a.silentClipboardAccessFailures]=!0,qa[If.a.isFormatPainter]=!0,qa)).continueWith(function(Na){(6>Na.status||6===
Na.status&&!Na.result)&&C.Xob()});this.gridView.c5a=!0;M.HBg(this.Xob);return!0};od.prototype.bvb=function(e,C,M,qa){var Na=87208751===e?"-1":C.Color;this.moreColorsHelper&&(1597684571===e?Na=this.moreColorsHelper.t$a:M||(this.moreColorsHelper.t$a=Na===od.notSet?od.RTd:Na,this.moreColorsHelper.xca(C,Na,qa)));e={ValidMembers:64};e.FillColor=zj.a.HG(Na,Tg.a.ug(C,"IntColor"));M?this.hi.gna(this.gridView,1650812936,e,!0):(this.qH&&(M=this.getThemeColor(C),C=M.themeColor,M.returnValue&&(e.ThemeFillColor=
C,e.ColorTypeOption=1)),this.hi.formatCells(1650812936,e,qa),this.KZa());return!0};od.prototype.yXh=function(){Dd.ULS.sendTraceTag(537159493,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Started handling the command");var e=this.$.da.Aa(221);if(e){var C=this.gridView.Jj;if(C){var M=e.l6h(C.text,C.textBox.caretPosition);var qa=M.$nf;var Na=M.WQe;(M=M.returnValue)?(e.isListVisible=!1,C.text=M,C.textBox.selectRange(qa,qa+Na),Dd.ULS.sendTraceTag(587534607,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell InsertFormulaArguments executed successfully")):
Dd.ULS.sendTraceTag(537159490,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell Can't insert formula arguments with current text and caret position.")}else Dd.ULS.shipAssertTag(537159491,0,!1,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No editor object")}else Dd.ULS.sendTraceTag(537159492,0,50,"GridCommandHandler.HandleInsertFormulaArgumentsInCell No formulaAssistanceControl object")};od.prototype.gXh=function(e,C){var M=0,qa=this.gridView,Na=bh.a(qa.sc(null));this.zg&&qa.isEditing&&
(Na.Font=qa.Jj.F2a(Na.Font));var Hb=Na.Font;Hb||(Hb={ValidMembers:0});switch(e){case -287251124:M|=4;mj.e(Hb,4)?Hb.Bold=!Hb.Bold:Hb.Bold=!0;break;case -1925065947:M|=8;mj.e(Hb,8)?Hb.Italic=!Hb.Italic:Hb.Italic=!0;break;case 1764140053:M|=16;mj.e(Hb,16)?Hb.Underline=!Hb.Underline:Hb.Underline=!0;break;case -1685033574:M|=64;mj.e(Hb,64)?Hb.DoubleUnderline=!Hb.DoubleUnderline:Hb.DoubleUnderline=!0;break;case -1590502662:M|=128,mj.e(Hb,128)?Hb.Strikethrough=!Hb.Strikethrough:Hb.Strikethrough=!0}if(!M)return!1;
Hb.ValidMembers=M;Na.Font=Hb;Na.ValidMembers=16;this.zg&&this.gridView.isEditing?this.Smb(C,!1,Na):(kd.EwaSettings.la(686)||qa.Bh.qG(!1),this.hi.formatCells(e,Na,C));this.$.Gf();return!0};od.prototype.sWh=function(e,C){var M=0,qa=this.gridView,Na=bh.a(qa.sc(null));-571165336===e||1041132226===e||-394785302===e?(M|=1,Na.VerticalAlignment=Tg.a.Kn(od.YXa,e.toString(),2)):od.xbi(e)?(M|=2,this.qXh(Na,e)):-1116189897===e&&(M|=8,Na.Wrap=Na.ValidMembers&8?!Na.Wrap:!0);if(!M)return!1;Na.ValidMembers=M;kd.EwaSettings.la(686)||
qa.Bh.qG(!1);this.hi.formatCells(e,Na,C);this.$.Gf();return!0};od.prototype.qXh=function(e,C){!kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5049785_DisableTextAlignmentCommandFlipInRTL")&&this.$.isChromeRtl&&-1142465846!==C&&(C=-1150205178===C?-286432209:-1150205178);C=Tg.a.Kn(od.YXa,C.toString(),0);e.HorizontalAlignment=C===e.HorizontalAlignment?0:C};od.prototype.cGf=function(e,C,M,qa){var Na=this,Hb=!1;kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",!1)&&
(Hb=this.wjc.umf(C,M))&&Ye.g(this.$).Ji.n0(this.t7a,gh.BasicTelemetryCalculator.sQ);return kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?this.B$(e,C,!1,Hb,function(Gc){Na.UGi(Gc,M,C,Hb,qa)}):this.B$(e,C,!1,Hb,function(Gc,gd,Uc){Na.WGi(Gc,gd,Uc,M,C,Hb,qa)})};od.prototype.handleMergeCellsCommand=function(e,C){var M=this;this.t7a=Pg.a.create().toString();var qa=null;qa=this.wjc.bYe();var Na=Ai.a(C.command),Hb=this.wjc.w$h(C.command,
qa),Gc=kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5855030_MergeCellLogTelemetryForDataLossScenario"),gd=0;Gc&&Hb?gd=nd.a.se():Ye.g(this.$).Ji.Y6(4,this.t7a,Na+", Scenario = "+qa.scenario.toString());Na=e.ha.va.selectedRanges;Dd.ULS.sendTraceTag(537159459,0,50,"GridCommandHandler.HandleMergeCellsCommand: Merge Command: {0}, Number of ranges: {1}, Ranges: {2}",pd.b().pi(C.command),Na.length,jg.i(Na,",",this.$,!1));Na=kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellPerfImprovement",
!1);e.Bh.qG(!1,Na);if(10===Tg.a.Kn(od.wmf,C.command.toString(),10))return Fg.Task.Ta(!1);var Uc=kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.MergeCellDataLossScenarioCse",!1);if(Na&&Uc)return Hb?(Gc?this.dPd(qa,C,!0,!0,gd):this.dPd(qa,C,!0),Fg.Task.Ta(!0)):this.cGf(e,C,qa,!1);var Wd=!1;Na&&(Wd=this.wjc.umf(C,qa))&&Ye.g(this.$).Ji.n0(this.t7a,gh.BasicTelemetryCalculator.sQ);return kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5364656_RefactorOutAwaitsInScriptSharpWithContinueWithAndLogExceptionsMethodV2")?
this.B$(e,C,!1,Wd,function(We){M.VGi(We,C,Wd)}):this.B$(e,C,!1,Wd,function(We,Gf,xg){M.XGi(We,Gf,xg,C,Wd)})};od.prototype.B$=function(e,C,M,qa,Na){function Hb(xg,Hg,Ig){Uc.$.Xu();xg=Na?lh.b(xg,Na):xg;xg=lh.b(xg,Gc);return vf.f(Uc.$.qa.ta,We,Gf,M,xg,Hg,Ig,null,Wd)}function Gc(xg){var Hg=!!xg&&!!xg.RequestTelemetryData;Ye.g(Uc.$).Ji.Pka(Uc.t7a,xg.StateId,Hg?xg.RequestTelemetryData.EcsOperationDuration:0,Hg?xg.RequestTelemetryData.EcsRequestDuration:0,Hg?xg.RequestTelemetryData.WfeRequestDuration:0)}
function gd(){return new $b(We,Gf)}var Uc=this;Na=void 0===Na?null:Na;var Wd=this.$.qa.ta.Xb(),We=Tg.a.Kn(od.wmf,C.command.toString(),10),Gf=jg.r(e.ha.va.selectedRanges,e.$);return qa?kd.EwaSettings.tc()?wg.a(this.$.userOperationManager,Hb,function(xg){return new mg.a(156,0,xg,64,gd)},C):wg.a(this.$.userOperationManager,Hb,function(xg){return new Xe.a(156,0,xg,void 0,gd)},C):wg.a(this.$.userOperationManager,Hb,function(xg){return new mg.a(156,0,xg,void 0,gd)},C)};od.prototype.dPd=function(e,C,M,qa,
Na){var Hb=this;qa=void 0===qa?!1:qa;Na=void 0===Na?0:Na;Dd.ULS.sendTraceTag(537159457,0,50,"Merge cells with multiple values. isCalledBeforeCSE :- {0}",M);var Gc=Ye.g(this.$).rtl,gd=kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5855030_MergeCellLogTelemetryForDataLossScenario");Gc=oh.a.jd(3,2,0,Gc?625:624,0,514846606,"MergeCellsLoseData");wf.TaskExtensions.Ba(Qi.a(this.$).ri(Gc),function(Uc){Uc=Uc.result;if(qa){var Wd=nd.a.se()-Na;Dd.ULS.sendTraceTag(528779355,0,50,"Time taken to show Dialog in Data Loss Scenario is : {0}, and the user action is : {1}",
Wd,Uc)}Uc?1===Uc&&Dd.ULS.sendTraceTag(537159455,0,50,"MergeCellsLoseData Dialog: Cancel pressed"):(Dd.ULS.sendTraceTag(537159456,0,50,"MergeCellsLoseData Dialog: Ok pressed"),M?(qa&&gd&&(Uc=Ai.a(C.command),Ye.g(Hb.$).Ji.Y6(4,Hb.t7a,Uc+", Scenario = "+e.scenario.toString())),Hb.cGf(Ye.g(Hb.$),C,e,!0)):Hb.B$(Hb.gridView,C,!0,!1))},this.$.ma,11)};od.prototype.Bif=function(e,C,M,qa){C!==e&&Dd.ULS.sendTraceTag(537159454,0,15,"MergeCellsLoseData flag as per client and server does not match. MergeCellsLoseData flag as per client is :- {0} and as per server is {1}. The scenario is:- {2}, The CSE is done:- {3}",
C,e,M,qa)};od.prototype.VGi=function(e,C,M){var qa=this;Ch.b(e,514846606)&&(Dd.ULS.sendTraceTag(537159453,0,50,"Merge cells with multiple values"),fj.a(this.$).nd.AD(514846606),e=Ye.g(this.$).rtl,e=oh.a.jd(3,2,0,e?625:624,0,514846606,"MergeCellsLoseData"),wf.TaskExtensions.Ba(Qi.a(this.$).ri(e),function(Na){(Na=Na.result)?1===Na&&Dd.ULS.sendTraceTag(537159451,0,50,"MergeCellsLoseData Dialog: Cancel pressed"):(Dd.ULS.sendTraceTag(537159452,0,50,"MergeCellsLoseData Dialog: Ok pressed"),qa.B$(qa.gridView,
C,!0,M))},this.$.ma,11))};od.prototype.XGi=function(e,C,M,qa,Na){new pe(this,e,C,M,qa,Na)};od.prototype.UGi=function(e,C,M,qa,Na){var Hb=this,Gc=!1;Ch.b(e,514846606)&&(Gc=!0,fj.a(this.$).nd.AD(514846606),qa&&Na?window.setTimeout(function(){Hb.B$(Hb.gridView,M,!0,!0)},0):this.dPd(C,M,!1));this.Bif(Gc,Na,C.scenario,qa)};od.prototype.WGi=function(e,C,M,qa,Na,Hb,Gc){new Ad(this,e,C,M,qa,Na,Hb,Gc)};od.prototype.kob=function(e){var C=kd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation");
if(C&&this.hZa!==e&&1461300262!==this.hZa){this.UPf(this.hZa);var M=pd.b().pi(e),qa=pd.b().pi(this.hZa);Dd.ULS.sendTraceTag(537159450,0,50,"GridCommandHandler.CacheFontStyles: Style cached during {0} was restored before caching the style for {1} command.",qa,M)}C&&(this.hZa=e);if(this.zg&&this.gridView.isEditing)this.dZa||(this.dZa=this.gridView.Jj.formattedText);else if(!this.LD){this.LD=[];C=this.gridView.m$("GridCommandHandler.CacheFontStyles",this.gridView.ha.va.selectedRanges);try{for(C.$$rst();C.$$mn();){var Na=
C.$$cu(),Hb=Na.cell.hasRichText;if(kd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var Gc=pd.b().pi(e);Dd.ULS.sendTraceTag(537159449,0,100,"GridCommandHandler.CacheFontStyles: Add CachedPreviewCellGroup following {0} command. isRichText({1}). Cache size is {2}",Gc,Hb,this.LD.length)}if(Hb)Array.add(this.LD,Pd.KMg(Na,Na.cell.formattedText));else switch(e){case 673562736:case -446735083:Array.add(this.LD,Pd.aXc(Na,Na.backgroundColor));kd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&
!Na.backgroundColor&&Dd.ULS.sendTraceTag(537159448,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null BackgroundColor. isNull({0})",!Na.backgroundColor);break;case -128950598:case 1688184685:Array.add(this.LD,Pd.aXc(Na,Na.color));kd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!Na.color&&Dd.ULS.sendTraceTag(537159447,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null Color. isNull({0})",!Na.color);break;case 909774670:Array.add(this.LD,
Pd.LMg(Na,Na.fontSize));if(kd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var gd=oi.c(Na.fontSize)?"null or undefined":Na.fontSize.toString();Dd.ULS.sendTraceTag(537159446,0,100,"GridCommandHandler.CacheFontStyles: cached font size is {0}",gd)}break;case 324978188:Array.add(this.LD,Pd.aXc(Na,Na.fontName)),kd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(Na.fontName?Dd.ULS.sendTraceTag(537159444,0,50,"GridCommandHandler.CacheFontStyles: cached FontName is ({0}) of length({1}).",
gridRenderer.CanvasRendererGlobals.getFontNameForLogging(Na.fontName),Na.fontName.length):Dd.ULS.sendTraceTag(537159445,0,100,"GridCommandHandler.CacheFontStyles: cached empty or null FontName. isNull({0})",!Na.fontName))}}}finally{C&&C.dispose()}}};od.prototype.Luj=function(){return this.zg&&this.gridView.isEditing?!this.dZa:!this.LD};od.prototype.v9h=function(e){return!!this.LD&&this.LD.length>e&&!!this.LD[e].formattedText};od.prototype.qbd=function(e){return this.LD[e].style};od.prototype.pEh=
function(e){return this.LD[e].size};od.prototype.UPf=function(e){if(this.Luj())kd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&Dd.ULS.sendTraceTag(537159443,0,100,"GridCommandHandler.RestoreCachedStyles: Nothing to restore following {0} command.",e);else{if(this.zg&&this.gridView.isEditing)kd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(e=pd.b().pi(e),Dd.ULS.sendTraceTag(537159442,0,50,"GridCommandHandler.RestoreCachedStyles: Restore style following {0} command. Formatted text is enabledand IsEditing is true.",
e)),this.dZa&&(this.gridView.Kc.formattedText=this.dZa);else for(var C=this.LD.length,M=0;M<C;M++){var qa,Na=this.LD[M].O1a.cell.getRange();if(qa=this.gridView.sc(Na)){Na=void 0;var Hb=qa.VJ?this.gridView.Zsc(qa.range):(Na=new lc.a,Na.add(qa),Na);Na=yl(Hb);for(Hb=Na.next();!Hb.done;Hb=Na.next()){Hb=Hb.value;if(kd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")){var Gc=pd.b().pi(e);Dd.ULS.sendTraceTag(537159440,0,100,"GridCommandHandler.RestoreCachedStyles: Restore style following {0} command. formattedCell.Cell.HasRichText({1}). Cached item {2}. isMerge({3}). Cache size is {4}",
Gc,Hb.cell.hasRichText,M,qa.VJ,C)}if(Hb.cell.hasRichText&&1457172838!==e)this.v9h(M)&&(Hb.cell.formattedText=this.LD[M].formattedText,kd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!Hb.cell.formattedText&&Dd.ULS.sendTraceTag(537159439,0,100,"GridCommandHandler.RestoreCachedStyles: Setting FormattedText to null."));else switch(e){case 1457172838:Hb.backgroundColor=this.qbd(M);kd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&
!Hb.backgroundColor&&Dd.ULS.sendTraceTag(537159438,0,100,"GridCommandHandler.RestoreCachedStyles: Setting BackgroundColor to be empty or null. isNull({0}).",!Hb.backgroundColor);break;case 2036397036:Hb.color=this.qbd(M);kd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&!Hb.color&&Dd.ULS.sendTraceTag(537159437,0,100,"GridCommandHandler.RestoreCachedStyles: Setting Color to be empty or null. isNull({0}).",!Hb.color);break;case -1904244080:Hb.fontSize=this.pEh(M);
kd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(Hb=oi.c(Hb.fontSize)?"null or undefined":Hb.fontSize.toString(),Dd.ULS.sendTraceTag(537159436,0,100,"GridCommandHandler.RestoreCachedStyles: Setting font size to {0}",Hb));break;case -1428968098:Gc=kd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation"),Hb.eMd(this.qbd(M),Gc,"RestoreCachedStyles")}}}else Dd.ULS.sendTraceTag(537159441,0,50,"GridCommandHandler.RestoreCachedStyles: Cell is not supposed to be null. Cell range: {0}",
Na.qE(!1))}kd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&(this.hZa=1461300262);this.KZa()}};od.prototype.KZa=function(){this.zg&&this.gridView.isEditing?this.dZa=null:this.LD=null;kd.EwaSettings.isChangeGateEnabled("OfficeVSO:4706109_FontNameRevert_Investigation")&&Dd.ULS.sendTraceTag(537159435,0,50,"GridCommandHandler.ClearCachedStyles: Cache cleared.")};od.prototype.wXh=function(e,C){var M={IndentationIncrease:0};if(-1942512156===e)M.IndentationIncrease=1;
else if(-1920201820===e)M.IndentationIncrease=-1;else return!0;M.ValidMembers=256;this.hi.formatCells(e,M,C);return!0};od.prototype.tXh=function(){var e=this,C=Ye.g(this.$),M=jg.r(C.ha.va.selectedRanges,this.$),qa=jg.o(C.ha.va.activeCell,this.$);Dd.ULS.sendTraceTag(42566215,0,50,"GridCommandHandler: HandleIgnoreErrorCommand Invoked.");return wg.a(this.$.userOperationManager,function(Na,Hb,Gc){return vf.K(e.$.qa.ta,qa,M,Na,Hb,Gc,null)},function(Na){return new mg.a(201,0,Na)},null)};od.prototype.j3e=
function(e,C){var M=null,qa=Ye.g(this.$).ha.va.selectedRanges;qa=this.gridView.m$("MoreColors",qa,1,!0);try{for(qa.$$rst();qa.$$mn();){var Na=qa.$$cu().cell;if(Na){var Hb=od.black;if(1970784898===e)Hb=Na.color;else if(1650812936===e){var Gc=Na.backgroundColor;Hb=K.a.compare(Gc,od.RTd,!0)&&K.a.compare(Gc,od.empty,!0)?Na.backgroundColor:od.white}if(!M)M=Hb;else if(M!==Hb){M=od.black;break}}}}finally{qa&&qa.dispose()}this.zg&&this.gridView.isEditing&&1970784898===e&&this.gridView.Jj.textBox.ire();return this.moreColorsHelper.Nwa(e,
C,M)};od.prototype.JXh=function(e){var C=dh.a.Y2a(this.borderFormatManager.Y2);return this.moreColorsHelper.Nwa(-236759591,e,C)};od.prototype.Smb=function(e,C,M,qa){var Na=this;qa=void 0===qa?!1:qa;C?this.gridView.Jj.cFf(M.Font):(this.Doi(e),qa?window.requestAnimationFrame(function(){Gg.FocusManager.instance().dk(wh.AFrame.Vha);Na.gridView.Jj.bSe(M.Font)}):(Gg.FocusManager.instance().dk(wh.AFrame.Vha),this.gridView.Jj.bSe(M.Font)),this.KZa())};od.prototype.Doi=function(e){var C=Ai.a(e.command);e=
Pf.a[e.df]+"_"+hh.a[e.method];var M=this.gridView.rc.Lue.toString(),qa=new Map;qa.set("Command",C);qa.set("Source",e);qa.set("Ribbon","React");qa.set("CellTextRuns",M);zi.Health.instance.recordKpiUsage(Oi.a.Zxh,0,rk.a.rQf,qa)};od.prototype.lgd=function(e,C,M){e=this.borderFormatManager.lgd(e,C,M);this.moreColorsHelper&&this.moreColorsHelper.xca(C,this.borderFormatManager.Y2,M);return e};od.prototype.getThemeColor=function(e){var C={};var M=!1;if((e.SqmControlId||"").includes("ThemeColorPicker")){if(!this.themesManager)return Dd.ULS.sendTraceTag(537159433,
0,10,"GridCommandHandler.GetThemeColor: Themes Manager is null"),{returnValue:!1,themeColor:C};M=this.themesManager.getThemeColor(e.Color);e=M.themeIndex;var qa=M.AAa;if(M=M.returnValue)C.ThemeColorIndex=e,C.ThemeColorRow=qa}return{returnValue:M,themeColor:C}};od.xbi=function(e){return-1150205178===e||-1142465846===e||-286432209===e};od.Ntc=function(e){var C={},M={};C.ValidMembers=16;C.Font=M;M.ValidMembers=e;return C};od.vWe=function(e,C){var M=e.top<C.top?3:e.bottom>C.bottom?0:-1;return M=e.left<
C.left?1:e.right>C.right?2:M};tl.Object.defineProperties(od.prototype,{Fdf:{configurable:!0,enumerable:!0,get:function(){return hi.a.all(this.gridView.ha.va.selectedRanges,function(e){return e.isRow})}},Cdf:{configurable:!0,enumerable:!0,get:function(){return hi.a.all(this.gridView.ha.va.selectedRanges,function(e){return e.Lh})}},themesManager:{configurable:!0,enumerable:!0,get:function(){this.zB||(this.zB=this.$.da.Aa(422));return this.zB}}});tl.Object.defineProperties(od,{tSi:{configurable:!0,enumerable:!0,
get:function(){return od.fbe||(od.fbe=RegExp("^[0-9]+[.]?[0-9]*$"))}},Yjd:{configurable:!0,enumerable:!0,get:function(){var e={};return od.I5d||(od.I5d=(e.InsertRows=5,e.InsertColumns=9,e.InsertCellsShiftRight=17,e.InsertCellsShiftDown=33,e.DeleteRows=6,e.DeleteColumns=10,e.DeleteCellsShiftLeft=18,e.DeleteCellsShiftUp=34,e.DeleteRowsTable=6,e.DeleteColumnsTable=10,e.InsertRowsTable=5,e.InsertColumnsTable=9,e))}},YXa:{configurable:!0,enumerable:!0,get:function(){var e={};return od.sfb||(od.sfb=(e["-394785302"]=
0,e["-571165336"]=2,e["1041132226"]=1,e["-1150205178"]=1,e["-1142465846"]=2,e["-286432209"]=3,e))}},wmf:{configurable:!0,enumerable:!0,get:function(){var e={};return od.t9d||(od.t9d=(e["-167499203"]=2,e["-255094134"]=5,e["1097660126"]=6,e["155820588"]=7,e))}}});od.RTd="transparent";od.notSet="-1";od.black="#000000";od.empty="";od.white="#FFFFFF";od.I5d=null;od.sfb=null;od.t9d=null;od.fbe=null;od.ZIa=[8,9,10,11,12,14,16,18,20,24,26,28,36,48,72];Object(sd.a)(od,"GridCommandHandler",null,[237]);var Qk=
cf.a;vm(Xd,Qk);Xd.prototype.Md=function(){var e=this;if(kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")){var C=td.GetServiceTaskFactory.create(this.$.da,111,this.ma,this.tb),M=td.GetServiceTaskFactory.create(this.$.da,18,this.ma,this.tb),qa=td.GetServiceTaskFactory.create(this.$.da,397,this.ma,this.tb),Na=td.GetServiceTaskFactory.Xa(this.$.da,296,468,this.tb);wf.TaskExtensions.Ba(wf.TaskExtensions.ve([C,M,qa,Na],this.ma),function(){e.Ed([new od(e.$,Ye.g(e.$),
M.result,C.result,Na.result,qa.result)])},this.ma,3)}else{var Hb=td.GetServiceTaskFactory.create(this.$.da,111,this.ma,this.tb),Gc=td.GetServiceTaskFactory.create(this.$.da,18,this.ma,this.tb),gd=td.GetServiceTaskFactory.create(this.$.da,102,this.ma,this.tb),Uc=td.GetServiceTaskFactory.create(this.$.da,397,this.ma,this.tb);wf.TaskExtensions.Ba(wf.TaskExtensions.ve([Hb,Gc,gd,Uc],this.ma),function(){e.Ed([new od(e.$,Ye.g(e.$),Gc.result,Hb.result,new Ke.BorderFormatManager(e.$,Gc.result,gd.result),Uc.result)])},
this.ma,3)}};Xd.ja=function(e){cf.a.de(80,new Xd(e))};Object(sd.a)(Xd,"GridCommandHandlerFactory",cf.a,[]);var fk=b(30),Zk=b(204),uk=b(1188);Jd.prototype.dispose=function(){var e=this;this.deactivate();this.gridView&&(this.tableManager.OMf(this.Hxf),this.gridView.K4i(this.Zuf),this.gridView.L4i(this.$uf),this.$.xa.rg(this.Oe),this.$.xb.rg(this.Oe),this.Poe(function(C){C.oHd(e.rKa)}));this.gridView=this.tableManager=this.aga=null};Jd.prototype.jyc=function(e,C,M,qa){if(!ih.b(this.$.oa)||this.$.fa.isNamedObjectViewMode||
this.gridView.$a.rSa)return!0;if(!M.length)return!1;var Na=qa.length;if(qa[Na-1]<e.left)return!1;var Hb=ab.HelperMethods.Tw(new Zk.a(qa),0,Na,e.left,ab.HelperMethods.xC);if(0>Hb)return!1;var Gc=e.I5f,gd=!!e.r_b&&0<e.r_b.length,Uc=!!e.menuModel&&0<e.menuModel.length,Wd=Hb,We=0;for(Na=Math.min(Gc.length+Hb,Na);Wd<Na;Wd++,We++)if(Hb=M[Wd],!kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5317457_ToggleHeaderSnapping_JSCrash_Fix")||Hb){var Gf=null,xg=Hb.getElementsByClassName(fk.a.p8c);xg&&(Gf=xg[0]);if(Gf&&
Gf.innerText){if(xg=Hb.getElementsByClassName(fk.a.Fme))for(var Hg=xg.length-1;0<=Hg;Hg--)Hb.removeChild(xg[Hg]);xg=qa[Wd];C?(Gf.innerText=Gc[We],Hb.classList.add(fk.a.CNe),gd&&e.r_b[We]&&(Gf=document.createElement("div"),Gf.innerHTML=e.r_b[We],Uc&&e.menuModel[We]&&this.hxg(e,We,xg),Hb.appendChild(Gf.firstChild))):(Hb.classList.remove(fk.a.CNe),Gf.textContent=Ug.Range.sY(xg),this.Adh(e,We,xg))}}e.CRa=C;return!0};Jd.prototype.hxg=function(e,C,M){this.$.da.Za(8,function(qa){qa.Q7b.eFi(e,C,M)})};Jd.prototype.Adh=
function(e,C,M){this.$.da.Za(8,function(qa){qa.Q7b.fFi(e,C,M)})};Jd.prototype.m1f=function(e,C,M,qa){for(var Na=!1,Hb=this.PTh(e,C),Gc=this.aga.length-1;0<=Gc;Gc--){var gd=this.aga[Gc];C>=gd.left&&e<=gd.right&&(this.jyc(gd,!1,M,qa),Array.removeAt(this.aga,Gc),Na=!0)}e=0;for(C=Hb.length;e<C;e++)this.jyc(Hb[e],!0,M,qa)&&(Array.add(this.aga,Hb[e]),Na=!0);return Na};Jd.prototype.activate=function(){this.te()&&!this.active&&(this.gridView.view.it(this.iw),this.active=!0)};Jd.prototype.deactivate=function(){this.active&&
(this.gridView.view.Wr(this.iw),this.active=!1)};Jd.prototype.te=function(){return ih.b(this.$.oa)&&!this.$.fa.isNamedObjectViewMode&&0>=this.gridView.$a.oO&&0<this.tableManager.rangeList.length};Jd.prototype.Poe=function(e){var C=kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ApplyHeaderSnappingOnVerticalFreezePane",!1)?this.gridView.unc:[this.gridView.K2];C=yl(C);for(var M=C.next();!M.done;M=C.next()){M=yl(M.value);for(var qa=M.next();!qa.done;qa=M.next()){qa=yl(qa.value);for(var Na=
qa.next();!Na.done;Na=qa.next())e(Na.value)}}};Jd.prototype.PTh=function(e,C){var M=[];if(!this.active)return M;this.xMa=this.gridView.vfd();for(var qa=this.tableManager.rangeList.length-1;0<=qa;qa--){var Na=this.tableManager.rangeList[qa];Na.bottom>=this.xMa&&this.ufd(Na)<=this.xMa&&Na.left>=e&&Na.right<=C&&Na.mva&&Array.add(M,Na)}return M};Jd.prototype.ufd=function(e){var C=this.gridView.Vb.vk(e);return C&&this.tableManager.Naf(e,C.usedRange.topLeft)?e.top+1:e.top};Object(sd.a)(Jd,"HeaderSnappingFeature",
null,[3]);var Ij=vb.a;vm(ad,Ij);ad.prototype.create=function(){var e=this,C=td.GetServiceTaskFactory.create(this.$.da,134,this.ma,this.tb);wf.TaskExtensions.Ba(wf.TaskExtensions.ve([C],this.ma),function(){e.Fb(e.$.da.Aa(68)||new Jd(C.result,Ye.g(e.$)))},this.ma,11)};ad.ja=function(e){e.da.Ha(67,new ad(e))};Object(sd.a)(ad,"HeaderSnappingFactory",vb.a,[]);var Dk=b(1245),Ek=vb.a;vm(Ac,Ek);Ac.prototype.create=function(){var e=this,C=this.$.da,M=td.GetServiceTaskFactory.create(C,134,this.ma,this.tb),
qa=td.GetServiceTaskFactory.Xa(C,213,214,this.tb);wf.TaskExtensions.Ba(wf.TaskExtensions.ve([M,qa],this.ma),function(){var Na=C.Aa(1);Na||(Na=new Dk.CellAutoCompleteControl(e.$,M.result),qa.result.ja(Na));e.Fb(Na)},this.ma,3)};Ac.ja=function(e){e.da.Ha(151,new Ac(e))};Object(sd.a)(Ac,"CellAutoCompleteControlFactory",vb.a,[]);cc.prototype.dispose=function(){this.OUd();this.zYa=null};cc.prototype.ja=function(e){e&&(this.zYa=e,e.pTc(this.Nxf),e.i2(this.Oxf),e.RAg(this.Pxf))};cc.prototype.OUd=function(){this.zYa&&
(this.zYa.SGd(this.Nxf),this.zYa.Mca(this.Oxf),this.zYa.W4i(this.Pxf))};Object(sd.a)(cc,"CellAutoCompleteReadoutHandler",null,[582,3]);var vk=vb.a;vm(pb,vk);pb.prototype.create=function(){var e=this,C=this.$.da;wf.TaskExtensions.Ba(td.GetServiceTaskFactory.Xa(C,211,212,this.tb),function(M){M=C.Aa(213)||new cc(M.result,C);e.Fb(M)},this.ma,3)};pb.ja=function(e){e.da.Ha(214,new pb(e))};Object(sd.a)(pb,"CellAutoCompleteReadoutHandlerFactory",vb.a,[]);za.Vjh="ewa-dv";za.Wjh="ewa-dv-buttonarea";za.bjh=
"ewa-dlb";za.Szb="list-table";za.listItem="list-item";za.Pzb="list-item-selected";za.Tzb="list-table-touch";za.Ujh="ewa-dpb";Object(sd.a)(za,"CssClassNames",null,[]);var Ej=b(520),rj=b(45),Jj=b(428),Zi=b(961),gk=Oh.ErrorDialog;vm(uc,gk);uc.prototype.dispose=function(){Ye.g(this.$).ha.mF(this.kd);gk.prototype.dispose.call(this)};uc.prototype.setFocus=function(){switch(this.error.Severity){case 0:var e=4;break;case 1:e=3;break;case 2:e=0;break;default:e=this.closeAction}(e=this.getButton(e))?e.get_element().focus():
gk.prototype.setFocus.call(this)};uc.prototype.ppb=function(){var e=Ye.g(this.$);e.isEditing&&e.Kc.endEdit(!1,"DataValidationErrorDeprecatedDialog.CommitAfterClosing",0);4===this.returnValue&&this.KQd(1);if(2===this.returnValue||!this.returnValue){var C=e.sc(null);if(C){e.Ca.gV();var M=Object.assign(new Rh.a,{Text:C.originalText});e.setCell(M,C.range,0,63,null)}this.$.Ce(-798660877,eg.a.Wb,8,null)}gk.prototype.ppb.call(this)};uc.prototype.dGa=function(){var e=Ye.g(this.$);e.isEditing&&e.Kc.endEdit(!1,
"DataValidationErrorDeprecatedDialog.CancelAfterClosing",0);3===this.returnValue&&this.KQd(0);gk.prototype.dGa.call(this)};uc.prototype.KQd=function(e){var C=Ye.g(this.$);wf.TaskExtensions.Ba(C.startEdit(!1,e),function(){var M=C.Kc.textBox;M.text&&M.selectRange(0,M.text.length)},this.ma,11,Te.a.current)};uc.iQ=function(e,C,M){M=C.da.Aa(14).v2a(M);e.MessageId=-1083021405;e.MessageIdName="DataValidationError";e.MessageIdHash=dh.a.lu(e.MessageIdName);e.Severity=M?M.d7c:1;C=(null===M||void 0===M?0:M.oIa)?
dh.a.If(M.oIa):null;M=(null===M||void 0===M?0:M.error)?dh.a.If(M.error):String.format("<p>{0}</p><p>{1}</p>",fe.a.instance.ea(874),fe.a.instance.ea(875));switch(e.Severity){case 0:e.Appearance=18;break;case 1:e.Appearance=12;M+=String.format("<p>{0}</p>",fe.a.instance.ea(876));break;default:e.Appearance=3}e.Caption=C;e.Description=M;e.HelpDescription=fe.a.instance.ea(1273);e.HelpTopicId=Zi.a.kDe;return e};Object(sd.a)(uc,"DataValidationErrorDeprecatedDialog",Oh.ErrorDialog,[]);var Xh=b(180),Ok=b(166),
wk=Ni.a;vm(Ic,wk);Ic.prototype.dispose=function(){this===this.Ab.Ap&&(this.Ab.Ap=null);ff.a.Fa(this.xm);this.xm=null;wk.prototype.dispose.call(this)};Ic.prototype.Yhj=function(){this.su&&this.su.error?this.errorMessage=this.su.error:this.su&&this.su.options&1?(Dd.ULS.sendTraceTag(537163289,0,50,"DataValidationErrorDialog.SetDialogProps, Data validation Error opened on a list rule."),this.errorMessage=fe.a.instance.ea(1682),this.h5e=vh.a.current.eo(96)):(this.errorMessage=fe.a.instance.ea(1681),this.PGh(this.xJe));
var e=this.su?this.su.d7c:1,C={};this.t$=(C[Ic.Ly]=this.xc,C.errorDescription=this.errorMessage,C.helpImageUri=this.h5e,C);switch(e){case 0:this.kc=1;this.Cc(1,"Retry");this.t$.dialogIcon=2;this.jdf=!0;break;case 1:this.kc=4;this.t$.dialogIcon=1;this.t$.additionalInformation=fe.a.instance.ea(876);break;default:this.kc=1,this.t$.dialogIcon=3}e={};this.t$.helpLink=(e.type="AppLinkProps",e[Ic.Ly]=this.error.HelpTopicId,e.text=fe.a.instance.ea(1273),e.handler=this.n8a,e);e=oh.a.UUc([this.error]);C={};
this.sU=(C[If.a.B7b]=!0,C[If.a.k9c]=e,C[If.a.l9c]=Ok.a(this.$).Prb(this.error.MessageIdHash),C[If.a.O$]=this.xc,C.DismissHandler=this.Pxd,C);e={};this.t$.giveFeedbackLink=(e.type="AppLinkProps",e[Ic.Ly]=If.a.Ufd,e.text=fe.a.instance.ea(1718),e.handler=this.ZEi,e)};Ic.prototype.PGh=function(e){var C=this.$.qa.ta.Xb();vf.u(this.$.qa.ta,jg.q(e,this.$),lh.b(this.BDi),lh.a(this.ADi),null,C)};Ic.prototype.CQh=function(e){switch(e.RuleType){case 1:switch(e.ConditionType){case 0:var C=fe.a.instance.Cb(107);
return String.format(C,e.LowerBoundary,e.UpperBoundary);case 1:return C=fe.a.instance.Cb(108),String.format(C,e.LowerBoundary,e.UpperBoundary);case 2:return C=fe.a.instance.Cb(109),String.format(C,e.LowerBoundary);case 3:return C=fe.a.instance.Cb(110),String.format(C,e.LowerBoundary);case 4:return C=fe.a.instance.Cb(111),String.format(C,e.LowerBoundary);case 5:return C=fe.a.instance.Cb(112),String.format(C,e.UpperBoundary);case 6:return C=fe.a.instance.Cb(113),String.format(C,e.LowerBoundary);case 7:return C=
fe.a.instance.Cb(114),String.format(C,e.UpperBoundary);default:return"we couldn't get the details"}case 2:switch(e.ConditionType){case 0:return C=fe.a.instance.Cb(115),String.format(C,e.LowerBoundary,e.UpperBoundary);case 1:return C=fe.a.instance.Cb(116),String.format(C,e.LowerBoundary,e.UpperBoundary);case 2:return C=fe.a.instance.Cb(117),String.format(C,e.LowerBoundary);case 3:return C=fe.a.instance.Cb(118),String.format(C,e.LowerBoundary);case 4:return C=fe.a.instance.Cb(119),String.format(C,e.LowerBoundary);
case 5:return C=fe.a.instance.Cb(120),String.format(C,e.UpperBoundary);case 6:return C=fe.a.instance.Cb(121),String.format(C,e.LowerBoundary);case 7:return C=fe.a.instance.Cb(122),String.format(C,e.UpperBoundary);default:return"we couldn't get the details"}case 4:switch(e.ConditionType){case 0:return C=fe.a.instance.Cb(123),String.format(C,e.LowerBoundary,e.UpperBoundary);case 1:return C=fe.a.instance.Cb(124),String.format(C,e.LowerBoundary,e.UpperBoundary);case 2:return C=fe.a.instance.Cb(125),String.format(C,
e.LowerBoundary);case 3:return C=fe.a.instance.Cb(126),String.format(C,e.LowerBoundary);case 4:return C=fe.a.instance.Cb(127),String.format(C,e.LowerBoundary);case 5:return C=fe.a.instance.Cb(128),String.format(C,e.UpperBoundary);case 6:return C=fe.a.instance.Cb(129),String.format(C,e.LowerBoundary);case 7:return C=fe.a.instance.Cb(130),String.format(C,e.UpperBoundary);default:return"we couldn't get the details"}case 5:switch(e.ConditionType){case 0:return C=fe.a.instance.Cb(131),String.format(C,
e.LowerBoundary,e.UpperBoundary);case 1:return C=fe.a.instance.Cb(132),String.format(C,e.LowerBoundary,e.UpperBoundary);case 2:return C=fe.a.instance.Cb(133),String.format(C,e.LowerBoundary);case 3:return C=fe.a.instance.Cb(134),String.format(C,e.LowerBoundary);case 4:return C=fe.a.instance.Cb(135),String.format(C,e.LowerBoundary);case 5:return C=fe.a.instance.Cb(136),String.format(C,e.UpperBoundary);case 6:return C=fe.a.instance.Cb(137),String.format(C,e.LowerBoundary);case 7:return C=fe.a.instance.Cb(138),
String.format(C,e.UpperBoundary);default:return"we couldn't get the details"}case 6:switch(e.ConditionType){case 0:return C=fe.a.instance.Cb(139),String.format(C,e.LowerBoundary,e.UpperBoundary);case 1:return C=fe.a.instance.Cb(140),String.format(C,e.LowerBoundary,e.UpperBoundary);case 2:return C=fe.a.instance.Cb(141),String.format(C,e.LowerBoundary);case 3:return C=fe.a.instance.Cb(142),String.format(C,e.LowerBoundary);case 4:return C=fe.a.instance.Cb(143),String.format(C,e.LowerBoundary);case 5:return C=
fe.a.instance.Cb(144),String.format(C,e.UpperBoundary);case 6:return C=fe.a.instance.Cb(145),String.format(C,e.LowerBoundary);case 7:return C=fe.a.instance.Cb(146),String.format(C,e.UpperBoundary);default:return"we couldn't get the details"}case 3:return C=fe.a.instance.Cb(105),String.format(C,e.LowerBoundary);case 7:return C=fe.a.instance.Cb(106),String.format(C,e.LowerBoundary);default:return"we couldn't get the details"}};Ic.prototype.KQd=function(e){var C=Ye.g(this.$);wf.TaskExtensions.Ba(C.startEdit(!1,
e),function(){var M=C.Kc.textBox;M.text&&M.selectRange(0,M.text.length)},this.ma,11,Te.a.current)};Ic.iQ=function(e,C,M){C=C.da.Aa(14).v2a(M);e.MessageId=-1083021405;e.MessageIdName="DataValidationError";e.MessageIdHash=dh.a.lu(e.MessageIdName);e.Severity=C?C.d7c:1;e.HelpDescription=fe.a.instance.ea(1273);e.HelpTopicId=Zi.a.kDe;return e};tl.Object.defineProperties(Ic.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"DataValidationErrorDialog"}},ma:{configurable:!0,enumerable:!0,get:function(){this.xm=
this.xm||new Xh.a;return this.xm.token}}});Object(sd.a)(Ic,"DataValidationErrorDialog",Ni.a,[87,88,3,89]);var Pk=b(1046),lk=b(381),Fj=Pk.a;vm(Jb,Fj);Jb.prototype.dispose=function(){this.dataValidationControl=null;Fj.prototype.dispose.call(this)};Jb.prototype.ki=function(e,C){this.dataValidationControl.qb=this.qb;var M=e.keyCode;return 1461300262!==C||16!==M&&17!==M&&18!==M?Fj.prototype.ki.call(this,e,C):!1};Jb.prototype.Uwd=function(){this.lV&&(this.dataValidationControl.qb=this.qb,this.dataValidationControl.show(this.dataValidationControl.CQ,
!0,!0,Mf.a.Pr||3===eg.a.Wb))};Jb.prototype.Rh=function(){};Jb.prototype.Mj=function(){this.dataValidationControl.show(this.dataValidationControl.CQ,!0,!0,Mf.a.Pr||3===eg.a.Wb)};Jb.prototype.jDd=function(e,C){return this.dataValidationControl.ki(C)};tl.Object.defineProperties(Jb.prototype,{pxb:{configurable:!0,enumerable:!0,get:function(){return Object(ig.a)(Ic,this.$.Ab.qh)}},lV:{configurable:!0,enumerable:!0,get:function(){return this.dataValidationControl.isListVisible},set:function(e){this.dataValidationControl.isListVisible=
e}},rwb:{configurable:!0,enumerable:!0,get:function(){return!1}},key:{configurable:!0,enumerable:!0,get:function(){return lk.a.L3c}}});Object(sd.a)(Jb,"DataValidationListAutoCompleteBehavior",Pk.a,[]);var Wj=b(978),xk=b(1045),ak=Wj.a;vm(Zb,ak);Zb.prototype.dispose=function(){ak.prototype.dispose.call(this);this.T6a=this.qkb=null};Zb.prototype.Sda=function(e,C,M,qa){if(e&&(!e||e.length)){this.e7(!1);this.tHa=e;this.xV=[];for(var Na=0;Na<e.length;Na++)this.xV[Na]=e[Na]?e[Na].Name:null;Na=String.format("<table class='{0}' aria-live='polite'><tbody>",
this.rba);var Hb="",Gc="";e=0;var gd=Ye.g(this.$).sc(null);qa=this.isEditing?qa?qa.text:this.editText:gd?gd.originalText:null;gd=!qa;var Uc=0;Array.clear(this.CDb);var Wd=[],We=[],Gf=[],xg=qa?qa.split(" "):[""];qa=qa.trim();for(var Hg={},Ig=0;Ig<this.xV.length;Hg={MBc:Hg.MBc},Ig++){var Hh=this.xV[Ig],jj=void 0;Hg.MBc=Hh.split(" ");jj=hi.a.all(xg,function(Jk){return function(Sk){return hi.a.any(Jk.MBc,function(al){return K.a.eI(al,Sk)})}}(Hg));var Kj=!Hh,Qj=Array.contains(Gf,Hh);Kj||Qj||this.isEditing&&
!jj||(jj=Hh?dh.a.If(dh.a.b6b(Hh)):"",jj=String.format("<tr>\r\n\t<td class='{0}'>{1}</td>\r\n</tr>",this.RZ,jj),Array.add(Gf,Hh),this.isEditing&&K.a.eI(Hh,qa)?(Hb+=jj,Array.add(Wd,Ig)):(Gc+=jj,Array.add(We,Ig)),!gd&&K.a.equals(qa,Hh,!0)&&(e=this.isEditing?Wd.length-1:Uc,gd=!0),Uc++)}this.Swa=Uc;Array.addRange(this.CDb,Wd);Array.addRange(this.CDb,We);this.dg.innerHTML=Na+(Hb+Gc+"</tbody></table>");Na=this.An=Le.DOMElementExtensions.vj(this.domElement,this.rba);this.Ylb(Na,C);this.e7(!0);this.hra(C,
M);this.Nk=0<this.Swa?Na.rows[e]:null}};Zb.prototype.CQa=function(e){var C=!1;this.isEditing&&e&&(C=!this.Swa,e.endEdit(C,"DataValidationListBox.SetCellContent",0));if(!C&&(e=Ye.g(this.$),C=e.sc(null))){var M=null;this.bda&&-1!==this.bda.SheetId&&-1!==this.bda.Row&&-1!==this.bda.Column&&(M={},M.SheetName=this.bda.SheetId.toString(),M.FirstRow=this.bda.Row,M.FirstColumn=this.bda.Column,M={ParameterType:6,SourceRange:M});var qa=Object.assign(new Rh.a,{Text:this.oe});e.setCell(qa,C.range,0,63,M)}return!0};
Zb.prototype.hra=function(e,C){var M=e?this.BAb:this.xH;e=e?this.Uhc:this.Vhc;if(0>=this.Swa)this.dg.style.height=ab.HelperMethods.Qb(e);else if(this.dg.style.height="auto",this.Swa>M){var qa=this.O9f?Math.floor(e*M):Math.floor(this.dg.offsetHeight*M/this.Swa);!this.O9f&&this.Fmi&&Dd.ULS.sendTraceTag(529056667,0,50,"DataValidationListBox.adjustHeightAndWidth:\n            old height: "+qa+",\n            new height: "+Math.floor(e*M)+",\n            maxItems: "+M+", listItemHeight: "+e+", listItemCount: "+
this.Swa);Le.DOMElementExtensions.HF(this.dg,qa);this.dg.style.overflowY="auto"}else this.dg.style.height="auto",this.dg.style.overflowY="hidden";Le.DOMElementExtensions.Gq(this.dg,C);Le.DOMElementExtensions.Gq(this.An,C-(this.Swa>M?yc.a.Sp:0))};tl.Object.defineProperties(Zb.prototype,{Nk:{configurable:!0,enumerable:!0,get:function(){return this.qkb},set:function(e){this.GAa(this.qkb);if(e){this.qkb=e;this.T6a.innerText="";this.GAa(this.qkb);var C=this.CDb[e.rowIndex];this.oe=this.xV[C];this.tHa&&
(this.bda=this.tHa[C],Dd.ULS.shipAssertTag(537163286,0,!this.CDb.length||!!this.bda,"DataValidationListBox.SelectedRow: Did not find corresponding DataValidationListItem"));this.T6a.innerText=this.oe;this.Lsc(e)}else this.bda=this.oe=null}},isEditing:{configurable:!0,enumerable:!0,get:function(){return Ye.g(this.$).isEditing}},editText:{configurable:!0,enumerable:!0,get:function(){return Ye.g(this.$).Kc.text}}});Object(sd.a)(Zb,"DataValidationListBox",Wj.a,[]);var Fk=b(241),hk=b(117),nj=b(169),Gk=
ei.a;vm(db,Gk);db.prototype.XSc=function(e){this.get_events().addHandler("ClickButton",e)};db.prototype.BGd=function(e){this.get_events().removeHandler("ClickButton",e)};db.prototype.nTc=function(e){this.get_events().addHandler("KeyDown",e)};db.prototype.RGd=function(e){this.get_events().removeHandler("KeyDown",e)};db.prototype.SXb=function(e){this.get_events().addHandler("PointerOver",e)};db.prototype.dHd=function(e){this.get_events().removeHandler("PointerOver",e)};db.prototype.RXb=function(e){this.get_events().addHandler("PointerOut",
e)};db.prototype.cHd=function(e){this.get_events().removeHandler("PointerOut",e)};db.prototype.cmb=function(e){this.get_events().addHandler("Blur",e)};db.prototype.aGb=function(e){this.get_events().removeHandler("Blur",e)};db.prototype.k9=function(e){this.get_events().addHandler("Focus",e)};db.prototype.Kca=function(e){this.get_events().removeHandler("Focus",e)};db.prototype.enable=function(){this.domElement&&(this.domElement.classList.remove(Ej.a.BY),this.domElement.style.cursor="",Mg.a.instance.pa(Ve.a.click,
this.domElement,this.Vc),hk.KeyInputManager.instance.pa(Ve.a.Rb,this.domElement,this.onKeyDown),nj.a.instance.pa(Ve.a.pointerOver,this.domElement,this.hw),nj.a.instance.pa(Ve.a.pointerOut,this.domElement,this.kN),this.wc.Bt("blur")||this.wc.ja("blur",this.onBlur),this.wc.Bt("focus")||this.wc.ja("focus",this.onFocus),this.domElement.title=this.fgh,this.pl=!0)};db.prototype.disable=function(){this.domElement&&(this.domElement.classList.add(Ej.a.BY),this.domElement.style.cursor="",this.isEnabled&&(Mg.a.instance.za(Ve.a.click,
this.domElement,this.Vc),hk.KeyInputManager.instance.za(Ve.a.Rb,this.domElement,this.onKeyDown),nj.a.instance.za(Ve.a.pointerOver,this.domElement,this.hw),nj.a.instance.za(Ve.a.pointerOut,this.domElement,this.kN)),this.domElement.title=this.Qah,this.pl=!1)};db.prototype.dispose=function(){this.isEnabled&&(Mg.a.instance.za(Ve.a.click,this.domElement,this.Vc),hk.KeyInputManager.instance.za(Ve.a.Rb,this.domElement,this.onKeyDown),nj.a.instance.za(Ve.a.pointerOver,this.domElement,this.hw),nj.a.instance.za(Ve.a.pointerOut,
this.domElement,this.kN),this.pl=!1);Le.DOMElementExtensions.setVisible(this.domElement,!1);Gk.prototype.dispose.call(this)};db.yb=function(e,C,M,qa,Na,Hb,Gc,gd){e.removeAttribute("Href");e.setAttribute(If.a.Sd,If.a.zr);e.className=C;e.tabIndex=gd;C=document.createElement("span");C.className=Gc;C.classList.add(M);C.tabIndex=-1;e.appendChild(C);e=document.createElement("img");e.src=vh.a.Be(qa);e.className=Na;e.alt=Hb;e.tabIndex=-1;C.appendChild(e);return e};tl.Object.defineProperties(db.prototype,
{Wj:{configurable:!0,enumerable:!0,get:function(){return this.EI}},isEnabled:{configurable:!0,enumerable:!0,get:function(){return this.pl}}});Object(sd.a)(db,"ListButton",ei.a,[666,3]);var Lg=b(123),Hk=pc.a.xUg,Ik=ei.a;vm(Ba,Ik);Ba.prototype.dispose=function(){this.$&&(this.AKb(!1),this.gridView.ha.vN(this.Gh),this.gridView.Us(this.onContentReady),this.gridView.rc.r4i(this.itf),this.$.Fn(this.qd));this.GBe(!1);this.HBe(!1);ff.a.pc(this.V3b);this.V3b=this.Vga=this.dg=this.$V=this.yI=this.gridView=
this.$=null;Ik.prototype.dispose.call(this)};Ba.prototype.u5c=function(e){return!!this.v2a(e)};Ba.prototype.Wpb=function(e,C){return kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5879568_ReactDataValidationErrorDialog")?new Ic(this.$,e,C):new uc(this.$,e,C)};Ba.prototype.v2a=function(e){e=this.gridView.getRangeInformation(e);for(var C=0;C<e.length;C++){var M=e[C];if(Object(ig.a)(Jj.DataValidationRange,M))return M}return null};Ba.prototype.aDh=function(){if(!this.E3a)return"";var e=this.C4e?String.format("{0} {1}",
this.su.rGf,this.su.prompt):"",C=this.vvb?fe.a.instance.ea(822):"";return String.format(fe.a.instance.Cb(17),e,C)};Ba.prototype.ki=function(e){var C=!1;if(this.isListVisible||(-569786022===e||541421805===e)&&this.vvb||1872288872===e&&this.CQ)switch(e){case -569786022:case 541421805:this.show(this.CQ,!this.isListVisible,!0,Mf.a.Pr||3===eg.a.Wb);C=!0;break;case 1872288872:this.isListVisible?(this.show(this.CQ,!1,!0,!1),C=!0):this.CQ?(this.show(!1,!1,!0,!1),C=!0):this.qb&&(this.qb.endEdit(!1,"DataValidationControl.HandleKeyDown",
0),C=!0);break;case -798660877:this.Oh.MA(1);C=!0;break;case 137938150:this.Oh.MA(-1);C=!0;break;case 2091832999:this.Oh.MA(this.Oh.xH-1);C=!0;break;case 742457698:this.Oh.MA(-(this.Oh.xH-1));C=!0;break;case 125627505:case 267796030:C=this.CQa()}return C};Ba.prototype.show=function(e,C,M,qa){this.wx();if(this.Iyb&&this.E3a){var Na=this.BNa;if(Na){if(e||C||M)this.isVisible=!0;Vj.d(this.style,this.isGridRtl);M&&this.vvb&&(this.HBe(!0),this.q$f(Na,!1));C&&this.vvb&&this.qRa(qa,Na);e&&this.C4e&&this.Ctj(Na);
this.Egi||(this.isVisible=!1)}}};Ba.prototype.Kua=function(e,C){if(!C||!C.cell.tk)return null;var M=this.gridView.rc.textBox.domElement;var qa=0<Le.DOMElementExtensions.getHeight(M)&&0<Le.DOMElementExtensions.getWidth(M)&&0<=M.offsetTop&&0<=M.offsetLeft;if(qa)M=Le.DOMElementExtensions.Kua(M,e.Ui);else{M=e.getCellBounds(C.cell);var Na=Le.DOMElementExtensions.getBoundingClientRect(e.Ui);M=new Sys.UI.Bounds(M.x-Na.x,M.y-Na.y,M.width,M.height)}if(M)if(qa)2<M.height&&2<M.height&&(M.x+=1,M.y+=1,M.height-=
2,M.width-=2);else if(qa=Ye.g(this.$).BJ(C.cell))qa=qa.width+1,Na=K.a.equals(Fk.a.u2a(C.cell,e.rtl),"right",!0),e.rtl&&Na&&(M.x=M.x+M.width-qa),C.oka&&e.rtl===Na&&(M.width=qa);else return null;return M};Ba.prototype.m_f=function(e){var C=this.E3a;this.AKb(C);C?this.show(!0,e,!0,!1):this.wx()};Ba.prototype.CQa=function(){var e=!1;this.isListVisible&&(e=this.Oh.CQa(this.qb),this.show(this.CQ,!1,!0,!1));return e};Ba.prototype.wx=function(){this.z$h?(this.isListVisible&&(this.isListVisible=!1),this.jLa&&
(this.jLa=!1),this.CQ&&(this.CQ=!1),this.isVisible&&(this.isVisible=!1)):this.isListVisible=this.jLa=this.CQ=this.isVisible=!1;this.Kmd=this.Nkd=this.Gnd=!1};Ba.prototype.qRa=function(e,C){this.vvb&&!this.su.tHa?this.jLa&&this.Eh.disable():(this.GBe(!0),this.Oh.Sda(this.su.tHa,e,this.PLh(C),this.qb),this.XAa(C,!1))};Ba.prototype.Ctj=function(e){this.su.prompt&&(this.CQ=!0,this.VKj(this.su.rGf,this.su.prompt),this.J$f(e,!1))};Ba.prototype.q$f=function(e,C){var M=e.y;this.Vga.style.top=ab.HelperMethods.Qb(M);
e=this.isGridRtl?e.x-this.Vga.offsetWidth+1:e.x+e.width+1;this.Vga.style.left=ab.HelperMethods.Qb(e);C?this.jLa=this.gridView.Rgc(new rj.a(e,M))&&this.Nkd:this.Nkd=!0};Ba.prototype.XAa=function(e,C){var M=e.y+e.height;e=this.isGridRtl?e.x+e.width-this.dg.offsetWidth:e.x;this.dg.style.top=ab.HelperMethods.Qb(M);this.dg.style.left=ab.HelperMethods.Qb(e);C?this.isListVisible=this.gridView.Rgc(new rj.a(e,M))&&this.Kmd:this.Kmd=!0};Ba.prototype.J$f=function(e,C){var M=e.y+e.height+5,qa=this.activeCell;
qa=qa?qa.width/2:32;e=this.isGridRtl?e.x-this.$V.offsetWidth+qa:e.x+e.width-qa;this.$V.style.top=ab.HelperMethods.Qb(M);this.$V.style.left=ab.HelperMethods.Qb(e);C?this.CQ=this.gridView.Rgc(new rj.a(e,M))&&this.Gnd:this.Gnd=!0};Ba.prototype.VKj=function(e,C){if(C){var M="";e&&(M+=String.format("<p class='dv-prompt-title'>\r\n\t<span class='dv-prompt-titletext'>{0}</span>\r\n</p>",dh.a.If(e)));M+=String.format("<p class='dv-prompt-message'>\r\n\t<span class='dv-prompt-messagetext'>{0}</span>\r\n</p>",
dh.a.If(C));this.$V.innerHTML=M;e=Le.DOMElementExtensions.vj(this.$V,"dv-prompt-titletext");if(C=Le.DOMElementExtensions.vj(this.$V,"dv-prompt-messagetext"))for(e=e?parseInt(String(Math.max(e.offsetWidth,C.offsetWidth))):C.offsetWidth,e+=6,Le.DOMElementExtensions.Gq(this.$V,e),C=0,M=this.$V.children.length;C<M;C++)Le.DOMElementExtensions.Gq(this.$V.children[C],e)}};Ba.prototype.PLh=function(e){if(this.A$h)return e.width+17-2+1;var C=this.Vga.clientWidth;this.oci&&17!==C&&Dd.ULS.sendTraceTag(528855200,
0,15,"DataValidationControl.getListBoxWidth: buttonWidth is "+C);return e.width+C-2+1};Ba.prototype.HBe=function(e){this.$&&!this.Iyb||!e?(this.m3f(!1),ff.a.Fa(this.Eh),this.Eh=null):(this.Eh||(this.Eh=new db(this.Vga,"ewa-dv-listbutton",Ej.a.Iha,1,"ewa-dv-listbutton",fe.a.instance.ea(873),Hk,fe.a.instance.ea(872),"",-1),this.m3f(!0)),this.jLa=!0,this.su.tHa?this.Eh.isEnabled||this.Eh.enable():this.Eh.disable())};Ba.prototype.GBe=function(e){this.$&&!this.Iyb||!e?(this.QRa(!1),ff.a.Fa(this.Oh),this.Oh=
null):(this.Oh||(this.Oh=new Zb(this.$,this.dg,this.T6a),this.QRa(!0)),this.isListVisible=!0)};Ba.prototype.QRa=function(e){this.Oh&&(e&&!this.LQ?(this.Oh.k9(this.Axd),this.Oh.IXb(this.JKa),this.Oh.tmb(this.Zxa),this.LQ=!0):!e&&this.LQ&&(this.Oh.Kca(this.Axd),this.Oh.Hqc(this.JKa),this.Oh.qGb(this.Zxa),this.LQ=!1))};Ba.prototype.AKb=function(e){e&&!this.pQ?(this.gridView.view.it(this.Ns),this.pQ=!0):!e&&this.pQ&&(this.gridView.view.Wr(this.Ns),this.pQ=!1)};Ba.prototype.m3f=function(e){this.Eh&&(e&&
!this.q_b?(this.Eh.XSc(this.VNa),this.Eh.nTc(this.VNa),this.Eh.cmb(this.JKa),this.q_b=!0):!e&&this.q_b&&(this.Eh.BGd(this.VNa),this.Eh.RGd(this.VNa),this.Eh.aGb(this.JKa),this.q_b=!1))};Ba.prototype.y$f=function(){if(this.E3a){var e=this.BNa;e&&(this.q$f(e,!0),this.XAa(e,!0),this.J$f(e,!0))}};tl.Object.defineProperties(Ba.prototype,{Iyb:{configurable:!0,enumerable:!0,get:function(){return!!(this.$.Fd&16)}},Egi:{configurable:!0,enumerable:!0,get:function(){return this.isListVisible||this.CQ||this.jLa}},
isListVisible:{configurable:!0,enumerable:!0,get:function(){return Le.DOMElementExtensions.isVisible(this.dg)},set:function(e){Le.DOMElementExtensions.setVisible(this.dg,e)}},CQ:{configurable:!0,enumerable:!0,get:function(){return Le.DOMElementExtensions.isVisible(this.$V)},set:function(e){Le.DOMElementExtensions.setVisible(this.$V,e)}},jLa:{configurable:!0,enumerable:!0,get:function(){return Le.DOMElementExtensions.isVisible(this.Vga)&&!!this.Eh&&Le.DOMElementExtensions.isVisible(this.Eh.domElement)},
set:function(e){Le.DOMElementExtensions.setVisible(this.Vga,e);this.Eh&&Le.DOMElementExtensions.setVisible(this.Eh.domElement,e)}},qb:{configurable:!0,enumerable:!0,get:function(){return this.yI},set:function(e){this.yI=e}},E3a:{configurable:!0,enumerable:!0,get:function(){return!!this.activeCell&&this.u5c(this.activeCell.range)}},activeCell:{configurable:!0,enumerable:!0,get:function(){return this.gridView.sc(null)}},C4e:{configurable:!0,enumerable:!0,get:function(){return this.E3a&&!!this.su&&!!(this.su.options&
2)&&!!this.su.prompt}},vvb:{configurable:!0,enumerable:!0,get:function(){return this.E3a&&!!this.su&&!!(this.su.options&1)}},isGridRtl:{configurable:!0,enumerable:!0,get:function(){return this.gridView.rtl}},su:{configurable:!0,enumerable:!0,get:function(){return this.v2a(this.activeCell.range)}},BNa:{configurable:!0,enumerable:!0,get:function(){var e=this.activeCell;return e?this.Kua(this.gridView,e):null}}});Object(sd.a)(Ba,"DataValidationControl",ei.a,[575,3]);var yk=vb.a;vm(Wa,yk);Wa.prototype.create=
function(){this.Fb(this.$.da.Aa(14)||new Ba(this.$))};Object(sd.a)(Wa,"DataValidationControlFactory",vb.a,[]);Za.B8c="!";Za.QBf="[";Za.PBf="]";Za.openParen="(";Za.closeParen=")";Za.Ccg=" /.(*\\".split("");Za.T5b="...";Za.MDb="param_help_link";Za.vAd="param_help_udf";Za.wad="function_list_box";Za.szh="function_param_box";Za.yad="function_reader_description";Za.rad="function_description_box";Za.CSe="function_param_table";Za.WOi="param_row_";Za.wAd="param_set";Za.wCf="param_row_0";Za.xCf="param_row_1";
Za.tzh="<div id='{0}' class='{1}'></div>";Za.rzh="<div id='{0}' class='{1} {2} {3}'>\r\n\t<table id='{4}'>\r\n\t\t{5}\r\n\t\t{6}\r\n\t</table>\r\n</div> ";Za.yCf="<tr>\r\n\t<td id='{0}'>\r\n\t\t<span id='{0}_{1}' class='{2}'></span>\r\n\t\t<a href = '#' id='{0}_{3}' class='{4}'></a>\r\n\t\t<span id ='{0}_{5}'></span>\r\n\t</td>\r\n</tr>";Za.ozh="<div id='{0}' class='{1} {2} {3}'></div>";Za.lzh="<div id='{0}' class='{1} {2} {3} {4}'></div>";Za.fhf="[@";Za.d_g=1;Za.c_g=3;Za.f9g=500;Za.amf=50;Object(sd.a)(Za,
"FormulaAssistanceConstants",null,[]);var bk=b(68),Sg=b(219);Object(sd.a)(dc,"FormulaAuthoringUsageDetails",null,[]);Object(sd.a)(Xb,"FormulaSuggestionsUsageDetails",null,[]);Object(sd.a)($a,"AutocompleteCardInteractionUsageDetails",null,[]);Object(sd.a)(kb,"AutocompleteRenderOptimizationDetails",null,[]);Object(sd.a)(Ua,"SessionDetails",null,[]);Object(sd.a)(Ha,"PerfMetrics",null,[]);Object(sd.a)(Ga,"AggregatedPerfMetrics",null,[]);bb.prototype.IRa=function(){this.njc=Xg.a.Ra.re.m};bb.prototype.aia=
function(e){-1!==this.njc&&(e?(this.Wlb(Xg.a.Ra.re.m-this.njc),this.njc=-1):this.s_.failedCount++)};bb.prototype.Quh=function(){this.s_.excludingFirstAction=bb.iQe(this.I5b);Array.add(this.I5b,this.s_.firstAction);this.s_.includingFirstAction=bb.iQe(this.I5b)};bb.prototype.Wlb=function(e){var C=this;this.s_.count?1E3>this.s_.count&&Array.add(this.I5b,e):this.s_.firstAction=e;this.Gmf&&this.Hmf&&this.Hmf.forEach(function(M){e>M&&C.s_.countAboveThresholds[M]++});this.s_.count++};bb.iQe=function(e){var C=
new Ga;0<e.length&&(xd.i(e),C.median=e[Math.floor(.5*e.length)],C.P75=e[Math.floor(.75*e.length)],C.P95=e[Math.floor(.95*e.length)],C.max=e[e.length-1],C.average=xd.g(e,function(M){return M})/e.length);return C};Object(sd.a)(bb,"PerformanceMeasurement",null,[]);var zk=b(38),Mj=b(101),cj={},ck=(cj.argumentAssistanceOverall=[50,80,100,130,150,170,200],cj);ka.prototype.Z6=function(e){var C=this;e.forEach(function(M){C.x9a.wb(M)||C.x9a.ia(M,new bb(ck[M]));C.x9a.na(M).IRa()})};ka.prototype.SY=function(e,
C){var M=this;C=void 0===C?!0:C;e.forEach(function(qa){M.x9a.wb(qa)&&M.x9a.na(qa).aia(C)})};ka.prototype.oUf=function(e){var C="Undefined";switch(e){case 1:C="Collapsed";break;case 0:C="Expanded";break;case 2:C="Hidden"}this.Fia.argumentAssistanceCardInitialMode=C};ka.prototype.e6b=function(e){var C=this;window.requestAnimationFrame(function(){C.SY([e])})};ka.prototype.getJsonForLogging=function(){return"{"+this.T2("SessionDetails",this.Btc)+","+this.T2("FormulaAuthoringUsage",this.Fia)+","+this.T2("FormulaSuggestionsUsage",
this.P8b)+","+this.T2("AutocompleteCardInteraction",this.q2)+","+this.T2("AutocompleteRenderOptimization",this.znb)+","+this.eRh()+"}"};ka.prototype.rlj=function(){this.Btc.argumentAssistanceFlight=this.ycd("Microsoft.Office.ExcelOnline.","ArgumentAssistancePlugin");this.Btc.autoCompleteUIFlight=this.ycd("Microsoft.Office.Excel.","AutoCompleteNewUI");this.Btc.smartFormulaBarAutoCompleteFlight=this.ycd("Microsoft.Office.Excel.","SmartFormulaBarAutocompleteIsEnabled")};ka.prototype.eRh=function(){for(var e=
new lc.a,C=yl(this.x9a),M=C.next();!M.done;M=C.next())M=M.value,M.value.Quh(),e.add(String.format('"{0}":{1}',M.key,xi.a.Hc(M.value.s_)));return String.format('"PerfMeasurements": {{{0}}}',e.toArray().join(","))};ka.prototype.ycd=function(e,C){return K.a.contains(this.vb.ya.FlightHolder.FlightId,C,!0)?kd.EwaSettings.getBooleanFeatureGate(e+C,!1)?"T":"C":"None"};ka.prototype.T2=function(e,C){return String.format('"{0}":{1}',e.toString(),zk.c(C))};tl.Object.defineProperties(ka.prototype,{$:{configurable:!0,
enumerable:!0,get:function(){return this.vb},set:function(e){this.vb||(this.vb=e,this.vb.Vl(this.qd))}}});tl.Object.defineProperties(ka,{instance:{configurable:!0,enumerable:!0,get:function(){ka.Na||(ka.Na=new ka);return ka.Na}}});ka.Na=null;Object(sd.a)(ka,"FormulaAssistanceTelemetryManager",null,[]);var V=b(351),va=Ci.a;vm(wb,va);wb.prototype.initialize=function(){this.Ob.classList.add(bk.a.Ejh);this.Ob.innerHTML=wb.tG();this.Le||(this.Vk(),this.f2());va.prototype.initialize.call(this);var e=Le.DOMElementExtensions.vj(this.Ob,
"ewa-dlg-function-link-container");this.rtl&&(e.align="right",this.etb.style.marginLeft="5px");this.Le&&(e.style.padding="1px");this.functionInfoManager.Jrb({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0)};wb.prototype.dispose=function(){this.functionInfoManager&&(this.functionInfoManager.Fqc(this.onFunctionInfoLoaded),this.functionInfoManager.$.fa.kk(this.Zc));ff.a.pc([this.b0b,this.v5,this.Nvb,this.eJa,this.ftb]);va.prototype.dispose.call(this)};wb.prototype.Vk=function(){this.fJa=Le.DOMElementExtensions.vj(this.Ob,
"ewa-dlg-function-category-select");this.Iia=Le.DOMElementExtensions.vj(this.Ob,"ewa-dlg-select");this.fJa.setAttribute(If.a.Sd,If.a.EFa);this.eJa=new Ti.a(this.fJa,!0);this.ftb=new Ti.a(this.Iia,!0);this.ASe=Le.DOMElementExtensions.vj(this.Ob,"ewa-dlg-function-loading");this.etb=Le.DOMElementExtensions.vj(this.Ob,"ewa-dlg-function-help-link");this.ESe=Le.DOMElementExtensions.vj(this.Ob,"ewa-dlg-udf-name");this.iif=Le.DOMElementExtensions.vj(this.Ob,"ewa-dlg-function-icon");this.BSe=$get(wb.sad,this.Ob);
this.Hia=Le.DOMElementExtensions.vj(this.Ob,"ewa-dlg-function-help-string");this.Le&&(this.Hia.style.paddingLeft="1px");this.functionInfoManager.lmb(this.onFunctionInfoLoaded);this.functionInfoManager.$.fa.Sj(this.Zc)};wb.prototype.qQ=function(e){var C=this;this.$.da.Za(40,function(){C.eJa.qQ(e)})};wb.prototype.lm=function(){this.formulaAssistanceControl.set_visible(!1);va.prototype.lm.call(this);this.ihd||(this.getButton(0).get_element().disabled=!0)};wb.prototype.setFocus=function(){!this.fJa.disabled&&
this.ihd&&Le.DOMElementExtensions.setFocus(this.fJa)};wb.prototype.commit=function(){return!0};wb.prototype.ppb=function(){var e=this,C=this.o$.NameDataStrings;if(kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5658291_FormulasTabImprovements")){var M=new Bf.a(-433697611,0,this.$.ed,8,null),qa={};qa=(qa[eg.a.hd]=C,qa);this.$.Ka.Zb(M,qa)}else{C+=Za.openParen;M=Ye.g(this.$);M.view.visibleArea.contains(M.Lg(null))||M.yt(M.ha.va.activeCell,3,Aj.a.mzh);var Na=this.cIa.textBox;if(this.cIa.isEditing&&this.cIa.text){qa=
this.cIa.text;var Hb=this.xYc?qa.substring(0,this.xYc):"=";this.cIa.text=Hb+C+qa.substring(this.xYc+(Na.Zu?Na.Zu.length:0),qa.length);Na.caretPosition=Hb.length+C.length}else wf.TaskExtensions.Ba(M.startEdit(!0,1),function(){e.cIa.text="="+C;var Gc=C.length+1;Na.BQa(Gc);Na.caretPosition=Gc},this.ma,11,Te.a.current);M.xj&&(M=M.Kc,M.text=Na.text,M.setCaretPosition(Na.caretPosition));(M=this.cIa.eP.get(lk.a.iua))&&M.OT(!1)}};wb.prototype.dGa=function(){this.formulaAssistanceControl.inb()};wb.prototype.kua=
function(e){this.ftb.clear();for(var C=wb.sad+" "+wb.wSe,M=0,qa=e.length;M<qa;++M){var Na=this.ftb.AL(e[M].NameUI,e[M].FunctionIndex.toString(),!1);Mf.a.Ku&&Na.classList.add("ewa-dlg-select-option-explorer-edge");Na.setAttribute(If.a.JD,wb.xSe);Na.setAttribute(If.a.HL,C)}this.ftb.selectedIndex=0};wb.prototype.WUf=function(){if(this.o$){this.etb.parentNode.className=bk.a.Kjh+(this.functionInfoManager.hmd(this.o$)?"-udf":"");var e=this.o$.NameDataStrings;this.ESe.innerText=e;this.etb.innerText=e;this.Hia.innerText=
this.o$.Help;e=this.o$.Params.split(Za.B8c);this.BSe.innerText=Za.openParen+(1<e.length?Za.T5b:e[0])+Za.closeParen}};wb.tG=function(){return String.format("<div class='"+bk.a.Fjh+"'>\r\n\t<label for='{6}'>{0}</label>\r\n\t<select id='{6}' class='{9}' disabled='true'></select>\r\n</div>\r\n<div class='"+Eg.a.xu+"'>{1}</div>\r\n<div class='"+bk.a.nKe+"'>\r\n\t<select id='{16}' class='{17} "+pc.a.yu+" "+pc.a.Ir+"' size='{8}'></select>\r\n\t<div class='{11}' >{2}</div>\r\n</div>\r\n<div class='"+bk.a.Ijh+
"'>\r\n\t<div style='direction:ltr' class='{15}'>\r\n\t\t<span class='{14} "+pc.a.yu+"'>\r\n\t\t\t<span class='"+pc.a.OB+" "+bk.a.Jjh+"'>\r\n\t\t\t\t<img title='{3}' class='"+pc.a.Doh+"' src='{4}'/>\r\n\t\t\t</span>\r\n\t\t</span>\r\n\t\t<span id='{19}' class='{13}'></span>\r\n\t\t<a tabindex='0' title='{5}' class='{10}'></a>\r\n\t\t<span id='{7}'></span>\r\n\t</div>\r\n\t<div id='{18}' class='{12}'></div>\r\n</div>",fe.a.instance.ea(1002),fe.a.instance.ea(1003),fe.a.instance.ea(720),fe.a.instance.Cb(3),
vh.a.Be(13),fe.a.instance.ea(1004),wb.kzh,wb.sad,7,"ewa-dlg-function-category-select","ewa-dlg-function-help-link","ewa-dlg-function-loading","ewa-dlg-function-help-string","ewa-dlg-udf-name","ewa-dlg-function-icon","ewa-dlg-function-link-container",wb.pzh,"ewa-dlg-select"+(Mf.a.Ku?" ewa-dlg-select-explorer-edge":""),wb.wSe,wb.xSe)};tl.Object.defineProperties(wb.prototype,{xc:{configurable:!0,enumerable:!0,get:function(){return"FunctionDialog"}},o$:{configurable:!0,enumerable:!0,get:function(){if(!this.Iia||
!this.Iia.firstChild)return null;var e=Number.parseInvariant(this.Iia.children[this.Iia.selectedIndex].value);return this.functionInfoManager.LJh(e)}}});wb.sad="function_dialog_param_string";wb.wSe="function_dialog_function_description";wb.xSe="function_dialog_function_name";wb.pzh="function_list";wb.kzh="function_category";Object(sd.a)(wb,"FunctionDialog",Ci.a,[]);rc.prototype.Xc=function(e,C){if(!kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5658291_FormulasTabImprovements"))return!1;switch(C){case 753860909:case -2060563418:case 917756490:case -1756230110:case -1702465186:case -977299160:case 2135922458:case -1960662393:case -1999560076:case 493672674:case -1031255406:case 548833656:case 641360851:case -433697611:return e=
Ye.g(this.$).Jj,(C=e.eP.get(lk.a.iua))&&(C.rwb||!e.isEditing||0>=e.text.length)?!1:!0;default:return!1}};rc.prototype.executeCommand=function(e,C,M){C=C.command;e=Ye.g(this.$);switch(C){case 753860909:case -2060563418:kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5658291_FormulasTabImprovements")?(M=e.Jj,e.inRangePicker&&M.MD(!1),this.create(M)):e.sc(null)&&(M=e.Jj,(C=M.eP.get(lk.a.iua))&&(C.rwb||!M.isEditing||0>=M.text.length)&&(e.inRangePicker&&M.MD(!1),this.create(M)));break;case -433697611:var qa=
M[eg.a.hd]+Za.openParen;M.UILocation&&this.$.Ce(-1075437823,-1,0,null);e.view.visibleArea.contains(e.Lg(null))||e.yt(e.ha.va.activeCell,3,Aj.a.nyh);var Na=e.Jj,Hb=Na.textBox;M=Na.textBox.caretPosition;if(Na.isEditing&&Na.text){C=Na.text;var Gc=M?C.substring(0,M):"=";Na.text=Gc+qa+C.substring(M+(Hb.Zu?Hb.Zu.length:0),C.length);Hb.caretPosition=Gc.length+qa.length}else wf.TaskExtensions.Ba(e.startEdit(!0,1),function(){Na.text="="+qa;var gd=qa.length+1;Hb.BQa(gd);Hb.caretPosition=gd},this.$.ma,11,Te.a.current);
e.xj&&(e=e.Kc,e.text=Hb.text,e.setCaretPosition(Hb.caretPosition));(e=Na.eP.get(lk.a.iua))&&e.OT(!1)}return Fg.Task.Ta(!0)};rc.prototype.Gc=function(e,C){switch(C.command){case 753860909:case -2060563418:case -433697611:return!0;default:return!1}};rc.prototype.iAh=function(e,C){C=this.Sa.zp(C);var M=this.Sa.Lc(),qa=this.functionInfoManager.RWe(e);if(!qa)return Dd.ULS.sendTraceTag(537162067,0,15,"FormulaAssistanceCommandHandler.GenerateFunctionMenu: functionList is null"),C.JB();for(var Na=0;Na<qa.length;++Na){var Hb=
qa[Na].NameUI,Gc=this.Sa.AP(280,"Formulas."+e+"MenuItem_"+qa[Na].FunctionIndex.toString(),-433697611,null,1,"None",0,0,Hb,!1,0);Gc.label=Hb;var gd=qa[Na].Params.split(Za.B8c);Gc.DR(Hb+" "+(Za.openParen+(1<gd.length?Za.T5b:gd[0])+Za.closeParen)+"\n"+qa[Na].Help);Array.add(M.buttons,Gc)}e=this.Sa.Lc();qa=this.Sa.AP(280,"Formulas.MoreFunctionsMenuItem",-2060563418,pc.a.xNe,3,"Image16by16",1001,0,"Formulas.MoreFunctionsMenuItem",!1,0);Array.add(e.buttons,qa);Array.add(C.yc,M);Array.add(C.yc,e);return C.JB()};
rc.prototype.fd=function(e,C,M){e=this.KJh(C);if(-1===e)return!1;this.menuId=M.MenuId;if(!this.functionInfoManager.I4)return this.functionInfoManager.Jrb({Filter:null,FilterType:2,IncludeOneOfEachGroupUI:!0},!0),!1;e=this.functionInfoManager.vSe[e];this.LL[e]=this.LL[e]||this.iAh(e,M.MenuId);M.MenuItems=this.LL[e];return!0};rc.prototype.create=function(e){(new wb(this.$,e)).mf()};rc.prototype.KJh=function(e){switch(e){case "PopulateFinancialFnsMenu":return 2;case "PopulateLogicalFnsMenu":return 9;
case "PopulateTextFnsMenu":return 8;case "PopulateDateTimeFnsMenu":return 3;case "PopulateLookupReferenceFnsMenu":return 6;case "PopulateMathTrigFnsMenu":return 4;case "PopulateStatisticalFnsMenu":return 5;case "PopulateEngineeringFnsMenu":return 11;case "PopulateCubeFnsMenu":return 12;case "PopulateInformationFnsMenu":return 10;default:return-1}};Object(sd.a)(rc,"FormulaAssistanceCommandHandler",null,[237]);var jb=cf.a;vm(tb,jb);tb.prototype.Md=function(){var e=this,C=td.GetServiceTaskFactory.create(this.$.da,
102,this.ma,this.tb),M=td.GetServiceTaskFactory.create(this.$.da,153,this.ma,this.tb);wf.TaskExtensions.Ba(wf.TaskExtensions.ve([C,M],this.ma),function(){e.Ed([new rc(e.$,C.result,M.result)])},this.ma,3)};tb.ja=function(e){cf.a.de(92,new tb(e))};Object(sd.a)(tb,"FormulaAssistanceCommandHandlerFactory",cf.a,[]);eb.prototype.dispose=function(){this.OUd();this.gJa=this.dua=this.Eia=null};eb.prototype.yVc=function(e){e&&(this.Eia=e,this.Eia.Qke(this.Qxf),this.Eia.Gle(this.Sxf),this.G4a&&this.Eia.Fle(this.Rxf))};
eb.prototype.zVc=function(e){e&&(this.dua=e,this.ALa&&(this.dua.Oke(this.duf),this.dua.Mke(this.Xtf)),this.zLa&&this.dua.Nke(this.$tf))};eb.prototype.Rpe=function(e){e&&(this.gJa=e,this.gJa.Hle(this.Txf),this.gJa.pTc(this.Mxf))};eb.prototype.OUd=function(){var e,C,M;this.Eia&&(this.Eia.vMf(this.Qxf),this.Eia.UMf(this.Sxf),this.G4a&&this.Eia.TMf(this.Rxf));this.gJa&&(this.gJa.VMf(this.Txf),this.gJa.SGd(this.Mxf));this.ALa&&(null===(e=this.dua)||void 0===e?void 0:e.uMf(this.duf),null===(C=this.dua)||
void 0===C?void 0:C.sMf(this.Xtf));this.zLa&&(null===(M=this.dua)||void 0===M?void 0:M.tMf(this.$tf))};eb.prototype.$Yi=function(e,C){if(C){var M="";this.G4a||(M+=fe.a.instance.Cb(56)+this.ariaLiveNotifier.Zwa);for(var qa=0;qa<C.length;qa++)M+=e+this.ariaLiveNotifier.Zwa+this.$Wc(C[qa])+eb.ABd(qa,C.length);this.G4a&&(M+=fe.a.instance.ea(861)+this.ariaLiveNotifier.Zwa);this.ariaLiveNotifier.readText(M)}};eb.prototype.ZYi=function(e,C,M){if(e){var qa="",Na=0;if(C){for(var Hb=0;Hb<C.length;Hb++)if(M>=
e[Hb].split(this.$.listSeparator).length)Na++;else{var Gc=C[Hb].trim();if(!Gc)return;Gc=this.$Wc(Gc);var gd=eb.ABd(Hb-Na,C.length-Na);qa+=Gc+gd;gd&&(qa+=this.ariaLiveNotifier.Zwa)}this.ariaLiveNotifier.readText(qa)}}};eb.prototype.$Wc=function(e){if(!e)return"";var C=e.split(this.$.listSeparator);e="";C=yl(C);for(var M=C.next();!M.done;M=C.next()){var qa=M.value;eb.Gld(qa)?e+=qa:(qa=(M=eb.cdi(qa))?qa.replace("[","").replace("]",""):qa,e+=String.format(M?fe.a.instance.Cb(58):fe.a.instance.Cb(57),qa));
e+=this.ariaLiveNotifier.Zwa}return e};eb.ABd=function(e,C){if(e>=C||1===C)return Dd.ULS.shipAssertTag(537161997,0,e<C,"FormulaAssistanceControl.PositionInList: requested item index >= list length."),""};eb.Gld=function(e){return K.a.contains(e,Za.T5b,!0)};eb.cdi=function(e){return e.trimStart().startsWith(Za.QBf)||e.trimEnd().endsWith(Za.PBf)};Object(sd.a)(eb,"FormulaAssistanceReadoutHandler",null,[570,3]);var ac=vb.a;vm(Ta,ac);Ta.prototype.create=function(){var e=this,C=this.$.da;wf.TaskExtensions.Ba(td.GetServiceTaskFactory.Xa(C,
211,212,this.tb),function(M){M=C.Aa(219)||new eb(M.result,e.$);e.Fb(M)},this.ma,3)};Ta.ja=function(e){e.da.Ha(220,new Ta(e))};Object(sd.a)(Ta,"FormulaAssistanceReadoutHandlerFactory",vb.a,[]);var Kc=b(687),cd=b(110),zc=b(1132);fb.prototype.bfd=function(e){return this.RPa&&e in this.RPa?this.RPa[e]:null};fb.prototype.J2f=function(e,C){this.RPa||(this.RPa={});this.RPa[e]=C};fb.prototype.uZ=function(){this.RPa=null};Object(sd.a)(fb,"FormulaAssistanceContextualPreviewCache",null,[]);Tc.prototype.dispose=
function(){this.Ld||(this.$&&(this.$.fa.TC(this.Nx),this.$=null),this.$ga=this.$Db=null,this.Ld=!0)};Tc.prototype.Nbd=function(e,C,M,qa){var Na=this;if(C&&0>=C.length)throw Error.argumentNull("GetContextualFormulaPreviewResults - currentFormula is null or empty");if(!e)throw Error.argumentNull("GetContextualFormulaPreviewResults - formulaSubExpressionObject is null");this.calcManager=this.$.da.Aa(266);if(!this.calcManager)throw Error.invalidOperation("GetContextualFormulaPreviewResults failed - No CalcManager");
var Hb="="+C.substring(M.start,M.end);kd.EwaSettings.la(622)&&(Hb=this.calcManager.qSh(Ye.g(this.$).ha.va.activeCell,e,M));var Gc=this.TFh(Hb,M);if(kd.EwaSettings.la(622)){if(Gc&&!this.calcManager.isFormulaSubExpressionVolatile(e))return Promise.resolve(Gc)}else if(Gc)return Promise.resolve(Gc);return this.VFh(Hb,M).then(function(gd){if(Na.gZc(qa))throw Error.create("OperationCanceledException");if(!gd||gd.W$i||gd.nma.startsWith("##UNSUPPORTED:"))return Na.mVe(C,Hb,M,qa);Na.$ga.J2f(Hb,gd.nma);return Promise.resolve(gd)})};
Tc.prototype.TFh=function(e,C){return(e=this.$ga.bfd(e))?new zc.a(e,C.start,C.end,0):null};Tc.prototype.VFh=function(e,C){if(!e||0>=e.length||!C)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");return this.calcManager.SOg(Ye.g(this.$).ha.va.activeCell,e,this.pri,C)};Tc.prototype.mVe=function(e,C,M,qa){var Na=this;if(!e||0>=e.length||!C||0>=C.length||!M)throw Error.argument("GetContextualFormulaPreviewResultsFromFormulaInspector failed - Invalid currentFormula or formulaSpan");
if(this.iOa)return this.UFh(e,C,M,qa);var Hb={};Hb.PartialFormula=C;Hb.Formula=e;Hb.SourceRange=jg.v(Ye.g(this.$).ha.va.activeCell,this.$);return this.iOa=new Promise(function(Gc,gd){Na.$Db=new Kc.a;Na.XOf=Na.$.fa.rf;Na.w9a=ub(Na.$.qa.ta,Hb,function(Uc){Na.LMi(C,M,qa,Uc,Gc,gd)},function(Uc){Na.iOa=null;Na.w9a=null;gd(Uc)},null,null,null);Na.$Db.token.R(function(){Na.vQg(gd)})})};Tc.prototype.LMi=function(e,C,M,qa,Na,Hb){this.w9a=this.iOa=null;if(this.XOf!==this.$.fa.rf)Hb(Error.create("OperationCanceledException"));
else if(qa.Result)if(qa=xi.a.li(qa.Result),!qa||cd.a.isEmpty(qa))Na(null);else{for(var Gc in qa)this.$ga.J2f(Gc,qa[Gc]);this.gZc(M)?Hb(Error.create("OperationCanceledException")):(e=this.$ga.bfd(e))?(""===e&&(e=" "),Na(new zc.a(e,C.start,C.end,0))):Hb(Error.create("SubexpressionNotFoundException"))}else Na(null)};Tc.prototype.UFh=function(e,C,M,qa){var Na=this;return new Promise(function(Hb,Gc){Na.iOa.then(function(){Na.HPf(e,C,M,qa,Hb,Gc)}).catch(function(){Na.HPf(e,C,M,qa,Hb,Gc)})})};Tc.prototype.HPf=
function(e,C,M,qa,Na,Hb){if(this.gZc(qa))Hb(Error.create("OperationCanceledException"));else{var Gc=this.$ga.bfd(C);Gc?Na(new zc.a(Gc,M.start,M.end,0)):this.mVe(e,C,M,qa).then(function(gd){Na(gd)}).catch(function(gd){Hb(gd)})}};Tc.prototype.vQg=function(e){this.w9a&&(ye.a.Zt(this.w9a.kt)?(this.iOa=this.w9a=null,e(Error.create("PendingWebReqeuestCancelled"))):Dd.ULS.sendTraceTag(537162063,0,10,"Failed to cancel the pending web request!"))};Tc.prototype.uZ=function(){this.wQg();this.$ga&&this.$ga.uZ()};
Tc.prototype.wQg=function(){this.$Db&&this.$Db.C()};Tc.prototype.gZc=function(e){return this.Ld||e.TJ};Object(sd.a)(Tc,"FormulaAssistanceContextualPreviewCalculator",null,[3]);var Mc=b(139),ld=b(209);wd.pkh="ewa-facp-text-box";Object(sd.a)(wd,"CssClassNames",null,[]);Pc.prototype.dispose=function(){(this.h$||this.zP)&&this.s5e();this.qb=this.Lpa=null};Pc.prototype.QIj=function(e,C,M,qa){e&&C&&qa&&C.nma&&!(1>C.nma.length)&&(this.qb=e,this.zLf(),this.Z0a=C,this.SRa=qa,this.Lrj(C,M,qa))};Pc.prototype.s5e=
function(){this.O_h();this.zLf();this.SRa=this.Z0a=null};Pc.prototype.Lrj=function(e,C,M){var qa=this;if(e.nma&&!(1>e.nma.length)){var Na=this.Nc.da.Aa(266);if(Na){var Hb=Na.QLh();Hb&&wf.TaskExtensions.Ba(this.Xzb,function(){if(C)if(kd.EwaSettings.la(622)&&qa.qb.isEditing&&0<M.length){qa.Yvb(e.cJa,M[0].start,null);var Gc=qa.h0e(M[0],Hb),gd=qa.qb.text.substring(M[0].start,M[0].end).trim();gd=qa.qb.text.indexOf(gd);gd=qa.qb.text.substring(0,gd).lastIndexOf("\n");qa.Yvb(0>gd||1>=M.length?M[0].start:
gd+1,M[0].end,Gc?String.format(Gc,.3):null);for(var Uc=1;Uc<M.length;Uc++)Gc=qa.h0e(M[Uc],Hb),gd=qa.qb.text.substring(M[Uc].start,M[Uc].end).trim(),gd=qa.qb.text.indexOf(gd),gd=qa.qb.text.substring(M[Uc-1].end,gd).lastIndexOf("\n"),qa.Yvb(0>gd?M[Uc-1].end:gd+1+M[Uc-1].end,M[Uc].end,Gc?String.format(Gc,.3):null);gd=qa.qb.text.substring(M[M.length-1].end,e.fua).indexOf("\n");qa.Yvb(0>gd?M[M.length-1].end:gd+1+M[M.length-1].end,e.fua,null);Dd.ULS.sendTraceTag(537162061,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Colored highlighting and partial evaluation completed")}else qa.Yvb(e.cJa,
e.fua,null),Dd.ULS.sendTraceTag(537162060,0,50,"FormulaAssistanceContextualPreviewControl.ShowContextualFormulaPreviewContainer: Default highlighting and partial evaluation completed");qa.h$||(qa.h$=document.createElement(ld.a.div),qa.qb.textBox.domElement.appendChild(qa.h$));qa.zP||(qa.zP=document.createElement(ld.a.div),qa.zP.className=wd.pkh,qa.Nc.domElement.appendChild(qa.zP));Gc=e.fua;kd.EwaSettings.la(622)&&qa.qb.isEditing&&M&&0<M.length&&M[0].start<Gc&&M[0].start!==e.cJa&&!qa.qb.textBox.Zu.length&&
(Gc=M[0].start);Uc=K.a.contains(qa.qb.textBox.nf.id,"FormulaBar",!0)&&K.a.contains(qa.qb.text.substring(e.cJa,e.fua),"\n",!0);gd=qa.qb.isEditing?qa.qb.textBox.caretPosition:0;Gc=excelOnline.utils.getBoundingRectForText(qa.qb.textBox.nf,Uc?gd:e.cJa,Uc?gd:Gc,kd.EwaSettings.la(622));qa.zP.style.left=ab.HelperMethods.Qb(Gc.left);qa.zP.style.top=ab.HelperMethods.Qb(Gc.top);qa.zP.style.width=ab.HelperMethods.Qb(Gc.width);qa.zP.style.height=ab.HelperMethods.Qb(Gc.height);Gc=String.format("FormulaAssistancePreviewToolTip_{0}_{1}",
e.fua,e.fua);dialogControls.renderToolTip(qa.h$,Gc,e.nma,qa.zP,0,!1,!1,1)},this.Nc.ma,3)}}};Pc.prototype.h0e=function(e,C){var M=this.qb.text,qa=M.substring(e.start,e.end);qa=qa.trim();e=M.indexOf(qa,e.start);C=M.indexOf(C,e);qa=M.substring(e,C);qa=qa.trim();return this.qb.colors.getItem(e+"-"+(e+qa.length))};Pc.prototype.O_h=function(){var e=this;this.qb&&this.h$&&this.zP&&wf.TaskExtensions.Ba(this.Xzb,function(){e.qb.textBox.domElement.contains(e.h$)&&(dialogControls.clearToolTip(e.h$),e.qb.textBox.domElement.removeChild(e.h$),
e.h$=null);e.Nc.domElement.contains(e.zP)&&(e.Nc.domElement.removeChild(e.zP),e.zP=null)},this.Nc.ma,3)};Pc.prototype.Yvb=function(e,C,M){if(this.qb&&!(e>=C)){var qa={};this.qb.textBox.formatText(e,C-e,(qa.background=M||"#E3DDCC",qa));this.Zgd=!0}};Pc.prototype.zLf=function(){if(this.qb&&this.Z0a&&this.Zgd){var e=this.Z0a.fua;kd.EwaSettings.la(622)&&0<this.SRa.length&&this.SRa[this.SRa.length-1].end>e&&(e=this.SRa[this.SRa.length-1].end);var C={};this.qb.textBox.formatText(this.Z0a.cJa,e-this.Z0a.cJa,
(C.background=!1,C));this.Zgd=!1}};tl.Object.defineProperties(Pc.prototype,{Xzb:{configurable:!0,enumerable:!0,get:function(){var e=this;if(this.Lpa)return this.Lpa;var C=new Mc.a;this.Nc.rE(function(M){wf.TaskExtensions.Ba(M.trd(),function(){C.setResult(!0)},e.Nc.ma,3)});return this.Lpa=C.task}}});Object(sd.a)(Pc,"FormulaAssistanceContextualPreviewControl",null,[3]);var Nd=b(44),Ud=b(42);Xc.prototype.j_f=function(e,C,M){M?this.$0g(e,C,M):this.x2e(e,C,M,!0)};Xc.prototype.D9i=function(){this.k7=0};
Xc.prototype.$0g=function(e,C,M){var qa=this;this.k7++;var Na=this.k7;Nd.a.instance.create(function(){qa.x2e(e,C,M,Na===qa.k7)},500,Ud.a.oyh,!0,!0)};Xc.prototype.x2e=function(e,C,M,qa){var Na=this,Hb=this.Y$c.Nbd(e,C);Hb&&Hb.then(function(Gc){qa&&Na.Y$c.rmd(C)&&Na.Y$c.PIj(e,Gc,M)}).catch(function(Gc){Gc=Object(qc.a)(Error,Gc);"OperationCanceledException"===Gc.message?Dd.ULS.sendTraceTag(537162059,0,50,"GetContextualFormulaPreviewResults - caught exception: {0}",Gc):Dd.ULS.sendTraceTag(537162058,0,
10,"GetContextualFormulaPreviewResults - caught exception: {0}",Gc)})};Object(sd.a)(Xc,"FormulaAssistanceContextualPreviewHoverManager",null,[]);Hc.prototype.dispose=function(){this.fYc();ff.a.pc([this.Xsb,this.K8b]);this.L8b=this.K8b=this.Xsb=null;this.$&&Ye.g(this.$).Kc.Rp(this.l8a);this.Yga=this.qb=this.$=null};Hc.prototype.Mrj=function(e,C){C&&bh.e(C.text)&&!(C.Wva||C.textBox.Zu||this.qb&&this.qb.textBox.Zu)&&(this.qb=C,this.calcManager=this.$.da.Aa(266))&&(Dd.ULS.sendTraceTag(537162056,0,50,
"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnHover: Highlighting and partial evaluation initiated"),e=ab.HelperMethods.Etb(e),e=this.calcManager.nSh(Ye.g(this.$).ha.va.activeCell,this.qb.text,e.x,e.y),C=this.calcManager.getSubExpressionSpan(e),!C||C.end<=C.start||this.rmd(C)||(this.Yga=C,this.L8b.j_f(e,C,!0)))};Hc.prototype.bPd=function(e){if(e&&bh.e(e.text))if(e.textBox.Zu&&e.textBox.Zu.trim()){if(this.qb=e,this.calcManager=this.$.da.Aa(266)){Dd.ULS.sendTraceTag(537162054,
0,50,"FormulaAssistanceContextualPreviewManager.GetContextualPreviewResultsOnSelection: Highlighting and partial evaluation initiated");e={};var C=this.qb.textBox.Zu.trim();e.start=this.qb.text.indexOf(C,this.qb.textBox.caretPosition);e.end=e.start+C.length;(C=this.calcManager.getFormulaSubExpressionObject(Ye.g(this.$).ha.va.activeCell,this.qb.text,this.qb.textBox.Zu))&&!this.rmd(e)&&(this.Yga=e,this.L8b.j_f(C,e,!1))}}else this.W3a(!1,!0)};Hc.prototype.W3a=function(e,C){!this.qb||C&&this.qb.textBox.Zu||
(this.Yga=null,e&&(this.fYc(),this.K8b.uZ(),this.L8b.D9i()),this.Xsb&&this.Xsb.s5e(),this.qb.Wva||(this.qb.Wva=!1,this.qb=null))};Hc.prototype.Nbd=function(e,C){if(!this.qb||this.qb.Wva)return null;this.fYc();this.oqb=new Kc.a;return this.K8b.Nbd(e,this.qb.text,C,this.oqb.token)};Hc.prototype.PIj=function(e,C,M){this.oqb=null;!e||!C||!C.nma||0>=C.nma.length?this.W3a(!1,!1):(e=this.calcManager.oSh(Ye.g(this.$).ha.va.activeCell,e,this.qb.text),this.Xsb.QIj(this.qb,C,M,e))};Hc.prototype.rmd=function(e){return this.Yga?
e.start===this.Yga.start&&e.end===this.Yga.end&&e.pre===this.Yga.pre&&e.post===this.Yga.post:!1};Hc.prototype.fYc=function(){this.oqb&&this.oqb.C()};Object(sd.a)(Hc,"FormulaAssistanceContextualPreviewManager",null,[568,3,569]);var Oe=b(1189),of=b(929),Nf=b(245),Kf=b(153);Eb.prototype.DVf=function(e){this.xS=0;this.h6d=e.IsCompatibility;this.set_name(e.NameDataStrings);this.SUa=e.Help};Eb.prototype.tij=function(e){this.xS=1;this.set_name(e.Name)};Eb.prototype.Uhj=function(e){this.xS=2;this.set_name(e.name);
this.SUa=e.tooltip};Eb.prototype.tjj=function(e){this.xS=3;this.set_name(e.name);this.SUa=e.toolTip};Eb.prototype.aXf=function(e){this.xS=4;this.set_name(e.name)};Eb.prototype.Nlj=function(e){this.xS=5;this.set_name(e.name);this.SUa=e.toolTip};Eb.prototype.Mlj=function(e){this.xS=7;this.set_name(e.name)};Eb.prototype.ikj=function(){this.xS=6;this.set_name(fe.a.instance.Cb(182));this.SUa=fe.a.instance.Cb(183)};Eb.prototype.set_name=function(e){return this.D7d=e};Eb.t5g=function(){return Object.assign(new Eb,
{k7d:!0})};tl.Object.defineProperties(Eb.prototype,{itemType:{configurable:!0,enumerable:!0,get:function(){return this.xS}},b$h:{configurable:!0,enumerable:!0,get:function(){return this.h6d}},name:{configurable:!0,enumerable:!0,get:function(){return this.label}},label:{configurable:!0,enumerable:!0,get:function(){return this.D7d}},Hia:{configurable:!0,enumerable:!0,get:function(){return this.SUa}},Ayb:{configurable:!0,enumerable:!0,get:function(){return this.k7d}}});Object(sd.a)(Eb,"AutoCompleteItem",
null,[683]);Object(sd.a)(Kb,"DefinedNameInfo",null,[]);xb.prototype.vFj=function(e){var C=this.eEe[e.toUpperCase()];if(!C)return{returnValue:!1,sheetName:"",range:null};e=C.sheetName;C=this.ZYg(C.namedRange);return{returnValue:!0,sheetName:e,range:C}};xb.prototype.pZg=function(e){if(null!=e&&void 0!=e)return{top:e.top,left:e.left,bottom:e.bottom,right:e.right,maxRows:e.maxRows,maxColumns:e.maxColumns,sheetName:void 0}};xb.prototype.ZYg=function(e){if(null!=e&&void 0!=e)return new Gj.a(e.top,e.left,
e.bottom,e.right,e.maxRows,e.maxColumns)};xb.prototype.iZg=function(e){switch(e){case 2:return 0;case 3:return 1;default:return-1}};tl.Object.defineProperties(xb.prototype,{dEe:{configurable:!0,enumerable:!0,get:function(){var e=[];if(!this.$.xb||!this.$.xb.items)return e;for(var C=0,M=kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5951570_sendingNamedObjectsAutocompleteRequest")&&fg.a.hV(this.$),qa=yl(this.$.xb.items),Na=qa.next();!Na.done;Na=qa.next())if((Na=Na.value)&&(3===Na.type&&Na.usedRange||
M&&2===Na.type)){var Hb=new Kb;Hb.tooltip=Na.sheetName+Cd.a.exclamation+Na.usedRange.toString();Hb.name=Na.name;Hb.namedRange=this.pZg(Na.usedRange);Hb.sheetName=Na.sheetName;Hb.type=this.iZg(Na.type);Array.add(e,Hb);this.eEe[Na.name.toUpperCase()]=Hb;++C;if(C===Za.amf){Dd.ULS.sendTraceTag(537162076,0,15,"Maximum number of defined names reached for formula assistance: {0}",Za.amf);break}}return e}}});Object(sd.a)(xb,"DefinedNameInfoManager",null,[]);var zg=b(135),uh=Sys.EventArgs;vm(Ja,uh);Object(sd.a)(Ja,
"FormulaAssistanceFunctionChangedEventArgs",Sys.EventArgs,[]);var Jh=Sys.EventArgs;vm(Lb,Jh);Object(sd.a)(Lb,"FormulaAssistanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);var ci=Sys.EventArgs;vm(Ra,ci);Object(sd.a)(Ra,"FormulaAssitanceSelectedParameterChangedEventArgs",Sys.EventArgs,[]);var Gi=b(256);Sa.prototype.Qe=function(e,C){e=!1;C||(Ye.g(this.$).Jj.textBox.QJ=!0,e=this.formulaAssistanceUIControl.focus(this.gSe));return e};Sa.prototype.zh=function(e){var C=this.Jb;return!(void 0===C||
null===C)&&Le.DOMElementExtensions.Ye(C,e)};Sa.prototype.ji=function(){this.S2e&&this.S2e()};Sa.prototype.Vh=function(){};Sa.prototype.dispose=function(){Gi.a(this.$).XA(this)};tl.Object.defineProperties(Sa.prototype,{canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.TXc},set:function(e){this.TXc!==e&&(e?Gi.a(this.$).Tg(this):Gi.a(this.$).XA(this),this.TXc=e)}},Zd:{configurable:!0,enumerable:!0,get:function(){return this.cej}},Jb:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceUIControl.getRootElement(this.gSe)}}});
Object(sd.a)(Sa,"FormulaAssistanceFocusManager",null,[100,3]);var Wh=b(1047),bi=ah.a;vm(Fa,bi);Fa.prototype.lmb=function(e){this.addHandler("FunctionInfoLoaded",e)};Fa.prototype.Fqc=function(e){this.removeHandler("FunctionInfoLoaded",e)};Fa.prototype.tAg=function(e){this.addHandler("FunctionInfoReset",e)};Fa.prototype.G4i=function(e){this.removeHandler("FunctionInfoReset",e)};Fa.prototype.dispose=function(){var e=this.$.da.Aa(268);e&&e.KGd(this.huf);this.vb=null;bi.prototype.dispose.call(this)};Fa.prototype.nPf=
function(){this.raiseEvent("FunctionInfoReset")};Fa.prototype.jId=function(){this.nPf();this.UIc=!1;this.uS=null;this.SIc=!0};Fa.prototype.Jrb=function(e,C){var M=this;C=void 0===C?!1:C;if(this.I4)this.pHf();else{Dd.ULS.sendTraceTag(537161991,0,50,"Retrieving the list of function names for culture '{0}' from the server.",this.$.ya.UICultureTag);var qa=null;(qa=this.$.da.Aa(268))||Dd.ULS.sendTraceTag(537161990,0,50,"instantaneousSupportInformationManager == null");if((null===qa||void 0===qa?0:qa.Jia)&&
0<qa.Jia.length)kd.EwaSettings.la(121)?qa.Pxh(this.wuf):this.VEd(qa.Jia,!0,!1);else{var Na=this.$.qa.ta.Xb();e&&(this.$.fa.oc||C)&&!this.Tai&&(C?wg.a(this.$.userOperationManager,function(Hb,Gc,gd){return vf.w(M.$.qa.ta,e,lh.b(Hb,M.yuf),lh.a(Gc,M.xuf),gd,e,Na)},function(Hb){return new mg.a(130,0,Hb,16)},null):vf.w(this.$.qa.ta,e,this.yuf,this.xuf,null,e,Na));!this.I4&&this.$.fa.oc&&(qa?(Dd.ULS.sendTraceTag(537161989,0,50,"FunctionInfoManager.EnsureFunctionInfoAsync - Functions not loaded yet, wait for them. IsFullyLoaded={0}, IsSessionActive={1}",
this.I4,this.$.fa.oc),qa.Pke(this.huf)):(Dd.ULS.sendTraceTag(537161988,0,50,"FunctionInfoManager.EnsureFunctionInfoAsync - instantaneousSupportInformationManager is null"),vf.w(this.$.qa.ta,{FilterType:0},this.wuf,null,null,null,Na),this.SIc=!1))}}};Fa.prototype.LJh=function(e){return 0>e||e>=this.uS.length?null:this.uS[e]};Fa.prototype.Ncd=function(e){return Tg.a.Ec(this.Aad,e.toUpperCase())};Fa.prototype.RWe=function(e){return Tg.a.Ec(this.hJa,e)};Fa.prototype.hmd=function(e){return!e.GroupUI};
Fa.prototype.kuf=function(e,C,M){var qa=Ch.a(e);Dd.ULS.sendTraceTag(537161955,0,50,"FunctionInfoManager.OnFunctionListSuceeded: areNonStatusMessagesPresentInResult={0}",qa);qa?(Ye.g(this.$).endEdit(!1,"FunctionInfoManager.OnFunctionListSuceeded"),this.$.fa.Yo(e.Errors)):(this.VEd(e.Result,C,M),fg.a.bka()&&!fg.a.hV(this.$)&&this.bLj())};Fa.prototype.VEd=function(e,C,M){Dd.ULS.sendTraceTag(537161954,0,50,"FunctionInfoManager.RefreshFunctionList: functionsInfo count = {0}, isCategorized = {1}, partialResult = {2} IsFullyLoaded = {3}",
e.length,C,M,this.I4);this.I4||(this.uS=e,this.DLg(C),this.UIc=!M,this.pHf())};Fa.prototype.pHf=function(){this.raiseEvent("FunctionInfoLoaded")};Fa.prototype.bLj=function(){this.pluginScheduler.notifier().setFunctionsInfo(this.vad)};Fa.prototype.DLg=function(e){function C(Gf,xg){return Gf.NameUI.localeCompare(xg.NameUI)}var M=fe.a.instance.ea(998),qa=[];this.hJa={};this.k8=[];this.hJa[M]=qa;var Na=fe.a.instance.ea(999),Hb=[];Array.add(this.k8,M);Array.add(this.k8,Na);M=0;for(var Gc=this.uS.length;M<
Gc;M++){var gd=this.uS[M];gd.IsCompatibility||Array.add(Hb,gd);var Uc=gd.NameUI,Wd=gd.NameDataStrings;this.Aad[Wd.toUpperCase()]||(this.Aad[Wd.toUpperCase()]=gd);this.GSe[Uc.toUpperCase()]||(this.GSe[Uc.toUpperCase()]=gd);if(!this.hmd(gd)){if(e){Uc=gd.GroupUI;var We=Tg.a.Ec(this.hJa,Uc);We||(We=[],this.hJa[Uc]=We,Array.add(this.k8,Uc));Array.add(We,gd)}gd.IsCommonlyUsed&&Array.add(qa,gd);gd.IsCompatibility||Array.add(this.Fkg,Wd)}}this.hJa[Na]=Hb;e&&(Fa.QKf(qa,[2,3,0,5,4,9,1,7,8,6]),qa=Array(14),
qa[0]=0,qa[1]=1,qa[2]=7,qa[3]=11,qa[4]=5,qa[5]=2,qa[6]=6,qa[7]=10,qa[8]=9,qa[9]=3,qa[10]=4,qa[11]=13,qa[12]=12,qa[13]=8,Fa.QKf(this.k8,qa),qa=[],Array.addRange(qa,this.k8),Array.removeAt(qa,13),this.k8=qa);this.uS=Array.clone(this.uS);this.uS.sort(function(Gf,xg){return Gf.NameDataStrings.localeCompare(xg.NameDataStrings)});qa=1;for(Na=this.k8.length;qa<Na&&e;qa++)this.hJa[this.k8[qa]].sort(C);e=0;for(qa=this.uS.length;e<qa;e++)this.uS[e].FunctionIndex=e};Fa.QKf=function(e,C){for(var M=Array.clone(e),
qa=0;qa<M.length&&qa<C.length;qa++)e[qa]=M[C[qa]]};tl.Object.defineProperties(Fa.prototype,{I4:{configurable:!0,enumerable:!0,get:function(){return this.UIc}},Tai:{configurable:!0,enumerable:!0,get:function(){return this.SIc}},vad:{configurable:!0,enumerable:!0,get:function(){var e=this.uS,C=Wh.a(this.$);if(!C)return e;C=C.$Ih();var M=C.length;if(0>=M)return e;var qa=[];Array.addRange(qa,e);for(e=0;e<M;e++){var Na=C[e],Hb={};Hb.FunctionIndex=qa.length;Hb.HelpId=Hb.GroupUI=null;Hb.Help=Na.description;
Hb.IsCommonlyUsed=Hb.IsCompatibility=!1;Hb.NameDataStrings=Na.name;Hb.NameUI=Na.name;Hb.Params=null;Hb.ParamsHelp=null;Array.add(qa,Hb)}return qa}},vSe:{configurable:!0,enumerable:!0,get:function(){return this.k8}},$:{configurable:!0,enumerable:!0,get:function(){return this.vb}}});Object(sd.a)(Fa,"FunctionInfoManager",ah.a,[561,562,3]);var kh=b(1128),Eh=kh.a;vm(Yb,Eh);Yb.prototype.setVisible=function(e){Le.DOMElementExtensions.setVisible(this.domElement,e);e||(this.domElement.style.top="auto",this.domElement.style.left=
"auto")};Yb.prototype.isRtl=function(){return this.fj};Yb.prototype.hZe=function(){return this.domElement.parentNode};Yb.prototype.SQa=function(e){var C=this.domElement.style;C.cursor="move";C.position=e?"relative":"absolute"};Object(sd.a)(Yb,"FunctionParamBoxDraggableItem",kh.a,[]);Object(sd.a)(lb,"FormulaArgumentAssistanceCallbacks",null,[]);Object(sd.a)(sa,"FormulaArgumentAssistanceRenderingInfo",null,[]);Object(sd.a)(xa,"ArgumentAssistanceRequest",null,[]);var Bh=b(269);ta.prototype.Paa=function(){return this.Bt&&
!!this.render&&!!this.dismiss&&!!this.root&&!!this.cva};ta.prototype.NNa=function(e){this.cva.style.cursor="grabbing";this.Gxj=e.clientPoint.x;this.Hxj=e.clientPoint.y;this.Jwc=this.root.firstChild.getBoundingClientRect();this.placeholder=this.root.cloneNode(!0);this.placeholder.firstChild.style.animationDuration="0ms";this.root.parentElement.appendChild(this.placeholder);this.dismiss();return!0};ta.prototype.ola=function(e){var C=e.clientPoint.x-this.Gxj;e=e.clientPoint.y-this.Hxj;C=Math.min(Math.max(C,
this.ZAc-this.Jwc.left),window.innerWidth-this.Jwc.right-this.ZAc);e=Math.min(Math.max(e,this.ZAc-this.Jwc.top),window.innerHeight-this.Jwc.bottom-this.ZAc);this.placeholder.firstChild.style.transform="translate("+C+"px, "+e+"px)";return!0};ta.prototype.nla=function(){this.rt()};ta.prototype.lla=function(){this.rt()};ta.prototype.ja=function(e,C,M,qa){this.root=e;this.cva=C;this.render=M;this.dismiss=qa;this.detach();this.cva&&(this.cva.style.cursor="grab",Bh.a.instance.iW(this.cva,this),this.Bt=
!0)};ta.prototype.detach=function(){this.Bt&&(this.cva.style.cursor="",Bh.a.instance.iW(this.cva,this),this.Bt=!1);Le.DOMElementExtensions.Sf(this.placeholder)};ta.prototype.clear=function(){this.M8b.setOverrideTarget(void 0);this.detach()};ta.prototype.rt=function(){var e=this,C=this.placeholder.firstChild.getBoundingClientRect(),M=this.M8b.getDirectionalHint({top:C.top,left:C.left});this.cva.style.cursor="grab";this.M8b.setOverrideTarget({top:1===M?C.bottom:C.top,left:C.left});this.render();window.requestAnimationFrame(function(){window.requestAnimationFrame(function(){Le.DOMElementExtensions.Sf(e.placeholder)})})};
Object(sd.a)(ta,"FormulaAssistanceDragAdapter",null,[698]);var pi=ei.a;vm(Fb,pi);Fb.prototype.Qke=function(e){this.addHandler("FAFunctionNameUpdated",e)};Fb.prototype.vMf=function(e){this.removeHandler("FAFunctionNameUpdated",e)};Fb.prototype.Gle=function(e){this.addHandler("FAParameterSelectionChangedOld",e)};Fb.prototype.UMf=function(e){this.removeHandler("FAParameterSelectionChangedOld",e)};Fb.prototype.Fle=function(e){this.addHandler("FAParameterSelectionChanged",e)};Fb.prototype.TMf=function(e){this.removeHandler("FAParameterSelectionChanged",
e)};Fb.prototype.set_visible=function(e){this.Wm?e||this.Vqb():Sys.UI.Control.prototype.set_visible.call(this,e);return e};Fb.prototype.Vqb=function(){this.formulaAssistanceUIControl&&(this.Aq=null,this.xQ&&this.VM.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),this.Bka=null,this.Uq.canReceiveFocus=!1)};Fb.prototype.show=function(e){this.Wm||(ka.instance.Z6(["argumentAssistanceRender"]),this.B0a.setVisible(!!e),ka.instance.SY(["argumentAssistanceRender"]),this.ZUc&&(this.ZUc=!1,
ka.instance.e6b("argumentAssistanceOverall")))};Fb.prototype.S8i=function(){var e=this;if(!this.Maa||this.fRa){ka.instance.Z6(["argumentAssistanceComputation","argumentAssistanceOverall"]);var C=Ye.g(this.$).Jj;this.pluginScheduler.requester().argumentAssistance(Object.assign(new xa,{content:C.text,caretPosition:C.textBox.caretPosition})).then(function(M){M.kind?ka.instance.SY(["argumentAssistanceComputation"],!1):M.payload?(ka.instance.SY(["argumentAssistanceComputation"]),e.rrj(e.TBd(M.payload),
C.textBox.domElement)):e.Vqb();return null})}};Fb.prototype.update=function(e,C,M,qa){if(!this.Wm&&e){ka.instance.Z6(["argumentAssistanceComputation","argumentAssistanceOverall"]);this.ZUc=!0;var Na=this.$.listSeparator;try{var Hb=$get(Za.yad,this.Ui),Gc=$get(Za.rad,this.Ui);Hb.innerText="";Gc.innerText="";var gd=$get(Za.CSe,this.Ui),Uc=e.Params.split(Za.B8c);Hb=[];Gc=0;for(var Wd=gd.rows.length;Gc<Wd;Gc++){var We=gd.rows[Gc];Le.DOMElementExtensions.setVisible(We,Gc<Uc.length);var Gf=Uc[Gc],xg=Za.WOi+
Gc+"_",Hg=e.NameDataStrings;$get(xg+Za.MDb,We).innerText=Hg;$get(xg+Za.vAd,We).innerText=Hg;if(Gf){var Ig=Uc[Gc].split(Na),Hh=Fb.Gld(Ig[Ig.length-1]),jj=Fb.gdi(e);Hh&&(jj&&(2<Ig.length?(Ig[Ig.length-2]+="1",Ig[Ig.length-3]+="1"):Dd.ULS.sendTraceTag(537162073,0,50,"pair params formula should have at least 2 params. at UpdateParameterAssistance. formula '{0}', {1} params, currentParameterIndex = {3}.",Hg,Ig.length.toString(),C)),Fb.CFg(Ig,jj,C,e));Gf=Ig.join(Na.toString()+" ");Uc[Gc]=Gf;M<Ig.length?
(Hb[Gc]=Ig[M],Dd.ULS.shipAssertTag(537162072,0,!!Ig[M]&&1<=Ig[M].length,"Emphasized parameter is too short or empty selectedParameterIndex = {0}, currRowParamsArray.Length = {1}, formula name = {3}, current row = {4}",M,Ig.length,Hg,Gc),Ig[M]=String.format("{0}{1}{2}","<b>",Ig[M],"</b>"),Gf=Ig.join(Na.toString()+" ")):Dd.ULS.shipAssertTag(537162071,0,!1,"the current param index is larger than the param list count. selectedParameterIndex = "+M+"currRowParamsArray.Length = "+Ig.length+", current row = "+
Gc);qa&&Dd.ULS.sendTraceTag(558474578,0,50,"formula '{0}', {1} params, isElipsis = {2}, isPairsParamsFormula = {3}, currentParameterIndex = {4}",Hg,Ig.length,Hh,jj,C)}$get(xg+Za.wAd,We).innerHTML="("+(Gf||"")+")"}qa?this.raiseEvent("FAFunctionNameUpdated",new Ja(e.NameDataStrings,Uc)):this.raiseEvent("FAParameterSelectionChangedOld",new Ra(Uc,Hb,M));gd.className=of.a.Ykh+(this.functionInfoManager.hmd(e)?"-udf":"")}catch(Kj){throw Dd.ULS.shipAssertTag(558474577,0,!1,"UpdateParameterAssistance Exception. formula '{0}', {1} params. \nException: {4}",
e.NameDataStrings,C,Kj),Kj;}ka.instance.SY(["argumentAssistanceComputation"])}};Fb.prototype.dispose=function(){this.Wm||(this.wc.kA(),ff.a.Fa(this.wc),Ye.g(this.$).view.Wr(this.Ns),ff.a.Fa(this.B0a),this.B0a=null);this.Wm&&ff.a.Fa(this.Uq);this.Maa&&Ye.g(this.$).rc.Rp(this.Rh);this.functionInfoManager=this.$=null;pi.prototype.dispose.call(this)};Fb.prototype.TBd=function(e){var C=new sa;C.functionRenderingInfo=e;C.cardMode=this.o2;this.AFd(C);return C};Fb.prototype.AFd=function(e){e.callbacks=new lb;
e.callbacks.onHelpLink=this.Vcd(e.functionRenderingInfo);e.callbacks.onCardModeChange=this.onCardModeChange;e.callbacks.onFeedback=this.tQa;this.Maa&&(e.callbacks.onDismissClick=this.onDismissClick)};Fb.prototype.rrj=function(e,C){var M=this;if(this.formulaAssistanceUIControl){ka.instance.Z6(["argumentAssistanceRender"]);var qa={};qa.zoomLevel=E(this.$);this.formulaAssistanceUIControl.updateContext(qa);this.Aq=function(){M.formulaAssistanceUIControl.renderArgumentAssistanceCard(M.domElement,C,e)};
this.Aq();this.WAd(e);this.xQ&&this.VM.ja(this.formulaAssistanceUIControl.getCalloutElement(0),this.formulaAssistanceUIControl.getDraggableElement(0),this.Aq,function(){return M.formulaAssistanceUIControl.dismiss(M.domElement)});this.Uq.canReceiveFocus=!0;ka.instance.SY(["argumentAssistanceRender"]);ka.instance.e6b("argumentAssistanceOverall")}};Fb.prototype.Vcd=function(e){var C=this;return function(){Mb(C.$,e.helpID,e.isUDF)}};Fb.prototype.jMd=function(){var e=zg.a.get(If.a.dZb);this.o2=e?parseInt(e):
Fb.k4c;ka.instance.oUf(this.o2)};Fb.prototype.WAd=function(e){var C=e.functionRenderingInfo.functionName;this.Bka&&K.a.equals(this.Bka,C,!0)?(C=hi.a.map(e.functionRenderingInfo.signatures,function(M){var qa="";0<=M.signatureParams.activeParam&&M.signatureParams.activeParam<M.signatureParams.params.length&&(qa=M.signatureParams.params[M.signatureParams.activeParam]);return qa}),this.raiseEvent("FAParameterSelectionChanged",new Lb(C))):(this.Bka=C,e=hi.a.map(e.functionRenderingInfo.signatures,function(M){return M.signatureParams.params.join(", ")}),
this.raiseEvent("FAFunctionNameUpdated",new Ja(C,e)))};Fb.prototype.cMb=function(e){this.o2=e;try{zg.a.vw(If.a.dZb,e.toString(),wh.AFrame.Qda)}catch(C){Dd.ULS.sendTraceTag(537162070,0,15,"Failed setting ArgumentAssistanceCardCollapseState cookie with error message: {0}",C.message)}};Fb.Gld=function(e){return K.a.contains(e,Za.T5b,!0)};Fb.gdi=function(e){return!!e&&K.a.M0a(e.NameDataStrings,"IFS")};Fb.CFg=function(e,C,M,qa){try{if(!e||2>e.length)Dd.ULS.shipAssertTag(537162069,0,!1,"Requested not on elipsis function, formula '{0}', {1} params, isPairsParamsFormula = {2}, currentParameterIndex = {3}.",
qa.NameDataStrings,e?e.length.toString():"currRowParamsArray == null",C,M);else{for(var Na=e.pop().toString(),Hb=e.length-1;Hb<M;Hb++){var Gc=e[Hb].trim();if(C){var gd=e[Hb-1].trim();e.push(Fb.XAh(gd,Gc))}else{var Uc=Fb.h7e(Gc);e.push(Fb.jTe(Uc))}}e.push(Na)}}catch(Wd){throw Dd.ULS.shipAssertTag(537162068,0,!1,"AppendNewOptionalParameters Exception. formula '{0}', {1} params, isPairsParamsFormula = {2}, currentParameterIndex = {3}. \nException: {4}",qa.NameDataStrings,e?e.length.toString():"currRowParamsArray == null",
C,M,Wd),Wd;}};Fb.XAh=function(e,C){e=Fb.h7e(e);var M=Fb.gZe(e);C=Fb.gZe(C);return Fb.jTe(e,!0,!!M&&!!C&&M!==C)};Fb.h7e=function(e){var C=e.match(Fb.uwd);e=K.a.trimEnd(K.a.trimStart(e,Za.QBf),Za.PBf);if(C&&C.length){C=C[C.length-1];var M=Number.parseLocale(C)+1;e=e.replace(C,M.toString())}else e=String.format("{0}{1}",e,1);return e};Fb.jTe=function(e,C,M){var qa="[{0}]";(void 0===C?0:C)&&(qa=(void 0===M?0:M)?"[{0}":"{0}]");return String.format(qa,e)};Fb.gZe=function(e){return(e=e.match(Fb.uwd))&&e.length?
e[0]:null};Fb.lJa=function(e){if(e)return document.createElement("div");e=String.format(Za.yCf,Za.wCf,Za.vAd,of.a.JKe,Za.MDb,of.a.IKe,Za.wAd);var C=String.format(Za.yCf,Za.xCf,Za.vAd,of.a.JKe,Za.MDb,of.a.IKe,Za.wAd);e=String.format(Za.rzh,Za.szh,of.a.zLe,of.a.dih,pc.a.yu,Za.CSe,e,C);C=document.createElement("div");C.innerHTML=e;return C.firstChild};Fb.uwd=RegExp("\\d+");Fb.k4c=0;Object(sd.a)(Fb,"FormulaArgumentAssistanceControlDeprecated",ei.a,[682]);Object(sd.a)(Qb,"ParseContext",null,[]);var wi=
b(313),$i=Pk.a;vm(Gb,$i);Gb.prototype.ki=function(e,C){this.formulaAssistanceControl.qb=this.qb;-1470715894!==C&&-1231471547!==C||this.H4a&&!this.ZEe()||(this.lV=!1);return $i.prototype.ki.call(this,e,C)};Gb.prototype.Uwd=function(){var e=this.rwb;if(e||this.FOd){this.formulaAssistanceControl.qb=this.qb;if(this.H4a&&(ka.instance.znb.formulaAssistanceRequestAttemptedCounter++,!this.ZEe())){ka.instance.znb.formulaAssistanceRequestOptimizedCounter++;return}if(!e&&this.FOd)this.formulaAssistanceControl.zpe();
else if(kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutocompleteTableColumnHeaders",!1)&&this.Y1h){if(e=this.$.Ub.Fc("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),this.formulaAssistanceControl.Bpe(),e.stop(),this.tYa.text.endsWith("[")&&"["!==this.tYa.text.charAt(this.tYa.text.length-2)){var C=""===this.oHa?this.formulaAssistanceControl.tableManager.Ah:Object(qc.a)(wi.a,this.$.xb.getItemByName(this.oHa));Dd.ULS.sendTraceTag(575776010,0,50,"FormulaAutoCompleteListAutoCompleteBehavior.OnAutoCompleteTimerTick: AutoComplete List Box for Table Column Headers is shown after user types =[ inside a table with id {0} in {1} ms with cell edit regression time of {2} ms and popup visibility - {3}",
C.pj,e.Ac,this.Yid,this.lV)}}else this.formulaAssistanceControl.inb(),this.uBf&&(this.uBf=this.lV=!1)}else this.lV=!1};Gb.prototype.Mj=function(){this.R2i||(this.jRa=null,this.FOd&&this.formulaAssistanceControl.hZ())};Gb.prototype.Rh=function(){this.lV=!1;this.formulaAssistanceControl.set_visible(!1);this.formulaAssistanceControl.Frc();this.Wm&&this.Zmi()};Gb.prototype.jDd=function(e,C){return this.formulaAssistanceControl.ki(e,C)};Gb.prototype.Zmi=function(){this.formulaAssistanceControl.vcb&&(ka.instance.P8b.smartSuggestionShownCounter++,
this.formulaAssistanceControl.vcb=!1);this.formulaAssistanceControl.fKb&&(ka.instance.P8b.smartSuggestionSelectedCounter++,this.formulaAssistanceControl.fKb=!1);this.formulaAssistanceControl.eKb&&(ka.instance.P8b.smartSuggestionCommittedCounter++,this.formulaAssistanceControl.eKb=!1)};Gb.prototype.QQg=function(e,C){for(var M=0,qa;-1!==M;)if(M=e.indexOf("[",M+1),-1!==M&&M<C&&(qa=e.indexOf("]",M+1),-1===qa||qa>=C))return M;return-1};Gb.prototype.ZEe=function(){var e=this.qb.text,C=this.qb.textBox.caretPosition,
M=this.formulaAssistanceControl.wMa,qa=this.formulaAssistanceControl.vMa;if(this.lV&&K.a.equals(e,M,!0)&&C===qa)return!1;this.formulaAssistanceControl.wMa=e;this.formulaAssistanceControl.vMa=C;return!0};tl.Object.defineProperties(Gb.prototype,{pxb:{configurable:!0,enumerable:!0,get:function(){return Object(ig.a)(wb,this.$.Ab.qh)}},lV:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceControl.isListVisible},set:function(e){this.formulaAssistanceControl.isListVisible=e}},rwb:{configurable:!0,
enumerable:!0,get:function(){var e=this.tYa.text;e=0<e.length?e.charCodeAt(0):-1;return 61===e||43===e||45===e||64===e}},Y1h:{configurable:!0,enumerable:!0,get:function(){var e=this.tYa.text,C=!1;if(0>=e.length)return C;var M=this.$.Ub.Fc("LoadingUIShown","FormulaAutoCompleteListAutoCompleteBehavior"),qa=Ye.g(this.$).ha.va.activeCell.clone(),Na=e.charCodeAt(0);this.oHa="";this.NP=this.QQg(e,this.tYa.caretPosition);Na=61===Na&&-1!==this.NP;if(!kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing"))Na&&
(C=!0);else if(Na){if(kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){Na=0;for(var Hb=this.NP-1;1<=Hb&&!(this.NP-Hb>Gb.Xlf);Hb--)if(Array.contains(Gb.Are,e.charAt(Hb))){Na=Hb;break}Na=e.substring(Na+1,this.NP);e=""!==Na?this.$.xb.getItemByName(Na):null;Hb=this.NP;for(var Gc=this.NP+1;Gc<=this.qb.textBox.caretPosition;Gc++)if("["===this.qb.text.charAt(Gc))Hb=Gc;else break;this.NP=Hb}else{Na=e.lastIndexOf("[");Hb=0;for(Gc=Na-1;1<=Gc&&!(Na-Gc>Gb.Xlf);Gc--)if(Array.contains(Gb.Are,
e.charAt(Gc))){Hb=Gc;break}Na=e.substring(Hb+1,Na);e=""!==Na?this.$.xb.getItemByName(Na):null}e&&2===e.type?(C=!0,this.oHa=Na):Ye.g(this.$).Vb.vk(qa)&&(C=!0,this.oHa="")}M.stop();this.Yid=M.Ac;Dd.ULS.sendTraceTag(575776011,0,50,"FormulaAutoCompleteListAutoCompleteBehavior.InTableHeaderMode: Regression time in cell edit due to column header mode parsing is {0} milliseconds",this.Yid);return C}},key:{configurable:!0,enumerable:!0,get:function(){return lk.a.iua}},calcManager:{configurable:!0,enumerable:!0,
get:function(){this.RDc||(this.RDc=this.$.da.Aa(266,!1));return this.RDc}},FOd:{configurable:!0,enumerable:!0,get:function(){if(null!=this.jRa)return this.jRa;if(!kd.EwaSettings.la(135))return this.jRa=!1;var e=Ye.g(this.$).ha.va.activeCell.clone();if(1!==e.Elf||!e.left||Ye.g(this.$).ha.va.pfc())return!1;var C=this.formulaAssistanceControl.tableManager.wn(e);if(C)return this.jRa=!1;--e.left;--e.right;if(!e.isValidRange)return!1;C=this.formulaAssistanceControl.tableManager.wn(e);return this.jRa=!!C&&
e.top===C.top&&this.formulaAssistanceControl.tableManager.a_g(C,Ye.g(this.$))}}});Gb.Are=" !%&'()*+,-/:;<=>@[]^{|}~".split("");Gb.Xlf=255;Object(sd.a)(Gb,"FormulaAutoCompleteListAutoCompleteBehavior",Pk.a,[]);var Ui;(function(e){e[e.function=0]="function";e[e.field=1]="field";e[e.definedName=2]="definedName";e[e.letVariable=3]="letVariable";e[e.tableColHeaderName=4]="tableColHeaderName";e[e.tableSpecialStructRef=5]="tableSpecialStructRef";e[e.pendingData=6]="pendingData";e[e.tableNamedObject=7]="tableNamedObject"})(Ui||
(Ui={}));Object(sd.b)("ItemType",Ui);var gi=b(1191),ri=b(1190);hb.prototype.execute=function(e){Array.add(e,this.index)};Object(sd.a)(hb,"AppendIndexOperation",null,[709]);ya.prototype.execute=function(){};Object(sd.a)(ya,"NopIndexOperation",null,[709]);da.prototype.execute=function(e){for(var C=0;C<e.length;C++)e[C]===this.PTi&&(e[C]=this.dof)};Object(sd.a)(da,"ReplaceIndexOperation",null,[709]);Tb.prototype.DBe=function(e,C){var M=new hb(C);if(!fg.a.emd())return M;e=this.Ihi(e,C);return null!=e?
this.items[e].Ayb?new da(e,C):new ya:M};Tb.prototype.Ihi=function(e,C){var M=this,qa=this.items[C];Dd.ULS.shipAssertTag(537162075,0,!!qa,"Internal error: invalid item index");e=ha.where(ha.asEnumerable(e),function(Na){return M.items[Na].name===qa.name});return ha.Ct(e)?ha.first(e):null};Object(sd.a)(Tb,"FilterItemOperationFactory",null,[]);Object(sd.a)(Sb,"CompletionItem",null,[]);var Hi=gi.a;vm(Xa,Hi);Xa.prototype.Hle=function(e){this.addHandler("FLBSelectedRowChanged",e)};Xa.prototype.VMf=function(e){this.removeHandler("FLBSelectedRowChanged",
e)};Xa.prototype.pTc=function(e){this.addHandler("ACLBUpdated",e)};Xa.prototype.SGd=function(e){this.removeHandler("ACLBUpdated",e)};Xa.prototype.dispose=function(){Hi.prototype.dispose.call(this);this.Bqa=this.DSe=this.dtb=null};Xa.prototype.qxc=function(e,C,M,qa){qa=void 0===qa?0:qa;this.Zbf||this.e7(!1);var Na="";M&&(Na+=String.format("<table aria-live='off' id='{0}'><tr><td class='{1}'>{2}</td></tr></table>","list_column_header",of.a.AVg,M));Na+=String.format("<table class='{0}' aria-live='off'><tbody>",
this.rba);for(var Hb=new lc.a,Gc=0,gd=this.YV.length;Gc<gd;Gc++)Na+=this.o0e(e[this.YV[Gc]],Gc+1,C,qa),this.Wm&&Hb.add(this.iVe(e[this.YV[Gc]]));Gc=this.YV.length;gd=0;for(var Uc=this.Kr.length;gd<Uc;gd++)Array.contains(this.YV,this.Kr[gd])||(Gc++,Na+=this.o0e(e[this.Kr[gd]],Gc,C,qa),this.Wm&&Hb.add(this.iVe(e[this.Kr[gd]])));this.dg.innerHTML=Na+"</tbody></table>";this.An=Le.DOMElementExtensions.vj(this.domElement,this.rba);this.Wm&&(this.l0c=Hb.toArray());this.Zbf?(this.isListVisible=!0,this.JFa.set_visible(!0)):
(this.e7(!0),this.CDg(!!M))};Xa.prototype.NIa=function(e,C,M,qa,Na,Hb){qa=void 0===qa?"":qa;Na=void 0===Na?0:Na;Hb=void 0===Hb?!1:Hb;if(e){var Gc=[],gd=[];this.dKb=0;var Uc=new Tb(this.$,e);if(C){var Wd=!!C&&0<Na,We=Wd&&91===C.charCodeAt(Na+1)?Na+2:Na+1;Hb=Wd?C.length===We:!1;Wd&&C.length===Na&&kd.EwaSettings.la(135)&&(Hb=!0);var Gf=null;!Hb&&Wd&&C.length>Na+1&&(Gf=C.substring(We,C.length));if(C)for(Wd=0,We=e.length;Wd<We;Wd++){var xg=e[Wd].name;if(!e[Wd].b$h){var Hg=Uc.DBe(Gc,Wd);e[Wd].Ayb&&this.dKb++;
(Gf||Hb)&&e[Wd].itemType||(gd=this.bQe(C,xg,M,Hg,Gc,gd),Gc=gd.p7e,gd=gd.CEf);Gf&&1===e[Wd].itemType&&(gd=this.bQe(Gf,xg,!0,Hg,Gc,gd),Gc=gd.p7e,gd=gd.CEf);Hb&&1===e[Wd].itemType&&Hg.execute(Gc)}}}else for(M=0;M<e.length;++M)if(e[M].Ayb||Hb)Gf=Uc.DBe(Gc,M),Gf.execute(Gc),Gf.execute(gd),e[M].Ayb&&this.dKb++;this.YV=gd;this.Kr=Gc;this.qxc(e,C,qa,Na)}};Xa.prototype.fKj=function(e){if(e&&!(1<e.length)){var C=[],M=[];C.push(0);M.push(0);this.YV=C;this.Kr=M;this.qxc(e,"","",0)}};Xa.prototype.qxa=function(){this.Nk&&
Hi.prototype.qxa.call(this)};Xa.prototype.gXi=function(e,C){this.raiseEvent("ACLBUpdated",new ri.a(e,void 0,void 0,C))};Xa.prototype.S$f=function(e){var C=this.An.rows[e];return(!this.Nk||this.Nk!==C)&&e<this.An.rows.length?(this.Nk=C,!0):!1};Xa.prototype.Glc=function(e){ch.g(e.Ea);this.rw&&2!==this.rw&&3!==this.rw&&4!==this.rw&&5!==this.rw&&7!==this.rw?1===this.rw?this.JFa.wy(!1):(this.JFa.wy(!1),e=Ye.g(this.$),e.Dq(!1),e.focus()):(this.raiseEvent(Wj.a.m3a),this.qxa());return!0};Xa.prototype.CDg=
function(e){this.hra();if(e){var C=this.An.offsetWidth+(this.Kr.length>this.xH?yc.a.Sp:0);e=$get("list_column_header");e.offsetWidth>C&&Le.DOMElementExtensions.Gq(this.dg,e.offsetWidth);C=this.dg.getElementsByClassName(this.RZ);for(var M=0;M<C.length;M++)C[M].style.width=ab.HelperMethods.Qb(e.offsetWidth)}};Xa.prototype.o0e=function(e,C,M,qa){if(1===e.itemType){var Na=dh.a.If(e.name),Hb=dh.a.If(qa?M.substring(qa+1,M.length):M),Gc=0;Na.substring(0,Hb.length).toLowerCase()!==Hb.toLowerCase()&&(Gc=Xa.mxj(Na,
Za.Ccg,Hb));M="";M=0<=Gc?M+(Na.substring(0,Gc)+"<b>"+Na.substring(Gc,Gc+Hb.length)+"</b>"+Na.substring(Gc+Hb.length,Na.length)):M+Na;qa=qa?String.format("<td>\r\n\t<div class='clip16x16'>\r\n\t\t<img class='{0}' src='{1}' alt='{2}'/>\r\n\t</div>\r\n</td>",pc.a.dMe,dh.a.$U(vh.a.Be(0)),fe.a.instance.ea(696)):"";return String.format("<tr>\r\n\t{0}\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='description_cell{1}' class='ewa-hidden'></td>\r\n\t<td id='item_type_cell' class='ewa-hidden'>{2}</td>\r\n</tr>",
qa,C,Ui[e.itemType],this.RZ,M)}if(5===e.itemType)return String.format("<tr>\r\n\t<td><b>{0}</b></td>\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='description_cell{1}' class='ewa-hidden'>{5}</td>\r\n\t<td id='item_type_cell' class='ewa-hidden'>{2}</td>\r\n</tr>","",C,Ui[e.itemType],this.RZ,dh.a.If(e.name),dh.a.If(e.Hia));if(4===e.itemType)return String.format("<tr>\r\n\t<td><b>{0}</b></td>\r\n\t<td id='name_cell{1}' class='{3}'>{4}</td>\r\n\t<td id='description_cell{1}' class='ewa-hidden'>{5}</td>\r\n\t<td id='item_type_cell' class='ewa-hidden'>{2}</td>\r\n</tr>",
"(...)",C,Ui[e.itemType],this.RZ,dh.a.If(e.name));if(6===e.itemType)return qa=qa?String.format("<td>\r\n\t<div class='clip16x16'>\r\n\t\t<img class='{0}' src='{1}' alt='{2}'/>\r\n\t</div>\r\n</td>",pc.a.dMe,dh.a.$U(vh.a.Be(0)),fe.a.instance.ea(696)):"",String.format("<tr>\r\n\t{0}\r\n\t<td id='name_cell{4}' class='{1}'>{2}</td>\r\n\t<td id='description_cell{4}' class='ewa-hidden'>{3}</td>\r\n\t<td id='item_type_cell' class='ewa-hidden'>{5}</td>\r\n</tr>",qa,this.RZ,dh.a.If(e.name),dh.a.If(e.Hia),
C,Ui[e.itemType]);qa=String.format("<td>\r\n\t<div class='clip16x16'>\r\n\t\t<img class='{0}' src='{1}' alt='{2}'/>\r\n\t</div>\r\n</td>",2===e.itemType||3===e.itemType?pc.a.Mnh:pc.a.Knh,dh.a.$U(vh.a.Be(0)),fe.a.instance.ea(693));return String.format("<tr>\r\n\t{0}\r\n\t<td id='name_cell{4}' class='{1}'>{2}</td>\r\n\t<td id='description_cell{4}' class='ewa-hidden'>{3}</td>\r\n\t<td id='item_type_cell' class='ewa-hidden'>{5}</td>\r\n</tr>",qa,this.RZ,dh.a.If(e.name),dh.a.If(e.Hia),C,Ui[e.itemType])};
Xa.prototype.iVe=function(e){var C=new Sb;C.label=e.label;C.textEdit=e.textEdit;C.kind=Xa.EFh(e.itemType);C.type=e.Ayb?1:0;if(kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5607789_FunctionShortDescriptions")&&3===C.kind){var M=this.formulaAssistanceControl.MJh(e.label);C.detail=M?M:e.Hia}else C.detail=e.Hia;return C};Xa.prototype.bQe=function(e,C,M,qa,Na,Hb){K.a.equals(C,"Pretend this is the line.",!1)&&0<Na.length||K.a.eI(C,e)?(qa.execute(Na),qa.execute(Hb)):M&&e.length>=Za.d_g&&Xa.K9g(C,Za.Ccg,
e)?qa.execute(Na):!M&&e.length>=Za.c_g&&K.a.contains(C,e,!0)&&qa.execute(Na);return{p7e:Na,CEf:Hb}};Xa.EFh=function(e){switch(e){case 0:return 3;case 2:return 100;case 1:case 6:return 103;case 3:return 102;case 4:return 101;case 5:return 107;case 7:return 106;default:return 3}};Xa.K9g=function(e,C,M){C=yl(C);for(var qa=C.next();!qa.done;qa=C.next())if(qa=e.split(qa.value),!(2>qa.length)){qa=yl(qa);for(var Na=qa.next();!Na.done;Na=qa.next())if(K.a.eI(Na.value,M))return!0}return!1};Xa.mxj=function(e,
C,M){C=yl(C);for(var qa=C.next();!qa.done;qa=C.next())if(qa=e.toLowerCase().indexOf((qa.value+M).toLowerCase()),0<qa)return qa+1;return-1};tl.Object.defineProperties(Xa.prototype,{vod:{configurable:!0,enumerable:!0,get:function(){return 0<this.dKb&&this.dKb===this.Kr.length}},isListVisible:{configurable:!0,enumerable:!0,get:function(){return Object(tj.a)(Xa.prototype,this,"isListVisible")},set:function(e){Object(tj.b)(Xa.prototype,this,"isListVisible",e);e||(this.dtc=0,this.oe=null);this.dtc?Le.DOMElementExtensions.setVisible(this.dtb,
!1):Le.DOMElementExtensions.setVisible(this.dtb,e&&!this.Wm)}},Nk:{configurable:!0,enumerable:!0,get:function(){return this.Bqa},set:function(e){this.GAa(this.Nk);if(e){this.DSe.innerText="";this.Bqa=e;var C=this.GAa(this.Nk),M=e.rowIndex+1,qa=$get("description_cell"+M,e);this.dtb.innerText=qa.innerText;var Na=$get("item_type_cell",e);this.oe=C=C.innerText;this.dtc="field"===Na.innerText?1:"definedName"===Na.innerText?2:"letVariable"===Na.innerText?3:"tableColHeaderName"===Na.innerText?4:"tableSpecialStructRef"===
Na.innerText?5:"pendingData"===Na.innerText?6:"tableNamedObject"===Na.innerText?7:0;this.raiseEvent("FLBSelectedRowChanged",new ri.a(this.Kr.length,M,C,qa.innerText));this.Lsc(e)}}},nSa:{configurable:!0,enumerable:!0,get:function(){return this.dtb}},JFa:{configurable:!0,enumerable:!0,get:function(){return this.formulaAssistanceControl}},rw:{configurable:!0,enumerable:!0,get:function(){return this.dtc}}});Object(sd.a)(Xa,"FormulaAutoCompleteListBox",gi.a,[681]);tl.Object.defineProperties(Cb.prototype,
{name:{configurable:!0,enumerable:!0,get:function(){return this._name}},toolTip:{configurable:!0,enumerable:!0,get:function(){return this.Y8}}});Object(sd.a)(Cb,"LETVariableInfo",null,[]);tl.Object.defineProperties(ob.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}}});Object(sd.a)(ob,"TableColHeaderNameInfo",null,[]);tl.Object.defineProperties(Ma.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}}});Object(sd.a)(Ma,"TableNamedObjectInfo",
null,[]);tl.Object.defineProperties(Ia.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return this._name}},toolTip:{configurable:!0,enumerable:!0,get:function(){return this.Y8}}});Object(sd.a)(Ia,"TableSpecialStructRefInfo",null,[]);var Ii=b(186),Yh=b(176);Object(sd.a)(pa,"FormulaAutoCompleteCallbacks",null,[]);Object(sd.a)(ma,"FormulaAutoCompleteRenderingInfo",null,[]);Object(sd.a)(wa,"CellMessage",null,[]);Object(sd.a)(Z,"FunctionSuggestionRequest",null,[]);Object(sd.a)(na,"RunExperimentRequest",
null,[]);var si=Oe.a;vm(Y,si);Y.prototype.Oke=function(e){this.addHandler(Y.gad,e)};Y.prototype.uMf=function(e){this.removeHandler(Y.gad,e)};Y.prototype.Mke=function(e){this.addHandler(Y.F$c,e)};Y.prototype.sMf=function(e){this.removeHandler(Y.F$c,e)};Y.prototype.Nke=function(e){this.addHandler("FormulaAutoCompleteShown",e)};Y.prototype.tMf=function(e){this.removeHandler("FormulaAutoCompleteShown",e)};Y.prototype.set_visible=function(e){this.Dia.set_visible(e);this.Wm&&!e&&this.q0a();Sys.UI.Control.prototype.set_visible.call(this,
e);return e};Y.prototype.XPg=function(e,C){this.isListVisible&&(e+=Za.openParen,C++,this.AAd(e,C));var M=0<C&&e.charAt(C-1)===Za.openParen,qa=C===e.length||e.charAt(C)===Za.closeParen;if(!M||!qa)return Dd.ULS.sendTraceTag(537162053,0,50,"FormulaAssistanceControl.CanInsertFormulaArguments Caret position: {0} is invalid. Is cell empty: {1}. Function exists in cell: {2}",C,!e.length,!!this.MP),!1;M=e.substring(0,C).lastIndexOf(this.$.listSeparator);qa=e.substring(0,C-1).lastIndexOf(Za.openParen);e=e.substring(-1===
M&&-1===qa?1:Math.max(M,qa)+1,C-1).trim();return this.functionInfoManager.Ncd(e)?!0:(Dd.ULS.sendTraceTag(537162052,0,50,"FormulaAssistanceControl.CanInsertFormulaArguments No valid function name before caret. Function exists in cell: {0}",!!this.MP),!1)};Y.prototype.l6h=function(e,C){var M=this.XPg(e,C);if(!M||!this.MP)return Dd.ULS.shipAssertTag(537162051,0,!M||M&&!!this.MP,"FormulaAssistanceControl.InsertFormulaArgumentsFromCaretPosition currentFunctionInfo is null"),{returnValue:null,$nf:0,WQe:0};
M=this.MP.Params;M=M.replace(RegExp("[\\[\\]]","g"),"");var qa=e.charAt(C-1)===Za.openParen,Na=qa?"":"(",Hb=C===e.length?")":"";var Gc=this.$.listSeparator;Gc=M.includes(Gc)?M.indexOf(Gc):M.length;return{returnValue:e.substring(0,C)+Na+M+Hb+e.substring(C,e.length),$nf:qa?C:C+1,WQe:Gc}};Y.prototype.Ns=function(e,C){this.Wm&&void 0!==this.Aq&&null!==this.Aq&&this.Aq();this.Wm||si.prototype.Ns.call(this,e,C)};Y.prototype.dispose=function(){if(this.$){this.QRa(!1);var e=Ye.g(this.$);e&&(e.ha&&(this.Wm?
e.ha.mF(this.kd):e.ha.Nca(this.kd),kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5680723_UseActiveCellChangedSync")&&e.ha.aza(this.Kwd)),e.view.Wr(this.xlc));this.Wm&&this.$.xa&&this.$.xa.rg(this.Yh)}this.functionInfoManager&&(this.functionInfoManager.Fqc(this.onFunctionInfoLoaded),this.functionInfoManager.G4i(this.juf));this.wi&&this.wi.Eqc(this.Oxa);this.Wm&&this.Rf&&this.Rf.VMf(this.azf);this.n3f(!1);ff.a.Fa(this.Rf);ff.a.Fa(this.nZb);ff.a.Fa(this.Dia);this.Vja&&ff.a.Fa(this.Uq);this.qb=this.functionInfoManager=
this.wi=null;ff.a.pc(this.aJa);this.Ah=this.N7=this.Dia=this.aJa=null;si.prototype.dispose.call(this)};Y.prototype.JLa=function(){return!this.Cv};Y.prototype.Wbi=function(){return!this.KFa};Y.prototype.ki=function(e,C){if(!this.JLa()){if(this.Wm&&this.DM){if(125627505===C||267796030===C)return this.Naa&&this.nzc(C),this.cye(),!1;if(1872288872===C)return this.Hca(),this.isListVisible=!1,!0;if(this.Rf.vod&&(-798660877===C||137938150===C))return!1}if(1!==this.Rf.rw||125627505!==C&&267796030!==C)if(6===
this.Rf.rw){var M=e.keyCode;13!==M&&9!==M||this.wy(!1)}else{if(4===this.Rf.rw||5===this.Rf.rw)return si.prototype.ki.call(this,e,C,!0);1===this.Rf.YV.length&&(M=e.keyCode,this.Tte=8===M||127===M||46===M?!0:!1)}else{if(this.wy(!1)&&!this.Hja)return Ye.g(this.$).ha.ki(e,C);if(125627505===C&&this.Hja)return!0}}return si.prototype.ki.call(this,e,C)};Y.prototype.Frc=function(){this.wi.sab();this.N7=null;null==this.qia||this.qia||this.iic("NoFieldChosen",1,2,1);this.qia=null;this.o3=0;this.c5=this.xpd=
this.Fnc=null};Y.prototype.inb=function(){var e=this,C=!!this.qb&&!ih.f(this.$.oa);if((this.hAa||this.qwc)&&C){var M=this.qb.text;this.pluginScheduler.requester().functionSuggestion(Object.assign(new Z,{content:M})).then(function(qa){qa.kind||(Dd.ULS.shipAssertTag(537162050,0,!!qa&&!!qa.payload.items,"FormulaAssistanceControl.AssistFormula - x10Scheduler returned `null` suggestion"),qa=ha.toArray(ha.select(ha.asEnumerable(qa.payload.items),function(Na){return Y.WYg(Na)})),e.qwc&&"="===M&&0<qa.length&&
e.gridView.D0a.wjj("="+qa[0].textEdit.newText),e.hAa&&(e.BRa=qa,hd.AFrameworkApplication.Gg||e.Ape(C,!0)));return null})}this.hAa&&C||this.Ape(C,!1)};Y.prototype.m0e=function(){if(kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")){var e=Ye.g(this.$).xj?this.Ysb.NP:this.Dob.NP;"@"===this.qb.text.charAt(e+1)&&this.qb.textBox.caretPosition>e+1?this.Pcb=e+2:this.Pcb=e+1}else{e=this.qb.text.lastIndexOf(Za.fhf);var C=this.qb.text.lastIndexOf("[");this.Pcb=
e+1>=C?e+2:C+1}return this.qb.text.substring(this.Pcb,this.qb.textBox.caretPosition)};Y.prototype.Bpe=function(){this.s0f()&&(this.K5g(),this.Cv&&(this.qia=!1,this.sV=this.m0e(),this.Rf.NIa(this.Cv,this.sV,!0,void 0,void 0,!0),this.show(),kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5516893_fixInTableHeaderModeAccordingToCaretPoisiton")&&this.Dia.Vqb()))};Y.prototype.zpe=function(){this.s0f()&&(this.nZb&&this.nZb.cancel(),this.wi.zxb?(this.JLa()&&this.tAe(!0),this.get_visible()?this.XPe():this.b_d=
Ii.AsyncMethodContext.Ky(this.XPe,Za.f9g,Ud.a.pyh,this.nZb)):this.hZ())};Y.prototype.s0f=function(){return this.qb?0<this.$.Ab.eR||!this.qb.text||!this.qb.isEditing?(this.set_visible(!1),!1):ih.f(this.$.oa)?!1:!0:!1};Y.prototype.f_a=function(e){this.qb&&this.isListVisible&&(this.bkd(this.qb.text,e),this.qb.textBox.caretPosition=e.range.start.character+e.newText.length,this.set_visible(!1))};Y.prototype.wy=function(){var e;if(!this.qb||!this.isListVisible)return!1;var C="",M=0,qa=Ye.g(this.$),Na=this.qb.text,
Hb=0,Gc=this.Rf.oe,gd=!1;if(this.Rf.rw&&2!==this.Rf.rw&&3!==this.Rf.rw&&7!==this.Rf.rw)if(1===this.Rf.rw)if(this.qia=!0,this.Hja){C+=Na.substr(0,this.o3+2);!C.toString().endsWith(Cd.a.kU)&&kd.EwaSettings.la(135)&&(C+=Cd.a.kU);Hb=this.Rf.oe;Hb=Hb.replace("'","''");Hb=Hb.replace("[","'[");Hb=Hb.replace("]","']");if(this.v4c||this.Oth(Hb))Hb=Cd.a.eki+Hb+Cd.a.Taj,gd=!0;C+=Hb;M=C.length;Hb=3;Yh.a("PulloutFieldAccepted")}else return this.qb.text=this.Rf.oe,this.set_visible(!1),qa.Dq(!1),qa.focus(),this.iic("FieldName",
1,1,1),Yh.a("TableHeaderAutoCompleteSuggestionAccepted"),!0;else if(5===this.Rf.rw)Dd.ULS.sendTraceTag(537162048,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableSpecialStructRef listbox item"),C+=Na.substr(0,this.Pcb),K.a.equals(this.Rf.oe,"@ - "+this.instantaneousSupportInformationManager.He.ThisRowStructRefString,!1)?C+="@":(C+=this.Rf.oe,gd=!0,this.set_visible(!1)),M=C.length;else if(4===this.Rf.rw){Dd.ULS.sendTraceTag(575776009,0,50,"FormulaAssistanceControl.Autocomplete: User selected TableColHeaderName listbox item}");
C+=Na.substr(0,this.Pcb);gd="";M=!1;for(var Uc=[39,91,93,64,35],Wd=0;Wd<this.Rf.oe.length;Wd++){var We=this.Rf.oe.charCodeAt(Wd);Array.contains(Uc,We)&&(gd+="'");gd+=this.Rf.oe.charAt(Wd).toString();M||K.a.isNumeral(We)||K.a.ubf(We)||(M=!0)}Uc=Ye.g(this.$).xj?this.Ysb.NP:this.Dob.NP;Na=kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?"@"===Na.charAt(Uc+1)&&M:Na.lastIndexOf(Za.fhf)+1>=Na.lastIndexOf("[")&&M;C+=Na?"["+gd+"]":gd;gd=!0;this.set_visible(!1);
M=C.toString().length}else if(6===this.Rf.rw)C+=Na.substr(0,this.hrb);else return Dd.ULS.sendTraceTag(537162019,0,10,"Autocomplete item type was not set on AutoComplete ListBox"),!1;else C+=Na.substr(0,this.Z1a)+this.Rf.oe,this.Rf.rw||this.Rf.oe.endsWith(")")||(C+="("),M=C.toString().length,C+=Na.substr(this.W8b),2===this.Rf.rw&&(Hb=4,Gc="DefinedName",gd=!0,this.set_visible(!1));this.qb.text=C;this.qb.textBox.caretPosition=M;this.qb.fMa()&&(null===(e=qa.hx)||void 0===e?0:e.eua)&&qa.hx.WHb(this.qb.text,
this.qb.textBox.caretPosition,this.qb.textBox.caretPosition,this.qb.textBox.Zu.length);qa.xj&&(e=qa.Kc,e.text=this.qb.text,e.setCaretPosition(this.qb.textBox.caretPosition));Gc=(null==this.qia?0:this.qia)?"FieldName":Gc;this.Rf.Nk.sectionRowIndex>=this.Rf.YV.length?this.iic(Gc,4,Hb,0):this.iic(Gc,1,Hb,0);gd||(5===this.Rf.rw||4===this.Rf.rw?this.Bpe():this.inb());return!0};Y.prototype.hZ=function(e,C){e=void 0===e?null:e;C=void 0===C?null:C;e?(this.wi.sab(),this.wi.hZ(e,!1,!1,C)):(e=Ye.g(this.$),e.ha.va.Dh&&
(e=jg.v(e.ha.va.Qd,this.$),this.wi.hZ(e,!0,!0,C)))};Y.prototype.Hca=function(){this.bfa=!1;this.qb.CFe()};Y.prototype.MJh=function(e){e=this.calcManager.getWorksheetFuncId(e);return this.HSe?this.HSe.descriptionsMap.get(e):null};Y.prototype.tAe=function(e){if(this.Wbi()){if(this.wi.zxb&&this.wi.Tk&&(!this.wi.Tk.length||!this.wi.Tk[0].FieldInfoDataList))return;this.jIj(e)}e=ha.asEnumerable(this.KFa);e=ha.concat(e,this.HLh(this.qb.text));kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5501880_NamedObjectAutoCompleteDropdown")&&
this.Wm&&(e=ha.concat(e,this.PMh()));ha.OBc(e,function(C){return C.name},new zf);this.hAa&&(e=ha.concat(ha.asEnumerable(this.BRa),e),kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5592322_fixSmartAutoCompleteItemsBugs")&&(0<this.BRa.length&&(this.vcb=!0),this.BRa=[]));this.N7=ha.toArray(e)};Y.prototype.K5g=function(){var e=this.qb.text;if(kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5402572_CrossSheetTableReferencing")){var C=Ye.g(this.$).xj?this.Ysb.oHa:this.Dob.oHa,M=!0;if(kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5962126_tableColHeadersListJSCrashFix")){if(""!==
C&&(this.Ah=Object(qc.a)(wi.a,this.$.xb.getItemByName(C))),this.Ah||(this.Ah=this.tableManager.Ah,M=!1),!this.Ah){Dd.ULS.sendTraceTag(527234895,0,50,"FormulaAssistanceControl.createTableColHeaderAutoCompleteList - current table object is null. Total number of named objects in workbook: %d. Is target table name empty? %d",this.$.xb.count,""===C);return}}else this.Ah=Object(qc.a)(wi.a,this.$.xb.getItemByName(C)),this.Ah||(this.Ah=this.tableManager.Ah,M=!1);this.Ah.r0&&this.Ah.r0.IsFullTableHeaders?
this.aEf(M):Kf.d(this.Ah)?(Dd.ULS.sendTraceTag(537162017,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Getting column headers for table with xluid - %s",this.Ah.pj),vf.H(this.$.qa.ta,this.Ah.pj,this.NEi,this.MEi,null,null)):Dd.ULS.sendTraceTag(537162018,0,15,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList - Table with xluid %s has header rows turned off.",this.Ah.pj)}else if(this.calcManager&&this.tableManager.Ah)if(C=this.calcManager.Rub(this.tableManager.Ah))if(this.calcManager.oEg(this.tableManager.Ah,
C)){e=ha.empty();if(91===this.qb.text.charCodeAt(this.qb.text.length-1)){var qa=this.D_a("@ - "+this.instantaneousSupportInformationManager.He.ThisRowStructRefString);e=ha.concat(e,(M=new lc.a,M.add(qa),M))}e=ha.concat(e,ha.select(ha.asEnumerable(C.toArray()),function(Na){var Hb=new Eb,Gc=new ob;Gc._name=Na.toString();Hb.aXf(Gc);return Hb}));this.N7=ha.toArray(e)}else e.endsWith("[")&&"["!==e.charAt(e.length-2)&&Dd.ULS.sendTraceTag(572381130,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns partial table header data with {0} columns for a table with id {1} of size {2}",
C.count,this.tableManager.Ah.pj,this.tableManager.Ah.usedRange.right-this.tableManager.Ah.usedRange.left+1);else e.endsWith("[")&&"["!==e.charAt(e.length-2)&&Dd.ULS.sendTraceTag(573149408,0,50,"FormulaAssistanceControl.CreateTableColHeaderAutoCompleteList: calcManager.GetTableHeaders returns null inside a table during table column header autocomplete list creation")};Y.prototype.Oth=function(e){if(!e)return!1;var C=e.charCodeAt(0);if(46===C||48<=C&&57>=C||63===C)return!0;for(var M=0;M<e.length;M++,
C=e.charCodeAt(M))if(!((kd.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?K.a.isLetter(C):K.a.Imd(C))||92===C||95===C||63===C||48<=C&&57>=C))return!0;return!1};Y.prototype.AAd=function(e,C){var M=!1,qa=!1,Na=!1,Hb=0,Gc=0;this.Z1a=0;this.W8b=C;this.z3b=1;for(var gd=C-1;0<=gd;--gd)switch(e.charCodeAt(gd)){case 39:qa=!qa;break;case 34:M=!M;break;case 91:++Hb;Na=Hb>Gc;break;case 93:++Gc}Na=Object.assign(new Qb,{csa:!M,dsa:!qa,pha:!Na,NDb:1});
Hb=this.rPi(e,C,Na);C=this.sPi(e,C,Na.csa,Na.dsa,Na.pha);this.z3b=Hb+C;if(this.xOc=Hb-1)this.nvc=!1;this.Buh(e,M,qa,Na.cAd,Na.dAd)};Y.prototype.Njd=function(){kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5680723_UseActiveCellChangedSync")?Ye.g(this.$).ha.bra(this.Kwd):Ye.g(this.$).ha.fG(this.Kwd);this.pBb();Y.FJd(this.pluginScheduler);this.hAa&&this.tSg()};Y.prototype.$sh=function(){return this.hAa||this.dPe};Y.prototype.tPi=function(){var e=this.c5;if(!this.Fpj||!e)return this.o3=0,this.KFa=this.N7=
null,!1;e=e.endsWith(Cd.a.kU);var C;if(C=kd.EwaSettings.la(135)){C=this.LFj(this.c5.substring(0,this.p3));var M=C.sheetRange;C=C.returnValue}return C&&(C=this.c5.substring(0,this.o3),e&&C!==this.xpd)?(this.xpd=C,this.o3=this.c5.length-(e?1:0),this.hZ(M,this.c5),this.qia=!1,Dd.ULS.sendTraceTag(537162015,0,50,"Begin dot notation autocomplete"),!0):!1};Y.prototype.HLh=function(e){var C=new lc.a;this.calcManager&&kd.EwaSettings.isChangeGateEnabled("OfficeVSO:4986015_LetAutocompleteTelemetry")&&Dd.ULS.shipAssertTag(537162014,
0,!!this.calcManager.rsa(Ug.Range.ld(1,1)),"FormulaAssistanceControl.GetLetVariables() - ConvertToSheetGridCell() is null");if(this.calcManager&&this.dPe&&(e=this.calcManager.extractLetVariables(e,this.qb.textBox.caretPosition))){e=yl(e);for(var M=e.next();!M.done;M=e.next()){var qa=M.value;M=new Cb;M._name=qa;M.Y8=fe.a.instance.ea(2145);qa=new Eb;qa.tjj(M);C.add(qa)}}return C};Y.prototype.PMh=function(){for(var e=new lc.a,C=this.$.xb.items,M=0,qa=C.length;M<qa;M++){var Na=C[M];if(ih.o(Na)){var Hb=
new Ma;Hb._name=Na.name;Na=new Eb;Na.Mlj(Hb);e.add(Na)}}return e};Y.prototype.D_a=function(e){var C=new Eb,M=new Ia;M._name=e;C.Nlj(M);return C};Y.prototype.aEf=function(e){var C=new lc.a,M=this.qb.text.charCodeAt(this.qb.text.length-1),qa=this.qb.textBox.caretPosition-1;if(kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?91===this.qb.text.charCodeAt(qa):91===M){var Na=this.D_a("@ - "+this.instantaneousSupportInformationManager.He.ThisRowStructRefString);
C.add(Na)}Na=yl(this.Ah.r0.HeadersList);for(var Hb=Na.next();!Hb.done;Hb=Na.next()){Hb=Hb.value;var Gc=new Eb,gd=new ob;gd._name=Hb.Name;Gc.aXf(gd);C.add(Gc)}Na=Ye.g(this.$).xj?this.Ysb.NP:this.Dob.NP;Hb=this.qb.text.charCodeAt(Na+1);(kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5611403_TableHeaderDropdownListWithCaretPosition")?!e||qa!==Na&&35!==Hb:!e||91!==M&&35!==M)||(e=this.D_a("#"+this.instantaneousSupportInformationManager.He.AllStructRefString),C.add(e),e=this.D_a("#"+this.instantaneousSupportInformationManager.He.DataStructRefString),
C.add(e),e=this.D_a("#"+this.instantaneousSupportInformationManager.He.HeadersStructRefString),C.add(e),e=this.D_a("#"+this.instantaneousSupportInformationManager.He.TotalsStructRefString),C.add(e));C&&(this.N7=C.toArray())};Y.prototype.jIj=function(e){var C=ha.empty();!e&&this.functionInfoManager.I4&&(C=ha.concat(C,ha.select(ha.asEnumerable(this.functionInfoManager.vad),function(M){var qa=new Eb;qa.DVf(M);return qa})),e=this.j4b.dEe,0<e.length&&(C=ha.OBc(ha.concat(C,ha.select(ha.asEnumerable(e),
function(M){var qa=new Eb;qa.Uhj(M);return qa})),function(M){return M.name},new zf)));if(this.wi.zxb&&this.wi.Tk){if(!this.wi.Tk.length||!this.wi.Tk[0].FieldInfoDataList)return;C=ha.OBc(ha.concat(C,ha.select(ha.asEnumerable(this.wi.Tk[0].FieldInfoDataList),function(M){var qa=new Eb;qa.tij(M);return qa})),function(M){return M.name},new zf);this.columnName=this.wi.Tk[0].ColumnName}this.KFa=ha.toArray(C)};Y.prototype.pBb=function(){var e=Ye.g(this.$).ha.va.activeCell;if(e){var C=this.calcManager.rsa(e);
if(C){var M=this.$.xa,qa=C.sheet.index;0>=M.count||0>qa||qa>=M.count||(qa=M=null,this.Yvd&&void 0!==this.calcManager&&null!==this.calcManager&&(e=Ye.g(this.$).Ca.Mr(e))&&(e=this.calcManager.Idd(e.Gm),void 0!==e&&null!==e&&(M=e.FormatString,qa=e.Builtin)),this.pluginScheduler.notifier().setActiveCell(Object.assign(new wa,{colIndex:C.range.col,rowIndex:C.range.row,sheetIndex:this.$.xa.getItem(C.sheet.index).sheetId,docName:C.sheet.document.name,docPath:C.sheet.document.path,formatString:M,builtIn:qa})))}}};
Y.prototype.tSg=function(){Ye.g(this.$).xj?this.Ysb.OT(!1):this.Dob.OT(!1)};Y.prototype.Qef=function(e){var C=kd.EwaSettings.isChangeGateEnabled("OfficeVSO:4831363_UseUpdatedisLetterCharacterCodeRangesInStringExtensions")?K.a.isLetter(e):K.a.Imd(e);return 48<=e&&57>=e||46===e||95===e||C};Y.prototype.show=function(){if(this.Cv){var e=this.Rf.S$f(0);this.Wm?0<this.Rf.Kr.length?e||this.f0f():this.q0a():((e=0<this.Rf.Kr.length)&&ka.instance.Z6(["autoCompleteRender"]),!this.isListVisible&&this.columnName&&
e&&this.Rf.gXi(this.Rf.Kr.length,this.columnName),this.isListVisible=e,this.Dia.show(this.MP),this.XAa(!0),this.Rf.qxa(),e&&ka.instance.SY(["autoCompleteRender"]))}};Y.prototype.sPi=function(e,C,M,qa,Na){for(M=Object.assign(new Qb,{GBf:41,Zwe:40,csa:M,dsa:qa,pha:Na});C<e.length&&!this.CCf(e,C,M);++C);return M.NDb};Y.prototype.rPi=function(e,C,M){for(--C;0<=C&&!this.CCf(e,C,M);--C);return M.NDb};Y.prototype.CCf=function(e,C,M){var qa=e.charCodeAt(C);0>=this.p3&&(this.p3=e.substring(0,C).lastIndexOf(Cd.a.kU));
46===qa&&(C<this.p3?this.p3=C:C>this.hrb&&(this.o3=this.hrb=C));if(!this.Qef(qa)&&!Y.chi(qa)&&(!this.Hja||C<=this.p3||!Y.A1h(qa,M))){M.Asf&&(M.Asf=!1,this.Z1a=C+1);if(M.Myd){M.dAd=C+1;if(this.functionInfoManager.Ncd(e.substring(M.dAd,M.cAd)))return!0;M.Myd=!1}switch(qa){case 39:M.dsa=!M.dsa;break;case 34:M.csa=!M.csa;break;case 91:M.pha=!1;break;case 93:M.pha=!0}qa===this.$.listSeparator.toString().charCodeAt(0)&&M.dsa&&M.csa&&!M.PZa&&(!this.Hja||M.pha)&&(C<M.uKd||-1===M.uKd)&&(M.NDb+=1,this.z3b++);
qa===M.Zwe&&M.csa&&M.dsa&&(!this.Hja||M.pha)?M.PZa+=1:qa===M.GBf&&M.csa&&M.dsa&&(!this.Hja||M.pha)?0<M.PZa?--M.PZa:(M.uKd=M.VQe,M.VQe=C,0<C&&this.Qef(e.charCodeAt(C-1))&&(M.Myd=!0,M.cAd=C)):this.Hja&&46===qa&&C>this.p3&&(C<this.p3?this.p3=C:C>this.hrb&&(this.o3=this.hrb=C))}return!1};Y.prototype.Buh=function(e,C,M,qa,Na){this.W8b>this.Z1a&&0<=this.Z1a?C||M||(this.sV=e.substring(this.Z1a,this.W8b)):this.sV=null;qa!==Na?(e=e.substring(Na,qa),this.MP&&K.a.equals(this.MP.NameDataStrings,e,!0)||(this.nvc=
!0),this.MP=this.functionInfoManager.Ncd(e)):(this.nvc=!1,this.MP=null)};Y.prototype.n3f=function(e){var C=$get(Za.wCf+"_"+Za.MDb,this.domElement),M=$get(Za.xCf+"_"+Za.MDb,this.domElement);e&&!this.Zbc?(C&&Mg.a.instance.pa(Ve.a.click,C,this.Qba),M&&Mg.a.instance.pa(Ve.a.click,M,this.Qba),this.Zbc=!0):this.Zbc&&(C&&Mg.a.instance.za(Ve.a.click,C,this.Qba),M&&Mg.a.instance.za(Ve.a.click,M,this.Qba),this.Zbc=!1)};Y.prototype.LFj=function(e){var C=this;var M=null;var qa;if(function(){var gd=jg.Z(e,C.$.fa.xa);
Hb=gd.sheetName;qa=gd.range;return gd}().returnValue&&qa){if(!Hb){var Na=Object(qc.a)(ji.a,this.$.oa);if(!Na)return{returnValue:!1,sheetRange:M};var Hb=Na.name}M=jg.v(qa,this.$);M.SheetName=Hb;this.v4c=!1;return{returnValue:!0,sheetRange:M}}var Gc=null;return function(){var gd=C.j4b.vFj(e);Hb=gd.sheetName;Gc=gd.range;return gd}().returnValue?(M=jg.v(Gc,this.$),M.SheetName=Hb,this.v4c=!0,{returnValue:!0,sheetRange:M}):{returnValue:!1,sheetRange:M}};Y.prototype.Wcc=function(){if(1===this.Rf.YV.length&&
this.Cv.length){var e=this.Cv[this.Rf.YV[0]];if(1===e.itemType){var C=e.name;e=this.qb.text;C=C.substring(e.length,C.length);C.length&&(this.qb.text=e+C,this.qb.textBox.selectRange(e.length,this.qb.text.length))}}else Dd.ULS.shipAssertTag(537162007,0,!1,"InCellAutoComplete should only be called when there is 1 item (number of items: {0})",this.Rf.YV.length)};Y.prototype.iic=function(e,C,M,qa){var Na={};Na.a=e;Na.b=C;Na.c=M;Na.d=qa;pd.b().Ne(38,Na,!0)};Y.prototype.Ape=function(e,C){if(!this.functionInfoManager.I4){if(e)if(this.AAd(this.qb.text,
this.qb.textBox.caretPosition),this.hAa||this.sV){var M={};M.Filter=this.sV?this.sV.charAt(0).toString():"";M.FilterType=1;M.IncludeOneOfEachGroupUI=!1;this.functionInfoManager.Jrb(M)}else kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AutocompleteTableColumnHeaders",!1)&&this.get_visible()&&this.set_visible(!1);if(!C)return}0<this.$.Ab.eR||this.qb&&!this.qb.isEditing?this.set_visible(!1):e&&(this.AAd(this.qb.text,this.qb.textBox.caretPosition),this.Dia.update(this.MP,this.z3b,this.xOc,
this.nvc),this.c5=this.qb.text.substring(1,this.qb.textBox.caretPosition),this.p3=this.c5.indexOf(Cd.a.kU),this.o3=this.c5.lastIndexOf(Cd.a.kU),this.tPi()?(e=new Eb,e.ikj(),this.KFa=this.N7=e=[e],this.Rf.fKj(e),this.show()):((this.$sh()||this.JLa())&&this.tAe(!1),0<this.o3?this.Rf.NIa(this.Cv,this.c5,!1,void 0,this.c5.lastIndexOf(Cd.a.kU),!1):this.Rf.NIa(this.Cv,this.sV,!1,void 0,this.o3,!1),this.show(),this.Wm&&(this.Rf.Kr.length||Ye.g(this.$).Jj.zK?this.Dia.Vqb():(this.Dia.S8i(),this.Wm&&this.q0a()))))};
Y.prototype.f0f=function(){var e=this;if(0<this.Rf.Kr.length){ka.instance.Z6(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){var C={};C.zoomLevel=E(this.$);this.formulaAssistanceUIControl.updateContext(C);this.Aq=function(){e.formulaAssistanceUIControl.renderAutoCompleteMenu(e.domElement,Ye.g(e.$).Jj.textBox.domElement,e.Kcd())};this.Aq();this.ALa&&this.Rf.vod&&this.raiseEvent(Y.gad,null);!this.zLa||this.Ekd||this.Rf.vod||this.raiseEvent("FormulaAutoCompleteShown");this.Vja&&(this.Uq.canReceiveFocus=
!0);this.Ekd=!0}ka.instance.SY(["autoCompleteRender"]);!kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5592322_fixSmartAutoCompleteItemsBugs")&&void 0!==this.BRa&&null!==this.BRa&&0<this.BRa.length&&(this.vcb=!0)}};Y.prototype.Krd=function(){this.KHa&&(ka.instance.q2.selectByArrowKeyCounter++,this.KHa=!1);this.LHa&&(ka.instance.q2.selectByMouseHoverCounter++,this.LHa=!1);this.JHa&&(ka.instance.q2.commitByTabKeyCounter++,this.JHa=!1);this.HHa&&(ka.instance.q2.commitByEnterKeyCounter++,this.HHa=!1);
this.IHa&&(ka.instance.q2.commitByMouseClickCounter++,this.IHa=!1)};Y.prototype.Kcd=function(){var e=new ma;e.completionItems=this.Rf.l0c;e.activeItemIndex=this.Rf.Nk?this.Rf.Nk.rowIndex:-1;this.yFd(e);return e};Y.prototype.yFd=function(e){e.callbacks=new pa;e.callbacks.onCompletionItemSelected=this.vxd;e.callbacks.onCompletionItemCommitted=this.uxd;e.callbacks.onFeedback=this.tQa;kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5818634_PassOnDismissCallbackToAutoCompleteMenu")&&(e.callbacks.onDismiss=
this.tld?this.onDismiss:this.q0a)};Y.prototype.jCd=function(e){this.bfa=!0;var C=e.textEdit.newText;this.qb.jcb(C.substring(this.qb.text.length-e.textEdit.range.start.character,C.length))};Y.prototype.cye=function(){this.wy(!0);this.bfa=this.isListVisible=!1;this.eKb=!0};Y.prototype.bkd=function(e,C){this.qb.text=e.substring(0,C.range.start.character)+C.newText+e.substring(C.range.end.character,e.length);Ye.g(this.$).xj&&(Ye.g(this.$).Kc.text=this.qb.text)};Y.FJd=function(e){e.requester().runExperiment(new na)};
Y.WYg=function(e){var C=Eb.t5g(),M={IsCompatibility:!1};M.NameDataStrings=e.label;M.Help=e.detail;C.DVf(M);C.textEdit=e.textEdit;return C};Y.lJa=function(){var e=String.format(Za.tzh,Za.yad,fk.a.NKe),C=String.format(Za.ozh,Za.wad,of.a.MKe,pc.a.Ir,pc.a.yu),M=String.format(Za.lzh,Za.rad,of.a.MKe,pc.a.Ir,of.a.zLe,pc.a.yu);return String.format("{0}\r\n{1}\r\n{2}",e,C,M)};Y.chi=function(e){return 36===e||58===e||33===e||39===e||32===e};Y.A1h=function(e,C){return 32===e||91===e||!C.pha};tl.Object.defineProperties(Y.prototype,
{mt:{configurable:!0,enumerable:!0,get:function(){return this.Rf}},Cv:{configurable:!0,enumerable:!0,get:function(){return this.N7}},OHb:{configurable:!0,enumerable:!0,get:function(){return this.Rf.oe}},zSe:{configurable:!0,enumerable:!0,get:function(){return this.Rf}},fSe:{configurable:!0,enumerable:!0,get:function(){return this.Dia}},Rf:{configurable:!0,enumerable:!0,get:function(){return this.Akg}},qqb:{configurable:!0,enumerable:!0,get:function(){return this.hAa?this.qb?this.qb.text:null:this.sV}},
isListVisible:{configurable:!0,enumerable:!0,get:function(){return this.mt.isListVisible},set:function(e){this.Wm&&!e&&this.q0a();this.mt.isListVisible=e}},tableManager:{configurable:!0,enumerable:!0,get:function(){return this.Csg}},Hja:{configurable:!0,enumerable:!0,get:function(){return 0<this.o3}},DM:{configurable:!0,enumerable:!0,get:function(){return this.bfa}},nZb:{configurable:!0,enumerable:!0,get:function(){return this.b_d}},o3:{configurable:!0,enumerable:!0,get:function(){return this.uGe},
set:function(e){this.uGe=e;e||(this.p3=0)}},Fpj:{configurable:!0,enumerable:!0,get:function(){if(null==this.Fnc){var e=this.$.lc;this.Fnc=!!e&&!e.inEmbedView}return this.Fnc}},eTf:{configurable:!0,enumerable:!0,get:function(){return this.Rf.l0c[this.Rf.Nk.rowIndex]}},HSe:{configurable:!0,enumerable:!0,get:function(){!this.zad&&this.pluginScheduler&&(this.zad=this.pluginScheduler.getFunctionsShortDescriptions());return this.zad}}});Y.gad="FACardOpened";Y.F$c="FAFocusOnSmartSuggestionsCard";Y.hid=null;
Object(sd.a)(Y,"FormulaAssistanceControl",Oe.a,[564,565,3,566,567]);var Uh=ei.a;vm(S,Uh);S.prototype.Qke=function(e){this.addHandler("FAFunctionNameUpdated",e)};S.prototype.vMf=function(e){this.removeHandler("FAFunctionNameUpdated",e)};S.prototype.Gle=function(e){this.addHandler("FAParameterSelectionChangedOld",e)};S.prototype.UMf=function(e){this.removeHandler("FAParameterSelectionChangedOld",e)};S.prototype.Fle=function(e){this.addHandler("FAParameterSelectionChanged",e)};S.prototype.TMf=function(e){this.removeHandler("FAParameterSelectionChanged",
e)};S.prototype.Xzg=function(e){this.addHandler("DC",e)};S.prototype.o4i=function(e){this.removeHandler("DC",e)};S.prototype.get_visible=function(){return this.visible};S.prototype.set_visible=function(e){e||this.dismiss();return this.visible=e};S.prototype.dismiss=function(){this.visible=!1;this.formulaAssistanceUIControl&&(this.Aq=null,this.xQ&&this.VM.detach(),this.formulaAssistanceUIControl.dismiss(this.domElement),this.Bka=null,this.Uq.canReceiveFocus=!1)};S.prototype.show=function(e,C){var M=
this;this.visible=!0;this.NSc();var qa=this.TBd(e);this.formulaAssistanceUIControl&&(ka.instance.Z6(["argumentAssistanceRender"]),e={},e.zoomLevel=E(this.$),this.formulaAssistanceUIControl.updateContext(e),kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5470368_FormulaAssistanceScroll")?(this.Aq=function(){M.formulaAssistanceUIControl.renderArgumentAssistanceCard(M.domElement,C,qa)},this.Aq()):this.formulaAssistanceUIControl.renderArgumentAssistanceCard(this.domElement,C,qa),this.WAd(qa),this.xQ&&this.VM.ja(this.formulaAssistanceUIControl.getCalloutElement(0),
this.formulaAssistanceUIControl.getDraggableElement(0),this.Aq,function(){return M.formulaAssistanceUIControl.dismiss(M.domElement)}),this.Uq.canReceiveFocus=!0,ka.instance.SY(["argumentAssistanceRender"]),ka.instance.e6b("argumentAssistanceOverall"))};S.prototype.dispose=function(){if(this.$){var e=Ye.g(this.$);e&&(e.ha&&e.ha.mF(this.kd),e.view.Wr(this.Ns),this.xQ&&e.rc.Rp(this.Rh))}ff.a.Fa(this.Uq);this.$=null};S.prototype.NSc=function(){Ye.g(this.$).Jj.fNb.add(this)};S.prototype.TBd=function(e){var C=
new sa;C.functionRenderingInfo=e;C.cardMode=this.o2;this.AFd(C);return C};S.prototype.AFd=function(e){e.callbacks=new lb;e.callbacks.onHelpLink=this.Vcd(e.functionRenderingInfo);e.callbacks.onCardModeChange=this.onCardModeChange;e.callbacks.onFeedback=this.tQa;this.Maa&&(e.callbacks.onDismissClick=this.onDismissClick)};S.prototype.Vcd=function(e){var C=this;return function(){Mb(C.$,e.helpID,e.isUDF)}};S.prototype.jMd=function(){var e=zg.a.get(If.a.dZb);this.o2=e?parseInt(e):S.k4c;ka.instance.oUf(this.o2)};
S.prototype.WAd=function(e){var C=e.functionRenderingInfo.functionName;this.Bka&&K.a.equals(this.Bka,C,!0)?(C=hi.a.map(e.functionRenderingInfo.signatures,function(M){var qa="";0<=M.signatureParams.activeParam&&M.signatureParams.activeParam<M.signatureParams.params.length&&(qa=M.signatureParams.params[M.signatureParams.activeParam]);return qa}),this.raiseEvent("FAParameterSelectionChanged",new Lb(C))):(this.Bka=C,e=hi.a.map(e.functionRenderingInfo.signatures,function(M){return M.signatureParams.params.join(", ")}),
this.raiseEvent("FAFunctionNameUpdated",new Ja(C,e)))};S.prototype.cMb=function(e){this.o2=e;try{zg.a.vw(If.a.dZb,e.toString(),wh.AFrame.Qda)}catch(C){Dd.ULS.sendTraceTag(537162074,0,15,"Failed setting ArgumentAssistanceCardCollapseState cookie with error message: {0}",C.message)}};S.lJa=function(){return document.createElement("div")};S.k4c=0;Object(sd.a)(S,"FormulaArgumentAssistanceControl",ei.a,[682]);var nh;(function(e){e[e.Dismissed=0]="Dismissed";e[e.Smart=1]="Smart";e[e.Simple=2]="Simple";
e[e.Mixed=3]="Mixed"})(nh||(nh={}));Object(sd.b)("UIState",nh);var dj=ei.a;vm(ca,dj);ca.prototype.Oke=function(e){this.addHandler("FACardOpened",e)};ca.prototype.uMf=function(e){this.removeHandler("FACardOpened",e)};ca.prototype.Mke=function(e){this.addHandler("FAFocusOnSmartSuggestionsCard",e)};ca.prototype.sMf=function(e){this.removeHandler("FAFocusOnSmartSuggestionsCard",e)};ca.prototype.Nke=function(e){this.addHandler("FormulaAutoCompleteShown",e)};ca.prototype.tMf=function(e){this.removeHandler("FormulaAutoCompleteShown",
e)};ca.prototype.dispose=function(){if(this.$){var e=Ye.g(this.$);e&&(e.ha&&e.ha.mF(this.kd),e.view.Wr(this.Ns));this.$.xa&&this.$.xa.rg(this.Yh)}this.Vja&&ff.a.Fa(this.Uq);this.$=null};ca.prototype.Jzg=function(e){this.addHandler("CVIC",e)};ca.prototype.a4i=function(e){this.removeHandler("CVIC",e)};ca.prototype.get_visible=function(){return this.visible};ca.prototype.set_visible=function(e){e||this.dismiss();return this.visible=e};ca.prototype.ki=function(e,C){if(!this.get_visible())return!1;this.Naa&&
this.nzc(C);if(this.DM){if(125627505===C||this.Jld&&267796030===C)return this.f_a(this.Cv.items[this.a0].textEdit),!this.Jld;if(1872288872===C)return this.Hca(),this.set_visible(!1),!0;if(!this.Jld&&267796030===C)this.Hca();else if(this.jNi&&(-798660877===C||137938150===C))return!1}e=!1;switch(C){case 1872288872:this.set_visible(!1);e=!0;break;case -798660877:this.$db(this.Kub(this.a0+1));e=!0;break;case 137938150:this.$db(this.Kub(this.a0-1));e=!0;break;case 2091832999:this.$db(this.Kub(this.a0+
8));e=!0;break;case 742457698:this.$db(this.Kub(this.a0-8));e=!0;break;case 125627505:this.f_a(this.Cv.items[this.a0].textEdit);e=!0;break;case 267796030:kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnterAutoCompletesSimpleSuggestions",!1)&&(this.f_a(this.Cv.items[this.a0].textEdit),e=!0)}return e};ca.prototype.show=function(e){this.qb=Ye.g(this.$).Jj;this.visible=!0;this.NSc();this.a0=0;this.Cv=e;0<this.Cv.items.length&&(this.render(),this.$db(this.Kub(this.a0)),1===this.Cv.items[0].type&&
this.dmd&&(this.vcb=!0))};ca.prototype.Hca=function(){this.bfa=!1;this.qb.CFe()};ca.prototype.render=function(){var e=this;ka.instance.Z6(["autoCompleteRender"]);if(this.formulaAssistanceUIControl){var C={};C.zoomLevel=E(this.$);this.formulaAssistanceUIControl.updateContext(C);this.Aq=function(){e.formulaAssistanceUIControl.renderAutoCompleteMenu(e.domElement,e.qb.textBox.domElement,e.Kcd())};this.Aq();this.zLa&&(C=this.TLb,this.TLb=this.ITh(this.Cv.items),C!==nh.Dismissed&&C!==nh.Smart||this.TLb!==
nh.Simple&&this.TLb!==nh.Mixed||this.raiseEvent("FormulaAutoCompleteShown"));this.Vja&&(this.Uq.canReceiveFocus=!0);ka.instance.SY(["autoCompleteRender"]);ka.instance.e6b("autoCompleteOverall")}};ca.prototype.NSc=function(){this.qb.fNb.add(this)};ca.prototype.f_a=function(e){this.qb&&this.get_visible()&&(this.bkd(this.qb.text,e),this.qb.textBox.caretPosition=e.range.start.character+e.newText.length,this.DM&&(this.bfa=!1,this.dmd&&(this.eKb=!0),this.qb.endEdit(!0,"FormulaAutoCompleteControl.CommitAutoCompletion",
0)),this.set_visible(!1),this.raiseEvent("CVIC"))};ca.prototype.Kcd=function(){var e=new ma;e.completionItems=this.Cv.items;e.activeItemIndex=this.a0;this.yFd(e);return e};ca.prototype.yFd=function(e){e.callbacks=new pa;e.callbacks.onCompletionItemSelected=this.vxd;e.callbacks.onCompletionItemCommitted=this.uxd;e.callbacks.onFeedback=this.tQa;kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5818634_PassOnDismissCallbackToAutoCompleteMenu")&&(e.callbacks.onDismiss=this.tld?this.PBi:this.dismiss)};ca.prototype.jCd=
function(e){this.bfa=!0;var C=e.textEdit.newText;this.qb.jcb(C.substring(this.qb.text.length-e.textEdit.range.start.character,C.length))};ca.prototype.$db=function(e){var C=this.a0;this.a0=e;var M=this.Cv.items[e];this.DM&&this.Hca();C!==e&&this.render();1===M.type&&kd.EwaSettings.ggc()&&!Ye.g(this.$).Jj.text.includes("\n")&&(this.jCd(M),this.dmd&&(this.fKb=!0))};ca.prototype.Kub=function(e){return 0>e?0:Math.min(e,this.Cv.items.length-1)};ca.prototype.bkd=function(e,C){this.qb.text=e.substring(0,
C.range.start.character)+C.newText+e.substring(C.range.end.character,e.length);Ye.g(this.$).xj&&(Ye.g(this.$).Kc.text=this.qb.text)};ca.prototype.Krd=function(){this.KHa&&(ka.instance.q2.selectByArrowKeyCounter++,this.KHa=!1);this.LHa&&(ka.instance.q2.selectByMouseHoverCounter++,this.LHa=!1);this.JHa&&(ka.instance.q2.commitByTabKeyCounter++,this.JHa=!1);this.HHa&&(ka.instance.q2.commitByEnterKeyCounter++,this.HHa=!1);this.IHa&&(ka.instance.q2.commitByMouseClickCounter++,this.IHa=!1)};ca.prototype.nzc=
function(e){switch(e){case -798660877:case 137938150:case 2091832999:case 742457698:this.KHa=!0;break;case 125627505:this.JHa=!0;break;case 267796030:kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnterAutoCompletesSimpleSuggestions",!1)&&(this.HHa=!0)}};ca.lJa=function(){return document.createElement("div")};ca.prototype.ITh=function(e){return e.reduce(function(C,M){return C|=0===M.type?nh.Simple:nh.Smart},nh.Dismissed)};tl.Object.defineProperties(ca.prototype,{DM:{configurable:!0,
enumerable:!0,get:function(){return this.bfa}},jNi:{configurable:!0,enumerable:!0,get:function(){return 1===this.Cv.items.length&&1===this.Cv.items[0].type}}});Object(sd.a)(ca,"FormulaAutoCompleteControl",ei.a,[684,3,566]);ba.prototype.then=function(e,C){return this.promise.then(e,C)};ba.prototype.resolve=function(e){this.qqg(e);return null!=e&&"function"===typeof e.then?this.promise.then():void 0};ba.prototype.reject=function(e){this.$pg(e);return null!=e&&"function"===typeof e.then?this.promise.then():
void 0};Object(sd.a)(ba,"ResolvablePromise",null,[]);O.prototype.getRichValueFieldListContext=function(e,C,M,qa){this.egf&&e!==this.egf&&this.wi.sab();this.egf=e;this.wi.hZ(e,M,qa,C);this.E7b=new ba;this.wi.zxb?this.E7b.resolve(this.wi.Tk):this.z0i();return this.E7b.promise};O.prototype.z0i=function(){this.wi.GXb(this.Oxa);this.wi.vAg(this.ruf)};O.prototype.b8f=function(){this.wi.Eqc(this.Oxa);this.wi.I4i(this.ruf)};Object(sd.a)(O,"ServerDataProvider",null,[595]);Q.prototype.dispose=function(){if(this.$){var e=
Ye.g(this.$);e&&(e.ha&&fg.a.bka()&&e.ha.aza(this.Gh),this.Xbf&&e.Ca&&e.Ca.yq(this.Hg))}this.Maa&&(Ye.g(this.$).rc.Rp(this.Rh),this.TCa.o4i(this.Gqf));this.ppa.a4i(this.Oqf);this.functionInfoManager&&this.functionInfoManager.Fqc(this.onFunctionInfoLoaded);ff.a.Fa(this.TCa);ff.a.Fa(this.ppa);this.ppa=this.TCa=this.functionInfoManager=this.$=null};Q.prototype.m9i=function(){this.vMa=-1;this.wMa=null};Q.prototype.jza=function(e){var C=this;e=void 0===e?0:e;if(27!==e&&9!==e&&13!==e&&!this.qb.zK){if(this.H4a&&
(ka.instance.znb.formulaAssistanceRequestAttemptedCounter++,!this.Ypj())){ka.instance.znb.formulaAssistanceRequestOptimizedCounter++;return}this.functionInfoManager.I4||this.functionInfoManager.Jrb({});var M=this.qb;e=M.text;M=M.textBox.caretPosition;!this.Maa||this.fRa?(ka.instance.Z6(["argumentAssistanceComputation","autoCompleteComputation","argumentAssistanceOverall","autoCompleteOverall"]),this.pluginScheduler.batchRequester().functionSuggestionAndArgumentAssistance({functionSuggestion:{content:e,
caretPosition:M},argumentAssistance:{content:e,caretPosition:M}}).then(function(qa){0===qa.kind&&(C.p2e(qa.payload.argumentAssistance),C.X2e(qa.payload.functionSuggestion));return null})):(ka.instance.Z6(["autoCompleteComputation","autoCompleteOverall"]),this.pluginScheduler.requester().functionSuggestion(Object.assign(new Z,{content:e,caretPosition:M})).then(function(qa){0===qa.kind&&C.X2e(qa.payload);return null}))}};Q.prototype.ki=function(){this.jza();return!1};Q.prototype.Ypj=function(){var e=
this.qb,C=e.text;e=e.textBox.caretPosition;if(this.ppa.get_visible()&&K.a.equals(C,this.wMa,!0)&&e===this.vMa)return!1;this.wMa=C;this.vMa=e;return!0};Q.prototype.FJd=function(){this.pluginScheduler.requester().runExperiment(new na)};Q.prototype.p2e=function(e){e&&this.qb.isEditing?(ka.instance.SY(["argumentAssistanceComputation"]),this.TCa.show(e,this.qb.textBox.domElement)):this.TCa.dismiss()};Q.prototype.X2e=function(e){e&&0<e.items.length&&this.qb.isEditing?(ka.instance.SY(["autoCompleteComputation"]),
this.ppa.show(e)):this.ppa.dismiss()};Q.prototype.pBb=function(){var e=Ye.g(this.$).ha.va.activeCell;if(e){var C=this.calcManager.rsa(e);if(C){var M=this.$.xa,qa=C.sheet.index;0>=M.count||0>qa||qa>=M.count||(qa=M=null,this.Yvd&&void 0!==this.calcManager&&null!==this.calcManager&&(e=Ye.g(this.$).Ca.Mr(e))&&(e=this.calcManager.Idd(e.Gm),void 0!==e&&null!==e&&(M=e.FormatString,qa=e.Builtin)),this.pluginScheduler.notifier().setActiveCell(Object.assign(new wa,{colIndex:C.range.col,rowIndex:C.range.row,
sheetIndex:this.$.xa.getItem(C.sheet.index).sheetId,docName:C.sheet.document.name,docPath:C.sheet.document.path,formatString:M,builtIn:qa})))}else Dd.ULS.sendTraceTag(537162002,0,50,"FormulaAssistanceManager.NotifyActiveCellChanged ISheetGridCell location is null")}};Q.prototype.cLj=function(){this.pluginScheduler.notifier().setFunctionsInfo(this.functionInfoManager.vad)};Q.prototype.Njd=function(){Ye.g(this.$).ha.bra(this.Gh);this.pBb();this.FJd();this.ppa.Jzg(this.Oqf);this.pluginScheduler.setServerDataProvider(new O(this.wi,
this.$));this.jza()};tl.Object.defineProperties(Q.prototype,{$Ia:{configurable:!0,enumerable:!0,get:function(){return this.ppa}},eSe:{configurable:!0,enumerable:!0,get:function(){return this.TCa}},qb:{configurable:!0,enumerable:!0,get:function(){return Ye.g(this.$).Jj}}});Object(sd.a)(Q,"FormulaAssistanceManager",null,[563,3]);var dk=vb.a;vm(I,dk);I.prototype.create=function(){var e=this,C=fg.a.bka(),M=kd.EwaSettings.la(382),qa=kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.LETAutocomplete",
!1),Na=fg.a.hV(this.$),Hb=this.$.da,Gc=td.GetServiceTaskFactory.create(Hb,134,this.ma,this.tb),gd=td.GetServiceTaskFactory.Xa(this.$.da,12,477,this.tb);var Uc=fg.a.AM(this.$)?td.GetServiceTaskFactory.create(this.$.da,449,this.$.ma,1):Fg.Task.Ta(null);var Wd=fg.a.bka()?td.GetServiceTaskFactory.create(this.$.da,414,this.$.ma,1):Fg.Task.Ta(null);if(qa||C){var We=td.GetServiceTaskFactory.Xa(Hb,266,265,this.tb),Gf=td.GetServiceTaskFactory.Xa(Hb,219,220,this.tb);wf.TaskExtensions.Ba(wf.TaskExtensions.ve([We,
Wd,Uc,Gf],this.ma),function(){var Hg=Hb.Aa(19)||new Fa(e.$,Wd.result),Ig=Gf.result;if(Na){var Hh=Hb.Aa(464);Hh||(Hh=new Q(e.$,Hg,We.result,Wd.result,Uc.result,gd.result.T1c(e.$,Gc.result)),Ig.yVc(Hh.eSe),Ig.zVc(Hh.$Ia))}else Hh=Hb.Aa(221),Hh||(Hh=new Y(e.$,Hg,Gc.result,We.result,null,gd.result,Uc.result,Wd.result),Ig.yVc(Hh.fSe),Ig.Rpe(Hh.zSe),Ig.zVc(Hh)),M&&(Hb.Aa(317)||new Hc(e.$));e.Fb(Hg)},this.ma,3)}else{var xg=td.GetServiceTaskFactory.Xa(Hb,219,220,this.tb);wf.TaskExtensions.Ba(wf.TaskExtensions.ve([xg,
Uc,Wd],this.ma),function(){var Hg=Hb.Aa(19)||new Fa(e.$,Wd.result),Ig=xg.result,Hh=Hb.Aa(221);Hh||(Hh=new Y(e.$,Hg,Gc.result,null,null,gd.result,Uc.result,Wd.result),Ig.yVc(Hh.fSe),Ig.Rpe(Hh.zSe),Ig.zVc(Hh));M&&(Hb.Aa(317)||new Hc(e.$));e.Fb(Hg)},this.ma,3)}};I.ja=function(e){e.da.Ha(153,new I(e))};Object(sd.a)(I,"FunctionInfoManagerFactory",vb.a,[]);var mk=b(200),Nj=b(74),nk=b(113);R.prototype.cWe=function(){return nk.a(Xg.a.Ra,this.startTime)};Object(sd.a)(R,"OngoingAction",null,[]);var Ak=Nj.a;
vm(W,Ak);W.prototype.dEb=function(e){Dd.ULS.sendTraceTag(537153864,0,50,"ActionAggregator<{0}>.PerformThrottledAction: Start. IsActionOngoing: {1}, AggregatedActionParams not null: {2}",this.Kka,this.$Ka,this.D4a);this.Emb=this.Kug.Cmb(e,this.Emb);this.lkd()};W.prototype.dispose=function(){this.documentVisibilityObserver&&this.documentVisibilityObserver.cGb(this.Nxa);this.fue();Ak.prototype.dispose.call(this)};W.prototype.rWf=function(e){this.iXc?(this.hOa=e?new R:null,e?this.startTimer():this.fue()):
this.hOa=e?{}:null};W.prototype.LQe=function(e){e=void 0===e?null:e;this.iXc&&e&&e.TJ?Dd.ULS.sendTraceTag(537153863,0,50,"ActionAggregator<{0}>.FinishedCallback: timedout, skipping",this.Kka):(Dd.ULS.sendTraceTag(537153862,0,50,"ActionAggregator<{0}>.FinishedCallback: Start. IsActionOngoing: {1}, AggregatedActionParams not null: {2}",this.Kka,this.$Ka,this.D4a),this.rWf(!1),this.lkd())};W.prototype.lkd=function(){var e=this;if(!this.lRa()){var C=this.Emb;this.Emb=null;this.rWf(!0);Dd.ULS.sendTraceTag(537153857,
0,50,"ActionAggregator<{0}>.InternalPerformAction: Calling PerformAction.",this.Kka);var M=this.iXc?this.hOa.Ww.token:mk.a.none;wf.TaskExtensions.Ba(this.Jug.cEb(C),function(){e.LQe(M)},M,0,this.aO)}};W.prototype.lRa=function(){return!this.D4a||this.$Ka?!0:this.documentVisibilityObserver&&this.documentVisibilityObserver.kj?(Dd.ULS.sendTraceTag(593376846,0,50,"ActionAggregator<{0}>.ShouldThrottle: Not Calling PerformAction as document is hidden.",this.Kka),!0):!1};W.prototype.fue=function(){this.$mc&&
this.$mc.cancel()};W.prototype.startTimer=function(){this.jXc<=this.Fse&&(this.$mc=Nd.a.instance.create(this.vJi,this.hOg,Ud.a.yhe))};tl.Object.defineProperties(W.prototype,{$Ka:{configurable:!0,enumerable:!0,get:function(){return!!this.hOa}},D4a:{configurable:!0,enumerable:!0,get:function(){return!!this.Emb}}});Object(sd.a)(W,"ActionAggregator",Nj.a,[687,3]);var sk=b(121),Pi=ah.a;vm(ia,Pi);ia.prototype.VAg=function(e){this.addHandler("KBIS",e)};ia.prototype.$4i=function(e){this.removeHandler("KBIS",
e)};ia.prototype.dispose=function(){this.firstElement&&T.a.removeHandler(this.firstElement,Ve.a.focus,this.Otf);this.ds&&this.ds.detach("focus");this.ho&&(T.a.removeHandler(this.ho,Ve.a.focus,this.Hvf),T.a.removeHandler(this.ho,Ve.a.blur,ia.onBlur),hk.KeyInputManager.instance.za(Ve.a.Rb,this.ho,this.Ivf));hk.KeyInputManager.instance.za(Ve.a.Rb,this.$.domElement,this.kBf);this.ds=this.ho=this.firstElement=this.$=null;Pi.prototype.dispose.call(this)};ia.prototype.G1g=function(){this.moj?(this.firstElement=
document.documentElement,this.ds=sk.a.instance.VD(document.parentWindow),this.ds.ja("focus",this.TMi)):(this.firstElement=ia.WAe(),document.body.insertBefore(this.firstElement,document.body.childNodes[0]),T.a.addHandler(this.firstElement,Ve.a.focus,this.Otf))};ia.prototype.F2g=function(){this.ho=ia.WAe();this.ho.id=If.a.WHe;this.ho.setAttribute(If.a.Bv,fe.a.instance.ea(842));document.body.appendChild(this.ho);T.a.addHandler(this.ho,Ve.a.focus,this.Hvf);T.a.addHandler(this.ho,Ve.a.blur,ia.onBlur);
hk.KeyInputManager.instance.pa(Ve.a.Rb,this.ho,this.Ivf)};ia.prototype.jsh=function(e){this.y6f(e);return!1};ia.prototype.oCi=function(){this.yLa=!0;Ye.g(this.$).focus();Ye.g(this.$).ha.P2e();this.raiseEvent("KBIS");return!0};ia.prototype.y6f=function(e){this.yLa?this.yLa=!1:(this.yLa=!0,e&&e.focus())};ia.WAe=function(){var e=document.createElement("div");e.tabIndex=0;return e};ia.J5e=function(){document.body.classList.add(pc.a.uKe)};ia.onBlur=function(){document.body.classList.remove(pc.a.uKe)};
Object(sd.a)(ia,"EmbedViewFocusControl",ah.a,[686,3]);var Vi=b(58),mi=b(527),Bi=ah.a;vm(P,Bi);P.prototype.GXb=function(e){this.addHandler("FieldInfoListContextLoaded",e)};P.prototype.Eqc=function(e){this.removeHandler("FieldInfoListContextLoaded",e)};P.prototype.vAg=function(e){this.addHandler("GetFieldInfoListContextOperationFailed",e)};P.prototype.I4i=function(e){this.removeHandler("GetFieldInfoListContextOperationFailed",e)};P.prototype.dispose=function(){this.vb=null;this.sab();Bi.prototype.dispose.call(this)};
P.prototype.hZ=function(e,C,M,qa){qa=void 0===qa?null:qa;if(e){this.cYc();var Na=null,Hb=!1,Gc;if(Gc=!qa)Gc=this.nFj(e,C,M),Hb=Gc.SDb,Na=Gc.Tk,Gc=Gc.returnValue;if(Gc&&(Na&&Dd.ULS.sendTraceTag(25264348,0,50,"Retrieved {0} rich value field contexts from block cache",Na.length),this.DKc=!0,(this.l1=Na)&&0<this.l1.length&&(this.GRb=!0,this.nHf()),!Hb))return;this.k$f(e,qa,C,M,!1)}};P.prototype.k$f=function(e,C,M,qa,Na){if(this.$.fa.oc){this.$.Ub&&(this.SGb=this.$.Ub.Fc("WebServiceCall","GetRichValueFieldInfoListContext"));
this.Utb=null;var Hb=this.$.qa.ta.Xb(),Gc=this.$.qa.ta,gd=this.IDi,Uc=this.HDi,Wd=Gc.Oa(1,null);Wd.selectedRange=e;Wd.richValueKeyPath=C;Wd.singleColumn=M;Wd.searchForRange=qa;Wd.calculateMajorityDataType=Na;this.Utb=vf.i(Gc,"GetRichValueFieldListContextList",Wd,gd,Uc,null,Hb,4)}else this.l1=null};P.prototype.sab=function(){this.l1=null;this.GRb=!1;this.cYc();this.Utb=null};P.prototype.cYc=function(){P.X_b(this.Utb)};P.prototype.nHf=function(){this.raiseEvent("FieldInfoListContextLoaded")};P.prototype.wn=
function(e){e=jg.D(e);--e.left;--e.right;return this.tableManager.wn(e)};P.prototype.nFj=function(e,C,M){var qa=null;var Na=!1;if(e.SheetName!==this.$.fa.oa.sheetName)return{returnValue:!1,SDb:Na,Tk:qa};if(M){var Hb=this.wn(e);if(!Hb||!Hb.mva)return{returnValue:!1,SDb:Na,Tk:qa};Hb.top+=1;Hb.right=jg.D(e).right-1}else Hb=new mi.AutofilterRange(e.FirstRow+1,e.FirstColumn+1,e.LastRow+1,e.LastColumn+1,null,null,null,0,!1);if(Hb.top>Hb.bottom||Hb.left>Hb.right)return{returnValue:!0,SDb:Na,Tk:qa};e=Ye.g(this.$);
var Gc=e.$a.width,gd=e.$a.height,Uc=e.view.visibleArea;Gc=new Vi.a(Uc.x-Gc,Uc.y-gd,Uc.width+Gc,Uc.height+gd);gd=e.Lg(Hb);if(!Uc||!gd||!e.Yfc(Hb))return{returnValue:!1,SDb:Na,Tk:qa};Gc.contains(gd)||(Na=!0);e=Hb.clone();if(M)for(M=Hb.right,Uc=0;M>=Hb.left;--M){if(e.left=M,e.right=M,Gc=this.sWe(e,!0,Hb.left)){qa||(qa=[]);qa[Uc]=Gc;if(C)break;++Uc}}else if(C=this.sWe(e,!1))qa=[],qa[0]=C;return{returnValue:!0,SDb:Na,Tk:qa}};P.prototype.sWe=function(e,C,M){M=void 0===M?0:M;var qa=null;if(kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5723259_StoreRichValueFieldsInDictionary")){var Na=
Ye.g(this.$).Vb.tQh(e);if(Na&&0<Na.count){var Hb=Array(Na.count),Gc=0;Na=yl(Na.values);for(qa=Na.next();!qa.done;qa=Na.next()){var gd={};gd.Name=qa.value;Hb[Gc]=gd;++Gc}Gc="";Na=-1;0<e.top&&C&&(e=new Ug.Range(e.top-1,e.left,e.top-1,e.left,!1,!1),Gc=Ye.g(this.$).sc(e).originalText,Na=e.left-M);qa={};qa.ColumnName=Gc;qa.ColumnIndex=Na;qa.FieldInfoDataList=Hb}}else if((Na=Ye.g(this.$).Vb.uQh(e))&&0<Na.count){Hb=Array(Na.count);Gc=0;Na=yl(Na);for(qa=Na.next();!qa.done;qa=Na.next())gd={},gd.Name=qa.value,
Hb[Gc]=gd,++Gc;Gc="";Na=-1;0<e.top&&C&&(e=new Ug.Range(e.top-1,e.left,e.top-1,e.left,!1,!1),Gc=Ye.g(this.$).sc(e).originalText,Na=e.left-M);qa={};qa.ColumnName=Gc;qa.ColumnIndex=Na;qa.FieldInfoDataList=Hb}return qa};P.X_b=function(e){e&&hd.AFrameworkApplication.Hd.Zt(e.kt)};tl.Object.defineProperties(P.prototype,{zxb:{configurable:!0,enumerable:!0,get:function(){return this.GRb}},Eli:{configurable:!0,enumerable:!0,get:function(){return this.DKc}},$:{configurable:!0,enumerable:!0,get:function(){return this.vb}},
Tk:{configurable:!0,enumerable:!0,get:function(){return this.l1}},BIh:{configurable:!0,enumerable:!0,get:function(){return!!this.Utb}}});Object(sd.a)(P,"FieldInfoManager",ah.a,[590,3]);vm(N,P);N.prototype.LIh=function(e,C){this.F0a=C;Dd.ULS.sendTraceTag(537153825,0,100,"FilterInfoManager.GetFilterFieldInfoListContextAsync - Retrieving the list of field list context for row, col, row, col ({0}, {1}, {2}, {3})",e.FirstRow,e.FirstColumn,e.LastRow,e.LastColumn);this.k$f(e,null,!0,!1,!0)};tl.Object.defineProperties(N.prototype,
{lG:{configurable:!0,enumerable:!0,get:function(){return this.Ugg}}});Object(sd.a)(N,"FilterInfoManager",P,[685,590,3]);U.wmh="ewa-sharedUi-launchButton";U.ymh="ewa-sharedUi-launchButtonWithText";U.xmh="ewa-sharedUi-launchButtonClick";U.zmh="ewa-sharedUi-launchButtonWithTextClick";Object(sd.a)(U,"CssClassNames",null,[]);var oj=b(279),Oj=ei.a;vm(B,Oj);B.prototype.g2=function(e){this.addHandler(this.lEb,e)};B.prototype.Jca=function(e){this.get_events().removeHandler(this.lEb,e)};B.prototype.lBg=function(e){this.addHandler("OnObjectButtonMouseOver",
e)};B.prototype.p5i=function(e){this.get_events().removeHandler("OnObjectButtonMouseOver",e)};B.prototype.kBg=function(e){this.addHandler("OnObjectButtonMouseOut",e)};B.prototype.o5i=function(e){this.get_events().removeHandler("OnObjectButtonMouseOut",e)};B.prototype.p9f=function(e){e&&(this.aZa.innerHTML=e)};B.prototype.tIj=function(e,C,M){this.aZa.innerHTML="";e?e.Iaa(C,16,16,this.aZa,16,16,void 0,M):Dd.ULS.sendTraceTag(537153824,0,10,"OnObjectButton.UpdateButtonSvgImage: Called without svgIconProvider")};
B.prototype.uIj=function(e,C){e&&(this.cLb.innerText=e);this.domElement.title=C};B.prototype.dispose=function(){this.get_isInitialized()&&(this.hide(),this.wc.kA(),ff.a.pc([this.NY,this.TYa]),Mg.a.instance.za(Ve.a.click,this.domElement,this.Vc),nj.a.instance.za(Ve.a.pointerDown,this.domElement,this.dN),this.tRa&&this.tRa.dispose(),Oj.prototype.dispose.call(this))};B.prototype.qab=function(){this.T0b&&this.domElement.classList.remove(this.T0b);this.lkc&&this.domElement.classList.add(this.lkc)};B.prototype.kEb=
function(){this.lkc&&this.domElement.classList.remove(this.lkc);this.T0b&&this.domElement.classList.add(this.T0b);this.T0a()};B.prototype.T0a=function(){this.sgc&&(this.tRa.cancel(),this.y2f(),this.setOpacity(1));this.set_visible(!0)};B.prototype.so=function(e,C,M,qa,Na){Na=void 0===Na?!1:Na;e=xe.a(qa).Fi(e);C=xe.a(qa).Fi(C);xe.a(qa).ruc(this.domElement);this.domElement.style.top=ab.HelperMethods.Qb(C);this.domElement.style.left=this.domElement.style.right="";C=e;Na&&(C=e-this.domElement.offsetWidth);
Vj.c(this.domElement.style,M,ab.HelperMethods.Qb(C));this.set_visible(!0);this.setOpacity(1);this.sgc&&(this.MPd=!1,this.kxj(),this.tRa.Bq())};B.prototype.hide=function(){this.qab();this.set_visible(!1);this.sgc&&(this.y2f(),this.tRa.cancel())};B.prototype.Y5b=function(){this.wc.ja("mouseover",this.ZE,!0);this.wc.ja("mouseout",this.HH,!0)};B.prototype.kxj=function(){this.NY.Bt("mousemove")||this.NY.ja("mousemove",this.Mxa)};B.prototype.y2f=function(){this.NY.Bt("mousemove")&&this.NY.detach("mousemove")};
B.prototype.Bgd=function(e){if(this.domElement.parentNode){var C=Sys.UI.DomElement.getBounds(this.domElement),M=new Sys.UI.Point(Math.round(C.x+C.width),Math.round(C.y+C.height));C=Math.abs(M.x-e.x);e=Math.abs(M.y-e.y);e=C>e?C:e;this.MPd?this.setOpacity(B.iPg(e)):100>=e&&this.Lhe()}};B.prototype.Lhe=function(){this.MPd=!0;this.tRa.cancel()};B.prototype.setOpacity=function(e){Mf.a.setOpacity(this.domElement,e);this.sgf=Xg.a.Ra.Kb};B.iPg=function(e){return 100>=e?1:250<=e?0:.01*(100-(e-100)/150*100)};
Object(sd.a)(B,"OnObjectButton",ei.a,[623,184,3]);var jk=b(924),ok=Nj.a;vm(w,ok);w.prototype.dispose=function(){this.Cbh();this.$=null;ok.prototype.dispose.call(this)};w.prototype.getButton=function(e,C){return this.sua(e,void 0===C?!0:C)};w.prototype.sua=function(e,C){var M=e.toString();M in this.buttons||this.H2g(e,void 0===C?!0:C);return this.buttons[M]};w.prototype.so=function(e,C,M,qa,Na,Hb){Na=void 0===Na?!0:Na;Hb=void 0===Hb?!1:Hb;this.hide();if(this.$.fa.isNamedObjectViewMode&&ih.i(this.$.oa)){var Gc=
Ye.g(this.$).FN.domElement,gd=e+this.buttonWidth-Gc.scrollWidth;Gc=C+this.buttonWidth-Gc.scrollHeight;e=0<gd?e-gd:e;C=0<Gc?C-Gc:C}this.sua(qa,Na).so(e,C,M,this.$,Hb)};w.prototype.hide=function(){var e=this.buttons,C;for(C in e)e[C].hide()};w.prototype.Y5b=function(e,C){!this.j6e&&(C=this.buttons[C.toString()])&&(this.Jjc=function(M,qa){e(qa,!0)},C.lBg(this.Jjc),this.Ijc=function(M,qa){e(qa,!1)},C.kBg(this.Ijc),this.j6e=!0,C.Y5b())};w.prototype.H2g=function(e,C){function M(Hb,Gc){qa.qAi(Gc,e)}var qa=
this;this.Eva=String.format(this.Mid===pc.a.K6b?'<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>':'<img class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1"/>',dh.a.If(this.Mid),dh.a.If(this.Lid),"{0}");var Na=String.format(this.Eva,dh.a.If(this.altText));C=new B(""===this.buttonText?U.wmh:U.ymh,""===this.buttonText?U.xmh:U.zmh,pc.a.OB,Na,C,this.lEb,this.buttonText,"ewa-sharedUi-launchButtonText");C.g2(M);this.buttons[e.toString()]=C;this.JJe[e.toString()]=
M;Na=Ye.g(this.$).fg(e);Na.domElement.insertBefore(C.domElement,Na.domElement.firstChild)};w.prototype.Cbh=function(){for(var e=yl(jk.a(this.buttons)),C=e.next();!C.done;C=e.next()){C=C.value;var M=this.buttons[C];M.Jca(this.JJe[C]);ff.a.Fa(M);delete this.buttons[C];this.Jjc&&M.p5i(this.Jjc);this.Ijc&&M.o5i(this.Ijc)}};w.prototype.domElement=function(e){return this.sua(e).domElement};w.prototype.T0a=function(e){this.sua(e).T0a()};w.prototype.AMb=function(e,C,M){M=void 0===M?!0:M;this.Eva=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',
dh.a.If(this.Mid),dh.a.If(this.Lid),"{0}");e=String.format(this.Eva,dh.a.If(e));this.sua(C,M).p9f(e)};w.prototype.LSa=function(e,C,M){this.sua(M,!1).uIj(e,C)};w.prototype.h$f=function(){var e=void 0===e?!1:e;this.Eva=String.format('<input type="image" class="{0}" src="{1}" title="{2}" alt="{2}" tabindex="-1" role="button"/>',"{0}",dh.a.If(this.Lid),"{1}");var C=String.format(this.Eva,void 0,dh.a.If(void 0));this.sua(void 0,e).p9f(C)};w.prototype.i$f=function(e,C,M){this.sua(M,!1).tIj(this.svgIconProvider,
e,C)};tl.Object.defineProperties(w.prototype,{Uy:{configurable:!0,enumerable:!0,get:function(){return xe.a(this.$).nFa(Mi.a.LHi)}},t0b:{configurable:!0,enumerable:!0,get:function(){return Mi.a.KHi}},buttonWidth:{configurable:!0,enumerable:!0,get:function(){return xe.a(this.$).nFa(Mi.a.MHi)}}});Object(sd.a)(w,"OnObjectLaunchButton",Nj.a,[593,3]);var Xj=b(83),Tk=Xj.a;vm(G,Tk);G.prototype.dispose=function(){ff.a.Fa(this.Zzb);this.Zzb=null;Tk.prototype.dispose.call(this)};G.prototype.jAa=function(){ff.a.Fa(this.Zzb);
this.Zzb=Nd.a.instance.create(Object(zb.a)(this,this.display,"display"),this.t2h,Ud.a.Ili)};G.prototype.NRa=function(){ff.a.Fa(this.Zzb);this.hide()};Object(sd.a)(G,"LoadingIndicatorBehavior",Xj.a,[621,3]);vm(r,G);r.prototype.dispose=function(){this.Yzb=null;G.prototype.dispose.call(this)};r.prototype.display=function(){this.njg(this.Yzb)};r.prototype.hide=function(){this.I_h(this.Yzb)};r.prototype.$wg=function(){this.Yzb=document.createElement("div");this.domElement.appendChild(this.Yzb)};Object(sd.a)(r,
"ShimmerLoadingIndicatorBehavior",G,[]);vm(z,G);z.prototype.dispose=function(){this.OMa=null;G.prototype.dispose.call(this)};z.prototype.display=function(){Le.DOMElementExtensions.setVisible(this.OMa,!0)};z.prototype.hide=function(){Le.DOMElementExtensions.setVisible(this.OMa,!1)};z.prototype.Zwg=function(){this.OMa=document.createElement("div");this.OMa.classList.add(bk.a.slh);var e=document.createElement("div");e.classList.add(bk.a.tlh);this.r3c&&""!=this.r3c&&e.classList.add(this.r3c);var C=this.gif?
fe.a.instance.ea(this.gif):"",M=String.format('<div class="'+bk.a.ulh+'">{0}</div>',C);this.Vcc?(C=String.format('<img src="{0}" alt="{1}" title="{1}"/>',this.Vcc,C),e.innerHTML=C+M):e.innerHTML=M;this.OMa.appendChild(e);this.domElement.appendChild(this.OMa)};Object(sd.a)(z,"SpinnerLoadingIndicatorBehavior",G,[]);t.prototype.q2c=function(e,C,M){return new Wj.a(e,C,M)};t.prototype.S2b=function(e,C,M,qa,Na,Hb,Gc,gd,Uc,Wd){return new db(e,C,M,qa,Na,Hb,Gc,gd,Uc,Wd)};t.prototype.B_a=function(e,C,M,qa,
Na){return new z(e,C,M,qa,void 0===Na?0:Na)};t.prototype.Sdd=function(e){return e.da.Aa(238)||new ia(e)};t.prototype.V2b=function(e,C,M,qa,Na,Hb,Gc,gd){return new w(e,C,M,qa,Na,Hb,Gc,void 0===gd?"":gd)};t.prototype.T1c=function(e,C){return new P(e,C)};t.prototype.C1g=function(e,C,M,qa){return new N(e,C,M,qa)};t.prototype.Ppb=function(e,C,M,qa){return new W(e,C,M,qa)};Object(sd.a)(t,"SharedUIControlsFactory",null,[560]);var dl=vb.a;vm(x,dl);x.prototype.create=function(){kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit2",
!1)?this.Fb(this.$.da.Aa(12)||new t):this.Fb(new t)};x.ja=function(e){e.da.Ha(477,new x(e))};Object(sd.a)(x,"SharedUIControlsFactoryServiceFactory",vb.a,[]);var il=b(1023),cl=vb.a;vm(A,cl);A.prototype.create=function(){var e=this;Dd.ULS.sendTraceTag(537154643,0,50,"PluginSchedulerFactory.Create: Loading scheduler slice");il.a.then(this.a4g(),function(C){e.Fb(C);return!0})};A.prototype.a4g=function(){var e=this;if(this.Y2b)return this.Y2b;var C=Sf.a.E_a(pd.b(),mk.a.none,"LoadResource","x10Scheduler loading");
if(kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5789323_disableSchedulerForIE")&&Mf.a.Ku){var M=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance();this.$.da.Ha(413,M);C.setResult(M);return this.Y2b=C.task}this.$.da.Za(266,function(){e.$.da.Za(283,function(qa){var Na=excelOnlineCalc.PluginSchedulerSingletonGlobal.instance();qa=qe.b(Fg.Task.Ta(qa.wo));if(kd.EwaSettings.isChangeGateEnabled("OfficeVSO:6035660_attachX10PluginsOnOouiSide"))excelOnlineCalc.x10.ensureAllPluginsAttached(qa).then(function(){e.$.da.Ha(413,
Na);C.setResult(Na)});else{var Hb=excelOnlineCalc.x10.ensurePluginAttached(1,qa),Gc=excelOnlineCalc.x10.ensurePluginAttached(5,qa),gd=excelOnlineCalc.x10.ensurePluginAttached(1E3,qa),Uc=excelOnlineCalc.x10.ensurePluginAttached(1002,qa),Wd=excelOnlineCalc.x10.ensurePluginAttached(10,qa),We=excelOnlineCalc.x10.ensurePluginAttached(11,qa),Gf=excelOnlineCalc.x10.ensurePluginAttached(12,qa),xg=excelOnlineCalc.x10.ensurePluginAttached(13,qa),Hg=excelOnlineCalc.x10.ensurePluginAttached(1004,qa);Hb=[Hb,Gc,
gd,Uc,Wd,We,xg,Hg,Gf];kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5818445_AttachDataTypesExperiment")&&(qa=excelOnlineCalc.x10.ensurePluginAttached(1003,qa),Hb.push(qa));Promise.all(Hb).then(function(){e.$.da.Ha(413,Na);C.setResult(Na)})}})});return this.Y2b=C.task};A.ja=function(e){e.da.Ha(414,new A(e))};Object(sd.a)(A,"PluginSchedulerFactory",vb.a,[]);var Bk=Nj.a;vm(m,Bk);m.prototype.dispose=function(){this.xp.dispose();this.$=null;Bk.prototype.dispose.call(this)};m.prototype.domElement=function(e){return this.xp.domElement(e)};
m.prototype.getButton=function(e){return this.xp.getButton(e,!1)};m.prototype.AMb=function(e,C){this.xp.AMb(e,C,!1)};m.prototype.aAa=function(e,C){var M=Ye.g(this.$),qa=M.$a.Kj(e);this.xp.AMb(C?fe.a.instance.ea(1684):fe.a.instance.ea(1685),qa);C=this.isMac?C?fe.a.instance.ea(1688):fe.a.instance.ea(1689):C?fe.a.instance.ea(1686):fe.a.instance.ea(1687);var Na=M.Lg(e,qa);e=M.fg(qa).Dn;if(Na&&0<=Na.x&&0<=Na.y){var Hb=Na.bottomRight.x+this.Uy;Na=Na.topLeft.y-this.Uy-this.buttonWidth;if(Na<e.topLeft.y+
this.Uy){if(M.$a.rSa){this.hide();return}Na=e.topLeft.y+this.Uy}this.so(Hb,Na,M.rtl,qa);this.ariaLiveNotifier.ePa(C)}else this.hide()};m.prototype.so=function(e,C,M,qa){this.xp.so(e,C,M,qa,!1)};m.prototype.hide=function(){this.xp.hide()};tl.Object.defineProperties(m.prototype,{Uy:{configurable:!0,enumerable:!0,get:function(){return this.xp.Uy}},buttonWidth:{configurable:!0,enumerable:!0,get:function(){return this.xp.buttonWidth}}});Object(sd.a)(m,"PulloutLaunchButton",Nj.a,[]);var Rk=Nj.a;vm(v,Rk);
v.prototype.dispose=function(){this.gridView&&(this.gridView.ha.Nca(this.Sh),this.gridView.view.Wr(this.Ns),this.gridView.Kc&&this.gridView.Kc.im(this.Mj));if(this.$){var e=this.$;e.ml(this.od);e.Fn(this.qd);e.RC(this.aj);Ye.g(e).Us(this.$Q)}this.wi&&this.wi.Eqc(this.Oxa);ff.a.Fa(this.Nh);this.wi=this.$=this.gridView=this.lnb=this.Nh=null;Rk.prototype.dispose.call(this)};v.prototype.wx=function(){this.Nh.hide()};v.prototype.Uca=function(){this.Nh?this.Nh.getButton(this.Yda).qab():Dd.ULS.sendTraceTag(537154142,
0,15,"PulloutManager.ResetButtonAppearance: launchButton is null.")};v.prototype.O9i=function(){this.S_=null};v.prototype.VFf=function(){this.Nh&&this.Nh.hide()};v.prototype.nUh=function(){if(!this.egd||1!==this.selectedRange.width)return null;for(var e=this.selectedRange.clone();this.gridView.HZ(e);){e.left+=1;e.right+=1;if(!this.gridView.fg(this.gridView.$a.Kj(e)).Ph.Jf(e))break;if(this.gridView.Ca.Mr(e)){var C=this.gridView.sl("PulloutManager.GetValidatedRangeToFill",e,2);try{if(v.cNj(C))return e}finally{C&&
C.dispose()}}}return null};v.prototype.Frc=function(){this.wi.sab()};v.prototype.showCallout=function(){var e=this;this.Nva&&(this.wi.zxb?(this.Nh.getButton(this.Yda).kEb(),kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit2",!1)?wf.TaskExtensions.Ba(td.GetServiceTaskFactory.Xa(this.$.da,8,9,0),function(C){e.a_f(C.result)},this.$.ma,3):this.a_f(this.contextMenuManager)):(this.fXc=!0,this.hZ()))};v.prototype.a_f=function(e){e.Mbd("tableFieldList").VN(null,this.Nh.domElement(this.Yda),
this.wi,null,!0);this.Frc()};v.prototype.CQe=function(){if(!this.Nva||!this.gridView||this.gridView.ha.Qa.nc||!this.gridView.ha.va.Dh)return null;var e=this.gridView.ha.va.activeCell,C=Ye.g(this.$).$a.Kj(e);if(!e)return null;this.NEa=e.clone();var M=this.tableManager.wn(e);this.xJc=!!M;if(this.KM){this.Nh.AMb(fe.a.instance.ea(1684),C);this.jO=v.nbg(M);if(!this.jO)return null;C=this.tableManager.Wze(M,this.gridView);e=C.fY;C=C.returnValue||e;this.BCc=e;if(C)return this.Ssc=new Ug.Range(M.top,M.left,
M.bottom,M.right,!1,!1),this.KLc=new Ug.Range(this.jO.top,this.jO.right+1,this.jO.top,this.jO.right+1,!1,!1),this.jO}else if(this.egd){this.Nh.AMb(fe.a.instance.ea(1685),C);this.uWa=this.gridView.ha.va.Qd.clone();M=Ye.g(this.$).Vb.YLa(this.selectedRange);this.jO=v.nbg(this.selectedRange);if(!M||!this.jO||!this.selectedRange||kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RichPivotAll",!1)&&this.tableManager.NJa(this.selectedRange))return null;this.KLc=this.nUh();if((kd.EwaSettings.isChangeGateEnabled("OfficeVSO:5459087_FixLinkedEntityConvertPulloutButtonVisibilityBounds")?
this.gridView.HZ(this.selectedRange):this.gridView.HZ(this.jO))&&this.zxa)return this.Ssc=this.jO,M=String.format("PulloutManager:FindSelection, NextRange, {0}, RightColumnHeader, {1}, ActiveCell, {2}",this.zxa?this.zxa.toString():"null",this.jO?this.jO.toString():"null",e?e.toString():"null"),Dd.ULS.sendTraceTag(537154137,0,50,M),this.jO}return null};v.prototype.hZ=function(){this.KM?this.wi.hZ(jg.v(this.zxa,this.$),!1,!0):kd.EwaSettings.la(135)&&this.wi.hZ(jg.v(this.selectedRange,this.$),!0,!1)};
v.prototype.v5a=function(){return this.$.fa.isNamedObjectViewMode&&ih.f(this.$.oa)};v.cNj=function(e){for(;e.$$mn();)if(e.$$cu().text||e.$$cu().VJ||e.$$cu().kj||e.Wn.t4e)return!1;return!0};v.nbg=function(e){return e.right===Mi.a.Qh?null:new Ug.Range(e.top,e.right,e.top,e.right,!1,!1)};tl.Object.defineProperties(v.prototype,{Jb:{configurable:!0,enumerable:!0,get:function(){return this.Nh.domElement(1)}},zxa:{configurable:!0,enumerable:!0,get:function(){return this.KLc}},selectedRange:{configurable:!0,
enumerable:!0,get:function(){return this.uWa}},KM:{configurable:!0,enumerable:!0,get:function(){return this.xJc}},Fzb:{configurable:!0,enumerable:!0,get:function(){var e=this.Nh.domElement(this.Yda);return e?Le.DOMElementExtensions.isVisible(e):!1}},Nva:{configurable:!0,enumerable:!0,get:function(){return this.$.isEditMode&&kd.EwaSettings.la(135)?!(new Hd.a(this.$.xa)).ik:!1}},uDg:{configurable:!0,enumerable:!0,get:function(){return this.BCc}},Yda:{configurable:!0,enumerable:!0,get:function(){return this.zxa?
this.gridView.$a.Kj(this.jO):1}}});Object(sd.a)(v,"PulloutManager",Nj.a,[557,3]);var pk=vb.a;vm(u,pk);u.prototype.create=function(){var e=this;th.a.Ga(function(C){var M=td.GetServiceTaskFactory.Xa(C.da,12,477,e.tb),qa=td.GetServiceTaskFactory.Xa(C.da,66,134,e.tb),Na=td.GetServiceTaskFactory.Xa(C.da,211,212,e.tb),Hb=null,Gc=!kd.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit2",!1);Gc&&(Hb=td.GetServiceTaskFactory.Xa(C.da,8,9,e.tb));wf.TaskExtensions.Ba(wf.TaskExtensions.ve([M,
qa,Hb,Na],C.ma),function(){Gc?e.Fb(e.$.da.Aa(261)||new v(e.$,M.result,qa.result,Hb.result,Na.result)):e.Fb(e.$.da.Aa(261)||new v(e.$,M.result,qa.result,null,Na.result))},C.ma)})};u.ja=function(e){e.da.Ha(262,new u(e))};Object(sd.a)(u,"PulloutManagerFactory",vb.a,[]);var $k=b(383);Object(sd.a)(f,"GestureAdapterInfo",null,[]);var el=b(373),Xi=b(221);l.prototype.bli=function(){if(!this.sFc){var e="hammer.min.js";hd.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.WordOnline.UseIsServerFlavorAppSetting",
!1)&&(e=hd.AFrameworkApplication.ga.ra("IsServerFlavorDebug")?"hammer.js":"hammer.min.js");e=hd.AFrameworkApplication.D6(String.format("{0}",e),5);e=Xi.a.create(e,null,null);el.a.bia(e);this.sFc=e.U6a}return this.sFc};tl.Object.defineProperties(l,{instance:{configurable:!0,enumerable:!0,get:function(){l.Na||(l.Na=new l);return l.Na}}});l.Na=null;Object(sd.a)(l,"HammerJsDependencyLoader",null,[688]);var vj;(function(e){e[e.none=-1]="none";e[e.pinch=0]="pinch";e[e.pan=1]="pan";e[e.swipe=2]="swipe"})(vj||
(vj={}));Object(sd.b)("GestureEvent",vj);var J=b(71),oa=J.a;vm(n,oa);n.create=function(e,C,M,qa,Na,Hb){if(M.rawEvent)if(Hb){var Gc=M.rawEvent;Gc=new Sys.UI.Point(Gc.clientX,Gc.clientY)}else Gc=J.a.Ftb(M);else Gc=new Sys.UI.Point(M.clientX,M.clientY);return new n(e,Gc,C,M,qa,Na,M.shiftKey,M.ctrlKey,Hb)};tl.Object.defineProperties(n.prototype,{shiftKey:{configurable:!0,enumerable:!0,get:function(){return this.Lfa}},ctrlKey:{configurable:!0,enumerable:!0,get:function(){return this.pX}},clientPoint:{configurable:!0,
enumerable:!0,get:function(){return this.Wfb}},mua:{configurable:!0,enumerable:!0,get:function(){return this.Kkg}}});Object(sd.a)(n,"GestureEventArgs",J.a,[]);Object(sd.a)(k,"GestureManagerData",null,[]);c.hfg=2;c.ifg=4;c.jfg=8;c.kfg=8;Object(sd.a)(c,"HammerConstants",null,[]);var Va=b(198),Ub=T.a;vm(d,Ub);d.prototype.SJh=function(){return this.SMc?0:this.Yfe?1:2};d.prototype.dn=function(e){Ub.prototype.dn.call(this,e);this.Ud.Lja(this.TUa,e,0,this.hjb)};d.prototype.Yl=function(e){Ub.prototype.Yl.call(this,
e);this.Ud.AHa(e,this.TUa)};d.prototype.H0i=function(e,C,M){var qa=this;M=void 0===M?null:M;var Na=void 0===Na?null:Na;hd.AFrameworkApplication.tfc()?l.instance.bli().continueWith(function(Hb){qa.vxj();if(Hb.jg||Hb.Ch)Dd.ULS.sendTraceTag(591192778,310,10,"Hammer did not download correctly: {0}",Hb.status);else{Dd.ULS.sendTraceTag(591192779,310,50,"Hammer download status: {0}",Hb.status);if(qa.q0d){Hb=window.Hammer;if("undefined"===typeof Hb){Dd.ULS.sendTraceTag(590901389,310,10,"Hammer does not exist");
qa.Uwc();return}if("undefined"===typeof Hb.inputHandler){Dd.ULS.sendTraceTag(590901390,310,10,"Hammer.inputHandler does not exist");qa.Uwc();return}}if(!e)throw qa.Uwc(),Error.argumentNull("source element can not be null");Hb=Va.a.Jua(e,qa.vpa);if(void 0===Hb||null===Hb)Hb=new Mj.a,Va.a.ybb(e,qa.vpa,Hb),qa.I0i(e);var Gc=null;if(!Hb.wb(vj[0])){Gc=Object;var gd=Gc.assign,Uc=new f,Wd=vj[0],We=Na;We=void 0===We?null:We;if(void 0===qa||null===qa)throw Dd.ULS.sendTraceTag(42256258,310,10,"manager cannot be null"),
Error.argumentNull("manager can not be null");var Gf=null;switch(Wd){case Ve.a.pinch:Gf=new Hammer.Pinch(We);break;case Ve.a.pan:Gf=new Hammer.Pan(We)}Gf&&(Gf.manager=qa);Gc=gd.call(Gc,Uc,{yca:Gf,xTe:C});Hb.add(vj[0],Gc)}if(void 0!==M&&null!==M)for(gd=0;gd<M.length;gd++)Hb.wb(vj[M[gd]])&&(Uc=Hb.na(vj[M[gd]]),Gc.yca.recognizeWith(Uc.yca))}qa.Uwc()}):Dd.ULS.sendTraceTag(42256219,310,10,"Multi Touch is not enabled either from common BRS or from your app BRS")};d.prototype.vxj=function(){this.dHc&&(this.uh?
this.BPc=this.uh.Fc("Task","RegisterGestureAdapterAfterLoad"):Dd.ULS.sendTraceTag(590387074,310,10,"_stopwatchBuilder is null"))};d.prototype.Uwc=function(){this.dHc&&(this.BPc?this.BPc.stop():Dd.ULS.sendTraceTag(590387075,310,10,"_stopwatchForRegisterGestureAdapterAfterLoad is null"))};d.prototype.I0i=function(e){this.Lkg.add(e);this.Ud.Lja(this.TUa,e,0,this.hjb)};d.prototype.recognize=function(e){for(var C=Array(e.pointers.length),M=0;M<e.pointers.length;M++)C[M]=e.pointers[M].target;M=null;for(this.Roa=
this.eMh(C);void 0!==this.Roa&&null!==this.Roa&&(M=Va.a.Jua(this.Roa,this.vpa),void 0===M||null===M);this.Roa=this.Roa.parentNode);if(void 0!==M&&null!==M){this.curRecognizer&&this.curRecognizer.state===c.kfg&&(this.curRecognizer=null);C=yl(M.keys);for(var qa=C.next();!qa.done;qa=C.next()){qa=M.na(qa.value);void 0!==qa&&null!==qa&&void 0!==qa.yca&&null!==qa.yca&&(void 0===this.curRecognizer||null===this.curRecognizer||qa.yca===this.curRecognizer||qa.yca.canRecognizeWith(this.curRecognizer))&&qa.yca.recognize(e);
var Na=qa.yca.state;this.curRecognizer||c.hfg!==Na&&c.ifg!==Na&&c.jfg!==Na||(this.curRecognizer=qa.yca)}}};d.prototype.emit=function(e,C){if("hammer.input"!==e){this.l8=!1;C=n.create(e,this.Roa,C.srcEvent,C,3,this.SMc);var M=Va.a.Jua(this.Roa,this.vpa);if(this.tdi(e))var qa=0;else if(this.idi(e))qa=1;else if(this.$fi(e))qa=2;else{Dd.ULS.sendTraceTag(42256256,310,15,"Event can not be recognized by current manager");return}M=M.Ec(vj[qa]).value;void 0!==M&&null!==M&&((M=M.xTe,M.ebi())?e.endsWith("start")?
this.l8=M.oDi(C):e.endsWith("end")?(M.mDi(C),this.l8=!0):e.endsWith("cancel")?(M.lDi(C),this.l8=!0):e.endsWith("move")&&(this.l8=M.nDi(C)):Dd.ULS.sendTraceTag(42256257,310,50,"App rejected to perform gesture now : {0}",e))}};d.prototype.get=function(e){return Object(qc.a)(Hammer.Recognizer,e)};d.prototype.eMh=function(e){if(1>e.length)return null;if(1===e.length)return e[0];for(var C=e[0],M=!0,qa=1;qa<e.length;qa++){if(!e[qa])return null;if(C!==e[qa]){M=!1;break}}if(M)return C;C=this.OTe(e[0]);M=
0;e=yl(e);for(qa=e.next();!qa.done;qa=e.next()){qa=this.OTe(qa.value);if(C.na(C.count-1)!==qa.na(qa.count-1))return null;for(var Na=C.count-2,Hb=qa.count-2;Na>=M&&0<=Hb;Na--,Hb--)if(C.na(Na)!==qa.na(Hb)){M=Na+1;break}}return C.na(M)};d.prototype.OTe=function(e){for(var C=new lc.a;void 0!==e&&null!==e;e=e.parentNode)C.add(e);return C};d.prototype.yXe=function(e){switch(e){case Ve.a.Ff:case Ve.a.Gra:return 1;case Ve.a.Ig:case Ve.a.d_b:return 2;case Ve.a.De:case Ve.a.Qnb:return 4;case Ve.a.wyc:case Ve.a.JWc:return 8}return 0};
d.prototype.cya=function(e,C,M){e=this.yXe(e);C=this.QKh(M);Hammer.inputHandler(this,e,C);this.l8&&M.preventDefault();return this.l8};d.prototype.R3e=function(){return 1<this.AS.count};d.prototype.U_b=function(){Dd.ULS.sendTraceTag(594055960,310,50,"CancelPendingPointerEvents");if(this.elb)for(var e=yl(this.AS),C=e.next();!C.done;C=e.next())this.BLf(C.value.key);else this.AS=new Mj.a;this.session=null};d.prototype.pxg=function(e,C,M){Dd.ULS.sendTraceTag(594055959,310,50,"AddOrReplacePointerInCaches: pointerId: {0}",
e);if(!this.Cjb.wb(e)){try{C.setPointerCapture(e)}catch(qa){Dd.ULS.sendTraceTag(594055958,310,10,"Exception: {0}",qa)}this.Cjb.add(e,C)}this.AS.ia(e,M);this.YTa&&1<this.AS.count&&this.Kea&&!this.Kea.xob&&(this.Kea.xob=!0)};d.prototype.BLf=function(e){Dd.ULS.sendTraceTag(594055957,310,50,"RemovePointerFromCaches: pointerId: {0}",e);if(this.Cjb.wb(e)){try{this.Cjb.na(e).releasePointerCapture(e)}catch(C){Dd.ULS.sendTraceTag(594055956,310,10,"Exception: {0}",C)}this.Cjb.remove(e)}else Dd.ULS.sendTraceTag(594055955,
310,10,"RemovePointerFromCaches: pointerId should be in cache: {0}",e);this.AS.remove(e);this.YTa&&1>=this.AS.count&&this.Kea&&this.Kea.xob&&(this.Kea.xob=!1)};d.prototype.kmc=function(e,C,M){var qa=M.rawEvent.pointerType.toString(),Na=M.rawEvent.pointerId.toString();if("touch"!==qa)return!1;e=this.yXe(e);if(1!==e&&!this.AS.wb(Na))return!1;this.w0d&&1===e&&M.rawEvent.isPrimary&&this.AS.count&&(Dd.ULS.sendTraceTag(593839564,310,10,"Pointer cache should be empty"),this.U_b());this.elb?this.pxg(Na,C,
M):this.AS.ia(Na,M);this.JKc&&2===e&&(!this.bEc||this.bEc&&"function"===typeof M.rawEvent.getCoalescedEvents)&&(C=M.rawEvent.getCoalescedEvents())&&this.R3e()&&(this.Iib=Math.max(this.Iib,C.length));this.qce&&(this.l8=!1);qa=this.PKh(this.AS,M,qa);Hammer.inputHandler(this,e,qa);if(4===e||8===e)this.elb?this.BLf(Na):this.AS.remove(Na),this.AS.count||(this.session=null,this.JKc&&-1!==this.Iib&&(Dd.ULS.sendTraceTag(593597138,310,50,"Max number of coalesced events: {0}",this.Iib),this.Iib=-1));this.l8&&
M.preventDefault();return this.l8};d.prototype.Wlc=function(){return!1};d.prototype.QKh=function(e){var C=new k,M=e.rawEvent,qa=M.touches;M=M.changedTouches;C.pointers=Array.clone(qa);C.pointers=Array.clone(0<qa.length?qa:M);C.changedPointers=Array.clone(M);C.srcEvent=e;C.pointerType="touch";return C};d.prototype.PKh=function(e,C,M){var qa=new k;qa.pointers=ha.toArray(e.values);qa.changedPointers=[C];qa.pointerType=M;qa.srcEvent=C;return qa};d.prototype.tdi=function(e){return dh.a.startsWith(e,Ve.a.pinch)};
d.prototype.idi=function(e){return dh.a.startsWith(e,Ve.a.pan)};d.prototype.$fi=function(e){return dh.a.startsWith(e,Ve.a.swipe)};Object(sd.a)(d,"GestureInputManager",T.a,[558,559]);a.prototype.di=function(e){e.register(d,"Common.App.GestureManager.GestureInputManager").as("Common.IGestureInputManager").zc().Ic(function(){return new d(Bh.a.instance,hd.AFrameworkApplication.sa.fD)});this.rb=e};a.prototype.init=function(){this.Hw||(this.rb.resolve("Common.App.GestureManager.GestureInputManager"),this.Hw=
!0)};a.prototype.dispose=function(){};a.main=function(){Kg.a.instance.mj(new a)};tl.Object.defineProperties(a.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.GestureInputManager"}}});Object(sd.a)(a,"GestureInputManagerPackage",null,[4,5]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.AutoComplete");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.ContextMenu");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidation");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataValidationEdit");
Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.FormulaAssistance");Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.SharedUIControlsFactory");Type.registerNamespace("_Ewa");Be.a.Yi('.ewa-ac{position:absolute;z-index:102;margin-top:1px;width:auto}.ewa-ac .ewa-ac-param{white-space:nowrap;margin-bottom:3px;direction:ltr}.ewa-ac .ewa-ac-param function_param_table{position:absolute}.ewa-ac .ewa-ac-param .ewa-function-help-link{text-decoration:underline}.ewa-lb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#262626;font-size:12px;font-family:"Segoe UI";z-index:102;height:auto;margin:0 8px;-ms-touch-action:manipulation;touch-action:manipulation;vertical-align:middle}.ewa-lb.ewa-fb-refactor{position:relative;margin:0}.ewa-lb table{left:0;right:0;border-collapse:collapse}.ewa-lb table td{white-space:nowrap}.ewa-lb table td div.clip16x16{margin:0 0 0 2px}.ewa-lb table td.list-item{height:24px;padding:0 8px}.ewa-lb table td.list-item-selected{background-color:#d3f0e0}@media screen and (-ms-high-contrast:active){.ewa-lb table td.list-item-selected{border:2px solid #fff}}.ewa-lb table.list-table-touch td.list-item{height:35px}div#suggested_cells_list_box{margin:0}div#suggested_cells_list_box .list-table .ewa-suggested-cell-name{float:left;overflow:hidden;text-overflow:ellipsis;white-space:nowrap}@font-face{font-family:"Segoe UI Semibold";font-weight:600;src:local("Segoe UI Semibold"),local("Segoe UI")}.ewa-lb table td.columnName-header{color:#666;font-size:12px;font-family:"Segoe UI Semibold";text-align:left;padding:3px 8px;text-overflow:ellipsis}.ewa-tt{background-color:#f7f7f7;border:1px solid #a2a6ab;color:#444;height:auto;vertical-align:middle;width:auto;z-index:102;font-size:8pt;margin:0;padding-bottom:3px;padding-top:2px}.ewa-root-ltr .ewa-tt{text-align:left;padding-left:5px;padding-right:7px}.ewa-root-rtl .ewa-tt{text-align:right;padding-left:7px;padding-right:5px}.ewa-dlg-function-link-container .ewa-fdb-help-link,.ewa-tt-rtl .ewa-fdb-help-link,.ewa-tt-ltr .ewa-fdb-help-link{color:#00f;text-decoration:underline}.ewa-function-link-container .ewa-function-udf-name,.ewa-function-link-container-udf .ewa-function-help-link{display:none}.ewa-root.rtl .ewa-function-link-container{text-align:left}');
th.a.Ga(vc.ja);th.a.Ga(Da.ja);Type.registerNamespace("Common.App.MultitabControl");Type.registerNamespace("CAUI");Qe.main();Be.a.Yi(".TabsContainer{width:100%}.TabTitlesContainer{width:100%;display:table;table-layout:fixed;padding:0}.TabTitlesContainer>.TabTitle{display:table-cell;text-align:center}.TabTitlesContainer>.TabTitle:hover:not(.TabTitleActive){font-weight:bold}.TabTitleText{text-decoration:none}div#dataFieldCustomLabel,div#dataFieldSourceLabel{font-weight:600;padding-left:10px}div#summarizeValuesByControlBody{background-color:#fff;padding:10px}.valueFielsSettingsControlTitle{font-weight:bold;border-bottom:1px solid #a2a6ab}div#summarizeValuesByControlBody>.summarizeValuesByControlDescription{font-weight:600}div#summarizeValuesByControlBody>select{width:100%}div#showValueAsControlBody{background-color:#fff;padding:10px}select#showValueAsSelect{width:100%;margin-bottom:5px}select#showValueAsBaseFieldSelect{width:100%}select#showValueAsBaseItemSelect{width:100%;overflow:hidden}div#showValueAsControlBody>.showValueAsControlSelectRegion{width:48%;display:inline-block;position:relative}div#showValueAsControlBody>.showValueAsControlSelectRegionSeparator{width:4%;display:inline-block}.showValueAsControlSelectRegion>div{width:100%}input#valueFieldsSettingsFieldName{width:273px}div#valueFieldSettingTabs{width:380px}");
(function(){rg.initData();th.a.Ga(function(e){dg.ja(e);Zc.ja(e);rg.ja(e);ud.ja(e)})})();Be.a.Yi(".ewa-dv{position:relative;z-index:100;width:auto}.ewa-dv-buttonarea{position:absolute;border:0;padding:1;z-index:100;margin:0;overflow:hidden;width:auto;height:auto}.ewa-dv-listbutton{margin:0;cursor:pointer}.ewa-dv-listbutton span.clip17x17{display:inline-block;margin:0}.ewa-dlb{position:absolute;border:1px solid #a2a6ab;overflow-x:hidden;overflow-y:auto;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:100;height:auto;margin:0}.ewa-dlb table{left:0;right:0;border-collapse:collapse;empty-cells:show}.ewa-dlb table td{white-space:nowrap;padding:0 2px 0 2px}.ewa-dlb table.list-table td.list-item{height:24px}.ewa-dlb table.list-table td.list-item-selected{height:24px;background-color:#d3f0e0;color:#444}.ewa-dlb table.list-table-touch td.list-item{height:35px}.ewa-dlb table.list-table-touch td.list-item-selected{height:35px;background-color:#d3f0e0;color:#444}@media screen and (-ms-high-contrast:active){.ewa-dlb table.list-table td.list-item-selected{background-color:highlight;-ms-high-contrast-adjust:none;color:highlighttext}}.ewa-dpb{position:absolute;border:1px solid #a2a6ab;cursor:default;background-color:#fff;color:#444;font-size:11px;z-index:99;margin:0;max-width:230px}.ewa-dpb p{padding:0 2px 0 2px;margin:0;border-collapse:collapse;width:230px}.ewa-dv-ltr .ewa-dpb p{text-align:left}.ewa-dv-rtl .ewa-dpb p{text-align:right}.ewa-dpb p.dv-prompt-title{font-weight:bold}.ewa-dpb p.dv-prompt-message{word-wrap:break-word;overflow:hidden}");
Be.a.Yi(".DataValidationDialogPanel{min-width:0}.DataValidationDialogPanel .TabTitlesContainer{width:300px}.DataValidationDialogPanel div#WACDialogBodyPanel{height:312px}.TabTitlesContainer{border-bottom:solid 1px #c3cbd0}.TabTitle{text-align:center;cursor:default}.TabTitleText{display:inline-block}.TabTitleActive{color:#217346;font-weight:bold}.TabTitleActive>.TabTitleText{padding-bottom:10px;border-bottom:solid 4px}.DataValidationEditTabContent{padding-top:7px}.DataValidationButtonPanel{float:none}.AppRtl .DataValidationButtonPanel{float:none}.DataValidationButtonClearAll{float:left;margin-left:0;margin-right:10px}.AppRtl .DataValidationButtonClearAll{float:right;margin-left:10px;margin-right:0}.DataValidationRow{margin-bottom:10px;display:table}.DataValidationNonBorderRow{margin-bottom:8px;display:table}.DataValidationEditElementLabel{width:95px;display:inline-block;margin-top:4px;margin-bottom:4px;vertical-align:top}.DataValidationEditElement{display:inline-block;margin-top:0;margin-bottom:0;padding:1px;font-size:9pt;font:inherit;border:solid 1px #c3cbd0}.DataValidationEditNoBorderElement{display:inline-block;margin-top:0;margin-bottom:0;font-size:9pt;font:inherit;width:210px;height:22px}.DataValidationEditSelect{width:calc(210px + 4px);height:calc(22px + 4px);padding:0;color:#000}.DataValidationEditSelect:disabled{color:graytext}.DataValidationEditSelectFocus:focus{outline:-webkit-focus-ring-color auto 5px !important}.DataValidationEditInput{width:210px;height:22px}.DataValidationEditTextArea{width:210px;height:50px;resize:none;overflow-y:auto;overflow-x:hidden}.DataValidationEditErrorMessage{margin-bottom:-15px;margin-top:-6px;font-size:9pt;color:#d90000;width:300px;height:65px}.DataValidationEditCheckBoxWithText{margin-top:0;margin-bottom:0;display:inline-block}.DataValidationEditCheckBoxNoText{margin-top:6px;margin-bottom:0;display:inline-block}.DataValidationEditRadio{margin-top:0;margin-bottom:0}.DataValidationEditLabel{margin-top:5px;margin-bottom:0;display:inline-block}div#listDescriptionSubDivID{height:37px;width:210px}label#listDescriptionLabelId{font-size:8pt;margin-top:0}div#ignoreBlankCheckboxDivID{margin-bottom:8px}");
th.a.Ga(gc.ja);th.a.Ga(ue.ja);th.a.Ga(Nb.ja);Be.a.Yi(".ewa-facp-text-box{position:absolute}");(function(){th.a.Ga(function(e){ib.ja(e)})})();(function(){th.a.Ga(function(e){ed.ja(e)})})();th.a.Ga(Xd.ja);th.a.Ga(oc.ja);th.a.Ga(ad.ja);Be.a.Yi('.ewa-sharedUi-launchButton,.ewa-sharedUi-launchButtonWithText{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#fff;padding:2px;cursor:default;width:fit-content}.ewa-sharedUi-launchButton:hover{background-color:#c6c6c6}.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{cursor:pointer;position:absolute;overflow:hidden;z-index:96;border:1px solid #abafb2;background-color:#b1b1b1;padding:1px;cursor:default;width:fit-content}@media(forced-colors:active){.ewa-sharedUi-launchButtonClick,.ewa-sharedUi-launchButton:active,.ewa-sharedUi-launchButtonWithTextClick{background-color:Highlight;color:HighlightText;border-color:CanvasText;forced-color-adjust:none}.ewa-sharedUi-launchButtonClick svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButton:active svg>path.OfficeIconColors_HighContrast,.ewa-sharedUi-launchButtonWithTextClick svg>path.OfficeIconColors_HighContrast{fill:HighlightText}}.ewa-sharedUi-launchButtonWithText .clip16x16,.ewa-sharedUi-launchButtonWithTextClick .clip16x16{float:left}.ewa-sharedUi-launchButton input{cursor:default}.ewa-sharedUi-launchButton .clip16x16,.ewa-sharedUi-launchButtonClick .clip16x16{padding:0}.ewa-sharedUi-launchButtonText{font-family:"Segoe UI",Tahoma,Thonburi,Arial,Verdana,sans-serif;font-size:10pt;overflow:hidden;padding-left:2px;cursor:pointer}');
th.a.Ga(Ac.ja);th.a.Ga(pb.ja);(function(){th.a.Ga(function(e){e.da.Ha(150,new Wa(e))})})();(function(){th.a.Ga(function(e){tb.ja(e);Ta.ja(e);I.ja(e)})})();th.a.Ga(x.ja);(function(){th.a.Ga(function(e){A.ja(e)})})();(function(){th.a.Ga(function(e){e.la(135)&&u.ja(e)})})();Type.registerNamespace("Common.App.GestureManager");a.main()},843:function(y,D,b){function a(S,Y,na,Z,wa,ma,pa,Ia,Ma,ob,Cb,Xa){var Sb=ca.call(this)||this;Sb.pjc=!1;Sb.contextMenuController=null;Sb.IGc=null;Sb.XDc=null;Sb.Zld=!1;Sb.qSj=
0;Sb.pSj=0;Sb.Zqb=null;Sb.fsc=null;Sb.bC=function(){Sb.contextMenuController?Sb.contextMenuController.bC():d.ULS.sendTraceTag(537167068,0,10,"ContextMenuBase.DismissFloatie: the context menu controller is null when attempintg to dismiss floatie on KeyDown.");Sb.C8f()};Sb.vb=S;Sb.rmf=wa;Sb.SNc=ob;Sb.LRj=na;Sb.KRj=Z;Sb.qRj=Y;Sb.SDf=ma;Sb.populateOnlyOnce=pa;Sb.FZh=Cb;Sb.hKf(Xa);return Sb}b.d(D,"a",function(){return a});y=b(0);var d=b(13),c=b(892),k=b(88),n=b(23),l=b(864),f=b(845),u=b(998),v=b(914),
m=b(110),A=b(308),x=b(86),t=b(408),z=b(814);D=b(74);var r=b(16),G=b(4),w=b(976),B=b(78),U=b(43),N=b(57),P=b(141),ia=b(119),W=b(1),R=b(8),I=b(19),Q=b(14),O=b(20),ba=b(34),ca=D.a;vm(a,ca);a.prototype.Xc=function(S,Y){S=!0;switch(Y){case 1651433993:case 1675506831:case 966232027:S=this.te(4096)||this.te(2048);break;case 912277356:case 2123758504:case -1793121409:case 1378457149:S=this.te(8192)}return!S};a.prototype.fd=function(S,Y,na){na.IsShadowMenuOpen||w.h(this.$,w.d);S=!1;Y===this.Kt&&(na.IsShadowMenuOpen||
w.h(this.$,w.a),Y=Object.assign(new c.a,{ExternalId:"ContextMenu",UpdateDynamically:!0,MenuSectionList:[]}),this.qBd(Y,na.IsShadowMenuOpen),na.MenuItems=Y,na.IsShadowMenuOpen||w.h(this.$,w.c),S=!0);S&&this.pjc&&R.HelperMethods.f_b&&!na.IsShadowMenuOpen&&w.j(this.$);return S};a.prototype.qBd=function(S,Y){(Y=this.zY(Y))?(this.q6e(Y),Array.addRange(S.MenuSectionList,Y.JB().MenuSectionList),this.Ixg(S)):d.ULS.sendTraceTag(537167105,0,10,"ContextMenuBase.PopulateContextMenuProps: CreateRibbonMenu() returned null instead of RibbonMenu instance")};
a.prototype.zY=function(){d.ULS.sendTraceTag(537167104,0,10,"ContextMenuBase.CreateRibbonMenu: This method should not be called if the menu is not ready for React!");return null};a.prototype.VN=function(S,Y,na,Z,wa){S=Sys.UI.DomElement.getBounds(Y);na=new Sys.UI.Point(S.x,S.y+S.height);this.ISa(na,Y);this.$.isChromeRtl&&(na.x+=S.width);this.so(na,wa)};a.prototype.so=function(S,Y,na){na=void 0===na?0:na;Y&&(S=ba.a(this.$).OJa(S));Y=!0;if(this.FZh){var Z;3===na?(Z=this.BJa(3))&&0<Z.length?(Y=!1,this.showFloatie(Z,
new Sys.UI.Bounds(S.x,S.y,0,0),na)):d.ULS.sendTraceTag(537167075,0,10,"ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the touch floatie groups. Context menu ID: {0}",this.menuId):2===na&&this.$.isEditMode&&((Z=this.BJa(2))&&0<Z.length?Z[0]!==a.kRe?(Y=!1,this.aPd(Z,new Sys.UI.Bounds(S.x,S.y,0,0),na)):d.ULS.sendTraceTag(537167074,0,50,"ContextMenuBase.ShowAt: The context menu does not support floatie. Context menu ID: {0}",this.menuId):d.ULS.sendTraceTag(537167073,
0,10,"ContextMenuBase.ShowAt: A context menu that implements floaties has returned null when generating the mouse floatie groups. Context menu ID: {0}",this.menuId))}Y&&this.showContextMenu(new Sys.UI.Bounds(S.x,S.y,0,0),na)};a.prototype.BJa=function(){return null};a.prototype.jed=function(S,Y){var na="";3===S?na="touch":2===S&&(na="mouse");S={};return S.ContextMenuId=this.menuId,S.IsEditMode=this.$.isEditMode,S.IsSLR=!!N.a.Qf&&N.a.Qf.uC,S.IsReactMLR=!!N.a.Qf&&N.a.Qf.nV,S.IsNov=this.$.fa.isNamedObjectViewMode,
S.InputType=na,S.FloatieGroups=JSON.stringify(void 0===Y?null:Y),S};a.prototype.showContextMenu=function(S,Y){Y=void 0===Y?0:Y;var na=this.jed(Y);d.ULS.sendTraceTag(595359709,0,50,"ContextMenuBase.ShowContextMenu: rendering a context menu with given arguments: {0}",JSON.stringify(na));this.contextMenuController?this.VA!==G.a.bEd&&this.VA!==G.a.cEd||!Y?this.contextMenuController.$Od(this.VA,S,B.a.Wb):this.contextMenuController.$Od(this.VA,S,Y):d.ULS.sendTraceTag(537167072,0,10,"ContextMenuBase.ShowContextMenu: the context menu controller is null when attempintg to show context menu.")};
a.prototype.showFloatie=function(S,Y,na){var Z=this.jed(na,S);d.ULS.sendTraceTag(595359710,0,50,"ContextMenuBase.ShowFloatie: rendering a floatie with given arguments: {0}",JSON.stringify(Z));this.contextMenuController?(W.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&this.nKf(),this.contextMenuController.Kvc(S,Y,na)):d.ULS.sendTraceTag(537167071,0,10,"ContextMenuBase.ShowFloatie: the context menu controller is null when attempting to show the floatie with floatieGroups {0}.",
JSON.stringify(S))};a.prototype.aPd=function(S,Y,na){var Z=this.jed(na,S);d.ULS.sendTraceTag(537167070,0,50,"ContextMenuBase.ShowContextMenuWithFloatie: rendering a floatie with given arguments: {0}",JSON.stringify(Z));this.contextMenuController?(W.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&this.nKf(),this.contextMenuController.ZOd(S,Y,na,this.VA)):d.ULS.sendTraceTag(587335491,0,10,"ContextMenuBase.ShowContextMenuWithFloatie: the context menu controller is null when attempintg to show floatie with ContextMenu.")};
a.prototype.hKf=function(S){this.contextMenuController=S};a.prototype.dispose=function(){this.$&&this.$.Ka.L$a(this);this.vb=null;W.EwaSettings.isChangeGateEnabled("OfficeVSO:5381730_FloatieDismissal_OnKeyDown_JsCrashFix")&&this.C8f();this.fsc&&(k.a.Fa(this.fsc),this.fsc=null);ca.prototype.dispose.call(this)};a.prototype.eAh=function(S){var Y=this.$.da.Aa(204);Y&&(Y=Y.MAh(this.rmf))&&Array.add(S.yc,Y)};a.prototype.ISa=function(S,Y){S&&Y&&this.$.fa.lc.isDivSyndicated&&n.a.Af&&(Y=Y.ownerDocument.documentElement,
S.x-=Y.scrollLeft,S.y-=Y.scrollTop)};a.prototype.te=function(S){return(new P.a(this.$.xa)).te(S)};a.prototype.q6e=function(S){S=yl(S.yc);for(var Y=S.next();!Y.done;Y=S.next())if(Y=Y.value,Object(t.a)(451,Y)){Y.title&&(Y.title=a.ym(Y.title));Y=yl(Y.buttons);for(var na=Y.next();!na.done;na=Y.next())na=na.value,Object(t.a)(380,na)?(na.label=a.ym(na.label),na.DR(a.ym(na.alt))):Object(t.a)(452,na)&&this.q6e(na.menu)}};a.prototype.$td=function(S,Y){Y=void 0===Y?!1:Y;var na=[];S=yl(S);for(var Z=S.next();!Z.done;Z=
S.next())na.push(this.XT(Z.value,Y));return na};a.prototype.XT=function(S){for(var Y=[],na=yl(S.MenuItems),Z=na.next();!Z.done;Z=na.next())switch(Z=Z.value,Z.Type){case 3:Array.add(Y,this.yAe(Z,!1));break;case 2:W.EwaSettings.isChangeGateEnabled("OfficeVSO:5775701_ContextMenuToggleButtonFix")?Array.add(Y,this.U5g(Z)):Array.add(Y,this.yAe(Z,!0));break;case 1:Array.add(Y,this.L1g(Z))}return Object.assign(new l.a,{ControlList:Y,Title:S.Title,DisplayMode:"Menu16",MenuSectionTitleFocusable:!0,ShowMenuSectionTitleBackground:!0,
ShowMenuSectionTitleIcon:!0})};a.prototype.Had=function(S,Y){Y=[this.Zqb,S.RibbonCommand.toString(),Y||S.Label,S.Disabled?S.Disabled.toString():"False"];var na=S.CommandData;na=I.a.hashCode(na).toString();Y.push(na,S.Identifier.toString());Y=Y.join("_");S.IsChecked&&(Y+="_Checked");return Y};a.prototype.NAh=function(S){var Y=[this.Zqb,I.a.hashCode(S.Title).toString()];S=yl(S.MenuItems);for(var na=S.next();!na.done;na=S.next())Y.push(na.value.RibbonCommand.toString());return Y.join("_")};a.prototype.aTe=
function(S){var Y=S.Label;Y=I.a.hashCode(Y).toString();Y=[this.Zqb,Y];W.EwaSettings.isChangeGateEnabled("OfficeVSO:5139850_FixPivotFilterMenuDuplicatingIdenticalFields")&&S.Id&&Y.push(I.a.hashCode(S.Id).toString());Y=Y.join("_");S.IsChecked&&(Y+="_Checked");return Y};a.prototype.yAe=function(S,Y){var na=this.c9b(S,Y&&S.IsChecked);Y=na.label;var Z=na.HKa;na=na.$o;var wa=this.Had(S,Y);return Object.assign(new f.a,{Command:S.Disabled?(-251203935).toString():na.toString(),ExternalId:wa,Id:wa,Image16by16Class:Z,
LabelText:Y||S.Label,MenuItemId:S.CommandData,CommandValueId:S.CommandData})};a.prototype.U5g=function(S){var Y=this.c9b(S,S.IsChecked);var na=Y.label;var Z=Y.HKa;Y=Y.$o;var wa=this.Had(S,na);return Object.assign(new u.a,{Command:S.Disabled?(-251203935).toString():Y.toString(),ExternalId:wa,Id:wa,Image16by16Class:Z,LabelText:na||S.Label,MenuItemId:S.CommandData,CommandValueId:S.CommandData,IsChecked:S.IsChecked})};a.prototype.L1g=function(S){var Y=this.mTe(S);var na=Y.label;Y=Y.HKa;var Z=Object.assign(new c.a,
{MenuSectionList:[],UpdateDynamically:!0});Array.addRange(Z.MenuSectionList,this.$td(S.SubMenu.Sections,!0));var wa=this.aTe(S);S=na||S.Label;return Object.assign(new v.a,{ExternalId:wa,Id:wa,LabelText:S,PopulateOnlyOnce:!1,Menu:Z,Image16by16Class:Y,ImageIsVisible:!!Y})};a.prototype.mTe=function(S){S=this.c9b(S,!0);return{label:S.label,HKa:S.HKa,$o:S.$o}};a.prototype.c9b=function(S,Y){var na=W.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled");switch(S.Identifier){case 26:var Z=
912804500;Y=r.a.lNe;S=Q.a.instance.ea(1892);break;case 3:Z=-1902148570;Y=Y?r.a.G$:null;S=Q.a.instance.ea(1852);break;case 4:Z=-1902148570;Y=Y?r.a.G$:null;S=Q.a.instance.ea(1853);break;case 5:Z=-1902148570;Y=Y?r.a.G$:null;S=null;break;case 1:Z=-1677817820;Y=r.a.P6b;S=Q.a.instance.ea(231);break;case 2:Z=-1649376918;Y=S.IsChecked?r.a.jia:null;S=Q.a.instance.ea(2055);break;case 23:Z=1701016594;Y=S.IsChecked?r.a.jia:null;S=Q.a.instance.ea(2055);break;case 6:Z=-87741481;Y=null;S=Q.a.instance.ea(2056);break;
case 7:Z=1948650742;Y=r.a.aMe;S=Q.a.instance.ea(1890);break;case 8:Z=1933713114;Y=r.a.$Le;S=Q.a.instance.ea(1891);break;case 14:Z=504133448;Y=na?r.a.E3:Y?r.a.Hta:r.a.E3;S=Q.a.instance.ea(144);break;case 30:Z=504133448;Y=na?r.a.E3:Y?r.a.Hta:r.a.E3;S=Q.a.instance.ea(148);break;case 32:Z=504133448;Y=na?r.a.E3:Y?r.a.Hta:r.a.E3;S=Q.a.instance.ea(150);break;case 34:Z=504133448;Y=na?r.a.E3:Y?r.a.Hta:r.a.E3;S=Q.a.instance.ea(152);break;case 27:Z=1701016594;Y=Y?r.a.Hta:r.a.E3;S=Q.a.instance.ea(144);break;
case 15:Z=-798968736;Y=na?r.a.G3:Y?r.a.Ita:r.a.G3;S=Q.a.instance.ea(146);break;case 31:Z=-798968736;Y=na?r.a.G3:Y?r.a.Ita:r.a.G3;S=Q.a.instance.ea(149);break;case 33:Z=-798968736;Y=na?r.a.G3:Y?r.a.Ita:r.a.G3;S=Q.a.instance.ea(151);break;case 35:Z=-798968736;Y=na?r.a.G3:Y?r.a.Ita:r.a.G3;S=Q.a.instance.ea(153);break;case 28:Z=1701016594;Y=Y?r.a.Ita:r.a.G3;S=Q.a.instance.ea(146);break;case 21:Z=-2058042992;Y=r.a.g1a;S=null;break;case 29:Z=1701016594;Y=r.a.g1a;S=null;break;case 9:Z=1701016594;S=Y=null;
break;case 11:Z=-1494291901;S=Y=null;break;case 25:Z=-1045020714;Y=S.IsChecked?r.a.jia:null;S=null;break;case 13:Z=1701016594;Y=S.IsChecked?r.a.jia:null;S=Q.a.instance.ea(155);break;case 16:Z=1701016594;Y=r.a.uIa;S=Q.a.instance.ea(1032);break;case 17:Z=1701016594;Y=r.a.Fta;S=null;break;case 18:Z=1701016594;Y=r.a.Eta;S=null;break;case 19:Z=1701016594;Y=r.a.f1a;S=Q.a.instance.ea(1037);break;case 20:Z=1701016594;Y=r.a.K7c;S=Q.a.instance.ea(1038);break;case 24:Z=1675506831;Y=na?null:S.IsChecked?r.a.jia:
null;S=null;break;case 22:Z=S.RibbonCommand;Y=S.IsChecked?na?r.a.G$:r.a.jia:null;S=null;break;case 36:Z=1461300262;Y=null;S=Q.a.instance.ea(154);break;default:d.ULS.shipAssertTag(537167069,0,!1,"Unable to map menu item: {0}",JSON.stringify(S)),Z=1461300262,S=Y=null}return{label:S,HKa:Y,$o:Z}};a.prototype.Ixg=function(S){if(!this.$.fa.amIAlone){var Y=this.$.da.Aa(25);if((void 0!==Y&&null!==Y||!W.EwaSettings.isChangeGateEnabled("OfficeVSO:5280339_GuardPresenceView"))&&!m.a.isEmpty(Y.dBa)&&(Y=Y.CUh(),
!A.a.yj(Y))){var na=[];x.a.instance.resolve("Common.App.UI.IPresenceContextMenuSectionBuilder").l4g(Y,na);Array.addRange(S.MenuSectionList,na)}}};a.prototype.nKf=function(){this.Zld||(this.Zsb&&this.Zsb.KXb(this.bC),this.Eob&&this.Eob.KXb(this.bC),this.Zld=!!this.Zsb||!!this.Eob)};a.prototype.C8f=function(){this.Zsb&&this.Zsb.Jqc(this.bC);this.Eob&&this.Eob.Jqc(this.bC);this.Zld=!1};a.X9b=function(S,Y,na){Y=U.C(Y);var Z=O.g(S).Ca.nub(Y);Y=O.g(S).getCellBounds(Z);var wa=Z.xIg;Z=Z.wIg;var ma=Y.x+wa.x;
Y=Y.y+wa.y;na&&W.EwaSettings.isChangeGateEnabled("OfficeVSO:5554367_NewAutoFilterUXEnabled")&&(O.g(S).rtl||(ma+=Z),Y-=Z);return new Sys.UI.Point(ma,Y)};a.Rrh=function(S){try{Object(z.a)(S.CommandValueId)}catch(Y){}};a.ym=function(S){var Y=a.eta.parseFromString(S,"text/html");return Y?Y.body.innerText:(d.ULS.sendTraceTag(537167066,0,15,"Not able to decode htmlFormattedText"),S)};tl.Object.defineProperties(a.prototype,{contextMenuRoot:{configurable:!0,enumerable:!0,get:function(){return this.fsc}},
$:{configurable:!0,enumerable:!0,get:function(){return this.vb}},Sa:{configurable:!0,enumerable:!0,get:function(){return this.SNc}},menuId:{configurable:!0,enumerable:!0,get:function(){return this.$.Ib+this.rmf}},Zsb:{configurable:!0,enumerable:!0,get:function(){this.IGc||(this.IGc=ia.a(this.$));return this.IGc}},Eob:{configurable:!0,enumerable:!0,get:function(){this.XDc||(this.XDc=O.g(this.$).Kc);return this.XDc}}});a.eta=new DOMParser;a.kRe="Unsupported";Object(y.a)(a,"ContextMenuBase",D.a,[237,
615,3])},929:function(y,D,b){function a(){}b.d(D,"a",function(){return a});y=b(0);a.TJe="ewa-ac";a.dih="ewa-ac-param";a.IKe="ewa-function-help-link";a.MKe="ewa-lb";a.BKe="ewa-fb-refactor";a.listItem="list-item";a.Pzb="list-item-selected";a.Tzb="list-table-touch";a.Szb="list-table";a.AVg="columnName-header";a.zLe="ewa-tt";a.Ykh="ewa-function-link-container";a.JKe="ewa-function-udf-name";a.rtl="rtl";Object(y.a)(a,"CssClassNames",null,[])},938:function(y,D,b){function a(ca,S,Y){this.WOb=null;this.gF=
{};this.MPb=this.zB=null;l.ULS.sendTraceTag(537159566,0,50,"BorderFormatManager: Request new instance");this.$=ca;this.A1d=a.c4c;this.B1d=a.borderStyleSolidLine;this.hi=S;this.Sa=Y;z.EwaSettings.isChangeGateEnabled("OfficeVSO:5680290_AddBorderFormatManagerFactory")||this.$.da.Ha(296,this);this.lU=new d(this.$,this.hi);this.qH=z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1);l.ULS.sendTraceTag(537159565,0,50,"BorderFormatManager: register BorderFormatManager with ServiceName {0}",
"296")}function d(ca,S){var Y=this;this.DEb=this.ribbonCommandInfo=this.cellFormat=this.Ar=this.Nb=this.ha=null;this.Ppc=!1;this.gFf=this.RKa=this.qFf=this.n5d=this.Bya=this.Pla=null;this.ZZb=this.lta=this.oFf=0;this.borderStyle=this.RYa=this.borderColor=null;this.yA=!1;this.E3b=this.R9a=null;this.P_=function(){if(!Y.yA||O.g(Y.$).Xy)Y.yA=!1,O.g(Y.$).Xy=!1,Y.lta=0,O.g(Y.$).Bh.Rt(v.a.taa),1===Y.$.Ka.LG()&&(O.g(Y.$).PU(G.a.clone(Y.qFf),Y.oFf,Y.$.oa?Y.$.oa.sheetName:null,null,Y.gFf.clone(),null,null,
0,Q.a.sdh,!0),O.g(Y.$).k0(!0)),Y.Xs(),Y.LUd(),Y.mm(),Y.Ppc=!1,Y.Pla=null,Y.Bya=null,Y.Ar&&(Y.Ar.cancel(),Y.Ar.dispose()),l.ULS.sendTraceTag(537159516,0,50,"DrawBorderBehavior.ResetBehavior : Ending ResetBehavior ")};this.onPointerDown=function(na){try{if(na=Y.Fe(na),O.g(Y.$).Xy=!0,Y.Pla={},Y.Bya={},Y.R9a=null,Y.Vnb(Y.ZZb),2===na.zb){var Z=O.g(Y.$).ha.gr(na.clientPoint,na.Sb,5,void 0,void 0,!1);Z&&(Y.RKa=Z,Y.E3b=Z,Y.s0i())}}catch(wa){O.g(Y.$).Xy=!1}return!0};this.Nj=function(na){try{na=Y.Fe(na);var Z=
O.g(Y.$).ha.gr(na.clientPoint,na.Sb,5,void 0,void 0,!1),wa=O.g(Y.$).Ca.Mr(Z);if(!Y.DEb||wa&&(wa.SJ!==Y.DEb.SJ||wa.RJ!==Y.DEb.RJ))if(Y.yA=!0,Y.DEb=wa,Z){var ma=new P.Range(Y.RKa.top,Y.RKa.left,Y.RKa.top,Y.RKa.left,!0,!1);ma.union(Z);ma=O.g(Y.$).ha.mPh(ma);Y.c_b(Z);Y.SPf(Y.R9a,ma);if(Y.bottomRightCorner(ma.bottom,ma.right))return l.ULS.sendTraceTag(537159515,0,15,"DrawBorderBehavior.OnPointerMove - Bottom-right corner of sheet reached, cannot expand further."),!1;var pa=new P.Range(ma.top,ma.left,ma.bottom+
1,ma.right+1,!0,!1),Ia=O.g(Y.$).m$("DrawBorderBehavior.OnPointerMove",[pa]);if(Y.Pla&&Y.Bya)for(;Ia.$$mn();){var Ma=Ia.$$cu(),ob=Ma.cell.getRange().toString();ob in Y.Pla&&1!==Y.lta||(Y.Pla[ob]=Ma,Y.Bya[ob]=Ma.cell.BUe())}Y.R9a=pa;Y.E3b=ma;O.g(Y.$).PU([ma],0,Y.$.oa.sheetName,null,ma.topLeft,null,null,0,Q.a.pdh,!0);Y.hi.gna(O.g(Y.$),-1690267012,Y.cellFormat,!0,null,[ma])}return!0}catch(Cb){return O.g(Y.$).Xy=!1}};this.Yg=function(na){na=Y.Fe(na);(na=O.g(Y.$).ha.gr(na.clientPoint,na.Sb,5,void 0,void 0,
!1))?Y.yA&&(Y.c_b(na),Y.RKa.union(na),3===Y.lta?Y.Vnb(0):Y.Vnb(Y.ZZb),O.g(Y.$).PU([Y.RKa],0,Y.$.oa.sheetName,null,null,null,null,0,Q.a.qdh,!0),Y.hi.formatCells(-1690267012,Y.cellFormat,Y.ribbonCommandInfo)):(3===Y.lta?Y.Vnb(0):Y.Vnb(Y.ZZb),O.g(Y.$).PU([Y.E3b],0,Y.$.oa.sheetName,null,null,null,null,0,Q.a.rdh,!0),Y.hi.formatCells(-1690267012,Y.cellFormat,Y.ribbonCommandInfo));Y.yA=!1;Y.LUd();Y.Pla=null;Y.Bya=null;return!0};this.onKeyDown=function(na){na=Y.Fe(na);if(Y.yA||Array.contains([17,16,18,20],
na.Ea.keyCode))return!0;Y.P_();return!1};this.onKeyUp=function(na){na=Y.Fe(na);if(na.Ea.keyCode===w.a.lO&&Y.yA)return Y.yA=!1,Y.SPf(Y.R9a,Y.E3b,!0),Y.LUd(),!0;if(Y.yA||na.Ea.keyCode===w.a.eBa||na.Ea.keyCode===w.a.dZd||na.Ea.keyCode===w.a.cZd||Array.contains([17,16,18,20,37,39,38,40,33,34,9,13],na.Ea.keyCode)||na.Ea.keyCode===w.a.Mfg||na.Ea.keyCode===w.a.Ifg||na.Ea.keyCode===w.a.Ffg)return!0;Y.P_();return!1};this.Jxa=function(na,Z){O.g(Y.$).Xy&&!Array.contains(Y.z1h,Z.ee.command)&&(l.ULS.sendTraceTag(537159512,
0,50,"DrawBorderBehavior.OnCommandExecutionStarting : Command Triggered : {0} ",Z.ee),Y.P_())};this.$=ca;this.hi=S}function c(ca){ca.xKf()}function k(){this.iconName=this.title=this.key=null}function n(ca,S,Y,na,Z,wa,ma,pa){this.ihg=ca;this.jhg=S;this.hhg=Y;this.XO=na;this.lsg=Z;this.xog=wa;this.uib=ma;this.sng=pa}b.r(D);y=b(0);var l=b(13),f=b(948),u=b(850),v=b(4),m=b(78),A=b(51),x=b(217),t=b(32),z=b(1),r=b(14);n.xLg=function(){return new n("BorderStyleSolidLine",1896,1,"1","",1,8,0)};n.tLg=function(){return new n("BorderStyleDashedLine",
1897,3,"1","5,3",1,8,0)};n.uLg=function(){return new n("BorderStyleDottedLine",1898,4,"1","1,1",1,8,0)};n.wLg=function(){return new n("BorderStyleMediumLine",1899,2,"2","",1,8,0)};n.yLg=function(){return new n("BorderStyleThickLine",1900,5,"3","",1,8,0)};n.vLg=function(){return new n("BorderStyleDoubleLine",1901,6,"1","",2,8,3)};tl.Object.defineProperties(n.prototype,{vre:{configurable:!0,enumerable:!0,get:function(){return this.ihg}},XZb:{configurable:!0,enumerable:!0,get:function(){return this.jhg}},
ure:{configurable:!0,enumerable:!0,get:function(){return this.hhg}},width:{configurable:!0,enumerable:!0,get:function(){return this.XO}},Ayj:{configurable:!0,enumerable:!0,get:function(){return this.lsg}},Bxi:{configurable:!0,enumerable:!0,get:function(){return this.xog}},lineHeight:{configurable:!0,enumerable:!0,get:function(){return this.uib}},Eki:{configurable:!0,enumerable:!0,get:function(){return this.sng}}});Object(y.a)(n,"BorderLineStyleProperties",null,[]);Object(y.a)(k,"BorderLineStyleProps",
null,[]);c.prototype.getBorderLineStyleProps=function(){var ca=b(938).BorderFormatManager.QYa,S=Array(Object.keys(ca).length),Y=0,na;for(na in ca){var Z=na,wa=ca[na];S[Y]=new k;S[Y].key=Z;Z=wa;S[Y].title=r.a.instance.ea(Z.XZb);S[Y].iconName=Z.vre;Y++}return S};Object(y.a)(c,"BorderMenuController",null,[619]);var G=b(308),w=b(91),B=b(169),U=b(12),N=b(117),P=b(24),ia=b(44),W=b(42),R=b(202),I=b(8),Q=b(105),O=b(20),ba=b(34);d.prototype.Rug=function(ca){l.ULS.sendTraceTag(537159517,0,50,"DrawBorderBehavior.ActivateBehavior : Starting ActivateBehavior ");
this.ha=O.g(this.$).ha;this.Nb=O.g(this.$).Nb;this.ribbonCommandInfo=ca;this.qFf=G.a.clone(this.ha.va.selectedRanges);this.oFf=this.ha.va.wA;this.gFf=this.ha.va.activeCell.clone();this.Nb&&this.Nb.Chd();this.Wu();this.ak()};d.prototype.dispose=function(){this.P_();this.DEb=this.ribbonCommandInfo=this.cellFormat=null};d.prototype.Vnb=function(ca){var S=b(938).BorderFormatManager;this.cellFormat={};var Y={};this.borderColor=this.borderColor||S.c4c;var na=x.a.HG(this.borderColor,!1);Y.Color=[na,na,na,
na];z.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ThemeColors",!1)&&this.RYa&&(Y.ThemeBorderColor=[this.RYa,this.RYa,this.RYa,this.RYa],Y.ColorTypeOption=1);na=b(938).BorderFormatManager.QYa;this.borderStyle=this.borderStyle||S.borderStyleSolidLine;S=na[this.borderStyle].ure;Y.LineStyle=[S,S,S,S];this.cellFormat.BorderFormat=Y;this.cellFormat.ValidMembers=128;this.cellFormat.Border=ca};d.prototype.Wu=function(){for(var ca=yl(O.g(this.$).jn),S=ca.next();!S.done;S=ca.next())B.a.instance.pa(U.a.pointerDown,
S.value.domElement,this.onPointerDown);N.KeyInputManager.instance.pa(U.a.Rb,document.documentElement,this.onKeyDown);N.KeyInputManager.instance.pa(U.a.Vd,document.documentElement,this.onKeyUp)};d.prototype.s0i=function(){for(var ca=yl(O.g(this.$).jn),S=ca.next();!S.done;S=ca.next())S=S.value,B.a.instance.pa(U.a.kh,S.domElement,this.Nj),B.a.instance.pa(U.a.Wd,S.domElement,this.Yg);B.a.instance.pa(U.a.Wd,document.documentElement,this.Yg);B.a.instance.pa(U.a.nz,document.documentElement,this.Yg);this.Ppc=
!0};d.prototype.Xs=function(){try{for(var ca=yl(O.g(this.$).jn),S=ca.next();!S.done;S=ca.next())B.a.instance.za(U.a.pointerDown,S.value.domElement,this.onPointerDown);N.KeyInputManager.instance.za(U.a.Rb,document.documentElement,this.onKeyDown);N.KeyInputManager.instance.za(U.a.Vd,document.documentElement,this.onKeyUp)}catch(Y){O.g(this.$).Xy=!1,l.ULS.sendTraceTag(537159514,0,10,"DrawBorderBehavior.UnregisterHandlers: Unregistering of Handlers failed with Exception {0}",Y)}};d.prototype.LUd=function(){if(this.Ppc)try{this.Ppc=
!1;for(var ca=yl(O.g(this.$).jn),S=ca.next();!S.done;S=ca.next()){var Y=S.value;B.a.instance.za(U.a.kh,Y.domElement,this.Nj);B.a.instance.za(U.a.Wd,Y.domElement,this.Yg)}B.a.instance.za(U.a.Wd,document.documentElement,this.Yg);B.a.instance.za(U.a.nz,document.documentElement,this.Yg)}catch(na){O.g(this.$).Xy=!1,l.ULS.sendTraceTag(537159513,0,10,"DrawBehavior.UnregisterDrawHandlersForMouse: Unregistering of Handlers failed with Exception {0}",na)}};d.prototype.ak=function(){this.$.xa.Pf(this.P_);O.g(this.$).Kc.wm(this.P_);
O.g(this.$).DD(this.P_);this.$.Ka.fmb(this.Jxa)};d.prototype.mm=function(){this.$.xa.rg(this.P_);O.g(this.$).Kc.im(this.P_);O.g(this.$).lF(this.P_);this.$.Ka.S$a(this.Jxa)};d.prototype.SPf=function(ca,S,Y){Y=void 0===Y?!1:Y;if(ca&&this.Pla&&this.Bya)for(ca=O.g(this.$).m$("DrawBorderBehavior.ApplyBordersOnPreviewCells",[ca]);ca.$$mn();){var na=ca.$$cu().cell.getRange();if(Y||!S.contains(na)||1===this.lta){na=na.toString();var Z=t.a.Ec(this.Pla,na);if(Z){var wa=t.a.Ec(this.Bya,na);this.setBorders(Z,
wa);delete this.Pla[na];delete this.Bya[na]}}}};d.prototype.setBorders=function(ca,S){var Y=ca.cell,na=Y.getRange();Y.ZKf();na.right!==this.R9a.right&&(Y=new P.Range(na.top,na.left-1,na.bottom,na.left-1,!0,!1),O.g(this.$).Ca.Mr(Y).OFd(3));na.bottom!==this.R9a.bottom&&(Y=new P.Range(na.top-1,na.left,na.top-1,na.right,!0,!1),O.g(this.$).Ca.Mr(Y).OFd(1));if(null===S||void 0===S?0:S.Borders.length){var Z={};Y=0;for(var wa=Array(4),ma=Array(4),pa=0;4>pa;pa++)wa[pa]=1,ma[pa]=0;S=yl(S.Borders);for(pa=S.next();!pa.done;pa=
S.next()){pa=pa.value;var Ia=pa.BorderPosition;wa[Ia]=pa.BorderLineStyle;var Ma=new R.a(pa.Color.Red,pa.Color.Green,pa.Color.Blue);ma[Ia]=Ma.z0();Y|=I.HelperMethods.wtb(pa.BorderPosition)}Z.LineStyle=wa;Z.Color=ma;Z={BorderFormat:Z};Z.Border=Y;this.hi.skj(ca,Z,na)}};d.prototype.c_b=function(ca){var S=this,Y=new P.Range(Math.max(1,ca.top-1),Math.max(1,ca.left-1),ca.bottom+1,ca.right+1,!1,!1);O.g(this.$).hka(Y)||this.Ar&&this.Ar.Qo||(this.Ar=ia.a.instance.create(function(){O.g(S.$).yt(Y,60,Q.a.ndh)},
40,W.a.odh))};d.prototype.bottomRightCorner=function(ca,S){return 1048576<=ca||16384<=S?!0:!1};d.prototype.Fe=function(ca){return ba.a(this.$).Fe(ca)};tl.Object.defineProperties(d.prototype,{z1h:{configurable:!0,enumerable:!0,get:function(){return this.n5d||(this.n5d=[1256700402,-1756763834,-1418159950,-236759591,-2118943501,1981159862,395594266,-1502853784,-111689794,-1059615499,-1027730316,-1104934572,1872288872,2045211913,1504715724,46555851,-70383382,-28797232])}}});Object(y.a)(d,"DrawBorderBehavior",
null,[3]);b.d(D,"BorderFormatManager",function(){return a});a.prototype.q2e=function(ca,S){l.ULS.sendTraceTag(537159564,0,50,"HandleBorderCommand : Begin handling, Command being executed: {0}",S.command.toString());var Y={},na={};var Z=x.a.HG(this.Y2,!1);na.Color=[Z,Z,Z,Z];this.qH&&this.Isa&&(na.ThemeBorderColor=[this.Isa,this.Isa,this.Isa,this.Isa],na.ColorTypeOption=1);ca=-600086683===S.command?"OutsideBorders":ca[m.a.hd];na.LineStyle=t.a.Ec(a.vEf,ca);na.LineStyle?l.ULS.sendTraceTag(537159562,0,
50,"RibbonCommand.Border is using the BorderFormat information, the predefined borderStyle requested is {0}",ca):(Z=a.QYa[this.eHa].ure,na.LineStyle=[Z,Z,Z,Z],l.ULS.sendTraceTag(537159563,0,50,"RibbonCommand.Border is using the BorderFormat information, the custom borderStyle requested is {0}",this.eHa));Z=t.a.Kn(a.tKg,ca,0);l.ULS.sendTraceTag(40732555,0,50,"RibbonCommand.Border is using the BorderFormat information, the border type requested is {0}, the border color selected is {1}",ca,this.Y2);
Y.BorderFormat=na;4!==Z&&8!==Z||!this.$.oa.displayRtl||(Z=4===Z?8:4);Y.ValidMembers=128;Y.Border=Z;this.hi.formatCells(-1690267012,Y,S);l.ULS.sendTraceTag(537159561,0,50,"HandleBorderCommand : Successfully handled, Command executed: {0}",S.command.toString());return!0};a.prototype.lgd=function(ca,S,Y){l.ULS.sendTraceTag(537159560,0,50,"RibbonCommand:{0} is being executed, the previous border color is {1}",ca.toString(),this.Y2);if(this.qH){if((S.SqmControlId||"").includes("ThemeColorPicker")){var na=
this.themesManager.getThemeColor(S.Color);var Z=na.themeIndex;var wa=na.AAa;na.returnValue?(this.MPb={},this.Isa.ThemeColorIndex=Z,this.Isa.ThemeColorRow=wa):this.MPb=null}else this.MPb=null;this.lU.RYa=this.Isa}this.A1d=-1803452024===ca?a.c4c:S.Color;this.lU.borderColor=this.Y2;this.iIe(Y);this.$.Gf();l.ULS.sendTraceTag(40944211,0,50,"RibbonCommand:{0} is being executed, the updated border color is {1}",ca.toString(),this.Y2);return!0};a.prototype.$Xh=function(ca){l.ULS.sendTraceTag(537159559,0,
50,"RibbonPopulateCommand.PopulateBorderStyle command Invoked");var S=this.Sa.zp(),Y=this.Sa.Lc();S.yc.push(Y);var na=this.Sa.iA("StyleDashGallery",1,"Size120by20");Y.buttons.push(na);Y=a.QYa;for(var Z in Y){var wa=Z,ma=Y[Z],pa=r.a.instance.ea(ma.XZb);na.ht(wa,-2118943501,"QueryBorderStyle",ma.XZb,wa,wa,void 0,void 0,pa)}l.ULS.sendTraceTag(537159557,0,50,"RibbonPopulateCommand, Invoke BuildMenuProps");ca.MenuItems=S.JB();l.ULS.sendTraceTag(537159556,0,50,"RibbonPopulateCommand handled")};a.prototype.CWh=
function(ca,S){l.ULS.sendTraceTag(537159555,0,50,"RibbonCommand.BorderStyle: Begin handling, Current Border Style is {0}",this.eHa);ca=ca[m.a.hd];if(a.Sgi(ca))this.B1d=ca,l.ULS.sendTraceTag(537159554,0,50,"RibbonCommand.BorderStyle: Updated Border Style is {0}",this.eHa);else return l.ULS.sendTraceTag(537159553,0,15,"RibbonCommand.BorderStyle: Invalid Border Style encountered, Requested Border Style : {0}",ca),!0;this.lU.borderStyle=this.eHa;this.iIe(S);this.$.Gf();l.ULS.sendTraceTag(40944220,0,50,
"RibbonCommand.BorderStyle: Successfully handled Current Border Style is {0}",this.eHa);return!0};a.prototype.qgd=function(ca){l.ULS.sendTraceTag(537159552,0,50,"HandleDrawBorderCommand : Begin handling, Command being executed: {0}",ca.command.toString());this.zRc(ca,64,this.Y2,86,1);return!0};a.prototype.rgd=function(ca){l.ULS.sendTraceTag(537159523,0,50,"HandleDrawBorderGridCommand : Begin handling, Command being executed: {0}",ca.command.toString());this.zRc(ca,112,this.Y2,87,2);return!0};a.prototype.F2e=
function(ca){l.ULS.sendTraceTag(537159522,0,50,"HandleEraseBorderCommand : Begin handling, Command being executed: {0}",ca.command.toString());this.zRc(ca,112,"white",88,3);return!0};a.prototype.cYh=function(ca){this.bjj(this.uKg,ca,ca.MenuItemId?ca.MenuItemId:a.borderStyleSolidLine)};a.prototype.bjj=function(ca,S,Y){Y in ca?(ca=ca[Y],l.ULS.sendTraceTag(537159521,0,50,"HandleQueryBorderStyleCommand:SetIcon command {0}",Y),this.djj(S,ca)):l.ULS.sendTraceTag(537159520,0,15,"HandleQueryBorderStyleCommand: cannot find dashes '{0}' in BorderLineStyleButtons dictionary",
Y)};a.prototype.nYh=function(ca,S){var Y=ca[m.a.hd];return"DrawBorder"===Y?this.qgd(S):"DrawBorderGrid"===Y?this.rgd(S):"EraseBorder"===Y?this.F2e(S):this.q2e(ca,S)};a.prototype.xKf=function(){this.WOb||this.zLg()};a.prototype.PDh=function(){return new c(this)};a.prototype.zLg=function(){this.WOb={};var ca=0,S=a.QYa,Y={},na;for(na in S){Y.gea=S[na];var Z=Y.gea.vre;r.a.instance.ea(Y.gea.XZb);var wa=function(ma){return function(){return appChrome.buildBorderStyleIconNew(ma.gea.Ayj,ma.gea.width,ma.gea.Bxi,
ma.gea.lineHeight,ma.gea.Eki)}}(Y);this.WOb[Z]=Z;this.D$a(Z,wa);ca++;Y={gea:Y.gea}}};a.prototype.D$a=function(ca,S){if(!(ca in this.gF)){var Y={};S=S();Y[ca]=S;appChrome.api.registerIconProvider(function(){return Y});this.gF[ca]=!0}return ca};a.prototype.djj=function(ca,S){ca.MenuItemId&&(ca[f.a.On]=ca.MenuItemId===this.eHa,ca[u.a.Icon]=S)};a.prototype.zRc=function(ca,S,Y,na,Z){l.ULS.sendTraceTag(537159519,0,50,"BorderFormatManager.ActivateDrawBorderBehavior : Starting ActivateDrawBorderBehavior ");
this.qSg(ca,Z)?(l.ULS.sendTraceTag(537159518,0,50,"BorderFormatManager.CheckDrawBorderBehaviorTriggered : Toggled Ribbon menu button "),this.lU.P_()):(O.g(this.$).Xy&&this.lU.P_(),A.a.current&&(na=String.format(v.a.Nsa,A.a.current.eo(na)),O.g(this.$).Bh.Rt(na)),this.lU.ZZb=S,this.lU.borderColor=Y,O.g(this.$).Xy=!0,this.lU.Rug(ca),this.lU.lta=Z)};a.prototype.iIe=function(ca){if(ca)switch(this.lU.lta){case 2:this.rgd(ca);break;default:this.qgd(ca)}};a.prototype.qSg=function(ca,S){return this.lU.lta===
S&&-236759591!==ca.command&&-2118943501!==ca.command?!0:!1};a.Sgi=function(ca){return ca?ca in a.vEf||ca in a.QYa:!1};tl.Object.defineProperties(a.prototype,{eHa:{configurable:!0,enumerable:!0,get:function(){return this.B1d}},Y2:{configurable:!0,enumerable:!0,get:function(){return this.A1d}},Isa:{configurable:!0,enumerable:!0,get:function(){return this.MPb}},themesManager:{configurable:!0,enumerable:!0,get:function(){this.zB||(this.zB=this.$.da.Aa(422));return this.zB}},uKg:{configurable:!0,enumerable:!0,
get:function(){this.xKf();return this.WOb}}});tl.Object.defineProperties(a,{QYa:{configurable:!0,enumerable:!0,get:function(){var ca={};return a.C_d||(a.C_d=(ca.BorderStyleSolidLine=n.xLg(),ca.BorderStyleDashedLine=n.tLg(),ca.BorderStyleDottedLine=n.uLg(),ca.BorderStyleMediumLine=n.wLg(),ca.BorderStyleThickLine=n.yLg(),ca.BorderStyleDoubleLine=n.vLg(),ca))}},tKg:{configurable:!0,enumerable:!0,get:function(){var ca={};return a.B_d||(a.B_d=(ca.NoBorder=0,ca.BottomBorder=1,ca.TopBorder=2,ca.LeftBorder=
4,ca.RightBorder=8,ca.OutsideBorders=64,ca.AllBorders=112,ca.ThickOutsideBorders=64,ca.InsideBorders=48,ca.InsideHorizontalBorders=16,ca.InsideVerticalBorders=32,ca.BottomDoubleBorder=1,ca.ThickBottomBorder=1,ca.TopBottomBorder=3,ca.TopThickBottomBorder=3,ca.TopDoubleBottomBorder=3,ca))}},vEf:{configurable:!0,enumerable:!0,get:function(){var ca={};return a.ibe||(a.ibe=(ca.ThickOutsideBorders=[2,2,2,2],ca.BottomDoubleBorder=[1,6,1,1],ca.ThickBottomBorder=[1,2,1,1],ca.TopBottomBorder=a.K8g,ca.TopThickBottomBorder=
[1,2,1,1],ca.TopDoubleBottomBorder=[1,6,1,1],ca))}}});a.B_d=null;a.C_d=null;a.ibe=null;a.c4c="black";a.borderStyleSolidLine="BorderStyleSolidLine";a.K8g=[1,1,1,1];Object(y.a)(a,"BorderFormatManager",null,[586])},976:function(y,D,b){function a(G,w,B){window.performance.measure(G,w,B);w=window.performance.getEntriesByName(G);w.length||v.ULS.sendTraceTag(537167063,0,10,"ContextMenuHelper.MeasureTime: measure name [{0}] returned no measures.",G);return w[w.length-1]?w[w.length-1].duration:-1}function d(){if(m.a.Snb){var G=
a("OnContextMenuHandling","ContextMenuPerf.A","ContextMenuPerf.B"),w=a("PrepInfraWork","ContextMenuPerf.B","ContextMenuPerf.C1"),B=a("EWAPopulation","ContextMenuPerf.C2","ContextMenuPerf.D");v.ULS.sendTraceTag(537167064,0,50,"ContextMenuHelper.ReportPerformanceIfSupported: OnContextMenuHandling=[{0}], PrepInfraWork=[{1}], EWAPopulation =[{2}]",G,w,B)}}function c(G,w){z.HelperMethods.MWc&&window.performance.mark(w)}function k(G){G=r.g(G).ha.va;return G.Dh&&(G.Qd.isRow||G.Qd.Lh)}function n(G){return G.Vb.S4(G.ha.va.activeCell)}
function l(G,w,B,U,N){G=U.sl("ContextMenuHelper.FindFirstCellInViewportArea",G,w,B);try{for(G.$$rst();G.$$mn();){var P=G.$$cu();if(P&&f(P,U,N))return P.cell}}finally{G&&G.dispose()}return null}function f(G,w,B){var U=w.rtl,N=B.isChromeRtl;G=G.cell;return(B=r.g(B).BJ(G))?(B=B.topLeft,U=B.x+=U===N?G.offsetWidth:0,N=B.y+=G.offsetHeight,w.view.visibleArea.contains(new x.a(U,N,0,0))):!1}function u(G,w){var B=G.sc(null);if((null===B||void 0===B?0:B.cell.tk)&&f(B,G,w))return G.getCellBounds(B.cell);B=G.ha.va.activeCell;
return(w=l(new t.Range(B.top,B.left,A.a.Fh,B.left,!1,!1),2,!0,G,w)||l(new t.Range(1,B.left,B.top,B.left,!1,!1),2,!1,G,w)||l(new t.Range(B.top,B.right,B.top,A.a.Qh,!1,!1),1,!0,G,w)||l(new t.Range(B.top,1,B.top,B.right,!1,!1),1,!1,G,w)||null)&&w.tk?G.getCellBounds(w):Sys.UI.DomElement.getBounds(G.Ivb.Jb)}b.d(D,"i",function(){return"ContextMenuPerf.A"});b.d(D,"b",function(){return"ContextMenuPerf.B"});b.d(D,"d",function(){return"ContextMenuPerf.C1"});b.d(D,"a",function(){return"ContextMenuPerf.C2"});
b.d(D,"c",function(){return"ContextMenuPerf.D"});b.d(D,"e",function(){return u});b.d(D,"f",function(){return n});b.d(D,"g",function(){return k});b.d(D,"h",function(){return c});b.d(D,"j",function(){return d});var v=b(13),m=b(315),A=b(9),x=b(58),t=b(24),z=b(8),r=b(20)},977:function(y,D,b){function a(){}b.d(D,"a",function(){return a});y=b(0);a.edit="Edit";a.clipboard="Clipboard";a.copy="Copy";a.color="Color";a.uIg="AutoFill";a.ebj="RowOperations";a.BVg="ColumnOperations";a.jOj="ViewModeRowOperations";
a.iOj="ViewModeColumnOperations";a.hyperlink="Hyperlink";a.openHyperlink="OpenHyperlink";a.onj="ShapeStyle";a.Owh="FloatingObjectClipboard";a.vDf="PivotTableCopyDelete";a.xDf="PivotTableFieldListActions";a.Cue="CellFloatie";a.knj="ShapeFloatie";a.contextMenu="ContextMenu";a.MVh="GridContextMenu";a.TQi="PivotTableContextMenu";a.Pwh="FloatingObjectContextMenu";a.vRg="CellRTEFloatie";a.RXf="ShapeRTEFloatie";Object(y.a)(a,"FloatieGroupIdentifiers",null,[])},978:function(y,D,b){function a(m,A,x){var t=
v.call(this,A)||this;t.LQ=!1;t.Xhc=!1;t.JMa=null;t._selectedRowListBox=null;t.An=null;t.tvf=function(z){return t.Glc(z)};t.ryd=function(z){f.g(z.Ea);t.raiseEvent(a.m3a);t.raiseEvent(a.HLd);return!0};t.onScroll=function(z){f.g(z);t.FDd();t.raiseEvent(a.m3a)};t.onBlur=function(z){f.g(z);t.FDd()};t.onPointerDown=function(){t.FDd();t.raiseEvent(a.m3a);t.raiseEvent(a.FOa);return!1};t.rCb=function(z){var r=z.Ea;r.button&&r.button!==Sys.UI.MouseButton.rightButton||(t.Nk=t.K9b(r),t.onPointerDown(z));t.raiseEvent(a.ypd);
return!1};t.vb=m;t.Ozb=x;t.oAa(!0);return t}b.d(D,"a",function(){return a});y=b(0);var d=b(88),c=b(276),k=b(12),n=b(169);D=b(232);var l=b(11),f=b(69),u=b(20),v=D.a;vm(a,v);a.prototype.k9=function(m){this.get_events().addHandler(a.m3a,m)};a.prototype.Kca=function(m){this.get_events().removeHandler(a.m3a,m)};a.prototype.IXb=function(m){this.get_events().addHandler(a.yid,m)};a.prototype.Hqc=function(m){this.get_events().removeHandler(a.yid,m)};a.prototype.tmb=function(m){this.get_events().addHandler(a.HLd,
m)};a.prototype.qGb=function(m){this.get_events().removeHandler(a.HLd,m)};a.prototype.HXa=function(m){this.get_events().addHandler(a.FOa,m)};a.prototype.Z$a=function(m){this.get_events().removeHandler(a.FOa,m)};a.prototype.lTc=function(m){this.get_events().addHandler(a.ypd,m)};a.prototype.QGd=function(m){this.get_events().removeHandler(a.ypd,m)};a.prototype.dispose=function(){this.e7(!1);this.oAa(!1);d.a.pc([this.JMa]);this.JMa=null;v.prototype.dispose.call(this)};a.prototype.K9b=function(m){return l.DOMElementExtensions.vcd(m.target,
"tr",!0)};a.prototype.MA=function(m){if(m){if(!this.Nk){var A=this.An;if(!A||!A.rows.length)return;this.Nk=A.rows[0];0<m?m--:m++}A=this.Nk;for(var x=0,t=Math.abs(m);x<t;x++)if(0>m){if(!A.previousSibling)break;A=A.previousSibling}else{if(!A.nextSibling)break;A=A.nextSibling}A&&(this.Nk=A)}};a.prototype.Ylb=function(m,A){l.DOMElementExtensions.toggleCssClass(m,this.Ozb.ListTableClassInTouch,A)};a.prototype.e7=function(m){var A=this.An;A&&(m&&!this.Xhc?(c.a.instance.pa(k.a.click,A,this.tvf),c.a.instance.pa(k.a.Ij,
A,this.ryd),n.a.instance.pa(k.a.pointerDown,A,this.rCb),this.Xhc=!0):this.Xhc&&(c.a.instance.za(k.a.click,A,this.tvf),c.a.instance.za(k.a.Ij,A,this.ryd),n.a.instance.za(k.a.pointerDown,A,this.rCb),this.Xhc=!1))};a.prototype.GAa=function(m){var A=null;m&&(A=l.DOMElementExtensions.vj(m,this.Ozb.ListCellClass))&&A.classList.toggle(this.Ozb.ListCellSelectedClass);return A};a.prototype.oAa=function(m){this.dg&&(m&&!this.LQ?(this.JMa=this.Nd.Cd(this.dg),this.JMa.ja("scroll",this.onScroll),this.JMa.ja("blur",
this.onBlur),n.a.instance.pa(k.a.pointerDown,this.domElement,this.onPointerDown),this.LQ=!0):this.LQ&&(d.a.Fa(this.JMa),this.JMa=null,n.a.instance.za(k.a.pointerDown,this.domElement,this.onPointerDown),this.LQ=!1))};a.prototype.Glc=function(m){return this.ryd(m)};a.prototype.Lsc=function(m){if(m){var A=m.offsetTop,x=this.dg.scrollTop;A<x?this.GSf(!0):A+m.offsetHeight>x+this.dg.clientHeight&&this.GSf(!1)}};a.prototype.GSf=function(m){this.dg.scrollTop=m?this.Nk.offsetTop:this.Nk.offsetTop+this.Nk.offsetHeight-
this.dg.clientHeight};a.prototype.FDd=function(){u.g(this.$).isEditing&&this.raiseEvent(a.yid)};tl.Object.defineProperties(a.prototype,{Nk:{configurable:!0,enumerable:!0,get:function(){return this._selectedRowListBox},set:function(m){this.GAa(this._selectedRowListBox);m?(this._selectedRowListBox=m,this.GAa(this._selectedRowListBox),this.Lsc(m)):this._selectedRowListBox=null}},RZ:{configurable:!0,enumerable:!0,get:function(){return this.Ozb.ListCellClass}},rba:{configurable:!0,enumerable:!0,get:function(){return this.Ozb.ListTableClass}},
xH:{configurable:!0,enumerable:!0,get:function(){return 8}},BAb:{configurable:!0,enumerable:!0,get:function(){return 5}},Vhc:{configurable:!0,enumerable:!0,get:function(){return 24}},Uhc:{configurable:!0,enumerable:!0,get:function(){return 35}},dg:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},$:{configurable:!0,enumerable:!0,get:function(){return this.vb}}});a.m3a="GotFocus";a.yid="IgnoreBlur";a.HLd="SetCell";a.FOa="PointerDown";a.ypd="ItemPointerDown";Object(y.a)(a,"ListBox",
D.a,[648,3])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.kpae.js.map/3f89f89313bebdfe087367048be33041/EwaDS.kpae.js.map