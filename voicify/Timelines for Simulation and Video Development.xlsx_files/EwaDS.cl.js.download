(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[6],{1024:function(y,D,b){function a(){this.dfe=!1;this.$Mc=null;this.z1d=0;this.nGc=this.yCe();this.xPb=this.yCe();this.lCa=this.RUa=0;this.Sv=function(){return new Date}}b.d(D,"a",function(){return a});y=b(0);a.prototype.yCe=function(){for(var d=Array(6),c=0;c<d.length;c++)d[c]=0;return d};a.prototype.RIh=function(){return this.nGc.toString()};a.prototype.IFh=function(){return this.xPb.toString()};a.prototype.ixj=function(){this.$Mc=
this.Sv()};a.prototype.sFb=function(d,c,k){if(!this.Zyj){if(void 0===k?0:k)this.dfe=!0;k=this.Sv();!d&&5<this.RUa||1===d&&5<this.lCa||(this.z1d<d?(1===this.RUa%2&&(this.nGc[this.RUa]=-1,this.RUa++),this.z1d=d,1===c&&(this.xPb[this.lCa]=-1,this.lCa++),this.xPb[this.lCa]=this.kRd(k),this.lCa++):d?(this.xPb[this.lCa]=this.kRd(k),this.lCa++):(this.nGc[this.RUa]=this.kRd(k),this.RUa++))}};a.prototype.kRd=function(d){var c=d.getTime()-this.$Mc.getTime();this.$Mc=d;return c};tl.Object.defineProperties(a.prototype,
{Zyj:{configurable:!0,enumerable:!0,get:function(){return this.dfe}}});tl.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){a.Na||(a.Na=new a);return a.Na},set:function(d){a.Na=d}}});a.Na=null;Object(y.a)(a,"LatencyMetrics",null,[])},1075:function(y,D,b){function a(u){this.Pye=this.DQe=null;this.Mlf=this.tSe=0;this.jp=null;this.W8d=this.TKc=0;this.Og=u;this.W4h();this.YFc=this.V3d=this.pLc=!1;this.KKc=0}y=b(0);var d=b(13),c=b(80),k=b(110),n;(function(u){u[u.SendNotification=
0]="SendNotification";u[u.SendPersistentState=1]="SendPersistentState";u[u.FindSession=2]="FindSession";u[u.Last=3]="Last"})(n||(n={}));Object(y.b)("ApiType",n);var l;(function(u){u[u.AttemptCount=0]="AttemptCount";u[u.SuccessCount=1]="SuccessCount";u[u.DropCount=2]="DropCount";u[u.FailedCount=3]="FailedCount";u[u.LatencyOverThresholdCount=4]="LatencyOverThresholdCount";u[u.LatencyUnderThresholdCount=5]="LatencyUnderThresholdCount";u[u.ThrottledCount=6]="ThrottledCount";u[u.Last=7]="Last"})(l||(l=
{}));Object(y.b)("EventCountType",l);var f=b(1024);b.d(D,"a",function(){return a});a.prototype.gxj=function(u){this.W8d=u;window.setInterval(Object(c.a)(this,this.Zrd,"logMetricsBatchAndReset"),u);this.TKc=(new Date).getTime()};a.prototype.yx=function(u,v){this.soj(u)&&!this.V3d||this.xsh||!window.navigator.onLine||this.Og.w5a||(this.jp[u][v]++,this.pLc=!0)};a.prototype.W4h=function(){this.jp=Array(3);for(var u=0;3>u;u++){this.jp[u]=Array(7);for(var v=0;7>v;v++)this.jp[u][v]=0}};a.prototype.uMg=function(){for(var u=
{},v=0;3>v;v++)for(var m=0;7>m;m++)this.Wgi(v,m)&&(u[n[v]+l[m]]=this.jp[v][m]);u.FSDomain=this.DQe;u.ConnectionDomain=this.Pye;u.FSRetryInterval=this.tSe;u.MaxPayloadSize=this.Mlf;u.LogNumber=this.KKc;1===this.KKc&&(u.FSLatencies=f.a.instance.RIh(),u.ConLatencies=f.a.instance.IFh());return u};a.prototype.Wgi=function(u,v){return 2===u&&3!==v&&v?!1:!0};a.prototype.soj=function(u){return 2===u?!1:!0};a.prototype.Zrd=function(){if(this.pLc){this.KKc++;if((new Date).getTime()-this.TKc<5E3+this.W8d){var u=
k.a.toJSON(this.uMg());d.ULS.sendTraceTag(50644352,500,15,u)}this.TKc=(new Date).getTime();for(u=0;3>u;u++)for(var v=0;7>v;v++)this.jp[u][v]=0;this.pLc=!1}};a.prototype.Lqi=function(){this.V3d=!0};a.create=function(u){a.instance||(a.Na=new a(u));return a.instance};tl.Object.defineProperties(a.prototype,{xsh:{configurable:!0,enumerable:!0,get:function(){return this.YFc}}});tl.Object.defineProperties(a,{instance:{configurable:!0,enumerable:!0,get:function(){return a.Na}}});a.Na=null;Object(y.a)(a,"FrequentLoggingMetrics",
null,[144])},1137:function(y,D,b){b.d(D,"a",function(){return a});y=b(0);var a;(function(d){d[d.disconnected=0]="disconnected";d[d.connecting=1]="connecting";d[d.connected=2]="connected"})(a||(a={}));Object(y.b)("ChannelConnectionState",a)},1138:function(y,D,b){function a(c,k,n,l){var f=d.call(this)||this;f.type=c;f.v7=k;f.L9g=n;f.Fda=l;return f}b.d(D,"a",function(){return a});y=b(0);var d=Sys.EventArgs;vm(a,d);Object(y.a)(a,"SendUpdateNotificationEventArgs",Sys.EventArgs,[])},1139:function(y,D,b){function a(){}
b.d(D,"a",function(){return a});y=b(0);a.AJd="rr";a.lbj="rd";a.jbj="rbp";a.SKd="sa";Object(y.a)(a,"RtcReconnectParams",null,[])},1140:function(y,D,b){function a(d,c,k,n){this.Dsi=d;this.CAa=c;this.zri=k;this.wVh=n}b.d(D,"a",function(){return a});y=b(0);Object(y.a)(a,"ThrottlerManagerSettings",null,[])},1232:function(y,D,b){function a(){this.Ya=new na.a}function d(Z,wa){var ma=Y.call(this)||this;ma.type=Z;ma.$Lj=wa;return ma}function c(Z){var wa=S.call(this)||this;wa.XZc=Z;return wa}function k(Z,wa){var ma=
ca.call(this)||this;ma.JRj=Z;ma.nSj=wa;return ma}function n(Z,wa,ma){var pa=O.call(this)||this;pa.type=Z;pa.presence=wa;pa.Fda=ma;return pa}function l(Z,wa){var ma=Q.call(this)||this;ma.TRj=Z;ma.errorMessage=wa;return ma}function f(Z){var wa=I.call(this)||this;wa.hubConnection=Z;return wa}function u(Z,wa,ma,pa,Ia,Ma){var ob=R.call(this)||this;ob.seb=Z;ob.u0c=wa;ob.OXg=ma;ob.BOe=Ia;ob.AZc=pa;ob.stopwatch=Ma;return ob}function v(Z){var wa=W.call(this)||this;wa.FSj=Z;return wa}function m(Z,wa){wa=void 0===
wa?null:wa;var ma=ia.call(this)||this;ma.AB=Z;ma.Atg=wa;return ma}function A(Z,wa){var ma=N.call(this)||this;ma.type=Z;ma.iO=wa;return ma}function x(Z){var wa=U.call(this)||this;wa.XZc=Z;return wa}function t(Z){var wa=B.call(this)||this;wa.presence=Z;return wa}function z(Z,wa){var ma=w.call(this)||this;ma.pUg=Z;ma.Fda=wa;return ma}function r(Z,wa){var ma=G.call(this)||this;ma.newState=Z;ma.oldState=wa;return ma}y=b(0);var G=Sys.EventArgs;vm(r,G);Object(y.a)(r,"ChangedConnectionStateEventArgs",Sys.EventArgs,
[]);var w=Sys.EventArgs;vm(z,w);Object(y.a)(z,"ClientInfoEventArgs",Sys.EventArgs,[]);var B=Sys.EventArgs;vm(t,B);Object(y.a)(t,"MyPresenceUpdatedEventArgs",Sys.EventArgs,[]);var U=Sys.EventArgs;vm(x,U);Object(y.a)(x,"PersistentStateClearedEventArgs",Sys.EventArgs,[]);var N=Sys.EventArgs;vm(A,N);Object(y.a)(A,"PersistentStateUpdateEventArgs",Sys.EventArgs,[]);var P=b(1298),ia=Sys.EventArgs;vm(m,ia);tl.Object.defineProperties(m.prototype,{type:{configurable:!0,enumerable:!0,get:function(){return this.AB}},
v7:{configurable:!0,enumerable:!0,get:function(){return this.Atg}}});Object(y.a)(m,"UpdateNotificationEventArgs",Sys.EventArgs,[]);var W=Sys.EventArgs;vm(v,W);Object(y.a)(v,"GotCompletePersistentStateWithMetadataEventArgs",Sys.EventArgs,[]);var R=Sys.EventArgs;vm(u,R);Object(y.a)(u,"RefreshAllPersistentStateEventArgs",Sys.EventArgs,[]);var I=Sys.EventArgs;vm(f,I);Object(y.a)(f,"RefreshProxyEventArgs",Sys.EventArgs,[]);var Q=Sys.EventArgs;vm(l,Q);Object(y.a)(l,"RtcConnectFailedEventArgs",Sys.EventArgs,
[]);var O=Sys.EventArgs;vm(n,O);Object(y.a)(n,"SendPersistentStateEventArgs",Sys.EventArgs,[]);var ba=b(1138),ca=Sys.EventArgs;vm(k,ca);Object(y.a)(k,"SessionPropertiesChangedEventArgs",Sys.EventArgs,[]);var S=Sys.EventArgs;vm(c,S);Object(y.a)(c,"UpdatePersistentStateClearedRequestEventArgs",Sys.EventArgs,[]);var Y=Sys.EventArgs;vm(d,Y);Object(y.a)(d,"UpdatePersistentStateRequestEventArgs",Sys.EventArgs,[]);var na=b(94);b.d(D,"a",function(){return a});a.prototype.KWi=function(Z,wa){this.Ya.raiseEvent("CSC",
new r(Z,wa))};a.prototype.uXi=function(Z){this.Ya.raiseEvent("RP",new f(Z))};a.prototype.hpc=function(Z){this.Ya.raiseEvent("RC",Z)};a.prototype.wXi=function(){this.Ya.raiseEvent("RMID")};a.prototype.tXi=function(Z,wa,ma,pa,Ia,Ma){this.Ya.raiseEvent("RPS",new u(Z,wa,ma,pa,Ia,Ma))};a.prototype.SHf=function(Z,wa){this.Ya.raiseEvent("UPSR",new d(Z,wa))};a.prototype.CHf=function(Z,wa){this.Ya.raiseEvent("PU",new P.a(Z,wa))};a.prototype.iXi=function(Z){this.Ya.raiseEvent("MPU",new t(Z))};a.prototype.MDd=
function(Z,wa,ma,pa){this.Ya.raiseEvent("SUN",new ba.a(Z,wa,ma,pa))};a.prototype.JXi=function(Z,wa){this.Ya.raiseEvent("UNR",new m(Z,wa))};a.prototype.KHf=function(Z,wa,ma){this.Ya.raiseEvent("SP",new n(Z,wa,ma))};a.prototype.qXi=function(Z,wa){this.Ya.raiseEvent("PSU",new A(Z,wa))};a.prototype.pXi=function(Z){this.Ya.raiseEvent("PSC",new x(Z))};a.prototype.eXi=function(Z){this.Ya.raiseEvent("IPSC",new x(Z))};a.prototype.KXi=function(Z){this.Ya.raiseEvent("UPSC",new c(Z))};a.prototype.zXi=function(Z,
wa){this.Ya.raiseEvent("SPC",new k(Z,wa))};a.prototype.HHf=function(Z,wa){this.Ya.raiseEvent("RCF",new l(Z,wa))};a.prototype.ZWi=function(Z){this.Ya.raiseEvent("CPSWM",new v(Z))};a.prototype.IXi=function(Z,wa){this.Ya.raiseEvent("UCI",new z(Z,wa))};a.prototype.BXa=function(Z){this.Ya.addHandler("CSC",Z)};a.prototype.yqc=function(Z){this.Ya.removeHandler("CSC",Z)};a.prototype.cCg=function(Z){this.Ya.addHandler("RP",Z)};a.prototype.bCg=function(Z){this.Ya.addHandler("RC",Z)};a.prototype.gCg=function(Z){this.Ya.addHandler("RMID",
Z)};a.prototype.aCg=function(Z){this.Ya.addHandler("RPS",Z)};a.prototype.TCg=function(Z){this.Ya.addHandler("UPSR",Z)};a.prototype.fFa=function(Z){this.Ya.addHandler("PU",Z)};a.prototype.dza=function(Z){this.Ya.removeHandler("PU",Z)};a.prototype.MAg=function(Z){this.Ya.addHandler("IPU",Z)};a.prototype.RCg=function(Z){this.Ya.addHandler("UCI",Z)};a.prototype.tCg=function(Z){this.Ya.addHandler("SUN",Z)};a.prototype.NAg=function(Z){this.Ya.addHandler("IUNR",Z)};a.prototype.IXa=function(Z){this.Ya.addHandler("UNR",
Z)};a.prototype.sGb=function(Z){this.Ya.removeHandler("UNR",Z)};a.prototype.LAg=function(Z){this.Ya.addHandler("IPSU",Z)};a.prototype.KAg=function(Z){this.Ya.addHandler("IPSC",Z)};a.prototype.SCg=function(Z){this.Ya.addHandler("UPSC",Z)};a.prototype.sCg=function(Z){this.Ya.addHandler("SP",Z)};a.prototype.vCg=function(Z){this.Ya.addHandler("SPC",Z)};a.getInstance=function(){return a.Na||(a.Na=new a)};a.Na=null;Object(y.a)(a,"RtcEventHub",null,[174])},1236:function(y,D,b){function a(Q,O,ba,ca,S,Y,na,
Z,wa,ma,pa,Ia,Ma){var ob=this;Ma=void 0===Ma?null:Ma;this.T7d=(new Date(0)).getTime();this.a9d=0;this.qSb=!1;this.Ode=null;this.XEd=36E5;this.nUa=a.N7e;this.Zgb=0;this.OPa=null;this.Yca=0;this.Mab=this.Qye=null;this.pqg=[u.eyb,u.errorMessage,u.L0f,u.SB,u.k6,u.H1e,u.q7a,u.CAa,u.u7a];this.oqg=[u.eyb,u.errorMessage];this.SB=this.Zic=null;this.R3d=new n(pa?pa:function(){return t.AFrameworkApplication.hj},S,Y,na,Q,O);this.Mfb=Ia;this.uh=ca;this.Og=O;this.mkg=ba;this.Ll=Z;this.eh=wa;this.ihb=Ma;this.S3d=
!1;this.a8b=9E4;ma&&ma.execute(function(Cb){Cb.OXb(function(){v.ULS.sendTraceTag(40768456,500,50,"Connection parameters refresh requested for client [{0}]",ob.Ll);ob.R3d.WJf()})});2>=100*Math.random()&&(this.XEd=3E5);P.a.instance&&(P.a.instance.tSe=this.XEd)}function d(){}function c(){}function k(){}function n(Q,O,ba,ca,S,Y){this.$Da=null;var na=b(1236).FindSessionStrategy;this.Lpg=Q;Q=String.format("{0}={1}",l.clientId,U.a.pf(ca));Q=String.format("{0}&{1}={2}",Q,l.userSessionId,U.a.pf(S));Q=String.format("{0}&{1}={2}",
Q,l.vMj,U.a.pf(ba.toString()));Q=String.format("{0}&{1}={2}",Q,l.userType,U.a.pf("1"));Q=String.format("{0}&{1}={2}",Q,l.OMj,U.a.pf(O));Q=String.format("{0}&{1}={2}",Q,l.tUg,U.a.pf(na.rUg));(O=n.jDh(ba,Y))&&(Q=String.format("{0}&{1}",Q,O));this.tig=Q}function l(){}function f(){this.I1e=this.Klf=this.Llf=this.Plf=0;this.igc=!1;this.correlationId=this.SB=this.k6=this.v0c=this.errorMessage=null}function u(){}b.r(D);y=b(0);var v=b(13),m=b(80),A=b(185),x=b(1137);u.u7a="throttling_messageDelay";u.eyb="enabled";
u.CAa="throttling_timeToWaitForResponse";u.q7a="throttling_maxNumberOfOutstandingMessages";u.H1e="throttling_globalMaxNumberOfOutstandingMessages";u.errorMessage="errorMessage";u.L0f="url";u.k6="queryString";u.SB="connectionString";Object(y.a)(u,"RtcFindSessionOutputFieldNameConstants",null,[]);var t=b(5),z=b(77),r=b(47),G=b(416),w=b(807),B=b(110),U=b(28),N=b(179);tl.Object.defineProperties(f.prototype,{YWg:{configurable:!0,enumerable:!0,get:function(){return this.v0c+"?"+this.k6}}});Object(y.a)(f,
"FindSessionResponse",null,[]);l.clientId="ClientId";l.vMj="UserApp";l.userSessionId="usid";l.userType="UserType";l.OMj="UserVersion";l.Zoc="qs";l.tUg="clientProtocol";l.Dvi="NoAuth";Object(y.a)(l,"RtcFindSessionInputQueryParamConstants",null,[]);n.prototype.WJf=function(){this.$Da=this.Lpg()};n.prototype.Dad=function(){this.$Da&&""!==this.$Da||(this.WJf(),v.ULS.sendTraceTag(575784194,500,this.$Da&&""!==this.$Da?50:15,"Query signature delegate called for refresh returned: {0} ",this.$Da));var Q=String.format("{0}={1}",
l.Zoc,U.a.pf(this.$Da));return String.format("{0}&{1}",Q,this.tig)};n.jDh=function(Q,O){return 4===Q?String.format("{0}={1}",l.Dvi,"1"):O?O.iUh():null};Object(y.a)(n,"FindSessionQueryStringGenerator",null,[]);var P=b(1075),ia=b(1024),W=b(840),R=b(1140);k.Ovh="FSType";Object(y.a)(k,"RtcFindSessionRequestHeaders",null,[]);c.gZi="polling";Object(y.a)(c,"RtcFindSessionTypes",null,[]);var I=b(1139);d.CNj="RTC-TokenProofkey";d.mhi="RTC-IsWacJsBootFsRequest";Object(y.a)(d,"RtcRequestHeaders",null,[]);b.d(D,
"FindSessionStrategy",function(){return a});a.prototype.Ykj=function(Q){this.Mab=Q};a.prototype.init=function(){this.eh.gCg(Object(m.a)(this,this.B9i,"resetGetMachineIdDelay"));this.eh.BXa(Object(m.a)(this,this.HV,"onConnectionStateChanged"))};a.prototype.HV=function(Q,O){this.Yca=O.newState;2===O.newState&&(this.Zgb=0)};a.prototype.yWe=function(){var Q=this.OPa.correlationId;return{returnValue:String.format("{0}&{1}={2}",this.OPa.k6,a.Sze,U.a.pf(Q)),correlationId:Q}};a.prototype.zQh=function(Q,O,
ba,ca,S){var Y=this;this.mfj(function(){ca(S,"GetMachineIdSuccess")&&(v.ULS.sendTraceTag(17956951,500,50,"Successfully retrieved Rtc MachineId [{0}] for [{1}]",Y.SB,Y.Ll),Q(Y.Ode),ba(Y.bTh()))},function(na){ca(S,"GetMachineIdFailure")&&(v.ULS.sendTraceTag(4060129,500,15,"Failed to retrieve Rtc MachineId for [{0}]",Y.Ll),O(na))},ca,S)};a.prototype.Lbh=function(){this.iwe();this.e2h()};a.prototype.mfj=function(Q,O,ba,ca){var S=this;v.ULS.sendTraceTag(17956952,500,50,"Retrieving Rtc MachineId from server. Getting from last findsession, connectionString is [{0}]",
this.SB);if(this.SB)Q();else{var Y=this.ePg();window.setTimeout(function(){S.sendFindSessionRequestToServerInternal(Q,O,ba,ca)},Y)}};a.prototype.sendFindSessionRequestToServerInternal=function(Q,O,ba,ca){var S=this;ba(ca,"RequestMachineId")&&(this.T7d=(new Date).getTime(),ba=r.a.se(),this.zWe(function(Y){var na=r.a.se();S.DCf(Y);S.rMd();Q();Y=r.a.se()-na;v.ULS.sendTraceTag(577356039,345,50,"SFSRTS Success - TimeElapsed: {0}",Y)},function(Y){var na=r.a.se();S.iwe();P.a.instance&&P.a.instance.yx(2,
3);O(Y);Y=r.a.se()-na;v.ULS.sendTraceTag(577356040,345,50,"SFSRTS Failure - TimeElapsed: {0}",Y)},!1),ba=r.a.se()-ba,v.ULS.sendTraceTag(577599296,345,50,"SFSRTS - TimeElapsed: {0}",ba))};a.prototype.e2h=function(){this.nUa+=a.fMh;this.nUa=Math.min(this.nUa,a.kri)};a.prototype.ePg=function(){var Q=(new Date).getTime();Q=this.T7d+this.nUa-Q;0>Q&&(Q=0);return Q};a.prototype.DCf=function(Q){try{this.OPa=Q,this.Zic=Q.YWg,this.SB=Q.SB,this.Qye=Q.k6,this.Ode=Q.v0c}catch(O){v.ULS.sendTraceTag(17956953,500,
10,"FindSession response contains invalid fields. Exception {0}, is thrown",O.toString())}};a.prototype.iwe=function(){this.SB=null;this.jwe()};a.prototype.rMd=function(){this.jwe();this.qSb=!0;this.a9d=window.setTimeout(Object(m.a)(this,this.R_i,"refreshMachineId"),this.XEd)};a.prototype.jwe=function(){this.qSb&&(window.clearTimeout(this.a9d),this.qSb=!1)};a.prototype.R_i=function(){var Q=this;this.qSb=!1;this.zWe(function(O){var ba=Q.Qye!==O.k6,ca=Q.SB!==O.SB,S=Q.SB;Q.DCf(O);Q.Yca&&(ca?(v.ULS.sendTraceTag(17956955,
500,15,"Recycling RTC connection due to RTC machine id change. old={0}, new={1}",S||"null",O.SB),Q.eh.hpc()):(Q.eh.zXi(ba,ca),Q.rMd()))},function(){P.a.instance&&P.a.instance.yx(2,3);Q.rMd()},!0)};a.prototype.B9i=function(){this.nUa=a.N7e};a.prototype.bTh=function(){return new R.a(this.OPa.Plf,this.OPa.Llf,this.OPa.Klf,this.OPa.I1e)};a.prototype.eEj=function(Q){if(Object.getType(Q)!==Object)return null;for(var O in Q);return this.F1g(Q)};a.prototype.F1g=function(Q){if(!(u.eyb in Q))return null;for(var O=
Q[u.eyb],ba=yl(O?this.pqg:this.oqg),ca=ba.next();!ca.done;ca=ba.next())if(!(ca.value in Q))return null;ba=Object.assign(new f,{igc:Q[u.eyb],errorMessage:Q[u.errorMessage],correlationId:N.a.create().toString()});O&&(ba.v0c=Q[u.L0f],ba.k6=Q[u.k6],ba.SB=Q[u.SB],ba.I1e=Q[u.H1e],ba.Klf=Q[u.q7a],ba.Llf=Q[u.CAa],ba.Plf=Q[u.u7a]);return ba};a.prototype.SIh=function(Q,O){var ba=this;v.ULS.sendTraceTag(50448152,500,50,"Using FindSessionUtils find session response");this.ihb.Mvh.continueWith(function(){ba.ihb.Mvh.result?
(v.ULS.sendTraceTag(50448153,500,50,"FindSessionUtils find Session resulted in success"),Q(ba.ihb.Nvh)):(v.ULS.sendTraceTag(50448154,500,15,"FindSessionUtils find Session resulted in error"),O(ba.ihb.Nvh))})};a.prototype.YOf=function(Q,O,ba,ca,S){var Y=this;S=void 0===S?!1:S;return function(na){ia.a.instance.sFb(0,1);Q&&Q.stop();Y.Mab=null;Y.Mfb=null;Y.gjf(na.data,!0,O);var Z=W.RtcUtils.deserialize(na.data.fe,"FindSession",null);if(Z)if(Z=Y.eEj(Z)){if(Z.igc&&Z.k6&&Z.SB){v.ULS.sendTraceTag(4317446,
500,50,"Successfully retrieved MachineId from server for [{0}]",Y.Ll);Y.Dmi(na.data);ba(Z);return}O.FindSessionFailureReason="FindSessionInvalidResponse";O.IsRtcEnabled=Z.igc;O.IsQueryStringEmpty=!Z.k6;O.IsConnectionStringEmpty=!Z.SB;v.ULS.sendTraceTag(4290720,500,15,"Response did not contain valid MachineId [ConnectionUrl and/or QueryString] for [{0}]; IsRtcEnabled:{1}; IsQueryStringEmpty:{2}; IsConnectionStringEmpty:{3}",Y.Ll,Z.igc,!Z.k6,!Z.SB)}else O.FindSessionFailureReason="FindSessionTranslateServerResponseFailed",
v.ULS.sendTraceTag(8745097,500,15,"Could not translate server response to findSession response for [{0}]",Y.Ll);else O.FindSessionFailureReason="FindSessionDeserializeServerResponseFailed",v.ULS.sendTraceTag(7372827,500,10,"Could not deserialize response data for [{0}]",Y.Ll);Y.IHf(O,S);ca(null)}};a.prototype.ROf=function(Q,O,ba,ca){var S=this;ca=void 0===ca?!1:ca;return function(Y){ia.a.instance.sFb(0,1);Q&&Q.stop();S.Mab=null;S.Mfb=null;S.gjf(Y.data,!1,O);var na=null,Z="unknown",wa="unknown";Y.data&&
((Z=Y.data.responseHeaders)&&a.hHb in Z&&(na=Z[a.hHb].toString()),Z=w.a[Y.data.status],wa=Y.data.httpStatus.toString());O.FindSessionFailureReason="FindSessionRequestFailed";O.HttpErrorCode=wa;O.HttpErrorStatus=Z;O[a.hHb]=na;v.ULS.sendTraceTag(4290721,500,15,"Request for MachineId failed with Status='{0}'; HttpStatus='{1}' for [{2}]; RtcErrorCode='{3}'. Polling: '{4}' '",Z,wa,S.Ll,na,ca);S.IHf(O,ca);ba(wa)}};a.prototype.zWe=function(Q,O,ba){var ca=this;ba=void 0===ba?!1:ba;var S=null;v.ULS.sendTraceTag(4317445,
500,50,"Getting MachineId from server for [{0}]",this.Ll);var Y={},na=this.R3d.Dad();Y[G.a.yY]=N.a.create().toString();this.Mab&&""!==this.Mab?na=String.format("{0}&{1}={2}",na,I.a.AJd,this.Mab):this.Mfb&&""!==this.Mfb&&(na=String.format("{0}&{1}={2}",na,I.a.AJd,this.Mfb),Y[d.CNj]="True",Y[d.mhi]="True");na=this.mkg+"?"+na;ba&&(Y[k.Ovh]=c.gZi);var Z={};Z.IsNetworkOfflineBeforeSendRequest=this.Og.w5a;Z.HasAvailableConnectionsBeforeSendRequest=this.Og.U3e;Z.MaxConnectionsAllowed=this.Og.fjc;Z.IsRefreshMachineId=
ba;this.ihb&&!this.S3d?(this.SIh(this.YOf(null,Z,Q,O,ba),this.ROf(null,Z,O,ba)),this.S3d=!0):(this.uh&&(S=this.uh.Fc("WebServiceCall","GetMachineIdFromTheServer")),P.a.instance&&P.a.instance.yx(2,0),0>this.Og.h9(na,1,null,Y,[a.s2b,a.hHb,a.CBb,a.zJd,a.rnf,a.Ppf,a.Opf],!1,1,this.YOf(S,Z,Q,O,ba),this.ROf(S,Z,O,ba),null,null,!1,null,this.a8b,"3",null,!0)&&(5<this.Zgb&&200>this.Zgb&&v.ULS.sendTraceTag(578166985,500,15,"FindSession request not scheduled due to expired token. Manually triggered failure callback {0} times.",
this.Zgb),window.setTimeout(function(){ca.Zgb++;O("-1")},1E3)))};a.prototype.gjf=function(Q,O,ba){ba||(ba={});ba.IsNetworkOfflineAfterRequestComplete=this.Og.w5a;ba.IsRequestSucceeded=O;Q&&(ba.EnqueueTime=Q.i6b,ba.InvokedTime=Q.AE,ba.CompletedTime=Q.R2,Q.responseHeaders&&(a.s2b in Q.responseHeaders&&(ba.CorrelationId=Q.responseHeaders[a.s2b]),a.CBb in Q.responseHeaders&&(ba[a.CBb]=Q.responseHeaders[a.CBb])));v.ULS.sendTraceTag(38633565,500,O?50:15,W.RtcUtils.Exa(ba))};a.prototype.IHf=function(Q,O){Q||
(Q={});Q.ConnectionState=x.a[this.Yca];O||this.eh.HHf(1,Q)};a.prototype.Dmi=function(Q){try{var O=!1,ba=!1,ca=Q.responseHeaders,S=z.a.oM(Q.request.get_url());if(ca&&a.zJd in ca){var Y=ca[a.zJd].toString().toLocaleLowerCase();ba="true"===Y;O="false"===Y}ca=!1;var na=0<=S.toLocaleLowerCase().indexOf("collab");ba&&!na?ca=!0:O&&na&&(ca=!0);if(ca){O={HostName:S};O.Status=w.a[Q.status];O.HttpStatus=Q.httpStatus.toString();var Z=Q.request.get_headers(),wa;for(wa in Z){var ma=Z[wa];(ba=wa)&&0<ba.length&&
(S=0,ma&&(S=ma.toString().length),O["r_"+ba]=S)}if(Q.responseHeaders){var pa=new A.a;pa.add(a.s2b);pa.add(a.CBb);pa.add(a.hHb);pa.add(a.Ppf);pa.add(a.Opf);pa.add(a.rnf);a.Vxg(O,Q.responseHeaders,pa)}a.Kxg(Q.request.get_url(),O);var Ia=B.a.toJSON(O);v.ULS.sendTraceTag(559437006,500,15,Ia)}}catch(Ma){v.ULS.sendTraceTag(559437007,500,10,"DomainLandingIncorretDC exception[{0}]",Ma.toString())}};a.createInstance=function(Q,O,ba,ca,S,Y,na,Z,wa,ma,pa,Ia){return a.z2g(Q,O,ba,ca,S,Y,na,Z,wa,ma,pa,void 0===
Ia?null:Ia)};a.z2g=function(Q,O,ba,ca,S,Y,na,Z,wa,ma,pa,Ia){Ia=void 0===Ia?null:Ia;Q=Q||N.a.create().toString();Q=new a(Q,O,ba,ca,S,Y,na,Z,wa,ma,null,pa,Ia);Q.init();return Q};a.Vxg=function(Q,O,ba){ba=yl(ba);for(var ca=ba.next();!ca.done;ca=ba.next())ca=ca.value,ca in O&&(Q[ca]=O[ca])};a.Kxg=function(Q,O){if(Q){var ba=Q.indexOf("?");if(-1!==ba)for(Q=Q.substr(ba+1).split("&"),ba=0;ba<Q.length;++ba){var ca=Q[ba].split("=");if(2===ca.length){var S=ca[0];if(S&&0<S.length){var Y=0;if(ca=ca[1])Y=ca.length;
O["q_"+S]=Y}}}}};a.fMh=3E3;a.kri=3E5;a.rUg="1.0";a.N7e=1E3;a.s2b="X-CorrelationId";a.Sze="corrid";a.hHb="RtcErrorCode";a.CBb="X-OfficeCluster";a.zJd="X-NewEnv";a.rnf="X-MSEdge-Ref";a.Opf="X-OFFICEFD";a.Ppf="X-OfficeFE";Object(y.a)(a,"FindSessionStrategy",null,[168])},1297:function(y,D,b){function a(){this.B$d=this.C$d=this.D$d=this.z$d=this.y$d=this.A$d=this.ejb=this.VLc=0;this.PQb=this.oKc=this.qib=this.hKc=this.iKc=this.ZJc=this.Gpa=this.nib=this.uVa=this.YJc=this.NQb=this.KUa=null;this.cLc=this.Jib=
this.Mde=this.z0d=0;this.A9d=!1;this.hJf=this.BEd;this.kJf=this.EEd;this.jJf=this.DEd;this.oJf=this.GEd;this.nJf=this.FEd;this.MEd=this.NEd;this.JEd=this.KEd;this.lPa=this.HEd;this.tFb=this.IEd;this.iJf=this.CEd;this.dBb=this.ovd;this.ckc=this.qvd}b.r(D);b.d(D,"RealtimeChannelMetrics",function(){return a});y=b(0);var d=b(13),c=b(233),k=b(110),n=b(840);a.prototype.BEd=function(){this.VLc++;this.YJc=new Date;this.KUa||(this.KUa=new Date)};a.prototype.EEd=function(){this.ejb++;this.Gpa=new Date;this.NQb||
(this.NQb=this.Gpa);this.qib=this.Gpa;this.hXg()};a.prototype.DEd=function(){this.A$d++;this.ZJc=new Date};a.prototype.GEd=function(){this.y$d++;this.uVa=new Date};a.prototype.FEd=function(){this.z$d++;this.nib=new Date};a.prototype.KEd=function(){this.iKc=new Date;this.D$d++};a.prototype.IEd=function(){this.PQb||(this.PQb=new Date);this.C$d++};a.prototype.HEd=function(){this.hKc=new Date;this.B$d++};a.prototype.NEd=function(){!this.A9d&&this.VLc&&(d.ULS.sendTraceTag(39321871,500,15,k.a.toJSON(this.rVg())),
this.A9d=!0)};a.prototype.CEd=function(l){var f=n.RtcUtils.Ssh(l);l=f.r6e;var u=f.t6e;f=f.mg;if(l&&l!==c.a.sO){var v={};d.ULS.sendTraceTag(40157596,500,15,k.a.toJSON((v.HttpErrorCode=l,v.HttpErrorStatus=u,v.Exception=f,v)));c.a.e$e(l)&&this.z0d++;c.a.Hdf(l)&&this.Mde++}};a.prototype.ovd=function(){this.oKc=new Date};a.prototype.qvd=function(){this.uVa=this.qib=new Date};a.prototype.rVg=function(){var l={};return l.numberOfConnectionAttempts=this.VLc,l.numberOfSuccessfulConnections=this.ejb,l.numberOfFailedConnections=
this.A$d,l.numberOfDisconnectedConnections=this.y$d,l.numberOfExplicitDisconnectedConnections=this.z$d,l.numberOfSentMessages=this.D$d,l.numberOfReceivedMessages=this.C$d,l.numberOfLostMessages=this.B$d,l.firstConnectionAttempt=this.KUa?this.KUa:null,l.firstMessageReceived=this.PQb?this.PQb:null,l.firstConnectionSuccess=this.NQb?this.NQb:null,l.lastConnectionAttempt=this.YJc?this.YJc:null,l.lastConnectionSuccess=this.Gpa?this.Gpa:null,l.lastConnectionFailure=this.ZJc?this.ZJc:null,l.lastMessageSent=
this.iKc?this.iKc:null,l.lastMessageLost=this.hKc?this.hKc:null,l.lastDisconnect=this.uVa?this.uVa:null,l.lastExplicitDisconnect=this.nib?this.nib:null,l.lastTimeOnline=this.qib?this.qib:null,l.lastTimeOffline=this.oKc?this.oKc:null,l.maxDisconnectedTimeMs=this.Jib,l.maxExplicitDisconnectedTimeMs=this.cLc,l.clientConnectionErrors=this.z0d,l.serverConnectionErrors=this.Mde,l};a.prototype.hXg=function(){this.KUa&&1===this.ejb&&(this.Jib=Math.max(this.Jib,this.Gpa.getTime()-this.KUa.getTime()));this.uVa&&
1<this.ejb&&(this.Jib=Math.max(this.Jib,this.Gpa.getTime()-this.uVa.getTime()));this.nib&&1<this.ejb&&(this.cLc=Math.max(this.cLc,this.Gpa.getTime()-this.nib.getTime()))};a.createInstance=function(l){a.Na||(a.Na=new a,d.ULS.sendTraceTag(39321870,500,50,"RealtimeChannelMetrics initialized for client {0}",l));return a.Na};a.Na=null;Object(y.a)(a,"RealtimeChannelMetrics",null,[170,83])},1298:function(y,D,b){function a(c,k){var n=d.call(this)||this;n.iO=c;n.i3=k;return n}b.d(D,"a",function(){return a});
y=b(0);var d=Sys.EventArgs;vm(a,d);Object(y.a)(a,"PresenceUpdatedEventArgs",Sys.EventArgs,[])},1386:function(y,D,b){function a(Pa){this.$=Pa}function d(Pa,qb,tc,dd,Kd,yd){var ze=qf.call(this)||this;ze.Aj=null;ze.Tvd=!1;ze.Zhd=null;ze.currentUserId=null;ze.Z7d=null;ze.Uyd=function(te,lf){if(lf.iO){te=lf.iO;for(var bf in te)(te=bf)&&te!==ze.currentUserId&&!ze.IZa.has(te)&&ze.jac(te).xKj()}};ze.IH=function(){ze.qJf()};ze.Wba=function(te,lf){ze.Tvd=!0;var bf=Object(E.a)(Object,lf.v7);if(1===lf.type)if(te=
cc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EditorsTableNotification",!1),null===bf||void 0===bf?0:bf[Ad.a.J0h]){if(!te||!Object(E.a)(String,bf[Ad.a.a6e]))return;te=ze.qze(Object(E.a)(String,bf[Ad.a.a6e]));Object(E.a)(String,bf[Ad.a.b6e])===Ad.a.H0h?(te=[te],te[0]===ze.currentUserId||ze.IZa.has(te[0])||ze.jac(te[0]).uKj(),ze.vOd(te)&&ze.mMb(te,null)):Object(E.a)(String,bf[Ad.a.b6e])===Ad.a.I0h&&te!==ze.currentUserId&&ze.mMb(null,null)}else{lf=Array.isArray(lf.v7)?lf.v7:null;!lf&&
bf&&(lf=Array.isArray(bf[Ad.a.pHe])?bf[Ad.a.pHe]:null);if(lf&&te)for(var xf=yl(lf),Og=xf.next();!Og.done;Og=xf.next())Og=Og.value,Og===ze.currentUserId||ze.IZa.has(Og)||ze.jac(Og).wKj();cc.EwaSettings.isChangeGateEnabled("OfficeVSO:5930962_ProcessPeerNotificationAsFallback")?lf&&!ze.vOd(lf)||ze.mMb(lf,null):lf&&(te||!ze.vOd(lf))||ze.mMb(lf,null);return}if(bf)if(lf.type){if(3===lf.type){if(!(Ad.a.NQf in bf)){Ta.ULS.sendTraceTag(537154117,13,10,"RTC WetContentUpdate does not specify a type. Ignoring this update.");
return}lf=bf[Ad.a.NQf];if(lf===Ad.a.sbj)ze.wYh(bf);else if(lf===Ad.a.qbj){if(!cc.EwaSettings.isChangeGateEnabled("OfficeVSO:5935009_UseSignalRForRtc")&&cc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.HandleFullSaveStartedRTC",!0)){if(ze.DFa(bf).returnValue)return;if(lf=bf[Ad.a.mbj])Ta.ULS.sendTraceTag(537154114,0,50,"RTC : FullSaveStarted received. Now invoking ProcessFullSaveStartedNotification web method"),B(ze.$.qa.ta,lf,null,null,null,null)}}else if(lf===Ad.a.tbj||lf===Ad.a.ubj||
lf===Ad.a.XQf){if(!cc.EwaSettings.isChangeGateEnabled("OfficeVSO:5935009_UseSignalRForRtc")&&cc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.HandleUploadNotificationsRTC",!0)){if(ze.DFa(bf).returnValue)return;te=0;lf!==Ad.a.XQf&&(te=bf[Ad.a.yJd]);(xf=bf[Ad.a.JQf])&&ze.gMj.dEb(new c(lf,te,xf,ze.Xkc))}}else lf!==Ad.a.rbj&&Ta.ULS.sendTraceTag(537154081,13,50,"RTC WetContentUpdate of unknown type {0}. Ignoring this update.",lf);return}if(4===lf.type){te=!1;Ad.a.jDf in bf&&(te=bf[Ad.a.jDf]);
if(ze.DFa(bf).returnValue)return;ze.$.fa.U9h()&&ze.eZc();if(ze.$.fa.j6a&&te)return;xf=bf[Ad.a.zQi];ze.$.fa.oc&&xf&&ze.yQi.dEb(new l(xf,te,ze.Xkc))}else if(8===lf.type){if(ze.y3i)return;var mf=0,bg=bf[Ad.a.obj],Wf=bf[Ad.a.JQf],zf=bf[Ad.a.nbj];Ad.a.yJd in bf&&(mf=bf[Ad.a.yJd]);ze.$.fa.oc&&bg&&(te=Object.assign(new m,{OcsSessionId:bg,ClientId:Wf&&cc.EwaSettings.isChangeGateEnabled("OfficeVSO:5544917_HookUpRevisionTrackerOnXLO")?Wf:"",SeqNum:zf,XrevidSaved:mf}),xf=function(){Ta.ULS.sendTraceTag(537154080,
0,10,"BatchCheckCollabServiceContent failed. OcsSessionId: {0}, ClientId: {1}, SeqNum: {2}, XrevidSaved: {3}",bg,Wf,zf,mf)},cc.EwaSettings.la(481)?(Og=Array(1),Og[0]=te,U(ze.$.qa.ta,Og,ze.Xkc,xf,null,null)):ze.mVg.dEb(new v(te,ze.Xkc,xf)))}}else{var tg;(function(){var Hf=ze.DFa(bf);tg=Hf.YIf;return Hf})().returnValue?(ze.WNa(bf),Ad.a.rf in bf&&(ze.$.fa.ZW(bf[Ad.a.rf],"ContentRefreshManager.OnUpdateNotificationReceived"),ze.m9f())):Ta.ULS.sendTraceTag(22905367,0,50,"RTC ContentUpdate session identifier mismatch. Received: {0}. Expected: {1}. Ignoring this update.",
tg,ze.$.fa.K6)}2===lf.type?bf&&ze.DFa(bf).returnValue||(Ta.ULS.sendTraceTag(537154079,0,50,"RTC : FileNameUpdate received. Now invoking CheckWorkbookFileNameUpdate web method"),w(ze.$.qa.ta,null,null,null,null)):12!==lf.type||bf&&ze.DFa(bf).returnValue||ze.raiseEvent("LabelUpdateEventKey")};ze.Xkc=function(te){var lf=te.Errors;Ce.a.Pq(lf)?(lf=Ce.a.jF(lf,[1552731907],"ContentRefreshManager"),Ce.a.w9(lf)||ze.$.fa.Yo(lf)):(lf=te.StateId+1,te.Result&&ze.$.fa.rf<lf&&ze.$.fa.ZW(Ad.a.Se,"ContentRefreshManager.OnCheckForUpdateSuccess"))};
ze.Zh=function(){ze.ibj&&ze.Tvd&&ze.$.fa.Q5b&&ze.m9f()};ze.ksf=function(){ze.Tvd=!1;ze.$.fa.Ima=500;ze.Z7d=rd.a.Ra.Kb};ze.XBb=function(te,lf){ze.HQd(lf.Aj)};ze.$=Pa;ze.ln=qb;ze.$.qa.us(ze.Zh);ze.ln.CXb(ze.XBb);ze.ln.xke(ze.ksf);ze.mVg=tc;ze.yQi=dd;ze.RKj=Kd;ze.gMj=yd;ze.CKa={};ze.IZa=new Set;ze.ln.EZa();cc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EditorsTableNotification",!1)&&(ze.currentUserId=ze.$.workbookContext.ClientId,ze.qJf(),ze.$.fa.rga(ze.IH));ze.y3i=cc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.RemoveWebRequestsForCollabServiceContentUpdates",
!1);return ze}function c(Pa,qb,tc,dd){this.fWd=new cb.a(!0);this.fWd.add(tc,Object.assign(new k,{RtcUpdateType:Pa,XrevidSaved:qb,ClientId:tc}));this.lr=dd}function k(){}function n(Pa,qb,tc){this.mEc={};this.nEc={};this.lr=tc;this.QYb(Pa,this.mEc);this.QYb(qb,this.nEc)}function l(Pa,qb,tc){this.v7g=Pa;this.Rkc=qb;this.lr=tc}function f(Pa,qb,tc,dd){this.oAc=this.woc=this.Mnc=this.Bcc=0;this.H6d=this.C9e=!1;this.clientId=Pa;this.Z6g=qb;this.$=dd;this.Goi=Ee.a.se()+tc}function u(Pa,qb,tc,dd,Kd){var yd=
Zg.call(this)||this;yd.pj=Pa;yd.bgj=qb;yd.agj=tc;yd.K6=dd;yd.RVg=Kd;return yd}function v(Pa,qb,tc){this.kha=new Bg.a;this.kha.add(Pa.ClientId,Pa);this.lr=qb;this.J3=tc}function m(){}function A(Pa){var qb=Ze.call(this)||this;qb.ef=null;qb.mergeSuspensionManager=null;qb.kwa=!1;qb.NAd=null;qb.Ld=!1;qb.fxc=!1;qb.dxc=!1;qb.exc=!1;qb.jDb=function(tc,dd){qb.kwa!==dd.kwa&&(qb.kwa=dd.kwa,qb.NAd=qb.kwa?null:rd.a.Ra.Kb)};qb.od=function(){qb.$.Ju&&qb.Qyj()};qb.Zc=function(tc,dd){dd.oc||qb.Hv(tc,dd)};qb.Hv=function(){if(0<
qb.nza.length||0<qb.yda.count)Ta.ULS.sendTraceTag(537154128,13,15,"Dropping {0} revisionGeneratedNotifications and {1} stateDownloadedNotifications.",qb.nza.length,qb.yda.count),qb.nza=[],qb.yda=new Re.a;qb.onb.cancel();qb.S8f();qb.YUd();qb.NHj()};qb.dyf=function(tc,dd){qb.Oyj();qb.Pyj();tc=new t;tc.Xluid=dd.pj;tc.NotificationReceivedOn=rd.a.Ra.Kb.toISOString();tc.CurrentPresenceUserCount=qb.$.fa.Em.length;tc.OurCollabModeIsUsingOcs=qb.$.fa.j6a;tc.SenderCollabMode=dd.bgj;tc.SenderClientType=dd.agj;
tc.SessionSiteIdentifier=dd.K6;tc.CommandTimeInMs=dd.RVg;Ta.ULS.sendTraceTag(537154127,13,50,"ContentLatencyTracker.OnRemoteRevisionGenerated: RevisionGeneratedNotification: {0}",JSON.stringify(tc));qb.nza.push(tc)};qb.Hg=function(){qb.lAe(qb.$.fa.rf,"OnBlockCacheConsistent")};qb.hyf=function(tc,dd){(tc=Object(E.a)(399,dd.gf))&&qb.lAe(tc.fJ,"OnRenderedContent")};qb.fMj=function(){if(!qb.$.fa.oc)Ta.ULS.sendTraceTag(537154122,13,15,"ContentLatencyTracker.UploadLatencyTelemetryPeriodically: session isn't active");
else if(qb.nza.length||qb.yda.count){var tc=null;0<qb.nza.length&&(tc=qb.nza,qb.nza=[]);var dd=null;if(0<qb.yda.count){dd=Array(qb.yda.count);for(var Kd=0,yd=yl(qb.yda.values),ze=yd.next();!ze.done;ze=yd.next())ze=ze.value,dd[Kd++]=ze;qb.yda=new Re.a}Ta.ULS.sendTraceTag(537154120,13,100,"ContentLatencyTracker.UploadLatencyTelemetryPeriodically: Uploading {0} revisionGeneratedNotifications and {1} stateDownloadedNotifications.",tc?tc.length:0,dd?dd.length:0);Kd=qb.$.qa.ta;yd=qb.sMi;ze=Kd.Oa(1,null);
ze.GenerateNotifications=tc;ze.DownloadNotifications=dd;Jf.i(Kd,"UploadLatencyTelemetry",ze,yd,null,null,null,128)}};qb.sMi=function(tc){tc.Result&&0<tc.Result&&qb.vtd()};qb.$=Pa;qb.Ca=ae.g(qb.$).Ca;qb.viewport=ae.g(qb.$).view;qb.contentRefreshManager=qb.$.da.Aa(292);qb.uf=qb.$.uf;qb.nza=[];qb.yda=new Re.a;Pa=cc.EwaSettings.la(288)?1E3:3E4;qb.onb=ge.a.instance.XB(qb.fMj,Pa,Yd.a.rYg,!1,!1);qb.$.Rk(qb.od);qb.$.fa.Sj(qb.Zc);qb.$.fa.GTc(qb.Hv);qb.$.da.Za(291,function(tc){qb.ef=tc});qb.$.da.Za(343,function(tc){qb.Ld||
(qb.mergeSuspensionManager=tc,qb.mergeSuspensionManager.XXb(qb.jDb),qb.mergeSuspensionManager.ZEb())});Ta.ULS.sendTraceTag(537154131,13,50,"ContentLatencyTracker initialized");qb.od(qb.$,null);return qb}function x(){}function t(){}function z(Pa){this.$=Pa}function r(Pa){this.$=Pa}function G(Pa){this.$=Pa}function w(Pa,qb,tc,dd,Kd,yd){yd=Pa.Oa(1,void 0===yd?null:yd);return Jf.i(Pa,"CheckWorkbookFileNameUpdate",yd,qb,tc,dd,Kd,0)}function B(Pa,qb,tc,dd,Kd,yd,ze){ze=Pa.Oa(1,void 0===ze?null:ze);ze.fullSaveId=
qb;return Jf.i(Pa,"ProcessFullSaveStartedNotification",ze,tc,dd,Kd,yd,0)}function U(Pa,qb,tc,dd,Kd,yd,ze){ze=Pa.Oa(1,void 0===ze?null:ze);ze.updateInfo=qb;return Jf.i(Pa,"BatchCheckCollabServiceContent",ze,tc,dd,Kd,yd,516)}function N(Pa,qb,tc){var dd=Rf.call(this)||this;dd.$Bd=null;dd.KOa=null;dd.PCb=function(Kd,yd){if(yd.iO){Kd=[];var ze=[],te=ae.g(dd.$).ha,lf=!(2===te.Te||128===te.Te);te=lf?oc.k(te.va.selectedRanges,dd.$):te.Qa.nc.floatingObject;yd=yd.iO;for(var bf in yd)dd.presenceView.MEe(te,
lf,Kd,ze,bf);bf=yl(dd.kHa);for(yd=bf.next();!yd.done;yd=bf.next())yd=yd.value,Array.contains(Kd,yd)||Array.contains(ze,yd)||dd.presenceView.MEe(te,lf,Kd,ze,yd.UserID);dd.kHa=[];Array.addRange(dd.kHa,Kd);Array.addRange(dd.kHa,ze);dd.$Bd&&(id.a.Fa(dd.KOa),dd.KOa=null,dd.$Bd=null);var xf=N.fse(Kd,ze);dd.KOa=new be.a;dd.$Bd=za.TaskExtensions.Ba(Ha.Task.delay(1),function(){dd.ariaLiveNotifier.q$a(xf,Ff.a.FFa)},dd.KOa.token,3)}};dd.$=qb;dd.ariaLiveNotifier=Pa;dd.presenceView=tc;dd.kHa=[];tc.eFa(dd.PCb);
dd.$.da.Ha(231,dd);return dd}function P(Pa){var qb=Zf.call(this)||this;qb.manager=null;qb.$=Pa;qb.dc();return qb}function ia(Pa,qb){var tc=Ng.call(this)||this;tc.Aj=null;tc.fieldManagerPane=null;tc.t5=null;tc.e5f=null;tc.d5f=null;tc.Wo=function(){tc.$&&tc.WKd(0,!1)};tc.Mj=function(){tc.HSd?tc.e5f(!1):(tc.uc.PresenceType=1,tc.raiseEvent(ia.c0),tc.sendPresenceToService(!1))};tc.Rh=function(){tc.HSd?tc.d5f(!1):(tc.bbb(!1),tc.TKd())};tc.olc=function(){tc.ha.Qa.nc?tc.WKd(1,!1):tc.eLd(0,!1)};tc.xla=function(dd,
Kd){tc.raiseEvent(ia.YBd,Kd)};tc.kd=function(){tc.eLd(ae.g(tc.$).isEditing?1:0,!1)};tc.Zc=function(dd,Kd){rg.a(Kd)&&(tc.kqa={})};tc.DCb=function(){tc.uTf()};tc.fBf=function(dd,Kd){if(Kd&&Kd.methodName in ia.Unc){dd=!1;switch(ia.Unc[Kd.methodName]){case 0:Kd=Kd.parameters.cell;break;case 1:Kd=Kd.parameters.parameters.Location;break;case 2:Kd=oc.v(tc.ha.va.activeRange,tc.$);dd=!0;break;default:return}Kd.LastColumn=Kd.FirstColumn;Kd.LastRow=Kd.FirstRow;Kd.NamedObjectName=null;tc.uc.SelectedRange=[Kd];
tc.uc.PresenceType=0;if(dd){Kd=[];dd=yl(tc.$.xb.RMh());for(var yd=dd.next();!yd.done;yd=dd.next()){yd=yd.value;var ze={};ze.ObjectType=tc.naa(yd.type);ze.ObjectPresenceType=1;ze.ObjectId=yd.pj;Array.add(Kd,ze)}tc.uc.Object=Kd}else Kd=Yb(Kd,tc.$,1),dd=null,Kd&&(dd={},dd.ObjectType=tc.naa(Kd.type),dd.ObjectPresenceType=0,dd.ObjectId=Kd.pj),tc.uc.Object=[dd];tc.raiseEvent(ia.c0);tc.sendPresenceToService(!1)}};tc.Xo=function(dd,Kd){Kd.context.methodName in ia.Unc&&(tc.uc.Object=[null],tc.bbb(!1))};tc.Zh=
function(dd,Kd){Kd.context.methodName in ia.Unc&&(tc.uc.Object=[null],tc.bbb(!1))};tc.od=function(dd,Kd){Kd.WJ||(tc.kqa={},cc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SendPresenterDetailsForExcelLive",!1)&&tc.$.ya.IsMeetingLiveSession&&tc.$.ya.IsMeetingPresenter&&(tc.uc.MeetingInfo=tc.wdd()),tc.$.Ju?tc.Z3a():tc.WLb())};tc.qd=function(){tc.TKd()};tc.Nef=function(){tc.uTf();tc.Gpf.gz()};tc.$=Pa;tc.ha=ae.g(tc.$).ha;tc.sNa=qb;tc.Idf=cc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ServiceInit2",
!1);tc.$.Rk(tc.od);tc.$.Vl(tc.qd);tc.kqa={};tc.UVa=new Qd.a(null,null,null,null);tc.Gza={};tc.Gza.b=0;tc.Gza.c=0;tc.Gpf=new W(tc.$);cc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SendPresenterDetailsForExcelLive",!1)&&tc.$.ya.IsMeetingLiveSession&&tc.$.ya.IsMeetingPresenter&&(tc.uc.MeetingInfo=tc.wdd());tc.HSd=cc.EwaSettings.gH();tc.HSd&&(tc.e5f=cg.a(function(dd){tc.uc.PresenceType=1;tc.raiseEvent(ia.c0);tc.sendPresenceToService(dd)},40,tc.$.ma,"SelectionPresenceManager.SendPresenceToService",
!0),tc.d5f=cg.a(function(dd){tc.bbb(dd);tc.TKd()},40,tc.$.ma,"SelectionPresenceManager.SendCurrentPresence",!0));return tc}function W(Pa){var qb=Ie.call(this)||this;qb.statusBarManager=null;qb.$=Pa;qb.$.da.Za(29,function(tc){qb.statusBarManager=tc;tc.$I(qb)});return qb}function R(Pa,qb,tc,dd,Kd){Kd=void 0===Kd?null:Kd;var yd=dg.call(this)||this;yd.iu={};yd.w2b=0;yd.v2b=0;yd.wqb=null;yd.Fqd=null;yd.Mif=3E4;yd.Ngd=!1;yd.ZNd=!0;yd.WBd=null;yd.htf=function(){var ze=yd.Gla,te;for(te in ze)ze=te,yd.Bje(ze)?
(yd.nic(ze,!0),delete yd.v9a[ze],delete yd.Gla[ze]):Ta.ULS.sendTraceTag(537154377,0,50,"PresenceView.OnEcsUserListChanged: pending userId=[{0}] still not updated",ze)};yd.mzd=function(ze,te){ze={};ze.UpdatedCount=te.iO?Object.keys(te.iO).length:0;ze.DisconnectedCount=te.i3?te.i3.length:0;ze.Location="canvas";Lc.b(yd.$).ae(mb.a.eCd,ze);ze=null;yd.$.Ub&&(ze=yd.$.Ub.Xh("ModelUpdate","PresenceRendering"),ze.start());var lf={};if(te.iO){if(cc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")){var bf=
(new Date).getTime();za.TaskExtensions.Ba(uc.GetServiceTaskFactory.Xa(yd.$.da,435,436,1),function(Hf){Hf.result.Rni(bf)},yd.$.ma,3)}yd.Bsb||(yd.fsd(!0),yd.Bsb=!0);var xf=te.iO;for(zf in xf){var Og=xf[zf],mf=zf;yd.bjd[mf]=rd.a.Ra.Kb;yd.yxe(mf,new Date);yd.IDg(Og);if(mf!==yd.wqb){var bg=yd.iu[mf];bg||(yd.Bje(mf)?yd.nic(mf,!0):(mf in yd.Gla?Ta.ULS.sendTraceTag(537154376,0,50,"PresenceView.OnSelectionPresenceChanged: userId=[{0}] already pending update",mf):(yd.v9a[mf]=rd.a.Ra.Kb,lf[mf]=1),yd.Gla[mf]=
!0,bg=yd.cOh(mf),yd.iu[mf]=yd.uCe(bg)),bg=yd.iu[mf]);bg&&(bg.uc=Og,Og.SelectedRange&&1<Og.SelectedRange.length?yd.w2b++:yd.v2b++,yd.LLf(mf),yd.FZa(bg))}}if(cc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")&&yd.$.fa&&yd.$.fa.Q3a){var Wf=(new Date).getTime();za.TaskExtensions.Ba(uc.GetServiceTaskFactory.Xa(yd.$.da,435,436,1),function(Hf){Hf.result.Sni(Wf)},yd.$.ma,3)}}if(te.i3){var zf=0;for(xf=te.i3.length;zf<xf;zf++)mf=te.i3[zf],yd.Z4c[mf]=rd.a.Ra.Kb,yd.CLf(mf,!0)}if(te.i3&&
0<te.i3.length||0<og.a(lf).length||0<og.a(yd.Gla).length)zf=[],Array.addRange(zf,og.a(lf)),Array.addRange(zf,og.a(yd.Gla)),(lf=yd.$.da.Aa(292))&&lf.mMb(zf,te.i3);ze&&ze.stop();yd.Ngd=!1;ze=yd.iu;for(var tg in ze)if(!Object(E.a)(da,ze[tg]).uc.CollabMode){yd.Ngd=!0;break}yd.raiseEvent("pcek",te)};yd.tBa=function(ze,te){te&&yd.$.Ju&&(te.Fmb.HasAnyNonOcsCoauthor=yd.Ngd)};yd.DCb=function(){var ze=new jd.a({},null),te=yd.dBa,lf;for(lf in te){var bf=lf,xf=te[lf].uc;xf.SelectedRange=xf.SelectedRangeRaw;ze.iO[bf]=
xf}yd.mzd(yd,ze)};yd.kd=function(){yd.x3e()};yd.Ooi=function(){yd.Fqd&&je.a(rd.a.Ra,yd.Fqd)<yd.Mif||(yd.Fqd=rd.a.Ra.Kb,yd.Jrd(),yd.Vli(),yd.Cmi(),yd.Bsb||yd.fsd(!1))};yd.T5=function(){yd.x3e();var ze=yd.iu,te;for(te in ze)yd.FZa(ze[te])};yd.qd=function(){yd.Jrd();yd.Bsb||yd.fsd(!1);yd.Bsb=!1};yd.Axf=function(){var ze=yd.iu,te;for(te in ze)ze[te].dispose();yd.iu={};yd.Wve();yd.v9a={};yd.JMc={};Array.clear(yd.Ax);yd.Pvc()};yd.XBb=function(ze,te){yd.HQd(te.Aj)};yd.Z4c={};yd.bjd={};yd.v9a={};yd.JMc={};
yd.$=Pa;yd.sNa=dd;yd.ln=qb;yd.Gde=tc;Y.sJb=!0;Y.cna=!0;yd.Z3a();yd.Tx=new S(Pa);yd.$.xa&&yd.$.xa.Pf(yd.T5);yd.ln.CXb(yd.XBb);Pa.qa&&yd.$.qa.fra(yd.tBa);yd.Ax=[];yd.ln.EZa();Pa.da.Ha(25,yd);yd.Bsb=!1;yd.$.Vl(yd.qd);yd.rVc=ge.a.instance.XB(yd.Ooi,yd.Mif/2,Yd.a.GTi,!0,!1);yd.XBd=Kd;return yd}function I(Pa,qb,tc){var dd=da.call(this)||this;dd.EG=new cb.a(!0);dd.m1c=0;dd.n1c=0;dd.countFloatingObjects=0;dd.Ms=function(){dd.gMd()};dd.T5=function(){dd.gMd()};dd.Bz=new ya(Pa);dd.EXf(Pa);dd.Tx=tc;dd.bNd([]);
dd.$=qb;dd.$.xa.Pf(dd.T5);ae.g(dd.$).hT(dd.Ms);return dd}function Q(Pa,qb,tc){qb=Df.call(this,qb,ae.g(qb),!0,!1,Pa.User.UserID)||this;qb.sZd=46;qb.RJb=!1;qb.qfc=!1;Q.k_a||(Q.k_a={});qb.Pp=Pa;qb.Ru=new ba(qb.gridView,qb.Pp.User.UserID,qb.Pp.User.UserName,qb.Pp.UserColor,qb,tc,qb.$,qb.Pp.IsAnonymous);return qb}function O(Pa,qb,tc){this.gk=this.objectId=this.QCa=null;this.Pp=Pa;this.$=qb;this.Tx=tc;this.Ru=new ba(ae.g(this.$),this.Pp.User.UserID,this.Pp.User.UserName,this.Pp.UserColor,null,tc,this.$,
this.Pp.IsAnonymous)}function ba(Pa,qb,tc,dd,Kd,yd,ze,te){var lf=jc.call(this)||this;lf.gd=null;lf.fz={};lf.She=0;lf.Wqa=null;lf.gk=null;lf.eqa=0;lf.pCb=function(bf){lf.Wqa&&lf.Wqa!==bf||(lf.Wqa=null,lf.s4(!1));lf.raiseEvent("hidePresenceTooltip")};lf.aDb=function(bf){lf.Wqa&&lf.Wqa!==bf||(lf.Wqa=null,lf.dna(!0,!1));lf.raiseEvent("showPresenceTooltip")};lf.$Cb=function(bf){lf.Wqa||lf.raiseEvent("showFullPresenceTooltip");lf.Wqa=bf};lf.PCb=function(){lf.s4(!1);lf.raiseEvent("presenceChanged")};te=
tc===re.a.instance.Cb(86)||te;lf.UMc=new Qd.a(qb,tc,dd,new ib.a,null,null,null,null,te);lf.gridView=Pa;lf.BQc=qb;lf.highlight=Kd;lf.Tx=yd;lf.$=ze;return lf}function ca(Pa,qb,tc,dd,Kd){var yd=we.call(this)||this;yd.Ax=[];yd.cZa=null;yd.visible=!1;yd.yzb=null;yd.mnb=null;yd.Xta=!1;yd.Wfe=null;yd.euj=function(){id.a.Fa(yd.mnb);yd.mnb=null;yd.visible&&(yd.GLa()?yd.raiseEvent("showPresenceTooltip"):yd.s4(!0))};yd.qyd=function(ze){yd.O$a(ze)};yd.iz=function(){yd.q9f()};yd.YE=function(){yd.q9f()};yd.domElement=
Pa;yd.gridView=qb;yd.BQc=Pa.id;yd.eqa=dd;yd.$=Kd;yd.kgc=!1;yd.Q5e();yd.UMc=tc;yd.gk=null;yd.rB={};yd.rB.FirstColumn=0;yd.rB.FirstRow=0;yd.rB.LastColumn=0;yd.rB.LastRow=0;return yd}function S(Pa){var qb=this;this.lgc=!1;this.$na=this.dCd=null;this.pCb=function(tc){var dd=qb.jja(tc.hB);dd&&qb.qqc(dd,tc.xya.clientId,tc.hB)};this.aDb=function(tc){qb.GW(!1,tc)};this.$Cb=function(tc){qb.GW(!0,tc)};this.iz=function(){qb.lag()};this.YE=function(){qb.lag()};this.T5=function(){qb.Ypb();qb.clearCache()};this.tUh=
function(tc){tc=Ae.DOMElementExtensions.getBounds(tc.element);tc=new Jc.a(tc.x,tc.y,tc.width,tc.height);for(var dd=yl(na.aKa()),Kd=dd.next();!Kd.done;Kd=dd.next())if(Kd=qb.gridView.fg(Kd.value),Kd=Ae.DOMElementExtensions.getBoundingClientRect(Kd.domElement),(new Jc.a(Kd.x,Kd.y,Kd.width,Kd.height)).Rd(tc))return Kd;return null};this.OLj=function(){var tc=qb.fz,dd;for(dd in tc){var Kd=tc[dd];if(Kd){var yd=Kd.GLa(),ze=qb.jja(Kd.hB),te=yd?qb.yZe(Kd.xoc,Kd.paneType,Kd.range):null;if(te!==ze){ze&&qb.qqc(ze,
Kd.xya.clientId,Kd.hB);if(!Y.cna)break;te&&yd&&(te.xXa(Kd.xya),qb.XSa[Kd.hB]=te,Kd.BKb(te),qb.N3e(te,Kd))}else qb.N3e(ze,Kd)}}};this.A6e=se.a.wnh;this.yva=20;this.gridView=ae.g(Pa);this.$=Pa;this.AEb={};this.XSa={};this.fz={};this.WSa={};this.$.xa&&this.$.xa.Pf(this.T5);this.Ypb()}function Y(){}function na(Pa,qb,tc){var dd=Sc.call(this)||this;dd.tya=null;dd.fEf=null;dd.iKd=!1;dd.iz=function(){dd.Ohd()};dd.YE=function(){dd.Ohd()};dd.gridView=Pa;dd.rtl=Pa.rtl;dd.Lmd=!1;dd.to=new cb.a(!0);for(var Kd=
0;4>Kd;Kd++)if(dd.gridView.$a.Mnd(tc,na.aKa()[Kd])||1===na.aKa()[Kd]){var yd=qb.A0g(),ze=Pa.fg(na.aKa()[Kd]).domElement;ze.insertBefore(yd.element,ze.firstChild);dd.to.add(Enum.toString(Oc,na.aKa()[Kd]),yd)}return dd}function Z(Pa,qb,tc){if(!qb)return null;Pa=Pa.wq;return new Sys.UI.Point(qb.x+Pa.x*(tc?1:-1),qb.y+Pa.y*(tc?1:-1))}function wa(Pa){this.xe=Pa;this.xe.vXa(10,gc.a.instance);this.xe.vXa(9,vd.a.instance);this.xe.vXa(6,20);this.xe.vXa(13,fd.a.instance);this.xe.vXa(17,!1)}function ma(Pa,qb,
tc){Pa=Sb.call(this,Pa)||this;Pa.SCa=!1;Pa.tRb=!1;Pa.p8=!1;Pa.dWa=!1;Pa.Wz=[];Pa.Khb={};Pa.xe=tc;Pa.fj=tc.get(8,!1);Pa.Z4d=tc.get(15,!1);Pa.djg=tc.get(12,0);Pa.Hra=tc.get(6,0);Pa.eVb=qb;Pa.Rge=tc.get(16);Pa.BGc=tc.get(17,!1);Pa.gRj=tc.get(19,!1);Pa.xpg=tc.get(20,!1);Pa.iSb=0;Pa.tpg=new Ia(Pa.fj,Pa.BGc);Pa.nfb=Pa.HVe();Pa.GMc=!1;Pa.pea=[];Pa.Mhb=[];Pa.element.id=ma.pAh();Pa.element.className=Sb.V4g(Pa.fj);Pa.Kqb&&(Pa.zIndex=Pa.Kqb);Pa.rtl=Pa.fj;Pa.Bhj(qb);Pa.Sea=Pa.createElement("div");Pa.Sea.className=
"prFlyoutContainer";Pa.element.appendChild(Pa.Sea);Pa.oL=[];Pa.rpa=new pa(Pa.zJ,Pa.element,Pa.Hra,4,6,32,Pa.fj);Pa.Sz=tc.get(9);Pa.Sz.pa(sc.a.pointerDown,Pa.rpa.element,Object(eb.a)(Pa,Pa.o8a,"onHitTarget"));Pa.Sz.pa(sc.a.pointerOver,Pa.rpa.element,Object(eb.a)(Pa,Pa.o8a,"onHitTarget"));Pa.Sz.pa(sc.a.pointerOut,Pa.rpa.element,Object(eb.a)(Pa,Pa.o8a,"onHitTarget"));return Pa}function pa(Pa,qb,tc,dd,Kd,yd,ze){this.oL=Pa;this._parent=qb;this.N0d=tc;this.$hg=dd;this.Jlg=Kd;this.GWa=yd;this.OI=ze;this._element=
document.createElement("div");this.element.className="prTouchTarget"}function Ia(Pa,qb){this.fj=void 0===Pa?!1:Pa;this.BGc=void 0===qb?!1:qb}function Ma(Pa,qb,tc,dd){this.offsetTop=Pa;this.offsetLeft=qb;this.Hbg=void 0===tc?2:tc;this.U5e=void 0===dd?4:dd}function ob(Pa,qb){var tc=Sb.call(this,Pa)||this;tc.Vg=null;tc.Sz=null;tc.QEc=null;tc.cIc=null;tc.gEc=null;tc.jpa=null;tc.vge=null;tc.OI=qb.get(8,!1);tc.Dgb=qb.get(6,0);tc.Ftg=qb.get(15,!1);tc.xe=qb;tc.z3d=0;tc.element=Pa;tc.element.className=ob.jxh;
tc.cG=document.createElement("span");tc.element.appendChild(tc.cG);tc.zjg=Cb.KGh(qb.get(6,0));tc.Wu(qb);tc._state=5;return tc}function Cb(){}function Xa(Pa,qb){var tc=Af.call(this)||this;tc.type=Pa;tc.Xrb=qb;return tc}function Sb(Pa){var qb=vg.call(this)||this;qb._element=null;qb.element=Pa;return qb}function Tb(){this.BO={}}function da(){var Pa=Of.call(this)||this;Pa.Bz=null;Pa.kbe=null;Pa.mbe=null;return Pa}function ya(Pa){var qb=Lf.call(this)||this;qb.Bge=Pa;qb.kqa=null;qb.ZMc=null;return qb}function hb(Pa){var qb=
zd.call(this)||this;qb.$=Pa;qb.dc();return qb}function Gb(Pa){var qb=this;this.NEf=this.aCd=this.PEf=this.LEf=this.ZCf=this.xJd=this.OQf=this.UQf=this.TQf=!1;this.bCd=this.PAd=this.gHb=this.iHb=this.ksc=this.BJd=0;this.sdf=!1;this.ivd=this.mob=0;this.pgc=!1;this.Zc=function(){qb.pgc=!0;qb.$.fa.kk(qb.Zc)};this.$=Pa;dc.a.mP&&(this.ivd=window.performance.timing.navigationStart);this.ivd||Ta.ULS.sendTraceTag(537154379,0,15,"Navigation start time is zero");this.$.fa.Sj(this.Zc)}function Qb(){var Pa=Nb.call(this)||
this;Pa.Jze=null;Pa.dc();return Pa}function Fb(){}function ta(){}function xa(Pa){var qb=this;this.Ma=new od.a;this.disposed=!1;this.pDb=function(){Ta.ULS.sendTraceTag(537154381,0,50,"PeopleInfoProvider.OnUserListUpdated fired");qb.Ma.raiseEvent("UU",qb)};this.$=Pa;this.$.fa.rga(this.pDb)}function sa(Pa){var qb=gb.call(this)||this;qb.manager=null;qb.$=Pa;qb.dc();return qb}function lb(Pa){var qb=wc.call(this)||this;qb.osa=null;qb.s_a=null;qb.Xsa=!1;qb.dBc=!1;qb.Kf=function(){var tc=qb.$.fa.zn;if(null===
tc||void 0===tc?0:tc.SheetChanges){tc=yl(tc.SheetChanges);for(var dd=tc.next();!dd.done;dd=tc.next())if(dd=dd.value,2===dd.Type){if(qb.osa)for(var Kd=yl(qb.osa),yd=Kd.next();!yd.done;yd=Kd.next())yd=yd.value,yd.Range.SheetName===dd.Name&&(yd.Range.SheetName=dd.NewName);if(qb.s_a)for(Kd=yl(qb.s_a),yd=Kd.next();!yd.done;yd=Kd.next())yd=yd.value,yd.Range.SheetName===dd.Name&&(yd.Range.SheetName=dd.NewName)}}};qb.Ruf=function(){Ta.ULS.sendTraceTag(537154395,0,50,"NamedSheetViewConversionManager.OnGridLoaded");
qb.dBc=!1;qb.dlc(qb,Sys.EventArgs.Empty)};qb.qd=function(){Ta.ULS.sendTraceTag(537154394,0,50,"NamedSheetViewConversionManager.OnWorkbookClosing");qb.dBc=!0};qb.dlc=function(){Ta.ULS.sendTraceTag(50620166,0,50,"NamedSheetViewConversionManager.OnConversionOutdatedEvent: triggered with version [{0}]",qb.$.fa.wxa);if(!qb.$.isEditMode||!qb.$.fa.oc||qb.$.fa.L3a||qb.dBc||qb.$.fa.wxa===Ad.a.c4b)Ta.ULS.sendTraceTag(537154393,0,50,"NamedSheetViewConversionManager.OnConversionOutdatedEvent: Request skipped [Edit Mode: {0}] [IsSessionActive: {1}] [HasRaisedSessionEnded: {2}] [WorkbookClosed: {3}]",
qb.$.isEditMode,qb.$.fa.oc,qb.$.fa.L3a,qb.dBc);else{qb.osa=null;qb.s_a=null;var tc=qb.$.qa.ta.Xb(),dd=qb.$.qa.ta,Kd=qb.dEi,yd=qb.cEi,ze=dd.Oa(1,null);Jf.i(dd,"GetNamedSheetViewConversion",ze,Kd,yd,null,tc,132)}};qb.dEi=function(tc){if(Ce.a.Pq(tc.Errors)){qb.Xsa=!0;var dd=[-1100324317,-1857233882];Ce.a.gh(tc.Errors,dd)&&Ta.ULS.sendTraceTag(537154392,0,10,"NamedSheetViewConversionManager.OnGetNamedSheetViewConversionSuccess Errors: [{0}]",Ce.a.Uc(tc.Errors));tc=Ce.a.jF(tc.Errors,dd,"NamedSheetViewConversionManager:OnGetNamedSheetViewConversionSuccess");
qb.$.fa.Yo(tc)}else qb.Xsa=!1,tc=tc.Result,qb.$.fa.wxa=tc.ConversionVersion,qb.GUi(tc.NamedSheetViewConversionEntries),qb.MWi()};qb.cEi=function(tc){qb.Xsa=!0;tc=Pd.a.yg(tc.data);Ta.ULS.sendTraceTag(537154391,0,10,"NamedSheetViewConversionManager.OnGetNamedSheetViewConversionFailure: Errors: [{0}].",Ce.a.Uc(tc))};qb.$=Pa;Ta.ULS.shipAssertTag(537154397,0,!!qb.$.fa,"NamedSheetViewConversionManager ctor: EwaControl.SessionStateManager should not be null");qb.$.Vl(qb.qd);qb.$.fa.iT(qb.Ruf);qb.$.fa.mBg(qb.dlc);
qb.$.fa.jt(qb.Kf);qb.$.fa.Dt&&qb.dlc(qb,Sys.EventArgs.Empty);return qb}function Yb(Pa,qb,tc){if(!qb||!qb.xb)return null;for(var dd=0;dd<qb.xb.count;dd++){var Kd=qb.xb.getItem(dd);if(Kd&&Kd.type===tc&&Kd.usedRange&&Kd.usedRange.contains(oc.D(Pa))&&ed.a.equals(Kd.sheetName,Pa.SheetName,!0))return Kd}return null}function Fa(Pa,qb){return!!Pa&&!!qb&&Pa.SheetName===qb.SheetName&&(!!Pa.NamedObjectName&&Pa.NamedObjectName===qb.NamedObjectName||!Pa.NamedObjectName&&!qb.NamedObjectName&&oc.D(Pa).Rd(oc.D(qb)))}
function Sa(){}function Ra(Pa,qb,tc,dd,Kd,yd,ze,te,lf){lf=void 0===lf?!1:lf;this.voa=null;this.wGc=!0;this.TMc=this.jEa=this.lDc=null;this.Ya=new od.a;this.fog=Pa;this.Zce=qb;this.lbe=tc;this.jbe=dd;this.l_d=yd;Ra.je=Kd;this.Dpg=ze;this.Zpa=te;this.aqg=lf;Ha.Task.WAA(qb,tc).continueWith(Object(eb.a)(this,this.$2h,"initOnTaskReady"))}function Lb(Pa){var qb=Jd.call(this)||this;qb.K1b=null;qb.VQf=null;qb.wfa=null;qb.f6d=!1;qb.HV=function(tc,dd){if(2===dd.newState){if(qb.Aj){if(cc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")){var Kd=
(new Date).getTime();za.TaskExtensions.Ba(uc.GetServiceTaskFactory.Xa(qb.$.da,435,436,1),function(yd){yd.result.ioi(Kd)},qb.$.ma,3)}qb.raiseEvent("connectionCompleted",new Ja(qb.Aj),dd)}else Ta.ULS.sendTraceTag(537167630,0,15,"RealTimeChannelController.OnConnectionStateChanged: new state is connected and this.RealTimeChannel is null");qb.K1b=dd}else 2!==dd.oldState&&dd.newState||(qb.K1b=null,qb.raiseEvent("connectionLostEventKey"))};qb.Wmc=function(){if(qb.Aj){var tc=Object(E.a)(129,qb.Aj);tc&&(Ta.ULS.sendTraceTag(537167629,
0,50,"RealTimeChannelController.OnWorkbookClosed: disconnecting from RTC"),tc.disconnect(),tc.yqc(qb.HV))}qb.wfa=null};qb.$=Pa;qb.$.Vl(qb.Wmc);qb.$.fa.GTc(qb.Wmc);Pa.da.Za(38,function(tc){tc.tle(qb.Wmc)});return qb}function Ja(Pa){var qb=Ic.call(this)||this;qb.Aj=Pa;return qb}function xb(){}function Kb(Pa,qb,tc,dd,Kd,yd,ze,te,lf){ze=void 0===ze?null:ze;te=void 0===te?null:te;lf=void 0===lf?null:lf;this.Abe={};this.tEc={};this.x7d=new Ua.a;this.Phb=this.Iw=this.oUb=null;this.Oee=this.Nee=0;this.GEa=
new kb.a(function(){return ze.lQ("PresenceBootLatencyThreshold",1E4)});this.tCa=new kb.a(function(){return ze.lQ("PresenceBootLatencyCutoffThreshold",6E4)});this.Xtg=new kb.a(function(){return ze.lQ("PresenceLightupLatencyThreshold",2E3)});this.Qig=new kb.a(function(){return ze.lQ("PresenceLightupLatencyCutoffThreshold",1E4)});this.spg=dd;this.J0d=Pa;this.Yce=qb;this.iqa=tc;this.ai=Kd;this.JSb=te;this.ZBa=yd;this.Jd=lf;this.z_d=!1;this.init()}function Eb(Pa,qb,tc){this.f0d=this.H0d=this.hPb=this.sPb=
this.ITa=0;this._id=Pa;this.GEa=qb;this.tCa=tc;this.QBa=Object(E.a)(String,tb.AFrameworkApplication.Gb.Application)||""}function Hc(Pa,qb,tc,dd,Kd,yd,ze,te,lf){this.Ude=!1;this._id=Pa;this.kp=qb;this.nL=tc;this.BLc=dd;this.fQc=Kd;this.GEa=yd;this.tCa=ze;this.C0d=te;this.ZBa=lf;this.QBa=Object(E.a)(String,tb.AFrameworkApplication.Gb.Application)||""}function Xc(){this.ct=this.vt=this.d=0}function Pc(){this.id=null;this.d=this.tp=this.mp=this.st=this.et=0;this.ct=null;this.vc=!1}function wd(Pa){this.Iw=
null;this.tPb={};this.qTb={};this.Ohb=null;this.iqa=Pa}function Tc(Pa,qb,tc,dd,Kd,yd,ze,te,lf){this.Nae=this.K0d=this.Iw=null;this.qOb=Pa;this.iVb=new wb.a;this.ub=tc;this.uEc=qb;this.LTa=dd;this.ai=Kd;this.LMc=yd;this.iqa=ze;this.Dgg=te;this.O4d=this.L4d=!1;this.CVb=0;this.I0d=1;this.ZBa=lf;this.Fge=this.ub.ra("PeoplesWellExtraButtonInfoIsEnabled");this.QBa=Object(E.a)(String,tb.AFrameworkApplication.Gb.Application)||""}function ub(Pa,qb){this.Mjb=null;this.ISb=!1;this.Mae=Pa;this.vTb=qb}b.r(D);
var fb=b(0),Ta=b(13),eb=b(80),tb=b(5),rc=b(86);ub.prototype.init=function(){var Pa=this;this.Mae.continueWith(function(){Pa.Mjb=Pa.Mae.result;Pa.Mjb.wmb(Object(eb.a)(Pa,Pa.mN,"onUsersUpdated"))})};ub.prototype.mN=function(){this.uSg(this.Mjb.pJa());this.ISb&&this.vTb.IsRealCoauthSession&&this.Mjb.pHd(Object(eb.a)(this,this.mN,"onUsersUpdated"))};ub.prototype.uSg=function(Pa){var qb,tc;var dd=tc=null;Pa=yl(Pa);for(qb=Pa.next();!qb.done;qb=Pa.next()){var Kd=qb.value;if(Kd){if(Kd.isAnonymous||!Kd.email){if(qb=
Kd.clientId,Kd.isAnonymous)if(!tc)tc=qb;else if(qb!==tc&&!this.ISb){this.Cni();this.vTb.IsRealCoauthSession=!0;break}}else qb=Kd.email.toUpperCase();if(!dd)dd=qb;else if(dd!==qb&&!this.vTb.IsRealCoauthSession&&(this.vTb.IsRealCoauthSession=!0,this.ISb))break}}};ub.prototype.Cni=function(){Ta.ULS.sendTraceTag(527556870,302,50,"Multiple guests simultaneously coauthoring");this.ISb=!0;if(tb.AFrameworkApplication.ga.getBooleanFeatureGate("Microsoft.Office.SharedOnline.GuestCoauthFloodgateEnabled",!1)){var Pa=
rc.a.instance.mc("Common.ISystemInitiatedFeedback");Pa&&Pa.execute(function(qb){window.setTimeout(function(){qb.logActivity("MultipleGuestsCoauthoring",null)},5E3)})}};ub.NGg=function(Pa){var qb,tc=null;Pa=yl(Pa);for(qb=Pa.next();!qb.done;qb=Pa.next())if(qb=qb.value)if(qb=qb.isAnonymous||!qb.email?qb.clientId:qb.email.toUpperCase(),!tc)tc=qb;else if(tc!==qb)return!0;return!1};Object(fb.a)(ub,"CoauthTelemetry",null,[317]);var wb=b(139),E=b(84),Mb;(function(Pa){Pa[Pa.badStatePreventedTelemetry=0]="badStatePreventedTelemetry";
Pa[Pa.notImplemented=1]="notImplemented";Pa[Pa.renderHandled=2]="renderHandled";Pa[Pa.renderHandledWithVeto=3]="renderHandledWithVeto"})(Mb||(Mb={}));Object(fb.b)("CoauthorGalleryTelemetryEndResult",Mb);var ka=b(93),bb=b(110),Ga=b(178),Ha=b(55);Tc.prototype.init=function(){var Pa=this;Ha.Task.WAA.call(null,this.iqa,this.uEc,this.LMc).continueWith(function(){Pa.Iw=Pa.iqa.result;Pa.K0d=Pa.uEc.result;Pa.Nae=Pa.LMc.result;Ha.Task.WAA.call(null,Pa.uEc.result.t_c,Pa.LMc.result.byc).continueWith(function(){Pa.I0d=
Pa.K0d.t_c.result;Pa.CVb=Pa.Nae.byc.result;Pa.Iw.wmb(Object(eb.a)(Pa,Pa.Smc,"onUsersUpdatedEventListener"));Pa.Iw.pJa().length&&Pa.mN()})})};Tc.prototype.Smc=function(){this.mN()};Tc.prototype.mN=function(){this.Dgg(this.Iw.pJa())?(this.Iw.pHd(Object(eb.a)(this,this.Smc,"onUsersUpdatedEventListener")),this.NCi(this.L4d)):this.iVb.zw(1);this.L4d=!0};Tc.prototype.NCi=function(Pa){var qb=this;this.O4d?this.i2f.continueWith(function(){Ta.ULS.sendTraceTag(42062996,325,15,"We already attempted to log a render of coauthor gallery: {0}",
Mb[qb.i2f.result])}):(this.O4d=!0,this.eVi(!this.I0d&&!Pa))};Tc.prototype.eVi=function(Pa){Pa?this.LTa.xl(4,Object(eb.a)(this,this.oyd,"onInteractiveReady")):this.iVb.zw(1)};Tc.prototype.oyd=function(){var Pa=this.ai.PG("AppInitStatus_interactivityReady");Ta.ULS.shipAssertTag(42259235,325,!!this.CVb);var qb=this.CVb-Pa;Pa={InteractiveTime:Pa};Pa.ReactRenderComplete=this.CVb;Pa.HadTabSwitch=this.ZBa();Pa.IsModernGallery=this.Fge;Ta.ULS.sendTraceTag(594883104,325,50,bb.a.toJSON(Pa));this.Fge?(Ta.ULS.sendTraceTag(42062997,
325,15,qb.toString()),this.iVb.zw(this.bOj(qb)?3:2)):Ta.ULS.sendTraceTag(594883103,325,15,qb.toString())};Tc.prototype.bOj=function(Pa){var qb=Pa>this.ub.zd("CoauthorGalleryTimeToRenderDurationMs",1E4),tc="Word"===this.QBa;if(this.ZBa())return Ta.ULS.sendTraceTag(50455714,325,50,qb.toString()),!1;tc&&ka.Health.instance.recordKpiUsage("CoauthGalleryExperienceDegraded",0,"wordcollabrel",null);qb&&(tc?ka.Health.instance.recordKpiFailure("CoauthGalleryExperienceDegraded","CoauthorGalleryTimeToRenderDurationIsTooLong",
!1,!0,null):ka.Health.instance.recordQosError("CoauthorGalleryTimeToRenderDurationIsTooLong",["CoauthGalleryExperienceDegraded"],!1,!0,!0,!1,Object.assign(new Ga.a,{inStaging:!0})),Ta.ULS.sendTraceTag(42062998,325,15,Pa.toString()));return qb};tl.Object.defineProperties(Tc.prototype,{i2f:{configurable:!0,enumerable:!0,get:function(){return this.iVb.task}}});Object(fb.a)(Tc,"CoauthorGalleryTelemetry",null,[316]);wd.prototype.oac=function(Pa){var qb=this,tc=new wb.a;this.init().continueWith(function(){Pa in
qb.tPb?tc.zw(qb.tPb[Pa]):qb.qTb[Pa]=tc});return tc.task};wd.prototype.init=function(){var Pa=this;if(this.Ohb)return this.Ohb.task;this.Ohb=new wb.a;this.iqa.continueWith(function(){Pa.Iw=Pa.iqa.result;Pa.Iw.wmb(Object(eb.a)(Pa,Pa.mN,"onUsersUpdated"));Pa.H$f();Pa.Ohb.setResult(null)});return this.Ohb.task};wd.prototype.H$f=function(){var Pa=this.Iw.pJa();Pa.sort(Object(eb.a)(this,this.PWg,"comparePresenceUsers"));this.tPb={};for(var qb=0;qb<Pa.length&&Pa[qb]&&Pa[qb].yka;qb++)this.Gxg(this.tPb,Pa[qb].clientId,
qb)};wd.prototype.Gxg=function(Pa,qb,tc){Pa[qb]=tc;qb in this.qTb&&(this.qTb[qb].zw(tc),delete this.qTb[qb])};wd.prototype.mN=function(){this.H$f()};wd.prototype.PWg=function(Pa,qb){return Pa.yka>qb.yka?1:Pa.yka<qb.yka?-1:0};Object(fb.a)(wd,"CoauthorPositionFinder",null,[315]);var Ua=b(185),kb=b(685);Object(fb.a)(Pc,"PL",null,[]);var $a=b(38);Xc.TTf=function(Pa,qb,tc){var dd=new Xc;dd.d=Pa;dd.vt=qb;dd.ct=tc;return $a.c(dd)};Object(fb.a)(Xc,"VD",null,[]);Hc.prototype.veto=function(Pa){var qb=this;
Ha.Task.WAA(this.BLc,this.fQc).continueWith(function(){if(qb.BLc.result<=qb.fQc.result)Pa.zw(!1);else{var tc=qb.nL-qb.kp,dd=new Pc;dd.id=qb._id;dd.et=qb.nL;dd.st=qb.kp;dd.d=qb.nL-qb.kp;dd.mp=qb.BLc.result;dd.tp=qb.fQc.result;dd.ct=qb.bFh(qb.C0d);dd.vc=qb.ZBa();var Kd=$a.c(dd),yd="Word"===qb.QBa;Ta.ULS.sendTraceTag(42078597,302,15,Kd);if(yd){var ze=new Map;ze.set("data",Kd);ka.Health.instance.recordKpiUsage("PresenceExperienceDegraded",0,"wordcollabrel",ze)}tc>qb.GEa.value&&!qb.Ude&&!dd.vc&&(qb.Ude=
!0,Pa.zw(!0),dd=Object.assign(new Ga.a,{inStaging:!0,extendedProperties:new Map}),dd.extendedProperties.set("data",Kd),yd?ka.Health.instance.recordKpiFailure("PresenceExperienceDegraded","PresenceRenderDurationIsTooLong",!1,!0,dd):ka.Health.instance.recordQosError("PresenceRenderDurationIsTooLong",["PresenceExperienceDegraded"],!1,!0,!1,!1,dd),tc<qb.tCa.value&&Ta.ULS.sendTraceTag(42078598,302,15,Xc.TTf(tc,qb.GEa.value,qb.tCa.value)));Pa.task.isCompleted||Pa.zw(!1)}})};Hc.prototype.bFh=function(Pa){switch(Pa){case 2:return"NonWac";
case 0:return"Unknown";case 1:return"Wac";default:return"Unknown"}};Object(fb.a)(Hc,"PresenceLatencyActivityLogger",null,[]);Eb.prototype.$Yc=function(){!this.lxe&&this.ITa&&this.sPb&&(this.H0d=this.veto(this.sPb,"CoauthGalleryLightupDurationTooLong"));!this.jue&&this.ITa&&this.hPb&&(this.f0d=this.veto(this.hPb,"CanvasPresenceLightupDurationTooLong"))};Eb.prototype.veto=function(Pa,qb){var tc=Pa-this.ITa,dd=new Pc;dd.id=this._id;dd.et=Pa;dd.st=this.ITa;dd.d=tc;var Kd=$a.c(dd);Pa="Word"===this.QBa;
dd="CanvasPresenceLightupDurationTooLong"===qb?"PresenceExperienceDegraded":"CoauthGalleryExperienceDegraded";"CanvasPresenceLightupDurationTooLong"===qb?Ta.ULS.sendTraceTag(572289499,302,15,Kd):Ta.ULS.sendTraceTag(571524118,302,15,Kd);if(Pa){var yd=new Map;yd.set("data",Kd);ka.Health.instance.recordKpiUsage(dd,0,"wordcollabrel",yd)}return tc>this.GEa.value?(yd=Object.assign(new Ga.a,{inStaging:!0,extendedProperties:new Map}),yd.extendedProperties.set("data",Kd),Kd=tc<this.tCa.value,yd.extendedProperties.set("cash",
Kd?"true":"false"),Pa?ka.Health.instance.recordKpiFailure(dd,qb,!1,!0,yd):ka.Health.instance.recordQosError(qb,[dd],!1,!0,!1,!1,yd),Ta.ULS.sendTraceTag(572289500,302,15,Xc.TTf(tc,this.GEa.value,this.tCa.value)),Kd?2:1):3};tl.Object.defineProperties(Eb.prototype,{ODg:{configurable:!0,enumerable:!0,get:function(){return this.ITa},set:function(Pa){this.ITa=Pa;this.$Yc()}},iVg:{configurable:!0,enumerable:!0,get:function(){return this.sPb},set:function(Pa){this.sPb=Pa;this.$Yc()}},FQg:{configurable:!0,
enumerable:!0,get:function(){return this.hPb},set:function(Pa){this.hPb=Pa;this.$Yc()}},lxe:{configurable:!0,enumerable:!0,get:function(){return!!this.H0d}},jue:{configurable:!0,enumerable:!0,get:function(){return!!this.f0d}}});Object(fb.a)(Eb,"PresenceLightupLatencyLogger",null,[]);var Xb=b(54),dc=b(315);Kb.prototype.tgh=function(Pa,qb,tc){var dd=this;tc=void 0===tc?null:tc;var Kd=void 0===Kd?0:Kd;tc&&(Ta.ULS.shipAssertTag(42274970,302,!this.JSb||this.JSb===tc,"_myClientId is already set and you are trying to update it to something different"),
this.JSb=tc);var yd=new wb.a;this.init().continueWith(function(){dd.pIi(Pa);dd.ugh(yd,Pa,qb,Kd)})};Kb.prototype.init=function(){var Pa=this;if(this.Phb)return this.Phb.task;this.Phb=new wb.a;this.ZBa()&&Ta.ULS.sendTraceTag(50951700,302,15,"TabSwitched Session");this.J0d.continueWith(function(){var qb=Pa.J0d.result,tc=qb.t_c,dd=qb.Cti;dd.continueWith(function(){tc.continueWith(function(){Pa.Jd&&Pa.Jd.addQosPillar("RealTimeCoauth");Pa.Axj(tc.result,dd.result);Pa.Phb.setResult(null)})})});this.Yce.continueWith(function(){Pa.oUb=
Pa.Yce.result;Pa.oUb.BXa(Object(eb.a)(Pa,Pa.uJi,"onRtcConnection"));Pa.oUb.IXa(Object(eb.a)(Pa,Pa.AAi,"onCoauthorBootReceived"))});this.iqa.continueWith(function(){Pa.Iw=Pa.iqa.result;Pa.Iw.wmb(Object(eb.a)(Pa,Pa.Smc,"onUsersUpdatedEventListener"));0<Pa.Iw.pJa().length&&Pa.mN()});return this.Phb.task};Kb.prototype.RUe=function(){return this.ai.ksa(Xb.a.TSa)?this.ai.PG(Xb.a.TSa):dc.a.mP?window.performance.timing.fetchStart:-1};Kb.prototype.uJi=function(Pa,qb){this.z_d||2!==qb.newState||(Pa=Date.now()-
this.RUe(),qb={},qb.clientId=this.Bnf,qb.bootTime=Pa,this.z_d=!0,this.oUb.fda(15,qb))};Kb.prototype.AAi=function(Pa,qb){if(15===qb.type){Pa=Date.now();qb=qb.v7;var tc=qb.bootTime;this.qdd(qb.clientId).ODg=Pa-tc}};Kb.prototype.Smc=function(){this.mN()};Kb.prototype.mN=function(){var Pa=Date.now(),qb=this.Iw.pJa(),tc=new Ua.a;qb=yl(qb);for(var dd=qb.next();!dd.done;dd=qb.next())dd=dd.value,this.x7d.contains(dd.clientId)||(this.x7d.add(dd.clientId),tc.add(dd.clientId));if(0<tc.count)for(tc=yl(tc),qb=
tc.next();!qb.done;qb=tc.next())qb=this.qdd(qb.value),qb.lxe||(qb.iVg=Pa)};Kb.prototype.pIi=function(Pa){Pa=this.qdd(Pa);Pa.jue||(Pa.FQg=Date.now())};Kb.prototype.qdd=function(Pa){return Pa in this.tEc?this.tEc[Pa]:this.tEc[Pa]=new Eb(Pa,this.Xtg,this.Qig)};Kb.prototype.Axj=function(Pa,qb){qb=void 0===qb?0:qb;this.Nee=Pa;this.Oee=qb?qb:(new Date).getTime()};Kb.prototype.ugh=function(Pa,qb,tc,dd){tc=tc?tc.getTime():(new Date).getTime();qb in this.Abe?Pa.Az():(dd=new Hc(qb,this.aSh(),tc,this.oac(this.Bnf),
this.oac(qb),this.GEa,this.tCa,dd,this.ZBa),this.Abe[qb]=dd,dd.veto(Pa))};Kb.prototype.aSh=function(){return 1===this.Nee?this.Oee:this.RUe()};Kb.prototype.oac=function(Pa){return this.spg.oac(Pa)};tl.Object.defineProperties(Kb.prototype,{Bnf:{configurable:!0,enumerable:!0,get:function(){return this.JSb||"{"+tb.AFrameworkApplication.userSessionId+"}"}}});Object(fb.a)(Kb,"PresenceBootTelemetry",null,[314]);var Za=b(144),Wa=b(274),Ba=b(213),db=b(524);xb.prototype.di=function(Pa){var qb=this;Pa.register(ub,
"Common.App.CoauthTelemetry.CoauthTelemetry").as("Common.App.CoauthTelemetry.ICoauthTelemetry").zc().Ic(function(){return new ub(db.a.Fq(Pa.mc("Common.IPeopleInfoProvider")),tb.AFrameworkApplication.Zf)});Pa.register(Tc,"Common.App.CoauthTelemetry.CoauthorGalleryTelemetry").as("Common.ICoauthorGalleryTelemetry").zc().Ic(function(){return new Tc(tb.AFrameworkApplication.Eb,db.a.Fq(Pa.mc("Common.ICoauthoringTelemeryInfoProvider")),tb.AFrameworkApplication.ga,Za.a.get_instance(),Ba.a.instance,db.a.Fq(Pa.mc("Common.IPeoplesWell")),
db.a.Fq(Pa.mc("Common.IPeopleInfoProvider")),ub.NGg,function(){return qb.Nre()})});Pa.register(Kb,"Common.App.CoauthTelemetry.PresenceBootTelemetry").as("Common.App.CoauthTelemetry.IPresenceBootTelemetry").zc().Ic(function(){return new Kb(db.a.Fq(Pa.mc("Common.ICoauthoringTelemeryInfoProvider")),db.a.Fq(Pa.mc("Common.IRealtimeChannelBasic")),db.a.Fq(Pa.mc("Common.IPeopleInfoProvider")),Pa.resolve("Common.App.CoauthTelemetry.ICoauthorPositionFinder"),Ba.a.instance,function(){return qb.Nre()},tb.AFrameworkApplication.ga,
null,ka.Health.instance)});Pa.register(wd,"Common.App.CoauthTelemetry.CoauthorPositionFinder").as("Common.App.CoauthTelemetry.ICoauthorPositionFinder").zc().Ic(function(){return new wd(db.a.Fq(Pa.mc("Common.IPeopleInfoProvider")))})};xb.prototype.init=function(){tb.AFrameworkApplication.ga.$v(function(){rc.a.instance.resolve("Common.App.CoauthTelemetry.CoauthTelemetry").init();tb.AFrameworkApplication.ga.ra("CoauthorGalleryTelemetryIsEnabled")&&rc.a.instance.resolve("Common.ICoauthorGalleryTelemetry").init();
tb.AFrameworkApplication.ga.ra("CashTelemetryIsEnabled")&&(rc.a.instance.resolve("Common.App.CoauthTelemetry.IPresenceBootTelemetry"),rc.a.instance.resolve("Common.App.CoauthTelemetry.ICoauthorPositionFinder"))})};xb.prototype.dispose=function(){};xb.prototype.Nre=function(){return dc.a.mP&&Ba.a.instance.ksa(Xb.a.GMb)?0<Ba.a.instance.PG(Xb.a.GMb)[Xb.a.Rbg]:!1};xb.main=function(){Wa.a.instance.mj(new xb)};tl.Object.defineProperties(xb.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.CoauthTelemetry"}}});
Object(fb.a)(xb,"CoauthTelemetryPackage",null,[4,5]);var Zb=b(934),Jb=b(36),Ic=Sys.EventArgs;vm(Ja,Ic);Object(fb.a)(Ja,"ConnectionCompletedEventArgs",Sys.EventArgs,[]);var uc=b(56),za=b(35),pb=b(51),cc=b(1),Ac=b(48),ad=b(1232),Jd=Jb.a;vm(Lb,Jd);Lb.prototype.CXb=function(Pa){this.addHandler("connectionCompleted",Pa)};Lb.prototype.EGd=function(Pa){this.removeHandler("connectionCompleted",Pa)};Lb.prototype.CTc=function(Pa){this.addHandler("rtcInitialized",Pa)};Lb.prototype.oGb=function(Pa){this.removeHandler("rtcInitialized",
Pa)};Lb.prototype.xke=function(Pa){this.addHandler("connectionLostEventKey",Pa)};Lb.prototype.fMf=function(Pa){this.removeHandler("connectionLostEventKey",Pa)};Lb.prototype.dispose=function(){this.Aj&&this.Aj.yqc(this.HV);this.$&&this.$.Fn(this.Wmc);this.wfa=this.$=null;Jd.prototype.dispose.call(this)};Lb.prototype.XBe=function(Pa){za.TaskExtensions.Ba(this.h_e().task,function(qb){Pa(qb.result)},this.ma)};Lb.prototype.Oye=function(Pa,qb){this.f6d=qb;this.HGi(Pa)};Lb.prototype.EZa=function(){this.Aj&&
(this.raiseEvent("rtcInitialized"),2===this.Aj.connectionState&&this.K1b&&this.raiseEvent("connectionCompleted",new Ja(this.Aj),this.K1b))};Lb.prototype.tli=function(){Ta.ULS.sendTraceTag(537167633,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice");if(cc.EwaSettings.isChangeGateEnabled("OfficeVSO:5856505_RtcDownloadBreakDownMetrics")){var Pa=(new Date).getTime();za.TaskExtensions.Ba(uc.GetServiceTaskFactory.Xa(this.$.da,435,436,1),function(dd){dd.result.loi(Pa)},this.$.ma,3)}var qb=[];qb.push(pb.a.current.eo(43));
qb.push(pb.a.current.eo(44));qb=pb.a.srd(qb,this.$.ma);var tc=pb.a.loadScript(10,0,1);return Ha.Task.WAA.call(null,qb,tc)};Lb.prototype.HGi=function(Pa){var qb=this,tc=this.tli();za.TaskExtensions.Ba(tc,function(){Ta.ULS.sendTraceTag(537167632,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice Before RealtimeChannel create. RealtimeChannel = null: {0}",void 0===Zb.RealtimeChannel||null===Zb.RealtimeChannel);if(cc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")){var dd=
(new Date).getTime();za.TaskExtensions.Ba(uc.GetServiceTaskFactory.Xa(qb.$.da,435,436,1),function(ze){ze.result.moi(dd)},qb.$.ma,3)}qb.wfa=Zb.RealtimeChannel.createInstance(Pa,qb.$.ya.UserSessionId,tb.AFrameworkApplication.WQf,tb.AFrameworkApplication.Hd,null,2,Ac.b().g1e(),qb.$.workbookContext.RtcEndpointUrl,void 0,new ad.a,void 0,void 0,qb.$.workbookContext.RtcBootToken);Ta.ULS.sendTraceTag(571770432,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice RealtimeChannel created");cc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EditorsTableNotification",
!1)&&(rc.a.instance.register(Zb.RealtimeChannel,"AppRealtimeChannel.RealtimeChannel").as("Common.IRealtimeChannelBasic").as("AppRealtimeChannel.IRealtimeChannel").zc().Ic(function(){return qb.Aj}),rc.a.instance.resolve("Common.IRealtimeChannelBasic"));qb.h_e().setResult(qb.Aj);if(cc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")){var Kd=(new Date).getTime();za.TaskExtensions.Ba(uc.GetServiceTaskFactory.Xa(qb.$.da,435,436,1),function(ze){ze.result.koi(qb.$kd,Kd)},
qb.$.ma,3)}qb.raiseEvent("rtcInitialized");Ta.ULS.sendTraceTag(571770403,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice raise RealTimeChannelInitializedEventKey");var yd=Object(E.a)(129,qb.Aj);yd&&(Ta.ULS.sendTraceTag(571770402,0,50,"RealTimeChannelController.OnLoadRealTimeChannelSlice attach changed handler"),yd.BXa(qb.HV),yd.connect())},this.ma,3)};Lb.prototype.h_e=function(){return this.VQf||(this.VQf=new wb.a)};Lb.ja=function(Pa){Pa.da.Ha(26,new Lb(Pa))};tl.Object.defineProperties(Lb.prototype,
{Aj:{configurable:!0,enumerable:!0,get:function(){return this.wfa}},$kd:{configurable:!0,enumerable:!0,get:function(){return this.f6d}}});Object(fb.a)(Lb,"RealTimeChannelController",Jb.a,[9,10]);var Xd=b(10),od=b(94),Je=b(109),bc=b(29);Ra.prototype.UHf=function(){this.Ya.raiseEvent("u",null,this)};Ra.prototype.$2h=function(){this.Zce.result&&this.lbe.result&&(this.jEa=this.Zce.result,this.TMc=this.lbe.result,this.jEa.fFa(Object(eb.a)(this,this.xla,"onPresenceUpdated")),this.lDc=new Je.a(2,2,this.l_d,
Object(eb.a)(this,this.mIj,"updateAwayClientsTask"),88),Ra.je.fh(this.lDc))};Ra.prototype.xla=function(Pa,qb){(this.wGc||this.MZi(qb.iO))&&Ra.je.kma(this.lDc,0)};Ra.prototype.MZi=function(Pa){for(var qb in Pa){var tc=this.jbe.zZe({key:qb,value:Pa[qb]});if(tc&&tc.clientId&&(tc=tc.clientId.toLowerCase(),(tc=this.voa[tc]||this.voa[tc.toUpperCase()])&&2===tc.status))return!0}return!1};Ra.prototype.mIj=function(Pa){var qb=this.jEa.KCh();if(qb){var tc=new Date,dd=!1;if(this.wGc){this.voa=qb;this.wGc=!1;
qb=this.voa;for(var Kd in qb){var yd=Kd,ze=qb[Kd];ze.I6a<tc&&(tc=ze.I6a);2===ze.status&&(dd=!0,this.TMc.NLf(yd))}dd&&this.UHf();Ra.je.kma(Pa,this.AYe(tc))}else{ze=new Ua.a;Kd=!1;var te=this.voa;for(yd in te)if(te=yd,te in this.voa&&this.fog.clientId!==te){var lf=this.voa[te],bf=qb[te];if(lf&&bf){lf=lf.status;var xf=bf.status;2===lf&&1===xf?(ze.add(te),Ta.ULS.sendTraceTag(38052609,392,50,te+" returned from away")):1===lf&&2===xf&&(Kd=dd=!0,this.TMc.NLf(te),Ta.ULS.sendTraceTag(38052610,392,50,te+" went away"));
1===xf&&bf.I6a<tc&&(tc=bf.I6a)}}this.voa=qb;Ra.je.kma(Pa,this.AYe(tc));(0<ze.count||dd)&&this.UHf();0<ze.count&&!this.aqg?(Pa=this.gFh(ze),this.GCj(Pa)):Pa=new Ua.a;(Kd||0<Pa.count)&&this.Dpg(bc.a.s_c,2)}}};Ra.prototype.GCj=function(Pa){if(Pa.count){Pa=yl(Pa);for(var qb=Pa.next();!qb.done;qb=Pa.next())qb=this.Zpa.l$(String.format(CommonUIStrings.l_EditorsToastArriving,qb.value),!1),qb.image=5,qb.Gja="CoAuth_AuthorStatus_16x16x32",this.Zpa.BD(qb)}};Ra.prototype.gFh=function(Pa){var qb=this.jEa.ebd(),
tc=new Ua.a,dd;for(dd in qb){var Kd={key:dd,value:qb[dd]};if(Pa.contains(Kd.key)){var yd=this.jbe.zZe(Kd);yd&&(tc.add(yd.userName),Pa.remove(Kd.key))}}tc.count||Ta.ULS.sendTraceTag(38052611,392,10,"There were no coauthor names found");return tc};Ra.prototype.AYe=function(Pa){var qb=new Date;return Math.max(Pa.getTime()+this.l_d-qb.getTime(),0)};Ra.je=null;Object(fb.a)(Ra,"AwayManager",null,[]);var Qd=b(1299),Vd=b(98),de=b(282),pe=b(216);Object(fb.a)(Sa,"NamedSheetViewConversionEntry",null,[]);var Ad=
b(9),Pd=b(126),Ce=b(27),Jf=b(81),oc=b(43),ed=b(19),wc=Jb.a;vm(lb,wc);lb.prototype.gle=function(Pa){this.addHandler("SVCU",Pa)};lb.prototype.JMf=function(Pa){this.removeHandler("SVCU",Pa)};lb.prototype.dispose=function(){this.s_a=this.osa=null;this.$&&this.$.Fn(this.qd);this.$.fa&&(this.$.fa.rR(this.Ruf),this.$.fa.q5i(this.dlc),this.$.fa.mw(this.Kf));this.$=null;wc.prototype.dispose.call(this)};lb.prototype.oZg=function(Pa){return this.Xsa?null:this.zze(Pa,this.s_a,"ConvertPresencePublicToPrivate")};
lb.prototype.nZg=function(Pa){return this.Xsa?null:this.zze(Pa,this.osa,"ConvertPresencePrivateToPublic")};lb.prototype.GUi=function(Pa){Pa?(this.p8g(Pa),this.osa=Pa,this.s_a=this.B2g(this.osa)):Ta.ULS.sendTraceTag(537154396,0,10,"NamedSheetViewConversionManager.ProcessConversionEntries: conversionEntries can be empty but not null")};lb.prototype.MWi=function(){Ta.ULS.sendTraceTag(537154390,0,50,"NamedSheetViewConversionManager.RaiseConversionUpdatedEvent: new version is update on client from server");
this.raiseEvent("SVCU")};lb.prototype.zze=function(Pa,qb,tc){if(!qb||!qb.length)return Ta.ULS.sendTraceTag(537154389,0,50,"NamedSheetViewConversionManager.{0}: skipping convert due to {1} ConversionEntries. ",tc,qb?"empty":"null"),Pa;tc=yl(Pa);for(var dd=tc.next();!dd.done;dd=tc.next()){dd=dd.value;for(var Kd=yl(qb),yd=Kd.next();!yd.done;yd=Kd.next())if(yd=yd.value,yd.IsRow&&Fa(yd.Range,dd)&&!(dd.FirstRow<=yd.Range.FirstRow&&dd.LastRow>=yd.Range.LastRow)){var ze={};ze.SheetName=dd.SheetName;ze.FirstRow=
ze.LastRow=dd.FirstRow;ze.FirstColumn=ze.LastColumn=dd.FirstColumn;Fa(yd.Range,ze)?(ze=dd.FirstRow-yd.Range.FirstRow,0>ze||ze>=yd.ConversionMap.length?Ta.ULS.sendTraceTag(537154388,0,10,"NamedSheetViewConversionManager.ConvertRanges: invalid mapIndex after adjust. Index: [{0}], ConversionMap.Length: {1}",ze,yd.ConversionMap.length):(ze=yd.ConversionMap[ze]-ze,dd.FirstRow+=ze,dd.LastRow=dd.FirstRow,dd.LastColumn=Math.min(dd.LastColumn,yd.Range.LastColumn))):dd.FirstRow<yd.Range.FirstRow&&dd.LastRow>=
yd.Range.FirstRow?dd.LastRow=yd.Range.FirstRow-1:dd.LastColumn>=yd.Range.FirstColumn&&(dd.LastColumn=yd.Range.FirstColumn-1)}if(0>dd.FirstRow||dd.FirstRow>Ad.a.dz)dd.FirstRow=Math.max(Math.min(dd.FirstRow,Ad.a.dz),0);if(0>dd.LastRow||dd.LastRow>Ad.a.dz)dd.LastRow=Math.max(Math.min(dd.LastRow,Ad.a.dz),0);if(0>dd.FirstColumn||dd.FirstColumn>Ad.a.ew)dd.FirstColumn=Math.max(Math.min(dd.FirstColumn,Ad.a.ew),0);if(0>dd.LastColumn||dd.LastColumn>Ad.a.ew)dd.LastColumn=Math.max(Math.min(dd.LastColumn,Ad.a.ew),
0)}return Pa};lb.prototype.B2g=function(Pa){if(!Pa||!Pa.length)return Ta.ULS.sendTraceTag(537154387,0,50,"NamedSheetViewConversionManager.CreateInverseConversionEntries: skip creating inverse due to {0} ConversionEntries. ",this.osa?"empty":"null"),Pa;for(var qb=Array(Pa.length),tc=0;tc<Pa.length;++tc){var dd=new Sa;dd.Range=Pa[tc].Range;dd.IsRow=Pa[tc].IsRow;dd.ConversionMap=Array(Pa[tc].ConversionMap.length);dd.IsRow||(this.Xsa=!0,Ta.ULS.sendTraceTag(537154386,0,10,"NamedSheetViewConversionManager.CreateInverseConversionEntries: adjusting presence against column sort map is NYI."));
for(var Kd=0;Kd<Pa[tc].ConversionMap.length;++Kd)dd.ConversionMap[Pa[tc].ConversionMap[Kd]]=Kd;qb[Pa.length-tc-1]=dd}return qb};lb.prototype.p8g=function(Pa){if(Pa&&Pa.length){Pa=yl(Pa);for(var qb=Pa.next();!qb.done;qb=Pa.next()){qb=qb.value;this.o8g(qb);var tc=qb.IsRow?qb.Range.LastRow-qb.Range.FirstRow+1:qb.Range.LastColumn-qb.Range.FirstColumn+1;qb.ConversionMap.length!==tc&&(Ta.ULS.shipAssertTag(537154385,0,!1,"NamedSheetViewConversionManager.DecompressEntries: decompressed conversion map doesn't match expected size - Expected: [{0}] | Actual: [{1}]",
tc,qb.ConversionMap.length),this.Xsa=!0)}}};lb.prototype.o8g=function(Pa){var qb=Pa.ConversionMap;if(qb&&qb.length)if(0>qb[0])Ta.ULS.shipAssertTag(537154384,0,!1,"NamedSheetViewConversionManager.DecompressConversionMap: conversionMap starts with a negative number"),this.Xsa=!0;else{for(var tc=[],dd=0;dd<qb.length;++dd)if(0>qb[dd])for(var Kd=qb[dd-1],yd=-1*qb[dd],ze=1;ze<=yd;++ze)Array.add(tc,Kd+ze);else Array.add(tc,qb[dd]);Pa.ConversionMap=tc}};Object(fb.a)(lb,"NamedSheetViewConversionManager",Jb.a,
[426,3]);var gb=pe.a;vm(sa,gb);sa.prototype.create=function(){this.Fb(this.manager||(this.manager=new lb(this.$)))};Object(fb.a)(sa,"NamedSheetViewConversionManagerFactory",pe.a,[]);var id=b(88),ib=b(1141);xa.prototype.dispose=function(){this.disposed||(this.$&&this.$.fa&&this.$.fa.Pca(this.pDb),id.a.pc([this.Ma]),this.$=this.Ma=null,this.disposed=!0)};xa.prototype.wmb=function(Pa){this.Ma.addHandler("UU",Pa)};xa.prototype.pHd=function(Pa){this.Ma.removeHandler("UU",Pa)};xa.prototype.pJa=function(){for(var Pa=
[],qb=yl(this.$.fa.Em),tc=qb.next();!tc.done;tc=qb.next())tc=tc.value,tc=new Qd.a(tc.User.UserID,tc.User.UserName,tc.UserColor,new ib.a(1),null,tc.UserEmail,void 0,void 0,void 0,void 0,void 0,tc.JoinCoauthTime),Array.add(Pa,tc);Ta.ULS.sendTraceTag(537154383,0,50,"PeopleInfoProvider.GetAllUsers: Count: [{0}]",Pa.length);return Pa};Object(fb.a)(xa,"PeopleInfoProvider",null,[404,3]);var nc=b(683);ta.prototype.BD=function(){Ta.ULS.sendTraceTag(537154380,0,50,"PresenceBootstrapper.AddNotificationBarEntry: User state changed from inactive to active")};
ta.prototype.removeEntry=function(){};ta.prototype.l$=function(Pa,qb){return new nc.a(Pa,qb)};ta.prototype.dispose=function(){};tl.Object.defineProperties(ta.prototype,{isVisible:{configurable:!0,enumerable:!0,get:function(){return!1}}});tl.Object.defineProperties(ta,{instance:{configurable:!0,enumerable:!0,get:function(){ta.Na||(ta.Na=new ta);return ta.Na}}});ta.Na=null;Object(fb.a)(ta,"NoOpNotificationBar",null,[403,3]);Fb.prototype.zZe=function(Pa){var qb=Pa.key;Pa=Pa.value;if(!Pa)return null;
var tc=Pa.SupportsChat?4:0;return Object.assign(new Qd.a,{clientId:qb,ZYc:Pa.ChatThreadId,YYc:Pa.ChatThreadDiscoveryUri,qwb:Pa.InChat,email:Pa.Cid,capabilities:new ib.a(tc)})};Object(fb.a)(Fb,"PresenceConverter",null,[425]);var Nb=pe.a;vm(Qb,Nb);Qb.prototype.create=function(){this.Fb(this.Jze||(this.Jze=new Fb))};Qb.ja=function(Pa){Pa.da.Ha(159,new Qb)};Object(fb.a)(Qb,"PresenceConverterFactory",pe.a,[]);var mb=b(125),Lc=b(127);Gb.prototype.loi=function(Pa){this.TQf||(this.BJd=Pa,this.TQf=!0)};Gb.prototype.moi=
function(Pa){this.UQf||(this.ksc=Pa,this.UQf=!0)};Gb.prototype.koi=function(Pa,qb){this.OQf||(this.iHb=qb,this.sdf=Pa,this.OQf=!0)};Gb.prototype.ioi=function(Pa){this.xJd||(this.gHb=Pa,this.xJd=!0)};Gb.prototype.Rni=function(Pa){!this.aCd&&this.xJd&&(this.bCd=Pa,this.aCd=!0)};Gb.prototype.Oni=function(Pa){this.ZCf||(this.PAd=Pa,this.ZCf=!0)};Gb.prototype.Qni=function(Pa){if(!this.LEf&&this.xga&&!this.pgc){this.LEf=!0;var qb=this.Ibd();qb.RtcIntializeToPeopleWellServiceCreate=this.PAd-this.iHb;qb.PeopleWellServiceCreateToPresenceGalleryRender=
Pa-this.PAd;qb.PresenceGalleryRenderTotalTime=Pa-this.xga;Lc.b(this.$).ae(mb.a.MEf,qb,void 0,!0)}};Gb.prototype.Tni=function(Pa){if(!this.PEf&&this.xga&&!this.pgc){this.PEf=!0;var qb=this.Ibd();qb.RtcIntializeToRtcConnect=this.gHb-this.iHb;qb.RtcConnectToPresenceSent=Pa-this.gHb;qb.PresenceSentTotalTime=Pa-this.xga;Lc.b(this.$).ae(mb.a.QEf,qb,void 0,!0)}};Gb.prototype.Sni=function(Pa){if(!this.NEf&&this.aCd&&this.xga&&!this.pgc){this.NEf=!0;var qb=this.Ibd();qb.RtcIntializeToRtcConnect=this.gHb-this.iHb;
qb.RtcConnectToPresenceRenderInitiate=this.bCd-this.gHb;qb.PresenceRenderInitiateToPresenceRenderFinish=Pa-this.bCd;qb.PresenceRenderTotalTime=Pa-this.xga;Lc.b(this.$).ae(mb.a.OEf,qb,void 0,!0)}};Gb.prototype.dispose=function(){this.$=null};Gb.prototype.Ibd=function(){var Pa={};Pa.CoAuthorCountsOnBoot=this.$.fa.Em.length;Pa.RtcConnectedLaterInSession=this.sdf;Pa.BrowserVisibilityChanged=this.hLg();Pa.AppInteractiveAbsTime=this.xga;Pa.NavigationStartTime=this.ivd;Pa.AppInteractiveToRtcSliceDownloadInitialize=
this.BJd-this.xga;Pa.RtcSliceDownloadInitializeToRtcSliceLoad=this.ksc-this.BJd;Pa.AppInteractiveToRtcSliceLoad=this.ksc-this.xga;Pa.RtcSliceLoadToRtcInitialize=this.iHb-this.ksc;return Pa};Gb.prototype.hLg=function(){return dc.a.mP&&Ba.a.instance.ksa(Xb.a.GMb)?0<Ba.a.instance.PG(Xb.a.GMb)[Xb.a.Rbg]:!1};tl.Object.defineProperties(Gb.prototype,{xga:{configurable:!0,enumerable:!0,get:function(){if(this.mob)return this.mob;Ba.a.instance.ksa("AppInitStatus_interactivityReady")&&(this.mob=Ba.a.instance.PG("AppInitStatus_interactivityReady"));
this.mob||Ta.ULS.sendTraceTag(537154378,0,15,"App interactive time is zero");return this.mob}}});Object(fb.a)(Gb,"PresenceTelemetry",null,[424,3]);var zd=pe.a;vm(hb,zd);hb.prototype.create=function(){this.Fb(this.$.da.Aa(435)||this.$.da.Ha(435,new Gb(this.$)))};hb.ja=function(Pa){Pa.da.Ha(436,new hb(Pa))};Object(fb.a)(hb,"PresenceTelemetryFactory",pe.a,[]);var jd=b(1298),ge=b(44),Yd=b(42),rd=b(26),je=b(113),re=b(14),ae=b(20),Uf=b(74),Lf=Jb.a;vm(ya,Lf);ya.prototype.dispose=function(){this.raiseEvent("userPresenceChanged");
this.raiseEvent("userLeft");this.ZMc=this.kqa=this.Bge=null;Lf.prototype.dispose.call(this)};tl.Object.defineProperties(ya.prototype,{KMb:{configurable:!0,enumerable:!0,get:function(){return this.Bge}},uc:{configurable:!0,enumerable:!0,get:function(){return this.kqa||{}},set:function(Pa){this.ZMc=this.kqa;this.kqa=Pa;this.raiseEvent("userPresenceChanged")}},zCd:{configurable:!0,enumerable:!0,get:function(){return this.ZMc}}});Object(fb.a)(ya,"UserPresence",Jb.a,[]);var Of=Uf.a;vm(da,Of);da.prototype.bNd=
function(Pa){this.kbe=Pa};da.prototype.EXf=function(Pa){this.mbe=Pa};da.prototype.FZa=function(){};da.prototype.W2a=function(){return null};da.prototype.Acd=function(){return null};da.prototype.B0f=function(){};da.prototype.C0f=function(){};da.prototype.E$f=function(){};da.prototype.Mvc=function(){};da.prototype.gcc=function(){};da.JKj=function(Pa,qb){var tc=Pa.Bz.uc;id.a.pc(Pa.Sx);id.a.pc([Pa.Bz]);Pa.Bz=null;Pa.Bz=new ya(qb);Pa.bNd([]);Pa.EXf(qb);Pa.uc=tc};tl.Object.defineProperties(da.prototype,
{Sx:{configurable:!0,enumerable:!0,get:function(){return this.kbe}},Pp:{configurable:!0,enumerable:!0,get:function(){return this.mbe}},uc:{configurable:!0,enumerable:!0,get:function(){return this.Bz.uc},set:function(Pa){this.Bz.uc=Pa}}});Object(fb.a)(da,"IUserGridPresence",Uf.a,[]);var Yf;(function(Pa){Pa[Pa.multipleBrowsersImageClassName=0]="multipleBrowsersImageClassName";Pa[Pa.peopleImageClassName=1]="peopleImageClassName";Pa[Pa.peopleImageClusterPath=4]="peopleImageClusterPath";Pa[Pa.multipleBrowserImageClusterPath=
5]="multipleBrowserImageClusterPath";Pa[Pa.imageDimension=6]="imageDimension";Pa[Pa.rtl=8]="rtl";Pa[Pa.pointerInputManager=9]="pointerInputManager";Pa[Pa.clickInputManager=10]="clickInputManager";Pa[Pa.vertical=11]="vertical";Pa[Pa.zIndex=12]="zIndex";Pa[Pa.contextMenuInputManager=13]="contextMenuInputManager";Pa[Pa.imageDomElement=14]="imageDomElement";Pa[Pa.useIdleTooltip=15]="useIdleTooltip";Pa[Pa.viewportBoundsCallback=16]="viewportBoundsCallback";Pa[Pa.flipHorizontalDirection=17]="flipHorizontalDirection";
Pa[Pa.fixRemoveFadeOutElementCrash=18]="fixRemoveFadeOutElementCrash";Pa[Pa.ignoreEventOnExpandedTooltip=19]="ignoreEventOnExpandedTooltip";Pa[Pa.ipWidthAdjustForFlyout=20]="ipWidthAdjustForFlyout"})(Yf||(Yf={}));Object(fb.b)("PresenceTooltipSettingKeys",Yf);Tb.prototype.get=function(Pa,qb){Pa=Yf[Pa];return"number"===typeof(void 0===qb?null:qb)?(qb=this.BO[Pa])?Number.parseInvariant(qb.toString()):0:this.BO[Pa]};Tb.prototype.add=function(Pa,qb){this.BO[Yf[Pa]]=qb};Tb.prototype.vXa=function(Pa,qb){Yf[Pa]in
this.BO||(this.BO[Yf[Pa]]=qb)};Tb.prototype.remove=function(Pa){delete this.BO[Yf[Pa]]};Object(fb.a)(Tb,"PresenceTooltipSettings",null,[]);var vg=od.a;vm(Sb,vg);Sb.prototype.dispose=function(){this.element&&this.element.parentNode&&this.element.parentNode.removeChild(this.element);this.element=null;vg.prototype.dispose.call(this)};Sb.prototype.createElement=function(Pa){return this.element.ownerDocument.createElement(Pa)};Sb.prototype.Twc=function(){return!0};Sb.V4g=function(Pa){return"prControl"+
(Pa?"Rtl":"")};tl.Object.defineProperties(Sb.prototype,{element:{configurable:!0,enumerable:!0,get:function(){return this._element},set:function(Pa){this._element=Pa}},visible:{configurable:!0,enumerable:!0,get:function(){return"visible"===this.element.style.visibility},set:function(Pa){this.element.style.visibility=Pa?"visible":"hidden"}},rtl:{configurable:!0,enumerable:!0,get:function(){return"rtl"===this.element.dir.toLowerCase()},set:function(Pa){this.element.dir=Pa?"rtl":"ltr"}},zIndex:{configurable:!0,
enumerable:!0,get:function(){return this.element.style.zIndex},set:function(Pa){this.element.style.zIndex=String(Pa)}}});Object(fb.a)(Sb,"BasePresenceControl",od.a,[3,482]);var Af=Sys.EventArgs;vm(Xa,Af);Xa.Rja="InteractivityChanged";Object(fb.a)(Xa,"InteractivityChangedEventArgs",Sys.EventArgs,[]);Cb.KGh=function(Pa){return Cb.LGh(Pa)};Cb.LGh=function(Pa){var qb=document.createElementNS(Cb.TXd,"svg");qb.setAttribute("viewBox",String.format(Cb.j7g,Cb.Kbg,Cb.Jbg));qb.appendChild(Cb.BSh(Pa));return qb};
Cb.BSh=function(Pa){var qb=Cb.Kbg/Pa,tc=2*qb,dd=Cb.Jbg/2;Pa=(Pa-12-8)*qb/2;var Kd=document.createElementNS(Cb.TXd,"g");Sys.UI.DomElement.addCssClass(Kd,Cb.i7g);for(var yd=1;3>=yd;yd++)Kd.appendChild(Cb.ZEh(yd,tc,Pa+(6*yd-2)*qb,dd));return Kd};Cb.ZEh=function(Pa,qb,tc,dd){var Kd=document.createElementNS(Cb.TXd,"circle");Sys.UI.DomElement.addCssClass(Kd,String.format("{0}-{1}",Cb.dTg,Pa));Kd.setAttribute("cx",String.format("{0}",tc));Kd.setAttribute("cy",String.format("{0}",dd));Kd.setAttribute("r",
String.format("{0}",qb));return Kd};Cb.TXd="http://www.w3.org/2000/svg";Cb.i7g="prDancingDots";Cb.dTg="prAnimateCircle";Cb.j7g="0 0 {0} {1}";Cb.Jbg=40;Cb.Kbg=120;Object(fb.a)(Cb,"ModernPresenceTooltipDancingDots",null,[]);var rf=b(157),Cg=b(369),sc=b(12),Rc=b(89),Qc=b(165),ee=b(87),ue=b(28);vm(ob,Sb);ob.prototype.jTc=function(Pa){this.addHandler(Xa.Rja,Pa)};ob.prototype.Iqc=function(Pa){this.removeHandler(Xa.Rja,Pa)};ob.prototype.dispose=function(){this.element&&(this.Vg.za(sc.a.click,this.element,
Object(eb.a)(this,this.Vc,"onClick")),this.Vg.za(sc.a.Ij,this.element,Object(eb.a)(this,this.Twc,"stopPropagationAndPreventDefaultBehavior")),this.Sz.za(sc.a.pointerDown,this.element,Object(eb.a)(this,this.onPointerDown,"onPointerDown")),this.Sz.za(sc.a.pointerOut,this.element,Object(eb.a)(this,this.kN,"onPointerOut")),this.Sz.za(sc.a.pointerOver,this.element,Object(eb.a)(this,this.hw,"onPointerOver")),this.QEc.za(this.element,Object(eb.a)(this,this.Twc,"stopPropagationAndPreventDefaultBehavior")));
Sb.prototype.dispose.call(this)};ob.prototype.Wu=function(Pa){this.Vg=Pa.get(10);this.Vg.pa(sc.a.click,this.element,Object(eb.a)(this,this.Vc,"onClick"));this.Vg.pa(sc.a.Ij,this.element,Object(eb.a)(this,this.Twc,"stopPropagationAndPreventDefaultBehavior"));this.Sz=Pa.get(9);this.Sz.pa(sc.a.pointerOver,this.element,Object(eb.a)(this,this.hw,"onPointerOver"));this.Sz.pa(sc.a.pointerOut,this.element,Object(eb.a)(this,this.kN,"onPointerOut"));this.Sz.pa(sc.a.pointerDown,this.element,Object(eb.a)(this,
this.onPointerDown,"onPointerDown"));this.QEc=Pa.get(13);this.QEc.pa(this.element,Object(eb.a)(this,this.Twc,"stopPropagationAndPreventDefaultBehavior"))};ob.prototype.hide=function(Pa,qb,tc){Pa=void 0===Pa?null:Pa;qb=void 0===qb?0:qb;tc=void 0===tc?0:tc;this.Ftg&&Pa?this.Esj(Pa,qb,tc):(3===this.state&&this.nLf(),this.visible=!1,this._state=5)};ob.prototype.Esj=function(Pa,qb,tc){this.show(Pa,qb,15,4,void 0,void 0===tc?0:tc)};ob.prototype.e_f=function(Pa,qb,tc,dd,Kd,yd){this.show(Pa,qb,20,(void 0===
tc?0:tc)?2:(void 0===dd?0:dd)?1:0,void 0===Kd?!1:Kd,void 0===yd?0:yd)};ob.prototype.asj=function(Pa,qb,tc,dd,Kd){this.show(Pa,qb,tc+20,3,void 0===dd?!1:dd,void 0===Kd?0:Kd)};ob.prototype.show=function(Pa,qb,tc,dd,Kd,yd){dd=void 0===dd?3:dd;yd=void 0===yd?0:yd;!Pa||dd===this.state&&this.XZh(qb,tc)||(this.awg(dd,void 0===Kd?!1:Kd,yd),this.xXa(Pa,dd,yd),this._state=dd,4===yd||!yd&&!this.OI?this.element.style.left=qb+"px":this.element.style.right=qb+"px",this.element.style.top=tc+"px",this.visible=!0)};
ob.prototype.xXa=function(Pa,qb,tc){this.vge=Pa;ee.a.Uob(this.cG);Qc.a.cUg(this.cG);this.cG.id="fly_"+Pa.clientId;this.cG.style.backgroundColor=Pa.color;4!==qb?(this.cG.style.height=this.Dgb+"px",this.cG.style.lineHeight=this.Dgb+"px",Qc.a.SQa(this.cG,"border-radius",this.Dgb+"px")):4===tc||!tc&&!this.OI?this.cG.style.left="0px":this.cG.style.right="0px";2!==qb&&(4===qb?ee.a.Ztc(this.cG,""):1===qb?this.cG.appendChild(this.zjg):(this.cG.setAttribute("dir","auto"),tc=ue.a.MKh(Pa.userName),!Pa.isAnonymous&&
tc||qb?(Pa=Pa.userName,qb||(Pa=tc,Qc.a.SQa(this.cG,"text-align","center")),ee.a.Ztc(this.cG,Pa)):(this.cIc||(this.cIc=this.R_g()),this.cG.appendChild(this.cIc),Qc.a.SQa(this.cG,"text-align","start"))))};ob.prototype.Vc=function(Pa){if(!this.state)return this.raiseEvent(Xa.Rja,new Xa(1,Pa)),!0;3===this.state&&Ta.ULS.sendTraceTag(50436114,302,50,"User clicked on presence pill.");return!1};ob.prototype.kN=function(Pa){3===this.state&&this.raiseEvent(Xa.Rja,new Xa(3,Pa));return!1};ob.prototype.hw=function(Pa){3!==
Pa.zb&&this.raiseEvent(Xa.Rja,new Xa(2,Pa));return!1};ob.prototype.onPointerDown=function(Pa){if(3!==Pa.zb)return!0;this.raiseEvent(Xa.Rja,new Xa(4,Pa));return!1};ob.prototype.R_g=function(){var Pa=document.createElement("img");Pa.src=rf.a.gsa("doughperson_white_glyph.svg");Pa.setAttribute("Unselectable","on");Rc.a.nh(Pa,Rc.a.Sd,Rc.a.vs);return Cg.createClusteredImageFromClusterWithImageClass(this.Dgb,this.Dgb,null,null,ob.mxh,"",!1,"",this.element.ownerDocument,Pa)};ob.prototype.awg=function(Pa,
qb,tc){qb=void 0===qb?!1:qb;tc=void 0===tc?0:tc;if(!this.hxb(this.state)||!this.hxb(Pa))switch(Sys.UI.DomElement.removeCssClass(this.element,this.gEc),this.state){case 4:3===Pa?this.iga(ob.u$c,ob.ARe):this.hxb(Pa)&&this.iga(ob.s$c,ob.ARe);break;case 3:4===Pa?this.iga(ob.x$c,ob.zRe):this.hxb(Pa)&&(qb&&this.nLf(),this.iga(ob.s$c,ob.zRe,qb?ob.lxh:""));break;case 0:case 1:case 2:4===Pa?this.iga(ob.x$c,ob.v$c):3===Pa&&(qb&&this.zwg(),this.iga(ob.u$c,ob.v$c,qb?ob.BRe:"",3===tc?ob.pxh:ob.nxh));break;default:4===
Pa?this.iga(ob.x$c):3===Pa?this.iga(ob.u$c):this.hxb(Pa)&&this.iga(ob.s$c)}};ob.prototype.iga=function(Pa){for(var qb=[],tc=0;tc<arguments.length;++tc)qb[tc-0]=arguments[tc];this.gEc=qb.join(" ");Sys.UI.DomElement.addCssClass(this.element,this.gEc)};ob.prototype.zwg=function(){var Pa=this;this.z3d=window.setTimeout(function(){Pa.element&&(Pa.jpa=Pa.element.cloneNode(!0),Pa.element.parentNode.appendChild(Pa.jpa),Pa.element.style.zIndex="2",Pa.jpa.style.zIndex="1")},300)};ob.prototype.nLf=function(){var Pa=
this;window.clearTimeout(this.z3d);this.jpa&&(Sys.UI.DomElement.removeCssClass(this.jpa,ob.v$c+" "+ob.BRe),Sys.UI.DomElement.addCssClass(this.jpa,ob.kxh),Ha.Task.delay(300).continueWith(function(){Pa.element&&Pa.element.parentNode===Pa.jpa.parentNode&&Pa.element.parentNode.removeChild(Pa.jpa)}),Qc.a.VFb(this.element,"z-index"))};ob.prototype.hxb=function(Pa){return!Pa||1===Pa||2===Pa};ob.prototype.XZh=function(Pa,qb){var tc=Qc.a.IC(this.element.style.top);return Qc.a.IC(this.element.style.left)===
Pa&&tc===qb};ob.prototype.iId=function(Pa){3===Pa&&Qc.a.D2(this.element,"left")?(Pa=Qc.a.IC(this.element.style.left),Qc.a.VFb(this.element,"left"),this.element.style.right=-1*Pa+"px"):4===Pa&&Qc.a.D2(this.element,"right")&&(Pa=Qc.a.IC(this.element.style.right),Qc.a.VFb(this.element,"right"),this.element.style.left=-1*Pa+"px")};tl.Object.defineProperties(ob.prototype,{user:{configurable:!0,enumerable:!0,get:function(){return this.vge}},state:{configurable:!0,enumerable:!0,get:function(){return this._state}}});
ob.jxh="prModernFlyout UIFont";ob.x$c="flyoutIdle";ob.u$c="flyoutExpanded";ob.s$c="flyoutCollapsed";ob.ARe="flyoutFromIdle";ob.zRe="flyoutFromExpanded";ob.v$c="flyoutFromCollapsed";ob.BRe="flyoutStacked";ob.lxh="flyoutFromStacked";ob.kxh="flyoutFadeOut";ob.mxh="cui-img-cont-float cui-img-20by20";ob.nxh="flyoutLtrDir";ob.pxh="flyoutRtlDir";Object(fb.a)(ob,"ModernPresenceTooltipFlyoutControl",Sb,[]);Object(fb.a)(Ma,"FlyoutsPositioningInfo",null,[]);var Ee=b(47);Ia.prototype.yLh=function(Pa,qb,tc,dd,
Kd){var yd=Kd.y,ze=Kd.height,te=this.UDh(dd),lf=te+qb,bf=Pa*tc+2*(Pa-1);tc=null;1===Pa||this.SPg(te,bf,yd,ze)?Pa=new Ma(0,0,2):(Pa=this.i$c(lf,bf,yd,ze),Pa.offsetTop-=te);this.BGc?tc=new Ma(0,0,void 0,this.fj?4:3):(dd=this.TDh(dd,Kd),te=Math.max(0,Kd.x),Kd=Kd.width,qb=dd+qb,this.TPg(dd,te,Kd)?tc=new Ma(0,0,void 0,this.fj?3:4):this.UPg(qb,te)&&(tc=new Ma(0,0,void 0,this.fj?4:3)),tc||(tc=this.wwh(dd,qb,te,Kd)));return new Ma(Pa.offsetTop,tc.offsetLeft,Pa.Hbg,tc.U5e)};Ia.prototype.UDh=function(Pa){return Ee.a.SDh(Pa)};
Ia.prototype.TDh=function(Pa,qb){return this.fj?qb.width-Ee.a.RDh(Pa):Ee.a.QDh(Pa)};Ia.prototype.SPg=function(Pa,qb,tc,dd){return Pa+qb<=tc+dd};Ia.prototype.i$c=function(Pa,qb,tc,dd){var Kd=1,yd=Math.max(tc,Pa-qb);qb>Pa-tc&&(Kd=2,yd=qb<dd?dd-qb:tc);return new Ma(yd,0,Kd)};Ia.prototype.TPg=function(Pa,qb,tc){return Pa+150<=qb+tc};Ia.prototype.UPg=function(Pa,qb){return 150<=Pa-qb};Ia.prototype.wwh=function(Pa,qb,tc,dd){dd-qb>=Pa-tc?Pa=4:(qb=Pa,Pa=3);return new Ma(0,qb,void 0,Pa)};Object(fb.a)(Ia,"ModernPresenceTooltipPositioner",
null,[]);pa.prototype.update=function(Pa,qb){if(3!==Pa)if(5!==Pa&&this.oL&&this.oL.length){if(4===Pa){var tc=this.Jlg;var dd=(this.GWa-tc)/2;this.element.style.height=this.GWa+"px";this.element.style.width=this.GWa+"px";Pa=Qc.a.IC(this.oL[0].element.style.top);qb=Qc.a.IC(this.OI?this.oL[0].element.style.right:this.oL[0].element.style.left)}else tc=this.N0d,dd=(this.GWa-tc)/2,this.element.style.height=this.GWa+"px",this.element.style.width=this.iFh()+2*dd+"px",Pa=Qc.a.IC(this.oL[this.oL.length-1].element.style.top),
qb=this.qPg(this.oL[this.oL.length-1].element,tc,qb);Qc.a.SQa(this.element,"border-radius",this.GWa+"px");this.element.style.top=Pa-dd-tc+"px";this.OI?this.element.style.right=qb-dd+"px":this.element.style.left=qb-dd+"px";this.element.parentNode||this._parent.insertBefore(this.element,this._parent.firstChild)}else this.element.parentNode&&this.element.parentNode.removeChild(this.element)};pa.prototype.qPg=function(Pa,qb,tc){return this.OI&&!tc?Qc.a.IC(Pa.style.right):this.OI||tc?this.OI&&tc?-Qc.a.IC(Pa.style.left)-
qb:-Qc.a.IC(Pa.style.right)-qb:Qc.a.IC(Pa.style.left)};pa.prototype.iFh=function(){return this.oL&&this.oL.length?this.N0d+Math.min(this.oL.length-1,2)*this.$hg:0};tl.Object.defineProperties(pa.prototype,{element:{configurable:!0,enumerable:!0,get:function(){return this._element}}});Object(fb.a)(pa,"ModernPresenceTooltipTarget",null,[]);var De=b(168),ne=b(308);vm(ma,Sb);ma.prototype.jTc=function(Pa){this.addHandler(Xa.Rja,Pa)};ma.prototype.Iqc=function(Pa){this.removeHandler(Xa.Rja,Pa)};ma.prototype.dispose=
function(){if(this.gaf)this.GMc=!0;else{if(this.zJ)for(var Pa=yl(this.zJ),qb=Pa.next();!qb.done;qb=Pa.next())qb=qb.value,qb.Iqc(Object(eb.a)(this,this.s8a,"onInteractivityChanged")),id.a.Fa(qb);this.oL=null;this.Sz.za(sc.a.pointerDown,this.rpa.element,Object(eb.a)(this,this.o8a,"onHitTarget"));this.Sz.za(sc.a.pointerOver,this.rpa.element,Object(eb.a)(this,this.o8a,"onHitTarget"));this.Sz.za(sc.a.pointerOut,this.rpa.element,Object(eb.a)(this,this.o8a,"onHitTarget"));Sb.prototype.dispose.call(this)}};
ma.prototype.fna=function(){this.uGa();this.visible=!0};ma.prototype.oRa=function(){this.visible=!0;this.FOe();this.SCa=!0};ma.prototype.hide=function(){this.ALf();this.k5e();this.rpa.update(this.JAa,this.dWa)};ma.prototype.xXa=function(Pa){var qb=this.JAa,tc=this.SCa;Pa.clientId||(Pa.clientId=(ma.K5d++).toString());if(Pa.clientId in this.Khb){var dd=this.vsb(Pa.clientId);if(0<=dd){dd=this.Wz[dd];if(dd.color===Pa.color&&dd.userName===Pa.userName)return;this.O$a(Pa.clientId)}}this.hide();dd=new ob(this.createElement("div"),
this.xe);dd.jTc(Object(eb.a)(this,this.s8a,"onInteractivityChanged"));this.Sea.insertBefore(dd.element,this.Sea.firstChild);this.Khb[Pa.clientId]=dd;Array.add(this.Wz,Pa);Array.add(this.zJ,dd);this.kag(qb,tc);this.visible=!0};ma.prototype.O$a=function(Pa){if(this.gaf)Array.add(this.Mhb,Pa);else{var qb=this.JAa,tc=this.SCa;this.hide();this.MLf(Pa);this.kag(qb,tc)}};ma.prototype.kag=function(Pa,qb){0>=this.Wz.length?this.hide():3===Pa&&qb?this.oRa():this.fna()};ma.prototype.MIb=function(Pa,qb){qb?this.Bvg(Pa):
this.TKf(Pa)};ma.prototype.Pma=function(Pa){Pa!==this.tRb&&(this.tRb=Pa,this.EMd(Pa))};ma.prototype.position=function(Pa,qb){this.element.style.top=qb+"px";this.element.style.left=Pa+"px"};ma.prototype.uGa=function(Pa){if(void 0===Pa||!Pa||this.p8){this.tRb&&this.EMd(!0);var qb=Math.min(3,this.Bia)-1;Pa=0;var tc=1,dd=0;this.dWa&&(Pa=this.nfb,tc=-1,dd=-this.Hra);for(var Kd=this.Bia-1;Kd>qb;Kd--)this.zJ[Kd].e_f(this.Wz[Kd],-4*qb*tc+dd,!0,!1,!0,Pa);for(;0<=qb;qb--)this.zJ[qb].e_f(this.Wz[qb],-4*qb*tc+
dd,0<qb,Array.contains(this.pea,this.Wz[qb].clientId),qb!==this.iSb,Pa);this.iSb=0;this.rpa.update(0,this.dWa);this.zIndex=this.Kqb;this.SCa=!1;this.ALf(0);this.GMc&&this.dispose()}};ma.prototype.FOe=function(){this.tRb&&this.EMd(!1);this.zIndex=this.Kqb+1;var Pa=this.yjj();var qb=Pa.offsetX;var tc=Pa.offsetY;Pa=Pa.T5e;for(var dd=0;dd<this.Bia;dd++)this.zJ[dd].asj(this.Wz[dd],qb,tc+(this.Hra+2)*dd,dd!==this.iSb,Pa)};ma.prototype.k5e=function(){var Pa=0,qb=0;this.dWa&&(Pa=this.nfb,qb=-6);for(var tc=
0;tc<this.Bia;tc++)this.zJ[tc].hide(this.Wz[tc],qb,Pa);this.zIndex=this.Kqb;this.visible=this.SCa=!1;this.GMc&&this.dispose()};ma.prototype.y_c=function(Pa){var qb=this;(Pa=void 0===Pa?0:Pa)?(this.p8=!0,Ha.Task.delay(Pa).continueWith(function(){qb.Z4d?qb.j0h():qb.uGa(!0);qb.p8=!1})):this.Z4d?this.hide():this.uGa()};ma.prototype.j0h=function(){this.p8&&this.hide()};ma.prototype.VJg=function(){if(tb.AFrameworkApplication.sa&&tb.AFrameworkApplication.sa.Pa.Cx&&De.c()){var Pa=appChrome.selectors.getShyState();
return Pa.isActive&&!!Pa.state}return!1};ma.prototype.s8a=function(Pa,qb){var tc=this;Pa=this.JAa;this.VJg()||2!==qb.type&&(4!==qb.type||3===Pa)?4===qb.type&&3===Pa?(this.p8&&(this.p8=!1),this.y_c()):3!==qb.type||3!==Pa||this.SCa||(1<this.Bia?(this.p8=!0,Ha.Task.delay(250).continueWith(function(){tc.uGa(!0);tc.p8=!1})):this.y_c()):(this.p8&&(this.p8=!1),3!==Pa&&(this.FOe(),3===qb.Xrb.zb&&this.y_c(2E3)));this.raiseEvent(Xa.Rja,qb)};ma.prototype.o8a=function(Pa){3===Pa.zb?this.s8a(this,new Xa(4,Pa)):
Pa.eventName===sc.a.pointerOver?this.s8a(this,new Xa(2,Pa)):Pa.eventName===sc.a.pointerOut&&this.s8a(this,new Xa(3,Pa));return!1};ma.prototype.Bhj=function(Pa){this.element.style.width=Pa+"px";this.element.style.height=this.Hra+"px"};ma.prototype.MLf=function(Pa){this.TKf(Pa);Pa=this.vsb(Pa);if(!(0>Pa)){var qb=this.Wz[Pa];Array.removeAt(this.Wz,Pa);delete this.Khb[qb.clientId];qb=this.zJ[Pa];this.Sea.removeChild(qb.element);this.xe.get(18,!1)&&qb.Iqc(Object(eb.a)(this,this.s8a,"onInteractivityChanged"));
Array.removeAt(this.zJ,Pa);qb.dispose()}};ma.prototype.ALf=function(Pa){Pa=void 0===Pa?5:Pa;if(this.Mhb.length){this.visible&&this.k5e();for(var qb=0;qb<this.Mhb.length;qb++)this.MLf(this.Mhb[qb]);Array.clear(this.Mhb);0>=this.Wz.length||5===Pa?this.hide():Pa||this.fna()}};ma.prototype.vsb=function(Pa){for(var qb=0;qb<this.Wz.length;qb++)if(this.Wz[qb].clientId===Pa)return qb;return-1};ma.prototype.lnf=function(Pa){if(Pa in this.Khb){var qb=this.vsb(Pa);if(qb){var tc=this.Wz[qb];Pa=this.Khb[Pa];Array.removeAt(this.Wz,
qb);Array.insert(this.Wz,0,tc);Array.removeAt(this.zJ,qb);Array.insert(this.zJ,0,Pa);this.Sea.removeChild(Pa.element);this.Sea.appendChild(Pa.element);this.uGa()}}};ma.prototype.Bvg=function(Pa){if(-1===this.vsb(Pa))Ta.ULS.sendTraceTag(41706451,302,15,"Cannot set active editor because client id is invalid");else{if(Array.contains(this.pea,Pa)){if(this.Wz[0].clientId===Pa)return;Array.remove(this.pea,Pa)}Array.add(this.pea,Pa);this.lnf(Pa);1!==this.JAa&&this.uGa()}};ma.prototype.TKf=function(Pa){-1===
this.vsb(Pa)?Ta.ULS.sendTraceTag(41706452,302,50,"Cannot remove active editor because client id is invalid"):Array.contains(this.pea,Pa)&&(Array.remove(this.pea,Pa),this.Wz[0].clientId===Pa&&0<this.pea.length&&this.lnf(this.pea[this.pea.length-1]),this.Wz[0].clientId===Pa&&1===this.JAa&&this.uGa())};ma.prototype.EMd=function(Pa){Pa?Sys.UI.DomElement.addCssClass(this.Sea,"prBackgroundSelection"):Sys.UI.DomElement.removeCssClass(this.Sea,"prBackgroundSelection")};ma.prototype.yjj=function(){var Pa;
var qb=Pa=0;var tc=this.nfb;if(this.Rge){var dd=this.Rge(this);if(!dd)return{offsetX:Pa,offsetY:qb,T5e:tc};var Kd=4===this.JAa;tc=this.tpg.yLh(this.Bia,Kd?6:this.Hra,this.Hra,this.element,dd);qb=tc.offsetTop;this.iSb=this.JKh(tc.Hbg,tc.offsetTop);tc=tc.U5e;tc!==this.nfb&&(this.iId(tc),this.element.dir=3===tc?"rtl":"ltr",this.nfb=tc);tc!==this.HVe()?(Pa=this.xpg?-2:Kd?-6:-this.Hra,this.dWa=!0):this.dWa=!1}return{offsetX:Pa,offsetY:qb,T5e:tc}};ma.prototype.JKh=function(Pa,qb){if(1===Pa)return this.Bia-
1;Pa=Math.abs(qb);return 0<Pa?Pa/(this.Hra+2):0};ma.prototype.iId=function(Pa){for(var qb=0;qb<this.Bia;qb++)this.zJ[qb].iId(Pa)};ma.prototype.HVe=function(){return this.fj?3:4};ma.pAh=function(){return String.format("{0}-{1}","presencetooltip",ma.K5d++)};tl.Object.defineProperties(ma.prototype,{yoc:{configurable:!0,enumerable:!0,get:function(){return ne.a.clone(this.Wz)}},zJ:{configurable:!0,enumerable:!0,get:function(){return this.oL}},Kqb:{configurable:!0,enumerable:!0,get:function(){return this.djg}},
Bia:{configurable:!0,enumerable:!0,get:function(){return this.zJ?this.zJ.length:0}},JAa:{configurable:!0,enumerable:!0,get:function(){return 0<this.Bia?this.zJ[0].state:5}},gaf:{configurable:!0,enumerable:!0,get:function(){return 3===this.JAa&&!this.SCa}}});ma.K5d=0;Object(fb.a)(ma,"ModernPresenceTooltipControl",Sb,[460,3]);var gc=b(276),fd=b(348),vd=b(169);wa.prototype.A0g=function(){var Pa=document.createElement("div");this.xe.vXa(15,!1);return new ma(Pa,20,this.xe)};Object(fb.a)(wa,"ModernPresenceTooltipFactory",
null,[481]);var se=b(16),Jc=b(58),Bc=b(186),Ae=b(11),cb=b(32),mc=b(341),Oc;(function(Pa){Pa[Pa.none=0]="none";Pa[Pa.master=1]="master";Pa[Pa.fixed=2]="fixed";Pa[Pa.horizontal=3]="horizontal";Pa[Pa.vertical=4]="vertical";Pa[Pa.first=1]="first";Pa[Pa.last=4]="last"})(Oc||(Oc={}));Object(fb.b)("PaneType",Oc);var Sc=Jb.a;vm(na,Sc);na.prototype.jTc=function(Pa){this.addHandler("interactivityChanged",Pa)};na.prototype.Iqc=function(Pa){this.removeHandler("interactivityChanged",Pa)};na.prototype.dispose=
function(){if(0<this.to.count){this.hide();var Pa=this.to.Nu,qb;for(qb in Pa)Pa[qb].dispose()}this.gridView=null;this.to.clear();Sc.prototype.dispose.call(this)};na.prototype.rkj=function(Pa){this.fEf=Pa};na.prototype.fna=function(){var Pa=this.to.Nu,qb;for(qb in Pa)Pa[qb].fna()};na.prototype.oRa=function(){this.Ohd();var Pa=this.to.Nu,qb;for(qb in Pa)Pa[qb].oRa()};na.prototype.hide=function(){this.ASa();var Pa=this.to.Nu,qb;for(qb in Pa)Pa[qb].hide()};na.prototype.xXa=function(Pa){var qb=this.to.Nu,
tc;for(tc in qb)qb[tc].xXa(Pa)};na.prototype.O$a=function(Pa){var qb=this.to.Nu,tc;for(tc in qb)qb[tc].O$a(Pa)};na.prototype.MIb=function(Pa,qb){var tc=this.to.Nu,dd;for(dd in tc)tc[dd].MIb(Pa,qb)};na.prototype.Pma=function(Pa){this.Lmd!==Pa&&(this.Lmd=Pa,Pa=cb.a.Ec(this.to.Nu,Enum.toString(Oc,na.aKa()[0])),this.tya&&Pa&&(Pa=Ae.DOMElementExtensions.getWidth(Pa.element)/2,this.position(this.Lmd?this.tya.x+14+Pa:this.tya.x-14-Pa,this.tya.y)))};na.prototype.position=function(Pa,qb){var tc=this.to.Nu,
dd;for(dd in tc){var Kd=tc[dd],yd=Enum.parse(Oc,dd);yd=this.gridView.fg(yd);var ze=Z(yd,new Sys.UI.Point(Pa,qb),!1);this.tya=new Sys.UI.Point(Pa,qb);0>ze.x&&(ze.x+=yd.domElement.scrollLeft);Ae.DOMElementExtensions.updatePosition(Kd.element,ze.x,ze.y,!1,this.rtl)}};na.prototype.Ohd=function(){this.tya&&(this.position(this.tya.x,this.tya.y),this.iKd||(this.iKd=!0,this.gridView.Ca.gG(this.iz),this.gridView.Ca.gq(this.iz),this.gridView.view.it(this.YE)))};na.prototype.ASa=function(){this.iKd&&(this.gridView.Ca.LH(this.iz),
this.gridView.Ca.Zo(this.iz),this.gridView.view.Wr(this.YE))};na.aKa=function(){return na.rFa||(na.rFa=[1,3,2,4])};tl.Object.defineProperties(na.prototype,{element:{configurable:!0,enumerable:!0,get:function(){return null}},yoc:{configurable:!0,enumerable:!0,get:function(){var Pa=cb.a.Ec(this.to.Nu,Enum.toString(Oc,na.aKa()[0]));return Pa?Pa.yoc:null}},rSi:{configurable:!0,enumerable:!0,get:function(){return this.fEf}}});na.rFa=null;Object(fb.a)(na,"PaneInvariantTooltip",Jb.a,[460,3]);Y.sJb=!1;Y.cna=
!1;Object(fb.a)(Y,"PresenceViewSettings",null,[]);S.prototype.dispose=function(){this.ASa();this.clearCache();this.$&&this.$.xa&&this.$.xa.rg(this.T5);this.gridView=null};S.prototype.ASa=function(){this.lgc&&(this.gridView.Ca.LH(this.iz),this.gridView.Ca.Zo(this.iz),this.gridView.view.Wr(this.YE),this.lgc=!1)};S.prototype.PGj=function(Pa){var qb=this.fz[Pa],tc=this.jja(Pa);qb&&this.mLf(qb);tc&&this.qqc(tc,qb.xya.clientId,qb.hB);delete this.XSa[Pa];delete this.fz[Pa];delete this.WSa[Pa]};S.prototype.bWd=
function(Pa){var qb=Pa.hB;this.fz[qb]||(this.Z3a(Pa),this.fz[qb]=Pa)};S.prototype.RLj=function(Pa){var qb=Pa.hB,tc=this.yZe(Pa.xoc,Pa.paneType,Pa.range),dd=this.jja(qb);tc&&tc!==dd&&(Pa.BKb(tc),this.XSa[qb]=tc,this.fz[qb]=Pa,this.WSa[qb]&&tc.Pma(this.WSa[qb]));dd!==tc&&dd&&this.qqc(dd,Pa.xya.clientId,Pa.hB);!this.lgc&&this.gridView&&(this.gridView.Ca.gG(this.iz),this.gridView.Ca.gq(this.iz),this.gridView.view.it(this.YE),this.lgc=!0)};S.prototype.qqc=function(Pa,qb,tc){Pa.O$a(qb);cc.EwaSettings.isChangeGateEnabled("OfficeVSO:3663630_ModernPresenceUxPerf")&&
this.jja(tc)===Pa&&delete this.XSa[tc];Pa.yoc&&Pa.yoc.length||((qb=Pa.rSi)&&delete this.AEb[qb],cc.EwaSettings.isChangeGateEnabled("OfficeVSO:3663630_ModernPresenceUxPerf")||this.jja(tc)===Pa&&delete this.XSa[tc],Pa.dispose())};S.prototype.mLf=function(Pa){Pa&&(Pa.NGd(this.pCb),Pa.mHd(this.aDb),Pa.lHd(this.$Cb),Pa.BKb(null))};S.prototype.Z3a=function(Pa){Pa.iTc(this.pCb);Pa.KTc(this.aDb);Pa.JTc(this.$Cb)};S.prototype.GW=function(Pa,qb){if(Y.cna){qb.Xta||this.bWd(qb);this.RLj(qb);var tc=this.jja(qb.hB);
tc&&(tc.xXa(qb.xya),qb.GLa()?Pa?tc.oRa():tc.fna():tc.hide())}};S.prototype.jja=function(Pa){return this.XSa[Pa]};S.prototype.yZe=function(Pa,qb,tc){if(!Pa)return null;Pa=this.cdd(Pa,qb);var dd=this.gridView.fg(qb).wq;qb=S.yOh(Pa,qb,dd).toString();dd=cb.a.Ec(this.AEb,qb);dd||(dd=new na(this.gridView,this.dCd,tc),dd.position(Pa.x,Pa.y),dd.rkj(qb),this.AEb[qb]=dd);return dd};S.prototype.cdd=function(Pa,qb){var tc=this.gridView.fg(qb).Dn,dd=this.gridView.fg(qb).wq;qb=mc.a.qM(qb,tc.topLeft);var Kd=Math.max(dd.x,
Pa.x-this.yva/2-2);Kd=Math.min(Math.max(qb.x+dd.x,Kd),qb.x+dd.x+tc.width-this.yva);Pa=Math.max(dd.y,Pa.y-this.yva/2+1);cc.EwaSettings.isChangeGateEnabled("OfficeVSO:5703071_toolTipOnRightForFirstRow")&&qb.y+dd.y>Pa&&(Kd=Math.min(Kd+this.yva/4,qb.x+dd.x+tc.width-this.yva));Pa=Math.min(Math.max(qb.y+dd.y,Pa),qb.y+dd.y+tc.height-this.yva);return new Sys.UI.Point(Kd,Pa)};S.prototype.clearCache=function(){var Pa=this.fz,qb;for(qb in Pa)this.mLf(Pa[qb]);Pa=this.AEb;for(var tc in Pa)Pa[tc].dispose();this.XSa=
{};this.fz={};this.AEb={};this.WSa={};id.a.Fa(this.$na);this.$na=null};S.prototype.Ypb=function(){var Pa=new Tb;Pa.add(0,se.a.V7c);Pa.add(1,this.A6e);Pa.add(12,49);Pa.add(6,this.yva);this.gridView&&(Pa.add(4,pb.a.Be(3)),Pa.add(5,pb.a.Be(3)),Pa.add(8,this.gridView.rtl));Pa.add(18,!0);this.dCd=new wa(Pa);Pa.add(16,this.tUh)};S.prototype.QKj=function(Pa){var qb=new Tb;qb.add(0,se.a.V7c);qb.add(1,this.A6e);qb.add(12,Number.parseInvariant(Pa.toString()));qb.add(6,this.yva);this.gridView&&(qb.add(4,pb.a.Be(3)),
qb.add(5,pb.a.Be(3)),qb.add(8,this.gridView.rtl));this.dCd=new wa(qb)};S.prototype.VLj=function(Pa){this.QKj(Pa)};S.prototype.lag=function(){Y.cna&&(this.$na=Bc.AsyncMethodContext.Ky(this.OLj,100,Yd.a.FTi,this.$na))};S.prototype.N3e=function(Pa,qb){Y.cna&&(this.WSa[qb.hB]&&Pa.Pma(this.WSa[qb.hB]),qb.GLa()?qb.dna(!0,!0):qb.dna(!1,!0))};S.prototype.Pma=function(Pa,qb){this.WSa[Pa]=qb;(Pa=this.jja(Pa))&&Pa.Pma(qb)};S.prototype.MIb=function(Pa,qb){var tc=this.jja(Pa);tc&&tc.MIb(Pa,qb)};S.yOh=function(Pa,
qb,tc){return Pa.x.toString()+"-"+Pa.y.toString()+"-"+qb.toString()+"-"+tc.x.toString()+"-"+tc.y.toString()};Object(fb.a)(S,"PresenceTooltipManager",null,[3]);var $c=b(103),le=b(118),we=Jb.a;vm(ca,we);ca.prototype.iTc=function(Pa){this.addHandler("hidePresenceTooltip",Pa)};ca.prototype.NGd=function(Pa){this.removeHandler("hidePresenceTooltip",Pa)};ca.prototype.KTc=function(Pa){this.addHandler("showPresenceTooltip",Pa)};ca.prototype.mHd=function(Pa){this.removeHandler("showPresenceTooltip",Pa)};ca.prototype.JTc=
function(Pa){this.addHandler("showFullPresenceTooltip",Pa)};ca.prototype.lHd=function(Pa){this.removeHandler("showFullPresenceTooltip",Pa)};ca.prototype.eFa=function(Pa){this.addHandler("presenceChanged",Pa)};ca.prototype.cza=function(Pa){this.removeHandler("presenceChanged",Pa)};ca.prototype.dispose=function(){this.raiseEvent("hidePresenceTooltip");this.raiseEvent("presenceChanged");this.twe();this.ASa();id.a.Fa(this.mnb);this.Wfe=this.domElement=this.gridView=null;we.prototype.dispose.call(this)};
ca.prototype.OPd=function(Pa,qb){var tc=!!Pa&&!oc.D(Pa).equals(oc.D(this.rB)),dd=!!qb&&(!this.gk||this.gk.get_id()!==qb.get_id());if(tc||dd)this.raiseEvent("presenceChanged"),this.twe(),this.Xta=!1,this.rB=Pa,this.gk=qb,this.yzb=null};ca.prototype.s4=function(Pa){this.visible=this.Xta=!1;Pa&&this.raiseEvent("hidePresenceTooltip")};ca.prototype.lga=function(Pa){Array.add(this.Ax,Pa);this.Q5e();Pa.eFa(this.qyd)};ca.prototype.dna=function(Pa,qb){Pa?(this.visible=!0,qb&&(this.mnb=Bc.AsyncMethodContext.Ky(this.euj,
this.$.ya.ShowTooltipDelayInMs,Yd.a.mDj,this.mnb))):this.s4(qb)};ca.prototype.BKb=function(Pa){this.Wfe=Pa};ca.prototype.Ndb=function(){if(this.domElement&&this.visible){this.cZa=Ae.DOMElementExtensions.getBoundingClientRect(this.domElement);var Pa=Math.floor(this.cZa.x);this.cZa.x=Pa===this.cZa.x?Pa:Pa+1;this.cZa.y=Math.floor(this.cZa.y)}};ca.prototype.GLa=function(){if(!this.rB)return!1;if(cc.EwaSettings.la(712)){var Pa=this.GOh();return Pa?this.gridView.Tdi(Pa,this.paneType):!1}Pa=this.gridView.fg(this.paneType).Dn;
var qb=this.gridView.Lg(this.range,this.paneType);return Pa.Rd(qb)};ca.prototype.GOh=function(){if(this.range.isSingle){var Pa=this.gridView.Ca.Eua(this.range,this.$.activeItemName);return Pa?(Pa=Pa.Ds(this.range))?Pa.nE:null:null}return this.range};ca.prototype.twe=function(){for(var Pa=0,qb=this.Ax.length;Pa<qb;Pa++)this.Ax[Pa].cza(this.qyd);Array.clear(this.Ax);this.ASa()};ca.prototype.Q5e=function(){!this.kgc&&1<=this.Ax.length&&(this.kgc=!0,this.gridView.Ca.gG(this.iz),this.gridView.Ca.gq(this.iz),
this.gridView.view.it(this.YE))};ca.prototype.ASa=function(){this.kgc&&!this.Ax.length&&(this.kgc=!1,this.gridView&&(this.gridView.Ca.LH(this.iz),this.gridView.Ca.Zo(this.iz),this.gridView.view.Wr(this.YE)))};ca.prototype.O$a=function(Pa){Pa.cza(this.qyd);Array.remove(this.Ax,Pa);this.ASa()};ca.prototype.q9f=function(){this.Ndb();for(var Pa=0,qb=this.Ax.length;Pa<qb;Pa++)this.Ax[Pa].Ndb()};tl.Object.defineProperties(ca.prototype,{hB:{configurable:!0,enumerable:!0,get:function(){return this.BQc}},
xya:{configurable:!0,enumerable:!0,get:function(){return this.UMc}},paneType:{configurable:!0,enumerable:!0,get:function(){return this.eqa}},xoc:{configurable:!0,enumerable:!0,get:function(){if(!this.domElement)return null;var Pa=this.gridView.fg(this.paneType).Dn,qb=this.gridView.rtl,tc=this.domElement.offsetWidth;if(!this.gk&&4>=tc){if(this.rB){tc=this.gridView.Ph;var dd=this.rB.FirstRow;qb=qb?this.rB.FirstColumn:this.rB.LastColumn;if(tc&&!(dd>=tc.top&&dd<=tc.bottom&&qb>=tc.left&&qb<=tc.right))return dd=
dd<=tc.top?Pa.y:Pa.y+(dd>=tc.bottom?Pa.height:Pa.height/2),qb=qb<=tc.left?Pa.x:Pa.x+(qb>=tc.right?Pa.width:Pa.width/2),this.yzb=new Sys.UI.Point(qb,dd)}return this.yzb}if(this.gk){Pa=this.domElement.offsetTop-2;dd=parseInt(this.domElement.style.left);var Kd=0;qb&&(Kd=parseInt(this.domElement.parentNode.style.width)-tc-dd,Kd-=this.gridView.FN.Bwa&&this.gridView.FN.lpd?le.a.Sp:0);return this.yzb=new Sys.UI.Point((qb?Kd:dd)+tc+4,Pa)}return this.yzb=new Sys.UI.Point(parseInt(qb?this.domElement.style.right:
this.domElement.style.left)+tc,this.domElement.offsetTop)}},range:{configurable:!0,enumerable:!0,get:function(){return oc.D(this.rB)}}});Object(fb.a)(ca,"TooltipNotificationUnit",Jb.a,[462,3]);var jc=Jb.a;vm(ba,jc);ba.prototype.iTc=function(Pa){this.addHandler("hidePresenceTooltip",Pa)};ba.prototype.NGd=function(Pa){this.removeHandler("hidePresenceTooltip",Pa)};ba.prototype.KTc=function(Pa){this.addHandler("showPresenceTooltip",Pa)};ba.prototype.mHd=function(Pa){this.removeHandler("showPresenceTooltip",
Pa)};ba.prototype.JTc=function(Pa){this.addHandler("showFullPresenceTooltip",Pa)};ba.prototype.lHd=function(Pa){this.removeHandler("showFullPresenceTooltip",Pa)};ba.prototype.eFa=function(Pa){this.addHandler("presenceChanged",Pa)};ba.prototype.cza=function(Pa){this.removeHandler("presenceChanged",Pa)};ba.prototype.dispose=function(){this.raiseEvent("hidePresenceTooltip");this.raiseEvent("presenceChanged");this.Tx&&this.Tx.PGj(this.hB);var Pa=this.fz,qb;for(qb in Pa){var tc=Pa[qb];tc.NGd(this.pCb);
tc.mHd(this.aDb);tc.lHd(this.$Cb);tc.cza(this.PCb);tc.dispose()}this.Tx=this.gd=this.highlight=this.gridView=this.fz=null;jc.prototype.dispose.call(this)};ba.prototype.J0f=function(Pa,qb,tc){tc=void 0===tc?null:tc;Pa?(this.gd=oc.D(Pa),this.eqa=this.gridView.$a.Kj(this.gd.topRight)):tc?(this.gk=tc,this.eqa=tc.Bg.paneType):this.eqa=1;this.She=qb;this.Lua(this.paneType);this.OPd(Pa,tc)};ba.prototype.OPd=function(Pa,qb){var tc=this.fz,dd;for(dd in tc)tc[dd].OPd(Pa,qb)};ba.prototype.s4=function(Pa){this.Lua(this.paneType).s4(Pa);
Pa=this.fz;for(var qb in Pa)Pa[qb].s4(!1)};ba.prototype.Eje=function(Pa){var qb=this.fz,tc;for(tc in qb){var dd=qb[tc];dd.lga(Pa.Lua(dd.paneType))}};ba.prototype.lga=function(Pa){this.Lua(Pa.paneType).lga(Pa)};ba.prototype.GLa=function(){var Pa=this.Lua(this.paneType).GLa(),qb=this.fz,tc;for(tc in qb)Pa=qb[tc].GLa()||Pa;return Pa};ba.prototype.dna=function(Pa,qb){this.Tx.bWd(this);this.Lua(this.paneType).dna(Pa,qb);qb=this.fz;for(var tc in qb)qb[tc].dna(Pa,!1)};ba.prototype.BKb=function(Pa){var qb=
this.fz,tc;for(tc in qb)qb[tc].BKb(Pa)};ba.prototype.Ndb=function(){var Pa=this.fz,qb;for(qb in Pa)Pa[qb].Ndb();this.Tx.bWd(this)};ba.prototype.Lua=function(Pa){return this.JNh(Pa,this.She)};ba.prototype.JNh=function(Pa,qb){var tc=this.highlight?this.highlight.OG(qb,Pa).Jh:this.gk?this.gk.get_element():null;qb=ba.MTh(qb,Pa);var dd=cb.a.Ec(this.fz,qb);dd||(dd=new ca(tc,this.gridView,this.xya,Pa,this.$),this.fz[qb]=dd,dd.iTc(this.pCb),dd.KTc(this.aDb),dd.JTc(this.$Cb),dd.eFa(this.PCb));return dd};ba.MTh=
function(Pa,qb){return Pa.toString()+qb.toString()};tl.Object.defineProperties(ba.prototype,{hB:{configurable:!0,enumerable:!0,get:function(){return this.BQc}},xya:{configurable:!0,enumerable:!0,get:function(){return this.UMc}},paneType:{configurable:!0,enumerable:!0,get:function(){return this.eqa}},range:{configurable:!0,enumerable:!0,get:function(){return this.gd}},xoc:{configurable:!0,enumerable:!0,get:function(){return this.gd||this.gk?Z(this.gridView.fg(this.paneType),this.Lua(this.paneType).xoc,
!0):null}},Xta:{configurable:!0,enumerable:!0,get:function(){return this.Lua(this.paneType).Xta},set:function(Pa){var qb=this.fz,tc;for(tc in qb)qb[tc].Xta=Pa}}});Object(fb.a)(ba,"PaneInvariantTooltipNotificationUnit",Jb.a,[462,3]);O.prototype.dispose=function(){this.Wvb();id.a.Fa(this.Ru);this.objectId=this.$=this.Pp=this.gk=null};O.prototype.lga=function(Pa){this.Ru.Eje(Pa.Ru)};O.prototype.Wvb=function(){this.gk&&this.Pp&&this.Pp.User&&(this.gk.tzc(!1,this.Pp.User.UserID,null),this.Ru.s4(!0))};
O.prototype.OJb=function(){Y.sJb&&this.gk&&this.Pp&&this.Pp.User&&(this.gk.tzc(!0,this.Pp.User.UserID,this.Pp.UserColor),this.Ru.Ndb())};O.prototype.GW=function(Pa){Y.cna&&(this.Ru.Xta=Pa,this.Ru.dna(Pa,!0))};O.prototype.WJb=function(Pa,qb){this.Ru.J0f(null,qb?47:46,Pa)};tl.Object.defineProperties(O.prototype,{gk:{configurable:!0,enumerable:!0,get:function(){return this.QCa},set:function(Pa){this.QCa=Pa;!this.QCa||cc.EwaSettings.isChangeGateEnabled("OfficeVSO:6032771_PresenceToolTipZIndexCheck")&&
!this.QCa.hy||this.Tx.VLj(this.QCa.hy)}}});Object(fb.a)(O,"FloatingObjectPresenceHighlight",null,[444,3]);var Zc=b(669),ud=b(68),Fd=b(8),me=b(247),$e=b(189),Df=Zc.a;vm(Q,Df);Q.prototype.dispose=function(){id.a.Fa(this.Ru);Df.prototype.dispose.call(this);var Pa=Q.k_a,qb;for(qb in Pa){var tc=qb,dd=Pa[qb];dd&&!dd.children.length&&(Ae.DOMElementExtensions.Sf(dd),Q.k_a[tc]=null)}};Q.prototype.lga=function(Pa){this.Ru.Eje(Pa.Ru)};Q.prototype.GW=function(Pa){Y.cna&&(this.qfc||(this.Ru.Xta=Pa,this.Ru.dna(Pa,
!0)),this.RJb=Pa&&this.qfc)};Q.prototype.WJb=function(Pa,qb){this.Ru.J0f(Pa,qb?47:46);this.RJb=!1};Q.prototype.OJb=function(Pa){Y.sJb&&(this.Ru.dna(!0,!0),this.sZd=Pa,this.Yr([Pa]))};Q.prototype.Wvb=function(Pa){this.s4();this.kl(Pa)};Q.prototype.jCe=function(Pa,qb,tc){tc.className=ud.a.rph;tc.style.borderColor=this.Pp.UserColor;var dd=document.createElement("div");46!==Pa&&47!==Pa&&(dd.style.backgroundColor=this.Pp.UserColor);tc.appendChild(dd);dd.className=[ud.a.tph,ud.a.sph][Pa-46];$e.f(this.$)&&
this.u1h(dd);Pa=cb.a.Ec(Q.k_a,qb.toString());Pa||(dd=this.gridView.fg(qb).domElement,Pa=document.createElement("div"),dd.insertBefore(Pa,dd.firstChild),Q.k_a[qb.toString()]=Pa);Pa.appendChild(tc)};Q.prototype.hcc=function(){};Q.prototype.KVf=function(Pa,qb,tc,dd){var Kd=this.zDg(dd,Pa,qb);me.c(tc,this.gridView.rtl,Fd.HelperMethods.Qb(Kd.x));tc.width=Fd.HelperMethods.Qb(Kd.width);tc.top=Fd.HelperMethods.Qb(Kd.y);tc.height=Fd.HelperMethods.Qb(Kd.height);qb=qb.Jh;tc=qb.parentNode;47===Pa?Q.uEd(tc,qb,
!1):46===Pa&&(Kd=this.OG(47),dd.equals(Kd.lhc)?Q.uEd(tc,qb,!1):Q.uEd(tc,qb,!0));this.ASi(Pa)};Q.prototype.pZf=function(){return!1};Q.prototype.zDg=function(Pa,qb,tc){var dd=Pa.y+this.Ztb(tc,!1);tc=Pa.x+this.Ztb(tc,!0)+le.a.Oad(tc.Jh.parentNode.parentNode,this.gridView.rtl);var Kd=Pa.width;Pa=Pa.height+1;1>tc&&-1<=tc&&46===qb&&(Kd-=1-tc,tc=1);1>dd&&-1<=dd&&46===qb&&(Pa-=1-dd,dd=1);Kd=Math.max(0,Kd-1);Pa=Math.max(0,Pa-2);return new Jc.a(tc,dd,Kd,Pa)};Q.prototype.ASi=function(Pa){this.Ru.Ndb();this.sZd=
Pa;this.qfc=!1;this.RJb&&this.GW(!0);this.RJb=!1};Q.prototype.s4=function(){this.qfc||(this.Ru.s4(!0),this.RJb=!1)};Q.uEd=function(Pa,qb,tc){tc?qb!==Pa.firstChild&&(Pa.removeChild(qb),Pa.insertBefore(qb,Pa.firstChild)):qb!==Pa.lastChild&&(Pa.removeChild(qb),Pa.appendChild(qb))};Q.prototype.u1h=function(Pa){var qb=this;Q.excelLiveManager?this.G6e(Pa):this.$.da.Za(473,function(tc){Q.excelLiveManager=tc;qb.G6e(Pa)})};Q.prototype.G6e=function(Pa){this.Pp.User.UserID===Q.excelLiveManager.TDb.lR&&(Pa.style.backgroundColor=
this.Pp.UserColor,Pa.style.opacity="0.1")};Q.k_a=null;Object(fb.a)(Q,"PresenceHighlight",Zc.a,[]);vm(I,da);I.prototype.Mvc=function(){for(var Pa=1===this.uc.PresenceType?47:46,qb=0;qb<this.Sx.length;qb++)this.Sx[qb].OJb(Pa);for(Pa=0;Pa<this.EG.count;Pa++)this.EG.ag(Pa).OJb()};I.prototype.gcc=function(){for(var Pa=1===this.uc.PresenceType?47:46,qb=0;qb<this.Sx.length;qb++)this.Sx[qb].Wvb([Pa]);for(Pa=0;Pa<this.EG.count;Pa++)this.EG.ag(Pa).Wvb()};I.prototype.dispose=function(){this.$&&(this.$.xa&&this.$.xa.rg(this.T5),
ae.g(this.$).wN(this.Ms));this.UFe();id.a.pc(this.Sx);id.a.pc([this.Bz]);this.Bz=this.$=null;this.bNd(null);this.EG=null;da.prototype.dispose.call(this)};I.prototype.UFe=function(){if(this.EG){for(var Pa=0;Pa<this.EG.count;Pa++)this.EG.ag(Pa).dispose();this.EG.clear()}};I.prototype.FZa=function(Pa){1===this.uc.Version?this.ASg(Pa):this.BSg(Pa)};I.prototype.ASg=function(Pa){if(Pa.uc.SelectedRange&&this.uc.SelectedRange)for(var qb=this.uc.SelectedRange.length,tc=Pa.uc.SelectedRange.length,dd=0;dd<qb;dd++)for(var Kd=
0;Kd<tc;Kd++)if(Fa(this.uc.SelectedRange[dd],Pa.uc.SelectedRange[Kd])){this.Sx[dd].lga(Pa.W2a(Kd));return}};I.prototype.BSg=function(Pa){var qb,tc=0,dd=0;if(this.uc&&this.uc.Object&&(null===(qb=Pa.uc)||void 0===qb?0:qb.Object)){qb=this.uc.Object.length;for(var Kd=Pa.uc.Object.length,yd=0;yd<qb;yd++)if(this.uc.Object[yd]&&this.Med(this.uc.Object[yd])){tc++;for(var ze=0;ze<Kd;ze++)if(Pa.uc.Object[ze]&&this.Med(Pa.uc.Object[ze])&&(dd++,this.XUc(this.uc.Object[yd],Pa.uc.Object[ze]))){var te=this.W2a(tc),
lf=Pa.W2a(dd);if(te&&lf){te.lga(lf);return}}}else if(this.uc.Object[yd]&&Pa.uc.Object[yd]&&(!this.uc.Object[yd].ObjectType||2===this.uc.Object[yd].ObjectType))for(ze=0;ze<Kd;ze++)if(Pa.uc.Object[ze]&&(!Pa.uc.Object[yd].ObjectType||2===Pa.uc.Object[yd].ObjectType)&&this.uc.Object[yd].ObjectId===Pa.uc.Object[ze].ObjectId&&(te=this.Acd(this.uc.Object[yd].ObjectId),lf=Pa.Acd(this.uc.Object[yd].ObjectId),te&&lf)){te.lga(lf);return}}if(Pa.uc.SelectedRange&&this.uc.SelectedRange)for(qb=this.uc.SelectedRange.length,
Kd=Pa.uc.SelectedRange.length,yd=0;yd<qb;yd++)for(ze=0;ze<Kd;ze++)if(Fa(this.uc.SelectedRange[yd],Pa.uc.SelectedRange[ze])&&(te=this.W2a(tc+yd),lf=Pa.W2a(dd+ze),te&&lf)){te.lga(lf);return}};I.prototype.XUc=function(Pa,qb){return!!Pa&&!!qb&&qb.ObjectType===Pa.ObjectType&&(1===Pa.ObjectType||3===Pa.ObjectType)&&!Pa.ObjectId.localeCompare(qb.ObjectId)};I.prototype.W2a=function(Pa){return 0<=Pa&&this.Sx.length>Pa?this.Sx[Pa]:null};I.prototype.B0f=function(Pa){for(var qb=0,tc=this.Sx.length;qb<tc;qb++)this.Sx[qb].GW(Pa)};
I.prototype.Acd=function(Pa){return Pa&&this.EG.wb(Pa)?this.EG.getItem(Pa):null};I.prototype.C0f=function(Pa,qb){qb=void 0===qb?null:qb;if(Pa)(Pa=this.EG.getItem(qb))&&Pa.GW(!0);else for(Pa=0;Pa<this.EG.count;Pa++)(qb=this.EG.ag(Pa))&&qb.GW(!1)};I.prototype.E$f=function(Pa){da.JKj(this,Pa)};I.prototype.w2c=function(Pa,qb){if(Pa<qb)return this.Sx[Pa];if(!this.Pp||!this.$||!this.Tx)return null;Pa=new Q(this.Pp,this.$,this.Tx);Array.add(this.Sx,Pa);return Pa};I.prototype.Yij=function(){for(var Pa=this.Sx.length,
qb=this.uc.SelectedRange?this.uc.SelectedRange.length:0,tc=this.$.xa.oa,dd=0;dd<qb;dd++){var Kd=this.w2c(dd,Pa);Kd&&this.uc.SelectedRange[dd]&&(this.uc.SelectedRange[dd].NamedObjectName?Kd.kl([47,46]):(Kd.WJb(this.uc.SelectedRange[dd],this.uc.PresenceType),I.KVd(this.uc.PresenceType,Kd,this.uc.SelectedRange[dd],tc,this.Pp,this.Tx)))}for(qb=this.Bz&&this.Bz.zCd&&this.Bz.zCd.PresenceType!==this.Bz.uc.PresenceType?0:qb;qb<Pa;qb++)this.Sx[qb].kl([1===this.Bz.zCd.PresenceType?47:46])};I.prototype.Med=
function(Pa){return(null===Pa||void 0===Pa?0:Pa.ObjectId)&&(1===this.pYe(Pa.ObjectType)||2===this.pYe(Pa.ObjectType))&&(Pa=this.$.xb.Bdd(Pa.ObjectId))?oc.w(Pa):null};I.prototype.Zij=function(){for(var Pa=this.Sx.length,qb=this.$.xa.oa,tc=this.uc.SelectedRange?this.uc.SelectedRange.length:0,dd=this.uc.Object?this.uc.Object.length:0,Kd=0;Kd<Pa;Kd++)this.Sx[Kd].kl([47,46]);this.JTg();for(var yd=this.n1c=this.m1c=Kd=0;yd<dd;yd++){var ze=this.uc.Object[yd],te=this.Med(ze);if(te){var lf=this.w2c(Kd,Pa);
1===ze.ObjectType?this.m1c++:3===ze.ObjectType&&this.n1c++;Kd++;lf.WJb(te,ze.ObjectPresenceType);I.KVd(ze.ObjectPresenceType,lf,te,qb,this.Pp,this.Tx)}}for(dd=0;dd<tc;dd++)this.uc&&this.uc.SelectedRange&&(yd=this.uc.SelectedRange[dd],yd.NamedObjectName||(ze=!!qb&&yd.SheetName===qb.name,te=!!Yb(yd,this.$,1),ze&&te||(ze=this.w2c(Kd+dd,Pa),ze.WJb(yd,this.uc.PresenceType),I.KVd(this.uc.PresenceType,ze,yd,qb,this.Pp,this.Tx))));0<(this.countFloatingObjects=this.lUf())&&Ta.ULS.sendTraceTag(537154370,0,
50,'{{"SetAllFloatingObjectPresenceHighlights":"Success"}')};I.prototype.JTg=function(){this.lUf();this.UFe()};I.prototype.lUf=function(){var Pa=0;if(this.uc&&this.uc.Object)for(var qb=0;qb<this.uc.Object.length;qb++)this.qJj(this.uc.Object[qb])&&Pa++;return Pa};I.prototype.G3g=function(Pa,qb){if(this.EG.wb(qb))return qb=this.EG.getItem(qb),qb.gk=Pa,qb;if(!this.Pp||!this.$||!this.Tx)return null;var tc=new O(this.Pp,this.$,this.Tx);tc.gk=Pa;this.EG.add(qb,tc);return tc};I.prototype.qJj=function(Pa){var qb=
!1;if((null===Pa||void 0===Pa?0:Pa.ObjectId)&&(!Pa.ObjectType||2===Pa.ObjectType))try{var tc=this.eJh(Pa);if(tc){var dd=this.G3g(tc,Pa.ObjectId);dd.WJb(tc,Pa.ObjectPresenceType);dd.OJb();qb=!0}}catch(Kd){throw Ta.ULS.sendTraceTag(537154369,0,10,'{{"UpdatedFloatingObjectPresence":"Fail","Exception":"{0}"}',Kd.stack),Kd;}return qb};I.prototype.eJh=function(Pa){if(!Pa)return null;var qb=null;2===Pa.ObjectType?qb=$c.a(this.$).w$b(Pa.ObjectId):!Pa.ObjectType&&(Pa=this.$.xb.Bdd(Pa.ObjectId),null===Pa||
void 0===Pa?0:Pa.Eja)&&(qb=$c.a(this.$).OKh(Pa.Eja));return qb};I.prototype.gMd=function(){try{1===this.uc.Version?(this.Yij(),Ta.ULS.sendTraceTag(537154368,0,50,'{{"SetGridHighlightPass":"V1"}')):(this.Zij(),Ta.ULS.sendTraceTag(537154339,0,50,'{{"FloatingObjects":"{0}","PivotTables":"{1}","QueryTables":"{2}"}',this.countFloatingObjects,this.m1c,this.n1c))}catch(Pa){throw Ta.ULS.sendTraceTag(537154338,0,10,'{{"SetGridHighlight Exception":"{0}"}',Pa.stack),Pa;}};I.prototype.pYe=function(Pa){switch(Pa){case 0:return 0;
case 1:return 1;case 3:return 2;case 2:return 9;default:return-1}};I.KVd=function(Pa,qb,tc,dd,Kd,yd){var ze=1===Pa?47:46;dd&&tc&&dd.name===tc.SheetName?(qb.Jl(oc.D(tc),[ze]),qb.OJb(ze),Ta.ULS.shipAssertTag(537154337,0,qb.Ru.hB===Kd.User.UserID,"UserID and UnitID should match"),yd.MIb(qb.Ru.hB,1===Pa)):qb.Wvb([ze])};tl.Object.defineProperties(I.prototype,{uc:{configurable:!0,enumerable:!0,get:function(){return this.Bz.uc},set:function(Pa){this.Bz.uc=Pa;this.gMd()}}});Object(fb.a)(I,"UserGridPresence",
da,[]);var gg=b(46),og=b(924),dg=Jb.a;vm(R,dg);R.prototype.eFa=function(Pa){this.addHandler("pcek",Pa)};R.prototype.cza=function(Pa){this.removeHandler("pcek",Pa)};R.prototype.NLf=function(Pa){this.dBa[Pa]&&this.CLf(Pa,!1)};R.prototype.HQd=function(Pa){this.wqb&&this.wqb!==Pa.clientId&&(this.ZNd=!1);!cc.EwaSettings.isChangeGateEnabled("OfficeVSO:5657706_CorrectPresenceBootTelemetry")||this.$.fa.Q3a&&gg.PageLoadTrackingInfo.instance.Hgj||(this.ZNd=!1);this.PK.MXg(Pa);this.wqb=Pa.clientId};R.prototype.VKh=
function(Pa,qb){var tc=[];var dd=[];var Kd=this.dBa,yd;for(yd in Kd){var ze=Kd[yd];if(qb){var te=oc.k(Pa,this.$);this.V0e(te,tc,dd,ze)}else this.U0e(Pa,tc,dd,ze)}return{Q6h:tc,Beh:dd}};R.prototype.MEe=function(Pa,qb,tc,dd,Kd){(Kd=this.dBa[Kd])&&(qb?this.V0e(Pa,tc,dd,Kd):this.U0e(Pa,tc,dd,Kd))};R.prototype.CUh=function(){var Pa=[],qb=this.dBa,tc;for(tc in qb){var dd=qb[tc],Kd=dd.uc.SelectedRange;if(void 0!==Kd&&null!==Kd&&cc.EwaSettings.isChangeGateEnabled("OfficeVSO:5280212_Guard_PresenceState.SelectedRange")){Kd=
yl(Kd);for(var yd=Kd.next();!yd.done;yd=Kd.next()){yd=yd.value;var ze=oc.D(yd),te=ae.g(this.$).ha.va.U3;if(this.$.xa.oa.sheetName===yd.SheetName&&ze.right===te.right&&ze.top===te.top){dd=dd.Pp;dd=new Qd.a(dd.User.UserID,dd.User.UserName,dd.UserColor,new ib.a(1),null,dd.UserEmail,void 0,void 0,void 0,void 0,void 0,dd.JoinCoauthTime);Array.add(Pa,dd);break}}}}return Pa};R.prototype.Mvc=function(){Y.sJb=!0;Y.cna=!0;var Pa=this.iu,qb;for(qb in Pa)Pa[qb].Mvc()};R.prototype.gcc=function(){Y.sJb=!1;Y.cna=
!1;var Pa=this.iu,qb;for(qb in Pa)Pa[qb].gcc()};R.prototype.dispose=function(){this.WLb();this.$&&(this.$.xa&&this.$.xa.rg(this.T5),this.$.qa&&this.$.qa.fza(this.tBa),this.$.Fn(this.qd));this.ln&&this.ln.EGd(this.XBb);this.rVc&&(this.rVc.dispose(),this.rVc=null);if(this.iu){var Pa=this.iu,qb;for(qb in Pa)Pa[qb].dispose()}id.a.pc([this.PK,this.Tx]);this.Wve();this.iu=this.$=this.Gde=null;Array.clear(this.Ax);dg.prototype.dispose.call(this)};R.prototype.WLb=function(){this.PK&&(this.PK.cza(this.mzd),
this.PK.q4i(this.htf),this.PK.Q5i(this.Axf),this.PK.Mca(this.kd));this.sNa.JMf(this.DCb)};R.prototype.uCe=function(Pa){return new I(Pa,this.$,this.Tx)};R.prototype.Bje=function(Pa){var qb=this.$.fa.Cfd(Pa);if(qb)if(Pa in this.iu)this.iu[Pa].E$f(qb);else{var tc=this.uCe(qb);this.iu[Pa]=tc;this.FZa(tc)}return!!qb};R.prototype.V0e=function(Pa,qb,tc,dd){if(Pa){Pa=yl(Pa);for(var Kd=Pa.next();!Kd.done;Kd=Pa.next()){if(Kd=Kd.value){var yd=Yb(Kd,this.$,1);if(yd&&R.Efd(yd.pj,qb,tc,dd))break;if((yd=Yb(Kd,this.$,
2))&&R.Efd(yd.pj,qb,tc,dd))break}if(dd.uc.SelectedRange){yd=yl(dd.uc.SelectedRange);for(var ze=yd.next();!ze.done;ze=yd.next())if((ze=ze.value)&&Kd&&Fa(Kd,ze)){Array.add(1===dd.uc.PresenceType?tc:qb,dd.Bz.KMb.User);return}}}}};R.prototype.U0e=function(Pa,qb,tc,dd){Pa&&R.Efd(this.kJh(Pa),qb,tc,dd)};R.prototype.IDg=function(Pa){Pa.SelectedRange&&(Pa.SelectedRangeRaw=this.t8g(Pa.SelectedRange),Pa.SelectedRange=this.sNa.oZg(Pa.SelectedRange))};R.prototype.t8g=function(Pa){for(var qb=Array(Pa.length),
tc=0;tc<Pa.length;tc++){var dd=tc,Kd=Pa[tc],yd={};yd.SheetName=Kd.SheetName;yd.FirstColumn=Kd.FirstColumn;yd.FirstRow=Kd.FirstRow;yd.LastRow=Kd.LastRow;yd.LastColumn=Kd.LastColumn;yd.NamedObjectName=Kd.NamedObjectName;qb[dd]=yd}return qb};R.prototype.kJh=function(Pa){if(Pa)switch(Pa.type){case 0:return(Pa=this.$.xb.oYe(Pa.id))?Pa.pj:null;case 2:return Pa.pj}return null};R.prototype.Z3a=function(){this.PK.eFa(this.mzd);this.PK.XBg(this.Axf);this.PK.$zg(this.htf);this.PK.i2(this.kd);this.sNa.gle(this.DCb)};
R.prototype.cjf=function(Pa,qb,tc,dd){var Kd={};Kd.a=this.$.ya.UserSessionId;Kd.b=Pa;Kd.c=tc?"PendingUserRemoved":"Non-PendingUserRemoved";Kd.d=dd?"Disconnected":"Inactivity";Kd.e=qb;Ac.b().Ne(22,Kd,!0)};R.prototype.CLf=function(Pa,qb){Pa in this.iu&&(this.LLf(Pa),this.iu[Pa].dispose(),delete this.iu[Pa],Ta.ULS.sendTraceTag(537154375,0,50,"PresenceView.RemovePresenceForUser: userId=[{0}] removed due to inactivity",Pa),this.cjf(Pa,rd.a.Ra.Kb,!1,qb));Pa in this.Gla&&(this.nic(Pa,!1),delete this.v9a[Pa],
delete this.Gla[Pa],Ta.ULS.sendTraceTag(537154374,0,50,"PresenceView.RemovePresenceForUser: Pending userId=[{0}] removed due to inactivity",Pa),this.cjf(Pa,rd.a.Ra.Kb,!0,qb))};R.prototype.LLf=function(Pa){for(var qb=this.Ax.length-1;0<=qb;qb--)if(this.Ax[qb].User.UserID===Pa){Array.removeAt(this.Ax,qb);for(var tc=yl(this.iu[Pa].Sx),dd=tc.next();!dd.done;dd=tc.next())this.Tx.Pma(dd.value.Ru.hB,!1);this.Pvc()}};R.prototype.Cmi=function(){if(this.v2b||this.w2b)this.$.Ce(-70383382,-1,0,null),Ta.ULS.sendTraceTag(537154373,
0,50,"PresenceView.LogDiscontinuousCountPresenceData: Discontinuous Presence Received with count= [{0}], Continuous Presence Received with count= [{1}]",this.w2b,this.v2b);this.w2b=this.v2b=0};R.prototype.Wve=function(){this.Jrd();this.JMc=this.v9a=null};R.prototype.Jrd=function(){var Pa=this.Gla,qb;for(qb in Pa)this.nic(qb,!1)};R.prototype.Vli=function(){var Pa=this.Z4c,qb;for(qb in Pa)this.Pif(qb,!0,Pa[qb]);Pa=this.bjd;for(var tc in Pa)this.Pif(tc,!1,Pa[tc]);this.Z4c={};this.bjd={}};R.prototype.nic=
function(Pa,qb){if(this.$.Ju&&this.$.fa.oc){var tc={};tc.a=this.$.ya.UserSessionId;tc.b=Pa;tc.c=qb;tc.e=!1;tc.d=-1;tc.f=rd.a.Ra.Kb;this.$.fa&&(tc.e=this.$.fa.cM);if(Pa=this.v9a[Pa])tc.d=je.a(rd.a.Ra,Pa);Ac.b().Ne(20,tc,!0)}};R.prototype.fsd=function(Pa){if(this.$.Ju){var qb={e:-1,f:-1,c:!1,d:!1};qb.b=Pa;qb.a=this.$.ya.UserSessionId;this.$.fa&&(qb.c=this.$.fa.Q3a,qb.d=this.$.fa.cM,qb.e=this.$.fa.Em.length,this.$.fa.xBa&&(qb.f=je.a(rd.a.Ra,this.$.fa.MPj)));Ac.b().Ne(21,qb,!0)}};R.prototype.Pif=function(Pa,
qb,tc){if(this.$.Ju){var dd={};dd.a=this.$.ya.UserSessionId;dd.b=Pa;dd.c=qb;dd.d=tc;Ac.b().Ne(19,dd,!0)}};R.prototype.x3e=function(){var Pa=[],qb=this.iu,tc;for(tc in qb){var dd=qb[tc];if(this.PK.nTf(dd.uc)){this.jke(Pa,dd);Array.remove(this.Ax,dd.Bz.KMb);if(1===this.PK.uc.PresenceType){var Kd={};Kd.a=1===dd.uc.PresenceType?"Editing":"Non-Editing";Kd.b=this.$.ya.UserSessionId;Kd.c=rd.a.Ra.Kb;Ac.b().Ne(18,Kd)}Kd=yl(dd.Sx);for(dd=Kd.next();!dd.done;dd=Kd.next())this.Tx.Pma(dd.value.Ru.hB,!0)}else for(Kd=
yl(dd.Sx),dd=Kd.next();!dd.done;dd=Kd.next())this.Tx.Pma(dd.value.Ru.hB,!1)}Array.clear(this.Ax);this.Ax=Pa;this.Pvc()};R.prototype.jke=function(Pa,qb){var tc=qb.Bz.KMb;if(qb.uc.PresenceType)Array.add(Pa,tc);else{qb=Pa.length;var dd;for(dd=0;dd<qb&&!this.iu[Pa[dd].User.UserID].uc.PresenceType;dd++);Array.insert(Pa,dd,tc)}};R.prototype.FZa=function(Pa){this.PK.nTf(Pa.uc)&&(this.jke(this.Ax,Pa),this.Pvc());var qb=Pa.Bz.KMb.User.UserID,tc=this.iu,dd;for(dd in tc){var Kd=tc[dd];dd!==qb&&Pa.FZa(Kd)}};
R.prototype.Pvc=function(){0<this.Ax.length&&this.fuj()};R.prototype.fuj=function(){for(var Pa=0,qb=this.Ax.length;Pa<qb;Pa++){var tc=this.iu[this.Ax[Pa].User.UserID];if(tc)if(this.PK.$Hf(tc.uc)){tc.B0f(!0);tc=yl(tc.Sx);for(var dd=tc.next();!dd.done;dd=tc.next())this.Tx.Pma(dd.value.Ru.hB,!0)}else(dd=this.PK.zXe(tc.uc))&&tc.C0f(!0,dd)}};R.prototype.cOh=function(Pa){var qb={User:{}};qb.User.UserID=Pa;qb.User.UserName=re.a.instance.Cb(86);qb.UserColor="#AAAAAA";return qb};R.prototype.yxe=function(Pa,
qb){var tc=this;this.ZNd&&this.XBd&&(Pa&&qb?this.WBd?this.WBd.tgh(Pa,qb,this.wqb):this.XBd.continueWith(function(){tc.WBd=tc.XBd.result;tc.yxe(Pa,qb)}):Ta.ULS.sendTraceTag(537154372,0,15,"userId: [{0}], endTime: [{1}]",Pa,qb))};R.Efd=function(Pa,qb,tc,dd){if(!dd||!dd.uc||!dd.uc.Object)return!1;for(var Kd=yl(dd.uc.Object),yd=Kd.next();!yd.done;yd=Kd.next())if(yd=yd.value,Pa&&yd&&yd.ObjectId&&!yd.ObjectId.localeCompare(Pa))return Array.add(1===yd.ObjectPresenceType?tc:qb,dd.Bz.KMb.User),!0;return!1};
tl.Object.defineProperties(R.prototype,{PK:{configurable:!0,enumerable:!0,get:function(){return this.Gde}},dBa:{configurable:!0,enumerable:!0,get:function(){return this.iu}},Gla:{configurable:!0,enumerable:!0,get:function(){return this.JMc}}});Object(fb.a)(R,"PresenceView",Jb.a,[400,401]);var af=b(200),rg=b(219),cg=b(459),Ie=Jb.a;vm(W,Ie);W.prototype.iq=function(Pa){this.addHandler("OSC",Pa)};W.prototype.zq=function(Pa){this.removeHandler("OSC",Pa)};W.prototype.gz=function(){this.raiseEvent("OSC")};
W.prototype.Jr=function(Pa,qb){if("QueryOcsConnectionStatus"===Pa)qb.Value=this.$.fa.j6a?re.a.instance.ea(890):re.a.instance.ea(891);else return!1;return!0};W.prototype.gn=function(){return!0};W.prototype.dispose=function(){this.statusBarManager&&(this.statusBarManager.iF(this),this.statusBarManager=null);this.$=null;Ie.prototype.dispose.call(this)};Object(fb.a)(W,"OcsStatusBarManager",Jb.a,[3,281,233]);var Ng=Jb.a;vm(ia,Ng);ia.prototype.wdd=function(){this.t5||(this.t5={},this.t5.IsPresenter=this.$.ya.IsMeetingPresenter,
this.t5.MeetingId=this.$.ya.MeetingId);return this.t5};ia.prototype.eFa=function(Pa){this.addHandler(ia.YBd,Pa)};ia.prototype.cza=function(Pa){this.removeHandler(ia.YBd,Pa)};ia.prototype.$zg=function(Pa){this.$.fa.rga(Pa)};ia.prototype.q4i=function(Pa){this.$.fa.Pca(Pa)};ia.prototype.i2=function(Pa){this.addHandler(ia.c0,Pa)};ia.prototype.Mca=function(Pa){this.removeHandler(ia.c0,Pa)};ia.prototype.XBg=function(Pa){this.addHandler(ia.ZBd,Pa)};ia.prototype.Q5i=function(Pa){this.removeHandler(ia.ZBd,
Pa)};ia.prototype.dispose=function(){this.$&&(this.WLb(),this.$.ml(this.od),this.$.Fn(this.qd));this.Aj&&this.Aj.dza(this.xla);id.a.Fa(this.Gpf);this.$=this.Aj=this.t5=null;Ng.prototype.dispose.call(this)};ia.prototype.MXg=function(Pa){this.Aj?this.Aj.dza(this.xla):this.Z3a();(this.Aj=Pa)?(this.Aj.fFa(this.xla),this.bbb(!0)):this.WLb()};ia.prototype.Z3a=function(){var Pa=this;this.ha.jG(this.kd);ae.g(this.$).DD(this.Wo);var qb=ae.g(this.$).Kc;qb.hq(this.Rh);qb.wm(this.Mj);this.$.fa.Sj(this.Zc);this.$.fa.Uke(this.Nef);
this.sNa.gle(this.DCb);qb=this.$.qa.ta;qb.KXa(this.fBf);qb.us(this.Zh);qb.FB(this.Xo);this.Idf?this.$.da.Za(16,function(tc){tc.Kke(Pa.olc);tc.Jke(Pa.Rh)}):(qb=uc.GetServiceTaskFactory.Xa(this.$.da,16,74,1),za.TaskExtensions.Ba(qb,function(tc){Pa.fieldManagerPane=tc.result;Pa.fieldManagerPane.Kke(Pa.olc);Pa.fieldManagerPane.Jke(Pa.Rh)},af.a.none,3))};ia.prototype.WLb=function(){var Pa=this;this.ha.mF(this.kd);ae.g(this.$).lF(this.Wo);var qb=ae.g(this.$).Kc;qb.Rp(this.Rh);qb.im(this.Mj);this.$.fa.kk(this.Zc);
this.$.fa.zMf(this.Nef);this.sNa.JMf(this.DCb);this.$.qa.ta.bab(this.fBf);this.$.qa.ta.Lt(this.Zh);this.$.qa.ta.VC(this.Xo);this.Idf?this.$.da.Za(16,function(tc){tc.qMf(Pa.olc);tc.pMf(Pa.Rh)}):this.fieldManagerPane&&(this.fieldManagerPane.qMf(this.olc),this.fieldManagerPane.pMf(this.Rh));this.raiseEvent(ia.ZBd)};ia.prototype.nTf=function(Pa){return this.$Hf(Pa)||!!this.zXe(Pa)};ia.prototype.$Hf=function(Pa){if(2===this.uc.Version&&this.uc.Object&&2===Pa.Version&&Pa.Object&&0<this.uc.Object.length&&
0<Pa.Object.length)for(var qb=this.uc.Object.length,tc=Pa.Object.length,dd=0;dd<qb;dd++)for(var Kd=0;Kd<tc;Kd++)if(this.XUc(this.uc.Object[dd],Pa.Object[Kd]))return!0;if(this.uc.SelectedRange&&Pa.SelectedRange)for(qb=this.uc.SelectedRange.length,tc=Pa.SelectedRange.length,dd=0;dd<qb;dd++)for(Kd=0;Kd<tc;Kd++)if(ia.FGg(this.uc.SelectedRange[dd],Pa.SelectedRange[Kd]))return!0;return!1};ia.prototype.zXe=function(Pa){if(2===this.uc.Version&&this.uc.Object&&2===Pa.Version&&Pa.Object&&0<this.uc.Object.length&&
0<Pa.Object.length)for(var qb=this.uc.Object.length,tc=Pa.Object.length,dd=0;dd<qb;dd++)for(var Kd=0;Kd<tc;Kd++)if(ia.Jxi(this.uc.Object[dd],Pa.Object[Kd]))return this.uc.Object[dd].ObjectId;return null};ia.prototype.XUc=function(Pa,qb){return!!Pa&&!!qb&&Pa.ObjectType===qb.ObjectType&&(1===Pa.ObjectType||3===Pa.ObjectType)&&!!Pa.ObjectId&&!!qb.ObjectId&&!Pa.ObjectId.localeCompare(qb.ObjectId)};ia.prototype.uTf=function(){this.bbb(!1)};ia.prototype.bbb=function(Pa){this.ha.Qa.nc?this.WKd(0,Pa):this.eLd(ae.g(this.$).Kc.isEditing?
1:0,Pa)};ia.prototype.WKd=function(Pa,qb){var tc={};this.$.wj(tc);if(this.ha.Qa.nc){var dd=this.ha.Qa.nc.floatingObject;tc.FirstColumn=-1;tc.FirstRow=-1;tc.LastColumn=-1;tc.LastRow=-1;tc.NamedObjectName=dd?dd.Eg():null;this.uc.SelectedRange=[tc];this.uc.PresenceType=0;tc=null;if(dd)switch(dd.type){case 0:if(dd=this.$.xb.oYe(dd.id))tc={},tc.ObjectType=this.naa(0),tc.ObjectPresenceType=Pa,tc.ObjectId=dd.pj;break;case 2:dd.id&&(tc={},tc.ObjectType=this.naa(9),tc.ObjectPresenceType=Pa,tc.ObjectId=dd.pj)}this.uc.Object=
[tc]}this.raiseEvent(ia.c0);this.sendPresenceToService(qb)};ia.prototype.eLd=function(Pa,qb){if(!ae.g(this.$).isEditing&&!ae.g(this.$).zi){var tc=this.$.Ub.Xh("ModelUpdate","SendRangePresence");tc.start();var dd=oc.k(this.ha.va.selectedRanges,this.$);this.uc.SelectedRange=this.sNa.nZg(dd);this.uc.Object=[];dd=yl(dd);for(var Kd=dd.next();!Kd.done;Kd=dd.next())if(Kd=Yb(Kd.value,this.$,1)){var yd={};yd.ObjectType=this.naa(Kd.type);yd.ObjectPresenceType=0;yd.ObjectId=Kd.pj;Array.add(this.uc.Object,yd)}this.uc.PresenceType=
Pa;this.raiseEvent(ia.c0);this.uc.SelectedRange||this.uc.Object?this.sendPresenceToService(qb):Ta.ULS.sendTraceTag(537154371,0,50,"SelectionPresenceManager.SendRangePresence: skip sending range presence since selected range/object are both null.  UserId: [{0}]",this.Aj.clientId);tc.stop()}};ia.prototype.sendPresenceToService=function(Pa){if(this.$.fa.Q5b||!this.$.fa.J1b||Pa)if(this.amIAlone||++this.Gza.b,this.Aj){this.uc.Version=2;this.uc.ClientType=1;this.uc.ChatThreadId=this.UVa.ZYc;this.uc.ChatThreadDiscoveryUri=
this.UVa.YYc;this.uc.InChat=this.UVa.qwb;this.uc.Cid=this.UVa.email;this.uc.SupportsChat=!!this.UVa.capabilities&&this.UVa.capabilities.mKa(4);this.uc.CollabMode=this.$.fa.j6a?2:0;this.uc.OcsCapable=this.$.fa.ocsCapable;!this.uc.MeetingInfo&&this.$.ya.IsMeetingLiveSession&&this.$.ya.IsMeetingPresenter&&cc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SendPresenterDetailsForExcelLive",!1)&&(this.uc.MeetingInfo=this.wdd());this.Aj.LTf(this.uc);if(cc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")&&
this.$.fa&&this.$.fa.Q3a){var qb=(new Date).getTime();za.TaskExtensions.Ba(uc.GetServiceTaskFactory.Xa(this.$.da,435,436,1),function(tc){tc.result.Tni(qb)},this.$.ma,3)}this.amIAlone||++this.Gza.c}};ia.prototype.TKd=function(){this.$.Ju&&(this.Gza.a=this.$.ya.UserSessionId,Ac.b().Ne(26,this.Gza,!0));this.Gza.b=0;this.Gza.c=0};ia.prototype.naa=function(Pa){switch(Pa){case 0:return 0;case 1:return 1;case 2:return 3;case 9:return 2;default:return-1}};ia.Jxi=function(Pa,qb){return!!Pa&&!!Pa.ObjectId&&
!!qb&&!!qb.ObjectId&&(!Pa.ObjectType||2===Pa.ObjectType)&&Pa.ObjectType===qb.ObjectType&&!Pa.ObjectId.localeCompare(qb.ObjectId)};ia.FGg=function(Pa,qb){return!Pa.NamedObjectName&&Fa(Pa,qb)};tl.Object.defineProperties(ia.prototype,{uc:{configurable:!0,enumerable:!0,get:function(){return this.kqa}},amIAlone:{configurable:!0,enumerable:!0,get:function(){return!this.$.fa||this.$.fa.amIAlone}}});tl.Object.defineProperties(ia,{Unc:{configurable:!0,enumerable:!0,get:function(){var Pa={};return ia.Yae||
(ia.Yae=(Pa.ApplyFilter=1,Pa.ApplyPivot=0,Pa.ApplyPivotSort=0,Pa.ApplyPivotSortByValue=1,Pa.ApplyWellKnownPivotFilter=0,Pa.RemovePivotFilter=0,Pa.SetCustomFilter=1,Pa.SetTop10Filter=1,Pa.TogglePivotDrill=0,Pa.RefreshAll=2,Pa))}}});ia.YBd="presenceChanged";ia.ZBd="presenceDisabled";ia.c0="selectionChanged";ia.Yae=null;Object(fb.a)(ia,"SelectionPresenceManager",Jb.a,[421,3,422]);var Zf=pe.a;vm(P,Zf);P.prototype.create=function(){var Pa=this;this.manager?this.Fb(this.manager):za.TaskExtensions.Ba(uc.GetServiceTaskFactory.create(this.$.da,
28,this.ma,this.tb),function(qb){Pa.Fb(Pa.manager||(Pa.manager=new ia(Pa.$,qb.result)))},this.ma,3)};Object(fb.a)(P,"SelectionPresenceManagerFactory",pe.a,[]);var ng=b(1255),Ff=b(4),be=b(180),Rf=Uf.a;vm(N,Rf);N.prototype.AXe=function(Pa,qb){this.kHa=[];qb=this.presenceView.VKh(Pa,qb);Pa=qb.Q6h;qb=qb.Beh;Array.addRange(this.kHa,Pa);Array.addRange(this.kHa,qb);return N.fse(Pa,qb)};N.prototype.dispose=function(){this.presenceView.cza(this.PCb);this.KOa&&(id.a.Fa(this.KOa),this.KOa=null);Rf.prototype.dispose.call(this)};
N.fse=function(Pa,qb){if(!Pa.length&&!qb.length)return"";if(qb.length){if(1===qb.length)return Pa=re.a.instance.Cb(82),String.format(Pa,qb[0].UserName);Pa=re.a.instance.Cb(83);return String.format(Pa,qb.length)}if(1===Pa.length)return qb=re.a.instance.Cb(84),String.format(qb,Pa[0].UserName);qb=re.a.instance.Cb(85);return String.format(qb,Pa.length)};Object(fb.a)(N,"PresenceReadoutHandlerService",Uf.a,[402]);G.prototype.otb=function(Pa){return Pa};G.prototype.cEb=function(Pa){for(var qb=Array(Pa.kha.count),
tc=0,dd=yl(Pa.kha.values),Kd=dd.next();!Kd.done;Kd=dd.next())qb[tc]=Kd.value,tc++;return U(this.$.qa.ta,qb,Pa.lr,Pa.J3,null,null)};G.prototype.Cmb=function(Pa,qb){if(!qb)return Pa;if(!Pa)return Ta.ULS.shipAssertTag(537154136,0,!!Pa,"CheckCollabServiceActionAggregationPerformer.AggregateActionParameters: Received null newActionParameters"),qb;Ta.ULS.shipAssertTag(537154135,0,1===Pa.kha.count,"CheckCollabServiceActionAggregationPerformer.AggregateActionParameters: newActionParameters has unexpected number of entries");
for(var tc={},dd=yl(Pa.kha),Kd=dd.next();!Kd.done;tc={pO:tc.pO,nea:tc.nea},Kd=dd.next())tc.pO=Kd.value,tc.nea=void 0,function(yd){return function(){var ze=qb.kha.Ec(yd.pO.key);yd.nea=ze.value;return ze}}(tc)().returnValue?tc.nea.OcsSessionId!==tc.pO.value.OcsSessionId?(Ta.ULS.sendTraceTag(537154134,0,15,"CheckCollabServiceActionAggregationPerformer.AggregateActionParameters: Found nonidentical OcsSessionIds. new SeqNum: {0}, aggregated SeqNum: {1}",tc.pO.value.SeqNum,tc.nea.SeqNum),qb.kha.ia(tc.pO.key,
tc.pO.value.SeqNum<tc.nea.SeqNum?tc.pO.value:tc.nea),qb.lr=tc.pO.value.SeqNum<tc.nea.SeqNum?Pa.lr:qb.lr):(tc.pO.value.SeqNum>tc.nea.SeqNum&&qb.kha.ia(tc.pO.key,tc.pO.value),qb.lr=Pa.lr):(qb.kha.add(tc.pO.key,tc.pO.value),qb.lr=Pa.lr);return qb};Object(fb.a)(G,"CheckCollabServiceActionAggregationPerformer",null,[357,349]);r.prototype.otb=function(Pa){return Pa};r.prototype.cEb=function(Pa){var qb=this.$.qa.ta,tc=Pa.v7g,dd=Pa.Rkc;Pa=Pa.lr;var Kd=qb.Oa(1,null);Kd.Id=tc;Kd.OnBehalfOfOcs=dd;return Jf.i(qb,
"CheckPersistedContentUpdate",Kd,Pa,null,null,null,516)};r.prototype.Cmb=function(Pa,qb){if(!qb)return Pa;if(!Pa)return Ta.ULS.shipAssertTag(537154133,0,!1,"CheckPersistedActionAggregationPerformer.AggregateActionParameters: Received null newActionParameters"),qb;Pa.Rkc=qb.Rkc&&Pa.Rkc;return Pa};Object(fb.a)(r,"CheckPersistedActionAggregationPerformer",null,[357,349]);z.prototype.otb=function(Pa){return Pa};z.prototype.cEb=function(Pa){var qb=this.$.qa.ta;Pa=Pa.eWd;var tc=qb.Oa(1,null);tc.UploadInfo=
Pa;return Jf.i(qb,"ProcessUploadRtcNotification",tc,null,null,null,null,0)};z.prototype.Cmb=function(Pa,qb){if(!qb)return Pa;if(!Pa)return Ta.ULS.shipAssertTag(537154132,0,!!Pa,"UploadNotificationActionAggregationPerformer.AggregateActionParameters: Received null newActionParameters"),qb;qb.$Ij(Pa);return qb};Object(fb.a)(z,"CheckUploadNotificationActionAggregationPerformer",null,[357,349]);Object(fb.a)(t,"RevisionGeneratedNotification",null,[]);Object(fb.a)(x,"StateDownloadedNotification",null,[]);
var Re=b(122),Ze=Uf.a;vm(A,Ze);A.prototype.dispose=function(){this.Ld=!0;this.onb&&(this.onb.dispose(),this.onb=null);this.contentRefreshManager&&(this.S8f(),this.contentRefreshManager=null);this.Ca&&(this.YUd(),this.Ca=null);this.viewport&&(this.YUd(),this.viewport=null);this.uf&&(this.uf=null);this.$&&(this.$.ml(this.od),this.$.fa.kk(this.Zc),this.$.fa.ZMf(this.Hv),this.$=null);this.mergeSuspensionManager&&(this.mergeSuspensionManager.Sqc(this.jDb),this.mergeSuspensionManager=null);Ze.prototype.dispose.call(this)};
A.prototype.Qyj=function(){this.fxc||(this.contentRefreshManager.eCg(this.dyf),this.fxc=!0,this.onb.Bq())};A.prototype.S8f=function(){this.fxc&&(this.contentRefreshManager.W5i(this.dyf),this.fxc=!1)};A.prototype.Oyj=function(){this.dxc||(this.Ca.np(this.Hg),this.dxc=!0)};A.prototype.YUd=function(){this.dxc&&(this.Ca.yq(this.Hg),this.dxc=!1)};A.prototype.Pyj=function(){this.exc||(this.viewport.fCg(this.hyf),this.exc=!0)};A.prototype.NHj=function(){this.exc&&(this.viewport.Z5i(this.hyf),this.exc=!1)};
A.prototype.lAe=function(Pa,qb){if(Pa!==Ad.a.Se&&!this.yda.wb(Pa)){var tc=rd.a.Ra.Kb.toISOString();tc=Object.assign(new x,{StateId:Pa,DownloadedOn:tc,IsHidden:this.ef?this.ef.kj:"visible"!==window.document.visibilityState,DocumentLastUnhidden:this.ef&&this.ef.phc?this.ef.phc.toISOString():null,LastLostRtcConnection:this.contentRefreshManager&&this.contentRefreshManager.ngf?this.contentRefreshManager.ngf.toISOString():null,LastOffline:this.uf&&this.uf.Kwa?this.uf.Kwa.toISOString():null});this.mergeSuspensionManager&&
(tc.IsPendingMergeBlockedByClient=this.kwa,this.NAd&&(tc.PendingMergeBlockedByClientLastEnded=this.NAd.toISOString()));Ta.ULS.sendTraceTag(537154124,13,50,"ContentLatencyTracker.CreateAndAddstateDownloadedNotifications: {0} - StateDownloadedNotification: {1}",qb,JSON.stringify(tc));this.yda.add(Pa,tc)}};A.prototype.vtd=function(){tb.AFrameworkApplication.Zf&&tb.AFrameworkApplication.Zf.vtd()};Object(fb.a)(A,"ContentLatencyTracker",Uf.a,[]);var hg=b(1025);Object(fb.a)(m,"UpdateInfo",null,[]);var Bg=
b(101);Object(fb.a)(v,"CollabServiceContentUpdateActionParameters",null,[]);var qh=b(1026),Zg=Sys.EventArgs;vm(u,Zg);Object(fb.a)(u,"RevisionGeneratedEventArgs",Sys.EventArgs,[]);f.prototype.xKj=function(){this.woc||(this.woc=Ee.a.se(),this.dAb())};f.prototype.uKj=function(){this.Bcc||(this.Bcc=Ee.a.se(),this.dAb())};f.prototype.wKj=function(){this.Mnc||(this.Mnc=Ee.a.se(),this.dAb())};f.prototype.yKj=function(Pa){this.oAc||(this.oAc=Ee.a.se(),this.C9e=Pa,this.dAb())};f.prototype.dAb=function(Pa){Pa=
void 0===Pa?0:Pa;this.Cbf||(Pa&&Pa>this.Goi?this.Xwa(!0):this.woc&&this.Mnc&&this.Bcc&&this.oAc&&this.Xwa(!1))};f.prototype.dispose=function(){this.$=null};f.prototype.Xwa=function(Pa){var qb={};qb.CoAuthorsCount=this.$.fa.Em.length;qb.HostNotificationTime=this.Bcc;qb.PeerNotificationTime=this.Mnc;qb.PresenceNotificationTime=this.woc;qb.UserFetchTime=this.oAc;qb.IsAlreadyFetchedFromServer=this.C9e;qb.IsTimeout=Pa;qb.ClientId=this.clientId;qb.CurrentUserClientId=this.Z6g;Ta.ULS.sendTraceTag(541388879,
0,50,"Host Notification Latency Entry: {0}",qb);this.H6d=!0};tl.Object.defineProperties(f.prototype,{Cbf:{configurable:!0,enumerable:!0,get:function(){return this.H6d}}});Object(fb.a)(f,"HostNotificationLatencyEntry",null,[3]);Object(fb.a)(l,"PersistedContentUpdateActionParameters",null,[]);n.prototype.TGj=function(Pa){this.QYb(Pa.UZc,this.mEc);this.QYb(Pa.VZc,this.nEc)};n.prototype.QYb=function(Pa,qb){if(Pa){Pa=yl(Pa);for(var tc=Pa.next();!tc.done;tc=Pa.next())qb[tc.value]=!0}};tl.Object.defineProperties(n.prototype,
{UZc:{configurable:!0,enumerable:!0,get:function(){return og.a(this.mEc)}},VZc:{configurable:!0,enumerable:!0,get:function(){return og.a(this.nEc)}},Daf:{configurable:!0,enumerable:!0,get:function(){return!this.UZc.length&&!this.VZc.length}}});Object(fb.a)(n,"UpdatePresenceUsersActionParameters",null,[]);Object(fb.a)(k,"UploadRevisionInfo",null,[]);c.prototype.$Ij=function(Pa){for(var qb=0;qb<Pa.eWd.length;qb++){var tc=Pa.eWd[qb];this.fWd.add(tc.ClientId,tc)}};tl.Object.defineProperties(c.prototype,
{eWd:{configurable:!0,enumerable:!0,get:function(){return this.fWd.values}}});Object(fb.a)(c,"UploadNotificationActionParameters",null,[]);var qf=Jb.a;vm(d,qf);d.prototype.eCg=function(Pa){this.addHandler("ekcrmrrg",Pa)};d.prototype.W5i=function(Pa){this.removeHandler("ekcrmrrg",Pa)};d.prototype.mmb=function(Pa){this.addHandler("ekcrmmcu",Pa)};d.prototype.jGb=function(Pa){this.removeHandler("ekcrmmcu",Pa)};d.prototype.WAg=function(Pa){this.addHandler("LabelUpdateEventKey",Pa)};d.prototype.a5i=function(Pa){this.removeHandler("LabelUpdateEventKey",
Pa)};d.prototype.mMb=function(Pa,qb){this.$.fa.oc&&(Ta.ULS.sendTraceTag(537154119,0,50,"ContentRefreshManager.UpdatePresenceUsers: clientIdsToAdd=[{0}] clientIdsToRemove=[{1}]",Pa?Pa.join(","):"null",qb?qb.join(","):"null"),this.RKj.dEb(new n(Pa,qb,null)))};d.prototype.dispose=function(){this.Aj&&(this.Aj.sGb(this.Wba),this.Aj.dza(this.Uyd));this.$&&(this.$.qa.Lt(this.Zh),this.$.fa.Pca(this.IH));this.ln&&(this.ln.EGd(this.XBb),this.ln.fMf(this.ksf));this.$=this.Aj=this.IZa=this.CKa=null;qf.prototype.dispose.call(this)};
d.prototype.HQd=function(Pa){this.Aj&&(this.Aj.sGb(this.Wba),this.Aj.dza(this.Uyd));this.Aj=Object(E.a)(129,Pa);this.Aj.IXa(this.Wba);cc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EditorsTableNotification",!1)&&this.Aj.fFa(this.Uyd);this.currentUserId=this.Aj.clientId};d.prototype.qJf=function(){for(var Pa=!this.Aj,qb=yl(this.$.fa.Em),tc=qb.next();!tc.done;tc=qb.next())(tc=tc.value.User.UserID)&&tc!==this.currentUserId&&!this.IZa.has(tc)&&this.jac(tc).yKj(Pa)};d.prototype.wYh=function(Pa){if(Ad.a.MQf in
Pa&&Ad.a.LQf in Pa&&Ad.a.KQf in Pa){var qb=Pa[Ad.a.KQf];1!==qb||Ad.a.K6 in Pa&&Ad.a.jsc in Pa||Ta.ULS.sendTraceTag(537154076,13,10,"RTC WetContentUpdate was sent from ECS and is missing some expected fields. Has SessionSiteIdentifier: {0}, Has UserOperationTimeInMs: {1}.",Ad.a.K6 in Pa,Ad.a.jsc in Pa);var tc=this.DFa(Pa);var dd=tc.YIf;tc.returnValue||(Pa=new u(Pa[Ad.a.MQf],Pa[Ad.a.LQf],qb,dd,Ad.a.jsc in Pa?Pa[Ad.a.jsc]:0),this.raiseEvent("ekcrmrrg",Pa,this))}else Ta.ULS.sendTraceTag(537154077,13,
10,"RTC WetContentUpdate is missing some critical fields. Ignoring this update.")};d.prototype.DFa=function(Pa){Pa=Ad.a.K6 in Pa?Pa[Ad.a.K6]:null;return{returnValue:this.$.fa.K6===Pa,YIf:Pa}};d.prototype.m9f=function(){this.$.fa.Ima=Math.max(d.$Ig,this.$.fa.Ima)};d.prototype.vOd=function(Pa){Pa=yl(Pa);for(var qb=Pa.next();!qb.done;qb=Pa.next())if(!this.$.fa.Cfd(qb.value))return!0;return!1};d.prototype.eZc=function(){this.$.Ce(1562177611,-1,0,null)};d.prototype.WNa=function(Pa){Ad.a.xmf in Pa&&Ad.a.ymf in
Pa&&Ad.a.zmf in Pa&&(Pa=Object.assign(new hg.a,{Pending:Pa[Ad.a.ymf],Current:Pa[Ad.a.xmf],SuspensionStartTimestamp:Pa[Ad.a.zmf]}),this.raiseEvent("ekcrmmcu",new qh.a(Pa),this))};d.prototype.jac=function(Pa){Pa=this.qze(Pa);if(!this.CKa[Pa]){var qb=new f(Pa,this.currentUserId,4E4,this.$);this.CKa[Pa]=qb}this.oSf();return Object(E.a)(f,this.CKa[Pa])};d.prototype.qze=function(Pa){if(!Pa)return Pa;var qb=Pa.toLocaleLowerCase();qb.startsWith("{")||(qb="{"+Pa+"}");return qb};d.prototype.oSf=function(){var Pa=
this;this.Zhd||bb.a.isEmpty(this.CKa)||!cc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EditorsTableNotification",!1)||(this.Zhd=Ha.Task.delay(2E4).continueWith(function(){Pa.G0h()}))};d.prototype.G0h=function(){var Pa=[],qb=Ee.a.se(),tc=this.CKa,dd;for(dd in tc){var Kd=dd,yd=Object(E.a)(f,tc[dd]);yd.dAb(qb);yd.Cbf&&(yd.dispose(),Pa.push(Kd))}Pa=yl(Pa);for(qb=Pa.next();!qb.done;qb=Pa.next())qb=qb.value,delete this.CKa[qb],this.IZa.add(qb);this.Zhd=null;this.oSf()};tl.Object.defineProperties(d.prototype,
{ngf:{configurable:!0,enumerable:!0,get:function(){return this.Z7d}},ibj:{configurable:!0,enumerable:!0,get:function(){return!!this.Aj&&2===this.Aj.connectionState}}});d.$Ig=3E4;Object(fb.a)(d,"ContentRefreshManager",Jb.a,[398]);var mh=b(60);a.prototype.otb=function(Pa){return Pa+5E3};a.prototype.cEb=function(Pa){var qb=this;return this.$.fa.oc?za.TaskExtensions.ts(za.TaskExtensions.ts(Ha.Task.delay(0),function(){var tc=qb.$.qa.ta,dd=Pa.UZc,Kd=Pa.VZc,yd=Pa.lr,ze=tc.Oa(1,null);ze.clientIdsToAdd=dd;
ze.clientIdsToRemove=Kd;return Jf.i(tc,"UpdatePresenceUsers",ze,yd,null,null,null,0)},af.a.none,0,mh.a.current),function(){return Ha.Task.delay(5E3)},af.a.none,0,mh.a.current):Ha.Task.Ta(!0)};a.prototype.Cmb=function(Pa,qb){if(!qb)return Pa;if(!Pa)return Ta.ULS.shipAssertTag(537154073,0,!1,"UpdatePresenceUsersActionAggregationPerformer.AggregateActionParameters: Received null newActionParameter"),qb;if(qb.Daf)return qb;if(Pa.Daf)return Pa;qb.TGj(Pa);return qb};Object(fb.a)(a,"UpdatePresenceUsersActionAggregationPerformer",
null,[357,349]);Type.registerNamespace("_Ewa");Type.registerNamespace("Common.App.CoauthTelemetry");xb.main();Type.registerNamespace("Common.App.CollabControls");Type.registerNamespace("Common.App.Presence");Type.registerNamespace("RealtimePresenceUI");Xd.a.Ga(Lb.ja);(function(){Xd.a.Ga(function(Pa){cc.EwaSettings.isChangeGateEnabled("OfficeVSO:5140517_PresenceBootBreakDownMetrics")&&hb.ja(Pa);var qb=Pa.da;qb.Ha(28,new sa(Pa));qb.Ha(158,new P(Pa));Xd.a.Ga(Qb.ja);var tc=uc.GetServiceTaskFactory.create(Pa.da,
158,qb.ma,1),dd=uc.GetServiceTaskFactory.create(Pa.da,28,qb.ma,1);za.TaskExtensions.Ba(za.TaskExtensions.ve([tc,dd],qb.ma),function(){var Kd=new wb.a,yd=qb.Aa(26);yd.XBe(Object(eb.a)(Kd,Kd.setResult,"setResult"));var ze=new R(Pa,yd,tc.result,dd.result,db.a.Fq(rc.a.instance.mc("Common.App.CoauthTelemetry.IPresenceBootTelemetry")));de.a.getInstance(Pa.da).add(ze);qb.Ha(159,new Qb);za.TaskExtensions.Ba(uc.GetServiceTaskFactory.create(qb,159,qb.ma,1),function(te){var lf=new wb.a;lf.setResult(ze);new Ra(Object.assign(new Qd.a,
{clientId:Pa.workbookContext.ClientId}),Kd.task,lf.task,te.result,Vd.a.instance,tb.AFrameworkApplication.ga.ra("AwayStatusOneMinuteTimeoutIsEnabled")?6E4:tb.AFrameworkApplication.ga.zd("AwayCoauthorThresholdMs",9E5),Object(eb.a)(tb.AFrameworkApplication.Eb,tb.AFrameworkApplication.Eb.processAction,"processAction"),ta.instance)},qb.ma)},qb.ma,3);rc.a.instance.register(375,"Microsoft.Office.Excel.WebUI.Client.ISessionStateManager").as("Common.ICoauthoringTelemeryInfoProvider").zc().Ic(function(){return Pa.fa});
rc.a.instance.resolve("Common.ICoauthoringTelemeryInfoProvider");rc.a.instance.register(xa,"Microsoft.Office.Excel.WebUI.Client.Presence.PeopleInfoProvider").as("Common.IPeopleInfoProvider").zc().Ic(function(){return new xa(Pa)});rc.a.instance.resolve("Common.IPeopleInfoProvider")})})();Xd.a.Ga(ng.a.ja);Xd.a.Ga(function(Pa){var qb=Pa.da,tc=uc.GetServiceTaskFactory.Xa(Pa.da,211,212,1);qb.Za(25,function(dd){za.TaskExtensions.Ba(tc,function(Kd){qb.Aa(231)||new N(Kd.result,Pa,dd)},qb.ma,3)})});(function(){Xd.a.Ga(function(Pa){za.TaskExtensions.Ba(uc.GetServiceTaskFactory.Xa(Pa.da,
12,477,0),function(qb){var tc=new G(Pa),dd=Pa.da.Aa(291);tc=qb.result.Ppb(tc,tc,dd,"collabService");var Kd=new r(Pa);dd=qb.result.Ppb(Kd,Kd,dd,"persisted");Kd=new a(Pa);Kd=qb.result.Ppb(Kd,Kd,null,"updatePresence");var yd=new z(Pa);qb=qb.result.Ppb(yd,yd,null,"uploadNotification");Pa.da.Ha(292,new d(Pa,Pa.da.Aa(26),tc,dd,Kd,qb));de.a.getInstance(Pa.da).add(new A(Pa));de.a.getInstance(Pa.da).add(tc);de.a.getInstance(Pa.da).add(dd);de.a.getInstance(Pa.da).add(qb)},Pa.ma)})})()},840:function(y,D,b){function a(){}
b.r(D);b.d(D,"RtcUtils",function(){return a});y=b(0);var d=b(13),c=b(934),k=b(38);a.bZc=function(n,l){l=void 0===l?c.RealtimeChannel.Dtd:l;try{var f=k.c(n)}catch(u){throw n=String.format("Failed to JSON-serialize payload : {0}",u),d.ULS.sendTraceTag(18637072,500,10,n),Error.argument("payload",n);}if(f.length>l)throw n=String.format("Payload exceeds maximum length: {0} > {1}.",f.length,l),d.ULS.sendTraceTag(18637074,500,10,n),Error.argument("payload",n);return f};a.deserialize=function(n,l,f){if(!n)return null;
if(Object.getType(n)!==String){var u=String.format("Failed to deserialize [{0}] - object is not of type [String] and is instead of type [{1}]. ExtraInfo: [{2}].",l,Object.getType(n).getName(),f);d.ULS.sendTraceTag(18637075,500,10,u);return null}u=null;try{u=k.a(n)}catch(v){n=String.format("Failed to deserialize [{0}]. Exception deserializing the object : [{1}]. ExtraInfo: [{2}].",l,v,f),d.ULS.sendTraceTag(18637077,500,10,n)}return u};a.Exa=function(n){if(!n)return"";if("string"===typeof n)return n.toString();
try{return k.c(n)}catch(l){return n.toString()}};a.Ssh=function(n){var l;var f=0;var u=l=null;if(!n)return{r6e:f,t6e:l,mg:u};try{var v=n.source;v&&Object.getType(v)===String&&(u=v);var m=n.context;m&&(n=m,f=n.status?n.status:0,l=n.statusText?n.statusText:null)}catch(A){}return{r6e:f,t6e:l,mg:u}};Object(y.a)(a,"RtcUtils",null,[])},934:function(y,D,b){function a(xa,sa,lb,Yb,Fa,Sa,Ra,Lb,Ja,xb,Kb,Eb){this.yPc=!1;this.W7=null;this.aG=new na.a;this.ggb=1;this.zO=null;this.$s=!1;this.$Jc=(new Date(0)).getTime();
this.zee=0;this._clientId=xa;this.KVb=sa;this.jL=0;this.uh=Yb;this.IEc=Lb;this.Oqg=Ra;this.Sfg=Ja;this.rig=Fa;this.Doa=Sa;this.Ll=lb;this.jp=xb;this.xe=Kb;this.Og=Eb;this.Org=1>100*Math.random()}function d(xa){return xa?xa.charAt(0).toLocaleUpperCase()+xa.substring(1,xa.length):xa}function c(xa,sa,lb){return String.format("ClientID={0}, App={1}, ClientType={2}, SessionId={3}",xa,d(ta[lb]),d("browser"),sa)}function k(xa,sa,lb,Yb,Fa,Sa,Ra,Lb,Ja,xb,Kb,Eb){Ja=void 0===Ja?null:Ja;xb=void 0===xb?null:xb;
Kb=void 0===Kb?null:Kb;Eb=void 0===Eb?null:Eb;var Hc=B.createInstance(Z.AFrameworkApplication.ga),Xc=Z.AFrameworkApplication.buildVersion?Z.AFrameworkApplication.buildVersion:"1.0",Pc=c(xa,sa,Ra,Xc),wd=Hc.qUg?b(1297).RealtimeChannelMetrics.createInstance(Pc):new ia,Tc=Ia.a.create(Fa);Hc.rtcJsClientFrequentlyLogsMetrics&&Tc.gxj(Hc.pbj);var ub="";ub=Ja&&""!==Ja?Ja:"/rtc2/";Tc.DQe=wa.a.oM(ub);var fb=ub+"signalr";Ja=ub+"findsession";var Ta=N.W0h;ub=new l;Kb=Kb||ob.a.getInstance();ba.ULS.shipAssertTag(556867617,
500,Hc.RQf<=b(934).RealtimeChannel.Nlf,"Client attempting to override max payload size beyond absolute limit");var eb=Math.min(Hc.RQf,b(934).RealtimeChannel.Nlf);Tc.Mlf=eb;Tc=new m(Hc,new n(ub),xa,Pc,function(tb){return new U(tb.createHubProxy(Ta))},Lb,Kb,wd,Tc,eb);xb||(xb=b(1236).FindSessionStrategy.createInstance(sa,Fa,Ja,Lb,Xc,Ra,xa,Pc,Kb,Sa,Yb,Eb));xb.a8b=Hc.a8b;sa=new W(Pc);lb=lb?lb.split(","):null;xa=new (b(934).RealtimeChannel)(xa,lb,Pc,Lb,function(){return $.hubConnection(fb)},xb,Tc,sa,Kb,
wd,Hc,Fa);xa.init();return xa}function n(xa){var sa=this;this.xe=null;this.Hw=!1;this.Ya=new Qb.a;this.hLc=new na.a;this.gLc=new na.a;this.hQc=xa;this.UUa=this.hQc.pBe(function(lb){return lb.send()},"GlobalMaxOustandingThrottler");this.UUa.YXb(function(){sa.Ya.raiseEvent("TMUDM")})}function l(){}function f(xa,sa){xa=v.call(this,xa,void 0===sa?"":sa)||this;xa.u7a=0;xa.oib=(new Date(0)).getTime();xa.currentTime=function(){return(new Date).getTime()};return xa}function u(xa,sa){xa=v.call(this,xa,void 0===
sa?"":sa)||this;xa.CAa=0;xa.q7a=0;xa.Ya=new Qb.a;xa.pVa=!1;xa.gQc=0;xa.yPb=0;xa.KPb=0;xa.RSb=0;xa.EVb=[];xa.clearTimeout=u.e4c;return xa}function v(xa,sa){this.Mgb=this.Vkb=0;this.cJc=!1;this.JWa=this.BVb=null;this.qVa=!1;this.Jde=xa;this.l5f=void 0===sa?"":sa;this.setTimeout=v.r4c;this.yEa=this.Vkb=this.Mgb=0}function m(xa,sa,lb,Yb,Fa,Sa,Ra,Lb,Ja,xb){Ra=w.call(this,Ra)||this;Ra.ur=null;Ra.Q8d=!1;Ra.HO=0;Ra.HMc=new Xa.a;Ra.xe=xa;Ra.u$d=0;Ra.v$d=0;Ra.Wkb=sa;Ra.Wkb.YXb(Object(ca.a)(Ra,Ra.ULi,"onTooManyUndeliveredMessages"));
Ra._clientId=lb;Ra.Gpg=Fa;Ra.eh.cCg(Object(ca.a)(Ra,Ra.RIi,"onRefreshProxyRequired"));Ra.eh.aCg(Object(ca.a)(Ra,Ra.OIi,"onRefreshAllPersistentStateRequest"));Ra.eh.tCg(Object(ca.a)(Ra,Ra.fda,"sendUpdateNotification"));Ra.eh.MAg(Object(ca.a)(Ra,Ra.RFi,"onInternalPresenceUpdated"));Ra.eh.NAg(Object(ca.a)(Ra,Ra.SFi,"onInternalUpdateNotificationReceived"));Ra.eh.LAg(Object(ca.a)(Ra,Ra.QFi,"onInternalPersistentStateUpdated"));Ra.eh.KAg(Object(ca.a)(Ra,Ra.PFi,"onInternalPersistentStateCleared"));Ra.eh.sCg(Object(ca.a)(Ra,
Ra.cLd,"sendPersistentState"));Ra.eh.RCg(Object(ca.a)(Ra,Ra.Pdb,"updateClientInfo"));Ra.uh=Sa;Ra.Ll=Yb;Ra.jp=Lb;Ra.nB=Ja;Ra.Kib=xb;Ra.QBa=Object(Cb.a)(String,Z.AFrameworkApplication.Gb.Application)||"";return Ra}function A(){this.zPc=this.kp=null}function x(xa,sa,lb,Yb){var Fa=da.call(this)||this;Fa.GHd=xa;Fa.reconnectDelay=sa;Fa.reason=lb;Fa.SKd=Yb;return Fa}function t(){this.y9d=new z;this.w9d=new z}function z(){this.X_d=this.HEc=!1;this.callback=null}function r(xa,sa){this.Yqg=xa;this.HO=void 0===
sa?"":sa}function G(){this.Presence=null;this.TimeStamp=0}function w(xa){this.Wkb=null;this.Yca=0;this.GIa=!1;this.eh=xa;this.eh.BXa(Object(ca.a)(this,this.HV,"onConnectionStateChanged"))}function B(){this.mDc=this.k_d=!1;this.kDc=0;this.oEc=this.VOc=this.UOc=this.FCc=!1;this.oGc=0;this.Xce=!1;this.Wce=this.Vce=0;this.bOc=!1;this.fOc=this.eOc=this.gOc=this.cOc=0}function U(xa){this.ur=xa}function N(){}function P(){}function ia(){this.hJf=this.BEd;this.kJf=this.EEd;this.jJf=this.DEd;this.oJf=this.GEd;
this.nJf=this.FEd;this.MEd=this.NEd;this.JEd=this.KEd;this.lPa=this.HEd;this.tFb=this.IEd;this.iJf=this.CEd;this.dBb=this.ovd;this.ckc=this.qvd}function W(xa){this.V8=!1;this.KWa=0;this.JEc=!1;this.setTimeout=W.r4c;this.clearTimeout=W.e4c;this.Poi=Object(ca.a)(this,this.joi,"logRtcConnectingUsageStatement");this.Ll=xa}function R(xa,sa){this.data=xa;this.timeStamp=sa}function I(xa,sa,lb){this.x8=null;this.UKc=this.AOc=0;this.xe=sa;this.z9d=lb;this.skb=!1;this.eh=xa;this.eh.IXa(Object(ca.a)(this,this.JZi,
"receiveMessage"))}function Q(xa){this.messageId=xa;this.Rfj=(new Date).getTime();this.Gqd=new pa.a}function O(xa,sa){this.status=xa;this.I6a=sa}b.r(D);y=b(0);var ba=b(13),ca=b(80),S=b(139),Y=b(1137),na=b(101),Z=b(5);Object(y.a)(O,"UserStatusInfo",null,[]);var wa=b(77),ma=b(592),pa=b(185);Object(y.a)(Q,"MessageLatencyDetails",null,[]);I.prototype.start=function(){if(this.z9d&&!this.skb){var xa=this.xe.SQf;this.UKc=this.xe.QQf;xa<=this.UKc?(ba.ULS.sendTraceTag(570975114,500,15,"LogMetrics cannot be started because configuration values are incorrect. RtcSendTelemetryMessageIntervalInMS({0}) should be greater than RtcLogClientMessageMetricsTimeOutInMs({1})",
this.xe.SQf,this.xe.QQf),this.z9d=!1):(this.skb=!0,this.AOc=window.setInterval(Object(ca.a)(this,this.Qj,"sendMessage"),xa))}};I.prototype.Qj=function(){var xa=this;if(this.skb){var sa=ma.a.create().toString();this.x8=new Q(sa);this.eh.MDd(16,sa,!1,new S.a);window.setTimeout(function(){xa.zni(sa)},this.UKc)}};I.prototype.zni=function(xa){this.x8&&this.x8.messageId===xa&&(0<this.x8.Gqd.count?(xa=this.x8.Gqd.toArray().join(","),ba.ULS.sendTraceTag(571339719,500,15,"ClientMessageLatencies:[{0}]",xa)):
ba.ULS.sendTraceTag(562312150,500,50,"No client message latencies recorded"),this.x8=null)};I.prototype.stop=function(){this.AOc&&(window.clearInterval(this.AOc),this.skb=!1)};I.prototype.JZi=function(xa,sa){16===sa.type?this.eh.MDd(17,sa.v7,!1,new S.a):17===sa.type&&this.skb&&sa.v7&&this.PUi(sa.v7)};I.prototype.PUi=function(xa){xa&&this.x8&&xa.toString()===this.x8.messageId&&(xa=(new Date).getTime()-this.x8.Rfj,this.x8.Gqd.add(xa))};I.Qdd=function(xa,sa,lb){return I.instance||(I.Na=new I(xa,sa,lb))};
tl.Object.defineProperties(I,{instance:{configurable:!0,enumerable:!0,get:function(){return I.Na}}});I.Na=null;Object(y.a)(I,"ClientToClientMessageTelemetry",null,[]);var Ia=b(1075),Ma=b(1024);Object(y.a)(R,"PresenceData",null,[]);W.prototype.LAi=function(){var xa=this;this.V8||(this.KWa=this.setTimeout(function(){xa.V8=!1;xa.ijf()},8E3),this.V8=!0,this.JEc=!1)};W.prototype.LBi=function(){this.VL()};W.prototype.cLi=function(){this.ijf()};W.prototype.ijf=function(){this.VL();this.JEc||(this.JEc=!0,
this.Poi())};W.prototype.joi=function(){ba.ULS.sendTraceTag(4539720,500,50,"Usage statement for the Rtc_ConnectedEver KPI for [{0}]",this.Ll)};W.prototype.VL=function(){this.V8&&this.clearTimeout(this.KWa);this.KWa=0;this.V8=!1};W.r4c=function(xa,sa){return window.setTimeout(xa,sa)};W.e4c=function(xa){window.clearTimeout(xa)};Object(y.a)(W,"ConnectedUsageKpiLogger",null,[179]);ia.prototype.BEd=function(){};ia.prototype.EEd=function(){};ia.prototype.DEd=function(){};ia.prototype.GEd=function(){};ia.prototype.FEd=
function(){};ia.prototype.KEd=function(){};ia.prototype.IEd=function(){};ia.prototype.HEd=function(){};ia.prototype.NEd=function(){};ia.prototype.CEd=function(){};ia.prototype.ovd=function(){};ia.prototype.qvd=function(){};Object(y.a)(ia,"NoopRealtimeChannelMetrics",null,[170,83]);P.lMb="presenceUpdated";P.updateNotification="updateNotification";P.mDf="persistentStateCleared";P.updatePersistentState="persistentStateUpdated";Object(y.a)(P,"RtcClientMethodNames",null,[]);N.W0h="realtimeChannelHub";
N.lMb="UpdatePresence";N.fda="SendUpdateNotification";N.Jbd="GetCompletePersistentStateWithMetadata";N.updatePersistentState="UpdatePersistentState";N.Pdb="UpdateClientInfo";Object(y.a)(N,"RtcHubMethodNames",null,[]);U.prototype.o1i=function(xa){this.ur.on(P.lMb,xa)};U.prototype.P1i=function(xa){this.ur.on(P.updateNotification,xa)};U.prototype.m1i=function(xa){this.ur.on(P.updatePersistentState,xa)};U.prototype.l1i=function(xa){this.ur.on(P.mDf,xa)};U.prototype.vHj=function(xa){this.ur.off(P.lMb,
xa)};U.prototype.DHj=function(xa){this.ur.off(P.updateNotification,xa)};U.prototype.uHj=function(xa){this.ur.off(P.updatePersistentState,xa)};U.prototype.tHj=function(xa){this.ur.off(P.mDf,xa)};U.prototype.lMb=function(xa){return this.ur.invoke(N.lMb,xa)};U.prototype.Pdb=function(xa){return this.ur.invoke(N.Pdb,xa)};U.prototype.fda=function(xa,sa){return this.ur.invoke(N.fda,xa,sa)};U.prototype.Jbd=function(xa){return this.ur.invoke(N.Jbd,xa)};U.prototype.updatePersistentState=function(xa,sa){return this.ur.invoke(N.updatePersistentState,
xa,sa)};Object(y.a)(U,"RealtimeChannelProxy",null,[176,177,178]);B.createInstance=function(xa){var sa=b(934).RealtimeChannel;return xa?Object.assign(new B,{k_d:xa.ra("AwayStatusManagerIsEnabled"),mDc:xa.ra("AwayStatusOneMinuteTimeoutIsEnabled"),kDc:xa.zd("AwayCoauthorThresholdMs",9E5),FCc:xa.ra("RtcAllowCrossDomainAccessEnabled"),UOc:xa.ra("ShouldLogOnContentNotification"),VOc:xa.ra("ShouldLogOnHostSubscriptionNotification"),oEc:xa.ra("RtcClientMetricsEnabled"),oGc:xa.zd("RtcFindSessionRequestTimeoutInMS",
6E4),Xce:xa.ra("RtcJsClientFrequentlyLogsMetrics"),Vce:xa.zd("RtcJsClientFrequentMetricsLatencyThresholdInMS",1E3),Wce:xa.zd("RtcJsClientFrequentMetricsLogIntervalInMS",3E5),bOc:xa.ra("RtcClientMessageTelemetryEnabled"),cOc:xa.zd("RtcClientMessageTelemetrySampleSize",5),gOc:xa.zd("RtcSendTelemetryMessageIntervalInMS",3E5),eOc:xa.zd("RtcLogClientMessageMetricsTimeOutInMs",2E4),fOc:xa.zd("RtcMaxPayloadSizeInCharactersOverride",sa.Dtd)}):Object.assign(new B,{k_d:!1,mDc:!1,kDc:9E5,FCc:!1,UOc:!1,VOc:!0,
oEc:!1,oGc:9E4,bOc:!1,cOc:5,gOc:3E5,eOc:2E4,fOc:sa.Dtd})};tl.Object.defineProperties(B.prototype,{VIg:{configurable:!0,enumerable:!0,get:function(){return this.mDc}},UIg:{configurable:!0,enumerable:!0,get:function(){return this.kDc}},rEg:{configurable:!0,enumerable:!0,get:function(){return this.FCc}},tpj:{configurable:!0,enumerable:!0,get:function(){return this.UOc}},upj:{configurable:!0,enumerable:!0,get:function(){return this.VOc}},qUg:{configurable:!0,enumerable:!0,get:function(){return this.oEc}},
a8b:{configurable:!0,enumerable:!0,get:function(){return this.oGc}},rtcJsClientFrequentlyLogsMetrics:{configurable:!0,enumerable:!0,get:function(){return this.Xce}},PQf:{configurable:!0,enumerable:!0,get:function(){return this.Vce}},pbj:{configurable:!0,enumerable:!0,get:function(){return this.Wce}},rtcClientMessageTelemetryEnabled:{configurable:!0,enumerable:!0,get:function(){return this.bOc}},kbj:{configurable:!0,enumerable:!0,get:function(){return this.cOc}},SQf:{configurable:!0,enumerable:!0,
get:function(){return this.gOc}},QQf:{configurable:!0,enumerable:!0,get:function(){return this.eOc}},RQf:{configurable:!0,enumerable:!0,get:function(){return this.fOc}}});Object(y.a)(B,"RealtimeChannelSettings",null,[175]);var ob=b(1232),Cb=b(84),Xa=b(342);w.prototype.HV=function(xa,sa){this.Yca=sa.newState};w.prototype.ULi=function(){ba.ULS.sendTraceTag(18637070,500,15,"Too many undelivered messages. Restarting RTC connection.");this.eh.hpc()};w.prototype.z3h=function(xa){this.Wkb.init(xa)};Object(y.a)(w,
"ARtcMessageHandler",null,[]);var Sb=b(93);Object(y.a)(G,"PresenceDataEntryForClients",null,[]);var Tb=b(110);r.prototype.send=function(){return this.Yqg()};tl.Object.defineProperties(r.prototype,{messageId:{configurable:!0,enumerable:!0,get:function(){return this.HO}}});Object(y.a)(r,"MessageHandler",null,[197]);z.prototype.cN=function(xa){this.callback=xa;this.I6f()};z.prototype.rlf=function(xa){this.HEc||(this.HEc=!0,this.oig=xa,this.I6f())};z.prototype.I6f=function(){this.HEc&&this.callback&&
!this.X_d&&(this.X_d=!0,this.callback(this.oig))};Object(y.a)(z,"CompletionTask",null,[]);t.prototype.Tlc=function(xa){this.y9d.cN(xa)};t.prototype.Slc=function(xa){this.w9d.cN(xa)};t.prototype.zAb=function(xa){this.y9d.rlf(xa)};t.prototype.jxa=function(xa){this.w9d.rlf(xa)};t.prototype.wtd=function(){this.zAb(2);this.jxa(2)};Object(y.a)(t,"MessageStatus",null,[196]);var da=Sys.EventArgs;vm(x,da);Object(y.a)(x,"RefreshConnectionReconnectArgs",Sys.EventArgs,[]);var ya=b(1138);A.prototype.start=function(){this.kp=
new Date};A.prototype.stop=function(){this.zPc=new Date};tl.Object.defineProperties(A.prototype,{Ac:{configurable:!0,enumerable:!0,get:function(){return this.kp?this.zPc?this.zPc.getTime()-this.kp.getTime():(new Date).getTime()-this.kp.getTime():0}}});Object(y.a)(A,"SimpleStopwatch",null,[]);var hb=b(1139),Gb;(function(xa){xa[xa.contentUpdate=0]="contentUpdate";xa[xa.editorsTableUpdate=1]="editorsTableUpdate";xa[xa.fileNameUpdate=2]="fileNameUpdate";xa[xa.wetContentUpdate=3]="wetContentUpdate";xa[xa.persistedContentUpdate=
4]="persistedContentUpdate";xa[xa.clientRtcReconnectRequest=5]="clientRtcReconnectRequest";xa[xa.replicationTelemetry=6]="replicationTelemetry";xa[xa.lockUpdate=7]="lockUpdate";xa[xa.collabServiceContentUpdate=8]="collabServiceContentUpdate";xa[xa.trackChangeSettingUpdate=9]="trackChangeSettingUpdate";xa[xa.saveTargetUpdate=10]="saveTargetUpdate";xa[xa.uploadToOcsUpdate=11]="uploadToOcsUpdate";xa[xa.labelUpdate=12]="labelUpdate";xa[xa.hostNotificationSubscriptionStatus=13]="hostNotificationSubscriptionStatus";
xa[xa.subscribeOrExtend=14]="subscribeOrExtend";xa[xa.elapsedBootTelemetry=15]="elapsedBootTelemetry";xa[xa.clientToClientTelemetryMessage=16]="clientToClientTelemetryMessage";xa[xa.clientToClientResponseMessage=17]="clientToClientResponseMessage";xa[xa.verifyNotificationPipeline=18]="verifyNotificationPipeline";xa[xa.hostNotificationHeartbeat=19]="hostNotificationHeartbeat";xa[xa.secondaryMetadataUpdate=20]="secondaryMetadataUpdate";xa[xa.last=21]="last"})(Gb||(Gb={}));Object(y.b)("UpdateNotificationType",
Gb);vm(m,w);m.prototype.RIi=function(xa,sa){this.ur=this.Gpg(sa.hubConnection);this.Wkb.reset();this.ur.o1i(Object(ca.a)(this,this.xla,"onPresenceUpdated"));this.ur.m1i(Object(ca.a)(this,this.jmc,"onPersistentStateUpdated"));this.ur.l1i(Object(ca.a)(this,this.Ryd,"onPersistentStateCleared"));this.ur.P1i(Object(ca.a)(this,this.Wba,"onUpdateNotificationReceived"))};m.prototype.HV=function(xa,sa){this.Yca=sa.newState;2===sa.newState&&this.Efj()};m.prototype.Efj=function(){for(var xa=yl(this.HMc),sa=
xa.next();!sa.done;sa=xa.next())sa=sa.value,this.fda(null,new ya.a(sa.key,sa.value,!1,new S.a));this.HMc=new Xa.a};m.prototype.OIi=function(xa,sa){sa.AZc();for(xa=0;3>xa;++xa)this.ofj(xa,sa)};m.prototype.ofj=function(xa,sa){var lb=this;try{this.ur.Jbd(xa).done(function(Yb){sa.seb(sa.u0c,"GetCompletePresenceSuccess")&&(sa.OXg.cLi(),ba.ULS.sendTraceTag(3249540,500,50,"Successfully retrieved complete session state for [{0}]",lb.Ll),lb.eh.wXi(),lb.gIi(xa,Yb),lb.eh.ZWi(Yb),sa.BOe.wb(xa)&&lb.eh.KHf(xa,
sa.BOe.na(xa),new S.a))}).fail(function(Yb){var Fa=b(840).RtcUtils;sa.seb(sa.u0c,"GetCompletePresenceFail")&&(ba.ULS.sendTraceTag(3249541,500,15,"Failed to retrieve complete session state : {0} for [{1}]",Fa.Exa(Yb),lb.Ll),lb.eh.hpc())}).always(function(){sa.stopwatch&&sa.stopwatch.stop()})}catch(Yb){ba.ULS.sendTraceTag(595132428,500,10,"Exception thrown while calling hub method GetCompletePersistentStateWithMetadata. Promise not even created. Current event token: {0}, Exception message: {1}",sa.u0c,
Yb.message)}};m.prototype.cLd=function(xa,sa){var lb=this,Yb=b(840).RtcUtils;xa=sa.presence;var Fa=sa.Fda;this.nB.yx(1,0);try{var Sa=Yb.bZc(xa,this.Kib)}catch(Lb){this.nB.yx(1,3);ba.ULS.sendTraceTag(574407636,500,10,"Exception thrown while trying to serialize presence. Exception message: {0}",Lb.message);Fa.setException(Lb);return}Yb=new na.a;Yb.ia(this._clientId,Object.assign(new G,{Presence:xa,TimeStamp:(new Date).getTime()}));this.eh.SHf(sa.type,Yb);if(2!==this.Yca)this.jp.lPa(),this.nB.yx(1,2),
Fa.setResult(null);else{var Ra=this.HO.toString();++this.HO;xa=new r(function(){return lb.Gfj(sa.type,Sa,Ra)},Ra);xa=this.k5f(0,sa.type).add(xa);xa.Tlc(function(Lb){2===Lb&&lb.nB.yx(1,6);Fa.setResult(null)});xa.Slc(function(){})}};m.prototype.Gfj=function(xa,sa,lb){var Yb=this,Fa=null,Sa=new A,Ra=new t;ba.ULS.sendTraceTag(3249501,500,50,"Sending presence update for [{0}]",this.Ll);if(2!==this.Yca)return this.jp.lPa(),this.nB.yx(1,2),ba.ULS.sendTraceTag(7934171,500,15,"Connection is lost - unable to send the message for [{0}]",
this.Ll),Ra.wtd(),Ra;this.uh&&20>this.u$d&&(Fa=this.uh.Fc("WebServiceCall","Send Presence Message"),this.u$d++);Sa.start();Ra.zAb(1);try{this.ur.updatePersistentState(xa,sa).done(function(){Yb.jp.JEd();Yb.nB.yx(1,1);ba.ULS.sendTraceTag(3249502,500,50,"Successfully delivered presence update message [{0}] for [{1}]",lb,Yb.Ll);Ra.jxa(1);Sa&&(Sa.stop(),Sa.Ac>Yb.xe.PQf?Yb.nB.yx(1,4):Yb.nB.yx(1,5))}).fail(function(Lb){var Ja=b(840).RtcUtils;Yb.GIa||(Yb.jp.lPa(),Yb.nB.yx(1,3),ba.ULS.sendTraceTag(3249503,
500,15,"Server failed to process the presence update message [{0}]: [{1}] for [{2}]",lb,Ja.Exa(Lb),Yb.Ll));Ra.jxa(2)}).always(function(){Fa&&Fa.stop()})}catch(Lb){ba.ULS.sendTraceTag(593072906,500,15,"Exception when invoking hub method UpdatePersistentState, error: {1}",Lb.message),this.nB.yx(1,3),Ra.jxa(2)}return Ra};m.prototype.Pdb=function(xa,sa){var lb=this;xa=b(840).RtcUtils;var Yb=sa.pUg,Fa=sa.Fda;try{var Sa=xa.bZc(Yb,this.Kib)}catch(Ra){ba.ULS.sendTraceTag(544318999,500,10,"Exception thrown while trying to serialize clientInfo. Exception message: {0}",
Ra.message);Fa.setException(Ra);return}try{this.ur.Pdb(Sa).done(function(){ba.ULS.sendTraceTag(544319E3,500,50,"Successfully delivered clientInfo.")}).fail(function(Ra){var Lb=b(840).RtcUtils;lb.GIa||ba.ULS.sendTraceTag(544319001,500,15,"Server failed to process udpate clientInfo: {0}.",Lb.Exa(Ra));Fa.setResult(null)})}catch(Ra){ba.ULS.sendTraceTag(544319002,500,15,"Exception when invoking hub method UpdateClientInfo: error: {0}",Ra.message),Fa.setResult(null)}};m.prototype.fda=function(xa,sa){var lb=
this;xa=b(840).RtcUtils;var Yb=sa.type,Fa=sa.v7,Sa=sa.L9g,Ra=sa.Fda;this.nB.yx(0,0);try{var Lb=xa.bZc(Fa,this.Kib)}catch(xb){this.nB.yx(0,3);ba.ULS.sendTraceTag(574407637,500,10,"Exception thrown while trying to serialize updateHint. Exception message: {0}",xb.message);Ra.setException(xb);return}if(2!==this.Yca)Sa?this.HMc.ia(Yb,Fa):(this.jp.lPa(),this.nB.yx(0,2)),Ra.setResult(null);else{var Ja=this.HO.toString();++this.HO;sa=new r(function(){return lb.$fj(Yb,Lb,Ja)},Ja);sa=this.k5f(1,Yb).add(sa);
sa.Tlc(function(xb){2===xb&&lb.nB.yx(0,6);Ra.setResult(null)});sa.Slc(function(){})}};m.prototype.$fj=function(xa,sa,lb){var Yb=this,Fa=null,Sa=new A,Ra=new t;ba.ULS.sendTraceTag(3249505,500,50,"Sending update notification for [{0}]",this.Ll);if(2!==this.Yca)return this.jp.lPa(),this.nB.yx(0,2),ba.ULS.sendTraceTag(7934172,500,15,"Connection is lost - unable to send the message for [{0}]",this.Ll),Ra.wtd(),Ra;this.uh&&3===xa&&20>this.v$d&&(Fa=this.uh.Fc("WebServiceCall","Send WetContent Update"),this.v$d++);
Sa.start();Ra.zAb(1);this.ur.fda(xa,sa).done(function(){Yb.jp.JEd();Yb.nB.yx(0,1);ba.ULS.sendTraceTag(3249506,500,50,"Successfully delivered update notification message [{0}] for [{1}]",lb,Yb.Ll);Ra.jxa(1);Sa&&(Sa.stop(),Sa.Ac>Yb.xe.PQf?Yb.nB.yx(0,4):Yb.nB.yx(0,5))}).fail(function(Lb){var Ja=b(840).RtcUtils;Yb.GIa||(Yb.jp.lPa(),Yb.nB.yx(0,3),ba.ULS.sendTraceTag(3249507,500,15,"Server failed to process the update notification message [{0}] : [{1}] for [{2}]",lb,Ja.Exa(Lb),Yb.Ll));Ra.jxa(2)}).always(function(){Fa&&
Fa.stop()});return Ra};m.prototype.Xs=function(){this.ur.vHj(Object(ca.a)(this,this.xla,"onPresenceUpdated"));this.ur.uHj(Object(ca.a)(this,this.jmc,"onPersistentStateUpdated"));this.ur.tHj(Object(ca.a)(this,this.Ryd,"onPersistentStateCleared"));this.ur.DHj(Object(ca.a)(this,this.Wba,"onUpdateNotificationReceived"))};m.prototype.RFi=function(xa,sa){this.xla(sa.iO,sa.i3)};m.prototype.xla=function(xa){this.jp.tFb();this.jmc(0,xa)};m.prototype.QFi=function(xa,sa){this.jmc(sa.type,sa.iO)};m.prototype.gIi=
function(xa,sa){var lb={},Yb;for(Yb in sa)lb[Yb]=sa[Yb].Presence;this.ixf(xa,lb,sa)};m.prototype.jmc=function(xa,sa){this.jp.tFb();this.ixf(xa,sa)};m.prototype.ixf=function(xa,sa,lb){lb=void 0===lb?null:lb;var Yb=b(840).RtcUtils;if(ba.ULS.oda(500,100))for(var Fa in sa);delete sa[this._clientId];if(!Tb.a.isEmpty(sa)){for(var Sa in sa)Fa=Sa,sa[Fa]=Yb.deserialize(sa[Sa],"Presence",Fa,!1,this.Kib);Yb=new na.a;Sa=(new Date).getTime();for(var Ra in sa){Fa=sa[Ra];var Lb=Ra;if(lb){var Ja=lb[Lb];Ja.Presence=
Fa}else Ja=Object.assign(new G,{Presence:Fa,TimeStamp:Sa});Yb.ia(Lb,Ja)}this.eh.SHf(xa,Yb);switch(xa){case 0:this.Q8d||(ba.ULS.sendTraceTag(4539734,500,50,"Raising first presence update notification for [{0}]",this.Ll),this.Q8d=!0,Z.AFrameworkApplication.Zf&&Z.AFrameworkApplication.Zf.Iqi());this.eh.CHf(sa,[]);break;default:this.eh.qXi(xa,sa)}}};m.prototype.PFi=function(xa,sa){this.Ryd(sa.XZc)};m.prototype.Ryd=function(xa){this.jp.tFb();if(ba.ULS.oda(500,100))for(var sa=0;sa<xa.length;++sa);xa.length&&
(this.eh.KXi(xa),this.eh.pXi(xa),this.eh.CHf({},xa))};m.prototype.SFi=function(xa,sa){this.Wba(sa.type,sa.v7)};m.prototype.Wba=function(xa,sa){sa=void 0===sa?null:sa;this.xe.tpj&&!xa&&ba.ULS.sendTraceTag(40128990,500,50,"Received ContentUpdate notification from the server");if(!xa&&"Word"===this.QBa){var lb=new Map;lb.set("AreaName","RealTimeCoauth");lb.set("FeatureName","RtcNotification");Sb.Health.instance.recordKpiUsage("ContentUpdateNotificationReceived",0,"wordcollabrel",lb)}this.xe.upj&&13===
xa&&ba.ULS.sendTraceTag(575221780,500,50,String.format("Received HostSubscription notification from the server : {0}",sa||"<none>"));this.jp.tFb();5===xa?(sa=(xa=this.BPi(sa))?String.format("Received client reconnection request from the server. Reason: {0}, Backoff time: {1} ",xa.reason,xa.reconnectDelay):"Received client reconnection request from the server without params.",ba.ULS.sendTraceTag(18637071,500,50,sa),this.eh.hpc(xa)):(sa=b(840).RtcUtils.deserialize(sa,String.format("UpdateNotification-{0}",
Gb[xa]),null,!1,this.Kib),this.eh.JXi(xa,sa))};m.prototype.BPi=function(xa){try{if(!xa||""===xa)return null;var sa=JSON.parse(xa);return new x(sa[hb.a.AJd],sa[hb.a.jbj],sa[hb.a.lbj],sa[hb.a.SKd])}catch(lb){return ba.ULS.sendTraceTag(593844380,500,15,"Error when parsing reconnect hint: {0}",lb.message),null}};m.prototype.k5f=function(xa,sa){return this.Wkb.$Sh(this.aTh(xa,sa))};m.prototype.aTh=function(xa,sa){return xa+","+sa};Object(y.a)(m,"RtcMessageHandler",w,[]);var Qb=b(94);v.prototype.LEd=function(){0<
this.yEa&&0<this.Mgb&&ba.ULS.sendTraceTag(36545635,500,50,"Throttler [{0}] dropped [{1}] messages out of [{2}]",this.l5f,this.Mgb,this.yEa);0<this.yEa&&0<this.Vkb&&ba.ULS.sendTraceTag(36545634,500,50,"Throttler [{0}] throttled [{1}] messages out of [{2}]",this.l5f,this.Vkb,this.yEa)};v.prototype.Cuc=function(xa,sa){this.Vkb++;this.$ob(!0);this.cJc=!0;this.BVb=xa;this.JWa=sa};v.prototype.$ob=function(xa){this.cJc=!1;this.JWa&&xa&&(this.Mgb++,this.JWa.wtd());this.JWa=this.BVb=null};v.r4c=function(xa,
sa){return window.setTimeout(xa,sa)};tl.Object.defineProperties(v.prototype,{s5a:{configurable:!0,enumerable:!0,get:function(){return this.cJc}}});Object(y.a)(v,"ThrottlerBase",null,[]);vm(u,v);u.prototype.add=function(xa){this.qVa||this.init(u.YDe,u.SDe);this.yEa++;var sa=new t;this.s5a?this.Cuc(xa,sa):this.RSb<this.q7a?this.UHb(xa,sa):(this.Cuc(xa,sa),this.pVa=!1);return sa};u.prototype.UHb=function(xa,sa){var lb=this;xa=this.Jde(xa);var Yb=this.setTimeout(Object(ca.a)(this,this.bHi,"onMessageWaitTimeExpired"),
this.CAa);++this.RSb;Array.add(this.EVb,Yb);var Fa=this.yPb;xa.Tlc(function(Sa){sa.zAb(Sa)});xa.Slc(function(Sa){lb.yPb===Fa&&(lb.aHi(Fa,Yb),sa.jxa(Sa))})};u.prototype.aHi=function(xa,sa){this.yPb===xa&&(--this.RSb,this.clearTimeout(sa),Array.remove(this.EVb,sa),this.s5a&&this.Pfj())};u.prototype.Pfj=function(){this.s5a&&!this.pVa&&(this.gQc=this.setTimeout(Object(ca.a)(this,this.Qfj,"sendThrottledMessageFromTimer"),0),this.pVa=!0)};u.prototype.Qfj=function(){this.pVa=!1;if(this.s5a){var xa=this.BVb,
sa=this.JWa;this.$ob(!1);this.UHb(xa,sa)}};u.prototype.bHi=function(){++this.KPb;this.KPb>Math.floor(this.q7a/2)&&(this.KPb=-1E9,this.Ya.raiseEvent("TMUDM"))};u.prototype.YXb=function(xa){this.Ya.addHandler("TMUDM",xa)};u.prototype.reset=function(){this.yEa=this.Vkb=this.Mgb=this.KPb=0;++this.yPb;for(var xa=yl(this.EVb),sa=xa.next();!sa.done;sa=xa.next())this.clearTimeout(sa.value);this.RSb=0;this.EVb=[];this.$ob(!0);this.pVa&&(this.clearTimeout(this.gQc),this.gQc=0,this.pVa=!1)};u.prototype.init=
function(xa,sa){this.qVa||(this.CAa=xa,this.q7a=sa,this.qVa=!0)};u.createInstance=function(xa,sa){return new u(xa,void 0===sa?"":sa)};u.e4c=function(xa){window.clearTimeout(xa)};u.YDe=15E3;u.SDe=5;Object(y.a)(u,"MaxOutstandingThrottler",v,[199,195]);vm(f,v);f.prototype.init=function(xa){this.qVa||(this.u7a=xa,this.qVa=!0)};f.prototype.add=function(xa){this.qVa||this.init(f.IDe);this.yEa++;var sa=this.currentTime(),lb=new t;this.oib>sa&&(this.oib=sa);this.s5a?(this.$ob(!0),this.Cuc(xa,lb)):this.oib+
this.u7a<=sa?this.UHb(xa,lb):(this.Cuc(xa,lb),this.setTimeout(Object(ca.a)(this,this.Ofj,"sendThrottledMessage"),this.oib+this.u7a-sa));return lb};f.prototype.Ofj=function(){if(this.s5a){var xa=this.BVb,sa=this.JWa;this.$ob(!1);this.UHb(xa,sa)}};f.prototype.UHb=function(xa,sa){this.oib=this.currentTime();xa=this.Jde(xa);xa.Tlc(function(lb){sa.zAb(lb)});xa.Slc(function(lb){sa.jxa(lb)})};f.createInstance=function(xa,sa){return new f(xa,void 0===sa?"":sa)};f.IDe=200;Object(y.a)(f,"MaxRateThrottler",
v,[194,195]);l.prototype.pBe=function(xa,sa){return u.createInstance(xa,void 0===sa?"":sa)};l.prototype.S2g=function(xa,sa){return f.createInstance(xa,void 0===sa?"":sa)};Object(y.a)(l,"ThrottlerFactory",null,[173]);var Fb=b(1140);n.prototype.init=function(xa){this.Hw||(this.xe=xa,this.UUa.init(this.xe.CAa,this.xe.wVh),this.Hw=!0)};n.prototype.$Sh=function(xa){var sa=this;this.Hw||this.init(new Fb.a(f.IDe,u.YDe,u.SDe,n.Ari));if(!function(){var Sa=sa.hLc.Ec(xa);Fa=Sa.value;return Sa}().returnValue){if(!function(){var Sa=
sa.gLc.Ec(xa);Yb=Sa.value;return Sa}().returnValue){var lb="MaxOutstandingThrottler-"+xa;var Yb=this.hQc.pBe(Object(ca.a)(this.UUa,this.UUa.add,"add"),lb);Yb.init(this.xe.CAa,this.xe.zri);Yb.YXb(function(){sa.Ya.raiseEvent("TMUDM")});this.gLc.add(xa,Yb)}lb="MaxRateThrottler-"+xa;var Fa=this.hQc.S2g(Object(ca.a)(Yb,Yb.add,"add"),lb);Fa.init(this.xe.Dsi);this.hLc.add(xa,Fa)}return Fa};n.prototype.reset=function(){for(var xa=yl(this.hLc),sa=xa.next();!sa.done;sa=xa.next())sa.value.value.LEd();xa=yl(this.gLc);
for(sa=xa.next();!sa.done;sa=xa.next())sa=sa.value,sa.value.LEd(),sa.value.reset();this.UUa.LEd();this.UUa.reset()};n.prototype.YXb=function(xa){this.Ya.addHandler("TMUDM",xa)};n.Ari=1E3;Object(y.a)(n,"ThrottlerManager",null,[172]);var ta;(function(xa){xa[xa.unspecified=0]="unspecified";xa[xa.word=1]="word";xa[xa.excel=2]="excel";xa[xa.powerPoint=3]="powerPoint";xa[xa.test=4]="test";xa[xa.wacFrontEnd=5]="wacFrontEnd";xa[xa.oneNote=6]="oneNote";xa[xa.visio=7]="visio";xa[xa.officeMobile=8]="officeMobile";
xa[xa.cosmosDBChangefeed=9]="cosmosDBChangefeed";xa[xa.last=10]="last"})(ta||(ta={}));Object(y.b)("RtcClientAppName",ta);b.d(D,"RealtimeChannel",function(){return a});a.prototype.init=function(){var xa=this;this.eh.bCg(Object(ca.a)(this,this.N4b,"disconnectAndCreateNewConnection"));this.eh.TCg(Object(ca.a)(this,this.hMi,"onUpdatePersistentStateRequestReceivedInternal"));this.eh.SCg(Object(ca.a)(this,this.gMi,"onUpdatePersistentStateClearedRequestReceived"));this.Og.wSc(this.jp);Z.AFrameworkApplication.CKb(function(){xa.jp.MEd();
Ia.a.instance&&Ia.a.instance.Zrd()});this.xBe();this.Mah();this.eh.vCg(Object(ca.a)(this,this.MIj,"updateConnectionQueryString"))};a.prototype.Mah=function(){try{var xa=$.signalR;if(!xa)throw Error.invalidOperation("Failed to retrieve Signalr object");var sa=xa.version;if(!sa)throw Error.invalidOperation("Signalr object is missing version information");if("2.1.1"===sa){var lb=xa.transports;if(!lb)throw Error.invalidOperation("Failed to retrieve transports object");var Yb=lb.longPolling;if(!Yb)throw Error.invalidOperation("Failed to retrieve longPolling object");
if(!Yb.supportsKeepAlive)throw Error.invalidOperation("LongPolling object does not have a field called supportsKeepAlive");Yb.supportsKeepAlive=this.p5g()}}catch(Fa){ba.ULS.sendTraceTag(6432339,500,15,"Failed to disable longPolling KeepAlives: {0}",Fa.message)}};a.prototype.p5g=function(){return function(){return!1}};a.prototype.xBe=function(){var xa=this,sa=++this.ggb;this.$Jc=(new Date(0)).getTime();this.zO=this.rig();this.eh.uXi(this.zO);this.zO.stateChanged(function(lb){xa.NAi(lb,sa)});this.zO.connectionSlow(Object(ca.a)(this,
this.RKi,"onSlowConnection"));this.zO.error(Object(ca.a)(this,this.IKi,"onSignalRError"));this.zO.log=Object(ca.a)(this,this.JKi,"onSignalRLog")};a.prototype.seb=function(xa,sa){return xa!==this.ggb?(ba.ULS.sendTraceTag(4309017,500,50,"ConnectionToken verification failed for {0}",sa),!1):!0};a.prototype.connect=function(){2!==this.jL&&1!==this.jL&&(ba.ULS.sendTraceTag(4539721,500,50,"Starting a new RTC connection for client [{0}]",this.Ll),this.IEc.LAi(),Ma.a.instance.ixj(),this.HV(1,this.jL),this.K1f())};
a.prototype.K1f=function(){var xa=this.ggb;this.yPc=!1;this.jp.hJf();this.Doa.zQh(Object(ca.a)(this,this.JXg,"connectSignalrConnection"),Object(ca.a)(this,this.Dtf,"onFailureToConnect"),Object(ca.a)(this.qza,this.qza.z3h,"initThrottlerManager"),Object(ca.a)(this,this.seb,"verifyConnectionToken"),xa)};a.prototype.Dtf=function(xa){xa=void 0===xa?null:xa;this.jp.jJf();var sa=null;!xa||"documentsessiondeleted"!==(sa=xa.toLowerCase())&&"documentsessionexpired"!==sa?this.N4b():(ba.ULS.sendTraceTag(41788292,
500,15,"In RealtimeChannel method OnFailureToConnect: Disconnect was called for [{0}], due to non-retriable RtcErrorCode:{1}",this.Ll,xa),this.disconnect())};a.prototype.N4b=function(xa,sa){sa=void 0===sa?null:sa;ba.ULS.sendTraceTag(4309018,500,50,"Disconnecting the connection [{0}]",this.W7);xa=(xa=2===this.jL||1===this.jL)&&!this.qza.GIa;var lb=!0,Yb=0;sa&&Object.getType(sa)!==Object.getType(Sys.EventArgs.Empty)&&sa.GHd&&""!==sa.GHd&&(xa=!0,this.Doa.Ykj(sa.GHd),lb=sa.SKd,Yb=sa.reconnectDelay);xa&&
this.HV(1,this.jL);++this.ggb;this.qza.Xs();this.hyj(lb);this.Doa.Lbh();this.xBe();xa&&window.setTimeout(Object(ca.a)(this,this.K1f,"startConnecting"),Math.min(Yb,3E4))};a.prototype.MIj=function(){var xa=this.Doa.yWe();var sa=xa.correlationId;this.zO.qs=xa.returnValue;ba.ULS.sendTraceTag(40768457,500,50,"Connection parameters refresh finished for client [{0}], CorrelationId:{1}",this.Ll,sa)};a.prototype.JXg=function(xa){var sa=this;this.$Jc=(new Date).getTime();var lb=null;this.zO.qs=function(){var Fa=
sa.Doa.yWe();lb=Fa.correlationId;return Fa}().returnValue;this.xe.rEg&&(this.zO.url=xa,Ia.a.instance&&(Ia.a.instance.Pye=wa.a.oM(xa)));var Yb=null;this.uh&&(Yb=this.uh.Fc("WebServiceCall","ConnectToServer"));ba.ULS.sendTraceTag(3290048,500,50,"Connecting to server for client [{0}]",this.Ll);xa={};this.KVb&&(xa.transport=1===this.KVb.length?this.KVb[0]:this.KVb);xa.pingInterval=null;Ma.a.instance.sFb(1,0);xa.waitForPageLoad=!1;this.zO.start(xa,null).done(function(Fa){sa.jp.kJf();Ma.a.instance.sFb(1,
1,!0);ba.ULS.sendTraceTag(3457857,500,50,"Successfully connected to server using connection [{0}], CorrelationId:{1}",Fa.id,lb)}).fail(function(Fa){var Sa=b(840).RtcUtils;ba.ULS.sendTraceTag(3457858,500,15,"Failed to connect to server : connection string: {0}, CorrelationId:{1}, callback parameter:{2} for [{3}]",sa.Doa.SB,lb,Sa.Exa(Fa),sa.Ll);sa.Dtf();sa.jp.iJf(Fa);Ma.a.instance.sFb(1,1,!1);Sa={};sa.eh.HHf(0,(Sa.CorrelationId=lb,Sa.ErrorDetails=Fa,Sa.ConnectionState=Y.a[sa.jL],Sa))}).always(function(){Yb&&
Yb.stop();Ia.a.instance&&(Ia.a.instance.YFc=!1)})};a.prototype.disconnect=function(){this.jL?(this.jp.nJf(),Ia.a.instance&&(Ia.a.instance.YFc=!0),ba.ULS.sendTraceTag(36545633,500,50,"Starting explicit disconnect for [{0}]",this.Ll),this.qza.GIa=!0,this.IEc.LBi(),this.HV(0,this.jL),this.N4b(),this.qza.GIa=!1):ba.ULS.sendTraceTag(36545632,500,50,"Disconnect for [{0}] was called but the channel is already Disconnected",this.Ll)};a.prototype.hyj=function(xa){function sa(){if(lb.yPc)ba.ULS.sendTraceTag(591692192,
500,15,"Stop connection was called twice, possibly on the same connection.");else try{lb.yPc=!0,Fa.stop(!0,xa)}catch(Ra){ba.ULS.sendTraceTag(591692191,500,15,"Stopping connection failed: {0}",Ra.message)}}var lb=this,Yb=this.tPg(),Fa=this.zO,Sa=this.W7;0<Yb?(ba.ULS.sendTraceTag(4309020,500,50,"Waiting to stop connection [{0}]: [{1}] ms.",Sa,Yb),window.setTimeout(sa,Yb)):(ba.ULS.sendTraceTag(36804372,500,50,"Stopping connection [{0}].",Sa),sa())};a.prototype.tPg=function(){var xa=0;this.zO.state||
(xa=this.$Jc+a.OOj-(new Date).getTime(),0>xa&&(xa=0));return xa};a.prototype.BXa=function(xa){this.eh.BXa(xa)};a.prototype.yqc=function(xa){this.eh.yqc(xa)};a.prototype.LTf=function(xa){this.cLd(0,xa)};a.prototype.cLd=function(xa,sa){var lb=new S.a;this.eh.KHf(xa,sa,lb);return lb.task};a.prototype.fFa=function(xa){this.eh.fFa(xa)};a.prototype.dza=function(xa){this.eh.dza(xa)};a.prototype.Uub=function(xa){return this.aUh(xa)};a.prototype.ebd=function(){return this.FCh()};a.prototype.FCh=function(){for(var xa=
{},sa=yl(this.aG),lb=sa.next();!lb.done;lb=sa.next())lb=lb.value,lb.value.wb(0)&&(xa[lb.key]=lb.value.na(0).data);return xa};a.prototype.aUh=function(xa){return this.aG.wb(xa)&&this.aG.na(xa).wb(0)?this.aG.na(xa).na(0).data:null};a.prototype.hMi=function(xa,sa){xa=yl(sa.$Lj);for(var lb=xa.next();!lb.done;lb=xa.next()){lb=lb.value;this.aG.wb(lb.key)||this.aG.ia(lb.key,new Xa.a);var Yb=lb.value;this.aG.na(lb.key).ia(sa.type,new R(Yb.Presence,new Date(Yb.TimeStamp)));lb.key!==this._clientId||sa.type||
this.eh.iXi(Yb.Presence)}};a.prototype.gMi=function(xa,sa){xa=yl(sa.XZc);for(sa=xa.next();!sa.done;sa=xa.next())this.aG.remove(sa.value)};a.prototype.ECh=function(){var xa=new Xa.a;if(!this.aG.wb(this._clientId))return xa;for(var sa=yl(this.aG.na(this._clientId)),lb=sa.next();!lb.done;lb=sa.next())lb=lb.value,xa.ia(lb.key,lb.value.data);return xa};a.prototype.fda=function(xa,sa,lb){sa=void 0===sa?null:sa;lb=void 0===lb?!1:lb;var Yb=new S.a;this.eh.MDd(xa,sa,lb,Yb);return Yb.task};a.prototype.IXa=
function(xa){this.eh.IXa(xa)};a.prototype.sGb=function(xa){this.eh.sGb(xa)};a.prototype.Wua=function(xa){var sa=this,lb,Yb;return function(){var Fa=sa.aG.Ec(xa);lb=Fa.value;return Fa}().returnValue&&function(){var Fa=lb.Ec(0);Yb=Fa.value;return Fa}().returnValue?new O(this.eUh(Yb),Yb.timeStamp):null};a.prototype.KCh=function(){for(var xa={},sa={},lb=yl(this.aG),Yb=lb.next();!Yb.done;sa={Ueb:sa.Ueb,JBc:sa.JBc},Yb=lb.next())sa.Ueb=Yb.value,sa.JBc=void 0,function(Fa){return function(){var Sa=Fa.Ueb.value.Ec(0);
Fa.JBc=Sa.value;return Sa}}(sa)().returnValue&&(xa[sa.Ueb.key]=this.Wua(sa.Ueb.key));return xa};a.prototype.Pdb=function(xa){var sa=new S.a;this.eh.IXi(xa,sa);return sa.task};a.prototype.dispose=function(){this.$s||(this.qza.Xs(),this.Og.c3i(this.jp),this.jp.MEd(),Ia.a.instance&&Ia.a.instance.Zrd(),this.$s=!0)};a.prototype.NAi=function(xa,sa){this.seb(sa,"StateChangedSignalR")&&this.HV(this.Bze(xa.newState),this.Bze(xa.oldState))};a.prototype.HV=function(xa,sa){if((1!==this.jL||sa||1!==xa)&&this.jL!==
sa){var lb=String.format.apply(null,["Unexpected connection state change : Current state is '{0}' while the event indicates ('{1}'->'{2}') transition"].concat([this.jL,sa,xa]));ba.ULS.sendTraceTag(3290053,500,10,lb)}if(this.jL!==xa){switch(xa){case 2:Ia.a.instance&&Ia.a.instance.Lqi();this.W7=this.zO.id;ba.ULS.sendTraceTag(3249539,500,50,"Established connection [{0}] for client [{1}]",this.W7,this.Ll);this.Ioi(this.zO);ba.ULS.sendTraceTag(4298369,500,50,"Retrieving complete session state");lb=null;
this.uh&&(lb=this.uh.Fc("WebServiceCall","Receive First Presence"));var Yb=this.ggb;this.eh.tXi(Object(ca.a)(this,this.seb,"verifyConnectionToken"),Yb,this.IEc,Object(ca.a)(this,this.AZc,"clearExistingPersistentState"),this.ECh(),lb);this.xe.rtcClientMessageTelemetryEnabled&&I.Qdd(this.eh,this.xe,100*Math.random()<=this.xe.kbj).start();break;case 1:2===sa&&ba.ULS.sendTraceTag(4298644,500,50,"Lost connection [{0}] to the server ...trying to re-establish it",this.W7);break;case 0:if(I.instance&&I.instance.stop(),
this.qza.GIa)ba.ULS.sendTraceTag(3249543,500,50,"Connection [{0}] has been explicitly closed",this.W7);else{1===sa&&(ba.ULS.sendTraceTag(7672737,500,50,"Signalr detected an unexpected disconnect event while attempting to re-establish connection [{0}]. Kicking off global reconnect logic ...",this.W7),this.jp.oJf());2===sa&&ba.ULS.sendTraceTag(36574532,500,50,"Signalr detected a disconnect event triggered by a period of client inactivity for connection [{0}]. Kicking off global reconnect logic ...",
this.W7);this.N4b();return}}this.jL=xa;this.eh.KWi(xa,sa)}};a.prototype.Ioi=function(xa){if(xa&&xa.transport&&xa.transport.name){xa=xa.transport.name;var sa=xa.toLowerCase();"websockets"===sa?ba.ULS.sendTraceTag(4290723,500,50,"Transport name - {0} for [{1}]",xa,this.Ll):"serversentevents"===sa?ba.ULS.sendTraceTag(4290752,500,50,"Transport name - {0} for [{1}]",xa,this.Ll):"foreverframe"===sa?ba.ULS.sendTraceTag(4290753,500,50,"Transport name - {0} for [{1}]",xa,this.Ll):"longpolling"===sa?ba.ULS.sendTraceTag(4290754,
500,50,"Transport name - {0} for [{1}]",xa,this.Ll):"mocktransport"!==sa&&ba.ULS.sendTraceTag(4290755,500,15,"Unknown transport protocol encountered - '{0}'",xa)}else ba.ULS.sendTraceTag(4290722,500,10,"Transport protocol name is missing")};a.prototype.RKi=function(){ba.ULS.sendTraceTag(3249544,500,50,"Detected that the connection [{0}] is slow",this.W7)};a.prototype.IKi=function(xa){var sa=b(840).RtcUtils;ba.ULS.sendTraceTag(3249545,600,10,"SignalR ERROR for connection [{0}]: {1}",this.W7,sa.Exa(xa)||
"<empty>")};a.prototype.JKi=function(xa){xa=b(840).RtcUtils.Exa(xa);this.tuj&&2E3>this.zee&&!xa.startsWith("Invok")&&!xa.startsWith("Trigger")&&(ba.ULS.sendTraceTag(578950464,500,50,"SignalR lib: {0}",xa),this.zee++)};a.prototype.AZc=function(){var xa=[],sa=this.aG.Ec(this._clientId);var lb=sa.value;sa.returnValue&&this.aG.remove(this._clientId);var Yb=yl(this.aG.keys);for(sa=Yb.next();!sa.done;sa=Yb.next())Array.add(xa,sa.value);Yb=yl(xa);for(sa=Yb.next();!sa.done;sa=Yb.next())this.aG.remove(sa.value);
lb&&this.aG.ia(this._clientId,lb);this.eh.eXi(xa)};a.prototype.Bze=function(xa){switch(xa){case 0:return 1;case 2:return 1;case 1:return 2;case 4:return 0;default:throw Error.argumentOutOfRange("state",xa,"Unknown SignalR state");}};a.prototype.eUh=function(xa){return xa&&xa.timeStamp?(new Date).getTime()-xa.timeStamp.getTime()>(this.xe.VIg?6E4:this.xe.UIg)?2:1:1};a.createInstance=function(xa,sa,lb,Yb,Fa,Sa,Ra,Lb,Ja,xb,Kb,Eb,Hc){return k(xa,sa,lb,void 0===Hc?null:Hc,Yb,Fa,Sa,Ra,void 0===Lb?null:Lb,
void 0===Ja?null:Ja,void 0===xb?null:xb,void 0===Eb?null:Eb,void 0===Kb?null:Kb)};tl.Object.defineProperties(a.prototype,{Zic:{configurable:!0,enumerable:!0,get:function(){return this.Doa.Zic},set:function(xa){this.Doa.Zic=xa}},qza:{configurable:!0,enumerable:!0,get:function(){return this.Oqg}},eh:{configurable:!0,enumerable:!0,get:function(){return this.Sfg}},connectionState:{configurable:!0,enumerable:!0,get:function(){return this.jL}},clientId:{configurable:!0,enumerable:!0,get:function(){return this._clientId}},
tuj:{configurable:!0,enumerable:!0,get:function(){return this.Org}}});a.Nlf=31E3;a.Dtd=8E3;a.OOj=15E3;Object(y.a)(a,"RealtimeChannel",null,[129,130])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.cl.js.map/01dd96f97159aa27b7f70408fdf5150d/EwaDS.cl.js.map