(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[16],{1240:function(y,D,b){function a(W,R,I){var Q=this;this.zMa=this.fad=this.rAa=this.Djc=null;this.hPd=this.Y5a=this.wz=!1;this.zyh=function(O,ba){u.ULS.sendTraceTag(528758222,306,50,"FormulaByExampleManager.formulaByExampleAnnotationHandler: annotation received.");var ca=ba.bY;if(ca)if(O=parseInt(ca.guid),u.ULS.sendTraceTag(526984792,306,15,"FormulaByExampleManager.formulaByExampleAnnotationHandler: annotation received for flowId: {0}.",
O),m.a.getInstance(Q.$).xij(O),Q.wz&&!Q.Y5a&&Object(m.f)("ANNOTATIONRECEIVED",O),null!=ca.errorMessage)u.ULS.sendTraceTag(527005666,306,10,"FormulaByExampleManager.formulaByExampleAnnotationHandler: annotation arrived with error message: {0}",ca.errorMessage);else{ba=ba.bY;ca=x.Range.ld(ba.rows[0],ba.column);var S=G.g(Q.$).Vb.vk(ca,!1),Y=z.a(S);Y=new x.Range(Y.top,ba.column,Y.bottom,ba.column,!0,!0);if(ba.formulas&&ba.formulas.length){var na=ba.formulas[0];Q.zMa=ba;Q.MOg(S,na,ba);ba.rows.length<a.sud?
u.ULS.sendTraceTag(528758220,306,50,"FormulaByExampleManager.formulaByExampleAnnotationHandler: annotation does not have enough examples to prompt a suggestion."):(u.ULS.sendTraceTag(527005665,306,50,"FormulaByExampleManager.formulaByExampleAnnotationHandler: annotation with formula suggestion arrived. trying to suggest/apply it. flowID: {0}",O),ba.invocationMethod?Q.IZf(S,ba.column,na,null,O)&&Q.i7f(S,Y,ca,na,ba.stateID,!1,O):Q.Qij(Y,ca,na))}else u.ULS.sendTraceTag(528758221,306,50,"FormulaByExampleManager.formulaByExampleAnnotationHandler: annotation does not have any formula suggestions.")}else u.ULS.sendTraceTag(537161922,
306,15,"FormulaByExampleManager.formulaByExampleAnnotationHandler: annotation is null.")};this.$ej=function(){u.ULS.sendTraceTag(537161889,306,50,"FormulaByExampleManager.SendByExampleFeedback: opening send feedback dialog after click on card.");var O={};O[A.a.O$]="FormulaByExampleCard";Q.$.Ce(802602464,0,8,O)};this.DKi=function(O){Q.hPd=!0;u.ULS.sendTraceTag(537161888,306,50,"FormulaByExampleManager.OnShowFormula: user clicked ShowFormula button in the card for flow {0}",O)};this.QXh=function(O){u.ULS.sendTraceTag(528758219,
306,50,"FormulaByExampleManager.HandleNewBlocksDuringPreview: new block arrived during preview mode.",O.$c.hash);var ba=O.$c.block,ca=x.Range.ld(Q.zMa.rows[0],Q.zMa.column),S=G.g(Q.$).Vb.vk(ca,!1);S=z.a(S);var Y=(new x.Range(S.top,Q.zMa.column,S.bottom,Q.zMa.column,!0,!0)).Jf(ba.Wf),na=(new x.Range(S.top,S.left,S.bottom,S.right,!0,!0)).Jf(ba.Wf);S=[];ba=yl(G.g(Q.$).Dua(na,ba));for(na=ba.next();!na.done;na=ba.next())S.push(na.value);u.ULS.sendTraceTag(537161886,306,50,"FormulaByExampleManager.HandleNewBlocksDuringPreview: putting skeleton for preview cells in new block {0}.",
O.$c.hash);Q.VVd(Y,!0);Q.k7c(Y,ca,Q.zMa.formulas[0],Q.zMa.stateID,!0,S).then(function(){u.ULS.sendTraceTag(537161885,306,50,"FormulaByExampleManager.HandleNewBlocksDuringPreview: putting calculated data into model and demanding re-render for block {0}.",O.$c.hash);Q.VVd(Y,!1);Q.sN.ulf(O.$c.block);return!0}).catch(function(Z){u.ULS.sendTraceTag(537161884,306,50,"FormulaByExampleManager.HandleNewBlocksDuringPreview: caught exception: {0}.",Z)})};this.N8a=function(O,ba){0==ba.Wx&&(170==ba.Sg.operation.operationName&&
Q.wFi(),Q.$.userOperationManager.pz(Q.N8a))};this.wFi=function(){u.ULS.sendTraceTag(528023709,306,50,"FormulaByExampleManager.onImmediateUndo: undo operation queued following a formula by example suggestion application.")};this.$=W;this.augmentationLoopManager=R;this.calcManager=I;this.sN=G.g(W).sN;this.nCd=!1;t.a.H4(this.$)?this.init():u.ULS.sendTraceTag(537161923,306,10,"FormulaByExampleManager.Ctor: not expected to be constructed when FG is off.")}function d(){var W=P.call(this)||this;W.rows=null;
W.column=0;W.formulas=null;W.stateID=0;W.invocationMethod=0;W.resultKind=0;W.guid=null;W.errorMessage=null;W.H_=Object.assign(new N.a,{T_:d.getTypeName(),B_:d.pe()});return W}function c(W){var R=B.call(this,document.createElement("div"))||this;R.$=W;R.grid=G.g(W);return R}function k(W){this.calcManager=W;this.cache=new Map}function n(W,R){this.formula=W;this.Xsc=this.state=0;this.i1a=R}function l(W,R,I){this.wz=!1;this.$=W;this.calcManager=R;this.wz=I}function f(W,R){this.status=W;this.IYc=void 0===
R?null:R}y=b(0);var u=b(13),v=b(80),m=b(960),A=b(4),x=b(24),t=b(41),z=b(153);Object(y.a)(f,"FormulaByExampleFormulaEvalResult",null,[]);var r=b(19),G=b(20);l.prototype.Rij=function(W,R,I,Q,O,ba,ca){var S=this;Q=void 0===Q?null:Q;O=void 0===O?!1:O;return this.EJe(W.Jf(G.g(this.$).Ph),R,I,Q).then(function(Y){S.wz&&!O&&ba&&Object(m.f)("CALCULATIONED",ba,ca);if(2===Y.status)return Y;u.ULS.sendTraceTag(537161881,0,50,"FormulaByExampleModelUpdater:setFormulaPreviewOnRangeModel: evalFormulaRangeOnClone CSE: Result received from calc.");
return S.IJj(Y,O,ba,ca)}).catch(function(Y){return Promise.reject(String.format("FormulaByExampleModelUpdater:setFormulaPreviewOnRangeModel: Unable to EvalFormulaRange, e: {0}",Y.toString()))})};l.prototype.EJe=function(W,R,I,Q){var O=this;Q=l.hyh(void 0===Q?null:Q);return this.calcManager.Wrb(Q,W,R,I).then(function(ba){if(!O.Xai(ba))return new f(2);if(!O.lEg(ba))return u.ULS.sendTraceTag(527005663,0,50,"FormulaByExampleModelUpdater:EvalFormulaRangeOnClone: Formula results from Calc.ts had errors."),
new f(2);if(!O.iNj(ba.results))return u.ULS.sendTraceTag(537161880,0,50,"FormulaByExampleModelUpdater:EvalFormulaRangeOnClone: Formula results from Calc.ts do not match grid data."),new f(2);u.ULS.sendTraceTag(537161879,0,50,"FormulaByExampleModelUpdater:EvalFormulaRangeOnClone: EvalFormulaRange CSE: Result received from calc.");return new f(0,ba.results)}).catch(function(ba){return Promise.reject(String.format("FormulaByExampleModelUpdater:EvalFormulaOnRange: Unable to EvalFormulaRange, e: {0}",
ba.toString()))})};l.prototype.YFg=function(W,R){if(W){W=yl(W);for(var I=W.next();!I.done;I=W.next())if(I=I.value,this.mSe(I)){var Q=l.ned(I);if(Q=G.g(this.$).sc(Q))Q=Q.cell,Q.text=l.q$b(I).value,Q.formulaBarText=R}}};l.hyh=function(W){function R(I){return{row:I.cell.SJ,column:I.cell.RJ,Gm:I.cell.Gm,text:I.cell.text}}return W?W.map(R):null};l.prototype.lEg=function(W){W=yl(W.results);for(var R=W.next();!R.done;R=W.next())if(!this.mSe(R.value))return!1;return!0};l.prototype.Xai=function(W){return(W=
W.results)&&W.length?!0:!1};l.prototype.mSe=function(W){var R=excelOnlineCalc.util.isSuccess(W);return R&&8===l.q$b(W).kind?(W=l.ned(W),(W=G.g(this.$).sc(W))&&W.cell.text&&u.ULS.shipAssertTag(537161878,0,!1,"FormulaByExampleModelUpdater:FormulaCalculationSucceeded: formula evaluation failed, bad formula provided"),!1):R};l.prototype.IJj=function(W,R,I,Q){for(var O=yl(W.IYc),ba=O.next();!ba.done;ba=O.next())if(ba=ba.value,excelOnlineCalc.util.isSuccess(ba)){var ca=l.DUe(ba);ba=l.q$b(ba);ca&&ba?(ca=
l.KZe(ca),(ca=G.g(this.$).sc(ca))?(ca.cell.fFf=ba.value,W.status|=1):W.status|=2):W.status|=2}else W.status|=2;this.wz&&!R&&I&&Object(m.f)("MODELUPDATED",I,Q);return W};l.prototype.iNj=function(W){W=yl(W);for(var R=W.next();!R.done;R=W.next()){R=R.value;if(!excelOnlineCalc.util.isSuccess(R))return!1;var I=l.ned(R);I=G.g(this.$).sc(I);if(!I||(I=I.text)&&!r.a.equals(I,l.q$b(R).value,!1))return!1}return!0};l.KZe=function(W){return x.Range.ld(W.row+1,W.col+1)};l.DUe=function(W){return W.value[0]};l.ned=
function(W){return l.KZe(l.DUe(W))};l.q$b=function(W){return W.value[1]};Object(y.a)(l,"FormulaByExampleModelUpdater",null,[]);Object(y.a)(n,"FormulaByExampleSuggestionsCacheEntry",null,[]);k.prototype.MZh=function(W,R,I){return(W=this.ffd(W,R))&&this.cache.has(W)&&r.a.equals(this.cache.get(W).formula,I,!0)};k.prototype.NOg=function(W,R,I,Q){var O=this.ffd(W,R);O?(u.ULS.sendTraceTag(537161877,306,50,"FormulaByExampleSuggestionsCache.CacheTableSuggestion: saving suggestion for table range. tableRange: {0}, columnNumber: {1}, examplesCount {2}, hasPreviousSuggestion: {3}",
W.usedRange,R,Q,this.cache.has(O)),this.cache.set(O,new n(I,Q))):u.ULS.sendTraceTag(528889932,306,15,"FormulaByExampleSuggestionsCache.CacheTableSuggestion: failed to cache table suggestion due to getTableColumnKey failure.")};k.prototype.Qub=function(W,R){W=this.ffd(W,R);return W?this.cache.get(W):(u.ULS.sendTraceTag(528889931,306,15,"FormulaByExampleSuggestionsCache.getTableCachedSuggestion: failed to get cached table suggestion due to getTableColumnKey failure."),null)};k.prototype.ffd=function(W,
R){return(R=this.HSh(W,R))?W.name+"_"+R:null};k.prototype.HSh=function(W,R){var I=this.calcManager.Rub(W);if(!I)return null;W=W.usedRange;var Q=R-W.left;(0>Q||Q>=I.count)&&u.ULS.sendTraceTag(537161876,306,10,"FormulaByExampleSuggestionsCache.GetTableColumnName: invalid inputs: tableRange: {0}, columnNumber: {1}.",W,R);return I.na(Q)};Object(y.a)(k,"FormulaByExampleSuggestionsCache",null,[]);var w=b(232),B=w.a;vm(c,B);c.prototype.show=function(W,R,I,Q,O,ba,ca){ba=void 0===ba?null:ba;ca=void 0===ca?
null:ca;if(!ca&&this.$){ca=this.grid.sc(null);if(!ca){u.ULS.sendTraceTag(537161875,1,50,"FormulaSuggestionUIControl.Show: failed to show UI, formattedActiveCell is null.");return}if(!ca.cell.tk){u.ULS.sendTraceTag(537161874,1,50,"FormulaSuggestionUIControl.Show: failed to show UI, formattedActiveCell is not in view.");return}ca=this.grid.getCellBounds(ca.cell,!0);u.ULS.shipAssertTag(537161873,1,!!ca,"FormulaSuggestionUIControl.Show: target cell bounds should not be null.")}u.ULS.sendTraceTag(537161872,
1,50,"FormulaSuggestionUIControl.Show: calling AppChrome API to render card UI.");appChrome.renderFormulaSuggestionCard(W,R,this.domElement,ca.y,ca.x,ca.y+ca.height,ca.x+ca.width,I,Q,O,ba)};c.prototype.hide=function(){u.ULS.sendTraceTag(537161871,1,50,"FormulaSuggestionUIControl.Hide: calling AppChrome API to unmount card UI.");appChrome.unmountReactComponent(this.domElement)};Object(y.a)(c,"FormulaSuggestionUIControl",w.a,[]);var U=b(257);w=b(848);var N=b(821),P=w.a;vm(d,P);d.getTypeName=function(){return"AugLoop_FormulaByExample_FormulaByExampleAnnotation"};
d.pe=function(){return["AugLoop_Core_Annotation"]};Object(y.a)(d,"FormulaByExampleAnnotation",w.a,[]);var ia=b(250);b.d(D,"a",function(){return a});a.prototype.iLi=function(W,R){this.nCd=!1;var I,Q=G.g(this.$).Vb.vk(W,!1);if((I=this.rAa.Qub(Q,W.left))&&this.IZf(Q,W.left,I.formula,I)){u.ULS.sendTraceTag(529109774,306,50,"FormulaByExampleManager.onTableInput: A cached formula suggestion found for current input.");var O=z.a(Q);O=new x.Range(O.top,W.left,O.bottom,W.left,!0,!0);this.i7f(Q,O,W,I.formula,
this.$.fa.Fhc,!0,R)}};a.prototype.dispose=function(){this.$.userOperationManager.pz(this.N8a)};a.prototype.init=function(){var W=b(1295).FormulaByExampleAutoSuggestActor;this.augmentationLoopManager.activateAnnotation(d.getTypeName());this.augmentationLoopManager.bT(d.getTypeName(),this.zyh);(this.wz=Object(m.b)())||u.ULS.sendTraceTag(529109773,306,50,"FormulaByExampleManager.init: performance marks and measure are not supported for current browser.");new W(this.$,this.calcManager,this.wz);this.Djc=
new l(this.$,this.calcManager,this.wz);this.rAa=new k(this.calcManager);this.fad=new c(this.$);u.ULS.sendTraceTag(528758223,306,50,"FormulaByExampleManager.init: init complete.")};a.prototype.Qij=function(W,R,I){var Q=this;this.Djc.EJe(W,R,I,null).then(function(O){Q.NUc(W,R,I,1===O.status?O.IYc:null);return null}).catch(function(){u.ULS.sendTraceTag(537161921,306,50,"FormulaByExampleManager.setFormulaOnRangeExplicit: client estimation failed for explicit by example flow.");Q.NUc(W,R,I,null)})};a.prototype.i7f=
function(W,R,I,Q,O,ba,ca){var S=this;u.ULS.sendTraceTag(527713160,306,50,"FormulaByExampleManager.tryDisplayFormulaSuggestionPreview: starting flow to show a formula suggestion. isFromCache: {0}",ba);this.wz&&!this.Y5a&&Object(m.f)("CALCULATIONSTART",ca,ba);O=this.k7c(R,I,Q,O,!0,null,ca,ba);var Y=O.then(function(){return S.sN.jcb(R,S.QXh).then(function(na){S.Y5a=!0;S.wz&&ia.a(function(){Object(m.f)("PREVIEWRENDERED",ca,ba);var Z=Object(m.e)(ba,ca);u.ULS.sendTraceTag(529109772,306,50,"FormulaByExampleManager.TryDisplayFormulaSuggestionPreview: durations for preview shown flow: {0}",
JSON.stringify(Z))},S.$.ma);S.fad.show(Q,R.toString(),Object(v.a)(na,function(){return na.lWb("CardUI")},"acceptPreview"),Object(v.a)(na,function(){return na.X3b("CardUI")},"declinePreview"),S.$ej,function(){return S.DKi(ca)});return na.X$i})});Promise.all([O,Y]).then(function(na){S.nCd=!0;S.bYh(na[0],na[1],W,R,I,Q,ba,ca)}).catch(function(na){u.ULS.sendTraceTag(537161920,306,15,"FormulaByExampleManager.TryDisplayFormulaSuggestionPreview: failed to show formula preview due to promise rejection. rejection reason: {0}",
na);if(na=S.rAa.Qub(W,R.left))na.state=2})};a.prototype.MOg=function(W,R,I){var Q=!1,O=I.rows.length,ba=this.rAa.Qub(W,I.column);!ba||(Q=ba.formula!==R)?(Q&&u.ULS.sendTraceTag(537161891,306,50,"FormulaByExampleManager.ByExampleAnnotationHandler: formula changed from last cache entry, overriding cache entry. Last example count: {0}, current: {1}",ba.i1a,O),this.rAa.NOg(W,I.column,R,O)):ba.i1a!==O&&(u.ULS.sendTraceTag(537161890,306,50,"FormulaByExampleManager.ByExampleAnnotationHandler: formula didn't change from the last cache entry, but number of examples changed. Last example count: {0}, current: {1}",
ba.i1a,O),ba.i1a=O)};a.prototype.k7c=function(W,R,I,Q,O,ba,ca,S){var Y=this;return this.Djc.Rij(W,R,I,void 0===ba?null:ba,this.Y5a,ca,S).then(function(na){u.ULS.sendTraceTag(537161887,306,50,"FormulaByExampleManager.EvaluateFormulaAndUpdateModel: model update completed. result: {0}.",na.status);switch(na.status){case 1:case 3:return Promise.resolve(na);case 2:return O&&Q+1===Y.$.fa.rf?Y.k7c(W,R,I,Q,!1):Promise.reject("Calc estimation aborted");default:return Promise.reject("Calc estimation failed")}})};
a.prototype.bYh=function(W,R,I,Q,O,ba,ca,S){var Y=this,na=this.hPd;this.G9i();this.wz&&Object(m.f)("USERINPUTARRIVED",S,ca);var Z=this.rAa.Qub(I,Q.left);this.VVd(Q,!1);this.fad.hide();I=R.dFf;ia.a(function(){Y.wz&&Object(m.f)("PREVIEWREMOVEDWITHCSE",S,ca);var wa={};wa=(wa.flowId=S,wa.caller=R.M_b,wa.suggestionOutcome=R.dFf,wa.isCachedSuggestion=ca,wa.showFormulaClicked=na,wa.exampleCount=null===Z||void 0===Z?void 0:Z.i1a,wa.seenCount=null===Z||void 0===Z?void 0:Z.Xsc,wa.previewShownDurations=Y.wz?
Object(m.e)(ca,S):"none",wa.previewRemovedDurations=Y.wz?Object(m.d)(ca,S):"none",wa);u.ULS.sendTraceTag(529109771,306,50,"FormulaByExampleManager.handlePreviewResult: FormulaByExample flow results: {0}",JSON.stringify(wa));Object(m.c)(S)},this.$.ma);switch(I){case "ACCEPT":u.ULS.sendTraceTag(529109770,306,50,"FormulaByExampleManager.handlePreviewResult: User accepted the formula via {0}",R.M_b);this.iVd(Z,1);this.NUc(Q,O,ba,W.IYc);break;case "DECLINE":u.ULS.sendTraceTag(529109769,306,50,"FormulaByExampleManager.handlePreviewResult: User declined the formula via {0}",
R.M_b);this.iVd(Z,3);break;case "IGNORE":u.ULS.sendTraceTag(529109768,306,50,"FormulaByExampleManager.handlePreviewResult: User ignored the formula via {0}",R.M_b),this.iVd(Z,2)}};a.prototype.G9i=function(){this.hPd=this.Y5a=!1};a.prototype.iVd=function(W,R){W&&(W.state=R,W.Xsc+=1)};a.prototype.NUc=function(W,R,I,Q){var O=G.g(this.$),ba=Object.assign(new U.a,{Text:I});O.setCell(ba,R,1,127,null,0,W);this.Djc.YFg(Q,I);u.ULS.sendTraceTag(537161883,306,50,"FormulaByExampleManager.applyFormulaSuggestionOnRange: applied formula on table, range: {0}",
W);this.$.userOperationManager.uy(this.N8a)};a.prototype.IZf=function(W,R,I,Q,O){Q=void 0===Q?null:Q;if(this.nCd)return u.ULS.sendTraceTag(528758218,306,50,"FormulaByExampleManager.shouldShowPreview: can't show preview again as preview already was shown for the current edit. flowId: {0}",O),!1;if(this.Y5a)return u.ULS.sendTraceTag(527005664,306,50,"FormulaByExampleManager.shouldShowPreview: can't show preview for this suggestion as preview is already showing. flowId: {0}",O),!1;Q||this.rAa.MZh(W,
R,I)&&(Q=this.rAa.Qub(W,R));if(Q){if(3===Q.state)return u.ULS.sendTraceTag(528758217,306,50,"FormulaByExampleManager.shouldShowPreview: user declined this suggestion before, not showing again. flowId: {0}",O),!1;if(2===Q.state&&2<=Q.Xsc)return u.ULS.sendTraceTag(528758216,306,50,"FormulaByExampleManager.shouldShowPreview: user saw suggestion at least twice and ignored last time. not showing again. flowId: {0}",O),!1;if(Q.i1a<a.sud)return u.ULS.sendTraceTag(528758215,306,50,"FormulaByExampleManager.shouldShowPreview: cached suggestion does not have enough examples. not showing preview. flowId: {0}",
O),!1}return!0};a.prototype.VVd=function(W,R){for(var I=W.top;I<=W.bottom;I++)for(var Q=W.left;Q<=W.right;Q++){var O=x.Range.ld(I,Q);if(O=G.g(this.$).sc(O))O.cell.Utj=R&&!O.cell.fFf}};a.Ysi=1;a.sud=2;Object(y.a)(a,"FormulaByExampleManager",null,[321,3])},1249:function(y,D,b){function a(w,B,U,N){this.wz=!1;this.$=w;this.gridView=v.g(w);this.augmentationLoopManager=B;this.calcManager=U;this.formulaByExampleManager=N;this.wz=Object(r.b)();n.ULS.sendTraceTag(528758226,306,50,"FormulaByExampleCommandHandler.ctor: FBE command handler created")}
function d(){var w=x.call(this)||this;w.examples=null;w.columnNames=null;w.formulasCount=null;w.stateID=0;w.invocationMethod=0;w.supportedFunctions=null;w.guid=null;w.H_=Object.assign(new A.a,{T_:d.getTypeName(),B_:d.pe()});return w}function c(){this.output=this.inputs=null}function k(){this.column=0;this.name=null}y=b(0);var n=b(13),l=b(41),f=b(153),u=b(175),v=b(20);Object(y.a)(k,"ColumnNameMap",null,[]);Object(y.a)(c,"FormulaByExampleInput",null,[]);var m=b(1017),A=b(821),x=m.a;vm(d,x);d.getTypeName=
function(){return"AugLoop_FormulaByExample_FormulaByExampleSignal"};d.pe=function(){return["AugLoop_Signals_Signal"]};Object(y.a)(d,"FormulaByExampleSignal",m.a,[]);var t=b(1274),z=b(55),r=b(960);b.d(D,"b",function(){return G});b.d(D,"a",function(){return a});var G={f6c:"editRange",ZTd:"triggerKind",rRe:"flowId"};a.prototype.Xc=function(){return!1};a.prototype.executeCommand=function(w,B,U){w=!1;B=B.command;switch(B){case 1928326585:w=!U||!U[G.f6c];var N=this.WHh(U,w),P=U[G.rRe];U=U&&U[G.ZTd]?U[G.ZTd]:
0;w||2!==U||this.formulaByExampleManager.iLi(N,P);w=this.triggerFormulaByExample(N,w,P)}return w?z.Task.Ta(!0):u.a(B)};a.prototype.Gc=function(w,B){switch(B.command){case 1928326585:return l.a.H4(this.$);default:return!1}};a.prototype.fd=function(){return!1};a.prototype.WHh=function(w,B){n.ULS.sendTraceTag(537161928,306,50,"FormulaByExampleCommandHandler.getEditedRange: flow triggered from: {0}",B?"Ribbon":"AutoDetect");return B?this.gridView.ha.va.activeCell:w[G.f6c]};a.prototype.triggerFormulaByExample=
function(w,B,U){if(!this.augmentationLoopManager)return n.ULS.sendTraceTag(537161927,306,10,"FormulaByExampleCommandHandler.TriggerFormulaByExample: augmentationLoopManager instance is null"),!1;var N=this.gridView.Vb.vk(w,!1);if(!N)return n.ULS.sendTraceTag(537161925,306,15,"FormulaByExampleCommandHandler.TriggerFormulaByExample: table returned null for given edit range."),!1;w=this.BJh(w,B,N,U);if(!w)return!0;n.ULS.sendTraceTag(537161926,306,50,"FormulaByExampleCommandHandler.TriggerFormulaByExample: calling SubmitOperationSignal for flowId: {0}.",
U);r.a.getInstance(this.$).wij(U);this.augmentationLoopManager.pRd(w);this.wz&&Object(r.f)("SIGNALSENT",U);return!0};a.prototype.BJh=function(w,B,U,N){w=this.KRh(U,w);if(!w||0==w.length)return n.ULS.sendTraceTag(527496675,306,50,"FormulaByExampleCommandHandler.GetFormulaByExampleSignal: column does not have any examples or any examples with inputs"),null;U=this.oFh(U);B=Object.assign(new d,{formulasCount:1,examples:w,columnNames:U,stateID:this.$.fa.Fhc,invocationMethod:B?0:1,guid:N});n.ULS.sendTraceTag(528758225,
306,50,"FormulaByExampleCommandHandler.getFormulaByExampleSignal: signal generated.");return B};a.prototype.oFh=function(w){var B=[],U=f.a(w),N=w.name;if(U){w=this.calcManager.Rub(w);U=U.left;w=yl(w);for(var P=w.next();!P.done;P=w.next())P=P.value,P=Object.assign(new k,{column:U,name:N+"[@["+P+"]]"}),B.push(P),U++;return B}return null};a.prototype.KRh=function(w,B){var U=[],N=f.a(w);B=B.left;w=this.gridView.sl("FormulaByExample.GetSignalExamplesFromTable",N);try{var P=N.right;N=!1;for(var ia=[],W=
null;w.$$mn();){var R=w.$$cu(),I=R.range,Q=I.left,O=I.top;Q===B?R.text&&(W=a.sAe(Q,O,R.text)):(R.text&&(N=!0),ia.push(a.sAe(Q,O,R.text)));if(Q===P){if(W&&N){var ba=Object.assign(new c,{output:W,inputs:ia});U.push(ba)}ia=[];W=null;N=!1}}}finally{w&&w.dispose()}return U};a.sAe=function(w,B,U){return Object.assign(new t.a,{column:w,displayText:U,row:B})};Object(y.a)(a,"FormulaByExampleCommandHandler",null,[237])},1295:function(y,D,b){function a(m,A,x){var t=this;this.wz=!1;this.QNa=function(z,r){var G=
t.DTh(r);switch(G){case 0:break;default:var w=t.axh.WMh();d.ULS.sendTraceTag(537161929,306,50,"FormulaByExampleAutoSuggestActor.OnEndEdit: triggering FormulaByExample for cell edit. Trigger kind: {0}, FlowId: {1}",G,w);t.wz&&Object(u.f)("EDITCOMMIT",w);z=new l.a(1928326585,1,2,6,null);var B={};r=(B[v.b.f6c]=r.zm,B[v.b.ZTd]=G,B[v.b.rRe]=w,B);t.$.Ka.Zb(z,r)}};this.$=m;this.gridView=f.g(m);this.calcManager=A;this.wz=x;this.gridView.Kc.hq(this.QNa);this.axh=u.a.getInstance(m)}b.r(D);b.d(D,"FormulaByExampleAutoSuggestActor",
function(){return a});y=b(0);var d=b(13),c=b(24),k=b(153),n=b(1240),l=b(92),f=b(20),u=b(960),v=b(1249);a.prototype.DTh=function(m){if(!m.eye)return 0;var A=m.zm;if(!this.gridView.Vb.TLa(A)||this.gridView.Vb.Rcf(A))return 0;A=this.gridView.sc(A);A=this.calcManager.Wai(A.cell.Gm,m.wRg);return null==A||A?0:this.Idj(m.zm)};a.prototype.Idj=function(m){var A=0,x=this.gridView.Vb.vk(m,!1);x=k.a(x);m=m.left;m=new c.Range(x.top,m,x.bottom,m,!0,!0);m=this.gridView.sl("FormulaByExampleAutoSuggestActor",m);try{for(;m.$$mn();)if(m.$$cu().text&&
(A++,A>=n.a.sud))return 2}finally{m&&m.dispose()}return A>=n.a.Ysi?1:0};Object(y.a)(a,"FormulaByExampleAutoSuggestActor",null,[])},1392:function(y,D,b){function a(db){var Zb=Ba.call(this)||this;Zb.$=db;Zb.dc();return Zb}function d(db){return Za.call(this,db)||this}function c(db){var Zb=kb.call(this)||this;Zb.augmentationLoopManager=null;Zb.$=db;Zb.dc();return Zb}function k(db){db=void 0===db?36E5:db;var Zb=Ua.call(this)||this;Zb.Pff=new Map;Zb.Pii=new Map;Zb.avf=new Set;Zb.wsh=db;ob.ULS.sendTraceTag(526766676,
0,50,"AugmentationLoopAnnotationValidator.constructor: annotationExpirationTimeout: "+Zb.wsh+" ms");return Zb}function n(){}function l(){var db=wb.call(this)||this;db.cluster=null;db.ecsId=null;db.restUrl=null;db.ecsOperationUrl=null;db.workbookMetadataVersion=null;db.serverEventVersion=null;db.permissionFlags=null;db.configurations=null;db.collabUserListVersion=null;db.collabStateId=null;db.accessToken=null;db.accessTokenTTL=null;db.supportCustomMessages=null;db.H_=Object.assign(new ta.a,{T_:l.getTypeName(),
B_:l.pe()});return db}function f(){this.ulsLogger=null}function u(){this.handler=null}function v(){this.sendOTelEvent=null}function m(){this.requestAuthTokenCallback=null}function A(){this.featureEnabledCallback=null}function x(){this.enableComplexLocalWorkflows=this.serviceUrl=this.onSessionClose=this.onSessionReconnect=this.onSessionDisconnect=this.onSessionConnect=this.flights=this.extensionConfigs=this.docSessionId=null}function t(){this.powerpoint=this.inferenceServiceVersion=this.downloadBaseUrl=
this.sessionCreationOptions=this.disabledServiceGroups=this.privateMode=this.flights=this.excelServer=this.initSession=this.sessionId=this.releaseFork=this.releaseChannel=this.releaseAudienceGroup=this.uiLanguage=this.appVersion=this.appName=this.serviceUrl=null}function z(db,Zb,Jb,Ic){Ic=void 0===Ic?null:Ic;var uc=wd.call(this)||this;uc.Dla=null;uc.gnd=!1;uc.Df=null;uc.BRc=new Set;uc.Mkc=[];uc.qNb=new Ia;uc.Zc=function(za,pb){pb.aH&&uc.$.fa.sessionId&&(ob.ULS.sendTraceTag(537170394,0,50,"AugmentationLoopManager.onSessionIdChanged: Update augmentation loop server on new ECS Session ID: '{0}'",
uc.$.fa.sessionId),uc.Hga.forceReconnectSession(Object.assign(new na,{excelServerParameters:Object.assign(new Z,{wacCluster:uc.$.ya.MachineCluster,ecsSessionId:"",ecsRestUrl:uc.$.ya.RestActionUrl,ecsOperationUrl:"",metadataVersion:0,serverEventVersion:0,permissionFlags:0,configurations:0,userListVersion:0,collabStateId:0,accessToken:uc.$.ya.AccessToken,accessTokenTTL:uc.$.ya.AccessTokenValidTo.toString()})})),hb.EwaSettings.isChangeGateEnabled("OfficeVSO:5948479_QuickSavesWhenAloneForAugloop")&&(ob.ULS.sendTraceTag(528348225,
0,50,"AugmentationLoopManager.onSessionIdChanged: sending ObserverRequiredNotification, isSeedingRequired: {0}",uc.gnd),uc.aLd(uc.gnd)))};uc.kJi=function(){ob.ULS.sendTraceTag(537170393,0,50,"AugmentationLoopManager.OnRetryableCloseMessage called");for(var za=yl(uc.BRc),pb=za.next();!pb.done;pb=za.next())uc.activateAnnotation(pb.value)};uc.sHi=function(){ob.ULS.sendTraceTag(537170392,0,50,"AugmentationLoopManager.OnNonRetryableCloseMessage called");uc.cRd();uc.mte();hb.EwaSettings.isChangeGateEnabled("OfficeVSO:5948479_QuickSavesWhenAloneForAugloop")&&
uc.$.fa.sessionId&&(ob.ULS.sendTraceTag(528348224,0,50,"AugmentationLoopManager.onNonRetryableCloseMessage: sending ObserverRequiredNotification, isSeedingRequired: false"),uc.aLd(!1))};uc.qd=function(){ob.ULS.sendTraceTag(537170381,0,50,"AugmentationLoopManager.OnWorkbookClosing: handler invoked (IsAppBeforeUnload == {0}, IsAppUnloading == {1).",uc.$.eLa,uc.$.CE);if(uc.$.eLa||uc.$.CE)uc.cRd(),uc.mte(),uc.Hga.closeSession()};uc.bYa=function(za){ob.ULS.sendTraceTag(537170380,0,50,"Annotation Received");
if(za)if(za.items){var pb;if(pb=uc.Dla.Ec(xb.a.Vua(za),0).value){for(var cc=!0,Ac=yl(za.items),ad=Ac.next();!ad.done;ad=Ac.next())if(ad=ad.value)if(xb.a.Yqi(za,[O.getTypeName()])||ad.body&&uc.O8h(ad.body)){var Jd=xb.a.Vua(ad.body),Xd=ad.body,od=new ma(Xd,null,za.parentPath,pb);try{cc=uc.Xpj(Xd)&&cc,ob.ULS.sendTraceTag(576271178,0,50,"AugmentationLoopManager.AnnotationCallback: Triggering Event handler for Annotation {0}. Should report: {1}. ParentRevId: {2}",Jd,cc,za.parentRevId),uc.raiseEvent(Jd,
od,uc)}catch(Je){ob.ULS.sendTraceTag(537170374,0,10,String.format("AnnotationCallback: exception thrown for annotation of type ${0} message: {1}",xb.a.Vua(ad.body),Je.message))}}else ob.ULS.sendTraceTag(537170375,0,10,"AnnotationCallback: Body is either null or not an annotation.");else ob.ULS.sendTraceTag(537170376,0,10,"AnnotationCallback: Error in item");uc.Ahc&&cc&&(za=ya.a(uc.Pg,uc.Ahc.DWd),ob.ULS.sendTraceTag(590906632,0,50,"AugmentationLoopManager.AnnotationCallback: Got valid annotation, time elapse from last state id({0}): {1}",
uc.Ahc.stateId,za))}else ob.ULS.sendTraceTag(537170377,0,10,"AnnotationCallback: Operation Type not supported "+xb.a.Vua(za))}else ob.ULS.sendTraceTag(537170378,0,10,"AnnotationCallback: Operation has no items");else ob.ULS.sendTraceTag(537170379,0,10,"AnnotationCallback: Operation is null")};uc.Nx=function(za,pb){-1!==pb.iof&&(uc.Ahc=Object.assign(new pa,{stateId:pb.iof,DWd:uc.Pg.Kb}))};uc.dya=function(){var za=ya.b(uc.Pg,uc.tzb);uc.$si<=za&&(uc.tzb=uc.Pg.Kb,uc.Hga.submitCustomMessage(Object.assign(new ca,
{message:new P})))};uc.Lxi=function(za,pb){za=pb.bY;ob.ULS.shipAssertTag(537170373,306,!!za,"AugmentationLoopManager.ObserverStatusAnnotationHandler: ObserverStatusAnnotation is null.");uc.gnd=za.isSeedingRequired;uc.$.fa.sessionId&&(ob.ULS.sendTraceTag(528348195,0,50,"AugmentationLoopManager.observerStatusAnnotationHandler: sending ObserverRequiredNotification, isSeedingRequired: {0}",za.isSeedingRequired),uc.aLd(za.isSeedingRequired))};uc.sBa=function(za,pb){var cc;(null===(cc=null===pb||void 0===
pb?void 0:pb.yd)||void 0===cc?0:cc.WorkbookCoauthVersion)&&uc.WMi(pb.yd.WorkbookCoauthVersion,pb.context)};uc.Pg=Ic||da.a.Ra;uc.tzb=uc.Pg.Kb;uc.$=db;uc.Hga=Zb;uc.DRj=Jb;uc.Hga.setAnnotationResultCallback(Object.assign(new S,{handler:uc.bYa}));uc.X4h();uc.$.fa.ED(uc.Nx);uc.$.Vl(uc.qd);uc.Ahc=Object.assign(new pa,{stateId:0,DWd:uc.Pg.Kb});uc.$.da.Ha(328,uc);uc.$si=uc.$.ya.MinimumSecondsBetweenKeepAlivesFromBrowserToAugloop;uc.$.fa.Sj(uc.Zc);uc.$.qa.us(uc.sBa);hb.EwaSettings.isChangeGateEnabled("OfficeVSO:5948479_QuickSavesWhenAloneForAugloop")&&
uc.bvg();uc.Qug();return uc}function r(){var db=G.call(this)||this;db.contents=null;db.H_=Object.assign(new ta.a,{T_:r.getTypeName(),B_:r.pe()});return db}function G(){var db=Xc.call(this)||this;db.widthPx=0;db.heightPx=0;db.H_=Object.assign(new ta.a,{T_:G.getTypeName(),B_:G.pe()});return db}function w(){var db=B.call(this)||this;db.format=0;db.otherFormat=null;db.size=0;db.isOriginalSize=null;db.H_=Object.assign(new ta.a,{T_:w.getTypeName(),B_:w.pe()});return db}function B(){var db=Hc.call(this)||
this;db.id=null;db.sizeBytes=0;db.data=null;db.dataPointer=null;db.H_=Object.assign(new ta.a,{T_:B.getTypeName(),B_:B.pe()});return db}function U(){var db=ia.call(this)||this;db.item=null;db.seq=null;db.opType=null;db.parentPath=null;db.H_=Object.assign(new ta.a,{T_:U.getTypeName(),B_:U.pe()});return db}function N(){var db=Eb.call(this)||this;db.isSeedingRequired=!1;db.H_=Object.assign(new ta.a,{T_:N.getTypeName(),B_:N.pe()});return db}function P(){var db=ia.call(this)||this;db.H_=Object.assign(new ta.a,
{T_:P.getTypeName(),B_:P.pe()});return db}function ia(){var db=Kb.call(this)||this;db.messageId=null;db.cv=null;db.H_=Object.assign(new ta.a,{T_:ia.getTypeName(),B_:ia.pe()});return db}function W(){var db=Ja.call(this)||this;db.isVisible=!1;db.H_=Object.assign(new ta.a,{T_:W.getTypeName(),B_:W.pe()});return db}function R(){var db=Ra.call(this)||this;db.M_=null;db.H_=Object.assign(new ta.a,{T_:R.getTypeName(),B_:R.pe()});return db}function I(){var db=Fa.call(this)||this;db.prevParentPath=null;db.H_=
Object.assign(new ta.a,{T_:I.getTypeName(),B_:I.pe()});return db}function Q(){var db=sa.call(this)||this;db.isFocused=!1;db.H_=Object.assign(new ta.a,{T_:Q.getTypeName(),B_:Q.pe()});return db}function O(){var db=xa.call(this)||this;db.H_=Object.assign(new ta.a,{T_:O.getTypeName(),B_:O.pe()});return db}function ba(){this.operation=null}function ca(){this.message=null}function S(){this.handler=null}function Y(){this.workflow=null}function na(){this.excelServerParameters=null}function Z(){this.supportCustomMessages=
this.accessTokenTTL=this.accessToken=this.collabStateId=this.userListVersion=this.configurations=this.permissionFlags=this.serverEventVersion=this.metadataVersion=this.ecsOperationUrl=this.ecsRestUrl=this.ecsSessionId=this.wacCluster=null}function wa(){this.stateUpdateHandler=this.handler=this.annotationType=null}function ma(db,Zb,Jb,Ic){var uc=Tb.call(this)||this;uc.bY=db;uc.DSj=Zb;uc.parentPath=Jb;uc.operationType=Ic;return uc}function pa(){this.stateId=0;this.DWd=null}function Ia(){}function Ma(db){return void 0===
db?"undefined":(null===db||void 0===db?void 0:db.Xluid)+"/"+(null===db||void 0===db?void 0:db.Xrevid)+"@"+(null===db||void 0===db?void 0:db.DocId)}b.r(D);y=b(0);var ob=b(13),Cb=b(93);D=b(216);Object(y.a)(Ia,"WorkbookCoauthVersion",null,[]);var Xa=b(36);Object(y.a)(pa,"StateIdChangedInfo",null,[]);var Sb=b(81),Tb=Sys.EventArgs;vm(ma,Tb);Object(y.a)(ma,"AnnotationReceivedEventArgs",Sys.EventArgs,[]);var da=b(26),ya=b(113),hb=b(1);Object(y.a)(wa,"ActivateAnnotationParameters",null,[]);Object(y.a)(Z,
"ExcelServerParameters",null,[]);Object(y.a)(na,"ForceReconnectParameters",null,[]);Object(y.a)(Y,"RegisterLocalWorkflowParameters",null,[]);Object(y.a)(S,"SetAnnotationResultCallbackParameters",null,[]);Object(y.a)(ca,"SubmitCustomMessageParameters",null,[]);Object(y.a)(ba,"SubmitOperationParameters",null,[]);var Gb=b(848),Qb=b(1125),Fb=b(880),ta=b(821),xa=Fb.a;vm(O,xa);O.getTypeName=function(){return"AugLoop_Core_DeleteOperation"};O.pe=function(){return["AugLoop_Core_Operation"]};Object(y.a)(O,
"DeleteOperation",Fb.a,[]);var sa=Fb.a;vm(Q,sa);Q.getTypeName=function(){return"AugLoop_Core_FocusOperation"};Q.pe=function(){return["AugLoop_Core_Operation"]};Object(y.a)(Q,"FocusOperation",Fb.a,[]);var lb=b(1016),Yb=b(1126),Fa=Yb.a;vm(I,Fa);I.getTypeName=function(){return"AugLoop_Core_MoveOperation"};I.pe=function(){return["AugLoop_Core_OperationWithSiblingContext","AugLoop_Core_Operation"]};Object(y.a)(I,"MoveOperation",Yb.a,[]);var Sa=b(1124),Ra=Fb.a;vm(R,Ra);R.getTypeName=function(){return"AugLoop_Core_UpdateAnnotationMetaDataOperation"};
R.pe=function(){return["AugLoop_Core_Operation"]};Object(y.a)(R,"UpdateAnnotationMetaDataOperation",Fb.a,[]);var Lb=b(1127),Ja=Fb.a;vm(W,Ja);W.getTypeName=function(){return"AugLoop_Core_VisibilityOperation"};W.pe=function(){return["AugLoop_Core_Operation"]};Object(y.a)(W,"VisibilityOperation",Fb.a,[]);var xb=b(849),Kb=xb.a;vm(ia,Kb);ia.getTypeName=function(){return"AugLoop_Session_Protocol_Message"};ia.pe=function(){return[]};Object(y.a)(ia,"Message",xb.a,[]);vm(P,ia);P.getTypeName=function(){return"AugLoop_Excel_Session_Protocol_ExcelKeepAlive"};
P.pe=function(){return["AugLoop_Session_Protocol_Message"]};Object(y.a)(P,"ExcelKeepAlive",ia,[]);var Eb=Gb.a;vm(N,Eb);N.getTypeName=function(){return"AugLoop_Excel_Session_Protocol_ObserverStatusAnnotation"};N.pe=function(){return["AugLoop_Core_Annotation"]};Object(y.a)(N,"ObserverStatusAnnotation",Gb.a,[]);vm(U,ia);U.getTypeName=function(){return"AugLoop_Session_Protocol_MicroSyncMessage"};U.pe=function(){return["AugLoop_Session_Protocol_Message"]};Object(y.a)(U,"MicroSyncMessage",ia,[]);var Hc=
xb.a;vm(B,Hc);B.getTypeName=function(){return"AugLoop_Core_Blob"};B.pe=function(){return[]};Object(y.a)(B,"Blob",xb.a,[]);vm(w,B);w.getTypeName=function(){return"AugLoop_Image_ImageContent"};w.pe=function(){return["AugLoop_Core_Blob"]};Object(y.a)(w,"ImageContent",B,[]);var Xc=xb.a;vm(G,Xc);G.getTypeName=function(){return"AugLoop_Image_ImageTileMetadata"};G.pe=function(){return[]};Object(y.a)(G,"ImageTileMetadata",xb.a,[]);vm(r,G);r.getTypeName=function(){return"AugLoop_Image_ImageTile"};r.pe=function(){return["AugLoop_Image_ImageTileMetadata"]};
Object(y.a)(r,"ImageTile",G,[]);var Pc=b(101),wd=Xa.a;vm(z,wd);z.prototype.gSc=function(db){this.Mkc.push(db)};z.prototype.bT=function(db,Zb){this.addHandler(db,Zb)};z.prototype.MFb=function(db,Zb){this.removeHandler(db,Zb)};z.prototype.activateAnnotation=function(db,Zb){Zb=void 0===Zb?null:Zb;ob.ULS.sendTraceTag(537170390,0,50,"AugmentationLoopManager.ActivateAnnotation: activating annotation type: {0}.",db);this.BRc.has(db)&&ob.ULS.sendTraceTag(537170389,0,50,"ActivateAnnotation:Annotations {0} were already activated in client session.",
db);this.BRc.add(db);this.Df||(this.Df=this.$.fa.Df,this.Df.dra(this.dya));this.Hga.activateAnnotation(Object.assign(new wa,{annotationType:db,stateUpdateHandler:Zb})).then(function(Jb){Jb||ob.ULS.sendTraceTag(537170388,0,10,"ActivateAnnotation:ActivateAnnotationsResult is null");return null})};z.prototype.submitOperation=function(db){ob.ULS.shipAssertTag(537170387,0,!!db,"AugmentationLoopManager.SubmitOperation: operation is null");ob.ULS.sendTraceTag(537170386,0,50,"AugmentationLoopManager.SubmitOperation: submitting operation of type '{0}'",
xb.a.Vua(db));this.Hga.submitOperation(Object.assign(new ba,{operation:db}))};z.prototype.pRd=function(db){ob.ULS.shipAssertTag(537170385,0,!!db,"AugmentationLoopManager.SubmitOperationSignal: signal is null");ob.ULS.sendTraceTag(537170384,0,50,"AugmentationLoopManager.SubmitOperationSignal: submitting operation signal of type '{0}'",Object.getTypeName(db));this.Hga.submitOperation(Object.assign(new ba,{operation:Object.assign(new Sa.a,{parentPath:["Signal",Object.getTypeName(db)],items:[Object.assign(new lb.a,
{body:db})]})}))};z.prototype.registerLocalWorkflow=function(db){ob.ULS.shipAssertTag(537170383,0,!!db,"AugmentationLoopManager.RegisterLocalWorkflow: workflow is null");ob.ULS.sendTraceTag(537170382,0,50,"AugmentationLoopManager.RegisterLocalWorkflow: registering local workflow '{0}'",db.id);this.Hga.registerLocalWorkflow(Object.assign(new Y,{workflow:db}))};z.prototype.dMj=function(db,Zb,Jb,Ic){db=Object.assign(new r,{heightPx:Ic,widthPx:Jb,contents:[Object.assign(new w,{id:Zb+".0",format:2,size:3,
sizeBytes:db.length,data:db})]});Zb=Object.assign(new lb.a,{id:Zb,body:db});Zb=Object.assign(new U,{item:Zb});this.Hga.submitCustomMessage(Object.assign(new ca,{message:Zb}))};z.prototype.dispose=function(){this.$&&this.$.fa&&this.$.fa.kk(this.Zc);this.$&&this.$.qa&&this.$.qa.Lt(this.sBa);this.Mkc=[];this.cRd();wd.prototype.dispose.call(this)};z.prototype.cRd=function(){this.Df&&(this.Df.eza(this.dya),this.Df=null);this.$.fa.TC(this.Nx)};z.prototype.mte=function(){for(var db=yl(this.Mkc),Zb=db.next();!Zb.done;Zb=
db.next()){Zb=Zb.value;try{Zb()}catch(Jb){ob.ULS.sendTraceTag(528016151,0,10,String.format("AugmentationLoopManager.CallAndClearAugloopCloseCallbacks: exception thrown at callback invocation with message: {0}",Jb.message))}}this.Mkc=[]};z.prototype.X4h=function(){this.Dla=new Pc.a;this.Dla.ia(Qb.a.getTypeName(),1);this.Dla.ia(Lb.a.getTypeName(),2);this.Dla.ia(I.getTypeName(),5);this.Dla.ia(O.getTypeName(),3);this.Dla.ia(W.getTypeName(),7);this.Dla.ia(Q.getTypeName(),6);this.Dla.ia(R.getTypeName(),
4)};z.prototype.O8h=function(db){return xb.a.Vua(db)===Gb.a.getTypeName()||0<=Array.indexOf(xb.a.jUe(db),Gb.a.getTypeName())};z.prototype.Xpj=function(db){if(db){if(hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.SharedOnline.AutoCLPV2Transition",!1)){var Zb=!!db.recommended&&!!db.recommended.id;return!!db.automatic&&!!db.automatic.id||Zb}Zb=!!db.recommended&&!!db.recommended.sensitivityLabel&&!!db.recommended.sensitivityLabel.id;return!!db.automatic&&!!db.automatic.sensitivityLabel&&!!db.automatic.sensitivityLabel.id||
Zb}return!1};z.prototype.Qug=function(){hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnitTelemetryAL",!1)&&this.activateAnnotation("AugLoop_UnitTelemetry_UnitTelemetryAggregatedAnnotation")};z.prototype.bvg=function(){this.activateAnnotation(N.getTypeName());this.bT(N.getTypeName(),this.Lxi)};z.prototype.aLd=function(db){var Zb=this.$.qa.ta,Jb=Zb.Oa(1,null);Jb.isObserverRequired=db;Sb.i(Zb,"ObserverRequiredNotification",Jb,null,null,null,null,0)};z.prototype.WMi=function(db,Zb){if(this.qNb.DocId!==
db.DocId||this.qNb.Xluid!==db.Xluid&&this.qNb.Xrevid!==db.Xrevid){this.qNb=db;var Jb=Ma(this.qNb);db=Ma(db);ob.ULS.sendTraceTag(537170372,0,50,"AugmentationLoopManager.OnWorkbookCoauthVersionUpdated: "+Jb+" --\x3e "+db+" ("+(null===Zb||void 0===Zb?void 0:Zb.methodName)+")")}};Object(y.a)(z,"AugmentationLoopManager",Xa.a,[323,3]);var Tc=b(5),ub=b(384),fb=b(183),Ta=b(143),eb=b(28),tb=b(84),rc=b(51);Object(y.a)(t,"InitializeParameters",null,[]);Object(y.a)(x,"SessionCreationOptions",null,[]);Object(y.a)(A,
"SetIsFeatureEnabledCallbackParameters",null,[]);Object(y.a)(m,"SetRequestAuthTokenCallbackParameters",null,[]);Object(y.a)(v,"SetSendOTelEventCallbackParameters",null,[]);Object(y.a)(u,"SetSessionInitOverrideCallbackParameters",null,[]);Object(y.a)(f,"SetULSLoggerParameters",null,[]);var wb=xb.a;vm(l,wb);l.getTypeName=function(){return"AugLoop_Excel_Session_Protocol_ExcelServerSessionExtensionConfig"};l.pe=function(){return[]};Object(y.a)(l,"ExcelServerSessionExtensionConfig",xb.a,[]);var E=b(1120),
Mb=b(335);n.Tki=function(db,Zb,Jb){if(n.BZb)return ob.ULS.sendTraceTag(537170369,0,15,"augloop: LoadAndInitializeAugLoopRuntimeManager called more than once"),n.BZb;var Ic=Tc.AFrameworkApplication.ga.Ua("AugLoopCloudALServiceUrl");if(!Ic||!Ic.length)return ob.ULS.sendTraceTag(537170368,0,15,"AugmentationLoopRuntimeProxy.LoadAndInitializeAugLoopRuntimeManager: AugLoopCloudALServiceUrl is null or empty"),Promise.reject(null);Jb=Mb.a(rc.a.loadScript(60,4,Jb,void 0,void 0,327));return hb.EwaSettings.isChangeGateEnabled("OfficeVSO:5873378_XLALDontRegisterRuntimeMoreThanOnce")?
(n.BZb=Jb.then(function(){var uc=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();n.S7e(db,Zb,uc);return Promise.resolve(uc)}).catch(function(uc){ob.ULS.sendTraceTag(537170339,0,10,"augloop: Failed to download script:"+uc);return Promise.reject(null)}),n.BZb):Jb.then(function(){var uc=augLoop.ALFactoryGlobal.getAugLoopRuntimeManager();n.S7e(db,Zb,uc);return Promise.resolve(uc)}).catch(function(uc){ob.ULS.sendTraceTag(529023136,0,10,"augloop: Failed to download script:"+uc);return Promise.reject(null)})};
n.S7e=function(db,Zb,Jb){ob.ULS.sendTraceTag(537170338,0,50,"augloop: Successfully loaded script");n.Pg||n.uhj(da.a.Ra);n.Tld=new Set;Jb.setIsFeatureEnabledCallback(Object.assign(new A,{featureEnabledCallback:function(uc){var za=Tc.AFrameworkApplication.ga.ra("AugLoop"+uc),pb=hb.EwaSettings.getBooleanFeatureGate(uc,!1),cc=hb.EwaSettings.getBooleanFeatureGate("AugLoop"+uc,!1),Ac=pb||cc,ad=za||Ac;n.Tld.has(uc)||(n.Tld.add(uc),ob.ULS.shipAssertTag(537170337,0,!(za&&!Ac),"AugmentationLoopRuntimeProxy.InitializeAugLoopRuntimeManager.isFeatureEnabled: legacy app setting return true for feature {0}, but feature gate return false. This is problem because app setting is depricated and about to be removed",
uc),ad&&ob.ULS.sendTraceTag(537170336,0,50,"AugmentationLoopRuntimeProxy.InitializeAugLoopRuntimeManager.isFeatureEnabled: feature {0} is enabled. legacyAppSettingResult: {1}, featureGateWithoutPrefix: {2}, featureGateWithPrefix: {3}",uc,za,pb,cc));return ad}}));if(hb.EwaSettings.la(449))if(Zb){var Ic=n.r9b(Zb);Ic=n.r9b(Zb,Tc.AFrameworkApplication.ga.Ua("AugloopACLPUserDataSignature"));Jb.setRequestAuthTokenCallback(Object.assign(new m,{requestAuthTokenCallback:Ic}))}else ob.ULS.sendTraceTag(537170335,
0,10,"Oauth manager is null");Jb.setULSLogger(Object.assign(new f,{ulsLogger:new ub.a}));Jb.setSendOTelEventCallback(Object.assign(new v,{sendOTelEvent:n.sendOTelEvent}));Zb="";hb.EwaSettings.la(451)&&(Zb+="AugmentationLoopObserverSession;");hb.EwaSettings.la(507)&&(Zb+="AugmentationLoopIncrementalUpdates;");hb.EwaSettings.la(457)&&(Zb+="EnterpriseDataTypeMipSupport;");if(hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TableLintExperiment",!1)||hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TableLintProdExperiment",
!1)||hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligence",!1)||hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.UnitTelemetryAL",!1))Zb+="LoadAdditionalDataToModel;";hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPane",!1)&&(Zb+="DataCleansingSlice0;LoadAdditionalDataToModel;");hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.AugloopNoLatency",!1)&&(Zb+="AugloopNoLatency;");hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableLintInvestigationTelemetry",
!1)&&(Zb+="TableLintInvestigationTelemetry;");hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TelemetryWorkflowIncludeTextHints",!1)&&(Zb+="TelemetryWorkflowIncludeTextHints;");hb.EwaSettings.isChangeGateEnabled("OfficeVSO:5951472_XLALRegisterCustomInitCallback")&&Jb.setInitSessionCallback({initSessionCallback:function(){var uc;if(null===(uc=null===db||void 0===db?void 0:db.fa)||void 0===uc?0:uc.sessionId)return ob.ULS.sendTraceTag(527708568,0,50,"AugmentationLoopRuntimeProxy.setInitSessionCallback: initSessionCallback called, sessionId is valid (length = "+
db.fa.sessionId.length+"), return resolved promise"),Promise.resolve();ob.ULS.sendTraceTag(527708567,0,50,"AugmentationLoopRuntimeProxy.setInitSessionCallback: initSessionCallback called, sessionId is not valid, return promise that will be resolved when session id will be valid again.");return new Promise(function(za){function pb(){var Ac;(null===(Ac=null===db||void 0===db?void 0:db.fa)||void 0===Ac?0:Ac.sessionId)?(ob.ULS.sendTraceTag(527708566,0,50,"AugmentationLoopRuntimeProxy.setInitSessionCallback: sessionId changed callback called with valid session id (length = "+
db.fa.sessionId.length+"), resolve the promise and unregister the callback."),db.fa.kk(pb),za()):ob.ULS.sendTraceTag(527708565,0,50,"AugmentationLoopRuntimeProxy.setInitSessionCallback: sessionId changed callback called, but the session id is not valid yet, keep waiting.")}var cc;null===(cc=null===db||void 0===db?void 0:db.fa)||void 0===cc?void 0:cc.Sj(pb)})}});Jb.setSessionInitOverrideCallback(Object.assign(new u,{handler:function(uc){uc.extensionConfigs=[Object.assign(new l,{cluster:db.ya.MachineCluster,
ecsId:n.SHh(db),restUrl:db.ya.RestActionUrl,ecsOperationUrl:"",workbookMetadataVersion:0,serverEventVersion:0,permissionFlags:0,configurations:0,collabUserListVersion:0,collabStateId:0,accessToken:db.ya.AccessToken,accessTokenTTL:db.ya.AccessTokenValidTo.toString()})];ob.ULS.sendTraceTag(537170334,0,50,"AugmentationLoopRuntimeProxy.InitializeAugLoopRuntimeManager: access token TTL "+db.ya.AccessTokenValidTo.toString());return uc}}));Jb.initialize(Object.assign(new t,{serviceUrl:Tc.AFrameworkApplication.ga.Ua("AugLoopCloudALServiceUrl"),
appName:"Excel",appVersion:Tc.AFrameworkApplication.ga.Ua("BuildVersion")||"",releaseAudienceGroup:Tc.AFrameworkApplication.Gb?Object(tb.a)(String,Tc.AFrameworkApplication.Gb.AudienceGroup)||"":"",releaseChannel:null,releaseFork:null,sessionId:db.ya.UserSessionId,initSession:!0,flights:Zb,uiLanguage:Tc.AFrameworkApplication.uiCulture,excelServer:null,sessionCreationOptions:Object.assign(new x,{onSessionClose:n.zNh(Jb)})}))};n.zNh=function(db){return function(Zb){var Jb=!fb.a.instance.GQ(Tc.AFrameworkApplication.qk);
Jb?Zb?Zb.reason?(Zb=Zb.reason,ob.ULS.shipAssertTag(537170333,0,!(void 0===Zb.isRetryableError||null===Zb.isRetryableError),"AugmentationLoopRuntimeProxy.GetOnCloseMessageCallback: closeReason.IsRetryableError is null"),Jb=(null==Zb.isRetryableError?!0:Zb.isRetryableError)&&Jb):ob.ULS.sendTraceTag(537170332,0,15,"AugmentationLoopRuntimeProxy.GetOnCloseMessageCallback: closeMessage.Reason is null"):ob.ULS.shipAssertTag(537170331,0,!1,"AugmentationLoopRuntimeProxy.GetOnCloseMessageCallback: - closeMessage is null"):
ob.ULS.sendTraceTag(537170330,0,15,"AugmentationLoopRuntimeProxy.GetOnCloseMessageCallback: access token has expired");ob.ULS.sendTraceTag(537170329,0,15,"AugmentationLoopRuntimeProxy.GetOnCloseMessageCallback: On close message callback is called. shouldRetry is set to {0}",Jb);Jb&&((!n.mLb||ya.a(n.Pg,n.mLb)>n.dJf)&&n.N9i(),n.zpc<n.Gtd?(n.zpc++,ob.ULS.sendTraceTag(537170328,0,50,"AugmentationLoopRuntimeProxy.GetOnCloseMessageCallback: Start new session attempt {0} of {1}. Time of first attempt in this iterval of reconnects: {2}",
n.zpc,n.Gtd,n.mLb)):(ob.ULS.sendTraceTag(537170327,0,15,"AugmentationLoopRuntimeProxy.GetOnCloseMessageCallback: Reached the limit of {0} attempts for session creation under interval of {1} Ms. Stop trying to reconnect. Time of first attempt in this iterval: {2}.",n.Gtd,n.dJf,n.mLb),Jb=!1));Jb?(db.startNewSession(),n.uyf()):n.Kwf()}};n.Pjj=function(db){n.Kwf=db};n.Hkj=function(db){n.uyf=db};n.uhj=function(db){n.Pg=db};n.N9i=function(){n.zpc=0;n.mLb=n.Pg.Kb};n.r9b=function(db,Zb){Zb=void 0===Zb?"":
Zb;return function(){try{return hb.EwaSettings.isChangeGateEnabled("OfficeVSO:5939271_XLALOAuthTokenLogs")&&ob.ULS.sendTraceTag(527970953,0,50,"AugmentationLoopRuntimeProxy.getAuthTokenDelegate: called with fallbackValue.length: "+Zb.length+"."),db.YR("AugLoop",Tc.AFrameworkApplication.ga.Ua("AugLoopOAuthResourceUriV2")).then(function(Jb){if(Jb.IsSuccess)return hb.EwaSettings.isChangeGateEnabled("OfficeVSO:5939271_XLALOAuthTokenLogs")&&ob.ULS.sendTraceTag(527970952,0,50,"AugmentationLoopRuntimeProxy.getAuthTokenDelegate: successfully fetch token."),
Jb.Token;ob.ULS.sendTraceTag(537170326,0,15,hb.EwaSettings.isChangeGateEnabled("OfficeVSO:5939271_XLALOAuthTokenLogs")?"AugmentationLoopRuntimeProxy.getAuthTokenDelegate: failed to get token, use fallback value (length: "+Zb.length+")":"AugmentationLoopRuntimeProxy.getAuthTokenDelegate: failed to get token, use fallback value");return Zb},function(){ob.ULS.sendTraceTag(537170325,0,15,"AugmentationLoopRuntimeProxy.getAuthTokenDelegate: got rejected promise, use fallback value");return Zb})}catch(Jb){return ob.ULS.sendTraceTag(537170324,
0,10,"Exception thrown when fetching token",Jb),Promise.resolve(Zb)}}};n.sendOTelEvent=function(db){Ta.a.sendOtelEvent(Object.assign(new E.a,{otelEvent:db}))};n.SHh=function(db){db=hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.XLALReadMetadataFromUserEcsSession",!1)?String.format("cluster={0}&session={1}&usid={2}",db.ya.MachineCluster,eb.a.pf(db.fa.sessionId),db.ya.UserSessionId):"";hb.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.XLALReadMetadataFromUserEcsSession",!1)&&
hb.EwaSettings.isChangeGateEnabled("OfficeVSO:5897059_XLALInvestigateIncorrectSessionId")&&ob.ULS.sendTraceTag(528348230,0,50,"AugmentationLoopRuntimeProxy.getEcsSessionId: ecsSessionId length is "+db.length);return db};n.Gtd=3;n.dJf=3E5;n.zpc=0;n.mLb=null;n.Pg=null;n.BZb=null;n.uyf=null;n.Kwf=null;n.Tld=null;Object(y.a)(n,"AugmentationLoopRuntimeProxy",null,[]);var ka=b(56),bb=b(35),Ga=b(178),Ha;(function(db){db.newAnnotation="New";db.validAnnotation="Valid";db.invalidAnnotation="Invalid"})(Ha||
(Ha={}));Object(y.b)("AnnotationCallbackType",Ha);var Ua=Xa.a;vm(k,Ua);k.prototype.dispose=function(){ob.ULS.sendTraceTag(526766675,0,50,"AugmentationLoopAnnotationValidator.dispose: "+this.getStatus());this.avf.clear();this.Pii.clear();this.Pff.clear();Ua.prototype.dispose.call(this)};k.prototype.bT=function(db,Zb){this.addHandler(this.klf(db,Zb),void 0)};k.prototype.MFb=function(db,Zb){this.removeHandler(this.klf(db,Zb),void 0)};k.prototype.klf=function(db,Zb){return db+"_"+Zb};k.prototype.getStatus=
function(){var db,Zb,Jb=Ma(this.ORj),Ic=null===(db=this.Pff)||void 0===db?void 0:db.size;db=null===(Zb=this.avf)||void 0===Zb?void 0:Zb.size;return"current coauth version: "+Jb+", "+Ic+" known annotations, "+db+" coauth versions on hold"};Object(y.a)(k,"AugmentationLoopAnnotationValidator",Xa.a,[320]);var kb=D.a;vm(c,kb);c.prototype.create=function(){var db=this,Zb=Date.now();Cb.Health.instance.recordKpiUsageForAlertableKpi("AugmentationLoopManagerCreation","xlalint",null);ob.ULS.sendTraceTag(537170371,
0,50,"AugmentationLoopManager.Create called");var Jb=null,Ic=[];hb.EwaSettings.la(449)&&(Jb=ka.GetServiceTaskFactory.Xa(this.$.da,349,350,this.tb),Ic.push(Jb));bb.TaskExtensions.Ba(bb.TaskExtensions.ve(Ic,this.ma,3),function(){n.Tki(db.$,Jb?Jb.result:null,db.tb).then(function(uc){ob.ULS.sendTraceTag(537170370,0,50,"Augmentation Loop runtime initialized");try{var za=new k(db.$.ya.AugmentationLoopAnnotationExpirationTimeoutInMs);db.Fb(db.augmentationLoopManager||(db.augmentationLoopManager=new z(db.$,
uc,za)));n.Hkj(db.augmentationLoopManager.kJi);n.Pjj(db.augmentationLoopManager.sHi)}catch(pb){Cb.Health.instance.recordKpiFailure("AugmentationLoopManagerCreation","Exception",!1,!0,Object.assign(new Ga.a,{extendedProperties:new Map,durationMs:Date.now()-Zb})),db.Fb(null),ob.ULS.sendTraceTag(42796228,0,10,String.format("Augmentation loop initialization failed. Exception {0}",pb.message))}}).catch(function(){Cb.Health.instance.recordKpiFailure("AugmentationLoopManagerCreation","PromiseRejected",!1,
!0,Object.assign(new Ga.a,{extendedProperties:new Map,durationMs:Date.now()-Zb}));db.Fb(null);ob.ULS.sendTraceTag(42796229,0,10,"Augmentation loop initialization failed")})},this.$.ma,3)};c.ja=function(db){db.da.Ha(327,new c(db))};Object(y.a)(c,"AugmentationLoopManagerFactory",D.a,[]);var $a=b(10),Xb=b(817),dc=b(1249),Za=Xb.a;vm(d,Za);d.prototype.Md=function(){var db=this;ob.ULS.sendTraceTag(528758224,0,50,"FormulaByExampleCommandHandlerFactory.CreateCommandHandlersAsync: FormulaByExampleCommandHandler init flow started.");
var Zb=ka.GetServiceTaskFactory.Xa(this.$.da,453,454,1),Jb=ka.GetServiceTaskFactory.Xa(this.$.da,266,265,1);bb.TaskExtensions.Ba(bb.TaskExtensions.ve([Zb,Jb],this.ma),function(){var Ic=db.$.da.Aa(328);db.Ed([new dc.a(db.$,Ic,Jb.result,Zb.result)]);ob.ULS.sendTraceTag(537161924,0,50,"FormulaByExampleCommandHandlerFactory.CreateCommandHandlersAsync: FormulaByExampleCommandHandler initialized successfully")},this.ma)};d.ja=function(db){Xb.a.de(455,new d(db))};Object(y.a)(d,"FormulaByExampleCommandHandlerFactory",
Xb.a,[]);var Wa=b(1240),Ba=D.a;vm(a,Ba);a.prototype.create=function(){var db=this;ob.ULS.sendTraceTag(528758214,0,50,"FormulaByExampleManagerFactory.Create: starting service creation flow.");var Zb=ka.GetServiceTaskFactory.Xa(this.$.da,328,327,1),Jb=ka.GetServiceTaskFactory.Xa(this.$.da,266,265,1);bb.TaskExtensions.Ba(bb.TaskExtensions.ve([Zb,Jb],this.ma),function(){ob.ULS.sendTraceTag(528758213,0,50,"FormulaByExampleManagerFactory.Create: augmentationLoopManager and calcManager creation tasks resolved.");
db.Fb(db.$.da.Aa(453)||db.$.da.Ha(453,new Wa.a(db.$,Zb.result,Jb.result)));ob.ULS.sendTraceTag(537161882,0,50,"FormulaByExampleManagerFactory.Create: FormulaByExampleManager initialized successfully")},this.ma)};a.ja=function(db){db.da.Ha(454,new a(db))};Object(y.a)(a,"FormulaByExampleManagerFactory",D.a,[]);Type.registerNamespace("_Ewa");(function(){$a.a.Ga(function(db){c.ja(db)})})();(function(){$a.a.Ga(function(db){a.ja(db);d.ja(db)})})()},960:function(y,D,b){function a(t){var z=this;this.nextId=
1;this.v8b=new Set;this.o6f=0;this.qd=function(){var r=z.v8b.size;0!=r&&z.$.sendBeaconTraceTag(526984790,50,!1,"some pending FBE flows were not resolved by workbook closure. Total flows amount in sessions: {0}, Unresolved flows amount: {1}, pending flows: {2}",z.o6f,r,[].concat(Fl(z.v8b)).join(","))};this.$=t;this.$.Vl(this.qd)}function d(t,z,r){window.performance.measure(t,z,r);var G=window.performance.getEntriesByName(t);if(G[G.length-1])return z=G[G.length-1].duration,performance.clearMeasures(t),
z;A.ULS.sendTraceTag(526984791,0,15,"FormulaByExampleTelemetryGenerator.measureTime: could not find performance entry for measure: {0}, startMark: {1}, endMark: {2}",t,z,r);return-1}function c(t,z,r){return t+"_"+(z+(r?"_cached":""))}function k(){return v.HelperMethods.MWc&&m.a.Snb}function n(t,z){try{var r={};return r.UserInPreviewDuration=d("FBE_InputToPreviewRemovedWithCSE_"+z+"_"+t,c(x.PreviewRendered,z,t),c(x.UserInputArrived,z,t)),r.InputToPreviewRemovedWithCSE=d("FBE_InputToPreviewRemovedWithCSE_"+
z+"_"+t,c(x.UserInputArrived,z,t),c(x.PreviewRemovedWithCSE,z,t)),r}catch(G){A.ULS.sendTraceTag(529109765,0,10,"FormulaByExampleTelemetryGenerator.getPreviewRemovedDurations: Error thrown : {0}",G.message)}}function l(t,z){try{var r={};return r.EditCommitToSignal=d("FBE_EditCommitToSignal_"+z+"_"+t,c(x.EditCommit,z,!1),c(x.SignalSent,z,!1)),r.WorkflowAndNetworkTime=t?0:d("FBE_WorkflowAndNetworkTime_"+z+"_"+t,c(x.SignalSent,z,!1),c(x.AnnotationReceived,z,!1)),r.Calculation=d("FBE_Calculation_"+z+"_"+
t,c(x.CalculationStart,z,t),c(x.CalculationEnd,z,t)),r.ModelUpdate=d("FBE_ModelUpdate_"+z+"_"+t,c(x.CalculationEnd,z,t),c(x.ModelUpdated,z,t)),r.PreviewRender=d("FBE_PreviewRendered_"+z+"_"+t,c(x.ModelUpdated,z,t),c(x.PreviewRendered,z,t)),r.Total=d("FBE_Total_"+z+"_"+t,c(x.EditCommit,z,!1),c(x.PreviewRendered,z,t)),r}catch(G){A.ULS.sendTraceTag(529109766,0,10,"FormulaByExampleTelemetryGenerator.getPreviewShownDurations: Error thrown : {0}",G.message)}}function f(t){for(var z in x)try{window.performance.clearMarks(c(z,
t,!1)),window.performance.clearMarks(c(z,t,!0))}catch(r){A.ULS.sendTraceTag(527005662,0,10,"FormulaByExampleTelemetryGenerator.clearPerformanceFlowMarks: Error thrown : {0}",r.message)}}function u(t,z,r){try{var G=c(t,z,r);window.performance.mark(G)}catch(w){A.ULS.sendTraceTag(529109767,0,10,"FormulaByExampleTelemetryGenerator.markPerformancePoint: Error thrown : {0}",w.message)}}b.d(D,"f",function(){return u});b.d(D,"c",function(){return f});b.d(D,"e",function(){return l});b.d(D,"d",function(){return n});
b.d(D,"b",function(){return k});b.d(D,"a",function(){return a});y=b(0);var v=b(8),m=b(315),A=b(13),x;(function(t){t.EditCommit="EDITCOMMIT";t.SignalSent="SIGNALSENT";t.AnnotationReceived="ANNOTATIONRECEIVED";t.CalculationStart="CALCULATIONSTART";t.CalculationEnd="CALCULATIONED";t.ModelUpdated="MODELUPDATED";t.PreviewRendered="PREVIEWRENDERED";t.UserInputArrived="USERINPUTARRIVED";t.PreviewRemovedWithCSE="PREVIEWREMOVEDWITHCSE"})(x||(x={}));Object(y.b)("FormulaByExampleFlowMarks",x);a.getInstance=
function(t){a.instance||(a.instance=new a(t));return a.instance};a.prototype.WMh=function(){return this.nextId++};a.prototype.wij=function(t){this.v8b.add(t);this.o6f++};a.prototype.xij=function(t){this.v8b.delete(t)};Object(y.a)(a,"FormulaByExampleFlowTracker",null,[])}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.augmentationloop.js.map/04c8902302d98f9df1839d29c8e9ac4e/EwaDS.augmentationloop.js.map