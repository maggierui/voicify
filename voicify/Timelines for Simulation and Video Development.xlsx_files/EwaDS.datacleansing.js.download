/*
 *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
*****************************************************************************/
function zm(){this.ryb=!1;this.BBa=null;this.VXd=void 0;this.L7a=1;this.kQe=this.TQg=0;this.llb=null}function Am(y){if(y.ryb)throw new TypeError("Generator is already running");y.ryb=!0}zm.prototype.lBb=function(y){this.VXd=y};zm.prototype.jLb=function(y){this.llb={mg:y,nai:!0};this.L7a=this.TQg||this.kQe};zm.prototype.return=function(y){this.llb={return:y};this.L7a=this.kQe};zm.prototype.ioa=function(y,D){this.L7a=D;return{value:y}};function Bm(y){this.jq=new zm;this.nVi=y}
Bm.prototype.lBb=function(y){Am(this.jq);if(this.jq.BBa)return Cm(this,this.jq.BBa.next,y,this.jq.lBb);this.jq.lBb(y);return Dm(this)};function Em(y,D){Am(y.jq);var b=y.jq.BBa;if(b)return Cm(y,"return"in b?b["return"]:function(a){return{value:a,done:!0}},D,y.jq.return);y.jq.return(D);return Dm(y)}Bm.prototype.jLb=function(y){Am(this.jq);if(this.jq.BBa)return Cm(this,this.jq.BBa["throw"],y,this.jq.lBb);this.jq.jLb(y);return Dm(this)};
function Cm(y,D,b,a){try{var d=D.call(y.jq.BBa,b);if(!(d instanceof Object))throw new TypeError("Iterator result "+d+" is not an object");if(!d.done)return y.jq.ryb=!1,d;var c=d.value}catch(k){return y.jq.BBa=null,y.jq.jLb(k),Dm(y)}y.jq.BBa=null;a.call(y.jq,c);return Dm(y)}
function Dm(y){for(;y.jq.L7a;)try{var D=y.nVi(y.jq);if(D)return y.jq.ryb=!1,{value:D.value,done:!1}}catch(b){y.jq.VXd=void 0,y.jq.jLb(b)}y.jq.ryb=!1;if(y.jq.llb){D=y.jq.llb;y.jq.llb=null;if(D.nai)throw D.mg;return{value:D.return,done:!0}}return{value:void 0,done:!0}}function Fm(y){this.next=function(D){return y.lBb(D)};this.throw=function(D){return y.jLb(D)};this.return=function(D){return Em(y,D)};this[Symbol.iterator]=function(){return this}}
function Gm(y,D){D=new Fm(new Bm(D));um&&y.prototype&&um(D,y.prototype);return D}
(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[31],{1387:function(y,D,b){function a(jc){var Zc=we.call(this)||this;Zc.$=jc;Zc.dc();return Zc}function d(jc){this.tableIntelligenceManager=jc;this.tableIntelligenceManager.TXb(function(Zc,ud){E.ULS.sendTraceTag(526979921,0,15,"Received annotation with "+ud.ypc.interpretations.count+" interpretations")})}function c(jc){var Zc=le.call(this)||this;Zc.$=jc;Zc.dc();return Zc}function k(jc,Zc){var ud=$c.call(this)||this;ud.eaf=!1;
ud.faf=!1;ud.dOe=function(Fd,me){if(1===me.operationType)if(Fd=me.bY){E.ULS.sendTraceTag(537151251,306,50,String.format("TableIntelligenceManager::ExcelRangeMetadataHandler called for requestID = {0}",Fd.requestId));me=A(Fd);var $e=ud.NPd.Ec(Fd.requestId);var Df=$e.value;$e.returnValue?(ud.NPd.remove(Fd.requestId),Df(me)):E.ULS.sendTraceTag(537151250,306,10,String.format("TableIntelligenceManager::ExcelRangeMetadataHandler Callback not found for requestId = {0}",Fd.requestId))}else E.ULS.sendTraceTag(537151252,
306,10,"TableIntelligenceManager::ExcelRangeMetadataHandler excelRangeMetadata is null.")};ud.Gie=function(Fd,me){1===me.operationType&&((Fd=me.bY)?(Fd=A(Fd),ud.raiseEvent("RecognizedTableUpdate",new r(Fd))):E.ULS.sendTraceTag(537151249,306,10,"TableIntelligenceManager::GetRange ExcelRecognizedTable is null."))};ud.augmentationLoopManager=jc;ud.$=Zc;Tc.EwaSettings.isChangeGateEnabled("OfficeVSO:590343_RemoveFeatureActivationForTableIntelligence")||ud.a0i();ud.NPd=new Sc.a;return ud}function n(){this.worksheetId=
null;this.bottom=this.right=this.top=this.left=0}function l(){var jc=Oc.call(this)||this;jc.range=null;jc.cells=null;jc.requestId=null;jc.H_=Object.assign(new Ad.a,{T_:l.getTypeName(),B_:l.pe()});return jc}function f(){var jc=cb.call(this)||this;jc.value=null;jc.type=0;jc.H_=Object.assign(new Ad.a,{T_:f.getTypeName(),B_:f.pe()});return jc}function u(){var jc=v.call(this)||this;jc.requestId=null;jc.H_=Object.assign(new Ad.a,{T_:u.getTypeName(),B_:u.pe()});return jc}function v(){var jc=Bc.call(this)||
this;jc.range=null;jc.interpretations=null;jc.tableName=null;jc.H_=Object.assign(new Ad.a,{T_:v.getTypeName(),B_:v.pe()});return jc}function m(jc){return new uc.Range(jc.top,jc.left,jc.bottom,jc.right,!1,!1)}function A(jc){var Zc=new od.a(m(jc.range),jc.range.worksheetId);var ud=jc.interpretations,Fd=new Yf.a;if(ud&&ud.length){ud=yl(ud);for(var me=ud.next();!me.done;me=ud.next()){var $e=me.value;b:switch($e.orientation.toLowerCase()){case "columnmajor":me=2;break b;case "rowmajor":me=1;break b;default:E.ULS.sendTraceTag(537151256,
0,50,"Invalid value for table orientaion."),me=0}if(me){var Df=m($e.location),gg=$e.confidence,og=$e.headerRowCount,dg=$e.headerColumnCount;var af=$e.fields;$e=new Yf.a;if(af){af=yl(af);for(var rg=af.next();!rg.done;rg=af.next()){var cg=rg.value;rg=$e;var Ie=rg.add;c:{var Ng=cg.classification;switch(Ng.toLowerCase()){case "dimension":Ng=1;break c;case "measure":Ng=2;break c;default:E.ULS.sendTraceTag(537151255,0,50,"Invalid value %s for field classification.",Ng),Ng=0}}var Zf=cg.aggregations;var ng=
new Yf.a;if(Zf){Zf=yl(Zf);for(var Ff=Zf.next();!Ff.done;Ff=Zf.next())switch(Ff.value.toLowerCase()){case "sum":ng.add(0);break;case "count":ng.add(1);break;case "average":ng.add(2);break;case "min":ng.add(3);break;case "max":ng.add(4);break;case "distinctcount":ng.add(5);break;case "stddev":ng.add(6);break;case "variance":ng.add(7);break;default:E.ULS.sendTraceTag(537151254,0,50,"Invalid value for aggregation type.")}}Zf=cg.headerReferences;cg=new Yf.a;if(Zf)for(Zf=yl(Zf),Ff=Zf.next();!Ff.done;Ff=
Zf.next())Ff=Ff.value,Ff=new uc.Range(Ff.top,Ff.left,Ff.top,Ff.left,!1,!1),cg.add(Ff);Ie.call(rg,new t(Ng,ng,cg))}}me=new x(Df,gg,og,dg,me,$e);Fd.add(me)}else E.ULS.sendTraceTag(537151257,0,50,"Invalid value for table orientaion. Skipping current interpretation.")}}return new z(Zc,Fd,jc.tableName)}function x(jc,Zc,ud,Fd,me,$e){this.xna=jc;this.confidence=Zc;this.headerRowCount=ud;this.headerColumnCount=Fd;this.orientation=me;this.fields=$e}function t(jc,Zc,ud){this.classification=jc;this.aggregations=
Zc;this.headerReferences=ud}function z(jc,Zc,ud){this.FD=jc;this.interpretations=Zc;this.tableName=ud}function r(jc){var Zc=Jc.call(this)||this;Zc.ypc=jc;return Zc}function G(jc){var Zc=vd.call(this)||this;Zc.$=jc;Zc.dc();return Zc}function w(){return fd.call(this)||this}function B(jc){var Zc=gc.call(this)||this;Zc.$=jc;Zc.dc();return Zc}function U(jc,Zc,ud,Fd){var me=this;Fd=void 0===Fd?null:Fd;this.Olf=Tc.EwaSettings.getIntFeatureGate("Microsoft.Office.ExcelOnline.MaxPivotTableHandRaiseCount",1);
this.mR=this.Nh=this.t9=this.GMa=null;this.HMa=!1;this.ZXh=function(Df,gg){E.ULS.sendTraceTag(537154647,306,50,"PivotTableHandRaiseManager:HandlePivotTableActivationCallback HandlePivotTableActivationCallback invoked.");if(!gg)return E.ULS.sendTraceTag(537154646,306,10,"PivotTableHandRaiseManager:HandlePivotTableActivationCallback surveyParams is null."),null;if(!gg.contextInfo||!gg.contextInfo.length||1<gg.contextInfo.length)return E.ULS.sendTraceTag(537154645,306,10,"PivotTableHandRaiseManager:HandlePivotTableActivationCallback no valid contextInfo in surveyParams."),
null;me.sPd(gg.contextInfo[0].context);return null};this.u$a=function(Df,gg){me.Uzc(gg.ypc)};this.kd=function(Df,gg){gg&&gg.wef||(Xd.g(me.$).ha.mF(me.kd),Tc.EwaSettings.isChangeGateEnabled("OfficeVSO:5989759_PTPSCardUX")?(E.ULS.sendTraceTag(526984154,306,50,"PivotTableProactiveSuggestion: selection changed, hide hand raise card"),me.mR.hide()):me.Nh.hide())};this.$=jc;this.tableIntelligenceManager=Zc;this.Xla=new Yf.a;this.svgIconProvider=Fd;this.Cha=ud;this.$8d=this.F1d=0;this.Nh=new N(this.$,ud,
Fd);this.mR=new R(this.$);var $e=Tc.EwaSettings.isChangeGateEnabled("OfficeVSO:6003612_PTPSFixLicenseCheck")?"ExcelIdeasPivotTableHandRaise":"PivotTableHandRaise";Za.a.instance.mc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Df){me.t9=Df;Df.isFeatureEnabled($e,!1).then(function(gg){return me.HMa=gg});me.GMa=Df.Vya($e,function(gg){me.HMa=gg.isEnabled})});(jc=Za.a.instance.mc("Common.ISystemInitiatedFeedback"))&&jc.execute(function(Df){Df.Mpc("PivotTableHandRaiseSurface",
me.ZXh)});this.ak()}function N(jc,Zc,ud){var Fd=De.call(this)||this;Fd.FWb=null;Fd.NM=!1;Fd.OZ=!1;Fd.Aid=!1;Fd.isVisible=!1;Fd.C9a=null;Fd.Rba=function(me,$e){$e?Fd.lcb():Fd.mcc()};Fd.onKeyUp=function(me){var $e=me.$r;me=me.Ea;switch(me.keyCode){case 27:return Fd.NM?(Fd.mcc(),Fd.Uca($e),!0):!1;case 121:return me.altKey&&me.shiftKey?(Fd.NM?(Fd.mcc(),Fd.Uca($e)):(Fd.lcb(),Fd.BIb($e)),!0):!1;case 17:return Fd.OZ||Fd.Aid?!1:(Fd.Aid=!0,window.setTimeout(function(){Fd.Aid=!1},30),Fd.NM?(Fd.mcc(),Fd.Uca($e)):
(Fd.lcb(),Fd.BIb($e)),!0);default:return!1}};Fd.onKeyDown=function(me){me=me.Ea;Fd.OZ=me.ctrlKey&&17!==me.keyCode;return 13===me.keyCode&&Fd.NM?(Fd.FBf(),!0):!1};Fd.$=jc;Fd.xp=Zc.V2b(jc,ud,function(){Fd.FBf()},"","","","PivotTableHandRaisePointerDown",Ua.a.instance.ea(1769));return Fd}function P(jc,Zc){this.text=this.cardViewManager=null;this.$=jc;this.Tn=Zc}function ia(jc){var Zc=Qc.call(this)||this;Zc.$=jc;Zc.dc();return Zc}function W(jc,Zc){var ud=this;this.t9=this.GMa=this.mR=null;this.HMa=!1;
this.NYh=function(Fd,me){E.ULS.sendTraceTag(527983895,306,50,"IntelligentMetadataOverlayManager:handleSmartViewActivationCallback handleSmartViewActivationCallback invoked.");if(!me)return E.ULS.sendTraceTag(527983894,306,10,"IntelligentMetadataOverlayManager:handleSmartViewActivationCallback surveyParams is null."),null;if(!me.contextInfo||!me.contextInfo.length||1<me.contextInfo.length)return E.ULS.sendTraceTag(527983893,306,10,"IntelligentMetadataOverlayManager:handleSmartViewActivationCallback no valid contextInfo in surveyParams."),
null;ud.SYe(me.contextInfo[0].context);return null};this.u$a=function(Fd,me){ud.Uzc(me.ypc)};this.QAf=function(){ud.xid();ud.$.fa.jNf(ud.QAf)};this.Yh=function(){ud.c$f()};this.Sh=function(){ud.TAa()};this.t0f=function(Fd){var me=ud.grid.ha.va.oV,$e=ud.grid.ha.va.activeCell;if($e=me?ud.grid.sc($e):ud.grid.sc(Fd.bottomRight))ud.q4f=ud.grid.getCellBounds($e.cell,!0);$e=[{key:"learnMessage",text:Ua.a.instance.Va(702),Vc:ud.DNi}];me=me?4:13;ud.mR.show(Fd,Ua.a.instance.Va(696),Ua.a.instance.Va(697),Ua.a.instance.Va(698),
Ua.a.instance.Va(699),ud.FZg,ud.xid,$e,function(){ud.Rba(!0)},function(){ud.Rba(!1)},"TableDesignIdeas",me,5,ud.q4f,ud.onDismiss)};this.DNi=function(){var Fd=new bc.a(-859308420,Ba.a.Wb,ud.$.ed,9,null),me={};me=(me[Ba.a.Kg]="HelpID=22118",me.InputMethod=Ba.a.Wb,me.ShouldCanvasTakeFocus=!0,me[Ba.a.hd]=Yd.a.XU,me[Yd.a.Ana]=!0,me);ud.$.Ka.Zb(Fd,me)};this.xid=function(){"Paste"==ud.dataFields.LaunchSource?(ud.P6e=ud.MNa.FD,ud.z$f()):(ud.Q6e.add(ud.KRc.FD),ud.TAa());rf.b(ud.$).ae(vg.a.Ivj,ud.dataFields,
{},!0)};this.FZg=function(){var Fd=db.v("Paste"==ud.dataFields.LaunchSource?ud.uOb.xna:ud.ofb.xna,ud.$);E.ULS.sendTraceTag(537155670,0,50,"Create table initiated for XLIM OOUI");ud.$.Ce(71074531,Ba.a.Wb,9,{TableRange:Fd,HasHeader:!0}).continueWith(function(me){Af.b(me)&&me.result?E.ULS.sendTraceTag(537155669,0,50,"Create table completed for XLIM OOUI"):E.ULS.sendTraceTag(537155668,0,10,"Create table failed for XLIM OOUI");ud.xid()})};this.onDismiss=function(){E.ULS.sendTraceTag(0,0,100,"Table Invitation Dismissed")};
this.nCb=function(){ud.Jaf()&&(ud.getMetadata(ud.n3c),ud.n3c=null,ud.grid.MGd(ud.nCb))};this.$=jc;this.tableIntelligenceManager=Zc;this.Xla=new Yf.a;this.uOb=this.ofb=this.KRc=this.MNa=null;this.Ecc=!1;this.Q6e=new Yf.a;this.P6e=null;jc={};this.dataFields=(jc.LaunchSource="Default",jc);this.q4f=this.n3c=null;this.mR=new R(this.$);this.grid=Xd.g(this.$);Za.a.instance.mc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Fd){ud.t9=Fd;Fd.isFeatureEnabled("TableHandRaise",
!1).then(function(me){return ud.HMa=me});ud.GMa=Fd.Vya("TableHandRaise",function(me){ud.HMa=me.isEnabled})});(jc=Za.a.instance.mc("Common.ISystemInitiatedFeedback"))&&jc.execute(function(Fd){Fd.Mpc("SmartViewSuggestion",ud.NYh)});Tc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.EnableExcelAugLoopMetadata",!1)&&this.ak()}function R(jc){var Zc=Rc.call(this,document.createElement("div"))||this;Zc.isMac=sc.a.isMac;Zc.onKeyUp=function(ud){ud=ud.Ea;switch(ud.keyCode){case 121:return ud.altKey&&
ud.shiftKey?(Zc.focus(),!0):!1;default:return!1}};Zc.$=jc;Zc.grid=Xd.g(jc);Zc.FCd=null;return Zc}function I(jc){var Zc=Of.call(this)||this;Zc.$=jc;Zc.dc();return Zc}function Q(jc,Zc){var ud=Lf.call(this,document.createElement("div"))||this;ud.ep=!1;ud.ke=null;ud.Ywe=null;ud.nr=0;ud.Zj=function(){ud.Lf(!1);ud.raiseEvent("DCTPC");return!0};ud.$=jc;ud.taskPaneManager=Zc;ud.e3h();rd.a(jc).Tg(ud);return ud}function O(){}function ba(jc){var Zc=gb.call(this)||this;Zc.$=jc;Zc.dc();return Zc}function ca(jc,
Zc,ud){var Fd=wc.call(this)||this;Fd.YVc=[43];Fd.YC=null;Fd.hSd=null;Fd.kd=function(){Fd.W4c()};Fd.Nx=function(){Fd.Y3a();for(var me=yl(Fd.suggestions.czj),$e=me.next();!$e.done;$e=me.next())$e=$e.value,Fd.suggestions.TWf(2,$e),Fd.raiseEvent("osscek",new S($e,Fd.suggestions.Qed($e)))};Fd.$=ud;Fd.augmentationLoopManager=jc;Fd.hi=Zc;Fd.suggestions=new ma(ud);Fd.f6a=!1;Fd.Osa=Fd.augmentationLoopManager?0:2;Fd.$.fa.ED(Fd.Nx);return Fd}function S(jc,Zc){var ud=oc.call(this)||this;ud.sheetId=jc;ud.f7=Zc;
return ud}function Y(jc,Zc,ud,Fd){var me=this;this.yga=!1;this.d4f=function($e,Df){if($e=Df.bY)switch(Df.operationType){case 1:case 2:me.dataCleansingManager.KMd($e.worksheetId,$e.tableName,me.kCe($e));break;case 3:me.dataCleansingManager.vGd($e.worksheetId,$e.tableName,me.kCe($e)[0]);break;default:E.ULS.sendTraceTag(537163396,306,15,"TableLintManager.TableLintColumnAnnotationHandler Received unexpected OperationType:{0}",Df.operationType)}else E.ULS.sendTraceTag(537163397,306,50,"TableLintManager.TableLintColumnAnnotationHandler TableLintColumnAnnotationntAnnotation is null.")};
this.e4f=function($e,Df){if($e=Df.bY)switch(Df.operationType){case 1:case 2:me.dataCleansingManager.Ilj($e.worksheetId);break;case 3:break;default:E.ULS.sendTraceTag(537163394,306,15,"TableLintManager.TableLintAnnotationHandler Received unexpected OperationType:{0}",Df.operationType)}else E.ULS.sendTraceTag(537163395,306,50,"TableLintManager.TableLintWorksheetAggregateAnnotationHandler TableLintWorksheetAggregateAnnotation is null.")};this.fAj=function($e,Df){E.ULS.sendTraceTag(537163393,306,50,"TableLintManager.TableLintColumnAnnotationStateUpdateHandler Received state update: {0}->{1}",
$e,Df)};this.dataCleansingManager=jc;this.augmentationLoopManager=ud;this.$=Fd;this.hi=Zc}function na(){var jc=Ce.call(this)||this;jc.worksheetId=null;jc.suggestionsCount=0;jc.H_=Object.assign(new Ad.a,{T_:na.getTypeName(),B_:na.pe()});return jc}function Z(){var jc=Pd.call(this)||this;jc.worksheetId=null;jc.worksheetName=null;jc.tableName=null;jc.tableRange=null;jc.tableIdentifier=null;jc.columnTitle=null;jc.columnName=null;jc.columnIdentifier=null;jc.suggestions=null;jc.investigationTelemetry=null;
jc.H_=Object.assign(new Ad.a,{T_:Z.getTypeName(),B_:Z.pe()});return jc}function wa(jc,Zc,ud,Fd){this.tableName=jc;this.columnName=Zc;this.columnTitle=ud;this.tableRange=Fd}function ma(jc){var Zc=Vd.call(this)||this;Zc.eF=new Map;Zc.lNa=new Map;Zc.TYb=new Map;Zc.WJc=null;Zc.f7=new Map;Zc.$=jc;return Zc}function pa(jc,Zc,ud,Fd){jc=Fd();jc.MRi(Zc,ud);return jc}function Ia(jc,Zc,ud,Fd){try{switch(ud.type){case "TextInconsistency":return pa(jc,ud,Fd,function(){return new Ma(jc)});case "ExtraSpaces":return pa(jc,
ud,Fd,function(){return new da(jc)});case "NumberFormattingInconsistency":return pa(jc,ud,Fd,function(){return new Xa(jc,Zc)});default:return E.ULS.sendTraceTag(537163424,0,10,"DataCleansingEwaSuggestionFactory.CreateFromTableLintSuggestion: suggestion type is not supported - "+ud.type),null}}catch(me){return E.ULS.sendTraceTag(537163423,0,10,"DataCleansingEwaSuggestionFactory.CreateFromTableLintSuggestion: exception thrown"),null}}function Ma(jc,Zc){return ta.call(this,jc,void 0===Zc?null:Zc)||this}
function ob(){this.ranges=this.value=null;this.isSelected=!1}function Cb(){var jc=hb.call(this)||this;jc.suggestedValue=null;jc.replacementValue=null;jc.variations=null;jc.normalizedValue=null;return jc}function Xa(jc,Zc,ud,Fd){Fd=void 0===Fd?null:Fd;jc=ta.call(this,jc,void 0===ud?null:ud)||this;jc.reb=null;Fd&&(jc.reb=Fd.reb);jc.hi=Zc;return jc}function Sb(){var jc=hb.call(this)||this;jc.suggestedFormat=null;jc.replacementFormat=null;jc.formats=null;jc.variationsType=null;jc.isMixedNumberText=null;
return jc}function Tb(){this.isApplicable=this.ranges=this.value=null}function da(jc,Zc){return ta.call(this,jc,void 0===Zc?null:Zc)||this}function ya(){var jc=hb.call(this)||this;jc.extraSpacesType=0;jc.ranges=null;return jc}function hb(){this.id=null;this.type=0;this.columnName=this.columnIdentifier=this.suggestionRange=this.suggestionRangeStringRef=this.tableIdentifier=this.tableRange=this.tableName=null}function Gb(jc,Zc,ud,Fd,me,$e,Df,gg){gg=jc.Oa(9,void 0===gg?null:gg);gg.ranges=Zc;gg.trimWhitespaceType=
ud;return ad.i(jc,"TrimWhitespace",gg,Fd,me,$e,Df,0)}function Qb(jc){return Object.assign(new Fb,{left:jc.left,right:jc.right,top:jc.top,bottom:jc.bottom})}function Fb(){this.bottom=this.top=this.right=this.left=0}function ta(jc,Zc){Zc=void 0===Zc?null:Zc;this.rra=new Ic.a;this.IPc=this.uMc=null;this.vb=jc;Zc&&(this.uMc=Zc,this.IPc=xa(Zc.suggestionRange,!0))}function xa(jc,Zc){jc=new uc.Range(jc.top,jc.left,jc.bottom,jc.right,!1,Zc);if(Zc&&(1>jc.top||jc.top>jc.maxRows||1>jc.bottom||jc.bottom>jc.maxRows||
jc.top>jc.bottom||1>jc.left||jc.left>jc.maxColumns||1>jc.right||jc.right>jc.maxColumns||jc.left>jc.right))throw E.ULS.sendTraceTag(537163357,0,10,"DataCleansingOouiAdapter.ValidateRange: range is invalid"),Error.argument("DataCleansingOouiAdapter.ValidateRange: range is invalid");return jc}function sa(jc,Zc,ud){this.suggestions=jc;this.f4f=Zc;this.YC=ud}function lb(jc){return Xb.call(this,jc)||this}function Yb(jc){var Zc=this;this.dU=this.O6a=null;this.Nvf=function(){Zc.hideTaskPane()};this.Ovf=function(){Zc.RA()};
this.Pvf=function(){Zc.Mx()};this.eAf=function(){Zc.updateTaskPane()};this.onSuggestionApplied=function(ud){ud&&Zc.qrj(ud)};this.Pmc=function(){Zc.rhd()};this.Tba=function(){Zc.SYb&&Zc.rhd();Zc.updateTaskPane()};this.Yh=function(){Zc.Bf&&Zc.$.da.Za(411,function(ud){ud.dTf()})};this.rhd=function(){Zc.wja&&(Ta.a.Fa(Zc.wja),Zc.wja=null);Zc.SYb=null;Zc.Bf&&Zc.updateTaskPane()};this.Xyd=function(){Zc.lya.Xyd()};this.$=jc;this.Psa=new Sa(this,this.$);this.Bf=this.y5a=!1;this.SYb=this.wja=null;this.lya=
new Lb(jc);this.lya.MTc(this.Tba);this.$.da.Za(411,function(ud){ud.JBg(Zc.eAf);ud.IBg(Zc.onSuggestionApplied);ud.NBg(Zc.Pmc);Zc.$.vr.Pf(Zc.Yh)})}function Fa(){this.canApplySuggestion=this.onUndo=this.onForceRefresh=this.onTableSelected=this.onSuggestionRejected=this.onSuggestionApplied=this.onSuggestionValuesChanged=this.onCancelSuggestionPreview=this.onSuggestionPreview=this.onSuggestionDeselected=this.onSuggestionSelected=null}function Sa(jc,Zc){this.V_a=jc;this.$=Zc}function Ra(){this.availableTables=
this.selectedTable=this.suggestions=this.callbacks=this.isLoading=this.type=null;this.viewState=0;this.applyConfirmationMessage=this.messageType=null}function Lb(jc){var Zc=ka.call(this)||this;Zc.v4e=!1;Zc.FLa=!1;Zc.Qxb=!1;Zc.i5a=!1;Zc.JPa=!1;Zc.XNd=!1;Zc.J5=function(){Zc.Qxb=!Zc.$.fa.isEditMode;Zc.Qxb&&(Zc.JPa=!1);E.ULS.sendTraceTag(537163355,0,50,"DataCleansingPaneStateManager.OnApplicationModeChanged: view mode has changed to {0}.",Zc.Qxb);Zc.ESa()};Zc.IH=function(ud,Fd){ud=Fd.BWd;E.ULS.sendTraceTag(537163354,
0,50,"DataCleansingPaneStateManager.OnUserListChanged: the number of coauth users has changed to {0}.",ud);if(Zc.FLa&&1>=ud||!Zc.FLa&&1<ud)Zc.FLa=1<Fd.BWd,E.ULS.sendTraceTag(537163353,0,50,"DataCleansingPaneStateManager.OnUserListChanged: coauthoring mode has changed to {0}.",Zc.FLa),Zc.FLa&&(Zc.JPa=!1),Zc.ESa()};Zc.Sxa=function(){Zc.i5a=Zc.$.oa.ye.sC;Zc.i5a&&(Zc.JPa=!1);E.ULS.sendTraceTag(537163352,0,50,"DataCleansingPaneStateManager.OnNamedSheetViewModeChanged: named sheet view mode has changed to {0}.",
Zc.i5a);Zc.ESa()};Zc.Yh=function(ud,Fd){E.ULS.sendTraceTag(537163351,0,50,"DataCleansingPaneStateManager.OnActiveSheetChanged: active sheet was changed.");Fd.xK.ye.kGb(Zc.Sxa);Fd.oa.ye.GXa(Zc.Sxa);Zc.i5a=Fd.oa.ye.sC;Zc.JPa=!1;Zc.ESa()};Zc.$=jc;Zc.XNd&&Zc.$.fa.rga(Zc.IH);Zc.$.fa.j9(Zc.J5);Zc.$.oa.ye.GXa(Zc.Sxa);Zc.$.vr.Pf(Zc.Yh);Zc.Jmc=Zc.Jmc.bind(Zc);Zc.$.da.Za(411,function(ud){ud.GCg(Zc.Jmc);2===ud.status&&(Zc.v4e=!0);Zc.ESa()});Zc.ape()&&(Zc.Qxb=!Zc.$.fa.isEditMode,Zc.FLa=1<Zc.$.fa.Em.length,Zc.i5a=
Zc.$.oa.ye.sC);Zc.tgb=Zc.Dye();return Zc}function Ja(jc,Zc){this.Ksg=jc;this.oLc=Zc}function xb(jc,Zc){this.$=jc;this.V_a=Zc}function Kb(jc,Zc,ud,Fd){function me($e){return $e instanceof ud?$e:new ud(function(Df){Df($e)})}return new (ud||(ud=Promise))(function($e,Df){function gg(af){try{dg(Fd.next(af))}catch(rg){Df(rg)}}function og(af){try{dg(Fd["throw"](af))}catch(rg){Df(rg)}}function dg(af){af.done?$e(af.value):me(af.value).then(gg,og)}dg((Fd=Fd.apply(jc,Zc||[])).next())})}b.r(D);var Eb=b(514),
Hc=b(10),Xc=b(41),Pc=b(0),wd=b(817),Tc=b(1),ub=b(175),fb=b(55);xb.prototype.Xc=function(){return!1};xb.prototype.executeCommand=function(jc,Zc){jc=!0;switch(Zc.command){case -1190551534:this.V_a.H3g();break;default:jc=!1}return jc?fb.Task.Ta(!0):ub.a(Zc.command)};xb.prototype.Gc=function(jc,Zc){return-1190551534===Zc.command&&Tc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPane",!1)};xb.prototype.fd=function(){return!1};Object(Pc.a)(xb,"DataCleansingCommandHandler",null,
[237]);var Ta=b(88),eb=b(80),tb=b(56),rc=b(409),wb=b(35),E=b(13),Mb=b(36);Ja.prototype.toString=function(){return"TaskPaneViewState: "+this.tSd+", MessageType: "+this.messageType};tl.Object.defineProperties(Ja.prototype,{tSd:{configurable:!0,enumerable:!0,get:function(){return this.Ksg}},messageType:{configurable:!0,enumerable:!0,get:function(){return this.oLc}}});Object(Pc.a)(Ja,"DataCleansingTaskPaneState",null,[]);var ka=Mb.a;vm(Lb,ka);Lb.prototype.MTc=function(jc){this.addHandler("scev",jc)};
Lb.prototype.hNf=function(jc){this.removeHandler("scev",jc)};Lb.prototype.dispose=function(){var jc=this;this.$.da.Za(411,function(Zc){Zc.w6i(jc.Jmc)});this.$.fa.Pca(this.IH);this.XNd&&this.$.fa.Pca(this.IH);this.$.fa.w6(this.J5);this.$.oa.ye.kGb(this.Sxa);this.$.vr.rg(this.Yh)};Lb.prototype.Xyd=function(){this.JPa=!1;E.ULS.sendTraceTag(537163356,0,50,"DataCleansingPaneStateManager.OnRefreshRequested: refresh pane was triggerd.");this.ESa()};Lb.prototype.Jmc=function(jc,Zc){jc=Zc.sheetId;Zc=Zc.f7;
E.ULS.sendTraceTag(537163350,0,50,"DataCleansingPaneStateManager.OnSuggestionsStatusChanged: suggestion status of sheet id {0} has changed to {1}.",jc,Zc);var ud=this.$.xa.oa.sheetId;ud===jc&&2===Zc&&(this.JPa=!0);ud!==jc||4!==Zc&&2!==Zc||this.ESa()};Lb.prototype.ape=function(){return this.$&&this.$.fa&&this.$.fa.Em&&this.$.oa&&this.$.oa.ye?!0:(E.ULS.sendTraceTag(537163349,0,50,"DataCleansingPaneStateManager.AreDependenciesValid: at least one of the dependencies is null."),!1)};Lb.prototype.ESa=function(){this.tgb=
this.Dye();this.raiseEvent("scev")};Lb.prototype.Dye=function(){var jc=this.v4e||!this.ape()?new Ja(4,4):this.Qxb?new Ja(5,2):this.XNd&&this.FLa?new Ja(5,1):this.i5a?new Ja(5,3):this.JPa?new Ja(2,0):4===this.fCh()?new Ja(1,0):new Ja(0,0);E.ULS.sendTraceTag(537163348,0,50,"DataCleansingPaneStateManager.ConcludeState: the new state of the data cleansing task pane is: {0}",jc);return jc};Lb.prototype.fCh=function(){var jc=this.$.da.Aa(411,void 0);return null===jc?0:jc.hCh()};tl.Object.defineProperties(Lb.prototype,
{currentState:{configurable:!0,enumerable:!0,get:function(){return this.tgb}}});Object(Pc.a)(Lb,"DataCleansingPaneStateManager",Mb.a,[]);var bb=b(187),Ga=b(1296),Ha=b(869),Ua=b(14);Object(Pc.a)(Ra,"DataCleansingTaskPaneProps",null,[]);Sa.prototype.tF=function(jc,Zc,ud,Fd,me,$e){var Df=this;bb.UISurfaces.Hk().then(function(gg){var og,dg;gg.showTaskPane("DataCleansingTaskPane",Df.Lv(jc,Zc,ud.tSd,Fd,me,$e,ud.messageType));E.ULS.sendTraceTag(537163409,0,50,"DataCleansingReactTaskPane.ShowReactTaskPane: Suggestions count: [{0}], tableNames count: [{1}], taskPaneState: [{2}]",
null!==(og=null===Zc||void 0===Zc?void 0:Zc.length)&&void 0!==og?og:0,null!==(dg=null===Fd||void 0===Fd?void 0:Fd.length)&&void 0!==dg?dg:0,ud);return null})};Sa.prototype.Bw=function(jc,Zc,ud,Fd,me,$e,Df){var gg=this;Df=void 0===Df?null:Df;bb.UISurfaces.Hk().then(function(og){og.updateTaskPane("DataCleansingTaskPane",gg.Lv(jc,Zc,ud.tSd,Fd,me,$e,ud.messageType,Df));E.ULS.sendTraceTag(537163408,0,50,"DataCleansingReactTaskPane.UpdateReactTaskPane: Suggestions count: [{0}], tableNames count: [{1}], taskPaneState: [{2}]",
Zc.length,Fd.length,ud);return null})};Sa.prototype.xM=function(){bb.UISurfaces.Hk().then(function(jc){jc.hideTaskPane("DataCleansingTaskPane",2);return null})};Sa.prototype.Aza=function(){bb.UISurfaces.Hk().then(function(jc){jc.setSelectedTaskPane("DataCleansingTaskPane");return null})};Sa.prototype.Lv=function(jc,Zc,ud,Fd,me,$e,Df,gg){var og=this;gg=void 0===gg?null:gg;Zc=Object.assign(new Ra,{type:"DataCleansingTaskPaneProps",suggestions:Zc,callbacks:$e,availableTables:Fd,selectedTable:me,isLoading:!ud,
viewState:ud,messageType:Df,applyConfirmationMessage:gg});return Xc.a.Gd(this.$)?Object.assign(new Ga.a,{width:320,contentProps:Zc,title:Ua.a.instance.ea(1257),onOpen:function(){og.V_a.Mx()},onClose:function(){og.V_a.RA()},onHide:function(){og.V_a.RA()},onShow:function(){og.V_a.Mx()}}):Object.assign(new Ga.a,{contentProps:Object.assign(new Ha.a,{container:jc,paneProps:Zc})})};Object(Pc.a)(Sa,"DataCleansingReactTaskPane",null,[]);var kb=b(44),$a=b(42);Object(Pc.a)(Fa,"DataCleansingTaskPaneCallbacks",
null,[]);Yb.prototype.H3g=function(){var jc=this.$.da.Aa(411),Zc=null===jc||void 0===jc?void 0:jc.ETe();this.N_g(Zc,this.zAe(jc))};Yb.prototype.N_g=function(jc,Zc){var ud=this;jc=void 0===jc?null:jc;Zc=void 0===Zc?null:Zc;var Fd=null,me=null,$e=null;jc&&(Fd=jc.f4f,me=jc.YC,$e=jc.suggestions);if(Xc.a.Gd(this.$))this.Bf?this.Psa.Aza():this.Psa.tF(this.O6a,$e,this.lya.currentState,Fd,me,Zc);else if(this.dU)this.H_f($e,Fd,me,Zc);else if(!this.y5a){this.y5a=!0;var Df=tb.GetServiceTaskFactory.Xa(this.$.da,
415,416,0),gg=rc.a(this.$);jc=tb.GetServiceTaskFactory.create(this.$.da,203,this.$.ma,0);wb.TaskExtensions.Ba(wb.TaskExtensions.ve([Df,gg,jc],this.$.ma),function(){ud.dU=Df.result;gg.result.rQ(ud.dU);ud.mLi();ud.H_f($e,Fd,me,Zc)},this.$.ma,3);return}fb.Task.Ta(!0)};Yb.prototype.Mx=function(){this.Bf=!0;this.$.da.Za(411,function(jc){jc.dTf()})};Yb.prototype.RA=function(){this.Bf=!1;this.$.da.Za(411,function(jc){jc.onSuggestionDeselected(null);jc.S9g();jc.O0b()})};Yb.prototype.dispose=function(){var jc=
this;this.lya.hNf(this.Tba);Ta.a.Fa(this.lya);this.$.da.Za(411,function(Zc){Zc.F5i(jc.eAf);Zc.E5i(jc.onSuggestionApplied);Zc.I5i(jc.Pmc)});this.hideTaskPane();this.dU&&(this.dU.xN(this.Nvf),this.dU.aHd(this.Ovf),this.dU.bHd(this.Pvf),this.$.vr.rg(this.Yh),this.dU=null);this.O6a=this.Psa=this.$=null;this.y5a=!1;Ta.a.Fa(this.wja);this.wja=null};Yb.prototype.zAe=function(jc){return jc?Object.assign(new Fa,{onSuggestionSelected:Object(eb.a)(jc,jc.onSuggestionSelected,"onSuggestionSelected"),onSuggestionDeselected:Object(eb.a)(jc,
jc.onSuggestionDeselected,"onSuggestionDeselected"),onSuggestionPreview:Object(eb.a)(jc,jc.onSuggestionPreview,"onSuggestionPreview"),onCancelSuggestionPreview:Object(eb.a)(jc,jc.onCancelSuggestionPreview,"onCancelSuggestionPreview"),onSuggestionValuesChanged:Object(eb.a)(jc,jc.onSuggestionValuesChanged,"onSuggestionValuesChanged"),onSuggestionApplied:Object(eb.a)(jc,jc.Zyi,"onApplySuggestion"),onSuggestionRejected:Object(eb.a)(jc,jc.onSuggestionRejected,"onSuggestionRejected"),onTableSelected:Object(eb.a)(jc,
jc.onTableSelected,"onTableSelected"),onForceRefresh:this.Xyd,onUndo:Object(eb.a)(jc,jc.$Li,"onUndoSuggestionApply"),canApplySuggestion:Object(eb.a)(jc,jc.canApplySuggestion,"canApplySuggestion")}):null};Yb.prototype.mLi=function(){this.O6a=this.dU.ZL();this.dU.CL(this.Nvf);this.dU.yTc(this.Ovf);this.dU.zTc(this.Pvf)};Yb.prototype.H_f=function(jc,Zc,ud,Fd){this.dU.Lf(!0);this.Bf?(this.Psa.Bw(this.O6a,jc,this.lya.currentState,Zc,ud,Fd),this.Psa.Aza()):(this.Psa.tF(this.O6a,jc,this.lya.currentState,
Zc,ud,Fd),this.Mx())};Yb.prototype.hideTaskPane=function(){this.Psa.xM();this.RA()};Yb.prototype.updateTaskPane=function(){var jc=this;this.$.da.Za(411,function(Zc){if(jc.Bf){var ud=Zc.ETe();jc.Psa.Bw(jc.O6a,ud.suggestions,jc.lya.currentState,ud.f4f,ud.YC,jc.zAe(Zc),jc.SYb)}})};Yb.prototype.qrj=function(jc){this.wja&&(Ta.a.Fa(this.wja),this.wja=null);this.SYb=jc.ibd();this.Bf&&this.updateTaskPane();this.wja=kb.a.instance.create(this.rhd,5E3,$a.a.r7g)};Object(Pc.a)(Yb,"DataCleansingPaneManager",null,
[]);var Xb=wd.a;vm(lb,Xb);lb.prototype.Md=function(){this.Ed([new xb(this.$,new Yb(this.$))])};lb.ja=function(jc){wd.a.de(417,new lb(jc))};Object(Pc.a)(lb,"DataCleansingCommandHandlerFactory",wd.a,[]);var dc=b(216),Za=b(86),Wa=b(200),Ba=b(78),db=b(43);Object(Pc.a)(sa,"DataCleansingSuggestionsResponse",null,[]);var Zb=b(308),Jb=b(592),Ic=b(139),uc=b(24),za=b(27);ta.prototype.MRi=function(jc,Zc){this.uMc=jc=this.Y0c(jc,Zc);this.IPc=xa(jc.suggestionRange,!0)};ta.prototype.JCb=function(jc){jc&&za.a.hh(jc.Errors)?
(E.ULS.sendTraceTag(537163360,0,10,"DataCleansingEwaSuggestion.OnOperationSuccessCallback: Ewa result contains error messages after applying type [{0}]",this.type),this.rra.setResult(null)):(E.ULS.sendTraceTag(537163359,0,50,"DataCleansingEwaSuggestion.OnOperationSuccessCallback: Suggestion of type [{0}] applied successfuly.",this.type),this.rra.setResult(jc))};ta.prototype.ICb=function(jc){E.ULS.sendTraceTag(537163358,0,10,"DataCleansingEwaSuggestion.OnOperationFailedCallback: Ewa result contains error messages for type [{0}], HttpStatus [{1}]",
this.type,jc.data.httpStatus);this.rra.setResult(null)};tl.Object.defineProperties(ta.prototype,{id:{configurable:!0,enumerable:!0,get:function(){return this.pN.id}},type:{configurable:!0,enumerable:!0,get:function(){return this.pN.type}},pN:{configurable:!0,enumerable:!0,get:function(){return this.uMc}},suggestionRange:{configurable:!0,enumerable:!0,get:function(){return this.IPc}},$:{configurable:!0,enumerable:!0,get:function(){return this.vb}}});Object(Pc.a)(ta,"DataCleansingEwaSuggestion",null,
[]);var pb=b(59),cc=b(368),Ac=b(163);Object(Pc.a)(Fb,"RangeAddress",null,[]);var ad=b(81),Jd=b(273),Xd=b(20),od=b(336);Object(Pc.a)(hb,"DataCleansingSuggestion",null,[]);vm(ya,hb);Object(Pc.a)(ya,"ExtraSpacesSuggestion",hb,[]);vm(da,ta);da.prototype.Jhd=function(jc){var Zc=this.q2a();Zc&&Xd.g(this.$).Nb.uw(od.a.RW(pb.d(this.$.oa),Object(db.W)(Zc)),jc,!0,void 0,!0)};da.prototype.q2a=function(){var jc=this.pN;jc||E.ULS.sendTraceTag(537163405,0,10,"ExtraSpacesEwaSuggestion.HighlightOnGrid: suggestion cast failure, should not happen");
var Zc=[];jc=yl(jc.ranges);for(var ud=jc.next();!ud.done;ud=jc.next())Zc.push(xa(ud.value,!1));if(0<Zc.length)return Zc};da.prototype.OXc=function(){return!0};da.prototype.apply=function(){var jc=this,Zc=this.pN,ud=this.$.qa.ta.Xb();cc.a(this.$.userOperationManager,function(Fd,me,$e){return Gb(jc.$.qa.ta,Object(db.u)(jc.$.activeItemName,null,Zb.a.map(Zc.ranges,function(Df){return xa(Df,!1)})),da.aZg(Zc.extraSpacesType),Jd.b(Fd,Object(eb.a)(jc,jc.JCb,"onOperationSuccessCallback")),Jd.a(me,Object(eb.a)(jc,
jc.ICb,"onOperationFailedCallback")),$e,ud)},function(Fd){return new Ac.a(253,0,Fd)},null);return this.rra.task};da.prototype.ibd=function(){if(this.rra.task.isCompleted){var jc=this.rra.task.result;if(null===jc||void 0===jc?0:jc.Result){jc=jc.Result;if(1===jc)return Ua.a.instance.Va(703);if(1<jc)return String.format(Ua.a.instance.Cb(168),jc)}}return Ua.a.instance.ea(1260)};da.prototype.Y0c=function(jc,Zc){if(!jc)return E.ULS.sendTraceTag(537163404,0,10,"ExtraSpacesEwaSuggestion.ConvertToPaneSuggestion: suggestion cast failure, should not happen"),
null;Zc=Object.assign(new ya,{id:Jb.a.create().toString(),type:2,tableRange:Zc.tableRange,tableName:Zc.tableName,columnName:Zc.I_c,extraSpacesType:this.HPi(jc.extraSpacesType),ranges:[]});var ud=Qb(jc.suggestionRange);Zc.suggestionRange=ud;ud=xa(ud,!0);Zc.suggestionRangeStringRef=ud.qE(!1);jc=yl(jc.ranges);for(ud=jc.next();!ud.done;ud=jc.next())Zc.ranges.push(Qb(ud.value));return Zc};da.prototype.HPi=function(jc){switch(jc){case "Leading":return 0;case "Trailing":return 1;case "InBetween":return 2;
default:throw E.ULS.sendTraceTag(537163403,0,10,"ExtraSpacesEwaSuggestion.ParseStringToExtraSpacesType: received illegal extra spaces type."),Error.argument("illegal extra spaces type");}};da.aZg=function(jc){switch(jc){case 0:return 1;case 2:return 2;case 1:return 4;default:throw E.ULS.sendTraceTag(537163402,0,10,"ExtraSpacesEwaSuggestion.ConvertExtraSpacesTypeToTrimWhitespaceType: received illegal ExtraSpacesPaddingType."),Error.argument("illegal ExtraSpacesPaddingType");}};Object(Pc.a)(da,"ExtraSpacesEwaSuggestion",
ta,[]);var Je=b(928),bc=b(92);Object(Pc.a)(Tb,"FormatVariation",null,[]);vm(Sb,hb);Object(Pc.a)(Sb,"NumberFormatInconsistencySuggestion",hb,[]);vm(Xa,ta);Xa.prototype.Jhd=function(jc){var Zc=this.q2a();Zc&&Xd.g(this.$).Nb.uw(od.a.RW(pb.d(this.$.oa),Object(db.W)(Zc)),jc,!0,void 0,!1);Xd.g(this.$).Nb.update(!1)};Xa.prototype.q2a=function(){var jc=this.pN;jc||E.ULS.sendTraceTag(537163401,0,10,"NumberFormattingEwaSuggestion.HighlightOnGrid: suggestion cast failure, should not happen");for(var Zc=[],ud=
yl(jc.formats),Fd=ud.next();!Fd.done;Fd=ud.next())if(Fd=Fd.value,Fd.ranges&&0<Fd.ranges.length)for(var me=yl(Fd.ranges),$e=me.next();!$e.done;$e=me.next())$e=$e.value,Fd.value===jc.replacementFormat&&Fd.isApplicable||Zc.push(xa($e,!1));if(0<Zc.length)return Zc};Xa.prototype.OXc=function(){return!0};Xa.prototype.apply=function(){for(var jc=this.pN,Zc=[],ud=yl(jc.formats),Fd=ud.next();!Fd.done;Fd=ud.next())if(Fd=Fd.value,Fd.ranges&&0<Fd.ranges.length&&Fd.value!==jc.replacementFormat){Fd=yl(Fd.ranges);
for(var me=Fd.next();!me.done;me=Fd.next())Zc.push(xa(me.value,!1))}ud=new bc.a(-1409276245,-1,this.$.ed,12,null);Fd={};Fd.NumberFormatOptions=this.reb.get(jc.replacementFormat);Fd.ValidMembers=32;Fd.NumberFormat=15;this.hi.formatCells(-1409276245,Fd,ud,void 0,Zc,Object(eb.a)(this,this.JCb,"onOperationSuccessCallback"),Object(eb.a)(this,this.ICb,"onOperationFailedCallback"));return this.rra.task};Xa.prototype.ibd=function(){return Ua.a.instance.ea(1259)};Xa.prototype.Y0c=function(jc,Zc){if(!jc)return E.ULS.sendTraceTag(537163400,
0,10,"NumberFormattingEwaSuggestion.ConvertToPaneSuggestion: suggestion cast failure, should not happen"),null;var ud=this.cTe(jc.suggestedFormat.value);Zc=Object.assign(new Sb,{id:Jb.a.create().toString(),type:1,tableRange:Zc.tableRange,tableName:Zc.tableName,columnName:Zc.I_c,replacementFormat:ud,suggestedFormat:ud,formats:[],variationsType:this.IPi(jc.variationsType)});var Fd=Qb(jc.suggestionRange);Zc.suggestionRange=Fd;Fd=xa(Fd,!0);Zc.suggestionRangeStringRef=Fd.qE(!1);this.reb=new Map;Fd=Object.assign(new Tb,
{value:ud,ranges:[],isApplicable:jc.suggestedFormat.isApplicable});this.reb.set(ud,Xa.Gze(jc.suggestedFormat.value));this.NIb(Fd,jc.suggestedFormat.ranges);Zc.formats.push(Fd);jc=yl(jc.otherFormats);for(ud=jc.next();!ud.done;ud=jc.next())ud=ud.value,Fd=this.cTe(ud.value),this.reb.set(Fd,Xa.Gze(ud.value)),Fd=Object.assign(new Tb,{value:Fd,ranges:[],isApplicable:ud.isApplicable}),this.NIb(Fd,ud.ranges),Zc.formats.push(Fd);return Zc};Xa.prototype.cTe=function(jc){jc=this.hi.dyh(jc);jc.success||E.ULS.sendTraceTag(537163399,
0,15,"NumberFormattingEwaSuggestion.GenerateFriendlyFormatString: Failed to acquire friendly format string");return jc.mM};Xa.prototype.NIb=function(jc,Zc){Zc=yl(Zc);for(var ud=Zc.next();!ud.done;ud=Zc.next())ud=Qb(ud.value),jc.ranges.push(ud)};Xa.Gze=function(jc){return Object.assign(new Je.a,{NumberFormatCategory:-1,CustomFormatString:jc})};Xa.prototype.IPi=function(jc){switch(jc){case "AllNumber":return 0;case "AllText":return 1;case "MixedNumberAndText":return 2;default:throw E.ULS.sendTraceTag(529105823,
0,10,"NumberFormattingEwaSuggestion.ParseStringToNumberFormatVariationsType: received illegal variations type."),Error.argument("illegal variations type");}};Object(Pc.a)(Xa,"NumberFormattingEwaSuggestion",ta,[]);vm(Cb,hb);Object(Pc.a)(Cb,"TextInconsistencySuggestion",hb,[]);Object(Pc.a)(ob,"TextVariation",null,[]);var Qd=b(72);vm(Ma,ta);Ma.prototype.Jhd=function(jc){var Zc=this.q2a();Zc&&Xd.g(this.$).Nb.uw(od.a.RW(pb.d(this.$.oa),Object(db.W)(Zc)),jc,!0,void 0,!1);Xd.g(this.$).Nb.update(!1)};Ma.prototype.q2a=
function(){var jc=this.pN;jc||E.ULS.sendTraceTag(537163392,0,10,"TextInconsistencyEwaSuggestion.HighlightOnGrid: suggestion cast failure, should not happen");var Zc=this.Z0e(function(ud){return ud.isSelected&&ud.value!==jc.replacementValue},!1);if(0<Zc.length)return od.a.aHa(Zc)};Ma.prototype.OXc=function(){var jc=this.pN;return Zb.a.any(jc.variations,function(Zc){return Zc.isSelected&&Zc.value!==jc.replacementValue})&&!!jc.replacementValue};Ma.prototype.apply=function(){var jc=this,Zc=this.pN,ud=
this.Y3(),Fd=this.$.qa.ta.Xb(),me=this.Z0e(function($e){return $e.isSelected&&$e.value!==Zc.replacementValue});cc.a(this.$.userOperationManager,function($e,Df,gg){return ad.X(jc.$.qa.ta,ud,Object(db.u)(jc.$.oa.sheetName,null,od.a.aHa(me)),Zc.replacementValue,Jd.b($e,Object(eb.a)(jc,jc.JCb,"onOperationSuccessCallback")),Jd.a(Df,Object(eb.a)(jc,jc.ICb,"onOperationFailedCallback")),gg,Fd)},function($e){return new Ac.a(258,0,$e)},null);return this.rra.task};Ma.prototype.ibd=function(){var jc=this.pN;
jc||E.ULS.sendTraceTag(537163363,0,10,"TextInconsistencyEwaSuggestion.GetApplicationConfirmationString: suggestion cast failure, should not happen");var Zc=Qd.Ct(Qd.where(Qd.asEnumerable(jc.variations),function(ud){return ud.isSelected&&ud.value!==jc.replacementValue}));Zc||E.ULS.sendTraceTag(537163362,0,10,"TextInconsistencyEwaSuggestion.GetApplicationConfirmationString: suggestion applied with 0 variation, should not happen");return 1===Zc?Ua.a.instance.ea(1261):String.format(Ua.a.instance.Cb(167),
Zc)};Ma.prototype.Y0c=function(jc,Zc){if(!jc)return E.ULS.sendTraceTag(537163361,0,10,"TextInconsistencyEwaSuggestion.ConvertToPaneSuggestion: suggestion cast failure, should not happen"),null;Zc=Object.assign(new Cb,{id:Jb.a.create().toString(),type:0,tableRange:Zc.tableRange,tableName:Zc.tableName,columnName:Zc.I_c,normalizedValue:jc.normalizedValue,suggestedValue:jc.suggestedValue.value,replacementValue:jc.suggestedValue.value,variations:[]});var ud=Qb(jc.suggestionRange);Zc.suggestionRange=ud;
ud=xa(ud,!0);Zc.suggestionRangeStringRef=ud.qE(!1);ud=Object.assign(new ob,{value:jc.suggestedValue.value,ranges:[],isSelected:!1});this.NIb(ud,jc.suggestedValue.ranges);Zc.variations.push(ud);jc=yl(jc.variations);for(ud=jc.next();!ud.done;ud=jc.next()){ud=ud.value;var Fd=Object.assign(new ob,{value:ud.value,ranges:[],isSelected:!0});this.NIb(Fd,ud.ranges);Zc.variations.push(Fd)}return Zc};Ma.prototype.NIb=function(jc,Zc){Zc=yl(Zc);for(var ud=Zc.next();!ud.done;ud=Zc.next())ud=Qb(ud.value),jc.ranges.push(ud)};
Ma.prototype.Y3=function(){var jc=this.pN,Zc=Qd.select(Qd.where(Qd.asEnumerable(jc.variations),function(Fd){return Fd.isSelected&&Fd.value!==jc.replacementValue}),function(Fd){return Fd.value}),ud={ExcludeFormulaResult:!0,MatchCase:!0,MatchEntireCell:!0,SearchAllSheets:!1};ud.SearchStrings=Qd.toArray(Zc);ud.SearchUp=!1;ud.SheetName=this.$.oa.sheetName;return ud};Ma.prototype.Z0e=function(jc,Zc){Zc=void 0===Zc?!0:Zc;for(var ud=[],Fd=yl(this.pN.variations),me=Fd.next();!me.done;me=Fd.next())me=me.value,
me.ranges&&jc(me)&&Array.addRange(ud,Zb.a.map(me.ranges,function($e){return xa($e,Zc)}));return od.a.RW(pb.d(this.$.oa),ud)};Object(Pc.a)(Ma,"TextInconsistencyEwaSuggestion",ta,[]);var Vd=Mb.a;vm(ma,Vd);ma.prototype.O0b=function(){this.lNa=new Map};ma.prototype.rTg=function(){this.TYb=new Map;this.WJc=null};ma.prototype.jGg=function(jc){jc&&this.TYb.set(jc.id,jc)};ma.prototype.pTg=function(){this.O0b();this.UTg();this.rTg()};ma.prototype.uti=function(jc,Zc){this.lNa.set(jc,Zc)};ma.prototype.onSuggestionApplied=
function(jc){this.WJc=jc};ma.prototype.Pmc=function(jc){this.TYb.delete(jc)};ma.prototype.wn=function(jc,Zc){if(this.eF.has(jc)&&(jc=this.eF.get(jc),jc.has(Zc)))for(Zc=jc.get(Zc),Zc=yl(Zc.values()).next();!Zc.done;)return xa(Zc.value.pN.tableRange,!0);return null};ma.prototype.cgi=function(jc,Zc){return this.eF.has(jc)?this.eF.get(jc).has(Zc):!1};ma.prototype.gCh=function(jc){var Zc=[];if(!jc)return Zc;var ud=this.$.xa.oa.sheetId;if(!this.eF.has(ud))return Zc;ud=this.eF.get(ud);if(ud.has(jc)){jc=
ud.get(jc);ud=yl(jc.keys());for(var Fd=ud.next();!Fd.done;Fd=ud.next())Fd=Fd.value,this.TYb.has(Fd)||(this.lNa.has(Fd)?Zc.push(this.lNa.get(Fd).pN):Zc.push(jc.get(Fd).pN))}return Zc};ma.prototype.Pub=function(jc,Zc,ud){return this.lNa.has(ud)?this.lNa.get(ud):this.eF.has(jc)&&(jc=this.eF.get(jc),jc.has(Zc)&&(Zc=jc.get(Zc),Zc.has(ud)))?Zc.get(ud):null};ma.prototype.KMd=function(jc,Zc,ud){if(ud){this.f7.has(jc)&&2===this.f7.get(jc)&&(E.ULS.sendTraceTag(537163407,0,50,"DataCleansingSuggestionsCollection.SetSuggestions: Clearing all suggestions due to receiving suggestion in Ready state"),
this.pTg());this.f7.set(jc,1);ud=yl(ud);for(var Fd=ud.next();!Fd.done;Fd=ud.next())this.ryg(jc,Zc,Fd.value)}};ma.prototype.vGd=function(jc,Zc,ud){this.p3i(jc,Zc,ud);this.lNa.delete(ud.id)};ma.prototype.TWf=function(jc,Zc){this.f7.set(Zc,jc);E.ULS.sendTraceTag(537163406,0,50,"DataCleansingSuggestionsCollection.setAllSheetsSuggestionsStatus: Setting the suggestions status of sheet id "+Zc+" to "+jc+".")};ma.prototype.Qed=function(jc){return this.f7.get(jc)};ma.prototype.UTg=function(){this.eF=new Map;
this.f7=new Map};ma.prototype.p3i=function(jc,Zc,ud){if(this.eF.has(jc)){var Fd=this.eF.get(jc);if(Fd.has(Zc)){var me=Fd.get(Zc);me.has(ud.id)&&(me.delete(ud.id),me.size||Fd.delete(Zc),Fd.size||this.eF.delete(jc))}}};ma.prototype.ryg=function(jc,Zc,ud){this.eF.has(jc)||this.eF.set(jc,new Map);var Fd=this.eF.get(jc);Fd.has(Zc)||this.eF.get(jc).set(Zc,new Map);Fd.get(Zc).set(ud.id,ud)};tl.Object.defineProperties(ma.prototype,{Uff:{configurable:!0,enumerable:!0,get:function(){return this.WJc}},Whe:{configurable:!0,
enumerable:!0,get:function(){var jc=this.$.xa.oa.sheetId,Zc=[];if(!this.eF.has(jc))return Zc;jc=this.eF.get(jc);jc=yl(jc.keys());for(var ud=jc.next();!ud.done;ud=jc.next())Zc.push(ud.value);return Zc}},lvg:{configurable:!0,enumerable:!0,get:function(){var jc=this.$.xa.oa.sheetId;return this.f7.has(jc)?this.f7.get(jc):0}},czj:{configurable:!0,enumerable:!0,get:function(){return this.f7.keys()}}});Object(Pc.a)(ma,"DataCleansingSuggestionsCollection",Mb.a,[]);tl.Object.defineProperties(wa.prototype,
{I_c:{configurable:!0,enumerable:!0,get:function(){var jc=String.format(Ua.a.instance.Cb(169),this.columnTitle);return this.columnName?jc+" ("+this.columnName+")":jc}}});Object(Pc.a)(wa,"ColumnMetadata",null,[]);var de=b(19),pe=b(848),Ad=b(821),Pd=pe.a;vm(Z,Pd);Z.getTypeName=function(){return"AugLoop_Tablelint_TableLintColumnAnnotation"};Z.pe=function(){return["AugLoop_Core_Annotation"]};Object(Pc.a)(Z,"TableLintColumnAnnotation",pe.a,[]);var Ce=pe.a;vm(na,Ce);na.getTypeName=function(){return"AugLoop_Tablelint_TableLintWorksheetAggregateAnnotation"};
na.pe=function(){return["AugLoop_Core_Annotation"]};Object(Pc.a)(na,"TableLintWorksheetAggregateAnnotation",pe.a,[]);Y.prototype.Uug=function(){this.yga?E.ULS.sendTraceTag(537163398,0,50,"TableLintManager.ActivateEvents: Events are already registered"):this.Ufi()?(this.C1i(),this.yga=!0,this.augmentationLoopManager.gSc(this.Nkc)):E.ULS.sendTraceTag(574482313,0,50,"TableLintManager.ActivateEvents: Skipping session due to unsupported culture")};Y.prototype.dispose=function(){this.yga&&(this.zHj(),this.yga=
!1)};Y.prototype.kCe=function(jc){var Zc=[],ud=new wa(jc.tableName,jc.columnName,jc.columnTitle,Qb(jc.tableRange));jc=yl(jc.suggestions);for(var Fd=jc.next();!Fd.done;Fd=jc.next())(Fd=Ia(this.$,this.hi,Fd.value,ud))&&Zc.push(Fd);return Zc};Y.prototype.C1i=function(){Tc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPane",!1)&&(E.ULS.sendTraceTag(574482312,0,50,"TableLintManager.RegisterTableLintEvents: activate annotations"),this.augmentationLoopManager.activateAnnotation(Z.getTypeName(),
this.fAj),this.augmentationLoopManager.bT(Z.getTypeName(),this.d4f),this.augmentationLoopManager.activateAnnotation(na.getTypeName()),this.augmentationLoopManager.bT(na.getTypeName(),this.e4f))};Y.prototype.zHj=function(){Tc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPane",!1)&&(this.augmentationLoopManager.MFb(Z.getTypeName(),this.d4f),this.augmentationLoopManager.MFb(na.getTypeName(),this.e4f))};Y.prototype.Ufi=function(){var jc=this.$.ya;return this.eef(jc.UICultureTag)&&
this.eef(jc.DataCultureTag)};Y.prototype.eef=function(jc){return de.a.eI(jc,"en-")};Y.prototype.Nkc=function(){E.ULS.sendTraceTag(526996383,0,50,"TableLintManager.onAugmentationLoopSessionClose Received augmentation loop session close.")};Object(Pc.a)(Y,"TableLintManager",null,[3]);var Jf=b(105),oc=Sys.EventArgs;vm(S,oc);Object(Pc.a)(S,"DataCleansingSuggestionStatusChangedEventArgs",Sys.EventArgs,[]);var ed=b(335),wc=Mb.a;vm(ca,wc);ca.prototype.JBg=function(jc){this.addHandler("oscek",jc)};ca.prototype.F5i=
function(jc){this.removeHandler("oscek",jc)};ca.prototype.IBg=function(jc){this.addHandler("osaek",jc)};ca.prototype.E5i=function(jc){this.removeHandler("osaek",jc)};ca.prototype.NBg=function(jc){this.addHandler("osauek",jc)};ca.prototype.I5i=function(jc){this.removeHandler("osauek",jc)};ca.prototype.GCg=function(jc){this.addHandler("osscek",jc)};ca.prototype.w6i=function(jc){this.removeHandler("osscek",jc)};ca.prototype.initialize=function(){var jc=this;2===this.Osa?E.ULS.sendTraceTag(537163421,
0,50,"DataCleansingManager.Initialize: skipping initialization since manager status is Error"):Tc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TableLintExperiment",!1)||Tc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.DataCleansingTaskPane",!1)?(E.ULS.sendTraceTag(574408774,0,50,"DataCleansingManager.Initialize: activate tablelint events"),this.Osa=1,this.Mhe()):Tc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.TableLintProdExperiment",!1)&&(E.ULS.sendTraceTag(537163420,
0,50,"DataCleansingManager.Initialize: Check license for activating tablelint events"),Za.a.instance.mc("Common.App.ApplicationFeatureHelper.IApplicationFeatureHelper").execute(function(Zc){Zc.isFeatureEnabled("ExcelIntelligence",!1).then(function(ud){ud&&(E.ULS.sendTraceTag(537163419,0,50,"DataCleansingManager.Initialize: LicenseEnabled - activate tablelint events"),jc.Osa=1,jc.Mhe());return ud})}))};ca.prototype.hCh=function(){return 2===this.Osa?3:this.suggestions.lvg};ca.prototype.ETe=function(){this.afi||
this.TVf();return new sa(this.suggestions.gCh(this.YC),this.suggestions.Whe,this.YC)};ca.prototype.dTf=function(){this.TVf();if(this.YC)this.onTableSelected(this.YC)};ca.prototype.KMd=function(jc,Zc,ud){this.Osa&&1!==this.Osa||(E.ULS.sendTraceTag(537163418,0,50,"DataCleansingManager.SetSuggestions: Setting data cleansing manager status to Ready"),this.Osa=3);this.suggestions.KMd(jc,Zc,ud);this.raiseEvent("osscek",new S(jc,this.suggestions.Qed(jc)))};ca.prototype.vGd=function(jc,Zc,ud){this.suggestions.vGd(jc,
Zc,ud);this.raiseEvent("oscek")};ca.prototype.Ilj=function(jc){E.ULS.sendTraceTag(537163417,0,50,"DataCleansingManager.SetSuggestionsReady: the suggestions of sheet id "+jc+" are ready.");this.suggestions.TWf(4,jc);this.raiseEvent("osscek",new S(jc,this.suggestions.Qed(jc)))};ca.prototype.onSuggestionSelected=function(jc){(jc=this.suggestions.Pub(this.$.oa.sheetId,this.YC,jc))?(this.N5e(jc),this.Wti(jc)):E.ULS.sendTraceTag(537163416,0,10,"DataCleansingManager.OnSuggestionSelected: Attempted to highlight missing suggestion")};
ca.prototype.onSuggestionDeselected=function(){this.Y3a()};ca.prototype.onSuggestionPreview=function(jc){(jc=this.suggestions.Pub(this.$.oa.sheetId,this.YC,jc))?this.N5e(jc):E.ULS.sendTraceTag(537163415,0,10,"DataCleansingManager.OnSuggestionPreview: Attempted to highlight missing suggestion")};ca.prototype.onCancelSuggestionPreview=function(){this.Y3a()};ca.prototype.onSuggestionValuesChanged=function(jc){E.ULS.sendTraceTag(537163414,0,50,"DataCleansingManager.OnSuggestionValuesChanged: Change in suggestion of type [{0}]",
jc.type);a:{var Zc=this.$,ud=this.hi,Fd=this.suggestions.Pub(this.$.oa.sheetId,this.YC,jc.id);switch(jc.type){case 0:jc=new Ma(Zc,jc);break a;case 2:jc=new da(Zc,jc);break a;case 1:jc=new Xa(Zc,ud,jc,Fd);break a;default:E.ULS.sendTraceTag(537163422,0,10,"DataCleansingEwaSuggestionFactory.CreateFromPaneSuggestion: suggestion type is not supported"),jc=null}}this.suggestions.uti(jc.id,jc);this.onSuggestionSelected(jc.id);this.raiseEvent("oscek")};ca.prototype.Zyi=function(jc){var Zc=this,ud=this.suggestions.Pub(this.$.oa.sheetId,
this.YC,jc);ud?(wb.TaskExtensions.zha(ud.apply(),function(Fd){Fd.result&&(Zc.Y3a(),Zc.suggestions.jGg(ud),ud.id===Zc.suggestions.Uff?Zc.raiseEvent("osaek",void 0,ud):Zc.raiseEvent("oscek"));return null},Wa.a.none),this.suggestions.onSuggestionApplied(ud.id)):E.ULS.sendTraceTag(537163413,0,10,"DataCleansingManager.OnSuggestionApplied: Attempted to apply non-existant suggestion")};ca.prototype.$Li=function(){var jc=this,Zc=this.suggestions.Uff;ed.b(this.$.Ce(-1502853784,Ba.a.Wb,12,null)).then(function(ud){ud&&
(jc.suggestions.Pmc(Zc),jc.raiseEvent("oscek"));return Promise.resolve(null)});this.raiseEvent("osauek")};ca.prototype.canApplySuggestion=function(jc){jc=this.suggestions.Pub(this.$.oa.sheetId,this.YC,jc);return jc?jc.OXc():(E.ULS.sendTraceTag(537163412,0,10,"DataCleansingManager.CanApplySuggestion: Did not find suggestion in collection"),!1)};ca.prototype.onSuggestionRejected=function(){};ca.prototype.onTableSelected=function(jc){if(!this.f6a||this.YC!==jc){this.Y3a();this.YC=jc;this.f6a=!0;jc=this.suggestions.wn(this.$.oa.sheetId,
jc);if(!jc)throw Error.argument("Table does not exist in suggestion collection");Xd.g(this.$).yi(db.v(jc,this.$),jc.topLeft,null,null,0,Jf.a.dataCleansing);this.Ryj();this.raiseEvent("oscek")}};ca.prototype.S9g=function(){this.f6a&&this.W4c();this.YC=null};ca.prototype.O0b=function(){this.suggestions.O0b()};ca.prototype.dispose=function(){this.$.fa.TC(this.Nx);this.f6a&&this.$&&this.T8f();Ta.a.Fa(this.hSd);wc.prototype.dispose.call(this)};ca.prototype.Mhe=function(){this.hSd=new Y(this,this.hi,this.augmentationLoopManager,
this.$);this.hSd.Uug()};ca.prototype.Ryj=function(){Xd.g(this.$).ha.iG(this.kd);Xd.g(this.$).DD(this.kd)};ca.prototype.T8f=function(){Xd.g(this.$).ha.DK(this.kd);Xd.g(this.$).lF(this.kd)};ca.prototype.Sah=function(){if(this.f6a){var jc=this.suggestions.wn(this.$.oa.sheetId,this.YC).topLeft;Xd.g(this.$).ha.bD([jc],0,jc,0);this.W4c()}};ca.prototype.W4c=function(){this.f6a=!1;this.T8f()};ca.prototype.Wti=function(jc){jc=jc.q2a();if(null===jc||void 0===jc?0:jc.length)jc=yl(jc.sort(function(Zc,ud){return Zc.top<
ud.top?-1:Zc.top>ud.top?1:0})).next().value.topLeft,Xd.g(this.$).HZ(jc)||Xd.g(this.$).yt(jc,0,Jf.a.dataCleansing)};ca.prototype.N5e=function(jc){this.Sah();this.Y3a();jc.Jhd(this.YVc)};ca.prototype.Y3a=function(){Xd.g(this.$).Nb.kl(this.YVc);Xd.g(this.$).Nb.Jl(null,this.YVc,!1);Xd.g(this.$).Nb.update(!1)};ca.prototype.TVf=function(){this.YC=this.suggestions.Whe[0]};tl.Object.defineProperties(ca.prototype,{status:{configurable:!0,enumerable:!0,get:function(){return this.Osa}},afi:{configurable:!0,
enumerable:!0,get:function(){return this.YC&&this.suggestions.cgi(this.$.oa.sheetId,this.YC)}}});Object(Pc.a)(ca,"DataCleansingManager",Mb.a,[279,3]);var gb=dc.a;vm(ba,gb);ba.prototype.create=function(){var jc=this,Zc=tb.GetServiceTaskFactory.Xa(this.$.da,328,327,1),ud=tb.GetServiceTaskFactory.create(this.$.da,18,this.$.ma,1);wb.TaskExtensions.Ba(wb.TaskExtensions.ve([Zc,ud],this.ma),function(){var Fd=jc.$.da.Aa(411);Fd||(Fd=new ca(Zc.result,ud.result,jc.$),Fd.initialize(),E.ULS.sendTraceTag(537163411,
0,50,"DataCleansingManagerFactory.Create: DataCleansingManager initialized successfully"));jc.Fb(Fd)},this.ma,3)};ba.ja=function(jc){jc.da.Ha(412,new ba(jc))};Object(Pc.a)(ba,"DataCleansingManagerFactory",dc.a,[]);var id=b(922),ib=b(276),nc=b(12),Nb=b(117),mb=b(5),Lc=b(91),zd=b(232),jd=b(123);O.n7g="DataCleansingPane";O.p7g="DataCleansingPaneHeader";O.o7g="DataCleansingPaneBody";O.q7g="DataCleansingPaneTitle";O.m7g="DataCleansingCloseButton";Object(Pc.a)(O,"CssClassNames",null,[]);var ge=b(16),Yd=
b(4),rd=b(256),je=b(245),re=b(11),ae=b(826),Uf=b(63),Lf=zd.a;vm(Q,Lf);Q.prototype.hG=function(jc){this.get_events().addHandler("DCTPR",jc)};Q.prototype.MH=function(jc){this.get_events().removeHandler("DCTPR",jc)};Q.prototype.CL=function(jc){this.addHandler("DCTPC",jc)};Q.prototype.xN=function(jc){this.removeHandler("DCTPC",jc)};Q.prototype.yTc=function(jc){this.addHandler("DCTPCO",jc)};Q.prototype.aHd=function(jc){this.removeHandler("DCTPCO",jc)};Q.prototype.zTc=function(jc){this.addHandler("DCTPC",
jc)};Q.prototype.bHd=function(jc){this.removeHandler("DCTPC",jc)};Q.prototype.Xv=function(){};Q.prototype.$B=function(){};Q.prototype.fn=function(){return this.ep};Q.prototype.Jp=function(){return this.ep};Q.prototype.bF=function(){};Q.prototype.VG=function(){return!1};Q.prototype.ji=function(){};Q.prototype.Vh=function(){};Q.prototype.Qe=function(){return!0};Q.prototype.zh=function(jc){return re.DOMElementExtensions.Ye(this.Jb,jc)};Q.prototype.Lf=function(jc){this.isVisible=this.ep=jc;this.taskPaneManager.ap();
jc&&0<this.taskPaneManager.zz.length&&(!this.taskPaneManager.xg||18!==this.taskPaneManager.xg.taskPane.tg||this.taskPaneManager.isCollapsed)&&this.taskPaneManager.WC(this,!0);this.$.Gf()};Q.prototype.ZL=function(){var jc=ae.b("div","DataCleansingPaneBodyId",O.o7g),Zc=this.domElement;Zc.setAttribute(jd.a.ariaLabel,Ua.a.instance.ea(1258));Zc.appendChild(this.sG());Zc.appendChild(jc);return jc};Q.prototype.dispose=function(){this.ke&&(ib.a.instance.za(nc.a.click,this.ke,this.Zj),Nb.KeyInputManager.instance.jv(this.ke,
this.Ywe),this.ke=null);this.taskPaneManager=this.$=null;Lf.prototype.dispose.call(this)};Q.prototype.e3h=function(){var jc=this.domElement;jc.id="DataCleansingPaneId";document.getElementById(this.$.Ib+Yd.a.YQ).appendChild(jc);jc.classList.add(O.n7g)};Q.prototype.sG=function(){var jc=ae.b("div","DataCleansingPaneHeaderId",O.p7g),Zc=ae.b("span","DataCleansingPaneTitleId",Yd.a.BAj+O.q7g);Zc.innerText=this.titleText;this.ke=id.a.yb("DataCleansingPaneCloseButtonId",Yd.a.v4f+O.m7g,Ua.a.instance.ea(10),
"ClosePaneGlyph_16x16x32",!1);this.ke.classList.add(mb.AFrameworkApplication.isRtl?Yd.a.X$:Yd.a.Y$);ib.a.instance.pa(nc.a.click,this.ke,this.Zj);this.Ywe=Nb.KeyInputManager.instance.Ur(this.ke,this.Zj,Lc.a.$h);jc.appendChild(Zc);jc.appendChild(this.ke);return jc};tl.Object.defineProperties(Q.prototype,{isVisible:{configurable:!0,enumerable:!0,get:function(){return Object(Uf.a)(Q.prototype,this,"isVisible")},set:function(jc){Object(Uf.a)(Q.prototype,this,"isVisible")!==jc&&(Object(Uf.b)(Q.prototype,
this,"isVisible",jc),this.raiseEvent(jc?"DCTPC":"DCTPCO"))}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return this.isVisible}},Zd:{configurable:!0,enumerable:!0,get:function(){return je.a.s7g}},tg:{configurable:!0,enumerable:!0,get:function(){return 18}},Vj:{configurable:!0,enumerable:!0,get:function(){return ge.a.tNe}},oC:{configurable:!0,enumerable:!0,get:function(){return Ua.a.instance.ea(1025)}},El:{configurable:!0,enumerable:!0,get:function(){return 320}},isResizable:{configurable:!0,
enumerable:!0,get:function(){return!1}},Jb:{configurable:!0,enumerable:!0,get:function(){return this.domElement}},titleText:{configurable:!0,enumerable:!0,get:function(){return Ua.a.instance.ea(1257)}}});Object(Pc.a)(Q,"DataCleansingTaskPane",zd.a,[280,3,257,100]);var Of=dc.a;vm(I,Of);I.prototype.create=function(){var jc=this;wb.TaskExtensions.Ba(rc.a(this.$),function(Zc){Zc=Zc.result;Zc=jc.$.da.Aa(415)||jc.$.da.Ha(415,new Q(jc.$,Zc));jc.Fb(Zc)},this.ma,3)};I.ja=function(jc){jc.da.Ha(416,new I(jc))};
Object(Pc.a)(I,"DataCleansingTaskPaneFactory",dc.a,[]);var Yf=b(185),vg=b(125),Af=b(147),rf=b(127),Cg;(function(jc){jc[jc.success=0]="success";jc[jc.featureDisabled=1]="featureDisabled";jc[jc.rangeNotInGrid=2]="rangeNotInGrid";jc[jc.emptyRange=3]="emptyRange"})(Cg||(Cg={}));Object(Pc.b)("ResultCode",Cg);var sc=b(23),Rc=zd.a;vm(R,Rc);R.prototype.show=function(jc,Zc,ud,Fd,me,$e,Df,gg,og,dg,af,rg,cg,Ie,Ng,Zf){var ng=this;if(!Ie&&this.$){jc=this.grid.sc(jc);if(!jc){E.ULS.sendTraceTag(527218010,1,15,"ProactiveSuggestionUIControl.Show: failed to show UI, formattedActiveCell is null.");
return}if(!jc.cell.tk){E.ULS.sendTraceTag(527218009,1,15,"ProactiveSuggestionUIControl.Show: failed to show UI, formattedActiveCell is not in view.");return}Ie=this.grid.getCellBounds(jc.cell,!0)}E.ULS.shipAssertTag(527218008,1,!!Ie,"ProactiveSuggestionUIControl.Show: target cell bounds should not be null.");E.ULS.sendTraceTag(527218007,1,50,"ProactiveSuggestionUIControl.Show: calling AppChrome API to render card UI.");appChrome.renderProactiveSuggestionCard(Ie.y,Ie.x,Ie.y+Ie.height,Ie.x+Ie.width,
this.domElement,Zc,ud,Fd,me,$e,Df,gg,og,dg,af,rg,cg,Ng,function(Ff){Ff&&(ng.FCd=Ff)},Zf,this.isMac?Zc+" "+Ua.a.instance.ea(1776):Zc+" "+Ua.a.instance.ea(1775));this.$.frame.hv.pa(nc.a.Vd,this.$.domElement,this.onKeyUp);this.$.da.Za(211,function(Ff){var be=ng.isMac?Ua.a.instance.ea(1776):Ua.a.instance.ea(1775);Ff.setEnabled(!0);Ff.readText(be)})};R.prototype.hide=function(){E.ULS.sendTraceTag(527218006,1,50,"ProactiveSuggestionUIControl.Hide: calling AppChrome API to unmount card UI.");appChrome.unmountReactComponent(this.domElement);
this.$.frame.hv.za(nc.a.Vd,this.$.domElement,this.onKeyUp)};R.prototype.focus=function(){this.FCd&&this.FCd.focus()};Object(Pc.a)(R,"ProactiveSuggestionUIControl",zd.a,[]);W.prototype.ak=function(){this.tableIntelligenceManager.TXb(this.u$a);this.$.xa.Pf(this.Yh);this.grid.ha.k2(this.Sh)};W.prototype.Uzc=function(jc){for(var Zc=new Yf.a,ud=yl(this.Xla),Fd=ud.next();!Fd.done;Fd=ud.next())Fd=Fd.value,Fd.FD.range.Rd(jc.FD.range)&&Fd.FD.sheetId===jc.FD.sheetId||Zc.add(Fd);jc.tableName||Zc.add(jc);this.Xla=
Zc;this.$.fa.Mh&&this.c$f()};W.prototype.tKj=function(jc){this.MNa=null;jc.tableName||(this.MNa=jc);this.z$f();this.$.fa.Xle(this.QAf)};W.prototype.Pda=function(jc,Zc){this.HMa?this.Zfi(jc)?(this.dataFields.LaunchSource=Zc,Tc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PasteSmartViewTestOnly",!1)?this.SYe(jc):this.voi(jc)):E.ULS.sendTraceTag(527229345,306,50,"IntelligentMetadataOverlayManager:Surrounding Cells contain values, update boundary required"):E.ULS.sendTraceTag(527958875,306,
15,"IntelligentMetadataOverlayManager:TriggerHandRaise License is not enabled.")};W.prototype.voi=function(jc){var Zc=Za.a.instance.mc("Common.ISystemInitiatedFeedback");Zc&&(E.ULS.sendTraceTag(527983892,306,50,"IntelligentMetadataOverlayManager:logSmartViewEventToLpp logged event to LPP"),Zc.execute(function(ud){ud.logActivity("SmartViewProactiveSuggestionActivity",null,jc)}))};W.prototype.SYe=function(jc){this.Jaf()?this.getMetadata(jc):(this.n3c=jc,this.grid.hTc(this.nCb))};W.prototype.dispose=
function(){this.mR&&this.mR.dispose()};W.prototype.xje=function(jc,Zc,ud){!jc.length||ud?jc.push(Zc.clone()):(ud=jc[jc.length-1],ud.right+1===Zc.left?ud.right=Zc.right:ud.bottom+1===Zc.top?ud.bottom=Zc.bottom:jc.push(Zc.clone()))};W.prototype.c$f=function(){if(Tc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataOverlayGridHighlights",!1)){for(var jc=[],Zc=[],ud=[],Fd=yl(this.Xla),me=Fd.next();!me.done;me=Fd.next()){var $e=me.value;me=this.$.xa.oa;if(!me)E.ULS.sendTraceTag(537155671,
0,50,"IntelligentMetadataOverlayManagerFactory.UpdateView: Active sheet null");else if($e.FD.sheetId===me.sheetId){var Df=0;me=null;$e=yl($e.interpretations);for(var gg=$e.next();!gg.done;gg=$e.next())gg=gg.value,gg.confidence>=Df&&(Df=gg.confidence,me=gg);if(me){Df=me.xna.clone();Df.left+=me.headerColumnCount;Df.top+=me.headerRowCount;gg=$e=!0;for(var og=0;og<me.fields.count;og++){var dg=Df.clone();2===me.orientation?(dg.left+=og,dg.right=dg.left):(dg.top+=og,dg.bottom=dg.top);1===me.fields.na(og).classification?
(this.xje(jc,dg,gg),gg=!1):(this.xje(Zc,dg,$e),$e=!1)}Df=me.xna.clone();2===me.orientation?Df.bottom=Df.top+me.headerRowCount-1:Df.right=Df.left+me.headerColumnCount-1;ud.push(Df)}}}this.grid.Nb.Zya();0<jc.length&&(jc=od.a.RW(pb.d(this.$.oa),jc),this.grid.Nb.uw(jc,[32],!0));0<Zc.length&&(Zc=od.a.RW(pb.d(this.$.oa),Zc),this.grid.Nb.uw(Zc,[33],!0));0<ud.length&&(ud=od.a.RW(pb.d(this.$.oa),ud),this.grid.Nb.uw(ud,[31],!0))}};W.prototype.D9h=function(jc){this.ofb=this.KRc=null;for(var Zc=yl(this.Xla),
ud=Zc.next();!ud.done;ud=Zc.next())if(ud=ud.value,ud.FD.sheetId===this.$.xa.oa.sheetId){for(var Fd=yl(this.Q6e),me=Fd.next();!me.done;me=Fd.next())if(me=me.value,me.sheetId===ud.FD.sheetId&&me.range.Rd(ud.FD.range))return!1;Fd=0;me=null;for(var $e=yl(ud.interpretations),Df=$e.next();!Df.done;Df=$e.next())Df=Df.value,Df.confidence>=Fd&&(Fd=Df.confidence,me=Df);if(me&&2===me.orientation&&1===me.headerRowCount&&!me.headerColumnCount&&me.xna.Rd(jc))return this.KRc=ud,this.ofb=me,!0}return!1};W.prototype.TAa=
function(){if(Tc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.IntelligentMetadataOverlayTableAI",!1)){var jc=this.grid.ha.va.oV,Zc=Tc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.ShowSkittleByActiveCell",!1),ud=this.grid.ha.Te;if(jc&&1===ud&&(jc=this.grid.ha.va.activeCell,this.D9h(jc))){rf.b(this.$).ae(vg.a.k1f,this.dataFields,{},!0);this.t0f(Zc?jc:this.ofb.xna);return}this.Rba(!1);this.mR.hide()}};W.prototype.z$f=function(){if(Tc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.SmartView.OnPasteEnabled",
!1)&&null!=this.MNa){var jc=this.P6e===this.MNa.FD;if(this.MNa.FD.sheetId!==this.$.xa.oa.sheetId||jc)this.Rba(!1),this.mR.hide();else{jc=0;for(var Zc=null,ud=yl(this.MNa.interpretations),Fd=ud.next();!Fd.done;Fd=ud.next())Fd=Fd.value,Fd.confidence>=jc&&(jc=Fd.confidence,Zc=Fd);Zc?2!==Zc.orientation||1!==Zc.headerRowCount||Zc.headerColumnCount?E.ULS.sendTraceTag(527218011,0,50,"IntelligentMetadataOverlayManagerFactory.updateOnDemandActionButton: The recognition cannot be converted to a table"):(this.uOb=
Zc,rf.b(this.$).ae(vg.a.k1f,this.dataFields,{},!0),this.t0f(this.ivg.xna)):E.ULS.sendTraceTag(527958874,0,50,"IntelligentMetadataOverlayManagerFactory.updateOnDemandActionButton: The recognition contained no interpretations")}}};W.prototype.Rba=function(jc){jc&&!this.Ecc?(jc=[],"Paste"==this.dataFields.LaunchSource?jc.push(this.uOb.xna):jc.push(this.ofb.xna),jc=od.a.RW(pb.d(this.$.oa),jc),this.grid.Nb.uw(jc,[0],!0),this.Ecc=!0):!jc&&this.Ecc&&(this.grid.Nb.Zya(),this.Ecc=!1)};W.prototype.getMetadata=
function(jc){(jc=this.tableIntelligenceManager.sMh(jc,this.tKj.bind(this)))&&this.yni(jc)};W.prototype.Jaf=function(){return this.grid.Ca.JZ(4,this.$.oa)};W.prototype.yni=function(jc){var Zc={};E.ULS.sendTraceTag(536953376,0,15,"GetMetadataOnDemand Failed {0}",(Zc.errorId=Cg[jc],Zc))};W.prototype.Zfi=function(jc){jc=new uc.Range(1<jc.range.top-1?jc.range.top-1:1,1<jc.range.left-1?jc.range.left-1:1,jc.range.bottom+1,jc.range.right+1,!0,!1);for(var Zc=1==jc.top,ud=1==jc.left,Fd=Xd.g(this.$).sl("IntelligenceMetadataOverlay",
jc,1);Fd.$$mn();){var me=Fd.$$cu();if((me.range.top==jc.top&&!Zc||me.range.left==jc.left&&!ud||me.range.bottom==jc.bottom||me.range.right==jc.right)&&0!=me.aL.value.length)return!1}return!0};tl.Object.defineProperties(W.prototype,{ivg:{configurable:!0,enumerable:!0,get:function(){return this.uOb}}});Object(Pc.a)(W,"IntelligentMetadataOverlayManager",null,[260,255,3]);var Qc=dc.a;vm(ia,Qc);ia.prototype.create=function(){var jc=this,Zc=tb.GetServiceTaskFactory.Xa(this.$.da,388,387,1),ud=tb.GetServiceTaskFactory.Xa(this.$.da,
12,477,this.tb),Fd=tb.GetServiceTaskFactory.Xa(this.$.da,20,404,1);wb.TaskExtensions.Ba(wb.TaskExtensions.ve([Zc,ud,Fd],this.$.ma),function(){if(Fd.result){var me=jc.$.da.Aa(426);me||(me=new W(jc.$,Fd.result,Zc.result,ud.result),jc.$.da.Ha(426,me));jc.Fb(me);E.ULS.sendTraceTag(537155667,0,50,"IntelligentMetadataOverlayManagerFactory.Create: IntelligentMetadataOverlayManager initialized successfully")}else E.ULS.sendTraceTag(537155666,306,10,"TableIntelligenceManager instance null. Can not create IntelligentMetadataOverlayManager instance. Creating null service event."),
jc.Fb(null)},this.$.ma,3)};ia.ja=function(jc){jc.da.Ha(427,new ia(jc))};Object(Pc.a)(ia,"IntelligentMetadataOverlayManagerFactory",dc.a,[]);var ee=b(74),ue=b(457);P.prototype.X3g=function(){var jc=this,Zc=this.Y3g();ue.a(this.$,243,242,0,function(ud){jc.cardViewManager=ud;ud.l_f(jc.Tn,4,Zc)})};P.prototype.$_h=function(){this.cardViewManager&&this.cardViewManager.xKa(-1,-1,this.Tn)};P.prototype.Y3g=function(){var jc={};jc.description=this.text;var Zc={fieldType:0};Zc.display=this.text;jc.fields=[Zc];
return jc};Object(Pc.a)(P,"PivotTableHandRaiseCardManager",null,[]);var Ee=b(836),De=ee.a;vm(N,De);N.prototype.setRange=function(jc){this.FWb=jc};N.prototype.dispose=function(){this.xp.dispose();this.$=null;De.prototype.dispose.call(this)};N.prototype.aAa=function(){this.hide();var jc=Xd.g(this.$),Zc=jc.$a.Kj(this.FWb),ud=jc.Lg(this.FWb,Zc),Fd=jc.fg(Zc).Dn,me=this.$.da.Aa(271);if((!me||!me.W8h())&&ud&&Fd&&0<=ud.x&&0<=ud.y&&Fd.width>ud.width+160){me=ud.bottomRight.x+this.Uy;var $e=ud.bottomRight.y,
Df=!1;me+160>Fd.bottomRight.x&&(me=ud.topLeft.x-this.Uy,Df=!0);this.xp.i$f(Ee.a.pej,null,Zc);this.xp.Y5b(this.Rba,Zc);this.so(me,$e,jc.rtl,Zc,Df);Tc.EwaSettings.isChangeGateEnabled("OfficeVSO:5449290_RichTooltip")||(this.xp.domElement(Zc).title=Ua.a.instance.Va(677));this.$.frame.hv.pR(nc.a.Vd,this.$.domElement,this.onKeyUp,Zc);this.$.frame.hv.Vu(nc.a.Rb,this.$.domElement,this.onKeyDown,!0);this.$.da.Za(211,function(gg){var og=Ua.a.instance.ea(1769)+" "+Ua.a.instance.ea(1693);gg.setEnabled(!0);gg.readText(og)});
this.isVisible=!0}};N.prototype.lcb=function(){E.ULS.sendTraceTag(537154657,306,50,"PivotTableHandRaiseLaunchButton:ShowRichToolTip Show tooltip");Tc.EwaSettings.isChangeGateEnabled("OfficeVSO:5449290_RichTooltip")&&(this.C9a||(this.C9a=new P(this.$,this.xp.domElement(1)),this.C9a.text=Ua.a.instance.Va(677)),this.C9a.X3g())};N.prototype.mcc=function(){this.C9a&&this.C9a.$_h()};N.prototype.hide=function(){this.isVisible&&(this.xp.hide(),E.ULS.sendTraceTag(537154656,306,50,"PivotTableHandRaiseLaunchButton:Hide Dismissing Pivot table hand rasie OOUI."),
this.$.frame.hv.za(nc.a.Vd,this.$.domElement,this.onKeyUp),this.$.frame.hv.kv(nc.a.Rb,this.$.domElement,this.onKeyDown,!0),this.isVisible=this.NM=this.OZ=!1)};N.prototype.Uca=function(jc){this.xp.getButton(jc).qab();this.NM=!1};N.prototype.BIb=function(jc){this.xp.getButton(jc).kEb();this.NM=!0;this.$.da.Za(211,function(Zc){var ud=Ua.a.instance.Va(677)+" "+Ua.a.instance.ea(1770);Zc.setEnabled(!0);Zc.readText(ud)})};N.prototype.FBf=function(){var jc=this;E.ULS.sendTraceTag(537154655,306,50,"PivotTableHandRaiseLaunchButton:OpenPane Pivot table hand rasie OOUI clicked.");
var Zc={SourceControlId:"PivotTableHandRaise"};Zc.StartingRanges=[this.FWb];this.$.Ce(2137617149,0,0,Zc).continueWith(function(){jc.hide()})};N.prototype.so=function(jc,Zc,ud,Fd,me){this.xp.so(jc,Zc,ud,Fd,!1,me);E.ULS.sendTraceTag(556615632,306,50,"PivotTableHandRaiseLaunchButton:ShowAt Pivot table hand raise OOUI shown.")};tl.Object.defineProperties(N.prototype,{Uy:{configurable:!0,enumerable:!0,get:function(){return this.xp.Uy}}});Object(Pc.a)(N,"PivotTableHandRaiseLaunchButton",ee.a,[]);var ne=
b(519);U.prototype.Pda=function(jc){if(this.HMa)if(jc)if(Tc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableHandRaiseTestOnly",!1))this.g3c<this.Olf&&this.sPd(jc);else if(Tc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableHandRaiseTableMetadataIntEnabled",!1)){var Zc=this.RPh(jc);Zc&&(this.dgi(Zc)?Tc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableHandRaiseLppIntEnabled",!1)?this.Iif(jc):this.g3c<this.Olf&&this.sPd(jc):E.ULS.sendTraceTag(537154652,
306,50,"PivotTableHandRaiseManager:TriggerHandRaise table data is not pivotable."))}else Tc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.PivotTableHandRaiseLppIntEnabled",!1)&&this.Iif(jc);else E.ULS.sendTraceTag(537154653,306,10,"PivotTableHandRaiseManager:TriggerHandRaise activeRangeForHandRaise is null.");else E.ULS.sendTraceTag(537154654,306,Tc.EwaSettings.isChangeGateEnabled("OfficeVSO:6003612_PTPSFixLicenseCheck")?50:10,"PivotTableHandRaiseManager:TriggerHandRaise License is not enabled.")};
U.prototype.dispose=function(){this.Nh&&this.Nh.dispose();this.mR&&this.mR.dispose()};U.prototype.Uzc=function(jc){for(var Zc=new Yf.a,ud=yl(this.Xla),Fd=ud.next();!Fd.done;Fd=ud.next())Fd=Fd.value,Fd.FD.range.Rd(jc.FD.range)&&Fd.FD.sheetId===jc.FD.sheetId||Zc.add(Fd);Zc.add(jc);this.Xla=Zc};U.prototype.RPh=function(jc){E.ULS.sendTraceTag(537154651,306,50,"PivotTableHandRaiseManager:GetRelevantRecognizedTable get table metadata info.");if(!this.Xla.count)return E.ULS.sendTraceTag(537154650,306,50,
"PivotTableHandRaiseManager:GetRelevantRecognizedTable table metadata info is not available."),null;for(var Zc=null,ud=pb.d(this.$.xa.oa),Fd=yl(this.Xla),me=Fd.next();!me.done;me=Fd.next())if(me=me.value,me.FD.sheetId===ud&&me.FD.range.Rd(jc)){Zc=me;break}Zc||E.ULS.sendTraceTag(537154649,306,50,"PivotTableHandRaiseManager:TriggerHandRaise table metadata is not relevant to current trigger.");return Zc};U.prototype.Iif=function(jc){var Zc=Za.a.instance.mc("Common.ISystemInitiatedFeedback");Zc&&(this.$8d=
this.Ojf+1,E.ULS.sendTraceTag(537154648,306,50,"PivotTableHandRaiseManager:TriggerHandRaise PivotTableHandRaiseActivity LPP activity log count: {0}",this.Ojf),Zc.execute(function(ud){ud.logActivity("PivotTableHandRaiseActivity",null,jc)}))};U.prototype.sPd=function(jc){var Zc=this;Tc.EwaSettings.isChangeGateEnabled("OfficeVSO:5989759_PTPSCardUX")?(E.ULS.sendTraceTag(526984158,306,50,"PivotTableProactiveSuggestion: show pivot table hand raise."),this.mR.show(jc,Ua.a.instance.ea(1774),Ua.a.instance.Va(679),
Ua.a.instance.ea(1772),Ua.a.instance.ea(1773),function(){E.ULS.sendTraceTag(526984157,306,50,"PivotTableProactiveSuggestion:OpenPane Pivot table hand raise OOUI clicked.");Zc.$.Ce(2137617149,0,0,{SourceControlId:"PivotTableHandRaise",VQj:[jc]}).continueWith(function(){Zc.mR.hide()})},function(){E.ULS.sendTraceTag(526984156,306,50,"PivotTableProactiveSuggestion: Not Now clicked.");Zc.mR.hide()})):(this.Nh.setRange(jc),this.Nh.aAa());Xd.g(this.$).ha.jG(this.kd);this.F1d=this.g3c+1};U.prototype.ak=function(){this.tableIntelligenceManager.TXb(this.u$a)};
U.prototype.dgi=function(jc){jc=yl(jc.interpretations);for(var Zc=jc.next();!Zc.done;Zc=jc.next())if(Zc=Zc.value,.75<=Zc.confidence&&2===Zc.orientation)return!0;return!1};U.prototype.expandRange=function(jc){return Kb(this,void 0,void 0,function ud(){var Fd=this,me,$e,Df,gg,og,dg,af;return Gm(ud,function(rg){if(1==rg.L7a)return me=Fd,$e=Xd.g(Fd.$),rg.ioa(new Promise(function(cg){function Ie(){$e.Ca.JZ(4,me.$.oa)&&($e.MGd(Ie),cg())}$e.hTc(Ie)}),2);if(3!=rg.L7a)return(Df=$e.Vb.vk(jc))?rg.return(Df.usedRange):
rg.ioa(tb.GetServiceTaskFactory.iac(Fd.$.da,482,483,1),3);gg=rg.VXd;og=Fd.$.qa.ta.Xb();dg=Object(db.o)(jc,Fd.$);af=Object(db.v)(jc,Fd.$);return rg.return(new Promise(function(cg){function Ie(Zf,ng,Ff){return gg.getExpandedRangeForPivotTable(me.$.qa.ta,af,dg,Object(Jd.b)(Zf,function(be){E.ULS.sendTraceTag(526790984,306,50,"PivotTableHandRaiseManager.getSelectionForHandRaise: Expanded range");be=Object(db.Z)(be.Result,me.$.xa);be.returnValue?cg(be.range):(E.ULS.sendTraceTag(526790983,306,10,"PivotTableHandRaiseManager.getSelectionForHandRaise: Failed to parse expanded range"),
cg(null))}),Object(Jd.a)(ng,function(){E.ULS.sendTraceTag(526790982,306,10,"PivotTableHandRaiseManager.getSelectionForHandRaise: Failed to expand range");cg(null)}),Ff,null,og)}var Ng=Tc.EwaSettings.tc()?new Ac.a(511,0,Ie,88):new ne.a(511,0,Ie,24);Ng.Qza(function(){return!0});me.$.userOperationManager.ic(Ng,null)}))})})};tl.Object.defineProperties(U.prototype,{g3c:{configurable:!0,enumerable:!0,get:function(){return this.F1d}},Ojf:{configurable:!0,enumerable:!0,get:function(){return this.$8d}}});
Object(Pc.a)(U,"PivotTableHandRaiseManager",null,[254,255,3]);var gc=dc.a;vm(B,gc);B.prototype.create=function(){var jc=this,Zc=this.$.da.Aa(430);if(!Zc){var ud=tb.GetServiceTaskFactory.Xa(this.$.da,20,404,1),Fd=tb.GetServiceTaskFactory.Xa(this.$.da,12,477,1),me=null;Tc.EwaSettings.la(571)&&(me=tb.GetServiceTaskFactory.Xa(this.$.da,388,387,1));var $e=[ud,Fd];me&&$e.push(me);wb.TaskExtensions.Ba(fb.Task.WAA.apply(null,$e),function(){var Df=ud.result,gg=Fd.result;Df?(Zc=me?new U(jc.$,Df,gg,me.result):
new U(jc.$,Df,gg),jc.Fb(Zc),jc.$.da.Ha(430,Zc)):(E.ULS.sendTraceTag(537154644,306,10,"PivotTableHandRaiseManagerFactory.Create: TableIntelligenceManager instance null."),jc.Fb(null))},this.$.ma)}};B.ja=function(jc){jc.da.Ha(431,new B(jc))};Object(Pc.a)(B,"PivotTableHandRaiseManagerFactory",dc.a,[]);var fd=Mb.a;vm(w,fd);w.prototype.aUd=function(jc,Zc){E.ULS.sendTraceTag(537154185,0,50,"ProactiveSuggestionManager.TriggerProactiveSuggestion: proactive suggestion was triggered. Range: {0}, TriggerType: {1}",
jc,Zc);if(Tc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.ExcelOnline.DataCleansingProactiveSuggestion",!1))switch(Zc){case 0:this.raiseEvent("pssort",void 0,jc);break;case 1:this.raiseEvent("psfilter",void 0,jc);break;case 2:this.raiseEvent("pscrttbl",void 0,jc)}};Object(Pc.a)(w,"ProactiveSuggestionManager",Mb.a,[252]);var vd=dc.a;vm(G,vd);G.prototype.create=function(){var jc=this.$.da.Aa(476);jc||(jc=new w);this.Fb(jc)};G.ja=function(jc){jc.da.Ha(475,new G(jc))};Object(Pc.a)(G,"ProactiveSuggestionManagerFactory",
dc.a,[]);var se=b(179),Jc=Sys.EventArgs;vm(r,Jc);Object(Pc.a)(r,"RecognizedTableUpdateEventArgs",Sys.EventArgs,[]);Object(Pc.a)(z,"RecognizedTable",null,[]);Object(Pc.a)(t,"TableField",null,[]);Object(Pc.a)(x,"TableInterpretation",null,[]);var Bc=pe.a;vm(v,Bc);v.getTypeName=function(){return"AugLoop_ExcelTableAi_ExcelRecognizedTableNew"};v.pe=function(){return["AugLoop_Core_Annotation"]};Object(Pc.a)(v,"ExcelRecognizedTableNew",pe.a,[]);vm(u,v);u.getTypeName=function(){return"AugLoop_ExcelTableai_ExcelRangeMetadata"};
u.pe=function(){return["AugLoop_ExcelTableAi_ExcelRecognizedTableNew","AugLoop_Core_Annotation"]};Object(Pc.a)(u,"ExcelRangeMetadata",v,[]);var Ae=b(1274),cb=Ae.a;vm(f,cb);f.getTypeName=function(){return"AugLoop_ExcelTableai_ExtendedExcelCell"};f.pe=function(){return["AugLoop_Excel_ExcelCell","AugLoop_Core_GridCell"]};Object(Pc.a)(f,"ExtendedExcelCell",Ae.a,[]);var mc=b(1017),Oc=mc.a;vm(l,Oc);l.getTypeName=function(){return"AugLoop_ExcelTableai_RangeDataSignal"};l.pe=function(){return["AugLoop_Signals_Signal"]};
Object(Pc.a)(l,"RangeDataSignal",mc.a,[]);Object(Pc.a)(n,"ExcelRangeAddressNew",null,[]);var Sc=b(101),$c=Mb.a;vm(k,$c);k.prototype.sMh=function(jc,Zc){if(!Tc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OnDemandMetadataEnabled",!1))return 1;this.Vug();if(this.Odi(jc.range))return this.qPh(jc,Zc);E.ULS.sendTraceTag(537151253,306,15,"Range is not completely contained within the viewport");return 2};k.prototype.TXb=function(jc){this.Wug();this.addHandler("RecognizedTableUpdate",jc)};k.prototype.T5i=
function(jc){this.removeHandler("RecognizedTableUpdate",jc)};k.prototype.y0i=function(){Tc.EwaSettings.la(295)&&Tc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.TableIntelligence",!1)&&(this.augmentationLoopManager.activateAnnotation(v.getTypeName()),this.augmentationLoopManager.bT(v.getTypeName(),this.Gie))};k.prototype.a0i=function(){this.augmentationLoopManager.activateAnnotation(v.getTypeName());this.augmentationLoopManager.bT(v.getTypeName(),this.Gie);Tc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.OnDemandMetadataEnabled",
!1)&&(this.augmentationLoopManager.activateAnnotation(u.getTypeName()),this.augmentationLoopManager.bT(u.getTypeName(),this.dOe))};k.prototype.x0i=function(){this.augmentationLoopManager.activateAnnotation(u.getTypeName());this.augmentationLoopManager.bT(u.getTypeName(),this.dOe)};k.prototype.Wug=function(){Tc.EwaSettings.isChangeGateEnabled("OfficeVSO:590343_RemoveFeatureActivationForTableIntelligence")&&!this.faf&&(this.y0i(),this.faf=!0)};k.prototype.Vug=function(){Tc.EwaSettings.isChangeGateEnabled("OfficeVSO:590343_RemoveFeatureActivationForTableIntelligence")&&
!this.eaf&&(this.eaf=!0,this.x0i())};k.prototype.qPh=function(jc,Zc){E.ULS.sendTraceTag(537151248,306,15,"On-Demand Metadata Triggered");var ud=jc.range;ud=Xd.g(this.$).sl("TableIntelligence",ud,1);for(var Fd=[];ud.$$mn();){var me=ud.$$cu();if(me&&(me.aL.type||!de.a.xn(me.aL.value))){var $e=me.range.top-1,Df=me.range.left-1;Array.add(Fd,Object.assign(new f,{row:$e,column:Df,value:me.aL.value,type:me.aL.type}))}}if(0<Fd.length)return this.p4g(Fd,jc,Zc),0;E.ULS.sendTraceTag(537151247,306,15,"All cells in range were empty");
return 3};k.prototype.p4g=function(jc,Zc,ud){var Fd=Zc.range;Fd=Object.assign(new n,{top:Fd.top,left:Fd.left,bottom:Fd.bottom,right:Fd.right,worksheetId:Zc.sheetId});Zc=se.a.create().toString();jc=Object.assign(new l,{cells:jc,range:Fd,requestId:Zc});this.augmentationLoopManager.pRd(jc);this.NPd.add(Zc,ud)};k.prototype.Odi=function(jc){var Zc=Xd.g(this.$);return Zc.Ca.JZ(4,this.$.oa)&&!!Zc.sc(jc.topLeft)&&!!Zc.sc(jc.bottomLeft)&&!!Zc.sc(jc.topRight)&&!!Zc.sc(jc.bottomRight)};Object(Pc.a)(k,"TableIntelligenceManager",
Mb.a,[3,258]);var le=dc.a;vm(c,le);c.prototype.create=function(){var jc=this;wb.TaskExtensions.Ba(tb.GetServiceTaskFactory.Xa(this.$.da,328,327,1),function(Zc){if(Zc=Zc.result){var ud=jc.$.da.Aa(20);ud||(ud=new k(Zc,jc.$));jc.Fb(ud)}else E.ULS.sendTraceTag(537151246,306,10,"AugmentationLoopManager instance null. Can not create TableIntelligenceManager instance. Creating null service event."),jc.Fb(null)},this.$.ma,3)};c.ja=function(jc){jc.da.Ha(404,new c(jc))};Object(Pc.a)(c,"TableIntelligenceManagerFactory",
dc.a,[]);Object(Pc.a)(d,"TableIntelligenceDarkActivationManager",null,[253]);var we=dc.a;vm(a,we);a.ja=function(jc){jc.da.Ha(481,new a(jc))};a.prototype.create=function(){var jc=this;this.$.da.Aa(480)&&E.ULS.shipAssertTag(526979920,0,!1,"TableIntelligenceDarkActivationManagerFactory: Create called when service already exists in the serviceRegistry for a service managed by FeatureActivationManager. There should only be one initializer for the service");var Zc=tb.GetServiceTaskFactory.Xa(this.$.da,
20,404,1);wb.TaskExtensions.Ba(Zc,function(){jc.Fb(new d(Zc.result))},this.$.ma,3)};Object(Pc.a)(a,"TableIntelligenceDarkActivationManagerFactory",dc.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.DataCleansing");Type.registerNamespace("_Ewa");Eb.a.Yi('.DataCleansingPane{background:#edebe9;height:100%;overflow:hidden;display:flex;flex-direction:column}.DataCleansingPaneHeader{position:relative;overflow:hidden;padding:16px 16px 16px 16px}.DataCleansingPaneBody{flex:auto;position:relative}.DataCleansingPaneTitle{position:relative !important;max-width:230px;display:inline-block;text-overflow:ellipsis;overflow:hidden;height:22px;font-weight:normal;background:#edebe9;font-size:16px;color:#252423;font-family:"Segoe UI Semibold","Segoe UI Web",Arial,Verdana,sans-serif}.DataCleansingCloseButton{display:inline-block;padding:0 5px;font-size:16px}');
(function(){Hc.a.Ga(function(jc){ba.ja(jc);lb.ja(jc);Xc.a.Gd(jc)||I.ja(jc)})})();(function(){Hc.a.Ga(function(jc){ia.ja(jc)})})();(function(){Hc.a.Ga(function(jc){B.ja(jc)})})();(function(){Hc.a.Ga(function(jc){G.ja(jc)})})();(function(){Hc.a.Ga(function(jc){c.ja(jc);a.ja(jc)})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.datacleansing.js.map/e14aa65503a256e8a23e6dcebbab0c43/EwaDS.datacleansing.js.map