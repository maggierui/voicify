(window.dullscriptWebpackJsonp=window.dullscriptWebpackJsonp||[]).push([[33],{1391:function(y,D,b){function a(Jb){var Ic=Zb.call(this)||this;Ic.ln=null;Ic.oA=null;Ic.XNa=function(){Ic.ln.oGb(Ic.XNa);wa.ULS.sendTraceTag(537162849,0,50,"ExcelLiveManager::OnRealTimeChannelInitialized");Ic.Fb(Ic.$.da.Aa(473)||new l(Ic.$,Ic.ln,Ic.oA))};Ic.$=Jb;Ic.dc();return Ic}function d(Jb){this.yIa=this.zIa=this.xv=null;this.Kyb=!1;this.$=Jb;this.Kyb=Yb.e(this.$);this.a4h()}function c(Jb,Ic){Ic=void 0===Ic?null:Ic;
this.container=null;this.En=0;this.OOa=null;this.Ai=!1;Ic&&(this.$=Jb,this.initialize(Ic),this.Ai=Xa.AFrameworkApplication.sa.Pa.Ai)}function k(Jb,Ic){var uc=this;Ic=void 0===Ic?null:Ic;this.Lna=null;this.OTd=this.YQe=!0;this.container=null;this.En=0;this.OOa=this.zya=null;this.lastUpdateTime=0;this.$=null;this.ZYh=function(){uc.OTd||(uc.yNf(),uc.OTd=!0,uc.container.classList.remove("ewa-excelLive-meetingPill-container-hidden"))};Ic&&this.initialize(Jb,Ic);this.$=Jb}function n(Jb){this.pbe=this.obe=
this.nbe=null;this.Hae=void 0;this.$=Jb}function l(Jb,Ic,uc){this.HUa=this.Ygb=this.Gjb=this.nhb=null;this.$=Jb;this.Ybe=Ic;this.pr=new f(this.$);this.wfa=Object(Qb.a)(129,this.ln.Aj);this.HUa=uc;this.N2h()}function f(Jb){this.mhe=this.g4d=this.f4d=this.Sge=this.n3d=this.o3d=this.Tde=0;this.p3d=!1;this.s$d=this.r$d=0;this.m8d=void 0;this.y1d=this.Ide=this.kfe=0;this.$=Jb}function u(Jb,Ic,uc,za){this.controller=this.t5=null;this.$=Jb;this.gridView=Eb.g(this.$);this.pr=za;this.realtimeChannel=Ic;this.controller=
uc;this.Inb();this.sxj();this.Jhj()}function v(Jb,Ic,uc){this.viewBlockContainerHelpers=this.$Mb=this.v_=null;this.Sld=this.RLa=!1;this.s1a=0;this.sPe=10;this.tPe=500;this.uPe=3E4;this.oA=uc;this.realtimeChannel=Ic;this.$=Jb;this.gridView=Eb.g(Jb);this.Fbc=this.Fbc.bind(this);this.vla=this.vla.bind(this);this.sPe=this.$.ya.FetchPresenterNavigationStateMaxRetries;this.tPe=this.$.ya.FetchPresenterNavigationStateRetryBaseInMs;this.uPe=this.$.ya.FetchPresenterNavigationStateRetryMaxDelayInMs;this.initialize()}
function m(Jb,Ic,uc,za){this.statusBarManager=null;this.F$=new A;this.aqd=this.JEb=null;this.P$=this.KEb=0;this.oPe=10;this.pPe=500;this.qPe=3E4;this.lXd=.98;this.yxb=this.UU=this.Bec=this.rxb=this.Bld=this.sxb=this.V5a=this.Rld=!1;this.Hqd=null;this.controller=uc;this.realtimeChannel=Ic;this.$=Jb;this.gridView=Eb.g(Jb);this.pr=za;this.statusBarManager=new x(this.$,this.F$);this.lXd=this.$.ya.ExcelLiveViewportRoundOffFactor;this.oPe=this.$.ya.FetchPresenterNavigationStateMaxRetries;this.pPe=this.$.ya.FetchPresenterNavigationStateRetryBaseInMs;
this.qPe=this.$.ya.FetchPresenterNavigationStateRetryMaxDelayInMs;this.Inb();this.BHg();this.rxc()}function A(){return E.call(this)||this}function x(Jb,Ic){var uc=wb.call(this)||this;uc.statusBarManager=null;uc.M3b=2;uc.Boc=null;uc.aBf=function(za,pb){uc.M3b=pb.M3b;uc.Boc=pb.Boc;uc.gz()};uc.$=Jb;uc.$.da.Za(29,function(za){uc.statusBarManager=za;za.$I(uc)});uc.F$=Ic;uc.F$.XCg(uc.aBf);return uc}function t(Jb,Ic){var uc=Ta.call(this)||this;uc.M3b=Jb;uc.Boc=Ic;return uc}function z(Jb,Ic){Jb=document.getElementById(Jb.Ib+
Pc.a.Y_a);return{dNb:Jb.clientWidth/Ic,aNb:Jb.clientHeight/Ic}}function r(Jb){return Sa.call(this,Jb)||this}function G(Jb,Ic){this.$=Jb;this.excelLiveManager=Ic}function w(){this.rb=null}function B(Jb){this.irg=Jb}function U(Jb){this.Wlg=Jb}function N(){}function P(){}function ia(){}function W(){}function R(Jb,Ic,uc,za){za=void 0===za?null:za;this.Sl=new Gb.a;this.Rog=Jb;this.Hng=Ic;this.ub=uc;this.vhb=za}function I(){}function Q(){}function O(){}function ba(Jb,Ic){this.La=Jb;this.DVa=Ic}function ca(){this.Hw=
this.sm=!1}function S(Jb,Ic,uc,za,pb,cc,Ac,ad,Jd){var Xd=this;this.sm=!1;this.FUb=this.bWa=this.VO=this.Bfa=null;this.Jkb=S.bCc;this.Ya=new Cb.a;this.Gqa=new Y(0);this.Gqa.MTc(Object(ma.a)(this,this.YKi,"onStateMachineChanged"));this.Nqg=Jb;this.nUb=Ic;this.Mqg=uc;this.dOc=za;this.je=pb;this.PS=cc;Ac.execute(function(od){Xd.sm||(Xd.bWa=od,Xd.bWa.IXa(Object(ma.a)(Xd,Xd.Wba,"onUpdateNotificationReceived")),Xd.start())});ad.execute(function(od){Xd.sm||(Xd.FUb=od,od.OXb(Object(ma.a)(Xd,Xd.EAf,"onTokenRefreshed")))});
this.Qfe=Jd}function Y(Jb){this.Ya=new Cb.a;this.Qee=new Date;this.tgb=Jb;this.VFc=0}function na(Jb,Ic,uc,za,pb){var cc=ob.call(this)||this;cc.DCd=Jb;cc.newState=Ic;cc.ZTi=uc;cc.$Ti=za;cc.USj=pb;return cc}function Z(Jb,Ic){var uc=pa.call(this)||this;uc.xSj=Jb;uc.tSj=Ic;return uc}b.r(D);y=b(514);D=b(0);var wa=b(13),ma=b(80),pa=Sys.EventArgs;vm(Z,pa);Object(D.a)(Z,"RtcHostNotificationEventArgs",Sys.EventArgs,[]);var Ia;(function(Jb){Jb[Jb.notYetStarted=0]="notYetStarted";Jb[Jb.polling=1]="polling";
Jb[Jb.subscribed=2]="subscribed";Jb[Jb.blocked=3]="blocked";Jb[Jb.permanentlyStopped=4]="permanentlyStopped"})(Ia||(Ia={}));Object(D.b)("RtcHostNotificationSubscriptionState",Ia);var Ma=b(109),ob=Sys.EventArgs;vm(na,ob);Object(D.a)(na,"StateChangedEventArgs",Sys.EventArgs,[]);var Cb=b(94);Y.prototype.event=function(Jb,Ic){this.currentState!==Jb&&(this.ewh(this.currentState,Jb,this.GJe,void 0===Ic?null:Ic),this.VFc=0,this.Qee=new Date);this.tgb=Jb;this.VFc=this.GJe+1};Y.prototype.ewh=function(Jb,Ic,
uc,za){Jb=new na(Jb,Ic,uc,this.Qee,za);this.Ya.raiseEvent("c",Jb)};Y.prototype.MTc=function(Jb){this.Ya.addHandler("c",Jb)};Y.prototype.hNf=function(Jb){this.Ya.removeHandler("c",Jb)};tl.Object.defineProperties(Y.prototype,{currentState:{configurable:!0,enumerable:!0,get:function(){return this.tgb}},GJe:{configurable:!0,enumerable:!0,get:function(){return this.VFc}}});Object(D.a)(Y,"StateMachine",null,[631]);S.prototype.start=function(){this.Icb?wa.ULS.sendTraceTag(573100178,502,15,"HostNotifications: Tried starting poll when in state {0}",
Ia[this.Icb]):(this.Gqa.event(1),this.gLd(null))};S.prototype.gLd=function(){this.Bfa=null;if(this.Kdf){wa.ULS.sendTraceTag(573100181,502,50,"HostNotifications: Send event when connected.  Current state: {0}",Ia[this.Icb]);var Jb=null;this.dOc&&this.dOc.length&&(Jb={},Jb.etts=this.dOc);this.bWa.fda(14,Jb,!0);this.sSf(this.Nqg)}else this.Gqa.event(3)};S.prototype.sSf=function(Jb){this.Bfa=Ma.a.CBe(1E3*Jb,Object(ma.a)(this,this.gLd,"sendSubscribeEvent"),this.nUb,192,"RtcHostNotificationSubscribe");
this.je.fh(this.Bfa)};S.prototype.$cj=function(Jb){Jb=1E3*(Jb+this.Mqg);var Ic=this.Qfe().getTime()+Jb;this.Jkb=new Date(Ic);Jb-=this.nUb;this.VO?this.je.kma(this.VO,Jb):(this.VO=Ma.a.CBe(Jb,Object(ma.a)(this,this.WDj,"transitionToPollingEvent"),this.nUb/2,194,"RtcHostNotificationTransitionToPolling"),this.je.fh(this.VO))};S.prototype.WDj=function(){this.VO=null;2===this.Icb&&(this.Gqa.event(1),wa.ULS.shipAssertTag(573100185,502,!!this.Bfa,"Missing task to ensure that we re-subscribe."))};S.prototype.EAf=
function(){this.AWh()};S.prototype.AWh=function(){3===this.Icb&&this.Kdf&&(this.Gqa.event(this.a5?2:1),this.gLd(null))};S.prototype.Wba=function(Jb,Ic){if(13===Ic.type&&(Jb=Ic.v7,Ic={},wa.ULS.sendTraceTag(573100183,502,50,"HostNotifications: Subscription status: {0}",(Ic.SerializableHostNotificationSubscription=Jb,Ic.DurationBeforeExpirationToResubscribeInSec=this.nUb,Ic)),Ic=Jb.cts,!this.NFj(Ic))){if(Jb.sb){var uc=2;this.$cj(Jb.cts)}else uc=1,this.Jkb=S.bCc,this.VO&&(this.je.Bp(this.VO),this.VO=
null);this.Gqa.event(uc);this.Bfa?this.je.kma(this.Bfa,1E3*Ic):this.sSf(Ic)}};S.prototype.NFj=function(Jb){if(!isNaN(Jb)&&isFinite(Jb)&&0<Jb)return!1;this.A2f(!1);return!0};S.prototype.A2f=function(Jb){this.Bfa&&(this.je.Bp(this.Bfa),this.Bfa=null);this.VO&&(this.je.Bp(this.VO),this.VO=null);this.bWa&&(this.bWa.sGb(Object(ma.a)(this,this.Wba,"onUpdateNotificationReceived")),this.bWa=null);this.FUb&&(this.FUb.ZGd(Object(ma.a)(this,this.EAf,"onTokenRefreshed")),this.FUb=null);Jb||this.Gqa.event(4)};
S.prototype.YKi=function(Jb,Ic){Jb=Ic.newState;var uc=Ic.DCd,za={};za.NewState=Ia[Jb];za.PreviousState=Ia[uc];za.PreviousStateHits=Ic.ZTi;za.PreviousStateTransitionTime=Ic.$Ti.toISOString();za.IsSubscribed=this.a5;this.Jkb!==S.bCc&&(za.SubscriptionExpiringTime=this.Jkb.toISOString());wa.ULS.sendTraceTag(572346515,502,4===Jb?15:50,"HostNotificationChanged: {0}",za);this.Ya.raiseEvent("HN",new Z(uc,Jb))};S.prototype.dispose=function(){this.sm||(this.sm=!0,this.A2f(!0),this.VO&&(this.je.Bp(this.VO),
this.VO=null))};tl.Object.defineProperties(S.prototype,{Icb:{configurable:!0,enumerable:!0,get:function(){return this.Gqa.currentState}},Kdf:{configurable:!0,enumerable:!0,get:function(){return!this.PS||this.PS.Vef}},a5:{configurable:!0,enumerable:!0,get:function(){return 2===this.Icb&&this.Qfe()<this.Jkb}}});S.bCc=new Date(0);Object(D.a)(S,"RtcHostNotificationSubscriptionManager",null,[617,3]);var Xa=b(5),Sb=b(274),Tb=b(688),da=b(86);ca.prototype.di=function(Jb){var Ic=this;Jb.register(S,"Common.App.RtcHostNotificationSubscription.RtcHostNotificationSubscriptionManager").as("Common.App.RtcHostNotificationSubscription.IRtcHostNotificationSubscriptionManager").zc().Ic(function(){var uc=
Xa.AFrameworkApplication.ga;return new S(uc.zd("RtcHostNotificationRetryIntervalIdeallyInSeconds",1800),uc.zd("RtcHostNotificationRetryIntervalBufferInSeconds",120),uc.zd("RtcHostNotificationSubscriptionLostBufferInSeconds",60),Ic.HQh(uc),Xa.AFrameworkApplication.oj,Tb.SessionStatusManager.instance,Jb.mc("Common.IRealtimeChannelBasic"),Jb.mc("Common.ISessionExpirationManager"),function(){return new Date})})};ca.prototype.init=function(){var Jb=this;Xa.AFrameworkApplication.ga.$v(function(){!Jb.sm&&
Xa.AFrameworkApplication.ga.ra("RtcHostNotificationEnabled")&&(Jb.Hw=!0,da.a.instance.resolve("Common.App.RtcHostNotificationSubscription.IRtcHostNotificationSubscriptionManager"))})};ca.prototype.dispose=function(){this.sm||(this.sm=!0,this.Hw&&da.a.instance.resolve("Common.App.RtcHostNotificationSubscription.RtcHostNotificationSubscriptionManager").dispose())};ca.prototype.HQh=function(Jb){return Jb.Dy("RtcEventTypesToSubscribe")?Jb.Tv("RtcEventTypesToSubscribe"):null};ca.main=function(){Sb.a.instance.mj(new ca)};
tl.Object.defineProperties(ca.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"RtcHostNotificationSubscription"}}});Object(D.a)(ca,"RtcHostNotificationSubscriptionPackage",null,[4,5]);var ya=b(108),hb=b(29);ba.prototype.Mg=function(){this.La.$b(hb.a.Ehf,ya.a.frame,Object(ma.a)(this,this.Fhf,"livePersonaCardActionHandler"))};ba.prototype.XLb=function(){this.La.QC(hb.a.Ehf,ya.a.frame,Object(ma.a)(this,this.Fhf,"livePersonaCardActionHandler"))};ba.prototype.Fhf=function(Jb,Ic,uc,
za,pb){if(!pb||3===uc)return 2;if(1===uc)return this.bXa(this.DVa.Fte(pb.upn||pb.aadObjectId));if(!this.jhh(pb))return 8;switch(pb.action){case 0:return this.bXa(this.DVa.Xvg(pb));case 1:return this.bXa(this.DVa.Wvg(pb));case 2:return this.bXa(this.DVa.Yvg(pb));case 3:return this.bXa(this.DVa.openCard(pb));case 4:return this.bXa(this.DVa.u2i(pb));default:return 2}};ba.prototype.jhh=function(Jb){var Ic=Jb.upn||Jb.aadObjectId;return Jb.targetElement&&(4===Jb.action||Ic&&""!==Ic)?!0:!1};ba.prototype.bXa=
function(Jb){return Jb?32:8};Object(D.a)(ba,"LivePersonaCardActor",null,[]);var Gb=b(139),Qb=b(84);Object(D.a)(O,"BootstrapperConfig",null,[]);Object(D.a)(Q,"LivePersonaCardInitializerResult",null,[]);I.sre=null;Object(D.a)(I,"LivePersonaCardModule",null,[]);var Fb=b(579);R.prototype.init=function(){this.Bbf()?this.Rog.nli().continueWith(Object(ma.a)(this,this.WHi,"onPackageLoaded")):this.Sl.setResult(Object.assign(new Q,{isInitialized:!1,isEnabled:!1,failureMessage:"LivePersonaCard is not enabled."}));
return this.Sl.task};R.prototype.WHi=function(){var Jb=this,Ic=I.sre;if(Ic){var uc=this.NDh();try{Ic.initializeLivePersonaCardAsync(uc).then(function(){Jb.Sl.setResult(Object.assign(new Q,{isInitialized:!0,isEnabled:!0}))}).catch(function(za){var pb=Object(Qb.a)(String,za);pb?Jb.Sl.setException(Error.create(pb)):Jb.Sl.setException(Error.create(JSON.stringify(za)))})}catch(za){this.Sl.setException(za)}}else this.Sl.setResult(Object.assign(new Q,{isInitialized:!1,isEnabled:!0,failureMessage:"LivePersonaCardBootstrapper package is not loaded."}))};
R.prototype.NDh=function(){var Jb=Fb.a.DJ(Xa.AFrameworkApplication.lcid);return Object.assign(new O,{culture:Jb?Jb.name.toLocaleLowerCase():"en-us",clientType:this.ub.Ua("LivePersonaCardClientType"),clientContextType:"Generic",clientCorrelationId:Xa.AFrameworkApplication.userSessionId,complianceEnvironment:this.FFh(),logMessage:Object(ma.a)(this,this.logMessage,"logMessage"),getAuthToken:Object(ma.a)(this,this.getAuthToken,"getAuthToken")})};R.prototype.Bbf=function(){if(!this.ub.ra("LivePersonaCardIsEnabled")||
!this.YEg())return!1;var Jb=this.ub.Ua("SovereignEnvironmentName");return Jb&&""!==Jb?Jb.toLocaleLowerCase()==="USGov".toLocaleLowerCase()||Jb.toLocaleLowerCase()==="Blackforest".toLocaleLowerCase()?!0:!1:!0};R.prototype.YEg=function(){return this.ub.ra("CoauthorGalleryLivePersonaCardIsEnabled")||!!Xa.AFrameworkApplication.sa&&Xa.AFrameworkApplication.sa.Pa.dRa};R.prototype.FFh=function(){return this.ub.Ua("LivePersonaCardComplianceEnvironment")};R.prototype.logMessage=function(Jb,Ic,uc){var za={};
Jb=JSON.stringify((za["Log Type"]=Jb,za["Log Result Type"]=Ic,za.Message=uc,za));wa.ULS.sendTraceTag(50431106,3006,50,Jb)};R.prototype.getAuthToken=function(Jb,Ic){var uc=this;Xa.AFrameworkApplication.ga.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LokiFutureObject")?this.vhb.continueWith(function(za){za.Ch||za.jg?Ic("LokiTokenManagerTask is either canceled or faulted.",Xa.AFrameworkApplication.userSessionId):uc.vhb.result.udd().then(function(pb){pb.isSuccess&&pb.token&&pb.token.length?
Jb(pb.token,Xa.AFrameworkApplication.userSessionId):Ic(pb.errorMessage,Xa.AFrameworkApplication.userSessionId)}).catch(function(pb){return wa.ULS.sendTraceTag(539617039,3006,10,"Unexpected exception received from GetLokiToken: {0}",JSON.stringify(pb))})}):this.Hng.udd().then(function(za){za.isSuccess&&za.token&&za.token.length?Jb(za.token,Xa.AFrameworkApplication.userSessionId):Ic(za.errorMessage,Xa.AFrameworkApplication.userSessionId)}).catch(function(za){return wa.ULS.sendTraceTag(50431107,3006,
10,"Unexpected exception received from GetLokiToken: {0}",JSON.stringify(za))})};Object(D.a)(R,"LivePersonaCardInitializer",null,[]);Object(D.a)(W,"Behavior",null,[]);Object(D.a)(ia,"Identifiers",null,[]);Object(D.a)(P,"LivePersonaCardParameters",null,[]);Object(D.a)(N,"PersonaInfo",null,[]);U.prototype.Fte=function(Jb){return this.Wlg.Bbf()&&Jb&&""!==Jb?!!window.self.LPC:!1};U.prototype.Xvg=function(Jb){return this.PLb("addedPersonaToPageV2",Jb,0)};U.prototype.Wvg=function(Jb){return this.PLb("addedPersonaToPageV2",
Jb,1)};U.prototype.Yvg=function(Jb){return this.PLb("addedPersonaToPageV2",Jb,2)};U.prototype.openCard=function(Jb){return this.PLb("openCard",Jb)};U.prototype.u2i=function(Jb){return this.PLb("removedPersonaFromPage",Jb)};U.prototype.RPg=function(Jb){return!!Jb.targetElement&&(this.Fte(Jb.upn||Jb.aadObjectId)||4===Jb.action)};U.prototype.PLb=function(Jb,Ic,uc){uc=void 0===uc?3:uc;if(!this.RPg(Ic))return!1;uc=4!==Ic.action?this.M2g(Ic,uc):null;var za=window.self.LPC;if(za&&za[Jb]){if(uc)za[Jb](Ic.targetElement,
uc);else za[Jb](Ic.targetElement);return!0}return!1};U.prototype.M2g=function(Jb,Ic){Ic=void 0===Ic?3:Ic;var uc=Object.assign(new ia,{PersonaType:"User",Upn:Jb.upn,AadObjectId:Jb.aadObjectId});return Object.assign(new P,{personaInfo:Object.assign(new N,{identifiers:uc,displayName:Jb.name,personaCoinColor:Jb.color}),behavior:Object.assign(new W,{onCardOpen:function(){wa.ULS.sendTraceTag(595067869,3006,100,"LivePersonaCard opened");if(Jb.onCardOpen)Jb.onCardOpen()},onCardClose:Jb.onCardClose,disableClick:2===
Ic||3===Ic,disableHover:!Ic||3===Ic})})};Object(D.a)(U,"LivePersonaCardManager",null,[]);B.prototype.nli=function(){var Jb=Xa.AFrameworkApplication.D6("midgardbootstrapper.js",5);return this.irg.Brd(Jb).continueWith(function(){I.sre=window.self.MidgardBootstrapper})};Object(D.a)(B,"LivePersonaCardPackageLoader",null,[616]);var ta=b(524);w.prototype.init=function(){Xa.AFrameworkApplication.ga&&Xa.AFrameworkApplication.ga.$v(Object(ma.a)(this,this.QA,"onFullAppSettingsReady"))};w.prototype.dispose=
function(){};w.prototype.di=function(Jb){this.rb=Jb};w.prototype.QA=function(){var Jb=Xa.AFrameworkApplication.ga.isChangeGateEnabled("Microsoft.Office.SharedOnline.ChangeGate.LokiFutureObject")?new R(new B(this.rb.resolve("Common.ISharedDependencyLoader")),null,Xa.AFrameworkApplication.ga,ta.a.Fq(this.rb.mc("Common.ILokiTokenManager"))):new R(new B(this.rb.resolve("Common.ISharedDependencyLoader")),this.rb.resolve("Common.ILokiTokenManager"),Xa.AFrameworkApplication.ga);Jb.init().continueWith(function(Ic){Ic.jg&&
Ic.mg?wa.ULS.sendTraceTag(50431108,3006,15,"Failed to initialize LivePersonaCard, exception: [{0}]",Ic.mg.message):((Ic=Ic.result)||wa.ULS.sendTraceTag(595067868,3006,15,"LivePersonaCardInitializer did not return a result"),Ic.isInitialized?wa.ULS.sendTraceTag(50431109,3006,100,"Successfully initialized LivePersonaCard"):wa.ULS.sendTraceTag(595067867,3006,Ic.isEnabled?15:100,"Failed to initialize LivePersonaCard, failure message: [{0}]",Ic.failureMessage))});(new ba(Xa.AFrameworkApplication.Eb,new U(Jb))).Mg()};
w.main=function(){Sb.a.instance.mj(new w)};tl.Object.defineProperties(w.prototype,{name:{configurable:!0,enumerable:!0,get:function(){return"Common.App.LivePersonaCard"}}});Object(D.a)(w,"LivePersonaCardPackage",null,[4,5]);var xa=b(10),sa=b(817),lb=b(35),Yb=b(189),Fa=b(175);G.prototype.Xc=function(){return!1};G.prototype.Gc=function(Jb,Ic){switch(Ic.command){case 1491932557:return Yb.e(this.$)&&2===this.excelLiveManager.TDb.En;case -440259636:return Yb.d(this.$)&&2===this.excelLiveManager.TDb.En;
default:return!1}};G.prototype.executeCommand=function(Jb,Ic){Jb=lb.TaskExtensions.om();var uc=Ic.command;switch(Ic.command){case -440259636:this.excelLiveManager.Wfd();break;case 1491932557:this.excelLiveManager.$Rd();break;default:Jb=Fa.a(uc)}return Jb};G.prototype.fd=function(){return!1};Object(D.a)(G,"ExcelLiveCommandHandler",null,[237]);var Sa=sa.a;vm(r,Sa);r.prototype.Md=function(){var Jb=this;this.$.da.Za(473,function(Ic){Jb.Ed([new G(Jb.$,Ic)])})};r.ja=function(Jb){sa.a.de(469,new r(Jb))};
Object(D.a)(r,"ExcelLiveCommandHandlerFactory",sa.a,[]);var Ra=b(216),Lb=b(9),Ja=b(45),xb=b(24),Kb=b(43),Eb=b(20),Hc=b(227),Xc=b(34),Pc=b(4),wd=b(121),Tc=b(44),ub=b(260),fb=b(8),Ta=Sys.EventArgs;vm(t,Ta);Object(D.a)(t,"ExcelLiveViewStateChangedArgs",Sys.EventArgs,[]);var eb=b(36),tb;(function(Jb){Jb[Jb.complete=0]="complete";Jb[Jb.nonComplete=1]="nonComplete";Jb[Jb.unknown=2]="unknown"})(tb||(tb={}));Object(D.b)("FollowerViewState",tb);var rc=b(1),wb=eb.a;vm(x,wb);x.prototype.iq=function(Jb){this.addHandler("followerViewStateInfoChanged",
Jb)};x.prototype.zq=function(Jb){this.removeHandler("followerViewStateInfoChanged",Jb)};x.prototype.gz=function(){this.gn("QueryExcelLiveViewState")&&this.raiseEvent("followerViewStateInfoChanged")};x.prototype.Jr=function(Jb,Ic){return"QueryExcelLiveViewState"!==Jb?!1:this.hYh(Ic)};x.prototype.gn=function(){return Object(Yb.e)(this.$)&&rc.EwaSettings.getBooleanFeatureGate("Microsoft.Office.Excel.ShowExcelLiveViewStateInStatusBar",!1)};x.prototype.dispose=function(){this.statusBarManager&&(this.statusBarManager.iF(this),
this.statusBarManager=null);this.F$.I6i(this.aBf);this.$=this.F$=null;wb.prototype.dispose.call(this)};x.prototype.hYh=function(Jb){if(!this.$)return!1;Jb.Value=String.format("View State: {0} | Presenter Visible Range: {1}",tb[this.M3b],this.Boc);return!0};Object(D.a)(x,"ExcelLiveStatusBarManager",eb.a,[3,281,233]);var E=eb.a;vm(A,E);A.prototype.XCg=function(Jb){this.addHandler("FollowerViewStateChanged",Jb)};A.prototype.I6i=function(Jb){this.removeHandler("FollowerViewStateChanged",Jb)};A.prototype.WWi=
function(Jb){this.raiseEvent("FollowerViewStateChanged",Jb)};Object(D.a)(A,"ExcelLiveFollowerOrExplorerEventManager",eb.a,[]);m.prototype.dispose=function(){this.g$g();2!==this.controller.En&&(this.EEe(),this.Pqb());this.gridView=this.$=this.controller=this.realtimeChannel=this.aqd=this.Mqd=this.M6a=this.Hqd=this.JEb=null};m.prototype.$Rd=function(){this.pr.ZRd=fb.HelperMethods.jc();this.rxc(!0)};m.prototype.rxc=function(Jb,Ic){var uc=this;Jb=void 0===Jb?!1:Jb;Ic=void 0===Ic?null:Ic;var za;Jb&&this.pr.Aoi();
if(Ic)this.QKb(Ic)?this.Jjd():wa.ULS.sendTraceTag(527496925,0,15,"ExcelLiveFollowerOrExplorer::syncToPresenterInternalWithRetry: Could not sync to presenter from presence update"),this.P$=0;else if(++this.P$,this.P$>this.oPe)wa.ULS.sendTraceTag(527496924,0,10,"ExcelLiveFollowerOrExplorer::syncToPresenterInternalWithRetry: Presenter Nav State not available after "+(this.P$-1)+" retries."),this.Rld=!0,this.P$=0;else{if(1===this.P$){var pb=null!==(za=this.aqd)&&void 0!==za?za:this.JEb;if(null!==pb&&
this.QKb(pb,!0)){this.Jjd(Jb,!0);this.P$=0;return}}(za=this.q9c())&&this.QKb(za)?(this.Jjd(Jb,!0),this.P$=0):1!==this.controller.En&&(this.controller.Wna(3,"ExcelLiveFollowerOrExplorer::syncToPresenterInternalWithRetry"),wa.ULS.sendTraceTag(527496923,0,15,"ExcelLiveFollowerOrExplorer::syncToPresenterInternalWithRetry: Retry\n           "+this.P$+" - Presenter Nav State not available."),Tc.a.instance.create(function(){uc.rxc(Jb,Ic)},ub.a.Qua(this.P$,this.pPe,this.qPe,!0),"ExcelLiveFollowerOrExplorer::syncToPresenterInternalWithRetry",
void 0,!0))}};m.prototype.Jjd=function(Jb,Ic){Jb=void 0===Jb?!1:Jb;Ic=void 0===Ic?!1:Ic;this.controller.Wna(1,"ExcelLiveFollowerOrExplorer::initializeFollower");this.AHg();this.xZb();this.Rld=!1;Jb&&this.pr.zoi(Ic)};m.prototype.Inb=function(){this.vla=this.vla.bind(this);this.Nx=this.Nx.bind(this);this.zC=this.zC.bind(this);this.Kf=this.Kf.bind(this);this.Tmc=this.Tmc.bind(this);this.Mj=this.Mj.bind(this);this.Pkc=this.Pkc.bind(this);this.aj=this.aj.bind(this);this.Lmc=this.Lmc.bind(this);this.Nlc=
this.Nlc.bind(this);this.LNa=this.LNa.bind(this);this.Zmc=this.Zmc.bind(this);this.onScroll=this.onScroll.bind(this);this.X8a=this.X8a.bind(this);this.qd=this.qd.bind(this);this.E8a=this.E8a.bind(this);this.wlc=this.wlc.bind(this);this.Oe=this.Oe.bind(this)};m.prototype.nPe=function(){var Jb=this.q9c();return this.QKb(Jb)};m.prototype.q9c=function(Jb){Jb=void 0===Jb?null:Jb;if(Jb=null!==Jb&&void 0!==Jb?Jb:this.realtimeChannel.ebd())for(var Ic in Jb){var uc=Ic,za=Jb[Ic];if(!za)break;if(za.NavigationState&&
za.MeetingInfo&&(za.MeetingInfo.MeetingId===this.$.ya.MeetingId||Yb.b()))return this.controller.lR&&this.controller.lR===uc||this.controller.ysc(uc,"ExcelLiveFollowerOrExplorer:extractNavigationStateFromMeetingPresence"),za.NavigationState}return null};m.prototype.QKb=function(Jb,Ic){Ic=void 0===Ic?!1:Ic;var uc=fb.HelperMethods.jc(),za=this.mXg(Jb,this.JEb,Ic);if(0===za)return this.FRf(za,Jb),!1;if(!this.IFj(Jb.SheetID))return!0;za&4&&this.setZoom(this.JEb,Jb);Ic=this.iXg(Jb);this.Mzj(Jb,za,Ic);this.FRf(za,
Jb);Jb=Kb.D(Jb.VisibleAreaRange);this.F$.WWi(new t(Ic,Jb.toString()));this.pr.KDj(Ic,uc);return!0};m.prototype.Mzj=function(Jb,Ic,uc){this.sxb=!0;0===uc?this.W3f(Ic,Jb):this.Nzj(Ic,Jb)};m.prototype.FRf=function(Jb,Ic){this.JEb=Ic;this.KEb=Jb};m.prototype.IFj=function(Jb){this.Hqd=Jb=this.$.xa.getItemByName(Jb);if(!Jb)return this.yxb=!0,!1;if(Jb!==this.$.oa){if(!Jb.visible)return!1;this.V5a=!0;Jb.activate()}return!0};m.prototype.setZoom=function(Jb,Ic){Jb&&Jb.SheetID===Ic.SheetID&&(Jb=(Ic.ZoomLevel-
Jb.ZoomLevel)/Jb.ZoomLevel*100,Ic=Xc.a(this.$).zoom,Jb=Ic+Ic*Jb/100,Xc.a(this.$).Ycg(Jb),this.pr.bYd=fb.HelperMethods.jc())};m.prototype.W3f=function(Jb,Ic){Jb&2&&(Jb=Kb.D(Ic.VisibleAreaRange),this.M6a=xb.Range.ld(Jb.top,Jb.left),this.Mqd=new Ja.a(Ic.TopLeftCellOffsets.X,Ic.TopLeftCellOffsets.Y),Ic=Hc.a(this.M6a,this.Mqd,this.gridView.ns,this.gridView.$a,0,0,this.$,this.gridView.Z3()),this.gridView.qYb(Ic,this.M6a,60,this.M6a,"ExcelLiveFollowerOrExplorerApp.SyncViewportToMatchOrigin"))};m.prototype.Nzj=
function(Jb,Ic){var uc=Kb.D(Ic.SelectedRanges[Ic.IndexOfActiveRange]),za=Jb!==this.KEb,pb=Kb.D(Ic.VisibleAreaRange);Jb&1?(this.xOj=this.gridView.T9b(),this.gridView.yt(uc,64,"ExcelLiveFollowerOrExplorer.syncViewportForNonCompleteViewState",!0),Jb=this.gridView.f4(),this.M6a=Jb.CF,this.Mqd=Jb.hz,za&&this.gridView.eTc(this.wlc)):Jb&2&&(!pb.Rd(uc)||this.KEb&2||this.KEb&4)&&(this.W3f(Jb,Ic),za&&this.pr.Xif(),this.pr.LAc=fb.HelperMethods.jc())};m.prototype.f_h=function(Jb){var Ic=this.gridView.T9b();return Ic.Rd(Jb)&&
Jb.Rd(Ic)?!0:!1};m.prototype.mXg=function(Jb,Ic,uc){uc=void 0===uc?!1:uc;if(null===Ic&&null===Jb)return 0;if(null===Ic&&Jb||uc)return 7;if(null!==Jb){var za=Kb.D(Jb.SelectedRanges[Jb.IndexOfActiveRange]);var pb=Kb.D(Ic.SelectedRanges[Ic.IndexOfActiveRange]),cc=Kb.D(Jb.VisibleAreaRange),Ac=Kb.D(Ic.VisibleAreaRange);za=null==Jb||Ic.SheetID!=Jb.SheetID||Ic.ZoomLevel!=Jb.ZoomLevel||!za.equals(pb)||!cc.equals(Ac)||Ic.TopLeftCellOffsets.X!=Jb.TopLeftCellOffsets.X||Ic.TopLeftCellOffsets.Y!=Jb.TopLeftCellOffsets.Y}else za=
void 0;if(!za)return uc?7:0;za=Kb.D(Jb.VisibleAreaRange);uc=Kb.D(Jb.SelectedRanges[Jb.IndexOfActiveRange]);za=xb.Range.ld(za.top,za.left);pb=new Ja.a(Jb.TopLeftCellOffsets.X,Jb.TopLeftCellOffsets.Y);Ac=Kb.D(Ic.VisibleAreaRange);cc=Kb.D(Ic.SelectedRanges[Ic.IndexOfActiveRange]);Ac=xb.Range.ld(Ac.top,Ac.left);var ad=new Ja.a(Ic.TopLeftCellOffsets.X,Ic.TopLeftCellOffsets.Y),Jd=0;cc.equals(uc)&&Jb.SheetID===Ic.SheetID||(Jd|=1);Jb.ZoomLevel!==Ic.ZoomLevel&&(Jd|=4);pb.equals(ad)&&za.equals(Ac)||(Jd|=2);
return Jd^0?Jd:0};m.prototype.iXg=function(Jb){var Ic=z(this.$,Xc.a(this.$).zoom),uc=Ic.aNb;return Ic.dNb<Jb.ViewportWidth*this.lXd||uc<Jb.ViewportHeight*this.lXd?1:0};m.prototype.AHg=function(){var Jb=this;this.$.fa.ED(this.Nx);this.$.fa.DXa(this.zC);this.$.da.Za(419,function(Ic){Ic.Zle(Jb.X8a);Ic.$le(Jb.X8a)})};m.prototype.EEe=function(){var Jb=this;this.$&&(this.$.fa.TC(this.Nx),this.$.fa.V$a(this.zC),this.$.da.Za(419,function(Ic){Ic.nNf(Jb.X8a);Ic.oNf(Jb.X8a)}))};m.prototype.X8a=function(){this.pr.LDj()};
m.prototype.Nx=function(){this.$.fa.rf!==Lb.a.Se&&this.$.fa.oc&&(this.yxb&&this.$.fa.jt(this.Kf),this.UU=!0)};m.prototype.Kf=function(){(this.UU||this.yxb)&&this.nPe()&&(this.$.fa.mw(this.Kf),this.yxb=this.UU=!1)};m.prototype.zC=function(){this.V5a?this.V5a=!1:this.UU&&this.nPe()&&(this.UU=!1)};m.prototype.xZb=function(){var Jb=this;this.gridView.JXa(this.Tmc);this.gridView.Kc.wm(this.Mj);this.$.USc(this.Pkc);this.$.Yz(this.aj);this.gridView.Ake(this.LNa);this.$.da.Za(419,function(Ic){Ic.dDg(Jb.Zmc)});
this.$.da.Za(65,function(Ic){Ic.tBg(Jb.Lmc)})};m.prototype.Pqb=function(){this.gridView&&(this.gridView.aab(this.Tmc),this.gridView.Kc.im(this.Mj),this.gridView.iMf(this.LNa));this.$&&(this.$.zGd(this.Pkc),this.$.RC(this.aj));var Jb=this.$.da.Aa(419);Jb&&Jb.M6i(this.Zmc);(Jb=this.$.da.Aa(65))&&Jb.w5i(this.Lmc)};m.prototype.Tmc=function(){this.rxb?this.rxb=!1:this.Bec||this.V5a||this.sxb||this.ihi()||(this.Bld?this.Bld=!1:this.RNa())};m.prototype.ihi=function(){var Jb=this.gridView.f4().CF;return this.Hqd===
this.$.oa&&Jb.equals(this.M6a)?!0:!1};m.prototype.Mj=function(){this.RNa()};m.prototype.Pkc=function(){this.rxb=!0};m.prototype.aj=function(){this.rxb=!0};m.prototype.Zmc=function(){this.Bec=!0};m.prototype.LNa=function(){this.Bec=!1};m.prototype.onScroll=function(Jb){this.sxb&&1===this.controller.En&&(this.sxb=!1,this.Bld=!0);Jb.stopPropagation()};m.prototype.Lmc=function(){this.RNa()};m.prototype.RNa=function(){this.U9i();this.pr.JDj(this.KEb);this.controller.Wna(2,"ExcelLiveFollowerOrExplorer::onExploreActionsObserved");
this.EEe();this.Pqb()};m.prototype.BHg=function(){this.realtimeChannel.fFa(this.vla);this.$.fa.cle(this.Nlc);wd.a.instance.Cd(this.gridView.domElement).ja("scroll",this.onScroll);this.$.Vl(this.qd);this.$.oa.ye.GXa(this.E8a);this.$.oa.ye.LXb(this.E8a);this.$.xa.Pf(this.Oe)};m.prototype.g$g=function(){this.realtimeChannel&&this.realtimeChannel.dza(this.vla);null!==this.$&&(this.$.fa.h5i(this.Nlc),this.$.Fn(this.qd),this.$.oa.ye.kGb(this.E8a),this.$.oa.ye.VGd(this.E8a),this.$.xa.rg(this.Oe))};m.prototype.vla=
function(Jb,Ic){this.VCd(Ic.i3);this.aDd(Ic.iO)};m.prototype.VCd=function(Jb){var Ic=this;!Jb||1>Jb.length||2===this.controller.En||Jb.forEach(function(uc){uc===Ic.controller.lR&&(Ic.controller.kqc(),Ic.controller.Wna(3,"ExcelLiveFollowerOrExplorer:processDisconnectedClients"))})};m.prototype.aDd=function(Jb){!Jb||1>Jb.length||(Jb=this.q9c(Jb),null!==Jb&&(this.aqd=Jb,2!==this.controller.En&&(3===this.controller.En?this.rxc(this.Rld,Jb):this.QKb(Jb))))};m.prototype.U9i=function(){this.yxb=this.sxb=
this.V5a=this.rxb=this.Bec=!1};m.prototype.Nlc=function(){1===this.controller.En?this.RNa():this.pr.NOe=!0};m.prototype.E8a=function(Jb,Ic){this.pr.ODj(Ic)};m.prototype.Oe=function(){this.V5a||this.RNa()};m.prototype.qd=function(Jb,Ic){Ic.Qg||this.pr.Wmi()};m.prototype.wlc=function(){this.gridView.LGd(this.wlc);this.f_h(this.xOj)&&this.pr.Xif()};Object(D.a)(m,"ExcelLiveFollowerOrExplorer",null,[]);var Mb=b(110),ka=b(28),bb=b(56),Ga=b(103),Ha=b(374),Ua=b(14);v.prototype.dispose=function(){this.Pqb();
this.j$g();this.$=this.gridView=this.viewBlockContainerHelpers=this.$Mb=this.realtimeChannel=this.POa=this.oA=null};v.prototype.Wfd=function(){wa.ULS.sendTraceTag(537162846,0,50,"ExcelLiveParticipantV0.GoToPresenter - UI action performed");this.POa&&this.POa.Ks&&Ha.a.sy.notificationBar.removeEntry(this.POa);if(this.Sld)this.b0f(),wa.ULS.sendTraceTag(537162845,0,50,"ExcelLiveParticipantV0.GoToPresenter - UI action ignored due to floating object selection.");else{var Jb=!0;this.RLa||(Jb=this.AVh());
Jb?this.Q1f():this.b0f()}};v.prototype.b0f=function(){this.POa||(this.POa=Ha.a.sy.notificationBar.l$(Ua.a.instance.ea(2199),!1),this.POa.image=0);Ha.a.sy.notificationBar.BD(this.POa);wa.ULS.sendTraceTag(528786756,0,50,"ExcelLiveParticipantV0.GoToPresenter - Action not performed. Location not available.")};v.prototype.initialize=function(){Yb.c(this.$)?(this.O2h(),this.xZb()):(this.QHg(),this.A7e())};v.prototype.O2h=function(){this.oA.Wna(0)};v.prototype.A7e=function(){var Jb=this;++this.s1a;if(this.s1a>
this.sPe)wa.ULS.sendTraceTag(527766151,0,10,"ExcelLiveParticipantV0::initFollowerOrExplorerRetryable: Presenter data not available after "+(this.s1a-1)+" retries.");else{var Ic=this.rPe();Ic?this.y7e(Ic):(wa.ULS.sendTraceTag(527766150,0,15,"ExcelLiveParticipantV0::initFollowerOrExplorerRetryable: Retry "+this.s1a+" - Presenter data not available."),Tc.a.instance.create(function(){Jb.A7e()},ub.a.Qua(this.s1a,this.tPe,this.uPe,!0),"ExcelLiveParticipantV0::initFollowerOrExplorerRetryable",void 0,!0))}};
v.prototype.y7e=function(Jb){Jb?(this.s1a=0,wa.ULS.sendTraceTag(537162844,0,50,"ExcelLiveParticipantV0::InitExcelLiveFollowerOrExplorer: Update received from presenter with CID: "+this.oA.lR),this.v_=Jb,this.FJe(),this.RLa&&3===this.oA.En?this.Q1f():this.RLa||this.O1f("ExcelLiveParticipantV0::InitExcelLiveFollowerOrExplorer")):wa.ULS.sendTraceTag(527766149,0,15,"ExcelLiveParticipantV0::InitExcelLiveFollowerOrExplorer: Presenter selection is null.")};v.prototype.Q1f=function(){this.oA.Wna(1,"ExcelLiveParticipantV0::startFollowing");
this.xZb()};v.prototype.O1f=function(Jb){this.oA.Wna(2,Jb);this.Pqb()};v.prototype.QHg=function(){this.realtimeChannel.fFa(this.vla)};v.prototype.j$g=function(){this.realtimeChannel.dza(this.vla)};v.prototype.xZb=function(){this.gridView.JXa(this.Fbc)};v.prototype.Pqb=function(){this.gridView.aab(this.Fbc)};v.prototype.vla=function(Jb,Ic){this.VCd(Ic.i3);this.aDd(Ic.iO)};v.prototype.VCd=function(Jb){var Ic=this;!Jb||1>Jb.length||Jb.forEach(function(uc){uc===Ic.oA.lR&&(Ic.v_=void 0,Ic.oA.kqc(),Ic.oA.Wna(3,
"ExcelLiveParticipantV0::onMeetingPresenceUpdated"))})};v.prototype.aDd=function(Jb){!Jb||1>Jb.length||(Jb=this.rPe(Jb),this.y7e(Jb))};v.prototype.Fbc=function(){var Jb=this;if(0===this.oA.En)wa.ULS.sendTraceTag(529064851,0,50,"ExcelLiveParticipantV0::HandleViewportChanged: Viewport changed for presenter.");else if(!this.$Mb||this.$Mb&&!this.$Mb.Qo)this.$Mb=Tc.a.instance.create(function(){Jb.RNa()},500,"ExcelLiveParticipantV0.HandleViewportChanged",void 0,!0)};v.prototype.RNa=function(){wa.ULS.sendTraceTag(529064849,
0,50,"ExcelLiveParticipantV0::onExploreActionsObserved: Explore action observed.");this.FJe();this.RLa||this.O1f("ExcelLiveParticipantV0::onExploreActionsObserved")};v.prototype.rPe=function(Jb){Jb=(void 0===Jb?null:Jb)||this.realtimeChannel.ebd();if(!Jb)return null;this.oA.lR||this.v1h(Jb);return this.oA.lR&&(Jb=Jb[this.oA.lR])?Jb.SelectedRange:null};v.prototype.v1h=function(Jb){for(var Ic in Jb){var uc=Ic,za=Jb[Ic];if((null===za||void 0===za?0:za.MeetingInfo)&&za.MeetingInfo.IsPresenter&&za.MeetingInfo.MeetingId===
this.$.ya.MeetingId){this.oA.ysc(uc,"ExcelLiveParticipantV0:identifyPresenterFromPresenceData");break}}};v.prototype.FJe=function(){if(this.v_){var Jb=this.v_.length;wa.ULS.sendTraceTag(537162840,0,50,"ExcelLiveParticipantV0::EvaluateIfPresenterRangeIntersectingWithCurrentViewport: Called with {0} presenter ranges to evaluate against viewport with [SheetName: {1}, TopLeftCell: {2}, BottomRightCell: {3}]",Jb,this.$.oa?this.$.oa.sheetName:null,Mb.a.toJSON(this.gridView.QG()),Mb.a.toJSON(this.gridView.oUe()));
for(var Ic=0;Ic<Jb;Ic++){var uc=this.v_[Ic].NamedObjectName;wa.ULS.sendTraceTag(529064848,0,50,"ExcelLiveParticipantV0::EvaluateIfPresenterRangeIntersectingWithCurrentViewport: Evaluating the following range for intersection: [{0}]",Mb.a.toJSON(this.v_[Ic]));if(ka.a.jZc(uc)){if(wa.ULS.sendTraceTag(537162837,0,50,"ExcelLiveParticipantV0::EvaluateIfPresenterRangeIntersectingWithCurrentViewport: Floating object selection evaluated to false"),this.Sld=!1,this.v_[Ic].SheetName===this.$.xa.oa.sheetName&&
this.gridView.HZ(Kb.D(this.v_[Ic]))){wa.ULS.sendTraceTag(537162836,0,50,"ExcelLiveParticipantV0::EvaluateIfPresenterRangeIntersectingWithCurrentViewport: Presenter selection intersection evaluated to true");this.RLa=!0;return}}else if(wa.ULS.sendTraceTag(537162839,0,50,"ExcelLiveParticipantV0::EvaluateIfPresenterRangeIntersectingWithCurrentViewport: Floating object selection evaluated to true"),this.Sld=!0,this.v_[Ic].SheetName===this.$.xa.oa.sheetName&&this.Jai(uc)){wa.ULS.sendTraceTag(537162838,
0,50,"ExcelLiveParticipantV0::EvaluateIfPresenterRangeIntersectingWithCurrentViewport: Presenter selection intersection evaluated to true");this.RLa=!0;return}}wa.ULS.sendTraceTag(537162835,0,50,"ExcelLiveParticipantV0::EvaluateIfPresenterRangeIntersectingWithCurrentViewport: Presenter selection intersection evaluated to false")}this.RLa=!1};v.prototype.Jai=function(Jb){var Ic=this;Jb=Ga.a(this.$).Hp(Jb);if(!Jb||!Jb.floatingObject||!Jb.domElement)return!1;this.viewBlockContainerHelpers||lb.TaskExtensions.Ba(bb.GetServiceTaskFactory.Xa(this.$.da,
103,104,0),function(za){Ic.viewBlockContainerHelpers=za.result},this.$.ma,8);if(!this.viewBlockContainerHelpers)return!1;var uc=this.viewBlockContainerHelpers.iZ(Jb.Bg,Jb.domElement);wa.ULS.sendTraceTag(529065985,0,50,"ExcelLiveParticipantV0::IsFoSelectedByPresenterIntersectingWithCurrentViewport: Floating object viewport area TopLeft:[{0}], BottomRight:[{1}]",Mb.a.toJSON(uc.topLeft),Mb.a.toJSON(uc.bottomRight));return Jb.Bg.Dn.Rd(uc)?!0:!1};v.prototype.AVh=function(){wa.ULS.sendTraceTag(537162834,
0,50,"ExcelLiveParticipantV0.GoToPresenterLocation - Update participant viewport");var Jb=this.v_&&0<this.v_.length?this.v_[0]:null;if(!Jb||!Jb.SheetName)return!1;var Ic=this.$.xa.getItemByName(Jb.SheetName);if(!Ic||Ic!==this.$.oa&&!Ic.visible)return wa.ULS.sendTraceTag(529109851,0,15,"ExcelLiveParticipantV0.GoToPresenterLocation - sheet not available"),!1;Ic!==this.$.oa&&Ic.activate();this.gridView.yt(Kb.D(Jb),3,"ExcelLiveParticipantV0.GoToPresenterLocation");return!0};Object(D.a)(v,"ExcelLiveParticipantV0",
null,[]);u.prototype.dispose=function(){this.l$g();this.gridView=this.$=this.realtimeChannel=this.controller=null};u.prototype.Inb=function(){this.ylc=this.ylc.bind(this);this.gva=this.gva.bind(this);this.pbc=this.pbc.bind(this);this.qd=this.qd.bind(this)};u.prototype.sxj=function(){this.HBd();this.$Hg()};u.prototype.$Hg=function(){this.$.xa.aJ(this.pbc);this.gridView.JXa(this.gva);this.gridView.ha.iG(this.gva);this.$.Vl(this.qd)};u.prototype.l$g=function(){this.$&&(this.$.xa.kF(this.pbc),this.$.Fn(this.qd));
this.gridView&&(this.gridView.aab(this.gva),this.gridView.ha.DK(this.gva))};u.prototype.pbc=function(){this.gridView.aab(this.gva);this.gridView.hT(this.ylc)};u.prototype.ylc=function(){this.HBd();this.gridView.wN(this.ylc);this.gridView.JXa(this.gva)};u.prototype.gva=function(){this.$.xa&&this.$.xa.v9e||this.HBd()};u.prototype.qd=function(Jb,Ic){Ic.Qg||this.pr.Vni()};u.prototype.zGh=function(){var Jb=fb.HelperMethods.jc(),Ic=this.gridView.T9b();if(null===Ic)return null;var uc=this.gridView.f4().hz;
var za={};za.SheetID=this.$.oa?this.$.oa.sheetName:null;za.ZoomLevel=Xc.a(this.$).zoom;za.SelectedRanges=Kb.k(this.gridView.ha.va.selectedRanges,this.$);za.IndexOfActiveRange=this.gridView.ha.va.wA;za.VisibleAreaRange=Kb.v(Ic,this.$);za.TopLeftCellOffsets={};za.TopLeftCellOffsets.X=uc.x;za.TopLeftCellOffsets.Y=uc.y;uc=z(this.$,za.ZoomLevel);var pb=uc.dNb;za.ViewportHeight=uc.aNb;za.ViewportWidth=pb;this.pr.MDj(Ic);this.pr.Ywa(fb.HelperMethods.jc()-Jb,"ExcelLivePresenter.getCurrentViewportNavigationState: TimeToCreateNavigationState");
return za};u.prototype.Jhj=function(){this.t5={};this.t5.MeetingId=this.$.ya.MeetingId;this.t5.IsPresenter=!0};u.prototype.HBd=function(){var Jb=this.zGh();if(null===Jb)wa.ULS.sendTraceTag(527962826,0,15,"ExcelLivePresenter:postViewportUpdatesToMeetingParticipants CurrentViewportNavigationState is null");else{var Ic={};Ic.MeetingInfo=this.t5;Ic.NavigationState=Jb;this.realtimeChannel.LTf(Ic)}};Object(D.a)(u,"ExcelLivePresenter",null,[]);var kb=b(648),$a;(function(Jb){Jb[Jb.none=0]="none";Jb[Jb.selection=
1]="selection";Jb[Jb.scroll=2]="scroll";Jb[Jb.zoom=4]="zoom";Jb[Jb.default=0]="default"})($a||($a={}));Object(D.b)("UpdateType",$a);var Xb=b(52);f.prototype.dispose=function(){};f.prototype.Wmi=function(){var Jb={};Jb.FollowerViewState=0<this.I$c?"Hybrid":tb[this.Dhc];Jb.FollowerViewStateTransitions=this.I$c;Jb.FollowerZoomInOppositeDirectionCount=this.NRe;Jb.ExplorerConsumptionTrends=this.NOe?"WorkbookEdited":"WorkbookViewed";Jb.ExplorerNSVModeTrends=this.hpf;Jb.ExplorerNSVSwitchTrends=this.ipf;
Jb=Xb.a.Hc(Jb);this.$.sendBeaconTraceTag(526987797,50,!1,"ExcelLiveFollowerOrExplorer.logFollowerOrExplorerTelemetry: "+Jb)};f.prototype.Xif=function(){2E3>fb.HelperMethods.jc()-this.LAc&&(this.Ywa(fb.HelperMethods.jc()-this.LAc,"ExcelLiveFollowerOrExplorer.logNonCompleteViewStateTelemetry: TimeElapsedSinceLastViewportChange"),this.LAc=0)};f.prototype.Ywa=function(Jb,Ic){wa.ULS.sendTraceTag(527499614,0,50,Ic+" = "+Jb)};f.prototype.KDj=function(Jb,Ic){this.Dhc&&Jb!==this.Dhc&&++this.I$c;this.Dhc=Jb;
this.Ywa(fb.HelperMethods.jc()-Ic,"ExcelLiveFollowerOrExplorer.trackAndLogFollowerViewStateTransitions: TimeElapsedInSyncingFollower")};f.prototype.JDj=function(Jb){this.W8c=fb.HelperMethods.jc();++this.MOe;1===this.MOe&&this.Ywa(fb.HelperMethods.jc()-this.sessionStartTime,"ExcelLiveFollowerOrExplorer.trackAndLogExplorerTransitions: TimeToFirstExplorerTransition");wa.ULS.sendTraceTag(527499613,0,50,"ExcelLiveFollowerOrExplorer.trackAndLogExplorerTransitions: Last Update Type from Presenter Was = {0}. Current View State = {1}",
$a[Jb],Eb.g(this.$).T9b().qE(!0))};f.prototype.LDj=function(){Xc.a(this.$);var Jb=fb.HelperMethods.jc()-this.bYd;1E4>Jb&&(this.Ywa(Jb,"ExcelLiveFollowerOrExplorer.trackAndLogFollowerZoomTrends: TimeToZoomChangeInOppositeDirection"),this.bYd=0);this.NDj()};f.prototype.NDj=function(){fb.HelperMethods.jc()<this.sessionStartTime+12E4&&++this.NRe};f.prototype.Aoi=function(){var Jb=fb.HelperMethods.jc()-this.W8c;5E3>Jb&&this.Ywa(Jb,"ExcelLiveFollowerOrExplorer.logSyncBackToPresenterTelemetry: TimeElapsedToSyncBackSinceBecomingExplorer");
this.W8c=0};f.prototype.zoi=function(Jb){Jb=void 0===Jb?!1:Jb;this.Ywa(fb.HelperMethods.jc()-this.ZRd,"ExcelLiveFollowerOrExplorer.logSyncBackToPresenterTelemetry: Synced via Presence Notification = "+Jb+" TimeElapsedInSyncingExplorerBackToPresenter");this.ZRd=0};f.prototype.ODj=function(Jb){typeof Jb===typeof kb.a?++this.hpf:++this.ipf};f.prototype.MDj=function(Jb){var Ic=Eb.g(this.$).ha.va.activeRange;Jb=Jb.Rd(Ic)?!0:!1;Jb||0!==this.QHb?Jb&&0<this.QHb&&(Jb=fb.HelperMethods.jc()-this.QHb,this.Ywa(Jb,
"ExcelLivePresenter.trackAndLogSelectionVisibilityForPresenter: Selection was outside presenter Viewport. TimeSpentWithoutSelectionVisible"),this.$2c+=Jb,this.QHb=0):this.QHb=fb.HelperMethods.jc()};f.prototype.Vni=function(){var Jb={},Ic=fb.HelperMethods.jc()-this.sessionStartTime;Jb.PercentageTimeSelectionVisible=(Ic-this.$2c)/Ic*100;Jb=Xb.a.Hc(Jb);this.$.sendBeaconTraceTag(526987796,50,!1,"ExcelLivePresenter.logPresenterTelemetry: "+Jb)};tl.Object.defineProperties(f.prototype,{sessionStartTime:{configurable:!0,
enumerable:!0,get:function(){return this.Tde},set:function(Jb){this.Tde=Jb}},MOe:{configurable:!0,enumerable:!0,get:function(){return this.o3d},set:function(Jb){this.o3d=Jb}},W8c:{configurable:!0,enumerable:!0,get:function(){return this.n3d},set:function(Jb){this.n3d=Jb}},LAc:{configurable:!0,enumerable:!0,get:function(){return this.Sge},set:function(Jb){this.Sge=Jb}},NRe:{configurable:!0,enumerable:!0,get:function(){return this.f4d},set:function(Jb){this.f4d=Jb}},I$c:{configurable:!0,enumerable:!0,
get:function(){return this.g4d},set:function(Jb){this.g4d=Jb}},bYd:{configurable:!0,enumerable:!0,get:function(){return this.mhe},set:function(Jb){this.mhe=Jb}},NOe:{configurable:!0,enumerable:!0,get:function(){return this.p3d},set:function(Jb){this.p3d=Jb}},hpf:{configurable:!0,enumerable:!0,get:function(){return this.r$d},set:function(Jb){this.r$d=Jb}},ipf:{configurable:!0,enumerable:!0,get:function(){return this.s$d},set:function(Jb){this.s$d=Jb}},Dhc:{configurable:!0,enumerable:!0,get:function(){return this.m8d},
set:function(Jb){this.m8d=Jb}},ZRd:{configurable:!0,enumerable:!0,get:function(){return this.kfe},set:function(Jb){this.kfe=Jb}},QHb:{configurable:!0,enumerable:!0,get:function(){return this.Ide},set:function(Jb){this.Ide=Jb}},$2c:{configurable:!0,enumerable:!0,get:function(){return this.y1d},set:function(Jb){this.y1d=Jb}}});Object(D.a)(f,"ExcelLiveTelemetryHelper",null,[3]);l.prototype.dispose=function(){this.Gjb&&(this.Gjb.dispose(),this.Gjb=null);this.nhb&&(this.nhb.dispose(),this.nhb=null);this.Ygb&&
(this.Ygb.dispose(),this.Ygb=null);this.pr&&(this.pr.dispose(),this.pr=null);this.$=this.wfa=this.Ybe=this.HUa=null};l.prototype.$Rd=function(){this.ORe?this.ORe.$Rd():wa.ULS.sendTraceTag(537162880,0,10,"ExcelLiveManager::SyncToPresenter - FollowerOrExplorer object is not available to complete the action")};l.prototype.Wfd=function(){this.bOe?this.bOe.Wfd():wa.ULS.sendTraceTag(537162851,0,10,"ExcelLiveManager::GoToPresenter - ExcelLiveParticipantV0 object is not available to complete the action")};
l.prototype.N2h=function(){Yb.e(this.$)?Yb.c(this.$)?this.Gjb=new u(this.$,this.wfa,this.HUa,this.pr):this.nhb=new m(this.$,this.wfa,this.HUa,this.pr):Yb.d(this.$)&&(this.Ygb=new v(this.$,this.wfa,this.HUa))};tl.Object.defineProperties(l.prototype,{ln:{configurable:!0,enumerable:!0,get:function(){return this.Ybe}},TDb:{configurable:!0,enumerable:!0,get:function(){return this.HUa.TDb}},ORe:{configurable:!0,enumerable:!0,get:function(){return this.nhb}},presenter:{configurable:!0,enumerable:!0,get:function(){return this.Gjb}},
bOe:{configurable:!0,enumerable:!0,get:function(){return this.Ygb}}});Object(D.a)(l,"ExcelLiveManager",null,[373,3]);n.prototype.dispose=function(){this.$=null};n.prototype.ysc=function(Jb,Ic,uc){wa.ULS.sendTraceTag(527171654,0,50,"ExcelLiveFollowerOrExplorer:"+uc+" Setting presenter information to CID: "+Jb+" from CID: "+this.lR);this.lR=Jb;this.zya=Ic.User.UserName;this.Aoc=Ic.UserColor};n.prototype.kqc=function(){this.Aoc=this.zya=this.lR=void 0};tl.Object.defineProperties(n.prototype,{En:{configurable:!0,
enumerable:!0,get:function(){return this.Hae},set:function(Jb){this.Hae=Jb}},lR:{configurable:!0,enumerable:!0,get:function(){return this.nbe},set:function(Jb){this.nbe=Jb}},zya:{configurable:!0,enumerable:!0,get:function(){return this.obe},set:function(Jb){this.obe=Jb}},Aoc:{configurable:!0,enumerable:!0,get:function(){return this.pbe},set:function(Jb){this.pbe=Jb}}});Object(D.a)(n,"ExcelLiveParticipantModel",null,[3]);var dc=b(245),Za=b(11),Wa;(function(Jb){Jb[Jb.presenter=0]="presenter";Jb[Jb.follower=
1]="follower";Jb[Jb.explorer=2]="explorer";Jb[Jb.unknown=3]="unknown"})(Wa||(Wa={}));Object(D.b)("ParticipantRole",Wa);var Ba=b(256),db=b(19);k.prototype.xHd=function(Jb,Ic,uc,za){uc=void 0===uc?null:uc;za=void 0===za?null:za;this.Xwa(Jb,Ic);this.En=Ic;this.zya=uc;this.OOa=za;this.YQe?(this.YQe=!1,this.yNf()):(this.OTd=!1,this.container.classList.add("ewa-excelLive-meetingPill-container-hidden"))};k.prototype.dispose=function(){$removeHandler(this.container,"transitionend",this.Lna);$removeHandler(this.container,
"transitioncancel",this.Lna);this.container=null};k.prototype.Qe=function(Jb,Ic){if(Ic)return!1;Jb=this.container.querySelectorAll(Za.DOMElementExtensions.Ep);var uc;for(Ic=0;Ic<Jb.length;Ic++){var za=Jb[Ic];Za.DOMElementExtensions.canReceiveFocus(za)&&(uc=za)}if(!uc)return wa.ULS.sendTraceTag(529109852,0,10,"ExcelLiveMeetingPillUtility.SetFocusOnSection: Could not find focusable element in live meeting pill"),!1;uc.focus();return!0};k.prototype.zh=function(Jb){return Za.DOMElementExtensions.Ye(this.Jb,
Jb)};k.prototype.ji=function(){};k.prototype.Vh=function(){};k.prototype.initialize=function(Jb,Ic){this.container=document.createElement("div");this.container.id="excelLiveMeetingPillContainer";this.container.classList.add("ewa-excelLive-meetingPill-container");Ic.appendChild(this.container);Yb.a(Jb)&&(this.container.style.height="32px",wa.ULS.sendTraceTag(529073433,0,50,"ExcelLiveMeetingPillUtility.initialize:Changed the height of meeting pill container for mobile"));this.Lna=this.ZYh;$addHandler(this.container,
"transitionend",this.Lna);$addHandler(this.container,"transitioncancel",this.Lna);Ba.a(Jb).Tg(this)};k.prototype.yNf=function(){var Jb={};Jb.participantRole=this.En;rc.EwaSettings.isChangeGateEnabled("OfficeVSO:5931413_ShortenMeetingPillDisplayNameForMobile")&&this.$.BQ?(wa.ULS.sendTraceTag(527991135,0,50,"ExcelLiveMeetingPillUtility.renderMeetingPillInternal: Getting shortened user name for mobile meeting pill"),Jb.presenterName=this.FRh(this.zya)):Jb.presenterName=this.zya;Jb.presenterColor=this.OOa;
appChrome.renderLiveMeetingPill(this.container,Jb)};k.prototype.FRh=function(Jb){if(db.a.yj(Jb))return wa.ULS.sendTraceTag(527991134,0,15,"ExcelLiveMeetingPillUtility.getShortenedUserName: Username is null or empty"),Jb;var Ic=Jb.split(" "),uc=Ic.length;return 2>uc||db.a.yj(Ic[uc-1])?Jb:Ic[0]+" "+Ic[uc-1].substring(0,1)};k.prototype.Xwa=function(Jb,Ic){if(0===this.lastUpdateTime)wa.ULS.sendTraceTag(527766152,0,50,Jb+"::FirstRole - ["+Wa[Ic]+"]");else{var uc=fb.HelperMethods.jc()-this.lastUpdateTime;
wa.ULS.sendTraceTag(528786757,0,50,"{0}:RoleTransition: Transition participant role from [{1}] to [{2}] after {3}s",Jb,Wa[this.En],Wa[Ic],(uc/1E3).toFixed(2))}this.lastUpdateTime=fb.HelperMethods.jc()};tl.Object.defineProperties(k.prototype,{Jb:{configurable:!0,enumerable:!0,get:function(){return this.container}},canReceiveFocus:{configurable:!0,enumerable:!0,get:function(){return!!this.container&&2===this.En}},Zd:{configurable:!0,enumerable:!0,get:function(){return dc.a.Dhf}}});Object(D.a)(k,"ExcelLiveMeetingPillUtility",
null,[100,3]);c.prototype.uGb=function(Jb,Ic){this.En=Jb;this.OOa=void 0===Ic?null:Ic;appChrome.renderLiveMeetingBoundary(this.container,this.DKg)};c.prototype.dispose=function(){this.container=null;this.$.RC(this.m$a);this.$.e6i(this.m$a)};c.prototype.initialize=function(Jb){this.Inb();this.container=document.createElement("div");this.container.id="excelLiveMeetingBoundaryContainer";this.container.classList.add("ewa-excelLive-meetingBoundary-container");Jb.append(this.container);this.uGb(this.En,
this.OOa);this.$.Yz(this.m$a);this.$.lCg(this.m$a)};c.prototype.Inb=function(){this.m$a=this.m$a.bind(this)};c.prototype.m$a=function(){var Jb=this;Tc.a.instance.create(function(){Jb.uGb(Jb.En,Jb.OOa)},100,"ExcelLiveMeetingBoundaryUtility::reRenderBoundaryComponent",void 0,!0)};tl.Object.defineProperties(c.prototype,{syh:{configurable:!0,enumerable:!0,get:function(){var Jb;return(Jb=this.Ai?document.getElementById("AdditionalBarsRegion"):document.getElementById(this.$.Ib+Pc.a.Z_a))?Jb.clientHeight:
0}},NNg:{configurable:!0,enumerable:!0,get:function(){var Jb;return(Jb=this.Ai?document.getElementById("BusinessBar"):document.getElementById(this.$.Ib+Pc.a.tse))?Jb.clientHeight:0}},mth:{configurable:!0,enumerable:!0,get:function(){var Jb=null;this.Ai&&(Jb=document.getElementById("FarPaneRegion"));return Jb?Jb.clientWidth:0}},bFg:{configurable:!0,enumerable:!0,get:function(){var Jb;return(Jb=this.Ai?this.$.nka?null:Xa.AFrameworkApplication.sa.Pa.Cx?document.getElementById("appshycomponent"):document.getElementById("RibbonContainer"):
document.getElementById(this.$.Ib+Pc.a.a_a))?Jb.clientHeight:0}},Lnj:{configurable:!0,enumerable:!0,get:function(){var Jb;return(Jb=this.Ai?document.getElementById("Header"):document.getElementById(Pc.a.xFa))?Jb.clientHeight:0}},TZc:{configurable:!0,enumerable:!0,get:function(){return this.Ai?document.getElementById("EditorContainer"):this.$.Ay}},EKg:{configurable:!0,enumerable:!0,get:function(){return this.Lnj+this.bFg+this.syh}},CKg:{configurable:!0,enumerable:!0,get:function(){return this.TZc.clientLeft}},
FKg:{configurable:!0,enumerable:!0,get:function(){return this.TZc.clientWidth+this.mth-3}},BKg:{configurable:!0,enumerable:!0,get:function(){var Jb=this.TZc.clientHeight+this.NNg;this.Ai&&(Jb+=document.getElementById("StatusBarRegion").clientHeight);return Jb}},DKg:{configurable:!0,enumerable:!0,get:function(){var Jb={};Jb.participantRole=this.En;Jb.presenterColor=this.OOa;Jb.top=this.EKg;Jb.left=this.CKg;Jb.width=this.FKg;Jb.height=this.BKg;Jb.size=3;return Jb}}});Object(D.a)(c,"ExcelLiveMeetingBoundaryUtility",
null,[3]);d.prototype.dispose=function(){this.$=null;this.xv&&(this.xv.dispose(),this.xv=null);this.zIa&&(this.zIa.dispose(),this.zIa=null);this.yIa&&(this.yIa.dispose(),this.yIa=null)};d.prototype.Wna=function(Jb,Ic){if(void 0==this.xv.En||this.xv.En!==Jb)this.xv.En=Jb,this.CNf(void 0===Ic?null:Ic)};d.prototype.ysc=function(Jb,Ic){if(Jb){var uc=this.$.fa.Cfd(Jb);uc?(this.xv.ysc(Jb,uc,Ic),this.CNf(Ic)):wa.ULS.sendTraceTag(528086351,0,10,"ExcelLiveController:savePresenterDetails Failed to get presenter information from sessionStateManager")}else wa.ULS.sendTraceTag(528086352,
0,10,"ExcelLiveController:savePresenterDetails Presenter CID is undefined")};d.prototype.kqc=function(){this.xv.kqc()};d.prototype.a4h=function(){this.xv=new n(this.$);var Jb=this.$.Ay;Xa.AFrameworkApplication.sa.Pa.Ai&&(Jb=document.getElementById("StatusBarRegion"));this.zIa=new k(this.$,Jb);Jb=this.$.Oq;Xa.AFrameworkApplication.sa.Pa.Ai&&(Jb=document.getElementById("regionComposerRoot"));this.Kyb&&(this.yIa=new c(this.$,Jb));Jb=Yb.c(this.$)?0:3;this.Wna(Jb,"ExcelLiveController::initializeController")};
d.prototype.CNf=function(Jb){switch(this.xv.En){case 2:this.zIa.xHd(Jb,this.xv.En,this.xv.zya);this.Kyb&&this.yIa.uGb(this.xv.En);break;case 1:this.zIa.xHd(Jb,this.xv.En,this.xv.zya,this.xv.Aoc);this.Kyb&&this.yIa.uGb(this.xv.En,this.xv.Aoc);break;case 3:case 0:this.zIa.xHd(Jb,this.xv.En),this.Kyb&&this.yIa.uGb(this.xv.En)}};tl.Object.defineProperties(d.prototype,{TDb:{configurable:!0,enumerable:!0,get:function(){return this.xv}},En:{configurable:!0,enumerable:!0,get:function(){return this.xv.En}},
lR:{configurable:!0,enumerable:!0,get:function(){return this.xv.lR}}});Object(D.a)(d,"ExcelLiveController",null,[3]);var Zb=Ra.a;vm(a,Zb);a.prototype.create=function(){this.M2h()};a.prototype.dispose=function(){this.ln&&this.ln.oGb(this.XNa);this.ln=null;this.oA&&(this.oA.dispose(),this.oA=null);Zb.prototype.dispose.call(this)};a.prototype.M2h=function(){var Jb=this;this.oA=new d(this.$);this.$.da.Za(26,function(Ic){Jb.ln=Ic;Jb.NXg()})};a.prototype.NXg=function(){wa.ULS.sendTraceTag(537162850,0,50,
"ExcelLiveCommandHandlerFactory::ConnectToRealTimeChannel - attach RealTimeChannelInitialized handler");this.ln.CTc(this.XNa);this.ln.EZa()};a.ja=function(Jb){wa.ULS.sendTraceTag(537162848,0,50,"ExcelLiveManagerFactory::Attach: Begin service registration");Jb.da.Ha(474,new a(Jb));wa.ULS.sendTraceTag(537162847,0,50,"ExcelLiveManagerFactory::Attach: Complete service registration")};Object(D.a)(a,"ExcelLiveManagerFactory",Ra.a,[]);Type.registerNamespace("Microsoft.Office.Excel.WebUI.Client.ExcelLive");
Type.registerNamespace("_Ewa");y.a.Yi(".ewa-excelLive-meetingPill-container{height:24px;transition:height 400ms cubic-bezier(.8,0,.2,1) 0s;position:absolute;width:100%;bottom:0;pointer-events:none;z-index:992}.ewa-excelLive-meetingPill-container-hidden{height:0 !important;overflow:hidden;transition:height 400ms cubic-bezier(.8,0,.2,1) 0s}.ewa-excelLive-meetingBoundary-container{position:fixed;z-index:992}");Type.registerNamespace("Common.App.RtcHostNotificationSubscription");ca.main();Type.registerNamespace("Common.App.LivePersonaCard.Contracts");
Type.registerNamespace("Common.App.LivePersonaCard");w.main();Type.registerNamespace("AppRealtimeChannel");(function(){xa.a.Ga(function(Jb){a.ja(Jb);r.ja(Jb)})})()}}]);

//# sourceMappingURL=https://artifacts.dev.azure.com/office/_apis/symbol/symsrv/EwaDS.rt.js.map/c8750573edfd96dbbece9e37ea78bf99/EwaDS.rt.js.map