var excelOnlineCalc=function(e){var t={};function r(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,r),a.l=!0,a.exports}return r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)r.d(n,a,function(t){return e[t]}.bind(null,a));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=148)}([function(e,t,r){"use strict";var n;function a(e){return{kind:n.Success,value:e}}r.d(t,"b",(function(){return n})),r.d(t,"f",(function(){return a})),r.d(t,"g",(function(){return o})),r.d(t,"c",(function(){return c})),r.d(t,"d",(function(){return u})),r.d(t,"a",(function(){return i})),r.d(t,"e",(function(){return s})),function(e){e.Success="Success",e.Failure="Failure",e.Paused="Paused"}(n||(n={}));var i,o=a(void 0);function c(e){return{kind:n.Failure,reason:e}}function u(e){return e.kind===n.Success}function s(e){return{kind:i.JavaScriptError,error:e}}!function(e){e.JavaScriptError="JavaScriptError"}(i||(i={}))},function(e,t,r){"use strict";r.d(t,"h",(function(){return c})),r.d(t,"f",(function(){return u})),r.d(t,"a",(function(){return i})),r.d(t,"g",(function(){return s})),r.d(t,"c",(function(){return y})),r.d(t,"e",(function(){return S})),r.d(t,"d",(function(){return C}));var n=r(8),a=r(50);r.d(t,"b",(function(){return a.a}));var i,o=r(30),c=Object(n.e)(0,254,[],[n.c.All],[],n.c.All,n.d.All,n.a.None);function u(){var e=n.b.Number|n.b.String|n.b.Boolean|n.b.Rich|n.b.Error|n.b.Blank|(Object(o.e)(o.a.CalcLambdaCellValues)?0:n.b.Range)|(Object(o.e)(o.a.CalcLambdaArrayLifting)?0:n.b.Array),t=n.b.Number|n.b.String|n.b.Boolean|n.b.Rich|n.b.Error|n.b.Blank|n.b.Missing|n.b.Array|n.b.Range;return Object(n.e)(1,255,[e],[t],[],n.c.All,n.d.None,n.a.Allow3dRef)}!function(e){e[e.Add=1]="Add",e[e.Sub=2]="Sub",e[e.Mul=3]="Mul",e[e.Div=4]="Div",e[e.Pow=5]="Pow",e[e.Percent=6]="Percent",e[e.Neg=7]="Neg",e[e.Pos=8]="Pos",e[e.Concat=9]="Concat",e[e.Eq=10]="Eq",e[e.Ne=11]="Ne",e[e.Lt=12]="Lt",e[e.Le=13]="Le",e[e.Gt=14]="Gt",e[e.Ge=15]="Ge",e[e.Range=16]="Range",e[e.Isect=17]="Isect",e[e.Union=18]="Union",e[e.And=19]="And",e[e.Or=20]="Or",e[e.Xor=21]="Xor",e[e.Min=22]="Min",e[e.Max=23]="Max",e[e.At=24]="At",e[e.Pound=25]="Pound"}(i||(i={}));var s=[void 0,"+","-","*","/","^","%","-","+","&","=","<>","<","<=",">",">=",":",void 0,void 0,"&&","||","^^",void 0,void 0,"@","#"],l=n.b.Number|n.b.String|n.b.Boolean|n.b.Blank,d=n.b.Number|n.b.String|n.b.Boolean|n.b.Blank,f=Object(n.e)(2,2,[n.b.Number,n.b.Number],[],[],n.b.Number,n.d.None,n.a.None),b=Object(n.e)(1,1,[n.b.Number],[],[],n.b.Number,n.d.None,n.a.None),h=Object(n.e)(1,1,[l],[],[],l,n.d.None,n.a.None),v=Object(n.e)(2,2,[n.b.String,n.b.String],[],[],n.b.String,n.d.None,n.a.None),p=Object(n.e)(2,2,[d,d],[],[],n.b.Boolean,n.d.None,n.a.None),m=Object(n.e)(2,2,[n.b.Range,n.b.Range],[],[],n.b.Range,n.d.AllCells,n.a.None),g=Object(n.e)(2,2,[n.b.Range,n.b.Range],[],[],n.b.Range,n.d.None,n.a.None),O=Object(n.e)(2,2,[n.b.Boolean,n.b.Boolean],[],[],n.b.Boolean,n.d.None,n.a.None),j=[];function y(e){var t=j[e];return null!=t?t:c}function S(e){var t=a.c[e];return null!=t?t:c}function C(e){return a.b[e]}function k(e,t){var r=a.c[e];null!=r&&(r.staticPrecs=t)}j[i.Add]=f,j[i.Sub]=f,j[i.Mul]=f,j[i.Div]=f,j[i.Pow]=f,j[i.Percent]=b,j[i.Neg]=b,j[i.At]=a.c[a.a.SINGLE],j[i.Pound]=a.c[a.a.ANCHORARRAY],j[i.Pos]=h,j[i.Concat]=v,j[i.Eq]=p,j[i.Ne]=p,j[i.Lt]=p,j[i.Le]=p,j[i.Gt]=p,j[i.Ge]=p,j[i.Range]=m,j[i.Isect]=g,j[i.Union]=g,j[i.And]=O,j[i.Or]=O,j[i.Xor]=O,j[i.Min]=f,j[i.Max]=f,k(a.a.ROW,n.d.OwnRow),k(a.a.COLUMN,n.d.OwnCol),k(a.a.SHEET,n.d.OwnDocSheets),k(a.a.SHEETS,n.d.OwnDocSheets),k(a.a.OFFSET,n.d.AllCells),k(a.a.INDIRECT,n.d.AllCells),k(a.a.SUMIF,n.d.AllCells),k(a.a.AVERAGEIF,n.d.AllCells),k(a.a.LOOKUP,n.d.AllCells),k(a.a.ADDRESS,n.d.RefStyle),k(a.a.FORMULATEXT,n.d.RefStyle),k(a.a.NOW,n.d.Time),k(a.a.TODAY,n.d.Time),k(a.a.RAND,n.d.Calc),k(a.a.RANDBETWEEN,n.d.Calc),k(a.a.RANDARRAY,n.d.Calc),k(a.a.SUBTOTAL,n.d.CellProps),k(a.a.CELL,n.d.CellProps|n.d.AllCells),k(a.a.INFO,n.d.None)},function(e,t,r){"use strict";r.d(t,"h",(function(){return n})),r.d(t,"g",(function(){return a})),r.d(t,"c",(function(){return i})),r.d(t,"f",(function(){return o})),r.d(t,"a",(function(){return c})),r.d(t,"k",(function(){return m})),r.d(t,"J",(function(){return g})),r.d(t,"e",(function(){return f})),r.d(t,"d",(function(){return b})),r.d(t,"i",(function(){return h})),r.d(t,"j",(function(){return v})),r.d(t,"b",(function(){return p})),r.d(t,"B",(function(){return O})),r.d(t,"fb",(function(){return j})),r.d(t,"A",(function(){return y})),r.d(t,"gb",(function(){return S})),r.d(t,"N",(function(){return C})),r.d(t,"hb",(function(){return k})),r.d(t,"o",(function(){return E})),r.d(t,"db",(function(){return A})),r.d(t,"s",(function(){return N})),r.d(t,"x",(function(){return T})),r.d(t,"v",(function(){return R})),r.d(t,"w",(function(){return I})),r.d(t,"r",(function(){return _})),r.d(t,"q",(function(){return F})),r.d(t,"I",(function(){return w})),r.d(t,"K",(function(){return M})),r.d(t,"V",(function(){return D})),r.d(t,"U",(function(){return P})),r.d(t,"T",(function(){return x})),r.d(t,"m",(function(){return L})),r.d(t,"l",(function(){return B})),r.d(t,"G",(function(){return H})),r.d(t,"O",(function(){return W})),r.d(t,"S",(function(){return z})),r.d(t,"R",(function(){return q})),r.d(t,"F",(function(){return K})),r.d(t,"ab",(function(){return Y})),r.d(t,"Z",(function(){return J})),r.d(t,"bb",(function(){return Q})),r.d(t,"Q",(function(){return X})),r.d(t,"P",(function(){return Z})),r.d(t,"Y",(function(){return $})),r.d(t,"mb",(function(){return ee})),r.d(t,"cb",(function(){return te})),r.d(t,"X",(function(){return re})),r.d(t,"M",(function(){return ne})),r.d(t,"t",(function(){return ae})),r.d(t,"D",(function(){return ie})),r.d(t,"H",(function(){return oe})),r.d(t,"L",(function(){return ce})),r.d(t,"u",(function(){return ue})),r.d(t,"E",(function(){return se})),r.d(t,"C",(function(){return le})),r.d(t,"kb",(function(){return de})),r.d(t,"ib",(function(){return fe})),r.d(t,"y",(function(){return be})),r.d(t,"eb",(function(){return he})),r.d(t,"z",(function(){return ve})),r.d(t,"lb",(function(){return pe})),r.d(t,"W",(function(){return me})),r.d(t,"p",(function(){return ge})),r.d(t,"jb",(function(){return Oe})),r.d(t,"n",(function(){return je}));var n,a,i,o,c,u=r(9),s=r(5),l=r(10),d=r(29);!function(e){e[e.R1C1=1]="R1C1",e[e.A1=2]="A1"}(n||(n={})),function(e){e.Error="Error",e.Relative="Relative",e.Document="Document",e.Sheet="Sheet",e.Ident="Ident",e.SheetRange="SheetRange",e.Bad="Bad"}(a||(a={})),function(e){e.Error="Error",e.Single="Single",e.Range="Range",e.Row="Row",e.Col="Col",e.Bad="Bad"}(i||(i={})),function(e){e.Abs="Abs",e.Rel="Rel"}(o||(o={})),function(e){e.LocalNameUse="LocalNameUse",e.LocalNameDecl="LocalNameDecl",e.AppHeadName="AppHeadName",e.FormulaRoot="FormulaRoot"}(c||(c={}));var f,b,h,v,p,m={kind:c.AppHeadName},g={kind:c.FormulaRoot};function O(e){return void 0===e&&(e=0),{kind:a.Error,isQuoted:!1,label:e}}function j(e){return void 0===e&&(e=0),{kind:a.Relative,isQuoted:!1,label:e}}function y(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:a.Document,isQuoted:r,label:n,document:e,path:t}}function S(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:a.Sheet,isQuoted:r,label:n,sheet:e,document:t}}function C(e,t,r){return void 0===t&&(t=!1),void 0===r&&(r=0),{kind:a.Ident,isQuoted:t,label:r,name:e}}function k(e,t,r,n,i){return void 0===n&&(n=!1),void 0===i&&(i=0),{kind:a.SheetRange,isQuoted:n,label:i,sheet1:e,sheet2:t,document:r}}function E(e,t,r){return void 0===t&&(t=!1),void 0===r&&(r=0),{kind:a.Bad,isQuoted:t,label:r,chars:e}}function A(e,t){return{kind:e,index:t}}function N(e){void 0===e&&(e=0);return{kind:i.Error,label:e,isBracketed:!1}}function T(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:i.Single,label:n,row:e,col:t,isBracketed:r}}function R(e,t,r){void 0===r&&(r=0);var n=e.isBracketed||t.isBracketed;return{kind:i.Range,label:r,ref1:e,ref2:t,isBracketed:n}}function I(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:i.Row,label:n,row1:e,row2:t,isBracketed:r}}function _(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:i.Col,label:n,col1:e,col2:t,isBracketed:r}}function F(e,t,r){return void 0===t&&(t=!1),void 0===r&&(r=0),{kind:i.Bad,label:r,chars:e,isBracketed:t}}function w(e,t,r,n){return{node:e,spans:t,annotations:r,depthUpperBound:null!=n?n:Object(d.k)(e)}}function M(e,t,r,n){return Object(s.d)("calc.lang.formulaSpan",e),Object(s.c)("calc.lang.formulaSpan",t),t<e&&Object(s.a)("calc.lang.formulaSpan: expected end >= ".concat(e,"; given ").concat(t)),{start:e,end:t,pre:r,post:n}}function D(e,t,r){return{kind:c.LocalNameUse,name:e,whole:t,label:r}}function P(e){return void 0===e&&(e=[]),{kind:c.LocalNameDecl,uses:e}}function x(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:f.Literal,label:r,oper:e,isClosed:t}}function L(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:f.Array,label:r,nodes:e,isClosed:t}}function B(e,t,r,n){return void 0===r&&(r=!0),void 0===n&&(n=0),{kind:f.App,label:n,head:e,args:t,isClosed:r}}function U(e){return Array.isArray(e)}function G(e){return void 0!==e.kind}function V(e){for(var t=[],r=0,n=e;r<n.length;r++){var a=n[r],i=a.arg,o=a.index;Object(s.b)("calc.lang.flattenNumberedArgs: idx",o,e.length),Object(s.h)("calc.lang.flattenNumberedArgs: repetition",void 0===t[o]),t[o]=i}return t}function H(e,t,r){return V(Object(l.o)(Object(u.__spreadArray)(Object(u.__spreadArray)([],void 0===t?[]:[t],!0),r,!0),e.map((function(e){return[e.name,e.binder]}))))}function W(e,t){return{arg:e,index:t}}function z(e,t){return{name:e,binder:t}}function q(e,t,r,n,a,i){void 0===n&&(n=[]),void 0===a&&(a=!0),void 0===i&&(i=0),Object(s.h)("calc.lang.letNode",t.every((function(e){return void 0===(U(e)?e[0]:e.name.arg).qualifier})));var o=t.map((function(e,t){return U(e)?z(W(e[0],2*t),W(e[1],2*t+1)):e})).sort((function(e,t){return e.name.index-t.name.index})),c=void 0!==r&&G(r)?W(r,2*t.length):r,u=H(o,c,n);return{kind:f.Let,label:i,head:e,args:u,isClosed:a,vars:o,body:c,badArgs:n}}function K(e,t,r){return void 0===r&&(r=[]),V(Object(u.__spreadArray)(Object(u.__spreadArray)(Object(u.__spreadArray)([],e.map((function(e){return e.name})),!0),void 0===t?[]:[t],!0),r,!0))}function Y(e,t,r,n){return void 0===r&&(r=!0),void 0===n&&(n=0),{label:n,name:e,isBracketed:t,isClosed:r}}function J(e,t){return void 0===t&&(t=0),{label:t,rhs:e}}function Q(e,t,r){return void 0===r&&(r=0),{kind:f.Param,label:r,name:e,whole:e.name.kind===f.Name?e.name.whole:void 0,def:t,isOptional:e.isBracketed||void 0!==t}}function X(e){return{name:e}}function Z(e,t,r,n,a,i){void 0===n&&(n=[]),void 0===a&&(a=!0),void 0===i&&(i=0),Object(s.h)("calc.lang.lambdaNode",t.every((function(e){var t=G(e)?e:e.name.arg,r=t.kind===f.Name?t:t.name.name;return r.kind!==f.Name||void 0===r.qualifier})));var o=t.map((function(e,t){return G(e)?e.kind===f.Name?X(W(Q(Y(e,!1),void 0),t)):X(W(e,t)):e})).sort((function(e,t){return e.name.index-t.name.index})),c=void 0!==r&&G(r)?W(r,t.length):r,u=K(o,c,n);return{kind:f.Lambda,label:i,head:e,args:u,isClosed:a,params:o,body:c,badArgs:n}}function $(e,t){return void 0===t&&(t=0),{kind:f.Operator,label:t,id:e}}function ee(e,t,r){return void 0===r&&(r=0),{kind:f.WSF,label:r,id:e,whole:t}}function te(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:f.Paren,label:r,node:e,isClosed:t}}function re(e,t,r){void 0===r&&(r=0);var n="string"==typeof e?e:e.asWhole,a="string"==typeof e?ne(e,!0):e;return{kind:f.Name,label:r,whole:n,parts:a,qualifier:t}}function ne(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{kind:b.IdentNamePart,label:r,asWhole:e,canDenoteNamedObject:t}}function ae(e,t,r){return void 0===r&&(r=0),{kind:b.CellRefNamePart,label:r,asWhole:t,canDenoteNamedObject:!1,ref:e}}function ie(e,t,r,n){return void 0===r&&(r=!0),void 0===n&&(n=0),{kind:b.FieldRefNamePart,label:n,asWhole:e.asWhole+"."+t,canDenoteNamedObject:r,lhs:e,rhs:t}}function oe(e){for(var t=[e],r=t[0];r.kind===b.FieldRefNamePart;)t.push(r.lhs),r=r.lhs;return t.reverse(),{kind:r.kind,parts:t}}function ce(e){for(var t=e;t.kind===b.FieldRefNamePart;)t=t.lhs;return t}function ue(e,t,r){return void 0===r&&(r=0),{kind:f.CellRef,label:r,ref:e,qualifier:t}}function se(e,t,r,n){return void 0===r&&(r=!1),void 0===n&&(n=0),{kind:f.FieldRef,label:n,lhs:e,rhs:t,shouldBeBracketed:r}}function le(e,t,r,n){return void 0===t&&(t=!1),void 0===r&&(r=!0),void 0===n&&(n=0),Object(s.h)("calc.lang.fieldRef","string"==typeof e||e.kind!==f.Name||void 0===e.qualifier),{label:n,field:"string"==typeof e?re(e):e,isBracketed:t,isClosed:r}}function de(e,t,r){return void 0===r&&(r=0),{kind:f.StructRef,label:r,lhs:e,rhs:t}}function fe(e,t,r,n){return void 0===t&&(t=!1),void 0===r&&(r=!0),void 0===n&&(n=0),{kind:v.SpecialRef,label:n,id:e,isBracketed:t,isClosed:r}}function be(e,t,r,n){return void 0===t&&(t=!1),void 0===r&&(r=!0),void 0===n&&(n=0),{kind:v.ColumnRef,label:n,name:e,isBracketed:t,isClosed:r}}function he(e,t,r){return void 0===r&&(r=0),{kind:v.RangeOpRef,label:r,lhs:e,rhs:t}}function ve(e,t){var r;void 0===t&&(t=0);for(var n=((r={})[h.All]=!1,r[h.Data]=!1,r[h.Headers]=!1,r[h.Totals]=!1,r[h.ThisRow]=!1,r),a=[],i=0,o=e;i<o.length;i++){var c=o[i];switch(c.kind){case v.SpecialRef:n[c.id]=!0;break;case v.ColumnRef:case v.RangeOpRef:a.push(c)}}return{kind:v.CommaOpRef,label:t,refs:e,specialRefs:n,columnRefs:a}}function pe(e,t){return void 0===t&&(t=0),{kind:v.ThisRowOpRef,label:t,ref:e}}function me(e){return void 0===e&&(e=0),{kind:v.MissingRef,label:e}}function ge(e,t,r,n){return void 0===t&&(t=!1),void 0===r&&(r=!0),void 0===n&&(n=0),{kind:v.BadRef,contents:e,isBracketed:t,isClosed:r,label:n}}function Oe(e,t,r){return void 0===t&&(t=!0),void 0===r&&(r=0),{label:r,isClosed:t,innerRef:e}}function je(e,t,r){return void 0===r&&(r=0),{kind:f.Bad,label:r,type:e,contents:t}}!function(e){e.Literal="Literal",e.Array="Array",e.App="App",e.Let="Let",e.Lambda="Lambda",e.Paren="Paren",e.Name="Name",e.CellRef="CellRef",e.FieldRef="FieldRef",e.StructRef="StructRef",e.Bad="Bad",e.Operator="Operator",e.WSF="WSF",e.Param="Param"}(f||(f={})),function(e){e.IdentNamePart="IdentNamePart",e.CellRefNamePart="CellRefNamePart",e.FieldRefNamePart="FieldRefNamePart"}(b||(b={})),function(e){e[e.All=1]="All",e[e.Data=2]="Data",e[e.Headers=3]="Headers",e[e.Totals=4]="Totals",e[e.ThisRow=5]="ThisRow"}(h||(h={})),function(e){e.SpecialRef="SpecialRef",e.ColumnRef="ColumnRef",e.RangeOpRef="RangeOpRef",e.CommaOpRef="CommaOpRef",e.ThisRowOpRef="ThisRowOpRef",e.MissingRef="MissingRef",e.BadRef="BadRef"}(v||(v={})),function(e){e.Unexpected="Unexpected",e.Qualifier="Qualifier",e.NumberLiteral="NumberLiteral",e.StringLiteral="StringLiteral",e.ErrorLiteral="ErrorLiteral",e.FieldName="FieldName",e.ParamName="ParamName",e.Missing="Missing",e.Sequence="Sequence",e.StructRef="StructRef",e.FieldRef="FieldRef"}(p||(p={}))},function(e,t,r){"use strict";r.d(t,"Y",(function(){return f})),r.d(t,"eb",(function(){return b})),r.d(t,"F",(function(){return h})),r.d(t,"W",(function(){return v})),r.d(t,"U",(function(){return p})),r.d(t,"d",(function(){return m})),r.d(t,"e",(function(){return g})),r.d(t,"s",(function(){return O})),r.d(t,"t",(function(){return j})),r.d(t,"v",(function(){return y})),r.d(t,"q",(function(){return S})),r.d(t,"r",(function(){return C})),r.d(t,"l",(function(){return k})),r.d(t,"o",(function(){return E})),r.d(t,"p",(function(){return A})),r.d(t,"u",(function(){return N})),r.d(t,"D",(function(){return T})),r.d(t,"Z",(function(){return R})),r.d(t,"K",(function(){return I})),r.d(t,"G",(function(){return _})),r.d(t,"H",(function(){return F})),r.d(t,"V",(function(){return w})),r.d(t,"X",(function(){return M})),r.d(t,"n",(function(){return D})),r.d(t,"ib",(function(){return P})),r.d(t,"m",(function(){return x})),r.d(t,"i",(function(){return L})),r.d(t,"g",(function(){return U})),r.d(t,"N",(function(){return G})),r.d(t,"db",(function(){return V})),r.d(t,"bb",(function(){return H})),r.d(t,"I",(function(){return W})),r.d(t,"L",(function(){return z})),r.d(t,"f",(function(){return q})),r.d(t,"cb",(function(){return K})),r.d(t,"jb",(function(){return Y})),r.d(t,"M",(function(){return J})),r.d(t,"ab",(function(){return Q})),r.d(t,"z",(function(){return X})),r.d(t,"E",(function(){return Z})),r.d(t,"R",(function(){return $})),r.d(t,"x",(function(){return ee})),r.d(t,"J",(function(){return te})),r.d(t,"y",(function(){return re})),r.d(t,"T",(function(){return ne})),r.d(t,"O",(function(){return ie})),r.d(t,"fb",(function(){return ue})),r.d(t,"S",(function(){return se})),r.d(t,"a",(function(){return oe})),r.d(t,"b",(function(){return le})),r.d(t,"hb",(function(){return de})),r.d(t,"kb",(function(){return fe})),r.d(t,"w",(function(){return be})),r.d(t,"c",(function(){return he})),r.d(t,"k",(function(){return me})),r.d(t,"j",(function(){return ge})),r.d(t,"h",(function(){return je})),r.d(t,"C",(function(){return Ce})),r.d(t,"A",(function(){return ke})),r.d(t,"B",(function(){return Ee})),r.d(t,"P",(function(){return Ae})),r.d(t,"Q",(function(){return Ne})),r.d(t,"gb",(function(){return Fe}));var n,a=r(9),i=r(5),o=r(12),c=r(2),u=r(8),s=r(0),l=r(10),d=r(93);function f(e){return e.index===e.index2}function b(e){return e.isWellFormed}function h(e){return 1===e.rows&&1===e.cols}function v(e){return f(e.sheet)}function p(e){return h(e.range)}function m(e,t){if(h(e))return t(e,0,0);for(var r=e.row,n=e.rows,a=e.col,i=e.cols,c=0;c<n;c+=1)for(var u=0;u<i;u+=1)if(!t(Object(o.f)(r+c,a+u),c,u))return!1;return!0}function g(e,t,r){var n=e.row,a=e.rows,c=e.col,u=e.cols;Object(i.f)("calc.lang.forEachTileInRange",t),Object(i.b)("calc.lang.forEachTileInRange",n,o.v),Object(i.b)("calc.lang.forEachTileInRange",c,o.o),Object(i.g)("calc.lang.forEachTileInRange",a,o.v-n),Object(i.g)("calc.lang.forEachTileInRange",u,o.o-c);for(var s=n;s<n+a;s+=t)for(var d=c;d<c+u;d+=t)if(!r(Object(o.x)(s,d,Object(l.c)(t,a+n-s),Object(l.c)(t,u+c-d))))return!1;return!0}function O(e,t){var r=e.row,n=e.col,a=e.rows,i=e.cols,c=t.row,u=t.col,s=t.rows,d=t.cols,f=Object(l.c)(r,c),b=Object(l.c)(n,u),h=Object(l.b)(r+a,c+s)-f,v=Object(l.b)(n+i,u+d)-b;return Object(o.x)(f,b,h,v)}function j(e,t){return e?t?O(e,t):e:t}function y(e){return 0===e.length&&Object(i.a)("calc.runtime.gridRangesJoin: expected nonempty range array"),e.reduce(O)}function S(e,t){var r=e.row,n=e.col,a=e.rows,i=e.cols,c=t.row,u=t.col,s=t.rows,d=t.cols,f=Object(l.b)(r,c),b=Object(l.b)(n,u),h=Object(l.c)(r+a,c+s)-f,v=Object(l.c)(n+i,u+d)-b;if(!(h<=0||v<=0))return Object(o.x)(f,b,h,v)}function C(e,t){var r=e.row,n=e.col,a=e.rows,i=e.cols,o=t.row,c=t.col,u=t.rows,s=t.cols;return Object(l.b)(r,o)<Object(l.c)(r+a,o+u)&&Object(l.b)(n,c)<Object(l.c)(n+i,c+s)}function k(e,t){var r=e.row,n=e.col,a=t.row,i=t.col,c=t.rows,u=t.cols,s=a<=r&&r<a+c,l=i<=n&&n<i+u;return s&&l?Object(o.f)(r,n):s&&1===u?Object(o.f)(r,i):l&&1===c?Object(o.f)(a,n):1===u&&1===c?Object(o.f)(a,i):void 0}function E(e,t){var r=e.row,n=e.col,a=e.rows,i=e.cols,o=t.row,c=t.col,u=r+a,s=o+t.rows,l=n+i,d=c+t.cols;return r===o&&u===s&&n===c&&l===d?0:r<=o&&u>=s&&n<=c&&l>=d?1:r>=o&&u<=s&&n>=c&&l<=d?-1:void 0}function A(e,t){var r=[e.row,e.row+e.rows],n=[e.col,e.col+e.cols],a=[t.row,t.row+t.rows],i=[t.col,t.col+t.cols],c=Object(d.a)(r,a),u=Object(d.a)(n,i);if(void 0!==c&&c<=0){var s=Object(d.b)(n,i);if(void 0!==s)return Object(o.g)(e.row,s[0],e.rows,s[1]-s[0])}if(void 0!==u&&u<=0){var l=Object(d.b)(r,a);if(void 0!==l)return Object(o.g)(l[0],e.col,l[1]-l[0],e.cols)}}function N(e){return e.rows*e.cols}function T(e,t){return e===t||e.name===t.name&&e.path===t.path}function R(e,t){return T(e.document,t.document)&&e.index===t.index}function I(e,t){return T(e.document,t.document)&&e.index===t.index}function _(e,t){return e.row===t.row&&e.col===t.col}function F(e,t){return e.row===t.row&&e.col===t.col&&e.rows===t.rows&&e.cols===t.cols}function w(e,t){return R(e.sheet,t.sheet)&&_(e.range,t.range)}function M(e,t){return R(e.sheet,t.sheet)&&F(e.range,t.range)}function D(e){return h(e)?e:Object(o.x)(e.row,e.col,1,1)}function P(e){return p(e)?e:Object(o.p)(e.sheet,D(e.range))}function x(e,t){var r=e.row,n=e.col,a=t.row,i=t.col;return Object(o.x)(Object(l.c)(r,a),Object(l.c)(n,i),Math.abs(a-r)+1,Math.abs(i-n)+1)}function L(e,t){function r(r){var n=e.spans[r.label];return void 0!==n&&n.start<=t&&t<n.end}for(var n=e.node,a=!0;a;)switch(a=!1,n.kind){case c.e.Array:for(var o=n.nodes,u=o.length-1;!a&&u>=0;u-=1)for(var s=o[u],l=s.length-1;!a&&l>=0;l-=1){r(f=s[l])&&(n=f,a=!0)}break;case c.e.App:case c.e.Let:case c.e.Lambda:var d=n.args.map((function(e){return e.kind===c.e.Param?e.name.name:e}));for(l=d.length-1;!a&&l>=0;l-=1){r(f=d[l])&&(n=f,a=!0)}break;case c.e.Paren:var f;r(f=n.node)&&(n=f,a=!0);break;case c.e.Bad:case c.e.Name:case c.e.CellRef:case c.e.StructRef:case c.e.Literal:break;case c.e.FieldRef:r(n.lhs)&&(n=n.lhs,a=!0);break;default:Object(i.e)("getSubExpressionFromPosition",n)}return n}var B=[];function U(e){return 0===function(e){return 1===e.args.length&&W(e.args[0])?0:e.args.length}(e)?B:e.args}function G(e){return e.kind===c.e.Operator}function V(e){return e.kind===c.e.WSF}function H(e){return e.kind===c.e.Name&&void 0===e.qualifier}function W(e){return e.kind===c.e.Literal&&te(e.oper)}function z(e){return e.kind===c.e.Literal&&J(e.oper)}function q(e,t,r){var n=e.maxArgs,a=e.headTypes,o=e.restTypes,c=e.tailTypes;if(Object(i.f)("calc.runtime.getArgType: n",r),Object(i.b)("calc.runtime.getArgType: i",t,r),t>=n)return u.c.None;if(t<a.length)return a[t];if(0===o.length)return u.c.None;if(t<a.length+o.length)return o[t-a.length];var s=(r-a.length)%o.length;return s>c.length?u.c.None:t>=r-s?c[t-(r-s)]:o[(t-a.length)%o.length]}function K(e,t){var r=e.minArgs,n=e.maxArgs,a=e.headTypes,i=e.restTypes,o=e.tailTypes;return!(t<r||t>n)&&(t<=a.length+i.length||0!==i.length&&(t-a.length)%i.length<=o.length)}function Y(e,t,r){return r.length>0&&t.field.kind===c.e.Name&&((n=e).kind===c.e.Literal&&X(n.oper)||e.kind===c.e.Name||e.kind===c.e.CellRef);var n}function J(e){return e.kind===u.b.Number}function Q(e){return e.kind===u.b.String}function X(e){return e.kind===u.b.Boolean}function Z(e){return e.kind===u.b.Error}function $(e){return e.kind===u.b.Range}function ee(e){return e.kind===u.b.Array}function te(e){return e.kind===u.b.Missing}function re(e){return e.kind===u.b.Blank}function ne(e){return e.kind===u.b.Rich}var ae=u.b.Number|u.b.String|u.b.Boolean;function ie(e){return 0!=(e.kind&ae)}var oe,ce=ae|u.b.Error|u.b.Array|u.b.Rich;function ue(e){return 0!=(e.kind&ce)}function se(e,t,r,n){if(r.kind!==t.kind)return!1;switch(r.kind){case u.b.Boolean:case u.b.String:return r.value===t.value;case u.b.Number:return 0===e.cond2(r,t);case u.b.Error:return r.type===t.type;case u.b.Rich:return n;case u.b.Array:var a=t;if(r.cols!==a.cols||r.rows!==a.rows)return!1;for(var o=0;o<r.rows;o+=1)for(var c=r.opers[o],s=a.opers[o],l=0;l<r.cols;l+=1)if(!se(e,s[l],c[l],n))return!1;return!0;case u.b.Blank:return!0;default:return Object(i.e)("calc.lang.readOperEq",r)}}!function(e){e.NotImplemented="NotImplemented",e.Unavailable="Unavailable",e.Internal="Internal"}(oe||(oe={}));var le=Object(a.__assign)(Object(a.__assign)({},s.a),oe);function de(e){return{kind:le.NotImplemented,features:e}}function fe(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return 0===e.length&&Object(i.a)("calc.lang.unavailable: expected nonempty array"),{kind:le.Unavailable,objects:e}}function be(e){return{kind:le.Internal,message:e}}function he(e){var t=function(t){this.reason=t,this.name=e,this.stack=e,this.message=t.kind};return(t.prototype=Object.create(Error.prototype)).constructor=t,t}var ve="_xlfn.",pe="_xlws.";function me(e,t){var r=t;return r.length>ve.length&&0===e.stringCompareCI(r.substring(0,ve.length),ve)&&(r=r.substring(ve.length)).length>pe.length&&0===e.stringCompareCI(r.substring(0,pe.length),pe)&&(r=r.substring(pe.length)),e.getWorksheetFuncId(r)}function ge(e,t,r,n){var a=n;return a.length>"_xludf.".length&&0===t.stringCompareCI(a.substring(0,"_xludf.".length),"_xludf.")&&(a=a.substring("_xludf.".length)),[e.getUserDefinedFuncLoc(r,a),a]}var Oe="_xlpm.";function je(e,t){var r=t;return r.length>Oe.length&&0===e.stringCompareCI(r.substring(0,Oe.length),Oe)&&(r=r.substring(Oe.length)),r}function ye(e){return e.kind!==c.j.SpecialRef&&e.kind!==c.j.BadRef||e.isBracketed}function Se(e){return e.kind===c.j.MissingRef||e.kind===c.j.BadRef}function Ce(e){return e.columnRefs.length<=1&&e.refs.every(ye)&&function(e){var t=e.specialRefs,r=Object.keys(t).reduce((function(e,r){return e+(t[Number(r)]?1:0)}),0);return 1===r||2===r&&t[c.i.Data]&&(t[c.i.Headers]||t[c.i.Totals])}(e)}function ke(e){return e.refs.every(Te)}function Ee(e){return!e.refs.some(Se)}function Ae(e){return Te(e.lhs)&&Te(e.rhs)}function Ne(e){return!Se(e.lhs)&&!Se(e.rhs)}function Te(e){switch(e.kind){case c.j.SpecialRef:case c.j.ColumnRef:return e.isClosed;case c.j.RangeOpRef:return Te(e.lhs)&&Te(e.rhs);case c.j.MissingRef:return!0;case c.j.BadRef:return e.isClosed}}var Re=((n={})[c.i.All]=1,n[c.i.Headers]=2,n[c.i.Data]=3,n[c.i.Totals]=4,n[c.i.ThisRow]=5,n),Ie=function(e){return e.kind===c.j.MissingRef?7:e.kind!==c.j.SpecialRef?6:Re[e.id]};function _e(e,t){return Ie(e)-Ie(t)}function Fe(e){for(var t={},r=[],n=0,a=e.refs;n<a.length;n++){var i=a[n];i.kind!==c.j.SpecialRef?r.push(i):void 0===t[i.id]&&(t[i.id]=!0,r.push(i))}return r.sort(_e),r}},function(e,t,r){"use strict";var n,a,i,o,c,u,s,l,d,f,b,h,v=r(25),p=r(10),m=r(5),g=r(1),O=r(35),j=r(18),y=r(23),S=Object(y.e)([65,91,92,93,95,96,97,123,170,171,181,182,186,187,192,215,216,247,248,706,710,722,736,741,748,749,750,751,880,885,886,888,890,894,895,896,902,903,904,907,908,909,910,930,931,1014,1015,1154,1162,1328,1329,1367,1369,1370,1376,1417,1488,1515,1519,1523,1568,1611,1646,1648,1649,1748,1749,1750,1765,1767,1774,1776,1786,1789,1791,1792,1808,1809,1810,1840,1869,1958,1969,1970,1994,2027,2036,2038,2042,2043,2048,2070,2074,2075,2084,2085,2088,2089,2112,2137,2144,2155,2160,2184,2185,2191,2208,2250,2308,2362,2365,2366,2384,2385,2392,2402,2417,2433,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2493,2494,2510,2511,2524,2526,2527,2530,2544,2546,2556,2557,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2649,2653,2654,2655,2674,2677,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2749,2750,2768,2769,2784,2786,2809,2810,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2877,2878,2908,2910,2911,2914,2929,2930,2947,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3024,3025,3077,3085,3086,3089,3090,3113,3114,3130,3133,3134,3160,3163,3165,3166,3168,3170,3200,3201,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3261,3262,3293,3295,3296,3298,3313,3315,3332,3341,3342,3345,3346,3387,3389,3390,3406,3407,3412,3415,3423,3426,3450,3456,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3585,3643,3648,3663,3713,3715,3716,3717,3718,3723,3724,3748,3749,3750,3751,3761,3762,3764,3773,3774,3776,3781,3782,3783,3804,3808,3840,3841,3904,3912,3913,3949,3976,3981,4096,4139,4159,4160,4176,4182,4186,4190,4193,4194,4197,4199,4206,4209,4213,4226,4238,4239,4256,4294,4295,4296,4301,4302,4304,4347,4348,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4992,5008,5024,5110,5112,5118,5121,5741,5743,5760,5761,5787,5792,5867,5870,5881,5888,5906,5919,5938,5952,5970,5984,5997,5998,6001,6016,6068,6103,6104,6108,6109,6176,6265,6272,6313,6314,6315,6320,6390,6400,6431,6480,6510,6512,6517,6528,6572,6576,6602,6656,6679,6688,6741,6823,6824,6917,6964,6981,6989,7043,7073,7086,7088,7098,7142,7168,7204,7245,7248,7258,7294,7296,7305,7312,7355,7357,7360,7401,7405,7406,7412,7413,7415,7418,7419,7424,7616,7680,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8125,8126,8127,8130,8133,8134,8141,8144,8148,8150,8156,8160,8173,8178,8181,8182,8189,8305,8306,8319,8320,8336,8349,8450,8451,8455,8456,8458,8468,8469,8470,8472,8478,8484,8485,8486,8487,8488,8489,8490,8506,8508,8512,8517,8522,8526,8527,8544,8585,11264,11493,11499,11503,11506,11508,11520,11558,11559,11560,11565,11566,11568,11624,11631,11632,11648,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,12293,12296,12321,12330,12337,12342,12344,12349,12353,12439,12443,12448,12449,12539,12540,12544,12549,12592,12593,12687,12704,12736,12784,12800,13312,19904,19968,42125,42192,42238,42240,42509,42512,42528,42538,42540,42560,42607,42623,42654,42656,42736,42775,42784,42786,42889,42891,42955,42960,42962,42963,42964,42965,42970,42994,43010,43011,43014,43015,43019,43020,43043,43072,43124,43138,43188,43250,43256,43259,43260,43261,43263,43274,43302,43312,43335,43360,43389,43396,43443,43471,43472,43488,43493,43494,43504,43514,43519,43520,43561,43584,43587,43588,43596,43616,43639,43642,43643,43646,43696,43697,43698,43701,43703,43705,43710,43712,43713,43714,43715,43739,43742,43744,43755,43762,43765,43777,43783,43785,43791,43793,43799,43808,43815,43816,43823,43824,43867,43868,43882,43888,44003,44032,55204,55216,55239,55243,55292,63744,64110,64112,64218,64256,64263,64275,64280,64285,64286,64287,64297,64298,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64434,64467,64830,64848,64912,64914,64968,65008,65020,65136,65141,65142,65277,65313,65339,65345,65371,65382,65471,65474,65480,65482,65488,65490,65496,65498,65501],[48,58,63,64,65,91,92,93,95,96,97,123,162,167,168,171,174,177,178,182,183,187,188,191,192,215,216,247,248,888,890,894,895,896,900,907,908,909,910,930,931,1328,1329,1367,1369,1370,1376,1417,1421,1424,1425,1470,1471,1472,1473,1475,1476,1478,1479,1480,1488,1515,1519,1523,1536,1545,1547,1548,1550,1563,1564,1565,1567,1642,1646,1748,1749,1792,1807,1867,1869,1970,1984,2039,2042,2043,2045,2094,2112,2140,2144,2155,2160,2191,2192,2194,2200,2404,2406,2416,2417,2436,2437,2445,2447,2449,2451,2473,2474,2481,2482,2483,2486,2490,2492,2501,2503,2505,2507,2511,2519,2520,2524,2526,2527,2532,2534,2557,2558,2559,2561,2564,2565,2571,2575,2577,2579,2601,2602,2609,2610,2612,2613,2615,2616,2618,2620,2621,2622,2627,2631,2633,2635,2638,2641,2642,2649,2653,2654,2655,2662,2678,2689,2692,2693,2702,2703,2706,2707,2729,2730,2737,2738,2740,2741,2746,2748,2758,2759,2762,2763,2766,2768,2769,2784,2788,2790,2800,2801,2802,2809,2816,2817,2820,2821,2829,2831,2833,2835,2857,2858,2865,2866,2868,2869,2874,2876,2885,2887,2889,2891,2894,2901,2904,2908,2910,2911,2916,2918,2936,2946,2948,2949,2955,2958,2961,2962,2966,2969,2971,2972,2973,2974,2976,2979,2981,2984,2987,2990,3002,3006,3011,3014,3017,3018,3022,3024,3025,3031,3032,3046,3067,3072,3085,3086,3089,3090,3113,3114,3130,3132,3141,3142,3145,3146,3150,3157,3159,3160,3163,3165,3166,3168,3172,3174,3184,3192,3204,3205,3213,3214,3217,3218,3241,3242,3252,3253,3258,3260,3269,3270,3273,3274,3278,3285,3287,3293,3295,3296,3300,3302,3312,3313,3315,3328,3341,3342,3345,3346,3397,3398,3401,3402,3408,3412,3428,3430,3456,3457,3460,3461,3479,3482,3506,3507,3516,3517,3518,3520,3527,3530,3531,3535,3541,3542,3543,3544,3552,3558,3568,3570,3572,3585,3643,3647,3663,3664,3674,3713,3715,3716,3717,3718,3723,3724,3748,3749,3750,3751,3774,3776,3781,3782,3783,3784,3790,3792,3802,3804,3808,3840,3844,3859,3860,3861,3898,3902,3912,3913,3949,3953,3973,3974,3992,3993,4029,4030,4045,4046,4048,4053,4057,4096,4170,4176,4294,4295,4296,4301,4302,4304,4347,4348,4681,4682,4686,4688,4695,4696,4697,4698,4702,4704,4745,4746,4750,4752,4785,4786,4790,4792,4799,4800,4801,4802,4806,4808,4823,4824,4881,4882,4886,4888,4955,4957,4960,4969,4989,4992,5018,5024,5110,5112,5118,5121,5742,5743,5760,5761,5787,5792,5867,5870,5881,5888,5910,5919,5941,5952,5972,5984,5997,5998,6001,6002,6004,6016,6100,6103,6104,6107,6110,6112,6122,6128,6138,6155,6170,6176,6265,6272,6315,6320,6390,6400,6431,6432,6444,6448,6460,6464,6465,6470,6510,6512,6517,6528,6572,6576,6602,6608,6619,6622,6684,6688,6751,6752,6781,6783,6794,6800,6810,6823,6824,6832,6863,6912,6989,6992,7002,7009,7037,7040,7156,7168,7224,7232,7242,7245,7294,7296,7305,7312,7355,7357,7360,7376,7379,7380,7419,7424,7958,7960,7966,7968,8006,8008,8014,8016,8024,8025,8026,8027,8028,8029,8030,8031,8062,8064,8117,8118,8133,8134,8148,8150,8156,8157,8176,8178,8181,8182,8191,8203,8208,8234,8239,8255,8257,8260,8261,8274,8275,8276,8277,8288,8293,8294,8306,8308,8317,8319,8333,8336,8349,8352,8385,8400,8433,8448,8588,8592,9001,9003,9255,9280,9291,9312,10088,10102,10181,10183,10214,10224,10627,10649,10712,10716,10748,10750,11124,11126,11158,11159,11508,11517,11518,11520,11558,11559,11560,11565,11566,11568,11624,11631,11632,11647,11671,11680,11687,11688,11695,11696,11703,11704,11711,11712,11719,11720,11727,11728,11735,11736,11743,11744,11776,11823,11824,11856,11858,11904,11930,11931,12020,12032,12246,12272,12284,12292,12296,12306,12308,12320,12336,12337,12349,12350,12352,12353,12439,12441,12448,12449,12539,12540,12544,12549,12592,12593,12687,12688,12772,12784,12831,12832,42125,42128,42183,42192,42238,42240,42509,42512,42540,42560,42611,42612,42622,42623,42738,42752,42955,42960,42962,42963,42964,42965,42970,42994,43053,43056,43066,43072,43124,43136,43206,43216,43226,43232,43256,43259,43260,43261,43310,43312,43348,43360,43389,43392,43457,43471,43482,43488,43519,43520,43575,43584,43598,43600,43610,43616,43715,43739,43742,43744,43760,43762,43767,43777,43783,43785,43791,43793,43799,43808,43815,43816,43823,43824,43884,43888,44011,44012,44014,44016,44026,44032,55204,55216,55239,55243,55292,63744,64110,64112,64218,64256,64263,64275,64280,64285,64311,64312,64317,64318,64319,64320,64322,64323,64325,64326,64451,64467,64830,64832,64912,64914,64968,64975,64976,65008,65040,65056,65072,65075,65077,65101,65104,65122,65123,65124,65127,65129,65130,65136,65141,65142,65277,65279,65280,65284,65285,65291,65292,65296,65306,65308,65311,65313,65339,65342,65371,65372,65373,65374,65375,65382,65471,65474,65480,65482,65488,65490,65496,65498,65501,65504,65511,65512,65519,65529,65534],[48,58,1632,1642,1776,1786,1984,1994,2406,2416,2534,2544,2662,2672,2790,2800,2918,2928,3046,3056,3174,3184,3302,3312,3430,3440,3558,3568,3664,3674,3792,3802,3872,3882,4160,4170,4240,4250,6112,6122,6160,6170,6470,6480,6608,6618,6784,6794,6800,6810,6992,7002,7088,7098,7232,7242,7248,7258,42528,42538,43216,43226,43264,43274,43472,43482,43504,43514,43600,43610,44016,44026,65296,65306]),C=r(98),k=r(7),E=r(2),A=r(11),N=r(36),T=r(99);function R(e,t,r,n,a,i,o){return void 0===t&&(t=E.h.A1),void 0===r&&(r=T.a),void 0===n&&(n=!1),void 0===a&&(a=!0),void 0===i&&(i=N.f),void 0===o&&(o=N.g),{localeInfo:e,refStyle:t,mathpack:r,date1904:n,dateCompatibility:a,timezone:i,datepack:o}}function I(e,t,r,n,a,i,o,c,u,s,l,d,f,b,h,v,p,m,g,O,j,y,S,C,k,E,A,N,T,R,I,_,F,w,M,D,P,x,L,B,U,G,V,H,W,z,q,K,Y,J,Q,X,Z,$,ee,te,re,ne,ae,ie,oe,ce,ue,se,le){return{getWorksheetFuncId:e,getWorksheetFuncName:t,isNumeral:r,getOrdinal:n,getNumberShape:a,isThousandsPosition:i,isIdentStart:o,isIdentContinue:c,stringCompareCI:u,errorNames:s,specialRefNames:l,trueName:d,falseName:f,rowLetter:b,columnLetter:h,leftBrace:v,rightBrace:p,leftBracket:m,rightBracket:g,decimalSeparator:O,listSeparator:j,columnSeparator:y,rowSeparator:S,thousandsSeparator:C,lcid:k,country:E,isThai:A,isEastAsia:N,isKorea:T,isJapan:R,isChinaT:I,isChinaS:_,isComplexScript:F,numberDecimals:w,isExpSepBySpace:M,fractionSeparator:D,isPercentSepBySpace:P,currencyFormat:x,isCurrencySymbolLead:L,isCurrencySepBySpace:B,currencySymbol:U,currencyDecimals:G,dateOrder:V,dateSeparator:H,dateAltSeparator:W,year4Digits:z,month2Digits:q,day2Digits:K,longDateFormat:Y,timeSeparator:J,timeAltSeparator:Q,hour2Digits:X,clock24Hour:Z,isAMPMSepBySpace:$,ampmSymbols:ee,dayNameShort:te,dayNameLong:re,monthNameShort:ne,monthNameLong:ae,pictureSpecial:ie,pictureSingle:oe,pictureColor:ce,pictureDbnum:ue,sysDateFormat:se,sysTimeFormat:le}}function _(e){return 0!=(S(e)&y.a.DigitClass)}function F(e){var t=S(e);return 0==(t&y.a.DigitClass)?Object(m.a)("calc.config.getOrdinal: expected numeral; given ".concat(Object(O.a)(e))):t&y.a.Ordinal}function w(e){switch(Object(m.h)("calc.config.getNumberShape",_(e)),2147483392&e){case 0:return A.e.ASCII;case 1536:return e<1648?A.e.ArabicIndic:A.e.ExtendedArabicIndic;case 1792:return A.e.Unknown;case 2304:return e<2416?A.e.Devanagari:A.e.Bengali;case 2560:return e<2672?A.e.Gurmukhi:A.e.Gujarati;case 2816:return e<2928?A.e.Oriya:A.e.Tamil;case 3072:return e<3184?A.e.Telugu:A.e.Kannada;case 3328:return e<3440?A.e.Malayalam:A.e.Unknown;case 3584:return e<3680?A.e.Thai:A.e.Lao;case 3840:return A.e.Tibetan;case 4096:return e<4176?A.e.Myanmar:A.e.Unknown;case 4864:return A.e.Ethiopic;case 5888:return A.e.Khmer;case 6144:return A.e.Mongolian;default:return A.e.Unknown}}function M(e){return 0!=(S(e)&y.a.IdentStartClass)}function D(e){return 0!=(S(e)&y.a.IdentContinueClass)}r.d(t,"j",(function(){return R})),r.d(t,"z",(function(){return I})),r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return l})),r.d(t,"h",(function(){return d})),r.d(t,"g",(function(){return f})),r.d(t,"e",(function(){return b})),r.d(t,"f",(function(){return h})),r.d(t,"y",(function(){return _})),r.d(t,"v",(function(){return F})),r.d(t,"u",(function(){return w})),r.d(t,"x",(function(){return M})),r.d(t,"w",(function(){return D})),r.d(t,"l",(function(){return P})),r.d(t,"q",(function(){return L})),r.d(t,"p",(function(){return B})),r.d(t,"o",(function(){return U})),r.d(t,"r",(function(){return H})),r.d(t,"m",(function(){return W})),r.d(t,"n",(function(){return z})),r.d(t,"A",(function(){return q})),r.d(t,"t",(function(){return Y})),r.d(t,"k",(function(){return J})),r.d(t,"s",(function(){return X})),r.d(t,"c",(function(){return v.LogCategory})),r.d(t,"i",(function(){return v.TraceLevel})),r.d(t,"d",(function(){return v.NulLogger})),r.d(t,"B",(function(){return m.i})),function(e){e[e.USA=1]="USA",e[e.UK=44]="UK",e[e.AUS=61]="AUS",e[e.NZ=64]="NZ",e[e.UNK=1]="UNK",e[e.CAN=2]="CAN",e[e.DUT=31]="DUT",e[e.FRN=33]="FRN",e[e.SPA=34]="SPA",e[e.ITN=39]="ITN",e[e.SWE=46]="SWE",e[e.GER=49]="GER",e[e.JPN=81]="JPN",e[e.MEX=52]="MEX",e[e.BRA=55]="BRA",e[e.LAM=3]="LAM",e[e.BEL=32]="BEL",e[e.SWZ=41]="SWZ",e[e.SWG=41]="SWG",e[e.SWF=41]="SWF",e[e.AUT=43]="AUT",e[e.DAN=45]="DAN",e[e.NOR=47]="NOR",e[e.POR=351]="POR",e[e.FIN=358]="FIN",e[e.ICE=354]="ICE",e[e.GRK=30]="GRK",e[e.TUR=90]="TUR",e[e.CZE=420]="CZE",e[e.HUN=36]="HUN",e[e.POL=48]="POL",e[e.RUS=7]="RUS",e[e.HEB=972]="HEB",e[e.ARB=966]="ARB",e[e.PER=981]="PER",e[e.ARB_Algeria=213]="ARB_Algeria",e[e.ARB_Bahrain=966]="ARB_Bahrain",e[e.ARB_Djibouti=253]="ARB_Djibouti",e[e.ARB_Egypt=20]="ARB_Egypt",e[e.ARB_Iraq=964]="ARB_Iraq",e[e.ARB_Jordan=962]="ARB_Jordan",e[e.ARB_Kuwait=965]="ARB_Kuwait",e[e.ARB_Lebanon=961]="ARB_Lebanon",e[e.ARB_Libya=218]="ARB_Libya",e[e.ARB_Mauritania=222]="ARB_Mauritania",e[e.ARB_Morocco=216]="ARB_Morocco",e[e.ARB_Oman=968]="ARB_Oman",e[e.ARB_Qatar=974]="ARB_Qatar",e[e.ARB_SaudiArabia=966]="ARB_SaudiArabia",e[e.ARB_Somalia=1]="ARB_Somalia",e[e.ARB_Sudan=249]="ARB_Sudan",e[e.ARB_Syria=963]="ARB_Syria",e[e.ARB_Tunisia=216]="ARB_Tunisia",e[e.ARB_UAE=971]="ARB_UAE",e[e.ARB_Yemen=969]="ARB_Yemen",e[e.KOR=82]="KOR",e[e.TW=886]="TW",e[e.PRC=86]="PRC",e[e.THA=66]="THA",e[e.VIET=84]="VIET"}(s||(s={})),function(e){e[e.None=0]="None",e[e.USA=1033]="USA",e[e.Greek=1032]="Greek",e[e.Hungarian=1038]="Hungarian",e[e.Turkish=1055]="Turkish",e[e.Thailand=1054]="Thailand",e[e.Vietnam=1066]="Vietnam",e[e.Arabic=1025]="Arabic",e[e.Hebrew=1037]="Hebrew",e[e.Tamil=1097]="Tamil",e[e.Syriac=1114]="Syriac",e[e.Iraq=2049]="Iraq",e[e.Algerian=5121]="Algerian",e[e.Basque=1069]="Basque",e[e.PortBrazil=1046]="PortBrazil",e[e.Croatian=1050]="Croatian",e[e.Czech=1029]="Czech",e[e.Danish=1030]="Danish",e[e.Dutch=1043]="Dutch",e[e.Australian=3081]="Australian",e[e.CanadianEnglish=4105]="CanadianEnglish",e[e.British=2057]="British",e[e.Finnish=1035]="Finnish",e[e.French=1036]="French",e[e.FrenchCanadian=3084]="FrenchCanadian",e[e.Italian=1040]="Italian",e[e.NorskBokmal=1044]="NorskBokmal",e[e.NorskNynorsk=2068]="NorskNynorsk",e[e.Polish=1045]="Polish",e[e.PortIberian=2070]="PortIberian",e[e.Romanian=1048]="Romanian",e[e.Russian=1049]="Russian",e[e.Ukrainian=1058]="Ukrainian",e[e.Belarusian=1059]="Belarusian",e[e.SerbianCyrillic=3098]="SerbianCyrillic",e[e.SerbianLatin=2074]="SerbianLatin",e[e.Slovak=1051]="Slovak",e[e.Slovenian=1060]="Slovenian",e[e.SpanishModern=3082]="SpanishModern",e[e.Swedish=1053]="Swedish",e[e.HongKong=3076]="HongKong",e[e.ChinaT=1028]="ChinaT",e[e.Korea=1042]="Korea",e[e.Japan=1041]="Japan",e[e.China=2052]="China",e[e.ChinaStroke=133124]="ChinaStroke",e[e.Devihi=1125]="Devihi",e[e.Hindi=1081]="Hindi",e[e.German=1031]="German",e[e.Swiss=4108]="Swiss",e[e.SystemTime=62464]="SystemTime",e[e.SystemLongDate=63488]="SystemLongDate",e[e.EuroTrailing=1]="EuroTrailing",e[e.EuroLeading=2]="EuroLeading",e[e.LANG=1023]="LANG",e[e.COUNTRY=64512]="COUNTRY",e[e.OPTIONS=16711680]="OPTIONS"}(l||(l={})),function(e){e[e.AP1=0]="AP1",e[e.AP2=1]="AP2",e[e.AP3=2]="AP3",e[e.GeneralOldMAC=3]="GeneralOldMAC",e[e.General=4]="General",e[e.Currency=5]="Currency"}(d||(d={})),function(e){e[e.Sep=1]="Sep",e[e.Hash=2]="Hash",e[e.Zero=3]="Zero",e[e.Decimal=4]="Decimal",e[e.Percent=5]="Percent",e[e.Comma=6]="Comma",e[e.Colon=7]="Colon",e[e.DateSep=8]="DateSep",e[e.Slash=9]="Slash",e[e.Space=10]="Space",e[e.Minus=11]="Minus",e[e.Plus=12]="Plus",e[e.OpenParen=13]="OpenParen",e[e.CloseParen=14]="CloseParen",e[e.Extra=15]="Extra",e[e.Backslash=16]="Backslash",e[e.Star=17]="Star",e[e.Year=18]="Year",e[e.Month=19]="Month",e[e.Day=20]="Day",e[e.Hour=21]="Hour",e[e.Minute=22]="Minute",e[e.Second=23]="Second",e[e.E=24]="E",e[e.APDelim=25]="APDelim",e[e.Quote=26]="Quote",e[e.ColorStart=27]="ColorStart",e[e.ColorEnd=28]="ColorEnd",e[e.Text=29]="Text",e[e.Question=30]="Question",e[e.Underscore=31]="Underscore",e[e.Reign=32]="Reign",e[e.LocDay=33]="LocDay",e[e.Era=34]="Era",e[e.EraYear=35]="EraYear",e[e.Nen1=36]="Nen1",e[e.Gatsu1=37]="Gatsu1",e[e.Nichi1=38]="Nichi1",e[e.Nen2=39]="Nen2",e[e.Gatsu2=40]="Gatsu2",e[e.Nichi2=41]="Nichi2",e[e.BidiDate=42]="BidiDate",e[e.BidiNum=43]="BidiNum",e[e.DayTh=44]="DayTh",e[e.MonthTh=45]="MonthTh",e[e.YearTh=46]="YearTh",e[e.EngYearTh=47]="EngYearTh",e[e.ThYear=48]="ThYear",e[e.HourTh=49]="HourTh",e[e.MinuteTh=50]="MinuteTh",e[e.SecondTh=51]="SecondTh",e[e.ZeroTh=52]="ZeroTh"}(f||(f={})),function(e){e[e.Black=0]="Black",e[e.White=1]="White",e[e.Red=2]="Red",e[e.Green=3]="Green",e[e.Blue=4]="Blue",e[e.Yellow=5]="Yellow",e[e.Magenta=6]="Magenta",e[e.Cyan=7]="Cyan",e[e.Color=8]="Color"}(b||(b={})),function(e){e[e.DBNUM1=0]="DBNUM1",e[e.DBNUM2=1]="DBNUM2",e[e.DBNUM3=2]="DBNUM3",e[e.DBNUM4=3]="DBNUM4"}(h||(h={}));var P=Object(j.d)(((n={})[k.a.NULL]="#NULL!",n[k.a.DIV0]="#DIV/0!",n[k.a.VALUE]="#VALUE!",n[k.a.REF]="#REF!",n[k.a.NAME]="#NAME?",n[k.a.NUM]="#NUM!",n[k.a.NA]="#N/A",n[k.a.GETTING_DATA]="#GETTING_DATA",n[k.a.FIELD]="#FIELD!",n)),x=Object(j.d)(((a={})[E.i.All]="#All",a[E.i.Data]="#Data",a[E.i.Headers]="#Headers",a[E.i.Totals]="#Totals",a[E.i.ThisRow]="#This Row",a)),L=Object(j.d)(((i={})[d.AP1]="AM/PM",i[d.AP2]="A/P",i[d.AP3]="上午/下午",i[d.General]="General",i[d.Currency]="$",i)),B=Object(j.d)(((o={})[f.Sep]=";",o[f.Hash]="#",o[f.Zero]="0",o[f.Decimal]=".",o[f.Percent]="%",o[f.Comma]=",",o[f.Colon]=":",o[f.DateSep]="/",o[f.Slash]="/",o[f.Space]=" ",o[f.Minus]="-",o[f.Plus]="+",o[f.OpenParen]="(",o[f.CloseParen]=")",o[f.Backslash]="\\",o[f.Star]="*",o[f.Year]="y",o[f.Month]="m",o[f.Day]="d",o[f.Hour]="h",o[f.Minute]="m",o[f.Second]="s",o[f.E]="E",o[f.APDelim]="/",o[f.Quote]='"',o[f.ColorStart]="[",o[f.ColorEnd]="]",o[f.Text]="@",o[f.Question]="?",o[f.Underscore]="_",o[f.Reign]="r",o[f.LocDay]="a",o[f.Era]="g",o[f.EraYear]="e",o[f.BidiDate]="B",o[f.BidiNum]="N",o[f.DayTh]="ว",o[f.MonthTh]="ด",o[f.YearTh]="ป",o[f.EngYearTh]="b",o[f.ThYear]="ค",o[f.HourTh]="ช",o[f.MinuteTh]="น",o[f.SecondTh]="ท",o[f.ZeroTh]="๐",o)),U=Object(j.d)(((c={})[b.Black]="Black",c[b.White]="White",c[b.Red]="Red",c[b.Green]="Green",c[b.Blue]="Blue",c[b.Yellow]="Yellow",c[b.Magenta]="Magenta",c[b.Cyan]="Cyan",c[b.Color]="Color",c)),G=Object(j.d)(((u={})[h.DBNUM1]="DBNum1",u[h.DBNUM2]="DBNum2",u[h.DBNUM3]="DBNum3",u[h.DBNUM4]="DBNum4",u)),V=void 0;function H(e){var t=Y()[e];return void 0===t?"wsf:".concat(e):t}function W(e){var t=P[e];return void 0===t?"error.type:".concat(e):t}function z(e){if(e===g.a.Isect)return" ";if(e===g.a.Union)return",";var t=g.g[e];return void 0===t?"op:".concat(e):t}function q(e,t,r){return t===g.a.Isect?r:t===g.a.Union?e.listSeparator:g.g[t]}var K=/_/g;function Y(){if(null==V){V=[];for(var e=0,t=Object(p.l)(g.b);e<t.length;e++){var r=t[e],n=Object(g.d)(r),a=null!=n?n:g.b[r].replace(K,".");V[r]=a}}return V}function J(e,t){var r=function(e,t){var r=[];return t.forEach((function(e,t){null!=e&&r.push([e,t])})),C.a.create(e).setValues(r)}(e,t);return{getWorksheetFuncId:function(e){return r.getValue(e)},getWorksheetFuncName:function(e){var r=t[e];return null==r?Object(m.a)("calc.config.getWorksheetFuncName: unknown function ID ".concat(e)):r}}}var Q=void 0;function X(){var e,t,r,n,a;return null==Q&&(e=Y(),t=Object(p.h)("en-US"),r=J(t,e),n=r.getWorksheetFuncId,a=r.getWorksheetFuncName,Q=I(n,a,_,F,w,(function(e){return e>0&&e%3==0}),M,D,t,P,x,"TRUE","FALSE","R","C","{","}","[","]",".",",",",",";",",",l.USA,s.USA,!1,!1,!1,!1,!1,!1,!1,2,!1," ",!1,A.b.Paren,!0,!1,"$",2,A.c.MDY,"/","-",!0,!1,!1,!0,":",void 0,!1,!1,!0,["AM","PM"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"],L,B,U,G,"dddd, mmmm dd, yyyy","h:mm:ss AM/PM")),Q}},function(e,t,r){"use strict";r.d(t,"i",(function(){return a})),r.d(t,"h",(function(){return i})),r.d(t,"a",(function(){return o})),r.d(t,"e",(function(){return c})),r.d(t,"d",(function(){return u})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return l})),r.d(t,"f",(function(){return d})),r.d(t,"g",(function(){return f}));var n=r(20),a=n.assertions.ulsLogger,i=n.assertions.assertTrue,o=n.assertions.assertFalse,c=n.assertions.assertNever,u=n.assertions.assertNatural,s=n.assertions.assertIndex,l=n.assertions.assertInteger,d=n.assertions.assertPositiveInteger,f=n.assertions.assertPositiveLength},function(e,t,r){"use strict";r.d(t,"g",(function(){return n})),r.d(t,"m",(function(){return u})),r.d(t,"E",(function(){return s})),r.d(t,"D",(function(){return l})),r.d(t,"C",(function(){return d})),r.d(t,"N",(function(){return f})),r.d(t,"o",(function(){return S})),r.d(t,"w",(function(){return C})),r.d(t,"H",(function(){return k})),r.d(t,"h",(function(){return b})),r.d(t,"b",(function(){return h})),r.d(t,"d",(function(){return v})),r.d(t,"A",(function(){return E})),r.d(t,"y",(function(){return A})),r.d(t,"f",(function(){return p})),r.d(t,"k",(function(){return m})),r.d(t,"a",(function(){return g})),r.d(t,"j",(function(){return O})),r.d(t,"c",(function(){return j})),r.d(t,"i",(function(){return y})),r.d(t,"s",(function(){return N})),r.d(t,"t",(function(){return T})),r.d(t,"q",(function(){return R})),r.d(t,"r",(function(){return I})),r.d(t,"x",(function(){return F})),r.d(t,"u",(function(){return w})),r.d(t,"K",(function(){return M})),r.d(t,"z",(function(){return D})),r.d(t,"I",(function(){return P})),r.d(t,"B",(function(){return x})),r.d(t,"J",(function(){return U})),r.d(t,"L",(function(){return G})),r.d(t,"e",(function(){return L})),r.d(t,"v",(function(){return V})),r.d(t,"M",(function(){return H})),r.d(t,"F",(function(){return W})),r.d(t,"G",(function(){return z})),r.d(t,"l",(function(){return B})),r.d(t,"n",(function(){return q})),r.d(t,"p",(function(){return K}));var n,a=r(9),i=r(3),o=r(10),c=r(0);!function(e){e.NotValueString="NotValueString",e.NotFormatString="NotFormatString",e.NoFormatPart="NoFormatPart",e.TooWide="TooWide",e.DateOverflow="DateOverflow",e.FractionOverflow="FractionOverflow",e.PreviousFormatFailure="PreviousFormatFailure"}(n||(n={}));var u=Object(a.__assign)(Object(a.__assign)({},i.a),n);function s(e){return{kind:u.NotValueString,message:e}}function l(e){return{kind:u.NotFormatString,message:e}}var d={kind:u.NoFormatPart};function f(e){return{kind:u.TooWide,clip:e}}var b,h,v,p,m,g,O,j,y,S={kind:u.DateOverflow},C={kind:u.FractionOverflow};function k(){return{kind:u.PreviousFormatFailure}}function E(e){return e===v.SysDate||e===v.SysTime}function A(e,t){return e.culture===t.culture&&e.numberShape===t.numberShape&&e.nationalNumberInput===t.nationalNumberInput&&e.calendar===t.calendar&&e.localCalendarInput===t.localCalendarInput&&e.tag===t.tag}function N(e,t,r,n,a,i){return{kind:y.General,num:e,decimalSeparator:t,includeSign:r,numberShape:n,expNumberShape:a,builtin:i}}function T(e){return{kind:y.String,str:e}}function R(e){return{kind:y.Blank,str:e}}function I(e){return{kind:y.Flexible,str:e}}function _(e,t,r,n){return{units:e,color:t,alignment:r,clip:n}}function F(e,t){return _(e,t,g.Center,j.All)}!function(e){e.General="General",e.Number="Number",e.Currency="Currency",e.Accounting="Accounting",e.Date="Date",e.Time="Time",e.Percentage="Percentage",e.Fraction="Fraction",e.Scientific="Scientific",e.Text="Text",e.Custom="Custom"}(b||(b={})),function(e){e.English="English",e.Lunar="Lunar"}(h||(h={})),function(e){e.SysDate="sysdate",e.SysTime="systime",e.Euro1="euro1",e.Euro2="euro2",e.GenLower="genlower",e.GenUpper="genupper",e.NomLower="nomlower",e.Bitcoin1="xbt1",e.Bitcoin2="xbt2",e.Gannen="gannen"}(v||(v={})),function(e){e[e.LocaleInfo=0]="LocaleInfo"}(p||(p={})),function(e){e.Black="Black",e.White="White",e.Red="Red",e.Green="Green",e.Blue="Blue",e.Yellow="Yellow",e.Magenta="Magenta",e.Cyan="Cyan"}(m||(m={})),function(e){e.Left="Left",e.Center="Center",e.Right="Right"}(g||(g={})),function(e){e.ValueCell="ValueCell",e.Volatile="Volatile",e.NonVolatile="NonVolatile"}(O||(O={})),function(e){e[e.MaxChars=2]="MaxChars",e[e.CellWidth=4]="CellWidth",e[e.None=0]="None",e[e.All=6]="All"}(j||(j={})),function(e){e.String="String",e.Blank="Blank",e.General="General",e.Flexible="Flexible"}(y||(y={}));var w=_,M=_;function D(e){return!Array.isArray(e.units)}function P(e,t,r){return{renderWidth:e,bestFit:r,getTextWidth:t}}function x(e){var t=Object(o.i)();return P(e.renderWidth,(function(r){if(null!=t[r])return t[r];var n=e.getTextWidth(r);return t[r]=n,n}),e.bestFit)}var L,B,U={renderWidth:1/0,bestFit:!1,getTextWidth:function(e){return e.length}};function G(e){for(var t="",r=0,n=e.units;r<n.length;r++){var a=n[r];switch(a.kind){case y.String:t+=a.str;break;case y.Blank:for(var i=0;i<a.str.length;i+=1)t+=" "}}return t}function V(e){return{kind:L.Formula,fmla:e}}function H(e,t){return{kind:L.String,value:e,tick:t}}function W(e,t){return{kind:L.Number,value:e,format:t}}function z(e){return{kind:L.Other,value:e}}function q(e,t){return{config:e,getTime:t}}function K(e,t){var r=Object(i.ib)(e.range);return{config:null!=t?t:void 0,lexicalSource:e,originGridCell:Object(c.f)(r.range),originSheet:Object(c.f)(r.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1}}!function(e){e.Formula="Formula",e.String="String",e.Number="Number",e.Other="Other"}(L||(L={})),function(e){e.Builtin="Builtin",e.CustomString="CustomString",e.CustomBytecode="CustomBytecode",e.System="System"}(B||(B={}))},function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"f",(function(){return s})),r.d(t,"a",(function(){return u})),r.d(t,"q",(function(){return l})),r.d(t,"e",(function(){return d})),r.d(t,"u",(function(){return f})),r.d(t,"h",(function(){return b})),r.d(t,"o",(function(){return h})),r.d(t,"g",(function(){return v})),r.d(t,"w",(function(){return p})),r.d(t,"t",(function(){return m})),r.d(t,"n",(function(){return g})),r.d(t,"p",(function(){return O})),r.d(t,"m",(function(){return j})),r.d(t,"k",(function(){return y})),r.d(t,"j",(function(){return S})),r.d(t,"c",(function(){return E})),r.d(t,"s",(function(){return A})),r.d(t,"r",(function(){return N})),r.d(t,"l",(function(){return T})),r.d(t,"d",(function(){return R})),r.d(t,"v",(function(){return I})),r.d(t,"i",(function(){return _}));var n,a,i=r(5),o=r(18),c=r(8);!function(e){e[e.Lower=-1]="Lower",e[e.Exact=0]="Exact",e[e.Upper=1]="Upper"}(a||(a={}));var u,s=32767;function l(e,t,r,n){return{cells:e,names:t,special:r,bound:n}}function d(e){return e?I:_}function f(e){return{kind:c.b.String,value:e}}function b(e){var t=k[e];return void 0!==t?t:C(e)}!function(e){e[e.NULL=1]="NULL",e[e.DIV0=2]="DIV0",e[e.VALUE=3]="VALUE",e[e.REF=4]="REF",e[e.NAME=5]="NAME",e[e.NUM=6]="NUM",e[e.NA=7]="NA",e[e.GETTING_DATA=8]="GETTING_DATA",e[e.FIELD=13]="FIELD"}(u||(u={}));var h=C(u.NULL),v=C(u.DIV0),p=C(u.VALUE),m=C(u.REF),g=C(u.NAME),O=C(u.NUM),j=C(u.NA),y=C(u.GETTING_DATA),S=C(u.FIELD);function C(e){return{kind:c.b.Error,type:e}}var k=Object(o.d)(((n={})[u.NULL]=h,n[u.DIV0]=v,n[u.VALUE]=p,n[u.REF]=m,n[u.NAME]=g,n[u.NUM]=O,n[u.NA]=j,n[u.GETTING_DATA]=y,n[u.FIELD]=S,n));function E(e,t,r){return Object(i.d)("calc.lang.arrayOper",e),Object(i.d)("calc.lang.arrayOper",t),r.length!==e?Object(i.a)("calc.lang.arrayOper: Inconsistent row number"):{kind:c.b.Array,rows:e,cols:t,opers:r}}function A(e,t){return Object(i.f)("calc.lang.rangeSeqOper",t.length),{kind:c.b.Range,sheets:e,ranges:t}}function N(e,t){return{kind:c.b.Range,sheets:e,ranges:[t]}}var T={kind:c.b.Missing},R={kind:c.b.Blank},I={kind:c.b.Boolean,value:!0},_={kind:c.b.Boolean,value:!1}},function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return a})),r.d(t,"d",(function(){return i})),r.d(t,"a",(function(){return o})),r.d(t,"e",(function(){return u}));var n,a,i,o,c=r(5);function u(e,t,r,n,a,i,o,u){if(Object(c.d)("calc.lang.functionType",t),Object(c.b)("calc.lang.functionType",e,t+1),0===n.length?0!==a.length:a.length>=n.length){var s=JSON.stringify(a);Object(c.a)("calc.lang.functionType: expected tailTypes.length < restTypes.length; given ".concat(s))}if(0===n.length&&r.length+a.length<t){s=JSON.stringify(r);Object(c.a)("calc.lang.functionType: expected headTypes.length + tailTypes.length >= ".concat(t,"; given ").concat(s))}return{minArgs:e,maxArgs:t,headTypes:r,restTypes:n,tailTypes:a,returnType:i,staticPrecs:o,flags:u}}!function(e){e[e.Number=1]="Number",e[e.String=2]="String",e[e.Boolean=4]="Boolean",e[e.Error=8]="Error",e[e.Range=16]="Range",e[e.Array=32]="Array",e[e.Missing=64]="Missing",e[e.Blank=128]="Blank",e[e.Rich=256]="Rich"}(n||(n={})),function(e){e[e.None=0]="None",e[e.Goto=512]="Goto",e[e.Ref3D=1024]="Ref3D",e[e.All=2047]="All"}(a||(a={})),function(e){e[e.None=0]="None",e[e.OwnDoc=1]="OwnDoc",e[e.OwnSheet=2]="OwnSheet",e[e.OwnRow=4]="OwnRow",e[e.OwnCol=8]="OwnCol",e[e.OwnRowCopy=16]="OwnRowCopy",e[e.OwnColCopy=32]="OwnColCopy",e[e.OwnDocSheets=64]="OwnDocSheets",e[e.CellProps=128]="CellProps",e[e.AllCells=256]="AllCells",e[e.AllNames=512]="AllNames",e[e.Time=1024]="Time",e[e.Calc=2048]="Calc",e[e.InFilterMode=4096]="InFilterMode",e[e.RefStyle=8192]="RefStyle",e[e.All=16383]="All"}(i||(i={})),function(e){e[e.None=0]="None",e[e.Dark=1]="Dark",e[e.Macro=2]="Macro",e[e.OnlyParsedDuringLoad=4]="OnlyParsedDuringLoad",e[e.Internal=8]="Internal",e[e.Allow3dRef=16]="Allow3dRef"}(o||(o={}))},function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return a})),r.d(t,"__assign",(function(){return i})),r.d(t,"__rest",(function(){return o})),r.d(t,"__decorate",(function(){return c})),r.d(t,"__param",(function(){return u})),r.d(t,"__metadata",(function(){return s})),r.d(t,"__awaiter",(function(){return l})),r.d(t,"__generator",(function(){return d})),r.d(t,"__createBinding",(function(){return f})),r.d(t,"__exportStar",(function(){return b})),r.d(t,"__values",(function(){return h})),r.d(t,"__read",(function(){return v})),r.d(t,"__spread",(function(){return p})),r.d(t,"__spreadArrays",(function(){return m})),r.d(t,"__spreadArray",(function(){return g})),r.d(t,"__await",(function(){return O})),r.d(t,"__asyncGenerator",(function(){return j})),r.d(t,"__asyncDelegator",(function(){return y})),r.d(t,"__asyncValues",(function(){return S})),r.d(t,"__makeTemplateObject",(function(){return C})),r.d(t,"__importStar",(function(){return E})),r.d(t,"__importDefault",(function(){return A})),r.d(t,"__classPrivateFieldGet",(function(){return N})),r.d(t,"__classPrivateFieldSet",(function(){return T}));
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function a(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var i=function(){return(i=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var a in t=arguments[r])Object.prototype.hasOwnProperty.call(t,a)&&(e[a]=t[a]);return e}).apply(this,arguments)};function o(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(n=Object.getOwnPropertySymbols(e);a<n.length;a++)t.indexOf(n[a])<0&&Object.prototype.propertyIsEnumerable.call(e,n[a])&&(r[n[a]]=e[n[a]])}return r}function c(e,t,r,n){var a,i=arguments.length,o=i<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)o=Reflect.decorate(e,t,r,n);else for(var c=e.length-1;c>=0;c--)(a=e[c])&&(o=(i<3?a(o):i>3?a(t,r,o):a(t,r))||o);return i>3&&o&&Object.defineProperty(t,r,o),o}function u(e,t){return function(r,n){t(r,n,e)}}function s(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,r,n){return new(r||(r=Promise))((function(a,i){function o(e){try{u(n.next(e))}catch(e){i(e)}}function c(e){try{u(n.throw(e))}catch(e){i(e)}}function u(e){var t;e.done?a(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(o,c)}u((n=n.apply(e,t||[])).next())}))}function d(e,t){var r,n,a,i,o={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(i){return function(c){return function(i){if(r)throw new TypeError("Generator is already executing.");for(;o;)try{if(r=1,n&&(a=2&i[0]?n.return:i[0]?n.throw||((a=n.return)&&a.call(n),0):n.next)&&!(a=a.call(n,i[1])).done)return a;switch(n=0,a&&(i=[2&i[0],a.value]),i[0]){case 0:case 1:a=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,n=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!(a=o.trys,(a=a.length>0&&a[a.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!a||i[1]>a[0]&&i[1]<a[3])){o.label=i[1];break}if(6===i[0]&&o.label<a[1]){o.label=a[1],a=i;break}if(a&&o.label<a[2]){o.label=a[2],o.ops.push(i);break}a[2]&&o.ops.pop(),o.trys.pop();continue}i=t.call(e,o)}catch(e){i=[6,e],n=0}finally{r=a=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,c])}}}var f=Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function b(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||f(t,e,r)}function h(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,a,i=r.call(e),o=[];try{for(;(void 0===t||t-- >0)&&!(n=i.next()).done;)o.push(n.value)}catch(e){a={error:e}}finally{try{n&&!n.done&&(r=i.return)&&r.call(i)}finally{if(a)throw a.error}}return o}function p(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function m(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),a=0;for(t=0;t<r;t++)for(var i=arguments[t],o=0,c=i.length;o<c;o++,a++)n[a]=i[o];return n}function g(e,t,r){if(r||2===arguments.length)for(var n,a=0,i=t.length;a<i;a++)!n&&a in t||(n||(n=Array.prototype.slice.call(t,0,a)),n[a]=t[a]);return e.concat(n||Array.prototype.slice.call(t))}function O(e){return this instanceof O?(this.v=e,this):new O(e)}function j(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,a=r.apply(e,t||[]),i=[];return n={},o("next"),o("throw"),o("return"),n[Symbol.asyncIterator]=function(){return this},n;function o(e){a[e]&&(n[e]=function(t){return new Promise((function(r,n){i.push([e,t,r,n])>1||c(e,t)}))})}function c(e,t){try{(r=a[e](t)).value instanceof O?Promise.resolve(r.value.v).then(u,s):l(i[0][2],r)}catch(e){l(i[0][3],e)}var r}function u(e){c("next",e)}function s(e){c("throw",e)}function l(e,t){e(t),i.shift(),i.length&&c(i[0][0],i[0][1])}}function y(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,a){t[n]=e[n]?function(t){return(r=!r)?{value:O(e[n](t)),done:"return"===n}:a?a(t):t}:a}}function S(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=h(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,a){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,a,(t=e[r](t)).done,t.value)}))}}}function C(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var k=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function E(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&f(t,e,r);return k(t,e),t}function A(e){return e&&e.__esModule?e:{default:e}}function N(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function T(e,t,r,n,a){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!a)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?a.call(e,r):a?a.value=r:t.set(e,r),r}},function(e,t,r){"use strict";r.d(t,"g",(function(){return a})),r.d(t,"r",(function(){return i})),r.d(t,"u",(function(){return o})),r.d(t,"s",(function(){return c})),r.d(t,"t",(function(){return u})),r.d(t,"d",(function(){return s})),r.d(t,"i",(function(){return l})),r.d(t,"l",(function(){return d})),r.d(t,"m",(function(){return f})),r.d(t,"v",(function(){return b})),r.d(t,"p",(function(){return h})),r.d(t,"o",(function(){return v})),r.d(t,"e",(function(){return p})),r.d(t,"f",(function(){return m})),r.d(t,"n",(function(){return g})),r.d(t,"c",(function(){return O})),r.d(t,"b",(function(){return j})),r.d(t,"a",(function(){return y})),r.d(t,"h",(function(){return S})),r.d(t,"w",(function(){return C})),r.d(t,"q",(function(){return k})),r.d(t,"j",(function(){return E})),r.d(t,"k",(function(){return A}));var n=r(20),a=n.core.makeNewtypeIso,i=n.core.staticAssertExtends,o=n.core.staticAssertSame,c=n.core.staticAssertIs,u=n.core.staticAssertIsOptional,s=n.core.identity,l=n.core.makeStringMap,d=(n.core.cloneStringMap,n.core.numEnumArray),f=n.core.numEnumMap,b=n.core.strEnumArray,h=n.core.safePush,v=n.core.safeConcat,p=n.core.isDefined,m=n.core.isNone,g=(n.core.filterOutNones,n.core.pair),O=n.core.fastMin,j=n.core.fastMax,y=n.core.fastAbs,S=n.core.makeStringCompareCI,C=n.core.typedInstanceCreator,k=n.core.singleton,E=(n.core.fswitch,n.core.mapFromArrayOfPairs),A=n.core.now},function(e,t,r){"use strict";var n,a,i,o,c;r.d(t,"b",(function(){return n})),r.d(t,"c",(function(){return a})),r.d(t,"e",(function(){return i})),r.d(t,"a",(function(){return o})),r.d(t,"d",(function(){return c})),function(e){e.Paren="Paren",e.Lead="Lead",e.Intern="Intern",e.Trail="Trail"}(n||(n={})),function(e){e.MDY="MDY",e.DMY="DMY",e.YMD="YMD",e.MYD="MYD",e.DYM="DYM",e.YDM="YDM"}(a||(a={})),function(e){e.ASCII="ASCII",e.ArabicIndic="ArabicIndic",e.ExtendedArabicIndic="ExtendedArabicIndic",e.Devanagari="Devanagari",e.Bengali="Bengali",e.Gurmukhi="Gurmukhi",e.Gujarati="Gujarati",e.Oriya="Oriya",e.Tamil="Tamil",e.Telugu="Telugu",e.Kannada="Kannada",e.Malayalam="Malayalam",e.Thai="Thai",e.Lao="Lao",e.Tibetan="Tibetan",e.Myanmar="Myanmar",e.Ethiopic="Ethiopic",e.Khmer="Khmer",e.Mongolian="Mongolian",e.Unknown="Unknown",e.ChineseTrad1="ChineseTrad1",e.ChineseTrad2="ChineseTrad2",e.ChineseTrad3="ChineseTrad3",e.ChineseSimp1="ChineseSimp1",e.ChineseSimp2="ChineseSimp2",e.ChineseSimp3="ChineseSimp3",e.Japanese1="Japanese1",e.Japanese2="Japanese2",e.Japanese3="Japanese3",e.Korean1="Korean1",e.Korean2="Korean2",e.Korean3="Korean3",e.Korean4="Korean4"}(i||(i={})),function(e){e.Gregorian="Gregorian",e.GregorianUS="GregorianUS",e.Japan="Japan",e.Taiwan="Taiwan",e.Korea="Korea",e.Hijri="Hijri",e.Thai="Thai",e.Hebrew="Hebrew",e.GregorianMEFrench="GregorianMEFrench",e.GregorianArabic="GregorianArabic",e.GregorianXlitEnglish="GregorianXlitEnglish",e.GregorianXlitFrench="GregorianXlitFrench"}(o||(o={})),function(e){e[e.General=0]="General",e[e.NoComFixed0=-1]="NoComFixed0",e[e.NoComFixed=-2]="NoComFixed",e[e.Fixed0=-3]="Fixed0",e[e.Fixed=-4]="Fixed",e[e.Currency=-9]="Currency",e[e.CoCurrency=-10]="CoCurrency",e[e.CurrencyDec=-11]="CurrencyDec",e[e.CoCurrencyDec=-12]="CoCurrencyDec",e[e.Pct0=-13]="Pct0",e[e.Pct=-14]="Pct",e[e.Exp=-15]="Exp",e[e.Fract=-17]="Fract",e[e.FractBond=-18]="FractBond",e[e.MMDDYY=-19]="MMDDYY",e[e.DDMMMYY=-20]="DDMMMYY",e[e.DDMMM=-21]="DDMMM",e[e.MMMYY=-22]="MMMYY",e[e.HHMMAP=-23]="HHMMAP",e[e.HHMMSSAP=-24]="HHMMSSAP",e[e.HHMM=-25]="HHMM",e[e.HHMMSS=-26]="HHMMSS",e[e.MDYHMS=-27]="MDYHMS",e[e.USCoCurrency=-37]="USCoCurrency",e[e.USCoCurrencyDec=-39]="USCoCurrencyDec",e[e.Currency2=-5]="Currency2",e[e.CoCurrency2=-6]="CoCurrency2",e[e.CurrencyDec2=-7]="CurrencyDec2",e[e.CoCurrencyDec2=-8]="CoCurrencyDec2",e[e.Acct=-33]="Acct",e[e.AcctCur=-32]="AcctCur",e[e.AcctDec=-35]="AcctDec",e[e.AcctDecCur=-34]="AcctDecCur",e[e.MMSS=-28]="MMSS",e[e.AbsHMMSS=-31]="AbsHMMSS",e[e.SS0=-29]="SS0",e[e.Eng=-16]="Eng",e[e.Text=-30]="Text"}(c||(c={}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a})),r.d(t,"h",(function(){return c})),r.d(t,"k",(function(){return u})),r.d(t,"i",(function(){return s})),r.d(t,"j",(function(){return l})),r.d(t,"v",(function(){return d})),r.d(t,"o",(function(){return f})),r.d(t,"d",(function(){return b})),r.d(t,"w",(function(){return h})),r.d(t,"t",(function(){return v})),r.d(t,"s",(function(){return p})),r.d(t,"c",(function(){return m})),r.d(t,"u",(function(){return g})),r.d(t,"x",(function(){return O})),r.d(t,"g",(function(){return j})),r.d(t,"f",(function(){return y})),r.d(t,"q",(function(){return C})),r.d(t,"r",(function(){return k})),r.d(t,"p",(function(){return E})),r.d(t,"n",(function(){return A})),r.d(t,"e",(function(){return N})),r.d(t,"m",(function(){return T})),r.d(t,"l",(function(){return R})),r.d(t,"y",(function(){return I}));var n,a,i=r(5),o=r(3);function c(e){return{kind:n.Cell,range:e}}function u(e){return{kind:n.Range,range:e}}function s(e,t){switch(e){case n.Cell:return Object(o.U)(t)?c(t):Object(i.a)("calc.lang.lexicalSourceGrid: expected cell");case n.Range:return u(t)}}function l(e){return{kind:n.NameManager,name:e}}!function(e){e[e.Cell=1]="Cell",e[e.Range=2]="Range",e[e.NameManager=3]="NameManager",e[e.CondFormatting=4]="CondFormatting",e[e.DataValidation=5]="DataValidation",e[e.Indirect=6]="Indirect",e[e.Other=7]="Other"}(n||(n={})),function(e){e.AppHead="AppHead",e.Plain="Plain",e.StructRef="StructRef",e.Indirect="Indirect"}(a||(a={}));var d=1<<20,f=16384;function b(e,t){return{path:e,name:t}}function h(e,t,r,n){return{name:e,range:t,hasHeadersRow:r,hasTotalsRow:n}}function v(e,t,r){return{document:e,index:t,index2:r}}function p(e,t){return v(e,t,t)}function m(e){return{document:e,index:void 0,index2:void 0}}function g(e,t){return{sheets:e,position:t}}function O(e,t,r,n){return{row:e,col:t,rows:r,cols:n}}function j(e,t,r,n){return Object(i.b)("calc.lang.gridRange",e,d),Object(i.b)("calc.lang.gridRange",t,f),Object(i.g)("calc.lang.gridRange",r,d-e),Object(i.g)("calc.lang.gridRange",n,f-t),O(e,t,r,n)}function y(e,t){return Object(i.b)("calc.lang.gridCell",e,d),Object(i.b)("calc.lang.gridCell",t,f),O(e,t,1,1)}function S(e,t){return{sheet:e,range:t}}var C=S,k=S,E=S,A=S;function N(e){return{document:e,index:void 0}}function T(e,t){return void 0===t?N(e):p(e,t)}function R(e,t){return{scope:e,name:t}}function I(e,t){return{document:e,id:t}}},function(e,t,r){"use strict";r.d(t,"p",(function(){return u})),r.d(t,"i",(function(){return s})),r.d(t,"q",(function(){return l})),r.d(t,"f",(function(){return f})),r.d(t,"d",(function(){return b})),r.d(t,"b",(function(){return h})),r.d(t,"v",(function(){return v})),r.d(t,"a",(function(){return m})),r.d(t,"m",(function(){return g})),r.d(t,"r",(function(){return O})),r.d(t,"g",(function(){return j})),r.d(t,"s",(function(){return S})),r.d(t,"n",(function(){return C})),r.d(t,"t",(function(){return k})),r.d(t,"c",(function(){return E})),r.d(t,"k",(function(){return N})),r.d(t,"l",(function(){return T})),r.d(t,"u",(function(){return R})),r.d(t,"j",(function(){return I})),r.d(t,"o",(function(){return _})),r.d(t,"h",(function(){return F})),r.d(t,"e",(function(){return w}));var n=r(25),a=r(5),i=r(35),o=r(0),c=r(10);function u(e,t,r,c){var u;if(function(e){for(var t=e;null!=t;)t=t()}(e(t,r,c,(function(e,t){u=Object(o.f)({output:e,index:t})}),(function(){u=Object(o.c)(void 0)}))),null==u){var s=Object(i.a)(t),l="calc.parse.runParser: internal error: parser did not call resolve or reject on ".concat(s);return a.i.ULS.assertTag(595980827,n.LogCategory.msoulscat_ES_EWAJS,!1,l)}return u}function s(e){var t;return function(r,n,a,i,o){var c=null!=t?t:t=e();return function(){return c(r,n,a,i,o)}}}function l(e){return function(t,r,n,a,i){return a(e,r)}}var d=function(e,t,r,n,a){return a};function f(){return d}function b(e,t){return function(r,n,a,i,o){return e(r,n,a,(function(e,n){return t(a,e)(r,n,a,i,o)}),o)}}function h(e,t){return function(r,n,a,i,o){return e(r,n,a,(function(e,r){return i(t(a,e),r)}),o)}}function v(e){return function(t,r,n,a,i){return e(n)(t,r,n,a,i)}}function p(e,t){return function(r,n,a,i,o){return e(r,n,a,i,(function(){return t(r,n,a,i,o)}))}}function m(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return 0===e.length?f():e.reduce(p)}function g(e,t){return function(r,n,a,i,o){return e(r,n,a,i,(function(){return i(t,n)}))}}function O(e){return function(t,r,n,a,i){return e(t,r,n,(function(){return a(!0,r)}),i)}}function j(e){return function(t,r,n,a,i){return e(t,r,n,i,(function(){return a(!0,r)}))}}function y(e,t){return function(r,n,a,i,o){var c=r[n];if(null==c)return o;var u=e(a,c);return null==u?o:i(u,n+t)}}function S(e){return y(e,1)}function C(e){return y(e,0)}function k(e){return function(t,r,n,a,i){var o=t[r],c=t[r+1];if(null==o||null==c)return i;var u=e(n,o,c);return null==u?i:a(u,r+1)}}function E(e,t){return function(r,n,a,i,o){return e(r,n,a,(function(e,r){var n=t(a,e);return null==n?o:i(n,r)}),o)}}function A(e,t){return r=e,o=function(e,t,r){return r.push(t),r},c=t,function(e,t,u,s,l){var d=c,f=t;function b(){return r(e,f,u,h,v)}function h(t,r){if(r<=f){var c=Object(i.a)(e),s="calc.parse.reduce: internal error: no progress made at index ".concat(f," on ").concat(c);return a.i.ULS.assertTag(595980829,n.LogCategory.msoulscat_ES_EWAJS,!1,s)}return d=o(u,t,d),f=r,b}function v(){return s(d,f)}return b};var r,o,c}function N(e,t){return void 0===t?function(t,r,n,a,i){return A(e,[])(t,r,n,a,i)}:function(r,n,a,i,o){return e(r,n,a,(function(e,n){return A(t,[e])(r,n,a,i,o)}),(function(){return i([],n)}))}}function T(e,t){return void 0===t&&(t=e),b(e,(function(e,r){return A(t,[r])}))}function R(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];if(0===e.length)return l([]);if(1===e.length)return h(e[0],(function(e,t){return[t]}));var r=e.length;return function(t,n,a,i,o){var c=n,u=[];function s(){return e[u.length](t,c,a,l,o)}function l(e,t){return c=t,u.push(e),u.length<r?s:i(u,c)}return s}}function I(e,t){return h(R(e,t),(function(e,t){return t[0]}))}function _(e,t){return h(R(e,t),(function(e,t){return t[1]}))}function F(e){return h(e,(function(e,t){return Object(c.o)([],t)}))}function w(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return F(R.apply(void 0,e))}},function(e,t,r){"use strict";r.d(t,"b",(function(){return c})),r.d(t,"a",(function(){return n})),r.d(t,"c",(function(){return u})),r.d(t,"l",(function(){return s})),r.d(t,"m",(function(){return l})),r.d(t,"n",(function(){return d})),r.d(t,"p",(function(){return f})),r.d(t,"f",(function(){return b})),r.d(t,"q",(function(){return h})),r.d(t,"j",(function(){return v})),r.d(t,"k",(function(){return p})),r.d(t,"i",(function(){return m})),r.d(t,"h",(function(){return g})),r.d(t,"g",(function(){return y})),r.d(t,"o",(function(){return S})),r.d(t,"d",(function(){return O})),r.d(t,"e",(function(){return j}));var n,a=r(9),i=r(10),o=r(5),c={GetSheetNames:"GetSheetNames",GetRange:"GetRange",Delay:"Delay",GetCell:"GetCell",GetContainingTable:"GetContainingTable",GetIntersectingTables:"GetIntersectingTables",GetIformat:"GetIformat",ParseCellFormula:"ParseCellFormula",ParseEdit:"ParseEdit",ParseNumberFormat:"ParseNumberFormat",PrintFormula:"PrintFormula",GetActiveCell:"GetActiveCell",GetConfig:"GetConfig",AwaitPromise:"AwaitPromise",GetFunctionsInfo:"GetFunctionsInfo",GetFunctionInfo:"GetFunctionInfo",GetCorrelationId:"GetCorrelationId",SetActiveCell:"SetActiveCell",ParseActiveCell:"ParseActiveCell",GetRichValueFieldListContext:"GetRichValueFieldListContext",GetHiddenRows:"GetHiddenRows",GetHiddenCols:"GetHiddenCols",GetDefinedNamesInfo:"GetDefinedNamesInfo",GetDefinedNameInfo:"GetDefinedNameInfo",ResolveReferences:"ResolveReferences"};Object(i.r)(),Object(i.r)(),function(e){e.setActiveCell="setActiveCell",e.doNothing="doNothing",e.setA1ReferenceStyle="setA1ReferenceStyle",e.setLocale="setLocale",e.setWorkbookProps="setWorkbookProps",e.updateSheetNames="updateSheetNames",e.updateNamedObjects="updateNamedObjects",e.setFunctionsInfo="setFunctionsInfo",e.conflictResolverEarlyTermination="conflictResolverEarlyTermination",e.setDefinedNamesInfo="setDefinedNamesInfo"}(n||(n={})),Object(i.r)();var u;n.setActiveCell,n.doNothing,n.setFunctionsInfo,n.setDefinedNamesInfo;function s(e){function t(e){return function(t){Object(i.f)(t)||e(t)}}return{doNothing:t((function(t){return e.doNotify(n.doNothing,[t])})),setActiveCell:t((function(t){return e.doNotify(n.setActiveCell,[t])})),setFunctionsInfo:t((function(t){return e.doNotify(n.setFunctionsInfo,[t])})),setDefinedNamesInfo:t((function(t){return e.doNotify(n.setDefinedNamesInfo,[t])}))}}function l(e){var t=function(t){return function(r){return Object(i.f)(r)?Promise.resolve(null):Promise.resolve(e.doRequest(t,r))}};Object(i.r)();for(var r={},n=0,a=Object(i.v)(u);n<a.length;n++){var o=a[n];r[o]=t(o)}return r}function d(e){return{parenthesesCoupling:function(t){return Object(i.f)(t)?null:e.doSyncRequest(u.parenthesesCoupling,t)}}}function f(e,t){var r;return Object(a.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(a.__assign)({kind:e},t)];case 1:if("RequestFailure"===(r=n.sent()).kind)throw"RequestFailure: typedRequest got error response";return Object(o.h)("Response kind coincides with request kind",r.kind===e),[2,r]}}))}function b(e){var t;return Object(a.__generator)(this,(function(r){switch(r.label){case 0:return[4,{kind:c.AwaitPromise,promise:e}];case 1:return t=r.sent(),Object(o.h)("Response kind coincides with request kind",t.kind===c.AwaitPromise),[2,t.result]}}))}function h(e){var t,r,n,i;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return r=void 0!==t?e.next(t):e.next(),[4,{kind:c.AwaitPromise,promise:r}];case 1:return n=a.sent(),Object(o.h)("Response kind coincides with request kind",n.kind===c.AwaitPromise),!0===(i=n.result).done?[2,i.value]:[4,i.value];case 2:return t=a.sent(),[3,0];case 3:return[2]}}))}function v(e){return f(c.GetRange,{range:e})}function p(){return f(c.GetSheetNames,{})}function m(e){return f(c.GetCell,{cell:e})}function g(){return f(c.Delay,{})}Object(i.u)(),Object(i.r)(),Object(i.r)(),function(e){e.functionSuggestion="functionSuggestion",e.formulaHighlighting="formulaHighlighting",e.argumentAssistance="argumentAssistance",e.runExperiment="runExperiment",e.runAuthoringExperiment="runAuthoringExperiment",e.parenthesesCoupling="parenthesesCoupling"}(u||(u={})),Object(i.r)(),Object(i.r)(),Object(i.r)(),Object(i.r)();var O,j,y={kind:c.Delay};function S(e,t,r){return void 0===r&&(r=!1),f(c.ParseCellFormula,{cell:e,formula:t,useEnglishLocaleInfo:r})}!function(e){e[e.NoOpRequest=0]="NoOpRequest",e[e.AsyncRequest=1]="AsyncRequest",e[e.SyncRequest=2]="SyncRequest",e[e.StepPlugin=3]="StepPlugin",e[e.StopPlugins=4]="StopPlugins"}(O||(O={})),function(e){e.DevOnly="DevOnly",e.StableOnly="StableOnly",e.Both="Both",e.SyncDevOnly="SyncDevOnly",e.SyncStableOnly="SyncStableOnly",e.SyncBoth="SyncBoth"}(j||(j={})),Object(i.r)(),Object(i.r)(),Object(i.r)()},function(e,t,r){"use strict";r.d(t,"c",(function(){return n})),r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i})),r.d(t,"d",(function(){return o})),r.d(t,"y",(function(){return O})),r.d(t,"z",(function(){return j})),r.d(t,"j",(function(){return y})),r.d(t,"x",(function(){return S})),r.d(t,"i",(function(){return C})),r.d(t,"q",(function(){return E})),r.d(t,"V",(function(){return A})),r.d(t,"Y",(function(){return N})),r.d(t,"s",(function(){return T})),r.d(t,"w",(function(){return R})),r.d(t,"D",(function(){return _})),r.d(t,"C",(function(){return F})),r.d(t,"B",(function(){return w})),r.d(t,"E",(function(){return M})),r.d(t,"S",(function(){return D})),r.d(t,"R",(function(){return P})),r.d(t,"Q",(function(){return x})),r.d(t,"T",(function(){return L})),r.d(t,"F",(function(){return B})),r.d(t,"m",(function(){return U})),r.d(t,"U",(function(){return G})),r.d(t,"O",(function(){return V})),r.d(t,"p",(function(){return H})),r.d(t,"g",(function(){return W})),r.d(t,"W",(function(){return z})),r.d(t,"k",(function(){return K})),r.d(t,"l",(function(){return Y})),r.d(t,"G",(function(){return J})),r.d(t,"v",(function(){return Q})),r.d(t,"K",(function(){return X})),r.d(t,"e",(function(){return $})),r.d(t,"X",(function(){return ee})),r.d(t,"I",(function(){return te})),r.d(t,"o",(function(){return re})),r.d(t,"N",(function(){return ne})),r.d(t,"L",(function(){return ae})),r.d(t,"n",(function(){return ie})),r.d(t,"r",(function(){return oe})),r.d(t,"H",(function(){return ce})),r.d(t,"u",(function(){return ue})),r.d(t,"J",(function(){return se})),r.d(t,"A",(function(){return le})),r.d(t,"t",(function(){return de})),r.d(t,"P",(function(){return fe})),r.d(t,"h",(function(){return be})),r.d(t,"M",(function(){return he})),r.d(t,"f",(function(){return ve}));var n,a,i,o,c=r(1),u=r(2),s=r(7),l=r(8),d=r(23),f=r(33),b=r(60),h=f.a,v=f.t,p=f.v,m=f.z,g=f.D;function O(e){return e.kind===o.BadNumber}function j(e){return e.kind===o.BadNumber||e.kind===l.b.Number}!function(e){e[e.End=1]="End",e[e.Left=2]="Left",e[e.Right=3]="Right",e[e.Sep=4]="Sep",e[e.Operator=5]="Operator",e[e.Spaces=6]="Spaces",e[e.Ident=7]="Ident",e[e.CellRef=8]="CellRef",e[e.Literal=9]="Literal",e[e.SpecialRef=10]="SpecialRef",e[e.Unexpected=11]="Unexpected",e[e.Escape=12]="Escape"}(n||(n={})),function(e){e[e.Paren=1]="Paren",e[e.Bracket=2]="Bracket",e[e.Brace=3]="Brace",e[e.SQuote=4]="SQuote"}(a||(a={})),function(e){e[e.List=1]="List",e[e.Row=2]="Row",e[e.Col=3]="Col",e[e.Qual=4]="Qual",e[e.Dot=5]="Dot",e[e.Assign=6]="Assign"}(i||(i={})),function(e){e.BadNumber="BadNumber",e.BadError="BadError"}(o||(o={}));var y={kind:o.BadNumber};function S(e){return e.kind===o.BadError}var C={kind:o.BadError};function k(e,t,r,n){return{kind:e,start:t,chars:r,isIdentContinue:n}}var E=function(e){return k(n.End,e,"",!1)},A=function(e,t){return k(n.Spaces,e,t,!1)},N=function(e,t){return k(n.Unexpected,e,t,!1)},T=function(e,t){return k(n.Escape,e,t,!1)},R=function(e,t){return k(n.Ident,e,t,!0)};function I(e,t,r,n){return{kind:e,start:t,chars:r,isIdentContinue:!1,value:n}}var _=function(e){return I(n.Left,e,"(",a.Paren)},F=function(e,t){return I(n.Left,e,t,a.Bracket)},w=function(e,t){return I(n.Left,e,t,a.Brace)},M=function(e){return I(n.Left,e,"'",a.SQuote)},D=function(e){return I(n.Right,e,")",a.Paren)},P=function(e,t){return I(n.Right,e,t,a.Bracket)},x=function(e,t){return I(n.Right,e,t,a.Brace)},L=function(e){return I(n.Right,e,"'",a.SQuote)},B=function(e,t){return I(n.Sep,e,t,i.List)},U=function(e,t){return I(n.Sep,e,t,i.Col)},G=function(e,t){return I(n.Sep,e,t,i.Row)},V=function(e){return I(n.Sep,e,"!",i.Qual)},H=function(e){return I(n.Sep,e,".",i.Dot)},W=function(e){return I(n.Sep,e,":=",i.Assign)},z=function(e,t,r){return I(n.SpecialRef,e,t,r)};function q(e,t,r,a,i,o,c){return{kind:n.CellRef,start:e,chars:t,isIdentContinue:r,row:a,col:i,refStyle:o,isBadLocale:c}}function K(e,t,r,n){return q(e,t,(null==r||"object"==typeof r&&r.kind===u.f.Rel)&&(null==n||"object"==typeof n&&n.kind===u.f.Rel),r,n,u.h.A1,!1)}function Y(e,t,r,n,a){return void 0===a&&(a=!1),q(e,t,!(r!==b.a.RCNoNum&&null!=r&&r.kind!==u.f.Abs||n!==b.a.RCNoNum&&null!=n&&n.kind!==u.f.Abs),r,n,u.h.R1C1,a)}function J(e,t,r,a){void 0===a&&(a=!0);var i=r.kind===l.b.Boolean||j(r)&&function(e){for(var t=0,r=Object(d.b)(e);t<r.length;t++){var n=r[t];if(n===p||n===v||n===h||n===g||n===m)return!1}return!0}(t);return{kind:n.Literal,start:e,chars:t,isIdentContinue:i,oper:r,hasRight:a}}function Q(e,t,r){return 0===e.stringCompareCI(e.falseName,r)?J(t,r,s.i):0===e.stringCompareCI(e.trueName,r)?J(t,r,s.v):R(t,r)}function X(e,t,r){return{kind:n.Operator,start:e,chars:t,isIdentContinue:!1,value:r}}function Z(e){var t=c.g[e];if(null==t)throw new Error("operatorTokenMaker: invalid operator ".concat(e));return function(r){return X(r,t,e)}}var $=Z(c.a.Add),ee=Z(c.a.Sub),te=Z(c.a.Mul),re=Z(c.a.Div),ne=Z(c.a.Pow),ae=Z(c.a.Percent),ie=Z(c.a.Concat),oe=Z(c.a.Eq),ce=Z(c.a.Lt),ue=Z(c.a.Gt),se=Z(c.a.Ne),le=Z(c.a.Le),de=Z(c.a.Ge),fe=Z(c.a.Range),be=Z(c.a.At),he=Z(c.a.Pound);function ve(e,t,r){return r.push(t),t.start+e}},function(e,t,r){"use strict";r.d(t,"l",(function(){return u})),r.d(t,"h",(function(){return s})),r.d(t,"m",(function(){return l})),r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a})),r.d(t,"i",(function(){return m})),r.d(t,"e",(function(){return d})),r.d(t,"k",(function(){return O})),r.d(t,"f",(function(){return b})),r.d(t,"g",(function(){return h})),r.d(t,"c",(function(){return v})),r.d(t,"d",(function(){return p})),r.d(t,"j",(function(){return j}));var n,a,i=r(9),o=r(26),c=r(5);function u(e,t){return{sheet:e,set:t}}function s(e){return u(e.sheet,Object(o.f)(e.range))}function l(e,t){return{sheet:e,range:t}}!function(e){e.PrecisionTest="PrecisionTest",e.EditedCell="EditedCell",e.DependentCell="DependentCell",e.EvalFormula="EvalFormula",e.ParseEdit="ParseEdit"}(n||(n={})),function(e){e.EditedCell="EditedCell",e.DependentCell="DependentCell",e.IndependentCell="IndependentCell",e.UnknownNonEditedCell="UnknownNonEditedCell"}(a||(a={}));var d,f,b,h,v,p,m={calculatedCellCount:{},changedCellCount:{},continueCount:0,editFinishedCount:0,stateTimedOut:!1,recalcFinishedCount:0};function g(e,t){var r,n;return Object(i.__assign)(Object(i.__assign)({},e),((r={})[t]=(null!==(n=e[t])&&void 0!==n?n:0)+1,r))}function O(e,t){switch(t.message){case d.ChangedCell:return Object(i.__assign)(Object(i.__assign)({},e),{changedCellCount:g(e.changedCellCount,t.cellKind),calculatedCellCount:g(e.calculatedCellCount,t.cellKind)});case d.UnchangedCell:return Object(i.__assign)(Object(i.__assign)({},e),{calculatedCellCount:g(e.calculatedCellCount,t.cellKind)});case d.ContinueComputation:return Object(i.__assign)(Object(i.__assign)({},e),{continueCount:e.continueCount+1});case d.StateTimedOut:return Object(i.__assign)(Object(i.__assign)({},e),{stateTimedOut:!0});case d.EditFinished:return Object(i.__assign)(Object(i.__assign)({},e),{editFinishedCount:e.editFinishedCount+1});case d.RecalcFinished:return Object(i.__assign)(Object(i.__assign)({},e),{recalcFinishedCount:e.recalcFinishedCount+1});default:return Object(c.e)("calc.calc.partialWorkbookMessages.mergeRecalcStatistics",t)}}function j(e){return"object"==typeof e}!function(e){e.ChangedCell="ChangedCell",e.UnchangedCell="UnchangedCell",e.ContinueComputation="ContinueComputation",e.EditFinished="EditFinished",e.StateTimedOut="StateTimedOut",e.RecalcFinished="RecalcFinished"}(d||(d={})),function(e){e.SetSheetNames="SetSheetNames",e.SetRefStyle="SetRefStyle",e.SetLocaleInfo="SetLocaleInfo",e.SetNumberFormats="SetNumberFormats",e.WriteNamedObject="WriteNamedObject",e.WriteUndefinedNames="WriteUndefinedNames",e.PromoteNamedObjects="PromoteNamedObjects",e.ExtendUnusedRange="ExtendUnusedRange",e.WriteHiddenRows="WriteHiddenRows",e.WriteInFilterMode="WriteInFilterMode",e.SetCellContents="SetCellContents",e.SetRangeFormula="SetRangeFormula",e.PromoteCellContents="PromoteCellContents"}(f||(f={})),function(e){e.Unavailable="Unavailable",e.Weak="Weak",e.ClientValueUnknown="ClientValueUnknown",e.Origin="Origin",e.Inferred="Inferred"}(b||(b={})),function(e){e.Unavailable="Unavailable",e.Weak="Weak",e.Blank="Blank"}(h||(h={})),function(e){e.EvalFormula="eval-formula",e.ServerCellFormula="server-cell-formula",e.EditCellFormula="edit-cell-formula",e.ServerNamedFormula="server-named-formula",e.EditNamedFormula="edit-named-formula"}(v||(v={})),function(e){e.StateAdvanced="StateAdvanced",e.CellWrite="CellWrite",e.RangeWrite="RangeWrite",e.NameFailure="NameFailure",e.RangeFailure="RangeFailure",e.NumberFormatFailure="NumberFormatFailure",e.PrintFormulaFailure="PrintFormulaFailure",e.InferFormatFailure="InferFormatFailure",e.FormatValueFailure="FormatValueFailure",e.UnhandledFailure="UnhandledFailure",e.UpdateRequest="UpdateRequest",e.UpdateNamesRequest="UpdateNamesRequest",e.GarbageCollected="GarbageCollected",e.RecalcStatistics="RecalcStatistics",e.WorkbookStatistics="WorkbookStatistics",e.ExperimentRunResult="ExperimentRunResult"}(p||(p={}))},function(e,t,r){"use strict";r.d(t,"b",(function(){return d})),r.d(t,"d",(function(){return f})),r.d(t,"e",(function(){return b})),r.d(t,"f",(function(){return h})),r.d(t,"c",(function(){return v})),r.d(t,"g",(function(){return p})),r.d(t,"a",(function(){return m})),r.d(t,"D",(function(){return g})),r.d(t,"k",(function(){return O})),r.d(t,"v",(function(){return C})),r.d(t,"C",(function(){return k})),r.d(t,"l",(function(){return E})),r.d(t,"w",(function(){return A})),r.d(t,"m",(function(){return N})),r.d(t,"h",(function(){return T})),r.d(t,"t",(function(){return R})),r.d(t,"A",(function(){return I})),r.d(t,"r",(function(){return _})),r.d(t,"y",(function(){return F})),r.d(t,"u",(function(){return w})),r.d(t,"B",(function(){return M})),r.d(t,"s",(function(){return D})),r.d(t,"z",(function(){return P})),r.d(t,"n",(function(){return x})),r.d(t,"x",(function(){return L})),r.d(t,"i",(function(){return B})),r.d(t,"p",(function(){return U})),r.d(t,"o",(function(){return G})),r.d(t,"q",(function(){return V})),r.d(t,"j",(function(){return z}));var n=r(25),a=r(35),i=r(5),o=r(7),c=r(1),u=r(15),s=r(13),l=r(8);function d(e){return e.kind===u.c.Sep&&e.value===u.b.Dot}function f(e){return e.kind===u.c.Sep&&e.value===u.b.List}function b(e){return e.kind===u.c.Operator&&e.value===c.a.Range}function h(e){return e.kind===u.c.Literal&&e.oper.kind===l.b.Error&&e.oper.type===o.a.REF}function v(e){return e.kind===u.c.Left&&e.value===u.a.Bracket}function p(e){return e.kind===u.c.Right&&e.value===u.a.Bracket}function m(e){return(e.kind===u.c.Left||e.kind===u.c.Right)&&e.value===u.a.Bracket}var g=Object(s.m)(Object(s.s)((function(e,t){return t.kind===u.c.Spaces?t.chars:void 0})),""),O=function(e,t,r,o,c){var u=e[t];if(null==u){var s="calc.parse.pStart: internal error: expected token at ".concat(t," in ").concat(Object(a.a)(e));return i.i.ULS.assertTag(589825166,n.LogCategory.msoulscat_ES_EWAJS,!1,s)}return o(u.start,t)};function j(e){return Object(s.s)((function(t,r){return r.kind===u.c.Sep&&r.value===e?r:void 0}))}function y(e){return Object(s.s)((function(t,r){return r.kind===u.c.Left&&r.value===e?r:void 0}))}function S(e){return Object(s.s)((function(t,r){return r.kind===u.c.Right&&r.value===e?r:void 0}))}var C=j(u.b.List),k=j(u.b.Row),E=j(u.b.Col),A=j(u.b.Qual),N=j(u.b.Dot),T=j(u.b.Assign),R=y(u.a.Paren),I=S(u.a.Paren),_=y(u.a.Brace),F=S(u.a.Brace),w=y(u.a.SQuote),M=S(u.a.SQuote),D=y(u.a.Bracket),P=S(u.a.Bracket),x=Object(s.t)((function(e,t,r){return d(t)&&!v(r)?t:void 0})),L=Object(s.s)((function(e,t){return b(t)?t:void 0})),B=Object(s.s)((function(e,t){return function(e){return e.kind===u.c.Operator&&e.value===c.a.At}(t)?t:void 0})),U=Object(s.s)((function(e,t){return t.kind===u.c.Escape?t:void 0})),G=Object(s.s)((function(e,t){return t.kind===u.c.End?t:void 0})),V=Object(s.b)(Object(s.l)(Object(s.s)((function(e,t){return t.isIdentContinue?t:void 0}))),(function(e,t){var r=t[0];return 1===t.length?r:Object(u.w)(r.start,t.map((function(e){return e.chars})).join(""))})),H=Object(s.s)((function(e,t){return m(t)||t.kind===u.c.End?void 0:t})),W=Object(s.i)((function(){return Object(s.h)(Object(s.k)(Object(s.a)(Object(s.l)(H),Object(s.e)(Object(s.u)(D),W,Object(s.m)(Object(s.u)(P),[])))))})),z=Object(s.b)(Object(s.u)(D,W,O,Object(s.m)(P,void 0)),(function(e,t){t[0];var r=t[1],n=t[2],a=t[3];return r.push(Object(u.q)(n)),[r,void 0!==a]}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return o})),r.d(t,"d",(function(){return c})),r.d(t,"e",(function(){return u})),r.d(t,"f",(function(){return s})),r.d(t,"g",(function(){return l})),r.d(t,"h",(function(){return d}));var n=r(20),a=n.util.arrayFill,i=n.util.isInteger,o=(n.util.mathLog2,n.util.messageFromError),c=n.util.partialArray,u=n.util.prependErrorMessage,s=n.util.repeat,l=n.util.stringEndsWith,d=n.util.stringStartsWith;n.util.values},function(e,t,r){"use strict";r.d(t,"k",(function(){return s})),r.d(t,"d",(function(){return n})),r.d(t,"j",(function(){return l})),r.d(t,"b",(function(){return a})),r.d(t,"h",(function(){return d})),r.d(t,"a",(function(){return i})),r.d(t,"g",(function(){return f})),r.d(t,"c",(function(){return o})),r.d(t,"i",(function(){return b})),r.d(t,"f",(function(){return v})),r.d(t,"e",(function(){return h})),r.d(t,"o",(function(){return p})),r.d(t,"l",(function(){return m})),r.d(t,"r",(function(){return g})),r.d(t,"n",(function(){return O})),r.d(t,"q",(function(){return j})),r.d(t,"p",(function(){return y})),r.d(t,"m",(function(){return S}));var n,a,i,o,c=r(0),u=r(10);function s(e){return{originGridCell:Object(c.f)(e.range),originSheet:Object(c.f)(e.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1}}function l(e){return{kind:n.NoOriginSheet,origin:e}}function d(e){return{kind:n.InvalidQualifier,reason:e}}function f(e){return{kind:n.InvalidCellRef,reason:e}}function b(e){return{kind:n.InvalidStructRef,reason:e}}!function(e){e.NoOriginSheet="NoOriginSheet",e.InvalidQualifier="InvalidQualifier",e.InvalidCellRef="InvalidCellRef",e.InvalidStructRef="InvalidStructRef",e.EmptyIntersection="EmptyIntersection"}(n||(n={})),function(e){e.UndefinedDocument="UndefinedDocument",e.UndefinedSheetName="UndefinedSheetName",e.SheetRangeName="SheetRangeName",e.DocumentCellRef="DocumentCellRef",e.BadQualifier="BadQualifier"}(a||(a={})),function(e){e.BadCellRef="BadCellRef"}(i||(i={})),function(e){e.UndefinedColumnName="UndefinedColumnName",e.UndefinedTableName="UndefinedTableName",e.InvalidOriginSheet="InvalidOriginSheet",e.InvalidOp="InvalidOp",e.MissingTableName="MissingTableName",e.NamedObjectNotTable="NamedObjectNotTable"}(o||(o={}));var h,v={kind:n.EmptyIntersection};!function(e){e.ResolvedName="ResolvedName",e.ResolvedCellRef="ResolvedCellRef",e.ResolvedUserDefinedFunc="ResolvedUserDefinedFunc",e.ResolvedLocalName="ResolvedLocalName",e.ResolvedStructRef="ResolvedStructRef",e.ResolvedNever="ResolvedNever",e.ResolvedDottedName="ResolvedDottedName"}(h||(h={}));var p=Object(u.w)()((function(e,t){return{kind:h.ResolvedName,node:e,resolution:t}})),m=Object(u.w)()((function(e,t){return{kind:h.ResolvedCellRef,node:e,resolution:t}})),g=Object(u.w)()((function(e,t,r){return{kind:h.ResolvedUserDefinedFunc,node:e,resolution:t,name:r}})),O=Object(u.w)()((function(e,t){return{kind:h.ResolvedLocalName,node:e,resolution:t}})),j=Object(u.w)()((function(e,t,r){return{kind:h.ResolvedStructRef,node:e,table:t,resolution:r}})),y=Object(u.w)()((function(e){return{kind:h.ResolvedNever,node:e,resolution:c.g}})),S=Object(u.w)()((function(e,t){return{kind:h.ResolvedDottedName,resolved:e,fields:t}}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.utils=t.table=t.split=t.rTree=t.ringBuffer=t.rbTree=t.rbMapTree=t.productSet=t.priorityQueue=t.interval=t.histogram=t.hashTable=t.hashSet=t.dictionary=t.deque=t.bspSet=t.binaryHeap=t.arrayMapTree=t.testUtil=t.core=t.featureConfiguration=t.assertions=t.util=t.anonymizer=t.findIsomorphicSubtrees=t.JSF32=t.fnv1a=t.PackageName=void 0,t.PackageName="excel-online-calc-common";var n=r(151);Object.defineProperty(t,"fnv1a",{enumerable:!0,get:function(){return n.fnv1a}});var a=r(131);Object.defineProperty(t,"JSF32",{enumerable:!0,get:function(){return a.JSF32}});var i=r(152);Object.defineProperty(t,"findIsomorphicSubtrees",{enumerable:!0,get:function(){return i.findIsomorphicSubtrees}});var o=r(124);t.anonymizer=o;var c=r(133);t.util=c;var u=r(103);t.assertions=u;var s=r(125);t.featureConfiguration=s;var l=r(95);t.core=l;var d=r(171);t.testUtil=d;var f=r(172);t.arrayMapTree=f;var b=r(135);t.binaryHeap=b;var h=r(136);t.bspSet=h;var v=r(173);t.deque=v;var p=r(174);t.dictionary=p;var m=r(175);t.hashSet=m;var g=r(176);t.hashTable=g;var O=r(177);t.histogram=O;var j=r(137);t.interval=j;var y=r(178);t.priorityQueue=y;var S=r(179);t.productSet=S;var C=r(180);t.rbMapTree=C;var k=r(138);t.rbTree=k;var E=r(181);t.ringBuffer=E;var A=r(182);t.rTree=A;var N=r(183);t.split=N;var T=r(104);t.table=T;var R=r(128);t.utils=R},function(e,t,r){"use strict";r.d(t,"k",(function(){return l})),r.d(t,"l",(function(){return d})),r.d(t,"a",(function(){return f})),r.d(t,"b",(function(){return b})),r.d(t,"g",(function(){return h})),r.d(t,"h",(function(){return v})),r.d(t,"f",(function(){return p})),r.d(t,"c",(function(){return m})),r.d(t,"d",(function(){return g})),r.d(t,"e",(function(){return O})),r.d(t,"j",(function(){return j})),r.d(t,"i",(function(){return y}));var n=r(7),a=r(44),i=r(5),o=r(3),c=r(49),u=r(8),s=r(0);function l(e){return function(t,r){return e(t)(r[0])}}function d(e){return function(t,r){return e(t)(r[0],r[1])}}var f=function(e){return Object(o.M)(e)?e:Object(i.a)("calc.funcs.assertNumber")},b=function(e){return Object(o.ab)(e)?e:Object(i.a)("calc.funcs.assertString")},h=Object(n.u)("");function v(e){return Object(o.ab)(e)&&""===e.value}function p(e,t){var r=Object(a.e)(e,t,!1),c=Object(o.T)(r)?r.getFallback():r;switch(c.kind){case u.b.Number:return c;case u.b.Boolean:return n.w;case u.b.String:var s=e.coerceOper(c,u.b.Number);return Object(o.M)(s)?s:n.w;case u.b.Error:return c;case u.b.Array:return n.w;case u.b.Missing:return n.m;case u.b.Blank:return e.mathpack.zero;default:return Object(i.e)("calc.funcs.chkNumOper",c)}}var m=1462;function g(e,t){var r=p(e,t);if(Object(o.E)(r))return r;var a=e.mathpack;return a.cond(r)<0?n.p:j(e,r=a.floor(r))?(e.config.date1904&&!Object(o.ab)(t)&&(r=a.add(a.fromNumber(m),r)),r):n.p}function O(e,t){switch(t.kind){case u.b.Number:return Object(s.f)(new c.c(1,1,1,1,[[t]],n.d));case u.b.String:var r=e.coerceOper(t,u.b.Number);return Object(o.E)(r)?Object(s.c)(n.w):Object(s.f)(new c.c(1,1,1,1,[[r]],n.d));case u.b.Blank:return Object(s.f)(new c.c(1,1,1,1,[[e.mathpack.zero]],n.d));case u.b.Missing:return Object(s.c)(n.m);case u.b.Error:return Object(s.c)(t);case u.b.Range:return O(e,Object(a.e)(e,t,!1));case u.b.Array:return Object(s.f)(new c.c(t.rows,t.cols,t.rows,t.cols,t.opers,n.d));default:return Object(s.c)(n.w)}}function j(e,t){var r,n,a=e.mathpack.lfix(t);return e.config.date1904?(r=0,n=2957003):(r=0,n=2958465),a>=r&&a<=n}function y(e,t,r){var n=e.div(t,r);if(Object(o.E)(n))return n;var a=e.mul(e.trunc(n),r);if(Object(o.E)(a))return a;var i=e.sub(t,a);return!Object(o.E)(i)&&e.cond(t)<0?e.abs(i):i}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(76),a=r(0),i=function(){function e(t,r,a){this.transition=t,this.onFulfilled=r,this.onRejected=a,this.runStatus=!(t instanceof e||t.kind===n.d.CallMachine)&&t}return e.prototype.setState=function(e,t,r){return this.onFulfilled=t,this.onRejected=r,this.transition=e,e},e.prototype.next=function(){return this.transition instanceof e?this.transition=Object(n.e)(this.transition,this):this.transition},e.prototype.receiveResult=function(t){var r;try{if(Object(a.d)(t)){if(!this.onFulfilled)return this.setState(t,void 0,void 0);r=this.onFulfilled(t.value)}else{if(!this.onRejected)return this.setState(t,void 0,void 0);r=this.onRejected(t.reason)}}catch(e){return this.setState(Object(a.c)(Object(a.e)(e)),void 0,void 0)}return r instanceof e?(this.setState(r.transition,r.onFulfilled,r.onRejected),r.setState(this,void 0,void 0),this.next()):this.setState(Object(a.f)(r),void 0,void 0)},e.prototype.bind=function(t){return new e(this,t,void 0)},e.prototype.catch=function(t){return new e(this,void 0,t)},e.prototype.finally=function(t){return new e(this,(function(e){return t(),e}),(function(r){return t(),e.reject(r)}))},e.all=function(t){return e.fromMachine(new n.a(t.map(e.resolve)))},e.prototype.settle=function(){return new n.c(this).run()},e.settleOrThrow=function(e){var t=e.settle();if(Object(a.d)(t))return t.value;throw t.reason.error},e.resolve=function(t){return t instanceof e?t:new e(Object(a.f)(t),void 0,void 0)},e.reject=function(t){return new e(Object(a.c)(t),void 0,void 0)},e.undefined=e.resolve(void 0),e.fromMachine=function(t){if(t instanceof e)return t;var r=new e(e.undefined,void 0,void 0);return r.transition=Object(n.e)(t,r),r},e.try=function(t){return e.undefined.bind(t)},e.RepeatMachine=function(){function t(e,t){this.onLoop=e,this.accum=t,this.runStatus=!1}return t.prototype.next=function(){var t=this.onLoop(this.accum);return t instanceof e?Object(n.e)(t,this):this.receiveSuccess(t)},t.prototype.receiveResult=function(e){return Object(a.d)(e)?this.receiveSuccess(e.value):e},t.prototype.receiveSuccess=function(e){return void 0===e?Object(a.f)(this.accum):(this.accum=e,n.g)},t}(),e.repeat=function(t,r){return e.resolve(r).bind((function(r){return e.fromMachine(new e.RepeatMachine(t,r))}))},e}()},function(e,t,r){"use strict";r.d(t,"d",(function(){return c})),r.d(t,"k",(function(){return u})),r.d(t,"j",(function(){return s})),r.d(t,"g",(function(){return l})),r.d(t,"h",(function(){return d})),r.d(t,"c",(function(){return f})),r.d(t,"i",(function(){return b})),r.d(t,"f",(function(){return h})),r.d(t,"b",(function(){return v})),r.d(t,"a",(function(){return n})),r.d(t,"e",(function(){return m}));var n,a=r(10);function i(e){return 55296==(64512&e)}function o(e){return 56320==(64512&e)}function c(e){return 55296==(63488&e)}function u(e,t){if(i(e)&&o(t))return 65536+((1023&e)<<10|1023&t)}function s(e){if(e<=65535)return String.fromCharCode(e);var t=e-65536;return String.fromCharCode(t>>10|55296,1023&t|56320)}function l(e,t,r){for(var n=t,a=0;a<r;a+=1){if(n>=e.length)return;i(e.charCodeAt(n))&&n+1<e.length&&o(e.charCodeAt(n+1))?n+=2:n+=1}return n}function d(e,t,r){for(var n=t,a=0;a<r;a+=1){if(n-1<0)return;o(e.charCodeAt(n-1))&&n-2>=0&&i(e.charCodeAt(n-2))?n-=2:n-=1}return n}function f(e,t,r){for(var n=0,a=t;a<r;n+=1){i(e.charCodeAt(a))&&a+1<r&&o(e.charCodeAt(a+1))?a+=2:a+=1}return n}function b(e,t){var r=e.charCodeAt(t);if(!c(r))return r;if(t+1>=e.length)return 65533;var n=u(r,e.charCodeAt(t+1));return null!=n?n:65533}function h(e){return e>=65536?2:1}function v(e,t){void 0===t&&(t=0);for(var r=[],n=t;n<e.length;){var a=b(e,n);r.push(a),n+=h(a)}return r}function p(e,t){if(1==(1&e.length))throw new Error("Invalid class length");for(var r=0;r<e.length;r+=2)for(var n=e[r],a=e[r+1],i=n;i<a;i+=1)t(i,n,a)}function m(e,t,r){var i;function o(e){i[e]|=n.IdentStartClass}function c(e){i[e]|=n.IdentContinueClass}function u(e,t){i[e]|=n.DigitClass,i[e]|=e-t}return function(n){if(void 0===i){var s=Object(a.b)(e[e.length-1],Object(a.b)(t[t.length-1],r[r.length-1]));i=new Uint8Array(s),p(e,o),p(t,c),p(r,u);for(var l=4969;l<4978;l+=1)u(l,4968)}var d=i[n];return void 0!==d?d:0}}!function(e){e[e.Ordinal=15]="Ordinal",e[e.DigitClass=16]="DigitClass",e[e.IdentStartClass=32]="IdentStartClass",e[e.IdentContinueClass=64]="IdentContinueClass"}(n||(n={}))},function(e,t,r){"use strict";r.d(t,"c",(function(){return a})),r.d(t,"i",(function(){return i})),r.d(t,"j",(function(){return o})),r.d(t,"g",(function(){return c})),r.d(t,"d",(function(){return u})),r.d(t,"a",(function(){return s})),r.d(t,"h",(function(){return l})),r.d(t,"b",(function(){return d})),r.d(t,"e",(function(){return f})),r.d(t,"f",(function(){return b}));var n=r(20),a=n.productSet.createFromProduct,i=n.productSet.project,o=n.productSet.unionProduct,c=n.productSet.intersectProduct,u=n.productSet.exceptProduct,s=n.productSet.compareProduct,l=n.productSet.meetsProduct,d=n.productSet.complementProduct,f=(n.productSet.symmetricDiffProduct,n.productSet.getSubspaces,n.productSet.forEachProduct),b=n.productSet.getSubspaceCount;n.productSet.ProductSetSerializer,n.productSet.productSetSerializer},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=t.initStopwatchFactory=t.ewaUtils=t.initEwaUtils=t.ConsoleLogger=t.NulLogger=t.perfWatch=t.browserSupport=t.LogCategory=t.TraceLevel=t.ULS=t.utils=t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=t.getNewGuid=void 0;var n=r(153);t.utils=n;var a=r(109);Object.defineProperty(t,"ULS",{enumerable:!0,get:function(){return a.ULS}}),Object.defineProperty(t,"TraceLevel",{enumerable:!0,get:function(){return a.TraceLevel}}),Object.defineProperty(t,"LogCategory",{enumerable:!0,get:function(){return a.LogCategory}}),Object.defineProperty(t,"NulLogger",{enumerable:!0,get:function(){return a.NulLogger}}),Object.defineProperty(t,"ConsoleLogger",{enumerable:!0,get:function(){return a.ConsoleLogger}});var i=r(154);t.browserSupport=i;var o=r(155);t.perfWatch=o;var c=r(156);Object.defineProperty(t,"initEwaUtils",{enumerable:!0,get:function(){return c.initEwaUtils}}),Object.defineProperty(t,"ewaUtils",{enumerable:!0,get:function(){return c.ewaUtils}});var u=r(160);Object.defineProperty(t,"initStopwatchFactory",{enumerable:!0,get:function(){return u.initStopwatchFactory}});var s=r(161);Object.defineProperty(t,"TelemetryCollector",{enumerable:!0,get:function(){return s.TelemetryCollector}});var l=r(162);Object.defineProperty(t,"getNewGuid",{enumerable:!0,get:function(){return l.getNewGuid}});var d=r(163);Object.defineProperty(t,"TextAreaVirtualKeyboardPolicy",{enumerable:!0,get:function(){return d.TextAreaVirtualKeyboardPolicy}}),Object.defineProperty(t,"TextAreaInputMode",{enumerable:!0,get:function(){return d.TextAreaInputMode}})},function(e,t,r){"use strict";var n,a=r(12),i=r(3),o=r(93),c=r(32),u=r(20),s=(u.split.boundedPareto,u.split.boundedParetoSplitter,u.split.boundedParetoSetOperations),l=r(24);r.d(t,"d",(function(){return v})),r.d(t,"f",(function(){return p})),r.d(t,"e",(function(){return m})),r.d(t,"c",(function(){return g})),r.d(t,"b",(function(){return O})),r.d(t,"a",(function(){return j})),r.d(t,"j",(function(){return y})),r.d(t,"h",(function(){return S})),r.d(t,"i",(function(){return C})),r.d(t,"g",(function(){return k})),r.d(t,"k",(function(){return E})),function(e){e[e.AvailableSet=0]="AvailableSet",e[e.AvailableRead=1]="AvailableRead"}(n||(n={}));var d=[n.AvailableSet,n.AvailableRead+1],f=[0,a.v],b=[0,a.o],h={availability:s(1,d[0]+1,d[1],d,"Availability operations, alpha = 1"),row:s(.2,f[0]+1,f[1],f,"Row operations, alpha = 0.2"),col:s(.35,b[0]+1,b[1],b,"Col operations, alpha = 0.35")},v={availability:Object(c.b)(h.availability),row:Object(c.b)(h.row),col:Object(c.b)(h.col)};function p(e){return Object(l.c)({row:v.row([e.row,e.row+e.rows]),col:v.col([e.col,e.col+e.cols])})}function m(e){if(e!==c.d){var t,r,n=e===c.c?void 0:e.root.bounds.row,i=e===c.c?void 0:e.root.bounds.col,u=void 0===n?h.row.top:(t=Object(c.g)(h.row,n),r=[],y(t,(function(e){return r.push(e),!0})),r.reduce(o.c)),s=u[0],l=u[1],d=void 0===i?h.col.top:function(e){var t=[];return S(e,(function(e){return t.push(e),!0})),t.reduce(o.c)}(Object(c.g)(h.col,i)),f=d[0],b=d[1];return Object(a.g)(s,f,l-s,b-f)}}var g=Object(l.c)({availability:v.availability([n.AvailableSet,n.AvailableSet+1])}),O=Object(l.c)({availability:v.availability([n.AvailableRead,n.AvailableRead+1])}),j=Object(l.c)({availability:v.availability([n.AvailableSet,n.AvailableRead+1])});function y(e,t){return e!==c.c?Object(c.f)(e,t):t(h.row.top)}function S(e,t){return e!==c.c?Object(c.f)(e,t):t(h.col.top)}function C(e,t){return Object(l.e)(e,(function(e){return y(e.row,(function(r){var n=r[0],i=r[1];return S(e.col,(function(e){var r=e[0],o=e[1];return t(Object(a.g)(n,r,i-n,o-r))}))}))}),"row","col")}function k(e,t){return C(e,(function(e){return Object(i.d)(e,t)}))}function E(e,t,r){var n=c.d;return Object(l.e)(e,(function(e){var a=c.d;y(e.row,(function(e){var r=e[0],n=e[1];return a=Object(c.j)(a,v.row([r+t,n+t])),!0}));var i=c.d;S(e.col,(function(e){var t=e[0],n=e[1];return i=Object(c.j)(i,v.col([t+r,n+r])),!0}));var o=Object(l.c)({row:a,col:i,availability:e.availability});return n=Object(l.j)(n,o),!0}),"row","col","availability"),n}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"e",(function(){return u})),r.d(t,"d",(function(){return s})),r.d(t,"b",(function(){return l})),r.d(t,"f",(function(){return f})),r.d(t,"c",(function(){return b}));var n,a=r(25),i=r(35),o=r(5),c=r(2);function u(e,t,r,a,i){return{localeInfo:e,mathpack:t,refStyle:r,lexicalKind:a,origin:i,delim:{delimId:void 0,listSep:n.Union},cellRefMustBeCellRefNode:!1,label:1,spans:[]}}function s(e,t){var r=e.spans[t.label];if(null==r){var n="calc.parse.getNodeSpan: internal error: expected node to have a span; given ".concat(Object(i.a)(t));return o.i.ULS.assertTag(595980824,a.LogCategory.msoulscat_ES_EWAJS,!1,n)}return r}function l(e,t,r,n,a){var i=e.label;return e.label+=1,e.spans[i]=Object(c.K)(t,r,n,a),i}function d(e,t,r){return function(n,a,i,o,c){var u=e(i);return r(n,a,i,(function(e,r){return t(i,u),o(e,r)}),(function(){return t(i,u),c}))}}function f(e,t){return d((function(t){var r=t.delim;return t.delim=e,r}),(function(e,t){return e.delim=t}),t)}function b(e){return d((function(e){var t=e.cellRefMustBeCellRefNode;return e.cellRefMustBeCellRefNode=!0,t}),(function(e,t){return e.cellRefMustBeCellRefNode=t}),e)}!function(e){e[e.Union=1]="Union",e[e.Arg=2]="Arg"}(n||(n={}))},function(e,t,r){"use strict";r.d(t,"d",(function(){return f})),r.d(t,"j",(function(){return b})),r.d(t,"h",(function(){return h})),r.d(t,"i",(function(){return v})),r.d(t,"p",(function(){return O})),r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return m})),r.d(t,"c",(function(){return g})),r.d(t,"o",(function(){return j})),r.d(t,"m",(function(){return y})),r.d(t,"t",(function(){return S})),r.d(t,"g",(function(){return C})),r.d(t,"f",(function(){return k})),r.d(t,"w",(function(){return E})),r.d(t,"x",(function(){return A})),r.d(t,"k",(function(){return N})),r.d(t,"l",(function(){return T})),r.d(t,"r",(function(){return R})),r.d(t,"e",(function(){return I})),r.d(t,"u",(function(){return _})),r.d(t,"v",(function(){return F})),r.d(t,"q",(function(){return w})),r.d(t,"s",(function(){return M})),r.d(t,"n",(function(){return D}));var n,a=r(9),i=r(5),o=r(10),c=r(3),u=r(12),s=r(6),l=r(0),d=r(19);!function(e){e.Timeout="Timeout",e.Stopped="Stopped",e.NameCycle="NameCycle",e.CellCycle="CellCycle",e.PreviousFailure="PreviousFailure",e.PreviousNameFailure="PreviousNameFailure",e.LimitExceeded="LimitExceeded",e.IllFormedFormula="IllFormedFormula"}(n||(n={}));var f=Object(a.__assign)(Object(a.__assign)(Object(a.__assign)(Object(a.__assign)({},c.b),n),s.g),d.d);function b(e){return{config:e}}function h(e,t,r){return{config:null!=r?r:void 0,lexicalKind:e,originGridCell:Object(l.f)(t),allowUnqualifiedCell:!0}}function v(e,t){return{config:null!=t?t:void 0,lexicalKind:u.a.NameManager,originGridCell:Object(l.f)(e),allowUnqualifiedCell:!1}}var p,m,g,O=Object(o.w)()((function(e,t){return Object(i.f)("calc.runtime.interval: end",t),Object(i.b)("calc.runtime.interval: start",e,t),{start:e,end:t}}));function j(e,t,r){return{kind:f.IllFormedFormula,message:e,mode:t,diagnostics:r}}function y(e){return{kind:p.FinalValue,oper:e}}function S(e){return{kind:p.PendingValue,anchor:e}}function C(e,t){return{source:e,formula:t}}function k(e,t){return{source:e,formula:t}}!function(e){e.FinalValue="FinalValue",e.PendingValue="PendingValue"}(p||(p={})),function(e){e[e.Continue=1]="Continue",e[e.Stop=2]="Stop"}(m||(m={})),function(e){e[e.CellChain=0]="CellChain",e[e.NameChain=1]="NameChain",e[e.LambdaCalls=2]="LambdaCalls",e[e.LambdaDepth=3]="LambdaDepth"}(g||(g={}));var E={kind:f.Stopped};function A(e,t){return{arity:e,func:t}}function N(e,t,r,n,a,i,o,u,s,d,f,b,h,v,p,g,O,j,y,S,C,k,E,A,N,T,R,I,_,F){return{config:e,getDocumentLoc:t,getSheetIndex:r,getSheetName:n,getSheetRangeIndexes:a,getNameLoc:i,getUserDefinedFuncLoc:o,getCellValue:u,getCellValues:s,getWorksheetFunc:d,getUserDefinedFunc:f,getNameFormula:b,getCellFormula:h,getUsedRange:v,interruptToken:[m.Continue],tryGetHiddenRows:p,tryGetHiddenCols:g,isInFilterMode:O,getKnownFormat:j,getIformat:y,getFormatString:S,getRandom:C,getTime:k,schedulerConfig:null!=_?_:{},limits:null!=F?F:{},setCellValue:E,setCellValues:A,setCellFailure:N,getContainingTable:T,getStructRefColumn:R,getStructRefSpecialRef:I,getIntersectingTables:function(){return Object(l.c)(Object(c.hb)(["getIntersectingTables"]))}}}var T=Object(o.w)()((function(e,t,r,n,a,i,o,c,u,s){return{lexicalSource:e,originGridCell:t,originSheet:r,calcingArray:n,reflectionGridCell:a,reflectionSheet:i,implicitIntersect:o,allowUnqualifiedCell:c,wrapCellReferences:u,followHyperlinks:s}}));function R(e){return{kind:f.NameCycle,names:e}}function I(e){return{kind:f.CellCycle,cells:e}}function _(e){return{kind:f.PreviousFailure,range:e}}function F(e){return{kind:f.PreviousNameFailure,name:e}}function w(e){return{kind:f.LimitExceeded,limit:e}}function M(e){return{kind:l.b.Paused,reason:f.Timeout,resume:e}}function D(e){if(e.kind===l.b.Failure)return e.reason.kind}},function(e,t,r){"use strict";r.d(t,"r",(function(){return u})),r.d(t,"s",(function(){return s})),r.d(t,"u",(function(){return l})),r.d(t,"p",(function(){return d})),r.d(t,"t",(function(){return f})),r.d(t,"q",(function(){return b})),r.d(t,"e",(function(){return v})),r.d(t,"l",(function(){return p})),r.d(t,"c",(function(){return m})),r.d(t,"j",(function(){return g})),r.d(t,"v",(function(){return O})),r.d(t,"d",(function(){return j})),r.d(t,"a",(function(){return y})),r.d(t,"h",(function(){return S})),r.d(t,"b",(function(){return C})),r.d(t,"i",(function(){return k})),r.d(t,"g",(function(){return E})),r.d(t,"f",(function(){return D})),r.d(t,"m",(function(){return x})),r.d(t,"o",(function(){return L})),r.d(t,"n",(function(){return B})),r.d(t,"k",(function(){return U}));var n=r(9),a=r(5),i=r(10),o=r(22),c=r(2);function u(e,t){switch(t.kind){case c.e.Literal:var r=t.oper,n=t.isClosed,i=t.label;return e.literalNode(r,n,i);case c.e.Array:var o=t.nodes;n=t.isClosed,i=t.label;return e.arrayNode(o,n,i);case c.e.App:var u=t.head,s=t.args;n=t.isClosed,i=t.label;return e.appNode(u,s,n,i);case c.e.Let:u=t.head;var l=t.vars,d=t.body,f=t.badArgs;n=t.isClosed,i=t.label;return e.letNode(u,l,d,f,n,i);case c.e.Lambda:u=t.head;var b=t.params;d=t.body,f=t.badArgs,n=t.isClosed,i=t.label;return e.lambdaNode(u,b,d,f,n,i);case c.e.Paren:var h=t.node;n=t.isClosed,i=t.label;return e.parenNode(h,n,i);case c.e.Name:var v=t.parts,p=t.qualifier;i=t.label;return e.nameNode(v,p,i);case c.e.CellRef:var m=t.ref;p=t.qualifier,i=t.label;return e.cellRefNode(m,p,i);case c.e.FieldRef:var g=t.lhs,O=t.rhs,j=t.shouldBeBracketed;i=t.label;return e.fieldRefNode(g,O,j,i);case c.e.StructRef:g=t.lhs,O=t.rhs,i=t.label;return e.structRefNode(g,O,i);case c.e.Bad:i=t.label;switch(t.type){case c.b.Sequence:case c.b.StructRef:case c.b.FieldRef:return e.badSequenceNode(t.type,t.contents,i);default:return e.badStringNode(t.type,t.contents,i)}default:return Object(a.e)("calc.lang.visitFormulaNode",t)}}function s(e,t){var r=t.id,n=t.label;return e.operatorNode(r,n)}function l(e,t){var r=t.id,n=t.whole,a=t.label;return e.wsfNode(r,n,a)}function d(e,t){switch(t.kind){case c.e.Operator:return s(e,t);case c.e.WSF:return l(e,t);default:return u(e,t)}}function f(e,t){switch(t.kind){case c.g.Error:var r=t.label;return e.errorQualifier(r);case c.g.Relative:r=t.label;return e.relativeQualifier(r);case c.g.Document:var n=t.document,i=t.path,o=t.isQuoted;r=t.label;return e.documentQualifier(n,i,o,r);case c.g.Sheet:var u=t.sheet,s=t.document;o=t.isQuoted,r=t.label;return e.sheetQualifier(u,s,o,r);case c.g.Ident:var l=t.name;o=t.isQuoted,r=t.label;return e.identQualifier(l,o,r);case c.g.SheetRange:var d=t.sheet1,f=t.sheet2,b=t.document;o=t.isQuoted,r=t.label;return e.sheetRangeQualifier(d,f,b,o,r);case c.g.Bad:var h=t.chars;o=t.isQuoted,r=t.label;return e.badQualifier(h,o,r);default:return Object(a.e)("calc.lang.visitQualifier",t)}}function b(e,t){switch(t.kind){case c.c.Error:var r=t.label;return e.cellRefError(r);case c.c.Single:var n=t.row,i=t.col,o=t.isBracketed;r=t.label;return e.cellRefSingle(n,i,o,r);case c.c.Range:var u=t.ref1,s=t.ref2;r=t.label;return e.cellRefRange(u,s,r);case c.c.Row:var l=t.row1,d=t.row2;o=t.isBracketed,r=t.label;return e.cellRefRow(l,d,o,r);case c.c.Col:var f=t.col1,b=t.col2;o=t.isBracketed,r=t.label;return e.cellRefCol(f,b,o,r);case c.c.Bad:var h=t.chars;o=t.isBracketed,r=t.label;return e.cellRefBad(h,o,r);default:return Object(a.e)("calc.lang.visitCellRef",t)}}function h(e){return{literalNode:e.literalNode.bind(e),arrayNode:e.arrayNode.bind(e),appNode:e.appNode.bind(e),letNode:e.letNode.bind(e),lambdaNode:e.lambdaNode.bind(e),parenNode:e.parenNode.bind(e),nameNode:e.nameNode.bind(e),cellRefNode:e.cellRefNode.bind(e),fieldRefNode:e.fieldRefNode.bind(e),structRefNode:e.structRefNode.bind(e),badSequenceNode:e.badSequenceNode.bind(e),badStringNode:e.badStringNode.bind(e),operatorNode:e.operatorNode.bind(e),wsfNode:e.wsfNode.bind(e)}}var v=function(){function e(){}return e.prototype.literalNode=function(e,t,r){return Object(c.T)(e,t,r)},e.prototype.arrayNode=function(e,t,r){return Object(c.m)(e,t,r)},e.prototype.appNode=function(e,t,r,n){return Object(c.l)(e,t,r,n)},e.prototype.letNode=function(e,t,r,n,a,i){return Object(c.R)(e,t,r,n,a,i)},e.prototype.lambdaNode=function(e,t,r,n,a,i){return Object(c.P)(e,t,r,n,a,i)},e.prototype.parenNode=function(e,t,r){return Object(c.cb)(e,t,r)},e.prototype.nameNode=function(e,t,r){return Object(c.X)(e,t,r)},e.prototype.cellRefNode=function(e,t,r){return Object(c.u)(e,t,r)},e.prototype.fieldRefNode=function(e,t,r,n){return Object(c.E)(e,t,r,n)},e.prototype.structRefNode=function(e,t,r){return Object(c.kb)(e,t,r)},e.prototype.badSequenceNode=function(e,t,r){return Object(c.n)(e,t,r)},e.prototype.badStringNode=function(e,t,r){return Object(c.n)(e,t,r)},e.prototype.operatorNode=function(e,t){return Object(c.Y)(e,t)},e.prototype.wsfNode=function(e,t,r){return Object(c.mb)(e,t,r)},e}(),p=h(new v),m=function(){function e(e){this.value=e}return e.prototype.literalNode=function(e,t,r){return this.value},e.prototype.arrayNode=function(e,t,r){return this.value},e.prototype.appNode=function(e,t,r,n){return this.value},e.prototype.letNode=function(e,t,r,n,a,i){return this.value},e.prototype.lambdaNode=function(e,t,r,n,a,i){return this.value},e.prototype.parenNode=function(e,t,r){return this.value},e.prototype.nameNode=function(e,t,r){return this.value},e.prototype.cellRefNode=function(e,t,r){return this.value},e.prototype.fieldRefNode=function(e,t,r,n){return this.value},e.prototype.structRefNode=function(e,t,r){return this.value},e.prototype.badSequenceNode=function(e,t,r){return this.value},e.prototype.badStringNode=function(e,t,r){return this.value},e.prototype.operatorNode=function(e,t){return this.value},e.prototype.wsfNode=function(e,t,r){return this.value},e}();function g(e){return h(new m(e))}var O=g(void 0),j=function(){function e(e){this.visitor=e}return e.prototype.literalNode=function(e,t,r){return this.visitor.literalNode(e,t,r)},e.prototype.arrayNode=function(e,t,r){return this.visitor.arrayNode(e,t,r)},e.prototype.appNode=function(e,t,r,n){return this.visitor.appNode(e,t,r,n)},e.prototype.letNode=function(e,t,r,n,a,i){return this.visitor.letNode(e,t,r,n,a,i)},e.prototype.lambdaNode=function(e,t,r,n,a,i){return this.visitor.lambdaNode(e,t,r,n,a,i)},e.prototype.parenNode=function(e,t,r){return this.visitor.parenNode(e,t,r)},e.prototype.nameNode=function(e,t,r){return this.visitor.nameNode(e,t,r)},e.prototype.cellRefNode=function(e,t,r){return this.visitor.cellRefNode(e,t,r)},e.prototype.fieldRefNode=function(e,t,r,n){return this.visitor.fieldRefNode(e,t,r,n)},e.prototype.structRefNode=function(e,t,r){return this.visitor.structRefNode(e,t,r)},e.prototype.badSequenceNode=function(e,t,r){return this.visitor.badSequenceNode(e,t,r)},e.prototype.badStringNode=function(e,t,r){return this.visitor.badStringNode(e,t,r)},e.prototype.operatorNode=function(e,t){return this.visitor.operatorNode(e,t)},e.prototype.wsfNode=function(e,t,r){return this.visitor.wsfNode(e,t,r)},e}(),y=function(e){function t(t,r){var n=e.call(this,t)||this;return n.reducer=function(e,t){return r(e,t)},n}return Object(n.__extends)(t,e),t.prototype.arrayNode=function(e,t,r){var n=this;return Object(a.h)("calc.lang.binaryVisitor: non-empty array",e.length>0&&e[0].length>0),e.map((function(e){return e.reduce(n.reducer)})).reduce(this.reducer)},t.prototype.appNode=function(e,t,r,n){return t.reduce(this.reducer,e)},t.prototype.letNode=function(e,t,r,a,i,o){return Object(n.__spreadArray)(Object(n.__spreadArray)(Object(n.__spreadArray)([],t.map((function(e){return e.binder.arg})),!0),void 0===r?[]:[r.arg],!0),a.map((function(e){return e.arg})),!0).reduce(this.reducer,e)},t.prototype.lambdaNode=function(e,t,r,a,o,c){return Object(n.__spreadArray)(Object(n.__spreadArray)(Object(n.__spreadArray)([],t.map((function(e){var t;return null===(t=e.name.arg.def)||void 0===t?void 0:t.rhs})).filter(i.e),!0),void 0===r?[]:[r.arg],!0),a.map((function(e){return e.arg})),!0).reduce(this.reducer,e)},t.prototype.parenNode=function(e,t,r){return e},t.prototype.fieldRefNode=function(e,t,r,n){return e},t.prototype.badSequenceNode=function(e,t,r){return Object(a.h)("calc.lang.binaryVisitor: non-empty bad-sequence",t.length>0),t.reduce(this.reducer)},t}(j);function S(e,t){return h(new y(e,t))}var C=function(){function e(e,t){this.a=e,this.b=t}return e.prototype.literalNode=function(e,t,r){return this.b(this.a.literalNode(e,t,r))},e.prototype.arrayNode=function(e,t,r){return this.b(this.a.arrayNode(e,t,r))},e.prototype.appNode=function(e,t,r,n){return this.b(this.a.appNode(e,t,r,n))},e.prototype.letNode=function(e,t,r,n,a,i){return this.b(this.a.letNode(e,t,r,n,a,i))},e.prototype.lambdaNode=function(e,t,r,n,a,i){return this.b(this.a.lambdaNode(e,t,r,n,a,i))},e.prototype.parenNode=function(e,t,r){return this.b(this.a.parenNode(e,t,r))},e.prototype.nameNode=function(e,t,r){return this.b(this.a.nameNode(e,t,r))},e.prototype.cellRefNode=function(e,t,r){return this.b(this.a.cellRefNode(e,t,r))},e.prototype.fieldRefNode=function(e,t,r,n){return this.b(this.a.fieldRefNode(e,t,r,n))},e.prototype.structRefNode=function(e,t,r){return this.b(this.a.structRefNode(e,t,r))},e.prototype.badSequenceNode=function(e,t,r){return this.b(this.a.badSequenceNode(e,t,r))},e.prototype.badStringNode=function(e,t,r){return this.b(this.a.badStringNode(e,t,r))},e.prototype.operatorNode=function(e,t){return this.b(this.a.operatorNode(e,t))},e.prototype.wsfNode=function(e,t,r){return this.b(this.a.wsfNode(e,t,r))},e}();function k(e,t){return h(new C(e,t))}k(S(g(0),i.b),(function(e){return e+1}));var E=function(){function e(e){this.visitors=e,this.keys=Object.keys(e)}return e.prototype.literalNode=function(e,t,r){for(var n={},a=0,i=this.keys;a<i.length;a++){var o=i[a];n[o]=this.visitors[o].literalNode(e,t,r)}return n},e.prototype.arrayNode=function(e,t,r){for(var n={},a=0,i=this.keys;a<i.length;a++){var o=i[a];n[o]=this.visitors[o].arrayNode(e,t,r)}return n},e.prototype.appNode=function(e,t,r,n){for(var a={},i=0,o=this.keys;i<o.length;i++){var c=o[i];a[c]=this.visitors[c].appNode(e,t,r,n)}return a},e.prototype.letNode=function(e,t,r,n,a,i){for(var o={},c=0,u=this.keys;c<u.length;c++){var s=u[c];o[s]=this.visitors[s].letNode(e,t,r,n,a,i)}return o},e.prototype.lambdaNode=function(e,t,r,n,a,i){for(var o={},c=0,u=this.keys;c<u.length;c++){var s=u[c];o[s]=this.visitors[s].lambdaNode(e,t,r,n,a,i)}return o},e.prototype.parenNode=function(e,t,r){for(var n={},a=0,i=this.keys;a<i.length;a++){var o=i[a];n[o]=this.visitors[o].parenNode(e,t,r)}return n},e.prototype.nameNode=function(e,t,r){for(var n={},a=0,i=this.keys;a<i.length;a++){var o=i[a];n[o]=this.visitors[o].nameNode(e,t,r)}return n},e.prototype.cellRefNode=function(e,t,r){for(var n={},a=0,i=this.keys;a<i.length;a++){var o=i[a];n[o]=this.visitors[o].cellRefNode(e,t,r)}return n},e.prototype.fieldRefNode=function(e,t,r,n){for(var a={},i=0,o=this.keys;i<o.length;i++){var c=o[i];a[c]=this.visitors[c].fieldRefNode(e,t,r,n)}return a},e.prototype.structRefNode=function(e,t,r){for(var n={},a=0,i=this.keys;a<i.length;a++){var o=i[a];n[o]=this.visitors[o].structRefNode(e,t,r)}return n},e.prototype.badSequenceNode=function(e,t,r){for(var n={},a=0,i=this.keys;a<i.length;a++){var o=i[a];n[o]=this.visitors[o].badSequenceNode(e,t,r)}return n},e.prototype.badStringNode=function(e,t,r){for(var n={},a=0,i=this.keys;a<i.length;a++){var o=i[a];n[o]=this.visitors[o].badStringNode(e,t,r)}return n},e.prototype.operatorNode=function(e,t){for(var r={},n=0,a=this.keys;n<a.length;n++){var i=a[n];r[i]=this.visitors[i].operatorNode(e,t)}return r},e.prototype.wsfNode=function(e,t,r){for(var n={},a=0,i=this.keys;a<i.length;a++){var o=i[a];n[o]=this.visitors[o].wsfNode(e,t,r)}return n},e}();function A(e,t){var r=function(t){switch(t.kind){case c.e.Literal:var n=t.oper,i=t.isClosed,o=t.label;return e.literalNode(n,i,o);case c.e.Array:var u=t.nodes;i=t.isClosed,o=t.label;return e.arrayNode(u.map((function(e){return e.map(r)})),i,o);case c.e.App:var d=t.head,f=t.args;i=t.isClosed,o=t.label;return e.appNode(function(t){switch(t.kind){case c.e.Operator:return s(e,t);case c.e.WSF:return l(e,t);default:return r(t)}}(d),f.map(r),i,o);case c.e.Let:d=t.head;var b=t.vars,h=t.body,v=t.badArgs;i=t.isClosed,o=t.label;return e.letNode(l(e,d),b.map((function(e){var t=e.name,n=e.binder;return Object(c.S)(t,Object(c.O)(r(n.arg),n.index))})),void 0===h?void 0:Object(c.O)(r(h.arg),h.index),v.map((function(e){return Object(c.O)(r(e.arg),e.index)})),i,o);case c.e.Lambda:d=t.head;var p=t.params;h=t.body,v=t.badArgs,i=t.isClosed,o=t.label;return e.lambdaNode(l(e,d),p.map((function(e){var t=e.name;return void 0===t.arg.def?Object(c.Q)(t):Object(c.Q)(Object(c.O)(Object(c.bb)(t.arg.name,Object(c.Z)(r(t.arg.def.rhs),t.arg.def.label),t.arg.label),t.index))})),void 0===h?void 0:Object(c.O)(r(h.arg),h.index),v.map((function(e){return Object(c.O)(r(e.arg),e.index)})),i,o);case c.e.Paren:var m=t.node;i=t.isClosed,o=t.label;return e.parenNode(r(m),i,o);case c.e.Name:var g=t.parts,O=t.qualifier;o=t.label;return e.nameNode(g,O,o);case c.e.CellRef:var j=t.ref;O=t.qualifier,o=t.label;return e.cellRefNode(j,O,o);case c.e.FieldRef:var y=t.lhs,S=t.rhs,C=t.shouldBeBracketed;o=t.label;return e.fieldRefNode(r(y),S,C,o);case c.e.StructRef:y=t.lhs,S=t.rhs,o=t.label;return e.structRefNode(y,S,o);case c.e.Bad:o=t.label;switch(t.type){case c.b.Sequence:case c.b.StructRef:case c.b.FieldRef:return e.badSequenceNode(t.type,t.contents.map(r),o);default:return e.badStringNode(t.type,t.contents,o)}default:return Object(a.e)("calc.lang.reduceBottomUp_Recursive",t)}};return r(t)}function N(e,t,r,n){var a=[],i=function(e){return a.push(e),o},o=function(){return a.length<t.length?r(e,t[a.length],i):n(a)};return o}function T(e,t,r){return N(e,t,M,r)}function R(e,t,r,n){return function(){return void 0!==t?r(e,t,n):n(void 0)}}function I(e,t,r){var n=t.id,a=t.whole,i=t.label;return function(){return r(e.wsfNode(n,a,i))}}function _(e,t,r){var n=t.name,a=t.binder;return M(e,a.arg,(function(e){return r(Object(c.S)(n,Object(c.O)(e,a.index)))}))}function F(e,t,r){var n=t.name,a=n.arg;return void 0===a.def?function(){return r(Object(c.Q)(n))}:M(e,a.def.rhs,(function(e){return r(Object(c.Q)(Object(c.O)(Object(c.bb)(a.name,Object(c.Z)(e,a.def.label),a.label),n.index)))}))}function w(e,t,r){var n=t.arg,a=t.index;return M(e,n,(function(e){return r(Object(c.O)(e,a))}))}function M(e,t,r){switch(t.kind){case c.e.Literal:var n=t.oper,i=t.isClosed,o=t.label;return function(){return r(e.literalNode(n,i,o))};case c.e.Array:var u=t.nodes,s=t.isClosed,l=t.label;return N(e,u,T,(function(t){return r(e.arrayNode(t,s,l))}));case c.e.App:var d=t.head,f=t.args,b=t.isClosed,h=t.label;return function(){return function(e,t,r){switch(t.kind){case c.e.Operator:var n=t.id,a=t.label;return function(){return r(e.operatorNode(n,a))};case c.e.WSF:return I(e,t,r);default:return M(e,t,r)}}(e,d,(function(t){return T(e,f,(function(n){return r(e.appNode(t,n,b,h))}))}))};case c.e.Let:var v=t.head,p=t.vars,m=t.body,g=t.badArgs,O=t.isClosed,j=t.label;return function(){return I(e,v,(function(t){return N(e,p,_,(function(n){return R(e,m,w,(function(a){return N(e,g,w,(function(i){return r(e.letNode(t,n,a,i,O,j))}))}))}))}))};case c.e.Lambda:var y=t.head,S=t.params,C=t.body,k=t.badArgs,E=t.isClosed,A=t.label;return function(){return I(e,y,(function(t){return function(){return N(e,S,F,(function(n){return R(e,C,w,(function(a){return N(e,k,w,(function(i){return r(e.lambdaNode(t,n,a,i,E,A))}))}))}))}}))};case c.e.Paren:var D=t.node,P=t.isClosed,x=t.label;return function(){return M(e,D,(function(t){return function(){return r(e.parenNode(t,P,x))}}))};case c.e.Name:var L=t.parts,B=t.qualifier,U=t.label;return function(){return r(e.nameNode(L,B,U))};case c.e.CellRef:var G=t.ref,V=t.qualifier,H=t.label;return function(){return r(e.cellRefNode(G,V,H))};case c.e.FieldRef:var W=t.lhs,z=t.rhs,q=t.shouldBeBracketed,K=t.label;return function(){return M(e,W,(function(t){return function(){return r(e.fieldRefNode(t,z,q,K))}}))};case c.e.StructRef:var Y=t.lhs,J=t.rhs,Q=t.label;return function(){return r(e.structRefNode(Y,J,Q))};case c.e.Bad:var X=t.label;switch(t.type){case c.b.Sequence:case c.b.StructRef:case c.b.FieldRef:var Z=t.type,$=t.contents;return T(e,$,(function(t){return r(e.badSequenceNode(Z,t,X))}));default:var ee=t.type,te=t.contents;return function(){return r(e.badStringNode(ee,te,X))}}default:return Object(a.e)("calc.lang.reduceBottomUp_CPS",t)}}var D=function(){function e(e){var t=this;this.visitor=e,this.visitFormulaNode=function(e){return u(t,e)},this.lazyVisitFormulaNode=function(e){return o.a.resolve(e).bind(t.visitFormulaNode)},this.visitAppHeadNode=function(e){return d(t,e)},this.lazyVisitAppHeadNode=function(e){return o.a.resolve(e).bind(t.visitAppHeadNode)},this.visitWSFNode=function(e){return l(t,e)},this.lazyVisitWSFNode=function(e){return o.a.resolve(e).bind(t.visitWSFNode)},this.lazyVisitVar=function(e){var r=e.name,n=e.binder;return t.lazyVisitFormulaNode(n.arg).bind((function(e){return Object(c.S)(r,Object(c.O)(e,n.index))}))},this.lazyVisitParam=function(e){var r=e.name,n=r.arg;return void 0===n.def?o.a.resolve(Object(c.Q)(r)):t.lazyVisitFormulaNode(n.def.rhs).bind((function(e){return Object(c.Q)(Object(c.O)(Object(c.bb)(n.name,Object(c.Z)(e,n.def.label),n.label),r.index))}))},this.lazyVisitIndexedArg=function(e){var r=e.arg,n=e.index;return t.lazyVisitFormulaNode(r).bind((function(e){return Object(c.O)(e,n)}))}}return e.prototype.literalNode=function(e,t,r){var n=this;return o.a.try((function(){return n.visitor.literalNode(e,t,r)}))},e.prototype.arrayNode=function(e,t,r){var n=this;return o.a.all(e.map((function(e){return o.a.all(e.map(n.lazyVisitFormulaNode))}))).bind((function(e){return n.visitor.arrayNode(e,t,r)}))},e.prototype.appNode=function(e,t,r,n){var a=this;return this.lazyVisitAppHeadNode(e).bind((function(e){return o.a.all(t.map(a.lazyVisitFormulaNode)).bind((function(t){return a.visitor.appNode(e,t,r,n)}))}))},e.prototype.letNode=function(e,t,r,n,a,i){var c=this;return this.lazyVisitWSFNode(e).bind((function(e){return o.a.all(t.map(c.lazyVisitVar)).bind((function(t){return(void 0===r?o.a.resolve(void 0):c.lazyVisitIndexedArg(r)).bind((function(r){return o.a.all(n.map(c.lazyVisitIndexedArg)).bind((function(n){return c.visitor.letNode(e,t,r,n,a,i)}))}))}))}))},e.prototype.lambdaNode=function(e,t,r,n,a,i){var c=this;return this.lazyVisitWSFNode(e).bind((function(e){return o.a.all(t.map(c.lazyVisitParam)).bind((function(t){return(void 0===r?o.a.resolve(void 0):c.lazyVisitIndexedArg(r)).bind((function(r){return o.a.all(n.map(c.lazyVisitIndexedArg)).bind((function(n){return c.visitor.lambdaNode(e,t,r,n,a,i)}))}))}))}))},e.prototype.parenNode=function(e,t,r){var n=this;return this.lazyVisitFormulaNode(e).bind((function(e){return n.visitor.parenNode(e,t,r)}))},e.prototype.nameNode=function(e,t,r){var n=this;return o.a.try((function(){return n.visitor.nameNode(e,t,r)}))},e.prototype.cellRefNode=function(e,t,r){var n=this;return o.a.try((function(){return n.visitor.cellRefNode(e,t,r)}))},e.prototype.fieldRefNode=function(e,t,r,n){var a=this;return this.lazyVisitFormulaNode(e).bind((function(e){return a.visitor.fieldRefNode(e,t,r,n)}))},e.prototype.structRefNode=function(e,t,r){var n=this;return o.a.try((function(){return n.visitor.structRefNode(e,t,r)}))},e.prototype.badSequenceNode=function(e,t,r){var n=this;return o.a.all(t.map(this.lazyVisitFormulaNode)).bind((function(t){return n.visitor.badSequenceNode(e,t,r)}))},e.prototype.badStringNode=function(e,t,r){var n=this;return o.a.try((function(){return n.visitor.badStringNode(e,t,r)}))},e.prototype.operatorNode=function(e,t){var r=this;return o.a.try((function(){return r.visitor.operatorNode(e,t)}))},e.prototype.wsfNode=function(e,t,r){var n=this;return o.a.try((function(){return n.visitor.wsfNode(e,t,r)}))},e}();function P(e,t,r){return r<=50?A(e,t):function(e,t){var r;return function(e){for(var t=e;null!=t;)t=t()}(M(e,t,(function(e){r=e}))),r}(e,t)}function x(e,t){return P(e,t.node,t.depthUpperBound)}function L(e,t){return o.a.settleOrThrow(o.a.resolve(u(e,t)))}function B(e,t){return L(e,t.node)}function U(e){return function e(t,r){if(r>50)return 1/0;switch(t.kind){case c.e.Array:for(var n=0,o=0,u=t.nodes;o<u.length;o++)for(var s=0,l=u[o];s<l.length;s++){var d=l[s];n=Object(i.b)(n,e(d,r+1))}return n+1;case c.e.Param:return void 0===t.def?1:e(t.def.rhs,r+1)+1;case c.e.Let:case c.e.Lambda:case c.e.App:n=e(t.head,r+1);for(var f=0,b=t.args;f<b.length;f++){var h=b[f];n=Object(i.b)(n,e(h,r+1))}return n+1;case c.e.Paren:return e(t.node,r+1)+1;case c.e.FieldRef:return e(t.lhs,r+1)+1;case c.e.Name:case c.e.CellRef:case c.e.StructRef:case c.e.Literal:case c.e.Operator:case c.e.WSF:return 1;case c.e.Bad:switch(t.type){case c.b.Sequence:case c.b.StructRef:case c.b.FieldRef:n=0;for(var v=0,p=t.contents;v<p.length;v++){var m=p[v];n=Object(i.b)(n,e(m,r+1))}return n+1;default:return"string"==typeof t.contents?1:Object(a.e)("calc.lang.getDepthUpperBound",t.contents)}default:return Object(a.e)("calc.lang.getDepthUpperBound",t)}}(e,0)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"d",(function(){return i})),r.d(t,"e",(function(){return o})),r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return u})),r.d(t,"f",(function(){return s}));var n=r(20),a=(r(70),n.featureConfiguration.FeatureName),i=n.featureConfiguration.initFeatureConfiguration,o=n.featureConfiguration.isFeatureEnabled,c=n.featureConfiguration.getFeatures,u=n.featureConfiguration.getTypedFeatureGate,s=n.featureConfiguration.isTypedChangeGateEnabled},function(e,t,r){"use strict";r.d(t,"nb",(function(){return i})),r.d(t,"r",(function(){return o})),r.d(t,"G",(function(){return c})),r.d(t,"Q",(function(){return u})),r.d(t,"fb",(function(){return s})),r.d(t,"j",(function(){return l})),r.d(t,"s",(function(){return d})),r.d(t,"cb",(function(){return f})),r.d(t,"D",(function(){return b})),r.d(t,"C",(function(){return h})),r.d(t,"o",(function(){return v})),r.d(t,"V",(function(){return p})),r.d(t,"gb",(function(){return m})),r.d(t,"eb",(function(){return g})),r.d(t,"k",(function(){return O})),r.d(t,"m",(function(){return j})),r.d(t,"e",(function(){return y})),r.d(t,"kb",(function(){return S})),r.d(t,"Y",(function(){return C})),r.d(t,"Z",(function(){return k})),r.d(t,"X",(function(){return E})),r.d(t,"c",(function(){return A})),r.d(t,"h",(function(){return N})),r.d(t,"i",(function(){return T})),r.d(t,"g",(function(){return R})),r.d(t,"ib",(function(){return I})),r.d(t,"P",(function(){return _})),r.d(t,"I",(function(){return F})),r.d(t,"N",(function(){return w})),r.d(t,"p",(function(){return M})),r.d(t,"O",(function(){return D})),r.d(t,"H",(function(){return P})),r.d(t,"J",(function(){return x})),r.d(t,"L",(function(){return L})),r.d(t,"M",(function(){return B})),r.d(t,"hb",(function(){return U})),r.d(t,"K",(function(){return G})),r.d(t,"U",(function(){return V})),r.d(t,"n",(function(){return H})),r.d(t,"lb",(function(){return W})),r.d(t,"F",(function(){return z})),r.d(t,"z",(function(){return q})),r.d(t,"B",(function(){return K})),r.d(t,"A",(function(){return Y})),r.d(t,"y",(function(){return J})),r.d(t,"T",(function(){return Q})),r.d(t,"f",(function(){return X})),r.d(t,"W",(function(){return Z})),r.d(t,"q",(function(){return $})),r.d(t,"E",(function(){return ee})),r.d(t,"l",(function(){return te})),r.d(t,"R",(function(){return re})),r.d(t,"d",(function(){return ne})),r.d(t,"S",(function(){return ae})),r.d(t,"ab",(function(){return ie})),r.d(t,"u",(function(){return oe})),r.d(t,"x",(function(){return ce})),r.d(t,"v",(function(){return ue})),r.d(t,"w",(function(){return se})),r.d(t,"t",(function(){return le})),r.d(t,"jb",(function(){return fe})),r.d(t,"db",(function(){return be})),r.d(t,"bb",(function(){return he})),r.d(t,"mb",(function(){return ve})),r.d(t,"a",(function(){return de}));var n=r(10),a=r(82);r.d(t,"b",(function(){return a.a}));var i=Object(n.w)()((function(e,t){return{functionId:e,functionName:t}})),o=Object(n.w)()((function(e,t){return{errorType:e,errorName:t}})),c=Object(n.w)()((function(e,t,r,n,a,i,o,c,u,s,l,d,f,b,h,v,p,m,g,O,j,y,S,C,k,E,A,N,T,R,I,_,F,w,M,D,P,x,L,B,U,G,V,H,W,z,q,K,Y,J,Q){return{worksheetFunctionNames:e,errorTypeNames:t,specialRefNames:Y,trueName:r,falseName:n,rowLetter:a,columnLetter:i,leftBrace:o,rightBrace:c,leftBracket:u,rightBracket:s,decimalSeparator:l,listSeparator:d,columnSeparator:f,rowSeparator:b,thousandsData:h,thousandsSeparator:v,lcid:p,country:m,numberDecimals:g,isExpSepBySpace:O,fractionSeparator:j,isPercentSepBySpace:y,currencyFormat:S,isCurrencySymbolLead:C,isCurrencySepBySpace:k,currencySymbol:E,currencyDecimals:A,dateOrder:N,dateSeparator:T,dateAltSeparator:R,year4Digits:I,month2Digits:_,day2Digits:F,longDateFormat:w,timeSeparator:M,timeAltSeparator:D,hour2Digits:P,clock24Hour:x,isAMPMSepBySpace:L,ampmSymbols:B,dayNameShort:U,dayNameLong:G,monthNameShort:V,monthNameLong:H,pictureSpecial:W,pictureSingle:z,pictureColor:q,pictureDbnum:K,sysDateFormat:J,sysTimeFormat:Q}})),u=Object(n.w)()((function(e,t,r){return{iformat:e,formatString:t,builtIn:r}})),s=Object(n.w)()((function(e,t){return{sheetId:e,sheetName:t}})),l={kind:"Blank"},d=Object(n.w)()((function(e){return{kind:"Error",type:e}})),f=Object(n.w)()((function(e){return{kind:"Rich",fields:e}}));function b(e){return"object"==typeof e?e.kind:typeof e}function h(e){return"object"==typeof e?e.kind:typeof e}var v=Object(n.w)()((function(e,t){return{row:e,column:t}})),p=Object(n.w)()((function(e,t,r,n){return{row:e,column:t,lastRow:r,lastColumn:n}})),m=Object(n.w)()((function(e,t,r,n,a){return{sheetId:e,row:t,column:r,lastRow:n,lastColumn:a}})),g=Object(n.w)()((function(e,t,r){return{sheetId:e,row:t,column:r,lastRow:void 0,lastColumn:void 0}})),O=Object(n.w)()((function(e,t,r,n,a){return{formulaBarText:e,value:t,iformat:r,failureReason:n,kind:a}}));function j(e,t,r,n){return O(e,t,r,n,"CellFormula")}function y(e,t,r){return O(void 0,e,t,r,"ArrayFormula")}function S(e,t,r,n){return O(e,t,r,n,"Value")}var C=Object(n.w)()((function(e,t,r,n,a){return{range:e,data:t,fromStateId:r,excludeRows:n,excludeColumns:a}})),k=Object(n.w)()((function(e,t,r,n){return C(e,t,void 0,r,n)}));function E(e,t,r,n){return C(e,void 0,t,r,n)}var A=Object(n.w)()((function(e,t){return{isSpilled:e,formulaBarText:t}})),N=Object(n.w)()((function(e,t,r){return{range:e,data:t,fromStateId:r}}));function T(e,t){return N(e,t,void 0)}function R(e,t){return N(e,void 0,t)}var I=Object(n.w)()((function(e,t){return{sheetId:e,usedRange:t}})),_=Object(n.w)()((function(e){return{kind:"NamedValue",value:e}})),F=Object(n.w)()((function(e){return{kind:"NamedFormula",formulaBarText:e}})),w=Object(n.w)()((function(e){return{kind:"NamedRange",range:e}})),M=Object(n.w)()((function(e,t){return{column:e,name:t}})),D=Object(n.w)()((function(e,t,r,n){return{kind:"NamedTable",range:e,hasHeadersRow:t,hasTotalsRow:r,columns:n}})),P=Object(n.w)()((function(e,t){return{kind:"NamedFailure",failureReason:e,objectKind:t}})),x=Object(n.w)()((function(e,t){return{name:e,data:t}})),L=Object(n.w)()((function(e,t,r){return{scope:e,objects:t,fromStateId:r}}));function B(e,t){return L(e,t,void 0)}function U(e){return L(e,void 0,void 0)}function G(e,t){return L(e,void 0,t)}var V=function(e,t,r,n,a,i){return void 0===i&&(i="Inferred"),{range:Array.isArray(e)?e:[e],formulaBarText:t,value:r,origin:n,viewport:a,kind:i}};function H(e,t,r,n){return V(e,t,void 0,r,n,"CellFormula")}function W(e,t,r,n){return V(e,t,r,void 0,n,"Value")}function z(e,t,r,n){return V(e,t,void 0,r,n,"Inferred")}var q=Object(n.w)()((function(e,t,r,n){return{kind:e,format:t,ribbon:r,changeDecimals:n}}));function K(e){return q("SetFormat",e,void 0,void 0)}function Y(e){return q("RibbonFormat",void 0,e,void 0)}function J(e){return q("ChangeDecimals",void 0,void 0,e)}var Q=Object(n.w)()((function(e,t,r,n){return{range:e,operation:t,origin:r,viewport:n}})),X=Object(n.w)()((function(e,t,r,n){return{range:e,formulaBarText:t,origin:r,viewport:n}})),Z=Object(n.w)()((function(e,t,r,n){return{kind:e,target:t,source:r,viewport:n}}));function $(e,t,r){var n=g(e.sheetId,e.row,e.column);return Z("CopyPaste",n,t,r)}var ee=Object(n.w)()((function(e,t,r){return{format:e,category:t,decimals:r}})),te=Object(n.w)()((function(e,t,r,n,a){return{formulaBarText:e,value:t,format:r,formatted:n,hasHyperlink:a}})),re=Object(n.w)()((function(e,t){return{range:e,data:t}})),ne=Object(n.w)()((function(e,t){return{range:e,data:t}})),ae=Object(n.w)()((function(e,t){return{range:e,reason:t}})),ie=Object(n.w)()((function(e,t,r,n,a,i){return{stateId:e,priorityGroup:t,isFinished:r,rangeDeltas:n,arrayDeltas:a,rangeFailures:i}})),oe=Object(n.w)()((function(e,t){return{kind:e,iformat:t}}));function ce(){return oe("Origin")}function ue(e){return oe("Iformat",e)}function se(){return oe("Inferred")}function le(e,t,r){return{value:e,formatted:t,cell:r}}var de,fe=Object(n.w)()((function(e,t,r){return{rangeUpdateRanges:e,arrayUpdateRanges:t,namesUpdateScopes:r}})),be=Object(n.w)()((function(e,t){return{name:e,param:t}})),he=Object(n.w)()((function(e,t,r,n,a,i,o,c,u,s,l,d){return void 0===l&&(l=null==s?void 0:s/(s>=1?1:10)),{totalEvalTimeMs:e,samplePrecisionEvalRate:t,samplePrecisionPrintFormulaRate:s,samplePrecisionPrintValueRate:l,sampleRecalcStatisticsRate:c,sampleWorkbookStatisticsRate:n,sampleRecalcEditedStopwatchRate:a,sampleRecalcViewportStopwatchRate:i,sampleCellEvalStopwatchRate:o,rngSeed:r,volatileMode:d,runExperiments:u}})),ve=Object(n.w)()((function(e,t,r){return{date1904:e,dateCompatibility:t,timezone:r}}));!function(e){e.Thread="Thread",e.Local="Local",e.ThreadOrLocal="ThreadOrLocal"}(de||(de={}))},function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"g",(function(){return i})),r.d(t,"j",(function(){return o})),r.d(t,"i",(function(){return c})),r.d(t,"e",(function(){return u})),r.d(t,"a",(function(){return s})),r.d(t,"c",(function(){return l})),r.d(t,"d",(function(){return d})),r.d(t,"h",(function(){return f})),r.d(t,"f",(function(){return b}));var n=r(20),a=(n.bspSet.SetKind,n.bspSet.cacheKeySplitting,n.bspSet.createFromKey),i=n.bspSet.fromUntyped,o=n.bspSet.union,c=(n.bspSet.unionUntyped,n.bspSet.intersect),u=(n.bspSet.intersectUntyped,n.bspSet.meets,n.bspSet.meetsUntyped,n.bspSet.except),s=(n.bspSet.exceptUntyped,n.bspSet.compare),l=(n.bspSet.combineCmp,n.bspSet.compareUntyped,n.bspSet.dense),d=n.bspSet.empty,f=(n.bspSet.lazy,n.bspSet.symmetricDiff,n.bspSet.complement,n.bspSet.getNodeCount),b=n.bspSet.forEachKey;n.bspSet.forEachKeyUntyped},function(e,t,r){"use strict";r.d(t,"r",(function(){return n})),r.d(t,"D",(function(){return a})),r.d(t,"m",(function(){return i})),r.d(t,"l",(function(){return o})),r.d(t,"o",(function(){return c})),r.d(t,"k",(function(){return u})),r.d(t,"u",(function(){return s})),r.d(t,"y",(function(){return l})),r.d(t,"s",(function(){return d})),r.d(t,"x",(function(){return f})),r.d(t,"a",(function(){return b})),r.d(t,"v",(function(){return h})),r.d(t,"t",(function(){return v})),r.d(t,"n",(function(){return p})),r.d(t,"z",(function(){return m})),r.d(t,"j",(function(){return g})),r.d(t,"h",(function(){return O})),r.d(t,"i",(function(){return j})),r.d(t,"g",(function(){return y})),r.d(t,"f",(function(){return S})),r.d(t,"w",(function(){return C})),r.d(t,"b",(function(){return k})),r.d(t,"c",(function(){return E})),r.d(t,"F",(function(){return A})),r.d(t,"E",(function(){return N})),r.d(t,"d",(function(){return T})),r.d(t,"e",(function(){return R})),r.d(t,"A",(function(){return I})),r.d(t,"B",(function(){return _})),r.d(t,"C",(function(){return F})),r.d(t,"p",(function(){return w})),r.d(t,"q",(function(){return M}));var n=10,a=32,i=33,o=34,c=35,u=36,s=37,l=39,d=40,f=41,b=42,h=43,v=45,p=46,m=47,g=48,O=49,j=50,y=57,S=58,C=63,k=64,E=92,A=95,N=126,T=65,R=90,I=97,_=116,F=122,w=161,M=191},function(e,t,r){"use strict";r.d(t,"b",(function(){return n})),r.d(t,"j",(function(){return f})),r.d(t,"a",(function(){return b})),r.d(t,"i",(function(){return h})),r.d(t,"h",(function(){return v})),r.d(t,"c",(function(){return p})),r.d(t,"g",(function(){return m})),r.d(t,"d",(function(){return g})),r.d(t,"f",(function(){return O})),r.d(t,"e",(function(){return j}));var n,a=r(28),i=r(3),o=r(12),c=r(5),u=r(7),s=r(53),l=r(8),d=r(0);function f(e){return 0===e.length&&Object(c.a)("calc.runtime.unevaluated: expected nonempty array"),{kind:n.Unevaluated,anchors:e}}!function(e){e.Unevaluated="Unevaluated"}(n||(n={}));var b=Object(i.c)("EvaluationError");function h(e){throw new b(e)}function v(e,t,r){var i;switch(r.kind){case n.Unevaluated:if(t.map.getCount()+1>(null!==(i=e.globals.limits.maxCellChain)&&void 0!==i?i:1/0))return Object(d.c)(Object(a.q)(a.c.CellChain));var o=r.anchors.map((function(r){return e.createCellEvaluationMachine(e,t,r,!0)}));return Object(s.callMachineTransition)(new s.AllMachine(o),Object(s.nextOnSuccessReceiver)());default:return Object(d.c)(r)}}function p(){return Object(u.q)([],[],l.d.None,u.b.Lower)}function m(e,t){return{lambdaCalls:e,lambdaDepth:t}}function g(e){var t=Object(i.ib)(e.range),r=Object(d.f)(t.range),n=Object(d.f)(t.sheet);return Object(a.l)(e,r,n,e.kind===o.a.Range,r,n,e.kind===o.a.Cell,!0,!1,Object(d.f)(!1))}function O(e,t){var r,n=e.name.scope;if(void 0!==n.index)r=Object(d.f)(n);else{var o=t.originSheet;if(!Object(d.d)(o))return h(o.reason);r=Object(i.D)(o.value.document,n.document)?o:Object(d.f)(n)}var c=t.originGridCell;return Object(a.l)(e,c,r,t.calcingArray,c,r,!1,!1,!0,Object(d.f)(!1))}function j(e,t){return Object(a.l)(e.lexicalSource,e.originGridCell,e.originSheet,t.calcingArray,t.reflectionGridCell,t.reflectionSheet,t.implicitIntersect,e.allowUnqualifiedCell,e.wrapCellReferences,Object(d.f)(!1))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return o}));var n=r(20),a=n.anonymizer.anonymize,i=n.anonymizer.anonymizeFormulaString,o=n.anonymizer.anonymizeMagnitude;n.anonymizer.kindAnonymizers},function(e,t,r){"use strict";r.d(t,"e",(function(){return c})),r.d(t,"f",(function(){return u})),r.d(t,"a",(function(){return s})),r.d(t,"d",(function(){return l})),r.d(t,"b",(function(){return d})),r.d(t,"c",(function(){return n})),r.d(t,"g",(function(){return f}));var n,a=r(43),i=r(7),o=r(10),c=Object(o.w)()((function(e,t,r,n,a){return{bias:e,standardDate:t,standardBias:r,daylightDate:n,daylightBias:a}})),u=c(0,void 0,0,void 0,0),s=a.dtr.Rounding,l=a.dtr.dtr,d=a.dtr.TimeDivision;!function(e){e[e.Year=0]="Year",e[e.Day=1]="Day",e[e.Instant=2]="Instant"}(n||(n={}));var f={fromNum:function(e,t,r){return a.dtr.fromNum(e.mathpack.toNumber(t),r,e.date1904,e.dateCompatibility)},toNum:function(e,t){var r=a.dtr.toNum(t,e.date1904,e.dateCompatibility);return"number"==typeof r?e.mathpack.fromNumber(r):i.p},toNumWithDuration:function(e,t,r,n){var o=a.dtr.toNumWithDuration(t,e.date1904,e.dateCompatibility,r,n);return"number"==typeof o?e.mathpack.fromNumber(o):i.p},daysPerMonth:a.dtr.daysPerMonth,toDays:function(e,t){return a.dtr.toDays(t,e.date1904,e.dateCompatibility)},toTime:function(e,t,r,n){return a.dtr.toTime(e.mathpack.toNumber(t),r,n)},utcToLocal:function(e,t,r){return a.dtr.utcToLocal(t,r,e.date1904,e.dateCompatibility)}}},function(e,t,r){"use strict";r.r(t),r.d(t,"SyntaxError",(function(){return a})),r.d(t,"TypeError",(function(){return i})),r.d(t,"TypeSourceKind",(function(){return o})),r.d(t,"baseErrors",(function(){return s})),r.d(t,"formatDiagnostic",(function(){return l}));var n,a,i,o,c=r(4),u=r(35);!function(e){e.Unclosed_application="Unclosed_application",e.Unclosed_paren="Unclosed_paren",e.Unclosed_bracket="Unclosed_bracket",e.Unclosed_array="Unclosed_array",e.Unclosed_literal="Unclosed_literal",e.Invalid_number_literal="Invalid_number_literal",e.Invalid_string_literal="Invalid_string_literal",e.Invalid_error_literal="Invalid_error_literal",e.Invalid_name="Invalid_name",e.Illegal_array_literal_element="Illegal_array_literal_element",e.Empty_array_literal="Empty_array_literal",e.Irregular_array_shape="Irregular_array_shape",e.Empty_parenthesis="Empty_parenthesis",e.Missing_operation_argument="Missing_operation_argument",e.Bad_node="Bad_node",e.Invalid_qualifier="Invalid_qualifier",e.Invalid_cell_ref="Invalid_cell_ref",e.Invalid_binder="Invalid_binder",e.Missing_binder="Missing_binder",e.Invalid_body="Invalid_body",e.Mandatory_binder_after_optional="Mandatory_binder_after_optional",e.Missing_default_expression="Missing_default_expression",e.Binder_requires_brackets="Binder_requires_brackets",e.Invalid_field_name="Invalid_field_name",e.Missing_field_name="Missing_field_name",e.Empty_formula="Empty_formula",e.Invalid_rel_sheet_qualifier_in_cell="Invalid_rel_sheet_qualifier_in_cell",e.Invalid_rel_sheet_qualifier_in_name="Invalid_rel_sheet_qualifier_in_name",e.Invalid_unqualified_cell="Invalid_unqualified_cell",e.Unexpected_closing_paren="Unexpected_closing_paren",e.Unexpected_closing_brace="Unexpected_closing_brace",e.Unexpected_closing_bracket="Unexpected_closing_bracket",e.Unexpected_character="Unexpected_character",e.Unexpected_field_ref="Unexpected_field_ref",e.Unexpected_dot="Unexpected_dot",e.Invalid_struct_ref_table_name="Invalid_struct_ref_table_name",e.Invalid_struct_ref_comma_parts="Invalid_struct_ref_comma_parts",e.Invalid_struct_ref_missing_part="Invalid_struct_ref_missing_part",e.Invalid_struct_ref_bad_part="Invalid_struct_ref_bad_part",e.Excess_higher_order_function_arguments="Excess_higher_order_function_arguments"}(a||(a={})),function(e){e.Types_not_related="Types_not_related",e.Unexpected_application_head="Unexpected_application_head",e.Unexpected_application_head_with_fix="Unexpected_application_head_with_fix",e.Incorrect_number_of_operator_arguments="Incorrect_number_of_operator_arguments",e.Excess_function_arguments="Excess_function_arguments",e.Insufficient_function_arguments="Insufficient_function_arguments"}(i||(i={})),function(e){e.WSFArgument="WSFArgument",e.OperatorArgument="OperatorArgument"}(o||(o={}));var s=((n={})[a.Unclosed_application]={kind:a.Unclosed_application},n[a.Unclosed_paren]={kind:a.Unclosed_paren},n[a.Unclosed_bracket]={kind:a.Unclosed_bracket},n[a.Unclosed_array]={kind:a.Unclosed_array},n[a.Unclosed_literal]={kind:a.Unclosed_literal},n[a.Invalid_number_literal]={kind:a.Invalid_number_literal},n[a.Invalid_string_literal]={kind:a.Invalid_string_literal},n[a.Invalid_error_literal]={kind:a.Invalid_error_literal},n[a.Invalid_name]={kind:a.Invalid_name},n[a.Illegal_array_literal_element]={kind:a.Illegal_array_literal_element},n[a.Empty_array_literal]={kind:a.Empty_array_literal},n[a.Irregular_array_shape]={kind:a.Irregular_array_shape},n[a.Empty_parenthesis]={kind:a.Empty_parenthesis},n[a.Bad_node]={kind:a.Bad_node},n[a.Invalid_qualifier]={kind:a.Invalid_qualifier},n[a.Invalid_cell_ref]={kind:a.Invalid_cell_ref},n[a.Invalid_binder]={kind:a.Invalid_binder},n[a.Missing_binder]={kind:a.Missing_binder},n[a.Invalid_body]={kind:a.Invalid_body},n[a.Mandatory_binder_after_optional]={kind:a.Mandatory_binder_after_optional},n[a.Missing_default_expression]={kind:a.Missing_default_expression},n[a.Binder_requires_brackets]={kind:a.Binder_requires_brackets},n[a.Invalid_field_name]={kind:a.Invalid_field_name},n[a.Missing_field_name]={kind:a.Missing_field_name},n[a.Empty_formula]={kind:a.Empty_formula},n[a.Invalid_rel_sheet_qualifier_in_cell]={kind:a.Invalid_rel_sheet_qualifier_in_cell},n[a.Invalid_rel_sheet_qualifier_in_name]={kind:a.Invalid_rel_sheet_qualifier_in_name},n[a.Invalid_unqualified_cell]={kind:a.Invalid_unqualified_cell},n[a.Unexpected_closing_paren]={kind:a.Unexpected_closing_paren},n[a.Unexpected_closing_brace]={kind:a.Unexpected_closing_brace},n[a.Unexpected_closing_bracket]={kind:a.Unexpected_closing_bracket},n[a.Unexpected_field_ref]={kind:a.Unexpected_field_ref},n[a.Unexpected_dot]={kind:a.Unexpected_dot},n[a.Invalid_struct_ref_table_name]={kind:a.Invalid_struct_ref_table_name},n[a.Invalid_struct_ref_comma_parts]={kind:a.Invalid_struct_ref_comma_parts},n[a.Invalid_struct_ref_missing_part]={kind:a.Invalid_struct_ref_missing_part},n[a.Invalid_struct_ref_bad_part]={kind:a.Invalid_struct_ref_bad_part},n[i.Unexpected_application_head]={kind:i.Unexpected_application_head},n[i.Unexpected_application_head_with_fix]={kind:i.Unexpected_application_head_with_fix},n);function l(e){switch(e.kind){case i.Insufficient_function_arguments:case i.Excess_function_arguments:return"".concat(e.kind,": ").concat(Object(c.r)(e.funcId));case a.Missing_operation_argument:case i.Incorrect_number_of_operator_arguments:return"".concat(e.kind,": ").concat(Object(c.n)(e.opId));case a.Unexpected_character:return"".concat(e.kind,": ").concat(Object(u.b)(e.text));case i.Types_not_related:return"".concat(e.kind,": ").concat(function(e){var t=e.kind,r=e.argIndex;switch(e.kind){case o.WSFArgument:return JSON.stringify({kind:t,head:Object(c.r)(e.head),argIndex:r});case o.OperatorArgument:return JSON.stringify({kind:t,head:Object(c.n)(e.head),argIndex:r})}}(e.typeSource));default:return e.kind}}},function(e,t,r){"use strict";r.d(t,"z",(function(){return f})),r.d(t,"x",(function(){return v})),r.d(t,"y",(function(){return p})),r.d(t,"D",(function(){return m})),r.d(t,"B",(function(){return g})),r.d(t,"a",(function(){return y})),r.d(t,"n",(function(){return T})),r.d(t,"h",(function(){return R})),r.d(t,"d",(function(){return M})),r.d(t,"C",(function(){return x})),r.d(t,"A",(function(){return L})),r.d(t,"w",(function(){return U})),r.d(t,"f",(function(){return G})),r.d(t,"l",(function(){return V})),r.d(t,"s",(function(){return W})),r.d(t,"e",(function(){return K})),r.d(t,"t",(function(){return X})),r.d(t,"q",(function(){return ae})),r.d(t,"c",(function(){return oe})),r.d(t,"u",(function(){return ce})),r.d(t,"j",(function(){return je})),r.d(t,"k",(function(){return ye})),r.d(t,"p",(function(){return Ee})),r.d(t,"o",(function(){return Ne})),r.d(t,"b",(function(){return Te})),r.d(t,"m",(function(){return Ie})),r.d(t,"i",(function(){return Ue})),r.d(t,"v",(function(){return He})),r.d(t,"g",(function(){return We})),r.d(t,"r",(function(){return qe}));var n,a=r(10),i=r(8),o=r(12),c=r(11),u=r(4),s=r(2),l=r(18),d=r(82);function f(e,t){var r;e[t]=(null!==(r=e[t])&&void 0!==r?r:0)+1}function b(e,t,r){return e.push("".concat(t.join("."),": expected ").concat(r)),!1}function h(e,t){return function(r,n,i){return Object(a.e)(r)&&e(r)||b(n,i,t)}}function v(e,t,r,n){for(var a=[],i=t(e,a,[n]),o=0,c=a;o<c.length;o++){f(r,c[o])}return i}function p(e,t,r,n){if(!v(e,D,r,n))return[];var a="".concat(n,".<index>");return e.filter((function(e){return v(e,t,r,a)}))}function m(e){return function(t,r,n){return!!Object(a.f)(t)||e(t,r,n)}}function g(e){return function(t,r,n){if(Object(a.f)(t))return b(r,n,"non-null object");var i=n.length;try{var o=!0;for(var c in e)n[i]=c,o=o&&e[c](t[c],r,n);return o}finally{n.length=i}}}function O(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return function(t,r,n){return e.reduce((function(e,a){return e&&a(t,r,n)}),!0)}}function j(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return function(r,n,a){return t.reduce((function(e,t){return e&&t(r)(r,n,a)}),e(r,n,a))}}function y(e){return function(t,r,n){if(!Array.isArray(t))return b(r,n,"Array");n.push("<index>");try{return t.reduce((function(t,a){return t&&e(a,r,n)}),!0)}finally{n.pop()}}}function S(e){var t="one of ".concat(JSON.stringify(Object.getOwnPropertyNames(e).sort()));return function(r,n,i){if(Object(a.f)(r))return b(n,i,"non-null object");var o=i.length;try{var c="string"==typeof r.kind||"number"==typeof r.kind?e[r.kind]:void 0;return Object(a.f)(c)?(i.push("kind"),b(n,i,t)):c(r,n,i)}finally{i.length=o}}}function C(e){var t="typeof one of ".concat(JSON.stringify(Object.getOwnPropertyNames(e).sort()));return function(r,n,i){var o=e[typeof r];return Object(a.f)(o)?b(n,i,t):o(r,n,i)}}function k(e){return"number"==typeof e&&e>-1/0&&e<1/0}function E(e){return(0|e)===e||Math.floor(e)===e}function A(e,t,r){return void 0===r&&(r=0!==e?"integer >= ".concat(e," and < ").concat(t):"natural < ".concat(t)),h((function(r){return"number"==typeof r&&r>=e&&r<t&&E(r)}),r)}var N=h((function(e){return!1}),"never"),T=h((function(e){return"number"==typeof e&&!isNaN(e)}),"number (non-NaN)"),R=h(k,"finite number"),I=h((function(e){return k(e)&&E(e)}),"integer"),_=A(0,1/0,"natural"),F=h((function(e){return"string"==typeof e}),"string"),w=h((function(e){return"string"==typeof e&&e.length>0}),"nonempty string"),M=h((function(e){return"boolean"==typeof e}),"boolean"),D=h((function(e){return Array.isArray(e)}),"Array");function P(e){return h((function(t){return t===e}),JSON.stringify(e))}function x(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r={},n=0,a=e;n<a.length;n++){var i=a[n];r[i]=!0}var o="one of ".concat(JSON.stringify(e.sort()));return h((function(e){return"string"==typeof e&&!0===r[e]}),o)}function L(e){return"="===e[0]||"+"===e[0]||"-"===e[0]}var B=h((function(e){return"string"==typeof e&&L(e)}),"formula text"),U=g({functionId:_,functionName:w}),G=g({errorType:_,errorName:h((function(e){return"string"==typeof e&&e.length>1&&Object(l.h)(e,"#")}),"error name")}),V=g({iformat:_,formatString:F,builtIn:M}),H=h((function(e){return"string"==typeof e||k(e)}),"string or finite number"),W=g({sheetId:H,sheetName:F}),z=A(0,o.v),q=A(0,o.o),K=g({row:z,column:q}),Y=h((function(e){return null==e.lastRow||e.lastRow>=e.row}),"lastRow >= row"),J=h((function(e){return null==e.lastColumn||e.lastColumn>=e.column}),"lastColumn >= column"),Q=j(O(K,g({lastRow:m(z),lastColumn:m(q)})),(function(e){return Y}),(function(e){return J})),X=O(Q,g({sheetId:H})),Z=O(X,g({lastRow:m(N),lastColumn:m(N)})),$=g({kind:P("Blank")}),ee=g({kind:P("Error"),type:_}),te=C({number:R,string:F,boolean:M,object:S({Blank:$,Error:ee})}),re=C({number:_,string:F}),ne=O(g({value:te,iformat:_,failureReason:m(F)}),S({CellFormula:g({formulaBarText:B}),ArrayFormula:g({formulaBarText:m(N)}),Value:g({formulaBarText:F})})),ae=g({range:X,excludeRows:m(y(z)),excludeColumns:m(y(q)),data:m(ne),fromStateId:m(I)}),ie=g({isSpilled:M,formulaBarText:B}),oe=g({range:X,data:m(ie),fromStateId:m(I)}),ce=g({sheetId:H,usedRange:m(Q)}),ue=C({number:R,string:F,boolean:M,object:S({Error:ee})}),se=g({kind:P("NamedValue"),value:ue}),le=g({kind:P("NamedFormula"),formulaBarText:B}),de=g({kind:P("NamedRange"),range:X}),fe=g({column:_,name:w}),be=function(e){var t;return(null!==(t=e.lastRow)&&void 0!==t?t:e.row)-e.row+1},he=function(e){var t;return(null!==(t=e.lastColumn)&&void 0!==t?t:e.column)-e.column+1},ve=h((function(e){return(!e.hasHeadersRow||e.range.row>0)&&(!e.hasTotalsRow||e.range.row+be(e.range)<o.v)}),"enough rows for headers and totals"),pe=h((function(e){var t=e.range.column,r=e.range.column+he(e.range);return e.columns.every((function(e){return e.column>=t&&e.column<r}))}),"column names in range"),me=j(g({kind:P("NamedTable"),range:X,hasHeadersRow:M,hasTotalsRow:M,columns:y(fe)}),(function(e){return ve}),(function(e){return pe})),ge=g({kind:P("NamedFailure"),failureReason:F,objectKind:m(x("NamedValue","NamedFormula","NamedRange","NamedTable"))}),Oe=g({name:F,data:m(S({NamedValue:se,NamedFormula:le,NamedRange:de,NamedTable:me,NamedFailure:ge}))}),je=function(e){return j(Oe,(function(t){return function(e){return h((function(t){var r;return"NamedTable"!==(null===(r=t.data)||void 0===r?void 0:r.kind)||null==e}),"NamedTable at global scope")}(e)}))},ye=g({scope:m(H),objects:m(D),fromStateId:m(I)}),Se=h((function(e){return e.length>0}),"a non-empty array"),Ce=h((function(e){return e.every((function(t){return t.sheetId===e[0].sheetId}))}),"ranges on the same sheet"),ke=j(y(X),(function(e){return Se}),(function(e){return Ce})),Ee=O(g({range:ke,origin:m(K),viewport:m(X)}),S({CellFormula:g({formulaBarText:B,value:m(N)}),Value:g({formulaBarText:F,value:te}),Inferred:g({formulaBarText:F,value:m(N)})})),Ae=S({SetFormat:g({format:re}),RibbonFormat:g({ribbon:x.apply(void 0,Object(a.v)(d.a))}),ChangeDecimals:g({changeDecimals:A(-20,20)})}),Ne=g({range:ke,operation:Ae,origin:m(K),viewport:m(X)}),Te=g({range:X,formulaBarText:h((function(e){return"string"==typeof e&&(0===e.length||L(e))}),"empty string or text denoting formula"),origin:m(K),viewport:m(X)}),Re=h((function(e){var t=he(e.source),r=be(e.source);return e.target.column+t<=o.o&&e.target.row+r<=o.v}),"(target,source) in range"),Ie=j(g({kind:x("CopyPaste"),target:Z,source:X,viewport:m(X)}),(function(e){return Re})),_e=h((function(e){return 2===e.length}),"2 AM/PM symbols"),Fe=h((function(e){return 7===e.length}),"7 day symbols"),we=h((function(e){return 12===e.length}),"12 month symbols");function Me(e){var t=Object(a.m)(e,a.d);return h((function(e){return e.every((function(e,r){return null==e||r in t}))}),"indexes in enum")}var De=Me(s.i),Pe=Me(u.h),xe=Me(u.g),Le=Me(u.e),Be=Me(u.f),Ue=g({worksheetFunctionNames:D,thousandsData:y(_),errorTypeNames:D,specialRefNames:j(y(m(w)),(function(e){return De})),trueName:w,falseName:w,rowLetter:w,columnLetter:w,leftBrace:w,rightBrace:w,leftBracket:w,rightBracket:w,decimalSeparator:w,listSeparator:w,columnSeparator:w,rowSeparator:w,thousandsSeparator:F,lcid:_,country:_,numberDecimals:_,isExpSepBySpace:M,fractionSeparator:w,isPercentSepBySpace:M,currencyFormat:x(c.b.Paren,c.b.Lead,c.b.Intern,c.b.Trail),isCurrencySymbolLead:M,isCurrencySepBySpace:M,currencySymbol:F,currencyDecimals:_,dateOrder:x(c.c.MDY,c.c.DMY,c.c.YMD,c.c.MYD,c.c.DYM,c.c.YDM),dateSeparator:F,dateAltSeparator:F,year4Digits:M,month2Digits:M,day2Digits:M,longDateFormat:M,timeSeparator:F,timeAltSeparator:m(F),hour2Digits:M,clock24Hour:M,isAMPMSepBySpace:M,ampmSymbols:j(y(F),(function(e){return _e})),dayNameShort:j(y(F),(function(e){return Fe})),dayNameLong:j(y(F),(function(e){return Fe})),monthNameShort:j(y(F),(function(e){return we})),monthNameLong:j(y(F),(function(e){return we})),pictureSpecial:j(y(m(w)),(function(e){return Pe})),pictureSingle:j(y(m(w)),(function(e){return xe})),pictureColor:j(y(m(w)),(function(e){return Le})),pictureDbnum:j(y(m(w)),(function(e){return Be})),sysDateFormat:F,sysTimeFormat:F}),Ge=g({yr:I,mon:A(1,13),dom:A(1,6),wdy:A(1,8),hour:A(0,24),min:A(0,60),sec:A(0,60),fracSec:P(0),rounding:A(0,4)}),Ve=j(g({bias:R,standardDate:m(Ge),standardBias:R,daylightDate:m(Ge),daylightBias:R}),(function(e){return h((function(e){return Object(a.f)(e.standardDate)===Object(a.f)(e.daylightDate)}),"standardDate iff daylightDate")})),He=g({date1904:m(M),dateCompatibility:m(M),timezone:m(Ve)}),We=m(S({Origin:g({value:m(N)}),Iformat:g({value:m(_)}),Inferred:g({value:m(N)})})),ze=((n={})[i.b.Number]=!0,n[i.b.String]=!0,n[i.b.Boolean]=!0,n[i.b.Error]=!0,n[i.b.Array]=!1,n[i.b.Blank]=!0,n[i.b.Rich]=!1,n),qe=h((function(e){return ze[e.kind]}),"supported ReadOper")},function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"l",(function(){return l})),r.d(t,"m",(function(){return d})),r.d(t,"s",(function(){return f})),r.d(t,"t",(function(){return b})),r.d(t,"h",(function(){return h})),r.d(t,"c",(function(){return p})),r.d(t,"i",(function(){return m})),r.d(t,"j",(function(){return g})),r.d(t,"b",(function(){return O})),r.d(t,"k",(function(){return j})),r.d(t,"r",(function(){return y})),r.d(t,"e",(function(){return S})),r.d(t,"p",(function(){return C})),r.d(t,"o",(function(){return k})),r.d(t,"n",(function(){return E})),r.d(t,"f",(function(){return A})),r.d(t,"d",(function(){return N})),r.d(t,"g",(function(){return T})),r.d(t,"q",(function(){return R}));var n,a,i,o=r(9),c=r(10),u=r(5),s=r(22);!function(e){e[e.Array=-2147483648]="Array",e[e.Lambda=-2147483647]="Lambda",e[e.Let=-2147483646]="Let",e[e.App=-2147483645]="App",e[e.Name=-2147483644]="Name",e[e.Udf=-2147483643]="Udf",e[e.CellRef=-2147483642]="CellRef",e[e.ReadStack=-2147483641]="ReadStack",e[e.ReadClosure=-2147483640]="ReadClosure",e[e.Conditional=-2147483639]="Conditional",e[e.StructRef=-2147483638]="StructRef",e[e.CallLambda=-2147483637]="CallLambda"}(i||(i={}));var l=(n=Object(c.g)(c.d,c.d)).wrap,d=n.unwrap,f=(a=Object(c.g)((function(e){return-e}),(function(e){return-e}))).wrap,b=a.unwrap;function h(e){return e>0}function v(e){return{kind:e,data:void 0,children:void 0}}function p(e,t,r){var n=v(i.Array);return n.children=r,n.data={rows:e,cols:t},n}function m(e,t,r,n,a,o){var c=v(i.Lambda);return c.children=o,c.data={maxArity:e,minArity:t,closureId:r,closedIdents:n,defIdents:a},c}function g(e,t,r){var n=v(i.Let);return n.children=Object(o.__spreadArray)(Object(o.__spreadArray)([],e,!0),[r],!1),n.data={rec:t},n}function O(e,t,r,n){var a=v(i.App);return a.children=n,a.data={funName:e,funType:t,isFormulaRoot:r},a}function j(e,t,r,n){var a=v(i.Name);return a.data={name:e,qualifier:t,source:r},a.children=n,a}function y(e,t,r){var n=v(i.Udf);return n.data={name:e,qualifier:t},n.children=r,n}function S(e,t){var r=v(i.CellRef);return r.data={ref:e,qualifier:t},r}function C(e){var t=v(i.StructRef);return t.data=e,t}function k(e){var t=v(i.ReadStack);return t.data=e,t}function E(e,t){var r=v(i.ReadClosure);return r.data=[e,t],r}function A(e,t,r,n,a){var c=v(i.Conditional);return c.children=Object(o.__spreadArray)([n],a,!0),c.data={funName:e,funType:t,isFormulaRoot:r},c}function N(e,t,r,n,a,o){var c=v(i.CallLambda);return c.children=o,c.data={arity:e,capturedLocals:t,stackEnv:r,closureEnv:n,defIdents:a},c}function T(e){return e.kind>0}function R(e,t){function r(e){if(T(e))return s.a.resolve(e);switch(e.kind){case i.Let:return s.a.all(e.children.map(n)).bind((function(t){return g(t.slice(0,t.length-1),e.data.rec,t[t.length-1])}));case i.App:return s.a.all(e.children.map(n)).bind((function(t){return O(e.data.funName,e.data.funType,e.data.isFormulaRoot,t)}));case i.Conditional:return s.a.all(e.children.map(n)).bind((function(t){var r=t[0],n=t.slice(1);return A(e.data.funName,e.data.funType,e.data.isFormulaRoot,r,n)}));case i.Lambda:return s.a.all(e.children.map(n)).bind((function(t){return m(e.data.maxArity,e.data.minArity,e.data.closureId,e.data.closedIdents,e.data.defIdents,t)}));case i.Array:return s.a.all(e.children.map((function(e){return s.a.all(e.map(n))}))).bind((function(t){return p(e.data.rows,e.data.cols,t)}));case i.Name:return(void 0===e.children?s.a.resolve(void 0):n(e.children)).bind((function(t){return j(e.data.name,e.data.qualifier,e.data.source,t)}));case i.Udf:return(void 0===e.children?s.a.resolve(void 0):n(e.children)).bind((function(t){return y(e.data.name,e.data.qualifier,t)}));case i.CellRef:case i.StructRef:case i.ReadStack:case i.ReadClosure:return s.a.resolve(e);default:return Object(u.e)("calc.runtime.transformBottomUp",e)}}function n(e){return s.a.resolve(e).bind(r).bind(t)}return s.a.settleOrThrow(n(e))}},function(e,t,r){"use strict";var n,a=r(9),i=r(28),o=r(3),c=r(12),u=r(7),s=r(1),l=r(16),d=r(5),f=r(26),b=r(38),h=r(10),v=r(59),p=r(20),m=r(24),g=r(102),O=r(25),j=r(110);!function(e){e[e.Back=0]="Back",e[e.Front=1]="Front"}(n||(n={}));var y,S,C,k,E=function(){function e(){this.minPriority=0,this.taskDeqs=[]}return e.prototype.deleteTasks=function(e,t){var r=this.taskDeqs[e];if(r)for(var n;n=r.popFront();)"function"!=typeof n&&n.onDeleted&&n.onDeleted(t)},e.prototype.addTask=function(e,t,r){var a,i=null!==(a=this.taskDeqs[e])&&void 0!==a?a:this.taskDeqs[e]=new j.a;t===n.Back?i.pushBack(r):i.pushFront(r),e<this.minPriority&&(this.minPriority=e)},e.prototype.runTask=function(){for(var e,t=this.minPriority;t<this.taskDeqs.length;t+=1){this.minPriority=t;var r=null===(e=this.taskDeqs[t])||void 0===e?void 0:e.popFront();if(r)return"function"==typeof r?r():r.onRun(),!0}return!1},e.prototype.getCount=function(e){var t,r;return void 0!==e?null!==(r=null===(t=this.taskDeqs[e])||void 0===t?void 0:t.getCount())&&void 0!==r?r:0:this.taskDeqs.reduce((function(e,t){return t?e+t.getCount():e}),0)},e}(),A=r(6),N=r(11),T=r(0),R=r(29),I=r(35),_=r(32),F=r(53),w=r(22),M=r(51),D=r(4),P=r(84),x=r(8);function L(e,t){switch(t.kind){case x.b.Number:return{kind:"n",magnitude:Object(I.c)(e.toNumber(t))};case x.b.String:return{kind:"s"};case x.b.Boolean:return{kind:"b"};case x.b.Error:return{kind:"e",type:Object(D.m)(t.type)};case x.b.Rich:return{kind:"r"};case x.b.Array:return{kind:"a"};case x.b.Blank:return{kind:"z"};default:return Object(d.e)("calc.calc.precisionValue",t)}}function B(e,t){var r=e[t.sheet.index];return void 0!==r&&Object(m.h)(r,Object(f.f)(t.range))}function U(e,t){var r,n=null!==(r=e[t.sheet.index])&&void 0!==r?r:_.d;e[t.sheet.index]=Object(m.j)(n,Object(f.f)(t.range))}!function(e){e.EvalStatistics="EvalStatistics",e.PrintFormulaStatistics="PrintFormulaStatistics",e.UnhandledFailure="UnhandledFailure"}(C||(C={})),function(e){e.Success="Success",e.Timeout="Timeout"}(k||(k={}));var G=((y={})[s.a.Add]=.05,y[s.a.Sub]=.069,y[s.a.Eq]=.097,y[s.a.Mul]=.1,y[s.a.Div]=.11,y[s.a.Concat]=.36,y[s.a.Gt]=.65,y[s.a.Ne]=.79,y[s.a.Lt]=.89,y[s.a.Le]=1.6,y[s.a.Ge]=1.9,y[s.a.Percent]=2.9,y[s.a.At]=6.2,y[s.a.Pow]=13,y[s.a.Range]=67,y),V=((S={})[s.b.IF]=.076,S[s.b.SUM]=.11,S[s.b.IFERROR]=.5,S[s.b.COUNTIF]=.77,S[s.b.AND]=.82,S[s.b.VLOOKUP]=1.5,S[s.b.AVERAGE]=1.5,S[s.b.HOUR]=1.9,S[s.b.MINUTE]=1.9,S[s.b.TEXT]=2,S[s.b.OR]=2,S[s.b.NOW]=2.1,S[s.b.ISBLANK]=2.3,S[s.b.CONCATENATE]=2.6,S[s.b.SUMIF]=2.7,S[s.b.COUNTIFS]=3.3,S[s.b.LEFT]=3.4,S[s.b.ISNUMBER]=3.7,S[s.b.MID]=3.9,S[s.b.COUNTA]=4,S[s.b.MONTH]=4.2,S[s.b.SECOND]=4.3,S[s.b.LEN]=4.9,S[s.b.WEEKNUM]=5,S[s.b.DAY]=5.2,S[s.b.ROUND]=5.4,S[s.b.FIND]=5.8,S[s.b.NETWORKDAYS]=6.2,S[s.b.COUNT]=6.2,S[s.b.YEAR]=6.3,S[s.b.INT]=6.4,S[s.b.RIGHT]=6.7,S[s.b.ABS]=7,S[s.b.CONCAT]=7.2,S[s.b.CHAR]=7.4,S[s.b.MAX]=8,S[s.b.ROW]=8.1,S[s.b.WEEKDAY]=9.1,S[s.b.DAYS]=9.2,S[s.b.MIN]=9.8,S[s.b.SEARCH]=9.8,S[s.b.WORKDAY]=11,S[s.b.DATEDIF]=12,S[s.b.TIME]=13,S[s.b.HYPERLINK]=13,S[s.b.IFS]=13,S[s.b.ISERROR]=13,S[s.b.COUNTBLANK]=14,S[s.b.TODAY]=14,S[s.b.VALUE]=18,S[s.b.ROUNDUP]=18,S[s.b.MATCH]=19,S[s.b.DATE]=20,S[s.b.SUBSTITUTE]=20,S[s.b.INDIRECT]=22,S[s.b.INDEX]=23,S[s.b.TRIM]=24,S[s.b.UPPER]=25,S[s.b.SUMIFS]=28,S[s.b.EXACT]=29,S[s.b.NOT]=32,S[s.b.PRODUCT]=35,S[s.b.ROUNDDOWN]=37,S[s.b.AVERAGEIF]=38,S[s.b.ISTEXT]=40,S[s.b.ISOWEEKNUM]=41,S[s.b.EOMONTH]=42,S[s.b.MROUND]=45,S[s.b.COLUMN]=45,S[s.b.ROWS]=46,S[s.b.TIMEVALUE]=52,S[s.b.TRUNC]=53,S[s.b.LOOKUP]=59,S[s.b.NA]=59,S[s.b.DAYS360]=61,S[s.b.RANK]=67,S[s.b.EDATE]=72,S[s.b.MOD]=82,S[s.b.OFFSET]=83,S[s.b.STDEV]=87,S[s.b.SUBTOTAL]=91,S),H=Object(R.h)(Object(a.__assign)(Object(a.__assign)({},Object(R.j)(.01)),{nameNode:function(){return 1},operatorNode:function(e){var t;return null!==(t=G[e])&&void 0!==t?t:100},wsfNode:function(e){var t;return null!==(t=V[e])&&void 0!==t?t:100}}),h.b);var W=function(){function e(e){var t,r,n,a,i=this;this.sampledSets={},this.precisionWrongSets={},this.log=[],this.result=void 0,this.testEval=function(e){var t=e.cell,r=e.p;return i.resumeToPledge((function(){return i.docs.evaluate(l.a.EditedCell,[t],v.b.PrecisionTest)}),r)},this.testPrint=function(e){var t=e.cell,r=e.p;return w.a.try((function(){var e=i.getFormula(t);if(!Object(T.d)(e))return i.onUnavailableObject(e.reason);var n,a=e.value,o=a[0],c=a[1];if(void 0===c.compiledFmla){var u=i.docs.getServerValue(t);if(!Object(T.d)(u))return i.onUnavailableObject(u.reason);n=i.docs.renderValueBarText(t,u.value.oper,c.fmla)}else{var s=c.compiledFmla.getValue();n=Object(T.d)(s)?i.docs.printFormulaBarText(o,c.origin,s.value):s}if(Object(T.d)(n)){var l=Object(I.b)(c.fmla),d=n.value===c.fmla?{expected:l,p:r}:{expected:l,sampled:Object(I.b)(n.value),p:r};i.log.push({kind:C.PrintFormulaStatistics,stats:{samples:[d],failures:[]}})}else i.log.push({kind:C.PrintFormulaStatistics,stats:{samples:[],failures:[n.reason]}})}))},this.config={samplePrecisionEvalRate:null!==(t=e.samplePrecisionEvalRate)&&void 0!==t?t:0,samplePrecisionPrintFormulaRate:null!==(r=e.samplePrecisionPrintFormulaRate)&&void 0!==r?r:0,samplePrecisionPrintValueRate:null!==(n=e.samplePrecisionPrintValueRate)&&void 0!==n?n:0,rngSeed:null!==(a=e.rngSeed)&&void 0!==a?a:0|Object(h.k)()},this.rng=new p.JSF32(this.config.rngSeed)}return Object.defineProperty(e.prototype,"done",{get:function(){return void 0!==this.result},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resultLogMessage",{get:function(){return this.createResultLogMessage(k.Success)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"failedLogMessage",{get:function(){return this.createResultLogMessage(k.Timeout)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"readonlyDebugLog",{get:function(){return this.log},enumerable:!1,configurable:!0}),e.prototype.setContext=function(e){var t=this;this.stateId=e.stateId,this.docs=e.documents,this.docs.reconfigure({yieldIntervalMs:e.stepBudget/2,totalTimeMs:e.totalBudget},this.docs.limits,this.docs.maxDereferenceCells,this.docs.isServerWorkbookLoad),this.runtime=new F.MachineRuntime(this.sampleCells().bind((function(e){var r=e.evalCells,n=e.printCells;return w.a.all(Object(a.__spreadArray)(Object(a.__spreadArray)([],r.map(t.testEval),!0),n.map(t.testPrint),!0))})).catch((function(e){t.log.push({kind:C.UnhandledFailure,reason:e})})))},e.prototype.step=function(){this.result||(this.result=this.runtime.step())},e.prototype.sampleCells=function(){var e=this,t=[],r=[],n=[];return this.docs.getServerAvailableCells().forEach((function(a){var i=a.sheetIdx;return n.push(w.a.try((function(){e.docs.forEachServerNonBlankCellInSet(i,_.c,(function(n){var a=Object(c.p)(i,n),o=e.config,u=o.samplePrecisionEvalRate,s=o.samplePrecisionPrintFormulaRate,l=o.samplePrecisionPrintValueRate;if(u>0){var d=e.getWeight(a);void 0!==(b=void 0===d?void 0:u>=1?1:Object(h.c)(1,u*d))&&e.rng.next()<b&&(U(e.sampledSets,a),t.push({cell:a,p:b}))}var f=Object(h.b)(s,l);if(f>0){var b,v=e.rng.next();if(v<f)v<(b=e.isValueCell(a)?l:s)&&r.push({cell:a,p:b})}return!0}))}))),!0})),w.a.all(n).bind((function(){return{evalCells:t,printCells:r}}))},e.prototype.getWeight=function(e){var t=this.getFormula(e);if(!Object(T.d)(t))return this.onUnavailableObject(t.reason);var r=t.value[1];return void 0!==r.compiledFmla?function(e){return Object(T.d)(e)?Object(R.m)(H,e.value):1}(r.compiledFmla.getValue()):void 0},e.prototype.isValueCell=function(e){var t=this.getFormula(e);return Object(T.d)(t)?void 0===t.value[1].compiledFmla:(this.onUnavailableObject(t.reason),!1)},e.prototype.resumeToPledge=function(e,t){var r=this;return w.a.try((function(){try{r.p=t;var n=e();return Array.isArray(n)?n:r.resumeToPledge(n.resume,t)}finally{r.p=void 0}}))},e.prototype.getFormula=function(e){var t,r=this.docs.getEditedFormula(e);if(!Object(T.d)(r))return r;var n=null!==(t=r.value)&&void 0!==t?t:[e.range,M.d],a=n[0],i=n[1],o=Object(c.i)(i.lexicalKind,Object(c.r)(e.sheet,a));return Object(T.f)([o,i])},e.prototype.onRangeFailure=function(e,t,r,n,a){var i={samples:[],failures:[t]};this.log.push({kind:C.EvalStatistics,stats:i})},e.prototype.onNameFailure=function(){},e.prototype.onNumberFormatFailure=function(){},e.prototype.onInferFormatFailure=function(){},e.prototype.onReturnCellValue=function(){},e.prototype.onUnavailableObject=function(e){var t=Object(o.kb)([e]);this.onUnavailable(t)},e.prototype.onUnavailable=function(e){this.log.push({kind:C.UnhandledFailure,reason:e})},e.prototype.hasWrongPrecedent=function(e){var t=this;return e.cells.some((function(e){return B(t.precisionWrongSets,e)}))},e.prototype.onSetCellValue=function(e,t,r,n,a){var i=this.getFormula(e);if(!Object(T.d)(i))return this.onUnavailableObject(i.reason);var o=i.value,c=o[0],u=o[1],s=this.hasWrongPrecedent(r);return this.logPrecisionResult(e,t,c,u,s)},e.prototype.onSetCellValues=function(e,t,r,n,a){var i=this,u=this.getFormula(Object(o.ib)(e));if(!Object(T.d)(u))return this.onUnavailableObject(u.reason);var s=u.value,l=s[0],d=s[1],f=this.hasWrongPrecedent(r);Object(o.d)(e.range,(function(r,n,a){return i.logPrecisionResult(Object(c.p)(e.sheet,r),t[n][a],l,d,f),!0}))},e.prototype.logPrecisionResult=function(e,t,r,n,a){var i=this.docs.allServerAvailable(e);if(!Object(T.d)(i))return this.onUnavailableObject(i.reason);if(!0===i.value){var o=this.docs.getServerValue(e);if(!Object(T.d)(o))return this.onUnavailableObject(o.reason);var c=B(this.sampledSets,e),u=this.precisionResult(t,o.value.oper,r,n,c,a);(function(e){return void 0===e.sampled})(u)||U(this.precisionWrongSets,e);var s={samples:[u],failures:[]};this.log.push({kind:C.EvalStatistics,stats:s})}},e.prototype.precisionResult=function(e,t,r,n,a,i){var c=this.p,u=this.docs.config.mathpack,s=L(u,t),l=this.docs.anonymizeFormula(r,n),d=l[0],f=l[1];if(Object(o.S)(u,e,t,!0))return{expected:s,formula:d,functions:f,root:a,cascaded:i,p:c};var b=L(u,e);if(Object(o.M)(t)&&Object(o.M)(e)){var h=u.toNumber(t),v=u.toNumber(e);return{expected:s,sampled:b,relMagnitude:Object(I.c)(0===h?v:(v-h)/h),formula:d,functions:f,root:a,cascaded:i,p:c}}return{expected:s,sampled:b,formula:d,functions:f,root:a,cascaded:i,p:c}},e.prototype.createResultLogMessage=function(e){var t,r;if(0!==this.log.length||e!==k.Success){for(var n={samples:[],failures:{}},a={samples:[],failures:{}},i={},o=0,c=this.log;o<c.length;o++){var u=c[o];switch(u.kind){case C.EvalStatistics:(t=n.samples).push.apply(t,u.stats.samples);for(var s=0,l=u.stats.failures;s<l.length;s++){var f=l[s];Object(P.b)(n.failures,f)}break;case C.PrintFormulaStatistics:(r=a.samples).push.apply(r,u.stats.samples);for(var b=0,h=u.stats.failures;b<h.length;b++){f=h[b];Object(P.b)(a.failures,f)}break;case C.UnhandledFailure:Object(P.b)(i,u.reason);break;default:Object(d.e)("calc.calc.PrecisionExperiment.createResultMessage",u)}}return["PrecisionExperiment",e,"stateId = ".concat(this.stateId),"evalStats = ".concat(JSON.stringify(n)),"printStats = ".concat(JSON.stringify(a)),"unhandledFailures = ".concat(JSON.stringify(i))].join(", ")}},e}(),z=r(88),q=r(74),K=r(45);r.d(t,"d",(function(){return Y})),r.d(t,"b",(function(){return te})),r.d(t,"a",(function(){return ee})),r.d(t,"c",(function(){return re}));var Y,J=2*c.o,Q=Object(c.g)(0,0,c.v,c.o);!function(e){e.DocumentLoc="DocumentLoc",e.SheetId="SheetId",e.SheetNames="SheetNames",e.GridRange="GridRange",e.GridRangeSize="GridRangeSize",e.CellFormat="CellFormat",e.CellStyle="CellStyle",e.HiddenRows="HiddenRows",e.HiddenCols="HiddenCols",e.InFilterMode="InFilterMode",e.CellFormula="CellFormula",e.CellMissingFormula="CellMissingFormula",e.CellEvaluatingValue="CellEvaluatingValue",e.ClientFailure="ClientFailure",e.NumberFormat="NumberFormat",e.StyleId="StyleId",e.FontId="FontId",e.FillId="FillId",e.BorderId="BorderId",e.NameLoc="NameLoc",e.VolatileFunction="VolatileFunction",e.TimeGranularity="TimeGranularity",e.GetTimeKind="GetTimeKind",e.ColumnName="ColumnName",e.ContainingTable="ContainingTable",e.NamedRanges="NamedRanges"}(Y||(Y={}));var X,Z=Object(R.h)(Object(a.__assign)(Object(a.__assign)({},Object(R.j)(!1)),{wsfNode:function(e){return e===s.b.HYPERLINK}}),(function(e,t){return e||t}));!function(e){e.EvalFinished="EvalFinished",e.EvalTimedOut="EvalTimedOut",e.StateIdAdvanced="StateIdAdvanced",e.EditReceived="EditReceived",e.SetSheetNames="SetSheetNames",e.SetLangConfig="SetLangConfig"}(X||(X={}));var $,ee,te=function(e){this.cloneLazy=new K.a((function(){return e.createSnapshotSync()})),this.resultsPromise=new q.a,this.stateId=-1};!function(e){e[e.ServerUpdate=0]="ServerUpdate",e[e.ClientEdit=1]="ClientEdit",e[e.EvalFormula=2]="EvalFormula",e[e.BeforeCompute=3]="BeforeCompute",e[e.ComputeCellValue=4]="ComputeCellValue",e[e.AfterCompute=5]="AfterCompute",e[e.ComputeEvalOnClone=6]="ComputeEvalOnClone",e[e.ComputeEvalFormula=7]="ComputeEvalFormula",e[e.RecalcFinished=8]="RecalcFinished",e[e.CompleteDataQuery=9]="CompleteDataQuery",e[e.MaybeCollectGarbage=10]="MaybeCollectGarbage",e[e.RunExperiment=11]="RunExperiment",e[e.TestAdvanceState=12]="TestAdvanceState"}($||($={})),function(e){e[e.Server=0]="Server",e[e.Client=1]="Client"}(ee||(ee={}));var re=function(){function e(e,t){void 0===t&&(t={});var r,n,a=this;this.scheduler=new E,this.outputMessageLog=[],this.stateId=-1/0,this.stateChangesSinceLastGC=0,this.stateChanges=0,this.stateEvalTime=0,this.numPrecisionFailures=0,this.printFormulaProperties=function(e){var t=Object(o.ib)(e),r=a.getAvailableFormula(t);if(Object(T.d)(r)){var n=r.value,i=n[0],c=n[1],u=c.compiledFmla.getValue(),s=Object(T.d)(u)?a.docs.printFormulaBarText(i,t.range,u.value):u;return{formulaBarText:s.kind===T.b.Success?s.value:void a.outputMessageLog.push({kind:l.d.PrintFormulaFailure,stateId:a.stateId,range:e,reason:s.reason}),hasHyperlink:a.formulaHasHyperlink(c),isFormula:!0}}a.onUnavailableObject(r.reason)},this.printValueProperties=function(e,t){var r,n,i=a.docs.getEditedFormula(e);if(Object(T.d)(i)){var o=null!==(n=null===(r=i.value)||void 0===r?void 0:r[1].fmla)&&void 0!==n?n:"",c=a.docs.renderValueBarText(e,t,o);return{formulaBarText:Object(T.d)(c)?c.value:void a.outputMessageLog.push({kind:l.d.PrintFormulaFailure,stateId:a.stateId,range:e,reason:c.reason}),hasHyperlink:!1,isFormula:!1}}a.onUnavailableObject(i.reason)},this.scheduleAvailableFormulas=function(e,t){var r=a.docs.forEachEditedNonBlankCellInSet(e.sheet,e.set,(function(r){var n=Object(c.p)(e.sheet,r),i=a.docs.getEditedFormula(n);return i.kind===T.b.Failure?(a.onUnavailableObject(i.reason),!0):(void 0!==i.value&&void 0!==i.value[1].compiledFmla&&a.enqueueComputeCellValue(n,t),!0)}));Object(T.d)(r)||a.onUnavailableObject(r.reason)},this.scheduleAvailableValues=function(e,t){var r=a.docs.forEachEditedCellInSet(e.sheet,e.set,(function(r){var n=Object(c.p)(e.sheet,r),i=a.docs.getEditedFormula(n);return i.kind===T.b.Failure?(a.onUnavailableObject(i.reason),!0):(void 0!==i.value&&void 0!==i.value[1].compiledFmla||a.enqueueReturnCellValue(n,t),!0)}));Object(T.d)(r)||a.onUnavailableObject(r.reason)},this.docs=new v.a(e,this,t,t,null!==(r=t.maxDereferenceCells)&&void 0!==r?r:J,null!==(n=t.isServerWorkbookLoad)&&void 0!==n&&n),this.reconfigure(t)}return e.prototype.reconfigure=function(e){var t,r;this.config=e,this.rng=new p.JSF32(void 0!==e.rngSeed?e.rngSeed:0),this.docs.reconfigure(e,e,null!==(t=e.maxDereferenceCells)&&void 0!==t?t:J,null!==(r=e.isServerWorkbookLoad)&&void 0!==r&&r)},e.prototype.setWorksheetFuncOverrides=function(e){this.docs.setWorksheetFuncOverrides(e)},e.prototype.onNameFailure=function(e,t,r){r.computeKind!==l.a.EvalFormula&&this.outputMessageLog.push({kind:l.d.NameFailure,stateId:this.stateId,name:e,reason:t})},e.prototype.onRangeFailure=function(e,t,r,n,a){a.computeKind!==l.a.EvalFormula&&this.outputMessageLog.push({kind:l.d.RangeFailure,stateId:this.stateId,cellKind:n,range:e,reason:t})},e.prototype.onNumberFormatFailure=function(e){this.outputMessageLog.push({kind:l.d.NumberFormatFailure,stateId:this.stateId,reason:e})},e.prototype.onInferFormatFailure=function(e,t){this.outputMessageLog.push({kind:l.d.InferFormatFailure,stateId:this.stateId,range:e,reason:t})},e.prototype.onUnavailableObject=function(e){var t=Object(o.kb)([e]);this.onUnavailable(t)},e.prototype.onUnavailable=function(e){this.outputMessageLog.push({kind:l.d.UnhandledFailure,stateId:this.stateId,reason:e})},e.prototype.onSetCellValue=function(e,t,r,n,i){if(i.computeKind!==l.a.EvalFormula){var o=this.outputCell(e,t,n,this.printFormulaProperties);void 0!==o?(this.outputMessageLog.push({kind:l.d.RecalcStatistics,message:l.e.ChangedCell,stateId:this.stateId,cellKind:n}),n!==l.b.EditedCell&&n!==l.b.DependentCell||this.outputMessageLog.push(Object(a.__assign)(Object(a.__assign)({kind:l.d.CellWrite,stateId:this.stateId,cellKind:n,cell:e},o),{formatted:this.formatValue(n,e,t)}))):this.outputMessageLog.push({kind:l.d.RecalcStatistics,message:l.e.UnchangedCell,stateId:this.stateId,cellKind:n})}},e.prototype.onSetCellValues=function(e,t,r,n,i){var o=this;if(i.computeKind!==l.a.EvalFormula){var u=this.outputRange(e,t,n);void 0!==u&&(n!==l.b.EditedCell&&n!==l.b.DependentCell||this.outputMessageLog.push(Object(a.__assign)(Object(a.__assign)({kind:l.d.RangeWrite,stateId:this.stateId,cellKind:n,range:e},u),{formatted:t.map((function(t,r){return t.map((function(t,a){return o.formatValue(n,Object(c.p)(e.sheet,Object(c.f)(e.range.row+r,e.range.col+a)),t)}))}))})))}},e.prototype.onReturnCellValue=function(e,t,r){var n=this,i=this.outputCell(e,t,r,(function(){return n.printValueProperties(e,t)}));void 0!==i?(this.outputMessageLog.push({kind:l.d.RecalcStatistics,message:l.e.ChangedCell,stateId:this.stateId,cellKind:l.b.EditedCell}),r===l.b.EditedCell&&this.outputMessageLog.push(Object(a.__assign)(Object(a.__assign)({kind:l.d.CellWrite,stateId:this.stateId,cellKind:l.b.EditedCell,cell:e},i),{formatted:this.formatValue(r,e,t)}))):this.outputMessageLog.push({kind:l.d.RecalcStatistics,message:l.e.UnchangedCell,stateId:this.stateId,cellKind:l.b.EditedCell})},e.prototype.createSnapshot=function(e){var t=this;return void 0===e&&(e=ee.Client),new Promise((function(r){t.scheduler.addTask($.CompleteDataQuery,n.Back,{onRun:function(){r(t.docs.clone(v.c,e))},onDeleted:function(){r(void 0)}})}))},e.prototype.createSnapshotSync=function(e){return void 0===e&&(e=ee.Client),this.docs.clone(v.c,e)},e.prototype.outputCell=function(e,t,r,n){var a;if(r===l.b.EditedCell||r===l.b.DependentCell){var i=this.docs.testAndSetClientValue(e,t);a=Object(T.d)(i)?i.value?t:void 0:void this.onUnavailableObject(i.reason)}var o=this.outputFormat(e,r),c=this.outputFormulaProperties(e,r,n);return void 0!==a||void 0!==o||void 0!==c?{value:t,format:o,formulaBarText:null==c?void 0:c.formulaBarText,hasHyperlink:null==c?void 0:c.hasHyperlink}:void 0},e.prototype.outputRange=function(e,t,r){var n=this;if(r===l.b.EditedCell||r===l.b.DependentCell){var a=this.docs.setClientValue(e,t);Object(T.d)(a)||this.onUnavailableObject(a.reason)}var i=t.map((function(t,a){return t.map((function(t,i){return n.outputFormat(Object(c.p)(e.sheet,Object(c.f)(e.range.row+a,e.range.col+i)),r)}))})),o=this.outputFormulaProperties(e,r,this.printFormulaProperties);return{values:t,formats:i,formulaBarText:null==o?void 0:o.formulaBarText}},e.prototype.outputFormat=function(e,t){if(t===l.b.EditedCell){var r=this.docs.getEditedFormat(e);if(Object(T.d)(r)){var n=this.docs.testAndSetClientFormat(e,r.value);if(Object(T.d)(n)){if(n.value){var a=r.value;if(a===l.f.Unavailable)return{format:Object(o.kb)([{kind:Y.CellFormat}]),valueType:A.h.Custom,decimals:0};var i=this.docs.resolveCellFormat(e.sheet.document,a);return Object(T.d)(i)?{format:"number"==typeof a?a:a.formatString,valueType:i.value.valueType,decimals:i.value.decimals}:void 0}}else this.onUnavailableObject(n.reason)}else this.onUnavailableObject(r.reason)}},e.prototype.outputFormulaProperties=function(e,t,r){if(t===l.b.EditedCell){var n=r(e);if(void 0!==n){var a=n.formulaBarText,i=n.hasHyperlink,o=n.isFormula,c=this.docs.testAndSetClientFormula(e,a,i);if(Object(T.d)(c)){var u=c.value,s=u.hasFmlaChanged,d=u.hasHyperlinkChanged;return s||d?{formulaBarText:s?a:void 0,hasHyperlink:d?i:void 0,isFormula:o}:void 0}this.onUnavailableObject(c.reason)}}},e.prototype.formatValue=function(e,t,r){var n=this.docs.formatValueCell(t,r);if(Object(T.d)(n))return n.value;this.outputMessageLog.push({kind:l.d.FormatValueFailure,stateId:this.stateId,cellKind:e,range:t,reason:n.reason})},e.prototype.getAvailableFormula=function(e){var t=this.docs.getEditedFormula(e);if(!Object(T.d)(t))return t;if(void 0===t.value)return Object(T.c)({kind:Y.CellMissingFormula});var r=t.value,n=r[0],a=r[1];if(void 0===a.compiledFmla)return Object(T.c)({kind:Y.CellEvaluatingValue});var i=Object(c.i)(a.lexicalKind,Object(c.r)(e.sheet,n));return Object(T.f)([i,a])},e.prototype.formulaHasHyperlink=function(e){if(e.lexicalKind!==c.a.Cell)return!1;var t=null==e?void 0:e.compiledFmla.getValue();return Object(T.d)(t)?Object(R.m)(Z,t.value):void 0},e.prototype.handleSetCellContents=function(e,t,r,n,a,i,u,s,f,b,h){var v,p,m,g,O=void 0!==f?Object(o.kb)([{kind:Y.ClientFailure,reason:f}]):void 0,j=u;void 0!==n?(p=n,Object(d.h)("calc.calc.PartialWorkbook.handleSetCellContents: formula edit",void 0!==a),m=a):void 0===r?(Object(d.h)("calc.calc.PartialWorkbook.handleSetCellContents: format edit",!e&&void 0===a&&void 0!==u&&void 0===O),p=!1,m=void 0):(Object(d.h)("calc.calc.PartialWorkbook.handleSetCellContents: inferred edit",!e&&void 0===O&&j===l.f.Weak),p=(v=this.parseInferredEdit(t,r,i,O,j,h)).isFormula,m=v.oper,O=v.cellFailure,j=v.cellFormat,g=v.inferredFormat);var y=void 0!==h?h.cloneLazy.getValue():this.docs,S=y.setCellContents(e,t,r,p,i,m,O,j,s,b);if(S.kind===T.b.Failure)return this.onUnavailableObject(S.reason);if(y.onCellModified(e),!e){var C=Object(c.p)(t.sheet,i),k=void 0===r?Object(T.f)(void 0):p?y.inferFormulaFormat(C):void 0!==g&&g!==N.d.General?y.resolveValueFormat(t.sheet.document,g):Object(T.f)(void 0);k.kind!==T.b.Success&&(this.onInferFormatFailure(C,k.reason),k=Object(T.f)(l.f.Unavailable)),void 0!==k.value&&y.fillInferredFormat(t,k.value),void 0!==h?(h.stateId=this.stateId,this.enqueueEvalFormulaComputeCellValuesOnDocs(t,y,h)):this.enqueueBeforeCompute(b)}},e.prototype.parseInferredEdit=function(e,t,r,n,a,i){var o=i?i.cloneLazy.getValue().parseInferredEdit(Object(c.p)(e.sheet,r),t,this.getVolatileMode()):this.docs.parseInferredEdit(Object(c.p)(e.sheet,r),t,this.getVolatileMode());if(!Object(T.d)(o))return{isFormula:!1,oper:u.d,cellFailure:o.reason,cellFormat:l.f.Unavailable};var s=t.length>0?t.charAt(0):"";switch("="!==s&&"+"!==s&&"-"!==s||o.value.kind!==A.e.Formula&&o.value.kind!==A.e.Number||d.i.ULS.dnmTraceTag(541189698,O.LogCategory.msoulscat_ES_EWAJS,O.TraceLevel.Info,JSON.stringify({startChar:s,editKind:String(o.value.kind)})),o.value.kind){case A.e.Formula:return{isFormula:!0,oper:u.d,cellFailure:n,cellFormat:a};case A.e.String:case A.e.Other:return{isFormula:!1,oper:o.value.value,cellFailure:n,cellFormat:a};case A.e.Number:return{isFormula:!1,oper:o.value.value,cellFailure:n,cellFormat:a,inferredFormat:o.value.format}}},e.prototype.handleSetRangeFormula=function(e,t,r,n,a){var i=Object(b.A)(r);Object(d.h)("calc.calc.PartialWorkbook: handleSetRangeFormula",""===r&&!e||i);var o=e?void 0:u.d,c=e?void 0:l.f.Weak,s=e?void 0:l.g.Weak,f=this.docs.setRangeFormula(e,t,r,n,o,c,s,a);if(f.kind===T.b.Failure)return this.onUnavailableObject(f.reason);this.docs.onCellModified(e),e||this.enqueueBeforeCompute(a)},e.prototype.handleEditPaste=function(e,t,r,n){var a=Object(c.r)(t.sheet,Object(c.g)(t.range.row,t.range.col,r.range.rows,r.range.cols)),i=this.docs.copyRange(r);if(i.kind===T.b.Failure)return this.onUnavailableObject(i.reason);var o=this.docs.pasteRange(a,i.value);if(o.kind===T.b.Failure)return this.onUnavailableObject(o.reason);this.docs.onCellModified(!1),this.enqueueBeforeCompute(n)},e.prototype.evalFormulaRange=function(e,t,r,a,o){var c=this;return new Promise((function(u){var s=function(){return u(Object(T.c)(i.w))};c.scheduler.deleteTasks($.EvalFormula,void 0),c.scheduler.addTask($.EvalFormula,n.Back,{onRun:function(){if(!c.trySetStateId($.EvalFormula,e))return s();c.enqueueComputeEvalFormulaRange(t,r,a,o,u)},onDeleted:s}),c.enqueueRecalcFinished()}))},e.prototype.enqueueBeforeCompute=function(e){var t=this;this.scheduler.deleteTasks($.BeforeCompute,void 0),this.scheduler.addTask($.BeforeCompute,n.Back,(function(){t.enqueueAfterCompute(),t.restrictToViewport(t.docs.getNonDirtyEditedCells(),e,l.a.EditedCell,t.scheduleAvailableValues),t.restrictToViewport(t.docs.getDirtyEditedCells(),e,l.a.EditedCell,t.scheduleAvailableFormulas),t.restrictToViewport(t.docs.getDirtyDependentCells(),e,l.a.DependentCell,t.scheduleAvailableFormulas)}))},e.prototype.withEvalTiming=function(e){var t=this.docs.schedulerConfig.totalTimeMs;if(void 0===t)return e();var r,n=Object(h.k)();try{r=e()}finally{this.stateEvalTime+=Object(h.b)(1,Object(h.k)()-n),this.stateEvalTime>=t&&(this.deleteComputeTasks(X.EvalTimedOut),this.outputMessageLog.push({kind:l.d.RecalcStatistics,stateId:this.stateId,message:l.e.StateTimedOut}),r=[])}return r},e.prototype.enqueueEvalFormulaComputeCellValuesOnDocs=function(e,t,r){var a=this,i=[];Object(f.g)(e.set,(function(t){return i.push(Object(c.p)(e.sheet,t)),!0}));var o=function(){return t.evaluate(l.a.EvalFormula,i,a.getVolatileMode())},u=function(){var e=a.withEvalTiming(o);if(Array.isArray(e)){var t=e.map((function(e,t){return e.kind===T.b.Failure?Object(T.c)({kind:e.reason.kind}):Object(T.f)(Object(h.n)(i[t].range,e.value))}));r.resultsPromise.resolve({stateId:r.stateId,results:t})}else o=e.resume,a.scheduler.addTask($.ComputeEvalOnClone,n.Front,u)};this.scheduler.addTask($.ComputeEvalOnClone,n.Front,u)},e.prototype.enqueueComputeCellValue=function(e,t){var r,a=this,i=t===l.a.EditedCell&&this.shouldSample(this.config.sampleRecalcEditedStopwatchRate)?Object(g.b)("calc.calc.PartialWorkbook: recalc edited"):void 0,o=!0,c=function(){return a.docs.evaluate(t,[e],a.getVolatileMode())},u=function(){if(o){o=!1,r=a.shouldSample(a.config.sampleCellEvalStopwatchRate)?Object(g.b)("calc.calc.PartialWorkbook: cell eval"):void 0;var t=a.docs.getEditedFormula(e);if(!Object(T.d)(t))return a.onUnavailableObject(t.reason);if(void 0===t.value)return}else a.outputMessageLog.push({kind:l.d.RecalcStatistics,stateId:a.stateId,message:l.e.ContinueComputation});var s=a.withEvalTiming(c);if(Array.isArray(s))return null==r||r.stop(),void(null==i||i.stop());c=s.resume,a.scheduler.addTask($.ComputeCellValue,n.Front,u)};this.scheduler.addTask($.ComputeCellValue,n.Back,u)},e.prototype.enqueueComputeEvalFormulaRange=function(e,t,r,a,o){var c=this,u=this.getVolatileMode(),s=function(){return c.docs.evalFormulaRange(e,t,r,a,u)},l={onRun:function(){var e=s();e.kind===T.b.Paused?(s=e.resume,c.scheduler.addTask($.ComputeEvalFormula,n.Front,l)):o(e)},onDeleted:function(){return o(Object(T.c)(i.w))}};this.scheduler.addTask($.ComputeEvalFormula,n.Back,l)},e.prototype.enqueueReturnCellValue=function(e,t){var r=this,a=this.getVolatileMode();this.scheduler.addTask($.ComputeCellValue,n.Back,(function(){r.docs.evalValue(e,t,a)}))},e.prototype.enqueueAfterCompute=function(){var e=this;this.scheduler.deleteTasks($.AfterCompute,X.EditReceived);var t=this.shouldSample(this.config.sampleRecalcViewportStopwatchRate)?Object(g.b)("calc.calc.PartialWorkbook: recalc viewport"):void 0;this.scheduler.addTask($.AfterCompute,n.Back,{onRun:function(){null==t||t.stop(X.EvalFinished),e.outputMessageLog.push({kind:l.d.RecalcStatistics,message:l.e.EditFinished,stateId:e.stateId})},onDeleted:function(e){null==t||t.stop(e)}})},e.prototype.enqueueRecalcFinished=function(){var e=this;this.scheduler.deleteTasks($.RecalcFinished,void 0),this.scheduler.addTask($.RecalcFinished,n.Back,(function(){e.outputMessageLog.push({kind:l.d.RecalcStatistics,message:l.e.RecalcFinished,stateId:e.stateId})}))},e.prototype.promoteCellContents=function(e,t,r,a){var i=this;this.scheduler.addTask($.ServerUpdate,n.Back,(function(){if(i.trySetStateId($.ServerUpdate,e)){var n=i.docs.promoteServerAvailability(r,a);if(n.kind===T.b.Failure)return i.onUnavailableObject(n.reason);i.docs.onCellModified(!0),n.value||i.outputMessageLog.push({kind:l.d.UpdateRequest,stateId:i.stateId,range:t})}}))},e.prototype.writeCellContents=function(e,t,r,a,i,o,c,u,s,l){var d=this;this.scheduler.addTask($.ServerUpdate,n.Back,(function(){(l||d.trySetStateId($.ServerUpdate,e))&&d.handleSetCellContents(!0,t,r,a,o,i,c,u,s,void 0,l)}))},e.prototype.editCellContents=function(e,t,r,a,i,o,s,d){var f=this;void 0===o&&(o=u.d),void 0===s&&(s=Object(c.r)(t.sheet,Q)),this.lastViewport=s,this.scheduler.addTask($.ClientEdit,n.Back,(function(){f.trySetStateId($.ClientEdit,e)&&f.handleSetCellContents(!1,t,r,a,o,i,l.f.Weak,l.g.Weak,void 0,s,d)})),this.enqueueRecalcFinished()},e.prototype.editCellContentsOnClone=function(e,t,r,n,a){this.editCellContents(this.stateId,e,t,r,n,void 0,void 0,a)},e.prototype.editCellFormats=function(e,t,r,a,i){var o=this;void 0===i&&(i=Object(c.r)(t.sheet,Q)),this.lastViewport=i,this.scheduler.addTask($.ClientEdit,n.Back,(function(){if(o.trySetStateId($.ClientEdit,e)){var n="SetFormat"===r.kind?o.docs.resolveEditFormat(t.sheet.document,r.format):"RibbonFormat"===r.kind?o.docs.resolveRibbonFormat(t.sheet.document,r.ribbon,Object(c.p)(t.sheet,a)):"ChangeDecimals"===r.kind?o.docs.resolveChangeDecimals(t.sheet.document,r.changeDecimals,Object(c.p)(t.sheet,a)):Object(d.e)("calc.calc.PartialWorkbook: editCellFormats",r);Object(T.d)(n)||Object(f.i)(t.set,(function(e){return o.onInferFormatFailure(Object(c.r)(t.sheet,e),n.reason),!0})),Object(T.d)(n)&&void 0===n.value||o.handleSetCellContents(!1,t,void 0,void 0,void 0,Object(c.f)(0,0),Object(T.d)(n)?n.value:l.f.Unavailable,void 0,void 0,i)}})),this.enqueueRecalcFinished()},e.prototype.writeArrayFormula=function(e,t,r,a,i){var c=this;void 0===a&&(a=Object(o.n)(t.range)),void 0===i&&(i=!1),this.scheduler.addTask($.ServerUpdate,n.Back,(function(){c.trySetStateId($.ServerUpdate,e)&&c.handleSetRangeFormula(!0,t,r,a,void 0)}))},e.prototype.editArrayFormula=function(e,t,r,a,i){var u=this;void 0===a&&(a=Object(o.n)(t.range)),void 0===i&&(i=Object(c.r)(t.sheet,Q)),this.lastViewport=i,this.scheduler.addTask($.ClientEdit,n.Back,(function(){u.trySetStateId($.ClientEdit,e)&&u.handleSetRangeFormula(!1,t,r,a,i)})),this.enqueueRecalcFinished()},e.prototype.editPaste=function(e,t,r,a,i){var o=this;void 0===i&&(i=Object(c.r)(r.sheet,Q)),this.scheduler.addTask($.ClientEdit,n.Back,(function(){o.trySetStateId($.ClientEdit,e)&&o.handleEditPaste(t,r,a,i)})),this.enqueueRecalcFinished()},e.prototype.testAdvanceState=function(e){var t=this;this.scheduler.addTask($.TestAdvanceState,n.Back,(function(){t.trySetStateId($.TestAdvanceState,e)}))},e.prototype.step=function(){if(!this.scheduler.runTask())return{queueEmpty:!0,messages:[]};var e=this.outputMessageLog;return this.outputMessageLog=[],{queueEmpty:!1,messages:e}},e.prototype.trySetStateId=function(t,r){var n,a,i,o,c,u=this;if(r<this.stateId)return!1;if(t===$.ClientEdit&&(this.deleteComputeTasks(X.EditReceived),this.stateEvalTime=0),r>this.stateId){if(this.stateId!==-1/0){var s=this.config.sampleWorkbookStatisticsRate;void 0!==s&&this.shouldSample(s)&&this.outputMessageLog.push({kind:l.d.WorkbookStatistics,stateId:this.stateId,stats:this.getStatistics(),p:s})}1===this.stateChanges&&this.enqueueRunExperiments(z.a.OneShot),this.stateChanges>=1&&0===this.scheduler.getCount($.RunExperiment)&&this.enqueueRunExperiments(z.a.Recurring);var d=null!==(n=this.config.samplePrecisionEvalRate)&&void 0!==n?n:0,f=null!==(a=this.config.samplePrecisionPrintFormulaRate)&&void 0!==a?a:0,b=null!==(i=this.config.samplePrecisionPrintValueRate)&&void 0!==i?i:0;if(this.stateChanges>=1&&(d>0||f>0||b>0)&&this.numPrecisionFailures<e.maxPrecisionFailures&&0===this.scheduler.getCount($.RunExperiment)){var h=this.config.experimentFactories,v=null!==(o=null==h?void 0:h.stepBudget)&&void 0!==o?o:10,p=null!==(c=null==h?void 0:h.totalBudget)&&void 0!==c?c:1e4,m=new W({samplePrecisionEvalRate:d,samplePrecisionPrintFormulaRate:f,samplePrecisionPrintValueRate:b}),g={stateId:this.stateId,documents:this.docs.clone(m),stepBudget:v,totalBudget:p,viewport:this.lastViewport};m.setContext(g),this.enqueueRunExperiment("PrecisionExperiment",v,p,z.a.Precision,m,(function(){return u.numPrecisionFailures=0}),(function(){return u.numPrecisionFailures+=1}))}this.deleteComputeTasks(X.StateIdAdvanced),this.lastViewport=void 0;var O=this.stateId;this.stateId=r,this.docs.advanceState(O),this.outputMessageLog.push({kind:l.d.StateAdvanced,stateId:this.stateId}),this.stateEvalTime=0,this.stateChangesSinceLastGC+=1,this.stateChanges+=1,this.enqueueMaybeCollectGarbage()}return!0},e.prototype.deleteComputeTasks=function(e){this.scheduler.deleteTasks($.BeforeCompute,void 0),this.scheduler.deleteTasks($.ComputeCellValue,void 0),this.scheduler.deleteTasks($.AfterCompute,e),e!==X.EvalTimedOut&&this.scheduler.deleteTasks($.ComputeEvalFormula,void 0)},e.prototype.enqueueRunExperiment=function(e,t,r,a,i,o,c){var u=this,s=0,d=0,f=function(t,r,n,o){var c=i.failedLogMessage;void 0!==c&&u.outputMessageLog.push({experimentName:e,kind:l.d.ExperimentRunResult,experimentKind:a,logMessage:c,timeoutReason:{budgetType:t,budget:r,elapsedTime:n,stepsCount:o}})},b=function(){if(i.done){var v=i.resultLogMessage;return void 0!==v&&u.outputMessageLog.push({experimentName:e,kind:l.d.ExperimentRunResult,experimentKind:a,logMessage:v}),void o()}for(var p=Object(h.k)(),m=p,g=0;g<1e3&&m===p;g+=1){i.step(),d+=1;var O=Object(h.k)(),j=O-m;if(j>=t&&!i.done)return f("stepBudget",t,j,d),void c();m=O}if((s+=m>p?m-p:1)>=r&&!i.done)return f("totalBudget",r,s,d),void c();u.scheduler.addTask($.RunExperiment,n.Front,b)};this.scheduler.addTask($.RunExperiment,n.Back,b)},e.prototype.enqueueRunExperiments=function(e){var t;if(this.config.experimentFactories){var r=this.config.experimentFactories,n=r.stepBudget,a=r.totalBudget,i=r.factories.filter((function(t){var r,n;return t.kind===e&&(null!==(r=t.numFailures)&&void 0!==r?r:0)<(null!==(n=t.maxFailures)&&void 0!==n?n:3)}));if(0!==i.length)for(var o={stateId:this.stateId,documents:this.docs.clone(v.c,e===z.a.OneShot?ee.Server:ee.Client),stepBudget:n,totalBudget:a,viewport:this.lastViewport},c=function(r){var i=r.create();if(!i)return"continue";i.setContext(o),u.enqueueRunExperiment(r.experimentName,null!==(t=r.stepBudget)&&void 0!==t?t:n,a,e,i,(function(){return r.numFailures=0}),(function(){var e;return r.numFailures=(null!==(e=r.numFailures)&&void 0!==e?e:0)+1}))},u=this,s=0,l=i;s<l.length;s++){c(l[s])}}},e.prototype.setSheetNames=function(e,t,r){var a=this;this.scheduler.addTask($.ServerUpdate,n.Back,(function(){if(a.trySetStateId($.ServerUpdate,r)){var n=a.docs.setSheetNames(e,t);n.kind===T.b.Failure&&a.onUnavailableObject(n.reason),a.deleteComputeTasks(X.SetSheetNames)}}))},e.prototype.setLangConfig=function(e,t){var r=this;this.scheduler.addTask($.ServerUpdate,n.Back,(function(){if(r.trySetStateId($.ServerUpdate,e)){var n=r.docs.config.localeInfo!==t.localeInfo,a=r.docs.config.refStyle!==t.refStyle;r.docs.setConfig(t),n&&r.docs.clearCompiledNumberFormats(),(n||a)&&(r.docs.clearCompiledFormulas(),r.deleteComputeTasks(X.SetLangConfig))}}))},e.prototype.setNumberFormats=function(e,t,r,a){var i=this;this.scheduler.addTask($.ServerUpdate,n.Back,(function(){if(i.trySetStateId($.ServerUpdate,a)){var n=i.docs.setNumberFormats(e,t,r);return n.kind===T.b.Failure?i.onUnavailable(n.reason):void 0}}))},e.prototype.writeNamedObject=function(e,t,r,a){var i=this;this.scheduler.addTask($.ServerUpdate,n.Back,(function(){if(i.trySetStateId($.ServerUpdate,e)){var n=i.docs.setNamedObject(!0,Object(c.l)(t,r),a);return n.kind===T.b.Failure?i.onUnavailable(n.reason):void 0}}))},e.prototype.writeUndefinedNames=function(e,t){var r=this;this.scheduler.addTask($.ServerUpdate,n.Back,(function(){if(r.trySetStateId($.ServerUpdate,e)){var n=r.docs.setUndefinedNames(t);return n.kind===T.b.Failure?r.onUnavailable(n.reason):void 0}}))},e.prototype.promoteNamedObjects=function(e,t,r){var a=this;this.scheduler.addTask($.ServerUpdate,n.Back,(function(){if(a.trySetStateId($.ServerUpdate,e)){var n=a.docs.promoteNamedObjects(t,r);if(n.kind===T.b.Failure)return a.onUnavailable(n.reason);n.value||a.outputMessageLog.push({kind:l.d.UpdateNamesRequest,stateId:a.stateId,scope:t})}}))},e.prototype.extendUnusedRange=function(e,t){var r=this;this.scheduler.addTask($.ServerUpdate,n.Back,(function(){if(r.trySetStateId($.ServerUpdate,t)){var n=r.docs.extendServerUnused(e.sheet,e.range);if(n.kind===T.b.Failure)return r.onUnavailableObject(n.reason);r.docs.onCellModified(!0)}}))},e.prototype.writeHiddenRows=function(e,t){var r=this;this.scheduler.addTask($.ServerUpdate,n.Back,(function(){if(r.trySetStateId($.ServerUpdate,e)){var n=r.docs.writeHiddenRows(t.sheet,t.range,t.hidden);return n.kind===T.b.Failure?r.onUnavailableObject(n.reason):void 0}}))},e.prototype.writeHiddenCols=function(e,t){var r=this;this.scheduler.addTask($.ServerUpdate,n.Back,(function(){if(r.trySetStateId($.ServerUpdate,e)){var n=r.docs.writeHiddenCols(t.sheet,t.range,t.hidden);return n.kind===T.b.Failure?r.onUnavailableObject(n.reason):void 0}}))},e.prototype.writeInFilterMode=function(e,t){var r=this;this.scheduler.addTask($.ServerUpdate,n.Back,(function(){if(r.trySetStateId($.ServerUpdate,e)){var n=r.docs.writeInFilterMode(t.sheet,t.inFilterMode);return n.kind===T.b.Failure?r.onUnavailableObject(n.reason):void 0}}))},e.prototype.getStatistics=function(){return{queueSize:this.scheduler.getCount(),totalGridStatistics:this.docs.getGridStatistics(),totalNameStatistics:this.docs.getNameStatistics()}},e.prototype.enqueueMaybeCollectGarbage=function(){var e=this;this.scheduler.deleteTasks($.MaybeCollectGarbage,void 0),this.scheduler.addTask($.MaybeCollectGarbage,n.Back,(function(){if(!(e.stateChangesSinceLastGC<17)){var t=e.stateId-17;e.docs.collectGarbage(t),e.outputMessageLog.push({kind:l.d.GarbageCollected,minStateIdKept:t}),e.stateChangesSinceLastGC=0}}))},e.prototype.shouldSample=function(e){return void 0!==e&&this.rng.next()<=e},e.prototype.restrictToViewport=function(e,t,r,n){if(void 0!==t)for(var a=t.sheet,i=t.range,c=Object(f.f)(i),u=0,s=e;u<s.length;u++){var d=s[u];Object(o.Z)(a,d.sheet)&&n(Object(l.l)(a,Object(m.g)(d.set,c)),r)}else for(var b=0,h=e;b<h.length;b++){n(d=h[b],r)}},e.prototype.getVolatileMode=function(){var e;return null!==(e=this.config.volatileMode)&&void 0!==e?e:v.b.Estimation},e.maxPrecisionFailures=3,e}()},function(e,t,r){"use strict";r.d(t,"c",(function(){return f})),r.d(t,"e",(function(){return v})),r.d(t,"b",(function(){return g})),r.d(t,"d",(function(){return O}));var n=r(42);r.d(t,"a",(function(){return n.a}));var a,i,o=r(5),c=r(4),u=r(10),s=r(14),l=r(30),d=r(85),f=((a={})[n.a.TestPlugin]=s.c.functionSuggestion,a[n.a.AutocompletePlugin]=s.c.functionSuggestion,a[n.a.HighlightPlugin]=s.c.formulaHighlighting,a[n.a.DragPlugin]=s.c.functionSuggestion,a[n.a.ConfigTestPlugin]=s.c.functionSuggestion,a[n.a.FeatureGateTestPlugin]=s.c.functionSuggestion,a[n.a.ChangeGateTestPlugin]=s.c.functionSuggestion,a[n.a.ArgumentAssistancePlugin]=s.c.argumentAssistance,a[n.a.FormulaRepairPlugin]=s.c.functionSuggestion,a[n.a.FormulaCollectionPlugin]=s.c.functionSuggestion,a[n.a.DNMTraceTagTestPlugin]=s.c.functionSuggestion,a[n.a.AutocompletePrecisionMeasurements]=s.c.runExperiment,a[n.a.AutocompletePrecisionExperiment]=s.c.runExperiment,a[n.a.AutocompleteGroundTruthMeasurements]=s.c.runExperiment,a[n.a.AutocompleteDataTypesMeasurements]=s.c.runExperiment,a[n.a.ParenthesesCouplingPlugin]=s.c.parenthesesCoupling,a[n.a.SlowTestPlugin]=s.c.functionSuggestion,a[n.a.AutocompleteFunctionPlugin]=s.c.functionSuggestion,a[n.a.AutocompleteLetPlugin]=s.c.functionSuggestion,a[n.a.AutocompleteRichValuePlugin]=s.c.functionSuggestion,a[n.a.AutocompleteNamedObjectsPlugin]=s.c.functionSuggestion,a[n.a.ParserPerformanceMeasurements]=s.c.runExperiment,a);Object(u.r)(),Object(u.r)(),Object(u.r)();var b=((i={})[n.a.ParenthesesCouplingPlugin]=s.e.SyncBoth,i);Object(u.r)(),Object(u.r)();var h="Main";function v(e){h=e}var p=Object(u.i)(),m=Object(u.i)();function g(e,t){var r=(t===d.a.Stable?p:m)[e];if(!r){var a="x10arch.getPluginFactory: ".concat(n.a[e]," has not been registered on ").concat(h);throw o.i.ULS.traceTag(557056858,c.c.msoulscat_ES_EWAJS,c.i.Error,a),new Error(a)}return r}function O(e){var t,r,a=e.factoryName,i=b,u=null!==(t=p[a])&&void 0!==t?t:m[a];if(void 0!==u&&u!==e){var d="x10arch.registerPluginFactory: ".concat(n.a[a]," is already registered on ").concat(h);if(o.i.ULS.traceTag(557056859,c.c.msoulscat_ES_EWAJS,c.i.Error,d),!Object(l.c)("Microsoft.Office.Excel.x10DoNotThrowOnDoublePluginRegistration"))throw new Error(d)}var f=null!==(r=i[a])&&void 0!==r?r:s.e.Both;switch(f){case s.e.Both:case s.e.SyncBoth:m[a]=e,p[a]=e;break;case s.e.StableOnly:case s.e.SyncStableOnly:p[a]=e;break;case s.e.DevOnly:case s.e.SyncDevOnly:m[a]=e;break;default:Object(o.e)("x10arch.registerPluginFactory: ".concat(n.a[a],", unknown compatibility: ").concat(f),f)}var v="x10arch.registerPluginFactory: registered ".concat(n.a[a]," on ").concat(h);o.i.ULS.traceTag(571246212,c.c.msoulscat_ES_EWAJS,c.i.Info,v)}},function(e,t,r){"use strict";var n,a,i,o;r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return o})),function(e){e[e.FunctionMessage=0]="FunctionMessage"}(n||(n={})),function(e){e[e.Insert=0]="Insert",e[e.Delete=1]="Delete",e[e.Replace=2]="Replace"}(a||(a={})),function(e){e[e.TestPlugin=0]="TestPlugin",e[e.AutocompletePlugin=1]="AutocompletePlugin",e[e.HighlightPlugin=2]="HighlightPlugin",e[e.DragPlugin=3]="DragPlugin",e[e.ConfigTestPlugin=4]="ConfigTestPlugin",e[e.ArgumentAssistancePlugin=5]="ArgumentAssistancePlugin",e[e.FeatureGateTestPlugin=6]="FeatureGateTestPlugin",e[e.FormulaRepairPlugin=7]="FormulaRepairPlugin",e[e.DNMTraceTagTestPlugin=8]="DNMTraceTagTestPlugin",e[e.ParenthesesCouplingPlugin=9]="ParenthesesCouplingPlugin",e[e.AutocompleteFunctionPlugin=10]="AutocompleteFunctionPlugin",e[e.AutocompleteLetPlugin=11]="AutocompleteLetPlugin",e[e.AutocompleteRichValuePlugin=12]="AutocompleteRichValuePlugin",e[e.AutocompleteNamedObjectsPlugin=13]="AutocompleteNamedObjectsPlugin",e[e.AutocompletePrecisionMeasurements=1e3]="AutocompletePrecisionMeasurements",e[e.AutocompletePrecisionExperiment=1001]="AutocompletePrecisionExperiment",e[e.AutocompleteGroundTruthMeasurements=1002]="AutocompleteGroundTruthMeasurements",e[e.AutocompleteDataTypesMeasurements=1003]="AutocompleteDataTypesMeasurements",e[e.FormulaCollectionPlugin=1004]="FormulaCollectionPlugin",e[e.ParserPerformanceMeasurements=1005]="ParserPerformanceMeasurements",e[e.ChangeGateTestPlugin=2e3]="ChangeGateTestPlugin",e[e.SlowTestPlugin=2001]="SlowTestPlugin"}(i||(i={})),function(e){e[e.Done=0]="Done",e[e.Superseded=1]="Superseded"}(o||(o={}))},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSupported=t.dtr=t.mathpack=void 0;var n=r(139);t.mathpack=n;var a=r(187);t.dtr=a;var i=r(129);Object.defineProperty(t,"isSupported",{enumerable:!0,get:function(){return i.isSupported}}),(0,r(106)._start)()},function(e,t,r){"use strict";r.d(t,"h",(function(){return d})),r.d(t,"f",(function(){return f})),r.d(t,"d",(function(){return b})),r.d(t,"g",(function(){return h})),r.d(t,"b",(function(){return v})),r.d(t,"e",(function(){return p})),r.d(t,"c",(function(){return m})),r.d(t,"a",(function(){return g}));var n=r(25),a=r(5),i=r(49),o=r(7),c=r(3),u=(r(12),r(10)),s=r(53),l=r(8),d=l.b.Number|l.b.String|l.b.Boolean|l.b.Error|l.b.Rich|l.b.Array,f=l.b.Number|l.b.String|l.b.Boolean|l.b.Error|l.b.Blank|l.b.Rich,b=f|l.b.Array;function h(e,t,r){var i="".concat(e,": generated Excel error, type ").concat(t,"; ").concat(r);a.i.ULS.traceTag(596120270,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Verbose,i)}function v(e,t,r){var n=Object(c.x)(r)?Object(i.e)(r.rows,r.cols,e,t,r.opers,o.m):Object(i.g)(e,t,r);return Object(o.c)(e,t,n)}function p(e,t,r){if(!Object(c.R)(t))return t;if(!Object(c.Y)(t.sheets))return o.w;if(!r)return 1===t.ranges.length&&Object(c.F)(t.ranges[0])?e.dereferenceOper(t,l.c.All&~l.b.Range):e.dereferenceOper(t,l.b.Array);var n=e.dereferenceOper(t,l.c.All&~(l.b.Range|l.b.Array));return Object(c.x)(n)?o.m:n}function m(e){var t=function(e){return e&~(l.b.Array|l.b.Range)};return Object(l.e)(e.minArgs,e.maxArgs,e.headTypes.map(t),e.restTypes.map(t),e.tailTypes.map(t),e.returnType,e.staticPrecs,e.flags)}function g(e,t,r,n){for(var a=0,d=0,f=0;f<n.length;f+=1){var b=n[f];Object(c.x)(b)&&0==(Object(c.f)(t,f,n.length)&l.b.Array)?(a=Object(u.b)(a,b.rows),d=Object(u.b)(d,b.cols)):(a=Object(u.b)(a,1),d=Object(u.b)(d,1))}var h=n.map((function(r,n,u){return function(e,t,r,n,a){switch(n.kind){case l.b.Missing:case l.b.Blank:return Object(i.h)(t,r,e.zero);case l.b.Array:return 0!=(a&l.b.Array)?Object(i.h)(t,r,n):Object(i.f)(t,r,new i.b(n.rows,n.cols,n.opers),o.m);case l.b.Range:default:return Object(i.h)(t,r,n)}}(e.mathpack,a,d,r,Object(c.f)(t,n,u.length))}));return Object(s.machineCall)(new s.ArrayMachine(e,a,d,(function(e,t){return r(h.map((function(r){return r.get(e,t)})))})))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return d})),r.d(t,"b",(function(){return f})),r.d(t,"d",(function(){return b})),r.d(t,"c",(function(){return h})),r.d(t,"e",(function(){return v}));var n=r(5),a=r(8),i=r(0),o=r(36),c=r(6),u=r(59),s=r(3),l=r(40),d=function(){function e(e){this.valueCreationFunc=e,this.value=void 0}return e.prototype.getValue=function(){return void 0===this.value&&(this.value=this.valueCreationFunc()),this.value},e.prototype.reset=function(){this.value=void 0},e}();function f(e){return new d(e)}function b(e){var t=e.value;if(Object(i.d)(t)){var r=t.value;switch(typeof r){case"object":switch(r.kind){case"Blank":return a.b.Blank;case"Error":return a.b.Error;case"Rich":return a.b.Rich;default:Object(n.e)("calc.calc.extractResultValue",r)}case"boolean":return a.b.Boolean;case"number":return a.b.Number;case"string":return a.b.String;default:return Object(n.e)("calc.calc.extractResultValue",r)}}}function h(e){var t=e.value;if(!Object(i.d)(t))return t.reason.kind}function v(e,t,r,a){switch(void 0===a&&(a=u.b.Estimation),a){case u.b.PrecisionTest:return Object(i.c)(Object(s.kb)([{kind:l.d.GetTimeKind,getTimeKind:r}]));case u.b.Estimation:switch(r){case c.j.NonVolatile:return Object(i.c)(Object(s.kb)([{kind:l.d.GetTimeKind,getTimeKind:r}]));case c.j.ValueCell:case c.j.Volatile:}break;case u.b.GroundTruth:}var d=e.mathpack,f=e.datepack,b=new Date,h=f.utcToLocal(e,Object(o.d)(b.getUTCFullYear(),b.getUTCMonth()+1,b.getUTCDate(),b.getUTCHours(),b.getUTCMinutes(),b.getUTCSeconds(),b.getUTCDay()+1,b.getUTCMilliseconds(),o.a.Round1000ths),e.timezone);Object(n.h)("calc.calc.PartialWorkbookDocumentCollection: to local",!1!==h);var v=h.yr,p=h.rounding,m=h.mon,g=h.dom,O=h.hour,j=h.min,y=h.sec,S=h.fracSec;t<o.c.Instant&&(S=0,y=0,j=0,O=0),t<o.c.Day&&(g=1,m=1);var C=Object(o.d)(v,m,g,O,j,y,1,S,p),k=f.toNum(e,C);Object(n.h)("calc.calc.PartialWorkbookDocumentCollection: toNum",!Object(s.E)(k));var E=d.toNumber(k);if(a===u.b.GroundTruth)return Object(i.f)(k);var A=f.toNum(e,h);Object(n.h)("calc.calc.PartialWorkbookDocumentCollection: toNum",!Object(s.E)(A));var N,T=d.toNumber(A);switch(t){case o.c.Instant:N=T;break;case o.c.Day:N=E+1;break;case o.c.Year:var R=Object(o.d)(v+1,m,g,O,j,y,1,S,p),I=f.toNum(e,R);Object(n.h)("calc.calc.PartialWorkbookDocumentCollection: toNum",!Object(s.E)(I)),N=d.toNumber(I)}return T<E+10/1440||T>N-10/1440?Object(i.c)(Object(s.kb)([{kind:l.d.TimeGranularity,granularity:t}])):Object(i.f)(k)}},function(e,t,r){"use strict";r.d(t,"b",(function(){return h})),r.d(t,"n",(function(){return v})),r.d(t,"a",(function(){return p})),r.d(t,"l",(function(){return m})),r.d(t,"i",(function(){return O})),r.d(t,"d",(function(){return j})),r.d(t,"j",(function(){return k})),r.d(t,"e",(function(){return E})),r.d(t,"c",(function(){return N})),r.d(t,"h",(function(){return T})),r.d(t,"m",(function(){return w})),r.d(t,"g",(function(){return M})),r.d(t,"k",(function(){return D})),r.d(t,"f",(function(){return P}));var n=r(12),a=r(2),i=r(60),o=r(5),c=r(33),u=r(23),s=r(18),l=Object(a.db)(a.f.Abs,0),d=Object(a.db)(a.f.Abs,n.v-1),f=c.d,b=c.n;function h(e){for(var t=e+1,r="";t>0;){var n=(t-1)%26;r=String.fromCharCode(f+n)+r,t=Math.floor((t-n)/26)}return r}function v(e,t,r){return e+t&r-1}function p(e,t){return e===a.h.R1C1&&t.kind===a.f.Rel&&0!==t.index}function m(e,t,r,n){if(t.kind===a.f.Abs)return t.index;if(n)return v(e,t.index,r);var i=e+t.index;return 0<=i&&i<r?i:void 0}function g(e,t,r,n,i,o){var c=m(r,n,i,o);if(void 0!==c){if(n.kind===a.f.Abs)return t+(c+1).toFixed();var u=c-r;return 0===u?t:t+e.leftBracket+u.toFixed()+e.rightBracket}}function O(e,t,r,i,o){return t===a.h.A1?function(e,t,r){var i=m(e,t,n.v,r);if(void 0!==i){var o=(i+1).toFixed();return t.kind===a.f.Abs?"$"+o:o}}(r,i,o):g(e,e.rowLetter,r,i,n.v,o)}function j(e,t,r,i,o){return t===a.h.A1?function(e,t,r){var i=m(e,t,n.o,r);if(void 0!==i){var o=h(i);return t.kind===a.f.Abs?"$"+o:o}}(r,i,o):g(e,e.columnLetter,r,i,n.o,o)}function y(e,t,r,n){if(r.kind===a.f.Abs)return r;var i=m(t,r,e,n);if(void 0!==i){var o=i-t;return o===r.index?r:Object(a.db)(a.f.Rel,o)}}y.bind(void 0,n.v),y.bind(void 0,n.o);function S(e,t,r,n,a){var i=m(e,t,n,a),o=m(e,r,n,a);if(void 0!==i&&void 0!==o)return i<=o?[t,r,i,o]:[r,t,o,i]}function C(e,t,r,n,i,o,c,u,s){var l=S(o,c,u,r,s);if(void 0!==l){var d=l[0],f=l[1],b=l[2],h=l[3];if(void 0!==t&&0===b&&h===r-1&&c.kind===u.kind)return t(n,i,s);var v=e(n,i,o,d,s);if(void 0!==v){if(i===a.h.R1C1&&d.kind===f.kind&&d.index===f.index)return v;var p=e(n,i,o,f,s);if(void 0!==p)return v+":"+p}}}var k=C.bind(void 0,O,void 0,n.v),E=C.bind(void 0,j,(function(e,t,r){return k(e,t,0,l,d,r)}),n.o);function A(e,t,r,n,a,i){var o=S(r,n,a,t,i);if(void 0!==o){var c=o[0],u=o[1],s=o[2],l=o[3];if(void 0!==e&&0===s&&l===t-1&&n.kind===a.kind)return e;var d=y(t,r,c,i),f=y(t,r,u,i);if(void 0!==d&&void 0!==f)return[!1,d,f]}}A.bind(void 0,void 0,n.v),A.bind(void 0,[!0,l,d],n.o);function N(e,t,r,n,i,o){var c=O(e,t,r.row,n,o),u=j(e,t,r.col,i,o);if(void 0!==c&&void 0!==u)return t===a.h.A1?u+c:c+u}function T(e,t,r,a,i,o,c,u){var s=S(r.row,a,o,n.v,u),l=S(r.col,i,c,n.o,u);if(void 0!==s&&void 0!==l){var d=s[0],f=s[1],b=s[2],h=s[3],v=l[0],p=l[1],m=l[2],g=l[3];if(0===m&&g===n.o-1&&i.kind===c.kind)return k(e,t,r.row,d,f,u);if(0===b&&h===n.v-1&&a.kind===o.kind)return E(e,t,r.col,v,p,u);var O=N(e,t,r,d,v,u),j=N(e,t,r,f,p,u);if(void 0!==O&&void 0!==j)return O+":"+j}}function R(e,t){return t===b||e.isIdentContinue(t)}var I=/'/g;function _(e,t){if(0===t.length)return!1;var r=0,n=Object(u.i)(t,r);if(!e.isIdentStart(n))return!1;r+=Object(u.f)(n);for(var a=0,i=Object(u.b)(t,r);a<i.length;a++){if(!R(e,i[a]))return!1}return!0}var F=Object(n.f)(0,0);function w(e,t,r){if(0===e.stringCompareCI(r,e.trueName))return!0;if(0===e.stringCompareCI(r,e.falseName))return!0;var n=Object(i.c)(e,t,F,r,0);if(void 0!==n)if(n.refStyle===a.h.A1){var o=n.i;if(o>=r.length&&void 0===e.getWorksheetFuncId(r.substring(0,o)))return!0}else if(!Object(i.b)(n.row,n.col))return!0;return!_(e,r)&&(!function(e,t){var r=0;if(!Object(s.h)(t,e.leftBracket,r))return!1;if((r+=e.leftBracket.length)===t.length)return!1;var n=Object(u.i)(t,r);if(!R(e,n))return!1;for(r+=Object(u.f)(n);;){if(Object(s.h)(t,e.rightBracket,r)){r+=e.rightBracket.length;break}if(r===t.length)return!1;var a=Object(u.i)(t,r);if(!R(e,a))return!1;r+=Object(u.f)(a)}var i=t.indexOf(":",r);return i<0?_(e,t.substring(r)):_(e,t.substring(r,i))&&_(e,t.substring(i+1))}(e,r)&&!function(e,t){var r=e.leftBracket.length,n=e.rightBracket.length;return!(t.length<r+n)&&(t.substring(0,r)===e.leftBracket&&(t.substring(t.length-n)===e.rightBracket&&_(e,t.substring(r,t.length-n))))}(e,r))}function M(e,t,r){return w(e,t,r)?D(r):r}function D(e){return"'".concat(e.replace(I,"''"),"'")}function P(e,t,r){var i=1===t.cols&&1===t.rows?N(e,a.h.A1,Object(n.f)(0,0),Object(a.db)(a.f.Rel,t.row),Object(a.db)(a.f.Rel,t.col),!1):T(e,a.h.A1,Object(n.f)(0,0),Object(a.db)(a.f.Rel,t.row),Object(a.db)(a.f.Rel,t.col),Object(a.db)(a.f.Rel,t.row+t.rows-1),Object(a.db)(a.f.Rel,t.col+t.cols-1),!1);return Object(o.h)("calc.lang.formatGridRangeA1",void 0!==i),void 0===r?i:M(e,a.h.A1,r)+"!"+i}},function(e,t,r){"use strict";r.d(t,"e",(function(){return j})),r.d(t,"g",(function(){return y})),r.d(t,"b",(function(){return C})),r.d(t,"p",(function(){return k})),r.d(t,"k",(function(){return E})),r.d(t,"q",(function(){return A})),r.d(t,"l",(function(){return N})),r.d(t,"n",(function(){return T})),r.d(t,"m",(function(){return R})),r.d(t,"o",(function(){return I})),r.d(t,"d",(function(){return _})),r.d(t,"c",(function(){return F})),r.d(t,"j",(function(){return w})),r.d(t,"h",(function(){return M})),r.d(t,"i",(function(){return D})),r.d(t,"a",(function(){return P})),r.d(t,"f",(function(){return x}));var n=r(9),a=r(10),i=r(4),o=r(12),c=r(31),u=r(26),s=r(51),l=r(16),d=r(7),f=r(3),b=r(32),h=r(24),v=r(5),p=r(38),m=r(63),g=r(8),O=r(2);function j(e,t){var r=Object(a.h)("en-US"),o=function(e,t,r){var n=Object(i.t)().slice();return Object(p.y)(t,p.w,r,"localeData.worksheetFunctionNames").forEach((function(e){return n[e.functionId]=e.functionName})),Object(i.k)(e,n)}(r,e.worksheetFunctionNames,t),c=o.getWorksheetFuncId,u=o.getWorksheetFuncName,s=function(e){if(Object(a.f)(e))return function(e){return e>0&&e%3==0};if(0===e.length||0===e[0])return function(){return!1};if(2===e.length&&0===e[1]){var t=e[0];return function(e){return e>0&&e%t==0}}var r=0===e[e.length-1]&&e.length>=2;return function(t){if(t<=0)return!1;for(var n=t,a=0;a<e.length&&!((n-=e[a])<=0);a+=1);return n>0&&r?n%e[e.length-2]==0:0===n}}(e.thousandsData),l=function(e,t){var r=i.l.slice();return Object(p.y)(e,p.f,t,"localeData.errorTypeNames").forEach((function(e){return r[e.errorType]=e.errorName})),r}(e.errorTypeNames,t),d=e.lcid,f=d===i.b.Thailand,b=d===i.b.Korea,h=d===i.b.Japan,v=d===i.b.ChinaT||d===i.b.HongKong,m=d===i.b.China,g=b||h||m||v,O=d===i.b.Hindi||d===i.b.Tamil,j=d===i.b.Thailand||d===i.b.Vietnam||O,y=(d&i.b.LANG)==(i.b.Hebrew&i.b.LANG)||(d&i.b.LANG)==(i.b.Arabic&i.b.LANG)||d===i.b.Syriac||j;return Object(n.__assign)(Object(n.__assign)({},e),{getWorksheetFuncId:c,getWorksheetFuncName:u,isNumeral:i.y,getOrdinal:i.v,getNumberShape:i.u,isThousandsPosition:s,isIdentStart:i.x,isIdentContinue:i.w,stringCompareCI:r,errorNames:l,isThai:f,isEastAsia:g,isKorea:b,isJapan:h,isChinaT:v,isChinaS:m,isComplexScript:y})}function y(e){return j(e,{})}function S(e,t){return Object(a.f)(t)?{index:e,length:1}:{index:e,length:Object(a.a)(t-e)+1}}function C(e){return Object(o.f)(e.row,e.column)}function k(e,t){var r=S(t.row,t.lastRow),n=r.index,a=r.length,i=S(t.column,t.lastColumn),c=i.index,u=i.length;return Object(o.r)(Object(o.s)(e,t.sheetId),Object(o.g)(n,c,a,u))}function E(e,t){var r=t.row,n=t.column;return Object(o.p)(Object(o.s)(e,t.sheetId),Object(o.f)(r,n))}function A(e,t){var r=t.sheetId,i=t.usedRange;return Object(a.e)(i)?k(e,Object(n.__assign)({sheetId:r},i)):Object(l.m)(Object(o.s)(e,r),s.i)}function N(e,t,r){return{sheet:e.sheet,set:function(e,t,r){var n=Object(h.c)({row:t}),a=Object(h.c)({col:r}),i=Object(h.j)(n,a);return Object(h.d)(Object(u.f)(e),i)}(e.range,t,r)}}function T(e,t){return{sheet:e.sheet,range:e.range,hidden:t}}function R(e,t){return{sheet:e.sheet,range:e.range,hidden:t}}function I(e){return Object(f.U)(e)?Object(c.gb)(e.sheet.index,e.range.row,e.range.col):Object(c.gb)(e.sheet.index,e.range.row,e.range.col,e.range.row+e.range.rows-1,e.range.col+e.range.cols-1)}function _(e,t,r,n){var i=b.d;if(Object(a.f)(n))return i;for(var o=0;o<n.length;o+=1){var c=n[o];if(e<=c&&c<e+t){for(var u=1;o+u<n.length&&n[o+u]===c+u;)u+=1;o+=u-1,i=Object(b.j)(i,r(Object(a.n)(c,c+u)))}}return i}function F(e,t){switch(typeof t){case"string":return Object(d.u)(t);case"boolean":return Object(d.e)(t);case"number":return e.fromNumber(t)}switch(t.kind){case"Blank":return d.d;case"Error":return Object(d.h)(t.type);default:return}}function w(e,t){switch(t.kind){case g.b.String:case g.b.Boolean:return t.value;case g.b.Number:return e.toNumber(t);case g.b.Error:return Object(c.s)(t.type);case g.b.Blank:return c.j;default:return}}function M(e,t,r,n){if(!Object(a.f)(n))switch(n.kind){case"NamedValue":switch(typeof n.value){case"string":return Object(m.j)(Object(d.u)(n.value));case"boolean":return Object(m.j)(Object(d.e)(n.value));case"number":return Object(m.j)(e.fromNumber(n.value))}return"Error"===n.value.kind?Object(m.j)(Object(d.h)(n.value.type)):Object(v.e)("calc.calc.namedObjectDataToNamedObject: NamedValue",n.value.kind);case"NamedFormula":return Object(m.g)(n.formulaBarText);case"NamedRange":var i=k(r,n.range);return Object(m.h)(Object(d.r)(i.sheet,i.range));case"NamedTable":var o=k(r,n.range);return Object(m.i)(o,n.hasHeadersRow,n.hasTotalsRow,n.columns,t);case"NamedFailure":return Object(m.f)(n.failureReason,Object(a.f)(n.objectKind)?void 0:n.objectKind);default:return Object(v.e)("calc.calc.namedObjectDataToNamedObject: kind",n)}}function D(e,t,r){if(r)switch(r.kind){case"NamedValue":switch(r.value.kind){case g.b.Number:return Object(c.P)(e.toNumber(r.value));case g.b.String:case g.b.Boolean:return Object(c.P)(r.value.value);case g.b.Error:return Object(c.P)(r.value.type);default:return}case"NamedFormula":return Object(c.I)(r.fmla);case"NamedRange":var n=Object(o.r)(Object(o.s)(t,r.value.sheets.index),r.value.ranges[0]);return Object(c.N)(I(n));case"NamedTable":var a=r.specialRefRanges[O.i.Data],i=[];return r.columnIndexes.forEach((function(e,t){return i.push(Object(c.p)(e,t)),!0})),Object(c.O)(I(a),r.hasHeadersRow,r.hasTotalsRow,i);case"NamedFailure":return r;default:return Object(v.e)("calc.calc.namedObjectToNamedObjectData: kind",r)}}function P(e){if(void 0!==e)return Object(l.j)(e.format)?Object(c.E)({kind:e.format.kind},e.valueType,e.decimals):Object(c.E)(e.format,e.valueType,e.decimals)}function x(e){if(null!=e)switch(e.kind){case"Origin":return l.f.Origin;case"Iformat":return Object(v.h)("calc.calc.evalFormulaFormatToUnion: iformat","number"==typeof e.iformat),e.iformat;case"Inferred":return l.f.Inferred;default:return Object(v.e)("calc.calc.evalFormulaFormatToUnion: kind",e.kind)}}},function(e,t,r){"use strict";r.d(t,"i",(function(){return d})),r.d(t,"c",(function(){return b})),r.d(t,"d",(function(){return h})),r.d(t,"e",(function(){return v})),r.d(t,"a",(function(){return g})),r.d(t,"f",(function(){return O})),r.d(t,"b",(function(){return k})),r.d(t,"h",(function(){return A})),r.d(t,"j",(function(){return N})),r.d(t,"g",(function(){return T}));var n,a=r(9),i=r(11),o=r(4),c=r(64),u=r(5),s=r(18),l=r(30);function d(e,t){var r,n=null!==(r=e.pictureSpecial[t])&&void 0!==r?r:o.q[t];return Object(u.h)("calc.numfmt.knownFormat: getSpecial",void 0!==n),n}function f(e,t){var r,n=null!==(r=e.pictureSingle[t])&&void 0!==r?r:o.p[t];return Object(u.h)("calc.numfmt.knownFormat: getSingle",void 0!==n),n}function b(e,t,r,n){var a="";if(r>1){var i=Object(s.f)(f(e,o.g.Hash),r-1);a+=t?Object(c.c)({isThousandsPosition:function(e){return e>0&&e%3==0},thousandsSeparator:f(e,o.g.Comma)},i,1):i}return a+="0",n>0&&(a+=f(e,o.g.Decimal),a+=Object(s.f)("0",n)),a}function h(e,t){var r="";return r+="0",t>0&&(r+=f(e,o.g.Decimal),r+=Object(s.f)("0",t)),e.isPercentSepBySpace&&(r+=f(e,o.g.Space)),r+=f(e,o.g.Percent)}function v(e,t,r,n){var a="";return a+=b(e,!1,t,r),e.isExpSepBySpace&&(a+=f(e,o.g.Space)),a+=f(e,o.g.E),a+="+",a+=Object(s.f)("0",n)}function p(e,t){var r=f(e,o.g.Quote);return r+t+r}function m(e,t){var r="";r+=f(e,o.g.Hash);var n=e.fractionSeparator;return n===f(e,o.g.Comma)&&Object(l.e)(l.a["OfficeVSO:3852168_CalcNFFracFix"])?r+=p(e,n):r+=" "===n?f(e,o.g.Space):p(e,n),r+=Object(s.f)(f(e,o.g.Question),t),r+=f(e,o.g.Slash),r+=Object(s.f)(f(e,o.g.Question),t)}function g(e,t,r,n,a,c,l){void 0===l&&(l=!1);for(var h=e.isCurrencySymbolLead,v=e.currencyFormat,m=e.isCurrencySepBySpace,g=l?0:a?3:1,j=b(e,!0,4,r),y="",S=function(l){0!==l&&(y+=f(e,o.g.Sep)),1===l&&t&&(y+=f(e,o.g.ColorStart)+function(e,t){var r,n=null!==(r=e.pictureColor[t])&&void 0!==r?r:o.o[t];return Object(u.h)("calc.numfmt.knownFormat: getColor",void 0!==n),n}(e,o.e.Red)+f(e,o.g.ColorEnd));var b=function(){return 2===l?function(e,t){var r="";return r+=p(e,"-"),t>0&&(r+=Object(s.f)(f(e,o.g.Question),t)),r}(e,r):3===l?f(e,o.g.Text):j},g=function(){return 3!==l?O(e,o.g.Star,o.g.Space):""},S=function(){return 1===l?f(e,o.g.OpenParen):""},C=function(){return 3!==l||h?1===l?f(e,o.g.CloseParen):O(e,o.g.Underscore,o.g.CloseParen):""},k=function(){var t="";if(1!==l)switch(v){case i.b.Intern:h||3===l||(t+=O(e,o.g.Underscore,o.g.Minus));break;case i.b.Lead:case i.b.Trail:if(v===i.b.Lead&&!a)break;t+=O(e,o.g.Underscore,o.g.Minus)}else t+=f(e,o.g.Minus);return a&&!h&&v===i.b.Lead&&(t+=g()),t},E=function(){var t="";return n&&!h&&m&&(t+=f(e,o.g.Space)),n&&(t+=null!=c?c:d(e,o.h.Currency)),h&&m&&(t+=f(e,o.g.Space)),t},A=function(){var e="";return 3!==l&&(h?(n&&(e+=E()),a&&(e+=g())):e+=E()),e};if(a&&(y+=function(){var t="";if(h)switch(v){case i.b.Paren:t+=O(e,o.g.Underscore,o.g.OpenParen);break;case i.b.Trail:t+=O(e,o.g.Underscore,o.g.Minus);break;case i.b.Intern:t+=O(e,o.g.Underscore,o.g.Space)}else{switch(v){case i.b.Trail:t+=O(e,o.g.Underscore,o.g.Minus);break;case i.b.Paren:case i.b.Intern:t+=O(e,o.g.Underscore,o.g.Space)}v!==i.b.Lead&&(t+=g())}return t}()),h)switch(v){case i.b.Paren:a||(y+=S()),y+=A(),a&&(y+=S()),y+=b(),y+=C();break;case i.b.Lead:y+=k(),y+=A(),y+=b();break;case i.b.Intern:y+=A(),y+=k(),y+=b();break;case i.b.Trail:y+=A(),y+=b(),y+=k()}else switch(v){case i.b.Paren:y+=S(),y+=b(),a&&(y+=C()),y+=A(),a||(y+=C());break;case i.b.Lead:y+=k(),y+=b(),y+=A();break;case i.b.Intern:y+=b(),y+=k(),y+=A();break;case i.b.Trail:y+=b(),y+=A(),y+=k()}a&&(y+=function(){if(h)switch(v){case i.b.Lead:return O(e,o.g.Underscore,o.g.Minus);case i.b.Intern:return O(e,o.g.Underscore,o.g.Space)}else switch(v){case i.b.Lead:return O(e,o.g.Underscore,o.g.Minus);case i.b.Paren:case i.b.Intern:return O(e,o.g.Underscore,o.g.Space)}return""}())},C=0;C<=g;C+=1)S(C);return y}function O(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return t.map((function(t){return"string"==typeof t?t:f(e,t)})).join("")}var j=((n={})[i.c.MDY]=[1,0,2],n[i.c.DMY]=[0,1,2],n[i.c.YMD]=[2,1,0],n[i.c.MYD]=[1,2,0],n[i.c.DYM]=[0,2,1],n[i.c.YDM]=[2,0,1],n);function y(e,t){return O(e,(t?e.hour2Digits&&!e.clock24Hour:e.hour2Digits)?o.g.Hour:"",o.g.Hour,o.g.Colon,o.g.Minute,o.g.Minute)}function S(e,t){return y(e,t)+O(e,o.g.Colon,o.g.Second,o.g.Second)}function C(e){var t="";return e.isAMPMSepBySpace&&(t+=f(e,o.g.Space)),t+=d(e,o.h.AP1)}function k(e,t){void 0===t&&(t=!1);for(var r=e.month2Digits,n=e.day2Digits,a=t||e.year4Digits,i=O(e,a?o.g.Year:"",a?o.g.Year:"",o.g.Year,o.g.Year),c=O(e,r?o.g.Month:"",o.g.Month),u=[O(e,n?o.g.Day:"",o.g.Day),c,i],s=j[e.dateOrder],l="",d=0;d<3;d+=1)l+=u[s[d]],d<2&&(l+=f(e,o.g.DateSep));return l}function E(e,t,r){var n=e.day2Digits,a=e.country===o.a.GER,i="/"===e.dateSeparator&&" "!==e.dateAltSeparator,c="";return t&&(c+=O(e,n?o.g.Day:"",o.g.Day),i?c+=e.dateAltSeparator:(c+=f(e,o.g.DateSep),a&&(c+=f(e,o.g.Space)))),c+=O(e,o.g.Month,o.g.Month,o.g.Month),r&&(c+=i?e.dateAltSeparator:f(e,a?o.g.Space:o.g.DateSep),c+=O(e,o.g.Year,o.g.Year)),c}function A(e,t){switch(t){case i.d.General:return d(e,o.h.General);case i.d.NoComFixed0:return b(e,!1,1,0);case i.d.NoComFixed:return b(e,!1,1,2);case i.d.Fixed0:return b(e,!0,4,0);case i.d.Fixed:return b(e,!0,4,2);case i.d.Currency:return g(e,!1,0,!0,!1);case i.d.CoCurrency:return g(e,!0,0,!0,!1);case i.d.CurrencyDec:return g(e,!1,2,!0,!1);case i.d.CoCurrencyDec:return g(e,!0,2,!0,!1);case i.d.Pct0:return h(e,0);case i.d.Pct:return h(e,2);case i.d.Exp:return v(e,1,2,2);case i.d.Fract:return m(e,1);case i.d.FractBond:return m(e,2);case i.d.MMDDYY:return k(e);case i.d.DDMMMYY:return E(e,!0,!0);case i.d.DDMMM:return E(e,!0,!1);case i.d.MMMYY:return E(e,!1,!0);case i.d.HHMMAP:return y(e,!0)+C(e);case i.d.HHMMSSAP:return S(e,!0)+C(e);case i.d.HHMM:return y(e,!1);case i.d.HHMMSS:return S(e,!1);case i.d.MDYHMS:return O(e,k(e),o.g.Space,y(e,!1));case i.d.USCoCurrency:case i.d.USCoCurrencyDec:return g(Object(a.__assign)(Object(a.__assign)({},e),{isCurrencySymbolLead:!0,isCurrencySepBySpace:!1,currencyFormat:i.b.Paren}),!0,t===i.d.USCoCurrencyDec?2:0,!0,!1,e.isChinaT?p(e,"US$"):"$");case i.d.Currency2:return g(e,!1,0,!1,!1);case i.d.CoCurrency2:return g(e,!0,0,!1,!1);case i.d.CurrencyDec2:return g(e,!1,2,!1,!1);case i.d.CoCurrencyDec2:return g(e,!0,2,!1,!1);case i.d.Acct:return g(e,!1,0,!1,!0);case i.d.AcctDec:return g(e,!1,2,!1,!0);case i.d.AcctCur:return g(e,!1,0,!0,!0);case i.d.AcctDecCur:return g(e,!1,2,!0,!0);case i.d.MMSS:return O(e,o.g.Minute,o.g.Minute,o.g.Colon,o.g.Second,o.g.Second);case i.d.AbsHMMSS:return O(e,o.g.ColorStart,o.g.Hour,o.g.ColorEnd,o.g.Colon,o.g.Minute,o.g.Minute,o.g.Colon,o.g.Second,o.g.Second);case i.d.SS0:return O(e,o.g.Minute,o.g.Minute,o.g.Colon,o.g.Second,o.g.Second,o.g.Decimal,"0");case i.d.Eng:return v(e,3,1,1);case i.d.Text:return f(e,o.g.Text)}}function N(e,t){switch(e){case i.d.USCoCurrency:case i.d.USCoCurrencyDec:return t.isEastAsia;default:return!0}}var T={0:i.d.General,1:i.d.NoComFixed0,2:i.d.NoComFixed,3:i.d.Fixed0,4:i.d.Fixed,5:i.d.Currency,6:i.d.CoCurrency,7:i.d.CurrencyDec,8:i.d.CoCurrencyDec,9:i.d.Pct0,10:i.d.Pct,11:i.d.Exp,12:i.d.Fract,13:i.d.FractBond,14:i.d.MMDDYY,15:i.d.DDMMMYY,16:i.d.DDMMM,17:i.d.MMMYY,18:i.d.HHMMAP,19:i.d.HHMMSSAP,20:i.d.HHMM,21:i.d.HHMMSS,22:i.d.MDYHMS,37:i.d.Currency2,38:i.d.CoCurrency2,39:i.d.CurrencyDec2,40:i.d.CoCurrencyDec2,41:i.d.Acct,42:i.d.AcctCur,43:i.d.AcctDec,44:i.d.AcctDecCur,45:i.d.MMSS,46:i.d.AbsHMMSS,47:i.d.SS0,48:i.d.Eng,49:i.d.Text}},function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"c",(function(){return i})),r.d(t,"a",(function(){return c})),r.d(t,"i",(function(){return u})),r.d(t,"d",(function(){return s})),r.d(t,"g",(function(){return l})),r.d(t,"h",(function(){return d})),r.d(t,"e",(function(){return f})),r.d(t,"f",(function(){return b}));var n=r(5),a=(r(10),function(){function e(e,t,r){Object(n.d)("calc.common.StrictArray2D",e),Object(n.d)("calc.common.StrictArray2D",t);var a=r.length;a<e&&Object(n.a)("calc.common.StrictArray2D: expected elements.length >= ".concat(e,"; given ").concat(a));for(var i=0;i<a;i+=1){var o=r[i].length;o<t&&Object(n.a)("calc.common.StrictArray2D: expected elements[".concat(i,"].length >= ").concat(e,"; given ").concat(o))}this.rows=e,this.cols=t,this.elements=r}return e.prototype.get=function(e,t){return Object(n.b)("calc.common.StrictArray2D.get",e,this.rows),Object(n.b)("calc.common.StrictArray2D.get",t,this.cols),this.elements[e][t]},e.prototype.strict=function(){return this},e.prototype.map=function(e){var t=this;return new o(this.rows,this.cols,(function(r,n){return e(t.elements[r][n])}))},e}());var i=function(){function e(e,t,r,a,i,o){Object(n.d)("calc.common.StrictSparseArray2D",e),Object(n.d)("calc.common.StrictSparseArray2D",t),Object(n.b)("calc.common.StrictSparseArray2D",r,e+1),Object(n.b)("calc.common.StrictSparseArray2D",a,t+1);var c=i.length;c<r&&Object(n.a)("calc.common.StrictSparseArray2D: expected elements.length >= ".concat(r,"; given ").concat(c));for(var u=0;u<c;u+=1){var s=i[u].length;s<a&&Object(n.a)("calc.common.StrictSparseArray2D: expected elements[".concat(u,"].length >= ").concat(a,"; given ").concat(s))}this.rows=e,this.cols=t,this.denseRows=r,this.denseCols=a,this.denseElements=i,this.sparseElement=o}return e.prototype.get=function(e,t){return Object(n.b)("calc.common.StrictSparseArray2D.get",e,this.rows),Object(n.b)("calc.common.StrictSparseArray2D.get",t,this.cols),e<this.denseRows&&t<this.denseCols?this.denseElements[e][t]:this.sparseElement},e.prototype.getSparse=function(){return this.sparseElement},e.prototype.strict=function(){return this},e.prototype.map=function(e){var t=this;return new c(this.rows,this.cols,this.denseRows,this.denseCols,(function(r,n){return e(t.denseElements[r][n])}),(function(){return e(t.sparseElement)}))},e}(),o=function(){function e(e,t,r){Object(n.d)("calc.common.NonstrictArray2D",e),Object(n.d)("calc.common.NonstrictArray2D",t),this.rows=e,this.cols=t,this.func=r}return e.prototype.get=function(e,t){return Object(n.b)("calc.common.NonstrictArray2D.get",e,this.rows),Object(n.b)("calc.common.NonstrictArray2D.get",t,this.cols),this.func(e,t)},e.prototype.strict=function(){var e=u(this.rows,this.cols,this.func);return new a(this.rows,this.cols,e)},e.prototype.map=function(t){var r=this;return new e(this.rows,this.cols,(function(e,n){return t(r.func(e,n))}))},e}(),c=function(){function e(e,t,r,a,i,o){Object(n.d)("calc.common.NonstrictSparseArray2D",e),Object(n.d)("calc.common.NonstrictSparseArray2D",t),Object(n.b)("calc.common.NonstrictSparseArray2D",r,e+1),Object(n.b)("calc.common.NonstrictSparseArray2D",a,t+1),this.rows=e,this.cols=t,this.denseRows=r,this.denseCols=a,this.denseFunc=i,this.sparseFunc=o}return e.prototype.get=function(e,t){return Object(n.b)("calc.common.NonstrictSparseArray2D.get",e,this.rows),Object(n.b)("calc.common.NonstrictSparseArray2D.get",t,this.cols),e<this.denseRows&&t<this.denseCols?this.denseFunc(e,t):this.sparseFunc()},e.prototype.getSparse=function(){return this.sparseFunc()},e.prototype.strict=function(){var e=u(this.denseRows,this.denseCols,this.denseFunc),t=this.sparseFunc();return new i(this.rows,this.cols,this.denseRows,this.denseCols,e,t)},e.prototype.map=function(t){var r=this;return new e(this.rows,this.cols,this.denseRows,this.denseCols,(function(e,n){return t(r.denseFunc(e,n))}),(function(){return t(r.sparseFunc())}))},e}();function u(e,t,r){for(var n=[],a=0;a<e;a+=1){for(var i=[],o=0;o<t;o+=1)i[o]=r(a,o);n[a]=i}return n}function s(e){return u(e.rows,e.cols,e.get.bind(e))}function l(e,t,r){for(var n=[],a=[],i=0;i<t;i+=1)a[i]=r;for(var o=0;o<e;o+=1)n[o]=a;return n}function d(e,t,r){return new o(e,t,(function(e,t){return r}))}function f(e,t,r,n,a,i){if(e===r&&t===n)return a;if(1===e&&1===t)return l(r,n,void 0===a[0]?i:a[0][0]);var o,c=[];o=1===e?function(e,r){return r<t?a[0][r]:i}:1===t?function(t,r){return t<e?a[t][0]:i}:function(r,n){return r<e&&n<t?a[r][n]:i};for(var u=0;u<r;u+=1){c.push([]);for(var s=0;s<n;s+=1)c[u][s]=o(u,s)}return c}function b(e,t,r,n){return r.rows===e&&r.cols===t?r:1===r.rows&&1===r.cols?d(e,t,r.get(0,0)):1===r.rows?new o(e,t,(function(e,t){return t<r.cols?r.get(0,t):n})):1===r.cols?new o(e,t,(function(e,t){return e<r.rows?r.get(e,0):n})):new o(e,t,(function(e,t){return e<r.rows&&t<r.cols?r.get(e,t):n}))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return i})),r.d(t,"c",(function(){return c}));var n,a=r(8);!function(e){e[e.COUNT=0]="COUNT",e[e.IF=1]="IF",e[e.ISNA=2]="ISNA",e[e.ISERROR=3]="ISERROR",e[e.SUM=4]="SUM",e[e.AVERAGE=5]="AVERAGE",e[e.MIN=6]="MIN",e[e.MAX=7]="MAX",e[e.ROW=8]="ROW",e[e.COLUMN=9]="COLUMN",e[e.NA=10]="NA",e[e.NPV=11]="NPV",e[e.STDEV=12]="STDEV",e[e.DOLLAR=13]="DOLLAR",e[e.FIXED=14]="FIXED",e[e.SIN=15]="SIN",e[e.COS=16]="COS",e[e.TAN=17]="TAN",e[e.ATAN=18]="ATAN",e[e.PI=19]="PI",e[e.SQRT=20]="SQRT",e[e.EXP=21]="EXP",e[e.LN=22]="LN",e[e.LOG10=23]="LOG10",e[e.ABS=24]="ABS",e[e.INT=25]="INT",e[e.SIGN=26]="SIGN",e[e.ROUND=27]="ROUND",e[e.LOOKUP=28]="LOOKUP",e[e.INDEX=29]="INDEX",e[e.REPT=30]="REPT",e[e.MID=31]="MID",e[e.LEN=32]="LEN",e[e.VALUE=33]="VALUE",e[e.TRUE=34]="TRUE",e[e.FALSE=35]="FALSE",e[e.AND=36]="AND",e[e.OR=37]="OR",e[e.NOT=38]="NOT",e[e.MOD=39]="MOD",e[e.DCOUNT=40]="DCOUNT",e[e.DSUM=41]="DSUM",e[e.DAVERAGE=42]="DAVERAGE",e[e.DMIN=43]="DMIN",e[e.DMAX=44]="DMAX",e[e.DSTDEV=45]="DSTDEV",e[e.VAR=46]="VAR",e[e.DVAR=47]="DVAR",e[e.TEXT=48]="TEXT",e[e.LINEST=49]="LINEST",e[e.TREND=50]="TREND",e[e.LOGEST=51]="LOGEST",e[e.GROWTH=52]="GROWTH",e[e.GOTO=53]="GOTO",e[e.HALT=54]="HALT",e[e.RETURN=55]="RETURN",e[e.PV=56]="PV",e[e.FV=57]="FV",e[e.NPER=58]="NPER",e[e.PMT=59]="PMT",e[e.RATE=60]="RATE",e[e.MIRR=61]="MIRR",e[e.IRR=62]="IRR",e[e.RAND=63]="RAND",e[e.MATCH=64]="MATCH",e[e.DATE=65]="DATE",e[e.TIME=66]="TIME",e[e.DAY=67]="DAY",e[e.MONTH=68]="MONTH",e[e.YEAR=69]="YEAR",e[e.WEEKDAY=70]="WEEKDAY",e[e.HOUR=71]="HOUR",e[e.MINUTE=72]="MINUTE",e[e.SECOND=73]="SECOND",e[e.NOW=74]="NOW",e[e.AREAS=75]="AREAS",e[e.ROWS=76]="ROWS",e[e.COLUMNS=77]="COLUMNS",e[e.OFFSET=78]="OFFSET",e[e.ABSREF=79]="ABSREF",e[e.RELREF=80]="RELREF",e[e.ARGUMENT=81]="ARGUMENT",e[e.SEARCH=82]="SEARCH",e[e.TRANSPOSE=83]="TRANSPOSE",e[e.ERROR=84]="ERROR",e[e.STEP=85]="STEP",e[e.TYPE=86]="TYPE",e[e.ECHO=87]="ECHO",e[e.SET_NAME=88]="SET_NAME",e[e.CALLER=89]="CALLER",e[e.DEREF=90]="DEREF",e[e.WINDOWS=91]="WINDOWS",e[e.SERIES=92]="SERIES",e[e.DOCUMENTS=93]="DOCUMENTS",e[e.ACTIVE_CELL=94]="ACTIVE_CELL",e[e.SELECTION=95]="SELECTION",e[e.RESULT=96]="RESULT",e[e.ATAN2=97]="ATAN2",e[e.ASIN=98]="ASIN",e[e.ACOS=99]="ACOS",e[e.CHOOSE=100]="CHOOSE",e[e.HLOOKUP=101]="HLOOKUP",e[e.VLOOKUP=102]="VLOOKUP",e[e.LINKS=103]="LINKS",e[e.INPUT=104]="INPUT",e[e.ISREF=105]="ISREF",e[e.GET_FORMULA=106]="GET_FORMULA",e[e.GET_NAME=107]="GET_NAME",e[e.SET_VALUE=108]="SET_VALUE",e[e.LOG=109]="LOG",e[e.EXEC=110]="EXEC",e[e.CHAR=111]="CHAR",e[e.LOWER=112]="LOWER",e[e.UPPER=113]="UPPER",e[e.PROPER=114]="PROPER",e[e.LEFT=115]="LEFT",e[e.RIGHT=116]="RIGHT",e[e.EXACT=117]="EXACT",e[e.TRIM=118]="TRIM",e[e.REPLACE=119]="REPLACE",e[e.SUBSTITUTE=120]="SUBSTITUTE",e[e.CODE=121]="CODE",e[e.NAMES=122]="NAMES",e[e.DIRECTORY=123]="DIRECTORY",e[e.FIND=124]="FIND",e[e.CELL=125]="CELL",e[e.ISERR=126]="ISERR",e[e.ISTEXT=127]="ISTEXT",e[e.ISNUMBER=128]="ISNUMBER",e[e.ISBLANK=129]="ISBLANK",e[e.T=130]="T",e[e.N=131]="N",e[e.FOPEN=132]="FOPEN",e[e.FCLOSE=133]="FCLOSE",e[e.FSIZE=134]="FSIZE",e[e.FREADLN=135]="FREADLN",e[e.FREAD=136]="FREAD",e[e.FWRITELN=137]="FWRITELN",e[e.FWRITE=138]="FWRITE",e[e.FPOS=139]="FPOS",e[e.DATEVALUE=140]="DATEVALUE",e[e.TIMEVALUE=141]="TIMEVALUE",e[e.SLN=142]="SLN",e[e.SYD=143]="SYD",e[e.DDB=144]="DDB",e[e.GET_DEF=145]="GET_DEF",e[e.REFTEXT=146]="REFTEXT",e[e.TEXTREF=147]="TEXTREF",e[e.INDIRECT=148]="INDIRECT",e[e.REGISTER=149]="REGISTER",e[e.CALL=150]="CALL",e[e.ADD_BAR=151]="ADD_BAR",e[e.ADD_MENU=152]="ADD_MENU",e[e.ADD_COMMAND=153]="ADD_COMMAND",e[e.ENABLE_COMMAND=154]="ENABLE_COMMAND",e[e.CHECK_COMMAND=155]="CHECK_COMMAND",e[e.RENAME_COMMAND=156]="RENAME_COMMAND",e[e.SHOW_BAR=157]="SHOW_BAR",e[e.DELETE_MENU=158]="DELETE_MENU",e[e.DELETE_COMMAND=159]="DELETE_COMMAND",e[e.GET_CHART_ITEM=160]="GET_CHART_ITEM",e[e.DIALOG_BOX=161]="DIALOG_BOX",e[e.CLEAN=162]="CLEAN",e[e.MDETERM=163]="MDETERM",e[e.MINVERSE=164]="MINVERSE",e[e.MMULT=165]="MMULT",e[e.FILES=166]="FILES",e[e.IPMT=167]="IPMT",e[e.PPMT=168]="PPMT",e[e.COUNTA=169]="COUNTA",e[e.CANCEL_KEY=170]="CANCEL_KEY",e[e.FOR=171]="FOR",e[e.WHILE=172]="WHILE",e[e.BREAK=173]="BREAK",e[e.NEXT=174]="NEXT",e[e.INITIATE=175]="INITIATE",e[e.REQUEST=176]="REQUEST",e[e.POKE=177]="POKE",e[e.EXECUTE=178]="EXECUTE",e[e.TERMINATE=179]="TERMINATE",e[e.RESTART=180]="RESTART",e[e.HELP=181]="HELP",e[e.GET_BAR=182]="GET_BAR",e[e.PRODUCT=183]="PRODUCT",e[e.FACT=184]="FACT",e[e.GET_CELL=185]="GET_CELL",e[e.GET_WORKSPACE=186]="GET_WORKSPACE",e[e.GET_WINDOW=187]="GET_WINDOW",e[e.GET_DOCUMENT=188]="GET_DOCUMENT",e[e.DPRODUCT=189]="DPRODUCT",e[e.ISNONTEXT=190]="ISNONTEXT",e[e.GET_NOTE=191]="GET_NOTE",e[e.NOTE=192]="NOTE",e[e.STDEVP=193]="STDEVP",e[e.VARP=194]="VARP",e[e.DSTDEVP=195]="DSTDEVP",e[e.DVARP=196]="DVARP",e[e.TRUNC=197]="TRUNC",e[e.ISLOGICAL=198]="ISLOGICAL",e[e.DCOUNTA=199]="DCOUNTA",e[e.DELETE_BAR=200]="DELETE_BAR",e[e.UNREGISTER=201]="UNREGISTER",e[e.USDOLLAR=204]="USDOLLAR",e[e.FINDB=205]="FINDB",e[e.SEARCHB=206]="SEARCHB",e[e.REPLACEB=207]="REPLACEB",e[e.LEFTB=208]="LEFTB",e[e.RIGHTB=209]="RIGHTB",e[e.MIDB=210]="MIDB",e[e.LENB=211]="LENB",e[e.ROUNDUP=212]="ROUNDUP",e[e.ROUNDDOWN=213]="ROUNDDOWN",e[e.ASC=214]="ASC",e[e.DBCS=215]="DBCS",e[e.RANK=216]="RANK",e[e.ADDRESS=219]="ADDRESS",e[e.DAYS360=220]="DAYS360",e[e.TODAY=221]="TODAY",e[e.VDB=222]="VDB",e[e.ELSE=223]="ELSE",e[e.ELSE_IF=224]="ELSE_IF",e[e.END_IF=225]="END_IF",e[e.FOR_CELL=226]="FOR_CELL",e[e.MEDIAN=227]="MEDIAN",e[e.SUMPRODUCT=228]="SUMPRODUCT",e[e.SINH=229]="SINH",e[e.COSH=230]="COSH",e[e.TANH=231]="TANH",e[e.ASINH=232]="ASINH",e[e.ACOSH=233]="ACOSH",e[e.ATANH=234]="ATANH",e[e.DGET=235]="DGET",e[e.CREATE_OBJECT=236]="CREATE_OBJECT",e[e.VOLATILE=237]="VOLATILE",e[e.LAST_ERROR=238]="LAST_ERROR",e[e.CUSTOM_UNDO=239]="CUSTOM_UNDO",e[e.CUSTOM_REPEAT=240]="CUSTOM_REPEAT",e[e.FORMULA_CONVERT=241]="FORMULA_CONVERT",e[e.GET_LINK_INFO=242]="GET_LINK_INFO",e[e.TEXT_BOX=243]="TEXT_BOX",e[e.INFO=244]="INFO",e[e.GROUP=245]="GROUP",e[e.GET_OBJECT=246]="GET_OBJECT",e[e.DB=247]="DB",e[e.PAUSE=248]="PAUSE",e[e.RESUME=251]="RESUME",e[e.FREQUENCY=252]="FREQUENCY",e[e.ADD_TOOLBAR=253]="ADD_TOOLBAR",e[e.DELETE_TOOLBAR=254]="DELETE_TOOLBAR",e[e._UDF=255]="_UDF",e[e.RESET_TOOLBAR=256]="RESET_TOOLBAR",e[e.EVALUATE=257]="EVALUATE",e[e.GET_TOOLBAR=258]="GET_TOOLBAR",e[e.GET_TOOL=259]="GET_TOOL",e[e.SPELLING_CHECK=260]="SPELLING_CHECK",e[e.ERROR_TYPE=261]="ERROR_TYPE",e[e.APP_TITLE=262]="APP_TITLE",e[e.WINDOW_TITLE=263]="WINDOW_TITLE",e[e.SAVE_TOOLBAR=264]="SAVE_TOOLBAR",e[e.ENABLE_TOOL=265]="ENABLE_TOOL",e[e.PRESS_TOOL=266]="PRESS_TOOL",e[e.REGISTER_ID=267]="REGISTER_ID",e[e.GET_PROJECT=268]="GET_PROJECT",e[e.AVEDEV=269]="AVEDEV",e[e.BETADIST=270]="BETADIST",e[e.GAMMALN=271]="GAMMALN",e[e.BETAINV=272]="BETAINV",e[e.BINOMDIST=273]="BINOMDIST",e[e.CHIDIST=274]="CHIDIST",e[e.CHIINV=275]="CHIINV",e[e.COMBIN=276]="COMBIN",e[e.CONFIDENCE=277]="CONFIDENCE",e[e.CRITBINOM=278]="CRITBINOM",e[e.EVEN=279]="EVEN",e[e.EXPONDIST=280]="EXPONDIST",e[e.FDIST=281]="FDIST",e[e.FINV=282]="FINV",e[e.FISHER=283]="FISHER",e[e.FISHERINV=284]="FISHERINV",e[e.FLOOR=285]="FLOOR",e[e.GAMMADIST=286]="GAMMADIST",e[e.GAMMAINV=287]="GAMMAINV",e[e.CEILING=288]="CEILING",e[e.HYPGEOMDIST=289]="HYPGEOMDIST",e[e.LOGNORMDIST=290]="LOGNORMDIST",e[e.LOGINV=291]="LOGINV",e[e.NEGBINOMDIST=292]="NEGBINOMDIST",e[e.NORMDIST=293]="NORMDIST",e[e.NORMSDIST=294]="NORMSDIST",e[e.NORMINV=295]="NORMINV",e[e.NORMSINV=296]="NORMSINV",e[e.STANDARDIZE=297]="STANDARDIZE",e[e.ODD=298]="ODD",e[e.PERMUT=299]="PERMUT",e[e.POISSON=300]="POISSON",e[e.TDIST=301]="TDIST",e[e.WEIBULL=302]="WEIBULL",e[e.SUMXMY2=303]="SUMXMY2",e[e.SUMX2MY2=304]="SUMX2MY2",e[e.SUMX2PY2=305]="SUMX2PY2",e[e.CHITEST=306]="CHITEST",e[e.CORREL=307]="CORREL",e[e.COVAR=308]="COVAR",e[e.FORECAST=309]="FORECAST",e[e.FTEST=310]="FTEST",e[e.INTERCEPT=311]="INTERCEPT",e[e.PEARSON=312]="PEARSON",e[e.RSQ=313]="RSQ",e[e.STEYX=314]="STEYX",e[e.SLOPE=315]="SLOPE",e[e.TTEST=316]="TTEST",e[e.PROB=317]="PROB",e[e.DEVSQ=318]="DEVSQ",e[e.GEOMEAN=319]="GEOMEAN",e[e.HARMEAN=320]="HARMEAN",e[e.SUMSQ=321]="SUMSQ",e[e.KURT=322]="KURT",e[e.SKEW=323]="SKEW",e[e.ZTEST=324]="ZTEST",e[e.LARGE=325]="LARGE",e[e.SMALL=326]="SMALL",e[e.QUARTILE=327]="QUARTILE",e[e.PERCENTILE=328]="PERCENTILE",e[e.PERCENTRANK=329]="PERCENTRANK",e[e.MODE=330]="MODE",e[e.TRIMMEAN=331]="TRIMMEAN",e[e.TINV=332]="TINV",e[e.MOVIE_COMMAND=334]="MOVIE_COMMAND",e[e.GET_MOVIE=335]="GET_MOVIE",e[e.CONCATENATE=336]="CONCATENATE",e[e.POWER=337]="POWER",e[e.SPREADBASE_DATA_FIELD=338]="SPREADBASE_DATA_FIELD",e[e.GET_VIEW=339]="GET_VIEW",e[e.GET_FIELD=340]="GET_FIELD",e[e.GET_ITEM=341]="GET_ITEM",e[e.RADIANS=342]="RADIANS",e[e.DEGREES=343]="DEGREES",e[e.SUBTOTAL=344]="SUBTOTAL",e[e.SUMIF=345]="SUMIF",e[e.COUNTIF=346]="COUNTIF",e[e.COUNTBLANK=347]="COUNTBLANK",e[e.SCENARIO_GET=348]="SCENARIO_GET",e[e.OPTIONS_LISTS=349]="OPTIONS_LISTS",e[e.ISPMT=350]="ISPMT",e[e.DATEDIF=351]="DATEDIF",e[e.DATESTRING=352]="DATESTRING",e[e.NUMBERSTRING=353]="NUMBERSTRING",e[e.ROMAN=354]="ROMAN",e[e.OPENDIALOG=355]="OPENDIALOG",e[e.SAVEDIALOG=356]="SAVEDIALOG",e[e.VIEW_GET=357]="VIEW_GET",e[e.GETPIVOTDATA=358]="GETPIVOTDATA",e[e.HYPERLINK=359]="HYPERLINK",e[e.FURIGANA=360]="FURIGANA",e[e.AVERAGEA=361]="AVERAGEA",e[e.MAXA=362]="MAXA",e[e.MINA=363]="MINA",e[e.STDEVPA=364]="STDEVPA",e[e.VARPA=365]="VARPA",e[e.STDEVA=366]="STDEVA",e[e.VARA=367]="VARA",e[e.BAHTTEXT=368]="BAHTTEXT",e[e.THAIDOW=369]="THAIDOW",e[e.THAIDIGIT=370]="THAIDIGIT",e[e.THAIMOY=371]="THAIMOY",e[e.THAINUMSOUND=372]="THAINUMSOUND",e[e.THAINUMSTRING=373]="THAINUMSTRING",e[e.THAISTRINGLENGTH=374]="THAISTRINGLENGTH",e[e.ISTHAIDIGIT=375]="ISTHAIDIGIT",e[e.ROUNDBAHTDOWN=376]="ROUNDBAHTDOWN",e[e.ROUNDBAHTUP=377]="ROUNDBAHTUP",e[e.THAIYEAR=378]="THAIYEAR",e[e.RTD=379]="RTD",e[e.CUBEVALUE=380]="CUBEVALUE",e[e.CUBEMEMBER=381]="CUBEMEMBER",e[e.CUBEMEMBERPROPERTY=382]="CUBEMEMBERPROPERTY",e[e.CUBERANKEDMEMBER=383]="CUBERANKEDMEMBER",e[e.HEX2BIN=384]="HEX2BIN",e[e.HEX2DEC=385]="HEX2DEC",e[e.HEX2OCT=386]="HEX2OCT",e[e.DEC2BIN=387]="DEC2BIN",e[e.DEC2HEX=388]="DEC2HEX",e[e.DEC2OCT=389]="DEC2OCT",e[e.OCT2BIN=390]="OCT2BIN",e[e.OCT2HEX=391]="OCT2HEX",e[e.OCT2DEC=392]="OCT2DEC",e[e.BIN2DEC=393]="BIN2DEC",e[e.BIN2OCT=394]="BIN2OCT",e[e.BIN2HEX=395]="BIN2HEX",e[e.IMSUB=396]="IMSUB",e[e.IMDIV=397]="IMDIV",e[e.IMPOWER=398]="IMPOWER",e[e.IMABS=399]="IMABS",e[e.IMSQRT=400]="IMSQRT",e[e.IMLN=401]="IMLN",e[e.IMLOG2=402]="IMLOG2",e[e.IMLOG10=403]="IMLOG10",e[e.IMSIN=404]="IMSIN",e[e.IMCOS=405]="IMCOS",e[e.IMEXP=406]="IMEXP",e[e.IMARGUMENT=407]="IMARGUMENT",e[e.IMCONJUGATE=408]="IMCONJUGATE",e[e.IMAGINARY=409]="IMAGINARY",e[e.IMREAL=410]="IMREAL",e[e.COMPLEX=411]="COMPLEX",e[e.IMSUM=412]="IMSUM",e[e.IMPRODUCT=413]="IMPRODUCT",e[e.SERIESSUM=414]="SERIESSUM",e[e.FACTDOUBLE=415]="FACTDOUBLE",e[e.SQRTPI=416]="SQRTPI",e[e.QUOTIENT=417]="QUOTIENT",e[e.DELTA=418]="DELTA",e[e.GESTEP=419]="GESTEP",e[e.ISEVEN=420]="ISEVEN",e[e.ISODD=421]="ISODD",e[e.MROUND=422]="MROUND",e[e.ERF=423]="ERF",e[e.ERFC=424]="ERFC",e[e.BESSELJ=425]="BESSELJ",e[e.BESSELK=426]="BESSELK",e[e.BESSELY=427]="BESSELY",e[e.BESSELI=428]="BESSELI",e[e.XIRR=429]="XIRR",e[e.XNPV=430]="XNPV",e[e.PRICEMAT=431]="PRICEMAT",e[e.YIELDMAT=432]="YIELDMAT",e[e.INTRATE=433]="INTRATE",e[e.RECEIVED=434]="RECEIVED",e[e.DISC=435]="DISC",e[e.PRICEDISC=436]="PRICEDISC",e[e.YIELDDISC=437]="YIELDDISC",e[e.TBILLEQ=438]="TBILLEQ",e[e.TBILLPRICE=439]="TBILLPRICE",e[e.TBILLYIELD=440]="TBILLYIELD",e[e.PRICE=441]="PRICE",e[e.YIELD=442]="YIELD",e[e.DOLLARDE=443]="DOLLARDE",e[e.DOLLARFR=444]="DOLLARFR",e[e.NOMINAL=445]="NOMINAL",e[e.EFFECT=446]="EFFECT",e[e.CUMPRINC=447]="CUMPRINC",e[e.CUMIPMT=448]="CUMIPMT",e[e.EDATE=449]="EDATE",e[e.EOMONTH=450]="EOMONTH",e[e.YEARFRAC=451]="YEARFRAC",e[e.COUPDAYBS=452]="COUPDAYBS",e[e.COUPDAYS=453]="COUPDAYS",e[e.COUPDAYSNC=454]="COUPDAYSNC",e[e.COUPNCD=455]="COUPNCD",e[e.COUPNUM=456]="COUPNUM",e[e.COUPPCD=457]="COUPPCD",e[e.DURATION=458]="DURATION",e[e.MDURATION=459]="MDURATION",e[e.ODDLPRICE=460]="ODDLPRICE",e[e.ODDLYIELD=461]="ODDLYIELD",e[e.ODDFPRICE=462]="ODDFPRICE",e[e.ODDFYIELD=463]="ODDFYIELD",e[e.RANDBETWEEN=464]="RANDBETWEEN",e[e.WEEKNUM=465]="WEEKNUM",e[e.AMORDEGRC=466]="AMORDEGRC",e[e.AMORLINC=467]="AMORLINC",e[e.CONVERT=468]="CONVERT",e[e.ACCRINT=469]="ACCRINT",e[e.ACCRINTM=470]="ACCRINTM",e[e.WORKDAY=471]="WORKDAY",e[e.NETWORKDAYS=472]="NETWORKDAYS",e[e.GCD=473]="GCD",e[e.MULTINOMIAL=474]="MULTINOMIAL",e[e.LCM=475]="LCM",e[e.FVSCHEDULE=476]="FVSCHEDULE",e[e.CUBEKPIMEMBER=477]="CUBEKPIMEMBER",e[e.CUBESET=478]="CUBESET",e[e.CUBESETCOUNT=479]="CUBESETCOUNT",e[e.IFERROR=480]="IFERROR",e[e.COUNTIFS=481]="COUNTIFS",e[e.SUMIFS=482]="SUMIFS",e[e.AVERAGEIF=483]="AVERAGEIF",e[e.AVERAGEIFS=484]="AVERAGEIFS",e[e.AGGREGATE=485]="AGGREGATE",e[e.BINOM_DIST=486]="BINOM_DIST",e[e.BINOM_INV=487]="BINOM_INV",e[e.CONFIDENCE_NORM=488]="CONFIDENCE_NORM",e[e.CONFIDENCE_T=489]="CONFIDENCE_T",e[e.CHISQ_TEST=490]="CHISQ_TEST",e[e.F_TEST=491]="F_TEST",e[e.COVARIANCE_P=492]="COVARIANCE_P",e[e.COVARIANCE_S=493]="COVARIANCE_S",e[e.EXPON_DIST=494]="EXPON_DIST",e[e.GAMMA_DIST=495]="GAMMA_DIST",e[e.GAMMA_INV=496]="GAMMA_INV",e[e.MODE_MULT=497]="MODE_MULT",e[e.MODE_SNGL=498]="MODE_SNGL",e[e.NORM_DIST=499]="NORM_DIST",e[e.NORM_INV=500]="NORM_INV",e[e.PERCENTILE_EXC=501]="PERCENTILE_EXC",e[e.PERCENTILE_INC=502]="PERCENTILE_INC",e[e.PERCENTRANK_EXC=503]="PERCENTRANK_EXC",e[e.PERCENTRANK_INC=504]="PERCENTRANK_INC",e[e.POISSON_DIST=505]="POISSON_DIST",e[e.QUARTILE_EXC=506]="QUARTILE_EXC",e[e.QUARTILE_INC=507]="QUARTILE_INC",e[e.RANK_AVG=508]="RANK_AVG",e[e.RANK_EQ=509]="RANK_EQ",e[e.STDEV_S=510]="STDEV_S",e[e.STDEV_P=511]="STDEV_P",e[e.T_DIST=512]="T_DIST",e[e.T_DIST_2T=513]="T_DIST_2T",e[e.T_DIST_RT=514]="T_DIST_RT",e[e.T_INV=515]="T_INV",e[e.T_INV_2T=516]="T_INV_2T",e[e.VAR_S=517]="VAR_S",e[e.VAR_P=518]="VAR_P",e[e.WEIBULL_DIST=519]="WEIBULL_DIST",e[e.NETWORKDAYS_INTL=520]="NETWORKDAYS_INTL",e[e.WORKDAY_INTL=521]="WORKDAY_INTL",e[e.ECMA_CEILING=522]="ECMA_CEILING",e[e.ISO_CEILING=523]="ISO_CEILING",e[e.BETA_DIST=525]="BETA_DIST",e[e.BETA_INV=526]="BETA_INV",e[e.CHISQ_DIST=527]="CHISQ_DIST",e[e.CHISQ_DIST_RT=528]="CHISQ_DIST_RT",e[e.CHISQ_INV=529]="CHISQ_INV",e[e.CHISQ_INV_RT=530]="CHISQ_INV_RT",e[e.F_DIST=531]="F_DIST",e[e.F_DIST_RT=532]="F_DIST_RT",e[e.F_INV=533]="F_INV",e[e.F_INV_RT=534]="F_INV_RT",e[e.HYPGEOM_DIST=535]="HYPGEOM_DIST",e[e.LOGNORM_DIST=536]="LOGNORM_DIST",e[e.LOGNORM_INV=537]="LOGNORM_INV",e[e.NEGBINOM_DIST=538]="NEGBINOM_DIST",e[e.NORM_S_DIST=539]="NORM_S_DIST",e[e.NORM_S_INV=540]="NORM_S_INV",e[e.T_TEST=541]="T_TEST",e[e.Z_TEST=542]="Z_TEST",e[e.ERF_PRECISE=543]="ERF_PRECISE",e[e.ERFC_PRECISE=544]="ERFC_PRECISE",e[e.GAMMALN_PRECISE=545]="GAMMALN_PRECISE",e[e.CEILING_PRECISE=546]="CEILING_PRECISE",e[e.FLOOR_PRECISE=547]="FLOOR_PRECISE",e[e.ACOT=548]="ACOT",e[e.ACOTH=549]="ACOTH",e[e.COT=550]="COT",e[e.COTH=551]="COTH",e[e.CSC=552]="CSC",e[e.CSCH=553]="CSCH",e[e.SEC=554]="SEC",e[e.SECH=555]="SECH",e[e.IMTAN=556]="IMTAN",e[e.IMCOT=557]="IMCOT",e[e.IMCSC=558]="IMCSC",e[e.IMCSCH=559]="IMCSCH",e[e.IMSEC=560]="IMSEC",e[e.IMSECH=561]="IMSECH",e[e.BITAND=562]="BITAND",e[e.BITOR=563]="BITOR",e[e.BITXOR=564]="BITXOR",e[e.BITLSHIFT=565]="BITLSHIFT",e[e.BITRSHIFT=566]="BITRSHIFT",e[e.PERMUTATIONA=567]="PERMUTATIONA",e[e.COMBINA=568]="COMBINA",e[e.XOR=569]="XOR",e[e.PDURATION=570]="PDURATION",e[e.BASE=571]="BASE",e[e.DECIMAL=572]="DECIMAL",e[e.DAYS=573]="DAYS",e[e.BINOM_DIST_RANGE=574]="BINOM_DIST_RANGE",e[e.GAMMA=575]="GAMMA",e[e.SKEW_P=576]="SKEW_P",e[e.GAUSS=577]="GAUSS",e[e.PHI=578]="PHI",e[e.RRI=579]="RRI",e[e.UNICHAR=580]="UNICHAR",e[e.UNICODE=581]="UNICODE",e[e.MUNIT=582]="MUNIT",e[e.ARABIC=583]="ARABIC",e[e.ISOWEEKNUM=584]="ISOWEEKNUM",e[e.NUMBERVALUE=585]="NUMBERVALUE",e[e.SHEET=586]="SHEET",e[e.SHEETS=587]="SHEETS",e[e.FORMULATEXT=588]="FORMULATEXT",e[e.ISFORMULA=589]="ISFORMULA",e[e.IFNA=590]="IFNA",e[e.CEILING_MATH=591]="CEILING_MATH",e[e.FLOOR_MATH=592]="FLOOR_MATH",e[e.IMSINH=593]="IMSINH",e[e.IMCOSH=594]="IMCOSH",e[e.FILTERXML=595]="FILTERXML",e[e.WEBSERVICE=596]="WEBSERVICE",e[e.ENCODEURL=597]="ENCODEURL",e[e.FORECAST_ETS=598]="FORECAST_ETS",e[e.FORECAST_ETS_CONFINT=599]="FORECAST_ETS_CONFINT",e[e.FORECAST_ETS_SEASONALITY=600]="FORECAST_ETS_SEASONALITY",e[e.FORECAST_LINEAR=601]="FORECAST_LINEAR",e[e.FORECAST_ETS_STAT=602]="FORECAST_ETS_STAT",e[e.MAXIFS=603]="MAXIFS",e[e.MINIFS=604]="MINIFS",e[e.TEXTJOIN=605]="TEXTJOIN",e[e.CONCAT=606]="CONCAT",e[e.IFS=607]="IFS",e[e.SWITCH=608]="SWITCH",e[e.SINGLE=609]="SINGLE",e[e.AVERAGE_WEIGHTED=610]="AVERAGE_WEIGHTED",e[e.ANCHORARRAY=611]="ANCHORARRAY",e[e._FV=612]="_FV",e[e.FIELDVALUE=613]="FIELDVALUE",e[e.FILTER=614]="FILTER",e[e.SORT=615]="SORT",e[e.UNIQUE=616]="UNIQUE",e[e.RICHSEARCH=617]="RICHSEARCH",e[e.LARGEPROPERTY=618]="LARGEPROPERTY",e[e.SMALLPROPERTY=619]="SMALLPROPERTY",e[e.AVERAGEPROPERTY=620]="AVERAGEPROPERTY",e[e.FINDN=621]="FINDN",e[e.TEXTSLICE=622]="TEXTSLICE",e[e.TEXTBEFORE=623]="TEXTBEFORE",e[e.TEXTAFTER=624]="TEXTAFTER",e[e.TEXTSPLIT=625]="TEXTSPLIT",e[e._SORT=626]="_SORT",e[e._ONEDARRAY=627]="_ONEDARRAY",e[e.XMATCH=628]="XMATCH",e[e.XLOOKUP=629]="XLOOKUP",e[e.SORTBY=630]="SORTBY",e[e.RANDARRAY=631]="RANDARRAY",e[e.SEQUENCE=632]="SEQUENCE",e[e.STOCKHISTORY=633]="STOCKHISTORY",e[e.WRAPROWS=634]="WRAPROWS",e[e.VSTACK=635]="VSTACK",e[e.HSTACK=636]="HSTACK",e[e.CHOOSEROWS=637]="CHOOSEROWS",e[e.CHOOSECOLS=638]="CHOOSECOLS",e[e.LET=639]="LET",e[e.LAMBDA=640]="LAMBDA",e[e.MAKEARRAY=641]="MAKEARRAY",e[e.APPLY=642]="APPLY",e[e.ISLAMBDA=643]="ISLAMBDA",e[e.ARITY=644]="ARITY",e[e.RECURSE=645]="RECURSE",e[e.RECORD=646]="RECORD",e[e.VALUETOTEXT=647]="VALUETOTEXT",e[e.ARRAYTOTEXT=648]="ARRAYTOTEXT",e[e.FORMATTEDNUMBER=649]="FORMATTEDNUMBER",e[e.TOCOL=650]="TOCOL",e[e.TOROW=651]="TOROW",e[e.WRAPCOLS=652]="WRAPCOLS",e[e.MAP=653]="MAP",e[e.REDUCE=654]="REDUCE",e[e.SCAN=655]="SCAN",e[e.BYROW=656]="BYROW",e[e.BYCOL=657]="BYCOL",e[e.ISOMITTED=658]="ISOMITTED",e[e.EXPAND=659]="EXPAND",e[e.TAKE=660]="TAKE",e[e.DROP=661]="DROP",e[e.PY=662]="PY",e[e.IMAGE=664]="IMAGE",e[e.TESTFUNCTIONBEGIN=665]="TESTFUNCTIONBEGIN",e[e.GRF=666]="GRF",e[e.UNIT=667]="UNIT",e[e.RICHERROR=668]="RICHERROR",e[e.COUNTER=669]="COUNTER",e[e.BROKENRECORD=670]="BROKENRECORD",e[e.STREAM=671]="STREAM",e[e.GETRICHERRORS=672]="GETRICHERRORS",e[e.DBGSTAT=673]="DBGSTAT",e[e.RICHNUMBER=674]="RICHNUMBER",e[e.RICHERNUMBER=675]="RICHERNUMBER",e[e.DBGWRITE=676]="DBGWRITE",e[e.TEST=677]="TEST",e[e.AAC=678]="AAC",e[e.AWC=679]="AWC",e[e._FCN_IMAGEWEBADDRESS=680]="_FCN_IMAGEWEBADDRESS",e[e.PARSEDEXPRESSION=681]="PARSEDEXPRESSION",e[e._FCN_CONTACTAGE=682]="_FCN_CONTACTAGE",e[e._FCN_CONTACTFIRSTNAME=683]="_FCN_CONTACTFIRSTNAME",e[e._FCN_CONTACTFULLNAME=684]="_FCN_CONTACTFULLNAME",e[e._FCN_CONTACTLASTNAME=685]="_FCN_CONTACTLASTNAME",e[e._FCN_CONTACTTRANSLATENAME=686]="_FCN_CONTACTTRANSLATENAME",e[e.ARRAYVALUE=687]="ARRAYVALUE",e[e.LETREC=750]="LETREC",e[e.NESTEDRECORD=751]="NESTEDRECORD"}(n||(n={}));var i=[[255,"255"],[268,"GET.WORKBOOK"],[349,"OPTIONS.LISTS.GET"],[355,"OPEN.DIALOG"],[356,"SAVE.DIALOG"],[360,"PHONETIC"],[369,"THAIDAYOFWEEK"],[371,"THAIMONTHOFYEAR"],[612,"_FV"],[626,"_SORT"],[627,"_ONEDARRAY"],[680,"IMAGEWEBADDRESS"],[682,"CONTACTAGE"],[683,"CONTACTFIRSTNAME"],[684,"CONTACTFULLNAME"],[685,"CONTACTLASTNAME"],[686,"CONTACTTRANSLATENAME"]].reduce((function(e,t){return e[t[0]]=t[1],e}),[]),o=[],c=[[1,255,o,[57],o,1,0,16],[1,3,[36,831,831],o,o,823,0,0],[1,1,[15],o,o,4,0,0],[1,1,[15],o,o,4,0,0],[1,255,o,[305],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[0,1,[16],o,o,33,0,0],[0,1,[16],o,o,33,0,0],[0,0,o,o,o,3,0,16],[2,255,[1],[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,2,[1,1],o,o,2,0,0],[1,3,[1,65,4],o,o,2,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[0,0,o,o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,3,[263,48,48],o,o,263,0,0],[2,4,[48,1,1,1],o,o,311,0,0],[2,2,[2,1],o,o,2,0,0],[3,3,[2,1,1],o,o,2,0,0],[1,1,[2],o,o,1,0,0],[1,1,[7],o,o,1,0,0],[0,0,o,o,o,4,0,16],[0,0,o,o,o,4,0,16],[1,255,o,[52],o,4,0,16],[1,255,o,[52],o,4,0,16],[1,1,[4],o,o,4,0,16],[2,2,[1,1],o,o,1,0,0],[3,3,[16,83,18],o,o,1,0,0],[3,3,[16,19,18],o,o,1,0,0],[3,3,[16,19,18],o,o,1,0,0],[3,3,[16,19,18],o,o,1,0,0],[3,3,[16,19,18],o,o,1,0,0],[3,3,[16,19,18],o,o,1,0,0],[1,255,o,[49],o,1,0,16],[3,3,[16,19,18],o,o,1,0,0],[2,2,[263,2],o,o,2,0,0],[1,4,[48,112,84,84],o,o,32,0,0],[1,4,[48,112,112,84],o,o,32,0,0],[1,4,[48,112,84,84],o,o,32,0,0],[1,4,[48,112,112,84],o,o,32,0,0],[1,1,[16],o,o,512,0,2],[0,1,[4],o,o,512,0,2],[0,1,[575],o,o,512,0,2],[3,5,[1,1,1,1,1],o,o,1,0,0],[3,5,[1,1,1,1,1],o,o,1,0,0],[3,5,[1,1,1,1,1],o,o,1,0,0],[3,5,[1,1,1,1,1],o,o,1,0,0],[3,6,[1,1,1,1,1,1],o,o,1,0,0],[3,3,[48,1,1],o,o,1,0,16],[1,2,[48,1],o,o,1,0,0],[0,0,o,o,o,1,16383,0],[2,3,[263,305,17],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,2,[1,1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[0,0,o,o,o,1,16383,0],[1,1,[16],o,o,1,0,0],[1,1,[48],o,o,1,0,0],[1,1,[48],o,o,1,0,0],[3,5,[16,65,65,65,65],o,o,16,16383,0],[2,2,[2,16],o,o,16,0,2],[2,2,[16,16],o,o,2,0,2],[0,3,[66,81,16],o,o,4,0,2],[2,3,[2,2,1],o,o,1,0,0],[1,1,[39],o,o,32,0,0],[0,2,[1,24],o,o,4,0,2],[0,0,o,o,o,4,0,2],[1,1,[303],o,o,1,0,0],[0,1,[4],o,o,4,0,2],[1,2,[2,63],o,o,4,0,2],[0,0,o,o,o,50,0,2],[1,1,[16],o,o,47,0,2],[0,2,[65,66],o,o,32,0,2],[4,5,[87,117,117,1,117],o,o,4,0,0],[0,2,[1,66],o,o,32,0,2],[0,0,o,o,o,16,0,2],[0,0,o,o,o,16,0,2],[0,1,[1],o,o,4,0,2],[2,2,[1,1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[2,255,[33],[831],o,823,0,0],[3,4,[263,49,49,4],o,o,295,0,0],[3,4,[263,49,49,4],o,o,295,0,0],[0,2,[66,65],o,o,32,0,2],[1,7,[2,65,66,67,65,65,2],o,o,575,0,2],[1,1,[63],o,o,4,0,0],[1,1,[18],o,o,2,0,2],[1,2,[2,4],o,o,6,0,2],[2,2,[16,47],o,o,4,0,2],[1,2,[1,1],o,o,1,0,0],[1,4,[2,1,4,4],o,o,7,0,2],[1,1,[1],o,o,2,0,0],[1,1,[2],o,o,2,0,0],[1,1,[2],o,o,2,0,0],[1,1,[2],o,o,2,0,0],[1,2,[2,9],o,o,2,0,0],[1,2,[2,9],o,o,2,0,0],[2,2,[258,258],o,o,4,0,0],[1,1,[2],o,o,2,0,0],[4,4,[2,1,1,2],o,o,2,0,0],[3,4,[2,2,2,2],o,o,2,0,0],[1,1,[2],o,o,1,0,0],[0,3,[66,65,66],o,o,32,0,2],[0,1,[2],o,o,2,0,2],[2,3,[2,2,1],o,o,1,0,0],[1,2,[2,16],o,o,303,16383,0],[1,1,[15],o,o,4,0,0],[1,1,[143],o,o,4,0,0],[1,1,[143],o,o,4,0,0],[1,1,[143],o,o,4,0,0],[1,1,[23],o,o,2,0,0],[1,1,[23],o,o,1,0,0],[1,2,[2,1],o,o,1,0,2],[1,1,[1],o,o,1,0,2],[1,1,[1],o,o,1,0,2],[1,1,[1],o,o,2,0,2],[2,2,[1,1],o,o,2,0,2],[2,2,[1,2],o,o,1,0,2],[2,2,[1,2],o,o,1,0,2],[1,2,[1,1],o,o,1,0,2],[1,1,[3],o,o,1,0,0],[1,1,[3],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[4,4,[1,1,1,1],o,o,1,0,0],[4,5,[1,1,1,1,1],o,o,1,0,0],[1,3,[2,66,65],o,o,2,0,2],[1,2,[16,4],o,o,2,0,2],[1,2,[2,4],o,o,16,0,2],[1,2,[2,4],o,o,16,16383,0],[1,255,[2,3,66,66,66,65,67,66,67],[66],o,3,0,2],[1,255,[3],[127],o,575,0,2],[0,1,[3],o,o,1,0,2],[2,4,[3,115,83,3],o,o,1,0,2],[3,5,[3,83,115,83,3],o,o,1,0,2],[4,5,[3,3,3,4,3],o,o,4,0,2],[4,5,[3,3,3,4,3],o,o,4,0,2],[4,5,[3,3,3,3,3],o,o,4,0,2],[0,1,[3],o,o,4,0,2],[2,3,[3,3,3],o,o,4,0,2],[3,4,[3,3,3,3],o,o,4,0,2],[1,3,[1,67,66],o,o,1,0,2],[1,1,[52],o,o,36,0,2],[1,1,[2],o,o,2,0,0],[1,1,[32],o,o,1,0,0],[1,1,[32],o,o,32,0,0],[2,2,[32,32],o,o,32,0,0],[0,2,[2,2],o,o,32,0,2],[4,6,[1,1,1,1,1,1],o,o,1,0,0],[4,6,[1,1,1,1,1,1],o,o,1,0,0],[1,255,o,[121],o,1,0,16],[0,2,[1,16],o,o,4,0,2],[3,4,[2,1,1,1],o,o,512,0,2],[1,1,[4],o,o,512,0,2],[0,0,o,o,o,512,0,2],[0,0,o,o,o,512,0,2],[2,2,[2,2],o,o,1,0,2],[2,2,[1,2],o,o,32,0,2],[3,3,[1,18,18],o,o,4,0,2],[2,2,[1,2],o,o,4,0,2],[1,1,[1],o,o,4,0,2],[0,1,[1],o,o,512,0,2],[0,1,[2],o,o,4,0,2],[0,4,[3,3,3,3],o,o,3,0,2],[1,255,o,[113],o,1,0,16],[1,1,[1],o,o,1,0,0],[1,2,[1,16],o,o,47,0,2],[1,1,[1],o,o,47,0,2],[1,2,[1,2],o,o,47,0,2],[1,2,[1,2],o,o,63,0,2],[3,3,[16,19,18],o,o,1,0,0],[1,1,[143],o,o,4,0,0],[0,3,[82,65,65],o,o,2,0,2],[0,4,[66,82,17,17],o,o,1,0,2],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[3,3,[16,19,18],o,o,1,0,0],[3,3,[16,19,18],o,o,1,0,0],[1,2,[1,1],o,o,1,0,0],[1,1,[143],o,o,4,0,0],[3,3,[16,83,18],o,o,1,0,0],[1,1,[3],o,o,4,0,2],[1,1,[3],o,o,4,0,2],void 0,void 0,[1,2,[1,1],o,o,2,0,0],[2,3,[2,2,1],o,o,1,0,0],[2,3,[2,2,1],o,o,1,0,0],[4,4,[2,1,1,2],o,o,2,0,0],[1,2,[2,9],o,o,2,0,0],[1,2,[2,9],o,o,2,0,0],[3,3,[2,1,1],o,o,2,0,0],[1,1,[2],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[1,1,[2],o,o,2,0,0],[1,1,[2],o,o,2,0,0],[2,3,[1,16,4],o,o,1,0,16],void 0,void 0,[2,5,[1,65,65,68,66],o,o,2,0,0],[2,3,[1,1,4],o,o,1,0,0],[0,0,o,o,o,1,16383,0],[5,7,[1,1,1,1,1,1,4],o,o,1,0,0],[0,0,o,o,o,512,0,2],[1,1,[12],o,o,512,0,2],[0,0,o,o,o,512,0,2],[1,3,[2,82,84],o,o,512,0,2],[1,255,o,[49],o,1,0,16],[1,255,o,[32],o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[3,3,[16,19,18],o,o,263,0,0],[2,11,[1,18,17,17,18,17,17,115,84,21,17],o,o,2,0,2],[0,1,[4],o,o,4,0,2],[0,0,o,o,o,16,0,2],[0,2,[2,2],o,o,4,0,2],[0,3,[2,2,2],o,o,4,0,2],[2,5,[2,23,23,23,23],o,o,2,0,2],[2,4,[2,1,1,2],o,o,1,0,2],[1,4,[2,66,65,65],o,o,1,0,2],[1,1,[2],o,o,3,16383,0],[0,0,o,o,o,2,0,2],[1,5,[1,2,1,1,1],o,o,47,0,2],[4,5,[1,1,1,1,1],o,o,1,0,0],[0,1,[4],o,o,512,0,2],void 0,void 0,[0,1,[1],o,o,512,0,2],[2,2,[48,48],o,o,32,0,16],[0,2,[66,96],o,o,2,0,2],[1,1,[2],o,o,4,0,2],[1,255,[17],[127],o,575,0,0],[1,1,[3],o,o,4,0,2],[1,1,[2],o,o,63,0,2],[1,2,[1,3],o,o,47,0,2],[1,3,[1,3,1],o,o,47,0,2],[1,3,[2,66,4],o,o,4,0,2],[1,1,[15],o,o,1,0,0],[0,1,[2],o,o,4,0,2],[0,1,[2],o,o,4,0,2],[0,2,[99,66],o,o,4,0,2],[3,3,[3,1,4],o,o,4,0,2],[3,3,[3,1,4],o,o,4,0,2],[2,3,[2,3,66],o,o,1,0,2],[1,2,[1,2],o,o,35,0,2],[1,255,o,[49],o,1,0,16],[3,5,[1,1,1,65,65],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[3,5,[1,1,1,65,65],o,o,1,0,0],[4,4,[1,1,1,4],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[3,3,[1,1,4],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[4,4,[1,1,1,4],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[4,4,[1,1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[4,4,[1,1,1,4],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[3,3,[1,1,4],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[4,4,[1,1,1,4],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[3,3,[1,32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[4,4,[32,32,1,1],o,o,1,0,0],[3,4,[32,32,1,65],o,o,1,0,0],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[2,3,[49,1,1],o,o,1,0,16],[2,2,[49,1],o,o,1,0,16],[2,2,[49,1],o,o,1,0,16],[2,2,[49,1],o,o,1,0,16],[2,2,[49,1],o,o,1,0,16],[2,3,[49,1,65],o,o,1,0,16],[1,255,o,[32],o,1,0,16],[2,2,[49,1],o,o,1,0,16],[2,2,[1,1],o,o,1,0,0],void 0,[3,4,[2,1,1,1],o,o,1,0,2],[2,3,[2,1,1],o,o,1,0,2],[1,255,o,[2],o,2,0,0],[2,2,[1,1],o,o,1,0,0],[2,9,[66,2,66,65,65,65,66,66,66],o,o,2,0,2],[1,2,[1,2],o,o,35,0,2],[1,3,[1,66,2],o,o,35,0,2],[1,4,[1,66,66,2],o,o,7,0,2],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[2,255,[1],[16],o,1,0,0],[2,3,[16,15,16],o,o,1,0,0],[2,2,[16,15],o,o,1,0,0],[1,1,[16],o,o,1,0,0],[1,2,[1,2],o,o,19,0,2],[1,1,[33],o,o,33,0,2],[4,4,[1,1,1,1],o,o,1,0,0],[3,3,[1,1,2],o,o,1,0,0],[1,1,[1],o,o,2,0,0],[2,2,[1,1],o,o,2,0,0],[1,2,[1,5],o,o,2,0,0],[0,4,[66,66,66,65],o,o,6,0,2],[0,5,[66,66,66,66,65],o,o,6,0,2],[1,2,[1,2],o,o,19,0,2],[2,255,[18,18],[2,79],o,15,0,0],[1,2,[2,39],o,o,39,0,0],[1,1,[16],o,o,2,0,0],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,255,o,[49],o,1,0,16],[1,1,[1],o,o,2,0,0],[1,1,[1],o,o,2,0,0],[1,1,[3],o,o,2,0,0],[1,1,[1],o,o,2,0,0],[1,1,[1],o,o,2,0,0],[1,1,[1],o,o,2,0,0],[1,1,[2],o,o,1,0,0],[1,1,[2],o,o,4,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[3,255,o,[2],o,2,0,0],[1,255,[2],[50],o,15,0,0],[2,3,[2,50,2],o,o,10,0,0],[3,3,[2,2,2],o,o,15,0,0],[3,4,[2,2,1,2],o,o,10,0,0],[1,2,[95,95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[2,3,[95,95,95],o,o,9,0,0],[1,255,o,[127],o,9,0,0],[1,255,o,[127],o,9,0,0],[4,4,[95,95,95,127],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[1,2,[95,95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,3,[127,127,95],o,o,9,0,0],[3,3,[95,127,127],o,o,9,0,0],[5,6,[95,95,95,95,95,95],o,o,9,0,0],[5,6,[95,95,95,95,95,95],o,o,9,0,0],[4,5,[95,95,95,95,95],o,o,9,0,0],[4,5,[95,95,95,95,95],o,o,9,0,0],[4,5,[95,95,95,95,95],o,o,9,0,0],[4,5,[95,95,95,95,95],o,o,9,0,0],[4,5,[95,95,95,95,95],o,o,9,0,0],[3,3,[95,95,95],o,o,9,0,0],[3,3,[95,95,95],o,o,9,0,0],[3,3,[95,95,95],o,o,9,0,0],[6,7,[95,95,95,95,95,95,95],o,o,9,0,0],[6,7,[95,95,95,95,95,95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[6,6,[95,95,95,95,95,95],o,o,9,0,0],[6,6,[95,95,95,95,95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,0,0],[2,3,[95,95,95],o,o,9,0,0],[3,4,[95,95,95,95],o,o,9,0,0],[3,4,[95,95,95,95],o,o,9,0,0],[3,4,[95,95,95,95],o,o,9,0,0],[3,4,[95,95,95,95],o,o,9,0,0],[3,4,[95,95,95,95],o,o,9,0,0],[3,4,[95,95,95,95],o,o,9,0,0],[5,6,[95,95,95,95,95,95],o,o,9,0,0],[5,6,[95,95,95,95,95,95],o,o,9,0,0],[7,8,[95,95,95,95,95,95,95,95],o,o,9,0,0],[7,8,[95,95,95,95,95,95,95,95],o,o,9,0,0],[8,9,[95,95,95,95,95,95,95,95,95],o,o,9,0,0],[8,9,[95,95,95,95,95,95,95,95,95],o,o,9,0,0],[2,2,[95,95],o,o,9,16383,0],[1,2,[95,95],o,o,9,0,0],[6,7,[95,95,95,95,95,95,95],o,o,9,0,0],[6,7,[95,95,95,95,95,95,95],o,o,9,0,0],[3,3,[95,95,95],o,o,9,0,0],[6,8,[95,95,95,95,95,95,95,95],o,o,9,0,0],[4,5,[95,95,95,95,95],o,o,9,0,0],[2,3,[95,95,127],o,o,9,0,0],[2,3,[95,95,127],o,o,9,0,0],[1,255,o,[127],o,9,0,0],[1,255,o,[127],o,9,0,0],[1,255,o,[127],o,9,0,0],[2,2,[95,127],o,o,9,0,0],[3,4,[2,2,1,2],o,o,10,0,0],[2,5,[2,50,2,1,2],o,o,10,0,0],[1,1,[2],o,o,9,0,0],[2,2,[47,575],o,o,303,0,0],[2,255,o,[16,15],o,1,0,0],[3,255,[16],[16,15],o,1,0,0],[2,3,[16,15,16],o,o,1,0,0],[3,255,[16],[16,15],o,1,0,0],[3,254,[1,1,48,17],[16],o,1,0,0],[4,4,[1,1,1,4],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[2,2,[32,32],o,o,1,0,0],[3,3,[1,1,4],o,o,1,0,0],[4,4,[1,1,1,4],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[1,254,o,[32],o,32,0,16],[1,254,o,[32],o,1,0,16],[4,4,[1,1,1,4],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[2,2,[49,1],o,o,1,0,16],[2,2,[49,1],o,o,1,0,16],[2,3,[49,1,65],o,o,1,0,16],[2,3,[49,1,65],o,o,1,0,16],[3,3,[1,1,4],o,o,1,0,0],[2,2,[49,1],o,o,1,0,16],[2,2,[49,1],o,o,1,0,16],[2,3,[1,16,4],o,o,1,0,16],[2,3,[1,16,4],o,o,1,0,16],[1,254,o,[49],o,1,0,16],[1,254,o,[49],o,1,0,16],[3,3,[1,1,4],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[1,254,o,[49],o,1,0,16],[1,254,o,[49],o,1,0,16],[4,4,[1,1,1,4],o,o,1,0,0],[2,4,[95,95,75,127],o,o,9,0,0],[2,4,[95,95,75,127],o,o,9,0,0],[2,2,[1,1],o,o,1,0,0],[1,2,[1,65],o,o,1,0,0],void 0,[4,6,[1,1,1,4,65,65],o,o,1,0,0],[3,5,[1,1,1,65,65],o,o,1,0,0],[3,3,[1,1,4],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[4,4,[1,1,1,4],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[5,5,[1,1,1,1,4],o,o,1,0,0],[4,4,[1,1,1,4],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[4,4,[1,1,1,4],o,o,1,0,0],[2,2,[1,4],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[4,4,[32,32,1,1],o,o,1,0,0],[2,3,[49,1,1],o,o,1,0,16],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[1],o,o,1,0,0],[1,2,[1,65],o,o,1,0,0],[1,2,[1,65],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[2,2,[1,1],o,o,1,0,0],[1,254,o,[52],o,4,0,16],[3,3,[1,1,1],o,o,1,0,0],[2,3,[1,1,65],o,o,2,0,0],[2,2,[2,1],o,o,1,0,0],[2,2,[3,3],o,o,1,0,0],[3,4,[1,1,1,65],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,254,o,[49],o,1,0,16],[1,1,[1],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[3,3,[1,1,1],o,o,1,0,0],[1,1,[1],o,o,2,0,0],[1,1,[2],o,o,1,0,0],[1,1,[1],o,o,32,0,0],[1,1,[2],o,o,1,0,0],[1,1,[1],o,o,1,0,0],[1,3,[2,66,66],o,o,1,0,0],[0,1,[50],o,o,1,16383,16],[0,1,[48],o,o,1,16383,16],[1,1,[16],o,o,2,16383,0],[1,1,[16],o,o,4,0,0],[2,2,[47,575],o,o,303,0,0],[1,3,[1,65,65],o,o,1,0,0],[1,3,[1,65,65],o,o,1,0,0],[1,1,[95],o,o,9,0,0],[1,1,[95],o,o,9,0,0],[2,2,[2,2],o,o,47,0,0],[1,1,[2],o,o,10,0,0],[1,1,[2],o,o,10,0,0],[3,6,[1,48,48,65,65,65],o,o,1,0,0],[3,7,[1,48,48,65,65,65,65],o,o,1,0,0],[2,4,[48,48,65,65],o,o,1,0,0],[3,3,[1,32,32],o,o,1,0,0],[3,6,[48,48,1,65,65,65],o,o,1,0,0],[3,254,[16],[16,15],o,1,0,0],[3,254,[16],[16,15],o,1,0,0],[3,254,[114,68],[114],o,2,0,16],[1,254,o,[114],o,2,0,16],[2,254,o,[44,575],o,831,0,0],[3,254,[47],[575,575],[575],831,0,0],[1,1,[1527],o,o,1503,0,21],[2,254,o,[113,113],o,1,0,17],[1,1,[16],o,o,48,0,21],[2,3,[271,2,4],o,o,303,0,21],[2,2,[271,2],o,o,303,0,17],[2,3,[48,48,111],o,o,303,0,1],[1,4,[160,96,96,4],o,o,32,0,1],[1,3,[160,4,4],o,o,32,0,1],[2,2,[2,256],o,o,1,0,8],[3,3,[2,49,1],o,o,1,0,25],[3,3,[2,49,1],o,o,1,0,25],[2,254,[2],[49],o,1,0,25],[2,5,[34,2,65,68,68],o,o,1,0,1],[1,3,[2,65,65],o,o,2,0,1],[2,4,[2,34,65,68],o,o,2,0,1],[2,4,[2,34,65,68],o,o,2,0,1],[2,5,[2,98,98,68,495],o,o,32,0,1],[1,4,[32,96,96,4],o,o,32,0,9],[2,2,[4,16],o,o,32,0,25],[2,4,[391,48,65,65],o,o,1,0,1],[3,6,[391,48,48,511,65,65],o,o,319,0,1],[2,254,[160],[160,65],o,32,0,1],[0,5,[65,65,65,65,68],o,o,32,16383,1],[1,4,[65,65,65,65],o,o,32,0,1],[2,254,[258,1,65,65,65],[65],o,32,0,17],[2,3,[32,1,463],o,o,32,0,1],[1,254,[48],[48],o,32,0,17],[1,254,[48],[48],o,32,0,17],[2,254,[48,33],[33],o,32,0,1],[2,254,[48,33],[33],o,32,0,1],[3,254,o,[319,319],[319],319,0,1],[1,254,o,[319],o,319,0,1],[3,3,[65,65,319],o,o,32,0,1],[1,254,o,[319],o,319,0,1],[1,1,[319],o,o,4,0,1],[1,1,[319],o,o,9,0,1],[0,0,o,o,o,319,0,1],[3,254,[15],[2,47],o,303,0,17],[1,2,[399,1],o,o,2,0,1],[1,2,[32,1],o,o,2,0,1],[2,2,[15,2],o,o,256,0,17],[1,3,[48,65,68],o,o,32,0,17],[1,3,[48,65,68],o,o,32,0,17],[2,3,[32,1,463],o,o,32,0,1],[2,254,[48],[319],o,32,0,1],[3,3,[511,48,271],o,o,319,0,1],[3,3,[511,48,271],o,o,32,0,1],[1,2,[48,271],o,o,32,0,1],[1,2,[48,271],o,o,32,0,1],[1,1,[1535],o,o,4,0,1],[2,4,[32,65,65,495],o,o,32,0,1],[2,3,[48,65,65],o,o,48,0,1],[2,3,[48,65,65],o,o,48,0,1],[1,254,[1],[48],o,1087,0,17],void 0,[1,5,[2,66,65,65,65],o,o,264,0,1],[0,0,o,o,o,1,0,1],[1,2,[287,2],o,o,288,0,17],[2,2,[15,2],o,o,271,0,17],[1,2,[1,1],o,o,10,0,17],[0,0,o,o,o,1,0,1],[3,254,[47],[2,47],o,47,0,17],[0,1,[1],o,o,1,0,1],[0,1,[1],o,o,32,0,1],[1,2,[2,1],o,o,47,0,1],[1,1,[1],o,o,264,0,17],[1,1,[1],o,o,264,0,17],[2,2,[2,47],o,o,47,0,1],[1,254,[2],[1151],o,1087,0,16],[1,254,[1],[1151],o,1087,0,0],[1,254,[1],[1151],o,1087,0,0],[1,1,[256],o,o,258,0,17],[1,1,[16],o,o,32,0,1],[1,1,[256],o,o,2,0,17],[1,1,[256],o,o,2,0,17],[1,1,[256],o,o,2,0,17],[1,1,[256],o,o,2,0,17],[2,2,[256,2],o,o,2,0,17],[1,1,[32],o,o,256,0,17],void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,[3,254,o,[319,319],[319],319,0,1],[3,254,[15],[2,303],o,303,0,17]].map((function(e){return void 0===e?void 0:a.e.apply(void 0,e)}))},function(e,t,r){"use strict";r.d(t,"c",(function(){return j})),r.d(t,"k",(function(){return y})),r.d(t,"b",(function(){return g})),r.d(t,"d",(function(){return S})),r.d(t,"f",(function(){return C})),r.d(t,"l",(function(){return E})),r.d(t,"e",(function(){return A})),r.d(t,"g",(function(){return N})),r.d(t,"n",(function(){return T})),r.d(t,"m",(function(){return I})),r.d(t,"j",(function(){return D})),r.d(t,"h",(function(){return x})),r.d(t,"o",(function(){return L})),r.d(t,"i",(function(){return B})),r.d(t,"a",(function(){return H}));var n=r(9),a=r(28),i=r(3),o=r(12),c=r(7),u=r(26),s=r(75),l=r(10),d=r(32),f=r(24),b=r(40),h=r(16),v=r(0),p=r(18);function m(e){return Array.isArray(e)}var g,O,j=0,y=function(e){return 0===e};!function(e){e.ClientValueUnknown="ClientValueUnknown"}(g||(g={})),function(e){e[e.ClientValueUnknown=0]="ClientValueUnknown"}(O||(O={}));var S={fmla:"",lexicalKind:o.a.Cell,origin:Object(o.f)(0,0),compiledFmla:void 0,hasHyperlink:!1};Object(l.r)();var C={fmla:"",lexicalKind:o.a.Range,origin:Object(o.f)(0,0),compiledFmla:void 0,hasHyperlink:!1};Object(l.r)();var k,E=function(e,t){return""===e&&!t},A=S;!function(e){e.ClientValueUnknown="ClientValueUnknown"}(k||(k={}));var N={kind:k.ClientValueUnknown};function T(e){return e.kind===k.ClientValueUnknown}var R={oper:c.d,failure:void 0};function I(e,t){return Object(i.y)(e)&&void 0===t}function _(e,t,r){return e.setValue(t,r,(function(e){return e.fmla!==r.fmla||e.lexicalKind!==r.lexicalKind||void 0!==e.compiledFmla&&!Object(i.G)(e.origin,r.origin)||null==e.compiledFmla!=(null==r.compiledFmla)}))}function F(e,t){return e.forEachMeets(t,(function(t,r){if(r.fmla.length>0){var n=r.lexicalKind===o.a.Cell?S:C;e=e.setValue(t,n)}return!0})),e}function w(e,t){return e.forEachMeets(t,(function(t,r){return(r.fmla===O.ClientValueUnknown||r.fmla.length>0)&&(e=e.setValue(t,A)),!0})),e}function M(e,t,r,n){var a=Object(f.g)(t,u.b),i=Object(f.i)(Object(f.g)(r,a),"row","col");return Object(u.g)(Object(f.d)(t,i),(function(t){return e=e.setValue(t,n),!0})),e}Object(l.r)();var D={hidden:[],available:[]},P={values:Object(s.a)(),formats:Object(s.a)(),styles:Object(s.a)(),formulae:Object(s.a)(),dirty:d.d},x={serverFormulaeNodeCount:0,serverFormatsNodeCount:0,serverStylesNodeCount:0,serverValuesNodeCount:0,serverDirtySetSubspaceCount:0,editedFormulaeNodeCount:0,editedFormatsNodeCount:0,editedStylesNodeCount:0,editedValuesNodeCount:0,editedDirtySetSubspaceCount:0,clientFormulaeNodeCount:0,clientFormatsNodeCount:0,clientValuesNodeCount:0,recalcValuesNodeCount:0,recalcDirtySetSubspaceCount:0,recalcFailuresSetSubspaceCount:0,recalcTaintSetSubspaceCount:0,availabilitySetSubspaceCount:0,availabilityHistorySize:0,hiddenRowsNodeCount:0,hiddenColsNodeCount:0};function L(e,t){return{serverFormulaeNodeCount:e.serverFormulaeNodeCount+t.serverFormulaeNodeCount,serverFormatsNodeCount:e.serverFormatsNodeCount+t.serverFormatsNodeCount,serverStylesNodeCount:e.serverStylesNodeCount+t.serverStylesNodeCount,serverValuesNodeCount:e.serverValuesNodeCount+t.serverValuesNodeCount,serverDirtySetSubspaceCount:e.serverDirtySetSubspaceCount+t.serverDirtySetSubspaceCount,editedFormulaeNodeCount:e.editedFormulaeNodeCount+t.editedFormulaeNodeCount,editedFormatsNodeCount:e.editedFormatsNodeCount+t.editedFormatsNodeCount,editedStylesNodeCount:e.editedStylesNodeCount+t.editedStylesNodeCount,editedValuesNodeCount:e.editedValuesNodeCount+t.editedValuesNodeCount,editedDirtySetSubspaceCount:e.editedDirtySetSubspaceCount+t.editedDirtySetSubspaceCount,clientFormulaeNodeCount:e.clientFormulaeNodeCount+t.clientFormulaeNodeCount,clientFormatsNodeCount:e.clientFormatsNodeCount+t.clientFormatsNodeCount,clientValuesNodeCount:e.clientValuesNodeCount+t.clientValuesNodeCount,recalcValuesNodeCount:e.recalcValuesNodeCount+t.recalcValuesNodeCount,recalcDirtySetSubspaceCount:e.recalcDirtySetSubspaceCount+t.recalcDirtySetSubspaceCount,recalcFailuresSetSubspaceCount:e.recalcFailuresSetSubspaceCount+t.recalcFailuresSetSubspaceCount,recalcTaintSetSubspaceCount:e.recalcTaintSetSubspaceCount+t.recalcTaintSetSubspaceCount,availabilitySetSubspaceCount:e.availabilitySetSubspaceCount+t.availabilitySetSubspaceCount,availabilityHistorySize:e.availabilityHistorySize+t.availabilityHistorySize,hiddenRowsNodeCount:e.hiddenRowsNodeCount+t.hiddenRowsNodeCount,hiddenColsNodeCount:e.hiddenColsNodeCount+t.hiddenColsNodeCount}}var B=void 0,U=Object(o.g)(0,0,o.v,o.o);function G(e,t){return e===B?t:t===B?e:Object(i.s)(e,t)}function V(e,t){return e===B||t===B?B:Object(i.q)(e,t)}var H=function(){function e(e,t,r,n,a,i,o,c,u,l){void 0===e&&(e=P),void 0===t&&(t=d.d),void 0===r&&(r=U),void 0===n&&(n=d.d),void 0===a&&(a=d.d),void 0===i&&(i=d.d),void 0===o&&(o=d.d),void 0===c&&(c=Object(s.a)()),void 0===u&&(u=!1),void 0===l&&(l=!1),this.oldAvailabilities={},this.availabilityHistorySize=0,this.serverContents=e,this.serverAvailability=t,this.serverUsed=r,this.hiddenRows=n,this.hiddenRowsAvailability=a,this.hiddenCols=i,this.hiddenColsAvailability=o,this.mergeCells=c,this.inFilterMode=u,this.filterModeAvailable=l,this.rollBackToServerState()}return e.create=function(){return new e},e.prototype.clone=function(t){void 0===t&&(t=b.a.Server);var r=new e(this.serverContents,this.serverAvailability,this.serverUsed,this.hiddenRows,this.hiddenRowsAvailability,this.hiddenCols,this.hiddenColsAvailability,this.mergeCells,this.inFilterMode,this.filterModeAvailable);return t===b.a.Client&&(r.editedContents=this.editedContents,r.clientContents=this.clientContents,r.recalcValues=this.recalcValues,r.recalcDirty=this.recalcDirty,r.recalcFailures=this.recalcFailures,r.editedTaint=this.editedTaint,r.recalcTaint=this.recalcTaint,r.editedAvailability=this.editedAvailability),r},e.prototype.advanceState=function(e){this.oldAvailabilities[e]=this.serverAvailability,this.availabilityHistorySize+=1,this.serverAvailability=d.d,this.serverUsed=U,this.hiddenRows=this.hiddenRowsAvailability=d.d,this.hiddenCols=this.hiddenColsAvailability=d.d,this.inFilterMode=this.filterModeAvailable=!1,this.rollBackToServerState()},e.prototype.rollBackToServerState=function(){this.editedContents=this.serverContents,this.editedAvailability=this.serverAvailability,this.editedUsed=this.serverUsed,this.editedTaint=d.d,this.rollBackToEditedState()},e.prototype.rollBackToEditedState=function(){this.clientContents=this.editedContents,this.recalcValues=this.editedContents.values,this.recalcFailures=d.d,this.recalcDirty=this.editedContents.dirty,this.recalcTaint=this.editedTaint},e.prototype.allServerAvailable=function(e){return this.allAvailable(e,this.serverAvailability)},e.prototype.allEditedAvailable=function(e){return this.allAvailable(e,this.editedAvailability)},e.prototype.allAvailable=function(e,t){var r=Object(u.f)(e),n=Object(f.g)(r,u.b),a=Object(f.g)(t,n),i=Object(f.i)(Object(f.d)(n,a),"row","col"),o=Object(f.a)(a,n);return!!(void 0!==o&&o>=0)||i},e.prototype.forEachRecalcDirty=function(e,t){return Object(u.g)(Object(f.g)(this.recalcDirty,Object(u.f)(e)),t)},e.prototype.hasRecalcDirty=function(e){return Object(f.h)(this.recalcDirty,Object(u.f)(e))},e.prototype.hasRecalcFailure=function(e){return Object(f.h)(this.recalcFailures,Object(u.f)(e))},e.prototype.hasEditedEditTaint=function(e){return Object(f.h)(this.editedTaint,Object(u.f)(e))},e.prototype.hasRecalcEditTaint=function(e){return Object(f.h)(this.recalcTaint,Object(u.f)(e))},e.prototype.getEditedUsedRange=function(){return this.editedUsed},e.prototype.getServerUsedRange=function(){return this.serverUsed},e.prototype.getServerAvailability=function(){return this.serverAvailability},e.prototype.getHiddenRows=function(e,t){var r=u.d.row(Object(l.n)(e,t)),n=Object(d.i)(this.hiddenRowsAvailability,r),i=[];Object(u.j)(n,(function(e){var t=e[0],r=e[1];return i.push(Object(a.p)(t,r)),!0}));var o=[];return Object(u.j)(Object(d.i)(this.hiddenRows,n),(function(e){var t=e[0],r=e[1];return o.push(Object(a.p)(t,r)),!0})),{hidden:o,available:i}},e.prototype.tryGetHiddenRows=function(e,t){var r=this.getHiddenRows(e,t);return 1===r.available.length&&r.available[0].start===e&&r.available[0].end===t?Object(v.f)(r.hidden):Object(v.c)({kind:b.d.HiddenRows})},e.prototype.setHiddenRows=function(e,t){var r=u.d.row(Object(l.n)(e.row,e.row+e.rows));this.hiddenRows=Object(d.j)(Object(d.e)(this.hiddenRows,r),Object(d.i)(t,r)),this.hiddenRowsAvailability=Object(d.j)(this.hiddenRowsAvailability,r)},e.prototype.getHiddenCols=function(e,t){var r=u.d.col(Object(l.n)(e,t)),n=Object(d.i)(this.hiddenColsAvailability,r),i=[];Object(u.h)(n,(function(e){var t=e[0],r=e[1];return i.push(Object(a.p)(t,r)),!0}));var o=[];return Object(u.h)(Object(d.i)(this.hiddenCols,n),(function(e){var t=e[0],r=e[1];return o.push(Object(a.p)(t,r)),!0})),{hidden:o,available:i}},e.prototype.tryGetHiddenCols=function(e,t){var r=this.getHiddenCols(e,t);return 1===r.available.length&&r.available[0].start===e&&r.available[0].end===t?Object(v.f)(r.hidden):Object(v.c)({kind:b.d.HiddenCols})},e.prototype.setHiddenCols=function(e,t){var r=u.d.col(Object(l.n)(e.col,e.col+e.cols));this.hiddenCols=Object(d.j)(Object(d.e)(this.hiddenCols,r),Object(d.i)(t,r)),this.hiddenColsAvailability=Object(d.j)(this.hiddenColsAvailability,r)},e.prototype.setMergeCell=function(e){this.mergeCells=this.mergeCells.setValue(e,!0)},e.prototype.getMergeCell=function(e){var t;return this.mergeCells.forEachGe(e,(function(e){return t=e,!0})),t},e.prototype.isInFilterMode=function(){return this.filterModeAvailable?Object(v.f)(this.inFilterMode):Object(v.c)({kind:b.d.InFilterMode})},e.prototype.setInFilterMode=function(e){this.inFilterMode=e,this.filterModeAvailable=!0},e.prototype.forEachNonBlankSetCellInSet=function(e,t,r,n){var a=Object(f.g)(e,u.c);return Object(u.i)(Object(f.g)(r,a),(function(e){return n.formulae.forEachMeets(e,(function(r,n){return!!E(n.fmla,void 0!==n.compiledFmla)||Object(i.d)(Object(i.q)(e,r),t)}))}))},e.prototype.forEachReadableCellInSet=function(e,t,r){var n=Object(f.g)(e,u.b);return Object(u.i)(Object(f.g)(r,n),(function(e){return Object(i.d)(e,t)}))},e.prototype.forEachEditedNonBlankCellInSet=function(e,t){return this.forEachNonBlankSetCellInSet(e,t,this.editedAvailability,this.editedContents)},e.prototype.forEachServerNonBlankCellInSet=function(e,t){return this.forEachNonBlankSetCellInSet(e,t,this.serverAvailability,this.serverContents)},e.prototype.forEachEditedCellInSet=function(e,t){return this.forEachReadableCellInSet(e,t,this.editedAvailability)},e.prototype.promoteServerAvailability=function(e,t){var r=Object(f.g)(e,u.c),n=this.oldAvailabilities[t];if(void 0===n)return!1;var a=Object(f.a)(n,r);return void 0!==a&&a>=0&&(this.unionAvailability(!0,Object(f.g)(e,u.a)),this.unionTaint(!0,d.d),this.unionUsed(!0,Object(u.e)(e)),!0)},e.prototype.extendServerUnused=function(e){var t=e===B?d.d:Object(u.f)(e),r=Object(f.b)(t),n=this.serverContents,a=n.values,i=n.formats,o=n.styles,c=n.formulae,s=n.dirty;Object(u.i)(r,(function(e){return a.forEachLe(e,(function(e,t){return I(t.oper,t.failure)||(a=a.setValue(e,R)),!0})),i.forEachLe(e,(function(e,t){return y(t)||(i=i.setValue(e,j)),!0})),o.forEachLe(e,(function(e,t){return t!==h.g.Blank&&(o=o.setValue(e,h.g.Blank)),!0})),!0})),Object(u.i)(r,(function(e){return c=F(c,e),!0})),s=Object(f.d)(s,r),this.setContents(!0,{values:a,formats:i,styles:o,formulae:c,dirty:s});var l=Object(f.g)(r,u.b);this.serverAvailability=this.editedAvailability=Object(f.j)(this.serverAvailability,l),this.editedTaint=this.recalcTaint=d.d;var b=this.serverUsed;b=V(b,e),this.serverUsed=this.editedUsed=b},e.prototype.setRecalcFailure=function(e){this.recalcFailures=Object(f.j)(this.recalcFailures,e)},e.prototype.setRecalcEditTaint=function(e){this.recalcTaint=Object(f.j)(this.recalcTaint,e)},e.prototype.setRecalcValue=function(e,t){var r=this;Object(i.d)(e,(function(e,n,a){return r.recalcValues=r.recalcValues.setValue(e,{oper:m(t)?t[n][a]:t,failure:void 0}),!0})),this.recalcDirty=Object(f.d)(this.recalcDirty,Object(u.f)(e))},e.prototype.setClientValue=function(e,t){var r=this.clientContents.values;Object(i.d)(e,(function(e,n,a){return r=r.setValue(e,{oper:m(t)?t[n][a]:t,failure:void 0}),!0})),this.clientContents=Object(n.__assign)(Object(n.__assign)({},this.clientContents),{values:r})},e.prototype.setClientFormula=function(e,t,r){var a=this.clientContents.formulae;a=w(a,e),void 0!==t?a=a.setValue(t,r):Object(i.d)(e,(function(e){return a=a.setValue(e,r),!0})),this.clientContents=Object(n.__assign)(Object(n.__assign)({},this.clientContents),{formulae:a})},e.prototype.setClientFormat=function(e,t){var r=this.clientContents.formats;Object(i.d)(e,(function(e){return r=r.setValue(e,t),!0})),this.clientContents=Object(n.__assign)(Object(n.__assign)({},this.clientContents),{formats:r})},e.prototype.getRecalcValues=function(e){for(var t=e.row,r=e.col,n=e.rows,a=e.cols,i=new Array(n),o=0;o<n;o+=1)i[o]=Object(p.a)(new Array(a),R);return this.recalcValues.forEachLe(e,(function(e,n){return i[e.row-t][e.col-r]=n,!0})),i},e.prototype.getClientValue=function(e){var t=this.clientContents.values.getValue(e);return null!=t?t:R},e.prototype.getServerValue=function(e){var t=this.serverContents.values.getValue(e);return null!=t?t:R},e.prototype.getEditedValue=function(e){var t=this.editedContents.values.getValue(e);return null!=t?t:R},e.prototype.forEachEditedValue=function(e,t){return this.editedContents.values.forEachMeets(e,t)},e.prototype.getServerFormula=function(e){return this.getFormula(e,this.serverContents.formulae)},e.prototype.getClientFormula=function(e){return this.getFormula(e,this.clientContents.formulae)},e.prototype.setEditedFormat=function(e,t){this.editedContents=Object(n.__assign)(Object(n.__assign)({},this.editedContents),{formats:this.editedContents.formats.setValue(e,t)})},e.prototype.getEditedFormat=function(e){var t=this.editedContents.formats.getValue(e);return null!=t?t:j},e.prototype.forEachEditedFormat=function(e,t){return this.editedContents.formats.forEachMeets(e,t)},e.prototype.getServerFormat=function(e){var t=this.serverContents.formats.getValue(e);return null!=t?t:j},e.prototype.getEditedStyle=function(e){var t=this.editedContents.styles.getValue(e);return null!=t?t:h.g.Blank},e.prototype.getServerStyle=function(e){var t=this.serverContents.styles.getValue(e);return null!=t?t:h.g.Blank},e.prototype.getClientFormat=function(e){var t=this.clientContents.formats.getValue(e);return null!=t?t:j},e.prototype.getEditedFormula=function(e){return this.getFormula(e,this.editedContents.formulae)},e.prototype.forEachEditedFormula=function(e,t){return this.editedContents.formulae.forEachMeets(e,t)},e.prototype.getFormula=function(e,t){var r=void 0;return t.forEachGe(e,(function(e,t){return!!E(t.fmla,void 0!==t.compiledFmla)||(r=[e,t],!1)})),r},e.prototype.setContents=function(e,t){e&&(this.serverContents=t),this.editedContents=t,e&&(this.clientContents=this.editedContents),this.recalcValues=this.editedContents.values,this.recalcDirty=this.editedContents.dirty,this.recalcFailures=d.d},e.prototype.unionAvailability=function(e,t){var r=e?this.serverAvailability:this.editedAvailability;r=Object(f.j)(r,t),e&&(this.serverAvailability=r),this.editedAvailability=r},e.prototype.unionTaint=function(e,t){this.editedTaint=e?d.d:Object(f.j)(this.editedTaint,t),this.recalcTaint=this.editedTaint},e.prototype.unionUsed=function(e,t){var r=e?this.serverUsed:this.editedUsed;r=G(r,t),e&&(this.serverUsed=r),this.editedUsed=r},e.prototype.setCellContents=function(e,t,r,n,a,i,o,c){this.setCommon(e,t,void 0,r,n,a,i,o,c)},e.prototype.setRangeFormula=function(e,t,r,n,a,i,o){var c=Object(u.f)(t);this.setCommon(e,c,t,r,n,void 0,a,i,o)},e.prototype.setCommon=function(e,t,r,a,i,o,c,s,l){var b=this,v=e?this.serverContents:this.editedContents,p=v.values,m=v.formats,g=v.styles,O=v.formulae,S=v.dirty,C=void 0===a&&void 0!==i||void 0!==(null==a?void 0:a.compiledFmla),k=a;void 0!==a&&(Object(u.i)(t,(function(e){return O=F(O,e),!0})),E(a.fmla,void 0!==a.compiledFmla)&&(k=void 0));var A=void 0!==k&&void 0===r?a:void 0,T=void 0!==k&&void 0!==r?a:void 0,w=i;void 0!==i&&I(i,o)&&(Object(u.i)(t,(function(e){return p.forEachLe(e,(function(e,t){return I(t.oper,t.failure)||(p=p.setValue(e,R)),!0})),!0})),S=C?Object(f.j)(S,t):Object(f.d)(S,t),w=void 0);var D=void 0!==w?{oper:w,failure:o}:void 0,P=c;void 0!==c&&y(c)&&(Object(u.i)(t,(function(e){return m.forEachLe(e,(function(e,t){return y(t)||(m=m.setValue(e,j)),!0})),!0})),P=void 0);var x=P===h.f.Weak?void 0:P,L=P===h.f.Weak?P:void 0,B=s;void 0!==s&&s===h.g.Blank&&(Object(u.i)(t,(function(e){return g.forEachLe(e,(function(e,t){return t!==h.g.Blank&&(g=g.setValue(e,h.g.Blank)),!0})),!0})),B=void 0);var U=B===h.g.Weak?void 0:B,G=B===h.g.Weak?B:void 0,V=t;if(!e){var H=Object(f.g)(t,u.c),W=Object(f.i)(Object(f.g)(this.editedAvailability,H),"row","col"),z=Object(f.g)(t,void 0!==l?Object(u.f)(l):d.d);V=Object(f.j)(W,z)}if(void 0===A&&void 0===x&&void 0===U&&void 0===D||(Object(u.g)(V,(function(e){return void 0!==A&&(O=_(O,e,A)),void 0!==x&&(m=m.setValue(e,x)),void 0!==U&&(g=g.setValue(e,U)),void 0!==D&&(p=p.setValue(e,D)),!0})),void 0===A&&void 0===D||(S=C?Object(f.j)(S,V):Object(f.d)(S,V))),void 0!==T){O=_(O,r,T);var q=Object(u.f)(r);S=C?Object(f.j)(S,q):Object(f.d)(S,q)}void 0!==L&&(m=M(m,V,e?this.serverAvailability:this.editedAvailability,h.f.Unavailable)),void 0!==G&&(g=function(e,t,r){var n=Object(f.g)(t,u.b),a=Object(f.i)(Object(f.g)(r,n),"row","col");return Object(u.g)(Object(f.d)(t,a),(function(t){return e=e.setValue(t,h.g.Unavailable),!0})),e}(g,V,e?this.serverAvailability:this.editedAvailability));var K=void 0===i?d.d:V,Y=void 0===a?d.d:V,J=void 0===c?d.d:V,Q=void 0===i&&void 0===c?d.d:V;e||(Object(u.i)(K,(function(e){return b.setClientValue(e,N),!0})),void 0!==a&&(void 0!==r?this.setClientFormula(r,r,a):Object(u.i)(Y,(function(e){return b.setClientFormula(e,void 0,a),!0}))),c===h.f.Weak?this.clientContents=Object(n.__assign)(Object(n.__assign)({},this.clientContents),{formats:M(this.clientContents.formats,J,this.editedAvailability,h.f.ClientValueUnknown)}):Object(u.i)(J,(function(e){return b.setClientFormat(e,h.f.ClientValueUnknown),!0}))),this.setContents(e,{values:p,formats:m,styles:g,formulae:O,dirty:S}),this.unionAvailability(e,Object(f.g)(K,u.a)),e||(this.editedAvailability=Object(f.d)(this.editedAvailability,Object(f.d)(t,V))),this.unionTaint(e,Q),this.unionUsed(e,Object(u.e)(t))},e.prototype.copyRange=function(e){function t(t,r){return t.forEachLe(e,(function(e,t){return r=r.setValue(e,t),!0})),r}var r=P.values,n=P.formats,a=P.styles,o=P.formulae,c=this.editedContents,s=c.values,l=c.formats,d=c.styles,b=c.formulae;r=t(s,r),n=t(l,n),a=t(d,a),b.forEachMeets(e,(function(t,r){return o=o.setValue(Object(i.q)(t,e),r),!0}));var h=Object(i.n)(e),v=Object(f.g)(this.editedAvailability,Object(u.f)(e)),p=V(this.editedUsed,e);return{origin:h,formats:n,styles:a,values:r,formulae:o,availability:v,used:p}},e.prototype.pasteRange=function(e,t){var r=Object(u.f)(e),a=Object(o.g)(t.origin.row,t.origin.col,e.rows,e.cols),i=this.editedContents,c=i.values,s=i.formats,l=i.styles,b=i.formulae,v=i.dirty,p=this.editedUsed,m=e.row-t.origin.row,y=e.col-t.origin.col;function C(e){return Object(o.g)(e.row+m,e.col+y,e.rows,e.cols)}function k(t,r,n){return r.forEachMeets(e,(function(e,t){return r=r.setValue(e,n),!0})),t.forEachLe(a,(function(e,t){return r=r.setValue(C(e),t),!0})),r}var E=G(p,t.used!==B?C(t.used):B),A=V(E,e);c=k(t.values,c,R),A!==B&&this.setClientValue(A,N),s=k(t.formats,s,j),l=k(t.styles,l,h.g.Blank),A!==B&&this.setClientFormat(A,h.f.ClientValueUnknown),b=k(t.formulae,b,S),v=Object(f.d)(v,r);var T=this.clientContents.formulae;T=w(T,e),b.forEachLe(e,(function(e,t){var r=t.origin,n=t.compiledFmla;return void 0!==n&&(v=Object(f.j)(v,Object(u.f)(e))),T=T.setValue(e,{fmla:O.ClientValueUnknown,origin:r,compiledFmla:n,hasHyperlink:g.ClientValueUnknown}),!0})),this.clientContents=Object(n.__assign)(Object(n.__assign)({},this.clientContents),{formulae:T});var I;this.setContents(!1,{values:c,formats:s,styles:l,formulae:b,dirty:v}),this.editedAvailability=Object(f.d)(this.editedAvailability,r),this.unionAvailability(!1,(I=t.availability,Object(u.k)(I,m,y))),this.unionTaint(!1,A===B?d.d:Object(u.f)(A)),this.unionUsed(!1,E)},e.prototype.getDirtyEditedCells=function(){return Object(f.g)(this.recalcDirty,this.editedTaint)},e.prototype.getNonDirtyEditedCells=function(){return Object(f.d)(this.editedTaint,this.recalcDirty)},e.prototype.getDirtyDependentCells=function(){return Object(f.d)(this.recalcDirty,this.editedTaint)},e.prototype.onCellModified=function(e){var t=e?this.serverContents:this.editedContents;this.setContents(e,t),this.unionAvailability(e,d.d),this.unionTaint(e,d.d),this.unionUsed(e,B)},e.prototype.clearCompiledFormulas=function(){for(var e=0,t=[this.serverContents.formulae,this.editedContents.formulae];e<t.length;e++){t[e].forEach((function(e,t){return void 0!==t.compiledFmla&&t.compiledFmla.reset(),!0}))}},e.prototype.getStatistics=function(){return{serverFormulaeNodeCount:this.serverContents.formulae.getCount(),serverFormatsNodeCount:this.serverContents.formats.getCount(),serverStylesNodeCount:this.serverContents.styles.getCount(),serverValuesNodeCount:this.serverContents.values.getCount(),serverDirtySetSubspaceCount:Object(f.f)(this.serverContents.dirty),editedFormulaeNodeCount:this.editedContents.formulae.getCount(),editedFormatsNodeCount:this.editedContents.formats.getCount(),editedStylesNodeCount:this.editedContents.styles.getCount(),editedValuesNodeCount:this.editedContents.values.getCount(),editedDirtySetSubspaceCount:Object(f.f)(this.editedContents.dirty),clientFormulaeNodeCount:this.clientContents.formulae.getCount(),clientFormatsNodeCount:this.clientContents.formats.getCount(),clientValuesNodeCount:this.clientContents.values.getCount(),recalcValuesNodeCount:this.recalcValues.getCount(),recalcDirtySetSubspaceCount:Object(f.f)(this.recalcDirty),recalcFailuresSetSubspaceCount:Object(f.f)(this.recalcFailures),recalcTaintSetSubspaceCount:Object(f.f)(this.recalcTaint),availabilityHistorySize:this.availabilityHistorySize,availabilitySetSubspaceCount:Object(f.f)(this.editedAvailability),hiddenRowsNodeCount:Object(d.h)(this.hiddenRows)+Object(d.h)(this.hiddenRowsAvailability),hiddenColsNodeCount:Object(d.h)(this.hiddenCols)+Object(d.h)(this.hiddenColsAvailability)}},e.prototype.collectGarbage=function(e){var t=d.d;for(var r in this.oldAvailabilities)if(this.oldAvailabilities.hasOwnProperty(r)){var n=Number(r);if(n>=e){t=Object(f.j)(t,this.oldAvailabilities[n]);continue}delete this.oldAvailabilities[n],this.availabilityHistorySize-=1}function a(e){return Object(f.h)(Object(f.g)(Object(u.f)(e),u.c),t)}function i(e,t){return!E(t.fmla,void 0!==t.compiledFmla)&&a(e)}function o(e,t){return!y(t)&&a(e)}function c(e,t){return t!==h.g.Blank&&a(e)}function s(e,t){return!(!T(t.oper)&&I(t.oper,t.failure))&&a(e)}var l=Object(f.i)(t,"row","col");this.serverContents={formulae:this.serverContents.formulae.filter(i),formats:this.serverContents.formats.filter(o),styles:this.serverContents.styles.filter(c),values:this.serverContents.values.filter(s),dirty:Object(f.g)(this.serverContents.dirty,l)},this.editedContents={formulae:this.editedContents.formulae.filter(i),formats:this.editedContents.formats.filter(o),styles:this.editedContents.styles.filter(c),values:this.editedContents.values.filter(s),dirty:Object(f.g)(this.editedContents.dirty,l)},this.clientContents={formulae:this.clientContents.formulae.filter(i),formats:this.clientContents.formats.filter(o),values:this.clientContents.values.filter(s)},this.recalcValues=this.recalcValues.filter(s),this.recalcDirty=Object(f.g)(this.recalcDirty,l)},e}()},function(e,t,r){"use strict";r.d(t,"c",(function(){return s})),r.d(t,"b",(function(){return l})),r.d(t,"d",(function(){return d})),r.d(t,"a",(function(){return f})),r.d(t,"e",(function(){return b}));var n=r(9),a=r(58),i=r(45),o=r(74),c=r(101),u=r(30),s=new o.a,l=Object(i.b)((function(){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(n.__generator)(this,(function(t){switch(t.label){case 0:return e=a.c.instance(),h.getValue()?[4,c.a.getValue()]:[3,2];case 1:t.sent(),t.label=2;case 2:return[4,e.recalcServiceAttached()];case 3:return t.sent(),[2,e]}}))}))})),d=Object(i.b)((function(){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(n.__generator)(this,(function(t){switch(t.label){case 0:return[4,b.getValue()];case 1:return[4,(e=t.sent()).loadPluginScript("formula-authoring-strings",!0)];case 2:return t.sent(),[2,e]}}))}))})),f=Object(i.b)((function(){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(n.__generator)(this,(function(t){switch(t.label){case 0:return[4,s];case 1:return e=t.sent(),[2,Object(a.d)(e)]}}))}))})),b=Object(i.b)((function(){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){return Object(n.__generator)(this,(function(e){switch(e.label){case 0:return[4,f.getValue()];case 1:return[2,e.sent().createPluginThread("worker")]}}))}))})),h=new i.a((function(){return!Object(u.c)("Microsoft.Office.Excel.FormulaAssistanceRedesign")&&Object(u.e)(u.a["OfficeVSO:5607789_FunctionShortDescriptions"])&&Object(u.c)("Microsoft.Office.ExcelOnline.ArgumentAssistancePlugin")}))},function(e,t,r){"use strict";r.r(t),r.d(t,"MachineCallKind",(function(){return n})),r.d(t,"machineCall",(function(){return l})),r.d(t,"isMachineCall",(function(){return d})),r.d(t,"ThenMachine",(function(){return f})),r.d(t,"ArrayMachine",(function(){return b}));var n,a=r(7),i=r(44),o=r(5),c=r(76),u=r(3),s=r(0);function l(e){return{kind:n.MachineCall,machine:e}}function d(e){return e.kind===n.MachineCall}r.d(t,"TransitionKind",(function(){return c.d})),r.d(t,"nextTransition",(function(){return c.g})),r.d(t,"callMachineTransition",(function(){return c.e})),r.d(t,"nextOnSuccessReceiver",(function(){return c.f})),r.d(t,"MachineCycle",(function(){return c.b})),r.d(t,"MachineRuntime",(function(){return c.c})),r.d(t,"AllMachine",(function(){return c.a})),function(e){e.MachineCall="MachineCall"}(n||(n={}));var f=function(){function e(e,t,r){this.context=e,this.f1=t,this.f2=r,this.runStatus=!1,this.oper1=void 0,this.oper2=void 0}return e.prototype.next=function(){var e;try{if(void 0===this.oper1){var t=this.f1();if(d(t))return Object(c.e)(t.machine,this);this.oper1=t}if(void 0===this.oper2){var r=this.f2(this.oper1);if(d(r))return Object(c.e)(r.machine,this);this.oper2=r}return Object(s.f)(this.oper2)}catch(t){return null!==(e=this.context.handleEvaluationError(t))&&void 0!==e?e:Object(s.c)(Object(s.e)(t))}},e.prototype.receiveResult=function(e){return Object(s.d)(e)?(void 0===this.oper1?this.oper1=e.value:void 0===this.oper2&&(this.oper2=e.value),this.next()):e},e}(),b=function(){function e(e,t,r,n){this.context=e,this.rows=t,this.cols=r,this.func=n,this.runStatus=!1,this.toDeref=void 0,this.row=[],this.opers=[]}return e.prototype.next=function(){var e;try{if(void 0!==this.toDeref){var t=this.context.coerceOper(Object(i.e)(this.context,this.toDeref,!0),i.d);Object(o.h)("calc.runtime.ArrayMachine.next",!Object(u.J)(t)&&!Object(u.R)(t)),Object(u.x)(t)&&(t=t.opers[0][0]),this.row.push(t),this.row.length===this.cols&&(this.opers.push(this.row),this.row=[]),this.toDeref=void 0}if(this.opers.length>=this.rows)return Object(s.f)(Object(a.c)(this.rows,this.cols,this.opers));var r=this.func(this.opers.length,this.row.length);return d(r)?Object(c.e)(r.machine,this):(this.toDeref=r,c.g)}catch(t){return null!==(e=this.context.handleEvaluationError(t))&&void 0!==e?e:Object(s.c)(Object(s.e)(t))}},e.prototype.receiveResult=function(e){return Object(s.d)(e)?(this.toDeref=e.value,this.next()):e},e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(20),a=n.rbMapTree.RedBlackMapTree},function(e,t,r){"use strict";r.r(t);var n=r(9);function a(e){return i(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function i(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function o(e){return i(e)?e:new Error("(non-Error object) ".concat(function(e){var t=typeof e;switch(t){case"function":case"symbol":case"undefined":return"<".concat(t,">");case"object":return JSON.stringify(e);default:return"".concat(e)}}(e)))}function c(e){return{name:e.name,message:a(e)?e.baseMessage:e.message,stack:e.stack,info:a(e)?(t=e.info,Object(n.__assign)(Object(n.__assign)({},t),{error:t.error?c(t.error):void 0})):void 0};var t}function u(e){return i(e)?{isError:!0,value:c(e)}:{isError:!1,value:e}}var s=function(e){function t(t,r){var a,i=this.constructor,o=this;(o=e.call(this,"".concat(t,"; info = ").concat(JSON.stringify(Object(n.__assign)(Object(n.__assign)({},r),{error:null===(a=r.error)||void 0===a?void 0:a.message}))))||this).baseMessage=t,o.info=r,o.name="WorkerError";var c=i.prototype;return Object.getPrototypeOf(o)!==c&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(o,c):o.__proto__=c),o}return Object(n.__extends)(t,e),t.isWorkerError=a,t}(Error);var l={Error:Error,EvalError:EvalError,RangeError:RangeError,ReferenceError:ReferenceError,SyntaxError:SyntaxError,TypeError:TypeError,URIError:URIError};function d(e){var t;if("WorkerError"===e.name)t=new s(e.message,function(e){return Object(n.__assign)(Object(n.__assign)({},e),{error:e.error?d(e.error):void 0})}(e.info));else{var r=l[e.name];r?t=new r(e.message):(t=new Error(e.message)).name=e.name}return null!=e.stack&&(t.stack=e.stack),t}function f(e){return e.isError?d(e.value):e.value}var b;function h(){return"undefined"!=typeof Blob&&"undefined"!=typeof URL&&void 0!==URL.createObjectURL&&void 0!==URL.revokeObjectURL&&"undefined"!=typeof Worker}function v(e){if(b)throw new TypeError("setConfig has already been called");b=e}function p(){var e=null!=b?b:{};return{createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls?Object(n.__spreadArray)([],e.importScriptUrls,!0):void 0,typedWorkersUrl:e.typedWorkersUrl,typedWorkersName:e.typedWorkersName,importScriptsMaxRetries:e.importScriptsMaxRetries}}function m(e){setTimeout((function(){throw e}))}function g(){return"undefined"!=typeof self&&"__typed_workers_thread"in self?self:void 0}function O(e){var t=g();if(void 0!==t){var r={kind:1,error:u(e)};t.postMessage(r)}else console.warn(e)}function j(e){var t;try{(null!==(t=null==b?void 0:b.onWorkerError)&&void 0!==t?t:O)(e)}catch(t){console.warn(e),m(t)}}function y(e){var t=g();if(void 0!==t){var r={kind:2,stats:e};t.postMessage(r)}}function S(e){var t;try{(null!==(t=null==b?void 0:b.onCreateWorker)&&void 0!==t?t:y)(e)}catch(e){m(e)}}var C=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return C.transfer.apply(C,Object(n.__spreadArray)([e,void 0],t,!1))};C.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var k=r(70),E=Object(k.makeTypedIsChangeGateEnabled)(["OfficeVSO:WINum_CGExample","OfficeVSO:5592319_TypedWorkersProxyPromiseFix"]);Object(k.makeGetTypedFeatureGate)({"Microsoft.Office.Shared.FGExample":!0});function A(e,t){return e.then((function(e){return t(),e}),(function(e){return t(),Promise.reject(e)}))}var N;function T(e,t,r){if(e>1<<30)return r;var n=setTimeout(t,Math.max(0,e));return{resolve:function(e){clearTimeout(n),r.resolve(e)},reject:function(e){clearTimeout(n),r.reject(e)}}}function R(){var e=Object.create(null);return e.key=void 0,delete e.key,e}function I(){return null!=N?N:N=function(){try{return"function"==typeof Proxy&&!0===new Proxy({},{get:function(){return!0}}).k}catch(e){return!1}}()}function _(e,t){var r=R(),n=E("OfficeVSO:5592319_TypedWorkersProxyPromiseFix")?function(t,r){var n;return"then"===r?void 0:null!==(n=t[r])&&void 0!==n?n:t[r]=e(r)}:function(t,r){var n;return null!==(n=t[r])&&void 0!==n?n:t[r]=e(r)};return t?(t.forEach((function(e){return n(r,e)})),r):new Proxy(r,{get:n})}function F(e){throw e}var w=-1,M=function(){function e(e,t){var r,n,a=this;this.idInfo=e,this.port=t,this.isClosed=!1,this.exports={},this.unresolvedCalls=R();var i=function(){var e;return null===(e=a.onClose)||void 0===e?void 0:e.call(a)},o=((r={})[0]=this.onInvoke.bind(this),r[1]=this.onResult.bind(this),r[2]=function(e){var t,r=e.funcNames;null===(t=a.onImports)||void 0===t||t.call(a,_(a.createPostProxy.bind(a),r),_(a.createCallProxy.bind(a),r))},r[3]=i,r),c=((n={})[0]=this.onSendInvokeFailed.bind(this),n[1]=this.onSendResultFailed.bind(this),n[2]=i,n[3]=i,n);this.port.onmessage=function(e){var t=e.data;return o[t.kind](t)},this.port.onmessageerror=function(e){var t=e.data;return c[t.kind](t)}}return e.prototype.setExports=function(e){this.exports=e;var t={kind:2,funcNames:I()?void 0:function(e){for(var t=R();null!=e;){for(var r=0,n=Object.getOwnPropertyNames(e);r<n.length;r++){var a=n[r];try{"function"==typeof e[a]&&(t[a]=!0)}catch(e){}}e=Object.getPrototypeOf(e)}return Object.getOwnPropertyNames(t)}(e)};this.port.postMessage(t)},e.prototype.close=function(){if(!this.isClosed){this.isClosed=!0;for(var e in this.port.postMessage({kind:3}),this.port.close(),this.unresolvedCalls){var t=this.unresolvedCalls[e],r=t.reject,n=t.funcName,a={cause:"Connection",idInfo:this.idInfo,funcName:n};r(new s("Importing Endpoint closed while waiting for ".concat(n," result"),a))}}},e.prototype.onInvoke=function(e){var t=this,r=e.callId,n=e.funcName,a=e.args,i=Promise.resolve().then((function(){var e=t.exports[n];if(e)return e.apply(t.exports,a);var i=r>=0?"call":"post",o={cause:"Connection",idInfo:t.idInfo,callId:r,funcName:n};throw new s("Exporting Endpoint received a ".concat(i," to unknown function ").concat(n),o)}));r>=0?i.then((function(e){return t.sendResult(r,n,!0,e)}),(function(e){return t.sendResult(r,n,!1,e)})):i.catch((function(e){var a=o(e),i={cause:"UnhandledError",idInfo:t.idInfo,error:a,callId:r,funcName:n};j(new s("Exporting Endpoint's ".concat(n," implementation threw or rejected"),i))}))},e.prototype.sendResult=function(e,t,r,n){var a={kind:1,callId:e,funcName:t,isFulfilled:r,resultValue:u(n)};try{this.port.postMessage(a,void 0)}catch(e){this.onSendResultFailed(a,o(e))}},e.prototype.onSendResultFailed=function(e,t){var r=e.callId,n=e.funcName,a=e.resultValue,i=t?"Exporting Endpoint failed to send ".concat(n," result"):"Importing Endpoint failed to deserialize ".concat(n," result"),o={cause:"MessageError",idInfo:this.idInfo,error:t,callId:r,funcName:n},c=new s(i,o);a.isError?j(c):this.sendResult(r,n,!1,c)},e.prototype.takeCallbacks=function(e){var t=this.unresolvedCalls[e];return t&&delete this.unresolvedCalls[e],t},e.prototype.setCallTimeout=function(e,t,r,n){var a=this;if(r>1<<30)return n;return T(r,(function(){var n=a.takeCallbacks(e);if(n){var i={cause:"Timeout",idInfo:a.idInfo,timeout:r,callId:e,funcName:t};n.reject(new s("Importing Endpoint's call to ".concat(t," timed out"),i))}}),n)},e.prototype.sendCall=function(e,t,r,a){var i=this;return new Promise((function(c,u){var l=w+=1,d={kind:0,callId:l,funcName:e,args:t};i.unresolvedCalls[l]=Object(n.__assign)(Object(n.__assign)({},i.setCallTimeout(l,e,r,{resolve:c,reject:u})),{funcName:e});try{i.port.postMessage(d,a)}catch(t){var f=i.takeCallbacks(l);if(f){var b=o(t),h={cause:"MessageError",idInfo:i.idInfo,error:b,callId:l,funcName:e};f.reject(new s("Importing Endpoint failed to send call to ".concat(e),h))}}}))},e.prototype.sendPost=function(e,t,r,n){var a={kind:0,callId:-1,funcName:e,args:t};try{this.port.postMessage(a,n)}catch(t){var i=o(t),c={cause:"MessageError",idInfo:this.idInfo,error:i,callId:-1,funcName:e};r(new s("Importing Endpoint failed to post to ".concat(e),c))}},e.prototype.onSendInvokeFailed=function(e){var t,r=e.callId,n=e.funcName,a=r>=0?"call":"post",i={cause:"MessageError",idInfo:this.idInfo,callId:r,funcName:n},o=new s("Exporting Endpoint failed to deserialize ".concat(a," to ").concat(n),i),c=r>=0?this.takeCallbacks(r):void 0;(null!==(t=null==c?void 0:c.reject)&&void 0!==t?t:j)(o)},e.prototype.onResult=function(e){var t=e.callId,r=e.funcName,n=e.isFulfilled,a=e.resultValue;if(t>=0){var i=this.takeCallbacks(t);if(i)(n?i.resolve:i.reject)(f(a))}else{var o={cause:"InternalError",idInfo:this.idInfo,callId:t,funcName:r};j(new s("Exporting Endpoint sent a result for a post to ".concat(r),o))}},e.prototype.createPostProxy=function(e){var t=this,r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.transfer.apply(r,Object(n.__spreadArray)([void 0],e,!1))};return r.transfer=function(n){for(var a,i,o,c=[],u=1;u<arguments.length;u++)c[u-1]=arguments[u];if(!t.isClosed){var s=null!==(o=null!==(a=r.onPostMessageError)&&void 0!==a?a:null===(i=t.getOnPostMessageError)||void 0===i?void 0:i.call(t))&&void 0!==o?o:F;t.sendPost(e,c,s,n)}},r},e.prototype.createCallProxy=function(e){var t=this,r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return r.transfer.apply(r,Object(n.__spreadArray)([void 0],e,!1))};return r.transfer=function(n){for(var a,i,o,c=[],u=1;u<arguments.length;u++)c[u-1]=arguments[u];if(t.isClosed){var l={cause:"Connection",idInfo:t.idInfo,funcName:e};return Promise.reject(new s("".concat(t.idInfo.side," Endpoint's call.").concat(e," called after close"),l))}var d=null!==(o=null!==(a=r.callTimeout)&&void 0!==a?a:null===(i=t.getCallTimeout)||void 0===i?void 0:i.call(t))&&void 0!==o?o:1/0;return t.sendCall(e,c,d,n)},r.callTimeout=void 0,r},e}();var D=function(){function e(e,t,r){this.callTimeout=1/0,this.onPostMessageError=F,this._idInfo=e,this._state=t,this.createMode=r;var n=function(t){return function(){var r="Outside"===e.side?"inside":"outside",n={cause:"Connection",idInfo:e};throw new s("".concat(e.side," Endpoint's ").concat(t," referenced before the ").concat(r," Endpoint started"),n)}};Object.defineProperties(this,{post:{configurable:!0,enumerable:!1,get:n("post")},call:{configurable:!0,enumerable:!1,get:n("call")}})}return e._create=function(t,r,n){var a,i,o=r.port,c=r.options,u=r.createMode,l={type:"Endpoint",side:t,id:null==c?void 0:c.id};try{a=new M(l,o),i=new e(l,a,u)}catch(e){return Promise.reject(e)}return new Promise((function(e,r){var o;a.getCallTimeout=function(){return i.callTimeout},a.getOnPostMessageError=function(){return i.onPostMessageError},a.onImports=function(e,t){Object.defineProperties(i,{post:{configurable:!0,enumerable:!1,writable:!1,value:e},call:{configurable:!0,enumerable:!1,writable:!1,value:t}}),f.resolve()},a.onClose=function(){return i.close("Force")};var u,d=function(e){var t,r;return null!==(r=null!==(t=null==e?void 0:e.createTimeout)&&void 0!==t?t:null==b?void 0:b.createTimeout)&&void 0!==r?r:3e5}(c),f=T(d,(function(){var e="Outside"===t?"inside":"outside",r={cause:"Timeout",idInfo:l,timeout:d},n=new s("".concat(t," Endpoint timed out waiting for the ").concat(e," to start"),r);f.reject(n)}),{resolve:e,reject:r});i._closedDuringCreate=function(){f.resolve()};try{u=n(i)}catch(e){return f.reject(e)}null===(o=i._state)||void 0===o||o.setExports(u)})).then((function(){return i._closedDuringCreate=void 0,i}),(function(e){return i._closedDuringCreate=void 0,i.close(),Promise.reject(e)}))},e.prototype.hasBeenClosed=function(){return void 0===this._state},e.prototype.close=function(e){var t,r;if(this._state){if(this._closedDuringCreate){if("Force"!==e){var n={cause:"Connection",idInfo:this._idInfo};throw new s("".concat(this._idInfo.side," Endpoint's close called during creation"),n)}this._closedDuringCreate()}var a=this._state;this._state=void 0;try{a.close(),null===(t=this._onClose)||void 0===t||t.call(this),null===(r=this.onClose)||void 0===r||r.call(this)}catch(e){n={cause:"Connection",idInfo:this._idInfo,error:o(e)};j(new s("".concat(this._idInfo.side," Endpoint's close threw an error"),n))}}},e.createOutside=function(t,r){return void 0===r&&(r=function(){}),e._create("Outside",t,r)},e.createInside=function(t,r){return e._create("Inside",t,r)},e}(),P='!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=12)}([function(e,t,r){"use strict";r.r(t),r.d(t,"__extends",(function(){return o})),r.d(t,"__assign",(function(){return a})),r.d(t,"__rest",(function(){return i})),r.d(t,"__decorate",(function(){return u})),r.d(t,"__param",(function(){return c})),r.d(t,"__metadata",(function(){return f})),r.d(t,"__awaiter",(function(){return l})),r.d(t,"__generator",(function(){return s})),r.d(t,"__createBinding",(function(){return d})),r.d(t,"__exportStar",(function(){return p})),r.d(t,"__values",(function(){return y})),r.d(t,"__read",(function(){return v})),r.d(t,"__spread",(function(){return _})),r.d(t,"__spreadArrays",(function(){return g})),r.d(t,"__spreadArray",(function(){return b})),r.d(t,"__await",(function(){return h})),r.d(t,"__asyncGenerator",(function(){return m})),r.d(t,"__asyncDelegator",(function(){return w})),r.d(t,"__asyncValues",(function(){return O})),r.d(t,"__makeTemplateObject",(function(){return j})),r.d(t,"__importStar",(function(){return S})),r.d(t,"__importDefault",(function(){return P})),r.d(t,"__classPrivateFieldGet",(function(){return T})),r.d(t,"__classPrivateFieldSet",(function(){return x}));var n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r])})(e,t)};function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}var a=function(){return(a=Object.assign||function(e){for(var t,r=1,n=arguments.length;r<n;r++)for(var o in t=arguments[r])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e}).apply(this,arguments)};function i(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}function u(e,t,r,n){var o,a=arguments.length,i=a<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,r):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)i=Reflect.decorate(e,t,r,n);else for(var u=e.length-1;u>=0;u--)(o=e[u])&&(i=(a<3?o(i):a>3?o(t,r,i):o(t,r))||i);return a>3&&i&&Object.defineProperty(t,r,i),i}function c(e,t){return function(r,n){t(r,n,e)}}function f(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)}function l(e,t,r,n){return new(r||(r=Promise))((function(o,a){function i(e){try{c(n.next(e))}catch(e){a(e)}}function u(e){try{c(n.throw(e))}catch(e){a(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r((function(e){e(t)}))).then(i,u)}c((n=n.apply(e,t||[])).next())}))}function s(e,t){var r,n,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function u(a){return function(u){return function(a){if(r)throw new TypeError("Generator is already executing.");for(;i;)try{if(r=1,n&&(o=2&a[0]?n.return:a[0]?n.throw||((o=n.return)&&o.call(n),0):n.next)&&!(o=o.call(n,a[1])).done)return o;switch(n=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,n=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!(o=i.trys,(o=o.length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=t.call(e,i)}catch(e){a=[6,e],n=0}finally{r=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,u])}}}var d=Object.create?function(e,t,r,n){void 0===n&&(n=r),Object.defineProperty(e,n,{enumerable:!0,get:function(){return t[r]}})}:function(e,t,r,n){void 0===n&&(n=r),e[n]=t[r]};function p(e,t){for(var r in e)"default"===r||Object.prototype.hasOwnProperty.call(t,r)||d(t,e,r)}function y(e){var t="function"==typeof Symbol&&Symbol.iterator,r=t&&e[t],n=0;if(r)return r.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&n>=e.length&&(e=void 0),{value:e&&e[n++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function v(e,t){var r="function"==typeof Symbol&&e[Symbol.iterator];if(!r)return e;var n,o,a=r.call(e),i=[];try{for(;(void 0===t||t-- >0)&&!(n=a.next()).done;)i.push(n.value)}catch(e){o={error:e}}finally{try{n&&!n.done&&(r=a.return)&&r.call(a)}finally{if(o)throw o.error}}return i}function _(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(v(arguments[t]));return e}function g(){for(var e=0,t=0,r=arguments.length;t<r;t++)e+=arguments[t].length;var n=Array(e),o=0;for(t=0;t<r;t++)for(var a=arguments[t],i=0,u=a.length;i<u;i++,o++)n[o]=a[i];return n}function b(e,t,r){if(r||2===arguments.length)for(var n,o=0,a=t.length;o<a;o++)!n&&o in t||(n||(n=Array.prototype.slice.call(t,0,o)),n[o]=t[o]);return e.concat(n||Array.prototype.slice.call(t))}function h(e){return this instanceof h?(this.v=e,this):new h(e)}function m(e,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n,o=r.apply(e,t||[]),a=[];return n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n;function i(e){o[e]&&(n[e]=function(t){return new Promise((function(r,n){a.push([e,t,r,n])>1||u(e,t)}))})}function u(e,t){try{(r=o[e](t)).value instanceof h?Promise.resolve(r.value.v).then(c,f):l(a[0][2],r)}catch(e){l(a[0][3],e)}var r}function c(e){u("next",e)}function f(e){u("throw",e)}function l(e,t){e(t),a.shift(),a.length&&u(a[0][0],a[0][1])}}function w(e){var t,r;return t={},n("next"),n("throw",(function(e){throw e})),n("return"),t[Symbol.iterator]=function(){return this},t;function n(n,o){t[n]=e[n]?function(t){return(r=!r)?{value:h(e[n](t)),done:"return"===n}:o?o(t):t}:o}}function O(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t,r=e[Symbol.asyncIterator];return r?r.call(e):(e=y(e),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(r){t[r]=e[r]&&function(t){return new Promise((function(n,o){(function(e,t,r,n){Promise.resolve(n).then((function(t){e({value:t,done:r})}),t)})(n,o,(t=e[r](t)).done,t.value)}))}}}function j(e,t){return Object.defineProperty?Object.defineProperty(e,"raw",{value:t}):e.raw=t,e}var G=Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t};function S(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)"default"!==r&&Object.prototype.hasOwnProperty.call(e,r)&&d(t,e,r);return G(t,e),t}function P(e){return e&&e.__esModule?e:{default:e}}function T(e,t,r,n){if("a"===r&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!n:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===r?n:"a"===r?n.call(e):n?n.value:t.get(e)}function x(e,t,r,n,o){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!o)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!o:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?o.call(e,r):o?o.value=r:t.set(e,r),r}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var n=r(4),o={};function a(){return"undefined"==typeof __get_feature_gate_dictionary_variable?o:__get_feature_gate_dictionary_variable()}function i(e,t){var r;return null!==(r=a()[e])&&void 0!==r?r:t}t.getFeatureGateDictionary=a,t.getStringFeatureGate=i,t.getBooleanFeatureGate=function(e,t){var r,n=null===(r=i(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===n||"false"!==n&&t},t.getNumberFeatureGate=function(e,t){var r,n=null===(r=i(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===n)return t;if("infinity"===n||"+infinity"===n)return 1/0;if("-infinity"===n)return-1/0;var o=parseFloat(n);return isNaN(o)?t:o},t.getIntFeatureGate=function(e,t){var r,n=null===(r=i(e))||void 0===r?void 0:r.trim();if(void 0===n)return t;var o=parseInt(n,10);return isNaN(o)?t:o},t.setFeatureGateDictionaryGetter=function(e){var t=n.globalThis.__get_feature_gate_dictionary_variable;return n.globalThis.__get_feature_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0;var n=r(4);function o(){return"undefined"==typeof __get_change_gate_dictionary_variable?null:__get_change_gate_dictionary_variable()}t.getChangeGateDictionary=o,t.isChangeGateEnabled=function(e){var t,r=o();return null!==r&&(null===(t=r[e])||void 0===t||t)},t.setChangeGateDictionaryGetter=function(e){var t=n.globalThis.__get_change_gate_dictionary_variable;return n.globalThis.__get_change_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(0);n.__exportStar(r(1),t),n.__exportStar(r(8),t),n.__exportStar(r(2),t),n.__exportStar(r(9),t),n.__exportStar(r(10),t),n.__exportStar(r(11),t)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalThis=void 0;var n=r(5);t.globalThis=n},function(e,t,r){"use strict";e.exports=r(6)()?globalThis:r(7)},function(e,t,r){"use strict";e.exports=function(){return"object"==typeof globalThis&&(!!globalThis&&globalThis.Array===Array)}},function(e,t){var r=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return r()}try{return __global__||r()}finally{delete Object.prototype.__global__}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var n=r(1);t.makeGetTypedFeatureGate=function(e){return function(t){var r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var n=r(2);t.makeTypedIsChangeGateEnabled=function(e){return function(e){return(0,n.isChangeGateEnabled)(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var n=r(0),o=r(2);function a(e){var t=(0,o.setChangeGateDictionaryGetter)(void 0);return void 0===t?(0,o.setChangeGateDictionaryGetter)(void 0):(0,o.setChangeGateDictionaryGetter)((function(){var r=t();return null===r?null:n.__assign(n.__assign({},r),e)})),t}t.overrideChangeGates=a,t.overrideTypedChangeGates=function(e,t){return a(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var n=r(0),o=r(1);function a(e){for(var t,r,a={},i=0,u=Object.keys(e);i<u.length;i++){var c=u[i];a[c]=null===(t=e[c])||void 0===t?void 0:t.toString()}var f=null!==(r=(0,o.setFeatureGateDictionaryGetter)(void 0))&&void 0!==r?r:function(){return{}};return(0,o.setFeatureGateDictionaryGetter)((function(){return n.__assign(n.__assign({},f()),a)})),f}t.overrideFeatureGates=a,t.overrideTypedFeatureGates=function(e,t){return a(t)}},function(e,t,r){"use strict";r.r(t);var n=r(0);function o(e){return a(e)&&"WorkerError"===e.name&&"object"==typeof e.info}function a(e){if(null==e)return!1;if(e instanceof Error)return!0;var t=e;return"string"==typeof t.name&&"string"==typeof t.message&&(null==t.stack||"string"==typeof t.stack)}function i(e){return a(e)?e:new Error("(non-Error object) ".concat(function(e){var t=typeof e;switch(t){case"function":case"symbol":case"undefined":return"<".concat(t,">");case"object":return JSON.stringify(e);default:return"".concat(e)}}(e)))}function u(e){return{name:e.name,message:o(e)?e.baseMessage:e.message,stack:e.stack,info:o(e)?(t=e.info,Object(n.__assign)(Object(n.__assign)({},t),{error:t.error?u(t.error):void 0})):void 0};var t}function c(e){throw new ReferenceError("".concat(e," is not defined"))}function f(e,t,r){void 0===r&&(r=c);try{for(var n=t.split("."),o=0,a=n;o<a.length;o++){e=e[a[o]]}return null!=e?e:r(t)}catch(e){return r(t)}}var l=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return l.transfer.apply(l,Object(n.__spreadArray)([e,void 0],t,!1))};l.transfer=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return{def:e,args:r,transferables:null!=t?t:[]}};var s="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function d(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:s()))}function p(e,t,r){var n=e.indexOf("?");if(n<0)return"".concat(e,"?").concat(t,"=").concat(r);for(var o=e.slice(0,n+1),a=e.slice(n+1).split("&"),i=0;i<a.length&&("="!==a[i][t.length]||a[i].slice(0,t.length)!==t);i+=1);return a[i]="".concat(t,"=").concat(r),o+a.join("&")}function y(e,t){for(var r,n=0;n<=t;n+=1)try{return void importScripts(n>0?p(e,"retries",String(n)):e)}catch(e){r=e}throw r}function v(e,t){if(0!==t)for(var r=0,n=e;r<n.length;r++){y(n[r],t)}else importScripts.apply(void 0,e)}var _=r(3);self.onmessage=function(e){var t,r,c=e.data,l=c.config,p=c.port,y=c.options,g=c.script,b=c.args,h=c.featureGateDictionary,m=c.changeGateDictionary;self.onmessage=null,self.__typed_workers_thread=!0,Object(_.setFeatureGateDictionaryGetter)((function(){return h})),Object(_.setChangeGateDictionaryGetter)((function(){return m}));var w,O=null!==(r=null!==(t=y.importScriptsMaxRetries)&&void 0!==t?t:l.importScriptsMaxRetries)&&void 0!==r?r:0;function j(){var e;if(w)return w;if(void 0===l.typedWorkersUrl)throw new TypeError("importTypedWorkers: typedWorkersUrl is not defined");return v([l.typedWorkersUrl],O),(w=f(self,null!==(e=l.typedWorkersName)&&void 0!==e?e:"typedWorkers")).setConfig(l),w}var G={status:"Pending",start:s()};function S(e,t){var r,n={kind:0,error:e?void 0:a(r=i(t))?{isError:!0,value:u(r)}:{isError:!1,value:r},stopwatch:G};self.postMessage(n),e||setTimeout(self.close.bind(self),6e4)}try{(function(e,t){function r(t){throw d(e,o(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!==(r=d(e,"Success"))&&void 0!==r?r:t}),r)}catch(e){r(e)}})(G,(function(){var e,t;return v(Object(n.__spreadArray)(Object(n.__spreadArray)([],null!==(t=null!==(e=null==y?void 0:y.importScriptUrls)&&void 0!==e?e:l.importScriptUrls)&&void 0!==t?t:[],!0),void 0!==g.scriptUrl?[g.scriptUrl]:[],!0),O),f(self,g.insideInitName).apply(void 0,Object(n.__spreadArray)([{config:l,importTypedWorkers:j,connection:{port:p,options:y,createMode:"Thread"}}],b,!1))})).then((function(){return S(!0)}),(function(e){return S(!1,e)}))}catch(e){S(!1,e)}}}]);',x=-1;var L=function(){function e(e,t){var r,n;try{var a;r=function(e){var t="def"in e?e:C(e),r=t.def,n=t.args,a=t.transferables;if("function"!=typeof r)return[r,n,a,void 0];var i="__generatedInsideInit".concat(x+=1);return[{scriptUrl:void 0,insideInitName:i},n,a,"var ".concat(i," = ").concat(r.toString(),";")]}(t),this.script=r[0],this.args=r[1],this.transferables=r[2];var i=void 0===(a=r[3])?[P]:[a,"\n\n",P];this.blobUrl=URL.createObjectURL(new Blob(i,{type:"application/javascript"}));var o={};null!=e.id&&(o.name=e.id),this.worker=new Worker(this.blobUrl,o)}catch(e){throw null===(n=this.worker)||void 0===n||n.terminate(),this.revokeBlobUrl(),e}}return e.prototype.revokeBlobUrl=function(){void 0!==this.blobUrl&&(URL.revokeObjectURL(this.blobUrl),this.blobUrl=void 0)},e.prototype.createInside=function(e,t){var r=this,o=e.port,c=e.options,u={type:"Thread",side:"Outside",id:c.id},l=this.worker;return A(new Promise((function(e,d){r.createCallbacks={resolve:e,reject:d};var b={config:p(),port:o,options:c,script:r.script,args:r.args,featureGateDictionary:Object(k.getFeatureGateDictionary)(),changeGateDictionary:Object(k.getChangeGateDictionary)()};l.postMessage(b,Object(n.__spreadArray)([o],r.transferables,!0)),l.onerror=function(e){e.preventDefault();var t=function(e,t,r){if(i(r.error)){if(a(r.error))return r.error;var n={cause:"UnhandledError",idInfo:e,error:r.error};return new s("".concat(t," received an unhandled error"),n)}if(null==r.message){var o={cause:"UnhandledError",idInfo:e};return new s("".concat(t," received a non-error (worker script fetch probably failed)"),o)}var c={cause:"UnhandledError",idInfo:e},u="".concat(r.message," at ").concat(r.filename,":").concat(r.lineno,":").concat(r.colno);return new s("".concat(t," received an unhandled error: ").concat(u),c)}(u,"worker.onerror",e);r.createCallbacks?r.createCallbacks.reject(t):j(t)},l.onmessage=function(e){var n,a,i=e.data;switch(i.kind){case 0:return t.insideInit=i.stopwatch,void 0===i.error?null===(n=r.createCallbacks)||void 0===n?void 0:n.resolve():null===(a=r.createCallbacks)||void 0===a?void 0:a.reject(f(i.error));case 1:return j(f(i.error));case 2:return S(i.stats)}}})),(function(){r.createCallbacks=void 0}))},e.prototype.terminate=function(){var e;if(this.worker){var t=this.worker;this.worker=void 0,null===(e=this.createCallbacks)||void 0===e||e.resolve(),t.terminate(),this.revokeBlobUrl()}},e}(),B="undefined"!=typeof performance&&void 0!==performance.timeOrigin?function(){return performance.now()+performance.timeOrigin}:function(){return Date.now()};function U(){return{status:"Pending",start:B()}}function G(e,t,r){"Pending"===e.status&&(e.status=t,e.end=Math.max(e.start,null!=r?r:B()))}function V(e,t){function r(t){throw G(e,a(t)&&"Timeout"===t.info.cause?"Timeout":"Error"),t}try{return t().then((function(t){var r;return null!==(r=G(e,"Success"))&&void 0!==r?r:t}),r)}catch(e){r(e)}}function H(e){return Math.round(1e3*e)/1e3}function W(e,t,r){return e<t?t:e>r?r:e}function z(e,t,r){var n,a,i,o=W(null!==(n=null==e?void 0:e.start)&&void 0!==n?n:1/0,t,r),c=W(null!==(a=null==e?void 0:e.end)&&void 0!==a?a:1/0,t,r);return{status:null!==(i=null==e?void 0:e.status)&&void 0!==i?i:"Pending",start:H(o-t),end:H(c-t),duration:H(c-o)}}var q=function(){return r(55)};function K(e,t,r,n,a){var i,o=new MessageChannel,c=o.port1,u=o.port2;return Promise.all([n({port:c,options:e,createMode:t}),V(r.createOutside=U(),(function(){return D.createOutside({port:u,options:e,createMode:t},(function(e){return a(i=e)}))}))]).then((function(){return i}),(function(e){return i?i.close("Force"):u.close(),Promise.reject(e)}))}function Y(e,t,r,a){return K(e,"Local",t,(function(e){return function(e,t,r){var a="def"in r?r:C(r),i=a.def,o=a.args;if("function"!=typeof i){var c={cause:"InternalError",idInfo:{type:"Endpoint",side:"Inside",id:e.options.id}};return Promise.reject(new s("Loading an InsideScript to create a local worker is unimplemented",c))}return Promise.resolve().then((function(){return V(t.insideInit=U(),(function(){return i.apply(void 0,Object(n.__spreadArray)([{config:p(),importTypedWorkers:q,connection:e}],o,!1)).then((function(){}))}))}))}(e,t,r)}),a)}function J(e,t,r,n){var a;t.createThread=U();try{a=new L(e,r)}catch(e){return G(t.createThread,"Error"),Promise.reject(e)}return G(t.createThread,"Success"),K(e,"Thread",t,(function(e){return a.createInside(e,t)}),n).then((function(e){return e.hasBeenClosed()?a.terminate():e._onClose=a.terminate.bind(a),e}),(function(e){return a.terminate(),Promise.reject(e)}))}function Q(e,t,r){void 0===r&&(r=function(){});var n=function(e){var t,r,n=null!==(r=null!==(t=null==e?void 0:e.createMode)&&void 0!==t?t:null==b?void 0:b.createMode)&&void 0!==r?r:"Thread";return"ThreadOrLocal"===n?h()?"Thread":"Local":n}(e),a="local"in t?"Local"===n?t.local:t.thread:t,i="Local"===n?Y:J,o={id:e.id,createMode:n,createWorker:U()};return A(V(o.createWorker,(function(){return i(function(e){return{id:e.id,createTimeout:e.createTimeout,createMode:e.createMode,importScriptUrls:e.importScriptUrls,importScriptsMaxRetries:e.importScriptsMaxRetries}}(e),o,a,r)})),(function(){var e=function(e){var t=e.id,r=e.createMode,n=e.createWorker,a=e.insideInit,i=e.createOutside,o=e.createThread,c=n.status,u=n.start,s=n.end;if("Pending"!==c&&void 0!==s)return{id:t,createMode:r,createWorker:{status:c,absStart:u,duration:H(s-u)},createThread:"Thread"===r?z(o,u,s):void 0,createOutside:z(i,u,s),insideInit:z(a,u,s)}}(o);e&&S(e)}))}function X(e,t,r){var n=e.indexOf("?");if(n<0)return"".concat(e,"?").concat(t,"=").concat(r);for(var a=e.slice(0,n+1),i=e.slice(n+1).split("&"),o=0;o<i.length&&("="!==i[o][t.length]||i[o].slice(0,t.length)!==t);o+=1);return i[o]="".concat(t,"=").concat(r),a+i.join("&")}function Z(e,t){for(var r,n=0;n<=t;n+=1)try{return void importScripts(n>0?X(e,"retries",String(n)):e)}catch(e){r=e}throw r}function $(e,t){if(0!==t)for(var r=0,n=e;r<n.length;r++){Z(n[r],t)}else importScripts.apply(void 0,e)}r.d(t,"WorkerError",(function(){return s})),r.d(t,"isThreadingSupported",(function(){return h})),r.d(t,"setConfig",(function(){return v})),r.d(t,"dispatchWorkerError",(function(){return j})),r.d(t,"paramInsideDef",(function(){return C})),r.d(t,"Endpoint",(function(){return D})),r.d(t,"createWorker",(function(){return Q})),r.d(t,"importScriptsWithRetry",(function(){return $}))},function(e,t,r){"use strict";r.d(t,"b",(function(){return c})),r.d(t,"d",(function(){return u})),r.d(t,"a",(function(){return s})),r.d(t,"c",(function(){return l}));var n,a=r(9),i=r(3),o=r(0);function c(e){return{config:e}}function u(e,t,r){return{config:null!=r?r:void 0,lexicalKind:e,originGridCell:Object(o.f)(t)}}!function(e){e.NotFormulaString="NotFormulaString"}(n||(n={}));var s=Object(a.__assign)(Object(a.__assign)({},i.b),n);function l(e){return{kind:s.NotFormulaString,message:e}}},function(e,t,r){"use strict";var n,a;r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return a})),function(e){e[e.Function=3]="Function",e[e.NamedRange=100]="NamedRange",e[e.TableHeader=101]="TableHeader",e[e.LetVariable=102]="LetVariable",e[e.RichEntity=103]="RichEntity",e[e.Lambda=104]="Lambda",e[e.CustomFunction=105]="CustomFunction",e[e.Table=106]="Table",e[e.TableSpecialStructRef=107]="TableSpecialStructRef"}(n||(n={})),function(e){e[e.Simple=0]="Simple",e[e.Smart=1]="Smart"}(a||(a={}))},function(e,t,r){"use strict";var n={};r.r(n),r.d(n,"getExcelOnlineCalcNewPackagesNames",(function(){return U})),r.d(n,"checkRequest",(function(){return V})),r.d(n,"ResponseState",(function(){return z}));var a={};r.r(a),r.d(a,"InternalSchedulerResponseKind",(function(){return W})),r.d(a,"wrapSyncRequest",(function(){return q})),r.d(a,"wrapRequest",(function(){return K})),r.d(a,"checkSyncRequest",(function(){return J}));var i={};r.r(i),r.d(i,"PrefetchingCache",(function(){return ct}));var o={};r.r(o),r.d(o,"createGridProvider",(function(){return lt})),r.d(o,"createGridImportManager",(function(){return dt})),r.d(o,"createPrefetchingCacheFactory",(function(){return ft})),r.d(o,"timelineQueueProcessorFactory",(function(){return bt})),r.d(o,"createFormulaBarScheduler",(function(){return ht})),r.d(o,"createExperimentFormulaBarScheduler",(function(){return vt})),r.d(o,"createDynamicPluginLoader",(function(){return pt})),r.d(o,"createRecalcSideGrid",(function(){return mt})),r.d(o,"dynamicPluginLoaderInsideInit",(function(){return we})),r.d(o,"createIGridFromRecalcService",(function(){return gt})),r.d(o,"Cache",(function(){return Ot})),r.d(o,"SchedulerMessages",(function(){return jt})),r.d(o,"PluginMessages",(function(){return yt}));var c={};r.r(c),r.d(c,"createGridProvider",(function(){return lt})),r.d(c,"createGridImportManager",(function(){return dt})),r.d(c,"createPrefetchingCacheFactory",(function(){return ft})),r.d(c,"timelineQueueProcessorFactory",(function(){return bt})),r.d(c,"createFormulaBarScheduler",(function(){return ht})),r.d(c,"createExperimentFormulaBarScheduler",(function(){return vt})),r.d(c,"createDynamicPluginLoader",(function(){return pt})),r.d(c,"createRecalcSideGrid",(function(){return mt})),r.d(c,"dynamicPluginLoaderInsideInit",(function(){return we})),r.d(c,"createIGridFromRecalcService",(function(){return gt})),r.d(c,"Cache",(function(){return Ot})),r.d(c,"SchedulerMessages",(function(){return jt})),r.d(c,"PluginMessages",(function(){return yt}));var u,s,l=r(9),d=r(30),f=r(10),b=r(12),h=r(42),v=r(5),p=r(4),m=r(14),g=r(41),O=r(0),j=r(89),y=r(67),S=r(57),C={formulaHighlighting:function(e){if(1===e.length){var t=e[0][1];return{tokens:t.tokens,colors:t.colors,styles:t.styles}}if(0===e.length)return null;throw new Error("Conflict resolver: formula highlighting: ".concat(e.length," results received, while only one active plugin is currently supported"))},functionSuggestion:function(e){for(var t=[],r=[],n=0,a=e;n<a.length;n++){var i=a[n],o=i[0],c=i[1];u(o)===S.b.Smart?Object(f.e)(c.items)&&c.items.filter(f.e).forEach((function(e){return t.push(Object(l.__assign)(Object(l.__assign)({},e),{type:S.b.Smart}))})):Object(f.e)(c.items)&&c.items.filter(f.e).forEach((function(e){return r.push(Object(l.__assign)(Object(l.__assign)({},e),{type:S.b.Simple}))}))}return{items:Object(l.__spreadArray)(Object(l.__spreadArray)([],t,!0),r.sort((function(e,t){if(Object(f.e)(e.label)&&Object(f.e)(t.label))return Object(f.e)(e.isPrefixed)&&Object(f.e)(t.isPrefixed)&&e.isPrefixed!==t.isPrefixed?e.isPrefixed?-1:1:e.label.toLocaleLowerCase()>t.label.toLocaleLowerCase()?1:-1;return Object(f.e)(e.label)?1:Object(f.e)(t.label)?-1:0})),!0)};function u(e){switch(e){case h.a.AutocompletePlugin:case h.a.FormulaRepairPlugin:case h.a.FormulaCollectionPlugin:return S.b.Smart;case h.a.TestPlugin:case h.a.DragPlugin:case h.a.ConfigTestPlugin:case h.a.FeatureGateTestPlugin:case h.a.ChangeGateTestPlugin:case h.a.DNMTraceTagTestPlugin:case h.a.SlowTestPlugin:case h.a.AutocompleteFunctionPlugin:case h.a.AutocompleteLetPlugin:case h.a.AutocompleteRichValuePlugin:case h.a.AutocompleteNamedObjectsPlugin:return S.b.Simple;default:Object(v.e)("unknown plugin factory name: ".concat(e),e)}}},argumentAssistance:function(e){if(0===e.length)return null;if(1===e.length)return e[0][1];throw new Error("Conflict resolver: argumentAssistance: ".concat(e.length," results received, while only one active plugin is currently supported"))},runExperiment:function(e){for(var t=[],r=0,n=e;r<n.length;r++){var a=n[r],i=(a[0],a[1]);Object(f.e)(i.results)&&t.push.apply(t,i.results.filter(f.e))}return{results:t}},runAuthoringExperiment:function(e){for(var t=[],r=0,n=e;r<n.length;r++){var a=n[r],i=(a[0],a[1]);Object(f.e)(i.results)&&t.push.apply(t,i.results.filter(f.e))}return{results:t}},parenthesesCoupling:function(e){if(0===e.length)return null;if(1===e.length)return e[0][1];throw new Error("Conflict resolver: parenthesesCoupling: ".concat(e.length," results received, while only one active plugin is currently supported"))}},k=r(74);!function(e){e.FunctionSuggestionAndArgumentAssistance="FunctionSuggestionAndArgumentAssistance"}(s||(s={}));var E,A=((u={})[s.FunctionSuggestionAndArgumentAssistance]=[m.c.functionSuggestion,m.c.argumentAssistance],u);function N(e){return!(Object(f.e)(e)&&Object(f.e)(e.items)&&e.items.length>0)}Object(f.r)(),Object(f.r)(),Object(f.r)(),Object(f.r)(),Object(f.r)();var T=function(){function e(){this.argumentAssistanceResult=null,this.functionSuggestionResult=null,this.argumentAssistanceSet=!1,this.functionSuggestionSet=!1,this.promise=new k.a}return e.prototype.consumeResult=function(e){var t;switch(e.kind){case m.c.functionSuggestion:if(Object(v.h)("functionSuggestionSet should be false when receiving functionSuggestion request",!this.functionSuggestionSet),Object(f.e)(e.result)&&Object(f.e)(e.result.items)&&e.result.items.length>0&&(null===(t=e.result.items[e.result.items.length-1])||void 0===t?void 0:t.type)===S.b.Simple)return this.promise.resolve({functionSuggestion:e.result,argumentAssistance:null});if(this.argumentAssistanceSet)return null!==this.argumentAssistanceResult?this.promise.resolve({functionSuggestion:null,argumentAssistance:this.argumentAssistanceResult}):N(e.result)?this.promise.resolve({functionSuggestion:null,argumentAssistance:null}):this.promise.resolve({functionSuggestion:e.result,argumentAssistance:null});N(e.result)||(this.functionSuggestionResult=e.result),this.functionSuggestionSet=!0;break;case m.c.argumentAssistance:if(Object(v.h)("argumentAssistanceSet should be false when receiving argumentAssistance request",!this.argumentAssistanceSet),this.functionSuggestionSet)return null!==e.result?this.promise.resolve({functionSuggestion:null,argumentAssistance:e.result}):this.promise.resolve({functionSuggestion:this.functionSuggestionResult,argumentAssistance:null});this.argumentAssistanceResult=e.result,this.argumentAssistanceSet=!0;break;default:Object(v.e)("unknown result: ".concat(e),e)}},e.create=function(){return new e},e}();Object(f.r)();var R=((E={})[s.FunctionSuggestionAndArgumentAssistance]=T,E);Object(f.r)();var I,_=r(117),F=r(101),w=r(18),M=r(20),D=r(143),P=r(144),x=r(145),L=r(146),B="".concat(M.PackageName,", ").concat(D.PackageName,",\n  ").concat(P.PackageName,", ").concat(x.PackageName,", ").concat(L.PackageName);function U(){return B}var G=((I={})[m.b.GetSheetNames]=!0,I[m.b.GetRange]=!0,I[m.b.Delay]=!0,I[m.b.GetCell]=!0,I[m.b.GetContainingTable]=!0,I[m.b.GetIntersectingTables]=!0,I[m.b.GetIformat]=!0,I[m.b.ParseCellFormula]=!0,I[m.b.ParseEdit]=!0,I[m.b.ParseActiveCell]=!0,I[m.b.ParseNumberFormat]=!0,I[m.b.PrintFormula]=!0,I[m.b.GetActiveCell]=!0,I[m.b.GetConfig]=!0,I[m.b.AwaitPromise]=!0,I[m.b.GetFunctionsInfo]=!0,I[m.b.GetFunctionInfo]=!0,I[m.b.GetCorrelationId]=!0,I[m.b.SetActiveCell]=!0,I[m.b.GetRichValueFieldListContext]=!0,I[m.b.GetHiddenRows]=!0,I[m.b.GetHiddenCols]=!0,I[m.b.GetDefinedNameInfo]=!0,I[m.b.GetDefinedNamesInfo]=!0,I[m.b.ResolveReferences]=!0,I);function V(e){return!0===G[e.kind]}Object(f.u)(),Object(f.r)(),Object(f.r)();var H,W,z=function(){function e(e){this.pluginKind=e,this.numPlugins=0,this.numSyncPlugins=0}return Object.defineProperty(e.prototype,"uiMessageFrame",{get:function(){return this._uiMessageFrame},enumerable:!1,configurable:!0}),e.prototype.createUIMessageFrame=function(e,t,r,n){var a=new k.a,i=this.pluginKind;return this._uiMessageFrame={correlationId:e,cache:t,config:r,startTime:n,successfulResults:{kind:i,results:[]},resolvable:a,numFailures:0},a},e.prototype.closeUIMessageFrame=function(e,t){var r,n=this.uiMessageFrame;if(n&&(this._uiMessageFrame=void 0,n.resolvable.resolve("UIMessage"===e?{kind:h.b.Superseded}:{kind:h.b.Done,payload:n.successfulResults}),null===(r=n.cache)||void 0===r||r.close(),this.numPlugins>0)){var a=this.pluginKind,i=this.numPlugins,o=n.correlationId,c=n.startTime,u={correlationId:o,pluginKind:a,numPlugins:i,numSent:n.successfulResults.results.length,stopReason:e,startTime:c,stopTime:t};p.B.ULS.traceTag(553734789,p.c.msoulscat_ES_EWAJS,p.i.Info,"x10arch.ResponseState.closeUIMessageFrame: ".concat(JSON.stringify(u)))}},e.prototype.stop=function(e,t){void 0!==this.uiMessageFrame&&this.closeUIMessageFrame(e,t)},e}();function q(e,t){switch(e.kind){case m.b.Delay:case m.b.GetActiveCell:case m.b.GetConfig:case m.b.GetCorrelationId:case m.b.GetFunctionInfo:case m.b.GetFunctionsInfo:case m.b.GetDefinedNameInfo:case m.b.GetDefinedNamesInfo:case m.b.SetActiveCell:return{kind:m.d.NoOpRequest,request:e,computation:t};case m.b.ParseCellFormula:case m.b.ParseNumberFormat:case m.b.PrintFormula:case m.b.ParseActiveCell:case m.b.ResolveReferences:return{kind:m.d.SyncRequest,request:e,computation:t};default:Object(v.e)("unknown request: ".concat(e),e)}}function K(e,t){switch(e.kind){case m.b.GetRange:case m.b.GetSheetNames:case m.b.GetCell:case m.b.GetContainingTable:case m.b.GetIntersectingTables:case m.b.GetIformat:case m.b.AwaitPromise:case m.b.ParseEdit:case m.b.GetRichValueFieldListContext:case m.b.GetHiddenRows:case m.b.GetHiddenCols:return{kind:m.d.AsyncRequest,request:e,computation:t};default:return q(e,t)}}!function(e){e[e.FirstStep=0]="FirstStep",e[e.NormalResponse=1]="NormalResponse",e[e.RequestFailure=2]="RequestFailure",e[e.AsyncException=3]="AsyncException"}(W||(W={})),Object(f.r)(),Object(f.r)(),Object(f.r)(),Object(f.r)();var Y=((H={})[m.b.Delay]=!0,H[m.b.ParseCellFormula]=!0,H[m.b.ParseActiveCell]=!0,H[m.b.ParseNumberFormat]=!0,H[m.b.PrintFormula]=!0,H[m.b.GetActiveCell]=!0,H[m.b.GetConfig]=!0,H[m.b.GetFunctionsInfo]=!0,H[m.b.GetFunctionInfo]=!0,H[m.b.GetDefinedNamesInfo]=!0,H[m.b.GetDefinedNameInfo]=!0,H[m.b.GetCorrelationId]=!0,H[m.b.SetActiveCell]=!0,H[m.b.ResolveReferences]=!0,H);function J(e){return!0===Y[e.kind]}Object(f.u)();var Q,X=r(79),Z=r(68),$=((Q={})[m.b.Delay]=function(){return Object(O.f)({})},Q[m.b.AwaitPromise]=function(e){var t=e.request.promise;return Object(l.__awaiter)(void 0,void 0,void 0,(function(){var e,r;return Object(l.__generator)(this,(function(n){switch(n.label){case 0:return n.trys.push([0,2,,3]),[4,t];case 1:return e=n.sent(),[2,Object(O.f)({result:e})];case 2:return r=n.sent(),[2,Object(O.c)(r)];case 3:return[2]}}))}))},Q[m.b.GetCell]=function(e){var t=e.request.cell,r=e.cache;return Object(l.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(l.__generator)(this,(function(n){switch(n.label){case 0:return void 0===r?[2,Object(O.c)(void 0)]:[4,r.getCell(t)];case 1:return e=n.sent(),[2,Object(O.f)({result:e})]}}))}))},Q[m.b.GetContainingTable]=function(e){var t=e.request.cell,r=e.cache;return Object(l.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(l.__generator)(this,(function(n){switch(n.label){case 0:return void 0===r?[2,Object(O.c)(void 0)]:[4,r.getContainingTable(t)];case 1:return e=n.sent(),[2,Object(O.f)({result:e})]}}))}))},Q[m.b.GetIntersectingTables]=function(e){var t=e.request.range,r=e.cache;return Object(l.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(l.__generator)(this,(function(n){switch(n.label){case 0:return void 0===r?[2,Object(O.c)(void 0)]:[4,r.getIntersectingTables(t)];case 1:return e=n.sent(),[2,Object(O.f)({result:e})]}}))}))},Q[m.b.GetRange]=function(e){var t=e.request,r=t.range,n=t.layers,a=e.cache;return Object(l.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(l.__generator)(this,(function(t){switch(t.label){case 0:return void 0===a?[2,Object(O.c)(void 0)]:[4,a.getRange(r,n)];case 1:return e=t.sent(),[2,Object(O.f)({localSheetGrid:e})]}}))}))},Q[m.b.GetSheetNames]=function(e){var t=e.cache;return Object(l.__awaiter)(void 0,void 0,void 0,(function(){return Object(l.__generator)(this,(function(e){return void 0===t?[2,Object(O.c)(void 0)]:[2,t.getSheetNames()]}))}))},Q[m.b.GetIformat]=function(e){var t=e.request,r=t.document,n=t.iformat,a=e.cache;return Object(l.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(l.__generator)(this,(function(t){switch(t.label){case 0:return void 0===a?[2,Object(O.c)(void 0)]:[4,a.getIformat(r,n)];case 1:return e=t.sent(),[2,Object(O.f)({result:e})]}}))}))},Q[m.b.ParseCellFormula]=function(e){var t=e.request,r=t.cell,n=t.formula,a=t.useEnglishLocaleInfo,i=e.cache;return void 0===i?Object(O.c)(void 0):Object(O.f)(i.parseCellFormula(r,n,a))},Q[m.b.ParseEdit]=function(e){var t=e.request,r=t.cell,n=t.formulaBarText,a=e.cache;return Object(l.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(l.__generator)(this,(function(t){switch(t.label){case 0:return void 0===a?[2,Object(O.c)(void 0)]:(e=O.f,[4,a.parseEdit(r,n)]);case 1:return[2,e.apply(void 0,[t.sent()])]}}))}))},Q[m.b.ParseActiveCell]=function(e){var t=e.request.formulaText,r=e.schedulerState,n=r.activeCell,a=r.activeCellFormat,i=e.cache;return void 0===i||Object(f.f)(n)||Object(f.f)(a)?Object(O.c)(void 0):Object(O.f)(i.parseEditSync(n,t,a))},Q[m.b.ParseNumberFormat]=function(e){var t=e.request,r=t.formatString,n=t.builtIn,a=e.cache;return void 0===a?Object(O.c)(void 0):Object(O.f)(a.parseNumberFormat(r,n))},Q[m.b.PrintFormula]=function(e){var t=e.request,r=t.formula,n=t.origin,a=e.config;if(void 0===a)return Object(O.c)([]);var i=Object(X.b)(Object(Z.a)(a)).printFormula(Object(Z.b)(Object(b.i)(b.a.Cell,n),n),r);return Object(O.f)({result:i})},Q[m.b.GetActiveCell]=function(e){var t=e.schedulerState.activeCell;return void 0===t?Object(O.c)(void 0):Object(O.f)({activeCell:t})},Q[m.b.GetConfig]=function(e){var t=e.config;return void 0===t?Object(O.c)(void 0):Object(O.f)({config:t})},Q[m.b.GetFunctionsInfo]=function(e){var t=e.schedulerState.functionsInfoMap;if(void 0===t)return Object(O.c)(void 0);var r=Object.keys(t).map((function(e){return t[e]}));return Object(O.f)({functionsInfo:r})},Q[m.b.GetFunctionInfo]=function(e){var t=e.request.functionName,r=e.schedulerState;if(void 0===r.functionsInfoMap)return Object(O.c)(void 0);var n=r.functionsInfoMap[t.toUpperCase()];return void 0===n?Object(O.c)(void 0):Object(O.f)({functionInfo:n})},Q[m.b.GetDefinedNamesInfo]=function(e){var t=e.schedulerState.definedNamesInfoMap;if(void 0===t)return Object(O.c)(void 0);var r=Object.keys(t).map((function(e){return t[e]}));return Object(O.f)({definedNamesInfo:r})},Q[m.b.GetDefinedNameInfo]=function(e){var t=e.request.definedName,r=e.schedulerState;if(void 0===r.definedNamesInfoMap)return Object(O.c)(void 0);var n=r.definedNamesInfoMap[t.toUpperCase()];return Object(O.f)({definedNameInfo:n})},Q[m.b.GetCorrelationId]=function(e){var t=e.correlationId;return Object(O.f)({correlationId:t})},Q[m.b.SetActiveCell]=function(e){return e.schedulerState=Object(l.__assign)(Object(l.__assign)({},e.schedulerState),{activeCell:e.request.activeCell,activeCellFormat:e.request.activeCellFormat}),Object(O.f)({})},Q[m.b.GetRichValueFieldListContext]=function(e){var t=e.schedulerState,r=e.request,n=r.rangeToQuery,a=r.dotNotationPath,i=r.singleColumn,o=r.findRange;return Object(l.__awaiter)(void 0,void 0,void 0,(function(){var e,r;return Object(l.__generator)(this,(function(c){switch(c.label){case 0:return e=t.serverDataProvider,Object(f.f)(e)?[2,Object(O.c)(void 0)]:[4,e.getRichValueFieldListContext(n,a,i,o)];case 1:return r=c.sent(),Object(f.f)(r)?[2,Object(O.c)(void 0)]:[2,Object(O.f)({result:r.filter(f.e)})]}}))}))},Q[m.b.GetHiddenRows]=function(e){var t=e.cache,r=e.request;return Object(l.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(l.__generator)(this,(function(n){switch(n.label){case 0:return void 0===t?[2,Object(O.c)([])]:[4,t.getHiddenRows(r.sheet,r.start,r.endExclusive)];case 1:return e=n.sent(),[2,Object(O.f)({result:e})]}}))}))},Q[m.b.GetHiddenCols]=function(e){var t=e.cache,r=e.request;return Object(l.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(l.__generator)(this,(function(n){switch(n.label){case 0:return void 0===t?[2,Object(O.c)([])]:[4,t.getHiddenCols(r.sheet,r.start,r.endExclusive)];case 1:return e=n.sent(),[2,Object(O.f)({result:e})]}}))}))},Q[m.b.ResolveReferences]=function(e){var t=e.schedulerState.activeCell,r=e.cache,n=e.request.nodes;if(void 0===r||void 0===t||void 0===n)return Object(O.c)(void 0);var a=r.resolveReferences(n,t);return Object(O.f)({resolverResults:a})},Q);function ee(e,t,r,n,a){var i={request:t,correlationId:r.info.correlationId,cache:n,config:a,schedulerState:r.schedulerState},o=(0,e[t.kind])(i);return o.kind!==O.b.Success?Object(O.c)(void 0):(r.schedulerState=i.schedulerState,Object(O.f)(Object(l.__assign)({kind:t.kind},o.value)))}var te,re=r(91),ne=r(45),ae=r(2),ie=r(87),oe=r(47),ce=r(31),ue=r(38),se=r(116),le=r(115),de=r(3),fe=function(e){function t(){var t=e.call(this,ie.b)||this;return t.sheets=void 0,t.nameManager=void 0,t.configNotifications=[],t}return Object(l.__extends)(t,e),t.prototype.getStateAsNotifications=function(){return this.configNotifications},t.prototype.setA1ReferenceStyle=function(e){this.configNotifications.push([m.a.setA1ReferenceStyle,[e]]);var t=e?ae.h.A1:ae.h.R1C1,r=this.config,n=r.localeInfo,a=r.mathpack,i=r.date1904,o=r.dateCompatibility,c=r.timezone,u=r.datepack;this.config=Object(p.j)(n,t,a,i,o,c,u)},t.prototype.setLocale=function(e){this.configNotifications.push([m.a.setLocale,[e]]);if(Object(ue.x)(e,ue.i,{},"localeData")){var t=Object(oe.g)(e),r=this.config,n=r.refStyle,a=r.mathpack,i=r.date1904,o=r.dateCompatibility,c=r.timezone,u=r.datepack;this.config=Object(p.j)(t,n,a,i,o,c,u)}},t.prototype.setWorkbookProps=function(e){this.configNotifications.push([m.a.setWorkbookProps,[e]]);if(Object(ue.x)(e,ue.v,{},"workbookProps")){var t=this.config,r=t.localeInfo,n=t.refStyle,a=t.mathpack,i=t.datepack,o=e.date1904,c=e.dateCompatibility,u=e.timezone;this.config=Object(p.j)(r,n,a,null!=o?o:ie.b.date1904,null!=c?c:ie.b.dateCompatibility,null!=u?u:ie.b.timezone,i)}},t.prototype.updateSheetNames=function(){},t.prototype.updateNamedObjects=function(){},t}(function(){function e(e){this.config=e}return e.prototype.getDocumentLoc=function(){return Object(O.c)(Object(de.hb)(["getDocumentLoc"]))},e.prototype.getSheetIndex=function(){return Object(O.c)(Object(de.hb)(["getSheetIndex"]))},e.prototype.getSheetName=function(){return Object(O.c)(Object(de.hb)(["getSheetName"]))},e.prototype.getNameLoc=function(){return Object(O.c)(Object(de.hb)(["getNameLoc"]))},e.prototype.getUserDefinedFuncLoc=function(){return Object(O.c)(Object(de.hb)(["getUserDefinedFuncLoc"]))},e.prototype.getSheetRangeIndexes=function(){return Object(O.c)(Object(de.hb)(["getSheetRangeIndexes"]))},e.prototype.getContainingTable=function(){return Object(O.c)(Object(de.hb)(["getContainingTable"]))},e.prototype.getStructRefColumn=function(){return Object(O.c)(Object(de.hb)(["getStructRefColumn"]))},e.prototype.getStructRefSpecialRef=function(){return Object(O.c)(Object(de.hb)(["getStructRefSpecialRef"]))},e.prototype.getTime=function(){return Object(O.c)(Object(de.kb)(["getTime"]))},e}()),be=function(){},he=function(){function e(){this.dataTransformer=new ie.a,this.stateId=-1/0,this.stateChangesSinceLastGC=0,this.config=this.dataTransformer.getLangConfig(),this.configNotifications=[],this.sheets=new se.a(this.dataTransformer.document,this.config.localeInfo.stringCompareCI),this.nameManager=new le.a(this.dataTransformer.document,this.config.localeInfo.stringCompareCI)}return Object.defineProperty(e.prototype,"document",{get:function(){return this.dataTransformer.document},enumerable:!1,configurable:!0}),e.prototype.getStateAsNotifications=function(){return Object(l.__spreadArray)(Object(l.__spreadArray)(Object(l.__spreadArray)([],this.configNotifications,!0),this.getSheetStateAsNotifications(),!0),this.getNameStateAsNotifications(),!0)},e.prototype.getSheetStateAsNotifications=function(){var e=[];return this.sheets.forEachSheet((function(t,r){e.push(Object(ce.fb)(r,t.name))})),e.length>0?[[m.a.updateSheetNames,[this.stateId,e]]]:[]},e.prototype.getNameStateAsNotifications=function(){var e=this,t=[],r=function(r){var n=[];r.forEachAvailableName((function(t,r){var a=Object(oe.i)(e.config.mathpack,e.dataTransformer.document,null==r?void 0:r.obj);return n.push(Object(ce.J)(t,a)),!0})),n.length>0&&t.push(Object(ce.M)(r.scope.index,n)),r.allAvailable()&&t.push(Object(ce.hb)(r.scope.index))},n=this.nameManager.getNamesBySheetId(void 0);return Object(O.d)(n)&&r(n.value),this.nameManager.forEachSheetScope((function(e){r(e)})),t.length>0?[[m.a.updateNamedObjects,[this.stateId,t]]]:[]},e.prototype.trySetStateId=function(e,t){if(t<this.stateId)return!1;if(t>this.stateId){var r=this.stateId;if(this.stateId=t,this.sheets.advanceState(r),this.nameManager.advanceState(r),this.stateChangesSinceLastGC+=1,this.stateChangesSinceLastGC>=17){this.stateChangesSinceLastGC=0;var n=this.stateId-17;this.nameManager.collectGarbage(n)}}return!0},e.prototype.clearCompiledFormulas=function(){this.nameManager.resetLazyData()},e.prototype.clearCompiledNumberFormats=function(){},e.prototype.setA1ReferenceStyle=function(e){this.configNotifications.push([m.a.setA1ReferenceStyle,[e]]),this.dataTransformer.setA1ReferenceStyle(this,this.stateId,e)},e.prototype.setLocale=function(e){this.configNotifications.push([m.a.setLocale,[e]]);this.dataTransformer.setLocaleInfo(this,this.stateId,e,{})},e.prototype.setWorkbookProps=function(e){this.configNotifications.push([m.a.setWorkbookProps,[e]]);this.dataTransformer.setWorkbookProps(this,this.stateId,e,{})},e.prototype.updateSheetNames=function(e,t){this.dataTransformer.updateSheetNames(this,e,t,{})},e.prototype.updateNamedObjects=function(e,t){this.dataTransformer.updateNamedObjects(this,e,t,{})},e.prototype.setLangConfig=function(e,t){if(this.trySetStateId(!0,e)){var r=this.config.localeInfo!==t.localeInfo,n=this.config.refStyle!==t.refStyle;this.config=t,r&&this.clearCompiledNumberFormats(),(r||n)&&this.clearCompiledFormulas()}},e.prototype.setSheetNames=function(e,t,r){this.trySetStateId(!0,r)&&(this.sheets=this.sheets.setSheetNames(t),this.nameManager=this.nameManager.setSheetNames(t))},e.prototype.writeNamedObject=function(e,t,r,n){if(this.trySetStateId(!0,e)){var a=this.nameManager.setNamedObject(!0,Object(b.l)(t,r),n,be);Object(O.d)(a)}},e.prototype.writeUndefinedNames=function(e,t){if(this.trySetStateId(!0,e)){var r=this.nameManager.setUndefinedNames(t);Object(O.d)(r)}},e.prototype.promoteNamedObjects=function(e,t,r){if(this.trySetStateId(!0,e)){var n=this.nameManager.promoteNamedObjects(t,r);Object(O.d)(n)&&n.value}},e.prototype.getDocumentLoc=function(e,t){var r=this.dataTransformer.document;return void 0!==e&&e!==r.path||0!==this.config.localeInfo.stringCompareCI(t,r.name)?Object(O.c)(Object(de.kb)([Object(b.d)(e,t)])):Object(O.f)(r)},e.prototype.getSheetIndex=function(e,t){var r=this.sheets.getSheetByName(t);return Object(O.d)(r)?void 0===r.value?r:Object(O.f)(r.value.sheetIndex.index):r},e.prototype.getSheetName=function(e,t){var r=this.sheets.getSheetById(t);return Object(O.d)(r)?Object(O.f)(r.value.name):r},e.prototype.getNameLoc=function(e,t,r){return this.nameManager.getNameLoc(e.index,t,r)},e.prototype.getUserDefinedFuncLoc=function(e,t){return Object(O.c)(Object(de.hb)(["call UDF"]))},e.prototype.getSheetRangeIndexes=function(e){return this.sheets.getSheetRangeIds(e)},e.prototype.getContainingTable=function(e){return this.nameManager.getContainingTable(e)},e.prototype.getStructRefColumn=function(e,t){return this.nameManager.getStructRefColumn(e,t)},e.prototype.getStructRefSpecialRef=function(e,t){return this.nameManager.getStructRefSpecialRef(e,t)},e.prototype.getTime=function(){return Object(O.c)(Object(de.kb)(["getTime"]))},e}(),ve=function(){function e(){this.current=0}return e.prototype.create=function(){return this.current+=1},e}(),pe=function(){function e(){this.subscribers=[]}return e.prototype.next=function(e){for(var t=0,r=this.subscribers;t<r.length;t++){(0,r[t])(e)}},e.prototype.subscribe=function(e){this.subscribers.push(e)},e}(),me=function(e){function t(t){var r=e.call(this)||this;return r.initializeSubscriber=t,r}return Object(l.__extends)(t,e),t.prototype.subscribe=function(t){e.prototype.subscribe.call(this,t),this.initializeSubscriber().map(t)},t}(pe),ge={kind:"RequestFailure"},Oe={kind:W.FirstStep},je=function(){function e(e,t,r,n,a,i){var o;void 0===r&&(r=Object(l.__assign)({},_.a)),void 0===n&&(n=j.b),void 0===a&&(a=Object(d.c)("Microsoft.Office.Excel.x10UseDevSyncDataModel"));var c,u=this;this.createPrefetchingCache=t,this.pluginResultWindows=r,this.timer=n,this.useDevSyncDataModel=a,this.parent=i,this.responseStates=Object(f.j)(Object(f.v)(m.c).map((function(e){return[e,new z(e)]}))),this.uiMessages=Object(f.j)(Object(f.v)(m.c).map((function(e){return[e,new pe]}))),this.syncUIMessages=Object(f.j)(Object(f.v)(m.c).map((function(e){return[e,new pe]}))),this.syncMessageQueue=new re.a((function(){return 0})),this.doNotifyStatelessSubject=new pe,this.doNotifyStatefulSubject=new me((function(){return u.syncDataModel.getStateAsNotifications()})),this.requestWithCorrelationIdSubject=new pe,this.idFactory=new ve,this.state={},this.notificationProcessorMap=((o={})[m.a.setActiveCell]=this.setActiveCellImpl.bind(this),o[m.a.setA1ReferenceStyle]=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=u.syncDataModel).setA1ReferenceStyle.apply(e,t)},o[m.a.setLocale]=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=u.syncDataModel).setLocale.apply(e,t)},o[m.a.setWorkbookProps]=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=u.syncDataModel).setWorkbookProps.apply(e,t)},o[m.a.updateSheetNames]=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=u.syncDataModel).updateSheetNames.apply(e,t)},o[m.a.updateNamedObjects]=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return(e=u.syncDataModel).updateNamedObjects.apply(e,t)},o[m.a.doNothing]=function(){},o[m.a.setFunctionsInfo]=this.setFunctionInfo.bind(this),o[m.a.conflictResolverEarlyTermination]=function(e,t){return u.stopPlugins(e,t,"ConflictResolverEarlyTermination")},o[m.a.setDefinedNamesInfo]=this.setDefinedNamesInfo.bind(this),o),this.notifierObject=Object(m.l)(this),this.requesterObject=Object(m.m)(this),this.syncRequesterObject=Object(m.n)(this),this.batchRequesterObject=(c=this,{functionSuggestionAndArgumentAssistance:function(e){if(Object(f.f)(e))return Promise.resolve(null);var t=e.functionSuggestion,r=e.argumentAssistance;return Object(f.f)(t)||Object(f.f)(r)?Promise.resolve(null):c.doBatchRequest({strategy:s.FunctionSuggestionAndArgumentAssistance,functionSuggestion:t,argumentAssistance:r})}}),this.recalcServiceAttachedPromise=new k.a,this.activeCellInitializedPromise=new k.a,this.warmupParse=Object(ne.b)((function(){return Object(l.__awaiter)(u,void 0,void 0,(function(){var e,t,r;return Object(l.__generator)(this,(function(n){return(e=this.createPrefetchingCache(this.syncDataModel,-1))&&(t=Object(b.d)(void 0,""),r=Object(b.p)(Object(b.s)(t,0),Object(b.f)(1,1)),e.parseEditSync(r,"=sum(5,7)",{formatString:"'GENERAL",builtIn:!0})),[2]}))}))})),v.i.ULS.traceTag(537796811,p.c.msoulscat_ES_EWAJS,p.i.Info,"x10arch.excelOnlineCalcPackages:  ".concat(yt.getExcelOnlineCalcNewPackagesNames())),this.processor=e(this.consumeMessage.bind(this)),this.syncDataModel=this.useDevSyncDataModel?new he:new fe}return e.prototype.setFunctionInfo=function(e){if(!Object(f.f)(e)){for(var t={},r=0,n=e;r<n.length;r++){var a=n[r];Object(f.e)(a)&&(t[a.NameDataStrings]=a)}this.state=Object(l.__assign)(Object(l.__assign)({},this.state),{functionsInfoMap:t})}},e.prototype.setDefinedNamesInfo=function(e){if(!Object(f.f)(e)){for(var t={},r=0,n=e;r<n.length;r++){var a=n[r];Object(f.e)(a)&&Object(f.e)(a.name)&&(t[a.name.toUpperCase()]=a)}this.state=Object(l.__assign)(Object(l.__assign)({},this.state),{definedNamesInfoMap:t})}},e.prototype.getPluginResponseWindows=function(){return this.pluginResultWindows},e.prototype.setPluginResponseWindow=function(e,t,r){this.pluginResultWindows[e]={startDelta:t,stopDelta:r}},e.prototype.consumeMessage=function(e){switch(e.kind){case m.d.StepPlugin:this.stepPlugin(e.computation,e.payload);break;case m.d.NoOpRequest:case m.d.SyncRequest:case m.d.AsyncRequest:var t=this.timer.now();this.processRequest(e.computation,e.request),e.computation.info.schedulerTime+=this.timer.now()-t;break;case m.d.StopPlugins:this.stopPlugins(e.correlationId,e.pluginKind,"Timeout");break;default:Object(v.e)("unknown message: ".concat(e),e)}},e.prototype.enqueueMessage=function(t,r){var n=e.abstractStepCosts[t.kind];this.processor.enqueue(t,n,r)},e.prototype.stepPlugin=function(e,t){var r=this.responseStates[e.info.pluginKind].uiMessageFrame;if(e.info.correlationId===(null==r?void 0:r.correlationId))try{var n=this.timer.now(),a=ye(e.generator,t);if(e.info.pluginTime+=this.timer.now()-n,!0!==a.done){var i=a.value;this.enqueueMessage(K(i,e))}else v.i.ULS.traceTag(553734790,p.c.msoulscat_ES_EWAJS,p.i.Info,"x10arch.stepPlugin: plugin completed in time. ".concat(JSON.stringify(e.info))),this.addResult(e.info.pluginFactoryName,Object(O.f)(a.value))}catch(t){this.addResult(e.info.pluginFactoryName,Object(O.c)(void 0)),v.i.ULS.traceTag(553734791,p.c.msoulscat_ES_EWAJS,p.i.Warning,"x10arch.stepPlugin: plugin threw exception during computation. ".concat(JSON.stringify(e.info)))}},e.prototype.addResult=function(e,t){var r,n,a=g.c[e],i=this.responseStates[a].uiMessageFrame;void 0!==i&&(this.parent&&this.parent.addResult(e,t),t.kind===O.b.Success?(r=i.successfulResults.results.push([e,t.value]),n=i.numFailures):(r=i.successfulResults.results.length,n=i.numFailures+=1),r+n===this.responseStates[a].numPlugins&&this.stopPlugins(i.correlationId,a,"Done"))},e.prototype.processRequest=function(e,t){var r,n,a=this,i=this.responseStates[e.info.pluginKind],o=i.uiMessageFrame;if(e.info.correlationId===(null==o?void 0:o.correlationId)){var c=this.timer.now(),u=function(e,t,r,n,a){var i=r.info.correlationId,o=r.schedulerState,c=e[t.kind],u={request:t,correlationId:i,cache:n,config:a,schedulerState:o},s=c(u);return Object(y.a)(s,(function(e){return e.kind!==O.b.Success?Object(O.c)(void 0):(r.schedulerState=u.schedulerState,Object(O.f)(Object(l.__assign)({kind:t.kind},e.value)))}))}($,t,e,null===(r=i.uiMessageFrame)||void 0===r?void 0:r.cache,null===(n=i.uiMessageFrame)||void 0===n?void 0:n.config);Object(y.a)(u,(function(r){if(a.addProcessingTime(e,t.kind,c),r.kind!==O.b.Success)return a.enqueueMessage({kind:m.d.StepPlugin,computation:e,payload:{kind:W.RequestFailure}}),void v.i.ULS.traceTag(538788238,p.c.msoulscat_ES_EWAJS,p.i.Warning,"x10arch.processRequest: request returned a scheduler-side failure: ".concat(JSON.stringify(Object(l.__assign)(Object(l.__assign)({},e.info),{failedRequest:t.kind}))));a.enqueueMessage({kind:m.d.StepPlugin,computation:e,payload:{kind:W.NormalResponse,response:r.value}})}),(function(r){a.addProcessingTime(e,t.kind,c),a.enqueueMessage({kind:m.d.StepPlugin,computation:e,payload:{kind:W.AsyncException,error:r}}),v.i.ULS.traceTag(540611209,p.c.msoulscat_ES_EWAJS,p.i.Warning,"x10arch.processRequest: request processor threw ".concat(JSON.stringify(Object(l.__assign)(Object(l.__assign)({},e.info),{failedRequest:t.kind,error:Object(w.c)(r)}))))}))}},e.prototype.addProcessingTime=function(e,t,r){var n=this.timer.now(),a=e.info.requestTimes[t];return a?(a.requestDuration=a.requestDuration+n-r,a.timeSinceLastRequest=n-e.lastTimestamp):e.info.requestTimes[t]={requestDuration:n-r,timeSinceLastRequest:n-e.lastTimestamp},e.lastTimestamp=n,n},e.prototype.stopPlugins=function(e,t,r){var n,a=this.responseStates[t];e===(null===(n=a.uiMessageFrame)||void 0===n?void 0:n.correlationId)&&a.stop(r,this.timer.now())},e.prototype.recalcServiceAttached=function(){return this.recalcServiceAttachedPromise.toPromise()},e.prototype.activeCellInitialized=function(){return this.activeCellInitializedPromise.toPromise()},e.prototype.getFunctionsShortDescriptions=function(){return F.b.getValue()},e.prototype.doNotify=function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];var n=t[0],a=t[1];switch((e=this.notificationProcessorMap)[n].apply(e,a),n){case m.a.setA1ReferenceStyle:case m.a.setLocale:case m.a.setWorkbookProps:case m.a.updateSheetNames:case m.a.updateNamedObjects:this.doNotifyStatefulSubject.next(t);break;default:this.doNotifyStatelessSubject.next(t)}},e.prototype.requestWithCorrelationId=function(e,t,r){var n=this.timer.now(),a=this.responseStates[e];a.closeUIMessageFrame("UIMessage",n);var i=this.createPrefetchingCache(this.syncDataModel,r),o=a.createUIMessageFrame(r,i,this.syncDataModel.config,n);return v.i.ULS.traceTag(553734792,p.c.msoulscat_ES_EWAJS,p.i.Info,"x10arch.FormulaBarScheduler.request: ".concat(JSON.stringify({correlationId:r,requestKind:e}))),this.uiMessages[e].next(t),this.enqueueMessage({kind:m.d.StopPlugins,correlationId:r,pluginKind:e},n+this.pluginResultWindows[e].stopDelta),this.requestWithCorrelationIdSubject.next([e,t,r]),o},e.prototype.syncRequestWithCorrelationId=function(e,t,r){var n=this.timer.now(),a=this.createPrefetchingCache(this.syncDataModel,r);v.i.ULS.traceTag(538581025,p.c.msoulscat_ES_EWAJS,p.i.Info,"x10arch.FormulaBarScheduler.syncRequest: ".concat(JSON.stringify({correlationId:r,requestKind:e}))),this.syncUIMessages[e].next([t,r]);var i=n+this.pluginResultWindows[e].stopDelta,o=this.runToCompletion(a,this.syncDataModel.config,i),c=o[0],u=o[1],s={startTime:n,stopTime:this.timer.now(),pluginKind:e,correlationId:r,numPlugins:this.responseStates[e].numSyncPlugins,numSent:u.length,stopReason:c};return v.i.ULS.traceTag(538581026,p.c.msoulscat_ES_EWAJS,p.i.Info,"x10arch.FormulaBarScheduler.syncRequestWithCorrelationId: ".concat(JSON.stringify(s))),{kind:e,results:u}},e.prototype.runToCompletion=function(e,t,r){for(var n=[],a=this.timer.now(),i=this.syncMessageQueue.pop();void 0!==i&&a<r;i=this.syncMessageQueue.pop(),a=this.timer.now()){var o=void 0;switch(i.kind){case m.d.StepPlugin:var c=i.computation,u=i.payload;try{var s=ye(c.generator,u);if(c.info.pluginTime+=this.timer.now()-a,!0!==s.done){var d=s.value;this.syncMessageQueue.enqueue(q(d,c))}else v.i.ULS.traceTag(538581027,p.c.msoulscat_ES_EWAJS,p.i.Info,"x10arch.FormulaBarScheduler.runToCompletion: plugin completed in time. ".concat(JSON.stringify(c.info))),n.push([c.info.pluginFactoryName,s.value])}catch(e){v.i.ULS.traceTag(538581056,p.c.msoulscat_ES_EWAJS,p.i.Warning,"x10arch.FormulaBarScheduler.runToCompletion: plugin threw exception during computation. ".concat(JSON.stringify(c.info)))}break;case m.d.NoOpRequest:case m.d.SyncRequest:var f=ee($,i.request,i.computation,e,t);o=this.addProcessingTime(i.computation,i.request.kind,a),i.computation.info.schedulerTime+=o-a,f.kind===O.b.Success?this.syncMessageQueue.enqueue({kind:m.d.StepPlugin,computation:i.computation,payload:{kind:W.NormalResponse,response:f.value}}):(v.i.ULS.traceTag(538469328,p.c.msoulscat_ES_EWAJS,p.i.Warning,"x10arch.FormulaBarScheduler.runToCompletion: request returned a scheduler-side failure: ".concat(JSON.stringify(Object(l.__assign)(Object(l.__assign)({},i.computation.info),{failedRequest:i.request.kind})))),this.syncMessageQueue.enqueue({kind:m.d.StepPlugin,computation:i.computation,payload:{kind:W.RequestFailure}}));break;default:Object(v.e)("unknown message: ".concat(i),i)}}return this.syncMessageQueue.clear(),[a<r?"Done":"Timeout",n]},e.prototype.doRequest=function(e,t){return this.doRequestUntyped(e,t)},e.prototype.doRequestUntyped=function(e,t){return Object(l.__awaiter)(this,void 0,void 0,(function(){var r,n,a;return Object(l.__generator)(this,(function(i){switch(i.label){case 0:return 0===this.responseStates[e].numPlugins?(v.i.ULS.traceTag(553734793,p.c.msoulscat_ES_EWAJS,p.i.Info,"x10arch.FormulaBarScheduler.doRequest: no plugins attached"),(r=new k.a).resolve({kind:h.b.Done,payload:{kind:e,results:[]}})):(n=this.idFactory.create(),r=this.requestWithCorrelationId(e,t,n)),[4,this.resolveConflicts(r)];case 1:return(a=i.sent()).kind===h.b.Superseded?[2,a]:[2,Object(l.__assign)(Object(l.__assign)({},a),{payload:a.payload.result})]}}))}))},e.prototype.doSyncRequest=function(e,t){return this.doSyncRequestUntyped(e,t)},e.prototype.doSyncRequestUntyped=function(e,t){var r;if(0===this.responseStates[e].numSyncPlugins)v.i.ULS.traceTag(538581057,p.c.msoulscat_ES_EWAJS,p.i.Info,"x10arch.FormulaBarScheduler.doSyncRequest: no plugins attached"),r={kind:e,results:[]};else{var n=this.idFactory.create();r=this.syncRequestWithCorrelationId(e,t,n)}return this.syncResolveConflicts(r).result},e.prototype.resolveConflicts=function(e){return Object(l.__awaiter)(this,void 0,void 0,(function(){var t;return Object(l.__generator)(this,(function(r){switch(r.label){case 0:return[4,e];case 1:return(t=r.sent()).kind===h.b.Superseded?[2,t]:[2,{kind:h.b.Done,payload:this.syncResolveConflicts(t.payload)}]}}))}))},e.prototype.syncResolveConflicts=function(e){var t=e.results.filter((function(e){var t=e[1];return Object(f.e)(t)}));return{kind:e.kind,result:C[e.kind](t)}},e.prototype.doBatchRequest=function(e){return Object(l.__awaiter)(this,void 0,void 0,(function(){var t,r,n,a,i,o,c,u,s,d,f;return Object(l.__generator)(this,(function(l){switch(l.label){case 0:for(t=this.idFactory.create(),r=A[e.strategy],n=R[e.strategy].create(),a=r.map((function(){return!0})),i=new k.a,o=function(o){var u=r[o],s=e[u],l=c.requestWithCorrelationId(u,s,t);c.resolveConflicts(l).then((function(e){if(a[o]=!1,e.kind===h.b.Superseded)i.resolve({kind:h.b.Superseded});else{var t=e.payload;n.consumeResult(t)}}),(function(){v.i.ULS.traceTag(553734794,p.c.msoulscat_ES_EWAJS,p.i.Error,'x10arch.doBatchRequest: Custom conflict resolver "'.concat(e.strategy,'" got an exception for plugin kind "').concat(u,'". Skipping kind.')),a[o]=!1,n.consumeResult({kind:u,result:null})}))},c=this,d=0;d<r.length;d+=1)o(d);return u=Object(y.a)(n.promise,(function(e){return{kind:h.b.Done,payload:e}})),[4,Promise.race([i,u])];case 1:for(s=l.sent(),d=0;d<r.length;d+=1)f=r[d],a[d]&&this.doNotify(m.a.conflictResolverEarlyTermination,[t,f]);return[2,s]}}))}))},e.prototype.notifier=function(){return this.notifierObject},e.prototype.requester=function(){return this.requesterObject},e.prototype.syncRequester=function(){return this.syncRequesterObject},e.prototype.batchRequester=function(){return this.batchRequesterObject},e.prototype.setServerDataProvider=function(e){Object(f.f)(e)||(this.state=Object(l.__assign)(Object(l.__assign)({},this.state),{serverDataProvider:e}))},e.prototype.setActiveCellImpl=function(e){if(Object(f.f)(e.docName)||Object(f.f)(e.sheetIndex))v.i.ULS.traceTag(553734796,p.c.msoulscat_ES_EWAJS,p.i.Warning,"x10arch.setSelectedCell early exit, some of the arguments is None");else{var t=Object(b.d)(void 0,""),r=Object(b.p)(Object(b.s)(t,e.sheetIndex),Object(b.f)(e.rowIndex,e.colIndex));this.activeCellInitializedPromise.resolve(void 0),this.state=Object(l.__assign)(Object(l.__assign)({},this.state),{activeCell:r}),Object(f.f)(e.formatString)||Object(f.f)(e.builtIn)||(this.state=Object(l.__assign)(Object(l.__assign)({},this.state),{activeCellFormat:{formatString:e.formatString,builtIn:e.builtIn}}))}},e.prototype.getConfig=function(){return this.syncDataModel.config},e.prototype.createAndAttachPlugin=function(e,t){var r=this;this.parent&&this.warmupParse.getValue();var n=e.create(t),a=g.c[e.factoryName];this.uiMessages[a].subscribe((function(t){var i=r.responseStates[a].uiMessageFrame;Object(v.h)("`frame` should be always defined at this point",void 0!==i);var o=n.run(t,V);r.enqueueMessage({kind:m.d.StepPlugin,computation:{info:{correlationId:i.correlationId,pluginKind:a,pluginFactoryName:e.factoryName,pluginTime:0,schedulerTime:0,requestTimes:{}},generator:o,schedulerState:r.state,lastTimestamp:r.timer.now()},payload:Oe},i.startTime+r.pluginResultWindows[a].startDelta)})),v.i.ULS.traceTag(545378970,p.c.msoulscat_ES_EWAJS,p.i.Info,"x10arch.FormulaBarScheduler.createAndAttachPlugin: ".concat(h.a[e.factoryName]," was attached.")),this.addToPluginCount(a,1)},e.prototype.createAndAttachSyncPlugin=function(e,t){var r=this,n=e.create(t),a=g.c[e.factoryName];this.syncUIMessages[a].subscribe((function(t){var i=t[0],o=t[1],c=n.run(i,J);r.syncMessageQueue.enqueue({kind:m.d.StepPlugin,computation:{info:{correlationId:o,pluginKind:a,pluginFactoryName:e.factoryName,pluginTime:0,schedulerTime:0,requestTimes:{}},generator:c,schedulerState:r.state,lastTimestamp:r.timer.now()},payload:Oe})})),v.i.ULS.traceTag(538581058,p.c.msoulscat_ES_EWAJS,p.i.Info,"x10arch.FormulaBarScheduler.createAndAttachSyncPlugin: ".concat(h.a[e.factoryName]," was attached.")),this.responseStates[a].numSyncPlugins+=1},e.prototype.addToPluginCount=function(e,t){this.parent&&this.parent.addToPluginCount(e,t),this.responseStates[e].numPlugins+=t},e.prototype.registerAsyncGrid=function(){this.recalcServiceAttachedPromise.resolve(void 0)},e.abstractStepCosts=((te={})[m.d.NoOpRequest]=.01,te[m.d.AsyncRequest]=.1,te[m.d.SyncRequest]=.5,te[m.d.StepPlugin]=1,te[m.d.StopPlugins]=.01,te),e}();function ye(e,t){switch(t.kind){case W.FirstStep:return e.next();case W.NormalResponse:return e.next(t.response);case W.AsyncException:case W.RequestFailure:return e.next(ge);default:Object(v.e)("x10arch: FormulaBarScheduler.stepPlugin: unknown payload",t)}}var Se=r(55),Ce=r(25),ke=r(72),Ee=function(){function e(e){this.onGridReady=e,this.gridService=void 0}return e.prototype.getGrid=function(){var e;return null===(e=this.gridService)||void 0===e?void 0:e.call},e.prototype.createIGridImportEndpoint=function(e){return Object(l.__awaiter)(this,void 0,void 0,(function(){var t,r=this;return Object(l.__generator)(this,(function(n){switch(n.label){case 0:return this.onGridExporterClosed(),[4,Se.Endpoint.createOutside(e,(function(e){r.gridService={call:void 0,close:function(){return e.close("Force")}}}))];case 1:return(t=n.sent()).hasBeenClosed()||(this.gridService=t,this.onGridReady(this.gridService.call)),[2]}}))}))},e.prototype.onGridExporterClosed=function(){if(this.gridService){var e=this.gridService;this.gridService=void 0,e.close()}},e}();function Ae(e,t,r){var n=new MessageChannel,a=n.port1,i=n.port2;Promise.all([e.createIGridImportEndpoint({port:i,options:r}),t.createIGridExportEndpoint({port:a,options:r},(function(){return e.onGridExporterClosed()}))]).catch((function(t){v.i.ULS.traceTag(540674071,Ce.LogCategory.msoulscat_ES_EWAJS,Ce.TraceLevel.Warning,"x10arch.connectGridImporterExporter: ".concat(Object(w.c)(t)));try{e.onGridExporterClosed()}catch(t){v.i.ULS.traceTag(540644190,Ce.LogCategory.msoulscat_ES_EWAJS,Ce.TraceLevel.Warning,"x10arch.connectGridImporterExporter: importer threw ".concat(Object(w.c)(t)))}}))}var Ne=function(){function e(e){this.timeout=e,this.exporter=void 0,this.importers=[]}return e.prototype.onGridExporterCreated=function(e){this.exporter=e;for(var t=0,r=this.importers;t<r.length;t++){var n=r[t];Ae(n.importer,e,{id:n.id,createTimeout:this.timeout})}},e.prototype.onGridImporterCreated=function(e,t){this.importers.push({importer:e,id:t}),this.exporter&&Ae(e,this.exporter,{id:t,createTimeout:this.timeout})},e}(),Te=r(85),Re=Te.a.Stable,Ie=function(){function e(e,t){if(this.threadId=e,!(t instanceof je))throw new TypeError("DynamicPluginLoaderBase.constructor: unknown IFormulaBarScheduler class: ".concat(JSON.stringify(t)));this.scheduler=t}return e.prototype.loadPluginScriptTrace=function(e,t){var r="x10arch.loadPluginScript: ".concat(e," loaded on ").concat(this.threadId,", time to load ").concat(t);v.i.ULS.traceTag(553734797,Ce.LogCategory.msoulscat_ES_EWAJS,Ce.TraceLevel.Info,r)},e.prototype.createAndAttachPlugin=function(e,t){return Object(l.__awaiter)(this,void 0,void 0,(function(){var r;return Object(l.__generator)(this,(function(n){return r=Object(g.b)(e,Re),this.scheduler.createAndAttachPlugin(r,t),[2]}))}))},e.prototype.createAndAttachSyncPlugin=function(e,t){return Object(l.__awaiter)(this,void 0,void 0,(function(){var r;return Object(l.__generator)(this,(function(n){return r=Object(g.b)(e,Re),this.scheduler.createAndAttachSyncPlugin(r,t),[2]}))}))},e}(),_e=function(e){function t(t,r,n,a){var i=e.call(this,"Main",n)||this;i.threadEntryPoint=t,i.gridManager=r,i.loader=a;var o=a.getConfig();return i.resolveScript=o.resolveScript,i}return Object(l.__extends)(t,e),t.prototype.loadPluginScript=function(e,t){return Object(l.__awaiter)(this,void 0,void 0,(function(){var r,n,a;return Object(l.__generator)(this,(function(i){switch(i.label){case 0:return Object(f.f)(e)||Object(f.f)(t)?[2]:(r=j.b,n=r.now(),[4,this.loader.loadScript(e)]);case 1:return i.sent(),a=r.now()-n,this.loadPluginScriptTrace(e,a),[2]}}))}))},t.prototype.isThreadingSupported=function(){return Se.isThreadingSupported()&&void 0!==Object(ke.a)()},t.prototype.createPluginThread=function(e){return Object(l.__awaiter)(this,void 0,void 0,(function(){var r,n,a,i,o,c,u,s=this;return Object(l.__generator)(this,(function(l){switch(l.label){case 0:return r="DynamicPluginLoaderThread-".concat(t.lastThreadNum+=1,"-").concat(e),n="".concat(r,"-IGrid"),[4,ke.d];case 1:return l.sent(),[4,Se.createWorker({createMode:"Thread",id:r},Se.paramInsideDef({scriptUrl:Object(ke.b)(),insideInitName:this.threadEntryPoint},{pluginResponseWindows:this.scheduler.getPluginResponseWindows(),useDevSyncDataModel:this.scheduler.useDevSyncDataModel}),(function(){return{addResult:s.scheduler.addResult.bind(s.scheduler),addToPluginCount:s.scheduler.addToPluginCount.bind(s.scheduler),resolveScript:s.resolveScript}}))];case 2:a=l.sent(),l.label=3;case 3:return l.trys.push([3,5,,6]),i=function(){},a.onClose=function(){i();var e="x10arch.DynamicPluginLoader: ".concat(r," closed");v.i.ULS.traceTag(553734798,Ce.LogCategory.msoulscat_ES_EWAJS,Ce.TraceLevel.Info,e)},[4,Object(ke.f)(a)];case 4:return o=l.sent(),i=function(){return o.close()},this.scheduler.doNotifyStatelessSubject.subscribe((function(e){var t;return(t=a.post).doNotify.apply(t,e)})),this.scheduler.requestWithCorrelationIdSubject.subscribe((function(e){var t;return(t=a.post).requestWithCorrelationId.apply(t,e)})),this.scheduler.doNotifyStatefulSubject.subscribe((function(e){var t;return(t=a.post).doNotify.apply(t,e)})),c={createIGridImportEndpoint:function(e){return a.call.createIGridImportEndpoint.transfer([e.port],e)},onGridExporterClosed:a.post.onGridExporterClosed},this.gridManager.onGridImporterCreated(c,n),[2,new Fe(a)];case 5:throw u=l.sent(),a.close(),u;case 6:return[2]}}))}))},t.lastThreadNum=0,t}(Ie),Fe=function(){function e(e){this.outside=e}return e.prototype.loadPluginScript=function(e,t){return this.outside.call.loadPluginScript(e,t)},e.prototype.createAndAttachPlugin=function(e,t){return this.outside.call.createAndAttachPlugin(e,t)},e.prototype.createAndAttachSyncPlugin=function(e,t){return this.outside.call.createAndAttachSyncPlugin(e,t)},e.prototype.recalcServiceAttached=function(){return this.outside.call.recalcServiceAttached()},e.prototype.close=function(){this.outside.close()},e}(),we=function(e,t){var r=e.config,n=e.connection,a=t.pluginResponseWindows,i=t.useDevSyncDataModel;return Object(l.__awaiter)(void 0,void 0,void 0,(function(){return Object(l.__generator)(this,(function(e){return[2,Se.Endpoint.createInside(n,(function(e){var t={addResult:function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return(t=e.post).addResult.apply(t,r)},addToPluginCount:function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return(t=e.post).addToPluginCount.apply(t,r)}},o=new Ee((function(){return c.registerAsyncGrid()})),c=new je(bt(void 0),ft(o),a,void 0,i,t);return new Me(String(n.options.id),o,c,r,e)}))]}))}))},Me=function(e){function t(t,r,n,a,i){var o=e.call(this,t,n)||this;return o.gridImporter=r,o.twConfig=a,o.inside=i,o.loadedScripts=Object(f.i)(),o.initCalcThreadInside=function(e,t,r){return Object(l.__awaiter)(o,void 0,void 0,(function(){return Object(l.__generator)(this,(function(n){switch(n.label){case 0:return[4,Object(ke.e)(e,t,r,this.twConfig)];case 1:return n.sent(),[2]}}))}))},o.createIGridImportEndpoint=o.gridImporter.createIGridImportEndpoint.bind(o.gridImporter),o.onGridExporterClosed=o.gridImporter.onGridExporterClosed.bind(o.gridImporter),o.doNotify=o.scheduler.doNotify.bind(o.scheduler),o.requestWithCorrelationId=o.scheduler.requestWithCorrelationId.bind(o.scheduler),Object(g.e)(t),o}return Object(l.__extends)(t,e),t.prototype.loadPluginScript=function(e,t){return Object(l.__awaiter)(this,void 0,void 0,(function(){var r,n,a,i,o;return Object(l.__generator)(this,(function(c){switch(c.label){case 0:return Object(f.f)(e)||Object(f.f)(t)||!0===this.loadedScripts[e]?[2]:(r=j.b,n=r.now(),i=(a=Se).importScriptsWithRetry,[4,this.inside.call.resolveScript({identifier:e,isLocalized:t})]);case 1:return i.apply(a,[[c.sent()],Object(d.c)("Microsoft.Office.Excel.CalcTSImportScriptsRetries")?ke.h:0]),o=r.now()-n,this.loadedScripts[e]=!0,this.loadPluginScriptTrace(e,o),[2]}}))}))},t.prototype.recalcServiceAttached=function(){return this.scheduler.recalcServiceAttached()},t}(Ie),De=r(105),Pe=r(69),xe=r(26),Le=r(24),Be=r(32),Ue=r(8),Ge=function(){function e(t,r,n,a){this.formats=void 0,this.values=void 0,this.formulae=void 0,this.valueAvailabilitySet=void 0,this.formatAvailabilitySet=void 0,this.formulaAvailabilitySet=void 0,Object(O.d)(r)&&(this.values=e.buildSparseMatrix(r.value.nonEmptyCells,(function(e){return e})),this.valueAvailabilitySet=e.unionRanges(r.value.availableRanges)),Object(O.d)(a)&&(this.formats=e.buildSparseMatrix(a.value.nonEmptyCells,(function(e){return e})),this.formatAvailabilitySet=e.unionRanges(a.value.availableRanges)),Object(O.d)(n)&&(this.formulae=e.buildSparseMatrix(n.value.nonEmptyCells,(function(e){return e})),this.formulaAvailabilitySet=e.unionRanges(n.value.availableRanges))}return e.buildSparseMatrix=function(e,t){for(var r=[],n=0,a=e;n<a.length;n++)for(var i=a[n],o=i[0],c=o[0],u=o[1],s=o[2],l=void 0===s?1:s,d=o[3],f=void 0===d?1:d,b=i.slice(1),h=b.length,v=u,p=0;v<u+f;v+=1)for(var m=c;m<c+l;m+=1,p=(p+1)%h)void 0===r[m]&&(r[m]=[]),r[m][v]=t(b[p],m,v);return r},e.forEachInSparseMatrix=function(e,t,r){void 0===r&&(r=function(){return!1});var n=!0;return e.forEach((function(e,a){n&&e.forEach((function(e,i){n&&(r(e)||t(Object(b.f)(a,i),e)||(n=!1))}))})),n},e.unionRanges=function(e){return e.map(xe.f).reduce(Le.j,Be.d)},e.prototype.getCellValue=function(e,t){return this.isAvailable(e,t,"value")?void 0!==this.values&&void 0!==this.values[e]&&void 0!==this.values[e][t]?Object(O.f)(this.values[e][t]):Object(O.f)(Pe.d):Object(O.c)(Object(de.kb)(["getCellValue"]))},e.prototype.getCellFormat=function(e,t){return this.isAvailable(e,t,"format")?void 0!==this.formats&&void 0!==this.formats[e]&&void 0!==this.formats[e][t]?Object(O.f)(this.formats[e][t]):Object(O.f)(Pe.b):Object(O.c)(Object(de.kb)(["getCellFormat"]))},e.prototype.getCellFormula=function(e,t){return this.isAvailable(e,t,"formula")?void 0!==this.formulae&&void 0!==this.formulae[e]&&void 0!==this.formulae[e][t]?Object(O.f)(this.formulae[e][t]):Object(O.f)(Pe.c):Object(O.c)(Object(de.kb)(["getCellFormula"]))},e.prototype.foreachNonBlankCellValue=function(t){return void 0===this.values||e.forEachInSparseMatrix(this.values,t,(function(e){return e.kind===Ue.b.Blank}))},e.prototype.foreachNonBlankCellFormula=function(t){return void 0===this.formulae||e.forEachInSparseMatrix(this.formulae,t,(function(e){return e.kind===Pe.c.kind&&e.formulaBarText===Pe.c.formulaBarText}))},e.prototype.isAvailable=function(e,t,r){var n,a;switch(r){case"value":a=this.valueAvailabilitySet;break;case"formula":a=this.formulaAvailabilitySet;break;case"format":a=this.formatAvailabilitySet;break;default:Object(v.e)("isAvailable",r)}return void 0!==a&&(null!==(n=Object(Le.a)(Object(xe.f)(Object(b.f)(e,t)),a))&&void 0!==n?n:1)<=0},e}();Object(f.r)();var Ve=r(75),He=r(54),We=r(6),ze=r(92),qe=r(56),Ke=r(66),Ye=r(80),Je=r(83),Qe=r(28),Xe=r(71),Ze=r(19);function $e(e){var t=e.hasHeadersRow,r=e.hasTotalsRow,n=e.dataRange;return Object(b.g)(n.row-Number(t),n.col,n.rows+Number(t)+Number(r),n.cols)}function et(e,t,r,n){for(var a=t.name,i=t.hasHeadersRow,o=t.hasTotalsRow,c=t.dataRange,u=t.columns,s=i?Object(b.g)(c.row-1,c.col,1,c.cols):void 0,l=o?Object(b.g)(c.row+c.rows,c.col,1,c.cols):void 0,d={},f=He.a.create(e.stringCompareCI),h=0,v=u;h<v.length;h++){var p=v[h];d[p.column]=p,f=f.setValue(p.name,p)}return{name:a,sheet:r,dataRange:c,headersRange:s,totalsRange:l,allRange:n,indexToColumn:d,nameToColumn:f,allColumnNamesAvailable:u.length===c.cols}}function tt(e,t){var r;return(null!==(r=Object(Le.a)(Object(xe.f)(t),e))&&void 0!==r?r:1)<=0}var rt=Object(O.c)(Object(de.kb)(["getCell"])),nt=Object(O.c)(Object(de.kb)(["getContainingTable"])),at=Object(O.c)(Object(de.kb)(["getIntersectingTables"])),it=Object(O.c)(Object(de.kb)(["getIformats"]));function ot(e,t){var r=Object.create(e);for(var n in t)r[n]=t[n];return r}var ct=function(){function e(e,t,r){this.grid=e,this.syncDataStore=t,this.correlationId=r,this.sheet2contents=Object(f.i)(),this.formatPages=[],this.formulaCache=new Map,this.englishFormulaCache=new Map,this.builtInFormatCache=new Map,this.customFormatCache=new Map,this.parser=Object(Ye.a)(t),this.analyzer=Object(Je.a)(t),this.formatter=Object(ze.a)(t),this.resolver=Object(Xe.a)(t);var n=ot(t,{config:ot(t.config,{localeInfo:Object(p.s)()})});this.englishParser=Object(Ye.a)(n),this.englishAnalyzer=Object(Je.a)(n)}return e.getOrFetchTile=function(t,r,n){var a=r.range.row>>>e.tileHeightPow,i=r.range.col>>>e.tileWidthPow;void 0===t[a]&&(t[a]=[]);var o=t[a][i];return void 0===o?n(Object(b.r)(r.sheet,Object(b.g)(a<<e.tileHeightPow,i<<e.tileWidthPow,1<<e.tileHeightPow,1<<e.tileWidthPow))).then((function(e){return t[a][i]=e})):o},e.create=function(t,r,n){return new e(t,r,n)},e.prototype.getSheetContents=function(e){var t;return null!==(t=this.sheet2contents[e])&&void 0!==t?t:this.sheet2contents[e]={cellTiles:[],tables:Object(Ve.a)(),tableTiles:[],hiddenRows:Be.d,hiddenRowsAvailability:Be.d,hiddenCols:Be.d,hiddenColsAvailability:Be.d}},e.prototype.getSheetNames=function(){return Object(l.__awaiter)(this,void 0,void 0,(function(){var e,t,r,n,a,i,o,c,u,s;return Object(l.__generator)(this,(function(l){switch(l.label){case 0:return void 0!==this.sheetNames?[3,2]:[4,this.grid.getSheetNames(this.correlationId)];case 1:if(e=l.sent(),!Object(O.d)(e))return[2,Object(O.c)(void 0)];for(t={},r=He.a.create(this.syncDataStore.config.localeInfo.stringCompareCI),n=e.value,a=n.document,i=n.sheets,o=0;o<i.length;o+=1)c=i[o],u=c.sheetIndex,s=c.sheetName,t[u.index]=o,r=r.setValue(s,o);this.sheetNames={document:a,sheets:i,idToIndex:t,nameToIndex:r},l.label=2;case 2:return[2,Object(O.f)(this.sheetNames)]}}))}))},e.prototype.getRangeValues=function(e){return this.grid.getRangeValues(this.correlationId,e)},e.prototype.getRangeFormulae=function(e){return this.grid.getRangeFormulae(this.correlationId,e)},e.prototype.getRangeFormats=function(e){return this.grid.getRangeFormats(this.correlationId,e)},e.prototype.getHiddenRows=function(e,t,r){return Object(l.__awaiter)(this,void 0,void 0,(function(){var n,a,i,o,c,u;return Object(l.__generator)(this,(function(s){switch(s.label){case 0:return n=this.getSheetContents(e.index),a=xe.d.row([t,r]),i=Object(Be.a)(a,n.hiddenRowsAvailability),0===i||-1===i?[3,2]:[4,this.grid.getHiddenRows(this.correlationId,e,Object(f.b)(0,t-10),Object(f.c)(b.v,r+10))];case 1:o=s.sent(),n.hiddenRows=o.hidden.reduce((function(e,t){var r=t.start,n=t.end;return Object(Be.j)(e,xe.d.row([r,n]))}),n.hiddenRows),n.hiddenRowsAvailability=o.available.reduce((function(e,t){var r=t.start,n=t.end;return Object(Be.j)(e,xe.d.row([r,n]))}),n.hiddenRowsAvailability),s.label=2;case 2:return c=[],Object(xe.j)(Object(Be.i)(n.hiddenRowsAvailability,a),(function(e){var t=e[0],r=e[1];return c.push(Object(Qe.p)(t,r)),!0})),u=[],Object(xe.j)(Object(Be.i)(n.hiddenRows,a),(function(e){var t=e[0],r=e[1];return u.push(Object(Qe.p)(t,r)),!0})),[2,{available:c,hidden:u}]}}))}))},e.prototype.getHiddenCols=function(e,t,r){return Object(l.__awaiter)(this,void 0,void 0,(function(){var n,a,i,o,c,u;return Object(l.__generator)(this,(function(s){switch(s.label){case 0:return n=this.getSheetContents(e.index),a=xe.d.col([t,r]),i=Object(Be.a)(a,n.hiddenColsAvailability),0===i||-1===i?[3,2]:[4,this.grid.getHiddenCols(this.correlationId,e,Object(f.b)(0,t-10),Object(f.c)(b.o,r+10))];case 1:o=s.sent(),n.hiddenCols=o.hidden.reduce((function(e,t){var r=t.start,n=t.end;return Object(Be.j)(e,xe.d.col([r,n]))}),n.hiddenCols),n.hiddenColsAvailability=o.available.reduce((function(e,t){var r=t.start,n=t.end;return Object(Be.j)(e,xe.d.col([r,n]))}),n.hiddenColsAvailability),s.label=2;case 2:return c=[],Object(xe.h)(Object(Be.i)(n.hiddenColsAvailability,a),(function(e){var t=e[0],r=e[1];return c.push(Object(Qe.p)(t,r)),!0})),u=[],Object(xe.h)(Object(Be.i)(n.hiddenCols,a),(function(e){var t=e[0],r=e[1];return u.push(Object(Qe.p)(t,r)),!0})),[2,{available:c,hidden:u}]}}))}))},e.prototype.getRange=function(e,t){return Object(l.__awaiter)(this,void 0,void 0,(function(){var r,n,a,i,o,c,u,s;return Object(l.__generator)(this,(function(l){switch(l.label){case 0:return r=void 0===t||t.indexOf("values")>-1,n=void 0===t||t.indexOf("formulae")>-1,a=void 0===t||t.indexOf("formats")>-1,i=Object(O.c)(Object(de.kb)(["getRange"])),[4,Promise.all([r?this.getRangeValues(e):i,n?this.getRangeFormulae(e):i,a?this.getRangeFormats(e):i])];case 1:return o=l.sent(),c=o[0],u=o[1],s=o[2],[2,new Ge(e.sheet,c,u,s)]}}))}))},e.prototype.getCell=function(t){var r=this,n=this.getSheetContents(t.sheet.index),a=e.getOrFetchTile(n.cellTiles,t,(function(e){return Object(l.__awaiter)(r,void 0,void 0,(function(){var r,n,a,i,o;return Object(l.__generator)(this,(function(c){switch(c.label){case 0:return[4,this.grid.getRangeValues(this.correlationId,e)];case 1:return o=[c.sent()],[4,this.grid.getRangeFormulae(this.correlationId,e)];case 2:return o=o.concat([c.sent()]),[4,this.grid.getRangeFormats(this.correlationId,e)];case 3:return r=o.concat([c.sent()]),n=r[0],a=r[1],i=r[2],Object(O.d)(n)&&Object(O.d)(a)&&Object(O.d)(i)?[2,new Ge(t.sheet,n,a,i)]:[2,"unavailable"]}}))}))}));return Object(y.a)(a,(function(e){if("unavailable"===e)return rt;var r=e.getCellValue(t.range.row,t.range.col),n=e.getCellFormula(t.range.row,t.range.col),a=e.getCellFormat(t.range.row,t.range.col);return Object(O.d)(r)&&Object(O.d)(n)&&Object(O.d)(a)?Object(O.f)({value:r.value,formula:n.value,format:a.value}):rt}))},e.prototype.getContainingTable=function(t){return Object(l.__awaiter)(this,void 0,void 0,(function(){var r,n,a=this;return Object(l.__generator)(this,(function(i){return r=this.getSheetContents(t.sheet.index),n=e.getOrFetchTile(r.tableTiles,t,(function(e){return Object(l.__awaiter)(a,void 0,void 0,(function(){var n,a,i,o,c,u;return Object(l.__generator)(this,(function(s){switch(s.label){case 0:return[4,this.grid.getIntersectingTables(this.correlationId,e)];case 1:if(n=s.sent(),!Object(O.d)(n))return[2,"unavailable"];for(a=n.value.availableRanges.map(xe.f).reduce(Le.j,Be.d),i=0,o=n.value.tables;i<o.length;i++)c=o[i],u=$e(c),r.tables.getValue(u)||(r.tables=r.tables.setValue(u,et(this.syncDataStore.config.localeInfo,c,t.sheet,u)));return[2,a]}}))}))})),[2,Object(y.a)(n,(function(e){return"unavailable"===e?nt:(r.tables.forEachGe(t.range,(function(e,t){return n=t,!1})),void 0!==n||tt(e,t.range)?Object(O.f)(n):nt);var n}))]}))}))},e.prototype.getIntersectingTables=function(t){return Object(l.__awaiter)(this,void 0,void 0,(function(){var r,n,a,i,o,c,u,s,d,f,h=this;return Object(l.__generator)(this,(function(l){switch(l.label){case 0:r=this.getSheetContents(t.sheet.index),n=Be.d,a=t.range.row,i=t.range.row+t.range.rows,l.label=1;case 1:if(!(a<i))return[3,8];o=t.range.col,c=t.range.col+t.range.cols,l.label=2;case 2:return o<c?(u=e.getOrFetchTile(r.tableTiles,Object(b.p)(t.sheet,Object(b.f)(a,o)),(function(e){return h.fetchTableTile(e.sheet,r,e)})),Object(y.b)(u)?[4,u]:[3,4]):[3,7];case 3:return d=l.sent(),[3,5];case 4:d=u,l.label=5;case 5:if("unavailable"===(s=d))return[2,at];n=Object(Le.j)(n,s),l.label=6;case 6:return o+=1<<e.tileWidthPow,[3,2];case 7:return a+=1<<e.tileHeightPow,[3,1];case 8:return f=[],r.tables.forEachMeets(t.range,(function(e,t){return f.push(t),n=Object(Le.j)(n,Object(xe.f)(e)),!0})),[2,tt(n,t.range)?Object(O.f)(f):at]}}))}))},e.prototype.fetchTableTile=function(e,t,r){return Object(l.__awaiter)(this,void 0,void 0,(function(){var n,a,i,o,c,u;return Object(l.__generator)(this,(function(s){switch(s.label){case 0:return[4,this.grid.getIntersectingTables(this.correlationId,r)];case 1:if(n=s.sent(),!Object(O.d)(n))return[2,"unavailable"];for(a=n.value.availableRanges.map(xe.f).reduce(Le.j,Be.d),i=0,o=n.value.tables;i<o.length;i++)c=o[i],u=$e(c),t.tables.getValue(u)||(t.tables=t.tables.setValue(u,et(this.syncDataStore.config.localeInfo,c,e,u)));return[2,a]}}))}))},e.prototype.getIformat=function(t,r){return Object(l.__awaiter)(this,void 0,void 0,(function(){var n,a,i,o,c,u,s,d,f,b;return Object(l.__generator)(this,(function(l){switch(l.label){case 0:return n=r>>>e.formatPagePow,a=n<<e.formatPagePow,i=a+(1<<e.formatPagePow),void 0!==(o=this.formatPages[n])?[3,2]:[4,this.grid.getIformats(this.correlationId,t,a,i)];case 1:if(c=l.sent(),Object(O.d)(c)){for(u=[],s=0,d=c.value.availableFormats;s<d.length;s++)(f=d[s]).iformat<a||f.iformat>=i||(u[f.iformat-a]=f);o=this.formatPages[n]=u}else o=this.formatPages[n]="unavailable";l.label=2;case 2:return"unavailable"===o||void 0===(b=o[r-a])?[2,it]:[2,Object(O.f)(b)]}}))}))},e.prototype.parseCellFormula=function(t,r,n){return{result:e.cachedParseFormula(n?this.englishFormulaCache:this.formulaCache,n?this.englishParser:this.parser,n?this.englishAnalyzer:this.analyzer,t,r)}},e.prototype.parseEdit=function(e,t){var r;return Object(l.__awaiter)(this,void 0,void 0,(function(){var n;return Object(l.__generator)(this,(function(a){switch(a.label){case 0:return[4,this.getEditFormat(e)];case 1:return n=null!==(r=a.sent())&&void 0!==r?r:{valueType:We.h.General,bidiDate:void 0,culture:void 0},[2,this.parseEditInternal(e,t,n)]}}))}))},e.prototype.parseEditSync=function(e,t,r){var n,a=this.parseNumberFormat(r.formatString,r.builtIn).result;return n=Object(O.d)(a)?a.value:{valueType:We.h.General,bidiDate:void 0,culture:void 0},this.parseEditInternal(e,t,n)},e.prototype.resolveReferences=function(e,t){var r=this,n=[];return e.forEach((function(e){switch(e.kind){case ae.e.StructRef:var a=r.resolveStructRefSync(t,e).result;n.push(a);break;case ae.e.CellRef:a=r.resolveCellRefNodeSync(t,e).result;n.push(a)}})),n},e.prototype.parseEditInternal=function(t,r,n){var a=this.formatter.parseEdit(r,n);if(!Object(O.d)(a))return{result:a};if(a.value.kind!==We.e.Formula)return{result:Object(O.f)(a.value)};var i=e.parseCheckedFormula(this.parser,this.analyzer,t,a.value.fmla,t.range);return Object(O.d)(i)?{result:Object(O.f)({kind:We.e.Formula,fmla:a.value.fmla,formula:i.value})}:{result:i}},e.prototype.getEditFormat=function(e){return Object(l.__awaiter)(this,void 0,void 0,(function(){var t,r,n,a,i,o;return Object(l.__generator)(this,(function(c){switch(c.label){case 0:return[4,this.getCell(e)];case 1:return t=c.sent(),Object(O.d)(t)?"string"!=typeof t.value.format?[3,2]:(r=this.parseNumberFormat(t.value.format,!1).result,[3,4]):[2,void 0];case 2:return[4,this.getIformat(e.sheet.document,t.value.format)];case 3:if(n=c.sent(),!Object(O.d)(n))return[2,void 0];a=n.value,i=a.formatString,o=a.builtIn,r=this.parseNumberFormat(i,o).result,c.label=4;case 4:return[2,Object(O.d)(r)?r.value:void 0]}}))}))},e.cachedParseFormula=function(t,r,n,a,i){var o,c=t.get(i);if(void 0!==c)return c;var u=e.parseWellFormedFormula(r,n,a,i.formulaBarText,null!==(o=i.origin)&&void 0!==o?o:a.range);return t.set(i,u),u},e.parseWellFormedFormula=function(t,r,n,a,i){var o=e.parseCheckedFormula(t,r,n,a,i);return Object(O.d)(o)?Object(de.eb)(o.value)?Object(O.f)(o.value):Object(O.c)(Object(Qe.o)("ill-formed formula")):o},e.parseCheckedFormula=function(e,t,r,n,a){var i=e.parseFormula(Object(qe.d)(b.a.Cell,a),n);if(!Object(O.d)(i))return i;var o=t.checkFormula(Object(Ke.a)(b.a.Cell,Object(b.p)(r.sheet,a)),i.value);return Object(O.d)(o)?Object(O.f)(o.value):o},e.prototype.parseNumberFormat=function(e,t){return{result:this.cachedParseNumberFormat(e,t)}},e.prototype.cachedParseNumberFormat=function(e,t){var r=t?this.builtInFormatCache.get(e):this.customFormatCache.get(e);if(void 0!==r)return r;var n=this.formatter.createFormat(e,t);return t?this.builtInFormatCache.set(e,n):this.customFormatCache.set(e,n),n},e.prototype.resolveStructRefSync=function(e,t){return{result:this.resolver.resolveStructRef(Object(Ze.k)(e),t)}},e.prototype.resolveCellRefNodeSync=function(e,t){return{result:this.resolver.resolveCellRef(Object(Ze.k)(e),t)}},e.prototype.close=function(){this.grid.discardSnapshot(this.correlationId).catch((function(e){var t="x10arch.PrefetchingCache.close: ".concat(Object(w.c)(e));v.i.ULS.traceTag(553734788,p.c.msoulscat_ES_EWAJS,p.i.Warning,t)}))},e.tileWidthPow=2,e.tileHeightPow=4,e.formatPagePow=6,e}(),ut=function(){function e(e){this.consumeMessage=e,this.queue=new re.a((function(){return 0}))}return e.prototype.enqueue=function(e,t,r){Object(f.e)(r)&&e.kind===m.d.StopPlugins||this.queue.enqueue(e)},e.prototype.step=function(){var e=this.queue.pop();Object(f.e)(e)&&this.consumeMessage(e)},Object.defineProperty(e.prototype,"done",{get:function(){return 0===this.queue.getCount()},enumerable:!1,configurable:!0}),e}();Object(f.r)();var st,lt=function(e){return new Ee(e)},dt=function(e){return new Ne(e)},ft=function(e){return function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var a=e.getGrid();if(void 0!==a)return(t=ct).create.apply(t,Object(l.__spreadArray)([a],r,!1))}},bt=function(e){return function(t){return new j.a((function(e,t){return e.kind-t.kind}),t,void 0,e)}},ht=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return new(je.bind.apply(je,Object(l.__spreadArray)([void 0,bt(t[1]),ft(e)],t,!1)))},vt=function(e){for(var t,r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];var a=function(e){return t=new ut(e)},i=new(je.bind.apply(je,Object(l.__spreadArray)([void 0,a,ft(e)],r,!1)));if(void 0===t)throw"not initialized";return[i,t]},pt=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return new(_e.bind.apply(_e,Object(l.__spreadArray)([void 0,e],t,!1)))},mt=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return new(De.a.bind.apply(De.a,Object(l.__spreadArray)([void 0],e,!1)))},gt=function(){throw new Error("createIGridFromRecalcService: unimplemented in dev")},Ot=i,jt=a,yt=n;r.d(t,"b",(function(){return Ct})),r.d(t,"c",(function(){return kt})),r.d(t,"d",(function(){return Et})),r.d(t,"a",(function(){return At})),r.d(t,"f",(function(){return Rt})),r.d(t,"e",(function(){return we})),r.d(t,"g",(function(){return we}));var St=Object(f.q)((function(){var e=Rt().createGridProvider((function(){return kt.instance().registerAsyncGrid()}));return Ct.instance().onGridImporterCreated(e,"Main-IGrid"),e})),Ct=Object(f.q)((function(){return Rt().createGridImportManager()})),kt=Object(f.q)((function(){return Rt().createFormulaBarScheduler(St.instance())}));function Et(e){return Rt().createDynamicPluginLoader(Ct.instance(),kt.instance(),e)}Object(f.r)();var At=function(){function e(){}return e.create=function(e){return Et(e)},e}();Object(f.r)();var Nt={createFormulaBarScheduler:ht,createDynamicPluginLoader:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return pt.apply(c,Object(l.__spreadArray)(["excelOnlineCalc.x10.devDynamicPluginLoaderInsideInit"],e,!1))},createRecalcSideGrid:mt,createGridImportManager:dt,createGridProvider:lt,createExperimentFormulaBarScheduler:vt},Tt={createFormulaBarScheduler:ht,createDynamicPluginLoader:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return pt.apply(o,Object(l.__spreadArray)(["excelOnlineCalc.x10.stableDynamicPluginLoaderInsideInit"],e,!1))},createRecalcSideGrid:mt,createGridImportManager:dt,createGridProvider:lt,createExperimentFormulaBarScheduler:vt};function Rt(e){return void 0===e&&(e=Object(d.c)("Microsoft.Office.Excel.SmartFormulaBarUseDevScheduler")?Te.a.Dev:Te.a.Stable),e===Te.a.Dev?Nt:Tt}if(Object(d.c)("TESTING_ONLY_SCHEDULER_IMPORTSCRIPTS_FAIL")&&(self.__retries=(null!==(st=self.__retries)&&void 0!==st?st:-1)+1,0===self.__retries))throw""},function(e,t,r){"use strict";var n=r(9),a=r(40),i=r(3),o=r(10),c=r(51),u=r(26),s=r(16),l=r(0),d=r(24),f=r(115),b=r(116),h=function(){function e(e,t,r,n,a,i,o,c){void 0===a&&(a=new b.a(e,t)),void 0===c&&(c=new f.a(e,t)),this.document=e,this.stringCompareCI=t,this.formats=r,this.styles=n,this.sheets=a,this.grids=i,this.oldGrids=o,this.nameManager=c}return e.prototype.clone=function(t){var r;if(void 0===t&&(t=a.a.Server),this.grids)for(var n in r=Object(o.i)(),this.grids){var i=this.grids[n];r[n]=i.clone(t)}return new e(this.document,this.stringCompareCI,this.formats.clone(),this.styles.clone(),this.sheets.clone(),r,void 0,this.nameManager.clone())},e.prototype.setClientValue=function(e,t){var r=this.getGridById(e.sheet.index);return r.kind===l.b.Failure?r:Object(l.f)(r.value.setClientValue(e.range,t))},e.prototype.setClientFormula=function(e,t){var r=this.getGridById(e.sheet.index);return r.kind===l.b.Failure?r:Object(l.f)(r.value.setClientFormula(e.range,e.range,t))},e.prototype.setRecalcFailure=function(e,t){var r=this.getGridById(e);return r.kind===l.b.Failure?r:Object(l.f)(r.value.setRecalcFailure(t))},e.prototype.setRecalcEditTaint=function(e,t){var r=this.getGridById(e);return r.kind===l.b.Failure?r:Object(l.f)(r.value.setRecalcEditTaint(t))},e.prototype.setRecalcValue=function(e,t){var r=this.getGridById(e.sheet.index);return r.kind===l.b.Failure?r:Object(l.f)(r.value.setRecalcValue(e.range,t))},e.prototype.setEditedFormat=function(e,t){var r=this.getGridById(e.sheet.index);return r.kind===l.b.Failure?r:Object(l.f)(r.value.setEditedFormat(e.range,t))},e.prototype.setClientFormat=function(e,t){var r=this.getGridById(e.sheet.index);return r.kind===l.b.Failure?r:Object(l.f)(r.value.setClientFormat(e.range,t))},e.prototype.setHiddenRows=function(e,t,r){var n=this.getGridById(e);return n.kind===l.b.Failure?n:Object(l.f)(n.value.setHiddenRows(t,r))},e.prototype.setHiddenCols=function(e,t,r){var n=this.getGridById(e);return n.kind===l.b.Failure?n:Object(l.f)(n.value.setHiddenCols(t,r))},e.prototype.setMergeCell=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.b.Failure?t:Object(l.f)(t.value.setMergeCell(e.range))},e.prototype.setInFilterMode=function(e,t){var r=this.getGridById(e);return r.kind===l.b.Failure?r:Object(l.f)(r.value.setInFilterMode(t))},e.prototype.setCellContents=function(e,t,r,n,a,o,c,u){var s=this.getGridById(t.sheet.index);if(s.kind===l.b.Failure)return s;var d=void 0!==u&&Object(i.Z)(t.sheet,u.sheet)?u.range:void 0;return Object(l.f)(s.value.setCellContents(e,t.set,r,n,a,o,c,d))},e.prototype.setRangeFormula=function(e,t,r,n,a,o,c){var u=this.getGridById(t.sheet.index);if(u.kind===l.b.Failure)return u;var s=void 0!==c&&Object(i.Z)(t.sheet,c.sheet)?c.range:void 0;return Object(l.f)(u.value.setRangeFormula(e,t.range,r,n,a,o,s))},e.prototype.copyRange=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.b.Failure?t:Object(l.f)(t.value.copyRange(e.range))},e.prototype.pasteRange=function(e,t){var r=this.getGridById(e.sheet.index);return r.kind===l.b.Failure?r:Object(l.f)(r.value.pasteRange(e.range,t))},e.prototype.getDirtyEditedCells=function(){var e=[];return this.forEachSheet((function(t,r){e.push(Object(s.l)(t.sheetIndex,r.getDirtyEditedCells()))})),e},e.prototype.getNonDirtyEditedCells=function(){var e=[];return this.forEachSheet((function(t,r){e.push(Object(s.l)(t.sheetIndex,r.getNonDirtyEditedCells()))})),e},e.prototype.getDirtyDependentCells=function(){var e=[];return this.forEachSheet((function(t,r){e.push(Object(s.l)(t.sheetIndex,r.getDirtyDependentCells()))})),e},e.prototype.setNamedObject=function(e,t,r,n){return this.nameManager.setNamedObject(e,t,r,n)},e.prototype.setUndefinedNames=function(e){return this.nameManager.setUndefinedNames(e)},e.prototype.promoteNamedObjects=function(e,t){return this.nameManager.promoteNamedObjects(e,t)},e.prototype.setSheetNames=function(t){for(var r,n,a=null!==(r=this.grids)&&void 0!==r?r:this.oldGrids,i=Object(o.i)(),u=0,s=t;u<s.length;u++){var l=s[u].sheetId;i[l]=null!==(n=null==a?void 0:a[l])&&void 0!==n?n:c.a.create()}return new e(this.document,this.stringCompareCI,this.formats,this.styles,this.sheets.setSheetNames(t),i,void 0,this.nameManager.setSheetNames(t))},e.prototype.extendServerUnused=function(e,t){var r=this.getGridById(e);return r.kind===l.b.Failure?r:Object(l.f)(r.value.extendServerUnused(t))},e.prototype.promoteServerAvailability=function(e,t,r){var n=this.getGridById(e);return n.kind===l.b.Failure?n:Object(l.f)(n.value.promoteServerAvailability(t,r))},e.prototype.getNameLoc=function(e,t,r){return this.nameManager.getNameLoc(e,t,r)},e.prototype.getNameFormula=function(e,t){return this.nameManager.getNameFormula(e,t)},e.prototype.hasRecalcNameFailure=function(e){return this.nameManager.hasRecalcNameFailure(e)},e.prototype.setRecalcNameFailure=function(e){return this.nameManager.setRecalcNameFailure(e)},e.prototype.getContainingTable=function(e){var t=this.nameManager.getContainingTable(e);if(t.kind===l.b.Failure||void 0!==t.value)return t;var r=this.getGridById(e.sheet.index);if(r.kind===l.b.Failure)return Object(l.c)(Object(i.kb)([r.reason]));var n=Object(d.g)(Object(u.f)(e.range),u.c);return Object(d.h)(n,r.value.getServerAvailability())?l.g:Object(l.c)(Object(i.kb)([{kind:a.d.ContainingTable,range:e}]))},e.prototype.getNamedRanges=function(e){var t=this.nameManager.getNamedRanges(e);if(t.kind===l.b.Failure||void 0!==t.value)return t;var r=this.getGridById(e.sheet.index);if(r.kind===l.b.Failure)return Object(l.c)(Object(i.kb)([r.reason]));var n=Object(d.g)(Object(u.f)(e.range),u.c);return Object(d.h)(n,r.value.getServerAvailability())?Object(l.f)([]):Object(l.c)(Object(i.kb)([{kind:a.d.NamedRanges,range:e}]))},e.prototype.getIntersectingTables=function(e){return this.nameManager.getIntersectingTables(e)},e.prototype.getStructRefColumn=function(e,t){return this.nameManager.getStructRefColumn(e,t)},e.prototype.getStructRefSpecialRef=function(e,t){return this.nameManager.getStructRefSpecialRef(e,t)},e.prototype.getEditedFormula=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.b.Failure?t:Object(l.f)(t.value.getEditedFormula(e.range))},e.prototype.forEachEditedFormula=function(e,t){var r=this.getGridById(e.sheet.index);return r.kind===l.b.Failure?r:Object(l.f)(r.value.forEachEditedFormula(e.range,t))},e.prototype.getEditedValue=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.b.Failure?t:Object(l.f)(t.value.getEditedValue(e.range))},e.prototype.forEachEditedValue=function(e,t){var r=this.getGridById(e.sheet.index);return r.kind===l.b.Failure?r:Object(l.f)(r.value.forEachEditedValue(e.range,t))},e.prototype.getEditedFormat=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.b.Failure?t:Object(l.f)(t.value.getEditedFormat(e.range))},e.prototype.forEachEditedFormat=function(e,t){var r=this.getGridById(e.sheet.index);return r.kind===l.b.Failure?r:Object(l.f)(r.value.forEachEditedFormat(e.range,t))},e.prototype.getEditedStyle=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.b.Failure?t:Object(l.f)(t.value.getEditedStyle(e.range))},e.prototype.isInFilterMode=function(e){var t=this.getGridById(e);return t.kind===l.b.Failure?t:t.value.isInFilterMode()},e.prototype.getHiddenRows=function(e,t,r){var n=this.getGridById(e);return n.kind===l.b.Failure?c.j:n.value.getHiddenRows(t,r)},e.prototype.tryGetHiddenRows=function(e,t,r){var n=this.getGridById(e);return n.kind===l.b.Failure?n:n.value.tryGetHiddenRows(t,r)},e.prototype.getHiddenCols=function(e,t,r){var n=this.getGridById(e);return n.kind===l.b.Failure?c.j:n.value.getHiddenCols(t,r)},e.prototype.tryGetHiddenCols=function(e,t,r){var n=this.getGridById(e);return n.kind===l.b.Failure?n:n.value.tryGetHiddenCols(t,r)},e.prototype.getMergeCell=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.b.Failure?t:Object(l.f)(t.value.getMergeCell(e.range))},e.prototype.getServerFormat=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.b.Failure?t:Object(l.f)(t.value.getServerFormat(e.range))},e.prototype.getServerStyle=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.b.Failure?t:Object(l.f)(t.value.getServerStyle(e.range))},e.prototype.getClientFormat=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.b.Failure?t:Object(l.f)(t.value.getClientFormat(e.range))},e.prototype.getClientValue=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.b.Failure?t:Object(l.f)(t.value.getClientValue(e.range))},e.prototype.getRecalcValues=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.b.Failure?t:Object(l.f)(t.value.getRecalcValues(e.range))},e.prototype.getServerValue=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.b.Failure?t:Object(l.f)(t.value.getServerValue(e.range))},e.prototype.getServerFormula=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.b.Failure?t:Object(l.f)(t.value.getServerFormula(e.range))},e.prototype.getClientFormula=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.b.Failure?t:Object(l.f)(t.value.getClientFormula(e.range))},e.prototype.getServerUsedRange=function(e){var t=this.getGridById(e);return t.kind===l.b.Failure?t:Object(l.f)(t.value.getServerUsedRange())},e.prototype.allServerAvailable=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.b.Failure?t:Object(l.f)(t.value.allServerAvailable(e.range))},e.prototype.allEditedAvailable=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.b.Failure?t:Object(l.f)(t.value.allEditedAvailable(e.range))},e.prototype.forEachRecalcDirty=function(e,t){var r=this.getGridById(e.sheet.index);return r.kind===l.b.Failure?r:Object(l.f)(r.value.forEachRecalcDirty(e.range,t))},e.prototype.hasRecalcDirty=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.b.Failure?t:Object(l.f)(t.value.hasRecalcDirty(e.range))},e.prototype.hasRecalcFailure=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.b.Failure?t:Object(l.f)(t.value.hasRecalcFailure(e.range))},e.prototype.hasEditedEditTaint=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.b.Failure?t:Object(l.f)(t.value.hasEditedEditTaint(e.range))},e.prototype.hasRecalcEditTaint=function(e){var t=this.getGridById(e.sheet.index);return t.kind===l.b.Failure?t:Object(l.f)(t.value.hasRecalcEditTaint(e.range))},e.prototype.forEachEditedNonBlankCellInSet=function(e,t,r){var n=this.getGridById(e);return n.kind===l.b.Failure?n:Object(l.f)(n.value.forEachEditedNonBlankCellInSet(t,r))},e.prototype.forEachServerNonBlankCellInSet=function(e,t,r){var n=this.getGridById(e);return n.kind===l.b.Failure?n:Object(l.f)(n.value.forEachServerNonBlankCellInSet(t,r))},e.prototype.forEachEditedCellInSet=function(e,t,r){var n=this.getGridById(e);return n.kind===l.b.Failure?n:Object(l.f)(n.value.forEachEditedCellInSet(t,r))},e.prototype.getSheetIndex=function(e){var t=this.sheets.getSheetByName(e);return t.kind===l.b.Failure||void 0===t.value?t:Object(l.f)(t.value.sheetIndex)},e.prototype.getSheetName=function(e){var t=this.sheets.getSheetById(e);return t.kind===l.b.Failure?t:Object(l.f)(t.value.name)},e.prototype.getEditedUsedRange=function(e){var t=this.getGridById(e);return t.kind===l.b.Failure?t:Object(l.f)(t.value.getEditedUsedRange())},e.prototype.getSheetRangeIds=function(e){return this.sheets.getSheetRangeIds(e)},e.prototype.getIformat=function(e){return this.formats.getIformat(e)},e.prototype.getIformats=function(){return this.formats.getIformats()},e.prototype.getKnownFormat=function(e){return this.formats.getKnownFormat(e)},e.prototype.getFormatString=function(e){return this.formats.getFormatString(e)},e.prototype.resolveCellStyle=function(e){return this.styles.resolveCellStyle(e)},e.prototype.setNumberFormats=function(e,t){this.formats.setNumberFormats(e,t)},e.prototype.setStyles=function(e,t){this.styles.setStyles(e,t)},e.prototype.setFonts=function(e,t){this.styles.setFonts(e,t)},e.prototype.setFills=function(e,t){this.styles.setFills(e,t)},e.prototype.setBorders=function(e,t){this.styles.setBorders(e,t)},e.prototype.onCellModified=function(e){this.forEachSheet((function(t,r){r.onCellModified(e)})),this.nameManager.onCellModified(e)},e.prototype.collectGarbage=function(e){this.forEachSheet((function(t,r){r.collectGarbage(e)})),this.nameManager.collectGarbage(e)},e.prototype.advanceState=function(e){this.forEachSheet((function(t,r){r.advanceState(e)})),this.nameManager.advanceState(e),this.sheets.advanceState(e),this.oldGrids=this.grids,this.grids=void 0},e.prototype.clearCompiledFormulas=function(){this.forEachSheet((function(e,t){t.clearCompiledFormulas()})),this.nameManager.resetLazyData()},e.prototype.clearCompiledNumberFormats=function(){this.formats.clearCompiledNumberFormats()},e.prototype.getGridStatistics=function(){var e=c.h;return this.forEachSheet((function(t,r){return e=Object(c.o)(e,r.getStatistics())})),e},e.prototype.getNameStatistics=function(){return this.nameManager.getNameStatistics()},e.prototype.getServerAvailableCells=function(){var e=[];return this.forEachSheet((function(t,r){e.push({sheetIdx:t.sheetIndex,availableCells:r.getServerAvailability()})})),e},e.prototype.forEachSheet=function(e){var t=this.grids;t&&this.sheets.forEachSheet((function(r,n){var a=t[n];a&&e(r,a)}))},e.prototype.getGridById=function(e){var t=this.grids;if(!t)return Object(l.c)({kind:a.d.SheetNames});var r=t[e];return void 0===r?Object(l.c)({kind:a.d.SheetId,document:this.document,sheetId:e}):Object(l.f)(r)},e}(),v=r(12),p=r(4),m=r(7),g=r(83),O=r(66),j=r(28),y=r(56),S=r(80),C=r(97),k=r(2),E=r(45),A=r(1),N=r(120),T=r(5),R=r(121),I=r(68),_=r(79),F=r(35),w=r(114),M=r(6),D=r(92),P=r(90),x=r(8),L=r(19),B=r(20),U=r(11),G=r(63),V=function(){function e(e){this.iformats=[],this.formatStrings=Object(o.i)(),this.knownFormats=e}return e.prototype.clone=function(){var t=this,r=new e(this.knownFormats);return Object.keys(this.iformats).map(Number).forEach((function(e){r.iformats[e]=t.iformats[e]})),Object.keys(this.formatStrings).forEach((function(e){r.formatStrings[e]=t.formatStrings[e]})),r},e.prototype.clearCompiledNumberFormats=function(){var e=this;this.iformats.forEach((function(e){e.compiledFormat.reset()})),Object.keys(this.knownFormats).map((function(e){return Number(e)})).forEach((function(t){e.knownFormats[t].reset()})),this.formatStrings=Object(o.i)(),Object.keys(this.iformats).map(Number).forEach((function(t){var r=e.iformats[t];e.formatStrings[r.formatString]=t}))},e.prototype.getIformat=function(e){var t=this.iformats[e];return void 0===t?Object(l.c)({kind:a.d.NumberFormat,iformat:e}):Object(l.f)(t.compiledFormat)},e.prototype.getIformats=function(){return this.iformats},e.prototype.getKnownFormat=function(e){return Object(l.f)(this.knownFormats[e])},e.prototype.getFormatString=function(e){return Object(l.f)(this.formatStrings[e])},e.prototype.setNumberFormats=function(e,t){var r=this;t||(this.iformats=[],this.formatStrings=Object(o.i)()),Object.keys(e).map(Number).forEach((function(t){var n=r.iformats[t];void 0!==n&&delete r.formatStrings[n.formatString];var a=e[t];r.iformats[t]=a,r.formatStrings[a.formatString]=t}))},e}(),H=r(48),W=r(18),z=r(29),q=r(100),K=r(82);r.d(t,"b",(function(){return Q})),r.d(t,"c",(function(){return Z})),r.d(t,"a",(function(){return $}));var Y=Object(v.f)(0,0),J=function(e){function t(){var t=e.call(this,void 0)||this;return t.fns=[],t}return Object(n.__extends)(t,e),t.prototype.wsfNode=function(e){this.fns.push(Object(p.r)(e))},t.prototype.operatorNode=function(e){this.fns.push(Object(p.n)(e))},t}(z.c);var Q,X=Object(m.q)([],[],x.d.None,m.b.Exact);!function(e){e.GroundTruth="GroundTruth",e.Estimation="Estimation",e.PrecisionTest="PrecisionTest"}(Q||(Q={}));var Z={onNameFailure:function(){},onRangeFailure:function(){},onNumberFormatFailure:function(){},onInferFormatFailure:function(){},onUnavailableObject:function(){},onUnavailable:function(){},onSetCellValue:function(){},onSetCellValues:function(){},onReturnCellValue:function(){}},$=function(){function e(e,t,r,n,o,c){var u=this;this.cb=t,this.schedulerConfig=r,this.limits=n,this.maxDereferenceCells=o,this.isServerWorkbookLoad=c,this.random=new B.JSF32(4294967296*Math.random()),this.worksheetFuncOverrides={},this.userDefinedFuncOverrides={},this.interruptToken=[j.b.Continue],this.getCellValue=this.makeGetCellValues(this.tryGetCellValue.bind(this)),this.getCellValues=this.makeGetCellValues(this.tryGetCellValues.bind(this)),this.compileNamedObject=function(e,t,r){var n=e?s.c.ServerNamedFormula:s.c.EditNamedFormula;switch(r.kind){case"NamedFormula":var o=r.fmla,c=u.parser.parseFormula(Object(y.d)(v.a.NameManager,Y),o);Object(T.h)("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: isServerUpdate",e);var d=e&&u.isServerWorkbookLoad,f=Object(O.b)(Object(v.n)(Object(v.e)(u.documentLoc),Y),void 0,d),b=c,h=u.checkFormula(f,b,o,n);return u.compileFormula(Object(j.i)(Y),h);case"NamedValue":case"NamedRange":case"NamedTable":var p;c=void 0;if("NamedRange"===r.kind){var m=r.value;Object(T.h)("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: bad range",Object(i.D)(r.value.sheets.document,t.scope.document));var g=m.sheets,S=u.getDocument(g.document);if(!Object(l.d)(S))return u.cb.onUnavailableObject(S.reason),Object(l.c)(Object(i.kb)([S.reason]));var C=S.value.getSheetName(g.index);if(!Object(l.d)(C))return u.cb.onUnavailable(C.reason),C;var E=r.value.ranges[0];c=Object(k.I)(Object(k.u)(Object(k.v)(Object(k.x)(Object(k.db)(k.f.Abs,E.row),Object(k.db)(k.f.Abs,E.col)),Object(k.x)(Object(k.db)(k.f.Abs,E.row+E.rows-1),Object(k.db)(k.f.Abs,E.col+E.cols-1))),Object(k.gb)(C.value)),[],[],1),p=Object(v.p)(g,Y)}else"NamedTable"===r.kind?(c=Object(k.I)(Object(k.kb)(Object(k.X)(t.name),Object(k.jb)(void 0)),[],[],1),p=Object(v.n)(Object(v.e)(u.documentLoc),Y)):(c=Object(k.I)(Object(k.T)(r.value,!0),[],[],1),p=Object(v.n)(Object(v.e)(u.documentLoc),Y));h=u.analyzer.checkFormula(Object(O.b)(p),c);return Object(l.d)(h)&&Object(i.eb)(h.value)?u.compileFormula(Object(j.i)(Y),Object(l.f)(h.value)):Object(T.a)("calc.calc.PartialWorkbookDocumentCollection.compileNamedObject: constructed ill-formed formula ".concat(Object(_.a)(u.config,c,Object(v.j)(t))));case"NamedFailure":return Object(l.c)(Object(i.kb)([{kind:a.d.ClientFailure,reason:r.failureReason}]));default:return Object(T.e)("calc.calc.partialWorkbookDocumentCollection.compileNamedFmla",r)}},this.config=e,this.parser=Object(S.a)(this),this.printer=Object(_.b)(this),this.analyzer=Object(g.a)(this),this.formatter=Object(D.a)(this),this.compiler=Object(C.b)(this),this.evaluator=Object(R.a)(this)}return e.prototype.clone=function(t,r){var n;void 0===t&&(t=Z),void 0===r&&(r=a.a.Server);var i=new e(this.config,t,this.schedulerConfig,this.limits,this.maxDereferenceCells,this.isServerWorkbookLoad);return i.documentLoc=this.documentLoc,i.document=null===(n=this.document)||void 0===n?void 0:n.clone(r),i.worksheetFuncOverrides=this.worksheetFuncOverrides,i.userDefinedFuncOverrides=this.userDefinedFuncOverrides,i},e.prototype.reconfigure=function(e,t,r,n){this.schedulerConfig=e,this.limits=t,this.maxDereferenceCells=r,this.isServerWorkbookLoad=n},e.prototype.setConfig=function(e){this.config=e},e.prototype.forEachDocument=function(e){void 0!==this.document&&e(this.document)},e.prototype.getDocumentLoc=function(e,t){var r=this.documentLoc;return void 0===r||void 0!==e&&e!==r.path||0!==this.config.localeInfo.stringCompareCI(t,r.name)?Object(l.c)(Object(i.kb)([{kind:a.d.DocumentLoc,document:Object(v.d)(e,t)}])):Object(l.f)(r)},e.prototype.getNameLoc=function(e,t,r){var n=this.getDocument(e.document);return n.kind===l.b.Failure?Object(l.c)(Object(i.kb)([n.reason])):n.value.getNameLoc(e.index,t,r)},e.prototype.getUserDefinedFuncLoc=function(e,t){if(void 0!==this.userDefinedFuncOverrides[t]){var r=Object(v.y)(e,t);return Object(l.f)([r])}return Object(l.c)(Object(i.hb)(["call UDF"]))},e.prototype.getCellFormat=function(e){var t=this.allEditedAvailable(e);if(t.kind===l.b.Failure)return Object(l.c)(Object(i.kb)([t.reason]));if(!0!==t.value)return Object(l.c)(Object(i.kb)([{kind:a.d.GridRange,unavailableCells:t.value,range:e}]));var r=this.getEditedFormat(e);return r.kind===l.b.Failure?Object(l.c)(Object(i.kb)([r.reason])):r.value===s.f.Unavailable?Object(l.c)(Object(i.kb)([{kind:a.d.CellFormat}])):Object(l.f)(r.value)},e.prototype.getCellStyle=function(e){var t=this.allEditedAvailable(e);if(!Object(l.d)(t))return Object(l.c)(Object(i.kb)([t.reason]));if(!0!==t.value)return Object(l.c)(Object(i.kb)([{kind:a.d.GridRange,unavailableCells:t.value,range:e}]));var r=this.getEditedStyle(e);return Object(l.d)(r)?r.value===s.g.Unavailable?Object(l.c)(Object(i.kb)([{kind:a.d.CellStyle}])):this.resolveCellStyle(e.sheet.document,r.value):Object(l.c)(Object(i.kb)([r.reason]))},e.prototype.getIformat=function(e,t){var r=this.getDocument(e);if(r.kind===l.b.Failure)return Object(l.c)(Object(i.kb)([r.reason]));var n=r.value.getIformat(t);if(n.kind===l.b.Failure)return Object(l.c)(Object(i.kb)([n.reason]));var a=n.value.getValue();return a.kind===l.b.Failure?Object(l.c)(Object(M.H)()):a},e.prototype.getIformats=function(e,t,r){var n=this.getDocument(e);if(n.kind===l.b.Failure)return Object(l.c)(Object(i.kb)([n.reason]));for(var a=n.value.getIformats(),c=[],u=t,s=Object(o.c)(a.length,r);u<s;u+=1){var d=a[u];void 0!==d&&c.push({iformat:u,formatString:d.formatString,builtIn:d.builtIn})}return Object(l.f)(c)},e.prototype.getKnownFormat=function(e,t){var r=this.getDocument(e);if(r.kind===l.b.Failure)return Object(l.c)(Object(i.kb)([r.reason]));var n=r.value.getKnownFormat(t);if(n.kind===l.b.Failure)return Object(l.c)(Object(i.kb)([n.reason]));var a=n.value.getValue();return a.kind===l.b.Failure?Object(l.c)(Object(M.H)()):a},e.prototype.getFormatString=function(e,t){var r=this.getDocument(e);if(r.kind===l.b.Failure)return Object(l.c)(Object(i.kb)([r.reason]));var n=r.value.getFormatString(t);return n.kind===l.b.Failure?Object(l.c)(Object(i.kb)([n.reason])):n},e.prototype.getNameFormula=function(e,t){var r=this.getDocument(e.scope.document);if(r.kind===l.b.Failure)return Object(l.c)(Object(i.kb)([r.reason]));var n=r.value.getNameFormula(e,t);if(n.kind===l.b.Failure)return n;if(void 0===n.value)return Object(l.f)(void 0);var a=n.value.lazyData.getValue();if(Object(l.d)(a))return a;var o=this.hasRecalcNameFailure(e);return Object(l.d)(o)?o.value||this.setNameFailure(e,a.reason):this.cb.onUnavailable(o.reason),Object(l.c)(Object(j.v)(e))},e.prototype.getCellFormula=function(e){var t=this.getEditedFormula(e);if(t.kind===l.b.Failure)return Object(l.c)(Object(i.kb)([t.reason]));if(void 0===t.value)return Object(l.f)(void 0);var r=t.value,n=r[0],a=r[1];if(void 0===a.compiledFmla)return Object(l.f)(void 0);var o=Object(v.r)(e.sheet,n),c=this.readCompiledFmla(o,a.compiledFmla);return Object(l.d)(c)?Object(l.f)(Object(j.f)(Object(v.i)(a.lexicalKind,o),c.value)):c},e.prototype.setCellValue=function(e,t,r){var n=this.setRecalcValue(e,t);if(n.kind===l.b.Failure)return this.cb.onUnavailableObject(n.reason);var a=this.propagateEditTaint(e,r);if(a.kind===l.b.Failure)return this.cb.onUnavailableObject(a.reason);this.cb.onSetCellValue(e,t,r,a.value,this.evalParams)},e.prototype.setCellValues=function(e,t,r){var n=this.setClientValue(e,t);if(n.kind===l.b.Failure)return this.cb.onUnavailableObject(n.reason);var a=this.setRecalcValue(e,t);if(a.kind===l.b.Failure)return this.cb.onUnavailableObject(a.reason);var i=this.propagateEditTaint(e,r);if(i.kind===l.b.Failure)return this.cb.onUnavailableObject(i.reason);this.cb.onSetCellValues(e,t,r,i.value,this.evalParams)},e.prototype.getWorksheetFunc=function(e){var t;if(0!=(Object(A.e)(e).staticPrecs&(x.d.Time|x.d.Calc))){var r=!1,n=this.evalParams.volatileMode;switch(e){case A.b.RAND:case A.b.RANDBETWEEN:case A.b.RANDARRAY:case A.b.NOW:r=n===Q.GroundTruth;break;case A.b.TODAY:r=n===Q.GroundTruth||n===Q.Estimation;break;default:r=void 0===A.b[e]}if(!r)return Object(l.c)(Object(i.kb)([{kind:a.d.VolatileFunction,name:Object(p.r)(e)}]))}var o=null!==(t=this.worksheetFuncOverrides[e])&&void 0!==t?t:Object(N.a)(e);return null!=o?Object(l.f)(o):Object(l.c)(Object(i.hb)([Object(p.r)(e)]))},e.prototype.getUserDefinedFunc=function(e){var t=e.id;return void 0!==this.userDefinedFuncOverrides[t]?Object(l.f)(this.userDefinedFuncOverrides[t]):Object(l.c)(Object(i.hb)(["call UDF"]))},e.prototype.getSheetRangeIndexes=function(e){return this.getSheetRangeIds(e)},e.prototype.setCellFailure=function(e,t,r){var n=this.setRecalcFailure(e.sheet,Object(u.f)(e.range));if(n.kind===l.b.Failure)return this.cb.onUnavailableObject(n.reason);var a=this.setClientValue(e,c.g);if(a.kind===l.b.Failure)return this.cb.onUnavailableObject(a.reason);var i=this.setRecalcValue(e,m.d);if(i.kind===l.b.Failure)return this.cb.onUnavailableObject(i.reason);var o=this.propagateEditTaint(e,r);if(o.kind===l.b.Failure)return this.cb.onUnavailableObject(o.reason);this.cb.onRangeFailure(e,t,r,o.value,this.evalParams)},e.prototype.getUsedRange=function(e){var t=this.getEditedUsedRange(e);return t.kind===l.b.Failure?Object(l.c)(Object(i.kb)([t.reason])):t},e.prototype.getSheetName=function(e,t){var r=this.getDocument(e);if(r.kind===l.b.Failure)return Object(l.c)(Object(i.kb)([r.reason]));var n=r.value.getSheetName(t);return n.kind===l.b.Failure||void 0===n.value?n:Object(l.f)(n.value)},e.prototype.getSheetIndex=function(e,t){var r=this.getDocument(e);if(r.kind===l.b.Failure)return Object(l.c)(Object(i.kb)([r.reason]));var n=r.value.getSheetIndex(t);return n.kind===l.b.Failure||void 0===n.value?n:Object(l.f)(n.value.index)},e.prototype.getContainingTable=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.b.Failure?Object(l.c)(Object(i.kb)([t.reason])):t.value.getContainingTable(e)},e.prototype.getNamedRanges=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.b.Failure?Object(l.c)(Object(i.kb)([t.reason])):t.value.getNamedRanges(e)},e.prototype.getStructRefColumn=function(e,t){var r=this.getDocument(e.scope.document);return r.kind===l.b.Failure?Object(l.c)(Object(i.kb)([r.reason])):r.value.getStructRefColumn(e,t)},e.prototype.getStructRefSpecialRef=function(e,t){var r=this.getDocument(e.scope.document);return r.kind===l.b.Failure?Object(l.c)(Object(i.kb)([r.reason])):r.value.getStructRefSpecialRef(e,t)},e.prototype.getIntersectingTables=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.b.Failure?Object(l.c)(Object(i.kb)([t.reason])):t.value.getIntersectingTables(e)},e.prototype.getNamedObject=function(e,t){var r,n=this.getDocument(e.scope.document);if(n.kind===l.b.Failure)return Object(l.c)(Object(i.kb)([n.reason]));var a=n.value.getNameFormula(e,t);return a.kind===l.b.Failure?a:Object(l.f)(null===(r=a.value)||void 0===r?void 0:r.obj)},e.prototype.getHiddenRows=function(e,t,r){var n=this.getDocument(e.document);return n.kind===l.b.Failure?c.j:n.value.getHiddenRows(e.index,t,r)},e.prototype.tryGetHiddenRows=function(e,t,r){var n=this.getDocument(e.document);if(n.kind===l.b.Failure)return Object(l.c)(Object(i.kb)([n.reason]));var a=n.value.tryGetHiddenRows(e.index,t,r);return a.kind===l.b.Failure?Object(l.c)(Object(i.kb)([a.reason])):a},e.prototype.getHiddenCols=function(e,t,r){var n=this.getDocument(e.document);return n.kind===l.b.Failure?c.j:n.value.getHiddenCols(e.index,t,r)},e.prototype.tryGetHiddenCols=function(e,t,r){var n=this.getDocument(e.document);if(n.kind===l.b.Failure)return Object(l.c)(Object(i.kb)([n.reason]));var a=n.value.tryGetHiddenCols(e.index,t,r);return a.kind===l.b.Failure?Object(l.c)(Object(i.kb)([a.reason])):a},e.prototype.getMergeCell=function(e){var t=this.allEditedAvailable(e);if(t.kind===l.b.Failure)return Object(l.c)(Object(i.kb)([t.reason]));if(!0!==t.value)return Object(l.c)(Object(i.kb)([{kind:a.d.GridRange,unavailableCells:t.value,range:e}]));var r=this.getDocument(e.sheet.document);if(r.kind===l.b.Failure)return Object(l.c)(Object(i.kb)([r.reason]));var n=r.value.getMergeCell(e);return n.kind===l.b.Failure?Object(l.c)(Object(i.kb)([n.reason])):n},e.prototype.isInFilterMode=function(e){var t=this.getDocument(e.document);if(t.kind===l.b.Failure)return Object(l.c)(Object(i.kb)([t.reason]));var r=t.value.isInFilterMode(e.index);return r.kind===l.b.Failure?Object(l.c)(Object(i.kb)([r.reason])):r},e.prototype.getRandom=function(){return Object(T.h)("calc.calc.PartialWorkbookDocumentCollection: getRandom",this.evalParams.volatileMode===Q.GroundTruth),Object(l.f)(this.config.mathpack.fromNumber(this.random.next()))},e.prototype.getTime=function(e,t){return Object(E.e)(this.config,e,t,this.evalParams.volatileMode)},e.prototype.withEvalParams=function(e,t){var r=this,n=this.evalParams;this.evalParams=e;try{var a=t();return Array.isArray(a)?a:Object(j.s)((function(){return r.withEvalParams(e,a.resume)}))}finally{this.evalParams=n}},e.prototype.withEvalParamsEvalFormula=function(e,t){var r=this,n=this.evalParams;this.evalParams=e;try{var a=t();return a.kind!==l.b.Paused?a:Object(j.s)((function(){return r.withEvalParamsEvalFormula(e,a.resume)}))}finally{this.evalParams=n}},e.prototype.evaluate=function(e,t,r){var n=this;return this.withEvalParams({computeKind:e,computeCells:t,volatileMode:r},(function(){return n.evaluator.evalCells(t)}))},e.prototype.evalFormula=function(e,t,r,n,a){var i=this,o=r.sheet,c=r.range,u={lexicalKind:v.a.Other,originGridCell:Object(l.f)(t),originSheet:Object(l.f)(o),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!0,wrapCellReferences:!1,workbookLoad:!1},d={lexicalSource:{kind:v.a.Other},originGridCell:Object(l.f)(c),originSheet:Object(l.f)(o),calcingArray:!1,reflectionGridCell:Object(l.f)(c),reflectionSheet:Object(l.f)(o),implicitIntersect:!1,allowUnqualifiedCell:!0,wrapCellReferences:!1,followHyperlinks:Object(l.f)(!1)},f=function(e,t){if(t.kind===l.b.Paused)return Object(j.s)((function(){return f(e,t.resume())}));if(!Object(l.d)(t))return Object(l.f)({value:t,cell:c});var a=i.evalFormulaFormat(r,e,t.value,n);return Object(l.f)({value:Object(l.f)(t.value),formatted:a,cell:c})};return this.withEvalParamsEvalFormula({computeKind:s.a.EvalFormula,computeCells:[r],volatileMode:a},(function(){var t=i.parser.parseFormula(u,e),r=i.checkFormula(u,t,e,s.c.EvalFormula),n=i.compileFormula(u,r);return Object(l.d)(n)?f(n.value,i.evaluator.evalFormula(d,n.value)):Object(l.f)({value:n,cell:c})}))},e.prototype.evalFormulaRange=function(e,t,r,n,a){var i,o=this,c=r.sheet,u=r.range,s=u.row,d=u.col,f=[],b=function(){for(;s<u.row+u.rows;s+=1,d=u.col)for(;d<u.col+u.cols;){var r=Object(v.p)(c,Object(v.f)(s,d)),h=void 0;return i?(h=i(),i=void 0):h=o.evalFormula(e,t,r,n,a),h.kind===l.b.Paused?(i=h.resume,Object(j.s)(b)):Object(l.d)(h.value.value)||h.value.value.reason.kind!==j.d.Stopped?(f.push(h.value),d+=1,Object(j.s)(b)):Object(l.c)(h.value.value.reason)}return Object(l.f)(f)};return b()},e.prototype.evalFormulaFormat=function(e,t,r,n){if(void 0!==n){if(n===s.f.Origin){var o=this.allEditedAvailable(e);return Object(l.d)(o)?!0!==o.value?Object(l.c)(Object(i.kb)([{kind:a.d.GridRange,unavailableCells:o.value,range:e}])):this.formatValueCell(e,r):void this.cb.onUnavailableObject(o.reason)}if(n===s.f.Inferred){var c={lexicalSource:{kind:v.a.Other},originGridCell:Object(l.f)(e.range),originSheet:Object(l.f)(e.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1},u=this.formatter.evalFormat(c,t);return Object(l.d)(u)?void 0===u.value?this.formatValueKnownFormat(e.sheet.document,U.d.General,r):"number"==typeof u.value?this.formatValueIformat(e.sheet.document,u.value,r):this.formatter.applyFormat(u.value,r,!0):u}return this.formatValueIformat(e.sheet.document,n,r)}},e.prototype.evalValue=function(e,t,r){var n,a=this.evalParams;this.evalParams={computeKind:t,computeCells:[e],volatileMode:r};try{var i=this.getEditedFormula(e);if(!Object(l.d)(i))return this.cb.onUnavailableObject(i.reason);if(void 0!==(null===(n=i.value)||void 0===n?void 0:n[1].compiledFmla))return;var o=this.hasRecalcDirty(e);if(!Object(l.d)(o))return this.cb.onUnavailableObject(o.reason);if(o.value)return;var c=this.tryGetCellValue(e.range,e.sheet);if(void 0===c)return;Object(T.h)("calc.calc.PartialWorkbookDocumentCollection.evalValue",c.kind===j.a.FinalValue),this.cb.onReturnCellValue(e,c.oper,s.b.EditedCell)}finally{this.evalParams=a}},e.prototype.setUserDefinedFuncOverrides=function(e){this.userDefinedFuncOverrides=e},e.prototype.setWorksheetFuncOverrides=function(e){this.worksheetFuncOverrides=e},e.prototype.setSheetNames=function(e,t){var r=this.ensureDocument(e);return r.kind===l.b.Failure?r:(this.document=r.value.setSheetNames(t),Object(l.f)(void 0))},e.prototype.advanceState=function(e){void 0!==this.document&&this.document.advanceState(e)},e.prototype.onCellModified=function(e){if(void 0!==this.document)return this.document.onCellModified(e)},e.prototype.getServerDocument=function(){return this.documentLoc},e.prototype.allServerAvailable=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.b.Failure?t:t.value.allServerAvailable(e)},e.prototype.forEachEditedNonBlankCellInSet=function(e,t,r){var n=e.index,a=e.document,i=this.getDocument(a);return i.kind===l.b.Failure?i:i.value.forEachEditedNonBlankCellInSet(n,t,r)},e.prototype.forEachServerNonBlankCellInSet=function(e,t,r){var n=e.index,a=e.document,i=this.getDocument(a);return i.kind===l.b.Failure?i:i.value.forEachServerNonBlankCellInSet(n,t,r)},e.prototype.forEachEditedCellInSet=function(e,t,r){var n=e.index,a=e.document,i=this.getDocument(a);return i.kind===l.b.Failure?i:i.value.forEachEditedCellInSet(n,t,r)},e.prototype.clearCompiledFormulas=function(){if(void 0!==this.document)return this.document.clearCompiledFormulas()},e.prototype.clearCompiledNumberFormats=function(){if(void 0!==this.document)return this.document.clearCompiledNumberFormats()},e.prototype.getGridStatistics=function(){return void 0!==this.document?this.document.getGridStatistics():c.h},e.prototype.getNameStatistics=function(){return void 0!==this.document?this.document.getNameStatistics():G.b},e.prototype.collectGarbage=function(e){if(void 0!==this.document)return this.document.collectGarbage(e)},e.prototype.getEditedFormula=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.b.Failure?t:t.value.getEditedFormula(e)},e.prototype.forEachEditedFormula=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===l.b.Failure?r:r.value.forEachEditedFormula(e,t)},e.prototype.getEditedValue=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.b.Failure?t:t.value.getEditedValue(e)},e.prototype.forEachEditedValue=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===l.b.Failure?r:r.value.forEachEditedValue(e,t)},e.prototype.getEditedFormat=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.b.Failure?t:t.value.getEditedFormat(e)},e.prototype.forEachEditedFormat=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===l.b.Failure?r:r.value.forEachEditedFormat(e,t)},e.prototype.getEditedStyle=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.b.Failure?t:t.value.getEditedStyle(e)},e.prototype.getServerFormat=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.b.Failure?t:t.value.getServerFormat(e)},e.prototype.getServerStyle=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.b.Failure?t:t.value.getServerStyle(e)},e.prototype.getClientFormat=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.b.Failure?t:t.value.getClientFormat(e)},e.prototype.getClientValue=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.b.Failure?t:t.value.getClientValue(e)},e.prototype.getRecalcValues=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.b.Failure?t:t.value.getRecalcValues(e)},e.prototype.getServerValue=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.b.Failure?t:t.value.getServerValue(e)},e.prototype.getServerFormula=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.b.Failure?t:t.value.getServerFormula(e)},e.prototype.getClientFormula=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.b.Failure?t:t.value.getClientFormula(e)},e.prototype.getServerUsedRange=function(e){var t=this.getDocument(e.document);if(t.kind===l.b.Failure)return t;var r=t.value.getServerUsedRange(e.index);return r.kind===l.b.Failure||void 0===r.value?r:Object(l.f)(Object(v.r)(e,r.value))},e.prototype.getServerAvailableCells=function(){var e=[];return this.forEachDocument((function(t){Object(o.p)(e,t.getServerAvailableCells())})),e},e.prototype.promoteServerAvailability=function(e,t){var r=e.sheet,n=e.set,a=this.getDocument(r.document);return a.kind===l.b.Failure?a:a.value.promoteServerAvailability(r.index,n,t)},e.prototype.extendServerUnused=function(e,t){var r=this.getDocument(e.document);return r.kind===l.b.Failure?r:r.value.extendServerUnused(e.index,t)},e.prototype.setCellContents=function(e,t,r,n,a,i,o,u,s,d){var f=this.getDocument(t.sheet.document);if(f.kind===l.b.Failure)return f;var b=void 0===r?void 0:n?this.compileFmla(e,v.a.Cell,Object(v.p)(t.sheet,a),void 0,r):""===r?c.d:{fmla:r,lexicalKind:v.a.Cell,origin:a,compiledFmla:void 0,hasHyperlink:c.b.ClientValueUnknown};return f.value.setCellContents(e,t,b,i,o,u,s,d)},e.prototype.setRangeFormula=function(e,t,r,n,a,o,u,s){var d=this.getDocument(t.sheet.document);if(d.kind===l.b.Failure)return d;var f=""===r?c.f:this.compileFmla(e,v.a.Range,Object(v.p)(t.sheet,n),Object(i.n)(t.range),r);return d.value.setRangeFormula(e,t,f,a,o,u,s)},e.prototype.copyRange=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.b.Failure?t:t.value.copyRange(e)},e.prototype.pasteRange=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===l.b.Failure?r:r.value.pasteRange(e,t)},e.prototype.getDirtyEditedCells=function(){return this.document?this.document.getDirtyEditedCells():[]},e.prototype.getNonDirtyEditedCells=function(){return this.document?this.document.getNonDirtyEditedCells():[]},e.prototype.getDirtyDependentCells=function(){return this.document?this.document.getDirtyDependentCells():[]},e.prototype.setNamedObject=function(e,t,r){var n=this.getDocument(t.scope.document);return n.kind===l.b.Failure?Object(l.c)(Object(i.kb)([n.reason])):n.value.setNamedObject(e,t,r,this.compileNamedObject)},e.prototype.setUndefinedNames=function(e){var t=this.getDocument(e.document);return t.kind===l.b.Failure?Object(l.c)(Object(i.kb)([t.reason])):t.value.setUndefinedNames(e)},e.prototype.promoteNamedObjects=function(e,t){var r=this.getDocument(e.document);return r.kind===l.b.Failure?Object(l.c)(Object(i.kb)([r.reason])):r.value.promoteNamedObjects(e,t)},e.prototype.setNumberFormats=function(e,t,r){var n=this,a=this.ensureDocument(e);if(a.kind===l.b.Failure)return Object(l.c)(Object(i.kb)([a.reason]));var o=[];return t.forEach((function(e){var t=e.iformat,r=e.formatString,a=e.builtIn,i=n.compileNumberFormat(r,a);o[t]={formatString:r,builtIn:a,compiledFormat:i}})),Object(l.f)(a.value.setNumberFormats(o,r))},e.prototype.setStyles=function(e,t,r){var n=this.ensureDocument(e);return n.kind===l.b.Failure?n:Object(l.f)(n.value.setStyles(t,r))},e.prototype.setFonts=function(e,t,r){var n=this.ensureDocument(e);return n.kind===l.b.Failure?n:Object(l.f)(n.value.setFonts(t,r))},e.prototype.setFills=function(e,t,r){var n=this.ensureDocument(e);return n.kind===l.b.Failure?n:Object(l.f)(n.value.setFills(t,r))},e.prototype.setBorders=function(e,t,r){var n=this.ensureDocument(e);return n.kind===l.b.Failure?n:Object(l.f)(n.value.setBorders(t,r))},e.prototype.writeHiddenRows=function(e,t,r){var n=this.getDocument(e.document);return n.kind===l.b.Failure?n:n.value.setHiddenRows(e.index,t,r)},e.prototype.writeHiddenCols=function(e,t,r){var n=this.getDocument(e.document);return n.kind===l.b.Failure?n:n.value.setHiddenCols(e.index,t,r)},e.prototype.writeMergeCell=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.b.Failure?t:t.value.setMergeCell(e)},e.prototype.writeInFilterMode=function(e,t){var r=this.getDocument(e.document);return r.kind===l.b.Failure?r:r.value.setInFilterMode(e.index,t)},e.prototype.resolveCellFormat=function(e,t){if("number"!=typeof t)return Object(l.f)(t);var r=this.getDocument(e);if(!Object(l.d)(r))return Object(l.c)(Object(i.kb)([r.reason]));var n=r.value.getIformat(t);return Object(l.d)(n)?n.value.getValue():Object(l.c)(Object(i.kb)([n.reason]))},e.prototype.resolveCellStyle=function(e,t){var r=this.getDocument(e);if(!Object(l.d)(r))return Object(l.c)(Object(i.kb)([r.reason]));var n=r.value.resolveCellStyle(t);return Object(l.d)(n)?Object(l.f)(n.value):Object(l.c)(Object(i.kb)([n.reason]))},e.prototype.resolveValueFormat=function(e,t){var r;if("string"==typeof t)return this.resolveStringFormat(e,t);var n=this.getKnownFormat(e,t);if(!Object(l.d)(n))return n;var a=this.getFormatString(e,n.value.formatString);return Object(l.d)(a)?Object(l.f)(null!==(r=a.value)&&void 0!==r?r:n.value):a},e.prototype.resolveStringFormat=function(e,t){var r=this.getFormatString(e,t);return Object(l.d)(r)?void 0!==r.value?Object(l.f)(r.value):this.formatter.createFormat(t,!1):r},e.prototype.resolveObjectFormat=function(e,t){var r=this.getFormatString(e,t.formatString);return Object(l.d)(r)?void 0!==r.value?Object(l.f)(r.value):Object(l.f)(t):r},e.prototype.resolveEditFormat=function(e,t){return"number"==typeof t?Object(l.f)(t):this.resolveStringFormat(e,t)},e.prototype.resolveRibbonFormat=function(e,t,r){var n;switch(t){case K.a.GalleryShortDate:case K.a.GalleryLongDate:var a=this.getCellFormat(r);if(!Object(l.d)(a))return a;var i=this.resolveCellFormat(r.sheet.document,a.value);if(!Object(l.d)(i))return i;n=i.value}var o=Object(K.b)(this.config.localeInfo,t,n);return this.resolveStringFormat(e,o)},e.prototype.resolveChangeDecimals=function(e,t,r){var n=this.getCellFormat(r);if(!Object(l.d)(n))return n;var a=this.resolveCellFormat(r.sheet.document,n.value);if(!Object(l.d)(a))return a;var i=this.formatter.changeFormatDecimals(a.value,t);return Object(l.d)(i)?void 0===i.value?l.g:this.resolveObjectFormat(e,i.value):i},e.prototype.parseInferredEdit=function(e,t,r){var n=this.getCellFormat(e);if(!Object(l.d)(n))return n;var a=this.resolveCellFormat(e.sheet.document,n.value);if(!Object(l.d)(a))return a;var i=this.evalParams;this.evalParams={computeKind:s.a.ParseEdit,computeCells:[e],volatileMode:r};try{return this.formatter.parseEdit(t,a.value)}finally{this.evalParams=i}},e.prototype.inferFormulaFormat=function(e){var t=this.getEditedFormula(e);if(!Object(l.d)(t))return Object(l.f)(void this.cb.onUnavailableObject(t.reason));if(void 0===t.value||void 0===t.value[1].compiledFmla)return Object(l.f)(void this.cb.onUnavailableObject({kind:a.d.CellEvaluatingValue}));var r=t.value[1].compiledFmla.getValue();if(!Object(l.d)(r))return r;var n=Object(v.i)(t.value[1].lexicalKind,Object(v.r)(e.sheet,t.value[0])),i=r.value;return this.formatter.evalFormat(Object(M.p)(n),i)},e.prototype.fillInferredFormat=function(e,t){var r=this,n=t,a=t===s.f.Unavailable?Object(l.f)(s.f.Unavailable):this.resolveCellFormat(e.sheet.document,t);if(!Object(l.d)(a)){var i=a.reason;Object(u.i)(e.set,(function(t){var n=Object(v.r)(e.sheet,t);return r.cb.onInferFormatFailure(n,i),!0})),a=Object(l.f)(s.f.Unavailable),n=s.f.Unavailable}var o=a.value;Object(u.g)(e.set,(function(t){var a=Object(v.p)(e.sheet,t),i=r.getEditedFormat(a);if(!Object(l.d)(i))return r.cb.onUnavailableObject(i.reason),!0;if(i.value===s.f.Unavailable)return!0;var c=r.resolveCellFormat(e.sheet.document,i.value);if(!Object(l.d)(c))return r.cb.onInferFormatFailure(a,c.reason),!0;if(Object(P.b)(o===s.f.Unavailable?void 0:o,c.value)){var u=r.setEditedFormat(a,n);Object(l.d)(u)||r.cb.onUnavailableObject(u.reason)}return!0}))},e.prototype.anonymizeFormula=function(e,t){var r,n,a,i=null===(r=t.compiledFmla)||void 0===r?void 0:r.getValue();return void 0!==i&&Object(l.d)(i)?[Object(_.a)(this.config,i.value,e),(n=i.value,a=new J,Object(z.m)(a,n),a.fns)]:[Object(F.b)(t.fmla),[]]},e.prototype.compileFmla=function(e,t,r,n,a){var i=this;return{fmla:a,lexicalKind:t,origin:null!=n?n:r.range,compiledFmla:new E.a((function(){var o=i.parser.parseFormula(Object(y.d)(t,r.range),a),c=e?o:i.autocorrectFormula(Object(O.a)(t,r),o),u=e&&i.isServerWorkbookLoad,l=i.checkFormula(Object(O.a)(t,r,void 0,u),c,a,e?s.c.ServerCellFormula:s.c.EditCellFormula),d=i.adjustFormulaOrigin(l,r,n);return i.compileFormula(Object(j.h)(t,r.range),d)})),hasHyperlink:c.b.ClientValueUnknown}},e.prototype.compileFormula=function(e,t){return Object(l.d)(t)?this.compiler.compileFormula(e,t.value):t},e.prototype.checkFormula=function(e,t,r,n){if(!Object(l.d)(t))return t;var a=this.analyzer.checkFormulaWithDiagnostics(e,t.value);if(!Object(l.d)(a))return a;if(!Object(i.eb)(a.value[0])){var o="calc.PartialWorkbook.checkFormula: expected well-formed formula; given "+Object(F.b)(r);return Object(l.c)(Object(j.o)(o,n,Object(O.e)(a.value[1])))}return Object(l.f)(a.value[0])},e.prototype.autocorrectFormula=function(e,t){return Object(l.d)(t)?this.analyzer.autocorrectFormula(e,t.value):t},e.prototype.adjustFormulaOrigin=function(e,t,r){if(!Object(l.d)(e)||void 0===r)return e;var n=Object(L.k)(t);return Object(w.a)(this,n,r,e.value)},e.prototype.compileNumberFormat=function(e,t){var r=this;return new E.a((function(){var n=r.formatter.createFormat(e,t);return Object(l.d)(n)||r.cb.onNumberFormatFailure(n.reason),n}))},e.prototype.compileKnownFormats=function(){var e=this;return Object(o.m)(U.d,(function(t){return e.compileNumberFormat(Object(H.h)(e.config.localeInfo,t),!1)}))},e.prototype.printFormulaBarText=function(e,t,r){return this.printer.printFormula(Object(I.b)(e,Object(v.p)(e.range.sheet,t)),r)},e.prototype.renderValueBarText=function(e,t,r){var n=this.getEditedResolvedFormat(e);return Object(l.d)(n)?this.formatter.renderFormulaBar(e.sheet.document,t,n.value,Object(W.h)(r,"'")):n},e.prototype.formatValueCell=function(e,t){if(Object(i.y)(t))return Object(l.f)(Object(M.u)([],void 0,M.a.Left,M.c.All));var r=this.getEditedResolvedFormat(e);if(!Object(l.d)(r))return r;return this.formatter.applyFormat(r.value,t,!0)},e.prototype.formatValueIformat=function(e,t,r){var n=this.getIformat(e,t);return Object(l.d)(n)?this.formatter.applyFormat(n.value,r,!0):n},e.prototype.formatValueKnownFormat=function(e,t,r){var n=this.getKnownFormat(e,t);return Object(l.d)(n)?this.formatter.applyFormat(n.value,r,!0):n},e.prototype.getEditedResolvedFormat=function(e){var t=this.getEditedFormat(e);return Object(l.d)(t)?t.value===s.f.Unavailable?Object(l.c)(Object(i.kb)([{kind:a.d.CellFormat}])):this.resolveCellFormat(e.sheet.document,t.value):Object(l.c)(Object(i.kb)([t.reason]))},e.prototype.getDocument=function(e){return void 0!==this.documentLoc&&void 0!==this.document&&Object(i.D)(this.documentLoc,e)?Object(l.f)(this.document):Object(l.c)({kind:a.d.DocumentLoc,document:e})},e.prototype.ensureDocument=function(e){return void 0===this.documentLoc&&void 0===this.document&&(this.documentLoc=e,this.document=new h(e,this.config.localeInfo.stringCompareCI,new V(this.compileKnownFormats()),new q.a)),this.getDocument(e)},e.prototype.tryGetCellValues=function(e,t){var r=this,n=Object(v.r)(t,e),o=e.row,c=e.col,u=e.rows,s=e.cols,d=this.getRecalcValues(n);if(d.kind!==l.b.Failure){for(var f=!1,b=0;b<u;b+=1)for(var h=d.value[b],p=0;p<s;p+=1){var m=h[p].failure;void 0!==m&&(this.setCellFailure(Object(v.p)(t,Object(v.f)(o+b,c+p)),m,X),f=!0)}if(!f){var g=function(e){return Object(j.m)(e.oper)},O=d.value.map((function(e){return e.map(g)})),y=this.forEachRecalcDirty(n,(function(e){var n=Object(v.p)(t,e),u=r.getEditedFormula(n);if(u.kind===l.b.Failure)return r.cb.onUnavailableObject(u.reason),!1;if(void 0===u.value)return r.setCellFailure(n,Object(i.kb)([{kind:a.d.CellMissingFormula}]),X),f=!0,!0;var s=u.value,d=s[0],b=s[1];if(void 0===b.compiledFmla)return r.cb.onUnavailableObject({kind:a.d.CellEvaluatingValue}),!1;var h=r.readCompiledFmla(Object(v.r)(t,d),b.compiledFmla);return Object(l.d)(h)?(O[e.row-o][e.col-c]=Object(j.t)(Object(v.p)(t,Object(i.n)(d))),!0):(f=!0,!0)}));if(Object(l.d)(y)){if(y.value&&!f)return O}else this.cb.onUnavailableObject(y.reason)}}else this.cb.onUnavailableObject(d.reason)},e.prototype.tryGetCellValue=function(e,t){var r=this.tryGetCellValues(e,t);return void 0===r?void 0:r[0][0]},e.prototype.makeGetCellValues=function(e){var t=this;return function(r){var n=t.allEditedAvailable(r);if(n.kind===l.b.Failure)return Object(l.c)(Object(i.kb)([n.reason]));if(!0!==n.value)return Object(l.c)(Object(i.kb)([{kind:a.d.GridRange,range:r,unavailableCells:n.value}]));var o=t.hasRecalcFailure(r);if(o.kind===l.b.Failure)return Object(l.c)(Object(i.kb)([o.reason]));if(o.value)return Object(l.c)(Object(j.u)(r));if(Object(i.u)(r.range)>t.maxDereferenceCells)return Object(l.c)(Object(i.kb)([{kind:a.d.GridRangeSize,range:r}]));var c=e(r.range,r.sheet);return void 0===c?Object(l.c)(Object(j.u)(r)):Object(l.f)(c)}},e.prototype.readCompiledFmla=function(e,t){var r=t.getValue();if(Object(l.d)(r))return r;if(this.setCellFailure(e,r.reason,X),r.reason.kind===j.d.Unavailable){r.reason;return r}return Object(l.c)(Object(i.kb)([{kind:a.d.CellFormula,reason:r.reason}]))},e.prototype.getEditedUsedRange=function(e){var t=this.getDocument(e.document);if(t.kind===l.b.Failure)return t;var r=t.value.getEditedUsedRange(e.index);return r.kind===l.b.Failure||void 0===r.value?r:Object(l.f)(Object(v.r)(e,r.value))},e.prototype.getSheetRangeIds=function(e){var t=this.getDocument(e.document);return t.kind===l.b.Failure?Object(l.c)(Object(i.kb)([t.reason])):t.value.getSheetRangeIds(e)},e.prototype.allEditedAvailable=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.b.Failure?t:t.value.allEditedAvailable(e)},e.prototype.forEachRecalcDirty=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===l.b.Failure?r:r.value.forEachRecalcDirty(e,t)},e.prototype.hasRecalcDirty=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.b.Failure?t:t.value.hasRecalcDirty(e)},e.prototype.hasRecalcFailure=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.b.Failure?t:t.value.hasRecalcFailure(e)},e.prototype.hasEditedEditTaint=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.b.Failure?t:t.value.hasEditedEditTaint(e)},e.prototype.hasRecalcEditTaint=function(e){var t=this.getDocument(e.sheet.document);return t.kind===l.b.Failure?t:t.value.hasRecalcEditTaint(e)},e.prototype.setEditedFormat=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===l.b.Failure?r:r.value.setEditedFormat(e,t)},e.prototype.setClientFormat=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===l.b.Failure?r:r.value.setClientFormat(e,t)},e.prototype.setRecalcFailure=function(e,t){var r=this.getDocument(e.document);return r.kind===l.b.Failure?r:r.value.setRecalcFailure(e.index,t)},e.prototype.testAndSetClientValue=function(e,t){var r=this.getClientValue(e);if(r.kind===l.b.Failure)return r;var n=Object(c.n)(r.value.oper)||!Object(i.S)(this.config.mathpack,r.value.oper,t,!0);if(n){var a=this.setClientValue(e,t);if(a.kind===l.b.Failure)return a}return Object(l.f)(n)},e.prototype.testAndSetClientFormat=function(e,t){var r=this.getClientFormat(e);if(r.kind===l.b.Failure)return r;var n=t!==r.value;if(n){var a=this.setClientFormat(e,t);if(a.kind===l.b.Failure)return a}return Object(l.f)(n)},e.prototype.testAndSetClientFormula=function(e,t,r){var n,a=this.getClientFormula(Object(i.ib)(e));if(a.kind===l.b.Failure)return a;var o=null!==(n=a.value)&&void 0!==n?n:[e.range,c.e],u=o[0],s=o[1],d=Object(i.n)(e.range),f=void 0!==t&&t!==s.fmla||void 0!==s.compiledFmla&&!Object(i.G)(d,s.origin),b=void 0!==r&&r!==s.hasHyperlink;if(f||b){var h=s.compiledFmla,p=this.setClientFormula(Object(v.r)(e.sheet,u),{fmla:null!=t?t:s.fmla,compiledFmla:h,origin:void 0!==t?d:s.origin,hasHyperlink:null!=r?r:s.hasHyperlink});if(p.kind===l.b.Failure)return p}return Object(l.f)({hasFmlaChanged:f,hasHyperlinkChanged:b})},e.prototype.setRecalcEditTaint=function(e,t){var r=this.getDocument(e.document);return r.kind===l.b.Failure?r:r.value.setRecalcEditTaint(e.index,t)},e.prototype.propagateEditTaint=function(e,t){var r=this.hasEditedEditTaint(e);if(r.kind===l.b.Failure)return r;if(r.value)return Object(l.f)(s.b.EditedCell);for(var n=0,a=t.cells;n<a.length;n++){var i,o=a[n],c=this.hasRecalcEditTaint(o);if(c.kind===l.b.Failure)return c;if(c.value)return(i=this.setRecalcEditTaint(e.sheet,Object(u.f)(e.range))).kind===l.b.Failure?i:Object(l.f)(s.b.DependentCell)}return 0!=(t.special&(x.d.Calc|x.d.Time))?(i=this.setRecalcEditTaint(e.sheet,Object(u.f)(e.range))).kind===l.b.Failure?i:Object(l.f)(s.b.DependentCell):t.bound===m.b.Exact||void 0!==this.evalParams&&this.evalParams.computeKind===s.a.EditedCell?Object(l.f)(s.b.IndependentCell):Object(l.f)(s.b.UnknownNonEditedCell)},e.prototype.setClientValue=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===l.b.Failure?r:r.value.setClientValue(e,t)},e.prototype.setRecalcValue=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===l.b.Failure?r:r.value.setRecalcValue(e,t)},e.prototype.setClientFormula=function(e,t){var r=this.getDocument(e.sheet.document);return r.kind===l.b.Failure?r:r.value.setClientFormula(e,t)},e.prototype.hasRecalcNameFailure=function(e){var t=this.getDocument(e.scope.document);return t.kind===l.b.Failure?Object(l.c)(Object(i.kb)([t.reason])):t.value.hasRecalcNameFailure(e)},e.prototype.setRecalcNameFailure=function(e){var t=this.getDocument(e.scope.document);return t.kind===l.b.Failure?Object(l.c)(Object(i.kb)([t.reason])):t.value.setRecalcNameFailure(e)},e.prototype.setNameFailure=function(e,t){var r=this.setRecalcNameFailure(e);if(r.kind===l.b.Failure)return this.cb.onUnavailable(r.reason);this.cb.onNameFailure(e,t,this.evalParams)},e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return I})),r.d(t,"b",(function(){return x})),r.d(t,"c",(function(){return L})),r.d(t,"d",(function(){return B})),r.d(t,"e",(function(){return U}));var n=r(12),a=r(10),i=r(2),o=r(46),c=r(61),u=r(33),s=r(18),l=r(23),d=r(30),f=n.v,b=f.toString(10).length,h=n.o,v=h.toString(26).length,p=h.toString(10).length,m=u.d,g=u.e,O=u.A,j=u.C,y=u.v,S=u.t,C=u.f;function k(e){return e>=O&&e<=j||e>=m&&e<=g}function E(e){return 1+(e>=O?e-O:e-m)}function A(e,t,r,n){return function(a,o,c,u,f){var b=function(e,t){return Object(s.h)(e,"$",t)?[i.f.Abs,t+1]:[i.f.Rel,t]}(c,u),h=b[0],v=b[1],p=e(a,r,c,v),m=p[0],g=p[1];if(g>v){if(m<1||m>t)return(h===i.f.Abs||(!0===n?"object"==typeof f&&f.kind===i.f.Abs||f===I.A1BadDollar:Object(s.h)(c,"$",g)))&&Object(d.e)(d.a["OfficeVSO:3594447_A1_BadDollar"])?[I.A1BadDollar,!0,g]:void 0;var O=h===i.f.Rel?m-o:m;return[Object(i.db)(h,O-1),h===i.f.Abs&&Object(d.e)(d.a["OfficeVSO:3594447_A1_BadDollar"]),g]}return h!==i.f.Abs||!0!==n&&g!==c.length&&a.isNumeral(Object(l.i)(c,g))||!Object(d.e)(d.a["OfficeVSO:3594447_A1_BadDollar"])?[void 0,!1,u]:[I.A1BadDollar,!0,g]}}function N(e,t,r){return Object(o.n)(e,t,r)-e}function T(e,t,r,n){return function(a,o,u,l){var f=t?e?"R":a.rowLetter:e?"C":a.columnLetter;if(l>=u.length||0!==a.stringCompareCI(f,u[l]))return[void 0,!1,l];var b=l+f.length,h=Object(c.d)(a,n,u,b),v=h[0],p=h[1];if(p>b){if(v>=1&&v<=r)return[Object(i.db)(i.f.Abs,v-1),!1,p];if(!Object(d.e)(d.a["OfficeVSO:3594447_R1C0_Fix"]))return}if(Object(s.h)(u,a.leftBracket,b)){if(b+=a.leftBracket.length,Object(s.h)(u,a.rightBracket,b))return[Object(i.db)(i.f.Rel,N(o,0,r)),!0,b+a.rightBracket.length];var m=1,g=u.charCodeAt(b);g===y?b+=1:g===S&&(m=-1,b+=1);var O=Object(c.d)(a,n,u,b),j=O[0],C=O[1];if(C>b&&j<r&&Object(s.h)(u,a.rightBracket,C))return[Object(i.db)(i.f.Rel,N(o,j*m,r)),!0,C+a.rightBracket.length]}return[I.RCNoNum,!1,l+f.length]}}function R(e,t,r,n,a,i,o){var c=n(e,t,i,o,void 0);if(null==c)return[void 0,void 0,o];var u=c[0],s=c[1],l=c[2];if(l>o){var d=a(e,r,i,l,u);if(null==d)return s?[u,void 0,l]:[void 0,void 0,o];var f=d[0],b=d[2];return b>l?[u,f,b]:[u,void 0,l]}var h=a(e,r,i,o,u);if(null==h)return[void 0,void 0,o];var v=h[0],p=h[2];return p>o?[void 0,v,p]:[void 0,void 0,o]}var I,_=A(c.d,f,b,!0),F=A((function(e,t,r,n){return function(e,t,r){for(var n=0,i=r,o=Object(a.c)(t.length,r+e);i<o;i+=1){var c=t.charCodeAt(i);if(!k(c))break;n=26*n+E(c)}return i===o&&i<t.length&&k(t.charCodeAt(i))?[0,r]:[n,i]}(t,r,n)}),h,v,!1),w=T(!1,!0,f,b),M=T(!1,!1,h,p),D=T(!0,!0,f,b),P=T(!0,!1,h,p);function x(e,t){return"object"!=typeof e&&"object"!=typeof t}function L(e,t,r,n,a){var o=function(e,t,r,n,a){var o=R(e,r.col,r.row,F,_,n,a),c=o[0],u=o[1],s=o[2],d="object"==typeof u&&u.kind===i.f.Abs||u===I.A1BadDollar||"object"==typeof c&&c.kind===i.f.Abs||c===I.A1BadDollar;if(null!=u&&null!=c||d||(null!=u||null!=c)&&(a-1>=0&&n.charCodeAt(a-1)===C||s<n.length&&n.charCodeAt(s)===C)){if(s<n.length&&e.isIdentContinue(Object(l.i)(n,s)))return;if(t!==i.h.A1&&!d)return;return{refStyle:i.h.A1,row:u,col:c,i:s}}}(e,t,r,n,a);return void 0!==o?o:function(e,t,r,n,a){var o,c=r.col,u=r.row,s=!1,d=R(e,u,c,w,M,n,a),f=d[0],b=d[1],h=d[2];if(null!=f||null!=b||"R"===e.rowLetter&&"C"===e.columnLetter||(s=!0,f=(o=R(e,u,c,D,P,n,a))[0],b=o[1],h=o[2]),(null!=f||null!=b)&&(h>=n.length||!x(f,b)||!e.isIdentContinue(Object(l.i)(n,h))))return{refStyle:i.h.R1C1,row:f,col:b,i:h,enLocale:s}}(e,0,r,n,a)}function B(e,t){var r=R(e,0,0,F,_,t,0),a=r[0],i=r[1],o=r[2];return"object"==typeof a&&"object"==typeof i&&o===t.length?Object(n.f)(i.index,a.index):void 0}function U(e,t){var r=R(e,0,0,F,_,t,0),i=r[0],o=r[1],c=r[2];if("object"==typeof i&&"object"==typeof o){if(c===t.length)return Object(n.f)(o.index,i.index);if(t.charCodeAt(c)===C){var u=R(e,0,0,F,_,t,c+1),s=u[0],l=u[1],d=u[2];if("object"==typeof s&&"object"==typeof l&&d===t.length){var f=Object(a.c)(o.index,l.index),b=Object(a.c)(i.index,s.index);return Object(n.g)(f,b,Object(a.b)(o.index,l.index)+1-f,Object(a.b)(i.index,s.index)+1-b)}}}}!function(e){e[e.RCNoNum=0]="RCNoNum",e[e.A1BadDollar=1]="A1BadDollar"}(I||(I={}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return v})),r.d(t,"d",(function(){return p})),r.d(t,"b",(function(){return g})),r.d(t,"c",(function(){return O}));var n=r(10),a=r(5),i=r(18),o=r(23),c=r(11),u=r(33),s=r(3),l=u.D,d=u.r,f=u.t,b=u.v,h=u.z;function v(e){return e===l||e===d}function p(e,t,r,i){Object(a.b)("calc.parse.parseUint",t,16);for(var c=0,u=i,s=r.length;u<s;){var l=Object(o.i)(r,u);if(!e.isNumeral(l))break;var d=e.getOrdinal(l);0===c&&0!==d&&(s=Object(n.c)(s,u+t)),c=10*c+d,u+=Object(o.f)(l)}return u===s&&u<r.length&&e.isNumeral(Object(o.i)(r,u))?[0,i]:[c,u]}function m(e,t,r,n){var i=n,o=p(e,5,r,i),c=o[0],u=o[1];if(u===i)return!1;if(c>32767)return!1;if(!((i=u)<r.length&&r.charCodeAt(i)===h))return!1;var l=p(e,5,r,i+=1),d=l[0],f=l[1];if(f===i)return!1;if(d>32767)return!1;if(i=f,0===d)return[!1,0,i];var b=t.div(t.fromNumber(c),t.fromNumber(d));return Object(a.h)("calc.lang.tryTokenizeFrac",Object(s.M)(b)),[b,d,i]}function g(e,t,r,u,l,d,h){var g,O,j,y=u,S=0,C="",k=!1,E=!1,A=c.e.ASCII;if(Object(i.h)(r,e.decimalSeparator,u)||u<r.length&&e.isNumeral(Object(o.i)(r,u))){for(var N=function(){if((d||l&&r.indexOf("%",y)>=0)&&(S-=2,void 0!==g)){var i=t.div(g,t.fromNumber(100));Object(a.h)("calc.lang.parseNumberLiteral",Object(s.M)(i)),g=i,j=c.d.Pct}if(Object(n.a)(S)>=309)return{value:void 0,i:y,consumedThousands:k,consumedDecimal:E,numShape:A,format:j};var o=t.parse(e,!0,S,C);if(void 0!==g){var u=t.add(o,g);Object(a.h)("calc.lang.parseNumberLiteral",Object(s.M)(u)),o=u}return{value:o,i:y,consumedThousands:k,consumedDecimal:E,numShape:A,format:j}};y<r.length;){var T=Object(o.i)(r,y);if(!e.isNumeral(T))break;if(0!==e.getOrdinal(T))break;(O=e.getNumberShape(T))!==c.e.ASCII&&(A=O),y+=Object(o.f)(T)}if(h)if(!1!==(F=m(e,t,r,y))){var R=F[0],I=F[1],_=F[2];return y=_,!1===R?{value:void 0,i:y,consumedThousands:k,consumedDecimal:E,numShape:A,format:j}:(j=I>=10?c.d.FractBond:c.d.Fract,g=R,N())}for(var F,w=y;y<r.length;){T=Object(o.i)(r,y);if(e.isNumeral(T))S+=1,(O=e.getNumberShape(T))!==c.e.ASCII&&(A=O),y+=Object(o.f)(T);else{if(!(l&&S>0&&Object(i.h)(r,e.thousandsSeparator,y)))break;k=!0,y+=e.thousandsSeparator.length}}if(C+=r.substring(w,y),k){var M=function(e,t,r){for(var n=r,a="",i=0;i<t.length;){var c=Object(o.i)(t,i);if(e.isNumeral(c)){var u=Object(o.f)(c);a+=t.substring(i,i+u),i+=u,n-=1}else{if(0===n||!e.isThousandsPosition(n))return;i+=e.thousandsSeparator.length}}return a}(e,C,S);if(void 0===M)return;C=M}if(u<y&&y<r.length&&v(r.charCodeAt(y)))if(!1!==(F=m(e,t,r,y+1))){R=F[0],I=F[1],_=F[2];return y=_,!1===R?{value:void 0,i:y,consumedThousands:k,consumedDecimal:E,numShape:A,format:j}:(j=I>=10?c.d.FractBond:c.d.Fract,g=R,N())}var D=!1;if(Object(i.h)(r,e.decimalSeparator,y)&&(D=y===u,E=!0,y+=e.decimalSeparator.length),0===S)for(;y<r.length;){T=Object(o.i)(r,y);if(!e.isNumeral(T))break;if(0!==e.getOrdinal(T))break;S-=1,(O=e.getNumberShape(T))!==c.e.ASCII&&(A=O),y+=Object(o.f)(T)}for(w=y;y<r.length;){T=Object(o.i)(r,y);if(!e.isNumeral(T))break;(O=e.getNumberShape(T))!==c.e.ASCII&&(A=O),y+=Object(o.f)(T)}if(C+=r.substring(w,y),!(D&&y<=u+e.decimalSeparator.length)){var P=function(e,t,r){var n=r;if(n<t.length&&0===e.stringCompareCI("E",t.substring(n,n+1)))n+=1;else{if(!Object(i.h)(t,"**",n))return[0,r];n+=2}var a=!1;if(n<t.length){var c=Object(o.i)(t,n);((a=c===f)||c===b)&&(n+=Object(o.f)(c))}if(n>=t.length||!e.isNumeral(Object(o.i)(t,n)))return!1;var u=p(e,10,t,n),s=u[0],l=u[1];return l!==n&&(!(s>2147483647)&&[a?-s:s,l])}(e,r,y);if(!1!==P){var x=P[0];_=P[1];S+=x,_!==y&&(j=c.d.Exp),y=_}return!1===P?{value:void 0,i:y,consumedThousands:k,consumedDecimal:E,numShape:A,format:j}:N()}}}function O(e,t,r,n,a){var i=n,o=!1;if(i<r.length){var c=r.charCodeAt(i);if((c===b||c===f)&&(o=c===f,i+=1,a))for(;i<r.length&&v(r.charCodeAt(i));)i+=1}var u=g(e,t,r,i,!1,!1,!1);return void 0===(null==u?void 0:u.value)?[t.zero,n]:(i=u.i,[o?t.neg(u.value):u.value,i])}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"d",(function(){return i})),r.d(t,"b",(function(){return o}));var n,a=r(53);function i(e){return{kind:n.RangeValues,arrays:e}}function o(e){return e.kind===n.RangeValues}r.d(t,"c",(function(){return a})),function(e){e.RangeValues="RangeValues"}(n||(n={}))},function(e,t,r){"use strict";r.d(t,"j",(function(){return v})),r.d(t,"h",(function(){return p})),r.d(t,"i",(function(){return g})),r.d(t,"e",(function(){return O})),r.d(t,"g",(function(){return j})),r.d(t,"f",(function(){return y})),r.d(t,"b",(function(){return k})),r.d(t,"d",(function(){return E})),r.d(t,"c",(function(){return A})),r.d(t,"a",(function(){return T}));var n=r(9),a=r(98),i=r(40),o=r(12),c=r(10),u=r(45),s=r(54),l=r(0),d=r(2),f=r(3),b=r(5),h=r(75),v=Object(c.w)()((function(e){return{kind:"NamedValue",value:e}})),p=Object(c.w)()((function(e){return{kind:"NamedRange",value:e}})),m=s.a.create((function(e,t){return e-t}));function g(e,t,r,n,a){var i,c=e.sheet,u=e.range,l=t?Object(o.g)(u.row-1,u.col,1,u.cols):void 0,h=r?Object(o.g)(u.row+u.rows,u.col,1,u.cols):void 0,v=Object(f.t)(Object(f.t)(l,e.range),h),p=n.reduce((function(t,r){return Object(b.h)("calc.calc.namedTable: column names in range",r.column>=e.range.col&&r.column<e.range.col+e.range.cols),t.setValue(r.column,r.name)}),m),g=s.a.create(a);p.forEach((function(e,t){return g=g.setValue(t,e),!0}));var O=p.getCount()===e.range.cols;return{kind:"NamedTable",specialRefRanges:(i={},i[d.i.Data]=e,i[d.i.Headers]=l?Object(o.r)(c,l):void 0,i[d.i.Totals]=h?Object(o.r)(c,h):void 0,i[d.i.All]=Object(o.r)(c,v),i),columnNames:g,columnIndexes:p,allColumnNamesAvailable:O,hasHeadersRow:t,hasTotalsRow:r}}function O(e,t){var r=e.columnNames,a=e.columnIndexes;t.columnIndexes.forEach((function(t,n){var a=e.columnIndexes.getValue(t);return void 0!==a&&(r=r.remove(a)),!0})),t.columnIndexes.forEach((function(e,t){return r=r.setValue(t,e),a=a.setValue(e,t),!0}));var i=a.getCount()===t.specialRefRanges[d.i.All].range.cols;return Object(n.__assign)(Object(n.__assign)({},t),{columnNames:r,columnIndexes:a,allColumnNamesAvailable:i})}var j=Object(c.w)()((function(e){return{kind:"NamedFormula",fmla:e}})),y=Object(c.w)()((function(e,t){return{kind:"NamedFailure",failureReason:e,objectKind:t}})),S=Object(h.a)(),C=Object(h.a)(),k={namesCount:0,tablesCount:0,rangesCount:0,recalcFailuresCount:0,scopes:0,allAvailableScopes:0};function E(e,t){return{namesCount:e.namesCount+t.namesCount,tablesCount:e.tablesCount+t.tablesCount,rangesCount:e.rangesCount+t.rangesCount,recalcFailuresCount:e.recalcFailuresCount+t.recalcFailuresCount,scopes:e.scopes+t.scopes,allAvailableScopes:e.allAvailableScopes+t.allAvailableScopes}}function A(e,t){return Object(f.X)(e.specialRefRanges[d.i.Data],t.specialRefRanges[d.i.Data])&&e.hasHeadersRow===t.hasHeadersRow&&e.hasTotalsRow===t.hasTotalsRow}var N=function(){function e(e,t,r,n){this.names=e,this.allAvailable=t,this.tables=r,this.ranges=n}return e.create=function(t){return new e(s.a.create(t),!1,S,C)},e.prototype.update=function(t,r,n,a){return t!==this.names||r!==this.allAvailable||n!==this.tables||a!==this.ranges?new e(t,r,n,a):this},e.prototype.getEntry=function(e,t,r){var n=this.names.getEntry(t);return void 0===n?this.allAvailable?Object(l.f)(void 0):Object(l.c)(Object(f.kb)([{kind:i.d.NameLoc,name:Object(o.l)(e,t),source:r}])):Object(l.f)(!1!==n.value?n:void 0)},e.prototype.getEntryIfDefined=function(e){var t=this.names.getEntry(e);if(void 0!==t)return!1!==t.value?t:void 0},e.prototype.setValue=function(e,t){return this.update(this.names.setValue(e,t),this.allAvailable,this.tables,this.ranges)},e.prototype.remove=function(e){return this.update(this.allAvailable?this.names.remove(e):this.names.setValue(e,!1),this.allAvailable,this.tables,this.ranges)},e.prototype.getContainingTable=function(e){var t;return this.tables.forEachGe(e,(function(e,r){return t=r,!1})),t},e.prototype.getIntersectingTables=function(e){var t=[];return this.tables.forEachMeets(e,(function(e,r){return t.push(r),!0})),t},e.prototype.getNamedRanges=function(e){var t;return null!==(t=this.ranges.getValue(e))&&void 0!==t?t:[]},e.prototype.getAvailableNames=function(e){var t=[];return this.names.forEach((function(r,n){return!1!==n&&t.push(Object(o.l)(e,r)),!0})),t},e.prototype.forEachAvailableName=function(e){return this.names.forEach((function(t,r){return e(t,!1===r?void 0:r)}))},e.prototype.setUndefined=function(){return this.update(this.names,!0,this.tables,this.ranges)},e.prototype.getStatistics=function(e){return{namesCount:this.names.getCount(),tablesCount:this.tables.getCount(),rangesCount:this.ranges.getCount(),recalcFailuresCount:e,scopes:1,allAvailableScopes:this.allAvailable?1:0}},e.prototype.collectGarbage=function(){return this.update(this.allAvailable?this.names.filter((function(e,t){return!1!==t})):this.names,this.allAvailable,this.tables,this.ranges)},e.prototype.resetLazyData=function(){this.names.forEach((function(e,t){return!1!==t&&t.lazyData.reset(),!0}))},e.prototype.onWriteNamedTable=function(e,t,r){var n=t.specialRefRanges[d.i.All].range;return this.update(this.names,this.allAvailable,"remove"===r?this.tables.remove(n):this.tables.setValue(n,e),this.ranges)},e.prototype.onWriteNamedRange=function(e,t,r){var a,i=t.value.ranges[0],o=null!==(a=this.ranges.getValue(i))&&void 0!==a?a:[],c="remove"===r?o.filter((function(t){return Object(f.K)(e.scope,t.scope)&&e.name===t.name})):Object(n.__spreadArray)(Object(n.__spreadArray)([],o,!0),[e],!1);return this.update(this.names,this.allAvailable,this.tables,0===c.length?this.ranges.remove(i):this.ranges.setValue(i,c))},e}(),T=function(){function e(e,t){this.stringCompareCI=e,this.scope=t,this.isCurrent=!1,this.isChanged=!1,this.oldContents=this.contents=this.emptyContents=N.create(e),this.emptyRecalcFailures=this.recalcFailures=a.a.create(e)}return e.prototype.clone=function(){var t=new e(this.stringCompareCI,this.scope);return t.contents=this.contents,t},e.prototype.advanceState=function(e){this.oldContents=this.contents,this.oldStateId=this.isCurrent?e:void 0,this.contents=this.emptyContents,this.isCurrent=this.isChanged=!1,this.recalcFailures=this.emptyRecalcFailures},e.prototype.getStatistics=function(){return this.contents.getStatistics(this.recalcFailures.getCount())},e.prototype.collectGarbage=function(e){void 0===this.oldStateId||this.oldStateId<e?(this.oldContents=this.emptyContents,this.oldStateId=void 0):this.oldContents=this.oldContents.collectGarbage(),this.contents=this.contents.collectGarbage()},e.prototype.getNameLoc=function(e,t){var r=this.contents.getEntry(this.scope,e,t);return Object(l.d)(r)?Object(l.f)(void 0!==r.value?Object(o.l)(this.scope,r.value.key):void 0):r},e.prototype.getNameFormula=function(e,t){var r=this.contents.getEntry(this.scope,e,t);return Object(l.d)(r)?Object(l.f)(void 0!==r.value?r.value.value:void 0):r},e.prototype.getContainingTable=function(e){return this.contents.getContainingTable(e)},e.prototype.getIntersectingTables=function(e){return this.contents.getIntersectingTables(e)},e.prototype.getNamedRanges=function(e){return this.contents.getNamedRanges(e)},e.prototype.allAvailable=function(){return this.contents.allAvailable},e.prototype.getAvailableNames=function(e){return this.contents.getAvailableNames(e)},e.prototype.hasRecalcFailure=function(e){return this.recalcFailures.contains(e)},e.prototype.setRecalcFailure=function(e){this.recalcFailures=this.recalcFailures.setValue(e,!0)},e.prototype.onCellModified=function(e){this.recalcFailures=this.emptyRecalcFailures},e.prototype.resetLazyData=function(){this.contents.resetLazyData(),this.oldContents!==this.contents&&this.oldContents.resetLazyData()},e.prototype.setNamedObject=function(e,t,r,n,a){var i,c=this.contents.getEntryIfDefined(t.name);if(void 0!==c&&(i=a(Object(o.l)(this.scope,c.key),c.value.obj,"remove")).kind===l.b.Failure)return i;if((this.contents=void 0===r?this.contents.remove(t.name):this.contents.setValue(t.name,{obj:r,lazyData:new u.a((function(){return n(e,t,r)}))}),this.isCurrent=this.isChanged=!0,void 0!==r)&&(i=a(t,r,"add")).kind===l.b.Failure)return i;return l.g},e.prototype.setUndefinedNames=function(){this.contents=this.contents.setUndefined(),this.isCurrent=this.isChanged=!0},e.prototype.promoteNamedObjects=function(e,t){var r=this;if(this.isChanged||e!==this.oldStateId)return Object(l.f)(!1);this.contents=this.oldContents,this.isCurrent=!0;var n=Object(l.f)(!0);return this.contents.forEachAvailableName((function(e,a){if(void 0===a)return!0;var i=t(Object(o.l)(r.scope,e),a.obj,"add");return i.kind===l.b.Success||(n=i,!1)})),n},e.prototype.onWriteNamedTable=function(e,t,r){this.contents=this.contents.onWriteNamedTable(e,t,r)},e.prototype.onWriteNamedRange=function(e,t,r){this.contents=this.contents.onWriteNamedRange(e,t,r)},e.prototype.forEachAvailableName=function(e){return this.contents.forEachAvailableName(e)},e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return p})),r.d(t,"b",(function(){return m})),r.d(t,"c",(function(){return g}));var n,a,i=r(3),o=r(5),c=r(23),u=r(33),s=r(11),l=r(0),d=u.j,f=u.g,b=u.h,h=((n={})[s.e.ArabicIndic]={zero:1632,one:1633},n[s.e.ExtendedArabicIndic]={zero:1776,one:1777},n[s.e.Devanagari]={zero:2406,one:2407},n[s.e.Bengali]={zero:2534,one:2535},n[s.e.Gurmukhi]={zero:2662,one:2663},n[s.e.Gujarati]={zero:2790,one:2791},n[s.e.Oriya]={zero:2918,one:2919},n[s.e.Tamil]={zero:48,one:3047},n[s.e.Telugu]={zero:3174,one:3175},n[s.e.Kannada]={zero:3302,one:3303},n[s.e.Malayalam]={zero:3430,one:3431},n[s.e.Thai]={zero:3664,one:3665},n[s.e.Lao]={zero:3792,one:3793},n[s.e.Tibetan]={zero:3872,one:3873},n[s.e.Myanmar]={zero:4160,one:4161},n[s.e.Ethiopic]={zero:48,one:4969},n[s.e.Khmer]={zero:6112,one:6113},n[s.e.Mongolian]={zero:6160,one:6161},n),v=((a={})[s.e.Japanese1]={digits:[12295,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806},a[s.e.Japanese2]={digits:[12295,22769,24336,21442,22235,20237,20845,19971,20843,20061],ten:25342,hundred:30334,thousand:38433,tenThousand:33836,hundredMillion:20740,trillion:20806},a[s.e.Japanese3]={digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806},a[s.e.Korean1]={digits:[65296,19968,20108,19977,22235,20116,63953,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806},a[s.e.Korean2]={digits:[63922,22777,36019,63851,22235,20237,63953,19971,20843,20061],ten:63859,hundred:30334,thousand:38433,tenThousand:33836,hundredMillion:20740,trillion:20806},a[s.e.Korean3]={digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20740,trillion:20806},a[s.e.Korean4]={digits:[50689,51068,51060,49340,49324,50724,50977,52832,54036,44396],ten:49901,hundred:48177,thousand:52380,tenThousand:47564,hundredMillion:50613,trillion:51312},a[s.e.ChineseSimp1]={digits:[9675,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20159,trillion:20806},a[s.e.ChineseSimp2]={digits:[38646,22777,36144,21441,32902,20237,38470,26578,25420,29590],ten:25342,hundred:20336,thousand:20191,tenThousand:19975,hundredMillion:20159,trillion:20806},a[s.e.ChineseSimp3]={digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:19975,hundredMillion:20159,trillion:20806},a[s.e.ChineseTrad1]={digits:[9675,19968,20108,19977,22235,20116,20845,19971,20843,20061],ten:21313,hundred:30334,thousand:21315,tenThousand:33836,hundredMillion:20740,trillion:20806},a[s.e.ChineseTrad2]={digits:[38646,22777,36019,21443,32902,20237,38520,26578,25420,29590],ten:25342,hundred:20336,thousand:20191,tenThousand:33836,hundredMillion:20740,trillion:20806},a[s.e.ChineseTrad3]={digits:[65296,65297,65298,65299,65300,65301,65302,65303,65304,65305],ten:21313,hundred:30334,thousand:21315,tenThousand:33836,hundredMillion:20740,trillion:20806},a);function p(e,t){if(t===s.e.ASCII)return e;switch(t){case s.e.ArabicIndic:case s.e.ExtendedArabicIndic:case s.e.Devanagari:case s.e.Bengali:case s.e.Gurmukhi:case s.e.Gujarati:case s.e.Oriya:case s.e.Tamil:case s.e.Telugu:case s.e.Kannada:case s.e.Malayalam:case s.e.Thai:case s.e.Lao:case s.e.Tibetan:case s.e.Myanmar:case s.e.Ethiopic:case s.e.Khmer:case s.e.Mongolian:for(var r="",n=h[t],a=0;a<e.length;a+=1){var i=e.charCodeAt(a);Object(o.h)("calc.numfmt.convertDigitsShape",d<=i&&i<=f),r+=i===d?Object(c.j)(n.zero):Object(c.j)(n.one+(i-b))}return r;case s.e.Unknown:return e;case s.e.ChineseTrad1:case s.e.ChineseTrad2:case s.e.ChineseTrad3:case s.e.ChineseSimp1:case s.e.ChineseSimp2:case s.e.ChineseSimp3:case s.e.Japanese1:case s.e.Japanese2:case s.e.Japanese3:case s.e.Korean1:case s.e.Korean2:case s.e.Korean3:case s.e.Korean4:for(r="",n=v[t],a=0;a<e.length;a+=1){i=e.charCodeAt(a);Object(o.h)("calc.numfmt.convertDigitsShape",d<=i&&i<=f),r+=Object(c.j)(n.digits[i-d])}return r}}function m(e,t,r){var n=e.decimalSeparator;if(r===s.e.ASCII)return Object(l.f)(t);switch(r){case s.e.ArabicIndic:case s.e.ExtendedArabicIndic:case s.e.Devanagari:case s.e.Bengali:case s.e.Gurmukhi:case s.e.Gujarati:case s.e.Oriya:case s.e.Tamil:case s.e.Telugu:case s.e.Kannada:case s.e.Malayalam:case s.e.Thai:case s.e.Lao:case s.e.Tibetan:case s.e.Myanmar:case s.e.Ethiopic:case s.e.Khmer:case s.e.Mongolian:var a=t.indexOf(n),c=p(t.substring(0,a<0?void 0:a),r),u=a<0?"":n,d=a<0?"":p(t.substring(a+n.length),r);return Object(l.f)(c+u+d);case s.e.Unknown:return Object(l.f)(t);case s.e.ChineseTrad1:case s.e.ChineseTrad2:case s.e.ChineseTrad3:case s.e.ChineseSimp1:case s.e.ChineseSimp2:case s.e.ChineseSimp3:case s.e.Japanese1:case s.e.Japanese2:case s.e.Japanese3:case s.e.Korean1:case s.e.Korean2:case s.e.Korean3:case s.e.Korean4:return Object(l.c)(Object(i.hb)(["convertNumberShape: ideographic shape ".concat(String(r))]));default:return Object(o.e)("calc.numfmt.convertNumberShape",r)}}function g(e,t,r){if(""===t)return"";for(var n=Object(c.c)(t,0,t.length),a="",i=0,o=0;i<t.length;){var u=Object(c.i)(t,i),s=Object(c.f)(u);a+=t.substring(i,i+s),i+=s,o+=1,e.isThousandsPosition(r+(n-o))&&(a+=e.thousandsSeparator)}return a}},function(e,t,r){"use strict";r.d(t,"a",(function(){return a})),r.d(t,"e",(function(){return O})),r.d(t,"b",(function(){return j})),r.d(t,"c",(function(){return y})),r.d(t,"h",(function(){return S})),r.d(t,"f",(function(){return C})),r.d(t,"d",(function(){return J})),r.d(t,"g",(function(){return Ce}));var n,a,i=r(9),o=r(25),c=r(35),u=r(5),s=r(2),l=r(1),d=r(7),f=r(15),b=r(13),h=r(27),v=r(3),p=r(17),m=r(0),g=r(30);function O(e,t,r,n){return{kind:a.LambdaArgsTerm,nodes:e,isClosed:t,start:r,end:n}}function j(e,t,r,n){return{kind:a.ArgsTerm,nodes:e,isClosed:t,start:r,end:n}}function y(e,t,r,n){return{kind:a.FieldRefTerm,hasDotPreSpace:e,rhs:t,start:r,end:n}}function S(e,t,r){return{kind:a.StructRefTerm,rhs:e,start:t,end:r}}function C(e,t){return{kind:a.MaybeWSFTerm,node:e,whole:t}}function k(e){return e.kind!==f.c.Operator&&e.kind!==f.c.Sep&&e.kind!==f.c.End&&e.kind!==f.c.Spaces&&!(e.kind in a)}function E(e,t){return k(t=t.kind===a.MaybeWSFTerm?t.node:t)?Object(h.d)(e,t).start:t.start}!function(e){e.LambdaArgsTerm="LambdaArgsTerm",e.ArgsTerm="ArgsTerm",e.FieldRefTerm="FieldRefTerm",e.StructRefTerm="StructRefTerm",e.MaybeWSFTerm="MaybeWSFTerm"}(a||(a={}));var A=Object(b.m)(Object(b.s)((function(e,t){return t.kind===f.c.Spaces?t.chars:void 0})),""),N=function(e,t,r,n,a){var i=e[t];if(null==i){var s="calc.parse.pStart: internal error: expected term at ".concat(t," in ").concat(Object(c.a)(e));return u.i.ULS.assertTag(589825160,o.LogCategory.msoulscat_ES_EWAJS,!1,s)}return n(E(r,i),t)};function T(e){return Object(b.b)(Object(b.u)(A,N,Object(b.s)(e),N,A),(function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=t[4];return Object(s.Y)(a,Object(h.b)(e,n,i,r,o))}))}function R(e){return Object(b.b)(Object(b.u)(A,N,Object(b.s)(e),N),(function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3];return Object(s.Y)(a,Object(h.b)(e,n,i,r,""))}))}function I(e){return Object(b.b)(Object(b.u)(N,Object(b.s)(e),N,A),(function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3];return Object(s.Y)(n,Object(h.b)(e,r,a,"",i))}))}var _=T((function(e,t){return t.kind!==f.c.Operator||t.value!==l.a.Add&&t.value!==l.a.Sub?void 0:t.value})),F=I((function(e,t){if(t.kind===f.c.Operator){if(t.value===l.a.Add)return l.a.Pos;if(t.value===l.a.Sub)return l.a.Neg}})),w=I((function(e,t){return t.kind===f.c.Operator&&t.value===l.a.At?t.value:void 0})),M=R((function(e,t){return t.kind===f.c.Operator&&t.value===l.a.Pound?t.value:void 0})),D=Object(b.s)((function(e,t){return t.kind===a.StructRefTerm?t:void 0})),P=T((function(e,t){return t.kind!==f.c.Operator||t.value!==l.a.Mul&&t.value!==l.a.Div?void 0:t.value})),x=T((function(e,t){return t.kind===f.c.Operator&&t.value===l.a.Pow?t.value:void 0})),L=R((function(e,t){return t.kind===f.c.Operator&&t.value===l.a.Percent?t.value:void 0})),B=T((function(e,t){return t.kind===f.c.Operator&&t.value===l.a.Concat?t.value:void 0})),U=T((function(e,t){return t.kind===f.c.Operator&&t.value>=l.a.Eq&&t.value<=l.a.Ge?t.value:void 0})),G=T((function(e,t){return t.kind===f.c.Operator&&t.value===l.a.Range?t.value:void 0})),V=T((function(e,t){return t.kind===f.c.Operator&&t.value===l.a.Union?t.value:void 0})),H=Object(b.t)((function(e,t,r){if(t.kind===f.c.Spaces&&r.kind!==f.c.End&&(r.kind!==f.c.Operator||r.value===l.a.At)&&!Object(p.b)(r)){var n=Object(h.b)(e,t.start,E(e,r),t.chars,"");return Object(s.Y)(l.a.Isect,n)}})),W=Object(b.s)((function(e,t){return Object(p.b)(t)?t:void 0})),z=Object(b.s)((function(e,t){return t.kind===a.ArgsTerm?t:void 0})),q=Object(b.s)((function(e,t){return t.kind===a.LambdaArgsTerm?t:void 0})),K=Object(b.s)((function(e,t){return t.kind===a.ArgsTerm||t.kind===a.FieldRefTerm?t:void 0})),Y=((n={})[l.b.LETREC]=g.a.CalcLetRecFunction,n[l.b.LAMBDA]=g.a.CalcLambdaFunction,n);function J(e,t){if(t.kind===a.MaybeWSFTerm&&void 0!==t.whole){var r=Object(v.k)(e,t.whole);if(void 0===r)return;Object(u.h)("calc.parse.parseWSFName: unexpected UDF",r!==l.b._UDF);var n=Y[r];if(void 0!==n&&!Object(g.e)(n))return;return Object(s.mb)(r,t.whole,t.node.label)}}var Q=Object(b.s)((function(e,t){return J(e.localeInfo,t)})),X=Object(b.s)((function(e,t){var r=J(e.localeInfo,t);return(null==r?void 0:r.id)===l.b.LAMBDA?r:void 0}));var Z=Object(b.b)(Object(b.u)(X,q),(function(e,t){for(var r,n=t[0],a=t[1],i=Object(h.d)(e,n).start,o=a.nodes,c=(n.id,[]),u=[],l=0;l<o.length;l+=1){var d=o[l];d.kind===s.e.Param?c.push(Object(s.Q)(Object(s.O)(d,l))):l===o.length-1?r=Object(s.O)(d,l):u.push(Object(s.O)(d,l))}var f=Object(h.b)(e,i,a.end,"","");return Object(s.P)(n,c,r,u,a.isClosed,f)})),$=Object(b.b)(Object(b.u)(Q,z),(function(e,t){var r,n,a=t[0],i=t[1],o=Object(h.d)(e,a).start,c=i.nodes;switch(a.id){case l.b.LET:case l.b.LETREC:a.id;for(var d=[],f=[],b=void 0,p=0;p<c.length;p+=1){var m=c[p];p!==c.length-1?!(p+1<c.length&&Object(v.bb)(m))||p+3<c.length&&(r=e.refStyle,n=c[p+2],!(Object(v.bb)(n)||r===s.h.A1&&n.kind===s.e.CellRef&&void 0===n.qualifier&&n.ref.kind===s.c.Single&&n.ref.col.kind===s.f.Rel&&n.ref.row.kind===s.f.Rel))&&Object(v.bb)(c[p+1])?f.push(Object(s.O)(m,p)):(d.push(Object(s.S)(Object(s.O)(m,p),Object(s.O)(c[p+1],p+1))),p+=1):b=Object(s.O)(m,p)}var g=Object(h.b)(e,o,i.end,"","");return Object(s.R)(a,d,b,f,i.isClosed,g);case l.b.LAMBDA:return Object(u.a)("calc.parse.parseWSFApp: unexpected LAMBDA+ArgTerm")}return ne(e,a,c,i.isClosed,o,i.end)}));function ee(e,t,r){return Object(b.b)(Object(b.u)(Object(b.k)(e),t),(function(e,t){var n=t[0],a=t[1];return n.reduceRight(r(e),a)}))}function te(e,t,r){return Object(b.b)(Object(b.u)(e,Object(b.k)(t)),(function(e,t){var n=t[0];return t[1].reduce(r(e),n)}))}function re(e){return function(t,r){var n=r[0],a=r[1],i=Object(h.d)(e,t).start,o=Object(h.d)(e,a).end,c=Object(h.b)(e,i,o,"","");return Object(s.l)(n,[t,a],!0,c)}}function ne(e,t,r,n,a,i){var o=Object(h.b)(e,a,i,"","");return Object(s.l)(t,r,n,o)}function ae(e){return function(t,r){var n=Object(h.d)(e,t).start;switch(r.kind){case a.ArgsTerm:return ne(e,t,r.nodes,r.isClosed,n,r.end);case a.FieldRefTerm:var i=Object(h.b)(e,n,r.end,"",""),o=Object(h.d)(e,r.rhs),c=o.start,u=o.end,l=o.pre,f=o.post;if(Object(v.L)(t)){var b=Object(h.b)(e,c,c,"",""),p=Object(s.T)(d.l,!0,b),m=Object(h.b)(e,c,u,l,f),g=Object(h.b)(e,c,u,"",""),O=Object(s.C)(r.rhs.field,r.rhs.isBracketed,r.rhs.isClosed,g);return Object(s.n)(s.b.FieldRef,[t,Object(s.E)(p,O,!1,m)],i)}var j=!r.rhs.isBracketed&&Object(v.jb)(t,r.rhs,l);return Object(s.E)(t,r.rhs,j,i);case a.StructRefTerm:i=Object(h.b)(e,n,r.end,"","");return t.kind===s.e.Name||Object(v.I)(t)?Object(s.kb)(t.kind===s.e.Name?t:void 0,r.rhs,i):Object(s.n)(s.b.StructRef,[t,Object(s.kb)(void 0,r.rhs,Object(h.b)(e,r.start,r.end,"",""))],i);case s.e.Operator:return ne(e,r,[t],!0,n,Object(h.d)(e,r).end)}}}function ie(e){var t=!0;return function(r,n){var a=Object(h.d)(e,n).start,i=Object(h.d)(e,r).end,o=Object(h.b)(e,a,i,"","");if((n.id===l.a.Pos||n.id===l.a.Neg)&&t&&(t=!1,Object(v.L)(r)&&""===Object(h.d)(e,n).post)){var c=n.id===l.a.Pos?r.oper:e.mathpack.neg(r.oper);return Object(s.T)(c,!0,o)}return Object(s.l)(n,[r],!0,o)}}var oe=Object(b.s)((function(e,t){return t.kind===a.MaybeWSFTerm?t.node:k(t)?t:void 0})),ce=Object(b.b)(Object(b.u)(A,W,N,A),(function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3];return Object(s.n)(s.b.Unexpected,n.chars,Object(h.b)(e,n.start,a,r,i))})),ue=Object(b.b)(Object(b.u)(N,A,W,N),(function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=Object(h.b)(e,i,i,"",""),c=Object(h.b)(e,a.start,i,n,""),u=Object(s.C)(Object(s.n)(s.b.Missing,"",o),!1,!0,c);return y(n.length>0,u,r,i)})),se=Object(b.i)((function(){return Object(b.b)(Object(b.u)(N,Object(b.k)(Object(b.a)(Z,$,oe,ce),Object(b.a)(Z,$,oe,Object(b.o)(Object(b.r)(w),he))),N),(function(e,t){var r=t[0],n=t[1],a=t[2];if(1===n.length)return n[0];var i=Object(h.b)(e,r,a,"","");return 0===n.length?Object(s.T)(d.l,!0,i):Object(s.n)(s.b.Sequence,n,i)}))})),le=te(Object(b.i)((function(){return Object(b.a)(Object(b.o)(Object(b.r)(w),he),Object(b.o)(Object(b.r)(F),pe),se)})),Object(b.a)(M,D),ae),de=te(le,Object(b.u)(G,le),re),fe=te(de,Object(b.u)(H,de),re),be=te(fe,Object(b.a)(K,ue),ae),he=ee(w,be,ie),ve=te(he,Object(b.u)(V,he),re),pe=ee(F,ve,ie),me=te(pe,L,ae),ge=te(me,Object(b.u)(x,me),re),Oe=te(ge,Object(b.u)(P,ge),re),je=te(Oe,Object(b.u)(_,Oe),re),ye=te(je,Object(b.u)(B,je),re),Se=te(ye,Object(b.u)(U,ye),re);function Ce(e,t){var r=t.length-1;if(1===r&&k(t[0]))return t[0];if(r<1){var n="calc.parse.runTermParser: internal error: expected at least 1 term";return u.i.ULS.assertTag(589825161,o.LogCategory.msoulscat_ES_EWAJS,!1,n)}if(t[0].kind===f.c.Spaces){n="calc.parse.runTermParser: internal error: array[0].kind === Spaces in ".concat(Object(c.a)(t));return u.i.ULS.assertTag(589825162,o.LogCategory.msoulscat_ES_EWAJS,!1,n)}if(r-1>=0&&t[r-1].kind===f.c.Spaces){n="calc.parse.runTermParser: internal error: array[n-1].kind === Spaces in ".concat(Object(c.a)(t));return u.i.ULS.assertTag(589825163,o.LogCategory.msoulscat_ES_EWAJS,!1,n)}if(t[r].kind!==f.c.End){n="calc.parse.runTermParser: internal error: array[n].kind !== End in ".concat(Object(c.a)(t));return u.i.ULS.assertTag(589825164,o.LogCategory.msoulscat_ES_EWAJS,!1,n)}for(;;){var a=Object(b.p)(Se,t,0,e);if(Object(m.d)(a)&&a.value.index>=r)return a.value.output;if(!Object(m.d)(a)||0===a.value.index||1===a.value.index&&k(t[0])){var s=Object(m.d)(a)?a.value.index:0;n="calc.parse.runTermParser: internal error: consumed ".concat(s," out of ").concat(r," in ").concat(Object(c.a)(t));return u.i.ULS.assertTag(589825165,o.LogCategory.msoulscat_ES_EWAJS,!1,n)}r=(t=Object(i.__spreadArray)([a.value.output],t.slice(a.value.index),!0)).length-1}}},function(e,t,r){"use strict";r.d(t,"e",(function(){return o})),r.d(t,"c",(function(){return c})),r.d(t,"a",(function(){return u})),r.d(t,"b",(function(){return s}));var n=r(12),a=r(37);r.d(t,"d",(function(){return a}));var i=r(0);function o(e){if(void 0!==e){var t={};return Object.keys(e).forEach((function(r){e[Number(r)].forEach((function(e){var r,n=a.formatDiagnostic(e);t[n]=(null!==(r=t[n])&&void 0!==r?r:0)+1}))})),t}}function c(e,t){return{config:e,getSheetName:t}}function u(e,t,r,n){return void 0===n&&(n=!1),{config:null!=r?r:void 0,lexicalKind:e,originGridCell:Object(i.f)(t.range),originSheet:Object(i.f)(t.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!0,wrapCellReferences:!1,workbookLoad:n}}function s(e,t,r){return void 0===r&&(r=!1),{config:null!=t?t:void 0,lexicalKind:n.a.NameManager,originGridCell:Object(i.f)(e.range),originSheet:Object(i.f)(e.sheet),allowRelativeQualifier:!0,allowUnqualifiedCell:!1,allowImplicitTable:!1,wrapCellReferences:!0,workbookLoad:r}}},function(e,t,r){"use strict";r.d(t,"d",(function(){return a})),r.d(t,"c",(function(){return i})),r.d(t,"e",(function(){return o})),r.d(t,"b",(function(){return c})),r.d(t,"a",(function(){return u}));var n=r(10);function a(e,t){return e.then((function(e){return t(),e}),(function(e){return t(),Promise.reject(e)}))}function i(){var e;return[new Promise((function(t,r){return e=[t,r]})),e]}function o(e,t){var r;return new Promise((function(n,a){Promise.resolve(t).then((function t(i){if(void 0!==i){r=i;try{Promise.resolve(e(r)).then(t,a)}catch(e){a(e)}}else n(r)}),a)}))}function c(e){return Object(n.e)(e)&&"function"==typeof e.then}function u(e,t,r){return c(e)?e.then(t,r):t(e)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return c})),r.d(t,"c",(function(){return u}));var n=r(12),a=r(0),i=function(){function e(e){this.config=e}return e.prototype.getDocumentLoc=function(e,t){return Object(a.f)(Object(n.d)(e,t))},e.prototype.getSheetIndex=function(e,t){return Object(a.f)(t)},e.prototype.getSheetName=function(e,t){return Object(a.f)(t)},e.prototype.getNameLoc=function(e,t){return Object(a.f)(t.indexOf(".")>=0?void 0:Object(n.l)(e,t))},e.prototype.getUserDefinedFuncLoc=function(e,t){return Object(a.f)([Object(n.y)(e,t)])},e.prototype.getSheetRangeIndexes=function(e){return Object(a.f)(Object(n.u)([e.index],0))},e.prototype.getContainingTable=function(e){return a.g},e.prototype.getStructRefColumn=function(e,t){return a.g},e.prototype.getStructRefSpecialRef=function(e,t){return a.g},e.prototype.getNamedRanges=function(e){return Object(a.f)([])},e}();function o(e){return new i(e)}function c(e,t,r){return{config:null!=r?r:void 0,lexicalSource:e,originGridCell:Object(a.f)(t.range),originSheet:Object(a.f)(t.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1}}function u(e,t,r){return{config:null!=r?r:void 0,lexicalSource:e,originGridCell:Object(a.f)(t.range),originSheet:Object(a.f)(t.sheet),allowUnqualifiedCell:!1,wrapCellReferences:!0}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"d",(function(){return u})),r.d(t,"c",(function(){return s})),r.d(t,"b",(function(){return l})),r.d(t,"e",(function(){return d}));var n,a=r(9),i=r(12),o=r(7),c=r(10);!function(e){e.Value="Value",e.CellFormula="CellFormula"}(n||(n={}));var u=o.d,s={kind:n.Value,formulaBarText:"",origin:Object(i.f)(0,0)};Object(c.r)();var l=0;function d(e,t){return{discardSnapshot:e.discardSnapshot.bind(e),getRangeFormats:function(r){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var o=e.getRangeFormats.apply(e,Object(a.__spreadArray)([r],n,!1));return t(r),o},getRangeValues:function(r){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var o=e.getRangeValues.apply(e,Object(a.__spreadArray)([r],n,!1));return t(r),o},getRangeFormulae:function(r){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var o=e.getRangeFormulae.apply(e,Object(a.__spreadArray)([r],n,!1));return t(r),o},getSheetNames:function(r){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var o=e.getSheetNames.apply(e,Object(a.__spreadArray)([r],n,!1));return t(r),o},getIntersectingTables:function(r){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var o=e.getIntersectingTables.apply(e,Object(a.__spreadArray)([r],n,!1));return t(r),o},getIformats:function(r){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var o=e.getIformats.apply(e,Object(a.__spreadArray)([r],n,!1));return t(r),o},getHiddenRows:function(r){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var o=e.getHiddenRows.apply(e,Object(a.__spreadArray)([r],n,!1));return t(r),o},getHiddenCols:function(r){for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];var o=e.getHiddenCols.apply(e,Object(a.__spreadArray)([r],n,!1));return t(r),o}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(9);n.__exportStar(r(126),t),n.__exportStar(r(167),t),n.__exportStar(r(127),t),n.__exportStar(r(168),t),n.__exportStar(r(169),t),n.__exportStar(r(170),t)},function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));var n=r(9),a=r(10),i=r(5),o=r(46),c=r(2),u=r(3),s=r(12),l=r(0),d=r(19),f=r(30);function b(e){return Object(l.d)(e)&&Object(a.f)(e.value)?l.g:e}function h(e){return!Object(l.d)(e)||void 0===e.value}function v(e,t,r){var n=Object(o.l)(e.row,t.row,s.v,r),a=Object(o.l)(e.col,t.col,s.o,r);return void 0!==n&&void 0!==a?Object(s.f)(n,a):void 0}function p(e,t){if(t.kind===c.c.Error)return l.g;var r=e.originGridCell;if(!Object(l.d)(r))return r;var n=r.value,a=e.wrapCellReferences;switch(t.kind){case c.c.Single:return Object(l.f)(v(n,t,a));case c.c.Range:var f=v(n,t.ref1,a),b=v(n,t.ref2,a);return void 0!==f&&void 0!==b?Object(l.f)(Object(u.m)(f,b)):l.g;case c.c.Row:var h=Object(o.l)(n.row,t.row1,s.v,a),p=Object(o.l)(n.row,t.row2,s.v,a);return void 0!==h&&void 0!==p?Object(l.f)(Object(u.m)(Object(s.f)(h,0),Object(s.f)(p,s.o-1))):l.g;case c.c.Col:var m=Object(o.l)(n.col,t.col1,s.o,a),g=Object(o.l)(n.col,t.col2,s.o,a);return void 0!==m&&void 0!==g?Object(l.f)(Object(u.m)(Object(s.f)(0,m),Object(s.f)(s.v-1,g))):l.g;case c.c.Bad:return Object(l.c)(Object(d.g)(d.a.BadCellRef));default:return Object(i.e)("calc.runtime.resolverService.resolveGridRef",t)}}function m(e){function t(t,r){if(void 0===r){var n=t.originSheet;return Object(l.d)(n)?[r,Object(l.f)(n.value.document)]:[r,n]}var i=e.getDocumentLoc(r.path,r.document);if(!Object(l.d)(i))return[r,i];if(Object(a.f)(i.value)&&Object(f.e)(f.a["OfficeVSO:3594447_InvalidQualifier"]))return[r,Object(l.c)(Object(d.h)(d.b.UndefinedDocument))];var o=null==r.path?void 0:Object(a.f)(i.value)?r.path:i.value.path,u=Object(a.f)(i.value)?r.document:i.value.name;return[Object(c.A)(u,o,r.isQuoted,r.label),Object(a.e)(i.value)?Object(l.f)(i.value):l.g]}function r(t,r){if(h(r))return[t,r];var n=b(e.getSheetIndex(r.value,t));if(!Object(l.d)(n))return[t,n];if(Object(a.f)(n.value))return Object(f.e)(f.a["OfficeVSO:3594447_InvalidQualifier"])?[t,Object(l.c)(Object(d.h)(d.b.UndefinedSheetName))]:[t,l.g];var i=e.getSheetName(r.value,n.value);return Object(l.d)(i)?[i.value,Object(l.f)(Object(s.s)(r.value,n.value))]:[t,i]}function o(e,n){var a=t(e,n.document),i=a[0],o=a[1],u=r(n.sheet,o),s=u[0],l=u[1];return[Object(c.gb)(s,i,n.isQuoted,n.label),l]}function v(n,a){switch(a.kind){case c.g.Error:return[a,l.g];case c.g.Sheet:return o(n,a);case c.g.SheetRange:return function(n,a){var i,o=t(n,a.document),d=o[0],f=o[1],b=r(a.sheet1,f),v=b[0],p=b[1],m=r(a.sheet2,f),g=m[0],O=m[1],j=v,y=g;if(h(f))i=f;else if(h(p))i=p;else if(h(O))i=O;else{if(Object(u.Z)(p.value,O.value))return[Object(c.gb)(j,d,a.isQuoted,a.label),Object(l.f)(Object(s.s)(f.value,p.value.index))];var S=e.getSheetRangeIndexes(p.value),C=e.getSheetRangeIndexes(O.value);Object(l.d)(S)?Object(l.d)(C)?C.value.position<S.value.position&&(j=g,y=v):i=C:i=S,i=Object(l.f)(Object(s.t)(f.value,p.value.index,O.value.index))}return[Object(c.hb)(j,y,d,a.isQuoted,a.label),i]}(n,a);case c.g.Document:return[a,Object(l.c)(Object(d.h)(d.b.SheetRangeName))];case c.g.Bad:return[a,Object(l.c)(Object(d.h)(d.b.BadQualifier))];default:return Object(i.e)("calc.runtime.resolverService.resolveCellRefQualifier",a)}}function m(e,t){var r,n,a,i,o=t.qualifier,u=t.ref,f=p(e,u);if(void 0===o||o.kind===c.g.Relative){n=o;var b=e.originSheet;if(Object(l.d)(b)){var m=b.value;a=void 0===m.index?Object(l.c)(Object(d.j)(m)):Object(l.f)(m)}else a=b}else n=(r=v(e,o))[0],a=r[1];return i=h(f)?f:h(a)?a:Object(l.f)(Object(s.q)(a.value,f.value)),Object(d.l)(Object(c.u)(u,n,t.label),i)}function g(r,n,a){var u,f,v,p=n.qualifier,m=n.parts;if(void 0===p||p.kind===c.g.Relative){var g=r.originSheet;if(!Object(l.d)(g))return Object(d.o)(n,g);var O=g.value;if(void 0===O.index)return Object(d.o)(n,Object(l.c)(Object(d.j)(O)));var j=b(e.getNameLoc(O,m.asWhole,a));if(!Object(l.d)(j))return Object(d.o)(n,j);if(j.value)return Object(d.o)(Object(c.X)(Object(c.M)(j.value.name,m.canDenoteNamedObject,m.label),p,n.label),j);f=p,v=Object(l.f)(Object(s.e)(O.document))}else f=(u=function(e,r){switch(r.kind){case c.g.Document:var n=t(e,r);return[v=n[0],h(p=n[1])?p:Object(l.f)(Object(s.e)(p.value))];case c.g.Sheet:return o(e,r);case c.g.SheetRange:return[r,Object(l.c)(Object(d.h)(d.b.SheetRangeName))];case c.g.Ident:var a=o(e,Object(c.gb)(r.name,void 0)),u=a[0],f=a[1];if(!Object(l.d)(f)&&f.reason.kind!==d.d.InvalidQualifier)return[r,f];if(Object(l.d)(f)&&void 0!==f.value)return[Object(c.N)(u.sheet,r.isQuoted,r.label),f];var b=t(e,Object(c.A)(r.name)),v=b[0],p=b[1];return[Object(c.N)(v.document,r.isQuoted,r.label),h(p)?p:Object(l.f)(Object(s.e)(p.value))];case c.g.Bad:return[r,Object(l.c)(Object(d.h)(d.b.BadQualifier))];default:return Object(i.e)("calc.runtime.resolverService.resolveNameQualifier",r)}}(r,p))[0],v=u[1];var y,S=m;return h(v)?y=v:h(y=b(e.getNameLoc(v.value,m.asWhole,a)))||(S=Object(c.M)(y.value.name,m.canDenoteNamedObject,m.label)),Object(d.o)(Object(c.X)(S,f,n.label),y)}function O(t,r,n){void 0===n&&(n=!1);var i=e.getStructRefColumn(t,r.name);if(!Object(l.d)(i))return{kind:c.j.ColumnRef,innerRef:r,resolution:i};var o=i.value;if(Object(a.f)(o))return{kind:c.j.ColumnRef,innerRef:r,resolution:Object(l.c)(Object(d.i)(d.c.UndefinedColumnName))};var u=o.range.range;return n&&(u=Object(s.g)(u.row-(o.hasHeadersRow?1:0),u.col,u.rows+(o.hasHeadersRow?1:0)+(o.hasTotalsRow?1:0),u.cols)),{kind:c.j.ColumnRef,innerRef:Object(c.y)(o.name,r.isBracketed,r.isClosed,r.label),resolution:Object(l.f)(Object(s.r)(o.range.sheet,u))}}function j(t,r,n){if(n===c.i.ThisRow){if(!Object(l.d)(t.originGridCell))return t.originGridCell;var a=j(t,r,c.i.Data);if(h(a))return a;var i=a.value.range,o=t.originGridCell.value.row;return o<i.row||o>=i.row+i.rows?Object(l.c)(d.f):Object(l.f)(Object(s.r)(a.value.sheet,Object(s.g)(o,i.col,1,i.cols)))}return b(e.getStructRefSpecialRef(r,n))}function y(e,t,r){switch(t.kind){case c.j.ColumnRef:return O(e,t,r);case c.j.MissingRef:return{kind:c.j.MissingRef,innerRef:t,resolution:l.g}}}function S(e,t,r){var n;void 0===r&&(r=!1);var a,i,o=y(e,t.lhs,r),f=o.innerRef,b=o.resolution,h=y(e,t.rhs,r),v=h.innerRef,p=h.resolution,m=Object(c.eb)(f,v,t.label);if(!Object(l.d)(b)&&b.reason.kind!==d.d.InvalidStructRef)return{kind:c.j.RangeOpRef,innerRef:m,resolution:b};if(!Object(l.d)(p)&&p.reason.kind!==d.d.InvalidStructRef)return{kind:c.j.RangeOpRef,innerRef:m,resolution:p};if(!Object(l.d)(b))return{kind:c.j.RangeOpRef,innerRef:m,resolution:b};if(!Object(l.d)(p))return{kind:c.j.RangeOpRef,innerRef:m,resolution:p};if(void 0!==b.value)a=b.value.sheet,i=Object(u.t)(b.value.range,null===(n=p.value)||void 0===n?void 0:n.range);else{if(void 0===p.value)return{kind:c.j.RangeOpRef,innerRef:m,resolution:Object(l.c)(Object(d.i)(d.c.InvalidOp))};a=p.value.sheet,i=p.value.range}return{kind:c.j.RangeOpRef,innerRef:m,resolution:Object(l.f)(Object(s.r)(a,i))}}function C(r,n){var a,o,s,f,b,v,p=n.qualifier,m=n.parts,g=null!==(s=null===(o=r.config)||void 0===o?void 0:o.localeInfo)&&void 0!==s?s:e.config.localeInfo;if(void 0===p){var O=r.originSheet;if(!Object(l.d)(O))return Object(d.r)(n,O,m.asWhole);f=p,b=Object(l.f)(O.value.document)}else f=(a=function(e,r){switch(r.kind){case c.g.Document:return t(e,r);case c.g.Ident:var n=t(e,Object(c.A)(r.name)),a=n[0],o=n[1];return[Object(c.N)(a.document,r.isQuoted,r.label),o];default:return Object(i.e)("calc.runtime.resolverService.resolveUserDefinedFuncQualifier",r)}}(r,p))[0],b=a[1];var j=m.asWhole;if(h(b))v=b;else{var y=Object(u.j)(e,g,b.value,m.asWhole),S=y[0],C=y[1];j=C,Object(l.d)(S)?0!==S.value.length?(v=S,j=C):(v=l.g,j=C):v=S}return Object(d.r)(Object(c.X)(Object(c.M)(m.asWhole,m.canDenoteNamedObject,m.label),f,n.label),v,j)}return{resolveGridRef:p,resolveCellRef:m,resolveName:g,resolveStructRef:function(t,r){var n,i=r.lhs,o=r.rhs,f=i;if(void 0!==i){var b=g(t,i,s.b.StructRef),v=b.node,p=b.resolution;if(!Object(l.d)(p))return Object(d.q)(r,void 0,p);if(Object(a.f)(p.value))return Object(d.q)(r,void 0,Object(l.c)(Object(d.i)(d.c.UndefinedTableName)));f=v,n=p.value}else{var m=t.originGridCell,y=t.originSheet;if(!Object(l.d)(m))return Object(d.q)(r,void 0,m);if(!Object(l.d)(y))return Object(d.q)(r,void 0,y);if(void 0===y.value.index)return Object(d.q)(r,void 0,Object(l.c)(Object(d.i)(d.c.InvalidOriginSheet)));p=e.getContainingTable(Object(s.p)(y.value,m.value));if(!Object(l.d)(p))return Object(d.q)(r,void 0,p);if(Object(a.f)(p.value))return Object(d.q)(r,void 0,Object(l.c)(Object(d.i)(d.c.MissingTableName)));n=p.value}var C=function(e,t,r){var n;switch(null===(n=r.innerRef)||void 0===n?void 0:n.kind){case c.j.ColumnRef:var a=O(t,r.innerRef),i=a.innerRef,o=a.resolution;return{structRef:Object(c.jb)(i,r.isClosed,r.label),resolution:o};case c.j.RangeOpRef:var f=S(t,r.innerRef);i=f.innerRef,o=f.resolution;return{structRef:Object(c.jb)(i,r.isClosed,r.label),resolution:o};case void 0:o=j(e,t,c.i.Data);return{structRef:r,resolution:o};case c.j.SpecialRef:o=j(e,t,r.innerRef.id);return{structRef:r,resolution:o};case c.j.CommaOpRef:var b=function(e,t,r){for(var n,a,i=r.refs.map((function(r){return function(e,t,r){switch(r.kind){case c.j.ColumnRef:return O(t,r,!0);case c.j.SpecialRef:return{kind:c.j.SpecialRef,innerRef:r,resolution:j(e,t,r.id)};case c.j.RangeOpRef:return S(t,r,!0);case c.j.MissingRef:return{kind:c.j.MissingRef,innerRef:r,resolution:l.g};case c.j.BadRef:return{kind:c.j.BadRef,innerRef:r,resolution:Object(l.c)(Object(d.i)(d.c.InvalidOp))}}}(e,t,r)})),o=Object(c.z)(i.map((function(e){return e.innerRef})),r.label),f=0,b=i;f<b.length;f++){var h=b[f].resolution;if(!Object(l.d)(h)&&h.reason.kind!==d.d.InvalidStructRef)return{commaOpRef:o,resolution:h}}for(var v,p,m=[],g=0,y=i;g<y.length;g++){var C=y[g];if(!Object(l.d)(C.resolution)||C.kind===c.j.BadRef)return{commaOpRef:o,resolution:C.resolution};m.push((C.kind===c.j.SpecialRef||(C.kind,c.j.MissingRef),{kind:C.kind,resolution:C.resolution}))}if(!Object(u.C)(r))return{commaOpRef:o,resolution:Object(l.c)(Object(d.i)(d.c.InvalidOp))};for(var k=0,E=m;k<E.length;k++){(C=E[k]).kind===c.j.SpecialRef&&(v=Object(u.t)(v,null===(n=C.resolution.value)||void 0===n?void 0:n.range),void 0===p&&(p=null===(a=C.resolution.value)||void 0===a?void 0:a.sheet))}if(void 0===v||void 0===p)return{commaOpRef:o,resolution:l.g};for(var A=0,N=m;A<N.length;A++){if((C=N[A]).kind!==c.j.SpecialRef&&(C.kind!==c.j.MissingRef&&void 0===(v=Object(u.q)(v,C.resolution.value.range))))return{commaOpRef:o,resolution:Object(l.c)(Object(d.i)(d.c.InvalidOp))}}return{commaOpRef:o,resolution:Object(l.f)(Object(s.r)(p,v))}}(e,t,r.innerRef);i=b.commaOpRef,o=b.resolution;return{structRef:Object(c.jb)(i,r.isClosed,r.label),resolution:o};case c.j.ThisRowOpRef:var v=j(e,t,c.i.ThisRow);if(h(v)||void 0===r.innerRef.ref)return{structRef:r,resolution:v};var p=r.innerRef.ref.kind===c.j.ColumnRef?O(t,r.innerRef.ref):S(t,r.innerRef.ref),m=(i=p.innerRef,p.resolution),g=Object(c.lb)(i,i.label);if(h(m))return{structRef:Object(c.jb)(g,r.isClosed,r.label),resolution:m};var y=Object(u.q)(v.value.range,m.value.range);return y?{structRef:Object(c.jb)(g,r.isClosed,r.label),resolution:Object(l.f)(Object(s.r)(v.value.sheet,y))}:{structRef:r,resolution:Object(l.c)(Object(d.i)(d.c.InvalidOp))};case c.j.BadRef:return{structRef:r,resolution:Object(l.c)(Object(d.i)(d.c.InvalidOp))}}}(t,n,o),k=C.structRef,E=C.resolution;return Object(d.q)(E.kind===l.b.Failure&&E.reason.kind!==d.d.EmptyIntersection?r:Object(c.kb)(f,k,r.label),n,E)},resolveUserDefinedFunc:C,resolveDottedName:function(e,t,r){var a,i=t.qualifier,o=t.parts,u=[],f=r[t.label],b=(null==f?void 0:f.kind)===c.a.AppHeadName;if(!i){var h=Object(c.L)(o);if(h.kind===c.d.IdentNamePart){var v=Object(c.H)(o).parts.slice(1),p=function(e,t){var r=t[e.label];return(null==r?void 0:r.kind)===c.a.LocalNameUse?Object(d.n)(Object(c.X)(Object(c.M)(r.whole,e.canDenoteNamedObject,e.label),void 0,-1),Object(l.f)(r)):Object(d.n)(Object(c.X)(Object(c.M)(e.asWhole,e.canDenoteNamedObject,e.label),void 0,-1),l.g)}(h,r);if(a=Object(d.m)(p,v.map((function(e){return e.rhs}))),!Object(l.d)(p.resolution)||p.resolution.value)return a}}for(;;){if(o.canDenoteNamedObject){var O=Object(c.X)(Object(c.M)(o.asWhole,o.canDenoteNamedObject,o.label),i,-1),j=g(e,O,b?s.b.AppHead:s.b.Plain);if(a=Object(d.m)(j,Object(n.__spreadArray)([],u,!0).reverse()),!Object(l.d)(j.resolution)&&j.resolution.reason.kind!==d.d.InvalidQualifier||Object(l.d)(j.resolution)&&void 0!==j.resolution.value)return a;if(b&&(void 0===i||i.kind===c.g.Document||i.kind===c.g.Ident)){var y=C(e,O);if(a=Object(d.m)(y,Object(n.__spreadArray)([],u,!0).reverse()),!Object(l.d)(y.resolution)&&y.resolution.reason.kind!==d.d.InvalidQualifier||Object(l.d)(y.resolution)&&void 0!==y.resolution.value)return a}}if(o.kind===c.d.CellRefNamePart&&(null==i&&e.allowUnqualifiedCell||null!=i&&i.kind!==c.g.Document)){var S=m(e,Object(c.u)(o.ref,null!=i&&i.kind===c.g.Ident?Object(c.gb)(i.name):i,o.label));return Object(d.m)(S,u.reverse())}if(o.kind!==c.d.FieldRefNamePart)return void 0!==a?a:Object(d.m)(Object(d.p)(Object(c.X)(Object(c.M)(o.asWhole,o.canDenoteNamedObject,o.label),i,-1)),Object(n.__spreadArray)([],u,!0).reverse());u.push(o.rhs),o=o.lhs,b=!1}}}}},function(e,t,r){"use strict";r.d(t,"d",(function(){return f})),r.d(t,"h",(function(){return b})),r.d(t,"g",(function(){return m})),r.d(t,"a",(function(){return g})),r.d(t,"b",(function(){return O})),r.d(t,"c",(function(){return j})),r.d(t,"e",(function(){return S})),r.d(t,"f",(function(){return C}));var n=r(9),a=r(25),i=r(55),o=r(5),c=r(102),u=r(30),s=r(18),l=r(74),d=r(108),f=new l.a,b=9,h=/^(https)|(http)|(file):\/\//,v=!1,p=void 0;function m(){return v}function g(){return p}function O(){if(null==p)throw new Error("initCalc was not passed calcAbsUrl");return p}function j(e,t,r){y(e,t,r,void 0)}function y(e,t,r,n){if(v){o.i.ULS.traceTag(595910878,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,"calc.config.initCalc: Calc is already initialized")}else{if(o.i.setLogger(e),Object(c.a)(e),Object(u.d)(t),null!=r&&!h.test(r)){var l="calc.config.initCalc: calcAbsUrl is not absolute: ".concat(r);o.i.ULS.traceTag(595910879,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,l)}i.setConfig(null!=n?n:{importScriptsMaxRetries:Object(u.c)("Microsoft.Office.Excel.CalcTSImportScriptsRetries")?b:0,onWorkerError:function(e){var t={error:Object(s.c)(e),innerError:e.info.error?Object(s.c)(e.info.error):void 0},r="calc.onWorkerError: ".concat(JSON.stringify(t));o.i.ULS.traceTag(593335298,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Warning,r)},onCreateWorker:function(e){var t="calc.onCreateWorker: ".concat(JSON.stringify(e));o.i.ULS.traceTag(593335299,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,t)}}),p=r,v=!0;var m=" (".concat("production",")"),g="calc.config.initCalc: Calc version ".concat(d.a).concat(m," initialized");o.i.ULS.traceTag(594642132,a.LogCategory.msoulscat_ES_EWAJS,a.TraceLevel.Info,g),f.resolve(void 0)}}function S(e,t,r,a){return Object(n.__awaiter)(this,void 0,void 0,(function(){var o;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,i.Endpoint.createOutside(e)];case 1:return o=n.sent(),y((c=o.post,u=function(e){return"[".concat((new Date).toISOString(),"] ").concat(e)},{shipAssertTag:function(e,t,r,n){c.shipAssertTag(e,t,r,u(n))},assertTag:function(e,t,r,n){c.assertTag(e,t,r,u(n))},traceTag:function(e,t,r,n){c.traceTag(e,t,r,u(n))},debugTraceTag:function(e,t,r,n){c.debugTraceTag(e,t,r,u(n))},dnmTraceTag:function(e,t,r,n){c.dnmTraceTag(e,t,r,u(n))}}),(function(e){return!0===t[e]}),r,a),[2]}var c,u}))}))}function C(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){var t,r,a,c,s;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:t=O(),r=new MessageChannel,a={port:r.port1,options:{id:"WorkerThreadLogger"}},c={port:r.port2,options:{id:"WorkerThreadLogger"}},n.label=1;case 1:return n.trys.push([1,3,,4]),[4,Promise.all([i.Endpoint.createInside(a,(function(){return o.i.noThrowLogger})),e.call.initCalcThreadInside.transfer([c.port],c,Object(u.b)(),t)])];case 2:return[2,n.sent()[0]];case 3:throw s=n.sent(),a.port.close(),s;case 4:return[2]}}))}))}},function(e,t,r){"use strict";r.d(t,"c",(function(){return n})),r.d(t,"d",(function(){return a})),r.d(t,"b",(function(){return i})),r.d(t,"f",(function(){return o})),r.d(t,"a",(function(){return c})),r.d(t,"e",(function(){return u})),r.d(t,"g",(function(){return s}));var n,a,i,o,c,u,s,l=r(10);!function(e){e.None="None",e.Single="Single",e.Double="Double",e.SingleAccounting="SingleAccounting",e.DoubleAccounting="DoubleAccounting"}(n||(n={})),Object(l.u)(),function(e){e.None="None",e.Subscript="Subscript",e.Superscript="Superscript"}(a||(a={})),Object(l.u)(),function(e){e.Pattern="Pattern",e.Gradient="Gradient"}(i||(i={})),function(e){e.None="None",e.Solid="Solid",e.MediumGray="MediumGray",e.DarkGray="DarkGray",e.LightGray="LightGray",e.DarkHorizontal="DarkHorizontal",e.DarkVertical="DarkVertical",e.DarkDown="DarkDown",e.DarkUp="DarkUp",e.DarkGrid="DarkGrid",e.DarkTrellis="DarkTrellis",e.LightHorizontal="LightHorizontal",e.LightVertical="LightVertical",e.LightDown="LightDown",e.LightUp="LightUp",e.LightGrid="LightGrid",e.LightTrellis="LightTrellis",e.Gray125="Gray125",e.Gray0625="Gray0625"}(o||(o={})),function(e){e.None="None",e.Thin="Thin",e.Medium="Medium",e.Dashed="Dashed",e.Dotted="Dotted",e.Thick="Thick",e.Double="Double",e.Hair="Hair",e.MediumDashed="MediumDashed",e.DashDot="DashDot",e.MediumDashDot="MediumDashDot",e.DashDotDot="DashDotDot",e.MediumDashDotDot="MediumDashDotDot",e.SlantDashDot="SlantDashDot"}(c||(c={})),Object(l.u)(),function(e){e.Automatic="Automatic",e.Left="Left",e.Center="Center",e.Right="Right",e.Fill="Fill",e.Justify="Justify",e.CenterAcrossSelection="CenterAcrossSelection",e.Distributed="Distributed",e.JustifyDistributed="JustifyDistributed"}(u||(u={})),Object(l.u)(),function(e){e.Top="Top",e.Center="Center",e.Bottom="Bottom",e.Justify="Justify",e.Distributed="Distributed"}(s||(s={})),Object(l.u)()},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(67),a=function(){function e(){var e=this;this.promise=new Promise((function(t,r){e._resolve=t,e._reject=r}))}return e.prototype.then=function(e,t){return this.promise.then(e,t)},e.prototype.toPromise=function(){return this.promise},e.prototype.resolve=function(e){return this._resolve(e),Object(n.b)(e)?this.promise.then():void 0},e.prototype.reject=function(e){return this._reject(e),Object(n.b)(e)?this.promise.then():void 0},e}()},function(e,t,r){"use strict";var n=r(20),a=(n.rTree.copyExcept,n.rTree.RTKind,n.rTree.RTree),i=r(10),o=r(3);function c(e,t){var r=e.row,n=e.col,a=e.rows,o=e.cols,c=t.row,u=t.col,s=t.rows,l=t.cols;return Object(i.a)(r-c+.5*(a-s))+Object(i.a)(n-u+.5*(o-l))}function u(){return a.create(o.s,o.r,o.o,c)}r.d(t,"a",(function(){return u}))},function(e,t,r){"use strict";r.d(t,"d",(function(){return n})),r.d(t,"g",(function(){return c})),r.d(t,"e",(function(){return u})),r.d(t,"f",(function(){return l})),r.d(t,"b",(function(){return d})),r.d(t,"c",(function(){return f})),r.d(t,"a",(function(){return b}));var n,a=r(9),i=r(0);function o(e,t,r){return{kind:e,machine:t,receiver:r}}!function(e){e[e.Next=1]="Next",e[e.CallMachine=2]="CallMachine"}(n||(n={}));var c=o(n.Next,void 0,void 0);function u(e,t){return o(n.CallMachine,e,t)}var s={receiveResult:function(e){return Object(i.d)(e)?c:e}};function l(){return s}var d=function(e){function t(t,r){var n=this.constructor,a=e.call(this,"Cycle detected: tried to call an already-running Machine")||this;a.machine=t,a.stackDepth=r;var i=n.prototype;return Object.getPrototypeOf(a)!==i&&(null!=Object.setPrototypeOf?Object.setPrototypeOf(a,i):a.__proto__=i),a}return Object(a.__extends)(t,e),t}(Error),f=function(){function e(e){this.numSteps=0,this.stack=[];try{this.pushFrame(u(e,{receiveResult:function(e){return e}})),this.transition=c}catch(e){this.transition=Object(i.c)(Object(i.e)(e))}}return e.resetStats=function(){e.maxStackDepth=0,e.numPauses=0,e.numCycles=0},e.prototype.pushFrame=function(t){var r=this.stack.length,n=t.machine;if(!0===n.runStatus)throw e.numCycles+=1,new d(n,r);!1===n.runStatus&&(n.runStatus=!0),this.stack.push(t),e.maxStackDepth<r+1&&(e.maxStackDepth=r+1)},e.prototype.advanceTopFrame=function(){var e=this.stack[this.stack.length-1].machine;return"boolean"!=typeof e.runStatus?e.runStatus:e.next()},e.prototype.step=function(){this.numSteps+=1;var e=this.transition;try{switch(e.kind){case n.Next:return void(this.transition=this.advanceTopFrame());case n.CallMachine:return this.pushFrame(e),void(this.transition=this.advanceTopFrame());default:var t=this.stack.pop();return t?(t.machine.runStatus=e,void(this.transition=t.receiver.receiveResult(e))):e}}catch(e){return void(this.transition=Object(i.c)(Object(i.e)(e)))}},e.prototype.run=function(t){if(void 0===t&&(t=function(){return!1}),this.result)return this.result;try{for(;;){var r=this.step();if(r)return this.result=r;if(t())return void(e.numPauses+=1)}}catch(e){return this.result=Object(i.c)(Object(i.e)(e))}},e.maxStackDepth=0,e.numPauses=0,e.numCycles=0,e}(),b=function(){function e(e){this.machines=e,this.runStatus=!1,this.values=[]}return e.prototype.next=function(){return this.values.length<this.machines.length?u(this.machines[this.values.length],this):Object(i.f)(this.values)},e.prototype.receiveResult=function(e){return Object(i.d)(e)?(this.values.push(e.value),this.next()):e},e}()},function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return o}));var n=r(7),a=r(8),i=function(){function e(e,t){void 0===t&&(t=n.w),this._fields=e,this._fallback=t,this.kind=a.b.Rich}return e.prototype.getFallback=function(){return this._fallback},e.prototype.getField=function(e){return this._fields.getValue(e)},e}(),o=function(){function e(e,t,r,n,i,o){this.maxArity=e,this.minArity=t,this.kind=a.b.Rich,this.locals=r,this.env=n,this.defIdents=i,this.defsAndBody=o}return e.prototype.getFallback=function(){return n.w},e.prototype.getField=function(e){},e}()},function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return i}));var n=r(10),a=Object(n.w)()((function(e,t,r){return{sign:e,mantissa:t,exponent:r}}));function i(e,t){if(t<=1)return t;var r=e%t;return 0===r?t:r<0?r+t:r}},function(e,t,r){"use strict";r.d(t,"a",(function(){return M})),r.d(t,"b",(function(){return U}));var n,a=r(9),i=r(2),o=r(7),c=r(1),u=r(5),s=r(3),l=r(12),d=r(4),f=r(35),b=r(46),h=r(18),v=r(19),p=r(71),m=r(0),g=r(29),O=r(8),j=r(111),y=r(68),S=r(23),C=/"/g,k=Object(l.p)(Object(l.s)(Object(l.d)(void 0,"Book1"),0),Object(l.f)(0,0));function E(e){if(!Object(m.d)(e)&&e.reason.kind!==v.d.NoOriginSheet&&e.reason.kind!==v.d.InvalidQualifier&&e.reason.kind!==v.d.InvalidCellRef&&e.reason.kind!==v.d.InvalidStructRef&&e.reason.kind!==v.d.EmptyIntersection)throw new _(e.reason)}function A(e){for(var t=[],r=[],n=0,a=e;n<a.length;n++){var i=a[n];i.length>0&&Object(S.f)(Object(S.i)(i,0))===i.length?t[Object(S.i)(i,0)]=!0:r.push(i)}return function(e,n){var a=Object(S.i)(e,n);if(!0===t[a])return!0;for(var i=0,o=r;i<o.length;i++){var c=o[i];if(Object(h.h)(e,c,n))return!0}return!1}}function N(e,t){for(var r="",n=0;n<e.length;){t(e,n)&&(r+="'");var a=Object(S.i)(e,n);r+=Object(S.j)(a),n+=Object(S.f)(a)}return r}!function(e){e[e.Original=0]="Original",e[e.Bracketed=1]="Bracketed",e[e.Unbracketed=2]="Unbracketed"}(n||(n={}));var T={literalNode:function(e,t,r){return r},arrayNode:function(e,t,r){return r},appNode:function(e,t,r,n){return n},letNode:function(e,t,r,n,a,i){return i},lambdaNode:function(e,t,r,n,a,i){return i},parenNode:function(e,t,r){return r},nameNode:function(e,t,r){return r},cellRefNode:function(e,t,r){return r},fieldRefNode:function(e,t,r,n){return n},structRefNode:function(e,t,r){return r},badSequenceNode:function(e,t,r){return r},badStringNode:function(e,t,r){return r},operatorNode:function(e,t){return t},wsfNode:function(e,t,r){return r}},R=Object(a.__assign)(Object(a.__assign)({},Object(g.j)(void 0)),{operatorNode:function(e){return e}}),I=function(){function e(e,t,r,n){var i,o,c,u,s=this;this.root=r,this.anonymize=n,this.anon=function(e){return s.anonymize?Object(f.b)(e):e},this.locals=t,this.localeInfo=null!==(o=null===(i=t.config)||void 0===i?void 0:i.localeInfo)&&void 0!==o?o:e.config.localeInfo,this.mathpack=e.config.mathpack,this.refStyle=null!==(u=null===(c=t.config)||void 0===c?void 0:c.refStyle)&&void 0!==u?u:e.config.refStyle,this.resolver=Object(p.a)(e),this.spans=r.spans,this.annotations=r.annotations;var l=["'",this.localeInfo.leftBracket,this.localeInfo.rightBracket,"#","@"],d=Object(a.__spreadArray)(Object(a.__spreadArray)([],l,!0),["\t","\n","\r"," ","!",'"',"$","%","&","(",")","*","+",this.localeInfo.listSeparator,"-",".","/",":",";","<","=",">","?","\\","^","_","`","{","}","~"],!1);this.isStructRefEscapable=A(l),this.isStructRefBracketedThisRef=A(d),this.isFieldRefEscapable=A(["'",this.localeInfo.leftBracket,this.localeInfo.rightBracket])}return e.prototype.print=function(){var e=new g.g({str:this,label:T,op:R});return"="+this.pre(this.root.node.label,"")+Object(g.m)(e,this.root).str},e.prototype.pre=function(e,t){var r,n;return this.anonymize?t:null!==(n=null===(r=this.spans[e])||void 0===r?void 0:r.pre)&&void 0!==n?n:t},e.prototype.post=function(e,t){var r,n;return this.anonymize?t:null!==(n=null===(r=this.spans[e])||void 0===r?void 0:r.post)&&void 0!==n?n:t},e.prototype.printRef=function(e,t){var r="";switch(e.kind){case i.j.SpecialRef:(t===n.Original&&e.isBracketed||t===n.Bracketed)&&(r+=this.localeInfo.leftBracket);var a=this.localeInfo.specialRefNames[e.id];if(null==a)throw new _(Object(s.w)("No locale data for specialRefName"));r+=a,(t===n.Original&&e.isBracketed&&e.isClosed||t===n.Bracketed)&&(r+=this.localeInfo.rightBracket);break;case i.j.ColumnRef:var o=0===e.name.length||Object(h.h)(e.name," ")||Object(h.g)(e.name," ");(t===n.Original&&e.isBracketed||t===n.Bracketed||t===n.Unbracketed&&o)&&(r+=this.localeInfo.leftBracket);var c=N(e.name,this.isStructRefEscapable);r+=this.anon(c),(t===n.Original&&e.isBracketed&&e.isClosed||t===n.Bracketed||t===n.Unbracketed&&o)&&(r+=this.localeInfo.rightBracket);break;case i.j.RangeOpRef:r+=this.printRef(e.lhs,t===n.Original?t:n.Bracketed)+":"+this.printRef(e.rhs,t===n.Original?t:n.Bracketed);break;case i.j.MissingRef:break;case i.j.BadRef:e.isBracketed&&(r+=this.localeInfo.leftBracket),r+=e.contents,e.isBracketed&&e.isClosed&&(r+=this.localeInfo.rightBracket)}return r},e.prototype.printThisRowOpRef=function(e){var t="@";return e&&(e.kind===i.j.ColumnRef?t+=this.printRef(e,e.isClosed?function(e,t){for(var r=0;r<e.length;){if(t(e,r))return!0;r+=Object(S.f)(Object(S.i)(e,r))}return!1}(e.name,this.isStructRefBracketedThisRef)?n.Bracketed:n.Unbracketed:n.Original):t+=this.printRef(e,Object(s.P)(e)&&Object(s.Q)(e)?n.Bracketed:n.Original)),t},e.prototype.printApplication=function(e,t,r){var n=this,a=t.map((function(e,t){return n.pre(e.label,0===t||""===e.str?"":" ")+e.str}));return e.str+"("+a.join(this.localeInfo.listSeparator)+(0===t.length?"":this.post(t[t.length-1].label,""))+(r?")":"")},e.prototype.printCellRef=function(e){var t=e.ref,r=e.qualifier;return(void 0!==r?Object(g.t)(this,r):"")+Object(g.q)(this,t)},e.prototype.printName=function(e){var t=e.whole,r=e.qualifier;return(void 0!==r?Object(g.t)(this,r):"")+this.anon(t)},e.prototype.printUnanonymisedDocQual=function(e){if(void 0===e)return"";var t=e.path,r=e.document;return(null!=t?t:"")+this.localeInfo.leftBracket+r+this.localeInfo.rightBracket},e.prototype.printOptionalParamName=function(e){return e.kind===i.e.Name?this.anon(Object(s.h)(this.localeInfo,e.whole)):this.pre(e.label,"")+this.anon(e.contents)+this.post(e.label,"")},e.prototype.literalNode=function(e,t,r){switch(e.kind){case O.b.String:return'"'+this.anon(e.value).replace(C,'""')+'"';case O.b.Boolean:return e.value?this.localeInfo.trueName:this.localeInfo.falseName;case O.b.Number:return this.anon(this.mathpack.formatGeneral(this.localeInfo,e,21));case O.b.Missing:return"";case O.b.Error:var n=this.localeInfo.errorNames[e.type];if(null==n)throw new _(Object(s.w)("No locale data for error type ".concat(e.type)));return n;default:return Object(u.e)("calc.lang.printFormula",e)}},e.prototype.arrayNode=function(e,t,r){var n=this;return this.localeInfo.leftBrace+e.map((function(e){return e.map((function(e){return e.str})).join(n.localeInfo.columnSeparator)})).join(this.localeInfo.rowSeparator)+(t?this.localeInfo.rightBrace:"")},e.prototype.appNode=function(e,t,r,n){if(void 0!==e.op){if(1===t.length){var a=t[0];switch(e.op){case c.a.Percent:return a.str+this.pre(e.label,"")+e.str;case c.a.Pound:return a.str+e.str;default:return e.str+this.post(e.label,"")+a.str}}if(2===t.length){var i=t[0],o=t[1];return i.str+this.pre(e.label," ")+e.str+this.post(e.label,e.op===c.a.Isect?"":" ")+o.str}return Object(u.a)("calc.lang.printFormula: invalid number of operator args")}return this.printApplication(e,t,r)},e.prototype.letNode=function(e,t,r,n,a,o){var c=this,u=t.map((function(e){var t=e.name,r=e.binder;return Object(i.S)(Object(i.O)({str:c.anon(Object(s.h)(c.localeInfo,t.arg.whole)),label:t.arg.label,op:void 0},t.index),r)}));return this.printApplication(e,Object(i.G)(u,r,n),a)},e.prototype.lambdaNode=function(e,t,r,n,a,o){var c=this,u=t.map((function(e){var t=e.name,r=(t.arg.name.isBracketed?c.localeInfo.leftBracket:"")+c.printOptionalParamName(t.arg.name.name)+(t.arg.name.isBracketed&&t.arg.name.isClosed?c.localeInfo.rightBracket:"");return void 0!==t.arg.def&&(r+=c.pre(t.arg.def.label," ")+":="+c.pre(t.arg.def.rhs.label,""===t.arg.def.rhs.str?"":" ")+t.arg.def.rhs.str),Object(i.Q)(Object(i.O)({str:r,label:t.arg.label,op:void 0},t.index))}));return this.printApplication(e,Object(i.F)(u,r,n),a)},e.prototype.parenNode=function(e,t,r){return"("+this.pre(e.label,"")+e.str+this.post(e.label,"")+(t?")":"")},e.prototype.nameNode=function(e,t,r){var n=this.resolver.resolveDottedName(this.locals,Object(i.X)(e,t,r),this.annotations),o=n.resolved,c=n.fields;return E(o.resolution),o.kind===v.e.ResolvedCellRef?Object(a.__spreadArray)([this.printCellRef(o.node)],c.map(this.anon),!0).join("."):o.kind===v.e.ResolvedLocalName&&void 0!==o.resolution.value?Object(a.__spreadArray)([this.anon(o.resolution.value.name)],c.map(this.anon),!0).join("."):o.kind===v.e.ResolvedUserDefinedFunc?Object(a.__spreadArray)([this.anon(o.name)],c.map(this.anon),!0).join("."):Object(a.__spreadArray)([this.printName(o.node)],c.map(this.anon),!0).join(".")},e.prototype.cellRefNode=function(e,t,r){var n=this.resolver.resolveCellRef(this.locals,Object(i.u)(e,t,r)),a=n.node;return E(n.resolution),this.printCellRef(a)},e.prototype.fieldRefNode=function(e,t,r,n){var a=e.str,o=r,c=t.isBracketed||o?this.localeInfo.leftBracket:"",u=t.isBracketed&&t.isClosed||o?this.localeInfo.rightBracket:"",s=t.field.kind===i.e.Name?N(t.field.whole,this.isFieldRefEscapable):t.field.contents;return t.field.kind!==i.e.Name&&(a+=this.pre(t.label,"")),a+="."+c+this.anon(s)+u+this.post(t.label,"")},e.prototype.structRefNode=function(e,t,r){var a,o=this,c=this.resolver.resolveStructRef(this.locals,Object(i.kb)(e,t,r)),u=c.node,l=c.table;E(c.resolution);var d=u.rhs.innerRef,f=u.lhs;void 0!==f||void 0===l||!u.rhs.isClosed||(null==d?void 0:d.kind)===i.j.ColumnRef||(null==d?void 0:d.kind)===i.j.ThisRowOpRef&&(null===(a=d.ref)||void 0===a?void 0:a.kind)===i.j.ColumnRef||(f=Object(i.X)(Object(i.M)(l.name)));var b=void 0!==f?this.printName(f):"";if(void 0===d&&u.rhs.isClosed&&void 0!==f)return b;switch(b+=this.localeInfo.leftBracket,null==d?void 0:d.kind){case i.j.ColumnRef:case i.j.SpecialRef:if(d.kind===i.j.SpecialRef&&d.id===i.i.ThisRow&&d.isClosed){b+=this.printThisRowOpRef(void 0);break}b+=this.printRef(d,d.isClosed?n.Unbracketed:n.Original);break;case i.j.RangeOpRef:var h=(v=Object(s.P)(d)&&Object(s.Q)(d))?n.Bracketed:n.Original;b+=this.printRef(d,h);break;case i.j.CommaOpRef:var v;if((v=Object(s.C)(d)&&Object(s.A)(d)&&Object(s.B)(d))&&d.specialRefs[i.i.ThisRow]){b+=this.printThisRowOpRef(0===d.columnRefs.length?void 0:d.columnRefs[0]);break}var p=v?Object(s.gb)(d):d.refs,m=v?1===p.length?n.Unbracketed:n.Bracketed:n.Original;b+=p.map((function(e){return o.printRef(e,m)})).join(this.localeInfo.listSeparator);break;case i.j.ThisRowOpRef:b+=this.printThisRowOpRef(d.ref);break;case i.j.BadRef:b+=this.printRef(d,n.Original)}return u.rhs.isClosed&&(b+=this.localeInfo.rightBracket),b},e.prototype.badSequenceNode=function(e,t,r){var n=this;return t.map((function(e){return n.pre(e.label,"")+e.str+n.post(e.label,"")})).join("")},e.prototype.badStringNode=function(e,t,r){return this.anon(t)},e.prototype.operatorNode=function(e,t){var r=Object(d.A)(this.localeInfo,e,"");if(void 0===r)throw new _(Object(s.w)("Invalid operator"));return r},e.prototype.wsfNode=function(e,t,r){return this.localeInfo.getWorksheetFuncName(e)},e.prototype.cellRefError=function(){var e=this.localeInfo.errorNames[o.a.REF];if(null==e)throw new _(Object(s.w)("No locale data for #REF"));return e},e.prototype.cellRefSingle=function(e,t,r){var n=Object(b.c)(this.localeInfo,this.refStyle,this.locals.originGridCell.value,e,t,this.locals.wrapCellReferences);return void 0!==n?this.anon(n):this.cellRefError()},e.prototype.cellRefRange=function(e,t){var r=Object(b.h)(this.localeInfo,this.refStyle,this.locals.originGridCell.value,e.row,e.col,t.row,t.col,this.locals.wrapCellReferences);return void 0!==r?this.anon(r):this.cellRefError()},e.prototype.cellRefRow=function(e,t,r){var n=Object(b.j)(this.localeInfo,this.refStyle,this.locals.originGridCell.value.row,e,t,this.locals.wrapCellReferences);return void 0!==n?this.anon(n):this.cellRefError()},e.prototype.cellRefCol=function(e,t,r){var n=Object(b.e)(this.localeInfo,this.refStyle,this.locals.originGridCell.value.col,e,t,this.locals.wrapCellReferences);return void 0!==n?this.anon(n):this.cellRefError()},e.prototype.cellRefBad=function(e,t){return this.anon(e)},e.prototype.errorQualifier=function(){var e=this.localeInfo.errorNames[o.a.REF];if(null==e)throw new _(Object(s.w)("No locale data for #REF"));return e},e.prototype.relativeQualifier=function(){return"!"},e.prototype.documentQualifier=function(e,t,r){return Object(b.k)(this.anon(this.printUnanonymisedDocQual(Object(i.A)(e,t))))+"!"},e.prototype.sheetQualifier=function(e,t,r){return Object(b.g)(this.localeInfo,this.refStyle,this.anon(this.printUnanonymisedDocQual(t)+e))+"!"},e.prototype.identQualifier=function(e,t){return Object(b.g)(this.localeInfo,this.refStyle,this.anon(e))+"!"},e.prototype.sheetRangeQualifier=function(e,t,r,n){var a=this.anon(this.printUnanonymisedDocQual(r)+e),i=this.anon(t),o=a+":"+i;return(Object(b.m)(this.localeInfo,this.refStyle,a)||Object(b.m)(this.localeInfo,this.refStyle,i)?Object(b.k)(o):o)+"!"},e.prototype.badQualifier=function(e,t){return this.anon(e)},e}(),_=Object(s.c)("PrintFormulaError"),F=Object(s.c)("PrintRangeError");function w(e,t,r,n){void 0===n&&(n=!1);try{return Object(m.f)(new I(e,t,r,n).print())}catch(e){return e instanceof _?Object(m.c)(e.reason):Object(m.c)(Object(m.e)(e))}}function M(e,t,r){try{var n=r.kind===l.a.Cell||r.kind===l.a.Range?Object(y.b)(r,Object(s.ib)(r.range)):r.kind===l.a.NameManager?Object(y.c)(r,k):Object(u.e)("calc.lang.anonymizeFormula",r),a=w(Object(y.a)(Object(d.j)(Object(d.s)(),i.h.A1,e.mathpack)),n,t,!0);if(a.kind===m.b.Success)return a.value;if(a.reason.kind===m.a.JavaScriptError)throw a.reason.error}catch(e){var o="calc.lang.anonymizeFormula: Format failed: "+Object(h.c)(e);u.i.ULS.traceTag(556863706,d.c.msoulscat_ES_EWAJS,d.i.Warning,o)}return Object(f.a)(t)}function D(e,t){return Object(i.x)(Object(i.db)(i.f.Rel,t.row-e.row),Object(i.db)(i.f.Rel,t.col-e.col))}function P(e,t,r){var n,a=t.originSheet.value,o=function(e,t){var r=D(e,Object(s.n)(t));if(Object(s.F)(t))return r;var n=D(e,Object(l.f)(t.row+t.rows-1,t.col+t.cols-1));return Object(i.v)(r,n)}(t.originGridCell.value,r.range);if(void 0===a.index||!Object(s.Z)(a,r.sheet)){var c=e.getSheetName(r.sheet.document,r.sheet.index);if(!Object(m.d)(c))throw new F(c.reason);n=Object(i.gb)(c.value)}return Object(i.u)(o,n)}function x(e){return Object(m.d)(e)?(Object(u.h)("calc.lang.printRangeStructRef: NameLoc can't be no-table",null!=e.value),Object(m.f)(e.value)):e.reason.kind===v.d.InvalidStructRef?Object(u.a)("calc.lang.printRangeStructRef: NameLoc can't be InvalidStructRef"):Object(m.c)(e.reason)}function L(e,t,r,n){var o,c;void 0===n&&(n=Object(j.b)());try{var u=t.originSheet.value;if(!Object(s.D)(u.document,r.sheet.document))throw new F(Object(s.hb)(["printRange cross-document"]));return Object(m.f)(null!==(c=null!==(o=function(e,t,r,n){var o=t.originSheet.value,c=e.getNamedRanges(r);if(!Object(m.d)(c))throw new F(c.reason);if(0!==c.value.length){var u=function(e){return void 0!==e.index&&(void 0===o.index||!Object(s.Z)(e,o))},d=c.value.filter((function(e){var t=e.scope;return void 0===t.index?Object(s.D)(t.document,r.sheet.document):Object(s.Z)(t,r.sheet)})).filter((function(t){var r=t.scope,n=t.name;if(void 0!==r.index||void 0===o.index)return!0;var a=o,i=e.getNameLoc(a,n,l.b.Plain);if(!Object(m.d)(i))throw new F(i.reason);return null==i.value})).filter((function(e){var t=e.scope,r=e.name;return u(t)||!n.contains(r)}));if(0!==d.length){var f,b=1===d.length?d[0]:Object(a.__spreadArray)([],d,!0).sort((function(t,r){return e.config.localeInfo.stringCompareCI(t.name,r.name)}))[0];if(u(b.scope)){var h=e.getSheetName(b.scope.document,b.scope.index);if(!Object(m.d)(h))throw new F(h.reason);f=Object(i.gb)(h.value)}return Object(i.X)(Object(i.M)(b.name),f)}}}(e,t,r,n))&&void 0!==o?o:function(e,t,r){var n=r.sheet,a=r.range,o=e.getContainingTable(Object(l.p)(n,Object(s.n)(a)));if(!Object(m.d)(o))throw new F(o.reason);if(null!=o.value){var c=o.value,u=x(e.getStructRefSpecialRef(c,i.i.All));if(!Object(m.d)(u))throw new F(u.reason);var d=u.value.range,f=u.value.sheet,b=Object(s.o)(d,a);if(!(void 0===b||b<0)){var h=x(e.getStructRefSpecialRef(c,i.i.Data));if(!Object(m.d)(h))throw new F(h.reason);var v=h.value.range,p=t.originGridCell.value,g=t.originSheet.value,O=void 0!==g.index&&Object(s.Z)(g,f)&&Object(s.r)(d,p)?void 0:Object(i.X)(Object(i.M)(c.name)),j=null!=O?O:Object(i.X)(Object(i.M)(c.name)),y=v.cols>1&&a.col===v.col&&a.cols===v.cols,S=function(){var t=x(e.getStructRefColumn(c,a.col));if(!Object(m.d)(t))throw new F(t.reason);if(1===a.cols)return Object(i.y)(t.value.name);var r=x(e.getStructRefColumn(c,a.col+a.cols-1));if(!Object(m.d)(r))throw new F(r.reason);return Object(i.eb)(Object(i.y)(t.value.name),Object(i.y)(r.value.name))};if(a.row===d.row&&a.rows===d.rows)return Object(i.kb)(j,Object(i.jb)(y?Object(i.ib)(i.i.All):Object(i.z)([Object(i.ib)(i.i.All,!0),S()])));if(1===a.rows&&a.row===p.row&&a.row>=v.row&&a.row<v.row+v.rows)return Object(i.kb)(1===a.cols?O:j,Object(i.jb)(Object(i.lb)(y?void 0:S())));if(a.row===v.row&&a.rows===v.rows)return y?Object(i.kb)(j,Object(i.jb)(void 0)):Object(i.kb)(1===a.cols?O:j,Object(i.jb)(S()));var C=a.row===d.row&&a.row+a.rows===v.row,k=a.row===v.row+v.rows&&a.row+a.rows===d.row+d.rows;if(C||k){var E=Object(i.ib)(C?i.i.Headers:i.i.Totals,!y);return Object(i.kb)(j,Object(i.jb)(y?E:Object(i.z)([E,S()])))}var A=a.row===d.row&&d.row<v.row&&a.row+a.rows===v.row+v.rows,N=a.row===v.row&&d.row+d.rows>v.row+v.rows&&a.row+a.rows===d.row+d.rows;if(A||N){var T=Object(i.ib)(A?i.i.Headers:i.i.Data,!0),R=Object(i.ib)(A?i.i.Data:i.i.Totals,!0);return Object(i.kb)(j,Object(i.jb)(y?Object(i.z)([T,R]):Object(i.z)([T,R,S()])))}}}}(e,t,r))&&void 0!==c?c:P(e,t,r))}catch(e){return e instanceof F?Object(m.c)(e.reason):Object(m.c)(Object(m.e)(e))}}var B={getNamedRanges:function(){return Object(u.a)("calc.lang.prettyPrinter: default getNamedRanges")}};function U(e){var t=function(e){var t,r,n;return{config:e.config,getDocumentLoc:e.getDocumentLoc.bind(e),getSheetIndex:e.getSheetIndex.bind(e),getSheetName:e.getSheetName.bind(e),getNameLoc:e.getNameLoc.bind(e),getUserDefinedFuncLoc:e.getUserDefinedFuncLoc.bind(e),getSheetRangeIndexes:e.getSheetRangeIndexes.bind(e),getContainingTable:e.getContainingTable.bind(e),getStructRefColumn:e.getStructRefColumn.bind(e),getStructRefSpecialRef:null===(t=e.getStructRefSpecialRef)||void 0===t?void 0:t.bind(e),getNamedRanges:null!==(n=null===(r=e.getNamedRanges)||void 0===r?void 0:r.bind(e))&&void 0!==n?n:B.getNamedRanges}}(e);return{printFormula:function(t,r){return w(e,t,r)},printRange:function(e,r,n){return L(t,e,r,n)}}}},function(e,t,r){"use strict";var n=r(123),a=r(25),i=r(35),o=r(5),c=r(2),u=r(7),s=r(1),l=r(15),d=r(13),f=r(65),b=r(27),h=r(17),v=r(9),p=r(60),m=r(3),g=r(33),O=r(8),j=r(46),y=r(30);function S(e){return e.kind===l.c.Literal&&e.oper.kind===O.b.Boolean}var C=g.n,k=Object(d.s)((function(e,t){return t.isIdentContinue&&!S(t)&&t.chars.length>0&&t.chars.charCodeAt(0)!==C?t.chars:void 0})),E=Object(d.s)((function(e,t){return t.isIdentContinue||Object(h.b)(t)?t.chars:void 0})),A=Object(d.b)(Object(d.l)(k,E),(function(e,t){return t.join("")})),N=Object(d.s)((function(e,t){return t.kind===l.c.Ident?t.chars:void 0})),T=function(e,t){var r;return(null!==(r=t.path)&&void 0!==r?r:"")+e.leftBracket+t.document+e.rightBracket};function R(e,t,r,n,a,i){var o,u;if(null==t)null==n?(o=Object(c.N)(r,a,i),u=r):(o=Object(c.hb)(r,n,void 0,a,i),u="".concat(r,":").concat(n));else{var s=T(e.localeInfo,t);null==n?(o=Object(c.gb)(r,t,a,i),u="".concat(s).concat(r)):(o=Object(c.hb)(r,n,t,a,i),u="".concat(s).concat(r,":").concat(n))}return[o,a?Object(j.k)(u):u]}var I=Object(d.s)((function(e,t){return t.kind===l.c.Ident||Object(h.e)(t)?t.chars:void 0})),_=Object(d.b)(Object(d.u)(h.k,Object(d.k)(I),h.s,Object(d.l)(I),h.z,h.k),(function(e,t){var r=t[0],n=t[1],a=(t[2],t[3]),i=(t[4],t[5]),o=n.join(""),u=a.join("");return Object(c.A)(u,""!==o?o:void 0,!0,Object(b.b)(e,r,i,"",""))})),F=Object(d.b)(Object(d.u)(h.k,h.s,Object(d.l)(E),h.z,h.k),(function(e,t){var r=t[0],n=(t[1],t[2]),a=(t[3],t[4]),i=n.join("");return Object(c.A)(i,void 0,!1,Object(b.b)(e,r,a,"",""))})),w=Object(d.b)(Object(d.u)(h.k,Object(d.m)(F,void 0),A,Object(d.m)(Object(d.o)(h.x,A),void 0),h.k),(function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=t[4];return R(e,n,a,i,!1,Object(b.b)(e,r,o,"",""))})),M=Object(d.b)(Object(d.u)(h.u,Object(d.m)(_,void 0),N,Object(d.m)(Object(d.o)(h.x,N),void 0),h.B,h.k),(function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=(t[4],t[5]);return R(e,n,a,i,!0,Object(b.b)(e,r.start,o,"",""))})),D=Object(d.b)(F,(function(e,t){return[t,T(e.localeInfo,t)]})),P=Object(d.b)(Object(d.u)(h.u,_,h.B),(function(e,t){t[0];var r=t[1];t[2];return[r,Object(j.k)(T(e.localeInfo,r))]})),x=Object(d.s)((function(e,t){return t.kind===l.c.End||t.kind===l.c.Right&&t.value===l.a.SQuote?void 0:t.chars})),L=Object(d.b)(Object(d.u)(h.u,Object(d.k)(x),Object(d.m)(Object(d.u)(h.B,Object(d.m)(Object(d.u)(h.w,h.D),[void 0,""])),[void 0,[void 0,""]]),h.k),(function(e,t){var r=t[0],n=t[1],a=t[2],i=a[0],o=a[1],u=o[0],s=o[1],l=t[3],d="'".concat(n.join("")).concat(void 0!==i?"'":"").concat(void 0!==u?"!":""),f=Object(b.b)(e,r.start,l-s.length,"",s);return[Object(c.o)(d,!0,f),d]})),B=Object(d.t)((function(e,t,r){if(Object(h.f)(t)){var n=Object(b.b)(e,t.start,r.start,"","");return[Object(c.B)(n),t.chars]}})),U=Object(d.n)((function(e,t){var r=Object(b.b)(e,t.start,t.start,"","");return[Object(c.fb)(r),""]})),G=Object(d.b)(Object(d.u)(Object(d.a)(w,M,D,P,U),h.w,h.D),(function(e,t){var r=t[0],n=r[0],a=r[1],i=(t[1],t[2]),o=Object(b.d)(e,n);return o.end+=1,o.post=i,[n,"".concat(a,"!")]})),V=Object(d.s)((function(e,t){return t.isIdentContinue||Object(h.b)(t)||S(t)||function(e){return e.kind===l.c.Literal&&Object(l.z)(e.oper)}(t)?t.chars:void 0})),H=Object(d.b)(Object(d.u)(h.k,Object(d.k)(V),h.w,h.k,h.D),(function(e,t){var r=t[0],n=t[1],a=(t[2],t[3]),i=t[4],o="".concat(n.join(""),"!"),u=Object(b.b)(e,r,a,"",i);return[Object(c.o)(o,!1,u),o]})),W=Object(d.a)(B,G,Object(d.i)((function(){return Object(y.e)(y.a["OfficeVSO:3594447_InvalidQualifier2"])?H:Object(d.f)()})),L),z=r(23),q=r(96);function K(e,t){return e.refStyle===t.refStyle&&!t.isBadLocale&&t.row!==p.a.A1BadDollar&&t.col!==p.a.A1BadDollar}function Y(e){return e.refStyle===c.h.R1C1||"object"==typeof e.row&&"object"==typeof e.col}function J(e,t){return t.kind===l.c.CellRef&&K(e,t)&&Y(t)}var Q=Object(c.db)(c.f.Rel,0);function X(e){return e===p.a.RCNoNum?Q:e}function Z(e,t){if(e.row!==p.a.A1BadDollar&&e.col!==p.a.A1BadDollar){var r=e.refStyle===c.h.R1C1&&!e.isIdentContinue;if(null!=e.row&&null!=e.col)return Object(c.x)(X(e.row),X(e.col),r,t);if(null!=e.row){var n=X(e.row);return Object(c.w)(n,n,r,t)}if(null!=e.col){var u=X(e.col);return Object(c.r)(u,u,r,t)}}var s="calc.parse.cellRefToken2cellRef: bad token ".concat(Object(i.a)(e));return o.i.ULS.assertTag(589825159,a.LogCategory.msoulscat_ES_EWAJS,!1,s)}function $(e,t){return t.isIdentContinue&&e.localeInfo.isIdentStart(Object(z.i)(t.chars,0))}var ee=Object(d.s)((function(e,t){return J(e,t)&&!$(e,t)||Object(h.f)(t)?t:void 0})),te=Object(d.s)((function(e,t){return J(e,t)&&$(e,t)?t:void 0})),re=Object(d.b)(Object(d.u)(Object(d.a)(ee,Object(d.v)((function(e){return e.cellRefMustBeCellRefNode?te:Object(d.j)(te,Object(d.g)(Object(d.a)(h.q,h.n)))}))),h.k),(function(e,t){var r=t[0],n=t[1],a=r.kind===l.c.CellRef?Z(r,Object(b.b)(e,r.start,n,"","")):Object(c.s)(Object(b.b)(e,r.start,n,"","")),i=r.kind===l.c.CellRef?r.chars:void 0;return Object(f.f)(Object(c.u)(a,void 0,Object(b.b)(e,r.start,n,"","")),i)}));var ne=Object(d.t)((function(e,t,r){return t.kind!==l.c.CellRef||!K(e,t)||function(e,t,r){return r.kind===l.c.Left&&r.value===l.a.Paren&&t.isIdentContinue&&null!=Object(m.k)(e.localeInfo,t.chars)}(e,t,r)||r.isIdentContinue?void 0:[t,r.start]})),ae=Object(d.d)(Object(d.u)(ne,h.D,h.x,h.D,ne),(function(e,t){var r=t[0],n=r[0],a=r[1],i=t[1],o=(t[2],t[3]),u=t[4],s=u[0],h=u[1],v=Object(b.b)(e,n.start,a,"",i),p=Object(b.b)(e,s.start,h,o,""),m=Z(n,v),g=Z(s,p),O=void 0;if(m.kind===c.c.Single&&g.kind===c.c.Single){var j=Object(b.b)(e,n.start,h,"","");O=Object(c.v)(m,g,j)}else if(0===i.length&&0===o.length)if(m.kind===c.c.Row&&g.kind===c.c.Row){var y=m.isBracketed||g.isBracketed;j=Object(b.b)(e,n.start,h,"","");O=Object(c.w)(m.row1,g.row1,y,j)}else if(m.kind===c.c.Col&&g.kind===c.c.Col){y=m.isBracketed||g.isBracketed,j=Object(b.b)(e,n.start,h,"","");O=Object(c.r)(m.col1,g.col1,y,j)}if(null==O)return Object(d.f)();var S=Object(f.f)(Object(c.u)(O,void 0,Object(b.b)(e,n.start,h,"","")),void 0);return n.isIdentContinue&&s.isIdentContinue?Object(d.n)((function(e,t){return t.kind===l.c.Sep&&t.value===l.b.Qual?void 0:S})):Object(d.q)(S)})),ie=Object(d.a)(ae,re),oe=Object(d.b)(Object(d.s)((function(e,t){return t.kind===l.c.CellRef?t:void 0})),(function(e,t){var r=t.start+t.chars.length,n=t.refStyle===c.h.R1C1&&!t.isIdentContinue;return Object(f.f)(Object(c.u)(Object(c.q)(t.chars,n,Object(b.b)(e,t.start,r,"","")),void 0,Object(b.b)(e,t.start,r,"","")),t.chars)}));var ce=Object(d.s)((function(e,t){return t.kind===l.c.Ident&&e.localeInfo.isIdentStart(Object(z.i)(t.chars,0))||t.kind===l.c.CellRef&&$(e,t)?t:void 0})),ue=Object(d.s)((function(e,t){return t.kind===l.c.Literal&&t.oper.kind===O.b.Boolean?t:void 0})),se=Object(d.a)(ce,Object(d.j)(ue,Object(d.r)(h.n))),le=Object(d.n)((function(e,t){return Object(h.c)(t)})),de=Object(d.u)(Object(d.l)(se,h.q),Object(d.k)(Object(d.a)(h.q,h.n)),le,h.k),fe=Object(d.b)(de,(function(e,t){var r,n,a,i,u,s,d,h,m,g,O=t[0],j=t[1],y=t[2],S=t[3],C=O[0],k=1===O.length&&(null===(r=j[0])||void 0===r?void 0:r.kind)===l.c.Sep,E=C.kind!==l.c.CellRef||(g=C).refStyle===c.h.A1&&null==g.row&&"object"==typeof g.col&&g.col.kind===c.f.Rel||function(e,t){return t.refStyle===c.h.A1&&e.refStyle===c.h.A1&&t.isIdentContinue||t.refStyle===c.h.R1C1&&Object(p.b)(t.row,t.col)}(e,C)&&k;if(y||function(e,t,r){return 0===r.length||1===t.length&&t[0].kind===l.c.Literal||r.length%2!=0||r.some((function(t,r){return r%2==0?t.kind!==l.c.Sep:t.kind===l.c.Sep||!Object(q.a)(e.localeInfo,t.chars)}))}(e,O,j)){var A=Object(v.__spreadArray)(Object(v.__spreadArray)([],O,!0),j,!0).map((function(e){return e.chars})).join(""),N=Object(c.M)(A,E,Object(b.b)(e,C.start,S,"","")),T=Object(c.X)(N,void 0,Object(b.b)(e,C.start,S,"",""));return Object(f.f)(T,T.whole)}var R,I=E,_=0;if(1===O.length&&C.kind===l.c.CellRef){var F=Object(b.b)(e,C.start,null!==(a=null===(n=j[_])||void 0===n?void 0:n.start)&&void 0!==a?a:S,"","");if(K(e,C))if(Y(C)){var w=Z(C,Object(b.b)(e,C.start,null!==(u=null===(i=j[_])||void 0===i?void 0:i.start)&&void 0!==u?u:S,"",""));R=Object(c.t)(w,C.chars,F)}else R=Object(c.M)(C.chars,I,F);else I=!1,R=Object(c.M)(C.chars,I,F)}else{var M=O.map((function(e){return e.chars})).join("");0===e.localeInfo.stringCompareCI(M,"_xlpm")&&_+1<j.length&&(M+="."+j[_+1].chars,_+=2);F=Object(b.b)(e,C.start,null!==(d=null===(s=j[_])||void 0===s?void 0:s.start)&&void 0!==d?d:S,"","");R=Object(c.M)(M,I,F)}for(var D=R;_+1<j.length;_+=2){var P=j[_+1],x=null!==(m=null===(h=j[_+2])||void 0===h?void 0:h.start)&&void 0!==m?m:S;D=Object(c.D)(D,P.chars,_+2>=j.length?E:I,Object(b.b)(e,C.start,x,"",""))}D.kind===c.d.CellRefNamePart&&Object(o.a)("calc.parse.pUnqualName: expected lhs.kind !== NamePartKind.CellRefNamePart");var L=Object(c.X)(D,void 0,Object(b.b)(e,C.start,S,"",""));return Object(f.f)(L,L.whole)})),be=Object(d.m)(Object(d.a)(ie,fe,oe),{node:void 0}),he=Object(d.a)(ie,Object(d.o)(Object(d.g)(fe),oe)),ve=Object(d.d)(W,(function(e,t){var r=t[0],n=t[1];return Object(d.b)(r.kind===c.g.SheetRange?Object(b.c)(r.isQuoted?be:he):r.kind===c.g.Error?Object(b.c)(be):be,(function(e,t){var a=t.node;if(null==a)return r.kind===c.g.Error?Object(c.T)(u.t,!0,r.label):Object(c.n)(c.b.Qualifier,n,r.label);var i=Object(b.d)(e,r).start,s=Object(b.d)(e,a).end;if(a.kind===c.e.Name){var l=Object(b.b)(e,i,s,"","");if((r.kind===c.g.Bad||r.kind===c.g.Error||r.kind===c.g.SheetRange)&&!Object(y.e)(y.a["OfficeVSO:3594447_NameCell_BadQual"])){var d=Object(c.n)(c.b.Qualifier,n,r.label);return Object(c.n)(c.b.Sequence,[d,a],l)}if(r.kind===c.g.Error){var f=Object(c.T)(u.t,!0,r.label);return Object(c.n)(c.b.Sequence,[f,a],l)}return Object(o.h)("calc.parse.pQualRef: sheet-range-name quoted",r.kind!==c.g.SheetRange||r.isQuoted),Object(c.X)(a.parts,r,l)}var h=Object(b.b)(e,i,s,"","");if((r.kind===c.g.Bad||r.kind===c.g.Document)&&!Object(y.e)(y.a["OfficeVSO:3594447_NameCell_BadQual"])){d=Object(c.n)(c.b.Qualifier,n,r.label);return Object(c.n)(c.b.Sequence,[d,a],h)}return r.kind===c.g.Ident&&(r=Object(c.gb)(r.name,void 0,r.isQuoted,r.label)),Object(c.u)(a.ref,r,h)}))})),pe=Object(d.b)(Object(d.a)(ie,fe),(function(e,t){return t.node.kind===c.e.CellRef&&t.node.ref.kind===c.c.Error?Object(c.T)(u.t,!0,t.node.label):t})),me=Object(d.a)(ve,pe);var ge=Object(d.s)((function(e,t){return t.kind===l.c.Literal&&t.oper.kind!==O.b.Boolean?t:t.kind===l.c.CellRef&&function(e){return e.refStyle===c.h.A1&&null==e.col&&"object"==typeof e.row&&e.row.kind===c.f.Rel}(t)?Object(l.G)(t.start,t.chars,e.mathpack.fromNumber(t.row.index+e.origin.row+1)):void 0})),Oe=Object(d.s)((function(e,t){return t.kind===l.c.Literal&&t.oper.kind===O.b.Boolean?t:void 0})),je=Object(d.b)(Object(d.u)(Object(d.a)(ge,Object(d.j)(Oe,Object(d.g)(h.n))),h.k),(function(e,t){var r=t[0],n=t[1],a=Object(b.b)(e,r.start,n,"","");if(Object(l.y)(r.oper))return Object(c.n)(c.b.NumberLiteral,r.chars,a);if(Object(l.x)(r.oper))return Object(c.n)(c.b.ErrorLiteral,r.chars,a);if(Object(m.ab)(r.oper)&&r.oper.value.length>u.f)return Object(c.n)(c.b.StringLiteral,r.chars,a);var i=Object(c.T)(r.oper,r.hasRight,a);return Object(m.z)(r.oper)?Object(f.f)(i,r.chars):i})),ye=r(0),Se=Object(d.s)((function(e,t){return t.isIdentContinue||t.kind===l.c.Spaces?t:void 0})),Ce=Object(d.b)(Object(d.l)(Se),(function(e,t){var r=t[0];return 1===t.length?r:Object(l.w)(r.start,t.map((function(e){return e.kind===l.c.Escape?"":e.chars})).join(""))})),ke=Object(d.s)((function(e,t){return t.isIdentContinue||t.kind===l.c.Spaces||t.kind===l.c.Escape||Object(h.d)(t)||Object(h.e)(t)?t:void 0})),Ee=Object(d.b)(Object(d.l)(ke),(function(e,t){var r=t[0];return 1===t.length?r:Object(l.w)(r.start,t.map((function(e){return e.kind===l.c.Escape?"":e.chars})).join(""))})),Ae=Object(d.s)((function(e,t){return t.kind===l.c.SpecialRef?t:void 0})),Ne=Object(d.b)(Object(d.u)(h.k,Ae,h.k),(function(e,t){var r=t[0],n=t[1],a=t[2];return Object(c.ib)(n.value,!1,!0,Object(b.b)(e,r,a,"",""))})),Te=Object(d.b)(Object(d.u)(h.k,h.s,Ae,Object(d.m)(h.z,void 0),h.k),(function(e,t){var r=t[0],n=(t[1],t[2]),a=t[3],i=t[4];return Object(c.ib)(n.value,!0,void 0!==a,Object(b.b)(e,r,i,"",""))})),Re=Object(d.a)(Ne,Te),Ie=Object(d.b)(Object(d.u)(h.k,Ce,h.k),(function(e,t){var r=t[0],n=t[1],a=t[2];return Object(c.y)(n.chars,!1,!0,Object(b.b)(e,r,a,"",""))})),_e=Object(d.b)(Object(d.u)(h.k,h.s,Object(d.m)(Ee,void 0),Object(d.m)(h.z,void 0),h.k),(function(e,t){var r,n=t[0],a=(t[1],t[2]),i=t[3],o=t[4];return Object(c.y)(null!==(r=null==a?void 0:a.chars)&&void 0!==r?r:"",!0,void 0!==i,Object(b.b)(e,n,o,"",""))})),Fe=Object(d.b)(Object(d.u)(h.k,Ee,h.k),(function(e,t){var r=t[0],n=t[1],a=t[2];return Object(c.y)(n.chars,!1,!0,Object(b.b)(e,r,a,"",""))})),we=Object(d.a)(Ie,_e),Me=Object(d.b)(h.k,(function(e,t){return Object(c.W)(Object(b.b)(e,t,t,"",""))})),De=Object(d.a)(we,Me),Pe=Object(d.s)((function(e,t){return"#"===t.chars?t:void 0})),xe=Object(d.b)(Object(d.l)(Pe,Se),(function(e,t){return Object(l.Y)(t[0].start,t.map((function(e){return e.chars})).join(""))})),Le=Object(d.b)(Object(d.l)(Pe,ke),(function(e,t){return Object(l.Y)(t[0].start,t.map((function(e){return e.chars})).join(""))})),Be=Object(d.b)(Object(d.u)(h.k,xe,h.k),(function(e,t){var r=t[0],n=t[1],a=t[2];return Object(c.p)(n.chars,!1,!0,Object(b.b)(e,r,a,"",""))})),Ue=Object(d.b)(Object(d.u)(h.k,h.s,Le,Object(d.m)(h.z,void 0),h.k),(function(e,t){var r=t[0],n=(t[1],t[2]),a=t[3],i=t[4];return Object(c.p)(n.chars,!0,void 0!==a,Object(b.b)(e,r,i,"",""))})),Ge=Object(d.a)(Be,Ue),Ve=Object(d.b)(Object(d.u)(h.k,De,h.x,De,h.k),(function(e,t){var r=t[0],n=t[1],a=(t[2],t[3]),i=t[4];return Object(c.eb)(n,a,Object(b.b)(e,r,i,"",""))})),He=Object(d.a)(Ve,we),We=Object(d.a)(Re,Ge,Ve,we,Me),ze=Object(d.b)(Object(d.u)(h.k,We,Object(d.l)(Object(d.u)(h.v,We)),h.k),(function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3];return Object(c.z)(Object(v.__spreadArray)([n],a.map((function(e){e[0];return e[1]})),!0),Object(b.b)(e,r,i,"",""))})),qe=Object(d.b)(Object(d.u)(h.k,h.i,Object(d.m)(He,void 0),h.k),(function(e,t){var r=t[0],n=(t[1],t[2]),a=t[3];return Object(c.lb)(n,Object(b.b)(e,r,a,"",""))})),Ke=Object(d.b)(h.D,(function(){})),Ye=Object(d.a)(Object(d.j)(Ke,h.o),Object(d.j)(Fe,h.o),Object(d.j)(ze,h.o),Object(d.j)(qe,h.o),Object(d.j)(Ve,h.o),Object(d.j)(Re,h.o),Object(d.j)(Ge,h.o),Object(d.j)(_e,h.o)),Je=Object(d.c)(Object(d.u)(h.k,h.j,h.k),(function(e,t){var r=t[0],n=t[1],a=n[0],i=n[1],o=t[2],u=Object(d.p)(Ye,a,0,e);return Object(ye.d)(u)?Object(f.h)(Object(c.jb)(u.value.output,i,Object(b.b)(e,r,o,"","")),r,o):void 0})),Qe=r(112),Xe=g.n;var Ze=Object(d.b)(Object(d.l)(Object(d.s)((function(e,t){return t.isIdentContinue||Object(h.b)(t)?t:void 0}))),(function(e,t){var r=t[0].start,n=t.map((function(e){return e.chars})).join(""),a=Object(b.b)(e,r,r+n.length,"","");if(!function(e,t){if(!e.localeInfo.isIdentStart(Object(z.i)(t,0)))return!1;if(!Object(z.b)(t).every((function(t){return t===Xe||e.localeInfo.isIdentContinue(t)})))return!1;var r=Object(p.c)(e.localeInfo,e.refStyle,e.origin,t,0);if(void 0!==r&&r.i===t.length){var n=r.refStyle===c.h.A1?Object(l.k)(0,t,r.row,r.col):Object(l.l)(0,t,r.row,r.col,r.enLocale);if(J(e,n))return!1}return!0}(e,n))return Object(c.n)(c.b.ParamName,n,a);var i=Object(b.b)(e,r,r+n.length,"","");return Object(c.X)(Object(c.M)(n,void 0,i),void 0,a)})),$e=Object(d.c)(Object(d.u)(h.k,h.s,h.k,h.D,Object(d.m)(Ze,void 0),h.D,h.k,Object(d.m)(h.z,void 0),h.k),(function(e,t){var r=t[0],n=(t[1],t[2]),a=t[3],i=t[4],o=t[5],u=t[6],s=t[7],l=t[8];if(void 0!==i){var d=Object(b.d)(e,i);d.pre=a,d.post=o}var f=null!=i?i:Object(c.n)(c.b.Missing,a+o,Object(b.b)(e,n,u,"",""));return Object(c.ab)(f,!0,void 0!==s,Object(b.b)(e,r,l,"",""))})),et=Object(d.i)((function(){return Object(y.e)(y.a.CalcLambdaOptionalParameters)?$e:Object(d.f)()})),tt=Object(d.c)(Object(d.u)(h.k,me,h.k),(function(e,t){var r=t[0],n=t[1],a=t[2],i=n.kind===f.a.MaybeWSFTerm?n.node:n;if(Object(m.bb)(i))return Object(c.ab)(i,!1,!0,Object(b.b)(e,r,a,"",""))})),rt=Object(d.b)(Object(d.u)(h.D,h.k,h.h,h.D,Object(d.i)((function(){return St})),h.k),(function(e,t){var r=t[0],n=t[1],a=(t[2],t[3]),i=t[4],o=t[5];return Object(b.d)(e,i).pre=a,Object(c.Z)(i,Object(b.b)(e,n,o,r,""))})),nt=Object(d.i)((function(){return Object(y.e)(y.a.CalcLambdaDefaultParameters)?rt:Object(d.f)()})),at=Object(d.c)(Object(d.u)(h.D,h.k,Object(d.d)(Object(d.a)(tt,et),(function(e,t){return t.isClosed?Object(d.b)(Object(d.m)(nt,void 0),(function(e,r){return[t,r]})):Object(d.q)([t,void 0])})),h.k,h.D,Object(d.n)((function(e,t){return t}))),(function(e,t){var r=t[0],n=t[1],a=t[2],i=a[0],o=a[1],u=t[3],s=t[4],d=t[5];if(void 0!==o||d.kind===l.c.End&&i.isBracketed||Object(h.d)(d)&&i.isClosed)return Object(c.bb)(i,o,Object(b.b)(e,n,u,r,s))})),it=Object(d.b)(Object(d.u)(h.D,Object(d.i)((function(){return St})),h.D),(function(e,t){var r=t[0],n=t[1],a=t[2],i=Object(b.d)(e,n);return i.pre=r,i.post=a,n})),ot=Object(d.b)(Object(d.u)(h.t,Object(b.f)({delimId:l.a.Paren,listSep:b.a.Union},it),Object(d.m)(h.A,void 0),h.k),(function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3];return Object(c.cb)(n,void 0!==a,Object(b.b)(e,r.start,i,"",""))})),ct=Object(d.l)(it,Object(d.o)(h.l,it)),ut=Object(d.l)(ct,Object(d.o)(h.C,ct)),st=Object(d.b)(Object(d.u)(h.r,Object(b.f)({delimId:l.a.Brace,listSep:b.a.Union},ut),Object(d.m)(h.y,void 0),h.k),(function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3];return Object(c.m)(n,void 0!==a,Object(b.b)(e,r.start,i,"",""))}));function lt(e){return Object(d.t)((function(t,r,n){return e(r)?Object(c.n)(c.b.Unexpected,r.chars,Object(b.b)(t,r.start,n.start,"","")):void 0}))}var dt=Object(d.b)(Object(d.u)(h.k,lt(h.c),Object(b.f)({delimId:l.a.Bracket,listSep:b.a.Union},it),Object(d.m)(lt(h.g),void 0),h.k),(function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],o=t[4],u=[n,a];return null!=i&&u.push(i),Object(c.n)(c.b.Sequence,u,Object(b.b)(e,r,o,"",""))})),ft=Object(d.t)((function(e,t,r){switch(t.kind){case l.c.End:case l.c.Operator:case l.c.Spaces:return;case l.c.Sep:if(t.value===l.b.Dot)return;if(t.value===l.b.Qual||t.value===l.b.Assign)break;if(e.delim.delimId===l.a.Brace||t.value!==l.b.Col&&t.value!==l.b.Row)return;break;case l.c.Right:if(t.value===e.delim.delimId)return}return Object(c.n)(c.b.Unexpected,t.chars,Object(b.b)(e,t.start,r.start,"",""))})),bt=Object(d.a)(me,je,ot,st,q.b,Je,dt,oe,ft);function ht(e){return Object(d.u)(h.t,Object(b.f)({delimId:l.a.Paren,listSep:b.a.Arg},Object(d.l)(e,Object(d.o)(h.v,e))),Object(d.m)(h.A,void 0),h.k)}var vt=Object(d.b)(ht(it),(function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3];return Object(f.b)(n,void 0!==a,r.start,i)})),pt=Object(d.b)(ht(Object(d.a)(Object(d.i)((function(){return at})),it)),(function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3];return Object(f.e)(n,void 0!==a,r.start,i)})),mt=Object(d.s)((function(e,t){return t.kind!==l.c.Operator||t.value!==s.a.Percent&&t.value!==s.a.Pound?void 0:t}));var gt=Object(d.s)((function(e,t){return t.kind===l.c.Operator||Object(h.b)(t)?t:function(e,t){return t.kind===l.c.Sep&&t.value===l.b.List&&e.delim.listSep===b.a.Union?Object(l.K)(t.start,e.localeInfo.listSeparator,s.a.Union):void 0}(e,t)})),Ot=Object(d.s)((function(e,t){return t.kind===l.c.Spaces?t:void 0})),jt=Object(d.a)(Object(d.e)(Object(d.d)(Object(d.a)(bt,mt),(function(e,t){var r=Object(f.d)(e.localeInfo,t);return(null==r?void 0:r.id)===s.b.LAMBDA?Object(d.e)(Object(d.q)([t]),Object(d.m)(Object(d.u)(pt),[])):Object(d.q)([t])})),Object(d.k)(Object(d.a)(vt,q.b,Je))),Object(d.u)(gt)),yt=Object(d.h)(Object(d.l)(jt,Object(d.e)(Object(d.m)(Object(d.u)(Ot),[]),jt))),St=Object(d.b)(Object(d.u)(Object(d.m)(yt,void 0),h.k),(function(e,t){var r=t[0],n=t[1];if(null==r){var a=Object(b.b)(e,n,n,"","");return Object(c.T)(u.l,!0,a)}var i=r;return i.push(Object(l.q)(n)),Object(f.g)(e,i)}));var Ct=r(56);r.d(t,"a",(function(){return At}));var kt={"=":1,"+":0,"-":0,"@":-1};function Et(e,t,r){var u,s,f,h;try{var v=r[0],p=null!=v?kt[v]:void 0;if(null==p)return Object(ye.c)(Object(Ct.c)("first character is not '=', '+', '-' or '@'"));if(p<0)return Object(ye.c)(Object(m.hb)(["Lotus 1-2-3 syntax"]));var g=null!==(s=null===(u=t.config)||void 0===u?void 0:u.localeInfo)&&void 0!==s?s:e.config.localeInfo,O=null!==(h=null===(f=t.config)||void 0===f?void 0:f.refStyle)&&void 0!==h?h:e.config.refStyle,j=e.config.mathpack,y=Object(n.a)(g,j,O,t.originGridCell.value,r,p),S=function(e,t,r,n,u,s){var f=s.length-1;if(f<0){var h="calc.parse.runTokenParser: internal error: expected at least 1 token";return o.i.ULS.assertTag(589825167,a.LogCategory.msoulscat_ES_EWAJS,!1,h)}if(s[f].kind!==l.c.End){h="calc.parse.runTokenParser: internal error: array[n] !== End in ".concat(Object(i.a)(s));return o.i.ULS.assertTag(589825168,a.LogCategory.msoulscat_ES_EWAJS,!1,h)}var v=Object(b.e)(e,t,r,n,u),p=Object(d.p)(it,s,0,v);if(!Object(ye.d)(p)||p.value.index<f){var m=Object(ye.d)(p)?p.value.index:0;h="calc.parse.runTokenParser: internal error: consumed ".concat(m," out of ").concat(f," in ").concat(Object(i.a)(s));return o.i.ULS.assertTag(589825169,a.LogCategory.msoulscat_ES_EWAJS,!1,h)}var g=p.value.output,O=v.spans,j=Object(Qe.a)(e,g);return Object(c.I)(g,O,j)}(g,j,O,t.lexicalKind,t.originGridCell.value,y);return Object(ye.f)(S)}catch(e){return Object(ye.c)(Object(ye.e)(e))}}function At(e){return{parseFormula:function(t,r){return Et(e,t,r)}}}},function(e,t,r){"use strict";r.d(t,"d",(function(){return d})),r.d(t,"b",(function(){return f})),r.d(t,"e",(function(){return b})),r.d(t,"c",(function(){return h})),r.d(t,"a",(function(){return v})),r.d(t,"f",(function(){return p}));var n=r(3),a=r(6),i=r(11),o=r(0),c=r(5),u=r(90),s=r(48),l={getKnownFormat:function(){return Object(c.a)("calc.numfmt: default getKnownFormat")},getIformat:function(){return Object(c.a)("calc.numfmt: default getIformat")},getFormatString:function(){return Object(c.a)("calc.numfmt: default getFormatString")}};function d(e){var t,r,n,a,i,o;return{config:e.config,getKnownFormat:null!==(r=null===(t=e.getKnownFormat)||void 0===t?void 0:t.bind(e))&&void 0!==r?r:l.getKnownFormat,getIformat:null!==(a=null===(n=e.getIformat)||void 0===n?void 0:n.bind(e))&&void 0!==a?a:l.getIformat,getFormatString:null!==(o=null===(i=e.getFormatString)||void 0===i?void 0:i.bind(e))&&void 0!==o?o:l.getFormatString}}function f(e,t,r,n,i){var c=t.getFormatString(r,n);if(!Object(o.d)(c))return c;if(void 0!==c.value)return t.getIformat(r,c.value);var u=e.createFormat(n,i);return Object(o.d)(u)?u:u.reason.kind===a.g.NotFormatString?Object(o.c)(Object(a.H)()):Object(o.c)(u.reason)}function b(e,t,r){var i=Object(n.ab)(r)?a.c.None:a.c.All,c=t.apply(r,a.a.Right,i,!0);if(!Object(o.d)(c))return c;var u=e.renderValue(c.value,a.J);return Object(o.d)(u)?Object(a.z)(u.value)?Object(o.f)(u.value.units):Object(o.f)(Object(a.L)(u.value)):u}function h(e){return e.value.kind}function v(e,t,r,n){var c=r;if(n.kind===a.e.Number&&n.format!==i.d.General){var l=n.format,d="string"==typeof l?l:Object(s.h)(t,l),f="string"!=typeof l,b=e.createFormat(d,f);if(!Object(o.d)(b))return b;var h=b.value;Object(u.b)(h,r)&&(c=h)}return e.applyFormat(c,n.value,!0)}function p(e,t,r){var n=t.parseGeneral(r,!1,!0,a.j.NonVolatile);return Object(o.d)(n)?null==n.value?Object(o.c)(null):Object(o.f)(e.toNumber(n.value.value)):n}},function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return s}));var n,a=r(9),i=r(4),o=r(11),c=r(48);function u(e,t){return Object(c.f)(e,i.g.ColorStart,"$-",t,i.g.ColorEnd)}function s(e,t,r){var s,l,d=(null!==(l=null===(s=null==r?void 0:r.culture)||void 0===s?void 0:s.calendar)&&void 0!==l?l:o.a.Gregorian)===o.a.Gregorian;switch(t){case n.GalleryGeneral:case n.KeyboardGeneral:return Object(c.h)(e,o.d.General);case n.GalleryNumber:return Object(c.c)(e,!1,1,e.currencyDecimals);case n.KeyboardNumber:return Object(c.c)(e,!0,4,e.currencyDecimals);case n.GalleryCurrency:var f=Object(a.__assign)(Object(a.__assign)({},e),{currencyFormat:e.currencyFormat===o.b.Paren?o.b.Lead:e.currencyFormat});return Object(c.a)(f,!1,e.currencyDecimals,!0,!1,void 0,!0);case n.KeyboardCurrency:return Object(c.a)(e,!0,e.currencyDecimals,!0,!1);case n.GalleryAccounting:case n.ButtonAccounting:return Object(c.a)(e,!1,e.currencyDecimals,!0,!0);case n.GalleryShortDate:return d?Object(c.h)(e,o.d.MMDDYY):Object(c.f)(e,i.g.Month,i.g.DateSep,i.g.Day,i.g.Sep,i.g.Text);case n.GalleryLongDate:return d?u(e,"x-sysdate")+Object(c.f)(e,i.g.Day,i.g.Day,i.g.Day,i.g.Day,", ",i.g.Month,i.g.Month,i.g.Month,i.g.Month," ",i.g.Day,i.g.Day,", ",i.g.Year,i.g.Year,i.g.Year,i.g.Year):Object(c.f)(e,i.g.Month,i.g.DateSep,i.g.Day,i.g.DateSep,i.g.Year,i.g.Year,i.g.Sep,i.g.Text);case n.GalleryTime:return u(e,"x-systime")+Object(c.f)(e,i.g.Hour,i.g.Colon,i.g.Minute,i.g.Minute,i.g.Colon,i.g.Second,i.g.Second," ")+Object(c.i)(e,i.h.AP1);case n.KeyboardDate:return u(e,"en-US")+Object(c.f)(e,i.g.Day,"-",i.g.Month,i.g.Month,i.g.Month,"-",i.g.Year,i.g.Year,i.g.Sep,i.g.Text);case n.KeyboardTime:return u(e,"en-US")+Object(c.f)(e,i.g.Hour,i.g.Colon,i.g.Minute,i.g.Minute," ",Object(c.i)(e,i.h.AP1),i.g.Sep,i.g.Text);case n.GalleryPercentage:return Object(c.d)(e,e.currencyDecimals);case n.ButtonPercentage:case n.KeyboardPercentage:return Object(c.h)(e,o.d.Pct0);case n.GalleryFraction:return Object(c.h)(e,o.d.Fract);case n.GalleryScientific:case n.KeyboardScientific:return Object(c.e)(e,1,e.currencyDecimals,2);case n.GalleryText:return Object(c.h)(e,o.d.Text);case n.ButtonComma:return Object(c.a)(e,!1,e.currencyDecimals,!1,!0)}}!function(e){e.GalleryGeneral="GalleryGeneral",e.GalleryNumber="GalleryNumber",e.GalleryCurrency="GalleryCurrency",e.GalleryAccounting="GalleryAccounting",e.GalleryShortDate="GalleryShortDate",e.GalleryLongDate="GalleryLongDate",e.GalleryTime="GalleryTime",e.GalleryPercentage="GalleryPercentage",e.GalleryFraction="GalleryFraction",e.GalleryScientific="GalleryScientific",e.GalleryText="GalleryText",e.ButtonComma="ButtonComma",e.ButtonPercentage="ButtonPercentage",e.ButtonAccounting="ButtonAccounting",e.KeyboardGeneral="KeyboardGeneral",e.KeyboardNumber="KeyboardNumber",e.KeyboardCurrency="KeyboardCurrency",e.KeyboardDate="KeyboardDate",e.KeyboardTime="KeyboardTime",e.KeyboardPercentage="KeyboardPercentage",e.KeyboardScientific="KeyboardScientific"}(n||(n={}))},function(e,t,r){"use strict";var n=r(9),a=r(5),i=r(10),o=r(37),c=r(54),u=r(3),s=r(8),l=r(2),d=r(7),f=r(1),b=r(0),h=r(12),v=r(22),p={};function m(e,t){return{context:e,result:t}}function g(e){return function(t){return t.kind===l.e.Literal&&e(t.oper)}}var O=g(u.J),j=g(u.M),y=s.b.String|s.b.Boolean|s.b.Error,S=g((function(e){return 0!=(e.kind&y)}));function C(e,t,r,n){void 0===n&&(n=!1),n||(e.errorData=e.reportError(t,r,e.errorData))}function k(e,t){return t!==s.b.Range||0!=(e&s.b.Range)}function E(e,t){if(t.kind===l.e.Literal)switch(C(e,t,o.baseErrors.Unclosed_literal,t.isClosed),t.oper.kind){case s.b.Number:case s.b.Boolean:case s.b.String:case s.b.Error:return;default:return void C(e,t,o.baseErrors.Illegal_array_literal_element)}C(e,t,o.baseErrors.Illegal_array_literal_element)}function A(e,t,r,n){return v.a.try((function(){if(e.earlyExit&&!e.isOk())throw p;switch(t.kind){case l.e.Paren:return C(e,t,o.baseErrors.Unclosed_paren,t.isClosed),C(e,t,o.baseErrors.Empty_parenthesis,!O(t.node)),A(e,t.node,r,n);case l.e.Bad:case l.e.Array:case l.e.Name:case l.e.CellRef:case l.e.FieldRef:case l.e.StructRef:case l.e.App:case l.e.Let:case l.e.Lambda:case l.e.Literal:return _(e,t).bind((function(i){return k(i.result,r)||(Object(a.h)("calc.analyze.checker.check: typeSource passed",void 0!==n),C(e,t,{kind:o.TypeError.Types_not_related,typeGiven:i.result,typeExpected:r,typeSource:n})),i.result=r,i}));default:return Object(a.e)("calc.analyze.checker.check: unhandled formula case",t)}}))}function N(e,t,r){if(Object(u.bb)(r)&&r.parts.kind===l.d.IdentNamePart){var n=Object(u.h)(e.localeInfo,r.whole);return C(e,r,o.baseErrors.Invalid_binder,n.indexOf(".")<0&&!t.contains(n)),t.setValue(n,!0)}return C(e,r,r.kind===l.e.Bad&&r.type===l.b.Missing?o.baseErrors.Missing_binder:o.baseErrors.Invalid_binder),t}var T=function(e){return 0===e.args.length?e:e.args[e.args.length-1]};function R(e,t,r){return v.a.try((function(){var d,b=Object(f.e)(t),p=b.minArgs,g=b.maxArgs,O=b.headTypes,j=b.restTypes,y=b.tailTypes,S=b.flags,k=r.args,E=k.length,R=Object(u.g)(r).length;if(C(e,r.head,o.baseErrors.Invalid_name,0==(S&s.a.OnlyParsedDuringLoad)||e.locals.workbookLoad),R<p)switch(t){case f.b.IF:case f.b.LET:case f.b.LETREC:case f.b.LAMBDA:break;default:var I=k[E-1];C(e,void 0===I?r:I,{kind:o.TypeError.Insufficient_function_arguments,funcId:t,numArgsGiven:R,numArgsExpected:p})}if(R>g){var F=k[E-1];C(e,void 0===F?r:F,{kind:o.TypeError.Excess_function_arguments,funcId:t,numArgsGiven:R,numArgsExpected:g})}else if(j.length>1&&R>O.length+j.length){var w=(R-O.length)%j.length;w>y.length&&C(e,T(r),{kind:o.TypeError.Insufficient_function_arguments,funcId:t,numArgsGiven:R,numArgsExpected:R+(j.length-w)})}var M=r.kind===l.e.App?Object(u.g)(r).map((function(r,n){return A(e,r,Object(u.f)(b,n,R),{kind:o.TypeSourceKind.WSFArgument,head:t,argIndex:n,numArgsGiven:R})})):Object(n.__spreadArray)(Object(n.__spreadArray)([],r.kind===l.e.Let?r.vars.map((function(e){return e.binder.arg})):r.params.map((function(e){var t;return null===(t=e.name.arg.def)||void 0===t?void 0:t.rhs})),!0),[null===(d=r.body)||void 0===d?void 0:d.arg],!1).filter(i.e).map((function(t){return _(e,t)}));return v.a.all(M).bind((function(n){return e.specialDependencies|=b.staticPrecs,function(e,t,r){var n=Object(u.g)(r).length;switch(t){case f.b.IF:var s=e.locals.lexicalKind===h.a.NameManager?1:2;return void(n<s&&C(e,T(r),{kind:o.TypeError.Insufficient_function_arguments,funcId:t,numArgsGiven:n,numArgsExpected:s}));case f.b._UDF:return C(e,r,o.baseErrors.Unexpected_application_head);case f.b.LET:case f.b.LETREC:Object(a.h)("calc.analyze.applySpecificWorksheetFunctionChecks",r.kind===l.e.Let);for(var d=c.a.create(e.localeInfo.stringCompareCI),b=0,v=r.vars;b<v.length;b++){d=N(e,d,v[b].name.arg)}for(var p=0,m=r.badArgs;p<m.length;p++){C(e,m[p].arg,o.baseErrors.Invalid_binder)}C(e,T(r),{kind:o.TypeError.Insufficient_function_arguments,funcId:t,numArgsGiven:n,numArgsExpected:Object(i.b)(3,n+1+n%2)},n>=3&&void 0!==r.body);break;case f.b.LAMBDA:Object(a.h)("calc.analyze.applySpecificWorksheetFunctionChecks",r.kind===l.e.Lambda);d=c.a.create(e.localeInfo.stringCompareCI);for(var g=!1,O=0,j=r.params;O<j.length;O++){var y=j[O].name;C(e,y.arg.name,o.baseErrors.Unclosed_bracket,y.arg.name.isClosed),void 0!==y.arg.def&&(C(e,y.arg.name,o.baseErrors.Binder_requires_brackets,y.arg.name.isBracketed),C(e,y.arg.def.rhs,o.baseErrors.Missing_default_expression,!Object(u.I)(y.arg.def.rhs))),y.arg.isOptional?g=!0:C(e,y.arg,o.baseErrors.Mandatory_binder_after_optional,!g),d=N(e,d,y.arg.name.name)}for(var S=0,k=r.badArgs;S<k.length;S++){C(e,k[S].arg,o.baseErrors.Invalid_binder)}C(e,T(r),{kind:o.TypeError.Insufficient_function_arguments,funcId:t,numArgsGiven:n,numArgsExpected:n+1},n>=1&&void 0!==r.body),void 0!==r.body&&C(e,r.body.arg,o.baseErrors.Invalid_body,0===n||!Object(u.I)(r.body.arg))}}(e,t,r),m(e,b.returnType)}))}))}function I(e,t){return v.a.try((function(){if(C(e,t,o.baseErrors.Unclosed_application,t.isClosed),Object(u.db)(t.head))return R(e,t.head.id,t);var r=t,n=r.args,a=n.length,i=Object(u.g)(r).length;if(Object(u.N)(t.head))return function(e,t,r){return v.a.try((function(){var n=Object(f.c)(t.id),a=r.length,i=a===n.minArgs;return C(e,t,{kind:o.TypeError.Incorrect_number_of_operator_arguments,opId:t.id},i),v.a.all(r.map((function(r,c){return v.a.try((function(){return O(r)&&(i=!1,C(e,r,{kind:o.SyntaxError.Missing_operation_argument,opId:t.id})),A(e,r,Object(u.f)(n,c,a),{kind:o.TypeSourceKind.OperatorArgument,head:t.id,argIndex:c,numArgsGiven:a})}))}))).bind((function(t){return i?(e.specialDependencies|=n.staticPrecs,m(e,n.returnType)):m(e,s.c.All)}))}))}(e,t.head,n);var c=t.head,d=n[a-1],b=Object(f.f)().maxArgs-1;return i>b&&C(e,void 0===d?t:d,{kind:o.SyntaxError.Excess_higher_order_function_arguments,numArgsGiven:i,numArgsExpected:b}),v.a.all(n.map((function(t){return A(e,t,s.c.All,void 0)}))).bind((function(t){return _(e,c).bind((function(t){return k(t.result,s.b.Range)||0!=(t.result&(s.b.Array|s.b.Rich))||C(e,c,S(c)||c.kind===l.e.Array?o.baseErrors.Unexpected_application_head:o.baseErrors.Unexpected_application_head_with_fix),m(e,s.c.All)}))}))}))}function _(e,t){return v.a.try((function(){var r,n,i,c,f,b,h,g,y,S;if(e.earlyExit&&!e.isOk())throw p;switch(t.kind){case l.e.App:case l.e.Let:case l.e.Lambda:return I(e,t);case l.e.Array:return function(e,t){return v.a.try((function(){C(e,t,o.baseErrors.Unclosed_array,t.isClosed);var r=t.nodes.length>0&&!(1===t.nodes.length&&1===t.nodes[0].length&&Object(u.I)(t.nodes[0][0]));if(C(e,t,o.baseErrors.Empty_array_literal,r),!r)return m(e,s.b.Array);for(var n=t.nodes[0].length,a=0;a<t.nodes.length;a+=1){var i=t.nodes[a],c=i.length;C(e,t,o.baseErrors.Irregular_array_shape,c===n);for(var l=0;l<c;l+=1)E(e,i[l])}return m(e,s.b.Array)}))}(e,t);case l.e.Bad:return function e(t,r){return v.a.try((function(){switch(r.type){case l.b.Sequence:return C(t,r,o.baseErrors.Bad_node,r.contents.some((function(e){return e.kind===l.e.Bad}))),v.a.all(r.contents.map((function(r){return r.kind===l.e.Bad?e(t,r):_(t,r)})));case l.b.StructRef:return C(t,r,o.baseErrors.Invalid_struct_ref_table_name);case l.b.FieldRef:return C(t,r,o.baseErrors.Unexpected_field_ref);case l.b.Unexpected:switch(r.contents){case")":return C(t,r,o.baseErrors.Unexpected_closing_paren);case t.localeInfo.rightBrace:return C(t,r,o.baseErrors.Unexpected_closing_brace);case t.localeInfo.rightBracket:return C(t,r,o.baseErrors.Unexpected_closing_bracket);case".":return C(t,r,o.baseErrors.Unexpected_dot);default:return C(t,r,{kind:o.SyntaxError.Unexpected_character,text:r.contents})}case l.b.NumberLiteral:return C(t,r,o.baseErrors.Invalid_number_literal);case l.b.StringLiteral:return C(t,r,o.baseErrors.Invalid_string_literal);case l.b.ErrorLiteral:return C(t,r,o.baseErrors.Invalid_error_literal);case l.b.FieldName:case l.b.ParamName:case l.b.Missing:return C(t,r,o.baseErrors.Bad_node);case l.b.Qualifier:return C(t,r,o.baseErrors.Invalid_qualifier);default:Object(a.e)("calc.analyze.diagnoseBadNode",r)}}))}(e,t).bind((function(){return m(e,s.c.All)}));case l.e.CellRef:return e.locals.allowRelativeQualifier||(null===(r=t.qualifier)||void 0===r?void 0:r.kind)!==l.g.Relative?e.locals.allowUnqualifiedCell||void 0!==t.qualifier?(null===(n=t.qualifier)||void 0===n?void 0:n.kind)===l.g.Document||(null===(i=t.qualifier)||void 0===i?void 0:i.kind)===l.g.Bad?(C(e,t,o.baseErrors.Invalid_qualifier),m(e,s.c.All)):t.ref.kind===l.c.Bad?(C(e,t,o.baseErrors.Invalid_cell_ref),m(e,s.c.All)):m(e,s.b.Range):(C(e,t,o.baseErrors.Invalid_unqualified_cell),m(e,s.c.All)):(C(e,t,o.baseErrors.Invalid_rel_sheet_qualifier_in_cell),m(e,s.c.All));case l.e.Literal:return C(e,t,o.baseErrors.Unclosed_literal,t.isClosed),m(e,t.oper.kind|(Object(u.E)(t.oper)&&t.oper.type===d.a.REF?s.b.Range:0));case l.e.Name:if(!e.locals.allowRelativeQualifier&&(null===(c=t.qualifier)||void 0===c?void 0:c.kind)===l.g.Relative)return C(e,t,o.baseErrors.Invalid_rel_sheet_qualifier_in_name),m(e,s.c.All);if(!e.locals.workbookLoad&&(null===(f=t.qualifier)||void 0===f?void 0:f.kind)===l.g.Document&&!t.qualifier.isQuoted)return C(e,t,o.baseErrors.Invalid_qualifier),m(e,s.c.All);if((null===(b=t.qualifier)||void 0===b?void 0:b.kind)===l.g.SheetRange||(null===(h=t.qualifier)||void 0===h?void 0:h.kind)===l.g.Bad)return C(e,t,o.baseErrors.Invalid_qualifier),m(e,s.c.All);var k=Object(l.H)(t.parts).parts;return C(e,t,o.baseErrors.Invalid_name,(null===(g=e.annotations[k[0].label])||void 0===g?void 0:g.kind)===l.a.LocalNameUse||(null===(y=e.annotations[t.label])||void 0===y?void 0:y.kind)===l.a.LocalNameDecl||k.some((function(e){return e.canDenoteNamedObject}))),m(e,s.c.All);case l.e.Paren:return C(e,t,o.baseErrors.Unclosed_paren,t.isClosed),C(e,t,o.baseErrors.Empty_parenthesis,!O(t.node)),_(e,t.node);case l.e.FieldRef:return C(e,t,o.baseErrors.Unclosed_bracket,t.rhs.isClosed),C(e,t,o.baseErrors.Unexpected_field_ref,!O(t.lhs)&&!j(t.lhs)),Object(u.bb)(t.rhs.field)||C(e,t.rhs.field,t.rhs.field.kind===l.e.Bad&&t.rhs.field.type===l.b.Missing?o.baseErrors.Missing_field_name:o.baseErrors.Invalid_field_name),_(e,t.lhs).bind((function(t){return m(e,s.c.All)}));case l.e.StructRef:if(C(e,t,o.baseErrors.Invalid_struct_ref_table_name,void 0===t.lhs&&e.locals.allowImplicitTable||(null===(S=t.lhs)||void 0===S?void 0:S.kind)===l.e.Name&&t.lhs.parts.kind===l.d.IdentNamePart&&t.lhs.parts.canDenoteNamedObject),void 0===t.rhs.innerRef);else{C(e,t.rhs.innerRef,o.baseErrors.Invalid_struct_ref_comma_parts,t.rhs.innerRef.kind!==l.j.CommaOpRef||Object(u.C)(t.rhs.innerRef));var A=function(t){switch(null==t?void 0:t.kind){case void 0:break;case l.j.RangeOpRef:A(t.lhs),A(t.rhs);break;case l.j.CommaOpRef:t.refs.forEach(A);break;case l.j.SpecialRef:case l.j.ColumnRef:C(e,t,o.baseErrors.Unclosed_bracket,t.isClosed);break;case l.j.ThisRowOpRef:A(t.ref);break;case l.j.MissingRef:C(e,t,o.baseErrors.Invalid_struct_ref_missing_part);break;case l.j.BadRef:C(e,t,o.baseErrors.Unclosed_bracket,t.isClosed),C(e,t,o.baseErrors.Invalid_struct_ref_bad_part)}};A(t.rhs.innerRef)}return C(e,t,o.baseErrors.Unclosed_bracket,t.rhs.isClosed),(void 0===t.lhs?v.a.resolve(void 0):_(e,t.lhs)).bind((function(t){return m(e,s.c.All)}));default:return Object(a.e)("calc.analyze.checker.infer: unhandled formula case",t)}}))}var F={ok:!0,isOk:i.d,collect:function(e,t,r){return!1}};function w(e,t,r,n,a){var i,o,c=r.annotations;void 0===a&&(a=!0);var u={globals:e,locals:t,localeInfo:null!==(o=null===(i=t.config)||void 0===i?void 0:i.localeInfo)&&void 0!==o?o:e.config.localeInfo,annotations:c,reportError:n.collect,isOk:function(){return n.isOk(u.errorData)},earlyExit:a,specialDependencies:s.d.None,errorData:n.ok};return u}function M(e,t){try{return C(e,t.node,o.baseErrors.Empty_formula,!O(t.node)),v.a.settleOrThrow(A(e,t.node,s.c.All,void 0))}catch(t){if(t===p)return m(e,s.c.All);throw t}}function D(e,t,r){try{return Object(b.f)(function(e,t,r){var a=M(w(e,t,r,F),r).context.errorData;return Object(n.__assign)(Object(n.__assign)({},r),{isWellFormed:a})}(e,t,r))}catch(e){return Object(b.c)(Object(b.e)(e))}}var P=r(29),x=r(19),L=r(71),B={getDocumentLoc:function(){return Object(a.a)("calc.analyze.autocorrectFormula: default getDocumentLoc")},getSheetIndex:function(){return Object(a.a)("calc.analyze.autocorrectFormula: default getSheetIndex")},getSheetName:function(){return Object(a.a)("calc.analyze.autocorrectFormula: default getSheetName")},getNameLoc:function(){return Object(a.a)("calc.analyze.autocorrectFormula: default getNameLoc")},getUserDefinedFuncLoc:function(){return Object(a.a)("calc.analyze.autocorrectFormula: default getUserDefinedFuncLoc")},getSheetRangeIndexes:function(){return Object(a.a)("calc.analyze.autocorrectFormula: default getSheetRangeIndexes")},getContainingTable:function(){return Object(a.a)("calc.analyze.autocorrectFormula: default getContainingTable")},getStructRefColumn:function(){return Object(a.a)("calc.analyze.autocorrectFormula: default getStructRefColumn")},getStructRefSpecialRef:function(){return Object(a.a)("calc.analyze.autocorrectFormula: default getStructRefSpecialRef")}};var U=Object(u.c)("AutocorrectError"),G=Object(n.__assign)(Object(n.__assign)({},Object(P.h)(Object(P.j)(!1),(function(e,t){return e||t}))),{badSequenceNode:function(e,t,r){return!0},badStringNode:function(e,t,r){return!0}}),V=function(e){function t(t,r,n){var a=e.call(this)||this;return a.f=n,a.seenUnclosed=!1,a.seenParen=!1,a.seenMissingOperand=!1,a.globals=function(e){var t,r,n,a,i,o,c,u,s,l,d,f,b,h,v,p,m,g;return{config:e.config,getDocumentLoc:null!==(r=null===(t=e.getDocumentLoc)||void 0===t?void 0:t.bind(e))&&void 0!==r?r:B.getDocumentLoc,getSheetIndex:null!==(a=null===(n=e.getSheetIndex)||void 0===n?void 0:n.bind(e))&&void 0!==a?a:B.getSheetIndex,getSheetName:null!==(o=null===(i=e.getSheetName)||void 0===i?void 0:i.bind(e))&&void 0!==o?o:B.getSheetName,getNameLoc:null!==(u=null===(c=e.getNameLoc)||void 0===c?void 0:c.bind(e))&&void 0!==u?u:B.getNameLoc,getUserDefinedFuncLoc:null!==(l=null===(s=e.getUserDefinedFuncLoc)||void 0===s?void 0:s.bind(e))&&void 0!==l?l:B.getUserDefinedFuncLoc,getSheetRangeIndexes:null!==(f=null===(d=e.getSheetRangeIndexes)||void 0===d?void 0:d.bind(e))&&void 0!==f?f:B.getSheetRangeIndexes,getContainingTable:null!==(h=null===(b=e.getContainingTable)||void 0===b?void 0:b.bind(e))&&void 0!==h?h:B.getContainingTable,getStructRefColumn:null!==(p=null===(v=e.getStructRefColumn)||void 0===v?void 0:v.bind(e))&&void 0!==p?p:B.getStructRefColumn,getStructRefSpecialRef:null!==(g=null===(m=e.getStructRefSpecialRef)||void 0===m?void 0:m.bind(e))&&void 0!==g?g:B.getStructRefSpecialRef}}(t),a.locals=r,a.resolver=Object(L.a)(a.globals),a}return Object(n.__extends)(t,e),t.prototype.autocorrect=function(){return Object(P.m)(G,this.f)?this.f.node:Object(P.m)(this,this.f)},t.prototype.literalNode=function(e,t,r){return t||(this.seenUnclosed=!0),Object(l.T)(e,t,r)},t.prototype.nameNode=function(e,t,r){var n=Object(l.X)(e,t,r),i=Object(l.H)(e);if(i.kind===l.d.CellRefNamePart){var o=this.resolver.resolveDottedName(this.locals,n,this.f.annotations).resolved;if(o.kind===x.e.ResolvedCellRef){var c=o.node,u=c.ref,s=c.qualifier,d=c.label,f=this.cellRefNode(u,s,d).ref;Object(a.h)("calc.analyze.autocorrectFormula",i.kind===l.d.CellRefNamePart);var h=i.parts,v=h[0],p=h[1],m=h.slice(2),g=function(e,t){var r=t.rhs,n=t.canDenoteNamedObject,a=t.label;return Object(l.D)(e,r,n,a)};return Object(l.X)(m.reduce(g,g(Object(l.t)(f,v.asWhole,v.label),p)),t,d)}if(o.resolution.kind!==b.b.Success&&o.resolution.reason.kind!==x.d.NoOriginSheet&&o.resolution.reason.kind!==x.d.InvalidQualifier)throw new U(o.resolution.reason)}return n},t.prototype.arrayNode=function(e,t,r){return t||(this.seenUnclosed=!0),Object(l.m)(e,t,r)},t.prototype.appNode=function(e,t,r,n){var a=this.appNodeBase(e,r,n);return r||(this.seenUnclosed=!0),Object(u.N)(e)||(this.seenParen=!0),Object(u.N)(e)&&t.some(u.I)&&(this.seenMissingOperand=!0),Object(l.l)(e,t,a,n)},t.prototype.letNode=function(e,t,r,n,a,i){var o=this.appNodeBase(e,a,i);return a||(this.seenUnclosed=!0),this.seenParen=!0,Object(l.R)(e,t,r,n,o,i)},t.prototype.lambdaNode=function(e,t,r,n,a,i){var o=this.appNodeBase(e,a,i);return a||(this.seenUnclosed=!0),this.seenParen=!0,Object(l.P)(e,t,r,n,o,i)},t.prototype.parenNode=function(e,t,r){return t||(this.seenUnclosed=!0),this.seenParen=!0,Object(l.cb)(e,t,r)},t.prototype.cellRefNode=function(e,t,r){var n=this.globals.config.localeInfo;return e.isBracketed&&"("===n.leftBracket&&(this.seenParen=!0),this.locals.allowUnqualifiedCell||void 0!==t?Object(l.u)(e,t,r):Object(l.u)(e,this.qualifyCellRef(),r)},t.prototype.fieldRefNode=function(e,t,r,n){return t.isClosed||(this.seenUnclosed=!0),Object(l.E)(e,t,r,n)},t.prototype.structRefNode=function(e,t,r){return t.isClosed||(this.seenUnclosed=!0),Object(l.kb)(e,t,r)},t.prototype.qualifyCellRef=function(){var e=this.locals.originSheet;if(!Object(b.d)(e))throw new U(e.reason);if(void 0!==e.value.index){var t=this.globals.getSheetName(e.value.document,e.value.index);if(!Object(b.d)(t))throw new U(t.reason);return Object(l.gb)(t.value,void 0)}},t.prototype.appNodeBase=function(e,t,r){return t||!Object(u.N)(e)&&this.isFormulaRoot(r)&&!this.seenParen&&!this.seenUnclosed&&!this.seenMissingOperand},t.prototype.isFormulaRoot=function(e){var t;return(null===(t=this.f.annotations[e])||void 0===t?void 0:t.kind)===l.a.FormulaRoot},t}(P.e);function H(e){return{checkFormula:function(t,r){return D(e,t,r)},checkFormulaWithDiagnostics:function(t,r){return function(e,t,r){try{var a=M(w(e,t,r,{ok:void 0,isOk:function(e){return void 0===e},collect:function(e,t,r){var n,a=null!=r?r:[];return(null!==(n=a[e.label])&&void 0!==n?n:a[e.label]=[]).push(t),a}},!1),r).context.errorData;return Object(b.f)([Object(n.__assign)(Object(n.__assign)({},r),{isWellFormed:void 0===a}),a])}catch(e){return Object(b.c)(Object(b.e)(e))}}(e,t,r)},autocorrectFormula:function(t,r){return function(e,t,r){try{var n=r.spans,a=r.annotations,i=r.depthUpperBound,o=new V(e,t,r).autocorrect();return Object(b.f)(Object(l.I)(o,n,a,i))}catch(e){return e instanceof U?Object(b.c)(e.reason):Object(b.c)(Object(b.e)(e))}}(e,t,r)},findStaticPrecedents:function(e,t){return Object(b.f)(Object(d.q)([],[],s.d.All,d.b.Upper))}}}r.d(t,"a",(function(){return H}))},function(e,t,r){"use strict";var n=r(9),a=r(55),i=r(25),o=r(10),c=r(72),u=r(12),s=r(31),l=r(26),d=r(40),f=r(51),b=r(16),h=r(7),v=r(3),p=r(32),m=r(24),g=r(5),O=r(28),j=r(67);function y(e){return new Promise((function(t){return setTimeout(t,e)}))}function S(e,t){var r,n,a,i=null!==(r=null==t?void 0:t.timeThreshold)&&void 0!==r?r:10,c=null!==(n=null==t?void 0:t.costThreshold)&&void 0!==n?n:1,u=null!==(a=null==t?void 0:t.macrotaskDelay)&&void 0!==a?a:0,s={iterations:0,microtaskContinues:0,macrotaskContinues:0,macrotaskTotalDelay:0},l=Object(j.c)(),d=l[0],f=l[1],b=f[0],h=f[1];var v=!0;var p=y(u),m=Object(o.k)();return function t(){if(!v||!function(){try{for(var t=0;t<c;){s.iterations+=1;var r=e();if(void 0===r)return!1;t+=r}return!0}catch(e){return h(e),!1}}())return b();var r=Object(o.k)();r-m<i?(Promise.resolve().then(t),s.microtaskContinues+=1):(p.then((function(){p=y(u),m=Object(o.k)(),s.macrotaskTotalDelay+=m-r,t()})),s.macrotaskContinues+=1)}(),{promise:d,stop:function(){v=!1},stats:s}}var C=r(38),k=r(18),E=r(88),A=r(6),N=r(36),T=r(59);var R=r(0),I=r(30),_=r(58),F=0;var w,M=r(118),D=r(56),P=r(47),x=r(87);r.d(t,"b",(function(){return L})),r.d(t,"a",(function(){return G})),r.d(t,"c",(function(){return H}));function L(e,t){var r,n;switch(t.kind){case O.d.NotImplemented:for(var a=0,i=t.features;a<i.length;a++){var o=i[a];Object(C.z)(e,"".concat(O.d.NotImplemented," ").concat(o))}break;case O.d.IllFormedFormula:Object(C.z)(e,"".concat(O.d.IllFormedFormula," ").concat(null!==(r=t.mode)&&void 0!==r?r:""," ").concat(JSON.stringify({diagnostics:null!==(n=t.diagnostics)&&void 0!==n?n:{},message:t.mode===b.c.ServerCellFormula||t.mode===b.c.ServerNamedFormula?t.message:void 0})));break;case O.d.Unavailable:for(var c=0,u=t.objects;c<u.length;c++){var s=u[c],l=[O.d.Unavailable];if("string"==typeof s.kind&&s.kind in d.d){var f=s;switch(l.push(f.kind),f.kind){case d.d.SheetId:l.push(f.sheetId);break;case d.d.NameLoc:l.push(f.source),l.push(void 0===f.name.scope.index?"global":"sheet");break;case d.d.ClientFailure:l.push(f.reason);break;case d.d.VolatileFunction:l.push(f.name);break;case d.d.TimeGranularity:l.push(N.c[f.granularity]);break;case d.d.GetTimeKind:l.push(f.getTimeKind)}}else l.push(JSON.stringify(s));Object(C.z)(e,l.join(" "))}break;case O.d.LimitExceeded:Object(C.z)(e,"".concat(t.kind," ").concat(O.c[t.limit]));break;case A.g.NotFormatString:case A.g.NotValueString:Object(C.z)(e,"".concat(t.kind," ").concat(t.message));break;case O.d.InvalidQualifier:case O.d.InvalidCellRef:case O.d.InvalidStructRef:Object(C.z)(e,"".concat(t.kind," ").concat(t.reason));break;case O.d.Internal:Object(C.z)(e,"".concat(t.kind," ").concat(t.message));break;case O.d.JavaScriptError:case D.a.NotFormulaString:case O.d.CellCycle:case O.d.NameCycle:case O.d.Stopped:case O.d.PreviousFailure:case O.d.PreviousNameFailure:case A.g.PreviousFormatFailure:Object(C.z)(e,t.kind);break;default:Object(g.e)("calc.calc.incrementFailure",t)}}var B=function(){function e(e,t,r){this.onRecalcResults=e,this.onUpdateRequest=t,this.currentOutputStateId=r,this.editedRangeDeltas=[],this.dependentRangeDeltas=[],this.editedRangeFailures=[],this.dependentRangeFailures=[],this.rangeUpdateRequests=[],this.namesUpdateRequests=[],this.recalcFinished=!1}return e.prototype.setOutputStateId=function(e){e<=this.currentOutputStateId||(this.flush(),this.currentOutputStateId=e)},e.prototype.pushCellWrite=function(e,t){(e!==b.b.DependentCell?this.editedRangeDeltas:this.dependentRangeDeltas).push(t)},e.prototype.pushRangeWrite=function(e,t){Object(o.p)(e!==b.b.DependentCell?this.editedRangeDeltas:this.dependentRangeDeltas,t)},e.prototype.pushRangeFailure=function(e,t){(e!==b.b.DependentCell?this.editedRangeFailures:this.dependentRangeFailures).push(t)},e.prototype.pushUpdateRequest=function(e){this.rangeUpdateRequests.push(e)},e.prototype.pushUpdateNameRequest=function(e){this.namesUpdateRequests.push(e.index)},e.prototype.pushRecalcFinished=function(e){this.recalcFinished=this.recalcFinished||e},e.prototype.isRecalcFinished=function(){return this.recalcFinished},e.prototype.flush=function(){(this.rangeUpdateRequests.length>0||this.namesUpdateRequests.length>0)&&(this.onUpdateRequest(Object(s.jb)(this.rangeUpdateRequests,[],this.namesUpdateRequests)),this.rangeUpdateRequests=[],this.namesUpdateRequests=[]),(this.editedRangeDeltas.length>0||this.editedRangeFailures.length>0)&&(this.sendRecalcResults("Edited",this.editedRangeDeltas,[],this.editedRangeFailures),this.editedRangeDeltas=[],this.editedRangeFailures=[]),(this.dependentRangeDeltas.length>0||this.dependentRangeFailures.length>0)&&(this.sendRecalcResults("Dependents",this.dependentRangeDeltas,[],this.dependentRangeFailures),this.dependentRangeDeltas=[],this.dependentRangeFailures=[]),this.recalcFinished&&(this.onRecalcResults(Object(s.ab)(this.currentOutputStateId,"Dependents",!0,[],[],[])),this.recalcFinished=!1)},e.prototype.sendRecalcResults=function(e,t,r,n){for(var a=0;a<Object(o.b)(Object(o.b)(t.length,r.length),n.length);a+=10)this.onRecalcResults(Object(s.ab)(this.currentOutputStateId,e,!1,t.slice(a,a+10),r.slice(a,a+10),n.slice(a,a+10)))},e}();function U(e){return{kind:e.kind}}var G=function(){function e(e,t,r,a,i){void 0===a&&(a={}),void 0===i&&(i="Local");var o=this;this.onRecalcResults=e,this.onUpdateRequest=t,this.onGC=r,this.twConfig=a,this.dataTransformer=new x.a,this.currentInputStateId=-1/0,this.currentOutputStateId=-1/0,this.lastRecalcStatsStateId=-1/0,this.recalcStatistics=b.i,this.nameFailures=[],this.rangeFailures=[],this.numberFormatFailures=[],this.printFormulaFailures=[],this.inferFormatFailures=[],this.formatValueFailures=[],this.unhandledFailures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.initCalcThreadInside=function(e,t,r){return Object(n.__awaiter)(o,void 0,void 0,(function(){return Object(n.__generator)(this,(function(n){return[2,Object(c.e)(e,t,r,this.twConfig)]}))}))},this.setConfig({}),this.dataModel=new d.c(this.dataTransformer.getLangConfig(),this.config)}return Object.defineProperty(e.prototype,"document",{get:function(){return this.dataTransformer.document},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"mathpack",{get:function(){return this.dataTransformer.getLangConfig().mathpack},enumerable:!1,configurable:!0}),e.prototype.ping=function(){},e.prototype.setInputStateId=function(e,t){var r=e-this.currentInputStateId;return r<0?(this.logInputStateIdDecrease(t),!1):(0!==r&&(this.flushInputLogs(),this.currentInputStateId=e),!0)},e.prototype.setOutputStateId=function(e){var t=e-this.currentOutputStateId;return t<0?(this.logOutputStateIdDecrease(),!1):(0!==t&&(this.flushOutputLogs(),this.currentOutputStateId=e),!0)},e.prototype.clearAsyncResumeRecalc=function(){void 0!==this.recalcLoop&&this.recalcLoop.stop()},e.prototype.resumeRecalc=function(){var e=this;this.flushInputLogs(),this.clearAsyncResumeRecalc(),this.recalcLoop=S((function(){var t=e.dataModel.step(),r=t.messages,n=t.queueEmpty;return r.length>0&&e.processRecalcResults(r),n?void 0:1}),{costThreshold:1,timeThreshold:this.config.yieldIntervalMs});var t=this.recalcLoop;return Object(j.d)(this.recalcLoop.promise,(function(){e.recalcLoop===t&&(e.recalcLoop=void 0)}))},e.prototype.testResumeRecalc=function(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){var t;return Object(n.__generator)(this,(function(r){switch(r.label){case 0:return[4,this.resumeRecalc()];case 1:return r.sent(),void 0!==e&&(t="calc.calc.RecalcService: resumeRecalc finished; resumeId = ".concat(e),g.i.ULS.traceTag(574128980,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,t)),[2]}}))}))},e.prototype.processRecalcResults=function(e){for(var t=new B(this.onRecalcResults,this.onUpdateRequest,this.currentOutputStateId),r=0,n=e;r<n.length;r++){var a=n[r];if(a.kind!==b.d.GarbageCollected)if(a.kind!==b.d.ExperimentRunResult){if(this.setOutputStateId(a.stateId))switch(t.setOutputStateId(a.stateId),a.kind){case b.d.CellWrite:var i=a.cell,c=a.value,u=a.format,s=a.cellKind,l=a.formulaBarText,d=a.formatted,f=a.hasHyperlink,h=i.sheet,v=i.range,p=this.cellWriteToRangeDelta(h.index,v.row,v.col,c,u,l,d,f,"messages.<index>.value");Object(o.e)(p)&&t.pushCellWrite(s,p);break;case b.d.RangeWrite:var m=a.range,O=a.values,j=(s=a.cellKind,l=a.formulaBarText,d=a.formatted,a.formats);h=m.sheet,v=m.range;t.pushRangeWrite(s,this.rangeWriteToRangeDeltas(h.index,v,O,j,l,d,"messages.<index>.values"));break;case b.d.NameFailure:this.nameFailures.push(a);break;case b.d.RangeFailure:m=a.range,s=a.cellKind;var y=a.reason;t.pushRangeFailure(s,this.rangeFailure(m,y)),this.rangeFailures.push(a);break;case b.d.NumberFormatFailure:this.numberFormatFailures.push(a);break;case b.d.PrintFormulaFailure:this.printFormulaFailures.push(a);break;case b.d.InferFormatFailure:this.inferFormatFailures.push(a);break;case b.d.FormatValueFailure:m=a.range,s=a.cellKind,y=a.reason;t.pushRangeFailure(s,this.rangeFailure(m,y)),this.formatValueFailures.push(a);break;case b.d.UnhandledFailure:this.unhandledFailures.push(a);break;case b.d.UpdateRequest:t.pushUpdateRequest(Object(P.o)(a.range));break;case b.d.UpdateNamesRequest:t.pushUpdateNameRequest(a.scope);break;case b.d.RecalcStatistics:t.pushRecalcFinished(a.message===b.e.RecalcFinished),this.recalcStatistics=Object(b.k)(this.recalcStatistics,a);break;case b.d.WorkbookStatistics:this.logWorkbookStats(a.stateId,a.stats,a.p);break;case b.d.StateAdvanced:break;default:return Object(g.e)("calc.calc.RecalcServiceImpl.processRecalcResults",a)}}else this.logExperimentRunResult(a.experimentName,JSON.stringify({message:a.logMessage,timeoutReason:a.timeoutReason}));else this.onGC(a.minStateIdKept)}t.isRecalcFinished()&&this.flushOutputLogs(),t.flush()},e.prototype.logExperimentRunResult=function(e,t){g.i.ULS.traceTag(594409422,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"calc.calc.RecalcService: ".concat(e," done; ").concat(t)),"UnitExperiment"===e&&g.i.ULS.traceTag(538567681,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,"calc.calc.RecalcService: UnitExperiment done: ".concat(t))},e.prototype.logAllFailureStats=function(){var e=this.nameFailures;this.nameFailures=[];var t=this.rangeFailures;this.rangeFailures=[];var r=this.numberFormatFailures;this.numberFormatFailures=[];var n=this.printFormulaFailures;this.printFormulaFailures=[];var a=this.inferFormatFailures;this.inferFormatFailures=[];var o=this.formatValueFailures;this.formatValueFailures=[];var c=this.unhandledFailures;this.unhandledFailures=[],this.logGenFailureStats(e,595194337,"name",i.TraceLevel.Info),this.logCellFailureStats(t,595658722,"range",i.TraceLevel.Info),this.logGenFailureStats(r,590484946,"format",i.TraceLevel.Info),this.logGenFailureStats(n,592730065,"print-formula",i.TraceLevel.Info),this.logGenFailureStats(a,590484947,"infer-format",i.TraceLevel.Info),this.logCellFailureStats(o,590484948,"format-value",i.TraceLevel.Info),this.logGenFailureStats(c,595194338,"unhandled",i.TraceLevel.Warning)},e.prototype.logGenFailureStats=function(e,t,r,n){if(0!==e.length){for(var a={},o=0,c=e;o<c.length;o++){L(a,c[o].reason)}var u="calc.calc.RecalcService: recalc ".concat(r," failures; stateId = ").concat(this.currentOutputStateId,", stats = ").concat(JSON.stringify(a));g.i.ULS.traceTag(t,i.LogCategory.msoulscat_ES_EWAJS,n,u),this.logJavaScriptFailures(e,r)}},e.prototype.logCellFailureStats=function(e,t,r,n){var a,o=this;if(0!==e.length){for(var c={},u=0,s=e;u<s.length;u++){var l=s[u],d=l.reason,f=l.cellKind;L(null!==(a=c[f])&&void 0!==a?a:c[f]={},d)}Object.getOwnPropertyNames(c).sort().forEach((function(e){var a=c[e],u="calc.calc.RecalcService: recalc ".concat(r," failures; stateId = ").concat(o.currentOutputStateId,", cell kind = ").concat(e,", stats = ").concat(JSON.stringify(a));g.i.ULS.traceTag(t,i.LogCategory.msoulscat_ES_EWAJS,n,u)})),this.logJavaScriptFailures(e,r)}},e.prototype.logJavaScriptFailures=function(e,t){for(var r=0,n=e;r<n.length;r++){var a=n[r].reason;if(a.kind===O.d.JavaScriptError){var o=Object(k.c)(a.error),c="calc.calc.RecalcService: recalc ".concat(t," JavaScript error: ").concat(o);g.i.ULS.traceTag(595658721,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,c)}}},e.prototype.logIgnoredStats=function(e,t,r,n){if(0!==Object.getOwnPropertyNames(n).length){var a="stateId = ".concat(t,", stats = ").concat(JSON.stringify(n)),o="calc.calc.RecalcService: ignored ".concat(r," data; ").concat(a);g.i.ULS.traceTag(e,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,o)}},e.prototype.logIgnoredInputStats=function(){this.logIgnoredStats(595658723,this.currentInputStateId,"input",this.ignoredInputStats),this.ignoredInputStats={}},e.prototype.logIgnoredOutputStats=function(){this.logIgnoredStats(595658752,this.currentOutputStateId,"output",this.ignoredOutputStats),this.ignoredOutputStats={}},e.prototype.logRecalcStats=function(){if(this.currentOutputStateId!==-1/0&&(this.lastRecalcStatsStateId!==this.currentOutputStateId||this.recalcStatistics!==b.i)){var e=this.recalcStatistics;this.recalcStatistics=b.i,this.lastRecalcStatsStateId=this.currentOutputStateId;var t=this.config.sampleRecalcStatisticsRate;if(this.dataModel.shouldSample(t)){var r="stateId = ".concat(this.currentOutputStateId,", stats = ").concat(JSON.stringify(e),", p = ").concat(JSON.stringify(t)),n="calc.calc.RecalcService: recalc statistics; ".concat(r);g.i.ULS.traceTag(595654593,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,n)}}},e.prototype.logUnavailableStats=function(){if(this.currentOutputStateId!==-1/0&&0!==this.rangeFailures.length){var e=function(e){for(var t,r,n,a,i,c,u,s=Object(o.i)(),f=Object(o.i)(),b=0,h=e;b<h.length;b++){var g=h[b],O=g.range;if(g.reason.kind===v.a.Unavailable)for(var j=0,y=g.reason.objects;j<y.length;j++){var S=y[j];S.kind===d.d.GridRange&&(Object(v.Z)(S.range.sheet,O.sheet)?s[S.range.sheet.index]=Object(m.j)(null!==(t=s[S.range.sheet.index])&&void 0!==t?t:p.d,!0!==S.unavailableCells?S.unavailableCells:p.d):f[S.range.sheet.index]=Object(m.j)(null!==(r=f[S.range.sheet.index])&&void 0!==r?r:p.d,!0!==S.unavailableCells?S.unavailableCells:p.d))}}var C=0,k=0,E=0,A=Object(o.i)();for(var N in s){var T=null!==(n=s[N])&&void 0!==n?n:p.d;A[N]=Object(m.j)(null!==(a=A[N])&&void 0!==a?a:p.d,T),Object(l.i)(T,(function(e){return C+=e.rows*e.cols,!0}))}for(var N in f){T=null!==(i=f[N])&&void 0!==i?i:p.d;A[N]=Object(m.j)(null!==(c=A[N])&&void 0!==c?c:p.d,T),Object(l.i)(T,(function(e){return k+=e.rows*e.cols,!0}))}for(var N in A){T=null!==(u=A[N])&&void 0!==u?u:p.d;Object(l.i)(T,(function(e){return E+=e.rows*e.cols,!0}))}return{numOfUnavailableCellsInTheSameSheet:C,numOfUnavailableCellsInDifferentSheet:k,totalNumOfUnavailableCells:E}}(this.rangeFailures);if(0!==e.numOfUnavailableCellsInTheSameSheet||0!==e.numOfUnavailableCellsInDifferentSheet||0!==e.totalNumOfUnavailableCells){var t="stateId = ".concat(this.currentOutputStateId,", stats = ").concat(JSON.stringify(e)),r="calc.calc.RecalcService: unavailable cells statistics; ".concat(t);g.i.ULS.traceTag(589632004,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,r)}}},e.prototype.logWorkbookStats=function(e,t,r){var n="stateId = ".concat(e,", stats = ").concat(JSON.stringify(t),", p = ").concat(JSON.stringify(r)),a="calc.calc.RecalcService: workbook statistics; ".concat(n);g.i.ULS.traceTag(595359882,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Info,a)},e.prototype.logInputStateIdDecrease=function(e){Object(C.z)(this.ignoredInputStats,"".concat(e,": input stateId went backwards"))},e.prototype.logOutputStateIdDecrease=function(){Object(C.z)(this.ignoredOutputStats,"output stateId went backwards")},e.prototype.flushInputLogs=function(){this.logIgnoredInputStats()},e.prototype.flushOutputLogs=function(){this.logUnavailableStats(),this.logAllFailureStats(),this.logIgnoredOutputStats(),this.logRecalcStats()},e.prototype.cellWriteToRangeDelta=function(e,t,r,n,a,i,c,u,l){if(Object(C.x)(n,C.r,this.ignoredOutputStats,l)){var d=Object(P.j)(this.mathpack,n),f=Object(P.a)(a);return Object(o.e)(i)||Object(o.e)(d)||Object(o.e)(f)||Object(o.e)(c)||Object(o.e)(u)?Object(s.R)(Object(s.gb)(e,t,r),Object(s.l)(i,d,f,c,u)):void 0}},e.prototype.rangeWriteToRangeDeltas=function(e,t,r,n,a,i,c){for(var u="".concat(c,".<index>.<index>"),s=t.row,l=t.col,d=t.rows,f=t.cols,b=[],h=0;h<d;h+=1)for(var v=0;v<f;v+=1){var p=this.cellWriteToRangeDelta(e,s+h,l+v,r[h][v],n[h][v],0===h&&0===v?a:void 0,i[h][v],void 0,u);Object(o.e)(p)&&b.push(p)}return b},e.prototype.rangeFailure=function(e,t){return Object(s.S)(Object(P.o)(e),U(t))},e.prototype.setA1ReferenceStyle=function(e){this.clearAsyncResumeRecalc(),this.dataTransformer.setA1ReferenceStyle(this.dataModel,this.currentInputStateId,e)},e.prototype.setLocale=function(e){this.clearAsyncResumeRecalc(),this.dataTransformer.setLocaleInfo(this.dataModel,this.currentInputStateId,e,this.ignoredInputStats)},e.prototype.setWorkbookProps=function(e){this.clearAsyncResumeRecalc(),this.dataTransformer.setWorkbookProps(this.dataModel,this.currentInputStateId,e,this.ignoredInputStats)},e.prototype.setNumberFormats=function(e,t){this.clearAsyncResumeRecalc(),this.dataModel.setNumberFormats(this.document,Object(C.y)(e,C.l,this.ignoredInputStats,"numberFormats"),t,this.currentInputStateId)},e.prototype.updateSheetNames=function(e,t){this.setInputStateId(e,"sheetNames")&&(this.clearAsyncResumeRecalc(),this.dataTransformer.updateSheetNames(this.dataModel,e,t,this.ignoredInputStats))},e.prototype.updateNamedObjects=function(e,t){this.setInputStateId(e,"namedObjectsUpdates")&&(this.clearAsyncResumeRecalc(),this.dataTransformer.updateNamedObjects(this.dataModel,e,t,this.ignoredInputStats))},e.prototype.updateUnusedCells=function(e,t){if(this.setInputStateId(e,"unusedCellsUpdates")){this.clearAsyncResumeRecalc();for(var r=0,n=Object(C.y)(t,C.u,this.ignoredInputStats,"unusedCellsUpdates");r<n.length;r++){var a=n[r];this.dataModel.extendUnusedRange(Object(P.q)(this.document,a),e)}}},e.prototype.updateRanges=function(e,t){this.setInputStateId(e,"rangeUpdates")&&(this.clearAsyncResumeRecalc(),this.applyRangeUpdates(e,t))},e.prototype.updateArrays=function(e,t){if(this.setInputStateId(e,"arrayUpdates")){this.clearAsyncResumeRecalc();for(var r=0,n=Object(C.y)(t,C.c,this.ignoredInputStats,"arrayUpdates");r<n.length;r++){var a=n[r],i=a.range,c=a.data,u=a.fromStateId,s=Object(P.p)(this.document,i);if(Object(o.e)(c)){var l=c.formulaBarText,d=c.isSpilled,f=Object(v.n)(s.range);this.dataModel.writeArrayFormula(e,s,l,f,d)}else Object(o.e)(u)}}},e.prototype.editRangeFormulas=function(e,t){this.setInputStateId(e,"rangeFormulaEdits")&&(this.clearAsyncResumeRecalc(),this.applyRangeFormulaEdits(t,e))},e.prototype.evalOnClonedModel=function(e,t){var r=new d.b(this.dataModel);return this.applyRangeUpdates(-1,e,r),this.applyRangeFormulaEdits(t,-1,r),r.resultsPromise.toPromise()},e.prototype.applyRangeUpdates=function(e,t,r){for(var n,a,i=0,c=Object(C.y)(t,C.q,this.ignoredInputStats,"rangeUpdates");i<c.length;i++){var u=c[i],s=u.range,d=u.excludeRows,p=u.excludeColumns,m=u.data,O=u.fromStateId,j=Object(P.p)(this.document,s),y=j.range,S=Object(P.d)(y.row,y.rows,l.d.row,d),k=Object(P.d)(y.col,y.cols,l.d.col,p),E=Object(P.l)(j,S,k),A=Object(o.e)(m)?Object(P.c)(this.mathpack,m.value):h.d;Object(g.h)("calc.calc.RecalcService: updateRanges oper",null!=A);var N=Object(v.n)(y);if(Object(o.e)(m)){var T=m.iformat,R="ArrayFormula"===m.kind?void 0:null!==(n=m.formulaBarText)&&void 0!==n?n:void 0,I=null!==(a=m.failureReason)&&void 0!==a?a:void 0,_="CellFormula"===m.kind;this.dataModel.writeCellContents(e,E,R,_,N,A,T,b.g.Blank,I,r)}else if(Object(o.f)(O))this.dataModel.writeCellContents(e,E,"",!1,N,h.d,f.c,void 0,void 0,r);else{if(r)throw new Error("Promote cell data is unsupported for cloned models.");this.dataModel.promoteCellContents(e,j,E,O)}r||(this.dataModel.writeHiddenRows(e,Object(P.n)(j,S)),this.dataModel.writeHiddenCols(e,Object(P.m)(j,k)))}},e.prototype.applyRangeFormulaEdits=function(e,t,r){for(var n=this,a=Object(C.y)(e,C.p,this.ignoredInputStats,"rangeFormulaEdits"),i=function(e){var a=e.kind,i=e.range,u=e.formulaBarText,s=e.value,d=e.origin,f=e.viewport,h=p.d;i.forEach((function(e){h=Object(m.j)(h,Object(l.f)(Object(P.p)(n.document,e).range))}));var O=Object(P.p)(c.document,i[0]),j=Object(o.e)(d)?Object(P.b)(d):Object(v.n)(O.range),y=Object(o.e)(f)?Object(P.p)(c.document,f):void 0,S=void 0;Object(o.e)(s)?(S=Object(P.c)(c.mathpack,s),Object(g.h)("calc.calc.RecalcService: editRangeFormulas oper",null!=S)):S=void 0;var C="CellFormula"===a||"Value"!==a&&void 0;r?c.dataModel.editCellContentsOnClone(Object(b.l)(O.sheet,h),u,C,j,r):c.dataModel.editCellContents(t,Object(b.l)(O.sheet,h),u,C,j,S,y)},c=this,u=0,s=a;u<s.length;u++){i(s[u])}},e.prototype.editRangeFormats=function(e,t){var r=this;if(this.setInputStateId(e,"rangeFormatEdits")){this.clearAsyncResumeRecalc();for(var n=Object(C.y)(t,C.o,this.ignoredInputStats,"rangeFormatEdits"),a=function(t){var n=t.range,a=t.operation,c=t.origin,u=t.viewport,s="SetFormat"!==a.kind||Object(o.f)(a.format)?"RibbonFormat"!==a.kind||Object(o.f)(a.ribbon)?"ChangeDecimals"!==a.kind||Object(o.f)(a.changeDecimals)?void 0:{kind:a.kind,changeDecimals:a.changeDecimals}:{kind:a.kind,ribbon:a.ribbon}:{kind:a.kind,format:a.format};Object(g.h)("calc.calc.RecalcService: editRangeFormats operation",null!=s);var d=p.d;n.forEach((function(e){d=Object(m.j)(d,Object(l.f)(Object(P.p)(r.document,e).range))}));var f=Object(P.p)(i.document,n[0]),h=null!=c?Object(P.b)(c):Object(v.n)(f.range),O=Object(o.e)(u)?Object(P.p)(i.document,u):void 0;i.dataModel.editCellFormats(e,Object(b.l)(f.sheet,d),s,h,O)},i=this,c=0,u=n;c<u.length;c++){a(u[c])}}},e.prototype.editArrayFormulas=function(e,t){if(this.setInputStateId(e,"arrayFormulaEdits")){this.clearAsyncResumeRecalc();for(var r=0,n=Object(C.y)(t,C.b,this.ignoredInputStats,"arrayFormulaEdits");r<n.length;r++){var a=n[r],i=a.range,c=a.formulaBarText,s=a.origin,l=a.viewport,d=Object(P.p)(this.document,i),f=Object(o.e)(s)?Object(P.b)(s):Object(u.f)(i.row,i.column),b=Object(o.e)(l)?Object(P.p)(this.document,l):void 0;this.dataModel.editArrayFormula(e,d,c,f,b)}}},e.prototype.editRangePaste=function(e,t){if(this.setInputStateId(e,"editRangePaste")){this.clearAsyncResumeRecalc();for(var r=0,n=Object(C.y)(t,C.m,this.ignoredInputStats,"pasteEdits");r<n.length;r++){var a=n[r],i=a.kind,c=a.source,u=a.target,s=a.viewport,l=Object(P.p)(this.document,c),d=Object(P.k)(this.document,u),f=Object(o.e)(s)?Object(P.p)(this.document,s):void 0;this.dataModel.editPaste(e,i,d,l,f)}}},e.prototype.setConfig=function(e){var t,r,n,a,i,o,c,s,l,d,f,b,h=Array.isArray(e.runExperiments)?{stepBudget:null!==(t=e.experimentStepBudget)&&void 0!==t?t:10,totalBudget:null!==(r=e.experimentTotalBudget)&&void 0!==r?r:1e4,factories:Object(E.b)(e.runExperiments)}:void 0;this.config={yieldIntervalMs:10,totalTimeMs:null!==(n=e.totalEvalTimeMs)&&void 0!==n?n:1e4,maxCellChain:2*u.o,maxNameChain:128,maxLambdaCalls:1e4,maxLambdaDepth:1e3,samplePrecisionEvalRate:null!==(a=e.samplePrecisionEvalRate)&&void 0!==a?a:.02,samplePrecisionPrintFormulaRate:null!==(i=e.samplePrecisionPrintFormulaRate)&&void 0!==i?i:.001,samplePrecisionPrintValueRate:null!==(o=e.samplePrecisionPrintValueRate)&&void 0!==o?o:1e-4,sampleRecalcStatisticsRate:null!==(c=e.sampleRecalcStatisticsRate)&&void 0!==c?c:.2,sampleWorkbookStatisticsRate:null!==(s=e.sampleWorkbookStatisticsRate)&&void 0!==s?s:.1,sampleCellEvalStopwatchRate:null!==(l=e.sampleCellEvalStopwatchRate)&&void 0!==l?l:.003,sampleRecalcEditedStopwatchRate:null!==(d=e.sampleRecalcEditedStopwatchRate)&&void 0!==d?d:1,sampleRecalcViewportStopwatchRate:null!==(f=e.sampleRecalcViewportStopwatchRate)&&void 0!==f?f:1,rngSeed:null!==(b=e.rngSeed)&&void 0!==b?b:1e3*Date.now(),volatileMode:null!=e.volatileMode?T.b[e.volatileMode]:T.b.Estimation,experimentFactories:h}},e.prototype.reconfigure=function(e){this.setConfig(e),this.dataModel.reconfigure(this.config)},e.prototype.clearCache=function(){this.clearAsyncResumeRecalc(),this.dataModel=new d.c(this.dataTransformer.getLangConfig(),this.config),this.recalcStatistics=b.i,this.nameFailures=[],this.rangeFailures=[],this.numberFormatFailures=[],this.unhandledFailures=[],this.ignoredInputStats={},this.ignoredOutputStats={},this.currentInputStateId=this.currentOutputStateId=this.lastRecalcStatsStateId=-1/0},e.prototype.evalFormulaRange=function(e,t,r,n,a){var i=this;return Object(C.x)(r,C.e,this.ignoredInputStats,"origin")&&Object(C.x)(n,C.t,this.ignoredInputStats,"range")?Object(C.x)(a,C.g,this.ignoredInputStats,"format")?this.dataModel.evalFormulaRange(e,t,Object(P.b)(r),Object(P.p)(this.document,n),Object(P.f)(a)).then((function(e){if(!Object(R.d)(e))return Object(R.c)(U(e.reason));for(var t=[],r=0,n=e.value;r<n.length;r++){var a=n[r],o=a.value,c=a.formatted,u=a.cell,l=void 0;if(Object(R.d)(o)){if(!Object(C.x)(o.value,C.r,i.ignoredOutputStats,"evalFormulaRange"))throw new Error("ignored output");var d=Object(P.j)(i.mathpack,o.value);Object(g.h)("calc.calc.RecalcService.evalFormulaRange",void 0!==d),l=Object(R.f)(d)}else l=Object(R.c)(U(o.reason));var f=void 0;f=void 0===c?void 0:Object(R.d)(c)?c:Object(R.c)(U(c.reason)),t.push(Object(s.t)(l,f,Object(s.o)(u.row,u.col)))}return Object(R.f)(t)})):Promise.reject(new Error("ignored format")):Promise.reject(new Error("ignored input"))},e.prototype.testAdvanceState=function(e){this.setInputStateId(e,"testAdvanceState")&&(this.dataModel.testAdvanceState(e),this.clearAsyncResumeRecalc())},e.prototype.getMissingJSFeatures=function(){return Object(M.a)()},e}(),V=function(e,t,r){for(var a,i=(void 0===(a="___mixinField")&&(a=""),a+(F+=1).toString()),o={},c=function(e){o[e]=function(){for(var t,r=[],a=0;a<arguments.length;a++)r[a]=arguments[a];var o=this[i];return(t=o[e]).call.apply(t,Object(n.__spreadArray)([o],r,!1))}},u=0,s=r;u<s.length;u++){c(s[u])}return function(e){function a(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];for(var c=e.apply(this,n)||this,u=t(c),s=0,l=r;s<l.length;s++){var d=l[s];Object.defineProperty(c,d,{value:o[d],enumerable:!1,configurable:!1})}return c[i]=u,c}return Object(n.__extends)(a,e),a}(e)}(G,(function(e){return Object(_.f)().createRecalcSideGrid(e)}),["getSheetNames","getRangeValues","getRangeFormats","getRangeFormulae","getIntersectingTables","getIformats","discardSnapshot","createIGridExportEndpoint","getHiddenRows","getHiddenCols"]);if(Object(I.c)("TESTING_ONLY_RECALC_SERVICE_IMPORTSCRIPTS_FAIL")&&(self.__retries=(null!==(w=self.__retries)&&void 0!==w?w:-1)+1,0===self.__retries))throw"";var H=function(e){var t=e.config,r=e.connection;return a.Endpoint.createInside(r,(function(e){return new V((function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return(t=e.post).onRecalcResults.apply(t,r)}),(function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return(t=e.post).onUpdateRequest.apply(t,r)}),(function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];return(t=e.post).onGC.apply(t,r)}),t,r.createMode)}))}},function(e,t,r){"use strict";var n;r.d(t,"a",(function(){return n})),function(e){e.Dev="Dev",e.Stable="Stable"}(n||(n={}))},function(e,t,r){"use strict";r.d(t,"c",(function(){return b})),r.d(t,"b",(function(){return h})),r.d(t,"e",(function(){return v})),r.d(t,"d",(function(){return p})),r.d(t,"a",(function(){return g}));var n=r(35),a=r(44),i=r(4),o=r(7),c=r(5),u=r(1),s=r(8),l=r(12),d=r(3),f=r(21);function b(e,t){switch(e){case u.a.Eq:return 0===t;case u.a.Ne:return 0!==t;case u.a.Lt:return t<0;case u.a.Gt:return t>0;case u.a.Le:return t<=0;case u.a.Ge:return t>=0}}function h(e,t,r){return b(e,t.value-r.value)}function v(e,t,r,n){return b(t,e.stringCompareCI(r.value,n.value))}function p(e,t,r,n){return b(t,e.compare(r,n))}function m(e,t,r){if(Object(d.Y)(t.sheets))if(Object(d.Y)(r.sheets))if(Object(d.D)(t.sheets.document,r.sheets.document)){if(t.sheets.index===r.sheets.index)return Object(l.s)(t.sheets.document,t.sheets.index);i="different sheet, range1 = ".concat(Object(n.a)(t),", range2 = ").concat(Object(n.a)(r));Object(a.g)(e,o.a.VALUE,i)}else{var i="different document, range1 = ".concat(Object(n.a)(t),", range2 = ").concat(Object(n.a)(r));Object(a.g)(e,o.a.VALUE,i)}else Object(a.g)(e,o.a.VALUE,"3D reference, range2 = ".concat(Object(n.a)(r)));else Object(a.g)(e,o.a.VALUE,"3D reference, range1 = ".concat(Object(n.a)(t)))}function g(e,t,r,l){void 0===l&&(l=!1);var g,O,j,y=e.config.mathpack;if(1===r.length){var S=r[0];switch(t){case u.a.Percent:return y.percent(S);case u.a.Neg:return y.neg(S);case u.a.Pos:return S;default:var C="bad application of ".concat(t," to 1 argument"),k="calc.runtime.applyOperator: ".concat(C);return c.i.ULS.assertTag(593372496,i.c.msoulscat_ES_EWAJS,!1,k)}}if(2===r.length){S=r[0];var E=r[1];switch(t){case u.a.Add:var A=y.add(S,E);return l&&Object(d.M)(A)?y.checkAlmostCancellation(S,A):A;case u.a.Sub:A=y.sub(S,E);return l&&Object(d.M)(A)?y.checkAlmostCancellation(S,A):A;case u.a.Mul:return y.mul(S,E);case u.a.Div:return y.div(S,E);case u.a.Pow:return y.power(S,E);case u.a.Concat:return Object(o.u)((S.value+E.value).substring(0,o.f));case u.a.Eq:case u.a.Ne:case u.a.Lt:case u.a.Le:case u.a.Gt:case u.a.Ge:return Object(o.e)(function(e,t,r,n){var a=e.config,i=a.localeInfo,c=a.mathpack;if(r.kind!==n.kind){if(Object(d.y)(r))switch(n.kind){case s.b.Number:return p(c,t,c.zero,n);case s.b.String:return v(i,t,f.g,n);case s.b.Boolean:return h(t,o.i,n)}if(Object(d.y)(n))switch(r.kind){case s.b.Number:return p(c,t,r,c.zero);case s.b.String:return v(i,t,r,f.g);case s.b.Boolean:return h(t,r,o.i)}return b(t,r.kind-n.kind)}switch(r.kind){case s.b.Number:return p(c,t,r,n);case s.b.String:return v(i,t,r,n);case s.b.Boolean:return h(t,r,n);case s.b.Blank:return b(t,0);default:return!1}}(e,t,S,E));case u.a.Range:return function(e,t){var r=m("calc.runtime.applyRangeOp",e,t);if(null==r)return o.w;var n=Object(d.v)(e.ranges),a=Object(d.v)(t.ranges),i=[Object(d.s)(n,a)];return Object(o.s)(r,i)}(S,E);case u.a.Isect:return function(e,t){var r=m("calc.runtime.applyIsectOp",e,t);if(null==r)return o.w;for(var i=[],c=0;c<e.ranges.length;c+=1)for(var u=0;u<t.ranges.length;u+=1){var s=Object(d.q)(e.ranges[c],t.ranges[u]);null!=s&&i.push(s)}if(0===i.length){var l="empty intersection, range1 = ".concat(Object(n.a)(e),", range2 = ").concat(Object(n.a)(t));return Object(a.g)("calc.runtime.applyIsectOp",o.a.NULL,l),o.o}return Object(o.s)(r,i)}(S,E);case u.a.Union:return null==(j=m("calc.runtime.applyUnionOp",g=S,O=E))?o.w:Object(o.s)(j,g.ranges.concat(O.ranges));case u.a.And:return Object(o.e)(S.value&&E.value);case u.a.Or:return Object(o.e)(S.value||E.value);case u.a.Xor:return Object(o.e)(S.value!==E.value);case u.a.Min:return y.cond2(S,E)<=0?S:E;case u.a.Max:return y.cond2(S,E)>=0?S:E;default:var N="bad application of ".concat(t," to 2 arguments"),T="calc.runtime.applyOperator: ".concat(N);return c.i.ULS.assertTag(593372497,i.c.msoulscat_ES_EWAJS,!1,T)}}var R="bad application of ".concat(t," to ").concat(r.length," arguments"),I="calc.runtime.applyOperator: ".concat(R);return c.i.ULS.assertTag(593372498,i.c.msoulscat_ES_EWAJS,!1,I)}},function(e,t,r){"use strict";r.d(t,"b",(function(){return f})),r.d(t,"a",(function(){return b}));var n=r(9),a=r(12),i=r(10),o=r(4),c=r(38),u=r(47),s=r(2),l=r(99),d=r(36),f={localeInfo:Object(o.s)(),mathpack:l.a,refStyle:s.h.A1,timezone:d.f,date1904:!1,dateCompatibility:!0,datepack:d.g},b=function(){function e(){this.document=Object(a.d)(void 0,""),this.langConfig=f}return e.prototype.getLangConfig=function(){return this.langConfig},e.prototype.setA1ReferenceStyle=function(e,t,r){this.langConfig=Object(n.__assign)(Object(n.__assign)({},this.langConfig),{refStyle:r?s.h.A1:s.h.R1C1}),e.setLangConfig(t,this.langConfig)},e.prototype.setLocaleInfo=function(e,t,r,a){Object(c.x)(r,c.i,a,"localeData")&&(this.langConfig=Object(n.__assign)(Object(n.__assign)({},this.langConfig),{localeInfo:Object(u.e)(r,a)}),e.setLangConfig(t,this.langConfig))},e.prototype.setWorkbookProps=function(e,t,r,a){var i,o,u;Object(c.x)(r,c.v,a,"workbookProps")&&(this.langConfig=Object(n.__assign)(Object(n.__assign)({},this.langConfig),{date1904:null!==(i=r.date1904)&&void 0!==i?i:f.date1904,dateCompatibility:null!==(o=r.dateCompatibility)&&void 0!==o?o:f.dateCompatibility,timezone:null!==(u=r.timezone)&&void 0!==u?u:f.timezone}),e.setLangConfig(t,this.langConfig))},e.prototype.updateSheetNames=function(e,t,r,n){e.setSheetNames(this.document,Object(c.y)(r,c.s,n,"sheetNames"),t)},e.prototype.updateNamedObjects=function(e,t,r,n){for(var o=0,s=Object(c.y)(r,c.k,n,"namedObjectsUpdates");o<s.length;o++){var l=s[o],d=l.scope,f=l.objects,b=l.fromStateId,h=Object(a.m)(this.document,Object(i.e)(d)?d:void 0);if(Object(i.e)(f))for(var v=0,p=Object(c.y)(f,Object(c.j)(d),n,"namedObjectsUpdates.<index>.objects");v<p.length;v++){var m=p[v],g=m.name,O=m.data;e.writeNamedObject(t,h,g,Object(u.h)(this.langConfig.mathpack,this.langConfig.localeInfo.stringCompareCI,this.document,O))}else Object(i.e)(b)?e.promoteNamedObjects(t,h,b):e.writeUndefinedNames(t,h)}},e}()},function(e,t,r){"use strict";var n=r(25),a=r(5),i=r(10),o=r(9),c=r(12),u=r(142),s=r(20),l=r(46),d=r(35),f=r(4),b=r(0);var h=function(){function e(e){void 0===e&&(e=75),this.timeLimitMS=e,this.result=void 0}return Object.defineProperty(e.prototype,"done",{get:function(){return!0},enumerable:!1,configurable:!0}),e.prototype.setContext=function(e){var t=e.documents;try{a.i.ULS.traceTag(578588694,f.c.msoulscat_ES_EWAJS,f.i.Info,"calc.calc.RecalcService: ExceLint experiment setContext started");var r=function(e){for(var t,r,n,a,i=e.getServerDocument(),u=[],d=0,f=e.getServerAvailableCells();d<f.length;d++){var h=f[d],v="UndefinedSheet";if(void 0!==i){var p=e.getSheetName(i,h.sheetIdx.index);p.kind===b.b.Success&&(v=p.value)}var m=e.getServerUsedRange(h.sheetIdx);if(m.kind!==b.b.Failure&&void 0!==m.value){var g=m.value.sheet,O=Object(o.__assign)({},m.value.range);O.cols=Math.min(O.cols,75),O.rows=Math.min(O.rows,1e3);for(var j=[],y=[],S=[],C=0,k=O.row,E=O.row+O.rows-1;k<=E;k+=1){for(var A=[],N=[],T=[],R=O.col,I=O.col+O.cols-1;R<=I;R+=1){var _=Object(c.p)(g,Object(c.f)(k,R)),F=e.getServerValue(_),w=F.kind===b.b.Success?JSON.stringify(F.value):"";N.push(w);var M=e.getServerFormat(_),D=M.kind===b.b.Success?Object(s.fnv1a)(JSON.stringify(M.value)).toString():"";T.push(D);var P=e.getServerFormula(_),x=P.kind===b.b.Success?null===(r=null===(t=P.value)||void 0===t?void 0:t[1].compiledFmla)||void 0===r?void 0:r.getValue():void 0,L=(null==x?void 0:x.kind)===b.b.Success&&null!==(a=null===(n=P.value)||void 0===n?void 0:n[1].fmla)&&void 0!==a?a:"";""!==L&&(C+=1),A.push(L)}j.push(A),y.push(N),S.push(T)}if(0!==C){var B={sheetName:v,usedRangeAddress:Object(l.f)(e.config.localeInfo,O,v),values:y,formulas:j,styles:S};u.push(B)}}}return{workbookName:"PartialWorkbook",worksheets:u}}(t);this.result=Object(u.detect_errors)(r,void 0,void 0,this.timeLimitMS)}catch(e){this.result="ExceLint experiment crashed with error: ".concat(e)}},e.prototype.step=function(){},Object.defineProperty(e.prototype,"report",{get:function(){var e=this;return void 0===this.result||"string"==typeof this.result?[]:Object.keys(this.result.worksheets).map((function(t){var r=e.result.worksheets[t],n=r.exampleFixes.map((function(e,t){var n=r.proposedFixes[t][0],a=e.rangeSizes,i=a.reduce((function(e,t){return e+t}),0);return{anomalousnessIndex:n,categories:e.bin,sizeOfCellRange:i,sizeOfEachSFRRange:a,redactedFormulaForEachSFR:e.formulas.map(d.b),stylesDiffer:!e.sameFormat,operatorsDiffer:null,direction:e.direction}})),a=n.map((function(e){return e.sizeOfEachSFRRange.length})).reduce((function(e,t){return e+t}),0);return{totalFormulas:r.numFormulaCells,totalSimilarFormulaRanges:a,numberOfAdjacentSFRs:n.length,numberOfAnomalousRanges:r.suspiciousRanges,numberOfCellsInAnomalousRanges:r.suspiciousCells,anomalies:n,elapsedTimeSeconds:r.elapsedTimeSeconds,proposedFixesTimeSeconds:r.proposedFixesTimeSeconds,adjustProposedFixesTimeSeconds:r.adjustProposedFixesTimeSeconds,adjustFormatProposedFixesTimeSeconds:r.adjustFormatProposedFixesTimeSeconds,exampleFixesTimeSeconds:r.exampleFixesTimeSeconds,numCountingTimeSeconds:r.numCountingTimeSeconds,columns:r.columns,rows:r.rows}})).filter((function(e){return e.totalFormulas>0}))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"resultLogMessage",{get:function(){return"string"==typeof this.result?this.result:void 0===this.result?"ExceLint experiment return <undefined>":"ExceLint experiment done. Result: ".concat(JSON.stringify(this.report))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"failedLogMessage",{get:function(){return this.resultLogMessage+" BTW, experiment ran out of time budget"},enumerable:!1,configurable:!0}),e}(),v=r(122),p=r(70);r.d(t,"a",(function(){return m})),r.d(t,"b",(function(){return j})),r.d(t,"c",(function(){return y}));var m,g=function(){function e(e){this.stepDelay=e,this.done=!1,this.resultLogMessage="TestExperiment",this.failedLogMessage="TestExperiment exceeded budget",this.iters=0}return e.create=function(t){if("number"==typeof t)return new e(t);var r="calc.calc.TestExperiment: expected number; given ".concat(t);a.i.ULS.traceTag(591974878,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,r)},e.prototype.setContext=function(){},e.prototype.step=function(){for(var e=Object(i.k)();Object(i.k)()<e+this.stepDelay;);this.iters+=1,this.iters>1&&(this.done=!0)},e}();!function(e){e.OneShot="OneShot",e.Recurring="Recurring",e.Precision="Precision"}(m||(m={}));var O={TestExperiment:function(e){return{experimentName:"TestExperiment",kind:m.OneShot,create:function(){return g.create(e)}}},ExceLintExperiment:function(){return{experimentName:"ExceLintExperiment",kind:m.OneShot,create:function(){return new h}}},UnitExperiment:function(){return{experimentName:"UnitExperiment",kind:m.OneShot,create:function(){return new v.a},stepBudget:Object(p.getNumberFeatureGate)("Microsoft.Office.Excel.UnitStepBudget")}}};function j(e){return e.map((function(e){var t,r=e.name,n=e.param;return null===(t=O[r])||void 0===t?void 0:t.call(O,n)})).filter((function(e){return void 0!==e}))}function y(e,t){O[e]=t}},function(e,t,r){"use strict";var n,a,i=r(9),o=r(10),c=r(91),u=r(5),s={setImmediate:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return setImmediate.apply(void 0,e)},setTimeout:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return setTimeout.apply(void 0,e)},clearImmediate:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return clearImmediate.apply(void 0,e)},clearTimeout:function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return clearTimeout.apply(void 0,e)}};function l(e,t){return{kind:e,handle:t}}function d(e){return void 0!==e?(e.kind=n.NoWorkScheduled,e.handle=void 0,e):l(n.NoWorkScheduled,void 0)}!function(e){e[e.NoWorkScheduled=0]="NoWorkScheduled",e[e.PromiseScheduled=1]="PromiseScheduled",e[e.ImmediateScheduled=2]="ImmediateScheduled",e[e.FutureScheduled=3]="FutureScheduled"}(n||(n={})),Object(o.r)(),function(e){e.Sync="Sync",e.MicroTask="MicroTask",e.MacroTask="MacroTask"}(a||(a={}));var f=Promise.resolve(),b=function(){function e(e,t){void 0===t&&(t=s);var r=this;this.timer=t,this.handleState=d(),this.clearHandleClosureAndRunBody=function(){var t;switch(r.handleState.kind){case n.NoWorkScheduled:t=a.Sync;break;case n.PromiseScheduled:t=a.MicroTask;break;case n.ImmediateScheduled:case n.FutureScheduled:t=a.MacroTask;break;default:Object(u.e)("Unknown handle state",r.handleState)}r.handleState=d(r.handleState),e(t)},this.promiseClosure=function(){r.handleState.kind===n.PromiseScheduled&&r.clearHandleClosureAndRunBody()}}return e.prototype.runNextSynchronously=function(){switch(this.handleState.kind){case n.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle);break;case n.FutureScheduled:this.timer.clearTimeout(this.handleState.handle)}this.clearHandleClosureAndRunBody()},e.prototype.runNextAsMicrotask=function(){switch(this.handleState.kind){case n.PromiseScheduled:return;case n.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle);break;case n.FutureScheduled:this.timer.clearTimeout(this.handleState.handle)}var e;this.handleState=void 0!==(e=this.handleState)?(e.kind=n.PromiseScheduled,e.handle=void 0,e):l(n.PromiseScheduled,void 0),f.then(this.promiseClosure)},e.prototype.runNextAsMacrotask=function(){switch(this.handleState.kind){case n.ImmediateScheduled:return;case n.FutureScheduled:this.timer.clearTimeout(this.handleState.handle)}var e,t;this.handleState=(e=this.timer.setImmediate(this.clearHandleClosureAndRunBody),void 0!==(t=this.handleState)?(t.kind=n.ImmediateScheduled,t.handle=e,t):l(n.ImmediateScheduled,e))},e.prototype.runNextInFuture=function(e){switch(this.handleState.kind){case n.FutureScheduled:this.timer.clearTimeout(this.handleState.handle);break;case n.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle)}var t,r;this.handleState=(t=this.timer.setTimeout(this.clearHandleClosureAndRunBody,e),void 0!==(r=this.handleState)?(r.kind=n.FutureScheduled,r.handle=t,r):l(n.FutureScheduled,t))},e.prototype.clear=function(){switch(this.handleState.kind){case n.FutureScheduled:this.timer.clearTimeout(this.handleState.handle);break;case n.ImmediateScheduled:this.timer.clearImmediate(this.handleState.handle)}this.handleState=d(this.handleState)},e}();r.d(t,"b",(function(){return h})),r.d(t,"a",(function(){return v}));var h=Object(i.__assign)(Object(i.__assign)({},s),{now:o.k}),v=function(){function e(e,t,r,n){void 0===n&&(n=h);var i,o,u=this;this.cmp=e,this.consumeMessage=t,this.timer=n,this.startTime=void 0,this.totalSyncCost=0,this.maxWitnessedNow=0,this.lastFutureAbsoluteTime=void 0,this.queue=new c.a((function(t,r){var n=t.delayUntil-r.delayUntil;return 0!==n?n:e(t.payload,r.payload)})),this.costThreshold=null!==(i=null==r?void 0:r.costThreshold)&&void 0!==i?i:1,this.timeThreshold=null!==(o=null==r?void 0:r.timeThreshold)&&void 0!==o?o:10,this.scheduler=new b((function(e){u.totalSyncCost=0,u.lastFutureAbsoluteTime=void 0,e===a.MacroTask&&(u.startTime=void 0),u.continue()}),n)}return e.prototype.enqueue=function(e,t,r){void 0===r&&(r=this.maxWitnessedNow),this.queue.enqueue({delayUntil:r,payload:e,abstractCost:t}),this.continue()},e.prototype.push=function(e,t,r){void 0===r&&(r=this.maxWitnessedNow),this.queue.push({delayUntil:r,payload:e,abstractCost:t}),this.continue()},e.prototype.pop=function(){var e;return 1===this.queue.getCount()&&this.scheduler.clear(),null===(e=this.queue.pop())||void 0===e?void 0:e.payload},e.prototype.peek=function(){return this.queue.peek()},e.prototype.getCount=function(){return this.queue.getCount()},e.prototype.continue=function(){var e;for(this.startTime=null!==(e=this.startTime)&&void 0!==e?e:this.now();this.totalSyncCost<this.costThreshold;){var t=this.queue.peek();if(void 0===t)return;if(t.delayUntil>this.maxWitnessedNow&&this.tryRunNextInFuture(t.delayUntil,this.now()))return;this.queue.pop(),this.totalSyncCost+=t.abstractCost,this.consumeMessage(t.payload)}var r=this.queue.peek();if(void 0!==r){var n=this.now();n-this.startTime<this.timeThreshold&&r.delayUntil<=n?this.scheduler.runNextAsMicrotask():this.tryRunNextInFuture(r.delayUntil,n)||this.scheduler.runNextAsMacrotask()}},e.prototype.tryRunNextInFuture=function(e,t){return e>t&&(this.lastFutureAbsoluteTime!==e&&(this.lastFutureAbsoluteTime=e,this.scheduler.runNextInFuture(e-t)),!0)},e.prototype.now=function(){return this.maxWitnessedNow=this.timer.now()},e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return b})),r.d(t,"b",(function(){return h}));var n=r(18),a=r(7),i=r(6),o=r(113),c=r(94),u=r(0);function s(e){var t=Object(n.h)(e,"'"),r=t?e.substring(1):e;return r.length>a.f?Object(u.c)(Object(i.E)("cell text too long")):Object(u.f)(Object(i.M)(Object(a.u)(r),t))}function l(e,t,r){return Object(c.b)(Object(c.a)(e),t,r,i.j.ValueCell)}function d(e,t,r){var n=e.config,a=n.localeInfo,c=n.mathpack,u=a.isEastAsia&&r.valueType===i.h.Percentage&&!0,s=!1;switch(r.valueType){case i.h.Number:case i.h.Currency:case i.h.Percentage:case i.h.Fraction:case i.h.Scientific:case i.h.Accounting:s=!0}return Object(o.a)(a,c,t,u,!0,s)}function f(e,t,r){var n=function(e,t){if(0===e.stringCompareCI(t,e.trueName))return a.v;if(0===e.stringCompareCI(t,e.falseName))return a.i;for(var r=1;r<e.errorNames.length;r+=1){var n=e.errorNames[r];if(null!=n&&0===e.stringCompareCI(n,t))return Object(a.h)(r)}}(e.config.localeInfo,t);if(void 0!==n)return Object(u.f)(Object(i.G)(n));for(var o=0,c=r.valueType===i.h.Date||r.valueType===i.h.Time?[l,d]:[d,l];o<c.length;o++){var s=(0,c[o])(e,t,r);if(!Object(u.d)(s))return s;if(void 0!==s.value){var f=s.value,b=f.value,h=f.format;return Object(u.f)(Object(i.F)(b,h))}}return Object(u.f)(void 0)}function b(e,t,r){try{if(r.valueType===i.h.Text)return s(t);if(""===t)return Object(u.f)(Object(i.G)(a.d));if(Object(n.h)(t,"="))return Object(u.f)(Object(i.v)(t));if(!Object(n.h)(t,"'")){var o=f(e,t,r);if(!Object(u.d)(o))return o;if(void 0!==o.value)return Object(u.f)(o.value)}return"="===(c=t.charAt(0))||"+"===c||"-"===c||"@"===c?Object(u.f)(Object(i.v)(t)):s(t)}catch(e){return Object(u.c)(Object(u.e)(e))}var c}function h(e,t){return e!==t&&(t.source===i.l.Builtin&&(t.valueType===i.h.General||function(e,t){return(null==e?void 0:e.valueType)!==i.h.Number&&t.valueType!==i.h.Number&&(null==e?void 0:e.valueType)!==t.valueType}(e,t)))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(20),a=n.priorityQueue.PriorityQueue},function(e,t,r){"use strict";var n=r(6),a=r(9),i=r(4),o=r(5),c=r(3),u=r(23),s=r(7),l=r(1),d=r(61),f=r(18),b=r(78),h=r(10),v=r(86),p=r(64),m=r(33),g=r(11),O=r(36),j=r(0),y=function(e){return e.kind!==n.i.General},S=function(e){return e.kind!==n.i.Flexible};function C(e,t,r){return 0!=(t&n.c.MaxChars)&&r.length>255?n.c.MaxChars:0!=(t&n.c.CellWidth)&&e.renderWidth<1/0&&e.getTextWidth(r)>e.renderWidth?n.c.CellWidth:void 0}function k(e,t,r,n,a,i,c){var u=Object(h.b)(0,255-r.length-n.length),s=0===a.length?u:Math.floor(u/a.length);if(e.renderWidth!==1/0){var l=e.getTextWidth(a);l>0&&(s=Object(h.c)(s,Object(h.b)(Math.floor((e.renderWidth-e.getTextWidth(r+n))/l),0)))}var d,f=c(s);if(e.bestFit&&i&&(!1===f||f.indexOf("E")>=0)){for(var b=1,v=f;(!1===v||v.indexOf("E")>=0)&&s+b<=N;)v=c(s+b),b++;if(!1!==v)return v}if(!1===f||void 0===(d=C(e,t,r+f+n))){for(var p=f,m=s+1;m<s+50;m+=1){if(!1!==(O=c(m))){if(O===p)break;if(void 0!==(j=C(e,t,r+O+n))){!1===p&&(p=j);break}p=O}}return Object(o.h)("calc.numfmt.renderValue: false after upwards search",!1!==p),p}var g=d;for(m=s-1;m>=0;m-=1){var O,j;if(!1===(O=c(m)))break;if(void 0===(j=C(e,t,r+O+n)))return O;g=j}return g}var E=Object(c.c)("RenderHashesError"),A=Object(c.c)("RenderError"),N=11;function T(e,t,r){var n=e.fromNumber(t.num),a=t.includeSign&&e.cond(n)<0?"-":"",i=a+e.formatGeneral(t,e.abs(n),r-a.length);if("-0"===i&&(i="0"),i.length>r)return Object(j.f)(!1);var c=i.indexOf("E");if(c>=0){var u=Object(p.b)(t,i.substring(0,c),t.expNumberShape);if(!Object(j.d)(u))return u;var s=i.substring(c,c+2),l=Object(p.a)(i.substring(c+2),t.expNumberShape);return Object(o.h)("calc.numfmt.render: formatGeneral ePart","E-"===s||"E+"===s),Object(j.f)(u.value+s+l)}var d=Object(p.b)(t,i,t.numberShape);return Object(j.d)(d)?Object(j.f)(d.value):d}function R(e,t,r){try{return Object(n.z)(t)?Object(j.f)(Object(n.x)(t.units,t.color)):Object(j.f)(function(e,t,r){var a,i,c=t.units,u=t.color,s=t.alignment,l=t.clip,d=Object(n.B)(r);if(c.every(y))a=c;else if(d.renderWidth===1/0)a=c.map((function(t){if(t.kind!==n.i.General)return t;var r=T(e,t,N);if(!Object(j.d)(r))throw new A(r.reason);return Object(o.h)("calc.numfmt.renderValue: false after format at defaultGenPrecision",!1!==r.value),Object(n.t)(r.value)}));else{for(var b="",v="",p=void 0,m=void 0,g=0;g<c.length;g+=1){var O=c[g];switch(O.kind){case n.i.String:case n.i.Blank:void 0!==p?v+=O.str:b+=O.str;break;case n.i.General:Object(o.h)("calc.numfmt.renderValue: expected a single General unit",void 0===p),p=g,m=O;break;case n.i.Flexible:}}Object(o.h)("calc.numfmt.renderValue: genUnit",void 0!==p&&void 0!==m);var R=m,I=k(d,l,b,v,"0",R.builtin,(function(t){var r=T(e,R,Object(h.c)(t,N));if(!Object(j.d)(r))throw new A(r.reason);return r.value}));if("number"==typeof I)throw new E(Object(n.N)(I));a=c.map((function(e){return e.kind===n.i.General?Object(n.t)(I):e}))}if(a.every(S))i=a;else if(d.renderWidth===1/0||d.bestFit)i=a.filter(S);else{b="",v="";var _,F=void 0;for(g=0;g<a.length;g+=1){var w=a[g];switch(w.kind){case n.i.String:case n.i.Blank:void 0!==_?v+=w.str:b+=w.str;break;case n.i.Flexible:_=g,F=w}}Object(o.h)("calc.numfmt.renderValue: lastFlexUnit",void 0!==_&&void 0!==F);var M=F,D=k(d,n.c.All,b,v,F.str,!1,(function(e){return Object(f.f)(M.str,e)}));if("number"==typeof D){if(0!=(D&l))throw new E(Object(n.N)(D));D=""}var P=D.length/M.str.length;P=Object(h.b)(P-1,0);var x=Object(f.f)(M.str,P);i=a.map((function(e,t){return e.kind!==n.i.Flexible?e:Object(n.t)(t===_?x:"")}))}if(l!==n.c.None){var L="";for(g=0;g<i.length;g+=1)L+=i[g].str;var B=C(d,l,L);if(d.bestFit&&B===n.c.CellWidth)return Object(n.K)(i,u,s,l);if(void 0!==B)throw new E(Object(n.N)(B))}return Object(n.K)(i,u,s,l)}(e,t,r))}catch(e){return e instanceof E?Object(j.f)(Object(n.x)(e.reason,t.color)):e instanceof A?Object(j.c)(e.reason):Object(j.c)(Object(j.e)(e))}}var I,_,F=r(8),w=r(35),M={ar:[["يناير","فبراير","مارس","أبريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوفمبر","ديسمبر"],["يناير","فبراير","مارس","أبريل","مايو","يونيو","يوليو","أغسطس","سبتمبر","أكتوبر","نوفمبر","ديسمبر"],["الأحد","الإثنين","الثلاثاء","الأربعاء","الخميس","الجمعة","السبت"],["الأحد","الإثنين","الثلاثاء","الأربعاء","الخميس","الجمعة","السبت"],["ص","م"],"z"],en:[["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],["January","February","March","April","May","June","July","August","September","October","November","December"],["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],["AM","PM"],"z"],es:[["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","set","oct.","nov.","dic."],["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],["do.","lu.","ma.","mi.","ju.","vi.","sá."],["domingo","lunes","martes","miércoles","jueves","viernes","sábado"],["a. m.","p. m."],"z"],fr:[["janv.","févr.","mars","avr.","mai","juin","juil.","août","sept.","oct.","nov.","déc."],["janvier","février","mars","avril","mai","juin","juillet","août","septembre","octobre","novembre","décembre"],["dim.","lun.","mar.","mer.","jeu.","ven.","sam."],["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],"en","z"],zh:[["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],["週日","週一","週二","週三","週四","週五","週六"],["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],["上午","下午"],"s"],de:[["Jan","Feb","Mrz","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],["So","Mo","Di","Mi","Do","Fr","Sa"],["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],"en","z"],hr:[["sij","vlj","ožu","tra","svi","lip","srp","kol","ruj","lis","stu","pro"],["siječanj","veljača","ožujak","travanj","svibanj","lipanj","srpanj","kolovoz","rujan","listopad","studeni","prosinac"],["ned","pon","uto","sri","čet","pet","sub"],["nedjelja","ponedjeljak","utorak","srijeda","četvrtak","petak","subota"],"en","z"],nl:[["jan","feb","mrt","apr","mei","jun","jul","aug","sep","okt","nov","dec"],["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],["zo","ma","di","wo","do","vr","za"],["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"],"en","z"],sv:[["jan","feb","mar","apr","maj","jun","jul","aug","sep","okt","nov","dec"],["januari","februari","mars","april","maj","juni","juli","augusti","september","oktober","november","december"],["sön","mån","tis","ons","tor","fre","lör"],["söndag","måndag","tisdag","onsdag","torsdag","fredag","lördag"],"en","z"],it:[["gen","feb","mar","apr","mag","giu","lug","ago","set","ott","nov","dic"],["gennaio","febbraio","marzo","aprile","maggio","giugno","luglio","agosto","settembre","ottobre","novembre","dicembre"],["dom","lun","mar","mer","gio","ven","sab"],["domenica","lunedì","martedì","mercoledì","giovedì","venerdì","sabato"],"en","z"],ro:[["ian.","feb.","mar.","apr.","mai","iun.","iul.","aug.","sept.","oct.","nov.","dec."],["ianuarie","februarie","martie","aprilie","mai","iunie","iulie","august","septembrie","octombrie","noiembrie","decembrie"],["dum.","lun.","mar.","mie.","joi","vin.","sâm."],["duminică","luni","marți","miercuri","joi","vineri","sâmbătă"],["a.m.","p.m."],"z"],ru:[["янв","фев","мар","апр","май","июн","июл","авг","сен","окт","ноя","дек"],["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],["Вс","Пн","Вт","Ср","Чт","Пт","Сб"],["воскресенье","понедельник","вторник","среда","четверг","пятница","суббота"],"en","z"],sr:[["jan","feb","mar","apr","maj","jun","jul","avg","sep","okt","nov","dec"],["januar","februar","mart","april","maj","jun","jul","avgust","septembar","oktobar","novembar","decembar"],["ned","pon","uto","sre","čet","pet","sub"],["nedelja","ponedeljak","utorak","sreda","četvrtak","petak","subota"],["pre podne","po podne"],"z"],uk:[["Січ","Лют","Бер","Кві","Тра","Чер","Лип","Сер","Вер","Жов","Лис","Гру"],["січень","лютий","березень","квітень","травень","червень","липень","серпень","вересень","жовтень","листопад","грудень"],["Нд","Пн","Вт","Ср","Чт","Пт","Сб"],["неділя","понеділок","вівторок","середа","четвер","п'ятниця","субота"],"en","z"],bg:[["яну","фев","мар","апр","май","юни","юли","авг","сеп","окт","ное","дек"],["януари","февруари","март","април","май","юни","юли","август","септември","октомври","ноември","декември"],["нед","пон","вт","ср","четв","пет","съб"],["неделя","понеделник","вторник","сряда","четвъртък","петък","събота"],"en","z"],cs:[["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII"],["leden","únor","březen","duben","květen","červen","červenec","srpen","září","říjen","listopad","prosinec"],["ne","po","út","st","čt","pá","so"],["neděle","pondělí","úterý","středa","čtvrtek","pátek","sobota"],["dop.","odp."],"z"],da:["sv",["januar","februar","marts","april","maj","juni","juli","august","september","oktober","november","december"],["sø","ma","ti","on","to","fr","lø"],["søndag","mandag","tirsdag","onsdag","torsdag","fredag","lørdag"],"sv","z"],el:[["Ιαν","Φεβ","Μαρ","Απρ","Μαϊ","Ιουν","Ιουλ","Αυγ","Σεπ","Οκτ","Νοε","Δεκ"],["Ιανουάριος","Φεβρουάριος","Μάρτιος","Απρίλιος","Μάιος","Ιούνιος","Ιούλιος","Αύγουστος","Σεπτέμβριος","Οκτώβριος","Νοέμβριος","Δεκέμβριος"],["Κυρ","Δευ","Τρι","Τετ","Πεμ","Παρ","Σαβ"],["Κυριακή","Δευτέρα","Τρίτη","Τετάρτη","Πέμπτη","Παρασκευή","Σάββατο"],["πμ","μμ"],"z"],et:[["jaan","veebr","märts","apr","mai","juuni","juuli","aug","sept","okt","nov","dets"],["jaanuar","veebruar","märts","aprill","mai","juuni","juuli","august","september","oktoober","november","detsember"],["P","E","T","K","N","R","L"],["pühapäev","esmaspäev","teisipäev","kolmapäev","neljapäev","reede","laupäev"],"en","z"],fi:[["tammi","helmi","maalis","huhti","touko","kesä","heinä","elo","syys","loka","marras","joulu"],["tammikuu","helmikuu","maaliskuu","huhtikuu","toukokuu","kesäkuu","heinäkuu","elokuu","syyskuu","lokakuu","marraskuu","joulukuu"],["su","ma","ti","ke","to","pe","la"],["sunnuntai","maanantai","tiistai","keskiviikko","torstai","perjantai","lauantai"],["ap.","ip."],"z"],he:[["ינו","פבר","מרץ","אפר","מאי","יונ","יול","אוג","ספט","אוק","נוב","דצמ"],["ינואר","פברואר","מרץ","אפריל","מאי","יוני","יולי","אוגוסט","ספטמבר","אוקטובר","נובמבר","דצמבר"],["יום א","יום ב","יום ג","יום ד","יום ה","יום ו","שבת"],["יום ראשון","יום שני","יום שלישי","יום רביעי","יום חמישי","יום שישי","שבת"],"en","z"],hu:[["jan.","febr.","márc.","ápr.","máj.","jún.","júl.","aug.","szept.","okt.","nov.","dec."],["január","február","március","április","május","június","július","augusztus","szeptember","október","november","december"],["V","H","K","Sze","Cs","P","Szo"],["vasárnap","hétfő","kedd","szerda","csütörtök","péntek","szombat"],["de.","du."],"z"],id:[["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agu","Sep","Okt","Nov","Des"],["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],["Mgg","Sen","Sel","Rab","Kam","Jum","Sab"],["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"],"en","z"],ja:[["1","2","3","4","5","6","7","8","9","10","11","12"],["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],["日","月","火","水","木","金","土"],["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"],["午前","午後"],"j"],ko:["ja",["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],["일","월","화","수","목","금","토"],["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],["오전","오후"],"k"],lt:[["saus.","vas.","kov.","bal.","geg.","birž.","liep.","rugp.","rugs.","spal.","lapkr.","gruod."],["sausis","vasaris","kovas","balandis","gegužė","birželis","liepa","rugpjūtis","rugsėjis","spalis","lapkritis","gruodis"],["sk","pr","an","tr","kt","pn","št"],["sekmadienis","pirmadienis","antradienis","trečiadienis","ketvirtadienis","penktadienis","šeštadienis"],["priešpiet","popiet"],"z"],lv:[["janv.","febr.","marts","apr.","maijs","jūn.","jūl.","aug.","sept.","okt.","nov.","dec."],["janvāris","februāris","marts","aprīlis","maijs","jūnijs","jūlijs","augusts","septembris","oktobris","novembris","decembris"],["svētd.","pirmd.","otrd.","trešd.","ceturtd.","piektd.","sestd."],["svētdiena","pirmdiena","otrdiena","trešdiena","ceturtdiena","piektdiena","sestdiena"],["priekšp.","pēcp."],"z"],nb:[["jan","feb","mar","apr","mai","jun","jul","aug","sep","okt","nov","des"],["januar","februar","mars","april","mai","juni","juli","august","september","oktober","november","desember"],["søn","man","tir","ons","tor","fre","lør"],"da","ro","z"],pl:[["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","paź","lis","gru"],["styczeń","luty","marzec","kwiecień","maj","czerwiec","lipiec","sierpień","wrzesień","październik","listopad","grudzień"],["niedz.","pon.","wt.","śr.","czw.","pt.","sob."],["niedziela","poniedziałek","wtorek","środa","czwartek","piątek","sobota"],"en","z"],pt:[["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],["janeiro","fevereiro","março","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"],["dom","seg","ter","qua","qui","sex","sáb"],["domingo","segunda-feira","terça-feira","quarta-feira","quinta-feira","sexta-feira","sábado"],"en","z"],sk:["ja",["január","február","marec","apríl","máj","jún","júl","august","september","október","november","december"],["ne","po","ut","st","št","pi","so"],["nedeľa","pondelok","utorok","streda","štvrtok","piatok","sobota"],"en","z"],sl:[["jan.","feb.","mar.","apr.","maj","jun.","jul.","avg.","sep.","okt.","nov.","dec."],["januar","februar","marec","april","maj","junij","julij","avgust","september","oktober","november","december"],["ned.","pon.","tor.","sre.","čet.","pet.","sob."],["nedelja","ponedeljek","torek","sreda","četrtek","petek","sobota"],["dop.","pop."],"z"],th:[["ม.ค.","ก.พ.","มี.ค.","เม.ย.","พ.ค.","มิ.ย.","ก.ค.","ส.ค.","ก.ย.","ต.ค.","พ.ย.","ธ.ค."],["มกราคม","กุมภาพันธ์","มีนาคม","เมษายน","พฤษภาคม","มิถุนายน","กรกฎาคม","สิงหาคม","กันยายน","ตุลาคม","พฤศจิกายน","ธันวาคม"],["อา.","จ.","อ.","พ.","พฤ.","ศ.","ส."],["อาทิตย์","จันทร์","อังคาร","พุธ","พฤหัสบดี","ศุกร์","เสาร์"],"en","z"],tr:[["Oca","Şub","Mar","Nis","May","Haz","Tem","Ağu","Eyl","Eki","Kas","Ara"],["Ocak","Şubat","Mart","Nisan","Mayıs","Haziran","Temmuz","Ağustos","Eylül","Ekim","Kasım","Aralık"],["Paz","Pzt","Sal","Çar","Per","Cum","Cmt"],["Pazar","Pazartesi","Salı","Çarşamba","Perşembe","Cuma","Cumartesi"],["ÖÖ","ÖS"],"z"],vi:[["Thg1","Thg2","Thg3","Thg4","Thg5","Thg6","Thg7","Thg8","Thg9","Thg10","Thg11","Thg12"],["Tháng Giêng","Tháng Hai","Tháng Ba","Tháng Tư","Tháng Năm","Tháng Sáu","Tháng Bảy","Tháng Tám","Tháng Chín","Tháng Mười","Tháng Mười Một","Tháng Mười Hai"],["CN","T2","T3","T4","T5","T6","T7"],["Chủ Nhật","Thứ Hai","Thứ Ba","Thứ Tư","Thứ Năm","Thứ Sáu","Thứ Bảy"],["SA","CH"],"z"],ta:[["ஜனவரி","பிப்ரவரி","மார்ச்","ஏப்ரல்","மே","ஜூன்","ஜூலை","ஆகஸ்ட்","செப்டம்பர்","அக்டோபர்","நவம்பர்","டிசம்பர்"],["ஜனவரி","பிப்ரவரி","மார்ச்","ஏப்ரல்","மே","ஜூன்","ஜூலை","ஆகஸ்ட்","செப்டம்பர்","அக்டோபர்","நவம்பர்","டிசம்பர்"],["ஞாயிறு","திங்கள்","செவ்வாய்","புதன்","வியாழன்","வெள்ளி","சனி"],["ஞாயிற்றுக்கிழமை","திங்கள்கிழமை","செவ்வாய்க்கிழமை","புதன்கிழமை","வியாழக்கிழமை","வெள்ளிக்கிழமை","சனிக்கிழமை"],["காலை","மாலை"],"z"],syr:[["܏ܟܢ ܏ܒ","ܫܒܛ","ܐܕܪ","ܢܝܣܢ","ܐܝܪ","ܚܙܝܪܢ","ܬܡܘܙ","ܐܒ","ܐܝܠܘܠ","܏ܬܫ ܏ܐ","܏ܬܫ ܏ܒ","܏ܟܢ ܏ܐ"],["ܟܢܘܢ ܐܚܪܝ","ܫܒܛ","ܐܕܪ","ܢܝܣܢ","ܐܝܪ","ܚܙܝܪܢ","ܬܡܘܙ","ܐܒ","ܐܝܠܘܠ","ܬܫܪܝ ܩܕܝܡ","ܬܫܪܝ ܐܚܪܝ","ܟܢܘܢ ܩܕܝܡ"],["܏ܐ ܏ܒܫ","܏ܒ ܏ܒܫ","܏ܓ ܏ܒܫ","܏ܕ ܏ܒܫ","܏ܗ ܏ܒܫ","܏ܥܪܘܒ","܏ܫܒ"],["ܚܕ ܒܫܒܐ","ܬܪܝܢ ܒܫܒܐ","ܬܠܬܐ ܒܫܒܐ","ܐܪܒܥܐ ܒܫܒܐ","ܚܡܫܐ ܒܫܒܐ","ܥܪܘܒܬܐ","ܫܒܬܐ"],["ܩ.ܛ","ܒ.ܛ"],"z"],eu:[["urt.","ots.","mar.","api.","mai.","eka.","uzt.","abu.","ira.","urr.","aza.","abe."],["urtarrila","otsaila","martxoa","apirila","maiatza","ekaina","uztaila","abuztua","iraila","urria","azaroa","abendua"],["ig.","al.","ar.","az.","og.","or.","lr."],["igandea","astelehena","asteartea","asteazkena","osteguna","ostirala","larunbata"],"en","z"],be:[["студз","лют","сак","крас","май","чэрв","ліп","жн","вер","кастр","ліст","снеж"],["студзень","люты","сакавік","красавік","май","чэрвень","ліпень","жнівень","верасень","кастрычнік","лістапад","снежань"],["нд","пн","аўт","ср","чц","пт","сб"],["нядзеля","панядзелак","аўторак","серада","чацвер","пятніца","субота"],"en","z"],dv:[["ޖަނަވަރީ","ފެބްރުއަރީ","މާރޗް","އޭޕްރިލް","މެއި","ޖޫން","ޖުލައި","އޮގަސްޓް","ސެޕްޓެމްބަރ","އޮކްޓޯބަރ","ނޮވެމްބަރ","ޑިސެމްބަރ"],["ޖަނަވަރީ","ފެބްރުއަރީ","މާރޗް","އޭޕްރިލް","މެއި","ޖޫން","ޖުލައި","އޮގަސްޓް","ސެޕްޓެމްބަރ","އޮކްޓޯބަރ","ނޮވެމްބަރ","ޑިސެމްބަރ"],["އާދީއްތަ","ހޯމަ","އަންގާރަ","ބުދަ","ބުރާސްފަތި","ހުކުރު","ހޮނިހިރު"],["އާދީއްތަ","ހޯމަ","އަންގާރަ","ބުދަ","ބުރާސްފަތި","ހުކުރު","ހޮނިހިރު"],["މކ","މފ"],"z"],hi:[["जनवरी","फरवरी","मार्च","अप्रैल","मई","जून","जुलाई","अगस्त","सितम्बर","अक्तूबर","नवम्बर","दिसम्बर"],["जनवरी","फरवरी","मार्च","अप्रैल","मई","जून","जुलाई","अगस्त","सितम्बर","अक्तूबर","नवम्बर","दिसम्बर"],["रवि.","सोम.","मंगल.","बुध.","गुरु.","शुक्र.","शनि."],["रविवार","सोमवार","मंगलवार","बुधवार","गुरुवार","शुक्रवार","शनिवार"],["पूर्वाह्न","अपराह्न"],"z"],"ar-SA":"ar","ar-IQ":[["كانون الثاني","شباط","آذار","نيسان","أيار","حزيران","تموز","آب","أيلول","تشرين الأول","تشرين الثاني","كانون الأول"],["كانون الثاني","شباط","آذار","نيسان","أيار","حزيران","تموز","آب","أيلول","تشرين الأول","تشرين الثاني","كانون الأول"],"ar","ar","ar","z"],"ar-DZ":"ar","en-US":"en","en-AU":"en","en-BZ":"en","en-CA":"en","en-029":"en","en-HK":"en","en-IN":"en","en-ID":"en","en-IE":"en","en-JM":"en","en-MY":"en","en-NZ":"en","en-PH":"en","en-SG":"en","en-ZA":"en","en-TT":"en","en-GB":"en","en-ZW":"en","es-ES":[["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sep.","oct.","nov.","dic."],"es","es","es","en","z"],"es-AR":["es-ES","es",["dom.","lun.","mar.","mié.","jue.","vie.","sáb."],"es",["a. m.","p. m."],"z"],"es-BO":["es-ES","es","es-AR","es","es-AR","z"],"es-CL":[["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sept.","oct.","nov.","dic."],"es","es-AR","es","es-AR","z"],"es-CO":["es-ES","es","es-AR","es","es-AR","z"],"es-CR":["es-ES","es","es-AR","es","es-AR","z"],"es-DO":["es-ES","es","es-AR","es","es-AR","z"],"es-EC":["es-ES","es","es-AR","es","es-AR","z"],"es-SV":["es-ES","es","es-AR","es","es-AR","z"],"es-GT":["es-ES","es","es-AR","es","es-AR","z"],"es-HN":["es-ES","es","es-AR","es","es-AR","z"],"es-419":["es-ES","es","es-AR","es","ro","z"],"es-MX":["es-ES","es","es-AR","es","es","z"],"es-NI":["es-ES","es","es-AR","es","es-AR","z"],"es-PA":["es-ES","es","es-AR","es","es-AR","z"],"es-PY":["es-CL","es","es-AR","es","es-CL","z"],"es-PE":[["Ene.","Feb.","Mar.","Abr.","May.","Jun.","Jul.","Ago.","Set.","Oct.","Nov.","Dic."],["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Setiembre","Octubre","Noviembre","Diciembre"],"es-AR","es","es-AR","z"],"es-PR":["es-ES","es","es-AR","es","es-AR","z"],"es-ES_tradnl":["es-ES","es","es","es","es-ES","z"],"es-US":[["ene","feb","mar","abr","may","jun","jul","ago","sep","oct","nov","dic"],"es",["dom","lun","mar","mié","jue","vie","sáb"],"es","en","z"],"es-UY":["es","es-PE","es-AR","es","es-AR","z"],"es-VE":["es-CL","es","es-AR","es","es-CL","z"],"fr-FR":"fr","fr-BE":"fr","fr-CM":["fr","fr","fr","fr",["mat.","soir"],"z"],"fr-CA":"fr","fr-029":"fr","fr-CD":"fr","fr-CI":"fr","fr-HT":"fr","fr-LU":"fr","fr-ML":"fr","fr-MC":"fr","fr-MA":[["jan.","fév.","mar.","avr.","mai","jui.","juil.","août","sept.","oct.","nov.","déc."],"fr","fr","fr","en","z"],"fr-RE":"fr","fr-SN":"fr","fr-CH":"fr","zh-CN":["zh","zh",["周日","周一","周二","周三","周四","周五","周六"],"zh","zh","s"],"zh-SG":[["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],"zh","zh-CN","zh","zh","s"],"zh-HK":["zh-SG","zh","zh","zh","zh-SG","t"],"zh-MO":["zh-SG","zh","zh","zh","zh-SG","t"],"zh-TW":["zh-SG","zh","zh","zh","zh-SG","t"],"de-DE":"de","de-AT":[["Jän","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],["Jänner","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."],"de","en","z"],"de-LI":[["Jan","Feb","Mär","Apr","Mai","Jun","Jul","Aug","Sep","Okt","Nov","Dez"],"de","de-AT","de","en","z"],"de-LU":["de-LI","de","de-AT","de","de-LI","z"],"de-CH":["de-LI","de","de-AT","de","de-LI","z"],"hr-HR":"hr","hr-BA":[["sij","velj","ožu","tra","svi","lip","srp","kol","ruj","lis","stu","pro"],"hr","hr","hr","en","z"],"nl-NL":"nl","nl-BE":"nl","sv-SE":"sv","sv-FI":[["jan.","feb.","mars","apr.","maj","juni","juli","aug.","sep.","okt.","nov.","dec."],"sv","sv","sv",["fm","em"],"z"],"it-IT":"it","it-CH":"it","ro-RO":"ro","ro-MD":["ro","ro",["Du","Lu","Mar","Mie","Jo","Vi","Sâ"],"ro","ro","z"],"ru-RU":"ru","ru-MD-x-genlower":[["янв.","февр.","март","апр.","май","июнь","июль","авг.","сент.","окт.","нояб.","дек."],["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"],"ru","ru","en","z"],"sr-Latn-RS":"sr","sr-Latn-BA":[["jan","feb","mart","apr","maj","jun","jul","avg","sept","okt","nov","dec"],"sr","hr","hr",["prije podne","po podne"],"z"],"sr-Latn-CS":[["jan.","feb.","mart","apr.","maj","jun","jul","avg.","sept.","okt.","nov.","dec."],"sr",["ned.","pon.","uto.","sre.","čet.","pet.","sub."],"sr","en","z"],"uk-UA-x-genlower":["uk",["січня","лютого","березня","квітня","травня","червня","липня","серпня","вересня","жовтня","листопада","грудня"],"uk","uk","uk","z"],"uk-UA":"uk","bg-BG":"bg","cs-CZ":"cs","da-DK":["sv","da","da","da","sv","z"],"el-GR":"el","et-EE":"et","fi-FI":"fi","he-IL":"he","hu-HU":"hu","id-ID":"id","ja-JP":"ja","ko-KR":["ja","ko","ko","ko","ko","k"],"lt-LT":"lt","lv-LV":"lv","nb-NO":["nb","nb","nb","da","nb","z"],"pl-PL":"pl","pt-BR":"pt","pt-PT":"pt","sk-SK":["ja","sk","sk","sk","en","z"],"sl-SI":"sl","th-TH":"th","tr-TR":"tr","vi-VN":"vi","ta-IN":"ta","syr-SY":"syr","eu-ES":"eu","be-BY-x-genlower":["be",["студзеня","лютага","сакавіка","красавіка","мая","чэрвеня","ліпеня","жніўня","верасня","кастрычніка","лістапада","снежня"],"be","be","be","z"],"be-BY":"be","dv-MV":"dv","hi-IN":"hi"};function D(e){var t=e.culture,r=e.tag;if("number"!=typeof t){var n=t;return void 0!==r&&(""!==t&&(n+="-"),n+="x-"+String(r)),void 0===_&&(_=function(){for(var e={},t=["monthNameShort","monthNameLong","dayNameShort","dayNameLong","ampmSymbols"],r=0,n=Object.keys(M);r<n.length;r++){var a=n[r],i=M[a];if("string"!=typeof i){var c=i.slice(0,5).map((function(r,n){if("string"==typeof r){var a=e[r];return Object(o.h)("calc.numfmt.buildBundledLocaleData: ref prior culture 2",void 0!==a),a[t[n]]}return r})),u=c[0],s=c[1],l=c[2],d=c[3],f=c[4],b=i[5],h="k"===b,v="j"===b,p="t"===b,m="s"===b,g=h||v||p||m;e[a]={monthNameShort:u,monthNameLong:s,dayNameShort:l,dayNameLong:d,ampmSymbols:f,isEastAsia:g,isKorea:h,isJapan:v,isChinaT:p,isChinaS:m}}else{var O=e[i];Object(o.h)("calc.numfmt.buildBundledLocaleData: ref prior culture",void 0!==O),e[a]=O}}return e}()),_[n]}}var P,x,L,B,U,G,V,H,W,z,q=((I={})[i.b.USA]="en-US",I[i.b.Greek]="el-GR",I[i.b.Hungarian]="hu-HU",I[i.b.Turkish]="tr-TR",I[i.b.Thailand]="th-TH",I[i.b.Vietnam]="vi-VN",I[i.b.Arabic]="ar-SA",I[i.b.Hebrew]="he-IL",I[i.b.Tamil]="ta-IN",I[i.b.Syriac]="syr-SY",I[i.b.Iraq]="ar-IQ",I[i.b.Algerian]="ar-DZ",I[i.b.Basque]="eu-ES",I[i.b.PortBrazil]="pt-BR",I[i.b.Croatian]="hr-HR",I[i.b.Czech]="cs-CZ",I[i.b.Danish]="da-DK",I[i.b.Dutch]="nl-NL",I[i.b.Australian]="en-AU",I[i.b.CanadianEnglish]="en-CA",I[i.b.British]="en-GB",I[i.b.Finnish]="fi-FI",I[i.b.French]="fr-FR",I[i.b.FrenchCanadian]="fr-CA",I[i.b.Italian]="it-IT",I[i.b.NorskBokmal]="nb-NO",I[i.b.NorskNynorsk]="nn-NO",I[i.b.Polish]="pl-PL",I[i.b.PortIberian]="pt-PT",I[i.b.Romanian]="ro-RO",I[i.b.Russian]="ru-RU",I[i.b.Ukrainian]="uk-UA",I[i.b.Belarusian]="be-BY",I[i.b.SerbianCyrillic]="sr-Cyrl-CS",I[i.b.SerbianLatin]="sr-Latn-CS",I[i.b.Slovak]="sk-SK",I[i.b.Slovenian]="sl-SI",I[i.b.SpanishModern]="es-ES",I[i.b.Swedish]="sv-SE",I[i.b.HongKong]="zh-HK",I[i.b.ChinaT]="zh-TW",I[i.b.Korea]="ko-KR",I[i.b.Japan]="ja-JP",I[i.b.China]="zh-CN",I[i.b.Devihi]="dv-MV",I[i.b.Hindi]="hi-IN",I[i.b.German]="de-DE",I[i.b.Swiss]="fr-CH",I);var K=m.t,Y=m.v,J=m.j,Q=m.o,X=m.n,Z=m.h,$=m.i,ee=m.s,te=m.x,re=m.B,ne=m.c,ae={decimalSeparator:"NOTUSED"};function ie(e,t,r,n){var a=e.formatFixed(t,0,0),i=a.mantissa,c=a.exponent;Object(o.h)("calc.numfmt.dtrInteger: mantissa len <= exponent",i.length<=c),Object(o.h)("calc.numfmt.dtrInteger: mantissa || !exponent",0!==i.length||0===c);var u=Object(p.a)(c<r?Object(f.f)("0",r-c):"",n),s=Object(p.b)(ae,i+Object(f.f)("0",c-i.length),n);if(!Object(j.d)(s))throw new Ue(s.reason);return u+s.value}function oe(e,t,r,n,a){var i=e.formatFixed(t,0,0),c=i.mantissa,u=i.exponent;Object(o.h)("calc.numfmt.dtrFracSeconds: mantissa len <= exponent",c.length<=u),Object(o.h)("calc.numfmt.dtrFracSeconds: mantissa || !exponent",0!==c.length||0===u);var s=((u<r?Object(f.f)("0",r-u):"")+c+Object(f.f)("0",u-c.length)).substring(0,n);return Object(p.a)(s,a)}function ce(e,t){var r=e.formatFixed(t,0,0),n=r.mantissa,a=r.exponent;return Object(o.h)("calc.numfmt.formatInt: mantissa len <= exponent",n.length<=a),Object(o.h)("calc.numfmt.formatInt: mantissa || !exponent",0!==n.length||0===a),""===n?"0":n.length<a?n+Object(f.f)("0",a-n.length):n}function ue(e){for(var t=[],r=0;r<e.length;r+=1){var a=e[r];switch(a.kind){case n.i.Blank:case n.i.String:for(var i=a.str;r+1<e.length;){var o=e[r+1];if(o.kind!==a.kind)break;i+=o.str,r+=1}t.push({kind:a.kind,str:i});break;case n.i.Flexible:case n.i.General:t.push(a)}}return t}var se,le=function(e){return e.kind===n.i.Flexible},de=((P={})[1]=g.e.ChineseTrad1,P[2]=g.e.ChineseTrad2,P[3]=g.e.ChineseTrad3,P),fe=((x={})[1]=g.e.ChineseSimp1,x[2]=g.e.ChineseSimp2,x[3]=g.e.ChineseSimp3,x),be=((L={})[1]=g.e.Japanese1,L[2]=g.e.Japanese2,L[3]=g.e.Japanese3,L),he=((B={})[1]=g.e.Korean1,B[2]=g.e.Korean2,B[3]=g.e.Korean3,B[4]=g.e.Korean4,B);function ve(e){return e+1}!function(e){e[e.Ne=0]="Ne",e[e.Le=1]="Le",e[e.Ge=2]="Ge",e[e.Eq=3]="Eq",e[e.Lt=4]="Lt",e[e.Gt=5]="Gt"}(se||(se={}));var pe,me=Object(f.d)(((U={})[se.Ne]="<>",U[se.Le]="<=",U[se.Ge]=">=",U[se.Eq]="=",U[se.Lt]="<",U[se.Gt]=">",U)),ge=((G={})[se.Ne]=l.a.Ne,G[se.Le]=l.a.Le,G[se.Ge]=l.a.Ge,G[se.Eq]=l.a.Eq,G[se.Lt]=l.a.Lt,G[se.Gt]=l.a.Gt,G),Oe=((V={})[l.a.Ne]=se.Ne,V[l.a.Le]=se.Le,V[l.a.Ge]=se.Ge,V[l.a.Eq]=se.Eq,V[l.a.Lt]=se.Lt,V[l.a.Gt]=se.Gt,V);function je(e,t,r,n){for(var a=0;a<t.length;a+=1){var i=t[a];if(null!=i&&!(n+i.length>r.length)){var o=r.substring(n,n+i.length);if(0===e.stringCompareCI(i,o))return Number(a)}}}function ye(e,t,r,n){for(var a=0;a<t.length;a+=1){var i=t[a];if(null!=i&&Object(f.h)(r,i,n))return Number(a)}return je(e,t,r,n)}function Se(e,t){var r;return null!==(r=e[t])&&void 0!==r?r:""}function Ce(e,t){var r=t.indexOf(Se(e.pictureSingle,i.g.APDelim));return r<0&&(r=t.length>>1),[t.substring(0,r),t.substring(r+1)]}!function(e){e[e.AMPM=100]="AMPM",e[e.AMPMFE=101]="AMPMFE",e[e.General=102]="General",e[e.Currency=103]="Currency",e[e.Color=200]="Color",e[e.Dbnum=201]="Dbnum",e[e.Cond=202]="Cond",e[e.CurrCode=203]="CurrCode",e[e.Char=300]="Char",e[e.StrLit=301]="StrLit",e[e.Numeral=302]="Numeral",e[e.PrefixDigTh=303]="PrefixDigTh",e[e.LatinDate=304]="LatinDate",e[e.BidiDate=305]="BidiDate",e[e.Exp=306]="Exp"}(pe||(pe={}));var ke=/^[0-9A-F]{1,8}$/i,Ee=/^(?:([a-z]{2,}(?:-[A-Z0-9]{2,}(?:_[A-Z0-9]+)?)*)(?:-x-([a-z]+))?|x-([a-z0-9]+))?(?:,([0-9A-F]{1,4}))?$/i,Ae=Object(f.d)(((H={})[1]=g.e.ASCII,H[2]=g.e.ArabicIndic,H[3]=g.e.ExtendedArabicIndic,H[4]=g.e.Devanagari,H[5]=g.e.Bengali,H[6]=g.e.Gurmukhi,H[7]=g.e.Gujarati,H[8]=g.e.Oriya,H[9]=g.e.Tamil,H[10]=g.e.Telugu,H[11]=g.e.Kannada,H[12]=g.e.Malayalam,H[13]=g.e.Thai,H[14]=g.e.Lao,H[15]=g.e.Tibetan,H[16]=g.e.Myanmar,H[17]=g.e.Ethiopic,H[18]=g.e.Khmer,H[19]=g.e.Mongolian,H[27]=g.e.Japanese1,H[28]=g.e.Japanese2,H[29]=g.e.Japanese3,H[30]=g.e.ChineseSimp1,H[31]=g.e.ChineseSimp2,H[32]=g.e.ChineseSimp3,H[33]=g.e.ChineseTrad1,H[34]=g.e.ChineseTrad2,H[35]=g.e.ChineseTrad3,H[36]=g.e.Korean1,H[37]=g.e.Korean2,H[38]=g.e.Korean3,H[39]=g.e.Korean4,H)),Ne=Object(f.d)(((W={})[1]=g.a.Gregorian,W[2]=g.a.GregorianUS,W[3]=g.a.Japan,W[4]=g.a.Taiwan,W[5]=g.a.Korea,W[6]=g.a.Hijri,W[7]=g.a.Thai,W[8]=g.a.Hebrew,W[9]=g.a.GregorianMEFrench,W[10]=g.a.GregorianArabic,W[11]=g.a.GregorianXlitEnglish,W[12]=g.a.GregorianXlitFrench,W)),Te=Object.keys(n.d).reduce((function(e,t){var r=n.d[t];return e[String(r)]=r,e}),Object.create(null));function Re(e){return e.toString(16).toUpperCase()}function Ie(e){return Number("0x"+e)}var _e=((z={})[i.g.Hour]=O.b.Hour,z[i.g.HourTh]=O.b.Hour,z[i.g.Minute]=O.b.Minute,z[i.g.MinuteTh]=O.b.Minute,z[i.g.Second]=O.b.Second,z[i.g.SecondTh]=O.b.Second,z);function Fe(e){return 400===e.kind?e.formattedStr:void 0}var we={kind:pe.General};function Me(e){return 1===e.length&&e[0].kind===pe.General}var De={code:[we],color:void 0,dbnum:void 0,dtrRounding:O.a.RoundSec};function Pe(e){return void 0===e.color&&void 0===e.dbnum&&Me(e.code)}function xe(e){return void 0===e.color&&void 0===e.dbnum&&(1===(t=e.code).length&&t[0].kind===i.g.Text);var t}var Le={},Be=Object(c.c)("ApplyHashesError"),Ue=Object(c.c)("ApplyError"),Ge=Object(c.c)("InitError"),Ve=function(){function e(e,t){this.config=e,this.hasPercent=!1,this.hasDate=!1,this.hasTime=!1,this.posBeforeText=!0,this.onlyOneNumberPart=!0,this.parts=[void 0,void 0,void 0,void 0],void 0===t.old?(this.logFormatString=Object(w.b)(t.formatString),this.source=t.source,this.parseString(t.formatString)):(this.hasPercent=t.old.hasPercent,this.hasDate=t.old.hasDate,this.hasTime=t.old.hasTime,this.posBeforeText=t.old.posBeforeText,this.onlyOneNumberPart=t.old.onlyOneNumberPart,this.parts=t.synth,this.thisCurrCode=t.old.thisCurrCode,this.thisCurrencySymbol=t.old.thisCurrencySymbol,this.applyCurrCode=t.old.applyCurrCode,this.condPos=t.old.condPos,this.condNeg=t.old.condNeg,this.logFormatString=t.logFormatString,this.source=n.l.CustomString,this.checkBytecode()),this.formatString=this.printFormatString(),this.valueType=this.determineValueType(),this.decimals=this.determineDecimals(),this.bidiDate=this.determineBidiDate()}return Object.defineProperty(e.prototype,"isPercent",{get:function(){return this.hasPercent},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isDate",{get:function(){return this.hasDate},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTime",{get:function(){return this.hasTime},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isTextOnly",{get:function(){return!this.posBeforeText},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"culture",{get:function(){return this.thisCurrCode},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currencySymbol",{get:function(){return this.thisCurrencySymbol},enumerable:!1,configurable:!0}),e.prototype.apply=function(e,t,r,n){try{return Object(j.f)(this.applyImpl(e,t,r,n))}catch(e){return e instanceof Ue?Object(j.c)(e.reason):Object(j.c)(Object(j.e)(Object(f.e)(e,"(while applying format ".concat(this.logFormatString,")"))))}},e.prototype.applyImpl=function(e,t,r,a){var i,u=this.config,s=u.mathpack,l=u.localeInfo;if(this.valueType===n.h.General){var d=void 0;if(Object(c.ab)(e))return Object(n.u)([Object(n.t)(e.value)],d,t,r);if(!a&&0===s.cond(e))return Object(n.u)([],d,t,r);var f=Object(n.s)(s.toNumber(e),l.decimalSeparator,!0,g.e.ASCII,g.e.ASCII,!0);return Object(n.u)([f],d,t,r)}for(var b=!1;;){var h=void 0;try{var v=void 0,p=!1,m=[];if(Object(c.ab)(e))v=3;else{var O=s.cond(e);void 0!==this.condPos||void 0!==this.condNeg?(v=(i=this.getPart(e)).partKind,p=i.forceNeg):v=O<0?1:O>0?0:2,O<0&&(this.onlyOneNumberPart||p)&&m.push(Object(n.t)("-"))}d=(h=this.parts[v]).color;var j=h.dbnum,y=h.code,S=h.dtrRounding;if(!a&&2===v&&h===this.parts[0]&&!b)return Object(n.u)([],d,t,r);var C=this.getNumShape(j);this.applyPart({dtrRounding:S,dbnum:j,forceNeg:p,units:m,numShape:C},y,e,void 0);var k=r|(3!==v||Pe(h)||xe(h)?n.c.None:n.c.MaxChars),E=m.some(le)?n.a.Left:t;return Object(n.u)(ue(m),d,E,k)}catch(t){if(t===Le){Object(o.h)("calc.numfmt.NumberFormatImpl: applyImpl restart",!Object(c.ab)(e)&&0!==s.cond(e)),e=s.zero,b=!0;continue}if(t instanceof Be)return Object(n.x)(t.reason,null==h?void 0:h.color);throw t}}},e.prototype.applyPart=function(e,t,r,a){for(var s,l,d,v,m=this,O=this.config,y=O.mathpack,S=O.datepack,C=O.localeInfo,k=function(){var t,a;if(void 0!==v)return v;Object(o.h)("calc.numfmt.NumberFormatImpl: applyPart getDtr value",!Object(c.ab)(r));var i=m.config,u=i.date1904,s=i.dateCompatibility;if(!s&&y.cond(r)<0)throw new Be(n.o);if(s&&!u&&y.cond(r)<0)throw new Be(n.o);var l=S.fromNum(m.config,y.abs(r),e.dtrRounding);if(!1===l)throw new Be(n.o);var d=null!==(a=null===(t=m.applyCurrCode)||void 0===t?void 0:t.calendar)&&void 0!==a?a:g.a.Gregorian;if(d!==g.a.Gregorian)throw new Ue(Object(c.hb)(["calendar: "+d]));return Object(o.h)("calc.numfmt.NumberFormatImpl: components within range",l.yr>=0&&l.mon>=1&&l.mon<=12&&l.dom>=0&&l.dom<=31&&l.hour>=0&&l.hour<=23&&l.min>=0&&l.min<=59&&l.sec>=0&&l.sec<=59&&l.fracSec>=0&&l.wdy>=1&&l.wdy<=7),v=l},E=function(){if(void 0!==v)throw new Ue(Object(c.hb)(["use of value after date component"]));return r},A=!1,N=e.numShape,R=e.units,I=0;I<t.length;I+=1){var _=t[I];switch(_.kind){case pe.General:A=!0;var F=E();if(Object(c.ab)(F))R.push(Object(n.t)(F.value));else{var w=y.abs(F);if(y.cond(F)<0&&"0"===y.formatGeneral(C,w,1))throw new Ue(Object(c.hb)(["potential LRestart in interval (-0.5,0)"]));var M=Object(n.s)(y.toNumber(w),C.decimalSeparator,!1,N,this.getNumShape(void 0),this.valueType===n.h.General);if(void 0!==e.dbnum){var D=T(y,M,255);if(!Object(j.d)(D))throw new Ue(D.reason);Object(o.h)("calc.numfmt.NumberFormatImpl: applyPart General renderRes",!1!==D.value),R.push(Object(n.t)(D.value));break}R.push(M)}break;case i.g.Text:var P=E();Object(o.h)("calc.numfmt.NumberFormatImpl: applyPart Text value",Object(c.ab)(P)),R.push(Object(n.t)(P.value));break;case pe.Exp:case i.g.Slash:case 400:R.push(Object(n.t)(_.formattedStr));break;case i.g.Star:R.push(Object(n.r)(_.escaped));break;case i.g.Underscore:R.push(Object(n.q)(_.escaped));break;case pe.StrLit:R.push(Object(n.t)(_.escaped));break;case i.g.Percent:case pe.Numeral:R.push(Object(n.t)(_.formattedStr));break;case pe.Currency:R.push(Object(n.t)(C.currencySymbol));break;case pe.CurrCode:var x=_.currencySymbol,L=_.currCode;Object(o.h)("calc.numfmt.NumberFormatImpl: applyPart system tag",!Object(n.A)(null==L?void 0:L.tag)),void 0!==x&&R.push(Object(n.t)(x));break;case 405:R.push(Object(n.t)(C.dateSeparator));break;case 406:_.printAsTimeSep?R.push(Object(n.t)(C.timeSeparator)):R.push(Object(n.t)(_.formattedStr));break;case 403:var B=E();Object(o.h)("calc.numfmt.NumberFormatImpl: applyPart Num value",!Object(c.ab)(B)),Object(o.h)("calc.numfmt.NumberFormatImpl: applyPart Num numState",void 0===a);var U=_.numDigLeft,G=_.numDigDec,V=2*(te=_.numPercent)-3*(re=_.numThousands),H=y.formatFixed(B,V,G),W=H.mantissa,z=H.exponent;if(Object(o.h)("calc.numfmt.NumberFormatImpl: applyPart Num mantissa || !exponent",0!==W.length||0===z),Object(o.h)("calc.numfmt.NumberFormatImpl: applyPart Num mantissa len",W.length<=z+G),y.cond(B)<0&&(this.onlyOneNumberPart||e.forceNeg)&&0===W.length)throw Le;this.applyPart(e,_.codeBefore,y.zero,void 0),this.applyPart(e,_.code,y.zero,{comma:_.comma,fractionDenom:!1,decimal:!1,digits:W,digitsExp:z,numDigLeft:U});break;case 402:var q=E();Object(o.h)("calc.numfmt.NumberFormatImpl: applyPart Exp value",!Object(c.ab)(q)),Object(o.h)("calc.numfmt.NumberFormatImpl: applyPart Exp numState",void 0===a);var K=_.numMantDigLeft,Y=_.numMantDigDec,J=0===K&&0===Y,Q=y.formatScientific(q,K,Y);W=Q.mantissa,z=Q.exponent;Object(o.h)("calc.numfmt.NumberFormatImpl: applyPart Exp mantissa || !exponent",0!==W.length||0===z||J);var X=Object(b.a)(z,K);Object(o.h)("calc.numfmt.NumberFormatImpl: applyPart Exp mantissa len",W.length<=X+Y),this.applyPart(e,_.codeMant,y.zero,{comma:_.commaMant,fractionDenom:!1,decimal:!1,digits:W,digitsExp:X,numDigLeft:_.numMantDigLeft}),this.applyPart(e,_.codeBetween,y.zero,void 0);var Z=""!==W||J?z-X:0;Z<0?R.push(Object(n.t)("-")):_.isNeg||R.push(Object(n.t)("+"));var $=ce(y,y.fromNumber(Z));this.applyPart(e,_.codeExp,y.zero,{comma:_.commaMant,fractionDenom:!1,decimal:!1,digits:$,digitsExp:$.length,numDigLeft:_.numExpDigLeft});break;case 401:var ee=E();Object(o.h)("calc.numfmt.NumberFormatImpl: applyPart Fraction value",!Object(c.ab)(ee)),Object(o.h)("calc.numfmt.NumberFormatImpl: applyPart Fraction numState",void 0===a);var te=_.numPercent,re=_.numThousands,ne=_.numIntDigLeft,ae=_.numNumerDig,ue=_.numDenomDig,se=_.commaInt,le=_.denomValue,de=(V=2*te-3*re,y.tenTo(V)),fe=Object(c.E)(de)?de:y.mul(y.abs(ee),de);if(Object(c.E)(fe))throw new Ue(Object(c.hb)(["overflow on fraction exp adjust"]));var be=function(e){for(var t=e;t<R.length;t+=1){var r=R[t];r.kind===n.i.String&&(R[t]=Object(n.q)(r.str))}},he=_.anyZeroNumer,ve=void 0,me=void 0,ge=void 0;if(void 0!==_.codeInt){var Oe=y.trunc(fe),je=y.sub(fe,Oe);if(Object(o.h)("calc.numfmt.NumberFormatImpl: applyPart fracPart sub",Object(c.M)(je)),ve=(s=this.formFraction(je,le,ue)).numer,me=s.denom,Object(o.h)("calc.numfmt.NumberFormatImpl: applyPart numer <= denom",y.cond2(ve,me)<=0),0===y.cond2(ve,me)){ve=y.zero;var ye=y.add(Oe,y.one);Object(o.h)("calc.numfmt.NumberFormatImpl: applyPart bumped error",Object(c.M)(ye)),Oe=ye}0!==y.cond(ve)&&(he=!0);var Se=ce(y,Oe),ke={comma:se,fractionDenom:!1,decimal:!1,digits:Se,digitsExp:Se.length,numDigLeft:ne},Ee=R.length;this.applyPart(e,_.codeInt,y.zero,ke),ge=R.length,Object(o.h)("calc.numfmt.NumberFormatImpl: applyPart Fraction lastDigInt",void 0!==_.lastDigInt),0!==y.cond(Oe)||!he||_.lastDigInt===i.g.Zero?this.applyPart(e,_.codeBetween1,y.zero,void 0):(_.lastDigInt!==i.g.Question&&(R.length=Ee),this.applyPart(e,_.codeBetween1,y.zero,void 0),be(Ee),_.firstDigNumer!==i.g.Question&&(R.length=Ee))}else{if(ve=(l=this.formFraction(fe,le,ue)).numer,me=l.denom,y.cond(ee)<0&&(this.onlyOneNumberPart||e.forceNeg)&&0===y.cond(ve))throw Le;he=!0,ge=R.length}var Ae=ce(y,ve),Ne={comma:!1,fractionDenom:!1,decimal:!1,digits:Ae,digitsExp:Ae.length,numDigLeft:ae};this.applyPart(e,_.codeNumer,y.zero,Ne),this.applyPart(e,_.codeBetween2,y.zero,void 0);var Te=ce(y,me),Re={comma:!1,fractionDenom:!0,decimal:Ne.decimal,digits:Te,digitsExp:Te.length,numDigLeft:ue};this.applyPart(e,_.codeDenom,y.zero,Re),he||(_.anyQuestionNumer||_.firstDigDenom===i.g.Question?be(ge):R.length=ge);break;case i.g.Decimal:Object(o.h)("calc.numfmt.NumberFormatImpl: applyPart Decimal numState",void 0!==a),a.digitsExp>0&&(a.numDigLeft=a.digitsExp,this.dumpDigLeft(e,a,a.digitsExp)),a.decimal=!0,R.push(Object(n.t)(C.decimalSeparator));break;case i.g.Hash:case i.g.Zero:case i.g.Question:Object(o.h)("calc.numfmt.NumberFormatImpl: applyPart H/Z/Q numState",void 0!==a);var Ie=_.count;if(a.decimal||a.fractionDenom&&_.kind===i.g.Question){if(a.fractionDenom&&I!==t.length-1)throw new Ue(Object(c.hb)(["left-align bug in denominator"]));if(a.digitsExp<0){var Fe=Object(h.c)(Ie,-a.digitsExp),we=Object(p.a)(Object(f.f)("0",Fe),N);R.push(Object(n.t)(we)),a.digitsExp+=Fe,Ie-=Fe}var Me=Object(h.c)(Ie,a.digits.length);we=Object(p.a)(a.digits.substring(0,Me),N);if(R.push(Object(n.t)(we)),a.digits=a.digits.substring(Me),Ie-=Me,_.kind!==i.g.Hash&&Ie>0){we=Object(p.a)(Object(f.f)("0",Ie),N);R.push(_.kind===i.g.Question?Object(n.q)(we):Object(n.t)(we))}break}if(a.numDigLeft>a.digitsExp){Fe=Object(h.c)(Ie,a.numDigLeft-a.digitsExp);if(_.kind!==i.g.Hash){we=Object(p.a)(Object(f.f)("0",Fe),N);a.comma&&(we=Object(p.c)(C,we,a.numDigLeft-Fe)),R.push(_.kind===i.g.Question?Object(n.q)(we):Object(n.t)(we))}Ie-=Fe,a.numDigLeft-=Fe}else Ie+=a.digitsExp-a.numDigLeft,a.numDigLeft=a.digitsExp;this.dumpDigLeft(e,a,Ie);break;case pe.PrefixDigTh:C.isThai&&(N=e.numShape=g.e.Thai);break;case pe.LatinDate:throw new Ue(Object(c.hb)(["TokenKind.LatinDate"]));case pe.BidiDate:throw new Ue(Object(c.hb)(["TokenKind.BidiDate"]));case i.g.HourTh:throw new Ue(Object(c.hb)(["PictureSingle.HourTh"]));case i.g.MinuteTh:throw new Ue(Object(c.hb)(["PictureSingle.MinuteTh"]));case i.g.SecondTh:throw new Ue(Object(c.hb)(["PictureSingle.SecondTh"]));case i.g.Hour:case i.g.Minute:case i.g.Second:if(_.isAbs){var De=E();Object(o.h)("calc.numfmt.NumberFormatImpl: applyPart H/M/S value",!Object(c.ab)(De));var Pe=S.toTime(this.config,y.abs(De),_e[_.kind],e.dtrRounding);if(!1===Pe)throw new Ue(Object(c.hb)(["absolute time overflow"]));R.push(Object(n.t)(ie(y,y.fromNumber(Pe),_.count,N)))}else{var xe=k(),Ge=void 0;_.kind===i.g.Minute?Ge=xe.min:_.kind===i.g.Second?Ge=xe.sec:(Ge=xe.hour,_.isAMPM&&(Ge>12&&(Ge-=12),0===Ge&&(Ge=12))),R.push(Object(n.t)(ie(y,y.fromNumber(Ge),_.count,N)))}break;case pe.AMPM:case pe.AMPMFE:var Ve=void 0;if(Ve=!!Object(c.ab)(r)||k().hour<12,(void 0===(null===(d=this.applyCurrCode)||void 0===d?void 0:d.culture)||_.kind===pe.AMPMFE)&&(_.kind===pe.AMPMFE||C.isEastAsia||_.pictureKind===i.h.AP2)){var He=Ce(C,_.tokenStr);R.push(Object(n.t)(He[Ve?0:1]));break}var We=this.getBundledLocaleInfo("localised AM/PM string",this.applyCurrCode);R.push(Object(n.t)(We.ampmSymbols[Ve?0:1]));break;case 404:var ze=k();Object(o.h)("calc.numfmt.NumberFormatImpl: applyPart FracSeconds rounding",ze.rounding>=_.rounding);var qe=oe(y,y.fromNumber(ze.fracSec),ze.rounding,_.rounding,N);R.push(Object(n.t)(C.decimalSeparator+qe));break;case i.g.Era:throw new Ue(Object(c.hb)(["PictureSingle.Era"]));case i.g.EraYear:throw new Ue(Object(c.hb)(["PictureSingle.EraYear"]));case i.g.YearTh:throw new Ue(Object(c.hb)(["PictureSingle.YearTh"]));case i.g.EngYearTh:throw new Ue(Object(c.hb)(["PictureSingle.EngYearTh"]));case i.g.ThYear:throw new Ue(Object(c.hb)(["PictureSingle.ThYear"]));case i.g.MonthTh:throw new Ue(Object(c.hb)(["PictureSingle.MonthTh"]));case i.g.DayTh:throw new Ue(Object(c.hb)(["PictureSingle.DayTh"]));case i.g.Year:var Ke=k().yr;Ge=_.count>2?Ke:Ke%100;R.push(Object(n.t)(ie(y,y.fromNumber(Ge),_.count,N)));break;case i.g.Month:var Ye=k().mon;switch(_.count){case 1:case 2:R.push(Object(n.t)(ie(y,y.fromNumber(Ye),_.count,N)));break;case 3:case 4:case 5:We=this.getBundledLocaleInfo("localised month string",this.applyCurrCode);if(3===_.count)R.push(Object(n.t)(We.monthNameShort[Ye-1]));else if(4===_.count)R.push(Object(n.t)(We.monthNameLong[Ye-1]));else{var Je=We.monthNameLong[Ye-1];R.push(Object(n.t)(Je.substring(0,Object(u.f)(Object(u.i)(Je,0)))))}}break;case i.g.Day:case i.g.LocDay:if(_.count<3){var Qe=k().dom;R.push(Object(n.t)(ie(y,y.fromNumber(Qe),_.count,N)))}else{var Xe=k().wdy,Ze=void 0;Ze=C.isEastAsia&&_.kind===i.g.Day?Object(i.s)():this.getBundledLocaleInfo("localised day string",this.applyCurrCode);we=3===_.count?Ze.dayNameShort[Xe-1]:Ze.dayNameLong[Xe-1];R.push(Object(n.t)(we))}break;case 407:Object(o.h)("calc.numfmt.NumberFormatImpl: applyPart SysFormat numState",void 0===a),this.applyPart(e,_.codeSysFormat,r,a);break;default:return Object(o.e)("calc.numfmt.NumberFormatImpl: applyPart code",_)}}A&&E()},e.prototype.dumpDigLeft=function(e,t,r){var a=this.config.localeInfo,i=e.units,o=e.numShape,c=r,u=Object(h.c)(c,t.digits.length),s=Object(p.a)(t.digits.substring(0,u),o);if(t.comma&&(s=Object(p.c)(a,s,t.numDigLeft-u)),i.push(Object(n.t)(s)),t.digits=t.digits.substring(u),c-=u,t.digitsExp-=u,t.numDigLeft-=u,c>0){s=Object(p.a)(Object(f.f)("0",c),o);t.comma&&(s=Object(p.c)(a,s,t.numDigLeft-c)),i.push(Object(n.t)(s)),t.digitsExp-=c,t.numDigLeft-=c}},e.prototype.getPart=function(e){for(var t=this.config.mathpack,r=0;r<2;r+=1){var a=r,i=void 0;if(0===r){if(void 0===(i=this.condPos)&&t.cond(e)>0)return{partKind:a,forceNeg:!1}}else{if(this.parts[a]===this.parts[0])throw new Be(n.C);if(0===this.parts[0].code.length)throw new Ue(Object(c.hb)(['emulation of ";[COND]foo" bug']));if(void 0===(i=this.condNeg)){if(this.parts[2]===this.parts[0])return Object(o.h)("calc.numfmt.NumberFormatImpl: getPart condPos",void 0!==this.condPos),{partKind:a,forceNeg:t.cond(this.condPos.operand)>0||this.condPos.operator===l.a.Eq};if(t.cond(e)<0)return{partKind:a,forceNeg:!1}}}if(void 0!==i){var u=i.operator,s=i.operand,d=t.sub(e,s);if(Object(c.E)(d))throw new Ue(Object(c.hb)(["overflow in condition check"]));if(Object(v.c)(u,t.cond2(e,s)))switch(u){case l.a.Eq:return{partKind:a,forceNeg:!1};case l.a.Ne:case l.a.Gt:case l.a.Ge:return{partKind:a,forceNeg:!0};case l.a.Lt:return{partKind:a,forceNeg:t.cond(s)>0};case l.a.Le:return{partKind:a,forceNeg:t.cond(s)>=0}}}}if(this.parts[2]===this.parts[0])throw new Be(n.C);return{partKind:2,forceNeg:!0}},e.prototype.getNumShape=function(e){var t=this.applyCurrCode,r=null==t?void 0:t.numberShape;if(void 0!==r)return r;if(void 0===e)return g.e.ASCII;var n=this.getBundledLocaleInfo("localised DBNUM culture",t);return n.isEastAsia&&(n.isKorea?r=he[e]:n.isJapan?r=be[e]:n.isChinaT?r=de[e]:n.isChinaS&&(r=fe[e])),null!=r?r:g.e.ASCII},e.prototype.formFraction=function(e,t,r){var a,i,u,s=this.config.mathpack;if(void 0!==t){var l=s.fromNumber(137438953472);if(Object(c.E)(s.sub(e,l)))throw new Ue(Object(c.hb)(["overflow in fraction threshold check"]));if(s.cond2(e,l)<0){var d=s.mul(e,s.fromNumber(1.0000000000000002));Object(o.h)("calc.numfmt.NumberFormatImpl: formFraction nudged error",Object(c.M)(d)),e=d}var f=t,b=s.toNumber(f)<<1,h=s.mul(e,s.fromNumber(b));if(!Object(c.M)(h))throw new Ue(Object(c.hb)(["overflow in fraction denom mul"]));var v=s.lfix(h);if(v<0||v>=65535)throw new Be(n.w);return{numer:s.fromNumber(v+1>>1),denom:f}}switch(r){case 1:u=10;break;case 2:u=100;break;case 3:u=1e3;break;case 4:u=1e4;break;case 5:u=1e5;break;case 6:u=1e6;break;default:u=1e7}var p=s.fix(e);if(p>=2147483647)throw new Be(n.w);for(var m=e,g=1,O=1,j=0,y=0;;){var S=g*p;y+=S;var C=j*p;if(O+=C,S>2147483647||C>2147483647||O>=u){1===j&&2===p&&0===s.cond2(m,s.trunc(m))&&(g+=1);break}g=(a=[y,g])[0],y=a[1],j=(i=[O,j])[0],O=i[1];var k=s.sub(m,s.trunc(m));if(Object(o.h)("calc.numfmt.NumberFormatImpl: formFraction frac sub",Object(c.M)(k)),0===s.cond(k))break;var E=s.div(s.one,k);if(Object(c.E)(E))throw new Ue(Object(c.hb)(["overflow in fraction inversion"]));if(m=E,(p=s.fix(m))>2147483647)break}return 0===j&&(j=g=1),{numer:s.fromNumber(g),denom:s.fromNumber(j)}},e.prototype.synthesizeDecimals=function(t){for(var r=this,n=Object(h.b)(0,Object(h.c)(t,127)),a=[],i=function(e){var t=o.parts[e];if((1===e||2===e)&&t===o.parts[0])return a.push(a[0]),"continue";if(3===e)return a.push(t===o.parts[0]?a[0]:t),"continue";var i=t.code,c=t.color,u=t.dbnum,s=t.dtrRounding,l={code:i.map((function(t){if(403===t.kind){var a=t.numDigLeft,i=t.numPercent,o=t.numThousands,c=t.comma,u=t.codeBefore;return{kind:403,numDigLeft:a,numDigDec:n,numPercent:i,numThousands:o,comma:c,code:r.adjustDecimals(e,t.numDigDec,t.code,n),codeBefore:u}}if(402===t.kind){var s=t.isNeg,l=t.numMantDigLeft,d=t.numExpDigLeft,f=t.commaMant,b=t.codeBetween,h=t.codeExp;return{kind:402,isNeg:s,numMantDigLeft:l,numMantDigDec:n,numExpDigLeft:d,commaMant:f,codeMant:r.adjustDecimals(e,t.numMantDigDec,t.codeMant,n),codeBetween:b,codeExp:h}}return t})),color:c,dbnum:u,dtrRounding:s};a.push(l)},o=this,c=0;c<=3;c+=1)i(c);try{var u=new e(this.config,{old:this,logFormatString:"synthesizeDecimals(dec=".concat(n," on ").concat(this.logFormatString,")"),synth:a});if(u.formatString.length>255)throw new Ge(this.notFormatString("format string too long: max length"));return u}catch(e){if(e instanceof Ge)return this;throw e}},e.prototype.adjustDecimals=function(e,t,r,n){var c;if(n===t)return r;for(var u=!1,s=void 0,l=void 0,d=void 0,f=0;f<r.length;f+=1){switch((S=r[f]).kind){case i.g.Decimal:void 0===d&&(d=f);break;case i.g.Hash:case i.g.Question:case i.g.Zero:void 0!==d?l=f:(s=f,S.kind===i.g.Question&&(u=!0))}}var b=function(e){return e===i.g.Percent||e===pe.Currency||e===pe.CurrCode||e===i.g.Star};if(0===n){if(void 0===d)return r;var v=0,p=0;void 0===s?void 0!==l&&(v=d+1,p=l+1):(v=d,p=(null!=l?l:d)+1);var m=r.slice(0,v);for(f=v;f<p;f+=1)b(r[f].kind)&&m.push(r[f]);return Object(h.p)(m,r.slice(p)),m}if(t>n){Object(o.h)("calc.numfmt.NumberFormatImpl: adjustDecimals dec",void 0!==d);var g=void 0;!function(e){e[e.AfterDigs=0]="AfterDigs",e[e.Dropping=1]="Dropping",e[e.Keeping=2]="Keeping"}(g||(g={}));var O=g.AfterDigs,j=[],y=t-n;for(f=r.length-1;f>=0;f-=1){f<=d&&(O=g.Keeping);var S=r[f];if(O===g.AfterDigs&&(S.kind!==i.g.Hash&&S.kind!==i.g.Question&&S.kind!==i.g.Zero||(O=g.Dropping)),O===g.Keeping||O===g.AfterDigs||b(S.kind))j.push(S);else if(S.kind===i.g.Hash||S.kind===i.g.Question||S.kind===i.g.Zero){var C=Object(h.c)(y,S.count);C<S.count&&j.push({kind:S.kind,count:S.count-C}),0===(y-=C)&&(O=g.Keeping)}}return j.reverse(),j}if(2===e&&u&&void 0===l)return r;var k=n-t;if(void 0!==l){var E=r.slice();S=E[l];return E[l]={kind:S.kind,count:S.count+k},E}var A=r.slice(),N=null!==(c=null!=d?d:s)&&void 0!==c?c:A.length-1,T=[];return void 0===d&&T.push({kind:i.g.Decimal}),T.push({kind:i.g.Zero,count:k}),A.splice.apply(A,Object(a.__spreadArray)([N+1,0],T,!1)),A},e.prototype.parseString=function(e){if(this.source!==n.l.CustomBytecode&&e.length>255)throw new Ge(this.notFormatString("format string too long: max length"));for(var t=!1,r=!1,a=0,i=!1,u=0;u<=3&&!i;u+=1){var s=this.tokenize(e.substring(a)),l=s.cond,d=s.currencySymbol,f=this.convertTokToSun(s),b=f.currCode,h=f.hasPercent,v=f.hasDate,p=f.hasTime,m=this.classifySunPartKind(f,3===u?3:0),g=this.convertSunToCode(f),O=g.part,j=g.applyCurrCode;if(a+=s.consumed,i=s.eos,h&&(this.hasPercent=!0),v&&(this.hasDate=!0),p&&(this.hasTime=!0),void 0!==b){if(0!==u&&(void 0===this.thisCurrCode||!Object(n.y)(this.thisCurrCode,b)))throw new Ge(Object(c.hb)(["inconsistent CurrCode in number parts"]));void 0===this.thisCurrCode&&(this.thisCurrCode=b)}if(void 0!==j&&void 0===this.applyCurrCode&&(this.applyCurrCode=j),void 0!==d&&void 0===this.thisCurrencySymbol&&(this.thisCurrencySymbol=d),this.source===n.l.System&&(Object(o.h)("calc.numfmt.NumberFormatImpl.parseString: system ipart",0===u),!i||3===m))throw new Ge(this.notFormatString("system format with more than one part"));if((3===m||0===u&&1===m)&&(t=!0,this.parts[3]=O,3===m)){if(void 0!==l)throw new Ge(this.notFormatString("condition in text part"));if(void 0!==b)throw new Ge(Object(c.hb)(["CurrCode in text part"]));break}if(r=!0,this.parts[u]=O,this.onlyOneNumberPart=0===u,0===u)this.parts[1]=O,this.parts[2]=O,this.condPos=l;else if(1===u)this.condNeg=l;else if(void 0!==l)throw new Ge(this.notFormatString("condition in zero part"))}if(!i)throw new Ge(this.notFormatString("too many parts"));r||(this.parts[0]=De,this.parts[1]=De,this.parts[2]=De,this.posBeforeText=!1),t||(this.parts[3]=De),r&&!t&&this.onlyOneNumberPart&&void 0!==this.condPos&&!Me(this.parts[0].code)&&(this.parts[1]=De,this.onlyOneNumberPart=!1),Object(o.h)("calc.numfmt.NumberFormatImpl.parseString: every part set",this.parts.every((function(e){return void 0!==e}))),this.checkBytecode()},e.prototype.tokenize=function(e){for(var t,r,a,o=this.config.localeInfo,u={color:void 0,dbnum:void 0,dbnumForbidden:!1,cond:void 0,currCode:void 0,currencySymbol:void 0,tokens:[],consumed:0,eos:!0};u.consumed<e.length&&u.eos;){var s=this.readToken(u,e,u.consumed),l=t;switch(t=s,u.consumed+=s.tokenStr.length,s.kind){case i.g.Sep:u.eos=!1;continue;case pe.Color:if(void 0!==u.color)throw new Ge(this.notFormatString("more than one color"));if(0!==u.tokens.length)throw new Ge(Object(c.hb)(["colour in middle of format"]));u.color=s.color;continue;case pe.Dbnum:if(void 0!==u.dbnum)throw new Ge(this.notFormatString("more than one DBNUM"));if(u.dbnumForbidden)throw new Ge(this.notFormatString("DBNUM after token which forbids it (% or E)"));if(0!==u.tokens.length)throw new Ge(Object(c.hb)(["DBNUM in middle of format"]));u.dbnum=s.dbnum;continue;case pe.Cond:if(void 0!==u.cond)throw new Ge(this.notFormatString("more than one condition"));if(0!==u.tokens.length)throw new Ge(Object(c.hb)(["condition in middle of format"]));u.cond=s.cond;continue;case pe.CurrCode:if(void 0!==r)throw new Ge(this.notFormatString("more than one currency code in section"));r=s;break;case pe.Currency:a=s;break;case pe.AMPM:case pe.AMPMFE:case i.g.Colon:case i.g.DateSep:case pe.LatinDate:case pe.BidiDate:case i.g.Year:case i.g.Month:case i.g.Day:case i.g.Hour:case i.g.Minute:case i.g.Second:case i.g.Reign:case i.g.LocDay:case i.g.Era:case i.g.EraYear:case i.g.EngYearTh:case i.g.DayTh:case i.g.MonthTh:case i.g.YearTh:case i.g.ThYear:case i.g.HourTh:case i.g.MinuteTh:case i.g.SecondTh:if((null==l?void 0:l.kind)===s.kind){l.count+=s.count;continue}}u.tokens.push(s)}return void 0!==r?(u.currCode=r.currCode,u.currencySymbol=r.currencySymbol):void 0!==a&&void 0===u.currencySymbol&&(u.currencySymbol=n.f.LocaleInfo),4!==u.dbnum||o.isKorea||void 0===u.currCode&&!o.isThai||(u.dbnum=void 0),u},e.prototype.readToken=function(e,t,r){var n=this.config,s=n.mathpack,l=n.localeInfo,b=je(l,l.pictureSpecial,t,r);if(void 0!==b){var h=b,v=Se(l.pictureSpecial,h);l.isJapan&&h===i.h.GeneralOldMAC&&(h=i.h.General);var p=t.substring(r,r+v.length);switch(h){case i.h.AP1:case i.h.AP2:return{kind:pe.AMPM,tokenStr:p,count:1,pictureKind:h};case i.h.AP3:return{kind:pe.AMPMFE,tokenStr:p,count:1};case i.h.General:return{kind:pe.General,tokenStr:p};case i.h.Currency:return{kind:pe.Currency,tokenStr:p}}}var m,O=Object(u.i)(t,r),j=Object(u.f)(O),y=t.substring(r,r+j),S=ye(l,l.pictureSingle,t,r);if(void 0!==S){h=S;if((l.isJapan||l.isChinaT)&&(h===i.g.E||h===i.g.EraYear)){var C=void 0,k=void 0;h=!(r+j+1<t.length)||(C=t.charCodeAt(r+j))!==K&&C!==Y||(k=t.charCodeAt(r+j+1))!==J&&k!==Q&&k!==X?i.g.EraYear:i.g.E}if(h===i.g.BidiDate||h===i.g.EngYearTh){C=void 0;if(r+j<t.length&&((C=t.charCodeAt(r+j))===Z||C===$))return{kind:C===Z?pe.LatinDate:pe.BidiDate,tokenStr:t.substring(r,r+j+1),count:1};h=i.g.EngYearTh}if(h===i.g.BidiNum)throw new Ge(this.notFormatString("bidi num not allowed"));switch(h){case i.g.Star:case i.g.Underscore:if(r+j>=t.length)throw new Ge(this.notFormatString("unterminated "+y));C=Object(u.i)(t,r+j);var E=Object(u.f)(C),A=Object(u.j)(C);return{kind:h,tokenStr:p=t.substring(r,r+j+E),escaped:A};case i.g.Backslash:return this.readToken_Backslash(t,r,j);case i.g.Quote:var N=t.indexOf(y,r+j);if(N<0)throw new Ge(this.notFormatString("unterminated quoted string"));var T=t.substring(r+j,N),R=(p=t.substring(r,N+j),je(l,l.pictureSpecial,T,0));return void 0!==R&&R===i.h.Currency&&Se(l.pictureSpecial,R).length===T.length?{kind:pe.Currency,tokenStr:p}:{kind:pe.StrLit,tokenStr:p,escaped:T};case i.g.E:if(l.isEastAsia){if(void 0!==e.dbnum)throw new Ge(this.notFormatString("invalid DBNUM with exp"));if(e.dbnumForbidden)throw new Ge(Object(c.hb)(["multiple DBNUM-forbidden tokens (% or E)"]));e.dbnumForbidden=!0}if(r+j>=t.length)throw new Ge(this.notFormatString("unterminated exp"));if((C=t.charCodeAt(r+j))!==Y&&C!==K)throw new Ge(this.notFormatString("exp not followed by sign"));p=t.substring(r,r+j+1);return{kind:pe.Exp,tokenStr:p,eStr:y,isNeg:C===K};case i.g.Hash:case i.g.Year:case i.g.Month:case i.g.Day:case i.g.Hour:case i.g.Minute:case i.g.Second:case i.g.YearTh:case i.g.MonthTh:case i.g.DayTh:case i.g.HourTh:case i.g.MinuteTh:case i.g.SecondTh:case i.g.EngYearTh:case i.g.ThYear:case i.g.Question:case i.g.Comma:case i.g.Reign:case i.g.LocDay:case i.g.Era:case i.g.EraYear:if(h===i.g.Reign&&!l.isJapan&&!l.isChinaT)break;for(var I=j,_=1;Object(f.h)(t,y,r+I)&&void 0===je(l,l.pictureSpecial,t,r+I);)I+=j,_+=1;if(h===i.g.LocDay&&_<3)break;return{kind:h,tokenStr:p=t.substring(r,r+I),count:_};case i.g.Sep:case i.g.Text:case i.g.Decimal:case i.g.Slash:case i.g.Minus:case i.g.Plus:return{kind:h,tokenStr:y};case i.g.Space:return{kind:pe.Char,tokenStr:y,escaped:y};case i.g.Colon:return{kind:h,tokenStr:y,count:1};case i.g.Percent:if(l.isEastAsia){if(void 0!==e.dbnum)throw new Ge(this.notFormatString("invalid DBNUM with pct"));if(e.dbnumForbidden)throw new Ge(Object(c.hb)(["multiple DBNUM-forbidden tokens (% or E)"]));e.dbnumForbidden=!0}return{kind:i.g.Percent,tokenStr:y};case i.g.DateSep:return y===Se(l.pictureSingle,i.g.Slash)?{kind:i.g.Slash,tokenStr:y}:y===Se(l.pictureSingle,i.g.Minus)?{kind:i.g.Minus,tokenStr:y}:{kind:i.g.DateSep,tokenStr:y,count:1};case i.g.ColorStart:var F=Se(l.pictureSingle,i.g.ColorEnd),w=t.indexOf(F,r+j);if(w<0)throw new Ge(this.notFormatString("unterminated ["));var M=t.substring(r+j,w),D=(p=t.substring(r,w+F.length),je(l,me,M,0));if(void 0!==D){for(var P=Se(me,D).length;P<M.length&&Object(d.a)(M.charCodeAt(P));)P+=1;var x=Object(d.c)(l,s,M,P,!1);if(x[1]===P)throw new Ge(Object(c.hb)(["invalid number in condition"]));if(x[1]!==M.length)throw new Ge(Object(c.hb)(["trailing junk after condition"]));return{kind:pe.Cond,tokenStr:p,cond:{operator:ge[D],operand:x[0]}}}var L=je(l,l.pictureColor,M,0);if(void 0!==L){var B=Se(l.pictureColor,L);if(L!==i.e.Color){if(B.length!==M.length)throw new Ge(Object(c.hb)(["trailing junk after named color"]));return{kind:pe.Color,tokenStr:p,color:(m=L,i.e[m])}}if(L===i.e.Color){for(var U=B.length;U<M.length&&Object(d.a)(M.charCodeAt(U));)U+=1;var G=Object(d.d)(l,4,M,U),V=G[0],H=G[1];if(H===U)throw new Ge(this.notFormatString("missing number for numbered color"));if(H!==M.length)throw new Ge(Object(c.hb)(["trailing junk after numbered color"]));if(V<1||V>56)throw new Ge(this.notFormatString("out-of-range numbered color"));return{kind:pe.Color,tokenStr:p,color:V+8}}}var W=je(l,l.pictureDbnum,M,0);if(void 0!==W){if(Se(l.pictureDbnum,W).length!==M.length)throw new Ge(Object(c.hb)(["trailing junk after DBNUM"]));return{kind:pe.Dbnum,tokenStr:p,dbnum:ve(W)}}return Object(f.h)(M,"$")?Object(a.__assign)({kind:pe.CurrCode,tokenStr:p},this.parseCurrCode(M.substring("$".length))):{kind:h,tokenStr:y};case i.g.ColorEnd:return{kind:h,tokenStr:y};case i.g.OpenParen:case i.g.CloseParen:return{kind:h,tokenStr:y,escaped:y};case i.g.Extra:case i.g.APDelim:case i.g.Nen1:case i.g.Gatsu1:case i.g.Nichi1:case i.g.Nen2:case i.g.Gatsu2:case i.g.Nichi2:break;case i.g.Zero:case i.g.ZeroTh:break;default:return Object(o.e)("calc.numfmt.NumberFormatImpl: readToken single picKind",h)}}if(l.isNumeral(O)){if(l.getNumberShape(O)!==g.e.ASCII)throw new Ge(Object(c.hb)(["non-ASCII digits"]));var z=l.getOrdinal(O);if(0===z){var q=j;for(_=1;Object(f.h)(t,y,r+q);)q+=j,_+=1;p=t.substring(r,r+q);return{kind:i.g.Zero,tokenStr:p,count:_}}return{kind:pe.Numeral,tokenStr:y,ordinal:z}}switch(O){case ee:return{kind:i.g.OpenParen,tokenStr:y,escaped:y};case te:return{kind:i.g.CloseParen,tokenStr:y,escaped:y};case ne:return this.readToken_Backslash(t,r,j);case re:if(l.isThai)return{kind:pe.PrefixDigTh,tokenStr:y}}return{kind:pe.Char,tokenStr:y,escaped:y}},e.prototype.readToken_Backslash=function(e,t,r){if(t+r>=e.length)throw new Ge(this.notFormatString("unterminated backslash"));var n=Object(u.i)(e,t+r),a=Object(u.f)(n),o=Object(u.j)(n),c=e.substring(t,t+r+a);return n===ee||n===te?{kind:n===ee?i.g.OpenParen:i.g.CloseParen,tokenStr:c,escaped:o}:{kind:pe.Char,tokenStr:c,escaped:o}},e.prototype.convertTokToSun=function(e){var t,r,n,a,u,s,l,d=this,f=e.color,b=e.dbnum,v=e.cond,p=e.currCode,m=e.tokens,g=this.config.localeInfo,j={suns:[],dtrRounding:O.a.RoundSec,color:f,dbnum:b,currCode:p,hasPercent:!1,hasDate:!1,hasTime:!1,get isEmpty(){return 0===this.suns.length&&void 0===v&&void 0===f&&void 0===b&&void 0===p}},y=0===g.stringCompareCI(Se(g.pictureSingle,i.g.Month),Se(g.pictureSingle,i.g.Minute)),S=!1,C=0,k=0,E=!1,A=!1,N=!1,T=!1,R=0,I=function(e,t){var n=_e[e];if(t){if(A)throw new Ge(d.notFormatString("more than one absolute time"));if(void 0!==r&&n>=r)throw new Ge(d.notFormatString("absolute time must be largest division"));A=!0}else if(A&&n<=r)throw new Ge(Object(c.hb)(["larger time division after absolute time"]));(void 0===r||n<r)&&(r=n)};function _(e,t,n){var a=r;if(I(e,t),e===i.g.Hour||e===i.g.HourTh)N=!0,u=n,s=void 0;else if(e===i.g.Second||e===i.g.SecondTh)if(void 0===s||A)void 0===a&&(N=!0);else{var c=s.code[0];Object(o.h)("calc.numfmt.NumberFormatImpl: onTime ambigCode",c.kind===i.g.Month);var l=i.g.Minute,d=c.count;Object(o.h)("calc.numfmt.NumberFormatImpl: onTime ambigCount",1===d||2===d);I(l,!1),C-=1,k+=1,s.code=[{kind:l,count:d,isAbs:!1}],s=void 0}else N=!1}function F(e){var t=Se(g.pictureSingle,e.kind);return{kind:406,printAsTimeSep:C>0||k>0,formattedStr:t}}function w(e){var t=Se(g.pictureSingle,e.kind);return t===Se(g.pictureSingle,i.g.DateSep)?{kind:405}:t===Se(g.pictureSingle,i.g.Colon)?F(e):{kind:400,formattedStr:t}}for(var M=0;M<m.length;M+=1){var D=m[M];switch(D.kind){case pe.AMPM:case pe.AMPMFE:case i.g.Colon:case i.g.DateSep:case i.g.Year:case i.g.Month:case i.g.Day:case i.g.Hour:case i.g.Minute:case i.g.Second:case i.g.Reign:case i.g.LocDay:case i.g.Era:case i.g.EraYear:case i.g.EngYearTh:case pe.LatinDate:case pe.BidiDate:case i.g.DayTh:case i.g.MonthTh:case i.g.YearTh:case i.g.ThYear:case i.g.HourTh:case i.g.MinuteTh:case i.g.SecondTh:var P={kind:1,code:[]};switch(j.suns.push(P),E=!0,D.kind){case pe.LatinDate:case pe.BidiDate:if(0!==M)throw new Ge(this.notFormatString("bidi date must be first"));P.code.push(D);break;case i.g.DateSep:P.code.push({kind:405});break;case i.g.Colon:P.code.push(F(D));break;case i.g.Reign:C+=1,g.isJapan&&D.count>=2&&P.code.push({kind:i.g.Era,count:3}),P.code.push({kind:i.g.EraYear,count:g.isChinaT?1:2});break;case i.g.Era:C+=1,P.code.push({kind:i.g.Era,count:Object(h.c)(3,D.count)});break;case i.g.EraYear:C+=1,P.code.push({kind:i.g.EraYear,count:Object(h.c)(2,D.count)});break;case i.g.Year:case i.g.YearTh:case i.g.EngYearTh:case i.g.ThYear:s=void 0,C+=1,P.code.push({kind:D.kind,count:D.count<=2?2:4});break;case i.g.Month:if(y&&D.count<=2){if(N){_(Z=i.g.Minute,x=!1,P),k+=1,P.code.push({kind:Z,count:D.count,isAbs:x}),N=!1;break}s=P}else s=void 0;C+=1,P.code.push({kind:D.kind,count:Object(h.c)(5,D.count)});break;case i.g.MonthTh:C+=1,P.code.push({kind:D.kind,count:Object(h.c)(4,D.count)});break;case i.g.Day:case i.g.DayTh:s=void 0,C+=1,P.code.push({kind:D.kind,count:Object(h.c)(4,D.count)});break;case i.g.LocDay:s=void 0,C+=1,P.code.push({kind:i.g.LocDay,count:3===D.count?3:4});break;case i.g.Hour:case i.g.HourTh:case i.g.Minute:case i.g.MinuteTh:case i.g.Second:case i.g.SecondTh:var x=!1;_(D.kind,x,P),k+=1;var L=Object(h.c)(2,D.count);D.kind===i.g.Hour||D.kind===i.g.HourTh?P.code.push({kind:D.kind,count:L,isAbs:x,isAMPM:!1}):P.code.push({kind:D.kind,count:L,isAbs:x});break;case pe.AMPM:case pe.AMPMFE:if(A)throw new Ge(this.notFormatString("AM/PM after absolute time"));if(D.count>1)throw new Ge(Object(c.hb)(["multiple AM/PM symbols"]));if(void 0!==u)(q=u.code[0]).isAMPM=!0,u=void 0;T=!0,P.code.push(D);break;default:return Object(o.e)("calc.numfmt.NumberFormatImpl: convertTokToSun tok as date",D)}break;case i.g.Decimal:case pe.Numeral:case i.g.Hash:case i.g.Zero:case i.g.Question:case i.g.Comma:if(E){if(D.kind!==i.g.Decimal&&D.kind!==i.g.Comma)throw new Ge(this.notFormatString("number picture in date/time format"));var B={kind:1,code:[]};j.suns.push(B);var U=m[M+1];if(D.kind===i.g.Decimal&&(null==U?void 0:U.kind)===i.g.Zero){var G=U.count;if(G>3)throw new Ge(this.notFormatString("invalid number of fractional seconds"));M+=1,_(i.g.Second,!1,B),k+=1,B.code.push({kind:404,rounding:G}),j.dtrRounding=Object(h.b)(j.dtrRounding,G)}else B.code.push(w(D));break}if(D.kind===i.g.Comma){var V={kind:7,code:[{kind:400,formattedStr:Se(g.pictureSingle,D.kind)}]};j.suns.push(V);break}P={kind:0,code:[],numDigLeft:0,numDigDec:0,numPercent:0,numThousands:0,comma:!1,decimal:!1,numVal:!1,nonZero:!1,get digitTokens(){return this.anyHash||this.anyQuestion},get reallyNum(){return this.anyHash||this.anyQuestion||this.anyZero},lastDig:void 0,firstDig:void 0,anyHash:!1,anyQuestion:!1,anyZero:!1};j.suns.push(P),void 0===n&&(n=P),a=P;var H=void 0;for(M-=1;M+1<m.length;M+=1){var W=m[M+1],z=!0;switch(W.kind){case i.g.Decimal:S=P.decimal=!0,P.code.push(W),H=void 0;break;case pe.Numeral:P.code.push({kind:W.kind,formattedStr:W.tokenStr,ordinal:W.ordinal}),P.numVal=P.nonZero=!0,H=void 0;break;case i.g.Hash:case i.g.Zero:case i.g.Question:if(P.decimal?P.numDigDec+=W.count:P.numDigLeft+=W.count,void 0===P.firstDig&&(P.firstDig=W.kind),P.lastDig=W.kind,W.kind===i.g.Hash?P.anyHash=!0:W.kind===i.g.Question?P.anyQuestion=!0:(P.anyZero=!0,P.numVal=!0),void 0!==H&&H.kind===W.kind)H.count+=W.count;else{var q={kind:W.kind,count:W.count};P.code.push(q),H=q}break;case i.g.Comma:U=null===(t=m[M+2])||void 0===t?void 0:t.kind;if((l=U)!==pe.Numeral&&l!==i.g.Hash&&l!==i.g.Zero&&l!==i.g.Question){L=W.count;var K=Se(g.pictureSingle,i.g.Space);K===Se(g.pictureSingle,i.g.Comma)&&(!g.isCurrencySymbolLead&&g.isCurrencySepBySpace&&U===pe.Currency||g.isPercentSepBySpace&&U===i.g.Percent)&&(P.code.push({kind:400,formattedStr:K}),L-=1),L>0&&(P.numThousands+=L)}else S||(P.comma=!0);break;default:z=!1}if(!z)break}break;case i.g.Percent:R+=1;P={kind:3,code:[{kind:i.g.Percent,formattedStr:D.tokenStr}]};j.suns.push(P),j.hasPercent=!0;break;case pe.Exp:P={kind:4,code:[{kind:pe.Exp,formattedStr:D.eStr,isNeg:D.isNeg}],isNeg:D.isNeg};j.suns.push(P);break;case pe.General:P={kind:6,code:[D]};j.suns.push(P);break;case i.g.Text:P={kind:5,code:[D]};j.suns.push(P);break;case i.g.Slash:if(E){var Y={kind:1,code:[w(D)]};j.suns.push(Y);break}P={kind:2,code:[{kind:i.g.Slash,formattedStr:D.tokenStr}]};j.suns.push(P);break;case i.g.Star:case pe.PrefixDigTh:case i.g.Underscore:case pe.Currency:case pe.CurrCode:case pe.StrLit:P={kind:7,code:[D]};j.suns.push(P);break;case i.g.ColorEnd:case i.g.Plus:P={kind:7,code:[{kind:400,formattedStr:D.tokenStr}]};j.suns.push(P);break;case i.g.OpenParen:case i.g.CloseParen:case pe.Char:P={kind:7,code:[{kind:400,formattedStr:D.escaped}]};j.suns.push(P);break;case i.g.Minus:if(E){var J={kind:1,code:[w(D)]};j.suns.push(J);break}P={kind:7,code:[{kind:400,formattedStr:Se(g.pictureSingle,D.kind)}]};j.suns.push(P);break;case i.g.ColorStart:var Q=0;for(P={kind:1,code:[]};M+1<m.length&&2!==Q;M+=1){var X=m[M+1];switch(X.kind){case i.g.ColorEnd:if(1!==Q)throw new Ge(this.notFormatString("unexpected closing ]"));Q=2;continue;case i.g.Hour:case i.g.Month:case i.g.Minute:case i.g.Second:if(X.kind===i.g.Month&&!y)break;var Z;_(Z=X.kind===i.g.Month?i.g.Minute:X.kind,x=!0,P),k+=1;L=Object(h.c)(2,X.count);Z===i.g.Hour?P.code.push({kind:Z,count:L,isAbs:x,isAMPM:!1}):P.code.push({kind:Z,count:L,isAbs:x}),E=!0,Q=1;continue;case pe.Char:if(X.tokenStr===Se(g.pictureSingle,i.g.Space))continue;break;case i.g.HourTh:throw new Ge(Object(c.hb)(["Thai hour in ["]))}throw new Ge(this.notFormatString("unexpected token after ["))}if(2!==Q)throw new Ge(Object(c.hb)(["semicolon inside [ ]"]));j.suns.push(P);break;default:return Object(o.e)("calc.numfmt.NumberFormatImpl: convertTokToSun tok",D)}if(j.suns.length>=2){var $=j.suns[j.suns.length-2],ee=j.suns[j.suns.length-1];if(7===$.kind&&7===ee.kind){var te=$.code;Object(h.p)(te,ee.code),j.suns.pop()}}}(void 0!==n&&(n.numThousands=a.numThousands,n.numPercent=R),T&&void 0!==u)&&((q=u.code[0]).isAMPM=!0);if(A)for(var re=0,ne=j.suns;re<ne.length;re++){if(1===(P=ne[re]).kind)for(var ae=0,ie=P.code;ae<ie.length;ae++){switch((q=ie[ae]).kind){case i.g.Hour:case i.g.HourTh:case i.g.Minute:case i.g.MinuteTh:case i.g.Second:case i.g.SecondTh:q.isAbs=_e[q.kind]===r}}}if(j.suns.length>32)throw new Ge(this.notFormatString("format string too long: SUNs limit"));return j.hasDate=C>0,j.hasTime=k>0,j},e.prototype.classifySunPartKind=function(e,t){for(var r=e.suns,n=e.isEmpty,a=e.hasDate,i=e.hasTime,c=2===t,u=3===t,s=!c&&!u,l=0,d=r;l<d.length;l++){var f=d[l];switch(f.kind){case 0:case 2:case 3:case 4:c=!0;break;case 5:u=!0;break;case 6:continue;case 7:case 1:break;default:return Object(o.e)("calc.numfmt.NumberFormatImpl: classifySunPartKind sun",f)}s=!1}if((c?1:0)+(a||i?1:0)+(u?1:0)>1)throw new Ge(this.notFormatString("cannot mix number/date/text"));return c||a||i?2:u?3:s&&!n?1:t},e.prototype.convertSunToCode=function(t){var r,i=t.suns,c=t.isEmpty,u=t.dtrRounding,s=t.color,l=t.dbnum,d=t.currCode,f=this.config.localeInfo,b=[];function v(e){for(var t=e-1;t>=0;t-=1){var r=i[t];if(0===r.kind)return[t,r]}}function p(e){for(var t=e+1;t<i.length;t+=1){var r=i[t];if(0===r.kind)return[t,r]}}for(var m=!1,g=0,O=0;O<i.length;O+=1){var j=i[O];switch(j.kind){case 5:if(5===r)break;if(void 0!==r)throw new Ge(this.notFormatString("@ after other control"));r=5;break;case 6:if(void 0!==r)throw new Ge(this.notFormatString("General after other control"));if(m)throw new Ge(this.notFormatString("General after number"));r=6;break;case 0:if(m=!0,6===r)throw new Ge(this.notFormatString("number after General"));break;case 2:if(void 0!==r)throw new Ge(this.notFormatString("/ after other control"));if(f.isEastAsia&&void 0!==l)throw new Ge(this.notFormatString("/ not allowed with DBNUM"));r=2;var y=v(O);if(void 0===y)throw new Ge(this.notFormatString("no number before /"));var S=this.mergeNumSuns(i,g,y[0]),C=S[0],k=S[1],E=S[2],A=p(O);if(void 0===A)throw new Ge(this.notFormatString("no number after /"));var N=i.slice(y[0]+1,A[0]),T=void 0!==p(A[0]);Object(h.p)(b,this.flattenSuns(C)),Object(h.p)(b,this.buildFractCode(k,E,y[1],N,A[1],T)),g=A[0]+1;break;case 4:if(void 0!==r)throw new Ge(this.notFormatString("E after other control"));r=4;var R=this.mergeNumSuns(i,g,O),I=R[0],_=R[1],F=R[2];if(void 0===_)throw new Ge(this.notFormatString("no number before E"));var w=this.mergeNumSuns(i,O+1,i.length),M=w[0],D=w[1],P=w[2];if(void 0===D)throw new Ge(this.notFormatString("no number after E"));Object(h.p)(b,this.flattenSuns(I)),Object(h.p)(b,this.buildExpCode(j.isNeg,_,Object(a.__spreadArray)(Object(a.__spreadArray)(Object(a.__spreadArray)([],F,!0),[i[O]],!1),M,!0),D)),Object(h.p)(b,this.flattenSuns(P)),g=i.length;break;case 3:case 7:case 1:break;default:return Object(o.e)("calc.numfmt.NumberFormatImpl: convertSunToCode sun",j)}}if(void 0===r){var x=this.mergeNumSuns(i,g,i.length),L=(C=x[0],x[1]),B=x[2];void 0!==L?Object(h.p)(b,this.buildNumberCode(C,L)):Object(h.p)(b,this.flattenSuns(C)),Object(h.p)(b,this.flattenSuns(B)),g=i.length}Object(h.p)(b,this.flattenSuns(i.slice(g))),0!==i.length||c||b.push(we);var U=null==d?void 0:d.tag;if(Object(n.A)(U)){var G=U===n.d.SysDate?f.sysDateFormat:f.sysTimeFormat,V=new e(this.config,{old:void 0,formatString:G,source:n.l.System}),H=V.parts[0];return{part:{code:[{kind:407,codeSysFormat:H.code,codeThisFormat:b}],color:H.color,dbnum:H.dbnum,dtrRounding:H.dtrRounding},applyCurrCode:V.thisCurrCode}}return{part:{code:b,color:s,dbnum:l,dtrRounding:u},applyCurrCode:d}},e.prototype.flattenSuns=function(e){return Object(h.o)([],e.map((function(e){return e.code})))},e.prototype.buildExpCode=function(e,t,r,n){if(n.comma)throw new Ge(this.notFormatString("comma following E"));var a=t.numDigDec;if(a>127)throw new Ge(this.notFormatString("too many decimal digits"));var i=this.bumpDigitsForComma(t),o=i.code,c=i.comma;return[{kind:402,isNeg:e,numMantDigLeft:i.numDigLeft,numMantDigDec:a,numExpDigLeft:n.numDigLeft,commaMant:c,codeMant:o,codeBetween:this.flattenSuns(r),codeExp:this.flattenSuns([n])}]},e.prototype.buildNumberCode=function(e,t){var r=t.numDigDec;if(r>127)throw new Ge(this.notFormatString("too many decimal digits"));var n=this.bumpDigitsForComma(t),a=n.code,i=n.comma;return[{kind:403,numDigLeft:n.numDigLeft,numDigDec:r,numPercent:t.numPercent,numThousands:t.numThousands,comma:i,codeBefore:this.flattenSuns(e),code:a}]},e.prototype.buildFractCode=function(e,t,r,n,a,u){var s,l,d,f,b=this.config.mathpack;if(r.comma)throw new Ge(this.notFormatString("comma in numerator"));if(r.decimal)throw new Ge(Object(c.hb)(["decimals in numerator"]));if(a.comma)throw new Ge(this.notFormatString("comma in denominator"));if(a.decimal)throw new Ge(this.notFormatString("decimals in denominator"));if(0!==r.numDigDec)throw new Ge(this.notFormatString("decimals in numerator"));if((f=a).numVal&&f.nonZero&&f.digitTokens)throw new Ge(this.notFormatString("literal and placeholder digits mixed in denominator"));if(u)throw new Ge(Object(c.hb)(["fraction number formats with trailing numbers"]));var h,v=!1,p=0;if(void 0!==e){if(!e.reallyNum)throw new Ge(Object(c.hb)(["fixed numerals in fraction integer part"]));if(e.decimal)throw new Ge(Object(c.hb)(["decimal in fraction integer part"]));if(0!==e.numDigDec)throw new Ge(this.notFormatString("decimals in fraction integer part"));if(e.numVal&&e.nonZero)throw new Ge(Object(c.hb)(["numerals in fraction integer part"]));h=(s=this.bumpDigitsForComma(e)).code,v=s.comma,p=s.numDigLeft}var m=null!==(l=null==e?void 0:e.numPercent)&&void 0!==l?l:r.numPercent,g=null!==(d=null==e?void 0:e.numThousands)&&void 0!==d?d:r.numThousands;if(g>0)throw new Ge(Object(c.hb)(["fraction number formats with thousands"]));var O,j=a.code,y=a.numDigLeft,S=a.firstDig;if(a.numVal&&a.nonZero){if(u)throw new Ge(Object(c.hb)(["fraction number formats with specified denominator and trailing numbers"]));if(a.code.length>5)throw new Ge(Object(c.hb)(["too many digits in denominator"]));for(var C=0,k=0;k<a.code.length;k+=1){var E=a.code[k];switch(E.kind){case pe.Numeral:C=10*C+E.ordinal;break;case i.g.Zero:if(0===k)throw new Ge(Object(c.hb)(["leading zero in denominator"]));C*=10;break;default:return Object(o.a)("calc.numfmt.NumberFormatImpl: buildFractCode denomCode")}}if(C>32767)throw new Ge(Object(c.hb)(["overflow in denominator not emulated"]));j=[{kind:i.g.Hash,count:1}],y=1,S=void 0,O=b.fromNumber(C)}return[{kind:401,numIntDigLeft:p,numPercent:m,numThousands:g,numNumerDig:r.numDigLeft,numDenomDig:y,commaInt:v,codeInt:h,codeBetween1:this.flattenSuns(t),codeNumer:r.code,codeBetween2:this.flattenSuns(n),codeDenom:j,denomValue:O,lastDigInt:void 0!==e?e.lastDig:void 0,firstDigNumer:r.firstDig,firstDigDenom:S,anyZeroNumer:r.anyZero,anyQuestionNumer:r.anyQuestion}]},e.prototype.mergeNumSuns=function(e,t,r){for(var n,a=[],i=[],o=t;o<e.length&&o<r;o+=1){var c=e[o];void 0!==n?0===c.kind?(n.decimal?n.numDigDec+=c.numDigLeft+c.numDigDec:(n.numDigLeft+=c.numDigLeft,n.numDigDec+=c.numDigDec),n.comma=n.comma||c.comma,n.decimal=n.decimal||c.decimal,n.numVal=n.numVal||c.numVal,n.nonZero=n.nonZero||c.nonZero,void 0!==c.lastDig&&(n.lastDig=c.lastDig),void 0===n.firstDig&&(n.firstDig=c.firstDig),n.anyHash=n.anyHash||c.anyHash,n.anyQuestion=n.anyQuestion||c.anyQuestion,n.anyZero=n.anyZero||c.anyZero,Object(h.p)(n.code,this.flattenSuns(i)),i.length=0,Object(h.p)(n.code,c.code)):i.push(c):0===c.kind?n=c:a.push(c)}return[a,n,i]},e.prototype.bumpDigitsForComma=function(e){if(!e.comma)return e;if(this.anyLegalCommaPosition(e))return e;for(var t=e.numDigLeft%3,r=(0===t?0===e.numDigLeft?3:e.numDigLeft:e.numDigLeft+3-t)+1,n=0;n<e.code.length;n+=1){var o=e.code[n];switch(o.kind){case i.g.Hash:return(u=e.code.slice())[n]=Object(a.__assign)(Object(a.__assign)({},o),{count:o.count+(r-e.numDigLeft)}),{code:u,comma:!0,numDigLeft:r};case i.g.Zero:case i.g.Question:case i.g.Decimal:var u;return(u=e.code.slice()).splice(n,0,{kind:i.g.Hash,count:r-e.numDigLeft}),{code:u,comma:!0,numDigLeft:r}}}throw new Ge(Object(c.hb)(["comma with pure number literal"]))},e.prototype.anyLegalCommaPosition=function(e){if(e.numDigLeft<4)return!1;for(var t=function(e){var t=null==e?void 0:e.kind;return t===i.g.Hash||t===i.g.Zero||t===i.g.Question},r=e.numDigLeft,n=0;n<e.code.length;n+=1){var a=e.code[n];if(a.kind===i.g.Decimal)return!1;if(t(a))for(var o=0;o<a.count;o+=1)if((r-=1)>0&&r%3==0&&(o+1<a.count||t(e.code[n+1])))return!0}return!1},e.prototype.parseCurrCode=function(e){var t,r,a,i=this.config.localeInfo,o=e.indexOf("-");if(0!==e.length&&0!==o){if((t=o<0?e:e.substring(0,o)).length>61)throw new Ge(this.notFormatString("currencySymbol too long"));for(var s=0,l=Object(u.b)(t);s<l.length;s++){var d=l[s];if(i.isNumeral(d)&&i.getNumberShape(d)!==g.e.ASCII)throw new Ge(Object(c.hb)(["non-ASCII digits in currencySymbol"]))}}if(o>=0&&(a=e.substring(o+"-".length)),void 0!==a&&void 0===(r=this.parseFormatCulture(a)))throw new Ge(Object(c.hb)(["unhandled CurrCode: "+Object(w.b)(e)]));if(Object(n.A)(null==r?void 0:r.tag)){if(void 0!==t)throw new Ge(this.notFormatString("currencySymbol with sysdate/systime"));if(this.source===n.l.System)throw new Ge(this.notFormatString("system format referenced circularly within system format"))}return{currencySymbol:t,currCode:r}},e.prototype.parseFormatCulture=function(e){var t,r,a={culture:"",numberShape:void 0,nationalNumberInput:!1,calendar:void 0,localCalendarInput:!1,tag:void 0},o=e.match(Ee);if(null!=o){a.culture=null!==(t=o[1])&&void 0!==t?t:"";var u=null!==(r=o[2])&&void 0!==r?r:o[3];if(null!=u){if(a.tag=Te[u.toLowerCase()],void 0===a.tag)throw new Ge(Object(c.hb)(["unknown CurrCode tag: "+Object(w.b)(e)]));switch(a.tag){case n.d.SysDate:case n.d.SysTime:case n.d.Euro1:case n.d.Euro2:case n.d.Bitcoin1:case n.d.Bitcoin2:if(""!==a.culture)throw new Ge(this.notFormatString("CultureTag ".concat(String(a.tag)," cannot have culture")));break;case n.d.GenLower:case n.d.GenUpper:case n.d.NomLower:case n.d.Gannen:if(""===a.culture)throw new Ge(this.notFormatString("CultureTag ".concat(String(a.tag)," must have culture")))}}var s=o[4];if(null!=s){var l=Ie(s),d=(32512&l)>>8;if(0!==d&&(a.numberShape=Ae[d],void 0===a.numberShape))throw new Ge(Object(c.hb)(["unknown number shape ".concat(d," in culture: ").concat(Object(w.b)(e))]));a.nationalNumberInput=0!=(32768&l);var f=127&l;if(0!==f&&(a.calendar=Ne[f],void 0===a.calendar))throw new Ge(Object(c.hb)(["unknown calendar ".concat(f," in culture: ").concat(Object(w.b)(e))]));a.localCalendarInput=0!=(128&l)}return a}if(ke.test(e)){var b=Ie(e);switch(b){case i.b.SystemLongDate:a.tag=n.d.SysDate;break;case i.b.SystemTime:a.tag=n.d.SysTime;break;case i.b.EuroTrailing:a.tag=n.d.Euro1;break;case i.b.EuroLeading:a.tag=n.d.Euro2;break;default:64512==(64512&b)&&(a.tag=n.d.GenLower),63488==(64512&b)&&(a.tag=n.d.GenUpper),62464==(64512&b)&&(a.tag=n.d.NomLower),void 0!==a.tag&&(b&=-63489),a.culture=function(e){var t;return"string"==typeof e?e:null!==(t=q[e])&&void 0!==t?t:e}(b)}return a}},e.prototype.determineValueType=function(){for(var e=this.config.localeInfo,t={accountFill:!1,fvt:void 0},r=0,a=this.parts;r<a.length;r++){var o=a[r];t.accountFill=!1;var c=this.determineValueTypeCodes(t,o.code);if(void 0!==c)return c;if(t.accountFill&&(t.fvt===n.h.Number||t.fvt===n.h.Currency))return n.h.Accounting;if(void 0!==t.fvt)return t.fvt}return void 0!==t.fvt?t.fvt:this.formatString===Se(e.pictureSpecial,i.h.General)?n.h.General:n.h.Custom},e.prototype.determineValueTypeCodes=function(e,t){for(var r=this.config.localeInfo,a=0;a<t.length;a+=1){var c=t[a];switch(c.kind){case pe.General:break;case i.g.Text:return n.h.Text;case i.g.Star:e.accountFill=!0;break;case 400:case pe.Exp:case i.g.Slash:case pe.StrLit:case i.g.Percent:case i.g.Underscore:case pe.Numeral:case 405:case 406:break;case pe.Currency:e.fvt=n.h.Currency;break;case pe.CurrCode:void 0!==c.currencySymbol&&(e.fvt=n.h.Currency);break;case 403:e.fvt=1===c.numPercent&&0===c.numThousands?n.h.Percentage:n.h.Number;var u=c.codeBefore,s=0;if(r.isEastAsia){if(s<u.length&&"("===Fe(u[s])&&(s+=1),s<u.length&&"US$"===Fe(u[s]))return n.h.Currency;if(r.isChinaT){if(s<u.length&&"NT$"===Fe(u[s]))return n.h.Currency}else if(s<u.length&&"$"===Fe(u[s]))return n.h.Currency}var l=void 0;if(void 0!==(l=this.determineValueTypeCodes(e,c.codeBefore.slice(s))))return l;if(void 0!==(l=this.determineValueTypeCodes(e,c.code)))return l;break;case 402:e.fvt=n.h.Scientific;l=void 0;if(void 0!==(l=this.determineValueTypeCodes(e,c.codeMant)))return l;if(void 0!==(l=this.determineValueTypeCodes(e,c.codeBetween)))return l;if(void 0!==(l=this.determineValueTypeCodes(e,c.codeExp)))return l;break;case 401:e.fvt=n.h.Fraction;l=void 0;if(void 0!==c.codeInt&&void 0!==(l=this.determineValueTypeCodes(e,c.codeInt)))return l;if(void 0!==(l=this.determineValueTypeCodes(e,c.codeBetween1)))return l;if(void 0!==(l=this.determineValueTypeCodes(e,c.codeNumer)))return l;if(void 0!==(l=this.determineValueTypeCodes(e,c.codeBetween2)))return l;if(void 0!==(l=this.determineValueTypeCodes(e,c.codeDenom)))return l;break;case i.g.Decimal:case i.g.Hash:case i.g.Zero:case i.g.Question:break;case pe.PrefixDigTh:case pe.LatinDate:case pe.BidiDate:break;case i.g.HourTh:case i.g.MinuteTh:case i.g.SecondTh:case i.g.Hour:case i.g.Minute:case i.g.Second:case 404:return n.h.Time;case pe.AMPM:case pe.AMPMFE:break;case i.g.Era:case i.g.EraYear:case i.g.YearTh:case i.g.EngYearTh:case i.g.ThYear:case i.g.MonthTh:case i.g.DayTh:case i.g.Year:case i.g.Month:case i.g.Day:case i.g.LocDay:return n.h.Date;case 407:return this.determineValueTypeCodes(e,c.codeThisFormat);default:return Object(o.e)("calc.numfmt.NumberFormatImpl: determineValueTypeCodes code",c)}}},e.prototype.determineDecimals=function(){for(var e=0,t=this.parts[0].code;e<t.length;e++){var r=t[e];switch(r.kind){case 403:return r.numDigDec;case 402:return r.numMantDigDec}}return 0},e.prototype.determineBidiDate=function(){var e=Se(this.config.localeInfo.pictureSingle,i.g.BidiDate);return Object(f.h)(this.formatString,e+"1")?n.b.English:Object(f.h)(this.formatString,e+"2")?n.b.Lunar:void 0},e.prototype.printFormatString=function(){var e=this.config.localeInfo,t=this.parts,r=t[0],n=t[1],a=t[2],o=t[3],c=!(Pe(o)||o===r),u=this.posBeforeText||!c,s="";return u&&(s+=this.printPart(r,this.condPos),n!==r&&(s+=Se(e.pictureSingle,i.g.Sep),s+=this.printPart(n,this.condNeg),a!==r&&(s+=Se(e.pictureSingle,i.g.Sep),s+=this.printPart(a,void 0)))),c&&(u&&(s+=Se(e.pictureSingle,i.g.Sep)),s+=this.printPart(o,void 0)),s},e.prototype.printPart=function(e,t){var r,n=this.config,a=n.mathpack,o=n.localeInfo,c="";if(void 0!==e.color&&(c+=Se(o.pictureSingle,i.g.ColorStart)+("number"==typeof e.color?Se(o.pictureColor,i.e.Color)+String(e.color-8):Se(o.pictureColor,(r=e.color,i.e[r])))+Se(o.pictureSingle,i.g.ColorEnd)),void 0!==t){c+=Se(o.pictureSingle,i.g.ColorStart)+Se(me,Oe[t.operator])+a.formatGeneral(o,t.operand,21)+Se(o.pictureSingle,i.g.ColorEnd)}return void 0!==e.dbnum&&(c+=Se(o.pictureSingle,i.g.ColorStart)+Se(o.pictureDbnum,e.dbnum-1)+Se(o.pictureSingle,i.g.ColorEnd)),c+=this.printCodes({seenDig:!1,wasPrevDig:!1},e.code,void 0)},e.prototype.printCodes=function(e,t,r){var a,c=this.config,s=c.mathpack,l=c.localeInfo,d="";if(void 0!==r&&r.numThousands>0){for(var b=0;b<t.length;b+=1){var h=t[b].kind;h!==i.g.Zero&&h!==i.g.Hash&&h!==i.g.Question&&h!==i.g.Decimal&&h!==pe.Numeral||(a=b)}Object(o.h)("calc.numfmt.NumberFormatImpl: printCodes thousandsAfter",void 0!==a)}var v=function(c){var b=t[c],h=e.wasPrevDig;switch(e.wasPrevDig=!1,b.kind){case pe.General:d+=Se(l.pictureSpecial,i.h.General);break;case i.g.Decimal:void 0!==r&&(r.decimal=!0),e.wasPrevDig=!0,d+=Se(l.pictureSingle,i.g.Decimal);break;case i.g.Hash:case i.g.Zero:case i.g.Question:e.seenDig=!0,e.wasPrevDig=!0;var v=b.kind===i.g.Zero?"0":Se(l.pictureSingle,b.kind),g=Object(f.f)(v,b.count);if(void 0===r||r.decimal){d+=g;break}if(r.comma){var O=r.numDigLeft-b.count;d+=Object(p.c)({isThousandsPosition:function(e){var r,n;return e>0&&e%3==0&&(e>O||((n=null===(r=t[c+1])||void 0===r?void 0:r.kind)===i.g.Hash||n===i.g.Zero||n===i.g.Question))},thousandsSeparator:Se(l.pictureSingle,i.g.Comma)},g,O)}else d+=g;r.numDigLeft-=b.count;break;case pe.Numeral:e.wasPrevDig=!0,d+=b.formattedStr;break;case 402:d+=m.printCodes(e,b.codeMant,{comma:b.commaMant,numThousands:0,decimal:!1,numDigLeft:b.numMantDigLeft})+m.printCodes(e,b.codeBetween,void 0)+m.printCodes(e,b.codeExp,{comma:!1,numThousands:0,decimal:!1,numDigLeft:b.numExpDigLeft});break;case 403:d+=m.printCodes(e,b.codeBefore,void 0)+m.printCodes(e,b.code,{comma:b.comma,numThousands:b.numThousands,decimal:!1,numDigLeft:b.numDigLeft});break;case 401:var j=void 0===b.codeInt?"":m.printCodes(e,b.codeInt,{comma:b.commaInt,numThousands:0,decimal:!1,numDigLeft:b.numIntDigLeft}),y=m.printCodes(e,b.codeBetween1,void 0),S=m.printCodes(e,b.codeNumer,{comma:!1,numThousands:0,decimal:!1,numDigLeft:b.numNumerDig}),C=m.printCodes(e,b.codeBetween2,void 0),k=m.printCodes(e,b.codeDenom,{comma:!1,numThousands:b.numThousands,decimal:!1,numDigLeft:b.numDenomDig});d+=j+y+S+C+(void 0!==b.denomValue?ce(s,b.denomValue):k);break;case 400:var E=Se(l.pictureSingle,i.g.Backslash),A=ye(l,l.pictureSingle,b.formattedStr,0),N=function(e,t,r,n){for(var a=r.substring(n,n+Object(u.f)(Object(u.i)(r,n))),i=0;i<t.length;i+=1){var o=t[i];if(null!=o&&0!==o.length){var c=o.substring(0,Object(u.f)(Object(u.i)(o,0)));if(0===e.stringCompareCI(a,c))return!0}}return!1}(l,l.pictureSpecial,b.formattedStr,0);if(void 0!==A&&A!==i.g.Extra&&A!==i.g.Zero)switch(A){case i.g.Comma:var T=t[c+1];if(h){var R=Se(l.pictureSingle,i.g.Space);if(b.formattedStr!==R||void 0===T||(l.isCurrencySymbolLead||!l.isCurrencySepBySpace||T.kind!==pe.Currency)&&(!l.isPercentSepBySpace||T.kind!==i.g.Percent)){d+=E;break}}if(400===(null==T?void 0:T.kind)&&(null==T?void 0:T.formattedStr)===b.formattedStr){d+=E;break}break;case i.g.Decimal:d+=E;break;case i.g.Slash:e.seenDig&&(d+=E);break;case i.g.Space:case i.g.Minus:case i.g.Plus:case i.g.OpenParen:case i.g.CloseParen:break;case i.g.DateSep:Se(l.pictureSingle,i.g.DateSep)!==Se(l.pictureSingle,i.g.Minus)&&(d+=E);break;default:d+=E}else(N||l.isNumeral(Object(u.i)(b.formattedStr,0)))&&(d+=E);d+=b.formattedStr;break;case pe.Exp:d+=b.formattedStr+(b.isNeg?"-":"+");break;case pe.StrLit:E=Se(l.pictureSingle,i.g.Quote);Object(o.h)("calc.numfmt.NumberFormatImpl: printCodes StrLit",b.escaped.indexOf(E)<0),d+=E+b.escaped+E;break;case i.g.Slash:d+=Se(l.pictureSingle,i.g.Slash);break;case i.g.Percent:d+=Se(l.pictureSingle,i.g.Percent);break;case i.g.Star:d+=Se(l.pictureSingle,i.g.Star)+b.escaped;break;case i.g.Underscore:d+=Se(l.pictureSingle,i.g.Underscore)+b.escaped;break;case pe.PrefixDigTh:d+="t";break;case pe.Currency:d+=Se(l.pictureSpecial,i.h.Currency);break;case pe.CurrCode:if(d+=Se(l.pictureSingle,i.g.ColorStart),d+="$",void 0!==b.currencySymbol&&(d+=b.currencySymbol),void 0!==b.currCode){var I=b.currCode,_=I.culture,F=I.numberShape,w=I.nationalNumberInput,M=I.calendar,D=I.localCalendarInput,P=I.tag;switch(d+="-",typeof _){case"number":var x=_;switch(Object(o.h)("calc.numfmt.NumberFormatImpl: printCodes lcid",void 0===F&&!w&&void 0===M&&!D),P){case void 0:break;case n.d.GenLower:x|=64512;break;case n.d.GenUpper:x|=63488;break;case n.d.NomLower:x|=62464;break;default:Object(o.a)("calc.numfmt.NumberFormatImpl: printCodes lcid2")}var L=Re(x);/^[a-f]{1,7}$/i.test(L)&&(L="0"+L),d+=L;break;case"string":d+=_,void 0!==P&&(""!==_&&(d+="-"),d+="x-",d+=String(P));var B=0;void 0!==F&&(B|=Ae.indexOf(F)<<8),w&&(B|=32768),void 0!==M&&(B|=Ne.indexOf(M)),D&&(B|=128),0!==B&&(d+=",",d+=Re(B))}}d+=Se(l.pictureSingle,i.g.ColorEnd);break;case i.g.Text:d+=Se(l.pictureSingle,i.g.Text);break;case pe.LatinDate:d+=Se(l.pictureSingle,i.g.BidiDate)+"1";break;case pe.BidiDate:d+=Se(l.pictureSingle,i.g.BidiDate)+"2";break;case 404:d+=Se(l.pictureSingle,i.g.Decimal)+Object(f.f)("0",b.rounding);break;case 405:d+=Se(l.pictureSingle,i.g.DateSep);break;case 406:d+=Se(l.pictureSingle,i.g.Colon);break;case i.g.Era:case i.g.EraYear:case i.g.Year:case i.g.YearTh:case i.g.EngYearTh:case i.g.ThYear:case i.g.Month:case i.g.MonthTh:case i.g.Day:case i.g.DayTh:case i.g.LocDay:d+=Object(f.f)(Se(l.pictureSingle,b.kind),b.count);break;case i.g.Hour:case i.g.HourTh:case i.g.Minute:case i.g.MinuteTh:case i.g.Second:case i.g.SecondTh:if(b.isAbs){d+=Se(l.pictureSingle,i.g.ColorStart)+Object(f.f)(Se(l.pictureSingle,b.kind),b.count)+Se(l.pictureSingle,i.g.ColorEnd);break}d+=Object(f.f)(Se(l.pictureSingle,b.kind),b.count);break;case pe.AMPM:case pe.AMPMFE:b.kind===pe.AMPMFE||l.isEastAsia||b.pictureKind===i.h.AP2?d+=b.tokenStr:d+=Se(l.pictureSpecial,b.pictureKind);break;case 407:d+=m.printCodes(e,b.codeThisFormat,void 0);break;default:return{value:Object(o.e)("calc.numfmt.NumberFormatImpl: printCodes code",b)}}c===a&&(d+=Object(f.f)(Se(l.pictureSingle,i.g.Comma),r.numThousands))},m=this;for(b=0;b<t.length;b+=1){var g=v(b);if("object"==typeof g)return g.value}return d},e.prototype.countBytecodeBuffer=function(e){for(var t,r,n=this.config,a=n.mathpack,c=n.localeInfo,u=0,s=0;s<e.length;s+=1){var l=e[s],d=1;switch(l.kind){case i.g.Percent:case pe.Numeral:case 400:case i.g.Star:case i.g.Underscore:d+=2;break;case pe.StrLit:d+=1+2*l.escaped.length;break;case 404:case i.g.Hash:case i.g.Zero:case i.g.Question:case pe.Exp:d+=1;break;case i.g.Hour:case i.g.HourTh:case i.g.Minute:case i.g.MinuteTh:case i.g.Second:case i.g.SecondTh:l.isAbs&&(d+=1);break;case 401:if(d+=5,void 0!==l.codeInt&&(d+=this.countBytecodeBuffer(l.codeInt)),d+=this.countBytecodeBuffer(l.codeBetween1),d+=this.countBytecodeBuffer(l.codeNumer),d+=this.countBytecodeBuffer(l.codeBetween2),d+=this.countBytecodeBuffer(l.codeDenom),void 0!==l.denomValue)d-=2,d+=2+2*ce(a,l.denomValue).length;l.commaInt&&(d+=1);break;case 402:d+=3,d+=this.countBytecodeBuffer(l.codeMant),d+=this.countBytecodeBuffer(l.codeBetween),d+=this.countBytecodeBuffer(l.codeExp),l.commaMant&&(d+=1);break;case 403:d+=3,d+=this.countBytecodeBuffer(l.codeBefore),d+=this.countBytecodeBuffer(l.code),l.comma&&(d+=1);break;case 407:d=0,d+=this.countBytecodeBuffer(l.codeThisFormat);break;case pe.CurrCode:d+=2*((null!==(r=null===(t=l.currencySymbol)||void 0===t?void 0:t.length)&&void 0!==r?r:0)+1),d+=8;break;case pe.AMPM:var f=c.isEastAsia||l.pictureKind===i.h.AP2?Ce(c,l.tokenStr):c.ampmSymbols;d+=2+2*(f[0].length+f[1].length);break;case pe.AMPMFE:break;case pe.General:case i.g.Decimal:case i.g.Slash:case pe.PrefixDigTh:case pe.Currency:case i.g.Text:case pe.LatinDate:case pe.BidiDate:case 405:case 406:case i.g.Era:case i.g.EraYear:case i.g.Year:case i.g.YearTh:case i.g.EngYearTh:case i.g.ThYear:case i.g.Month:case i.g.MonthTh:case i.g.Day:case i.g.DayTh:case i.g.LocDay:break;default:return Object(o.e)("calc.numfmt.NumberFormatImpl: printCodes code",l)}u+=d}return u},e.prototype.countBytecodePart=function(e){var t=e.code,r=0;return void 0!==e.color&&(r+=2),void 0!==e.dbnum&&(r+=2),0!==e.dtrRounding&&(r+=2),r+=this.countBytecodeBuffer(t)},e.prototype.countBytecode=function(){for(var e=0,t=0;t<=3;t+=1){(0===t&&void 0!==this.condPos||1===t&&void 0!==this.condNeg)&&(e+=10);for(var r=this.parts[t],n=!1,a=0;a<t;a+=1)if(this.parts[a]===r){n=!0;break}n||(e+=this.countBytecodePart(r))}return e},e.prototype.checkBytecode=function(){if(this.countBytecode()>255)throw new Ge(this.notFormatString("format string too long: bytecode limit"));if(this.countBytecode()>247)throw new Ge(Object(c.hb)(["format string too long: close to bytecode limit"]))},e.prototype.getBundledLocaleInfo=function(e,t){if(void 0!==(null==t?void 0:t.culture)){var r=D(t);if(void 0===r)throw new Ue(this.notImplementedCulture(e,t.culture));return r}return this.config.localeInfo},e.prototype.notFormatString=function(e){return Object(n.D)("".concat(e," (source=").concat(String(this.source),"): ").concat(this.logFormatString))},e.prototype.notImplementedCulture=function(e,t){var r="number"==typeof t?"lcid:".concat(Re(t)):"lang:".concat(t);return Object(c.hb)(["".concat(e,": culture = ").concat(r)])},e}();function He(e,t,r,a){try{var i=void 0,o=void 0,l=void 0,d=e.config.localeInfo;switch(r.kind){case F.b.String:i=function(e){if(0===e.length)return!1;var t=Object(u.i)(e,0);return t>=1424&&t<=1535||8207===t||t>=64285&&t<=64335||t>=1536&&t<=1791||t>=1872&&t<=1919||t>=2208&&t<=2303||t>=64336&&t<=65023||t>=65136&&t<=65279}(r.value)?n.a.Right:n.a.Left,o=n.c.None,l=r;break;case F.b.Number:i=t.isTextOnly?n.a.Left:n.a.Right,o=n.c.All,l=r;break;case F.b.Boolean:i=n.a.Center,o=n.c.All,l=Object(s.u)(r.value?d.trueName:d.falseName);break;case F.b.Blank:return Object(j.f)(Object(n.u)([],void 0,n.a.Left,n.c.All));case F.b.Error:var f=d.errorNames[r.type];return null==f?Object(j.c)(Object(c.w)("No locale data for error type ".concat(r.type))):Object(j.f)(Object(n.u)([Object(n.t)(f)],void 0,n.a.Center,n.c.All));case F.b.Array:return Object(j.c)(Object(c.hb)(["Array applyFormat"]));case F.b.Rich:return Object(j.c)(Object(c.hb)(["Rich applyFormat"]))}return t.apply(l,i,o,a)}catch(e){return Object(j.c)(Object(j.e)(e))}}function We(e,t){try{switch(e.valueType){case n.h.General:return Object(j.c)(Object(c.hb)(["changeDecimals General"]));case n.h.Number:case n.h.Currency:case n.h.Accounting:case n.h.Percentage:case n.h.Scientific:if(0===e.decimals&&t<0)return j.g;var r=Object(h.b)(0,e.decimals+t),a=e.synthesizeDecimals(r);return a.formatString===e.formatString?j.g:Object(j.f)(a);default:return j.g}}catch(e){return Object(j.c)(Object(j.e)(e))}}var ze,qe,Ke=r(90),Ye=r(2),Je=r(19),Qe=r(71),Xe=r(29),Ze=r(22),$e=Object(h.w)()((function(e,t,r,n){return{strong:e,format:t,valueType:r,decimals:n}})),et={},tt=Object(c.c)("InferenceError"),rt={getDocumentLoc:function(){return Object(o.a)("calc.numfmt.evalFormula: default getDocumentLoc")},getSheetIndex:function(){return Object(o.a)("calc.numfmt.evalFormula: default getSheetIndex")},getSheetName:function(){return Object(o.a)("calc.numfmt.evalFormula: default getSheetName")},getNameLoc:function(){return Object(o.a)("calc.numfmt.evalFormula: default getNameLoc")},getUserDefinedFuncLoc:function(){return Object(o.a)("calc.numfmt.evalFormula: default getUserDefinedFuncLoc")},getSheetRangeIndexes:function(){return Object(o.a)("calc.numfmt.evalFormula: default getSheetRangeIndexes")},getCellFormat:function(){return Object(o.a)("calc.numfmt.evalFormula: default getCellFormat")},getKnownFormat:function(){return Object(o.a)("calc.numfmt.evalFormula: default getKnownFormat")},getIformat:function(){return Object(o.a)("calc.numfmt.evalFormula: default getIformat")},getFormatString:function(){return Object(o.a)("calc.numfmt.evalFormula: default getFormatString")},getContainingTable:function(){return Object(o.a)("calc.numfmt.evalFormula: default getContainingTable")},getStructRefColumn:function(){return Object(o.a)("calc.numfmt.evalFormula: default getStructRefColumn")},getStructRefSpecialRef:function(){return Object(o.a)("calc.numfmt.evalFormula: default getStructRefSpecialRef")}};function nt(e,t){var r,n,a=function(e){var t,r,n,a,i,o,c,u,s,l,d,f,b,h,v,p,m,g,O,j,y,S,C,k,E,A;return{config:e.config,getDocumentLoc:null!==(r=null===(t=e.getDocumentLoc)||void 0===t?void 0:t.bind(e))&&void 0!==r?r:rt.getDocumentLoc,getSheetIndex:null!==(a=null===(n=e.getSheetIndex)||void 0===n?void 0:n.bind(e))&&void 0!==a?a:rt.getSheetIndex,getSheetName:null!==(o=null===(i=e.getSheetName)||void 0===i?void 0:i.bind(e))&&void 0!==o?o:rt.getSheetName,getNameLoc:null!==(u=null===(c=e.getNameLoc)||void 0===c?void 0:c.bind(e))&&void 0!==u?u:rt.getNameLoc,getUserDefinedFuncLoc:null!==(l=null===(s=e.getUserDefinedFuncLoc)||void 0===s?void 0:s.bind(e))&&void 0!==l?l:rt.getUserDefinedFuncLoc,getSheetRangeIndexes:null!==(f=null===(d=e.getSheetRangeIndexes)||void 0===d?void 0:d.bind(e))&&void 0!==f?f:rt.getSheetRangeIndexes,getCellFormat:null!==(h=null===(b=e.getCellFormat)||void 0===b?void 0:b.bind(e))&&void 0!==h?h:rt.getCellFormat,getKnownFormat:null!==(p=null===(v=e.getKnownFormat)||void 0===v?void 0:v.bind(e))&&void 0!==p?p:rt.getKnownFormat,getIformat:null!==(g=null===(m=e.getIformat)||void 0===m?void 0:m.bind(e))&&void 0!==g?g:rt.getIformat,getFormatString:null!==(j=null===(O=e.getFormatString)||void 0===O?void 0:O.bind(e))&&void 0!==j?j:rt.getFormatString,getContainingTable:null!==(S=null===(y=e.getContainingTable)||void 0===y?void 0:y.bind(e))&&void 0!==S?S:rt.getContainingTable,getStructRefColumn:null!==(k=null===(C=e.getStructRefColumn)||void 0===C?void 0:C.bind(e))&&void 0!==k?k:rt.getStructRefColumn,getStructRefSpecialRef:null!==(A=null===(E=e.getStructRefSpecialRef)||void 0===E?void 0:E.bind(e))&&void 0!==A?A:rt.getStructRefSpecialRef}}(e);return{globals:a,locals:t,config:e.config,localeInfo:null!==(n=null===(r=t.config)||void 0===r?void 0:r.localeInfo)&&void 0!==n?n:e.config.localeInfo,mathpack:e.config.mathpack,get document(){var e=t.originSheet;if(!Object(j.d)(e))throw new tt(e);return e.value.document},get defaultFormat(){var e=lt(this,g.d.General);return $e(!1,e,e.valueType,e.decimals)},get unitlessFormat(){var e=lt(this,g.d.General);return $e(!0,e,e.valueType,e.decimals)},resolver:Object(Qe.a)(a),multOrDivTainted:!1}}var at,it=((ze={})[n.h.General]=0,ze[n.h.Number]=1,ze[n.h.Currency]=2,ze[n.h.Accounting]=2,ze[n.h.Percentage]=3,ze[n.h.Date]=4,ze[n.h.Time]=5,ze[n.h.Fraction]=6,ze[n.h.Scientific]=7,ze[n.h.Text]=8,ze[n.h.Custom]=9,ze);!function(e){e[e.Propagate=-2147483648]="Propagate",e[e.Ignore=-2147483647]="Ignore"}(at||(at={}));var ot=((qe={})[l.b.INT]=at.Propagate,qe[l.b.MOD]=at.Propagate,qe[l.b.ROUND]=at.Propagate,qe[l.b.SUM]=at.Propagate,qe[l.b.TRUNC]=at.Propagate,qe[l.b.AVERAGE]=at.Propagate,qe[l.b.MAX]=at.Propagate,qe[l.b.MEDIAN]=at.Propagate,qe[l.b.MIN]=at.Propagate,qe[l.b.ROUNDUP]=at.Propagate,qe[l.b.ROUNDDOWN]=at.Propagate,qe[l.b.NPV]=g.d.CoCurrencyDec,qe[l.b.PV]=g.d.CoCurrencyDec,qe[l.b.FV]=g.d.CoCurrencyDec,qe[l.b.PMT]=g.d.CoCurrencyDec,qe[l.b.RATE]=g.d.Pct0,qe[l.b.MIRR]=g.d.Pct0,qe[l.b.IRR]=g.d.Pct0,qe[l.b.DATE]=g.d.MMDDYY,qe[l.b.TIME]=g.d.HHMMAP,qe[l.b.NOW]=g.d.MDYHMS,qe[l.b.SLN]=g.d.CoCurrencyDec,qe[l.b.SYD]=g.d.CoCurrencyDec,qe[l.b.DDB]=g.d.CoCurrencyDec,qe[l.b.IPMT]=g.d.CoCurrencyDec,qe[l.b.PPMT]=g.d.CoCurrencyDec,qe[l.b.TODAY]=g.d.MMDDYY,qe[l.b.VDB]=g.d.CoCurrencyDec,qe[l.b.DB]=g.d.CoCurrencyDec,qe);var ct=[[n.h.General,n.h.Number,n.h.Currency,n.h.Percentage,n.h.Date,n.h.Time,n.h.Fraction,n.h.Scientific,n.h.Text,n.h.Custom],[n.h.General,n.h.Number,n.h.Currency,n.h.Percentage,n.h.Date,n.h.Time,n.h.Number,n.h.Scientific,n.h.Text,n.h.Custom],[n.h.General,n.h.General,n.h.Currency,n.h.General,n.h.General,n.h.General,n.h.Currency,n.h.Currency,n.h.Text,n.h.Custom],[n.h.General,n.h.General,n.h.General,n.h.Percentage,n.h.General,n.h.General,n.h.Percentage,n.h.Percentage,n.h.Text,n.h.Custom],[n.h.General,n.h.General,n.h.General,n.h.General,n.h.General,n.h.Date,n.h.General,n.h.General,n.h.Text,n.h.Custom],[n.h.General,n.h.General,n.h.General,n.h.General,n.h.General,n.h.Time,n.h.General,n.h.General,n.h.Text,n.h.Custom],[n.h.General,n.h.General,n.h.General,n.h.General,n.h.General,n.h.General,n.h.Fraction,n.h.Scientific,n.h.Text,n.h.Custom],[n.h.General,n.h.General,n.h.General,n.h.General,n.h.General,n.h.General,n.h.General,n.h.Scientific,n.h.Text,n.h.Custom],[n.h.General,n.h.General,n.h.General,n.h.General,n.h.General,n.h.General,n.h.General,n.h.General,n.h.Text,n.h.Custom],[n.h.General,n.h.General,n.h.General,n.h.General,n.h.General,n.h.General,n.h.General,n.h.General,n.h.General,n.h.Custom]],ut=[[n.h.General,n.h.Number,n.h.Currency,n.h.General,n.h.Date,n.h.Time,n.h.Fraction,n.h.Scientific,n.h.Text,n.h.Custom],[n.h.General,n.h.Number,n.h.Currency,n.h.Number,n.h.Date,n.h.Time,n.h.Fraction,n.h.Scientific,n.h.Text,n.h.Custom],[n.h.General,n.h.General,n.h.General,n.h.Currency,n.h.General,n.h.General,n.h.Currency,n.h.Currency,n.h.Text,n.h.Custom],[n.h.General,n.h.General,n.h.General,n.h.Percentage,n.h.Date,n.h.Time,n.h.Percentage,n.h.Scientific,n.h.Text,n.h.Custom],[n.h.General,n.h.General,n.h.General,n.h.General,n.h.General,n.h.General,n.h.Date,n.h.Date,n.h.Text,n.h.Custom],[n.h.General,n.h.General,n.h.General,n.h.General,n.h.General,n.h.General,n.h.Time,n.h.Time,n.h.Text,n.h.Custom],[n.h.General,n.h.General,n.h.General,n.h.General,n.h.General,n.h.General,n.h.Fraction,n.h.Scientific,n.h.Text,n.h.Custom],[n.h.General,n.h.General,n.h.General,n.h.General,n.h.General,n.h.General,n.h.General,n.h.Scientific,n.h.Text,n.h.Custom],[n.h.General,n.h.General,n.h.General,n.h.General,n.h.General,n.h.General,n.h.General,n.h.General,n.h.Text,n.h.Custom],[n.h.General,n.h.General,n.h.General,n.h.General,n.h.General,n.h.General,n.h.General,n.h.General,n.h.General,n.h.Custom]];function st(e,t){if("number"!=typeof t)return t;var r=e.globals.getIformat(e.document,t);if(!Object(j.d)(r))throw new tt(r.reason);return r.value}function lt(e,t){var r=e.globals.getKnownFormat(e.document,t);if(!Object(j.d)(r))throw new tt(r.reason);return r.value}function dt(e,t){if("number"==typeof t)return t;var r=e.globals.getFormatString(e.document,t.formatString);if(!Object(j.d)(r))throw new tt(r.reason);return void 0!==r.value?r.value:t}function ft(e,t,r){return Object(o.h)("calc.numfmt.evalFormula: well-formed bin op",2===t.length),r(e,t[0],t[1])}function bt(e,t,r,n){var a=r[0],i=n[0],o=it[a.valueType],c=it[i.valueType],u=o<=c?t[o][c]:t[c][o],s=it[u],l=i.decimals>a.decimals?i.decimals:a.decimals;switch(s){case o:return $e(!0,a.format,a.valueType,l);case c:return $e(!0,i.format,i.valueType,l);default:return e.unitlessFormat}}function ht(e,t,r){return bt(e,ut,t,r)}function vt(e,t,r){var a=t[0],i=r[0];if(a.format===i.format&&a.valueType===i.valueType&&a.valueType===n.h.Time)return $e(!0,a.format,a.valueType,a.decimals);if(a.valueType===n.h.Date&&i.valueType===n.h.Time||a.valueType===n.h.Time&&i.valueType===n.h.Date){var o=lt(e,g.d.MDYHMS),c=o.valueType,u=o.decimals;return $e(!0,o,c,u)}return bt(e,ct,t,r)}var pt=function(e){return e.unitlessFormat};function mt(e,t,r){var n=t[0],a=r[0];return n.format===a.format?$e(!0,n.format,n.valueType,n.decimals):e.unitlessFormat}function gt(e){return it[e]===it[n.h.General]}var Ot=function(){function e(e){var t=this;this.context=e,this.visitFormulaNode=function(e){return Object(Xe.r)(t,e)},this.lazyVisitFormulaNode=function(e){return Ze.a.resolve(e).bind(t.visitFormulaNode)}}return e.prototype.literalNode=function(e){switch(e.kind){case F.b.String:case F.b.Boolean:case F.b.Error:case F.b.Missing:return Ze.a.resolve(this.context.defaultFormat);case F.b.Number:var t=this.context.mathpack.formatGeneral(this.context.localeInfo,this.context.mathpack.abs(e),21),r=t.indexOf(this.context.localeInfo.decimalSeparator),n=r>=0?t.length-r-1:0,a=lt(this.context,g.d.General);return Ze.a.resolve($e(!1,a,a.valueType,n));default:return Object(o.e)("calc.numfmt.evalFormat: unexpected literal oper",e)}},e.prototype.arrayNode=function(e){return Ze.a.resolve(this.context.defaultFormat)},e.prototype.appNode=function(e,t){var r,n=this;if(Object(c.N)(e))return Ze.a.all(t.map((function(e){return n.lazyVisitFormulaNode(e).bind((function(t){return[t,e]}))}))).bind((function(t){return function(e,t,r){switch(t){case l.a.Mul:case l.a.Div:return e.multOrDivTainted=!0,ft(e,r,ht);case l.a.Pow:return ft(e,r,ht);case l.a.Add:case l.a.Sub:return ft(e,r,vt);case l.a.Percent:Object(o.h)("calc.numfmt.evalFormat: well-formed unary op",1===r.length);var n=r[0],a=n[0],i=n[1];if(!Object(c.L)(i))return e.defaultFormat;var u=a.strong,s=a.decimals,d=lt(e,g.d.Pct);return $e(u,d,d.valueType,s);case l.a.Pound:case l.a.At:return e.defaultFormat;case l.a.Neg:case l.a.Pos:return Object(o.h)("calc.numfmt.evalFormat: well-formed unary op",1===r.length),a=r[0][0];case l.a.Lt:case l.a.Le:case l.a.Eq:case l.a.Ge:case l.a.Gt:case l.a.Ne:return ft(e,r,pt);case l.a.Isect:case l.a.Union:case l.a.Range:case l.a.Concat:return ft(e,r,mt);case l.a.And:case l.a.Or:case l.a.Xor:case l.a.Min:case l.a.Max:throw new tt(Object(c.hb)(["evalFormat for Yellow ops"]));default:return Object(o.e)("calc.numfmt.evalFormat: unexpected operator id",t)}}(n.context,e.id,t)}));if(Object(c.db)(e)){var a=e.id,i=null!==(r=ot[a])&&void 0!==r?r:at.Ignore,u=Object(l.e)(a),s=Object(c.g)(Object(Ye.l)(e,t));if(Object(o.h)("calc.numfmt.evalFormula: well-formed WSF args",Object(c.cb)(u,s.length)),i===at.Ignore)return Ze.a.resolve(this.context.defaultFormat);if(i===at.Propagate)return 0===s.length?Ze.a.resolve(this.context.defaultFormat):Ze.a.all(t.map(this.lazyVisitFormulaNode)).bind((function(e){var t=e[0],r=t.format,a=t.valueType,i=t.decimals,o=!gt(a);if(!t.strong&&o)return n.context.unitlessFormat;for(var c=o,u=1;u<e.length;u+=1){var s=e[u],l=!gt(s.valueType);if(!s.strong&&l)return n.context.unitlessFormat;c||(r=s.format,a=s.valueType,i=s.decimals,c=l)}return $e(!0,r,a,i)}));var d=lt(this.context,i),f=d.valueType,b=d.decimals;return Ze.a.resolve($e(!0,d,f,b))}return this.lazyVisitFormulaNode(e)},e.prototype.letNode=function(e,t,r,n){return Ze.a.resolve(this.context.defaultFormat)},e.prototype.lambdaNode=function(e,t,r,n){return Ze.a.resolve(this.context.defaultFormat)},e.prototype.parenNode=function(e){return this.lazyVisitFormulaNode(e)},e.prototype.nameNode=function(e,t){return Ze.a.resolve(this.context.defaultFormat)},e.prototype.cellRefNode=function(e,t){var r=this.context.resolver.resolveCellRef(this.context.locals,Object(Ye.u)(e,t)).resolution;if(!Object(j.d)(r))throw Object(o.h)("calc.numfmt.evalFormat: NoOriginSheet",r.reason.kind!==Je.d.NoOriginSheet),new tt(r.reason);var n=r.value;if(void 0===n)throw et;return Object(c.W)(n)?Ze.a.resolve(yt(this.context,n)):Ze.a.resolve(this.context.unitlessFormat)},e.prototype.fieldRefNode=function(e,t){var r=this;return this.lazyVisitFormulaNode(e).bind((function(e){return r.context.defaultFormat}))},e.prototype.structRefNode=function(e,t){var r=Object(Ye.kb)(e,t),n=this.context.resolver.resolveStructRef(this.context.locals,r).resolution;if(!Object(j.d)(n)){if(Object(o.h)("calc.numfmt.evalFormat: NoOriginSheet",n.reason.kind!==Je.d.NoOriginSheet),n.reason.kind===Je.d.EmptyIntersection)throw et;throw new tt(n.reason)}var a=n.value;if(void 0===a)throw et;return Ze.a.resolve(yt(this.context,a))},e.prototype.badSequenceNode=function(e,t){return Object(o.a)("calc.numfmt.evalFormat: unexpected bad node")},e.prototype.badStringNode=function(e,t){return Object(o.a)("calc.numfmt.evalFormat: unexpected bad node")},e.prototype.operatorNode=function(e,t){return Ze.a.resolve(Object(Ye.Y)(e,t))},e.prototype.wsfNode=function(e,t,r){return Ze.a.resolve(Object(Ye.mb)(e,t,r))},e}();function jt(e,t){return Object(Xe.n)(new Ot(e),t)}function yt(e,t){var r=Object(c.ib)(t),a=e.globals.getCellFormat(r);if(!Object(j.d)(a))throw new tt(a.reason);var i=a.value,o=st(e,i);if(!Object(c.D)(r.sheet.document,e.document)&&("number"!=typeof i||o.source!==n.l.Builtin))return e.defaultFormat;var u=o.valueType,s=o.decimals;return $e(!0,i,u,s)}function St(e,t,r){try{var a=nt(e,t),i=jt(a,r);return Object(j.f)(function(e,t){var r=t.strong,a=t.format,i=t.valueType,o=t.decimals;if(i!==n.h.Number||!e.multOrDivTainted){if(o>0&&r&&(i===n.h.Number||i===n.h.Currency||i===n.h.Accounting||i===n.h.Percentage)){var c=st(e,a);o!==c.decimals&&(a=c.synthesizeDecimals(o))}if(i!==n.h.General&&r)return a=dt(e,a)}}(a,i))}catch(e){return e instanceof tt?Object(j.c)(e.reason):e===et?j.g:Object(j.c)(Object(j.e)(e))}}var Ct=r(48),kt=r(81);function Et(e,t,r,a,i){if(i.isDate||i.isTime){var u=function(e,t,r,a,i){var u=t.config,s=u.mathpack,l=u.localeInfo;if(s.cond(a)<0)return Object(j.f)(void 0);var d="",f=0!==s.fix(a)||i.isDate,b=a;if(f){var h=s.trunc(a),v=Object(kt.b)(e,t,r,Object(Ct.b)(l,!0),n.l.CustomString);if(!Object(j.d)(v))return v;var p=Object(kt.e)(e,v.value,h);if(!Object(j.d)(p))return p;if("string"!=typeof p.value)return Object(j.f)(void 0);d+=p.value;var m=s.sub(a,h);Object(o.h)("calc.numfmt.renderFormulaBar: sub error",!Object(c.E)(m)),b=m}if(s.cond(b)>0||i.isTime){f&&(d+="  ");var O=t.getKnownFormat(r,l.clock24Hour?g.d.HHMMSS:g.d.HHMMSSAP);if(!Object(j.d)(O))return O;p=Object(kt.e)(e,O.value,b);if(!Object(j.d)(p))return p;if("string"!=typeof p.value)return Object(j.f)(void 0);d+=p.value}return Object(j.f)(d)}(e,Object(kt.d)(t),r,a,i);if(!Object(j.d)(u))return u;if(void 0!==u.value){u.value;return u}}var s=t.config,l=s.mathpack,d=s.localeInfo;if(i.isPercent){var f=l.mul(a,l.fromNumber(100));return Object(c.E)(f)?Object(j.c)(Object(c.hb)(["renderFormulaBar % overflow"])):Object(j.f)(l.formatGeneral(d,f,21)+"%")}return Object(j.f)(l.formatGeneral(d,a,21))}var At=r(113),Nt=r(94);function Tt(e){return{createFormat:function(t,r){return function(e,t,r){try{return Object(j.f)(new Ve(e.config,{old:void 0,formatString:t,source:r}))}catch(e){return e instanceof Ge?Object(j.c)(e.reason):Object(j.c)(Object(j.e)(e))}}(e,t,"boolean"!=typeof r?r:r?n.l.Builtin:n.l.CustomString)},applyFormat:function(t,r,n){return He(e,t,r,n)},changeFormatDecimals:We,renderValue:function(t,r){return R(e.config.mathpack,t,r)},renderHashesValue:function(e,t){return function(e,t){try{var r=k(Object(n.B)(t),e.clip,"","","#",!1,(function(e){return Object(f.f)("#",e)}));if("number"==typeof r)switch(r){case n.c.MaxChars:r=Object(f.f)("#",255);break;case n.c.CellWidth:r="";break;default:return Object(o.e)("calc.numFmt.renderHashesValue",r)}var a=Object(n.t)(r);return Object(j.f)(Object(n.K)([a],e.color,e.alignment,e.clip))}catch(e){return Object(j.c)(Object(j.e)(e))}}(e,t)},renderFormulaBar:function(t,r,n,a){return function(e,t,r,n,a,i){try{var u=t.config.localeInfo;switch(n.kind){case F.b.Number:return Et(e,t,r,n,a);case F.b.String:return Object(j.f)(i?"'"+n.value:n.value);case F.b.Boolean:return Object(j.f)(n.value?u.trueName:u.falseName);case F.b.Error:var s=u.errorNames[n.type];return null==s?Object(j.c)(Object(c.w)("No locale data for error type ".concat(n.type))):Object(j.f)(s);case F.b.Array:return Object(j.c)(Object(c.hb)(["Array renderFormulaBar"]));case F.b.Rich:return Object(j.c)(Object(c.hb)(["Rich renderFormulaBar"]));case F.b.Blank:return Object(j.f)("");default:return Object(o.e)("calc.numfmt.renderFormulaBar: never value",n)}}catch(e){return Object(j.c)(Object(j.e)(e))}}(this,e,t,r,n,a)},parseGeneral:function(t,r,n,a){return function(e,t,r,n,a){try{var i=e.config,o=i.localeInfo,c=i.mathpack,u=Object(At.a)(o,c,t,r,n,!1);return Object(j.d)(u)?void 0!==u.value?u:Object(Nt.b)(Object(Nt.a)(e),t,void 0,a):u}catch(e){return Object(j.c)(Object(j.e)(e))}}(e,t,r,n,a)},parseDate:function(t,r){return function(e,t,r){try{return Object(Nt.b)(Object(Nt.a)(e),t,void 0,r)}catch(e){return Object(j.c)(Object(j.e)(e))}}(e,t,r)},parseEdit:function(t,r){return Object(Ke.a)(e,t,r)},evalFormat:function(t,r){return St(e,t,r)}}}r.d(t,"a",(function(){return Tt}))},function(e,t,r){"use strict";r.d(t,"c",(function(){return a})),r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return o}));var n=r(20),a=n.interval.ivlJoin,i=(n.interval.ivlMeet,n.interval.ivlDistance,n.interval.ivlMeets,n.interval.ivlMeetsOrTouches,n.interval.ivlExcept),o=n.interval.ivlCompare},function(e,t,r){"use strict";r.d(t,"a",(function(){return S})),r.d(t,"b",(function(){return Y}));var n,a=r(9),i=r(4),o=r(6),c=r(10),u=r(3),s=r(23),l=r(33),d=r(61),f=r(5),b=r(11),h=r(36),v=r(18),p=r(0),m=l.z,g=l.D,O=l.t,j=l.f,y={getTime:function(){return Object(f.a)("calc.numfmt.parseDateInternal: default getTime")}};function S(e){var t,r;return{config:e.config,getTime:null!==(r=null===(t=e.getTime)||void 0===t?void 0:t.bind(e))&&void 0!==r?r:y.getTime}}function C(e,t){return Object(f.h)("calc.numfmt.monthToken",U(e,1,12)),{kind:0,value:e,bidiDate:t}}var k=Object(a.__spreadArray)([],new Array(12),!0).map((function(e,t){return C(t+1)})),E=function(e){return k[e]},A=function(e){return C(e+1,o.b.English)},N=function(e){return C(e+1,o.b.Lunar)},T=[!0,!1].map((function(e){return{kind:1,am:e}})),R=T[0],I=T[1],_=function(e){return 0===e?R:I};function F(e,t,r){return Object(f.h)("calc.numfmt.numberToken",Object(v.b)(e)&&U(e,-9999,9999)&&U(t,1,4)),{kind:2,value:e,digits:t,numShape:r}}var w=function(e){return 3===e||4===e},M=function(e,t){return e.lcid===i.b.Hungarian&&2===t},D=function(e){return e<=1},P=function(e){return e<=2},x=["上午","下午"],L=((n={})[i.a.FRN]=[["Jun",C(6)],["Jul",C(7)]],n[i.a.DUT]=[["Mrt",C(3)]],n[i.a.GER]=[["Mrz",C(3)]],n),B=["محرم","صفر","ربيع الاول","ربيع الثاني","جمادى الاولى","جمادى الثانية","رجب","شعبان","رمضان","شوال","ذو القعدة","ذو الحجة"];function U(e,t,r){return e>=t&&e<=r}function G(e,t){var r=e.getTime(h.c.Year,t);if(!Object(p.d)(r))return r;var n=e.config,a=n.datepack.fromNum(n,r.value,h.a.RoundSec);return Object(f.h)("calc.numfmt.parseDateInternal: current year fromNum",!1!==a),Object(p.f)(a.yr)}function V(e,t,r,n){return n+t.length<=r.length&&0===e.stringCompareCI(t,r.substring(n,n+t.length))}function H(e,t,r,n,a,i){for(var o=t.indexOf(" ",r),u=0;u<n.length;u+=1){var s=n[u],l=Object(c.c)(a,s.length);if(o>=0&&s.indexOf(" ")<0&&o-r>=l&&o-r<=s.length)if(V(e,b=s.substring(0,o-r),t,r))return[i(u),r+b.length];for(var d=void 0,f=l;f<=s.length;f+=1){var b;if(!V(e,b=s.substring(0,f),t,r))break;d=r+b.length}if(void 0!==d)return[i(u),d]}}function W(e,t,r,n,a){for(var i=0;i<n.length;i+=1){var o=n[i];if(V(e,o,t,r))return[a(i),r+o.length]}}function z(e,t,r){var n,a=L[e.country];if(void 0!==a)for(var o=0,c=a;o<c.length;o++){var u=c[o],s=u[0],l=u[1];if(V(e,s,t,r))return[l,r+s.length]}if(e.isEastAsia){if(void 0!==(n=H(e,t,r,Object(i.s)().monthNameLong,3,E)))return n}else if(e.isComplexScript){if(void 0!==(n=W(e,t,r,e.monthNameLong,E)))return n;if(void 0!==(n=W(e,t,r,e.monthNameShort,E)))return n;if(void 0!==(n=W(e,t,r,Object(i.s)().monthNameLong,A)))return n;if(void 0!==(n=W(e,t,r,Object(i.s)().monthNameShort,A)))return n}else if(void 0!==(n=H(e,t,r,e.monthNameLong,3,E)))return n;return(e.lcid&i.b.LANG)==(i.b.Arabic&i.b.LANG)&&void 0!==(n=W(e,t,r,B,N))||void 0!==(n=H(e,t,r,e.ampmSymbols,1,_))||void 0!==(n=H(e,t,r,Object(i.s)().ampmSymbols,1,_))||(e.isChinaS||e.isChinaT)&&void 0!==(n=H(e,t,r,x,1,_))?n:[void 0,r]}function q(e,t,r,n){var a,i,o,c,u,l=r,h=t.charCodeAt(l)===O;if(h&&(l+=1),5===n){if(o=(a=Object(d.d)(e,4,l+4<t.length?t.substring(0,l+4):t,l))[0],u=(c=a[1])-l,Object(f.h)("calc.numfmt.parseDateInternal: 0 < digits <= 4",U(u,1,4)),4===u){for(var v=void 0;c<t.length&&e.isNumeral(v=Object(s.i)(t,c));)c+=Object(s.f)(v);o=Math.round(o/10),u=3}}else if(o=(i=Object(d.d)(e,4,t,l))[0],(u=(c=i[1])-l)>4||u>2&&o<100)return[void 0,r];if(0===u)return[void 0,r];var p=function(e,t){for(var r=b.e.ASCII,n=0,a=Object(s.b)(t);n<a.length;n++){var i=a[n],o=e.getNumberShape(i);o!==b.e.ASCII&&(r=o)}return r}(e,t.substring(l,c));return l=c,[F(h?-o:o,u,p),l]}function K(e,t,r,n){var a=0,i=r;if(t.charCodeAt(i)===g)for(a=1;t.charCodeAt(i)===g;)i+=1;return null!=e.timeAltSeparator&&e.timeAltSeparator!==e.timeSeparator&&3===n&&Object(v.h)(t,e.timeAltSeparator,i)?(a=4,i+=e.timeAltSeparator.length):Object(v.h)(t,e.dateSeparator,i)?(a=2,i+=e.dateSeparator.length):Object(v.h)(t,e.timeSeparator,i)?(a=3,i+=e.timeSeparator.length):Object(v.h)(t,e.decimalSeparator,i)&&3===n?(a=5,i+=e.decimalSeparator.length):t.charCodeAt(i)===m||t.charCodeAt(i)===O?(a=2,i+=1):t.charCodeAt(i)===j?(a=3,i+=1):Object(v.h)(t,", ",i)&&(a=6,i+=2),1===a&&(" "===e.dateSeparator?a=2:" "===e.timeSeparator?a=3:" "===e.decimalSeparator&&3===n&&(a=5)),[a,i]}function Y(e,t,r,n){var a=e.config,i=a.localeInfo;if(!i.isEastAsia&&!function(e,t){for(var r=0,n=Object(s.b)(t);r<n.length;r++){var a=n[r];if(e.isNumeral(a))return!0}return!1}(i,t))return Object(p.f)(void 0);if(i.isEastAsia)return Object(p.c)(Object(u.hb)(["parse East Asia date"]));if(i.isThai){var c=t.indexOf("b");if(c<0&&(c=t.indexOf("B")),c>=0&&c+1<t.length&&i.isNumeral(Object(s.i)(t,c+1)))return Object(p.c)(Object(u.hb)(["parse Thai Buddhist date"]))}var l=function(e,t,r){for(var n,a=e.localeInfo,i=e.dateCompatibility,o=[],c=null==r?void 0:r.bidiDate,l=b.e.ASCII,d=null==r?void 0:r.culture,h=!1,v=!1,m=0;m<t.length;){if(o.length>=9)return Object(p.f)(void 0);var j=void 0;if(a.isNumeral(Object(s.i)(t,m))||!i&&m+1<t.length&&t.charCodeAt(m)===O&&a.isNumeral(Object(s.i)(t,m+1))){var y=q(a,t,m,n),S=y[0],C=y[1];if(void 0===S)return Object(p.f)(void 0);m=C,S.numShape!==b.e.ASCII&&(l=S.numShape),j=S}else{if(t.charCodeAt(m)===g)return Object(p.c)(Object(u.hb)(["absurd date/time string with leading space"]));var k=z(a,t,m),E=k[0],A=k[1];if(void 0===E)return Object(p.f)(void 0);if(m=A,0===E.kind){if(h)return Object(p.f)(void 0);h=!0,void 0!==E.bidiDate&&(c=E.bidiDate)}if(1===E.kind){if(v)return Object(p.f)(void 0);if(v=!0,0===o.length||1!==o[o.length-1].sep)return Object(p.f)(void 0);n=o[o.length-1].sep=3}j=E}var N=K(a,t,m,n),T=N[0];for(m=N[1];m<t.length&&t.charCodeAt(m)===g;)m+=1;o.push({tok:j,sep:T}),n=T}return Object(f.h)("calc.numfmt.parseDateInternal: > 0 tokens",0!==o.length),Object(p.f)({tokens:o,bidiDate:c,numShape:l,culture:d})}(a,t,r);if(!Object(p.d)(l)||void 0===l.value)return l;var d=l.value,v=d.tokens,m=d.bidiDate,j=d.numShape,y=d.culture;if(m===o.b.Lunar)return Object(p.c)(Object(u.hb)(["Lunar calendar"]));if(void 0!==y&&(y.localCalendarInput||y.tag===o.d.Gannen))return Object(p.c)(Object(u.hb)(["parse date: possible local calendar"]));var S=function(e,t){for(var r,n,a,i,o,c,s,l=e.localeInfo,d=0;d<t.length;d+=1)if(w(t[d].sep)){r={start:d,end:d+1};break}if(void 0!==r){if(0!==r.start&&1!==t[r.start-1].sep&&!M(l,t[r.start-1].sep))return Object(p.f)(void 0);for(;r.end<t.length&&w(t[r.end-1].sep);)r.end+=1;if(r.end<t.length&&5===t[r.end-1].sep){r.end+=1;var b=t[r.end-1];if(2!==b.tok.kind)return Object(p.f)(void 0);b.tok;if(c=b,r.end<t.length&&w(t[r.end-1].sep)){if(r.end+=1,1!==(h=t[r.end-1]).tok.kind)return Object(p.c)(Object(u.hb)(["non-AM/PM after FracSec"]));h.tok;s=h}}else{var h;if(1===(h=t[r.end-1]).tok.kind){h.tok;s=h}}var v=r.end-r.start-(void 0!==c?1:0)-(void 0!==s?1:0);for(d=0;d<v;d+=1)if(2!==t[r.start+d].tok.kind)return Object(p.c)(Object(u.hb)(["non-number in H/M/S component"]));switch(v){case 0:return Object(f.a)("calc.numfmt.parseDateInternal: 0 time");case 1:Object(f.h)("calc.numfmt.parseDateInternal: 1 time => !fracSec",void 0===c),a=t[r.start];break;case 2:void 0===c?(a=t[r.start],i=t[r.start+1]):(i=t[r.start],o=t[r.start+1]);break;case 3:a=t[r.start],i=t[r.start+1],o=t[r.start+2];break;default:return Object(p.f)(void 0)}for(d=r.end;d<t.length;d+=1)if(w(t[d].sep))return Object(p.f)(void 0);if(r.end===t.length){var m=t[r.end-1].sep;if(!(D(m)||void 0!==s&&5===m))return Object(p.c)(Object(u.hb)(["trailing sep after time"]))}else{var g=t[r.end-1].sep;if(!D(g)&&6!==g)return Object(p.c)(Object(u.hb)(["unexpected sep between time and date"]))}if(0===r.start)r.end!==t.length&&(n={start:r.end,end:t.length});else{if(r.end!==t.length)return Object(p.c)(Object(u.hb)(["date part split around time part"]));n={start:0,end:r.start}}}else n={start:0,end:t.length};return Object(p.f)({time:r,date:n,hour:a,min:i,sec:o,fracSec:c,ampm:s})}(a,v);if(!Object(p.d)(S)||void 0===S.value)return S;var C=S.value,k=C.time,E=C.date,A=C.hour,N=C.min,T=C.sec,R=C.fracSec,I=C.ampm,_=function(e,t,r,n){var a,i,o,c=e.config,s=c.localeInfo,l=c.dateCompatibility,d=c.datepack,h=!1;if(void 0!==n){var v=n.end-n.start;if(v<2||v>3)return Object(p.f)(void 0);var m=r[n.start],g=m.tok,O=m.sep,j=r[n.start+1],y=j.tok,S=j.sep,C=r[n.end-1],k=C.tok,E=C.sep;if(Object(f.h)("calc.numfmt.parseDateInternal: all not AM/PM",1!==g.kind&&1!==y.kind&&1!==k.kind),!D(E)&&!M(s,E))return Object(p.f)(void 0);var A=void 0!==function(e,t){for(var r=t.start;r<t.end;r+=1)if(0===e[r].tok.kind)return r}(r,n);if(h=A,A)if(P(O)&&P(S))if(0===g.kind){if(v>2)return Object(p.f)(void 0);i=g,Object(f.h)("calc.numfmt.parseDateInternal: yr not Month",0!==k.kind),a=k}else{if(0!==y.kind)return Object(p.f)(void 0);o=g,i=y,3===v&&(Object(f.h)("calc.numfmt.parseDateInternal: yr not Month",0!==k.kind),a=k)}else{if(3!==v)return Object(p.f)(void 0);if(D(S))return Object(p.f)(void 0);var N=s.longDateFormat?g:y,T=s.longDateFormat?y:g;if(0!==N.kind)return Object(p.f)(void 0);Object(f.h)("calc.numfmt.parseDateInternal: Int1 dom & yr not Month",0!==T.kind&&0!==k.kind),o=T,i=N,a=k}else if(Object(f.h)("calc.numfmt.parseDateInternal: all not Month",0!==g.kind&&0!==y.kind&&0!==k.kind),2===v&&2===O)switch(h=!0,s.dateOrder){case b.c.MDY:i=g,a=k;break;case b.c.YMD:U(g.value,1,12)?(i=g,o=k):(a=g,i=k);break;case b.c.DMY:U(k.value,1,12)?(o=g,i=k):(i=g,a=k);break;default:return Object(p.c)(Object(u.hb)(["date parse date order"]))}else{if(v<3||2!==O||2!==S)return Object(p.f)(void 0);switch(g.value>999||!l&&g.value>99?b.c.YMD:s.dateOrder){case b.c.MDY:i=g,o=y,a=k;break;case b.c.YMD:a=g,i=y,o=k;break;case b.c.DMY:o=g,i=y,a=k;break;default:return Object(p.c)(Object(u.hb)(["date parse date order"]))}}}var R=!1;if(s.dateOrder!==b.c.DMY&&void 0===o&&void 0!==i&&U(i.value,1,12)&&void 0!==a&&U(a.value,1,31)){var I=G(e,t);if(!Object(p.d)(I))return I;a.value<=d.daysPerMonth(i.value,I.value,l)&&(o=a,a=F(I.value,4,b.e.ASCII),R=!0)}return Object(p.f)({yr:a,mon:i,dom:o,useMonthName:h,usingCurrentYear:R})}(e,n,v,E);if(!Object(p.d)(_)||void 0===_.value)return _;var x=_.value,L=x.yr,B=x.mon,V=x.dom,H=x.useMonthName,W=x.usingCurrentYear,Y=function(e,t,r,n,a,i,o,c,s,l){var d,b,v,m,g=e.config,O=g.mathpack,j=g.datepack,y=g.dateCompatibility;if(void 0!==n||void 0!==a||void 0!==r){if(Object(f.h)("calc.numfmt.parseDateInternal: dom || yr",void 0!==a||void 0!==r),Object(f.h)("calc.numfmt.parseDateInternal: mon",void 0!==n),!U(v=n.value,1,12))return Object(p.f)(void 0);if(void 0===r){var S=G(e,t);if(!Object(p.d)(S))return S;b=S.value}else b=U(r.value,0,99)?function(e){return 1900+(e<30?100:0)+e}(r.value):r.value;if(!U(b,1900,9999))return Object(p.f)(void 0);if(!U(m=null!==(d=null==a?void 0:a.value)&&void 0!==d?d:1,1,j.daysPerMonth(v,b,y)))return Object(p.f)(void 0)}else{var C=j.fromNum(g,O.zero,h.a.RoundSec);Object(f.h)("calc.numfmt.parseDateInternal: zeroDtr fromNum",!1!==C),b=C.yr,v=C.mon,m=C.dom}var k,E=0,A=0,N=0,T=0,R=h.a.RoundSec,I=0;if(void 0!==i){if(i.value<0)return Object(p.c)(Object(u.hb)(["negative hour"]));if(i.value>23){if(void 0!==k)return Object(p.f)(void 0);I=i.value,k=h.b.Hour}else E=i.value}if(void 0!==o){if(o.value<0)return Object(p.c)(Object(u.hb)(["negative minute"]));if(o.value>59){if(void 0!==k)return Object(p.f)(void 0);I=o.value,k=h.b.Minute}else A=o.value}if(void 0!==c){if(c.value<0)return Object(p.c)(Object(u.hb)(["negative second"]));if(c.value>59){if(void 0!==k)return Object(p.f)(void 0);I=c.value,k=h.b.Second}else N=c.value}if(void 0!==s){if(s.value<0)return Object(p.c)(Object(u.hb)(["negative fractional second"]));Object(f.h)("calc.numfmt.parseDateInternal: fracSec.digits",s.digits>=1&&s.digits<=3),R=s.digits,Object(f.h)("calc.numfmt.parseDateInternal: fracSec.value",s.value<(3===R?1001:2===R?100:10)),T=s.value}if(void 0!==l){if(void 0!==k||E>12)return Object(p.f)(void 0);l.am?12===E&&(E=0):E<12&&(E+=12)}var _=Object(h.d)(b,v,m,E,A,N,1,T,R),F=void 0!==k?j.toNumWithDuration(g,_,k,I):j.toNum(g,_);return Object(u.E)(F)?Object(p.f)(void 0):Object(p.f)({value:F,duration:k})}(e,n,L,B,V,null==A?void 0:A.tok,null==N?void 0:N.tok,null==T?void 0:T.tok,null==R?void 0:R.tok,null==I?void 0:I.tok);if(!Object(p.d)(Y)||void 0===Y.value)return Y;var J=Y.value,Q=J.value,X=function(e,t,r,n,a,i,o,c,s,l,d,v){if(e!==b.e.ASCII)return Object(p.c)(Object(u.hb)(["parseDateInternal ifmt for non-ASCII"]));if(o)return 4===(null==c?void 0:c.sep)?Object(p.c)(Object(u.hb)(["parseDateInternal ifmt for alternate time separator"])):void 0!==l?Object(p.f)(b.d.SS0):void 0!==v?v!==h.b.Hour||void 0!==d||t?Object(p.f)(b.d.General):Object(p.f)(b.d.AbsHMMSS):t?Object(p.f)(b.d.MDYHMS):void 0!==d?Object(p.f)(void 0!==s?b.d.HHMMSSAP:b.d.HHMMAP):Object(p.f)(void 0!==s?b.d.HHMMSS:b.d.HHMM);if(Object(f.h)("calc.numfmt.parseDateInternal: !haveTime => haveDate",t),!a)return Object(p.f)(b.d.MMDDYY);var m=void 0!==r&&!i;return Object(p.f)(void 0===n?b.d.MMMYY:m?b.d.DDMMMYY:b.d.DDMMM)}(j,void 0!==E,L,V,H,W,void 0!==k,N,T,R,I,J.duration);return Object(p.d)(X)?Object(p.f)({value:Q,format:X.value}):X}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mapFromArrayOfPairs=t.fswitch=t.singleton=t.now=t.typedInstanceCreator=t.makeStringCompareCI=t.fastAbs=t.fastMax=t.fastMin=t.pair=t.filterOutNones=t.isNone=t.isDefined=t.safeConcat=t.safePush=t.strEnumArray=t.numEnumMap=t.numEnumArray=t.cloneStringMap=t.makeStringMap=t.identity=t.staticAssertIsOptional=t.staticAssertIs=t.staticAssertSame=t.staticAssertExtends=t.makeNewtypeIso=void 0;var n=r(125);function a(){return function(e){return e}}function i(){var e=Object.create(null);return e.___=void 0,delete e.___,e}function o(e){return Object.keys(e).map((function(e){return Number(e)})).filter((function(e){return!isNaN(e)}))}function c(e,t){for(var r=0,n=t;r<n.length;r++){var a=n[r];e.push(a)}return e}function u(e){return null!=e}t.makeNewtypeIso=function(e,t){return{wrap:e,unwrap:t}},t.staticAssertExtends=function(){},t.staticAssertSame=function(){},t.staticAssertIs=a,t.staticAssertIsOptional=function(e){return e},t.identity=function(e){return e},t.makeStringMap=i,t.cloneStringMap=function(e){var t=i();for(var r in e)t[r]=e[r];return t},t.numEnumArray=o,t.numEnumMap=function(e,t){for(var r={},n=0,a=o(e);n<a.length;n++){var i=a[n];r[i]=t(i)}return r},t.strEnumArray=function(e){return Object.keys(e).map((function(e){return e})).map((function(t){return e[t]})).sort()},t.safePush=c,t.safeConcat=function(e,t){var r=[];c(r,e);for(var n=0,a=t;n<a.length;n++){c(r,a[n])}return r},t.isDefined=u,t.isNone=function(e){return null==e},t.filterOutNones=function(e){return e.filter(u)};t.pair=function(e,t){return[e,t]},t.fastMin=function(e,t){return e<t?e:t},t.fastMax=function(e,t){return e<t?t:e},t.fastAbs=function(e){return e<0?-e:e},t.makeStringCompareCI=function(e){try{var t=new Intl.Collator(function(e){var t=[e],r=e.indexOf("-");return r>0&&t.push(e.substring(0,r)),"en"!==t[t.length-1]&&t.push("en"),t}(e),{sensitivity:"accent"});return t.compare.bind(t)}catch(e){return function(e,t){return e===t?0:e.toLocaleUpperCase().localeCompare(t.toLocaleUpperCase())}}},t.typedInstanceCreator=function(){return function(e){return e}};var s="undefined"!=typeof self&&null!=self.performance&&null!=self.performance.now?function(){return self.performance.now()}:"undefined"!=typeof process&&null!=process.hrtime?function(){var e=process.hrtime();return 1e3*e[0]+e[1]/1e6}:function(){return Date.now()},l="undefined"!=typeof self&&null!=self.performance&&null!=self.performance.now?function(){return self.performance.now()}:function(){return Date.now()};t.now=(0,n.isTypedChangeGateEnabled)("Microsoft.Office.Excel.ChangeGate.PreciseNowForNodeJS")?s:l,t.singleton=function(e){return function(){function t(){}return t.instance=function(){return void 0===t.value&&(t.value=e()),t.value},t.prototype.instance=function(){return t.instance()},t.value=void 0,t}()},t.fswitch=function(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return t[e].apply(t,r)},t.mapFromArrayOfPairs=function(e){return e.reduce((function(e,t){var r=t[0],n=t[1];return e[r]=n,e}),{})}},function(e,t,r){"use strict";r.d(t,"a",(function(){return v})),r.d(t,"b",(function(){return S}));var n=r(2),a=r(15),i=r(13),o=r(65),c=r(27),u=r(17),s=r(0),l=r(23),d=r(33),f=d.w,b=d.c,h=d.F;function v(e,t){if(0===t.length)return!1;var r,n=Object(l.i)(t,0);return!((r=n)===h||r===b||!e.isIdentStart(r)&&!e.isNumeral(r))&&Object(l.b)(t,Object(l.f)(n)).every((function(t){return t!==f&&t!==b&&e.isIdentContinue(t)}))}var p=Object(i.s)((function(e,t){return Object(u.a)(t)||t.kind===a.c.Escape||t.kind===a.c.End?void 0:t.chars})),m=Object(i.s)((function(e,t){return t.kind!==a.c.Ident||t.chars!==e.localeInfo.leftBracket&&t.chars!==e.localeInfo.rightBracket&&"'"!==t.chars?void 0:t.chars})),g=Object(i.a)(p,Object(i.o)(u.p,m)),O=Object(i.b)(Object(i.u)(Object(i.k)(g),u.o),(function(e,t){var r=t[0];t[1];return r.join("")})),j=Object(i.c)(u.j,(function(e,t){var r=t[0],a=t[1],o=Object(i.p)(O,r,0,e);if(Object(s.d)(o)){var u=r[0].start,l=r[r.length-1].start,d=o.value.output;if(d.length>255){var f=r.map((function(e){return e.chars})).join("");return[Object(n.n)(n.b.FieldName,f,Object(c.b)(e,u,l,"","")),!1,!0]}var b=Object(c.b)(e,u,l,"",""),h=Object(c.b)(e,u,l,"","");return[Object(n.X)(Object(n.M)(d,void 0,b),void 0,h),!0,a]}})),y=Object(i.b)(u.q,(function(e,t){var r=t.start,a=t.start+t.chars.length;if(!v(e.localeInfo,t.chars)||t.chars.length>255)return[Object(n.n)(n.b.FieldName,t.chars,Object(c.b)(e,r,a,"","")),!1,!0];var i=Object(c.b)(e,r,a,"",""),o=Object(c.b)(e,r,a,"","");return[Object(n.X)(Object(n.M)(t.chars,void 0,i),void 0,o),!1,!0]})),S=Object(i.b)(Object(i.u)(u.k,u.D,u.m,Object(i.a)(y,j),u.k),(function(e,t){var r=t[0],a=t[1],i=t[2],u=t[3],s=u[0],l=u[1],d=u[2],f=t[4],b=Object(c.b)(e,i.start,f,a,""),h=Object(n.C)(s,l,d,b);return Object(o.c)(a.length>0,h,r,f)}))},function(e,t,r){"use strict";r.d(t,"a",(function(){return I})),r.d(t,"b",(function(){return F}));var n,a=r(9),i=r(35),o=r(5),c=r(39),u=r(44),s=r(2),l=r(3),d=r(1),f=r(54),b=r(7),h=r(0),v=r(29),p=r(10),m=r(22),g=r(12),O=Object(l.c)("CompileError"),j=Object(u.c)(Object(d.e)(d.b.IF)),y=Object(u.c)(Object(d.e)(d.b.CHOOSE));function S(e){return Object(c.g)(e)&&Object(l.fb)(e)}var C=function(){function e(e){this.id=e,this.slots=[],this.idToSlot={}}return e.prototype.mapStackId=function(e){var t=this.idToSlot[e];return null!=t?t:this.idToSlot[e]=this.slots.push(e)-1},e}(),k=f.a.create((function(e,t){return e-t})),E=function(){function e(e){var t=this;this.context=e,this.visitFormulaNode=function(e){return Object(v.r)(t,e)},this.lazyVisitFormulaNode=function(e){return m.a.resolve(e).bind(t.visitFormulaNode)}}return e.prototype.literalNode=function(e,t,r){return m.a.resolve(e)},e.prototype.arrayNode=function(e,t,r){var n=this;return m.a.all(e.map((function(e){return m.a.all(e.map(n.lazyVisitFormulaNode))}))).bind((function(e){return n.toArrayTerm(e)}))},e.prototype.toArrayTerm=function(e){var t=e.length,r=void 0===e[0]?0:e[0].length;return e.every((function(e){return e.every(S)}))?Object(b.c)(t,r,e):Object(c.c)(t,r,e)},e.prototype.appNode=function(t,r,n,i){var u,f=this,b=Object(l.g)(Object(s.l)(t,r,n)),h=(null===(u=this.context.annotations[i])||void 0===u?void 0:u.kind)===s.a.FormulaRoot;if(Object(l.N)(t)){var p=Object(d.c)(t.id);return m.a.all(b.map(this.lazyVisitFormulaNode)).bind((function(e){return Object(c.b)(Object(c.l)(t.id),p,h,e)}))}if(Object(l.db)(t)){var g=t.id;switch(g){case d.b.IFERROR:case d.b.IFNA:Object(o.h)("calc.runtime.toIfPredicateTerm: expected wff",2===b.length);var O=b[0],j=b[1],y=new e(Object(a.__assign)(Object(a.__assign)({},this.context),{numNames:this.context.numNames+1}));return m.a.all([this.lazyVisitFormulaNode(O),m.a.try((function(){return Object(v.r)(y,j)}))]).bind((function(e){var t=e[0],r=e[1];return f.toIfPredicateTerm(g===d.b.IFERROR?d.b.ISERROR:d.b.ISNA,t,r)}));case d.b._UDF:return Object(o.a)("calc.runtime.appNode: expected wff (not UDF)")}return m.a.all(b.map(this.lazyVisitFormulaNode)).bind((function(e){switch(g){case d.b.IF:return f.toIfTerm(e);case d.b.CHOOSE:return f.toChooseTerm(e)}var t=Object(d.e)(g);return Object(c.b)(Object(c.s)(g),t,!1,e)}))}return this.lazyVisitFormulaNode(t).bind((function(e){return m.a.all(b.map(f.lazyVisitFormulaNode)).bind((function(t){return f.toAppTerm(e,t)}))}))},e.prototype.toIfPredicateTerm=function(e,t,r){var n=Object(c.o)(0),a=Object(c.f)(Object(c.s)(d.b.IF),j,!1,Object(c.b)(Object(c.s)(e),Object(d.e)(e),!1,[n]),[r,n]);return Object(c.j)([t],!1,a)},e.prototype.toIfTerm=function(e){switch(e.length){case 3:return Object(c.f)(Object(c.s)(d.b.IF),j,!1,e[0],[e[1],e[2]]);case 2:return Object(c.f)(Object(c.s)(d.b.IF),j,!1,e[0],[e[1],b.i]);case 1:throw new O(Object(l.hb)(["single-argument IF"]));default:return Object(o.a)("calc.runtime.toIfTerm: expected wff")}},e.prototype.toChooseTerm=function(e){return Object(o.h)("calc.runtime.toChooseTerm: expected wff",e.length>=1),Object(c.f)(Object(c.s)(d.b.CHOOSE),y,!1,e[0],e.slice(1))},e.prototype.toAppTerm=function(e,t){return Object(c.b)(Object(c.s)(d.b._UDF),Object(d.f)(),!1,Object(a.__spreadArray)([e],t,!0))},e.prototype.letNode=function(e,t,r,n,a,i){var u=e.id===d.b.LETREC||e.id!==d.b.LET&&Object(o.a)("calc.runtime.compile");Object(o.h)("calc.runtime.letNode: expected wff",void 0!==r);var s=this.context,l=s.names,f=s.numNames,b=s.closures,h=this.bindNames(l,f,b,t,!1),p=h[t.length];return(u?m.a.all(t.map((function(e){var t=e.binder;return m.a.try((function(){return Object(v.r)(p,t.arg)}))}))):m.a.all(t.map((function(e,t){var r=e.binder,n=h[t];return m.a.try((function(){return Object(v.r)(n,r.arg)}))})))).bind((function(e){return Object(v.r)(p,r.arg).bind((function(t){return Object(c.j)(e,u,t)}))}))},e.prototype.lambdaNode=function(e,t,r,n,a,i){Object(o.h)("calc.runtime.lambdaNode: expected wff",void 0!==r);var u=this.context,s=u.names,l=u.numNames,d=u.closures,f=new C(d.getCount()+1),b=d.setValue(f.id,f),h=this.bindNames(s,l,b,t,!0),g=h[t.length],O=t.reduce((function(e,t,r){var n=t.name;return Object(p.b)(e,n.arg.isOptional?0:r+1)}),0),j=t.length;return m.a.all(t.map((function(e,t){var r=e.name;if(void 0===r.arg.def)return m.a.resolve(void 0);var n=h[t],a=r.arg.def.rhs;return m.a.try((function(){return Object(v.r)(n,a)}))}))).bind((function(e){return Object(v.r)(g,r.arg).bind((function(t){for(var r=f.slots.map((function(e){return l-e-1})),n=[],a=[],i=0;i<e.length;i+=1){var o=e[i];if(void 0!==o){var u=l+i,s=l+j;n.push(s-u-1),a.push(o)}}return a.push(t),Object(c.i)(j,O,f.id,r,n,a)}))}))},e.prototype.bindNames=function(t,r,n,i,c){var u=this,s=[new e(Object(a.__assign)(Object(a.__assign)({},this.context),{names:t,numNames:r,closures:n}))];return i.reduce((function(t,d,f){var b=d.name;Object(o.h)("calc.runtime.bindNames: expected wff",void 0!==b.arg.whole);var h=t.setValue(Object(l.h)(u.context.localeInfo,b.arg.whole),{closureId:n.getCount(),nameId:r+f});return s.push(new e(Object(a.__assign)(Object(a.__assign)({},u.context),{names:h,numNames:c?r+i.length:r+f+1,closures:n}))),h}),t),s},e.prototype.parenNode=function(e,t,r){return this.lazyVisitFormulaNode(e)},e.prototype.nameNode=function(e,t,r){var n,a=(null===(n=this.context.annotations[r])||void 0===n?void 0:n.kind)===s.a.AppHeadName;return m.a.resolve(this.toNameTerm(e,t,a))},e.prototype.toNameTerm=function(e,t,r){var n=this,a=this.context,i=a.locals,u=a.names,d=a.numNames,f=a.closures;if(!t){var b=Object(s.H)(e);if(b.kind===s.d.IdentNamePart){var h=b.parts,v=h[0],p=h.slice(1),O=u.getEntry(Object(l.h)(this.context.localeInfo,v.asWhole));if(void 0!==O){var j=O.value,y=j.closureId,S=j.nameId,C=void 0;if(y===f.getCount())C=Object(c.o)(d-S-1);else{var k=f.getValue(y+1);Object(o.h)("calc.runtime.toNameTerm: closure",void 0!==k),C=Object(c.n)(k.id,k.mapStackId(S))}return m.a.resolve(p.reduce((function(e,t){return n.toFieldRefTerm(e,t.rhs)}),C))}}}var E=function(e,r){var a=m.a.resolve(void 0);return r.kind===s.d.FieldRefNamePart&&(a=m.a.try((function(){return E(!1,r.lhs)})).bind((function(e){return void 0===e?void 0:n.toFieldRefTerm(e,r.rhs)}))),r.kind===s.d.CellRefNamePart&&(null==t&&i.allowUnqualifiedCell||null!=t&&t.kind!==s.g.Document)&&(a=m.a.resolve(Object(c.e)(r.ref,null!=t&&t.kind===s.g.Ident?Object(s.gb)(t.name):t))),r.canDenoteNamedObject&&(!e||t&&t.kind!==s.g.Document&&t.kind!==s.g.Ident||(a=a.bind((function(e){return Object(c.r)(r.asWhole,t,e)}))),a=a.bind((function(n){return Object(c.k)(r.asWhole,t,e?g.b.AppHead:g.b.Plain,n)}))),a};return E(r,e).bind((function(e){return void 0!==e?e:Object(o.a)("calc.runtime.compile: expected wff NameNode")}))},e.prototype.cellRefNode=function(e,t,r){return m.a.resolve(Object(c.e)(e,t))},e.prototype.fieldRefNode=function(e,t,r,n){var a=this;Object(o.h)("calc.runtime.compile: expected wff FieldRef",t.field.kind===s.e.Name);var i=t.field.whole;return this.lazyVisitFormulaNode(e).bind((function(e){return a.toFieldRefTerm(e,i)}))},e.prototype.toFieldRefTerm=function(e,t){var r=d.b.FIELDVALUE;return Object(c.b)(Object(c.s)(r),Object(d.e)(r),!1,[e,Object(b.u)(t)])},e.prototype.structRefNode=function(e,t,r){return m.a.resolve(Object(c.p)(Object(s.kb)(e,t,r)))},e.prototype.badSequenceNode=function(e,t,r){return Object(o.a)("calc.runtime.compile: unexpected bad node")},e.prototype.badStringNode=function(e,t,r){return Object(o.a)("calc.runtime.compile: unexpected bad node")},e.prototype.operatorNode=function(e,t){return m.a.resolve(Object(s.Y)(e,t))},e.prototype.wsfNode=function(e,t,r){return m.a.resolve(Object(s.mb)(e,t,r))},e}(),A=((n={})[d.a.At]=d.b.SINGLE,n[d.a.Pound]=d.b.ANCHORARRAY,n);var N=[function(e){if(!Object(c.g)(e)&&e.kind===c.a.App&&Object(c.h)(e.data.funName)){var t=A[Object(c.m)(e.data.funName)];if(void 0!==t)return Object(c.b)(Object(c.s)(t),Object(d.e)(t),e.data.isFormulaRoot,e.children)}return e}],T=function(e,t){return t(e)},R=function(e){return N.reduce(T,e)};function I(e,t){return"object"!=typeof t.term?Object(o.a)("".concat(e,": expected known compiled formula type; given ").concat(Object(i.a)(t))):t.term}function _(e,t,r){var n,i,o;try{var u=null!==(i=null===(n=t.config)||void 0===n?void 0:n.localeInfo)&&void 0!==i?i:e.config.localeInfo,s=f.a.create(u.stringCompareCI),l={globals:e,locals:t,localeInfo:u,annotations:r.annotations,names:s,numNames:0,closures:k},d=Object(v.n)(new E(l),r),b=(o=d,Object(c.q)(o,R));return Object(h.f)(function(e,t){return Object(a.__assign)(Object(a.__assign)({},e),{term:t})}(r,b))}catch(e){return e instanceof O?Object(h.c)(e.reason):Object(h.c)(Object(h.e)(e))}}function F(e){return{compileFormula:function(t,r){return _(e,t,r)}}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(20),a=(n.arrayMapTree.floorToPowerOf2,n.arrayMapTree.ArrayMapTree);n.arrayMapTree.RootPointer,n.arrayMapTree.enumerateInOrder,n.arrayMapTree.enumerateKeysInOrder},function(e,t,r){"use strict";r.d(t,"a",(function(){return k}));var n=r(43),a=r(7),i=r(5),o=r(8),c=r(10);function u(e){return{kind:o.b.Number,_valueXL:e}}var s=u(n.mathpack.zero()),l=u(n.mathpack.one()),d=u(n.mathpack.pi());function f(e){return 0!=(e.num&n.mathpack.MathErrorNum.DivBy0)?a.g:a.p}function b(e){return function(t){return Object(i.a)("calc.lang.".concat(e,": error ").concat(JSON.stringify(t)))}}function h(e,t,r){return function(n){var a=e(n._valueXL);return"number"==typeof a?t(a):r(a)}}function v(e,t,r){return function(n,a){var i=e(n._valueXL,a._valueXL);return"number"==typeof i?t(i):r(i)}}var p=v((function(e,t){return n.mathpack.equal(t,2)?n.mathpack.mul(e,e):n.mathpack.power(e,t)}),u,f),m=h((function(e){return n.mathpack.div(e,100)}),u,b("xlPercent"));var g=h(n.mathpack.ceil,u,b("xlCeil")),O=h(n.mathpack.floor,u,b("xlFloor")),j=h(n.mathpack.cond,c.d,b("xlCond, isSupported = ".concat(Object(n.isSupported)()))),y=v(n.mathpack.cond2,c.d,b("xlCond2"));var S=h(n.mathpack.sfix,c.d,b("xlSfix")),C=h(n.mathpack.viewRound,u,b("xlViewRound"));var k={zero:s,one:l,pi:d,add:v(n.mathpack.add,u,f),sub:v(n.mathpack.sub,u,f),mul:v(n.mathpack.mul,u,f),div:v(n.mathpack.div,u,f),power:p,percent:m,neg:function(e){return 0!==j(e)?u(n.mathpack.neg(e._valueXL)):e},compare:function(e,t){return n.mathpack.compare(e._valueXL,t._valueXL)},formatGeneral:function(e,t,r){var a=t._valueXL,o=n.mathpack.formatGeneral(e,a,r);return"string"!=typeof o?Object(i.a)("calc.lang.xlFormatGeneral: error ".concat(JSON.stringify(o))):o},formatFixed:function(e,t,r){var a=e._valueXL,o=n.mathpack.formatFixed(a,t,r);return"object"!=typeof o?Object(i.a)("calc.lang.xlFormatFixed: error ".concat(JSON.stringify(o))):o},formatScientific:function(e,t,r){var a=e._valueXL,o=n.mathpack.formatScientific(a,t,r);return"object"!=typeof o?Object(i.a)("calc.lang.xlFormatScientific: error ".concat(JSON.stringify(o))):o},parse:function(e,t,r,a){var o=n.mathpack.pack(e,t,r,a);return"number"!=typeof o?Object(i.a)("calc.lang.xlParse: error ".concat(JSON.stringify(o))):u(o)},trunc:function(e){return u(n.mathpack.trunc(e._valueXL))},ceil:g,floor:O,abs:function(e){return u(n.mathpack.abs(e._valueXL))},cond:j,cond2:y,fromNumber:function(e){return Object(i.h)("calc.lang.xlFromNumber",isFinite(e)),u(e)},toNumber:function(e){var t=e._valueXL;return Object(i.h)("calc.lang.xlToNumber",isFinite(t)),t},sqrt:h(n.mathpack.sqrt,u,f),exp:h(n.mathpack.exp,u,f),ln:h(n.mathpack.ln,u,f),log:h(n.mathpack.log,u,f),sin:h(n.mathpack.sin,u,f),cos:h(n.mathpack.cos,u,f),tan:h(n.mathpack.tan,u,f),asin:h(n.mathpack.asin,u,f),acos:h(n.mathpack.acos,u,f),atan:h(n.mathpack.atan,u,f),atan2:v(n.mathpack.atan2,u,f),round:v(n.mathpack.round,u,f),roundUp:v(n.mathpack.roundUp,u,f),roundDown:v(n.mathpack.roundDown,u,f),tenTo:function(e){Object(i.c)("calc.lang.xlTenTo",e);var t=n.mathpack.tenTo(e);return"number"==typeof t?u(t):f(t)},checkAlmostCancellation:function(e,t){var r=e._valueXL,a=t._valueXL;return n.mathpack.exp32(r)-n.mathpack.exp32(a)>=52428800?s:t},fix:function(e){return n.mathpack.fix(e._valueXL)},lfix:function(e){return n.mathpack.lfix(e._valueXL)},sfix:S,viewRound:C}},function(e,t,r){"use strict";r.d(t,"b",(function(){return u})),r.d(t,"a",(function(){return s}));var n=r(40),a=r(0),i=r(73),o=r(16),c={type:i.a.None,color:{argb:"00000000"}},u={font:{name:"Calibri",bold:!1,italic:!1,underline:i.c.None,strikethrough:!1,verticalAlign:i.d.None,size:11,color:{argb:"ff000000"}},fill:{kind:i.b.Pattern,pattern:i.f.None,fgColor:{argb:"00000000"},bgColor:{argb:"00000000"}},border:{top:c,bottom:c,left:c,right:c},alignment:{horizontal:i.e.Automatic,vertical:i.g.Bottom,textRotation:0,wrapText:!1,indent:0,relativeIndent:0,shrinkToFit:!1,readingOrder:0}},s=function(){function e(){this.styles=[],this.fonts=[],this.fills=[],this.borders=[]}return e.prototype.clone=function(){function t(e,t){Object.keys(e).map(Number).forEach((function(r){t[r]=e[r]}))}var r=new e;return t(this.styles,r.styles),t(this.fonts,r.fonts),t(this.fills,r.fills),t(this.borders,r.borders),r},e.prototype.resolveCellStyle=function(e){if(e===o.g.Blank)return Object(a.f)(u);var t=this.styles[e];if(void 0===t)return Object(a.c)({kind:n.d.StyleId,styleId:e});var r=t.fontId,i=t.fillId,c=t.borderId,s=t.alignment,l=void 0!==r?this.fonts[r]:u.font;if(void 0===l)return Object(a.c)({kind:n.d.FontId,fontId:r});var d=void 0!==i?this.fills[i]:u.fill;if(void 0===d)return Object(a.c)({kind:n.d.FillId,fillId:i});var f=void 0!==c?this.borders[c]:u.border;return void 0===f?Object(a.c)({kind:n.d.BorderId,borderId:c}):Object(a.f)({font:l,fill:d,border:f,alignment:s})},e.prototype.setStyles=function(e,t){var r=this;t||(this.styles=[]),Object.keys(e).map(Number).forEach((function(t){r.styles[t]=e[t]}))},e.prototype.setFonts=function(e,t){var r=this;t||(this.fonts=[]),Object.keys(e).map(Number).forEach((function(t){r.fonts[t]=e[t]}))},e.prototype.setFills=function(e,t){var r=this;t||(this.fills=[]),Object.keys(e).map(Number).forEach((function(t){r.fills[t]=e[t]}))},e.prototype.setBorders=function(e,t){var r=this;t||(this.borders=[]),Object.keys(e).map(Number).forEach((function(t){r.borders[t]=e[t]}))},e}()},function(e,t,r){"use strict";r.d(t,"b",(function(){return s})),r.d(t,"a",(function(){return l}));var n=r(9),a=r(1),i=r(45),o=r(52),c=r(5),u=r(25),s=new i.a((function(){try{for(var e=new Map,t=0,r=Object.keys(a.b);t<r.length;t++){var n=r[t],i=Number(n);isNaN(Number(i))||e.set(i,FormulaAuthoringStrings[a.b[i]+"ShortDescription"])}return{descriptionsMap:e}}catch(e){return c.i.ULS.traceTag(538792415,u.LogCategory.msoulscat_ES_EWAJS,u.TraceLevel.Info,"failed to get functionShortDescriptionsMap with exception ".concat(e)),{}}})),l=Object(i.b)((function(){return Object(n.__awaiter)(void 0,void 0,void 0,(function(){return Object(n.__generator)(this,(function(e){switch(e.label){case 0:return[4,o.a.getValue()];case 1:return[4,e.sent().loadPluginScript("formula-authoring-strings",!0)];case 2:return e.sent(),[2]}}))}))}))},function(e,t,r){"use strict";r.d(t,"b",(function(){return i})),r.d(t,"a",(function(){return o}));var n=r(25),a={ULS:new n.NulLogger},i=Object(n.initStopwatchFactory)((function(e){return a.ULS.traceTag(595948114,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,e)}));function o(e){a.ULS=e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertPositiveLength=t.assertIndex=t.assertPositiveInteger=t.assertNatural=t.assertInteger=t.assertTrue=t.assertFalse=t.assertNever=t.ulsLogger=void 0;var n=r(25),a=r(133),i=r(124);function o(e,t){return function(r,n,a,i){if(e(r,n,a,i),!a)throw new Error("".concat(t," ").concat(r," ").concat(n," ").concat(i))}}function c(e){return{shipAssertTag:o(e.shipAssertTag.bind(e),"shipAssertTag"),assertTag:o(e.assertTag.bind(e),"assertTag"),traceTag:e.traceTag.bind(e),debugTraceTag:e.debugTraceTag.bind(e),dnmTraceTag:e.dnmTraceTag.bind(e)}}function u(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];try{return e.apply(void 0,t)}catch(e){}}}var s=function(){function e(){this.callBufferCapacity=100,this.callBuffer=[],this.shipAssertTag=this.createBufferingCallback("shipAssertTag"),this.assertTag=this.createBufferingCallback("assertTag"),this.traceTag=this.createBufferingCallback("traceTag"),this.dnmTraceTag=this.createBufferingCallback("dnmTraceTag"),this.debugTraceTag=this.createBufferingCallback("debugTraceTag")}return e.prototype.createBufferingCallback=function(e){var t=this;return function(){for(var r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];t.callBuffer.length<t.callBufferCapacity&&t.callBuffer.push({method:e,args:r})}},e.prototype.invokeBufferedCalls=function(){var e;if(0!==this.callBuffer.length){var r=this.callBuffer;this.callBuffer=[];var a="calc.common.DefaultLogger.invokeBufferedCalls: ".concat(r.length," calls before initLogger");t.ulsLogger.ULS.traceTag(579736781,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Warning,a);for(var i=0,o=r;i<o.length;i++){var c=o[i];(e=t.ulsLogger.noThrowLogger)[c.method].apply(e,c.args)}}},e}(),l=function(){function e(){this.logger=new s,this.ULS=c(this.logger),this.noThrowLogger=this.logger}return e.prototype.setLogger=function(e){var t=this.logger;this.logger=e,this.ULS=c(e),this.noThrowLogger=function(e){return{shipAssertTag:u(e.shipAssertTag.bind(e)),assertTag:u(e.assertTag.bind(e)),traceTag:u(e.traceTag.bind(e)),debugTraceTag:u(e.debugTraceTag.bind(e)),dnmTraceTag:u(e.dnmTraceTag.bind(e))}}(e),t instanceof s&&t.invokeBufferedCalls()},e}();function d(e){return t.ulsLogger.ULS.assertTag(595980873,n.LogCategory.msoulscat_ES_EWAJS,!1,e)}t.ulsLogger=new l,t.assertNever=function(e,r){var a=(0,i.anonymize)(r),o="".concat(e,": code should be unreachable because a value has type 'never'; given ").concat(a);return t.ulsLogger.ULS.assertTag(595980872,n.LogCategory.msoulscat_ES_EWAJS,!1,o)},t.assertFalse=d,t.assertTrue=function(e,t){t||d("".concat(e,": expected condition to be true"))},t.assertInteger=function(e,t){(0,a.isInteger)(t)||d("".concat(e,": expected integer; given ").concat((0,i.anonymize)(t)))},t.assertNatural=function(e,t){(!(0,a.isInteger)(t)||t<0)&&d("".concat(e,": expected natural number; given ").concat((0,i.anonymize)(t)))},t.assertPositiveInteger=function(e,t){(!(0,a.isInteger)(t)||t<=0)&&d("".concat(e,": expected positive integer; given ").concat((0,i.anonymize)(t)))},t.assertIndex=function(e,t,r){(!(0,a.isInteger)(t)||t<0||t>=r)&&d("".concat(e,": expected natural number less than ").concat((0,i.anonymize)(r),"; given ").concat((0,i.anonymize)(t)))},t.assertPositiveLength=function(e,t,r){(!(0,a.isInteger)(t)||t<=0||t>r)&&d("".concat(e,": expected positive integer at most ").concat((0,i.anonymize)(r),"; given ").concat((0,i.anonymize)(t)))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.entry=t.makeEmptyTable=void 0;var n={getCount:function(){return 0},getValue:function(){},getEntry:function(){},contains:function(){return!1},forEach:function(){return!0}};t.makeEmptyTable=function(){return n},t.entry=function(e,t){return{key:e,value:t}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return v}));var n=r(9),a=r(10),i=r(0),o=r(12),c=r(3),u=r(69),s=r(26),l=r(24),d=r(2),f=r(16),b=r(51),h=r(55);Object(a.u)(),Object(a.u)(),Object(a.u)(),Object(a.u)();var v=function(){function e(e){this.calcGrid=e,this.snapshotPromises=[]}return e.prototype.createIGridExportEndpoint=function(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){var t=this;return Object(n.__generator)(this,(function(r){switch(r.label){case 0:return[4,h.Endpoint.createInside(e,(function(){return t}))];case 1:return r.sent(),[2]}}))}))},e.prototype.discardSnapshot=function(e){return void 0!==this.snapshotPromises[e]&&(delete this.snapshotPromises[e],!0)},e.prototype.getSheetNames=function(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){var t,r,a,u,s,l,d;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.getOrCreateSnapshot(e)];case 1:if(void 0===(t=n.sent()))return[2,Object(i.c)(Object(c.kb)(["getSheetNames"]))];if(r={document:this.calcGrid.document,sheets:new Array},a=t.getSheetRangeIndexes(Object(o.c)(this.calcGrid.document)),!Object(i.d)(a))return[2,a];for(u=0,s=a.value.sheets;u<s.length;u++){if(l=s[u],d=t.getSheetName(this.calcGrid.document,l),!Object(i.d)(d))return[2,d];r.sheets.push({sheetIndex:Object(o.s)(this.calcGrid.document,l),sheetName:d.value})}return[2,Object(i.f)(r)]}}))}))},e.prototype.getOrCreateSnapshot=function(e){return Object(n.__awaiter)(this,void 0,void 0,(function(){return Object(n.__generator)(this,(function(t){return void 0===this.snapshotPromises[e]&&(this.snapshotPromises[e]=this.calcGrid.dataModel.createSnapshot(),this.calcGrid.resumeRecalc().catch((function(e){setTimeout((function(){throw e}))}))),[2,this.snapshotPromises[e]]}))}))},e.prototype.getRangeFormats=function(e,t){return this.getRangeData(e,t,"formats")},e.prototype.getRangeValues=function(e,t){return this.getRangeData(e,t,"values")},e.prototype.getRangeFormulae=function(e,t){return this.getRangeData(e,t,"formulae")},e.prototype.getRangeData=function(e,t,r){return Object(n.__awaiter)(this,void 0,void 0,(function(){var a,d,h,v,p,m,g;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.getOrCreateSnapshot(e)];case 1:return void 0===(a=n.sent())?[2,Object(i.c)(Object(c.kb)(["getRangeData/getOrCreateSnapshot"]))]:(d=a.allEditedAvailable(t)).kind!==i.b.Success?[2,Object(i.c)(Object(c.kb)(["getRangeData/allEditedAvailable"]))]:(h=Object(s.f)(t.range),!0!==d.value&&(h=Object(l.d)(h,d.value)),v=function(e){var r=[];return Object(s.i)(h,(function(n){var a=e(Object(o.r)(t.sheet,n),(function(e){h=Object(l.d)(h,Object(s.f)(e))}),(function(e,t){r.push([[e.row,e.col],t])}));return a.kind===i.b.Success&&a.value}))?Object(i.f)(r):Object(i.c)(Object(c.kb)(["getRangeData/extractData"]))},p={formulae:function(){return v((function(e,t,r){return a.forEachEditedFormula(e,(function(e,n){var a=n.lexicalKind,i=n.compiledFmla,s=n.fmla,l=n.origin;return a!==o.a.Range&&Object(c.F)(e)?Object(b.l)(s,void 0!==i)||r(e,{kind:void 0!==i?u.a.CellFormula:u.a.Value,formulaBarText:s,origin:Object(c.G)(l,e)?void 0:l}):t(e),!0}))}))},formats:function(){return v((function(e,t,r){return a.forEachEditedFormat(e,(function(e,n){return n===f.f.Unavailable?t(e):Object(b.k)(n)||r(e,"number"==typeof n?n:n.formatString),!0}))}))},values:function(){return v((function(e,t,r){return a.forEachEditedValue(e,(function(e,n){return void 0!==n.failure?t(e):Object(b.m)(n.oper,n.failure)||r(e,n.oper),!0}))}))}}[r](),(m=p).kind!==i.b.Success?[2,m]:(g=[],Object(s.i)(h,(function(e){return g.push(e),!0})),[2,Object(i.f)({nonEmptyCells:m.value,availableRanges:g})]))}}))}))},e.prototype.getIntersectingTables=function(e,t){var r;return Object(n.__awaiter)(this,void 0,void 0,(function(){var a,u,f,b,h,v,p,m,g,O,j,y;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.getOrCreateSnapshot(e)];case 1:if(void 0===(a=n.sent()))return[2,Object(i.c)(Object(c.kb)(["getIntersectingTables/getOrCreateSnapshot"]))];if((u=a.allServerAvailable(t)).kind!==i.b.Success)return[2,Object(i.c)(Object(c.kb)(["getIntersectingTables/allServerAvailable"]))];if(f=a.getIntersectingTables(t),!Object(i.d)(f))return[2,Object(i.c)(Object(c.kb)(["getIntersectingTables/getIntersectingTables"]))];for(b=[],h=function(e){var t=a.getNamedObject(e,o.b.Plain);if(t.kind!==i.b.Success)return{value:t};if("NamedTable"!==(null===(r=t.value)||void 0===r?void 0:r.kind))return"continue";var n=[];t.value.columnIndexes.forEach((function(e,t){return n.push({column:e,name:t}),!0})),b.push({name:e.name,dataRange:t.value.specialRefRanges[d.i.Data].range,hasHeadersRow:t.value.hasHeadersRow,hasTotalsRow:t.value.hasTotalsRow,columns:n})},v=0,p=f.value;v<p.length;v++)if(m=p[v],"object"==typeof(g=h(m)))return[2,g.value];return O=Object(s.f)(t.range),j=!0===u.value?O:Object(l.d)(O,u.value),y=[],Object(s.i)(j,(function(e){return y.push(e),!0})),[2,Object(i.f)({tables:b,availableRanges:y})]}}))}))},e.prototype.getIformats=function(e,t,r,a){return Object(n.__awaiter)(this,void 0,void 0,(function(){var o,u;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.getOrCreateSnapshot(e)];case 1:return void 0===(o=n.sent())?[2,Object(i.c)(Object(c.kb)(["getIformats/getOrCreateSnapshot"]))]:(u=o.getIformats(t,r,a),Object(i.d)(u)?[2,Object(i.f)({availableFormats:u.value})]:[2,Object(i.c)(Object(c.kb)(["getIformats/getIntersectingTables"]))])}}))}))},e.prototype.getHiddenRows=function(e,t,r,a){return Object(n.__awaiter)(this,void 0,void 0,(function(){var i;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.getOrCreateSnapshot(e)];case 1:return void 0===(i=n.sent())?[2,b.j]:[2,i.getHiddenRows(t,r,a)]}}))}))},e.prototype.getHiddenCols=function(e,t,r,a){return Object(n.__awaiter)(this,void 0,void 0,(function(){var i;return Object(n.__generator)(this,(function(n){switch(n.label){case 0:return[4,this.getOrCreateSnapshot(e)];case 1:return void 0===(i=n.sent())?[2,b.j]:[2,i.getHiddenCols(t,r,a)]}}))}))},e}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.stackSave=t.stackRestore=t.stackAlloc=t.setThrew=t.memory=t._start=t.__growWasmMemory=t.__errno_location=t.Mathpack_Zero=t.Mathpack_ViewRound=t.Mathpack_Trunc=t.Mathpack_TenTo=t.Mathpack_Tan=t.Mathpack_TakeMathError=t.Mathpack_Sub=t.Mathpack_Sqrt=t.Mathpack_Sin=t.Mathpack_SFloat=t.Mathpack_SFix=t.Mathpack_RoundUp=t.Mathpack_RoundDown=t.Mathpack_Round=t.Mathpack_Power=t.Mathpack_Pi=t.Mathpack_Pack=t.Mathpack_One=t.Mathpack_Neg=t.Mathpack_Mul=t.Mathpack_Log=t.Mathpack_Ln=t.Mathpack_LFix=t.Mathpack_GetExp32=t.Mathpack_FormatScientific=t.Mathpack_FormatGetSign=t.Mathpack_FormatGetExponent=t.Mathpack_FormatGeneral=t.Mathpack_FormatFixed=t.Mathpack_Floor=t.Mathpack_Float=t.Mathpack_Fix=t.Mathpack_Exp=t.Mathpack_Equal=t.Mathpack_Div=t.Mathpack_Cos=t.Mathpack_Cond2=t.Mathpack_Cond=t.Mathpack_Compare=t.Mathpack_Ceil=t.Mathpack_Atan2=t.Mathpack_Atan=t.Mathpack_Asin=t.Mathpack_Add=t.Mathpack_Acos=t.Mathpack_Abs=t.Dtr_Yr=t.Dtr_Write=t.Dtr_Wdy=t.Dtr_UtcToLocal=t.Dtr_ToTime=t.Dtr_ToNumWithDuration=t.Dtr_ToNum=t.Dtr_ToDays=t.Dtr_Sec=t.Dtr_Rounding=t.Dtr_Mon=t.Dtr_Min=t.Dtr_Hour=t.Dtr_FromNum=t.Dtr_FracSec=t.Dtr_DaysPerMonth=t.Dtr_Days=t.Dtr_DOM=t.Base_StrBufSize=t.Base_StrBuf=void 0;var n=r(184),a=r(185),i=r(186),o=new ArrayBuffer(8),c=new Int32Array(o),u=(new Float32Array(o),new Float64Array(o));function s(e){return c[e]}function l(e,t){c[e]=t}function d(){return u[0]}function f(e){u[0]=e}var b,h=new ArrayBuffer(65536),v=(b=new Uint8Array(h),function(e,t){var r,n;if("undefined"==typeof Buffer)for(r=atob(t),n=0;n<r.length;n++)b[e+n]=r.charCodeAt(n);else for(r=Buffer.from(t,"base64"),n=0;n<r.length;n++)b[e+n]=r[n]});v(1024,"GAwAAAEAAAACAAAAAwAAAAAAAAAE"),v(1056,"6AsAAPALAAD4CwAAAAwAAB8dHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8cHx4fHh8fHh8eHx8dHx4fHh8fHh8eHw=="),v(1152,"sAsAAMgLAADACwAA0As="),v(1199,"AQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQECAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHCAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsAAAAAHwA8AFsAeQCYALYA1QD0ABIBMQFPAW4B"),v(1599,"AQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBAQEBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgYGBgcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcHBwcICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCQkJCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwsLCwAAAAAAHwA7AFoAeACXALUA1ADzABEBMAFOAW0B"),v(1975,"oAQ="),v(1991,"yAc="),v(2007,"+go="),v(2022,"QJwO"),v(2038,"UMMR"),v(2054,"JPQU"),v(2069,"gJaYGA=="),v(2085,"ILy+Gw=="),v(2101,"KGvuHg=="),v(2117,"+QKVIg=="),v(2132,"QLdDuiU="),v(2148,"EKXU6Cg="),v(2164,"KueEkSw="),v(2179,"gPQg5rUv"),v(2195,"oDGpX+My"),v(2211,"BL/JG442AAAAAAAAAJ61cCuorcWdawAAAAAAAADXlUMOBY0pr6AAAAAAAAAA1abP/0kfeMLVAAAAAAAAAPz32oePeufXCgEAAAAAAACjFJvFFquz7z8BAAAAAAAAnjIjmcCtD4V1AQAAAAAAAOCM6YDJR7qTqgEAAAAAAADnptOoxbkCpN8BAAAAAAAAqhfmfyuhFrYUAgAAAAAAAJO/m4WRoijKSQIAAAAAAABrVSc5jfdw4H4CAAAAAAAARmGCNzUMLvmzAgAAAAAAADDJPOP/llKK6QIAAAAAAABmF7/W86aRmR4DAAAAAAAAjt75nfvrfqpTAwAAAAAAAM3MzMzMzMzM/f///wAAAAAK16NwPQrXo/r///8AAAAAO99PjZduEoP3////AAAAACxlGeJYF7fR8////wAAAAAjhEcbR6zFp/D///8AAAAAtmlsrwW9N4bt////AAAAALxCeuXVlL/W6f///wAAAAD9zmGEEXfMq+b///8AAAAAl6W0NkFfcInj////AAAAAL/V7b3O/ubb3////wAAAAD/qiTLC//rr9z///8AAAAAzIhQbwnMvIzZ////AAAAABMOtEtCEy7h1f///wAAAAAP2FwJNdwktNL///8AAAAA2aywOvd8HZDP////AAAAAFvhTcS+lJXmy////wAAAAC6lDlFrR6xz5b///8AAAAAWcF+sVN8Erth////AAAAAKXpOaUn6n+oLP///wAAAACmGQlrumDFl/f+//8AAAAAm1N1/fcCtIjC/v//AAAAAH3TZfC8NUP2jP7//wAAAACh5LxkfEbQ3Vf+//8AAAAAyYJTfG66ysci/v//AAAAAJOgc9uT4PSz7f3//wAAAAAwAMs42ycXorj9//8AAAAABswjVHeD/5GD/f//AAAAAGC8pD2p3oCDTv3//wAAAAC+TjFK7Dzl7Bj9//8AAAAA1+Eyz81fYNXj/P//AAAAADoZemMlQzHArvz//wAAAAAYLURU+yEJQAAAAAAAAOA/AAAAAAAAAEAYLURU+yH5PwAAAAAAAPA/"),v(3014,"WUAAAAAAAAAkQAAAAAAAQI9AAAAAAAAAOEAAAAAAAABOQClRzqDIRdg+IXQL5wZroz41IN+kpBFvPvZNfx3q2jg+AADA////30EAAAAAAADgwQQEAAAQBA=="),v(3728,"ME8=");var p=function(e,t,r){var n=new e.Int8Array(r),a=new e.Int16Array(r),i=new e.Int32Array(r),o=new e.Uint8Array(r),u=new e.Uint16Array(r),b=new e.Uint32Array(r),h=(new e.Float32Array(r),new e.Float64Array(r)),v=e.Math.imul,p=(e.Math.fround,e.Math.abs),m=e.Math.clz32,g=e.Math.min,O=(e.Math.max,e.Math.floor),j=e.Math.ceil,y=e.Math.sqrt,S=t.abort,C=(e.NaN,e.Infinity,t.Base_LocaleIsNumeral),k=t.Base_LocaleGetOrdinal,E=t.Base_LocaleDecimalSeparator,A=t.Math_log10,N=t.Math_log,T=(y=t.Math_sqrt,t.Math_sin),R=t.Math_cos,I=t.Math_tan,_=t.Math_atan,F=t.Math_exp,w=t.proc_exit,M=20112,D=0;function P(){}function x(e,t,r){e:if(e>>>0<=t>>>0){if(!r)break e;for(;n[0|e]=o[0|t],e=e+1|0,t=t+1|0,r=r+-1|0;);}else if(r)for(e=e+r|0,t=t+r|0;t=t+-1|0,n[0|(e=e+-1|0)]=o[0|t],r=r+-1|0;);}function L(e,t){var r,c,l=0,d=0,b=0,v=0;if(d=3680,M=r=M-48|0,i[r+40>>2]=0,a[r+30>>1]=0,a[r+32>>1]=0,h[460]=e,c=q(e),h[460]=c,Oe(c,r+40|0,r,15),u[r+42>>1]){l=(0|(l=de(t)<<16))<0?100:l>>16,f(+t),b=0|s(1),s(0),(v=-65536&b)&&(2146435072!=(2146435072&b)?l=(0|v)<1?0-l|0:l:i[922]=1);e:{if(!((0|(l=a[r+40>>1]+l|0))>=a[r+42>>1])){if((0|l)<1){d=3e3;break e}(255&l)>>>0>=o[r+30|0]||(n[r+30|0]=l)}ge(3100,3680,r)}e=h[d>>3]}return M=r+48|0,e}function B(e,t){var r,n=0,a=0,o=0;if(h[460]=e,f(+e),a=0|s(1),s(0),o=a,a=0,(n=-65536&o)&&(2146435072!=(2146435072&o)?a=(0|n)<1:(i[922]=1,a=0)),i[921]=2147483647&o,te(h[374]),n=-65536&(o=i[921]))if(2146435072!=(2146435072&o)){if(!((0|n)<1))return K(8),0}else i[922]=1;r=re(h[374],e),h[460]=re(h[372],r),ne(r),he();e:{t:{if((n=i[921])>>>0>=65536){if(2146435072!=(2146435072&n))break t;i[922]=1}if(t){if(i[920]=0,i[921]=0,!a)break e;return t=i[741],i[920]=i[740],i[921]=t,h[460]}if(n=i[747],i[920]=i[746],i[921]=n,t=n,1^a|n>>>0<65536)break e;return i[921]=-2147483648^t,h[460]}Se(e),ve(),t&&(h[460]=re(h[373],h[460]))}return h[460]}function U(e,t,r,n){var c,s=0,l=0,d=0,f=0,b=0,h=0,p=0;if(s=i[e+4>>2],b=-2146827284,!((0|(c=(l=u[e>>1])+(e=(0|(d=a[e+2>>1]))>=1?(d+-1|0)/12|0:(0|d)/-12^-1)<<16>>16))>9999|((r?1900:-9999)+(t?4:0)|0)>(0|c)||((d=d+v(e,-12)<<16>>16)+-1&65535)>>>0>11|(!s|1900==(0|c)&2==(0|d)&29==(0|s)?!r:0))){if(h=(0|(e=(f=(0|(l=c+1e4|0))/4|0)<<2))%100|0,p=(0|e)%400|0,s=(((f=v(f,1461)+s|0)+((0|(s=e+-1|0))/-100|0)|0)+((0|s)/400|0)|0)-1|0,l=(v(l-e|0,12)+d|0)-1|0)for(l=l+(e=p?h?0:12:0)|0;s=o[e+1072|0]+s|0,(0|l)!=(0|(e=e+1|0)););e:if(r||t){if(e=s+-4346385|0,!((0|c)>1900|(0|d)>=3))break e;e=s+-4346384|0}else e=s+-4346384|0;e>>>0>2958465||(i[n>>2]=e,b=0)}return b}function G(e,t,r){var n,c,u,s=0,l=0,d=0;l=d=Ne(e,t,711573504,201),i[r+28>>2]=(l+1>>>0)%7,s=l+v(n=(l>>>0)/146097|0,-146097)|0,c=(v(s,100)+75>>>0)/3652425|0,s=((u=v(c,-36524)+s|0)>>>0)/1461|0,l=(((l+(((s=((v(c,100)+v(n,400)|0)+(s<<2)|0)+((v(u+v(s,-1461)|0,100)+75>>>0)/36525|0)|0)>>>0)/100|0)|0)-(s>>>2)|0)-((s>>>0)/400|0)|0)+v(s,-365)|0,d=Ae(d,D,-864e5,-1),e=Ne(e,t,1e4,0)+d|0,d=!(((t=s+1|0)>>>0)%100)|3&t&&(t>>>0)%400|0?1936+((t=o[l+1568|0])<<1)|0:1536+((t=o[l+1168|0])<<1)|0,i[r+12>>2]=(e>>>0)/36e5,i[r+4>>2]=t+1,i[r>>2]=s+1601,t=(e>>>0)/1e3|0,i[r+20>>2]=(t>>>0)%60,i[r+16>>2]=((e>>>0)/6e4>>>0)%60,i[r+24>>2]=e-v(t,1e3),i[r+8>>2]=1+(l-a[d>>1]|0)}function V(e,t){var r=0,n=0,o=0,c=0,u=0,s=0,l=0,d=0,f=0,b=0,h=0,p=0;return(0|(c=i[e+4>>2]))<1||(d=c+-1|0)>>>0>11||(n=(r=i[e>>2])+-1601|0)>>>0>29226||(0|(u=i[e+8>>2]))<1||(o=1536,((s=65535&r)>>>0)%400&&(o=3&r?1936:(s>>>0)%100|0?1536:1936),(f=i[e+24>>2])>>>0>999||(s=i[e+20>>2])>>>0>59||(b=i[e+16>>2])>>>0>59||(h=i[e+12>>2])>>>0>23||(u=u+-1|0)>>>0>=a[o+(c<<1)>>1]-a[o+(d<<1)>>1]>>>0||(o=n>>>2,c=v(n,365),n=((e=65535&n)>>>0)/400|0,p=(e>>>0)/100|0,((l=65535&(r=r+-1600|0))>>>0)%400&&(e=1936,!((l>>>0)%100)|3&r)||(e=1536),l=1,r=(r=v(v(v(h,60)+b|0,60)+s|0,1e3)+f|0)+(n=Ae(e=a[(d<<1)+e>>1]+(n+((u+(c+o|0)|0)-p|0)|0)|0,e>>31,864e5,0))|0,e=D,i[t>>2]=Ae(r,r>>>0<n>>>0?e+1|0:e,1e4,0),i[t+4>>2]=D)),l}function H(e,t,r,n){var a,o=0,c=0,u=0,s=0;M=a=M-112|0,G(r,n,a+80|0);e:{if(i[e>>2]){if(!V(e,t))break e}else{if((0|(c=i[e+8>>2]))>5|!c)break e;if(r=i[e+4>>2],n=i[e+28>>2],o=i[a+80>>2],i[a+56>>2]=1,i[a+52>>2]=r,i[a+48>>2]=o,i[a+60>>2]=i[e+12>>2],i[a+64>>2]=i[e+16>>2],i[a+68>>2]=i[e+20>>2],e=i[e+24>>2],i[a+76>>2]=0,i[a+72>>2]=e,!V(a+48|0,a+8|0)){o=0;break e}e=n+8|0,r=n+1|0,u=(0|c)<2,G(i[a+8>>2],i[a+12>>2],a+16|0),s=a;t:{if((0|n)<(0|(o=i[a+44>>2])))e=e-o|0;else{if(e=1,(0|n)<=(0|o))break t;e=r-o|0}i[s+56>>2]=e}t:if(!u&&(r=e+7|0,i[a+56>>2]=r,o=1,V(a+48|0,a+8|0)))for(;;){if(G(i[a+8>>2],i[a+12>>2],a+16|0),e=i[a+24>>2],(0|c)==(0|(o=o+1|0)))break t;if(r=r+7|0,i[a+56>>2]=r,!V(a+48|0,a+8|0))break}if(i[a+56>>2]=e,!V(a+48|0,a+8|0)){o=0;break e}e=i[a+12>>2],i[t>>2]=i[a+8>>2],i[t+4>>2]=e}o=1}return M=a+112|0,o}function W(e,t,r){var n,o=0,c=0,s=0,l=0,d=0;if(M=n=M-16|0,r&&(s=r>>31,s^=s+r))for(r=(0|r)>0?1952:2448;(o=15&s)&&(c=a[(o=(o<<4)+r|0)+8>>1],d=z(h[e>>3],h[o>>3],n),t=t+c|0,a[n+14>>1]<=0?(o=u[n+6>>1],c=u[n+8>>1]):(c=i[n+4>>2],o=u[n+6>>1]<<1,a[n+6>>1]=o,l=i[n+8>>2],i[n+12>>2]=i[n+12>>2]<<1|l>>>31,c=l<<1|c>>>31,i[n+8>>2]=c,t=t+-1|0),(65535&o|1&c|0!=(0|d))>>>0<32769||(c=(o=i[n+8>>2])+1|0,i[n+8>>2]=c,c>>>0>=o>>>0||(c=(o=i[n+12>>2])+1|0,i[n+12>>2]=c,c>>>0>=o>>>0||(i[n+12>>2]=-2147483648,t=t+1|0))),o=i[n+12>>2],i[e>>2]=i[n+8>>2],i[e+4>>2]=o),r=r+240|0,s>>=4;);return M=n+16|0,t}function z(e,t,r){var n,i,o,c=0,u=0,l=0,d=0,b=0,h=0,p=0,m=0,g=0,O=0,j=0,y=0;return f(+t),d=0|s(1),b=65535&(u=0|s(0)),f(+e),O=0|s(1),c=0|s(0),l=O,i=v(m=65535&c,b),a[r>>1]=i,o=((65535&(j=v(g=c>>>16,b)))+(i>>>16)|0)+(65535&(p=v(u>>>=16,m)))|0,a[r+2>>1]=o,j=(((h=((65535&(c=v(n=65535&l,b)))+(j>>>16)|0)+(p>>>16)|0)+(65535&(p=v(u,g)))|0)+(65535&(y=v(O=65535&d,m)))|0)+(o>>>16)|0,a[r+4>>1]=j,p=(((((((65535&(h=v(d>>>=16,m)))+(c>>>16)|0)+(65535&(l=v(c=l>>>16,b)))|0)+(p>>>16)|0)+(y>>>16)|0)+(65535&(b=v(O,g)))|0)+(65535&(m=v(u,n)))|0)+(j>>>16)|0,a[r+6>>1]=p,g=((((((y=(l>>>16)+(h>>>16)|0)+(65535&(l=v(d,g)))|0)+(b>>>16)|0)+(m>>>16)|0)+(65535&(h=v(c,u)))|0)+(65535&(u=v(O,n)))|0)+(p>>>16)|0,a[r+8>>1]=g,h=((u=(((65535&(b=v(d,n)))+(l>>>16)|0)+(h>>>16)|0)+(u>>>16)|0)+(65535&(l=v(c,O)))|0)+(g>>>16)|0,a[r+10>>1]=h,c=(((65535&(d=v(c,d)))+(b>>>16)|0)+(l>>>16)|0)+(h>>>16)|0,a[r+12>>1]=c,a[r+14>>1]=(c>>>16)+(d>>>16),65535&(i|o|j)}function q(e){var t,r,n=0,a=0,o=0,c=0,u=0,l=0;return M=t=M-16|0,h[t+8>>3]=e,f(+e),n=0|s(1),a=0|s(0),r=n,(n&=2146435072)&&(i[t+8>>2]=a<<11,i[t+12>>2]=r<<11|a>>>21|-2147483648,c=(n=v(a=(n>>>20)-1022|0,39457)>>17)+-14|0,o=W(t+8|0,a,14-n|0),a=i[t+8>>2],(0|o)>=(0|(b[t+12>>2]<(a>>>0<2147477094?-1243209483:-1243209484)>>>0?48:47))||(o=W(t+8|0,o,1),a=i[t+8>>2],c=n+-15|0),n=c,c=(c=a)+(a=-2147483648>>>(31&o))|0,i[t+8>>2]=c,c>>>0>=a>>>0||(l=(u=i[t+12>>2])+1|0,i[t+12>>2]=l,l>>>0>=u>>>0||(i[t+12>>2]=-2147483648,o=o+1|0)),i[t+8>>2]=c&0-(a<<1),o=W(t+8|0,o,n),3071&(n=i[t+8>>2])?(a=n+1024|0,i[t+8>>2]=a,n>>>0<4294966272||(c=(n=i[t+12>>2])+1|0,i[t+12>>2]=c,o=(c>>>0<n>>>0)+o|0)):a=n,(0|o)<=-1023?(i[t+8>>2]=0,i[t+12>>2]=0):(0|(n=1071644672+(o<<20)|0))<=-1||(o=i[t+12>>2],i[t+8>>2]=o<<21|a>>>11,i[t+12>>2]=o>>>11&1048575|n|-2147483648&r),e=h[t+8>>3]),M=t+16|0,e}function K(e){var t;return t=i[922],i[922]=e,t}function Y(){var e,t,r;return e=i[920],t=i[921],$(1048576),$(2146435072),a[1843]<0?(i[920]=e,i[921]=t,-2147483648):(r=le(),i[920]=e,i[921]=t,-2147483648^r)}function J(e){var t,r=0,n=0,a=0,i=0;if(f(+e),r=0|s(1),t=0|s(0),i=r,a=0,!((r=2047&(n=r>>>20))>>>0<1023||(a=e,r>>>0>1075))){if(n=-1<<(19-n&31),r>>>0>=1044)return l(0,n&t),l(1,0|i),+d();i&=n,l(0,0),l(1,0|i),a=+d()}return a}function Q(e){var t=0,r=0,n=0;if(e+307>>>0<=615)return i[920]=0,i[921]=-2147483648,n=W(3680,1,e),r=i[920],e=i[921],3071&r&&(t=i[921],(e=i[920]+1024|0)>>>0<1024&&(t=t+1|0),i[920]=e,i[921]=t,r=e,e=t),i[920]=e<<21|r>>>11,void(i[921]=1071644672+(e>>>11&1048575|n<<20));(0|e)>=309&&(i[922]=1),i[920]=0,i[921]=0}function X(e,t,r,n){var o=0,c=0,s=0;e:{t:{r:{n:{if(!n){if(u[e>>1]<=52)break n;break t}if(!((0|n)<1)&&(0|n)<15)break r}return i[t>>2]=1,void(i[r>>2]=0)}if(u[(n<<1)+e>>1]<=52)break e;for(;;){if(s=u[(c=((o=n+-1|0)<<1)+e|0)>>1]+1|0,a[c>>1]=s,58!=(65535&s))break e;if(!(n=o))break}}return a[e>>1]=49,i[t>>2]=i[t>>2]+1,void(i[r>>2]=1)}for(;t=n,(0|n)>=2&&48==u[((n=t+-1|0)<<1)+e>>1];);i[r>>2]=t}function Z(){var e=0,t=0,r=0;e:{if(r=i[920],t=-65536&(e=i[921])){if(2146435072==(2146435072&e))return i[922]=1,void pe();if((0|t)<1)break e}return void pe()}pe(),(0|r)==i[920]&&i[921]==(0|e)||te(1)}function $(e){h[460]=ee(h[460],e)}function ee(e,t){var r;return f(+(e+=t)),r=0|s(1),s(0),2146435072==(2146435072&r)&&(i[922]=1,e=h[375]),e}function te(e){h[460]=re(h[460],e)}function re(e,t){var r;return f(+(e-=t)),r=0|s(1),s(0),2146435072==(2146435072&r)&&(i[922]=1,e=h[375]),e}function ne(e){h[460]=ae(h[460],e)}function ae(e,t){var r,n=0,a=0,o=0;return f(+e*t),n=0|s(1),r=0|s(0),0|2146435072!=(0|(a=2146435072&n))?(o=(a=!(a|o))?i[750]:r,n=a?i[751]:n,l(0,0|o),l(1,0|n),+d()):(i[922]=1,n=i[751],l(0,i[750]),l(1,0|n),+d())}function ie(e){h[460]=oe(h[460],e)}function oe(e,t){var r=0,n=0,a=0,o=0;if(f(+t),r=0|s(1),s(0),2146435072&r){if(n=1,f(+e/t),r=0|s(1),a=0|s(0),!(!0&2146435072==(0|(o=2146435072&r))))return a=(n=!(0|o))?i[750]:a,r=n?i[751]:r,l(0,0|a),l(1,0|r),+d()}else n=4;return i[922]=n,r=i[751],l(0,i[750]),l(1,0|r),+d()}function ce(e){h[460]=e>>>0}function ue(e){h[460]=0|e}function se(){var e,t;e=+N(+h[460]),h[460]=e,f(+e),t=0|s(1),s(0),2146435072==(2146435072&t)&&(i[922]=8)}function le(){return de(h[460])}function de(e){var t,r=0,n=0,a=0,i=0;return f(+e),i=1106247680==(0|(a=2146435072&(r=0|s(1))))&i>>>0<0|a>>>0<1106247680,t=r&=2147483647,l(0,0|(n=0|s(0))),l(1,0|r),(e=+d())<0x10000000000000000&e>=0?(a=p(e)>=1?e>0?~~g(O(e/4294967296),4294967295)>>>0:~~j((e-+(~~e>>>0>>>0))/4294967296)>>>0:0,r=~~e>>>0):(a=0,r=0),n=i?r:n,!(r=i?a:t)&n>>>0<4294967295|r>>>0<0?n:-1}function fe(){return be(h[460])}function be(e){var t=0,r=0;return f(+e),t=0|s(1),s(0),r=1105199104==(0|(t&=2145386496))&r>>>0<0|t>>>0<1105199104,t=p(e)<2147483648?~~e:-2147483648,r?t:-2147483648}function he(){var e,t;e=+y(+h[460]),h[460]=e,f(+e),t=0|s(1),s(0),2146435072==(2146435072&t)&&(i[922]=8)}function ve(){var e,t;e=+_(+h[460]),h[460]=e,f(+e),t=0|s(1),s(0),2146435072==(2146435072&t)&&(i[922]=8)}function pe(){h[460]=J(h[460])}function me(){var e,t;e=+F(+h[460]),h[460]=e,f(+e),t=0|s(1),s(0),2146435072==(2146435072&t)&&(i[922]=1)}function ge(e,t,r){return function(e,t,r){var n=0,c=0,l=0,d=0;if(n=o[r+30|0]){for(c=r;d=10*d+ +(0|Re[i[i[e>>2]+4>>2]](e,u[c>>1])),c=c+2|0,l=(0|n)>1,n=n+-1|0,l;);if(f(+d),n=0|s(1),e=0|s(0),i[t>>2]=e<<11,i[t+4>>2]=2147481600&((2097151&n)<<11|e>>>21)|e>>>21|-2147483648,n=W(t,(n>>>20&2047)-1022|0,((32767&u[r+32>>1])-o[r+30|0]|0)-16384|0),3071&(c=i[t>>2])?(e=c+1024|0,i[t>>2]=e,c>>>0<4294966272||(l=(c=i[t+4>>2])+1|0,i[t+4>>2]=l,n=(l>>>0<c>>>0)+n|0)):e=c,!((0|n)<=-1022))return(0|(c=1071644672+(n<<20)|0))<0?1:(n=i[t+4>>2],i[t>>2]=n<<21|e>>>11,i[t+4>>2]=-2147483648&a[r+32>>1]|c|n>>>11&1048575,0)}return i[t>>2]=0,i[t+4>>2]=0,0}(e,t,r)}function Oe(e,t,r,o){!function(e,t,r,o){var c,l,d=0,b=0,p=0,m=0,g=0,O=0,j=0,y=0,S=0,C=0;M=c=M-16|0,h[c+8>>3]=e,l=t,f(+e),b=0|s(1),p=0|s(0),m=d=b;e:if(b=2146435072&d){if(b=v(g=(b>>>20)-1022|0,39457)>>17,a[r+32>>1]=b+16385|d>>>16&32768,(0|o)<=14){if((0|(o=1+(o+b|0)|0))<=-1){n[r+30|0]=0,a[r+32>>1]=0,a[t+2>>1]=0,t=0;break e}o=(0|o)<15?o:15}if(i[c+8>>2]=p<<11,i[c+12>>2]=m<<11|p>>>21|-2147483648,(0|(d=W(c+8|0,g,-1^b)))>=1)for(p=r+32|0;b=u[p>>1],a[p>>1]=b+1&32767|32768&b,(0|(d=W(c+8|0,d,-1)))>0;);if(d?(b=(p=i[c+12>>2])>>>(m=0-d|0),i[c+12>>2]=b,d=p<<d+32|i[c+8>>2]>>>m,i[c+8>>2]=d):(d=i[c+8>>2],b=i[c+12>>2]),d=(p=b>>>0<(d>>>0<2576980377?429496730:429496729)>>>0?922:9223)+d|0,i[c+8>>2]=d,d>>>0<p>>>0&&(b=b+1|0,i[c+12>>2]=b),(0|o)<1)p=r;else{for(O=d>>>16,j=u[c+14>>1],y=r+32|0,C=15==(0|o),p=r,m=1;;){g=o;t:{r:{for(;;){if(o=v(O,10)+(v(65535&d,10)>>>16)>>>16,S=v(j,10)+(o+v(65535&b,10)>>>16)>>>16|48,a[p>>1]=S,j=(b=o+v(b,10)|0)>>>16,O=(d=v(d,10))>>>16,1&(-1^m|48!=(0|S)))break r;if(o=u[y>>1],a[y>>1]=o+-1&32767|32768&o,!C)break}m=1;break t}p=p+2|0,m=0}if(o=g+-1|0,!((0|g)>1))break}i[c+12>>2]=b,i[c+8>>2]=d}d=(o=p-r|0)>>1;t:{if((0|o)<=29){if((0|b)<=-1){a[p>>1]=57,b=d+1|0;break t}a[p>>1]=48}for(;;){if(b=d,(0|d)<1)break t;if(d=b+-1|0,48!=u[(p=p+-2|0)>>1])break}}n[r+30|0]=b,a[t+2>>1]=b,t=(32767&u[r+32>>1])-16384|0}else n[r+30|0]=0,a[r+32>>1]=0,a[t+2>>1]=0,t=0;a[l>>1]=t,M=c+16|0}(e,t,r,o)}function je(e){return re(h[460],e)}function ye(e){return oe(h[460],e)}function Se(e){h[460]=oe(e,h[460])}function Ce(e,t){h[460]=oe(e,t)}function S(){w(1),S()}function ke(e,t){var r,n;r=0|e,n=0|t,c[0]=r,c[1]=n}function Ee(e,t,r,n){var a=0,i=0;return r=function(e,t,r,n){var a=0,i=0,o=0,c=0,u=0,s=0,l=0,d=0,f=0,b=0;e:{t:{r:{n:{a:{i:{o:{c:{u:{s:{if(o=t){if(!(a=r))break s;if(!(i=n))break u;if((a=m(i)-m(o)|0)>>>0<=31)break c;break t}if(1==(0|n)&r>>>0>=0|n>>>0>1)break t;return ke(e-v(t=(e>>>0)/(r>>>0)|0,r)|0,0),D=0,t}if(a=n,!e)break o;if(!a)break i;if((i=a+-1|0)&a)break i;return ke(e,o&i),e=o>>>(31&Te(a)),D=0,e}if(!((i=a+-1|0)&a))break a;u=(m(a)+33|0)-m(o)|0,s=0-u|0;break r}u=a+1|0,s=63-a|0;break r}return ke(0,o-v(e=(o>>>0)/(a>>>0)|0,a)|0),D=0,e}if((a=m(a)-m(o)|0)>>>0<31)break n;break t}if(ke(e&i,0),1==(0|a))break e;return r=Te(a),n=e,e=31&r,32<=(63&r)>>>0?(a=0,e=t>>>e):(a=t>>>e,e=((1<<e)-1&t)<<32-e|n>>>e),D=a,e}u=a+1|0,s=63-a|0}if(i=t,f=e,o=31&(a=63&u),32<=(63&a)>>>0?(a=0,c=i>>>o):(a=i>>>o,c=((1<<o)-1&i)<<32-o|f>>>o),i=a,o=e,e=31&(a=63&s),32<=(63&a)>>>0?(a=o<<e,e=0):(a=(1<<e)-1&o>>>32-e|t<<e,e=o<<e),t=a,u)for(a=n+-1|0,(o=r+-1|0)>>>0<4294967295&&(a=a+1|0),s=a;a=i<<1|c>>>31,i=c<<1,f=a,a=(c=s-((o>>>0<(i|=t>>>31)>>>0)+a|0)|0)>>31,c=(d=i)-(i=r&(l=c>>31))|0,i=f-((n&a)+(d>>>0<i>>>0)|0)|0,a=t<<1|e>>>31,e=b|e<<1,t=0|a,d=0,b=l&=1,u=u+-1|0;);return ke(c,i),D=(a=t<<1|e>>>31)|d,e=l|e<<1}ke(e,t),e=0,t=0}return D=t,e}((e^=a=t>>31)-a|0,i=((i=t>>31)^t)-((e>>>0<a>>>0)+i|0)|0,(r^=e=n>>31)-e|0,((a=n>>31)^n)-((r>>>0<e>>>0)+a|0)|0),D=((e=(t^=n)>>31)^D)-(((r^=t>>=31)>>>0<t>>>0)+e|0)|0,n=r-t|0}function Ae(e,t,r,n){return e=function(e,t,r,n){var a,i,o,c,u=0,s=0;return c=v(u=r>>>16,s=e>>>16),u=(65535&(s=((o=v(a=65535&r,i=65535&e))>>>16)+v(s,a)|0))+v(u,i)|0,e=(((v(t,r)+c|0)+v(e,n)|0)+(s>>>16)|0)+(u>>>16)|0,D=e,t=65535&o|u<<16}(e,t,r,n)}function Ne(e,t,r,n){return e=Ee(e,t,r,n)}function Te(e){return e?31-m(e+-1^e)|0:32}var Re=[null,function(e,t){return 0,0!=(0|C(0|(t|=0)))|0},function(e,t){return 0,0|k(0|(t|=0))},function(e){return 0,0|E()},function(e,t){return 0,(t|=0)+-48|0},P];return{memory:Object.create(Object.prototype,{grow:{},buffer:{get:function(){return r}}}),Base_StrBuf:function(){return 3104},Base_StrBufSize:function(){return 255},Dtr_DaysPerMonth:function(e,t,r){return 0|function(e,t,r){var n=0;n=3&t;e:if(r){if(n|(0|t)<2100)break e;n=!((t>>>0)%100)&0!=((t>>>0)%400|0)}else n||(n=!((0|t)%100)&0!=((0|t)%400|0));return o[1072+(((v(n,12)+e|0)-1|0)%48|0)|0]}(e|=0,t|=0,0!=(0|(r|=0)))},Dtr_FromNum:function(e,t,r,n,c){return e=+e,t|=0,n|=0,c|=0,r=v(r|=0,20)+3616|0,a[r>>1]=0,t=function(e,t,r,n,c){var b=0,p=0,m=0,g=0,O=0,j=0,y=0,S=0,C=0;e:if(!u[e>>1]){if(h[460]=t,f(+t),b=0|s(1),m=0|s(0),j=b,C=-65536&b)if(2146435072!=(2146435072&b)){if(!((0|C)>=1))return-2147467259}else i[922]=1;O=i[770],y=i[771],g=-1;t:{if(!((0|b)<(0|(p=y))||(g=1,(0|b)>(0|p)))){if((0|O)==(0|(p=m)))break t;g=p>>>0<O>>>0?-1:1}if(p=-2147467259,1==(0|((j&y)>-1?g:0-g|0)))break e}t:{if(O=i[772],p=i[773],y=p,g=-1,!((0|b)<(0|p)||(g=1,(0|b)>(0|y)))){if((0|m)==(0|O))break t;g=m>>>0<O>>>0?-1:1}if(O=g,-1==(0|((p&j)>-1?O:0-O|0)))return-2147467259}t:{r:{if(!(c|!C))if(2146435072!=(2146435072&b)){if((0|C)<1)break r}else i[922]=1;$(h[i[1056+(r<<2)>>2]>>3]),S=h[460];break t}Z(),te(t),j=i[921],m=j,l(0,0|(b=i[920])),l(1,0|m),S=+d(),i[750]==(0|b)&&i[751]==(0|m)||(p=i[921])>>>0<65536||(i[921]=-2147483648^p,f(+(S=h[460])),m=0|s(1),b=0|s(0)),j=m,O=m,m=i[1056+(r<<2)>>2],y=i[m+4>>2],p=i[m>>2],g=-1;r:{if(!((0|O)<(0|(m=y))||(g=1,(0|O)>(0|m)))){if((0|b)==(0|p)){h[460]=t;break r}g=b>>>0<p>>>0?-1:1}if(O=g,h[460]=t,-1==(0|((j&y)>-1?O:0-O|0)))break t}te(h[374])}if(a[e+18>>1]=r,b=fe(),p=-2147467259,!K(0)){if(n){if((0|b)>2957003)break e;b=b+1462|0}else if(b+4346018>>>0>7304483)break e;if(a[e+14>>1]=1+((b+6|0)%7|0),!c|b)if(b){if((0|b)<=-1?(m=-4-((n=(-1^b)/1461|0)<<2)|0,p=1461+(v(n,1461)+b|0)|0):(m=(n=(b+-1|0)/1461|0)<<2,p=v(n,-1461)+b|0),!(c&&(0|m)<=199))if((0|(p=(((0|(n=m+-101|0))/100|0)-((0|n)/400|0)|0)+p|0))>=1462){b=3&(n=m+1900|0);t:if(c){if(b|(0|m)<200)break t;b=!((n>>>0)%100)&0!=((n>>>0)%400|0)}else b||(b=!((0|n)%100)&0!=((0|n)%400|0));m=m+4|0,p=(12==(0|v(b,12))?-1460:-1461)+p|0}else(0|p)>0||(m=m+-4|0,p=p+1461|0);b=3&(n=m+1900|0);t:if(c){if(b|(0|m)<200)break t;b=!((n>>>0)%100)&0!=((n>>>0)%400|0)}else b||(b=!((0|n)%100)&0!=((0|n)%400|0));for(j=v(b,12),b=j;c=b,b=b+1|0,(0|(p=(n=p)-o[c+1072|0]|0))>0;);c=((p=c)-((0|j)<(0|(c=c+-11|0))?j:c)>>>0)/12|0,a[e>>1]=1900+(c+m|0),a[e+2>>1]=(v(c,-12)+b|0)-j}else i[e>>2]=788331,n=30;else i[e>>2]=67436;if(i[e+4>>2]=n,h[460]=S,pe(),(n=i[921])>>>0>=65536&&(i[921]=-2147483648^n),$(S),ne(h[379]),t=h[460],n=le(),a[e+8>>1]=n,ce(n<<16>>16),(n=i[921])>>>0>=65536&&(i[921]=-2147483648^n),$(t),ne(h[380]),t=h[460],n=le(),a[e+10>>1]=n,ce(n<<16>>16),(n=i[921])>>>0>=65536&&(i[921]=-2147483648^n),$(t),ne(h[380]),!r)return r=le(),a[e+16>>1]=0,a[e+12>>1]=r,0;t=h[460],n=le(),a[e+12>>1]=n,ce(n<<16>>16),(n=i[921])>>>0>=65536&&(i[921]=-2147483648^n),$(t),ne(h[i[1152+(r<<2)>>2]>>3]),h[460]=q(h[460]),a[e+16>>1]=le(),p=0}}return p}(r,e,t,0!=(0|n),0!=(0|c)),i[922]=0,0|t},Dtr_Yr:function(e){return a[v(e|=0,20)+3616>>1]},Dtr_Mon:function(e){return a[v(e|=0,20)+3618>>1]},Dtr_DOM:function(e){return i[v(e|=0,20)+3620>>2]},Dtr_Hour:function(e){return a[v(e|=0,20)+3624>>1]},Dtr_Min:function(e){return a[v(e|=0,20)+3626>>1]},Dtr_Sec:function(e){return a[v(e|=0,20)+3628>>1]},Dtr_Wdy:function(e){return a[v(e|=0,20)+3630>>1]},Dtr_FracSec:function(e){return a[v(e|=0,20)+3632>>1]},Dtr_Rounding:function(e){return a[v(e|=0,20)+3634>>1]},Dtr_Write:function(e,t,r,n,o,c,u,s,l,d){e|=0,t|=0,r|=0,n|=0,o|=0,c|=0,u|=0,s|=0,l|=0,d=v(d|=0,20),a[d+3634>>1]=l,a[d+3632>>1]=s,a[d+3630>>1]=u,a[d+3628>>1]=c,a[d+3626>>1]=o,a[d+3624>>1]=n,i[d+3620>>2]=r,a[d+3618>>1]=t,a[d+3616>>1]=e},Dtr_ToNum:function(e,t,r){return e|=0,t|=0,r|=0,i[920]=0,i[921]=0,function(e,t,r){var n,o=0;M=n=M-16|0;e:{t:{r:{if((u[e+2>>1]+-32767&65535)>>>0>1){if(a[e+18>>1]>=1?(ue(a[e+16>>1]),o=ye(h[i[1152+(a[e+18>>1]<<2)>>2]>>3]),ue(a[e+12>>1]),$(o)):ue(a[e+12>>1]),o=ye(h[380]),ue(a[e+10>>1]),$(o),o=ye(h[380]),ue(a[e+8>>1]),$(o),o=ye(h[379]),!((0|U(e,t,r,n+12|0))<0)){if(e=i[n+12>>2],!t)break r;if(ue(e+-1462|0),!((0|e)<1462)){if(e=i[921],!(t=-65536&e))break t;if(2146435072==(2146435072&e)){i[922]=1;break t}if((0|t)>=1)break t}}i[920]=0,i[921]=0}i[920]=0,i[921]=0,K(8);break e}ce(e)}$(o)}M=n+16|0}(v(e,20)+3616|0,0!=(0|t),0!=(0|r)),+h[460]},Dtr_ToNumWithDuration:function(e,t,r,n,o){return e|=0,t|=0,r|=0,n|=0,o|=0,i[920]=0,i[921]=0,function(e,t,r,n,o){var c,s=0;M=c=M-16|0;e:{t:{r:{if((u[e+2>>1]+-32767&65535)>>>0>1){n:if(a[e+18>>1]>=1){if(ue(a[e+16>>1]),ie(h[i[1152+(a[e+18>>1]<<2)>>2]>>3]),s=h[460],2==(0|o)){h[460]=n,$(s);break n}ue(a[e+12>>1]),$(s)}else 2!=(0|o)?ue(a[e+12>>1]):h[460]=n;if(ie(h[380]),s=h[460],1!=(0|o)?ue(a[e+10>>1]):h[460]=n,$(s),ie(h[380]),s=h[460],o?ue(a[e+8>>1]):h[460]=n,$(s),ie(h[379]),n=h[460],!((0|U(e,t,r,c+12|0))<0)){if(e=i[c+12>>2],!t)break r;if(ue(e+-1462|0),!((0|e)<1462)){if(e=i[921],!(t=-65536&e))break t;if(2146435072==(2146435072&e)){i[922]=1;break t}if((0|t)>=1)break t}}i[920]=0,i[921]=0}i[920]=0,i[921]=0,K(8);break e}ce(e)}$(n)}M=c+16|0}(v(e,20)+3616|0,0!=(0|t),0!=(0|r),+(0|o),n),+h[460]},Dtr_Days:function(){return i[919]},Dtr_ToDays:function(e,t,r){return t|=0,r|=0,0|U(v(e|=0,20)+3616|0,0!=(0|t),0!=(0|r),3676)},Dtr_ToTime:function(e,t,r){return function(e,t,r){h[460]=e,$(h[i[1056+(r<<2)>>2]>>3]);e:{if(t>>>0<=1){if(t-1)break e}else ne(h[380]);ne(h[380])}ne(h[379]),pe()}(e=+e,t|=0,r|=0),+h[460]},Dtr_UtcToLocal:function(e,t,r,n,o,c,s,l){var d;return e|=0,t|=0,r|=0,n|=0,o|=0,c|=0,s|=0,l|=0,M=d=M-32|0,i[d+24>>2]=c,i[d+16>>2]=n,i[d+8>>2]=t,i[d+20>>2]=(0|o)>-1?v(o,20)+3616|0:0,i[d+12>>2]=(0|r)>-1?v(r,20)+3616|0:0,e=function(e,t,r,n){var o,c=0;M=o=M-32|0,function(e,t,r){var n,o=0,c=0,s=0,l=0,d=0,f=0,b=0,h=0,p=0,m=0,g=0,O=0;if(M=n=M-96|0,i[n+64>>2]=a[t>>1],i[n+68>>2]=a[t+2>>1],i[n+72>>2]=i[t+4>>2],i[n+76>>2]=a[t+8>>1],i[n+80>>2]=a[t+10>>1],i[n+84>>2]=a[t+12>>1],i[n+92>>2]=a[t+14>>1]+-1,(o=a[t+18>>1])>>>0<=3){e:{t:switch(o-1|0){case 0:o=v(a[t+16>>1],100);break e;case 1:o=v(a[t+16>>1],10);break e;case 2:break t;default:break e}o=a[t+16>>1]}i[n+88>>2]=o}t=0;e:if(V(n- -64|0,n+40|0)){if(s=Ae(s=v(i[e>>2],60),s>>31,1e7,0),d=D,(c=i[e+4>>2])&&(l=i[e+12>>2])){if(i[n+64>>2]=a[c>>1],i[n+68>>2]=a[c+2>>1],i[n+72>>2]=i[c+4>>2],i[n+76>>2]=a[c+8>>1],i[n+80>>2]=a[c+10>>1],i[n+84>>2]=a[c+12>>1],i[n+92>>2]=a[c+14>>1]+-1,(o=a[c+18>>1])>>>0<=3){t:{r:switch(o-1|0){case 0:o=v(a[c+16>>1],100);break t;case 1:o=v(a[c+16>>1],10);break t;case 2:break r;default:break t}o=a[c+16>>1]}i[n+88>>2]=o}if(i[n+8>>2]=a[l>>1],i[n+12>>2]=a[l+2>>1],i[n+16>>2]=i[l+4>>2],i[n+20>>2]=a[l+8>>1],i[n+24>>2]=a[l+10>>1],i[n+28>>2]=a[l+12>>1],i[n+36>>2]=a[l+14>>1]+-1,(o=a[l+18>>1])>>>0<=3){t:{r:switch(o-1|0){case 0:o=v(a[l+16>>1],100);break t;case 1:o=v(a[l+16>>1],10);break t;case 2:break r;default:break t}o=a[l+16>>1]}i[n+32>>2]=o}if(c=i[n+44>>2],l=c,o=i[n+40>>2],!H(n- -64|0,n+56|0,o,c))break e;if(!H(n+8|0,n+48|0,o,l))break e;p=i[n+40>>2],b=i[n+44>>2],m=s,g=e+16|0,O=e+8|0,h=(l=d)+i[n+52>>2]|0,(f=(o=s)+i[n+48>>2]|0)>>>0<o>>>0&&(h=h+1|0),c=f,o=v(i[e+8>>2],60),f=Ae(o,o>>31,1e7,0),o=D+h|0,h=c=c+f|0,f=o=c>>>0<f>>>0?o+1|0:o,c=d+i[n+60>>2]|0,(d=s+i[n+56>>2]|0)>>>0<s>>>0&&(c=c+1|0),e=v(i[e+16>>2],60),s=Ae(e,e>>31,1e7,0),e=D+c|0,e=(d=s+d|0)>>>0<s>>>0?e+1|0:e,s=d,e=Ae(e=v(i[((e=(0|o)<(0|e)||(0|o)<=(0|e)&&!(h>>>0>=s>>>0)?((0|b)<(0|e)?1:(0|b)<=(0|e)?p>>>0>=s>>>0?0:1:0)&((0|b)>(0|f)?1:(0|b)>=(0|f)?p>>>0<h>>>0?0:1:0):((0|b)<(0|e)?1:(0|b)<=(0|e)?p>>>0>=s>>>0?0:1:0)|((0|b)>(0|f)?1:(0|b)>=(0|f)?p>>>0<h>>>0?0:1:0))?g:O)>>2],60),e>>31,1e7,0),o=D+l|0,d=o=(s=m+e|0)>>>0<e>>>0?o+1|0:o}e=i[n+40>>2],o=i[n+44>>2]-(d+(e>>>0<s>>>0)|0)|0,s=e-s|0,(0|(e=o))<0||(0|e)<=0&&!(s>>>0>=0)||(G(s,e,n- -64|0),a[r>>1]=i[n+64>>2],a[r+2>>1]=i[n+68>>2],i[r+4>>2]=i[n+72>>2],t=1,a[r+14>>1]=u[n+92>>1]+1,a[r+8>>1]=i[n+76>>2],a[r+10>>1]=i[n+80>>2],a[r+12>>1]=i[n+84>>2],e=i[n+88>>2],a[r+18>>1]=3,a[r+16>>1]=e)}return M=n+96|0,t}(n,e,o+8|0)&&(n=i[o+12>>2],i[e>>2]=i[o+8>>2],i[e+4>>2]=n,i[e+16>>2]=i[o+24>>2],n=i[o+20>>2],i[e+8>>2]=i[o+16>>2],i[e+12>>2]=n,n=e,(0|U(e,t,r,o+28|0))>=0?e=1+((i[o+28>>2]+6|0)%7|0)|0:(i[o+28>>2]=-1,e=6),a[n+14>>1]=e,c=1);return M=o+32|0,c}(v(e,20)+3616|0,0!=(0|s),0!=(0|l),d+8|0),M=d+32|0,0|e},Mathpack_Zero:function(){return+h[375]},Mathpack_One:function(){return+h[374]},Mathpack_Pi:function(){return+h[370]},Mathpack_Div:function(e,t){return+oe(e=+e,t=+t)},Mathpack_Mul:function(e,t){return+ae(e=+e,t=+t)},Mathpack_Sub:function(e,t){return+re(e=+e,t=+t)},Mathpack_Add:function(e,t){return+ee(e=+e,t=+t)},Mathpack_Power:function(e,t){return+function(e,t){var r=0,n=0,o=0,c=0;h[460]=t,f(+t),r=0|s(1),s(0),o=r,i[921]=2147483647&r,t=h[460];e:{if(f(+je(h[371])),r=0|s(1),n=0|s(0),65535==(0|r)&n>>>0<=4294967295|r>>>0<65535)h[460]=e,he();else if(pe(),f(+je(t)),r=0|s(1),n=0|s(0),65535==(0|r)&n>>>0>4294967295|r>>>0>65535||-1==(0|(r=le()))){if(h[460]=e,f(+e),n=0|s(1),s(0),(0|(n=(r=n)>>>16<<16))>=1)se(),ne(t),me();else if(!((0|n)>-1)){if(Ce(h[374],t),c=q(h[460]),h[460]=c,pe(),f(+je(c)),65535==(0|(n=0|s(1)))&s(0)>>>0>4294967295|n>>>0>65535)break e;if(2147483647==(0|(n=fe()))|!(1&n))break e;h[460]=e,i[921]=2147483647&r,se(),ne(t),me(),(r=i[921])>>>0<65536||(i[921]=-2147483648^r)}}else h[460]=e,function(e){var t,r=0;if(!((t=a[1843])|e))return void(i[922]=4&i[922]?4:64);if(!((0|t)<1)&&10==(0|le())){if(r=h[460],pe(),te(r),!u[1843])return void Q(e);h[460]=r}r=1;for(;1&e&&(r=ae(h[460],r)),e>>>=1;)ne(h[460]);h[460]=r}(r);if(o>>>16<<16>>16<=-1){if(1&(o=i[922]))return i[920]=0,i[921]=0,i[922]=-2&o,h[460];Se(h[374])}return h[460]}return i[922]=8,h[460]}(e=+e,t=+t)},Mathpack_Cond:function(e){var t,r;return f(+(e=+e)),t=0|s(1),s(0),(r=-65536&t)?2146435072==(2146435072&t)?(i[922]=1,0):0|((0|r)<1?-1:1):0},Mathpack_Cond2:function(e,t){t=+t;var r,n,a,i,o=0,c=0,u=0;f(+(e=+e)),o=0|s(1),r=0|s(0),n=o,i=o,f(+t),a=0|s(1),o=0|s(0),u=-1;e:{if(!((0|n)<(0|(c=a))||(u=1,(0|i)>(0|c)))){if(c=0,(0|o)==(0|r))break e;u=r>>>0<o>>>0?-1:1}o=u,c=(a&n)>-1?o:0-o|0}return 0|c},Mathpack_TakeMathError:function(){var e;return e=i[922],i[922]=0,0|e},Mathpack_Trunc:function(e){return+J(e=+e)},Mathpack_Ceil:function(e){return e=+e,h[460]=e,function(){var e=0,t=0,r=0;e:{if(r=i[920],e=i[921],t=-65536&e){if(2146435072==(2146435072&e))return i[922]=1,void pe();if((0|t)>0)break e}return void pe()}pe(),(0|r)==i[920]&&i[921]==(0|e)||$(1)}(),+h[460]},Mathpack_Floor:function(e){return e=+e,h[460]=e,Z(),+h[460]},Mathpack_Abs:function(e){var t=0;return f(+(e=+e)),t=0|s(1),t&=2147483647,l(0,0|(0|s(0))),l(1,0|t),+d()},Mathpack_Neg:function(e){var t,r,n,a;return f(+(e=+e)),n=-2147483648^(t=0|s(1)),l(0,0|(r=0|s(0))),l(1,0|n),a=+d(),+(65535==(0|t)&r>>>0>4294967295|t>>>0>65535?a:e)},Mathpack_Float:function(e){return+((e|=0)>>>0)},Mathpack_SFloat:function(e){return+(0|(e|=0))},Mathpack_Fix:function(e){return 0|de(e=+e)},Mathpack_LFix:function(e){return 0|be(e=+e)},Mathpack_SFix:function(e){return e=+e,h[460]=e,0|Y()},Mathpack_Round:function(e,t){return+function(e,t){var r,o=0,c=0,l=0,d=0;M=r=M+-64|0,i[r+56>>2]=0,a[r+46>>1]=0,a[r+48>>1]=0,h[460]=e,f(+e),o=0|s(1),s(0);e:if(c=-65536&o)if(2146435072!=(2146435072&o)){(0|c)>0||(d=32768,o>>>0<65536||(i[921]=-2147483648^o,e=h[460])),Oe(e,r+56|0,r+16|0,15),u[r+58>>1]||(a[r+56>>1]=1),h[460]=t,o=(0|(o=Y()))<0?100:o;t:{if(c=i[921],l=-65536&c)if(2146435072!=(2146435072&c)){if(!((0|l)>0)){if((o=i[921])>>>0>=65536&&(i[921]=-2147483648^o),(0|(o=Y()))<=-1)break t;o=0-o|0}}else i[922]=1;c=a[r+56>>1],l=o+c|0,o=a[r+58>>1],(0|l)<(0|o)&&(i[r+12>>2]=o,i[r+8>>2]=c,X(r+16|0,r+8|0,r+12|0,l),o=i[r+12>>2],a[r+58>>1]=o,c=i[r+8>>2],a[r+56>>1]=c),n[r+46|0]=o,a[r+48>>1]=c+16384&32767|d,ge(3100,3680,r+16|0),e=h[460];break e}e=h[375]}else i[922]=1;return M=r- -64|0,e}(e=+e,t=+t)},Mathpack_RoundUp:function(e,t){return+function(e,t){var r=0,n=0,a=0,o=0,c=0;f(+e),r=0|s(1),s(0);(n=-65536&r)&&(2146435072!=(2146435072&r)?c=(0|n)<1?-1:1:i[922]=1);if(a=L(e,t),h[460]=e,h[460]=q(e),te(a),(r=i[921])>>>0>=65536){if(2146435072==(2146435072&r))return i[922]=1,a;if(r=(0|(r=de(t)<<16))<0?309:r>>16,f(+t),n=0|s(1),s(0),(o=-65536&n)&&(2146435072!=(2146435072&n)?r=(0|o)<1?0-r|0:r:i[922]=1),(0|r)<=-309)return K(8),0;Q(0-r|0),(0|c)>-1||(r=i[921])>>>0<65536||(i[921]=-2147483648^r),$(a),a=h[460]}return a}(e=+e,t=+t)},Mathpack_RoundDown:function(e,t){var r;return f(+(e=L(e=+e,t=+t))),r=0|s(1),s(0),2146435072==(2146435072&r)&&(i[922]=1,e=-1),+e},Mathpack_TenTo:function(e){return Q(e|=0),+h[460]},Mathpack_Compare:function(e,t){return+(0|function(e,t){var r,n=0,a=0,o=0,c=0,u=0;M=r=M-16|0,h[r+8>>3]=e,h[r>>3]=t,f(+e),n=0|s(1),a=0|s(0),o=n,f(+t),n=0|s(1),c=0|s(0),u=n;e:{if((0|a)!=(0|c)||(0|o)!=(0|n)){if((u+2097152&2146435072)-(2146435072&o)>>>0<=5242879&&(e=q(e),h[r+8>>3]=e,f(+e),n=0|s(1),s(0),o=n,e=q(t),h[r>>3]=e,f(+e),n=0|s(1),s(0),u=n),n=1,o=i[(c=(a=(u&o)>-1)?r+8|0:r)+4>>2],u=i[(a=a?r:r+8|0)+4>>2],(0|o)>(0|u))break e;if((0|o)<(0|u)){n=-1;break e}if(c=i[c>>2],a=i[a>>2],c>>>0>a>>>0)break e;if(n=-1,c>>>0<a>>>0)break e}n=0}return M=r+16|0,n}(e=+e,t=+t))},Mathpack_GetExp32:function(e){var t;return f(+(e=+e)),t=0|s(1),s(0),2146435072&t},Mathpack_Equal:function(e,t){t=+t;var r,n,a=0;return f(+(e=+e)),a=0|s(1),r=0|s(0),f(+t),n=0|s(1),0|(a=(0|r)==(0|s(0))?(0|a)==(0|n):0)},Mathpack_ViewRound:function(e){var t;return f(+(e=+e)),t=0|s(1),s(0),2146435072==(2146435072&t)?(i[922]=1,-1):+q(e)},Mathpack_Sqrt:function(e){return e=+e,h[460]=e,he(),+h[460]},Mathpack_Exp:function(e){return e=+e,h[460]=e,me(),+h[460]},Mathpack_Ln:function(e){return e=+e,h[460]=e,se(),+h[460]},Mathpack_Log:function(e){return e=+e,h[460]=e,function(){var e,t;e=+A(+h[460]),h[460]=e,f(+e),t=0|s(1),s(0),2146435072==(2146435072&t)&&(i[922]=8)}(),+h[460]},Mathpack_Sin:function(e){return e=+e,h[460]=e,function(){var e=0,t=0;f(+(t=h[460])),e=0|s(1),s(0),1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+T(+t),h[460]=t,f(+t),e=0|s(1),s(0),2146435072!=(2146435072&e))||(i[922]=8)}(),+h[460]},Mathpack_Cos:function(e){return e=+e,h[460]=e,function(){var e=0,t=0;f(+(t=h[460])),e=0|s(1),s(0),1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+R(+t),h[460]=t,f(+t),e=0|s(1),s(0),2146435072!=(2146435072&e))||(i[922]=8)}(),+h[460]},Mathpack_Tan:function(e){return e=+e,h[460]=e,function(){var e=0,t=0,r=0;r=8,f(+(t=h[460])),e=0|s(1),s(0);1101004799==(0|(e&=2145386496))&!0|e>>>0<1101004799&&(t=+I(+t),h[460]=t,r=4,f(+t),e=0|s(1),s(0),2146435072!=(2146435072&e))||(i[922]=r)}(),+h[460]},Mathpack_Asin:function(e){return+B(e=+e,0)},Mathpack_Acos:function(e){return+B(e=+e,1)},Mathpack_Atan:function(e){return e=+e,h[460]=e,ve(),+h[460]},Mathpack_Atan2:function(e,t){return+function(e,t){var r=0,n=0,a=0,o=0,c=0,u=0;h[460]=e;e:{if(f(+e),r=0|s(1),s(0),r>>>0>=65536){if(2146435072!=(2146435072&r))break e;i[922]=1}h[460]=t;t:{if(f(+t),r=0|s(1),s(0),n=-65536&r){if(2146435072!=(2146435072&r))break t;i[922]=1}return K(4),0}return ue((0|n)<1?-1:1),ne(h[370]),ie(h[372]),h[460]}e:if((0|r)<=-1){f(+t),r=0|s(1),s(0);t:{if(n=-65536&r)if(2146435072!=(2146435072&r)){if((0|n)<1)break t}else i[922]=1;a=h[370];break e}f(+(a=h[370])),r=0|s(1),n=0|s(0),o=-2147483648^r,l(0,0|n),l(1,0|o),c=+d(),u=a,a=65535==(0|r)&n>>>0>4294967295|r>>>0>65535?c:u}else a=h[375];return Ce(t,e),ve(),$(a),h[460]}(e=+e,t=+t)},Mathpack_FormatGeneral:function(e,t){t|=0;var r,n,o,c=0,l=0;return f(+(e=+e)),r=0|s(1),o=0|s(0),2146435072==(2146435072&r)?(i[922]=1,-1):(h[460]=e,c=3104,(n=-65536&(l=r))&&(2146435072!=(2146435072&l)?(c=3104,(0|n)>0||(l>>>0>=65536&&(i[921]=-2147483648^l),c=3104,!o&-2147483648==(0|r)||(a[1552]=45,c=3106))):(i[922]=1,c=3104)),l=c,t=(0|t)<255?t:255,t=function(e,t,r,n){var o;M=o=M-16|0,e=0|Re[i[i[e>>2]+8>>2]](e),i[o+8>>2]=0;e:if(r<<1>>>0<=33){if((0|r)<1)break e;a[t>>1]=0}else Oe(h[460],o+8|0,t,15),t=function(e,t,r,n,o,c){var s,l,d,f=0,b=0,h=0,p=0,m=0;M=l=M-16|0,s=(t<<1)+e|0,d=l+12|0;t:{r:{n:{a:if(!(h=(0|r)<5&(b=o?n:1)+3>>>0<8)){i:if(!((0|b)>(0|r))){if((0|(n=r+b|0))>=3){if((0|r)<5|(0|b)>-4)break a;if((n+-2|0)<(0|o))break i;break a}if((0|r)<5)break a}if(p=1,n=1,(0|r)<7)break n;n=r-(b+97>>>0>196?6:5)|0;break n}(1!=(0|r)||(n=0,b))&&(n=r-((0|b)<(0|r)?(0|b)<1?2-b|0:1:0)|0)}n:{if((0|n)<(0|o)){f=1,o=0;a:if(!((0|t)<1)){i:{o:{if(!n){if(u[e>>1]>52)break o;break a}if((0|n)<1|(0|n)>=(0|t))break a;if(u[(n<<1)+e>>1]<=52)break i;for(;;){if(m=u[(f=((o=n+-1|0)<<1)+e|0)>>1]+1|0,a[f>>1]=m,58!=(65535&m))break i;if(n=o,!o)break}}a[e>>1]=49,o=1,f=b+1|0;break a}for(;(0|(o=n))>=2&&48==u[((n=o+-1|0)<<1)+e>>1];);f=b}if((-1^h)&(0|f)>(0|r)|p)break n;break r}if(f=b,!p)break r}if(i[d>>2]=32768,r=e+2|0,(0|o)<2||(n=r+(o<<1)|0)>>>0>=s>>>0?n=r:(o=o+-1|0,i[d>>2]=32768|o,e=e+4|0,(t<<1)-4>>1>>>0<o>>>0&&S(),x(e,r,o<<1),a[r>>1]=c),n>>>0<s>>>0&&(a[n>>1]=69,n=n+2|0),n>>>0>=s>>>0?o=n:(o=n+2|0,(0|f)<=0?(a[n>>1]=45,f=1-f|0):(a[n>>1]=43,f=f+-1|0)),(0|f)<100|o>>>0>=s>>>0||(e=(f>>>0)/100|0,a[o>>1]=e+48,f=f-v(e,100)|0,o=o+2|0),o>>>0<s>>>0&&(a[o>>1]=48+((0|f)/10|0),o=o+2|0),o>>>0>=s>>>0)break t;a[o>>1]=48+((0|f)%10|0),o=o+2|0;break t}if((0|o)<0|(0|o)>(0|f))if(r=o-f|0,i[d>>2]=r,(0|f)>=1){if(!((r=(n=((h=(r=(b=(0|f)>(0|t)?t:f)<<1)+e|0)+(o<<1)|0)-r|0)+-2|0)>>>0<e>>>0|n>>>0>=s>>>0))for(;a[n>>1]=u[r>>1],n=n+-2|0,(r=r+-2|0)>>>0>=h>>>0;);(0|f)<(0|t)&&(a[h>>1]=c),o=h+(((0|(e=s-h>>1))>(0|(t=o-b|0))?t+1|0:e)<<1)|0}else{if(!((n=2+((e-(f<<1)|0)+(o<<1)|0)|0)>>>0>=s>>>0||(o=((o<<1)+e|0)-2|0)>>>0<e>>>0))for(;a[n>>1]=u[o>>1],n=n+-2|0,(o=o+-2|0)>>>0>=e>>>0;);if((0|t)>=1&&(a[e>>1]=48,e=e+2|0),e>>>0<s>>>0&&(a[e>>1]=c,e=e+2|0),n=s-e>>1,f&&(t=(0|n)<(0|(t=0-f|0))?n:t))for(o=0;a[(o<<1)+e>>1]=48,(0|t)!=(0|(o=o+1|0)););o=(((0|n)<(0|r)?n:r)<<1)+e|0}else{if(r=(n=(0|f)>(0|t)?t:f)-o|0)for(t=(o<<1)+e|0,o=0;a[t+(o<<1)>>1]=48,(0|r)!=(0|(o=o+1|0)););o=(n<<1)+e|0}}return M=l+16|0,o}(t,r,n,a[o+8>>1],a[o+10>>1],e);return M=o+16|0,t}(i[256],l,3614-l>>1,(0|t)>0?t:0),i[920]=0,i[921]=0,t-3104>>1)},Mathpack_FormatGetExponent:function(){return i[924]},Mathpack_FormatGetSign:function(){return i[925]},Mathpack_FormatFixed:function(e,t,r){t|=0,r|=0;var n,o=0,c=0;return M=n=M+-64|0,f(+(e=+e)),o=0|s(1),s(0),2146435072!=(2146435072&o)?(i[n+56>>2]=0,a[n+46>>1]=0,a[n+48>>1]=0,Oe(e,n+56|0,n+16|0,(o=t+r|0)>>>0<15?o:15),c=a[n+56>>1],o=a[n+58>>1],i[n+8>>2]=o,t=t+c|0,i[n+12>>2]=t,(0|(t=t+r|0))<(0|o)&&(X(n+16|0,n+12|0,n+8|0,t),o=i[n+8>>2]),o?((0|(r=r+(t=i[n+12>>2])|0))<(0|o)&&(i[n+8>>2]=r,o=r),(0|o)>-1||(i[922]=1)):(o=0,i[n+12>>2]=0,t=0),i[924]=t,i[925]=u[n+48>>1]>>>15^1,r=o,o>>>0>=256&&(S(),r=i[n+8>>2]),x(3104,n+16|0,o<<1)):(i[922]=1,r=-1),M=n- -64|0,0|r},Mathpack_FormatScientific:function(e,t,r){t|=0,r|=0;var n,o=0,c=0,l=0;if(M=n=M+-64|0,f(+(e=+e)),c=0|s(1),s(0),2146435072!=(2146435072&c)){if(i[n+56>>2]=0,a[n+46>>1]=0,a[n+48>>1]=0,Oe(e,n+56|0,n+16|0,15),l=a[n+56>>1],i[n+12>>2]=l,c=a[n+58>>1],i[n+8>>2]=c,(0|(o=t))>=2&&(o=(0|l)%(0|t)|0,o=((0|l)<1?t:o?0:t)+o|0),!((0|(o=r+o|0))>=(0|c))){for(X(n+16|0,n+12|0,n+8|0,o),o=(0|o)<(0|(c=i[n+8>>2]))?o:c;c=o,(0|o)>=1&&48==u[(n+16|0)+((o=c+-1|0)<<1)>>1];);i[n+8>>2]=c,(0|t)<2||(0|(o=i[n+12>>2]))!=(0|l)&&((((l=r)+(r=(0|o)%(0|t)|0)|0)+((0|o)<1?t:r?0:t)|0)>=(0|c)||(S(),c=i[n+8>>2]))}(0|c)<=-1&&(i[922]=1),i[924]=i[n+12>>2],i[925]=u[n+48>>1]>>>15^1,(o=c)>>>0>=256&&(S(),o=i[n+8>>2]),x(3104,n+16|0,c<<1)}else i[922]=1,o=-1;return M=n- -64|0,0|o},Mathpack_Pack:function(e,t,r){var o;return e|=0,t|=0,r|=0,M=o=M-48|0,n[o+39|0]=0,x(o+8|0,3104,(r=(0|r)<15?r:15)<<1),a[o+40>>1]=t+16384&32767|!e<<15,n[o+38|0]=r,i[o>>2]=0,i[o+4>>2]=0,ge(i[256],o,o+8|0)&&(i[922]=1),M=o+48|0,+h[o>>3]},_start:P,__errno_location:function(){return 3712},setThrew:function(e,t){e|=0,t|=0,i[926]||(i[927]=t,i[926]=e)},stackSave:function(){return 0|M},stackAlloc:function(e){return M=e=M-(e|=0)&-16,0|e},stackRestore:function(e){M=e|=0},__growWasmMemory:function(e){return 0,0|S()}}}({Math:n.Math,Int8Array:Int8Array,Uint8Array:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array,NaN:NaN,Infinity:1/0},{abort:function(){throw new Error("abort")},Base_LocaleIsNumeral:a.Base_LocaleIsNumeral,Base_LocaleGetOrdinal:a.Base_LocaleGetOrdinal,Base_LocaleDecimalSeparator:a.Base_LocaleDecimalSeparator,Math_log10:a.Math_log10,Math_log:a.Math_log,Math_sqrt:a.Math_sqrt,Math_sin:a.Math_sin,Math_cos:a.Math_cos,Math_tan:a.Math_tan,Math_atan:a.Math_atan,Math_exp:a.Math_exp,proc_exit:i.proc_exit},h),m=p.memory;t.memory=m;var g=p.Base_StrBuf;t.Base_StrBuf=g;var O=p.Base_StrBufSize;t.Base_StrBufSize=O;var j=p.Dtr_DaysPerMonth;t.Dtr_DaysPerMonth=j;var y=p.Dtr_FromNum;t.Dtr_FromNum=y;var S=p.Dtr_Yr;t.Dtr_Yr=S;var C=p.Dtr_Mon;t.Dtr_Mon=C;var k=p.Dtr_DOM;t.Dtr_DOM=k;var E=p.Dtr_Hour;t.Dtr_Hour=E;var A=p.Dtr_Min;t.Dtr_Min=A;var N=p.Dtr_Sec;t.Dtr_Sec=N;var T=p.Dtr_Wdy;t.Dtr_Wdy=T;var R=p.Dtr_FracSec;t.Dtr_FracSec=R;var I=p.Dtr_Rounding;t.Dtr_Rounding=I;var _=p.Dtr_Write;t.Dtr_Write=_;var F=p.Dtr_ToNum;t.Dtr_ToNum=F;var w=p.Dtr_ToNumWithDuration;t.Dtr_ToNumWithDuration=w;var M=p.Dtr_Days;t.Dtr_Days=M;var D=p.Dtr_ToDays;t.Dtr_ToDays=D;var P=p.Dtr_ToTime;t.Dtr_ToTime=P;var x=p.Dtr_UtcToLocal;t.Dtr_UtcToLocal=x;var L=p.Mathpack_Zero;t.Mathpack_Zero=L;var B=p.Mathpack_One;t.Mathpack_One=B;var U=p.Mathpack_Pi;t.Mathpack_Pi=U;var G=p.Mathpack_Div;t.Mathpack_Div=G;var V=p.Mathpack_Mul;t.Mathpack_Mul=V;var H=p.Mathpack_Sub;t.Mathpack_Sub=H;var W=p.Mathpack_Add;t.Mathpack_Add=W;var z=p.Mathpack_Power;t.Mathpack_Power=z;var q=p.Mathpack_Cond;t.Mathpack_Cond=q;var K=p.Mathpack_Cond2;t.Mathpack_Cond2=K;var Y=p.Mathpack_TakeMathError;t.Mathpack_TakeMathError=Y;var J=p.Mathpack_Trunc;t.Mathpack_Trunc=J;var Q=p.Mathpack_Ceil;t.Mathpack_Ceil=Q;var X=p.Mathpack_Floor;t.Mathpack_Floor=X;var Z=p.Mathpack_Abs;t.Mathpack_Abs=Z;var $=p.Mathpack_Neg;t.Mathpack_Neg=$;var ee=p.Mathpack_Float;t.Mathpack_Float=ee;var te=p.Mathpack_SFloat;t.Mathpack_SFloat=te;var re=p.Mathpack_Fix;t.Mathpack_Fix=re;var ne=p.Mathpack_LFix;t.Mathpack_LFix=ne;var ae=p.Mathpack_SFix;t.Mathpack_SFix=ae;var ie=p.Mathpack_Round;t.Mathpack_Round=ie;var oe=p.Mathpack_RoundUp;t.Mathpack_RoundUp=oe;var ce=p.Mathpack_RoundDown;t.Mathpack_RoundDown=ce;var ue=p.Mathpack_TenTo;t.Mathpack_TenTo=ue;var se=p.Mathpack_Compare;t.Mathpack_Compare=se;var le=p.Mathpack_GetExp32;t.Mathpack_GetExp32=le;var de=p.Mathpack_Equal;t.Mathpack_Equal=de;var fe=p.Mathpack_ViewRound;t.Mathpack_ViewRound=fe;var be=p.Mathpack_Sqrt;t.Mathpack_Sqrt=be;var he=p.Mathpack_Exp;t.Mathpack_Exp=he;var ve=p.Mathpack_Ln;t.Mathpack_Ln=ve;var pe=p.Mathpack_Log;t.Mathpack_Log=pe;var me=p.Mathpack_Sin;t.Mathpack_Sin=me;var ge=p.Mathpack_Cos;t.Mathpack_Cos=ge;var Oe=p.Mathpack_Tan;t.Mathpack_Tan=Oe;var je=p.Mathpack_Asin;t.Mathpack_Asin=je;var ye=p.Mathpack_Acos;t.Mathpack_Acos=ye;var Se=p.Mathpack_Atan;t.Mathpack_Atan=Se;var Ce=p.Mathpack_Atan2;t.Mathpack_Atan2=Ce;var ke=p.Mathpack_FormatGeneral;t.Mathpack_FormatGeneral=ke;var Ee=p.Mathpack_FormatGetExponent;t.Mathpack_FormatGetExponent=Ee;var Ae=p.Mathpack_FormatGetSign;t.Mathpack_FormatGetSign=Ae;var Ne=p.Mathpack_FormatFixed;t.Mathpack_FormatFixed=Ne;var Te=p.Mathpack_FormatScientific;t.Mathpack_FormatScientific=Te;var Re=p.Mathpack_Pack;t.Mathpack_Pack=Re;var Ie=p._start;t._start=Ie;var _e=p.__errno_location;t.__errno_location=_e;var Fe=p.setThrew;t.setThrew=Fe;var we=p.stackSave;t.stackSave=we;var Me=p.stackAlloc;t.stackAlloc=Me;var De=p.stackRestore;t.stackRestore=De;var Pe=p.__growWasmMemory;t.__growWasmMemory=Pe},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.watchdog=void 0;var n,a,i=(0,r(130).createPerf)();t.watchdog=(n=1/0,(a=function(e){if(void 0===e&&(e=""),i.now()>n)throw new Error("Time limit exceeded with message: ".concat(e))}).arm=function(e){n=i.now()+e},a)},function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n="33.3.0"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.NulLogger=t.ConsoleLogger=t.ULS=t.LogCategory=t.TraceLevel=void 0,function(e){e[e.Error=10]="Error",e[e.Warning=15]="Warning",e[e.Info=50]="Info",e[e.Verbose=100]="Verbose",e[e.Spam=200]="Spam"}(t.TraceLevel||(t.TraceLevel={})),function(e){e[e.msoulscat_ES_EWAJS=0]="msoulscat_ES_EWAJS"}(t.LogCategory||(t.LogCategory={})),t.ULS={getFromExternalLogger:function(e){var t=e;return{ULS:{trace:function(e,r,n){return t.traceTag(0,e,r,n)},traceTag:function(e,r,n,a){return t.traceTag(e,r,n,a)},debugTrace:function(e,r,n){return t.debugTraceTag(0,e,r,n)},debugTraceTag:function(e,r,n,a){return t.debugTraceTag(e,r,n,a)},assert:function(e,r,n){return t.assertTag(0,e,r,n)},assertTag:function(e,r,n,a){return t.assertTag(e,r,n,a)},shipAssert:function(e,r,n){return t.shipAssertTag(0,e,r,n)},shipAssertTag:function(e,r,n,a){return t.shipAssertTag(e,r,n,a)},dnmTrace:function(e,r,n){return t.dnmTraceTag(0,e,r,n)},dnmTraceTag:function(e,r,n,a){return t.dnmTraceTag(e,r,n,a)}}}}};var n=function(){function e(){}return e.prototype.shipAssertTag=function(e,t,r,n){console.assert(r,"shipAssertTag:",e,t,n)},e.prototype.assertTag=function(e,t,r,n){console.assert(r,"assertTag",e,t,n)},e.prototype.traceTag=function(e,t,r,n){console.log("traceTag",e,n,t,r)},e.prototype.dnmTraceTag=function(e,t,r,n){console.log("dnmTraceTag",e,n,t,r)},e.prototype.debugTraceTag=function(e,t,r,n){console.log("debugTraceTag",e,n,t,r)},e}();t.ConsoleLogger=n;var a=function(){function e(){}return e.prototype.shipAssertTag=function(){},e.prototype.assertTag=function(){},e.prototype.traceTag=function(){},e.prototype.debugTraceTag=function(){},e.prototype.dnmTraceTag=function(){},e}();t.NulLogger=a},function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r(20),a=n.deque.Deque},function(e,t,r){"use strict";r.d(t,"b",(function(){return a})),r.d(t,"a",(function(){return i}));var n=r(20),a=n.table.makeEmptyTable,i=n.table.entry},function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r(9),a=r(5),i=r(54),o=r(22),c=r(50),u=r(2),s=r(3),l=r(29),d=function(e){function t(t,r,n){var a=e.call(this,l.v)||this;return a.localeInfo=t,a.annotations=r,a.names=n,a}return Object(n.__extends)(t,e),t.prototype.appNode=function(t,r,n,a){var i=this;return o.a.try((function(){return t.kind===u.e.Name&&(i.annotations[t.label]=u.k),e.prototype.appNode.call(i,t,r,n,a)}))},t.prototype.letNode=function(e,t,r,n){var i=this,u=e.id===c.a.LETREC||e.id!==c.a.LET&&Object(a.a)("calc.lang.buildAnnotations"),s=this.bindNames(t),d=s[t.length];return this.lazyVisitAppHeadNode(e).bind((function(e){return u?o.a.all(t.map((function(e){var t=e.binder;return o.a.try((function(){return Object(l.r)(d,t.arg)}))}))):o.a.all(t.map((function(e,t){var r=e.binder,n=s[t];return o.a.try((function(){return Object(l.r)(n,r.arg)}))})))})).bind((function(e){return void 0===r?void 0:Object(l.r)(d,r.arg)})).bind((function(e){return o.a.all(n.map((function(e){return o.a.try((function(){return Object(l.r)(i,e.arg)}))})))})).bind((function(e){}))},t.prototype.lambdaNode=function(e,t,r,n){var a=this,i=this.bindNames(t),c=i[t.length];return this.lazyVisitAppHeadNode(e).bind((function(e){return o.a.all(t.map((function(e,t){var r=e.name;if(void 0===r.arg.def)return o.a.resolve(void 0);var n=i[t],a=r.arg.def;return o.a.try((function(){return Object(l.r)(n,a.rhs)}))})))})).bind((function(e){return void 0===r?void 0:Object(l.r)(c,r.arg)})).bind((function(e){return o.a.all(n.map((function(e){return o.a.try((function(){return Object(l.r)(a,e.arg)}))})))})).bind((function(e){}))},t.prototype.bindNames=function(e){var r=this,n=[this];return e.reduce((function(e,a){var i=a.name;if(void 0===i.arg.whole)return n.push(new t(r.localeInfo,r.annotations,e)),e;var o=e.setValue(Object(s.h)(r.localeInfo,i.arg.whole),i.arg);return n.push(new t(r.localeInfo,r.annotations,o)),r.annotations[i.arg.label]=Object(u.U)(),o}),this.names),n},t.prototype.nameNode=function(t,r,n){var a=this;return o.a.try((function(){if(void 0===r){var i=Object(u.L)(t),o=a.names.getEntry(Object(s.h)(a.localeInfo,i.asWhole));if(void 0!==o)a.annotations[i.label]=Object(u.V)(o.key,o.value.whole,o.value.label),a.annotations[o.value.label].uses.push({label:i.label})}return e.prototype.nameNode.call(a,t,r,n)}))},t}(l.f);function f(e,t){var r=[];return Object(l.o)(new d(e,r,i.a.create(e.stringCompareCI)),t),r[t.label]=u.J,r}},function(e,t,r){"use strict";r.d(t,"a",(function(){return j}));var n=r(9),a=r(61),i=r(3),o=r(11),c=r(48),u=r(33),s=r(0),l=u.k,d=u.c,f=u.u,b=u.D,h=u.s,v=u.t,p=u.v,m=u.x;function g(e,t,r,n){if(" "!==t&&""!==t){var a="$"===t;if(e.isEastAsia){if(n<r.length&&r.charCodeAt(n)===l&&!a)return{currency:1,i:n+1};if(n+2<r.length&&0===e.stringCompareCI(r.substring(n,n+3),"US$"))return{currency:e.isChinaT?1:2,i:n+3};if(("¥"===t&&e.isJapan||"₩"===t&&e.isKorea)&&n<r.length&&r.charCodeAt(n)===d)return{currency:0,i:n+1};if(e.isChinaT&&n+2<r.length&&0===e.stringCompareCI(r.substring(n,n+3),"NT$"))return{currency:2,i:n+3}}return n+t.length<=r.length&&0===e.stringCompareCI(r.substring(n,n+t.length),t)?{currency:0,i:n+t.length}:void 0}}function O(e,t,r,u,l,d){var O,j=0,y=!1,S=!1,C=!1,k=e.isCurrencySymbolLead,E=e.currencySymbol;0!==l&&(k=1===l,E="€");for(var A=0;A<r.length;){if(void 0===O&&k)if(void 0!==(I=g(e,E,r,A))){O=I.currency,A=I.i;continue}switch(_=r.charCodeAt(A)){case f:A+=1,j+=1;continue;case b:A+=1;continue;case h:case v:case p:if(A+=1,S)return Object(s.f)(void 0);S=!0,_===h&&(y=!0),C=_!==p;continue}break}var N=Object(a.b)(e,t,r,A,!0,j>0||u,d);if(void 0===N||void 0===N.value)return Object(s.f)(void 0);A=N.i;for(var T,R=C?t.neg(N.value):N.value;A<r.length;){var I,_;if(void 0===O&&!k)if(void 0!==(I=g(e,E,r,A))){O=I.currency,A=I.i;continue}switch(_=r.charCodeAt(A)){case f:A+=1,j+=1;continue;case b:A+=1;continue;case m:if(A+=1,!y)return Object(s.f)(void 0);y=!1;continue}break}if(A!==r.length||y||j>1||void 0!==O&&j>0)return Object(s.f)(void 0);if(void 0!==N.format)T=N.format;else if(1===O)T=N.consumedDecimal?o.d.USCoCurrencyDec:o.d.USCoCurrency;else if(2===O){T=e.isChinaT?N.consumedDecimal?'"NT$"#,##0.00_);("NT$"#,##0.00)':'"NT$"#,##0_);("NT$"#,##0)':N.consumedDecimal?'"US$"#,##0.00_);("US$"#,##0.00)':'"US$"#,##0_);("US$"#,##0)'}else{if(N.numShape!==o.e.ASCII)return Object(s.c)(Object(i.hb)(["parseConstInternal ifmt for non-ASCII"]));if(void 0!==O)switch(l){case 0:T=N.consumedDecimal?o.d.CoCurrencyDec:o.d.CoCurrency;break;case 1:T=Object(c.a)(Object(n.__assign)(Object(n.__assign)({},e),{isCurrencySymbolLead:!0,isCurrencySepBySpace:!0}),!0,N.consumedDecimal?2:0,!0,!1,"[$€-x-euro2]");break;case 2:T=Object(c.a)(Object(n.__assign)(Object(n.__assign)({},e),{isCurrencySymbolLead:!1,isCurrencySepBySpace:!0}),!0,N.consumedDecimal?2:0,!0,!1,"[$€-x-euro1]")}else T=j>0?N.consumedDecimal?o.d.Pct:o.d.Pct0:N.consumedThousands?N.consumedDecimal?o.d.Fixed:o.d.Fixed0:o.d.General}return Object(s.f)({value:R,format:T})}function j(e,t,r,n,a,i){if(!a)return O(e,t,r,n,0,i);for(var o=0;o<=2;o+=1){var c=O(e,t,r,n,o,i);if(!Object(s.d)(c))return c;if(void 0!==c.value)return c;if(0===o&&r.indexOf("€")<0)break}return Object(s.f)(void 0)}},function(e,t,r){"use strict";r.d(t,"a",(function(){return g}));var n=r(9),a=r(12),i=r(2),o=r(3),c=r(46),u=r(0),s=r(5),l=r(19),d=r(71),f=r(29);function b(e,t,r,n){if(r.kind===i.f.Abs)return r;var a=Object(c.n)(e,r.index,n)-t;return a===r.index?r:Object(i.db)(i.f.Rel,a)}function h(e,t,r,n){var o=b(t.row,r.row,n.row,a.v),u=b(t.col,r.col,n.col,a.o),s=Object(c.a)(e,o)||Object(c.a)(e,u);return Object(i.x)(o,u,s,n.label)}function v(e,t,r,n){switch(n.kind){case i.c.Error:case i.c.Bad:return n;case i.c.Single:return h(e,t,r,n);case i.c.Range:var o=h(e,t,r,n.ref1),u=h(e,t,r,n.ref2);return o===n.ref1&&u===n.ref2?n:Object(i.v)(o,u,n.label);case i.c.Row:var s=b(t.row,r.row,n.row1,a.v),l=b(t.row,r.row,n.row2,a.v),d=Object(c.a)(e,s)||Object(c.a)(e,l);return Object(i.w)(s,l,d,n.label);case i.c.Col:var f=b(t.col,r.col,n.col1,a.o),v=b(t.col,r.col,n.col2,a.o);d=Object(c.a)(e,f)||Object(c.a)(e,v);return Object(i.r)(f,v,d,n.label)}}var p=Object(o.c)("TransformRefsError"),m=function(e){function t(t,r,n,a){var i=e.call(this)||this;return i.fn=t,i.locals=n,i.annotations=a,i.resolver=Object(d.a)(r),i}return Object(n.__extends)(t,e),t.prototype.nameNode=function(e,t,r){var n=Object(i.X)(e,t,r),a=this.resolver.resolveDottedName(this.locals,n,this.annotations).resolved;if(a.kind===l.e.ResolvedCellRef){var o=Object(i.H)(e);Object(s.h)("calc.lang.adjustFormulaOrigin",o.kind===i.d.CellRefNamePart);var c=o.parts,d=c[0],f=c[1],b=c.slice(2),h=function(e,t){var r=t.rhs,n=t.canDenoteNamedObject,a=t.label;return Object(i.D)(e,r,n,a)};return Object(i.X)(b.reduce(h,h(Object(i.t)(this.fn(d.ref),d.asWhole,d.label),f)),t,r)}if(a.resolution.kind!==u.b.Success&&a.resolution.reason.kind!==l.d.NoOriginSheet&&a.resolution.reason.kind!==l.d.InvalidQualifier)throw new p(a.resolution.reason);return n},t.prototype.cellRefNode=function(e,t,r){return Object(i.u)(this.fn(e),t,r)},t}(f.e);function g(e,t,r,a){var i=t.originGridCell.value;if(Object(o.G)(i,r))return Object(u.f)(a);try{var c=Object(f.m)(new m(v.bind(void 0,e.config.refStyle,i,r),e,t,a.annotations),a);return Object(u.f)(Object(n.__assign)(Object(n.__assign)({},a),{node:c}))}catch(e){if(e instanceof p)return Object(u.c)(e.reason);throw e}}},function(e,t,r){"use strict";r.d(t,"a",(function(){return b}));var n=r(40),a=r(12),i=r(10),o=r(0),c=r(2),u=r(3),s=r(5),l=r(63),d=r(19),f=r(111),b=function(){function e(e,t,r,n,i){var d=this;this.document=e,this.stringCompareCI=t,this.sheetScopedNames=r,this.oldSheetScopedNames=n,this.onWriteNamedObject=function(e,t,r){if("NamedRange"===t.kind){var n=t.value;if(Object(s.h)("calc.calc.PartialWorkbookDocument.onWriteNamedObject: bad range",Object(u.D)(t.value.sheets.document,e.scope.document)),(a=d.getNamesBySheetId(n.sheets.index)).kind===o.b.Failure)return a;a.value.onWriteNamedRange(e,t,r)}if("NamedTable"===t.kind){var a;if((a=d.getNamesBySheetId(t.specialRefRanges[c.i.All].sheet.index)).kind===o.b.Failure)return a;a.value.onWriteNamedTable(e,t,r)}return o.g},this.globalNames=null!=i?i:new l.a(t,Object(a.e)(e))}return e.prototype.clone=function(){var t;if(this.sheetScopedNames)for(var r in t=Object(i.i)(),this.sheetScopedNames){var n=this.sheetScopedNames[r];t[r]=n.clone()}return new e(this.document,this.stringCompareCI,t,void 0,this.globalNames.clone())},e.prototype.setNamedObject=function(e,t,r,n){var i=this.getNameFormula(t,a.b.StructRef);void 0!==r&&"NamedTable"===r.kind&&Object(o.d)(i)&&void 0!==i.value&&"NamedTable"===i.value.obj.kind&&Object(l.c)(i.value.obj,r)&&(r=Object(l.e)(i.value.obj,r));var c=this.getNamesBySheetId(t.scope.index);return c.kind===o.b.Failure?c:c.value.setNamedObject(e,t,r,n,this.onWriteNamedObject)},e.prototype.setUndefinedNames=function(e){var t=this.getNamesBySheetId(e.index);return t.kind===o.b.Failure?t:Object(o.f)(t.value.setUndefinedNames())},e.prototype.promoteNamedObjects=function(e,t){var r=this.getNamesBySheetId(e.index);return r.kind===o.b.Failure?r:r.value.promoteNamedObjects(t,this.onWriteNamedObject)},e.prototype.setSheetNames=function(t){for(var r,n,o=null!==(r=this.sheetScopedNames)&&void 0!==r?r:this.oldSheetScopedNames,c=Object(i.i)(),u=0,s=t;u<s.length;u++){var d=s[u].sheetId;c[d]=null!==(n=null==o?void 0:o[d])&&void 0!==n?n:new l.a(this.stringCompareCI,Object(a.s)(this.document,d))}return new e(this.document,this.stringCompareCI,c,void 0,this.globalNames)},e.prototype.getNameLoc=function(e,t,r){var n=this.getNamesBySheetId(e);if(n.kind===o.b.Failure)return n;var a=n.value.getNameLoc(t,r);return a.kind,o.b.Failure,a},e.prototype.getAvailableNamesInScope=function(e){var t=this.globalNames.getAvailableNames(Object(a.e)(this.document)),r=this.getNamesBySheetId(e);return r.kind===o.b.Success&&Object(i.p)(t,r.value.getAvailableNames(Object(a.m)(this.document,e))),t},e.prototype.getAvailableTableColumns=function(e){var t=this.getNameFormula(e,a.b.StructRef),r=[];return t.kind!==o.b.Success||void 0===t.value||"NamedTable"!==t.value.obj.kind||t.value.obj.columnNames.forEach((function(e){return r.push(e),!0})),r},e.prototype.getNameFormula=function(e,t){var r=this.getNamesBySheetId(e.scope.index);return r.kind===o.b.Failure?r:r.value.getNameFormula(e.name,t)},e.prototype.hasRecalcNameFailure=function(e){var t=this.getNamesBySheetId(e.scope.index);return t.kind===o.b.Failure?t:Object(o.f)(t.value.hasRecalcFailure(e.name))},e.prototype.setRecalcNameFailure=function(e){var t=this.getNamesBySheetId(e.scope.index);return t.kind===o.b.Failure?t:Object(o.f)(t.value.setRecalcFailure(e.name))},e.prototype.getNamesBySheetId=function(e){if(void 0===e)return Object(o.f)(this.globalNames);if(!this.sheetScopedNames)return Object(o.c)(Object(u.kb)([{kind:n.d.SheetNames}]));var t=this.sheetScopedNames[e];return void 0===t?Object(o.c)(Object(u.kb)([{kind:n.d.SheetId,document:this.document,sheetId:e}])):Object(o.f)(t)},e.prototype.getContainingTable=function(e){var t=this.getNamesBySheetId(e.sheet.index);return t.kind===o.b.Failure?t:Object(o.f)(t.value.getContainingTable(e.range))},e.prototype.getNamedRanges=function(e){var t=this.getNamesBySheetId(e.sheet.index);return t.kind===o.b.Failure?t:Object(o.f)(t.value.getNamedRanges(e.range))},e.prototype.getIntersectingTables=function(e){var t=this.getNamesBySheetId(e.sheet.index);return t.kind===o.b.Failure?t:Object(o.f)(t.value.getIntersectingTables(e.range))},e.prototype.getStructRefColumn=function(e,t){var r=this.getNameFormula(e,a.b.StructRef);if(r.kind===o.b.Failure)return r;if(void 0===r.value)return Object(o.f)(void 0);if("NamedTable"!==r.value.obj.kind)return Object(o.c)(Object(d.i)(d.c.NamedObjectNotTable));var i,s=r.value.obj;if("string"==typeof t)i=s.columnNames.getEntry(t);else{var l=s.columnIndexes.getValue(t);i=void 0===l?void 0:Object(f.a)(l,t)}if(void 0===i)return s.allColumnNamesAvailable?Object(o.f)(void 0):Object(o.c)(Object(u.kb)([{kind:n.d.ColumnName,table:e,columnNameOrIndex:t}]));var b=s.specialRefRanges[c.i.Data],h=b.sheet,v=b.range,p=Object(a.r)(h,Object(a.g)(v.row,i.value,v.rows,1));return Object(o.f)(Object(a.w)(i.key,p,s.hasHeadersRow,s.hasTotalsRow))},e.prototype.getStructRefSpecialRef=function(e,t){var r=this.getNameFormula(e,a.b.StructRef);return r.kind===o.b.Failure?r:void 0===r.value?Object(o.f)(void 0):"NamedTable"!==r.value.obj.kind?Object(o.c)(Object(d.i)(d.c.NamedObjectNotTable)):Object(o.f)(r.value.obj.specialRefRanges[t])},e.prototype.onCellModified=function(e){this.forEachSheetScope((function(t){t.onCellModified(e)})),this.globalNames.onCellModified(e)},e.prototype.collectGarbage=function(e){this.forEachSheetScope((function(t){t.collectGarbage(e)})),this.globalNames.collectGarbage(e)},e.prototype.advanceState=function(e){this.forEachSheetScope((function(t){t.advanceState(e)})),this.globalNames.advanceState(e),this.oldSheetScopedNames=this.sheetScopedNames,this.sheetScopedNames=void 0},e.prototype.resetLazyData=function(){this.forEachSheetScope((function(e){e.resetLazyData()})),this.globalNames.resetLazyData()},e.prototype.getNameStatistics=function(){var e=this.globalNames.getStatistics();return this.forEachSheetScope((function(t){return e=Object(l.d)(e,t.getStatistics())})),e},e.prototype.forEachSheetScope=function(e){for(var t in this.sheetScopedNames){if(Object.prototype.hasOwnProperty.call(this.sheetScopedNames,t))e(this.sheetScopedNames[t])}},e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return l}));var n=r(9),a=r(98),i=r(40),o=r(10),c=r(12),u=r(0),s=r(3),l=function(){function e(e,t,r,n,a,i){this.document=e,this.stringCompareCI=t,this.sheetPosToId=r,this.sheetNameToId=n,this.data=a,this.oldData=i}return e.prototype.clone=function(){return new e(this.document,this.stringCompareCI,this.sheetPosToId,this.sheetNameToId,this.data,void 0)},e.prototype.setSheetNames=function(t){for(var r,i=null!==(r=this.data)&&void 0!==r?r:this.oldData,u=Object(o.i)(),s=[],l=[],d=0;d<t.length;d+=1){var f=t[d],b=f.sheetName,h=f.sheetId;s[d]=h,l.push([b,h]);var v=null==i?void 0:i[h];if(void 0===v){var p=Object(c.s)(this.document,h);u[h]={pos:d,name:b,sheetIndex:p}}else u[h]=Object(n.__assign)(Object(n.__assign)({},v),{pos:d,name:b})}var m=a.a.create(this.stringCompareCI).setValues(l);return new e(this.document,this.stringCompareCI,s,m,u,void 0)},e.prototype.advanceState=function(e){this.oldData=this.data,this.sheetPosToId=void 0,this.sheetNameToId=void 0,this.data=void 0},e.prototype.getSheetRangeIds=function(e){var t,r;if(!this.sheetPosToId)return Object(u.c)(Object(s.kb)([{kind:i.d.SheetNames}]));if(void 0===e.index)t=0,r=this.sheetPosToId.length;else{var n=this.getSheetById(e.index);if(!Object(u.d)(n))return n;var a=this.getSheetById(e.index2);if(!Object(u.d)(a))return a;t=Object(o.c)(n.value.pos,a.value.pos),r=Object(o.b)(n.value.pos,a.value.pos)+1}for(var l=[],d=t;d<r;d+=1)l.push(this.sheetPosToId[d]);return Object(u.f)(Object(c.u)(l,t))},e.prototype.getSheetById=function(e){if(!this.data)return Object(u.c)(Object(s.kb)([{kind:i.d.SheetNames}]));var t=this.data[e];return void 0===t?Object(u.c)(Object(s.kb)([{kind:i.d.SheetId,document:this.document,sheetId:e}])):Object(u.f)(t)},e.prototype.getSheetByName=function(e){if(!this.sheetNameToId)return Object(u.c)(Object(s.kb)([{kind:i.d.SheetNames}]));var t=this.sheetNameToId.getValue(e);return void 0===t?Object(u.f)(void 0):this.getSheetById(t)},e.prototype.forEachSheet=function(e){if(this.sheetPosToId&&this.data)for(var t=0,r=this.sheetPosToId;t<r.length;t++){var n=r[t],a=this.data[n];a&&e(a,n)}},e}()},function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));var n,a=r(14),i=r(10),o=r(30),c=((n={})[a.c.functionSuggestion]={startDelta:5,stopDelta:2e3},n[a.c.formulaHighlighting]={startDelta:5,stopDelta:2e3},n[a.c.argumentAssistance]={startDelta:Object(o.e)(o.a["OfficeVSO:5581754_DisableThrottlingOnArgumentAssistance"])?0:5,stopDelta:2e3},n[a.c.runExperiment]={startDelta:0,stopDelta:15e3},n[a.c.runAuthoringExperiment]={startDelta:0,stopDelta:15e3},n[a.c.parenthesesCoupling]={startDelta:5,stopDelta:2e3},n);Object(i.r)(),Object(i.r)(),Object(i.r)(),Object(i.r)()},function(e,t,r){"use strict";r.d(t,"a",(function(){return c})),r.d(t,"b",(function(){return u}));var n=r(5),a=r(4),i=r(18),o=[{name:"self",test:function(){return"undefined"!=typeof self}},{name:"fetch",test:function(){return"function"==typeof fetch}},{name:"Set",test:function(){return"function"==typeof Set}},{name:"Map",test:function(){return"function"==typeof Map}},{name:"WeakMap",test:function(){return"function"==typeof WeakMap}},{name:"Symbol",test:function(){return"function"==typeof Symbol}},{name:"WebAssembly",test:function(){return"object"==typeof WebAssembly}},{name:"Atomics",test:function(){return"object"==typeof Atomics}},{name:"BigInt",test:function(){return"function"==typeof BigInt}},{name:"String.startsWith",test:function(){return"function"==typeof"".startsWith}},{name:"String.codePointAt",test:function(){return"function"==typeof"".codePointAt}},{name:"Object.assign",test:function(){return"function"==typeof Object.assign}},{name:"Object.setPrototypeOf",test:function(){return"function"==typeof Object.setPrototypeOf}},{name:"Number.EPSILON",test:function(){return"number"==typeof Number.EPSILON}},{name:"Number.isFinite",test:function(){return"function"==typeof Number.isFinite}},{name:"Number.parseInt",test:function(){return"function"==typeof Number.parseInt}},{name:"Math.acosh",test:function(){return"function"==typeof Math.acosh}},{name:"Math.hypot",test:function(){return"function"==typeof Math.hypot}},{name:"Math.log1p",test:function(){return"function"==typeof Math.log1p}},{name:"Math.trunc",test:function(){return"function"==typeof Math.trunc}},{name:"Promise.finally",test:function(){return"function"==typeof Promise.resolve().finally}},{name:"RegExp_flags",test:function(){return new RegExp("x","i"),!0}},{name:"RegExp.flags",test:function(){return"string"==typeof/x/.flags}},{name:"Array.of",test:function(){return"function"==typeof Array.of}},{name:"Array.entries",test:function(){return"function"==typeof[].entries}},{name:"Array.find",test:function(){return"function"==typeof[].find}},{name:"performance",test:function(){return"object"==typeof performance}},{name:"performance.now",test:function(){return"function"==typeof performance.now}},{name:"performance.timeOrigin",test:function(){return"number"==typeof performance.timeOrigin}},{name:"performance.memory",test:function(){return"object"==typeof performance.memory}}];function c(){return o.map((function(e){var t=e.name,r=e.test;try{return r()?"":t}catch(e){return t}})).filter((function(e){return e.length>0}))}function u(e){e().then((function(e){var t={main:c(),worker:e},r="calc.calc.logMissingJSFeatures: missing = ".concat(JSON.stringify(t));n.i.ULS.traceTag(561534152,a.c.msoulscat_ES_EWAJS,a.i.Info,r)})).catch((function(e){var t="calc.calc.logMissingJSFeatures: threw ".concat(Object(i.c)(e));n.i.ULS.traceTag(561534153,a.c.msoulscat_ES_EWAJS,a.i.Info,t)}))}},function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r(10);function a(e,t){for(var r=0,a=0;a<t;){var i=e.indexOf("\n",a),o=e.indexOf("\r",a),c=i<0?o:o<0?i:Object(n.c)(i,o);if(c<0||c>=t)break;r+=1,a=c+1+(c===o&&c+1<t&&10===e.charCodeAt(c+1)?1:0)}return{line:r,character:t-a}}function i(e,t,r){return{start:a(e,t),end:a(e,r)}}},function(e,t,r){"use strict";var n,a=r(9),i=r(5),o=r(7),c=r(3),u=r(62),s=r(12),l=r(1),d=r(49),f=r(10),b=r(86),h=r(33),v=r(23);!function(e){e[e.OP_DOT=-1]="OP_DOT",e[e.OP_DOTSTAR=-2]="OP_DOTSTAR"}(n||(n={}));var p=h.E,m=h.w,g=h.a,O=function(){function e(e,t,r){void 0===r&&(r=!1),this.localeInfo=e,this.source=t,this.appendWildcard=r,this.bytecode=[],this.blocks=[];for(var n="",a=0;a<t.length;a+=1){var i=t.charCodeAt(a);if(i===p&&a+1<t.length){var o=Object(v.i)(t,a+1);n+=Object(v.j)(o),a+=Object(v.f)(o)}else i!==p&&(i!==m&&i!==g?n+=t.charAt(a):(this.pushBlock(n),n="",this.pushMeta(i)))}0===this.bytecode.length&&(this.simplePattern=n),this.pushBlock(n),r&&this.pushMeta(g)}return e.prototype.pushBlock=function(e){if(""!==e){var t=this.blocks.length;this.blocks.push(e),this.bytecode.push(t);for(var r=1;r<e.length;r+=1)this.bytecode.push(n.OP_DOT)}},e.prototype.pushMeta=function(e){e===m?this.bytecode.push(n.OP_DOT):this.bytecode.push(n.OP_DOTSTAR)},e.prototype.test=function(e){if(void 0!==this.simplePattern)return this.testSimple(e,this.simplePattern);var t=Object.create(null);this.addState(t,0);for(var r=0;r<e.length;r+=1){var a=Object.keys(t);if(t=Object.create(null),0===a.length)return!1;for(var i=0;i<a.length;i+=1){var o=Number(a[i]);if(o!==this.bytecode.length){var c=this.bytecode[o];switch(c){case n.OP_DOT:this.addState(t,o+1);break;case n.OP_DOTSTAR:this.addState(t,o);break;default:var u=this.blocks[c];r+u.length<=e.length&&0===this.localeInfo.stringCompareCI(u,e.substring(r,r+u.length))&&this.addState(t,o+1)}}}}return this.bytecode.length in t},e.prototype.addState=function(e,t){e[t]=!0;for(var r=this.bytecode,a=t;a<r.length&&r[a]===n.OP_DOTSTAR;a+=1)e[a+1]=!0},e.prototype.testSimple=function(e,t){return t.length<=e.length&&(t.length===e.length||this.appendWildcard)&&0===this.localeInfo.stringCompareCI(t,e.substring(0,t.length))},e}(),j=r(21),y=r(8),S={"=":l.a.Eq,"<":l.a.Lt,">":l.a.Gt},C={"<>":l.a.Ne,"<=":l.a.Le,">=":l.a.Ge};function k(e,t){if(!Object(c.ab)(t))return t;var r,n,a=(r=t.value).length>=2&&void 0!==(n=C[r.substring(0,2)])?[n,r.substring(2)]:r.length>=1&&void 0!==(n=S[r.substring(0,1)])?[n,r.substring(1)]:[void 0,r];return{kind:"FilterExpression",operator:a[0],operand:function(e,t){var r=e.config.localeInfo;if(0===r.stringCompareCI(t,r.trueName))return o.v;if(0===r.stringCompareCI(t,r.falseName))return o.i;for(var n=1;n<r.errorNames.length;n+=1){var a=r.errorNames[n];if(null!=a&&0===r.stringCompareCI(a,t))return Object(o.h)(n)}var i=e.parseGeneral(t,!1);return void 0!==i?i:Object(o.u)(t)}(e,a[1])}}function E(e,t,r,n){var a=function(e,t){var r="FilterExpression"===t.kind?t:{kind:"FilterExpression",operator:l.a.Eq,operand:t},n=e.config,a=n.mathpack,o=n.localeInfo;if(r.operator===l.a.Ne&&Object(j.h)(r.operand))return function(e){return!Object(c.y)(e)};if(r.operator===l.a.Eq&&Object(j.h)(r.operand))return c.y;if(void 0!==r.operator&&Object(j.h)(r.operand))return function(e){return!1};if(void 0===r.operator&&Object(j.h)(r.operand))return function(e){return Object(c.y)(e)||Object(j.h)(e)};var u,s,d=void 0===r.operator?l.a.Eq:r.operator;switch(r.operand.kind){case y.b.Number:return u=d,s=r.operand,function(t){var r=Object(c.T)(t)?t.getFallback():t;if(Object(c.M)(r))return Object(b.d)(a,u,r,s);if(Object(c.ab)(r)&&u===l.a.Eq){var n=e.parseGeneral(r.value,!1);return void 0!==n&&Object(b.d)(a,u,n,s)}return u===l.a.Ne};case y.b.Boolean:return function(e,t){return function(r){var n=Object(c.T)(r)?r.getFallback():r;return Object(c.z)(n)?Object(b.b)(e,n,t):e===l.a.Ne}}(d,r.operand);case y.b.String:return function(e,t){switch(e){case l.a.Eq:case l.a.Ne:var r=new O(o,t.value);return function(t){var n=Object(c.T)(t)?t.getFallback():t;return Object(c.ab)(n)?r.test(n.value)===(e===l.a.Eq):e===l.a.Ne};case l.a.Lt:case l.a.Gt:case l.a.Le:case l.a.Ge:return function(r){var n=Object(c.T)(r)?r.getFallback():r;return!!Object(c.ab)(n)&&Object(b.e)(o,e,n,t)}}}(d,r.operand);case y.b.Error:return function(e,t){return function(r){var n=Object(c.T)(r)?r.getFallback():r;return Object(c.E)(n)?Object(b.c)(e,n.type-t.type):e===l.a.Ne}}(d,r.operand);default:return Object(i.e)("calc.funcs.criteria.compileCriteria",r.operand)}}(e,k(e,r)),o=t,u=void 0===n?o:n;return new d.a(u.rows,u.cols,Object(f.b)(o.denseRows,u.denseRows),Object(f.b)(o.denseCols,u.denseCols),(function(e,t){var r=o.get(e,t);return a(r)?u.get(e,t):void 0}),(function(){var e=o.getSparse();return a(e)?u.getSparse():void 0}))}var A=y.b.Number|y.b.String|y.b.Boolean;function N(e,t,r,n,a){var i=function(n,i,c,u){if((null==i?void 0:i.kind)===y.b.Array){for(var s=new d.b(i.rows,i.cols,i.opers),l=n,f=0;f<c;f+=1)l=o(l,s);return l}var b=(u&&void 0!==a?a:r)(e,i);return null==b?n:t(n,b,c)};function o(e,t){for(var r=e,n=0;n<t.rows;n+=1)for(var a=0;a<t.cols;a+=1){var o=t.get(n,a);void 0!==o&&(r=i(r,o,1,!0))}return r}function c(e,t){for(var r=e,n=t.getSparse(),a=t.cols-t.denseCols,o=0;o<t.denseRows;o+=1){for(var c=0;c<t.denseCols;c+=1){var u=t.get(o,c);void 0!==u&&(r=i(r,u,1,!1))}a>0&&void 0!==n&&(r=i(r,n,a,!1))}var s=(t.rows-t.denseRows)*t.cols;return s>0&&void 0!==n&&(r=i(r,n,s,!1)),r}return n.reduce((function(e,t){return Object(u.b)(t)?t.arrays.reduce(c,e):i(e,t,1,!1)}),void 0)}var T=r(0),R=r(29);function I(e,t){var r=Object(c.T)(t)?t.getFallback():t;switch(r.kind){case y.b.Number:return r;case y.b.Boolean:case y.b.String:return;case y.b.Error:return r;case y.b.Missing:case y.b.Blank:return;default:return Object(i.e)("calc.funcs.arithmeticOperationCoerce",r)}}function _(e,t){var r=Object(c.T)(t)?t.getFallback():t;switch(r.kind){case y.b.Boolean:return r.value?e.mathpack.one:e.mathpack.zero;case y.b.Number:return r;case y.b.String:return e.mathpack.zero;case y.b.Error:return r;case y.b.Missing:case y.b.Blank:return;default:return Object(i.e)("calc.funcs.arithmeticAOperationCoerce",r)}}function F(e){return function(t,r,n){if(void 0!==t&&Object(c.E)(t))return t;if(Object(i.h)("calc.funcs.numberReducer",void 0===t||Object(c.M)(t)),Object(c.E)(r))return r;var a,o;Object(i.h)("calc.funcs.numberReducer",Object(c.M)(r)),void 0===t?(a=r,o=n-1):(a=t,o=n);for(var u=0;u<o;u+=1){var s=e(a,r);if(Object(c.E)(s))return s;a=s}return a}}function w(e){return function(t,r,n){return e.count+=n,r}}function M(e,t,r){if(!Object(c.M)(r))return r;var n=function(e){for(var t=e.length-1;t>=0;t-=1){var r=e[t];if(void 0!==r&&Object(u.b)(r))for(var n=r.arrays.length-1;n>=0;n-=1){var a=r.arrays[n];if(a.rows>a.denseRows||a.cols>a.denseCols)if((null==(c=a.getSparse())?void 0:c.kind)===y.b.Number)return c;for(var i=a.denseRows-1;i>=0;i-=1)for(var o=a.denseCols-1;o>=0;o-=1){var c;if((null==(c=a.get(i,o))?void 0:c.kind)===y.b.Number)return c}}}}(t);return(null==n?void 0:n.kind)!==y.b.Number?r:e.mathpack.checkAlmostCancellation(n,r)}function D(e,t,r){var n=N(t,F(t.mathpack.add),I,r);return null==n?t.mathpack.zero:(e&&(n=M(t,r,n)),n)}var P=D.bind(void 0,!1),x=D.bind(void 0,!0);function L(e){return Object(c.R)(e)&&1!==e.ranges.length}function B(e,t,r){if(L(t))return Object(T.c)(o.w);if(void 0===r){var n=e.dereferenceAllOpers([t])[0];return Object(T.f)({values:n,valuesToFilter:n})}if(L(r))return Object(T.c)(o.w);var a=function(e,t){var r=e.ranges[0],n=t.ranges[0],a=Object(f.c)(r.cols,s.o-n.col),i=Object(f.c)(r.rows,s.v-n.row),c=Object(s.g)(r.row,r.col,i,a),u=Object(o.r)(e.sheets,c),l=Object(s.g)(n.row,n.col,i,a),d=Object(o.r)(t.sheets,l);return{actualEvalRange:u,actualFilterRange:d}}(t,r),i=a.actualEvalRange,c=a.actualFilterRange,u=i.ranges[0],l=c.ranges[0],d=e.dereferenceAllOpers([i])[0];if(u.col===l.col&&u.row===l.row)return Object(T.f)({values:d,valuesToFilter:d});var b=e.dereferenceAllOpers([c])[0];return Object(T.f)({values:d,valuesToFilter:b})}function U(e,t){var r=t[0],n=t[1],a=B(e,r,t[2]);if(!Object(T.d)(a))return a.reason;var i=a.value,o=i.values,c=i.valuesToFilter,s=[Object(u.d)([E(e,o.arrays[0],n,c.arrays[0])])];return P(e,s)}function G(e,t,r,n){void 0===r&&(r=!1),void 0===n&&(n=!1);var a,i,c=t[0];if(L(c))return Object(T.c)(o.w);if(r){var s=t[1],l=e.dereferenceAllOpers([c])[0];a=E(e,l.arrays[0],s),i=2}else{a=e.dereferenceAllOpers([c])[0].arrays[0],i=1}for(var d=i;d<t.length;d+=2){var f=t[d],b=t[d+1];if(L(f))return Object(T.c)(o.w);if(f.ranges[0].cols!==c.ranges[0].cols||f.ranges[0].rows!==c.ranges[0].rows)return Object(T.c)(o.w);l=e.dereferenceAllOpers([f])[0];a=E(e,l.arrays[0],b,a)}return n&&(a=a.strict()),Object(T.f)(Object(u.d)([a]))}function V(e,t){var r=N(e,F(e.mathpack.mul),I,t);return null==r?e.mathpack.zero:r}function H(e,t,r,n,a,o){var u=N(a,F(a.mathpack.add),e,o,t);if(null==u)return n;if(r&&(u=M(a,o,u)),Object(c.E)(u))return u;var s={count:0},l=N(a,w(s),e,o,t);Object(i.h)("calc.funcs.averageCoerceInner",Object(c.M)(u)&&(null==l?void 0:l.kind)===y.b.Number&&s.count>0);var d=a.mathpack.div(u,a.mathpack.fromNumber(s.count));return Object(c.E)(d)?d:[d,s.count]}function W(e,t,r,n,a){var i=H(e,t,r,o.g,n,a);return Array.isArray(i)?i[0]:i}var z=W.bind(void 0,I,void 0,!1),q=W.bind(void 0,I,void 0,!0),K=W.bind(void 0,_,(function(e,t){var r=Object(c.T)(t)?t.getFallback():t;return Object(c.ab)(r)?e.mathpack.zero:I(0,r)}),!0);function Y(e,t){var r=t[0],n=t[1],a=B(e,r,t[2]);if(!Object(T.d)(a))return a.reason;var i=a.value,o=i.values,c=i.valuesToFilter,s=[Object(u.d)([E(e,o.arrays[0],n,c.arrays[0]).strict()])];return z(e,s)}function J(e,t,r,n,a){for(var u=void 0,s=0,l="",d=function(e,t){return e.coerceOper(t,y.b.String)},f=function(e,n,a){if(void 0!==e&&Object(c.E)(e))return e;for(var d=0;d<a;d+=1){if(void 0!==u&&t.length>0&&(!r||u.value.length>0)){var f=t[s];if(s=(s+1)%t.length,l.length+f.value.length>o.f)return o.w;l+=f.value}if(Object(c.E)(n))return n;if(Object(i.h)("calc.funcs.concatInner: expected string in reducer",Object(c.ab)(n)),l.length+n.value.length>o.f)return o.w;if(l+=n.value,u=n,""===n.value&&(0===t.length||r))break}return n},b=0;b<a.length;b+=1){var h=n[b];if(Object(c.R)(h)&&h.ranges.length>1)return o.w;var v=N(e,f,d,a.slice(b,b+1));if(void 0!==v&&Object(c.E)(v))return v;Object(i.h)("calc.funcs.concatInner: expected string from reduce",void 0!==v&&Object(c.ab)(v))}if(r&&void 0!==u&&""===u.value&&t.length>0&&l.length>0){var p=t[(s+t.length-1)%t.length];l=l.substring(0,l.length-p.value.length)}return Object(o.u)(l)}function Q(e,t,r){var n={count:0};return N(t,w(n),e,r),t.mathpack.fromNumber(n.count)}var X=Q.bind(void 0,(function(e,t){var r=Object(c.T)(t)?t.getFallback():t;return Object(c.M)(r)?r:void 0}));var Z=Q.bind(void 0,(function(e,t){var r=Object(c.T)(t)?t.getFallback():t;return Object(c.y)(r)||Object(j.h)(r)?r:void 0}));var $=Q.bind(void 0,(function(e,t){var r=Object(c.T)(t)?t.getFallback():t;return Object(c.O)(r)||Object(c.E)(r)?r:void 0}));var ee=Q.bind(void 0,(function(e,t){return t}));function te(e,t){var r=t[0],n=t[1];if(L(r))return o.w;var a=e.dereferenceAllOpers([r])[0],i=[Object(u.d)([E(e,a.arrays[0],n)])];return ee(e,i)}var re=function(e,t,r){return e.mathpack.cond2(t,r)>0},ne=function(e,t,r){return e.mathpack.cond2(t,r)<0};function ae(e,t,r,n,a){var o=N(n,(function(t,r,a){return void 0===t?r:Object(c.E)(t)?t:(Object(i.h)("calc.funcs.minMaxCoerceInner",Object(c.M)(t)),Object(c.E)(r)?r:(Object(i.h)("calc.funcs.minMaxCoerceInner",Object(c.M)(r)),e(n,t,r)?t:r))}),t,a,r);return null==o?n.mathpack.zero:o}var ie=ae.bind(void 0,re,I,void 0),oe=ae.bind(void 0,ne,I,void 0),ce=ae.bind(void 0,re,_,I),ue=ae.bind(void 0,ne,_,I);function se(e,t){var r=Object(c.T)(t)?t.getFallback():t;switch(r.kind){case y.b.Boolean:return r;case y.b.Number:return Object(o.e)(0!==e.mathpack.cond(r));case y.b.String:return;case y.b.Error:return r;case y.b.Missing:case y.b.Blank:return;default:return Object(i.e)("calc.funcs.aggregationFuncs: booleanOperationCoerce",r)}}function le(e,t,r){var n=N(t,(function(t,r,n){return void 0!==t&&Object(c.E)(t)?t:Object(c.E)(r)?r:(Object(i.h)("calc.funcs.booleanInner",(void 0===t||Object(c.z)(t))&&Object(c.z)(r)),Object(o.e)(e(null==t?void 0:t.value,r.value,n)))}),se,r);return null==n?o.w:n}var de=le.bind(void 0,(function(e,t){return!1!==e&&t})),fe=le.bind(void 0,(function(e,t){return!0===e||t})),be=le.bind(void 0,(function(e,t,r){return t?((!0===e?1:0)+r)%2==1:!0===e}));function he(e,t){return function(r,n,a){if(void 0!==r&&Object(c.E)(r))return r;if(!Object(c.E)(n))for(var i=t(n),o=0;o<a;o+=1)e.push(i);return n}}function ve(e,t,r,n){var a=[],i=N(t,he(a,j.a),I,[r]);if(null==i)return o.p;if(Object(c.E)(i))return i;var u=t.mathpack;if(u.cond2(n,u.one)<0)return o.p;if(u.cond2(n,u.fromNumber(a.length))>0)return o.p;var s=a.sort(u.cond2);if(e){var l=Object(j.a)(u.add(Object(j.a)(u.sub(u.fromNumber(a.length),n)),u.one));return s[u.lfix(l)-1]}return s[u.lfix(n)-1]}var pe=ve.bind(void 0,!0),me=ve.bind(void 0,!1);function ge(e,t,r,n){var a=e.mathpack,i=[],u=N(e,he(i,j.a),I,t);if(null==u)return o.p;if(Object(c.E)(u))return u;if(Object(c.E)(r))return r;if(a.cond(r)<0)return o.p;if(a.cond2(r,a.one)>0)return o.p;var s=i.sort(a.cond2),l=Object(j.a)(a.sub(a.fromNumber(s.length),a.one)),d=Object(j.a)(a.add(a.fromNumber(s.length),a.one)),f=n?Object(j.a)(a.mul(l,r)):Object(j.a)(a.sub(Object(j.a)(a.mul(d,r)),a.one));if(a.cond(f)<0||a.cond2(f,l)>0)return o.p;var b=a.lfix(f),h=Object(j.a)(a.sub(f,a.fromNumber(b)));if(0===a.cond(h))return s[b];var v=a.sub(s[b+1],s[b]);return Object(c.E)(v)?v:a.add(s[b],Object(j.a)(a.mul(v,h)))}var Oe=function(e,t,r){return ge(e,[t],r,!0)};function je(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return Oe(e,n,a)}var ye=function(e,t,r){return ge(e,[t],r,!1)};function Se(e,t){var r=e.mathpack;if(r.cond(t)<0)return o.p;if(r.cond2(t,r.fromNumber(5))>=0)return o.p;var n=r.lfix(t);return r.div(r.fromNumber(n),r.fromNumber(4))}var Ce=function(e,t,r){return ge(e,[t],Se(e,r),!0)};function ke(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return Ce(e,n,a)}var Ee=function(e,t,r){return ge(e,[t],Se(e,r),!1)};function Ae(e,t){return ge(e,t,e.mathpack.fromNumber(.5),!0)}function Ne(e){return function(t,r){var n=e(t,r);return void 0!==n&&Object(c.M)(n)?t.mathpack.mul(n,n):n}}function Te(e,t){return function(r,n){var a=e(r,n);if((null==a?void 0:a.kind)!==y.b.Number)return a;var i=r.mathpack,o=i.sub(a,t);return Object(c.E)(o)?o:i.mul(o,o)}}function Re(e,t,r,n){var a={count:0};if(null==N(r,w(a),e,n,t))return o.g;Object(i.h)("calc.funcs.varFirstPass: unexpected count type",a.count>=1);var u=F(r.mathpack.add),s=N(r,u,e,n,t),l=N(r,u,Ne(e),n,void 0===t?void 0:Ne(t));if(Object(i.h)("calc.funcs.varFirstPass: expected sum",null!=s),Object(i.h)("calc.funcs.varFirstPass: expected sumSq",null!=l),Object(c.E)(s))return s;if(Object(c.E)(l))return l;Object(i.h)("calc.funcs.varFirstPass: unexpected oper type",Object(c.M)(s)&&Object(c.M)(l));var d=r.mathpack,f=d.div(s,d.fromNumber(a.count));return Object(c.E)(f)?f:[a.count,s,l,f]}function Ie(e,t,r,n,a){var o=N(r,F(r.mathpack.add),Te(e,a),n,void 0===t?void 0:Te(t,a));return Object(i.h)("calc.funcs.varSecondPass: unexpected error",(null==o?void 0:o.kind)===y.b.Number),o}function _e(e,t,r,n){var a=Re(e,t,r,n);if(!Array.isArray(a))return a;var i=r.mathpack,u=a[0],s=a[1],l=a[2],d=a[3];if(u<2)return o.g;var f=i.mul(s,s);if(Object(c.E)(f))return f;var b=Object(j.a)(i.div(f,i.fromNumber(u))),h=Object(j.a)(i.sub(l,b));if(0===i.cond(d))return i.cond(h)<0?i.zero:i.div(h,i.fromNumber(u-1));if(i.cond(h)>=0){var v=Object(j.a)(i.div(h,i.fromNumber(u-1)));if(i.cond2(v,i.fromNumber(21219957905e-324))>0){var p=i.div(b,l),m=Object(c.E)(p)?p:i.sub(p,i.one);if(!Object(c.E)(m)&&i.cond2(i.abs(m),i.fromNumber(.01))>0){var g=i.div(d,v),O=Object(c.E)(g)?g:i.sub(i.abs(g),i.fromNumber(1e3));if(!Object(c.E)(O)&&i.cond(O)<0)return v}}}var y=Ie(e,t,r,n,d);return i.cond(y)<0?i.zero:i.div(y,i.fromNumber(u-1))}function Fe(e,t,r,n){var a=Re(e,t,r,n);if(!Array.isArray(a))return a;var i=r.mathpack,u=a[0],s=a[1],l=a[2],d=a[3];if(u<1)return o.g;var f=i.mul(s,s);if(Object(c.E)(f))return f;var b=i.mul(l,i.fromNumber(u));if(Object(c.E)(b))return b;var h=Object(j.a)(i.sub(b,f));if(0===i.cond(d))return i.cond(h)<0?i.zero:i.div(h,i.fromNumber(u*u));if(i.cond(h)>=0){var v=Object(j.a)(i.div(h,i.fromNumber(u*u)));if(i.cond2(v,i.fromNumber(21219957905e-324))>0){var p=i.div(Object(j.a)(i.div(f,i.fromNumber(u))),l),m=Object(c.E)(p)?p:i.sub(p,i.one);if(!Object(c.E)(m)&&i.cond2(i.abs(m),i.fromNumber(.01))>0){var g=i.div(d,v),O=Object(c.E)(g)?g:i.sub(i.abs(g),i.fromNumber(1e3));if(!Object(c.E)(O)&&i.cond(O)<0)return v}}}var y=Ie(e,t,r,n,d);return i.cond(y)<0?i.zero:i.div(y,i.fromNumber(u))}var we=_e.bind(void 0,I,void 0),Me=Fe.bind(void 0,I,void 0),De=_e.bind(void 0,_,I),Pe=Fe.bind(void 0,_,I);function xe(e){return function(t,r){var n=e(t,r);return Object(c.M)(n)?t.mathpack.sqrt(n):n}}var Le=xe(we),Be=xe(Me),Ue=xe(De),Ge=xe(Pe);function Ve(e,t){var r=e.dereferenceAllOpers(t);return Le(e,r)}function He(e,t){var r=e.dereferenceAllOpers(t);return Be(e,r)}function We(e,t){var r=e.dereferenceAllOpers(t);return we(e,r)}function ze(e,t){var r=e.dereferenceAllOpers(t);return Me(e,r)}var qe=[q,X,$,ie,oe,V,Le,Be,x,we,Me];function Ke(e,t){var r,n=[],a=N(e,(r=n,function(e,t,n){if(void 0!==e&&Object(c.E)(e))return e;if(Object(c.M)(t))for(var a=0;a<n;a+=1)r.push({value:t,index:r.length});return t}),I,t);if(null==a)return o.m;if(Object(c.E)(a))return a;var u=e.mathpack,s=n.sort((function(e,t){return u.cond2(e.value,t.value)})),l=1,d=0,f=1/0,b=[];function h(e){l=1,f=e.index}var v,p,m,g=function(e){var t=e.value;l>d?(d=l,b.length=0,b.push({value:t,index:f})):l===d&&b.push({value:t,index:f})};h(s[0]);for(var O=1;O<s.length;O+=1)p=s[O-1],m=s[O],0===u.cond2(p.value,m.value)?((v=s[O]).index<f&&(f=v.index),l+=1):(g(s[O-1]),h(s[O]));return g(s[s.length-1]),d<2?o.m:(Object(i.h)("calc.funcs.modeInner: unexpected error",0!==b.length),b.sort((function(e,t){return e.index-t.index})))}function Ye(e,t){var r=Ke(e,t);return Array.isArray(r)?r[0].value:r}function Je(e,t){return Ye(e,t)}var Qe=Object(R.h)(Object(a.__assign)(Object(a.__assign)({},Object(R.j)(!1)),{wsfNode:function(e){return e===l.b.SUBTOTAL||e===l.b.AGGREGATE}}),(function(e,t){return e||t}));function Xe(e){if(!Object(u.b)(e))return e;var t=e.arrays.map((function(e){return e.map((function(e){var t,r=e[0],n=e[1];return void 0!==n&&(t=n.formula,Object(R.m)(Qe,t))?void 0:r}))}));return Object(u.d)(t)}var Ze=Object(a.__spreadArray)(Object(a.__spreadArray)([],qe,!0),[Ae,Ye],!1),$e=[pe,me,Oe,Ce,ye,Ee];function et(e,t){return tt(e,t,!1)}function tt(e,t,r){var n=t[0],a=t[1],i=t[2],u=(void 0===i?o.i:i).value?1:-1,s=0,l=0,d=e.mathpack,f=N(e,(function(e,t,r){if(void 0!==e)return e;if(Object(c.E)(t))return t;var a=d.cond2(n,Object(j.a)(t));0===a?s+=r:a===u&&(l+=r)}),I,e.dereferenceAllOpers([a]));if(void 0!==f)return f;if(0===s)return o.m;var b=d.fromNumber(l+1);if(r){var h=d.div(d.fromNumber(s-1),d.fromNumber(2));return d.add(b,Object(j.a)(h))}return b}function rt(e){return function(t,r){var n=e(t,r);return(null==n?void 0:n.kind)===y.b.Number?t.mathpack.abs(n):n}}function nt(e,t,r){var n=H(I,void 0,!0,o.p,t,r);if(!Array.isArray(n))return n;var a=n[0],u=n[1],s=N(t,F(t.mathpack.add),e(function(e,t){return function(r,n){var a=e(r,n);return(null==a?void 0:a.kind)===y.b.Number?r.mathpack.sub(a,t):a}}(I,a)),r);return Object(i.h)("calc.funcs.sumDevAndCount",void 0!==s),Object(c.E)(s)?s:[Object(j.a)(s),u]}var at=r(36);function it(e,t,r){var n=r[0],a=t.datepack,i=t.config,c=a.fromNum(i,n,at.a.RoundSec);return!1===c?o.p:t.mathpack.fromNumber(e(c))}var ot=it.bind(void 0,(function(e){return e.yr})),ct=it.bind(void 0,(function(e){return e.mon})),ut=it.bind(void 0,(function(e){return e.dom})),st=it.bind(void 0,(function(e){return e.hour})),lt=it.bind(void 0,(function(e){return e.min})),dt=it.bind(void 0,(function(e){return e.sec}));function ft(e,t,r){var n=t[0],i=t[1];void 0===r&&(r=!1);var c,u=e.config,s=e.mathpack,l=e.datepack.fromNum(Object(a.__assign)(Object(a.__assign)({},u),{date1904:u.date1904&&!r}),n,at.a.RoundSec);if(!1===l)return o.p;switch(void 0!==i?s.sfix(i):1){case 1:case 17:c=l.wdy;break;case 2:case 11:c=1===l.wdy?7:l.wdy-1;break;case 3:c=1===l.wdy?6:l.wdy-2;break;case 12:c=(l.wdy+4)%7+1;break;case 13:c=(l.wdy+3)%7+1;break;case 14:c=(l.wdy+2)%7+1;break;case 15:c=(l.wdy+1)%7+1;break;case 16:c=l.wdy%7+1;break;default:return o.p}return s.fromNumber(c)}function bt(e,t,r){if(!t){var n=e.lfix(r);if(0===n||1===n)return e.fromNumber(52)}return o.p}function ht(e,t,r){var n=r[0],u=r[1],s=Object(j.d)(t,n);if(Object(c.E)(s))return s;var l=function(e,t,r){if(void 0===t||Object(c.J)(t))return[r?2:1,r];var n=Object(j.f)(e,t);if(!Object(c.E)(n)){var a=e.mathpack.sfix(n);if(r){if(1===a||2===a)return[a,r]}else{if(1===a||2===a)return[a,r];if(a>=11&&a<=16)return[a-9,r];if(17===a)return[1,r];if(21===a)return[2,!0]}}return[void 0,r]}(t,u,e),d=l[0],f=l[1];if(void 0===d)return o.p;var b=t.mathpack,h=t.datepack,v=t.config,p=Object(a.__assign)(Object(a.__assign)({},v),{date1904:!1}),m=h.fromNum(p,s,at.a.RoundSec);if(!1===m)return bt(b,p.dateCompatibility,s);var g=Object(at.d)(m.yr,1,1,0,0,0,0,0,at.a.RoundSec),O=h.toNum(p,g);if(Object(c.E)(O))return bt(b,p.dateCompatibility,s);var y=ft(t,[O],!0);if(Object(c.E)(y))return y;var S=Object(j.a)(b.add(Object(j.a)(b.sub(y,b.fromNumber(d))),b.fromNumber(7))),C=Object(j.a)(Object(j.i)(b,S,b.fromNumber(7))),k=Object(j.a)(b.add(b.floor(Object(j.a)(b.div(Object(j.a)(b.add(Object(j.a)(b.sub(s,O)),C)),b.fromNumber(7)))),b.one));return f?function(e,t,r,n){var o=e.mathpack,c=e.datepack,u=e.config,s=Object(a.__assign)({},n),l=(t+6-s.wdy)%7;if(12===s.mon&&s.dom+l>=35)return o.one;s.dom=4,s.mon=1;var d=c.toDays(u,s);if(Object(i.h)("calc.funcs.weeknumISOAmendments",!1!==d),((d=(d-1)%7+1)-t+7)%7<3){var f=Object(j.a)(o.sub(r,o.one));if(0===o.cond(f)){var b=s.yr-1;return t===d||b%4==0&&(b%100!=0||b%400==0)&&(t-d+7)%7==6?o.fromNumber(53):o.fromNumber(52)}return f}return r}(t,d,k,m):k}var vt=ht.bind(void 0,!0),pt=ht.bind(void 0,!1);var mt;function gt(e,t){var r;if(Object(c.ab)(t)){var n=t.value.replace(/^\s+/,"");if(r=e.coerceOper(Object(o.u)(n),y.b.Number),Object(c.E)(r))return r}else r=t;return Object(j.d)(e,r)}function Ot(e,t,r){return r?Object(j.a)(e.sub(t,e.fromNumber(j.c))):t}function jt(e,t){return 0!=(e>>t%7&1)}function yt(e){switch(e){case 1:return mt.Saturday|mt.Sunday;case 2:return mt.Sunday|mt.Monday;case 3:return mt.Monday|mt.Tuesday;case 4:return mt.Tuesday|mt.Wednesday;case 5:return mt.Wednesday|mt.Thursday;case 6:return mt.Thursday|mt.Friday;case 7:return mt.Friday|mt.Saturday;case 11:return mt.Sunday;case 12:return mt.Monday;case 13:return mt.Tuesday;case 14:return mt.Wednesday;case 15:return mt.Thursday;case 16:return mt.Friday;case 17:return mt.Saturday;default:return!1}}function St(e){if(7!==e.length)return!1;for(var t=mt.None,r=0;r<e.length;r+=1)if("1"===e[r])t|=1<<(r+2)%7;else if("0"!==e[r])return!1;return t}function Ct(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],u=mt.Saturday|mt.Sunday,s=Object(j.d)(e,r);if(Object(c.E)(s))return s;var l=Object(j.f)(e,n);if(Object(c.E)(l))return l;var d=e.mathpack,f=e.config;l=d.floor(l);var b=d.cond(l)>0?d.one:d.fromNumber(-1),h=d.abs(l),v=Object(j.a)(d.add(s,l));if(!Object(j.j)(e,v))return o.p;if(0===d.cond(h))return Ot(d,s,f.date1904);var p=null,m=[];if(a){if(!Object(c.J)(a)){if(Object(c.M)(a)){var g=yt(d.lfix(a));if(!1===g)return o.p;u=g}else{if(!Object(c.ab)(a))return o.p;var O=St(a.value);if(!1===O)return o.w;u=O}if(127===u)return o.w}if(i&&!Object(c.J)(i)){var S=Object(j.e)(e,i);if(!Object(T.d)(S))return S.reason;p=S.value}}for(var C=null==p?[]:function(e){for(var t=[],r=e.getSparse(),n=e.cols-e.denseCols,a=0;a<e.denseRows;a+=1){for(var i=0;i<e.denseCols;i+=1){var o=e.get(a,i);void 0!==o&&t.push(o)}if(n>0&&void 0!==r)for(var c=0;c<n;c+=1)t.push(r)}var u=(e.rows-e.denseRows)*e.cols;if(u>0&&void 0!==r)for(a=0;a<u;a+=1)t.push(r);return t}(p),k=C.length-1;k>=0;k-=1){var E=C[k];switch(E.kind){case y.b.Number:case y.b.String:case y.b.Blank:var A=Object(j.d)(e,E);if(Object(c.E)(A))return A;m[k]=A;break;case y.b.Error:return E;default:return o.w}}for(;d.cond(h)>0;){if(s=Object(j.a)(d.add(s,b)),!jt(u,d.lfix(s))){var N=!0;for(k=0;k<C.length;k+=1)if(0===d.cond2(m[k],s)){N=!1;break}N&&(h=Object(j.a)(d.sub(h,d.one)))}}return s=Ot(d,s,f.date1904),Object(j.j)(e,s)?s:o.p}!function(e){e[e.None=0]="None",e[e.Saturday=1]="Saturday",e[e.Sunday=2]="Sunday",e[e.Monday=4]="Monday",e[e.Tuesday=8]="Tuesday",e[e.Wednesday=16]="Wednesday",e[e.Thursday=32]="Thursday",e[e.Friday=64]="Friday"}(mt||(mt={}));function kt(e,t,r,n){var i=e.mathpack,o=e.datepack,u=e.config,s=Object(a.__assign)(Object(a.__assign)({},u),{date1904:!1}),l=o.fromNum(s,t,at.a.RoundSec);if(!1===l)return l;var d=i.fromNumber(l.dom),f=i.fromNumber(l.mon),b=i.fromNumber(12),h=i.fromNumber(l.yr);if(i.cond(r)>=0){h=Object(j.a)(i.add(i.floor(Object(j.a)(i.div(r,b))),h));var v=Object(j.a)(Object(j.i)(i,r,b)),p=Object(j.a)(i.add(v,f));1===i.cond2(p,b)&&(h=Object(j.a)(i.add(h,i.one))),f=Object(j.a)(Object(j.i)(i,p,b))}else{var m=i.neg(r),g=i.floor(Object(j.a)(i.div(m,b)));h=Object(j.a)(i.sub(h,g));v=Object(j.a)(Object(j.i)(i,m,b));if(i.cond2(v,f)>=0)h=Object(j.a)(i.sub(h,i.one)),f=Object(j.a)(i.add(Object(j.a)(i.sub(f,v)),b));else{var O=Object(j.a)(i.sub(f,v));f=Object(j.a)(Object(j.i)(i,O,b))}}0===i.cond(f)&&(f=b);var y=i.lfix(f);switch(y){case 4:case 6:case 9:case 11:var S=i.fromNumber(30);i.cond2(d,S)>0&&(d=S);break;case 2:i.cond2(d,i.fromNumber(28))>0&&(d=i.fromNumber(o.daysPerMonth(2,i.toNumber(h),!1)))}if(n&&(d=i.fromNumber(o.daysPerMonth(y,i.toNumber(h),!1))),i.lfix(h)<(s.dateCompatibility?1900:-9999))return!1;var C=function(e,t,r,n,a,i){var o=e.lfix(n),c=e.lfix(a),u=e.lfix(i);return t.toNum(r,Object(at.d)(u,c,o,0,0,0,0,0,at.a.RoundSec))}(i,o,s,d,f,h);return!Object(c.E)(C)&&C}function Et(e,t,r){var n=r[0],a=r[1],i=Object(j.d)(t,n);if(Object(c.E)(i))return i;var u=Object(j.f)(t,a);if(Object(c.E)(u))return u;var s=t.mathpack,l=t.config,d=kt(t,i,u=s.cond(u)>0?s.floor(u):s.ceil(u),!e);return!1===d?o.p:Ot(s,d,l.date1904)}var At,Nt=Et.bind(void 0,!0),Tt=Et.bind(void 0,!1);function Rt(e,t){var r,n=t[0],a=t[1],i=t[2],u=t[3],s=e.mathpack,l=mt.Saturday|mt.Sunday,d=5;function f(e){d=7;for(var t=l=e;0!==t;)1==(1&t)&&(d-=1),t>>=1}if(void 0!==i&&!Object(c.J)(i))if(Object(c.ab)(i)){var b=St(i.value);if(!1===b)return o.w;f(b)}else{var h=Object(j.f)(e,i);if(Object(c.E)(h))return o.w;var v=yt(s.lfix(h));if(!1===v)return o.p;f(v)}var p=null!=u?u:o.l,m=Object(j.d)(e,n);if(Object(c.E)(m))return m;var g=Object(j.d)(e,a);if(Object(c.E)(g))return g;var O,S=s.lfix(m),C=s.lfix(g);S>C?(O=S,S=C,C=O,r=-1):r=1,O=S%7,O=C%7;for(var k=0,E=S<C?S:C,A=S<C?C:S;E%7!=0&&E!==A;)jt(l,E)||(k+=1),E+=1;for(;A%7!=6&&E!==A;)jt(l,A)||(k+=1),A-=1;if(A===E&&1!=(l>>E%7&1)&&(k+=1),S>C){var N=E;E=A,A=N}var T=s.fromNumber(d*Math.floor((A+1-E)/7)+k);switch(p.kind){case y.b.Number:case y.b.String:var R=Object(j.d)(e,p);if(Object(c.E)(R))return R;(O=s.lfix(R))>=S&&O<=C&&O%7>=2&&(T=Object(j.a)(s.sub(T,s.one)));break;case y.b.Range:case y.b.Array:var I=function(e,t,r,n,a,i){var u,s=e.mathpack;if(void 0===i||Object(c.J)(i))u=mt.Saturday|mt.Sunday;else if(Object(c.ab)(i)){var l=St(i.value);if(!1===l)return o.w;u=l}else{var d=Object(j.f)(e,i);if(Object(c.E)(d))return o.w;var f=yt(s.lfix(d));if(!1===f)return o.p;u=f}var b=s.fromNumber(r),h=s.fromNumber(n),v=e.dereferenceOper(a,y.b.Array);if(!Object(c.x)(v))return o.w;var p=[];function m(e){if(s.cond2(e,b)>=0&&s.cond2(e,h)<=0){var t=s.lfix(e);jt(u,t)||p.push(e)}}for(var g=0;g<v.rows;g+=1)for(var O=0;O<v.cols;O+=1){var S=v.opers[g][O];switch(S.kind){case y.b.Number:case y.b.String:var C=Object(j.d)(e,S);if(Object(c.E)(C))return C;m(C);break;case y.b.Blank:break;case y.b.Error:return S;default:return o.w}}var k=t;if(0!==p.length){var E=p.sort((function(e,t){return s.cond2(e,t)})),A=E[0];k=Object(j.a)(s.sub(k,s.one));for(g=0;g<E.length;g+=1){var N=E[g];0!==s.cond2(N,A)&&(A=N,k=Object(j.a)(s.sub(k,s.one)))}}return k}(e,T,S,C,p,i);if(Object(c.E)(I))return I;T=I;break;case y.b.Error:return p;case y.b.Missing:break;default:return o.w}return s.mul(s.fromNumber(r),T)}function It(e,t,r,n,a,i,o){var c=360*(r-t),u=30*(a-n);return e.mathpack.fromNumber(o-i+u+c)}function _t(e,t,r,n){var a=e.datepack,i=e.config;return t===a.daysPerMonth(r,n,i.dateCompatibility)}function Ft(e,t,r,n,a){var i=e.mathpack;switch(i.cond2(t,r)){case 1:break;case 0:return i.zero;case-1:switch(n){case At.Basis30360:return function(e,t,r,n,a){var i=e.datepack,o=e.config,c=i.fromNum(o,t,at.a.RoundSec);if(!1===c)return!1;var u=c.dom,s=c.mon,l=c.yr,d=i.fromNum(o,r,at.a.RoundSec);if(!1===d)return!1;var f=d.dom,b=d.mon,h=d.yr;return 2===f&&_t(e,f,b,h)&&(2===u&&_t(e,u,s,l)||3===n)&&(f=30),31===f&&(u>=30||3===n)&&(f=30),31===u&&(u=30),a&&2===s&&_t(e,u,s,l)&&(u=30),It(e,l,h,s,b,u,f)}(e,t,r,a,!0);case At.BasisActual360:case At.BasisActual365:case At.BasisActual:return Object(j.a)(i.sub(r,t));case At.BasisE30360:return function(e,t,r){var n=e.datepack,a=e.config,i=n.fromNum(a,t,at.a.RoundSec);if(!1===i)return!1;var o=i.dom,c=i.mon,u=i.yr,s=n.fromNum(a,r,at.a.RoundSec);if(!1===s)return!1;var l=s.dom,d=s.mon;return 31===o&&(o=30),31===l&&(l=30),It(e,u,s.yr,c,d,o,l)}(e,t,r)}}return!1}function wt(e,t){var r=t[0],n=t[1],a=void 0===n||Object(c.J)(n)?e.mathpack.zero:Object(j.f)(e,n);if(Object(c.E)(a))return a;var i=Object(j.f)(e,r);return Object(c.E)(i)?i:[i,a]}!function(e){e[e.DefaultBasis=0]="DefaultBasis",e[e.Basis30360=0]="Basis30360",e[e.BasisActual=1]="BasisActual",e[e.BasisActual360=2]="BasisActual360",e[e.BasisActual365=3]="BasisActual365",e[e.BasisE30360=4]="BasisE30360"}(At||(At={}));var Mt=r(44);function Dt(e,t){if(Object(c.R)(t)){if(Object(c.Y)(t.sheets)){var r=Object(o.s)(t.sheets,[Object(c.n)(t.ranges[0])]);return e.dereferenceOper(r,Mt.d)}return o.w}return t}var Pt=r(77),xt=r(53),Lt=r(34);function Bt(e,t,r){var n=Object(Mt.e)(e,t,!0);return n instanceof Pt.a?void 0===r||r>=n.minArity&&r<=n.maxArity?n:o.m:Object(c.E)(n)?n:o.t}function Ut(e,t){var r=t[0],n=t.slice(1),a=Bt(e,r,n.length);return Object(c.E)(a)?a:e.applyLambda(a,n)}function Gt(e,t){var r=t[0],n=t[1],a=t[2],i=Bt(e,a,2);if(Object(c.E)(i))return i;var u=e.mathpack,s=Object(c.J)(r)?1:u.fix(r),l=Object(c.J)(n)?1:u.fix(n);if(s<1||l<1)return o.w;if(s*l>1e6)return Object(Lt.i)(Object(c.hb)(["MAKEARRAY with very large size"]));var d=[o.i,o.i];return Object(xt.machineCall)(new xt.ArrayMachine(e,s,l,(function(t,r){return Object(xt.machineCall)(new xt.ThenMachine(e,(function(){var n=e.mathpack;return d[0]=n.fromNumber(t+1),d[1]=n.fromNumber(r+1),e.applyLambda(i,d)}),(function(e){return Object(c.R)(e)?Object(Lt.i)(Object(c.hb)(["MAKEARRAY with nested RangeOper"])):Object(c.x)(e)?Object(Lt.i)(Object(c.hb)(["MAKEARRAY with nested ArrayOper"])):e})))})))}function Vt(e,t){var r=Object(Mt.e)(e,t[0],!0);return r instanceof Pt.a?e.mathpack.fromNumber(r.maxArity):o.m}var Ht=Object(Mt.c)(Object(l.e)(l.b.IFS)),Wt=Object(Mt.c)(Object(l.e)(l.b.SWITCH));function zt(e,t,r,n){var a=n.slice();return e.dereferenceOpers(a,t),Object(Mt.a)(e,t,(function(n){for(var a=[],i=0;i<n.length;i+=1){var o=Object(c.f)(t,i,n.length);a[i]=e.coerceOper(n[i],o)}return r(e,a)}),a)}var qt=function(e){return e<0?l.a.Lt:e>0?l.a.Gt:l.a.Eq};function Kt(e,t,r){void 0===r&&(r=!1);var n,a=e.config,o=a.localeInfo,u=a.mathpack;switch(t.kind){case y.b.Number:n=function(e){return{correctType:!0,sgnT:(r=u,n=e,a=t,qt(r.cond2(n,a)))};var r,n,a};break;case y.b.String:if(r){var s=new O(o,t.value);n=function(e){return{correctType:!0,sgnT:s.test(e.value)?l.a.Eq:l.a.Ne}}}else n=function(e){return{correctType:!0,sgnT:qt(o.stringCompareCI(e.value,t.value))}};break;case y.b.Boolean:n=function(e){return{correctType:!0,sgnT:(r=e.value,n=t.value,qt(r-n))};var r,n};break;case y.b.Rich:return Object(Lt.i)(Object(c.hb)(["lookup with rich value condition"]));default:return Object(i.e)("calc.funcs.makeLookupComparer",t)}return function(e){var r=Object(c.T)(e)?e.getFallback():e;return t.kind!==r.kind?{correctType:!1,sgnT:l.a.Ne}:n(r)}}function Yt(e,t,r){for(var n=!1,a=r.length-1,i=Math.floor((0+a)/2),o=0,c=a,u=Kt(e,t);;){var s=u(r.get(i)).sgnT;if(s===l.a.Ne){if(i<c)for(var d=i+1;d<=c;d+=1)if((s=u(r.get(d)).sgnT)!==l.a.Ne){i=d;break}s===l.a.Ne&&(i=Math.floor((o+c)/2),s=l.a.Gt)}if(s===l.a.Eq){if(i<a){n=!0,o=i+=1,c=i;continue}return i}if(s===l.a.Lt?o=i+1:c=i-1,!(o<=c)){if(n)i-=1;else if(s===l.a.Gt&&(i-=1)>=0){o=i,c=i;continue}return i}i=Math.floor((o+c)/2)}}function Jt(e,t,r,n){for(var a=-1,i=Kt(e,t,n===l.a.Eq),o=0;o<r.length;o+=1){var c=i(r.get(o)),u=c.correctType,s=c.sgnT;if(u){if(s===l.a.Eq)return o;if(s!==l.a.Ne&&s===n)return a;a=o}o===r.denseLength&&(o=Object(f.b)(o,r.length-2))}return n!==l.a.Eq?a:r.length}function Qt(e){switch(e.kind){case y.b.Number:return o.m;case y.b.Range:return Object(c.Y)(e.sheets)?e.ranges.length>1?o.m:e:o.w;case y.b.Array:return e}}function Xt(e,t){var r;switch(t.kind){case y.b.Number:return t;case u.a.RangeValues:r=t.arrays[0].get(0,0);break;case y.b.Array:r=t.opers[0][0];break;default:return Object(i.e)("calc.funcs.lookupFuncs.getNumFromRef",t)}return r=e.coerceOper(r,y.b.Number),Object(c.E)(r)?o.t:r}function Zt(e){switch(e.kind){case y.b.Number:case y.b.Rich:return o.m;case y.b.Range:if(!Object(c.Y)(e.sheets))return o.w;if(e.ranges.length>1)return o.m;var t=e.ranges[0];return 1!==t.rows&&1!==t.cols?o.m:e;case y.b.Array:return 1!==e.rows&&1!==e.cols?o.m:e}}function $t(e){switch(e.kind){case u.a.RangeValues:return e.arrays[0];case y.b.Array:return new d.c(e.rows,e.cols,e.rows,e.cols,e.opers,o.d)}}function er(e,t){switch(t.kind){case y.b.Range:var r=t.sheets,n=t.ranges[0];return new d.a(n.rows,n.cols,n.rows,n.cols,(function(t,a){var i=Object(s.f)(n.row+t,n.col+a);return e.dereferenceAllOpers([Object(o.s)(r,[i])])[0].arrays[0].get(0,0)}),(function(){return Object(i.a)("calc.funcs.lookupFuncs: rangeOrArrayOperToLazyArray2D")}));case y.b.Array:return new d.c(t.rows,t.cols,t.rows,t.cols,t.opers,o.d)}}function tr(e){if(Object(c.R)(e)){var t=e.ranges[0];return t.cols>t.rows}return e.cols>e.rows}function rr(e,t,r){var n=t[0],a=t[1],i=t[2],u=t[3],s=void 0===u?o.v:u,d=Qt(a);if(Object(c.E)(d))return d;var f=ar(d,r),b=nr($t(e.dereferenceAllOpers([f])[0]),r),h=!s.value?Jt(e,n,b,l.a.Eq):Yt(e,n,b);if(h<0||h>=b.length)return o.m;var v=function(e,t){switch(t.kind){case y.b.Number:return t;case y.b.Range:if(!Object(c.Y)(t.sheets))return o.w;if(t.ranges.length>1)return o.t;var r=t.ranges;return e.calcingArray?Object(Lt.i)(Object(c.hb)(["HLOOKUP/VLOOKUP ref argument 3 in array formula"])):r[0].rows>1||r[0].cols>1?Object(Lt.i)(Object(c.hb)(["HLOOKUP/VLOOKUP non-singleton ref argument 3"])):t;case y.b.Array:return Object(Lt.i)(Object(c.hb)(["HLOOKUP/VLOOKUP array argument 3"]))}}(e,i);if(Object(c.E)(v))return v;var p=e.dereferenceAllOpers([v])[0],m=Xt(e,p);if(Object(c.E)(m))return m;var g=e.mathpack.sfix(m)-1,O=er(e,d);return g<0?o.w:g>=(r?O.rows:O.cols)?o.t:r?O.get(g,h):O.get(h,g)}function nr(e,t){var r=e.getSparse.bind(e);return t?{length:e.cols,denseLength:e.denseCols,get:function(t){return e.get(0,t)},getSparse:r}:{length:e.rows,denseLength:e.denseRows,get:function(t){return e.get(t,0)},getSparse:r}}function ar(e,t){if(Object(c.R)(e)){var r=e.ranges[0],n=Object(s.g)(r.row,r.col,t?1:r.rows,t?r.cols:1);return Object(o.s)(e.sheets,[n])}return e}var ir=Object(j.k)((function(e){return e.mathpack.sqrt})),or=Object(j.k)((function(e){return e.mathpack.exp})),cr=Object(j.l)((function(e){return e.mathpack.power})),ur=Object(j.k)((function(e){return e.mathpack.ln})),sr=Object(j.k)((function(e){return e.mathpack.log}));var lr=Object(j.k)((function(e){return e.mathpack.sin})),dr=Object(j.k)((function(e){return e.mathpack.cos})),fr=Object(j.k)((function(e){return e.mathpack.tan})),br=Object(j.k)((function(e){return e.mathpack.asin})),hr=Object(j.k)((function(e){return e.mathpack.acos})),vr=Object(j.k)((function(e){return e.mathpack.atan})),pr=Object(j.l)((function(e){return e.mathpack.atan2}));var mr=Object(j.l)((function(e){return e.mathpack.round}));var gr=Object(j.l)((function(e){return e.mathpack.roundUp})),Or=Object(j.l)((function(e){return e.mathpack.roundDown}));function jr(e,t,r){var n=e.cond(t),a=e.cond(r);if(n>0&&a<0)return o.p;if(0===n||0===a)return e.zero;var i=e.div(t,r);return Object(c.E)(i)?i:e.mul(e.ceil(e.viewRound(i)),r)}function yr(e,t,r){var n=e.cond(t),a=e.cond(r);if(n>0&&a<0)return o.p;if(0===n&&0===a)return t;var i=e.div(t,r);return Object(c.E)(i)?i:e.mul(e.floor(e.viewRound(i)),r)}function Sr(e,t){var r=t[0],n=t[1];return jr(e.mathpack,r,n)}function Cr(e,t){var r=t[0],n=t[1],a=e.mathpack,i=void 0===n||Object(c.J)(n)?a.one:a.abs(n);return 0===a.cond(i)?a.zero:jr(a,r,i)}function kr(e,t,r){var n=r[0],a=t.mathpack;if(a.cond(n)>=0){var i=a.ceil(n);return 0===a.cond2(Object(j.a)(Object(j.i)(a,i,a.fromNumber(2))),a.one)===e?a.add(i,a.one):i}var o=a.floor(n);return 0===a.cond2(Object(j.a)(Object(j.i)(a,o,a.fromNumber(2))),a.one)===e?a.sub(o,a.one):o}var Er=kr.bind(void 0,!0),Ar=kr.bind(void 0,!1),Nr=Object(j.k)((function(e){return e.mathpack.abs}));var Tr=r(11),Rr=r(48),Ir=r(6),_r=h.D;function Fr(e,t,r,n){if(void 0===r||Object(c.J)(r))return{formatValue:t,formatDecimals:null!=n?n:2};var a=e.config.mathpack;if(a.cond(r)<0){var u=mr(e,[t,r]);return Object(i.h)("calc.funcs.fixedDollarRound",Object(c.M)(u)||Object(c.E)(u)),{formatValue:u,formatDecimals:0}}var s=a.sfix(r);return s<0||s>127?{formatValue:o.w,formatDecimals:0}:{formatValue:t,formatDecimals:s}}function wr(e){for(var t=0;t<e.length&&e.charCodeAt(t)===_r;)t+=1;return e.substring(t)}function Mr(e,t){var r;return Object(c.ab)(t)?t.value.length>255?o.w:null!==(r=e.parseDate(wr(t.value)))&&void 0!==r?r:o.w:o.w}function Dr(e,t){var r=Object(Mt.e)(e,t[0],!0);return Object(o.e)(r instanceof Pt.a)}function Pr(e,t){var r=t[0];return Object(o.e)(Object(c.J)(r))}function xr(e,t){var r=t[0],n=Object(j.f)(e,r);if(Object(c.E)(n))return n;var a=e.mathpack,i=Object(j.a)(a.add(a.abs(n),a.fromNumber(1.0000000000000003e-10))),u=Object(j.a)(a.div(a.floor(i),a.fromNumber(2)));return Object(o.e)(0===a.cond2(u,a.floor(u)))}function Lr(e,t,r){if(!Object(c.Y)(t.sheets))return o.w;var n=t.ranges[0];if(e.calcingArray||!Object(c.F)(n)){var a=t.sheets;return Object(o.c)(n.rows,n.cols,Object(d.i)(n.rows,n.cols,(function(t,i){var o=Object(s.p)(a,Object(s.f)(n.row+t,n.col+i));return r(e.getCellFormula(o),o)})))}var i=Object(c.ib)(Object(s.r)(t.sheets,n));return r(e.getCellFormula(i),i)}function Br(e,t){if(!t)return[e.reflectionGridCell,!e.calcingArray];if(!Object(c.Y)(t.sheets))return o.w;if(t.ranges.length>1)return o.t;var r=t.ranges[0];return[r,Object(c.F)(r)]}var Ur=r(54);function Gr(e,t){var r=t[0],n=t[1].value;if(Object(c.T)(r)){var a=r.getField(n);if(void 0!==a)return a}return o.j}function Vr(e,t){for(var r=t[0],n=e.config.localeInfo,a=Ur.a.create(n.stringCompareCI),i=1;i<t.length;i+=2){var o=t[i].value,c=t[i+1];a=a.setValue(o,c)}return new Pt.b(a,r)}var Hr=r(2),Wr=r(46),zr=r(18);var qr=h.D,Kr=h.d,Yr=h.e,Jr=h.A,Qr=h.C;function Xr(e,t){return void 0===t?1:e.cond(t)<0?o.w:e.sfix(t)}function Zr(e){return e>=Kr&&e<=Yr||e>=Jr&&e<=Qr}function $r(e,t,r){return""===e?e:function(e){for(var t=0;t<e.length;t+=1)if(e.charCodeAt(t)>=128)return!1;return!0}(e)?r():Object(Lt.i)(Object(c.hb)([t+" for non-ASCII input"]))}var en=r(30);r.d(t,"a",(function(){return nn}));var tn={};tn[l.b.SUM]=function(e,t){var r=e.dereferenceAllOpers(t);return x(e,r)},tn[l.b.PRODUCT]=function(e,t){var r=e.dereferenceAllOpers(t);return V(e,r)},tn[l.b.AVERAGE]=function(e,t){var r=e.dereferenceAllOpers(t);return q(e,r)},tn[l.b.COUNTBLANK]=function(e,t){var r=t[0];if(!Object(c.Y)(r.sheets)||1!==r.ranges.length)return o.w;var n=e.dereferenceAllOpers(t);return Z(e,n)},tn[l.b.MAX]=function(e,t){var r=e.dereferenceAllOpers(t);return ie(e,r)},tn[l.b.MIN]=function(e,t){var r=e.dereferenceAllOpers(t);return oe(e,r)},tn[l.b.AND]=function(e,t){var r=e.dereferenceAllOpers(t);return de(e,r)},tn[l.b.COUNTA]=function(e,t){var r=e.dereferenceAllOpers(t);return $(e,r)},tn[l.b.OR]=function(e,t){var r=e.dereferenceAllOpers(t);return fe(e,r)},tn[l.b.CONCAT]=function(e,t){var r=e.dereferenceAllOpers(t);return J(e,[],!0,t,r)},tn[l.b.AVERAGEIF]=Y,tn[l.b.AVERAGEIFS]=function(e,t){if(3===t.length)return Y(e,[t[1],t[2],t[0]]);var r=G(e,t,void 0,!0);return Object(T.d)(r)?z(e,[r.value]):r.reason},tn[l.b.COUNT]=function(e,t){var r=e.dereferenceAllOpers(t);return X(e,r)},tn[l.b.COUNTIF]=te,tn[l.b.COUNTIFS]=function(e,t){if(2===t.length)return te(e,t);var r=G(e,t,!0);return Object(T.d)(r)?ee(e,[r.value]):r.reason},tn[l.b.MEDIAN]=function(e,t){var r=e.dereferenceAllOpers(t);return Ae(e,r)},tn[l.b.SUMSQ]=function(e,t){var r=e.dereferenceAllOpers(t),n=Ne(I),a=N(e,F(e.mathpack.add),n,r);return null==a?e.mathpack.zero:a},tn[l.b.SUMIF]=U,tn[l.b.SUMIFS]=function(e,t){if(3===t.length)return U(e,[t[1],t[2],t[0]]);var r=G(e,t);return Object(T.d)(r)?P(e,[r.value]):r.reason},tn[l.b.LARGE]=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return pe(e,n,a)},tn[l.b.SMALL]=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return me(e,n,a)},tn[l.b.RANK]=et,tn[l.b.RANK_EQ]=et,tn[l.b.RANK_AVG]=function(e,t){return tt(e,t,!0)},tn[l.b.PERCENTILE]=je,tn[l.b.PERCENTILE_INC]=je,tn[l.b.PERCENTILE_EXC]=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return ye(e,n,a)},tn[l.b.QUARTILE]=ke,tn[l.b.QUARTILE_INC]=ke,tn[l.b.QUARTILE_EXC]=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1];return Ee(e,n,a)},tn[l.b.TRIMMEAN]=function(e,t){var r=e.dereferenceAllOpers(t),n=r[0],a=r[1],u=[],s=N(e,he(u,j.a),I,[n]);if(null==s)return o.p;if(Object(c.E)(s))return s;var l=e.mathpack;if(l.cond(a)<0)return o.p;if(l.cond2(a,l.one)>=0)return o.p;u=u.sort(l.cond2);var d=l.lfix(Object(j.a)(l.div(Object(j.a)(l.mul(l.fromNumber(u.length),a)),l.fromNumber(2))));Object(i.h)("calc.funcs.trimmean",d+d<u.length);var f=u[d],b=u[u.length-1-d],h=0,v=0,p=N(e,F(e.mathpack.add),(function(e,t){var r=I(0,t);if(void 0===r)return r;Object(i.h)("calc.funcs.trimmean: unexpected error",Object(c.M)(r));var n=e.mathpack;if(n.cond2(r,f)<0)h+=1;else{if(!(n.cond2(r,b)>0))return r;v+=1}}),[n]);Object(i.h)("calc.funcs.trimmean: found no elements",void 0!==p&&Object(c.M)(p)),Object(i.h)("calc.funcs.trimmean: trimmed too many",h<=d&&v<=d);for(var m=p;h<d;h+=1){var g=l.sub(m,f);if(Object(c.E)(g))return g;m=g}for(;v<d;v+=1){g=l.sub(m,b);if(Object(c.E)(g))return g;m=g}return l.div(m,l.fromNumber(u.length-d-d))},tn[l.b.AVERAGEA]=function(e,t){var r=e.dereferenceAllOpers(t);return K(e,r)},tn[l.b.MAXA]=function(e,t){var r=e.dereferenceAllOpers(t);return ce(e,r)},tn[l.b.MINA]=function(e,t){var r=e.dereferenceAllOpers(t);return ue(e,r)},tn[l.b.MAXIFS]=function(e,t){var r=G(e,t);return Object(T.d)(r)?ie(e,[r.value]):r.reason},tn[l.b.MINIFS]=function(e,t){var r=G(e,t);return Object(T.d)(r)?oe(e,[r.value]):r.reason},tn[l.b.XOR]=function(e,t){var r=e.dereferenceAllOpers(t);return be(e,r)},tn[l.b.AGGREGATE]=function(e,t){var r=t[0],n=t[1],a=t[2],s=t[3],l=t.slice(4),d=e.mathpack,f=d.sfix(r),b=d.sfix(n);if(!(f>=1&&f<=Ze.length+$e.length&&b>=0&&b<=7))return o.w;var h=1==(1&b),v=2==(2&b),p=!(4==(4&b));function m(t){var r=p?e.dereferenceAllOpersAndFormulae(t,h).map(Xe):e.dereferenceAllOpers(t,h);return v&&(r=r.map((function(e){if(function(e){var t=e.kind;return"number"==typeof t&&0!=(t&A)}(e))return e;if(Object(u.b)(e)){var t=e.arrays.map((function(e){return e.map((function(e){return void 0===e||Object(c.E)(e)?void 0:e}))}));return Object(u.d)(t)}if(function(e){return e.kind===y.b.Array}(e)){var r=e.opers.map((function(e){return e.map((function(e){return void 0===e||Object(c.E)(e)?void 0:e}))}));return function(e,t,r){return Object(i.d)("calc.runtime.coercedArrayOper",e),Object(i.d)("calc.runtime.coercedArrayOper",t),r.length!==e?Object(i.a)("calc.runtime.coercedArrayOper: Inconsistent row number"):{kind:y.b.Array,rows:e,cols:t,opers:r}}(e.rows,e.cols,r)}return e}))),r}if(f>Ze.length){if(void 0===s||l.length>0)return o.w;var g=y.b.Number,O=e.coerceOper(e.dereferenceOper(s,g),g);if(Object(c.E)(O))return o.w;if(Object(c.R)(a)&&!Object(c.Y)(a.sheets))return o.w;var j=m([a])[0],S=Ze.length;return(0,$e[f-S-1])(e,j,O)}for(var C=2;C<t.length;C+=1){var k=t[C];if(!k||!Object(c.R)(k)||!Object(c.Y)(k.sheets))return o.w}var E=m(t.slice(2));return Object(i.h)("calc.funcs.aggregate: requested non-array function with unexpected number",f>=1&&f<=Ze.length),(0,Ze[f-1])(e,E)},tn[l.b.SUBTOTAL]=function(e,t){var r=t[0],n=t.slice(1),a=e.mathpack.sfix(r),i=qe.length;if(!(a>=1&&a<=i||a>=101&&a<=i+100))return o.w;var c=a>100||e.isInFilterMode(n),u=e.dereferenceAllOpersAndFormulae(n,c).map(Xe);return(0,qe[a%100-1])(e,u)},tn[l.b.VAR]=We,tn[l.b.VAR_S]=We,tn[l.b.VARP]=ze,tn[l.b.VAR_P]=ze,tn[l.b.STDEV]=Ve,tn[l.b.STDEV_S]=Ve,tn[l.b.STDEVP]=He,tn[l.b.STDEV_P]=He,tn[l.b.VARA]=function(e,t){var r=e.dereferenceAllOpers(t);return De(e,r)},tn[l.b.VARPA]=function(e,t){var r=e.dereferenceAllOpers(t);return Pe(e,r)},tn[l.b.STDEVA]=function(e,t){var r=e.dereferenceAllOpers(t);return Ue(e,r)},tn[l.b.STDEVPA]=function(e,t){var r=e.dereferenceAllOpers(t);return Ge(e,r)},tn[l.b.AVEDEV]=function(e,t){var r=e.dereferenceAllOpers(t),n=nt(rt,e,r);if(!Array.isArray(n))return n;var a=n[0],i=n[1];return e.mathpack.div(a,e.mathpack.fromNumber(i))},tn[l.b.DEVSQ]=function(e,t){var r=e.dereferenceAllOpers(t),n=nt(Ne,e,r);return Array.isArray(n)?n[0]:n},tn[l.b.MODE]=Je,tn[l.b.MODE_SNGL]=Je,tn[l.b.MODE_MULT]=function(e,t){var r=Ke(e,t);return Array.isArray(r)?Object(o.c)(r.length,1,r.map((function(e){return[e.value]}))):r},tn[l.b.TEXTJOIN]=function(e,t){var r=t[0],n=t[1],a=t.slice(2),u=[];if(!Object(c.J)(r)){if(Object(c.R)(r)&&r.ranges.length>1)return o.w;var s=N(e,he(u,j.b),(function(e,t){return e.coerceOper(t,y.b.String)}),e.dereferenceAllOpers([r]));if(void 0!==s&&Object(c.E)(s))return s;Object(i.h)("calc.funcs.textjoin: expected string from reduce",void 0!==s&&Object(c.ab)(s))}return J(e,u,Object(c.J)(n)||n.value,a,e.dereferenceAllOpers(a))},tn[l.b.YEAR]=ot,tn[l.b.MONTH]=ct,tn[l.b.DAY]=ut,tn[l.b.HOUR]=st,tn[l.b.MINUTE]=lt,tn[l.b.SECOND]=dt,tn[l.b.WEEKNUM]=pt,tn[l.b.ISOWEEKNUM]=vt,tn[l.b.WEEKDAY]=function(e,t){return ft(e,t)},tn[l.b.DATE]=function(e,t){var r=t[0],n=t[1],a=t[2],i=e.mathpack,c=e.datepack,u=e.config,s=i.sfix(r);if(s>9999)return o.p;var l=i.sfix(n);if(l>32767||l<-32768)return o.p;var d=i.sfix(a);(d>32767||d<-32768)&&(d=32767),u.dateCompatibility?s<1900&&(s+=1900):s<1900&&!(1899===s&&12===l&&d>=30)&&(s+=1900);var f=Object(at.d)(s,l,d,0,0,0,0,0,at.a.RoundSec);return c.toNum(u,f)},tn[l.b.TIME]=function(e,t){var r=t[0],n=t[1],a=t[2],i=e.mathpack,u=e.datepack,s=e.config,l=i.sfix(r);if(l>32767)return o.p;var d=i.sfix(n);if(d>32767)return o.p;var f,b,h,v=i.sfix(a);if(v>32767)return o.p;s.dateCompatibility?(f=s.date1904?1904:1900,b=1,h=s.date1904?1:0):(f=1899,b=12,h=30);var p=Object(at.d)(f,b,h,l,d,v,0,0,at.a.RoundSec),m=u.toNum(s,p);return Object(c.E)(m)?m:i.cond(m)<0?o.p:i.sub(m,i.trunc(m))},tn[l.b.DAYS360]=function(e,t){var r,n=t[0],a=t[1],i=t[2],c=e.mathpack,u=e.datepack,s=e.config,l=null!==(r=null==i?void 0:i.value)&&void 0!==r&&r,d=u.fromNum(s,n,at.a.RoundSec);if(!1===d)return o.m;var f=31===d.dom||!l&&2===d.mon&&d.dom===u.daysPerMonth(2,d.yr,s.dateCompatibility)?30:d.dom,b=c.fromNumber(360*(d.yr-1900)+30*d.mon+f),h=u.fromNum(s,a,at.a.RoundSec);if(!1===h)return o.m;var v=31!==h.dom||!l&&30!==d.dom?h.dom:30,p=c.fromNumber(360*(h.yr-1900)+30*h.mon+v);return c.sub(p,b)},tn[l.b.DAYS]=function(e,t){var r=t[0],n=t[1];if(Object(c.ab)(r)&&r.value.length>255||Object(c.ab)(n)&&n.value.length>255)return o.w;var a=gt(e,r);if(Object(c.E)(a))return a;var i=gt(e,n);return Object(c.E)(i)?i:e.mathpack.sub(a,i)},tn[l.b.DATEDIF]=function(e,t){var r=t[0],n=t[1],a=t[2].value;if(a.length>2||0===a.length)return o.p;var i=e.mathpack,c=e.datepack,u=e.config,s=i.lfix(r),l=c.fromNum(u,r,at.a.RoundSec);if(!1===l)return o.p;var d=e.mathpack.lfix(n),f=c.fromNum(u,n,at.a.RoundSec);if(!1===f)return o.p;if(s>d)return o.p;var b=f.dom,h=f.mon,v=f.yr;l.dom>b&&(0===(h-=1)&&(h=12,v-=1),b+=c.daysPerMonth(h,v,u.dateCompatibility)),l.mon>h&&(h+=12,v-=1);var p=function(e,t){return 0===u.localeInfo.stringCompareCI(e,t)};if(p(a,"Y"))return i.fromNumber(v-l.yr);if(p(a,"M"))return i.fromNumber(12*(v-l.yr)+(h-l.mon));if(p(a,"D"))return i.fromNumber(d-s);if(p(a,"MD"))return i.fromNumber(b-l.dom);if(p(a,"YM"))return i.fromNumber(h-l.mon);if(p(a,"YD")){for(var m=0,g=l.mon;g<h;g+=1)m+=c.daysPerMonth(g,l.yr,u.dateCompatibility);return i.fromNumber(m+(b-l.dom))}return o.p},tn[l.b.WORKDAY]=function(e,t){var r=t[0],n=t[1],a=t[2];return Ct(e,a?[r,n,o.l,a]:[r,n])},tn[l.b.WORKDAY_INTL]=Ct,tn[l.b.EDATE]=Nt,tn[l.b.EOMONTH]=Tt,tn[l.b.NETWORKDAYS]=function(e,t){var r=t[0],n=t[1],a=t[2];return Rt(e,a?[r,n,o.l,a]:[r,n])},tn[l.b.NETWORKDAYS_INTL]=Rt,tn[l.b.YEARFRAC]=function(e,t){var r=t[0],n=t[1],a=t[2],i=At.DefaultBasis;if(void 0!==a){var u=function(e,t){var r=At.DefaultBasis;if(void 0===t||Object(c.J)(t))return r;var n=Object(j.f)(e,t);if(Object(c.E)(n))return n;var a=e.mathpack;switch(r=a.lfix(a.floor(n))){case At.Basis30360:case At.BasisActual:case At.BasisActual360:case At.BasisActual365:case At.BasisE30360:return r;default:return o.p}}(e,a);if("number"!=typeof u)return u;i=u}var s=Object(j.d)(e,r);if(Object(c.E)(s))return s;var l=Object(j.d)(e,n);if(Object(c.E)(l))return l;var d=e.mathpack;if(d.cond2(s,l)>0){var f=s;s=l,l=f}var b=Ft(e,s,l,i,0);if(!1===b)return o.p;var h=function(e,t,r,n){var a=e.mathpack,i=e.datepack,o=e.config,u=a.fromNumber(360),s=a.fromNumber(365),l=a.fromNumber(366);switch(t){case At.BasisActual:var d=i.fromNum(o,r,at.a.RoundSec);if(!1===d)return!1;var f=d.dom,b=d.mon,h=d.yr,v=i.fromNum(o,n,at.a.RoundSec);if(!1===v)return!1;var p=v.dom,m=v.mon,g=v.yr,O=g-1;if(h===g)return 29===i.daysPerMonth(2,h,o.dateCompatibility)?l:s;if(O===h&&(b>m||b===m&&f>=p)){if(29===i.daysPerMonth(2,h,o.dateCompatibility)){var y=i.toNum(o,Object(at.d)(h,2,29,0,0,0,0,0,at.a.RoundSec));return!Object(c.E)(y)&&(a.cond2(y,r)>=0?l:s)}if(29===i.daysPerMonth(2,g,o.dateCompatibility)){y=i.toNum(o,Object(at.d)(h,2,29,0,0,0,0,0,at.a.RoundSec));return!Object(c.E)(y)&&(a.cond2(y,n)<=0?l:s)}return s}for(var S=0,C=h;C<=g;C+=1)29===i.daysPerMonth(2,C,o.dateCompatibility)?S+=366:S+=365;var k=a.fromNumber(g-h+1);return Object(j.a)(a.div(a.fromNumber(S),k));case At.Basis30360:case At.BasisActual360:case At.BasisE30360:return u;case At.BasisActual365:return s;default:return u}}(e,i,s,l);return!1===h?o.p:d.div(b,h)},tn[l.b.DELTA]=function(e,t){var r=wt(e,t);if(!Array.isArray(r))return r;var n=r[0],a=r[1],i=e.mathpack;return 0===i.cond2(n,a)?i.one:i.zero},tn[l.b.GESTEP]=function(e,t){var r=wt(e,t);if(!Array.isArray(r))return r;var n=r[0],a=r[1],i=e.mathpack;return i.cond2(n,a)>=0?i.one:i.zero},tn[l.b.NA]=function(e,t){return o.m},tn[l.b.T]=function(e,t){var r=Dt(e,t[0]);return Object(c.ab)(r)||Object(c.E)(r)?r:j.g},tn[l.b.N]=function(e,t){var r=Dt(e,t[0]);if(Object(c.M)(r)||Object(c.E)(r))return r;var n=e.mathpack;return Object(c.z)(r)&&r.value?n.one:n.zero},tn[l.b.TYPE]=function(e,t){var r=t[0],n=e.mathpack;switch(r.kind){case y.b.Number:return n.fromNumber(1);case y.b.String:return n.fromNumber(2);case y.b.Boolean:return n.fromNumber(4);case y.b.Error:return n.fromNumber(16);case y.b.Array:return n.fromNumber(64);case y.b.Rich:return n.fromNumber(128);default:return Object(i.e)("calc.funcs.type",r)}},tn[l.b.ERROR_TYPE]=function(e,t){var r=t[0];return Object(c.E)(r)?e.mathpack.fromNumber(r.type):o.m},tn[l.b.INFO]=function(e,t){return o.w},tn[l.b.IF]=function(e,t){var r=t[0];Object(i.h)("calc.funcs.if: condition is not a boolean",Object(c.z)(r));var n=t[r.value?1:2];return Object(i.h)("calc.funcs.if: result is undefined",void 0!==n),n},tn[l.b.IFS]=function e(t,r){for(var n=0;n<r.length;n+=2){var a=r[n];if(Object(c.x)(a)){var u=r.slice(n);return zt(t,Ht,e,u)}if(Object(c.E)(a))return a;if(Object(i.h)("calc.funcs.ifs",Object(c.z)(a)),a.value)return r[n+1]}return o.m},tn[l.b.SWITCH]=function e(t,r){var n=r[0];if(Object(c.x)(n))return zt(t,Wt,e,r);if(Object(c.E)(n))return n;for(var a=function(e,t){var r=e.mathpack,n=e.localeInfo;switch(t.kind){case y.b.Number:return function(e){return Object(c.T)(e)?Object(Lt.i)(Object(c.hb)(["SWITCH with a rich value case"])):Object(c.M)(e)&&0===r.compare(t,e)};case y.b.String:return function(e){return Object(c.T)(e)?Object(Lt.i)(Object(c.hb)(["SWITCH with a rich value case"])):Object(c.ab)(e)&&0===n.stringCompareCI(t.value,e.value)};case y.b.Boolean:return function(e){return Object(c.T)(e)?Object(Lt.i)(Object(c.hb)(["SWITCH with a rich value case"])):Object(c.z)(e)&&t.value===e.value};case y.b.Rich:return Object(Lt.i)(Object(c.hb)(["SWITCH with a rich value condition"]));default:return Object(i.e)("calc.funcs.makeSwitchComparer",t)}}(t.config,n),u=1;u<r.length-1;u+=2){var s=y.b.Error|y.b.Rich|y.b.Number|y.b.Boolean|y.b.String|y.b.Array,l=t.coerceOper(t.dereferenceOper(r[u],s),s);if(Object(c.x)(l))return zt(t,Wt,e,r);if(Object(c.E)(l))return l;if(a(l))return r[u+1]}return r.length%2==0?r[r.length-1]:o.m},tn[l.b.TRUE]=function(e,t){return o.v},tn[l.b.FALSE]=function(e,t){return o.i},tn[l.b.NOT]=function(e,t){var r=t[0];return Object(o.e)(!r.value)},tn[l.b.CHOOSE]=function(e,t){var r=t[0];Object(i.h)("calc.funcs.choose",Object(c.M)(r));var n=e.mathpack.fix(r);return n<1||n>t.length-1?o.w:t[n]},tn[l.b.INDEX]=function(e,t){var r=t[0],n=t[1],a=t[2],u=t[3],l=e.mathpack,d=l.sfix(n);if(d<0)return o.w;var b=void 0===a?void 0:l.sfix(a);if(void 0!==b&&b<0)return o.w;var h,v,p=void 0===u?0:l.sfix(u)-1;if(p<0)return o.w;switch(r.kind){case y.b.Range:if(!Object(c.Y)(r.sheets))return o.w;if(p>=r.ranges.length)return o.t;var m=r.ranges[p];if(void 0===b)if(1===m.rows)h=0,v=d-1;else{if(1!==m.cols)return o.t;h=d-1,v=-1}else h=d-1,v=b-1;if(h>=m.rows||v>=m.cols)return o.t;var g=Object(s.g)(m.row+Object(f.b)(h,0),m.col+Object(f.b)(v,0),-1===h?m.rows:1,-1===v?m.cols:1);return Object(o.s)(r.sheets,[g]);case y.b.Array:return p>0?o.t:(void 0===b?1===r.rows?(h=0,v=d-1):(h=d-1,v=-1):(h=d-1,v=b-1),h>=r.rows||v>=r.cols?o.t:-1===h&&-1===v?r:-1===h?Object(o.c)(r.rows,1,r.opers.map((function(e){return[e[v]]}))):-1===v?Object(o.c)(1,r.cols,[r.opers[h]]):r.opers[h][v]);default:return Object(i.e)("calc.funcs.lookupFuncs: INDEX",r)}},tn[l.b.MATCH]=function(e,t){var r=t[0],n=t[1],a=t[2],i=void 0===a?e.mathpack.one:a,u=e.mathpack,s=function(e){switch(e.kind){case y.b.Number:return e;case y.b.Range:if(!Object(c.Y)(e.sheets))return o.w;if(e.ranges.length>1)return o.t;var t=e.ranges[0];return 1!==t.rows||1!==t.cols?o.t:e}}(i);if(Object(c.E)(s))return s;var d=e.dereferenceAllOpers([s])[0],f=Xt(e,d);if(Object(c.E)(f))return f;var b=Zt(n);if(Object(c.E)(b))return b;var h=$t(e.dereferenceAllOpers([b])[0]),v=nr(h,1===h.rows),p=-1;return(p=u.cond(f)>0?Yt(e,r,v):0===u.cond(f)?Jt(e,r,v,l.a.Eq):Jt(e,r,v,l.a.Lt))<0||p>=v.length?o.m:e.mathpack.fromNumber(p+1)},tn[l.b.LOOKUP]=function(e,t){var r=t[0],n=t[1],a=t[2],i=Qt(n);if(Object(c.E)(i))return i;var u=tr(i),l=ar(i,u),d=nr($t(e.dereferenceAllOpers([l])[0]),u),b=Yt(e,r,d);if(b<0)return o.m;if(void 0!==a){var h=Zt(a);if(Object(c.E)(h))return h;var v=tr(h),p=nr(er(e,function(e,t,r){if(Object(c.R)(r)){var n=r.ranges[0],a=Object(s.g)(n.row,n.col,Object(f.c)(t?1:e,s.v-n.row),Object(f.c)(t?e:1,s.o-n.col));return Object(o.r)(r.sheets,a)}return r}(d.length,v,h)),v);return b>=p.length?Object(c.x)(h)?o.m:o.d:p.get(b)}var m=er(e,i);return u?m.get(m.rows-1,b):m.get(b,m.cols-1)},tn[l.b.HLOOKUP]=function(e,t){return rr(e,t,!0)},tn[l.b.VLOOKUP]=function(e,t){return rr(e,t,!1)},tn[l.b.ABS]=Nr,tn[l.b.CEILING]=Sr,tn[l.b.ECMA_CEILING]=Sr,tn[l.b.DEGREES]=function(e,t){var r=t[0],n=e.mathpack,a=Object(j.a)(n.div(n.fromNumber(180),n.pi));return n.mul(r,a)},tn[l.b.FLOOR]=function(e,t){var r=t[0],n=t[1];return yr(e.mathpack,r,n)},tn[l.b.RADIANS]=function(e,t){var r=t[0],n=e.mathpack,a=Object(j.a)(n.div(n.pi,n.fromNumber(180)));return n.mul(r,a)},tn[l.b.ROUND]=mr,tn[l.b.ROUNDUP]=gr,tn[l.b.ROUNDDOWN]=Or,tn[l.b.EVEN]=Er,tn[l.b.SIGN]=function(e,t){var r=t[0],n=e.mathpack;return n.fromNumber(n.cond(r))},tn[l.b.PI]=function(e,t){return e.mathpack.pi},tn[l.b.SQRT]=ir,tn[l.b.EXP]=or,tn[l.b.POWER]=cr,tn[l.b.LN]=ur,tn[l.b.LOG10]=sr,tn[l.b.LOG]=function(e,t){var r=t[0],n=t[1],a=e.mathpack;if(void 0===n)return a.log(r);var i=a.ln(r);if(Object(c.E)(i))return i;var o=a.ln(n);return Object(c.E)(o)?o:a.div(i,o)},tn[l.b.SIN]=lr,tn[l.b.COS]=dr,tn[l.b.TAN]=fr,tn[l.b.ASIN]=br,tn[l.b.ACOS]=hr,tn[l.b.ATAN]=vr,tn[l.b.ATAN2]=pr,tn[l.b.FACT]=function(e,t){var r=t[0],n=e.mathpack,a=n.sfix(r);if(n.cond(r)<0||a>170)return o.p;for(var i=n.one,u=a;u>0;u-=1){if(Object(c.E)(i))return i;i=n.mul(n.fromNumber(u),i)}return i},tn[l.b.SQRTPI]=function(e,t){var r=t[0],n=Object(j.f)(e,r);if(Object(c.E)(n))return n;var a=e.mathpack;if(a.cond(n)<0)return o.p;var i=a.mul(a.pi,n);return Object(c.E)(i)?i:a.sqrt(i)},tn[l.b.FACTDOUBLE]=function(e,t){var r=t[0],n=Object(j.f)(e,r);if(Object(c.E)(n))return n;var a=e.mathpack,i=a.floor(n);if(a.cond2(i,a.fromNumber(-1))<0||a.cond2(i,a.fromNumber(300))>0)return o.p;for(var u=a.one,s=a.toNumber(i);s>1;s-=2){if(Object(c.E)(u))return u;u=a.mul(a.fromNumber(s),u)}return u},tn[l.b.INT]=function(e,t){var r=t[0],n=e.mathpack;return n.cond2(n.abs(r),n.fromNumber(1e15))<0&&(r=n.viewRound(r)),n.floor(r)},tn[l.b.TRUNC]=function(e,t){var r=t[0],n=t[1],a=void 0===n?e.mathpack.zero:n;return e.mathpack.roundDown(r,a)},tn[l.b.ODD]=Ar,tn[l.b.MROUND]=function(e,t){var r=t[0],n=t[1],a=Object(j.f)(e,r);if(Object(c.E)(a))return a;var i=Object(j.f)(e,n);if(Object(c.E)(i))return i;var u=e.mathpack;if(0===u.cond(i))return u.zero;if(0!==u.cond(a)&&u.cond(a)<0!=u.cond(i)<0)return o.p;var s=u.div(a,i);if(Object(c.E)(s))return o.p;var l=u.floor(s),d=Object(j.a)(u.sub(s,l)),f=u.fromNumber(.5-5e-15);if(u.cond2(d,f)<0)return u.mul(l,i);var b=u.add(l,u.one);return Object(c.E)(b)?b:u.mul(b,i)},tn[l.b.QUOTIENT]=function(e,t){var r=t[0],n=t[1],a=Object(j.f)(e,r);if(Object(c.E)(a))return a;var i=Object(j.f)(e,n);if(Object(c.E)(i))return i;var u=e.mathpack;if(0===u.cond(i))return o.g;var s=u.div(a,i);return Object(c.E)(s)?o.p:u.cond(s)>0?u.floor(s):u.ceil(s)},tn[l.b.FLOOR_MATH]=function(e,t){var r=t[0],n=t[1],a=t[2],i=e.mathpack,o=void 0===n||Object(c.J)(n)?i.one:i.abs(n),u=void 0===a||Object(c.J)(a)?i.zero:a;return 0!==i.cond(u)&&i.cond(r)<0&&(o=i.neg(o)),0===i.cond(o)?i.zero:yr(i,r,o)},tn[l.b.FLOOR_PRECISE]=function(e,t){var r=t[0],n=t[1],a=e.mathpack,i=void 0===n||Object(c.J)(n)?a.one:a.abs(n);return 0===a.cond(i)?a.zero:yr(a,r,i)},tn[l.b.CEILING_MATH]=function(e,t){var r=t[0],n=t[1],a=t[2],i=e.mathpack,o=void 0===n||Object(c.J)(n)?i.one:i.abs(n),u=void 0===a||Object(c.J)(a)?i.zero:a;return 0!==i.cond(u)&&i.cond(r)<0&&(o=i.neg(o)),0===i.cond(o)?i.zero:jr(i,r,o)},tn[l.b.CEILING_PRECISE]=Cr,tn[l.b.ISO_CEILING]=Cr,tn[l.b.TEXT]=function(e,t){var r,n=t[0],a=t[1].value,u=Object(c.T)(n)?n.getFallback():n;if(Object(c.ab)(u)&&u.value.length>255||a.length>255)return o.w;switch(u.kind){case y.b.String:var s=e.coerceOper(u,y.b.Number);r=Object(c.M)(s)?s:u;break;case y.b.Number:r=u;break;case y.b.Boolean:s=e.coerceOper(u,y.b.String);Object(i.h)("calc.funcs.text",Object(c.ab)(s)),r=s;break;case y.b.Error:return o.w}var l=e.applyFormat(e.originSheet.document,a,r,Ir.l.CustomString);return void 0!==l?Object(o.u)(l):o.w},tn[l.b.FIXED]=function(e,t){var r,n,a=t[0],i=t[1],u=t[2],s=Fr(e,a,i,void 0),l=s.formatValue,d=s.formatDecimals;if(Object(c.E)(l))return l;n=null!==(r=null==u?void 0:u.value)&&void 0!==r&&r?0===d?Tr.d.NoComFixed0:2===d?Tr.d.NoComFixed:Object(Rr.c)(e.config.localeInfo,!1,1,d):0===d?Tr.d.Fixed0:2===d?Tr.d.Fixed:Object(Rr.c)(e.config.localeInfo,!0,4,d);var f=e.applyFormat(e.originSheet.document,n,l,Ir.l.CustomBytecode);return void 0!==f?Object(o.u)(f):o.w},tn[l.b.DOLLAR]=function(e,t){var r=t[0],n=t[1],a=e.config.localeInfo,i=Fr(e,r,n,a.isEastAsia?a.currencyDecimals:void 0),u=i.formatValue,s=i.formatDecimals;if(Object(c.E)(u))return u;var l=0===s?Tr.d.Currency:2===s?Tr.d.CurrencyDec:Object(Rr.a)(a,!1,s,!0,!1),d=e.applyFormat(e.originSheet.document,l,u,Ir.l.CustomBytecode);return void 0!==d&&d.length>0&&d.charCodeAt(d.length-1)===_r?Object(o.u)(d.substring(0,d.length-1)):void 0!==d?Object(o.u)(d):o.w},tn[l.b.VALUE]=function(e,t){var r=t[0];switch(r.kind){case y.b.Boolean:return o.w;case y.b.Number:return r;case y.b.String:return r.value.length>255?o.w:e.coerceOper(Object(o.u)(wr(r.value)),y.b.Number)}},tn[l.b.DATEVALUE]=function(e,t){var r=Mr(e,t[0]);return Object(c.E)(r)?r:e.mathpack.trunc(r)},tn[l.b.TIMEVALUE]=function(e,t){var r=Mr(e,t[0]);return Object(c.E)(r)?r:e.mathpack.sub(r,e.mathpack.trunc(r))},tn[l.b.ISERROR]=function(e,t){var r=t[0];return Object(o.e)(Object(c.E)(r))},tn[l.b.ISERR]=function(e,t){var r=t[0];return Object(o.e)(Object(c.E)(r)&&r.type!==o.a.NA)},tn[l.b.ISBLANK]=function(e,t){var r=t[0];return Object(o.e)(Object(c.y)(r))},tn[l.b.ISLOGICAL]=function(e,t){var r=t[0];return Object(o.e)(Object(c.z)(r))},tn[l.b.ISNA]=function(e,t){var r=t[0];return Object(o.e)(Object(c.E)(r)&&r.type===o.a.NA)},tn[l.b.ISNONTEXT]=function(e,t){var r=t[0];return Object(o.e)(!Object(c.ab)(r))},tn[l.b.ISTEXT]=function(e,t){var r=t[0];return Object(o.e)(Object(c.ab)(r))},tn[l.b.ISNUMBER]=function(e,t){var r=t[0];return Object(o.e)(Object(c.M)(r))},tn[l.b.ISREF]=function(e,t){var r=t[0];return Object(o.e)(Object(c.R)(r))},tn[l.b.ISEVEN]=xr,tn[l.b.ISODD]=function(e,t){var r=xr(e,t);return Object(c.z)(r)?Object(o.e)(!r.value):r},tn[l.b.ISFORMULA]=function(e,t){return Lr(e,t[0],(function(e){return Object(o.e)(void 0!==e)}))},tn[l.b.FORMULATEXT]=function(e,t){var r=t[0];return Lr(e,r,(function(t,r){if(void 0===t)return o.m;var n=e.printFormula(t,r.range);return t.source.kind===s.a.Cell?Object(o.u)(n):Object(o.u)("{"+n+"}")}))},tn[l.b.ROWS]=function(e,t){var r=t[0],n=e.mathpack;return Object(c.x)(r)?n.fromNumber(r.rows):Object(c.Y)(r.sheets)?r.ranges.length>1?o.t:n.fromNumber(r.ranges[0].rows):o.w},tn[l.b.COLUMNS]=function(e,t){var r=t[0],n=e.mathpack;return Object(c.x)(r)?n.fromNumber(r.cols):Object(c.Y)(r.sheets)?r.ranges.length>1?o.t:n.fromNumber(r.ranges[0].cols):o.w},tn[l.b.AREAS]=function(e,t){var r=t[0];return Object(c.Y)(r.sheets)?e.mathpack.fromNumber(r.ranges.length):o.w},tn[l.b.SHEETS]=function(e,t){var r=t[0],n=e.mathpack;return r?Object(c.x)(r)?o.m:n.fromNumber(e.getSheetRangeIndexes(r.sheets).length):n.fromNumber(e.getSheetRangeIndexes(Object(s.c)(e.reflectionSheet.document)).length)},tn[l.b.ROW]=function(e,t){var r=Br(e,t[0]);if(!Array.isArray(r))return r;var n=r[0],a=r[1],i=e.mathpack;return a?i.fromNumber(n.row+1):Object(o.c)(n.rows,1,Object(d.i)(n.rows,1,(function(e){return i.fromNumber(n.row+e+1)})))},tn[l.b.COLUMN]=function(e,t){var r=Br(e,t[0]);if(!Array.isArray(r))return r;var n=r[0],a=r[1],i=e.mathpack;return a?i.fromNumber(n.col+1):Object(o.c)(1,n.cols,Object(d.i)(1,n.cols,(function(e,t){return i.fromNumber(n.col+t+1)})))},tn[l.b.SHEET]=function(e,t){var r=t[0],n=e.mathpack;if(!r){var a=e.reflectionSheet;return void 0===a.index?o.m:n.fromNumber(e.getSheetRangePosition(a)+1)}if(Object(c.ab)(r)){var u=e.getSheetIndex(e.reflectionSheet.document,r.value);return void 0===u?o.m:n.fromNumber(e.getSheetRangePosition(u)+1)}return Object(c.R)(r)?n.fromNumber(e.getSheetRangePosition(r.sheets)+1):Object(c.x)(r)?o.m:Object(i.e)("calc.funcs.sheet",r)},tn[l.b.OFFSET]=function(e,t){var r=t[0],n=t[1],a=t[2],i=t[3],u=t[4];if(!Object(c.Y)(r.sheets))return o.w;if(1!==r.ranges.length)return o.w;var l=e.mathpack,d=r.ranges[0],b=d.row,h=d.col,v=d.rows,p=d.cols,m=b;Object(c.M)(n)&&(m+=l.lfix(n));var g=h;Object(c.M)(a)&&(g+=l.lfix(a));var O=m+v-1;if(void 0!==i&&Object(c.M)(i)){if(0===(y=l.cond(i)))return o.t;O=m+l.lfix(i)-(y>0?1:-1)}var j=g+p-1;if(void 0!==u&&Object(c.M)(u)){var y;if(0===(y=l.cond(u)))return o.t;j=g+l.lfix(u)-(y>0?1:-1)}var S=Object(f.c)(m,O),C=Object(f.c)(g,j),k=Object(f.b)(m,O)-S+1,E=Object(f.b)(g,j)-C+1;return S<0||C<0||S+k>s.v||C+E>s.o?o.t:Object(o.s)(r.sheets,[Object(s.g)(S,C,k,E)])},tn[l.b.TRANSPOSE]=function(e,t){var r=t[0];return Object(c.x)(r)?Object(o.c)(r.cols,r.rows,Object(d.i)(r.cols,r.rows,(function(e,t){return r.opers[t][e]}))):r},tn[l.b.SINGLE]=function(e,t){var r=t[0];if(Object(c.O)(r)||Object(c.J)(r)||Object(c.y)(r)||Object(c.T)(r))return r;if(Object(c.x)(r))return r.opers[0][0];if(!Object(c.Y)(r.sheets))return o.t;if(1!==r.ranges.length)return o.w;var n=e.originGridCell,a=Object(c.l)(n,r.ranges[0]);return void 0===a?o.w:Object(o.s)(r.sheets,[a])},tn[l.b.ADDRESS]=function(e,t){var r=t[0],n=t[1],a=t[2],u=t[3],l=t[4],d=e.mathpack,f=(null==a?void 0:a.kind)===y.b.Number?d.sfix(a)-1:0;if(f<0||f>3)return o.w;var b=0!=(1&f),h=0!=(2&f),v=(null==u?void 0:u.kind)!==y.b.Boolean||u.value?Hr.h.A1:Hr.h.R1C1,p=function(e,t,r){return v===Hr.h.R1C1&&e?-t<r&&r<t:1<=r&&r<=t},m=d.sfix(r);if(!p(h,s.v,m))return o.w;if(!Object(c.M)(n))return o.w;var g=d.sfix(n);if(!p(b,s.o,g))return o.w;var O=Object(s.f)(m<0?s.v-1:0,g<0?s.o-1:0),j=Object(Hr.db)(h?Hr.f.Rel:Hr.f.Abs,v===Hr.h.R1C1&&h?m:m-1),S=Object(Hr.db)(b?Hr.f.Rel:Hr.f.Abs,v===Hr.h.R1C1&&b?g:g-1),C=Object(Wr.c)(e.config.localeInfo,v,O,j,S,!1);return Object(i.h)("calc.funcs.address: cell wrapped",void 0!==C),(null==l?void 0:l.kind)===y.b.String?""===l.value?Object(o.u)("!"+C):l.value.length>255?o.w:Object(o.u)(Object(Wr.g)(e.config.localeInfo,e.config.refStyle,l.value)+"!"+C):Object(o.u)(C)},tn[l.b.INDIRECT]=function(e,t){var r,n=t[0].value,a=t[1],i=null===(r=null==a?void 0:a.value)||void 0===r||r?Hr.h.A1:Hr.h.R1C1;if(n.length>255||Object(zr.h)(n," "))return o.w;var u=Object(s.n)(e.originSheet,e.originGridCell),d={lexicalKind:s.a.Indirect,originGridCell:Object(T.f)(u.range),originSheet:Object(T.f)(u.sheet),allowRelativeQualifier:!1,allowUnqualifiedCell:!0,allowImplicitTable:!1,wrapCellReferences:!0,workbookLoad:!1},f=e.parseFormula(i,u.range,d,"="+n);if(!Object(T.d)(f))return o.t;for(var b=f.value.node,h=!1,v=!1;;){var p;if(!h&&b.kind===Hr.e.App&&Object(c.N)(b.head)&&b.head.id===l.a.Pound&&1===b.args.length&&(h=!0,b=b.args[0]),v||b.kind!==Hr.e.Name)return b.kind===Hr.e.CellRef?void 0===(p=e.getCellRef(b.qualifier,b.ref,u,!0))?o.t:Object(c.Y)(p.sheets)?h?Object(Lt.i)(Object(c.hb)(["# operator in INDIRECT"])):p:o.t:b.kind===Hr.e.StructRef?void 0===b.lhs||void 0===(p=e.getStructRef(b.lhs,b.rhs,u))||h?o.t:p:o.t;var m=e.getNameFormula(b.qualifier,b.whole,s.b.Indirect);if(void 0===m)return o.t;u=Object(s.n)(u.sheet,Object(s.f)(0,0)),b=m[1],v=!0}},tn[l.b.LEFT]=function(e,t){var r,n=t[0].value,a=t[1];if(void 0!==a&&Object(c.E)(a))return a;var i=Xr(e.mathpack,a);if("number"!=typeof i&&Object(c.E)(i))return o.w;var u=null!==(r=Object(v.g)(n,0,i))&&void 0!==r?r:n.length;return Object(o.u)(n.substring(0,u))},tn[l.b.RIGHT]=function(e,t){var r,n=t[0].value,a=t[1];if(void 0!==a&&Object(c.E)(a))return a;var i=Xr(e.mathpack,a);if("number"!=typeof i&&Object(c.E)(i))return o.w;var u=null!==(r=Object(v.h)(n,n.length,i))&&void 0!==r?r:0;return Object(o.u)(n.substring(u))},tn[l.b.MID]=function(e,t){var r,n,a=t[0].value,i=t[1],c=t[2],u=e.mathpack,s=u.fix(i)-1,l=u.fix(c);if(u.cond(i)<0||s<0||u.cond(c)<0||l<0)return o.w;var d=null!==(r=Object(v.g)(a,0,s))&&void 0!==r?r:a.length,f=null!==(n=Object(v.g)(a,d,l))&&void 0!==n?n:a.length;return Object(o.u)(a.substring(d,f))},tn[l.b.LEN]=function(e,t){var r=t[0].value;return e.mathpack.fromNumber(Object(v.c)(r,0,r.length))},tn[l.b.CONCATENATE]=function(e,t){for(var r="",n=0;n<t.length;n+=1){var a=t[n].value;if(r.length+a.length>o.f){r+=a.substring(0,o.f-r.length);break}r+=a}return Object(o.u)(r)},tn[l.b.EXACT]=function(e,t){var r=t[0],n=t[1];return(Object(c.T)(r)||Object(c.T)(n))&&Object(Lt.i)(Object(c.hb)(["EXACT rich argument"])),Object(o.e)(r.value===n.value)},tn[l.b.REPT]=function(e,t){var r=t[0].value,n=t[1],a=e.mathpack,i=a.fix(n);return a.cond(n)<0||i>2147483647?o.w:""===r?j.g:i*r.length>o.f?o.w:Object(o.u)(Object(zr.f)(r,i))},tn[l.b.TRIM]=function(e,t){for(var r=t[0].value,n="",a=0;a<r.length;){for(;a<r.length&&r.charCodeAt(a)===qr;)a+=1;for(var i=a;a<r.length;){var c=r.charCodeAt(a)===qr;if(a+=1,c)break}n+=r.substring(i,a)}return n.length>0&&n.charCodeAt(n.length-1)===qr&&(n=n.substring(0,n.length-1)),Object(o.u)(n)},tn[l.b.CLEAN]=function(e,t){for(var r=t[0].value,n="",a=0;a<r.length;a+=1){var i=r.charCodeAt(a);(i>=256||(127&i)>=32)&&(n+=r.charAt(a))}return Object(o.u)(n)},tn[l.b.CHAR]=function(e,t){var r=t[0],n=e.mathpack.sfix(r);return n<1||n>255?o.w:Object(o.u)(String.fromCharCode(n))},tn[l.b.UNICHAR]=function(e,t){var r=t[0],n=e.mathpack,a=n.lfix(n.trunc(r));return n.cond2(r,n.one)<0||a>=1114112?o.w:a<=65535&&Object(v.d)(a)||a>=64976&&a<=65007||(65535&a)>=65534?o.m:Object(o.u)(Object(v.j)(a))},tn[l.b.CODE]=function(e,t){var r=t[0].value;if(0===r.length)return o.w;var n=r.charCodeAt(0);return n>255?Object(Lt.i)(Object(c.hb)(["CODE for codepoints > 255"])):e.mathpack.fromNumber(n)},tn[l.b.UNICODE]=function(e,t){var r=t[0].value;if(0===r.length)return o.w;var n=r.charCodeAt(0),a=e.mathpack;if(!Object(v.d)(n))return a.fromNumber(n);if(1===r.length)return o.w;var i=r.charCodeAt(1),c=Object(v.k)(n,i);return void 0===c?o.w:a.fromNumber(c)},tn[l.b.LOWER]=function(e,t){var r=t[0].value;return Object(o.u)($r(r,"LOWER",r.toLowerCase.bind(r)))},tn[l.b.UPPER]=function(e,t){var r=t[0].value;return Object(o.u)($r(r,"UPPER",r.toUpperCase.bind(r)))},tn[l.b.PROPER]=function(e,t){var r=t[0].value;return Object(o.u)($r(r,"PROPER",(function(){for(var e=r.toLowerCase(),t="",n=0;;){for(var a=n;n<e.length&&!Zr(e.charCodeAt(n));)n+=1;if(t+=e.substring(a,n),n===e.length)break;var i=n,o=Object(v.i)(e,n);for(t+=Object(v.j)(o).toUpperCase(),n+=Object(v.f)(o);n<e.length&&Zr(e.charCodeAt(n));)n+=1;t+=e.substring(i+1,n)}return t})))},tn[l.b.FIND]=function(e,t){var r,n=t[0].value,a=t[1].value,i=t[2],c=void 0!==i?e.mathpack.sfix(i)-1:0;if(c<0||c>=2147483647)return o.w;var u=null!==(r=Object(v.g)(a,0,c))&&void 0!==r?r:a.length,s=a.indexOf(n,u);return s>=0?e.mathpack.fromNumber(Object(v.c)(a,0,s)+1):o.w},tn[l.b.REPLACE]=function(e,t){var r,n,a=t[0].value,i=t[1],c=t[2],u=t[3].value,s=e.mathpack.sfix(i)-1;if(s<0||s>=o.f)return o.w;var l=e.mathpack.sfix(c);if(l<0||l>o.f)return o.w;var d=null!==(r=Object(v.g)(a,0,s))&&void 0!==r?r:a.length,f=null!==(n=Object(v.g)(a,d,l))&&void 0!==n?n:a.length,b=a.slice(0,d),h=a.slice(f);return b.length+u.length+h.length>o.f?o.w:Object(o.u)(b+u+h)},tn[l.b.SEARCH]=function(e,t){var r,n=t[0].value,a=t[1].value,i=t[2],c=void 0!==i?e.mathpack.sfix(i)-1:0;if(c<0||c>=2147483647)return o.w;for(var u=null!==(r=Object(v.g)(a,0,c))&&void 0!==r?r:a.length,s=new O(e.config.localeInfo,n,!0);u<a.length;u+=1)if(s.test(a.slice(u)))return e.mathpack.fromNumber(Object(v.c)(a,0,u)+1);return o.w},tn[l.b.SUBSTITUTE]=function(e,t){var r=t[0],n=t[1].value,a=t[2].value,i=t[3],u=r.value,s=1/0;if(void 0!==i){var l=e.coerceOper(i,y.b.Number);if(Object(c.E)(l))return l;if((s=e.mathpack.sfix(l))<1||s>2147483646)return o.w}var d=n.length;if(d>0){for(var f="",b=0,h=0;s>=0&&-1!==(h=u.indexOf(n,h));)if((s-=1)===1/0||0===s){var v=u.slice(b,h);if(f.length+v.length+a.length>o.f)return o.w;f+=v,f+=a,b=h+=d}else h+=1;var p=u.slice(b);return f.length+p.length>o.f?o.w:(f+=p,Object(o.u)(f))}return r},tn[l.b.RAND]=function(e,t){return e.getRandom()},tn[l.b.RANDBETWEEN]=function(e,t){var r=t[0],n=t[1],a=Object(j.f)(e,r),i=Object(j.f)(e,n);if(Object(c.E)(a))return a;if(Object(c.E)(i))return i;var u=e.mathpack;if(u.cond2(a,i)>0)return o.p;var s=e.getRandom(),l=u.ceil(a),d=u.floor(i),f=u.sub(d,l);return Object(c.E)(f)?f:u.add(u.floor(Object(j.a)(u.mul(Object(j.a)(u.add(f,u.one)),s))),l)},tn[l.b.NOW]=function(e,t){return e.getTime(at.c.Instant)},tn[l.b.TODAY]=function(e,t){return e.getTime(at.c.Day)},tn[l.b.HYPERLINK]=function(e,t){var r=t[0],n=t[1];return e.followHyperlinks?r:null!=n?n:r},tn[l.b.FIELDVALUE]=Gr,tn[l.b._FV]=Gr;var rn=!1;function nn(e){return rn||(rn=!0,Object(en.e)(en.a.CalcRecordFunctions)&&(tn[l.b.RECORD]=Vr),Object(en.e)(en.a.CalcNestedRecordFunction)&&(tn[l.b.NESTEDRECORD]=Vr),Object(en.e)(en.a.CalcLambdaBasicFunctions)&&(tn[l.b.ARITY]=Vt,tn[l.b.APPLY]=Ut,tn[l.b.ISLAMBDA]=Dr),Object(en.e)(en.a.CalcLambdaHelperFunctions)&&(tn[l.b.MAKEARRAY]=Gt,tn[l.b.ISOMITTED]=Pr)),tn[e]}},function(e,t,r){"use strict";var n=r(5),a=r(35),i=r(28),o=r(34),c=r(25),u=r(12),s=r(54);function l(e,t,r){return void 0===e?void 0===t?0:-1:void 0===t?1:r(e,t)}function d(e,t){return e<t?-1:e===t?0:1}function f(e,t){return"string"==typeof e?"string"!=typeof t?1:d(e,t):"string"==typeof t||e<t?-1:e===t?0:1}function b(e,t){var r;return 0!==(r=d(e.name,t.name))?r:l(e.path,t.path,d)}function h(e,t){return{current:e,map:t}}var v=h(void 0,s.a.create((function(e,t){var r;return 0!=(r=e.range.col-t.range.col)||0!=(r=e.range.row-t.range.row)||0!==(r=f(e.sheet.index,t.sheet.index))?r:b(e.sheet.document,t.sheet.document)})));function p(e,t){return{current:e,map:t}}var m=p(void 0,s.a.create((function(e,t){var r;return 0!==(r=d(e.name,t.name))||0!==(r=l(e.scope.index,t.scope.index,f))?r:b(e.scope.document,t.scope.document)})));var g=r(3),O=r(7),j=r(44),y=r(22),S=r(0),C=r(30),k=r(77),E=function(){function e(e,t,r,u){var s=this;this.context=e,this.visitedCells=t,this.cell=r,this.isPrecedent=u,this.receiveSuccess=function(e){return function(t){if(Object(g.R)(t)||Object(g.J)(t)){var r="expected ReadOper; given ".concat(Object(a.a)(t)),i="calc.runtime.CellEvaluationMachine.receiveSuccess: ".concat(r);return n.i.ULS.assertTag(595980815,c.LogCategory.msoulscat_ES_EWAJS,!1,i)}return s.writeSuccess(e.source,t,e.precedents),t}},this.receiveFailure=function(e){return function(t){if(t.kind===o.b.Unevaluated){var r="unexpected reason ".concat(Object(a.a)(t)),u="calc.runtime.CellEvaluationMachine.receiveFailure: ".concat(r);return n.i.ULS.assertTag(595980817,c.LogCategory.msoulscat_ES_EWAJS,!1,u)}var l=t.kind===i.d.PreviousFailure&&void 0!==e.cycle?e.cycle:t;return s.writeFailure(e.source,l,e.precedents),y.a.reject(s.isPrecedent?Object(i.u)(e.source.range):l)}}}return e.prototype.evalCell=function(){var e=this.context.globals.getCellValue(this.cell);if(e.kind===S.b.Failure)return y.a.reject(e.reason);var t=e.value;if(t.kind===i.a.FinalValue)return t.oper;var r=this.context.globals.getCellFormula(t.anchor);if(r.kind===S.b.Failure){var u="calc.runtime.CellEvaluationMachine.next: unexpected Failure from getCellFormula";return n.i.ULS.assertTag(595980813,c.LogCategory.msoulscat_ES_EWAJS,!1,u)}var s=r.value;if(null==s){var l="client error: expected getCellFormula(".concat(Object(a.a)(t.anchor),") != null");u="calc.runtime.CellEvaluationMachine.next: ".concat(l);return n.i.ULS.assertTag(595980814,c.LogCategory.msoulscat_ES_EWAJS,!1,u)}var d,f,b=this.visitAnchor(s),v=this.context.createFormulaEvaluationMachine(this.context,Object(o.d)(b.source),b.precedents,(d=this.visitedCells,f=b,Object(n.h)("calc.runtime.appendVisitedCell",f.previous===d.current),h(f,d.map.setValue(f.cell,f))),s.formula);return y.a.fromMachine(v).bind(this.receiveSuccess(b)).catch(this.receiveFailure(b))},e.prototype.visitAnchor=function(e){var t=Object(g.ib)(e.source.range),r=this.visitedCells.map.getValue(t);if(null!=r){var i="unexpected visitValue at ".concat(Object(a.a)(t),"; given ").concat(Object(a.a)(r)),u="calc.runtime.CellEvaluationMachine.visitAnchor: ".concat(i);return n.i.ULS.assertTag(595980812,c.LogCategory.msoulscat_ES_EWAJS,!1,u)}return{cell:t,cycle:void 0,previous:this.visitedCells.current,source:e.source,precedents:Object(o.c)()}},e.prototype.writeSuccess=function(e,t,r){this.setCellValue(e,t,r)},e.prototype.writeFailure=function(e,t,r){this.context.globals.setCellFailure(e.range,t,r)},e.prototype.setCellValue=function(e,t,r){var n=this.context.globals.config.mathpack.zero,a=Object(g.y)(t)?n:t;if(e.kind===u.a.Cell){if(Object(g.x)(a)){var i=void 0===a.opers[0]?O.m:a.opers[0][0],o=Object(g.y)(i)?n:i;if(!this.isLambdaEnabled(e,o,r))return;return this.context.globals.setCellValue(e.range,o,r)}if(!this.isLambdaEnabled(e,a,r))return;return this.context.globals.setCellValue(e.range,a,r)}var c=e.range.range,s=Object(j.b)(c.rows,c.cols,a).opers,l=function(e){return Object(g.y)(e)?n:e},d=s.map((function(e){return e.map(l)}));if(this.isLambdaEnabled(e,d,r))return this.context.globals.setCellValues(e.range,d,r)},e.prototype.isLambdaEnabled=function(e,t,r){return!((Array.isArray(t)?t.some((function(e){return e.some((function(e){return e instanceof k.a}))})):t instanceof k.a)&&!Object(C.e)(C.a.CalcLambdaCellValues))||(this.context.globals.setCellFailure(e.range,Object(g.hb)(["LAMBDA cell values"]),r),!1)},e}();function A(e,t,r,n){return y.a.try((function(){return new E(e,t,r,n).evalCell()}))}function N(e,t){for(var r=B(e),n=[],a=0;a<t.length;a+=1)n.push(A(r.machineContext,v,t[a],!1));return new G(r,n)}var T=r(10),R=r(53),I=r(71),_=r(80),F=r(83),w=r(18),M=r(92),D=r(79);function P(e){return{yieldIntervalMs:e.yieldIntervalMs,endTimeMs:null==e.totalTimeMs?void 0:Object(T.k)()+e.totalTimeMs,scheduleFunction:null!=e.scheduleFunction?e.scheduleFunction:function(e){return setTimeout(e,0)}}}function x(e){if(void 0!==e.yieldIntervalMs||void 0!==e.endTimeMs){if(void 0===e.yieldIntervalMs)return e.endTimeMs;var t=Object(T.k)()+e.yieldIntervalMs;return void 0===e.endTimeMs?t:Object(T.c)(e.endTimeMs,t)}}var L={kind:i.d.Timeout};function B(e){return{globals:e,timer:{doTimeout:function(e){return void 0!==e&&Object(T.k)()>=e}},machineContext:U(e)}}function U(e){return{globals:e,resolver:Object(I.a)(e),numberFormatter:Object(M.a)(e),parser:Object(_.a)(e),printer:Object(D.b)(e),analyzer:Object(F.a)(e),createCellEvaluationMachine:A,createFormulaEvaluationMachine:Ne,createLambdaEvaluationMachine:Te}}var G=function(){function e(e,t){Object(n.f)("calc.runtime.EvaluationRuntime",t.length),this.context=e,this.machineRuntimes=t.map((function(e){return new R.MachineRuntime(e)})),this.results=[]}return e.prototype.evaluateAsync=function(e){var t=this;if(this.context.globals.interruptToken[0]===i.b.Stop)return this.generatePartialResults(),Promise.resolve(this.results);if(this.context.timer.doTimeout(e.endTimeMs))return this.generatePartialResults(),Promise.resolve(this.results);try{var r=this.evaluate(x(e));return Array.isArray(r)?Promise.resolve(r):new Promise((function(r,n){return e.scheduleFunction((function(){try{r(t.evaluateAsync(e))}catch(e){n(e)}}))}))}catch(e){return Promise.reject(e)}},e.prototype.evaluateSync=function(e){var t=this,r=function(n){if(t.context.globals.interruptToken[0]===i.b.Stop||t.context.timer.doTimeout(e.endTimeMs))return t.generatePartialResults(),t.results;var a=t.evaluate(n);return Array.isArray(a)?a:Object(i.s)((function(t){return r(void 0!==t?t:x(e))}))};return r(x(e))},e.prototype.evaluate=function(e){var t=this,r=function(){return t.context.timer.doTimeout(e)};try{for(;this.results.length<this.machineRuntimes.length;){var a=this.machineRuntimes[this.results.length].run(r);if(!a)return L;this.pushResult(a)}return this.results}catch(e){var i="calc.runtime.EvaluationRuntime.evaluate: unhandled error ".concat(Object(w.c)(e));return n.i.ULS.assertTag(595980807,c.LogCategory.msoulscat_ES_EWAJS,!1,i)}},e.prototype.pushResult=function(e){return this.results.push(e),R.nextTransition},e.prototype.generatePartialResults=function(){for(;this.results.length<this.machineRuntimes.length;)this.results.push(Object(S.c)(i.w))},e}(),V=r(49),H=r(62),W=r(86),z=r(39),q=r(4),K=r(2),Y=r(19),J=r(56),Q=r(66),X=r(114),Z=r(1),$=r(6),ee=r(81),te=r(8);function re(e,t){var r=t.map.getValue(e);if(void 0!==r){var n=function(e,t){for(var r=[],n=Object(i.e)(r),a=t;r.push(a.cell),a.cycle=n,a!==e;a=a.previous);return r.reverse(),n}(r,t.current);return Object(o.i)(n)}}function ne(e,t,r){e.precedents.cells.push(t);var n=e.globals.getCellValue(t);if(n.kind===S.b.Failure)return Object(o.i)(n.reason);var a=n.value;if(a.kind===i.a.FinalValue)return a.oper;re(a.anchor,e.visitedCells),r.push(a.anchor)}function ae(e,t,r,a){var c;if(e.precedents.cells.push(t),!a||Object(g.u)(t.range)<=16)c=t;else{var s=e.globals.getUsedRange(t.sheet),l=void 0;Object(S.d)(s)?l=null==s.value?void 0:s.value.range:Object(o.i)(s.reason);var d=void 0===l?void 0:Object(g.q)(t.range,Object(u.g)(0,0,l.row+l.rows,l.col+l.cols));if(void 0===d)return new V.c(t.range.rows,t.range.cols,0,0,[],O.d);c=Object(u.r)(t.sheet,d)}var f=e.globals.getCellValues(c);if(f.kind===S.b.Failure)return Object(o.i)(f.reason);var b=r.length,h=function(e,t,r,a,o){var c=[],u=a.length,s=0;Object(n.h)("calc.runtime.deference: readIntoArray2D number of rows",u===r.rows);for(var l=0;l<u;l+=1){c.push([]);var d=a[l].length;Object(n.h)("calc.runtime.deference: readIntoArray2D number of cols",d===r.cols),s=0===l?d:Object(T.c)(d,s);for(var f=0;f<d;f+=1){var b=a[l][f];i.a.FinalValue===b.kind?c[l][f]=b.oper:(re(b.anchor,e.visitedCells),Object(n.h)("calc.runtime.deference: readIntoArray2D correct sheet",Object(g.Z)(b.anchor.sheet,t.sheet)),o.push(b.anchor),c[l][f]=O.t)}}return new V.c(t.range.rows,t.range.cols,u,s,c,O.d)}(e,t,c.range,f.value,r);return b===r.length?h:void 0}function ie(e,t,r){var n=ae(e,t,r,!1);if(null!=n)return Object(O.c)(n.rows,n.cols,n.rows===n.denseRows&&n.cols===n.denseCols?n.denseElements:Object(V.d)(n))}function oe(e,t,r,n){if(0!=(r&te.b.Range))return t;if(!Object(g.R)(t))return t;var i=t.sheets;if(!Object(g.Y)(i))return Object(j.g)("calc.runtime.dereference",O.a.REF,"3D range, oper = ".concat(Object(a.a)(t))),O.t;if(1!==t.ranges.length)return Object(j.g)("calc.runtime.dereference",O.a.VALUE,"union range, oper = ".concat(Object(a.a)(t))),O.w;var c=t.ranges[0];if(0!=(r&j.f)){if(Object(g.F)(c))return ne(e,Object(u.p)(i,c),n);if(e.locals.implicitIntersect&&Object(C.e)(C.a.CalcLegacyImplicitIntersection)&&!Object(C.e)(C.a.CalcPreventSpillingHack)){var s=e.locals.originGridCell;if(!Object(S.d)(s))return Object(o.i)(s.reason);var l=Object(g.l)(s.value,c);return null==l?(Object(j.g)("calc.runtime.dereference",O.a.VALUE,"empty intersection, oper = ".concat(Object(a.a)(t))),O.w):ne(e,Object(u.p)(i,l),n)}return ie(e,Object(u.r)(i,c),n)}return 0!=(r&te.b.Array)?ie(e,Object(u.r)(i,c),n):(Object(j.g)("calc.runtime.dereference",O.a.VALUE,"bad target type ".concat(r)),O.w)}function ce(e,t,r){var i=[],u=oe(e,t,r,i);if(null==u){if(i.length>0)return Object(o.i)(Object(o.j)(i));var s=Object(a.a)(t),l="calc.runtime.dereferenceOper: internal error: expected nonempty anchors; oper = ".concat(s);return n.i.ULS.assertTag(595980819,c.LogCategory.msoulscat_ES_EWAJS,!1,l)}return u}function ue(e,t,r){for(var n=[],a=0;a<t.length;a+=1){var i=oe(e,t[a],Object(g.f)(r,a,t.length),n);null!=i&&(t[a]=i)}if(n.length>0)return Object(o.i)(Object(o.j)(n))}var se=r(21);function le(e,t){return 0!=(t&te.b.Number)?e.zero:0!=(t&te.b.String)?se.g:0!=(t&te.b.Boolean)?O.i:O.w}function de(e,t,r){var a=function e(t,r,a){var i=t.globals.config,c=i.localeInfo,u=i.mathpack;if(0!=(a&r.kind))return r;if(Object(g.M)(r)){if(0!=(a&te.b.String)){return Object(O.u)(u.formatGeneral(c,r,20))}return 0!=(a&te.b.Boolean)?Object(O.e)(0!==u.cond(r)):0!=(a&te.b.Array)?Object(O.c)(1,1,[[r]]):O.w}if(Object(g.ab)(r)){if(0!=(a&te.b.Number)){if(0===r.value.length)return O.w;if(r.value.length>255)return O.w;var s=t.numberFormatter.parseGeneral(r.value,!1,!0,$.j.NonVolatile);return Object(S.d)(s)||Object(o.i)(s.reason),void 0!==s.value?s.value.value:O.w}return 0!=(a&te.b.Boolean)?0===c.stringCompareCI(r.value,c.trueName)?O.v:0===c.stringCompareCI(r.value,c.falseName)?O.i:O.w:0!=(a&te.b.Array)?Object(O.c)(1,1,[[r]]):O.w}if(Object(g.z)(r))return 0!=(a&te.b.Number)?r.value?u.one:u.zero:0!=(a&te.b.String)?Object(O.u)(r.value?c.trueName:c.falseName):0!=(a&te.b.Array)?Object(O.c)(1,1,[[r]]):O.w;switch(r.kind){case te.b.Error:return r;case te.b.Missing:return 0!=(a&te.b.Blank)?O.d:le(u,a);case te.b.Blank:return le(u,a);case te.b.Rich:return e(t,r.getFallback(),a);case te.b.Range:case te.b.Array:return O.w;default:return Object(n.e)("calc.runtime.coerceOper",r)}}(e,t,r);return Object(g.E)(a)&&!Object(g.E)(t)&&Object(j.g)("calc.runtime.coerceOper",a.type,"kind = ".concat(t.kind)),a}var fe,be=r(68);function he(e,t){return Object(n.h)("calc.runtime.lambdaCall",t.length>=e.minArity&&t.length<=e.maxArity),{kind:fe.LambdaCall,lambda:e,args:t}}function ve(e){return e.kind===fe.LambdaCall}!function(e){e.LambdaCall="LambdaCall"}(fe||(fe={}));var pe=function(){function e(e){this.kind=te.b.Rich,this.arity=e.arity,this.func=e.func}return e.prototype.getFallback=function(){return Object(n.a)("calc.runtime.UdfOper.getFallback")},e.prototype.getField=function(e){return Object(n.a)("calc.runtime.UdfOper.getField")},e}(),me=function(){function e(e,t,r,n,a,i){this.context=e,this.locals=t,this.precedents=r,this.visitedCells=n,this.visitedNames=a,this.usage=i;var o=e.globals.config.refStyle;this.config={localeInfo:e.globals.config.localeInfo,get refStyle(){return r.special|=te.d.RefStyle,o},mathpack:e.globals.config.mathpack,date1904:e.globals.config.date1904,dateCompatibility:e.globals.config.dateCompatibility,timezone:e.globals.config.timezone,datepack:e.globals.config.datepack},this.mathpack=this.config.mathpack,this.datepack=this.config.datepack}return Object.defineProperty(e.prototype,"globals",{get:function(){return this.context.globals},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numberFormatter",{get:function(){return this.context.numberFormatter},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"calcingArray",{get:function(){return this.locals.calcingArray},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"originGridCell",{get:function(){var e=this.locals.originGridCell;return Object(S.d)(e)?e.value:Object(o.i)(e.reason)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"originSheet",{get:function(){var e=this.locals.originSheet;return Object(S.d)(e)?e.value:Object(o.i)(e.reason)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reflectionGridCell",{get:function(){var e=this.locals.reflectionGridCell;return Object(S.d)(e)?e.value:Object(o.i)(e.reason)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"reflectionSheet",{get:function(){var e=this.locals.reflectionSheet;return Object(S.d)(e)?e.value:Object(o.i)(e.reason)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"followHyperlinks",{get:function(){var e=this.locals.followHyperlinks;return Object(S.d)(e)?e.value:Object(o.i)(e.reason)},enumerable:!1,configurable:!0}),e.prototype.applyFunction=function(e,t){var r=Object(Z.e)(e),n=t.some(g.R)?t.slice(0):t;return ue(this,n,r),this.handleLambda(this.dispatchFunction(Object(z.s)(e),r,!1,n))},e.prototype.applyLambda=function(e,t){return this.handleLambda(he(e,t))},e.prototype.handleEvaluationError=function(e){if(e instanceof o.a)return Object(o.h)(this.context,this.visitedCells,e.reason)},e.prototype.applyOperatorOrFunction=function(e,t,r){if(Object(z.h)(e))return Object(W.a)(this.globals,Object(z.m)(e),t,r);var a=Object(z.t)(e);if(a===Z.b._UDF){if(t[0]instanceof k.a){var i=t[0],c=t.slice(1);return c.length>=i.minArity&&c.length<=i.maxArity?he(i,c):O.w}if(t[0]instanceof pe){var u=t[0];if(t.length-1!==u.arity)return O.w;if((f=u.func(this,t.slice(1))).kind===te.b.Error){var s="UDF function return value";Object(j.g)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",f.type,s)}return f}switch(t[0].kind){case te.b.Error:return t[0];case te.b.Number:return O.w;case te.b.Rich:return Object(o.i)(Object(g.hb)(["Rich UDF head"]));case te.b.String:case te.b.Boolean:case te.b.Blank:case te.b.Missing:return O.t;case te.b.Array:return Object(C.e)(C.a.CalcLambdaArrayLifting)?Object(n.a)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction: unexpected array UDF head"):Object(o.i)(Object(g.hb)(["Array UDF head"]));case te.b.Range:return Object(C.e)(C.a.CalcLambdaCellValues)?Object(n.a)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction: unexpected range UDF head"):Object(o.i)(Object(g.hb)(["Range UDF head"]));default:return Object(n.e)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",t[0])}}var l=this.globals.getWorksheetFunc(a);if(l.kind===S.b.Failure)return Object(o.i)(l.reason);var d=l.value;if(null==d){s="nonexistent worksheet function ".concat(a);return Object(j.g)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",O.a.NAME,s),O.n}try{var f;if((f=d(this,t)).kind===te.b.Error){s="worksheet function ".concat(a," return value");Object(j.g)("calc.runtime.FunctionDispatcher.applyOperatorOrFunction",f.type,s)}return f}catch(e){throw Object(w.e)(e,"(in WSF ".concat(Object(q.r)(a),")"))}},e.prototype.handleLambda=function(e){return ve(e)?Object(R.machineCall)(this.context.createLambdaEvaluationMachine(this.context,this.locals,this.precedents,this.visitedCells,this.visitedNames,this.usage,e.lambda,e.args)):e},e.prototype.dispatchFunction=function(e,t,r,i){var o=this;if(!Object(g.cb)(t,i.length)){var u=JSON.stringify(t),s="bad application of ".concat(JSON.stringify(e)," to ").concat(i.length," arguments, ftype = ").concat(u),l="calc.runtime.FunctionDispatcher.dispatchFunction: ".concat(s);return n.i.ULS.assertTag(593372499,c.LogCategory.msoulscat_ES_EWAJS,!1,l)}for(var d=i.length,f=te.c.None,b=0;b<d;b+=1){var h=i[b],v=h.kind;0==(v&Object(g.f)(t,b,d))&&(f|=v),Object(g.R)(h)&&0==(t.flags&te.a.Allow3dRef)&&!Object(g.Y)(h.sheets)&&(f|=v)}if(f===te.c.None)return this.applyOperatorOrFunction(e,i,r);if(0!=(f&te.b.Array)){return Object(j.a)(this,t,(function(r){return o.handleLambda(o.dispatchFunction(e,t,!1,r))}),i)}f&=~te.b.Array;var p=[];for(b=0;b<d;b+=1){var m=i[b];if(0!=(f&m.kind)){var y=Object(g.f)(t,b,d);if(m=this.coerceOper(m,y),Object(g.E)(m)&&0==(y&te.b.Error))return m;if(Object(g.R)(m)&&0==(t.flags&te.a.Allow3dRef)&&!Object(g.Y)(m.sheets)){s="3D reference, oper = ".concat(Object(a.a)(m));return Object(j.g)("calc.runtime.FunctionDispatcher.dispatchFunction",O.a.VALUE,s),O.w}}p[b]=m}return this.applyOperatorOrFunction(e,p,r)},e.prototype.getAvailableFormula=function(e){var t=this.globals.getCellFormula(e);return Object(S.d)(t)?Object(T.f)(t.value)?void 0:t.value:Object(o.i)(t.reason)},e.prototype.getNameFormula=function(e,t,r){var n=this.context.resolver.resolveName(this.locals,Object(K.X)(Object(K.M)(t,!0),e),r).resolution;if(!Object(S.d)(n))switch(n.reason.kind){case Y.d.NoOriginSheet:case Y.d.InvalidQualifier:return;default:return Object(o.i)(n.reason)}var a=n.value;if(a){this.precedents.names.push(a);var i=this.globals.getNameFormula(a,r);Object(S.d)(i)||Object(o.i)(i.reason);var c=i.value;if(!Object(T.f)(c))return[a,c.node]}},e.prototype.getCellRef=function(e,t,r,n){var a={originGridCell:Object(S.f)(r.range),originSheet:Object(S.f)(r.sheet),allowUnqualifiedCell:!0,wrapCellReferences:n},i=this.context.resolver.resolveCellRef(a,Object(K.u)(t,e)).resolution;if(!Object(S.d)(i))switch(i.reason.kind){case Y.d.NoOriginSheet:case Y.d.InvalidQualifier:return;default:return Object(o.i)(i.reason)}var c=i.value;if(c)return Object(O.r)(c.sheet,c.range)},e.prototype.getStructRef=function(e,t,r){var n={originGridCell:Object(S.f)(r.range),originSheet:Object(S.f)(r.sheet),allowUnqualifiedCell:!0,wrapCellReferences:!1},a=this.context.resolver.resolveStructRef(n,Object(K.kb)(e,t)).resolution;if(!Object(S.d)(a))switch(a.reason.kind){case Y.d.NoOriginSheet:case Y.d.InvalidQualifier:case Y.d.InvalidStructRef:case Y.d.EmptyIntersection:return;default:return Object(o.i)(a.reason)}var i=a.value;if(i)return Object(O.r)(i.sheet,i.range)},e.prototype.dereferenceOper=function(e,t){return ce(this,e,t)},e.prototype.dereferenceOpers=function(e,t){ue(this,e,t)},e.prototype.getCellFormula=function(e){this.precedents.cells.push(e);var t=this.globals.getCellValue(e);return Object(S.d)(t)?this.getAvailableFormula(e):Object(o.i)(t.reason)},e.prototype.getSheetIndex=function(e,t){var r=this.globals.getSheetIndex(e,t);return Object(S.d)(r)?(this.precedents.special|=te.d.OwnDocSheets,null==r.value?void 0:Object(u.s)(e,r.value)):Object(o.i)(r.reason)},e.prototype.getSheetRangePosition=function(e){this.precedents.special|=te.d.OwnDocSheets;var t=this.globals.getSheetRangeIndexes(e);return Object(S.d)(t)?t.value.position:Object(o.i)(t.reason)},e.prototype.getSheetRangeIndexes=function(e){if(void 0!==e.index&&e.index===e.index2)return[e.index];this.precedents.special|=te.d.OwnDocSheets;var t=this.globals.getSheetRangeIndexes(e);return Object(S.d)(t)?t.value.sheets:Object(o.i)(t.reason)},e.prototype.dereferenceAllOpersInner=function(e,t,r){var a=this;void 0===r&&(r=!1);for(var i=[],c=[],s=function(s){var d=e[s];if(!Object(g.R)(d))return c.push(d),"continue";for(var f=[],b=function(e){var r=ae(a,e,i,!0);void 0!==r&&f.push(t(r,e))},h=l.getSheetRangeIndexes(d.sheets),v=function(e){for(var t=Object(u.s)(d.sheets.document,h[e]),a=function(e){var a=d.ranges[e];if(!r)return b(Object(u.r)(t,a)),"continue";var i=l.globals.tryGetHiddenRows(t,a.row,a.row+a.rows);if(!Object(S.d)(i))return{value:Object(o.i)(i.reason)};var c=i.value;if(0===c.length)return b(Object(u.r)(t,a)),"continue";for(var s=function(e,r){var n=Object(u.g)(e,a.col,r-e,a.cols);b(Object(u.r)(t,n))},f=0;f<c.length;f+=1){var h=c[f],v=h.start,p=h.end,m=0===f?a.row:c[f-1].end;Object(n.h)("calc.runtime.FunctionDispatcher.dereferenceAllOpersInner: valid interval",m<=v&&v<p&&p<=a.row+a.rows),m!==v&&s(m,v);var g=Object(u.g)(v,a.col,p-v,a.cols);l.precedents.cells.push(Object(u.r)(t,g))}var O=c[c.length-1].end;O!==a.row+a.rows&&s(O,a.row+a.rows)},i=0;i<d.ranges.length;i+=1){var c=a(i);if("object"==typeof c)return c}},p=0;p<h.length;p+=1){var m=v(p);if("object"==typeof m)return m}c.push({kind:H.a.RangeValues,arrays:f})},l=this,d=0;d<e.length;d+=1){var f=s(d);if("object"==typeof f)return f.value}return i.length>0?Object(o.i)(Object(o.j)(i)):c},e.prototype.dereferenceAllOpers=function(e,t){return this.dereferenceAllOpersInner(e,T.d,t)},e.prototype.dereferenceAllOpersAndFormulae=function(e,t){var r=this;return this.dereferenceAllOpersInner(e,(function(e,t){return new V.a(e.rows,e.cols,e.denseRows,e.denseCols,(function(n,a){var i=e.get(n,a),o=Object(u.p)(t.sheet,Object(u.f)(t.range.row+n,t.range.col+a));return[i,r.getAvailableFormula(o)]}),(function(){return[e.getSparse(),void 0]})).strict()}),t)},e.prototype.parseFormula=function(e,t,r,n){var a=this.context.parser.parseFormula(Object(J.d)(r.lexicalKind,t,{refStyle:e}),n);if(!Object(S.d)(a))return a;var o=this.context.analyzer.checkFormula(r,a.value);if(!Object(S.d)(o))return o;if(!Object(g.eb)(o.value))return Object(S.c)(Object(i.o)("ill-formed indirect formula","indirect"));o.value;return o},e.prototype.getRandom=function(){this.precedents.special|=te.d.Calc;var e=this.globals.getRandom();return Object(S.d)(e)||Object(o.i)(e.reason),e.value},e.prototype.getTime=function(e){this.precedents.special|=te.d.Time;var t=this.globals.getTime(e,$.j.Volatile);return Object(S.d)(t)||Object(o.i)(t.reason),t.value},e.prototype.coerceOper=function(e,t){return de(this,e,t)},e.prototype.parseGeneral=function(e,t){var r,n=this.numberFormatter.parseGeneral(e,!1,t,$.j.NonVolatile);return Object(S.d)(n)||Object(o.i)(n.reason),null===(r=n.value)||void 0===r?void 0:r.value},e.prototype.parseDate=function(e){var t,r=this.numberFormatter.parseDate(e,$.j.NonVolatile);return Object(S.d)(r)||Object(o.i)(r.reason),null===(t=r.value)||void 0===t?void 0:t.value},e.prototype.getBinaryOperator=function(e){var t=this,r=Object(Z.c)(e),a=[O.i,O.i];return function(i,o){a[0]=i,a[1]=o,ue(t,a,r);var c=t.dispatchFunction(Object(z.l)(e),r,!1,a);return Object(n.h)("calc.runtime.FunctionDispatcher.getBinaryOperator",!ve(c)&&!Object(R.isMachineCall)(c)),c}},e.prototype.getUnaryOperator=function(e){var t=this,r=Object(Z.c)(e),a=[O.i];return function(i){a[0]=i,ue(t,a,r);var o=t.dispatchFunction(Object(z.l)(e),r,!1,a);return Object(n.h)("calc.runtime.FunctionDispatcher.getUnaryOperator",!ve(o)&&!Object(R.isMachineCall)(o)),o}},e.prototype.isInFilterMode=function(e){this.precedents.special|=te.d.InFilterMode;for(var t=0,r=e;t<r.length;t++){var n=r[t];if(Object(g.R)(n))for(var a=0,i=this.getSheetRangeIndexes(n.sheets);a<i.length;a++){var c=i[a],s=this.globals.isInFilterMode(Object(u.s)(n.sheets.document,c));if(!Object(S.d)(s))return Object(o.i)(s.reason);if(s.value)return!0}}return!1},e.prototype.printFormula=function(e,t){var r=Object(u.p)(e.source.range.sheet,t),n=Object(X.a)(this.globals,Object(Q.a)(u.a.Cell,Object(g.ib)(e.source.range)),t,e.formula);if(!Object(S.d)(n))return Object(o.i)(n.reason);var a=this.context.printer.printFormula(Object(be.b)(e.source,r,{refStyle:this.config.refStyle}),n.value);return Object(S.d)(a)?a.value:Object(o.i)(a.reason)},e.prototype.applyFormat=function(e,t,r,n){var a;if("number"==typeof t){var i=this.globals.getKnownFormat(e,t);if(!Object(S.d)(i))return Object(o.i)(i.reason);a=i.value}else{var c=Object(ee.b)(this.context.numberFormatter,this.globals,e,t,n);if(!Object(S.d)(c))switch(c.reason.kind){case $.g.PreviousFormatFailure:return;default:return Object(o.i)(c.reason)}a=c.value}var u=Object(ee.e)(this.context.numberFormatter,a,r);return Object(S.d)(u)?"string"==typeof u.value?u.value:void 0:Object(o.i)(u.reason)},e}(),ge=r(97),Oe=[void 0,O.n],je=[void 0,O.t],ye=function(){function e(e){this.fallback=e}return Object.defineProperty(e.prototype,"value",{get:function(){return void 0===this._value?this.fallback():this._value},set:function(e){this._value=e},enumerable:!1,configurable:!0}),e}(),Se=function(){return Object(o.i)(Object(g.hb)(["LETREC cycle"]))},Ce=function(){return Object(n.a)("calc.runtime.assertLambdaParam")};function ke(e){for(var t=e.lambda,r=e.args.slice();r.length<t.maxArity;)r.push(O.l);for(var n=[],a=[],i=0;i<t.defsAndBody.length-1;i+=1){var o=t.defIdents[i],c=r[r.length-1-o];c instanceof ye||!Object(g.J)(c)||(n.push(o),a.push(t.defsAndBody[i]),r[r.length-1-o]=new ye(Ce))}return a.push(t.defsAndBody[t.defsAndBody.length-1]),Object(z.d)(t.maxArity,t.locals,r,t.env,n,a)}var Ee=s.a.create((function(e,t){return e-t}));var Ae=function(){function e(e,t,r,n,a,i,o,c,u){this.context=e,this.locals=t,this.precedents=r,this.visitedCells=n,this.visitedNames=a,this.usage=i,this.target=o,this.isLambda=c,this.runStatus=!1,this.stackEnv=[],this.closureEnv=Ee,this.term=u,this.continuation=[]}return Object.defineProperty(e.prototype,"globals",{get:function(){return this.context.globals},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"numberFormatter",{get:function(){return this.context.numberFormatter},enumerable:!1,configurable:!0}),e.prototype.next=function(){try{return this.doNext()}catch(e){if(e instanceof o.a)return Object(o.h)(this.context,this.visitedCells,e.reason);throw e}},e.prototype.receiveResult=function(e){return Object(S.d)(e)?this.updateTermTransition(e.value):e},e.prototype.doNext=function(){if(Object(z.g)(this.term)){var e=this.continuation;if(0===e.length){var t=de(this,ce(this,this.term,this.target),this.target);return this.precedents.bound=O.b.Exact,!Object(C.e)(C.a.CalcPreventSpillingHack)||this.isLambda||this.locals.lexicalSource.kind!==u.a.Cell||!Object(g.x)(t)||1===t.rows&&1===t.cols?Object(S.f)(t):Object(S.c)(Object(g.hb)(["spilling"]))}var r=e[e.length-1];return this.applyContinuation(this.term,r)}return this.reduceFormula(this.term)},e.prototype.applyContinuation=function(e,t){var r=t.context;switch(r.kind){case z.a.App:var i=t.holeIndex,o=r.children.length;return(c=t.locals)[i]=e,i+1<o?this.nextHoleTransition(t,r.children[i+1]):this.dispatchFunction(c,c,r.data);case z.a.Conditional:var c;if(0===(i=t.holeIndex)){var u=Object(z.t)(r.data.funName),s=u===Z.b.IF?te.b.Boolean:te.b.Number,l=ce(this,e,s);if(Object(g.x)(l))return t.locals=[l],this.nextHoleTransition(t,r.children[i+1]);if(Object(g.T)(l))return Object(S.c)(Object(g.hb)(["IF/CHOOSE with a rich value condition"]));if(l=de(this,l,s),u===Z.b.IF&&Object(g.z)(l))return this.popContextTransition(r.children[l.value?1:2]);if(u===Z.b.CHOOSE&&Object(g.M)(l)){var d=this.context.globals.config.mathpack.fix(l);if(d<1||d>r.children.length-1){var f="CHOOSE; out of bounds option = ".concat(Object(a.a)(d));return Object(j.g)("calc.runtime.FormulaEvaluationMachine.applyContinuation",O.a.VALUE,f),this.popContextTransition(O.w)}return this.popContextTransition(r.children[d])}return Object(n.h)("calc.runtime.FormulaEvaluationMachine.applyContinuation",Object(g.E)(l)),this.popContextTransition(l)}return(c=t.locals)[i]=e,i+1<r.children.length?this.nextHoleTransition(t,r.children[i+1]):this.dispatchFunction(c,c,r.data);case z.a.Name:var b=this.popContextTransition(e),h=t.locals;return this.locals=h.locals,this.visitedNames=h.visitedNames,b;case z.a.Let:i=t.holeIndex;var v=r.children.length-1;if(i>=v){b=this.popContextTransition(e),h=t.locals;return this.stackEnv.length=h.stackEnvLen,b}if(r.data.rec){var p=this.stackEnv.length-v+i;this.stackEnv[p].value=e,this.stackEnv[p]=e}else this.stackEnv.push(e);return this.nextHoleTransition(t,r.children[i+1]);case z.a.Array:var m=ce(this,e,j.h),y=r.data,C=y.rows,k=y.cols,E=t.holeIndex,A=E%k,N=k===A+1,T=(E-A)/k,R=t.locals;if(R[T][A]=de(this,m,j.h),C===T+1&&N)return this.popContextTransition(Object(O.c)(C,k,R));var I=N?T+1:T,_=N?0:A+1;return this.nextHoleTransition(t,r.children[I][_]);case z.a.CallLambda:i=t.holeIndex;var F=r.children.length;if(i<F-1){p=this.stackEnv.length-1-r.data.defIdents[i];this.stackEnv[p]=e}if(i+1<F)return this.nextHoleTransition(t,r.children[i+1]);b=this.popContextTransition(e),h=t.locals;return this.locals=h.locals,this.stackEnv.length=h.stackEnvLen,this.closureEnv=h.closureEnv,this.usage.lambdaDepth-=1,b;default:return Object(n.e)("calc.runtime.FormulaEvaluationMachine.applyContinuation",r)}},e.prototype.reduceFormula=function(e){var t=this;switch(e.kind){case z.a.CellRef:return this.updateTermTransition(this.evalCellRefTerm(e));case z.a.StructRef:return this.updateTermTransition(this.evalStructRefTerm(e));case z.a.App:var r=e.data.funName;if(!Object(z.h)(r)){var a=Object(z.t)(r);if(a!==Z.b._UDF){var i=this.globals.getWorksheetFunc(a);if(i.kind===S.b.Failure)return Object(o.i)(i.reason)}}return 0===e.children.length?ve(c=new me(this.context,this.locals,this.precedents,this.visitedCells,this.visitedNames,this.usage).dispatchFunction(r,e.data.funType,e.data.isFormulaRoot,[]))?this.evaluateLambdaTransition(void 0,c):Object(R.isMachineCall)(c)?this.evaluateMachineTransition(void 0,c):this.updateTermTransition(c):this.pushContextTransition(e,e.children[0],[]);case z.a.CallLambda:return this.usage.lambdaDepth+=1,Object(T.p)(this.stackEnv,e.data.stackEnv),this.closureEnv=e.data.closureEnv,this.locals=Object(o.e)(e.data.capturedLocals,this.locals),this.usage.lambdaCalls[0]+=1,this.pushContextTransition(e,e.children[0],{locals:this.locals,stackEnvLen:this.stackEnv.length,closureEnv:this.closureEnv});case z.a.Conditional:return this.pushContextTransition(e,e.children[0],void 0);case z.a.Let:return this.evaluateLetTransition(e);case z.a.Name:var c;if(void 0!==(c=this.evalNameTerm(e))[0]){var s=c[0],l=c[1],d=c[2],f=this.pushContextTransition(e,l,{locals:this.locals,visitedNames:this.visitedNames});return this.locals=Object(o.f)(Object(u.j)(s),this.locals),this.visitedNames=d,f}var b=c[1];return this.updateTermTransition(b);case z.a.Udf:return this.updateTermTransition(this.evalUdfTerm(e));case z.a.ReadStack:var h=this.stackEnv[this.stackEnv.length-1-e.data];return Object(n.h)("calc.runtime.FormulaEvaluationMachine.reduceFormula: ReadStack oper",void 0!==h),this.updateTermTransition(h instanceof ye?h.value:h);case z.a.ReadClosure:var v=this.closureEnv.getValue(e.data[0]);Object(n.h)("calc.runtime.FormulaEvaluationMachine.reduceFormula: ReadClosure closure",void 0!==v);h=v[e.data[1]];return Object(n.h)("calc.runtime.FormulaEvaluationMachine.reduceFormula: ReadClosure oper",void 0!==h),h instanceof ye&&(h=h.value,v[e.data[1]]=h),this.updateTermTransition(h);case z.a.Array:return this.pushContextTransition(e,e.children[0][0],e.children.map((function(){return[]})));case z.a.Lambda:var p=e.data.closedIdents.map((function(e){var r=t.stackEnv[t.stackEnv.length-1-e];return Object(n.h)("calc.runtime.FormulaEvaluationMachine.reduceFormula: Lambda oper",void 0!==r),r}));v=this.closureEnv.setValue(e.data.closureId,p);return this.updateTermTransition(new k.a(e.data.maxArity,e.data.minArity,this.locals,v,e.data.defIdents,e.children));default:return Object(n.e)("calc.runtime.FormulaEvaluationMachine.reduceFormula",e)}},e.prototype.dispatchFunction=function(e,t,r){var n=r.funName,a=r.funType,i=r.isFormulaRoot;ue(this,t,a);var o=new me(this.context,this.locals,this.precedents,this.visitedCells,this.visitedNames,this.usage).dispatchFunction(n,a,i,t);return ve(o)?this.evaluateLambdaTransition(e,o):Object(R.isMachineCall)(o)?this.evaluateMachineTransition(e,o):this.popContextTransition(o)},e.prototype.pushContextTransition=function(e,t,r){var n=function(e,t){return{context:e,holeIndex:0,locals:t}}(e,r);return this.continuation[this.continuation.length]=n,this.updateTermTransition(t)},e.prototype.popContextTransition=function(e){return this.continuation.pop(),this.updateTermTransition(e)},e.prototype.evaluateMachineTransition=function(e,t){var r=t.machine;return void 0!==e&&this.continuation.pop(),Object(R.callMachineTransition)(r,this)},e.prototype.evaluateLambdaTransition=function(e,t){var r,n,a=this.continuation[this.continuation.length-1-(void 0!==e?1:0)],c=(null==a?void 0:a.context.kind)===z.a.CallLambda&&a.holeIndex===a.context.children.length-1?a:void 0;if(this.usage.lambdaCalls[0]+1>(null!==(r=this.globals.limits.maxLambdaCalls)&&void 0!==r?r:1/0))return Object(o.i)(Object(i.q)(i.c.LambdaCalls));if(void 0===c&&this.usage.lambdaDepth+1>(null!==(n=this.globals.limits.maxLambdaDepth)&&void 0!==n?n:1/0))return Object(o.i)(Object(i.q)(i.c.LambdaDepth));void 0!==e&&this.continuation.pop();var u,s=ke(t);return void 0!==c?(c.context=s,c.holeIndex=0,u=this.updateTermTransition(s.children[0]),this.stackEnv.length=c.locals.stackEnvLen):(u=this.pushContextTransition(s,s.children[0],{locals:this.locals,stackEnvLen:this.stackEnv.length,closureEnv:this.closureEnv}),this.usage.lambdaDepth+=1),Object(T.p)(this.stackEnv,s.data.stackEnv),this.closureEnv=s.data.closureEnv,this.locals=Object(o.e)(s.data.capturedLocals,this.locals),this.usage.lambdaCalls[0]+=1,u},e.prototype.evaluateLetTransition=function(e){var t=this.pushContextTransition(e,e.children[0],{stackEnvLen:this.stackEnv.length});if(e.data.rec)for(var r=e.children.length-1,n=0;n<r;n+=1)this.stackEnv.push(new ye(Se));return t},e.prototype.nextHoleTransition=function(e,t){return e.holeIndex+=1,this.updateTermTransition(t)},e.prototype.updateTermTransition=function(e){return this.term=e,R.nextTransition},e.prototype.getNameFormulaAsTerm=function(e,t){this.precedents.names.push(e);var r=this.globals.getNameFormula(e,t);if(r.kind===S.b.Failure)return Object(o.i)(r.reason);var n=r.value;return null!=n?Object(ge.a)("calc.runtime.FormulaEvaluationMachine.getNameFormulaAsTerm",n):void 0},e.prototype.checkForNameCycle=function(e){var t,r=this.visitedNames,n=r.map.getValue(e);if(void 0!==n){var a=function(e,t){for(var r=[],n=t;r.push(n.name),n!==e;n=n.previous);return r.reverse(),Object(i.r)(r)}(n,r.current);return Object(o.i)(a)}return this.visitedNames.map.getCount()+1>(null!==(t=this.globals.limits.maxNameChain)&&void 0!==t?t:1/0)?Object(o.i)(Object(i.q)(i.c.NameChain)):function(e,t){var r={name:t,previous:e.current};return p(r,e.map.setValue(t,r))}(this.visitedNames,e)},e.prototype.evalNameTerm=function(e){var t=this.context.resolver.resolveName(this.locals,Object(K.X)(Object(K.M)(e.data.name,!0),e.data.qualifier),e.data.source).resolution;if(!Object(S.d)(t)){if(t.reason.kind===Y.d.NoOriginSheet){var r="error ref, no sheet, qualifier = ".concat(Object(a.a)(e.data.qualifier));return Object(j.g)("calc.runtime.FormulaEvaluationMachine.evalName",O.a.REF,r),je}var n=e.children;return t.reason.kind===Y.d.InvalidQualifier&&void 0!==n?[void 0,n]:Object(o.i)(t.reason)}var i,c=t.value;if(void 0===c||void 0===(i=this.getNameFormulaAsTerm(c,e.data.source))){if(void 0===(n=e.children)){r="error ref, qualifier = ".concat(Object(a.a)(e.data.qualifier));return Object(j.g)("calc.runtime.FormulaEvaluationMachine.evalName",O.a.NAME,r),Oe}return[void 0,n]}return[c,i,this.checkForNameCycle(c)]},e.prototype.evalCellRefTerm=function(e){var t=this.context.resolver.resolveCellRef(this.locals,Object(K.u)(e.data.ref,e.data.qualifier)).resolution;if(!Object(S.d)(t)){if(t.reason.kind===Y.d.NoOriginSheet){var r="error ref, no sheet, qualifier = ".concat(Object(a.a)(e.data.qualifier));return Object(j.g)("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",O.a.REF,r),O.t}return Object(o.i)(t.reason)}var n=t.value;if(!n){r="error ref, qualifier = ".concat(Object(a.a)(e.data.qualifier));return Object(j.g)("calc.runtime.FormulaEvaluationMachine.evalCellRefTerm",O.a.REF,r),O.t}return Object(O.r)(n.sheet,n.range)},e.prototype.evalStructRefTerm=function(e){var t=this.context.resolver.resolveStructRef(this.locals,e.data).resolution;if(!Object(S.d)(t)){if(t.reason.kind===Y.d.NoOriginSheet){var r="error ref, no sheet, struct ref = ".concat(Object(a.a)(e.data));return Object(j.g)("calc.runtime.FormulaEvaluationMachine.evalStructRefTerm",O.a.REF,r),O.t}if(t.reason.kind===Y.d.EmptyIntersection){r="error ref, empty intersection, struct ref = ".concat(Object(a.a)(e.data));return Object(j.g)("calc.runtime.FormulaEvaluationMachine.evalStructRefTerm",O.a.VALUE,r),O.w}return Object(o.i)(t.reason)}var n=t.value;if(!n){r="error ref, struct ref = ".concat(Object(a.a)(e.data));return Object(j.g)("calc.runtime.FormulaEvaluationMachine.evalStructRefTerm",O.a.REF,r),O.t}return Object(O.r)(n.sheet,n.range)},e.prototype.evalUdfTerm=function(e){var t=this.context.resolver.resolveUserDefinedFunc(this.locals,Object(K.X)(Object(K.M)(e.data.name,!0),e.data.qualifier)).resolution;if(!Object(S.d)(t)){var r=e.children;if(t.reason.kind===Y.d.InvalidQualifier&&void 0!==r)return r;Object(o.i)(t.reason)}var n=t.value;if(!n){if(void 0===(r=e.children)){var i="UDF resolution, qualifier = ".concat(Object(a.a)(e.data.qualifier));return Object(j.g)("calc.runtime.FormulaEvaluationMachine.evalUdfTerm",O.a.NAME,i),O.n}return r}if(n.length>1){i="UDF resolution, ambiguous name";return Object(j.g)("calc.runtime.FormulaEvaluationMachine.evalUdfTerm",O.a.NAME,i),O.n}var c=this.globals.getUserDefinedFunc(n[0]);return Object(S.d)(c)||Object(o.i)(c.reason),new pe(c.value)},e}();function Ne(e,t,r,n,a){return new Ae(e,t,r,n,m,Object(o.g)([0],0),j.d,!1,Object(ge.a)("calc.runtime.createFormulaEvaluationMachine",a))}function Te(e,t,r,n,a,i,o,c){var u=ke(he(o,c));return new Ae(e,t,r,n,a,i,te.c.All,!0,u)}function Re(e,t,r){var n,a=B(e),c=Object(o.c)(),u=Ne(a.machineContext,t,c,v,r),s=new G(a,[u]),l=P(null!==(n=t.schedulerConfig)&&void 0!==n?n:e.schedulerConfig);return function e(t){return Array.isArray(t)?t[0]:Object(i.s)((function(r){return e(t.resume(r))}))}(s.evaluateSync(l))}function Ie(e){return{evalFormula:function(t,r){return Re(e,t,r)},evalCells:function(t){return function(e,t){if(0===t.length)return[];var r=N(e,t),n=P(e.schedulerConfig);return r.evaluateSync(n)}(e,t)},evalCellsAsync:function(t){return function(e,t){if(0===t.length)return Promise.resolve([]);var r=N(e,t),n=P(e.schedulerConfig);return r.evaluateAsync(n)}(e,t)}}}r.d(t,"a",(function(){return Ie}))},function(e,t,r){"use strict";var n,a=r(9),i=r(5),o=r(12),c=r(1),u=r(2),s=r(19),l=r(71);function d(e,t){for(var r in e)if(!t(r,e[r]))return!1;return!0}!function(e){e.Root="calc.exp.UnitExperiment",e.Default="uninitialised",e.Initialised="init",e.Failure="fail",e.UnifyBound="unifyBound"}(n||(n={}));var f=function(e,t){return d(e.consts,t)};function b(e,t){var r=0;!function(e,t){for(var r in e)t(r,e[r])}(t.vars,(function(){return r+=1})),Object(i.h)(e,void 0===t.name||1===t.varCount),Object(i.h)(e,t.varCount===r)}function h(e,t,r){var a={varCount:e,vars:t,consts:r,name:void 0};return b(n.Root,a),a}function v(){}function p(){return new v}var m=p();function g(){return h(0,{},p())}function O(e){return h(0,{},e)}function j(e){var t,r=h(1,((t={})[e]=1,t),m);return r.name=e,r}var y=function(){return!1};function S(e){if(0===e.varCount)return!0;if(void 0!==e.name)return!0;if(1===e.varCount&&(e.consts===m||f(e,y))){var t=function(e,t){for(var r in e.vars)return t===e.vars[r]?r:void 0}(e,1);return void 0!==t&&(e.name=t,!0)}return!1}function C(e,t){return r=function(e,r){return t.vars[e]===r},d(e.vars,r)&&f(e,(function(e,r){return t.consts[e]===r}));var r}function k(e,t){var r,a,i=g(),o=e.vars,c=e.consts,u=t.vars,s=t.consts;for(var l in o){0!==(d=o[l]+(null!==(r=u[l])&&void 0!==r?r:0))&&(i.vars[l]=d,i.varCount+=1)}for(var l in c){var d;0!==(d=c[l]+(null!==(a=s[l])&&void 0!==a?a:0))&&(i.consts[l]=d)}for(var l in u)void 0===o[l]&&(i.vars[l]=u[l],i.varCount+=1);for(var l in s)void 0===c[l]&&(i.consts[l]=s[l]);return b(n.Root,i),i}function E(e,t,r){var n=t.vars,a=t.consts,i=n[e];if(void 0===i)return t;var o=0,c=g(),u=c.vars,s=c.consts;for(var l in n){var d=r.vars[l],f=void 0===d?0:d;0!==(b=(l===e?0:n[l])+f*i)&&(o+=1,u[l]=b)}for(var l in r.vars){void 0===n[l]&&(o+=1,u[l]=i*r.vars[l])}for(var l in a){var b,v=r.consts[l];0!==(b=a[l]+i*(void 0===v?0:v))&&(s[l]=b)}for(var l in r.consts){void 0===a[l]&&(s[l]=i*r.consts[l])}return h(o,u,s)}var A=function(){},N={kind:1,substitution:A},T=function(e){return{kind:1,substitution:e}},R={kind:0},I=function(e){return e<0?-e:e};function _(e,t,r){var n={};return r===A?t:t===A?r:function(a){var i=n[a];if(void 0!==i)return i;var o=r(a);return n[a]=void 0===o?t(a):e(t,o)}}function F(e,t){return function(r){return e===r?t:void 0}}var w=function(e,t,r){return function e(t,r,a){if(t>=100)return Object(i.a)(n.UnifyBound);if(0===a.varCount)return f(a,y)?N:R;if(1===a.varCount){var o;for(var c in a.vars){o=c;break}Object(i.h)(n.Root,void 0!==o);var u=a.vars[o],s={};for(var l in a.consts){if((j=a.consts[l])%u!=0)return R;s[l]=-j/u}return T(F(o,O(s)))}var d,b=0,v=void 0,p=a.vars,m=a.consts,g=a.varCount;for(var l in p){var j=p[l],S=I(j);(void 0===v||S<v)&&(b=j,v=S,d=l)}Object(i.h)(n.Root,void 0!==d),Object(i.h)(n.Root,0!==b);var C={},k={};for(var l in p)if(l===d)C[l]=1;else{j=p[l];C[l]=-Math.floor(j/b)}for(var l in m){j=m[l];k[l]=-Math.floor(j/b)}var A=h(g,C,k),w=e(t+1,r,E(d,a,A));return 0===w.kind?w:T(_(r,w.substitution,F(d,A)))}(0,e,function(e,t){var r,a,i=g(),o=e.vars,c=e.consts,u=t.vars,s=t.consts;for(var l in o){0!==(d=o[l]-(null!==(r=u[l])&&void 0!==r?r:0))&&(i.vars[l]=d,i.varCount+=1)}for(var l in c){var d;0!==(d=c[l]-(null!==(a=s[l])&&void 0!==a?a:0))&&(i.consts[l]=d)}for(var l in u)void 0===o[l]&&(i.vars[l]=-u[l],i.varCount+=1);for(var l in s)void 0===c[l]&&(i.consts[l]=-s[l]);return b(n.Root,i),i}(t,r))},M=r(3),D=r(8);function P(e,t){return void 0===t&&(t=void 0),{kind:0,flags:e,unit:t}}function x(e){return{kind:1,reference:e,resolution:void 0}}function L(e,t){return{kind:2,elementType:e,dimensions:t}}function B(e){return{kind:3,flags:e}}function U(e){var t;switch(e.kind){case 1:var r=null===(t=e.resolution)||void 0===t?void 0:t.range;return void 0!==r&&(!!Object(M.F)(r)||{rows:r.rows,columns:r.cols,exact:!0});case 2:return e.dimensions;case 0:return!0;case 3:return!1}}function G(e,t){return function(e,t){if("object"==typeof e)return"object"==typeof t?{rows:Math.max(e.rows,t.rows),columns:Math.max(e.columns,t.columns),exact:e.exact&&t.exact}:Object(a.__assign)(Object(a.__assign)({},e),{exact:e.exact&&t});if("object"==typeof t)return Object(a.__assign)(Object(a.__assign)({},t),{exact:t.exact&&e});return e&&t}(U(e),U(t))}function V(e,t){return!0===t?e:L(e,t)}var H,W=P(D.b.Boolean),z=P(D.b.String),q=P(D.b.Number),K=O({}),Y=P(D.b.Number,K),J=P(D.b.Error),Q=P(D.b.Missing|D.b.Blank),X=B(D.c.None),Z=B(D.c.All),$=P(D.b.Number|D.b.Boolean|D.b.String),ee=function(e){return P(D.b.Number|D.b.Boolean|D.b.String,e)};!function(e){e[e.Checking=0]="Checking",e[e.SolvingSimple=1]="SolvingSimple",e[e.SolvingFull=2]="SolvingFull"}(H||(H={}));var te,re=function(){function e(){this.roots=[],this.backlinks=[],this.descriptors=[],this.ranks=[]}return e.prototype.makePoint=function(e){var t=this.roots.length;return this.roots.push(t),this.backlinks.push(t),this.descriptors.push(e),this.ranks.push(0),t},e.prototype.find=function(e){for(var t=this.roots,r=e;t[r]!==r;)t[r]=t[t[r]],r=t[r];return r},e.prototype.findWithDescriptor=function(e){var t=this.find(e);return[t,this.descriptors[t]]},e.prototype.union=function(e,t,r){void 0===r&&(r=!1);var n=this.find(e),a=this.find(t);if(n!==a){var i=this.roots,o=this.backlinks,c=this.ranks;if(r){var u=o[a];return o[a]=o[n],o[n]=u,i[a]=n,void(c[n]<=c[a]&&(c[n]=c[a]+1))}if(c[n]<c[a]){u=o[n];o[n]=o[a],o[a]=u,i[n]=a}else{u=o[a];o[a]=o[n],o[n]=u,i[a]=n,c[n]===c[a]&&(c[n]+=1)}}},e.prototype.forEachInClass=function(e,t){var r=this.backlinks,n=e;for(t(n);r[n]!==e;)t(n=r[n])},e}(),ne=r(26),ae=r(16),ie=r(24),oe=r(6),ce=r(0),ue={kind:0},se=function(e){return{kind:2,constraint:e}},le=O({error:1}),de=O({}),fe=O({currency:1}),be=O({date:1}),he=O({time:1});function ve(e,t,r){var n,a=new re,i=a.makePoint(le),o=(n=le,function(e,t){if(0===t.varCount||e===A)return t;var r=t;for(var a in t.vars){var i=e(a);if(i===n)return n;void 0!==i&&(r=E(a,r,i))}return r});return{symbolContext:e,typeContext:t,stats:r,uf:a,errorPoint:i,errorUnit:le,apply:o}}function pe(e,t){return void 0===t.link&&(t.link=e.uf.makePoint(t.unit)),t.link}function me(e,t,r,a){return Object(i.h)(n.Root,0===r.varCount),e.uf.union(void 0===a?e.uf.makePoint(r):a,t,!0),ue}function ge(e,t,r,a,o){return t===e.errorUnit?(Object(i.h)(n.Root,r===e.errorPoint),void 0!==o&&e.uf.union(e.errorPoint,o,!0),ue):a===e.errorUnit?(Object(i.h)(n.Root,o===e.errorPoint),void 0!==r&&e.uf.union(e.errorPoint,r,!0),ue):0===t.varCount?0===a.varCount?C(c=t,u=a)&&C(u,c)?ue:(void 0!==r&&e.uf.union(e.errorPoint,r,!0),void 0!==o&&e.uf.union(e.errorPoint,o,!0),{kind:1,error:[t,a]}):(Object(i.h)(n.Root,void 0!==o),me(e,o,t,r)):1===a.varCount?(Object(i.h)(n.Root,void 0!==r),Object(i.h)(n.Root,void 0!==o),e.uf.union(r,o),ue):(Object(i.h)(n.Root,void 0!==r),me(e,r,a,o));var c,u}function Oe(e,t,r){if(!S(t))return se({kind:2,unit:t,target:r});var a=pe(e,r),o=e.uf.findWithDescriptor(a),c=o[0],u=o[1];if(1===t.varCount){Object(i.h)(n.Root,void 0!==t.name);var s=e.symbolContext.getTable().getValue(t.name);Object(i.h)(n.Root,void 0!==s);var l=e.uf.findWithDescriptor(pe(e,s)),d=l[0];return ge(e,l[1],d,u,c)}return ge(e,t,void 0,u,c)}function je(e,t){if(t===ae.f.Unavailable||0===t)return!1;var r=Se(e,t);if(void 0===r)return!1;var n=null==r?void 0:r.valueType;return void 0!==n&&n!==oe.h.General&&(n!==oe.h.Currency&&n!==oe.h.Accounting||void 0!==r.currencySymbol)}function ye(e,t,r,n){var a,i,o;if(n?r.referencedFormatCells+=1:r.allFormatCells+=1,we.LogDNM){var c=Se(e,t),u=n?r.enriched.referencedFormatTypes:r.enriched.allFormatTypes,s=null==c?void 0:c.valueType;if(void 0!==s&&(u[s]=(null!==(a=u[s])&&void 0!==a?a:0)+1),s===oe.h.Currency||s===oe.h.Accounting){var l=n?r.enriched.referencedCurrencyTypes:r.enriched.allCurrencyTypes,d=null==c?void 0:c.currencySymbol,f=null===(i=null==c?void 0:c.culture)||void 0===i?void 0:i.culture,b=void 0===d?"none":d===oe.f.LocaleInfo?"defaultSymbol":d+"_"+f;l[b]=(null!==(o=l[b])&&void 0!==o?o:0)+1}}}function Se(e,t){if("number"==typeof t){var r=e.getIformat(t);return Object(ce.d)(r)?r.value:void 0}return t}function Ce(e,t,r){var a=e.typeContext.types[t.index];if(void 0===a)return Object(i.a)(n.Root);var c=a.getValue(r);if(void 0===c){var u=Object(o.p)(t,r),s=e.typeContext.formats(u);if(Object(ce.d)(s)){if(!je(e.typeContext,s.value)||e.typeContext.isStringValue(u)){var l=e.symbolContext.freshSymbol().unit;return e.typeContext.types[t.index]=a.setValue(r,ee(l)),l}var d=ke(e,s.value);return void 0===d?d=e.symbolContext.freshSymbol().unit:ye(e.typeContext,s.value,e.stats,!0),e.typeContext.types[t.index]=a.setValue(r,ee(d)),d}var f=e.symbolContext.freshSymbol().unit;return e.typeContext.types[t.index]=a.setValue(r,ee(f)),f}return 0===c.kind?c.unit:void 0}function ke(e,t){var r=function(e,t){var r;return null===(r=Se(e,t))||void 0===r?void 0:r.valueType}(e.typeContext,t);if(void 0!==r)switch(r){case oe.h.Currency:case oe.h.Accounting:return fe;case oe.h.Percentage:return de;case oe.h.Date:return we.UnitlessTimeAndDate?de:be;case oe.h.Time:return we.UnitlessTimeAndDate?de:he;default:return}}var Ee=((te={})[2]=function(e,t){return Oe(e,t.unit,t.target)},te[3]=function(e,t){var r=ke(e,t.format);if(void 0===r)return ue;var a=Ce(e,t.cell.sheet,t.cell.range);if(void 0===a)return ue;if(!S(a))return se(t);if(1===a.varCount){Object(i.h)(n.Root,void 0!==a.name);var o=e.symbolContext.getTable().getValue(a.name);Object(i.h)(n.Root,void 0!==o);var c=e.uf.findWithDescriptor(pe(e,o)),u=c[0];return ge(e,c[1],u,r,void 0)}return ge(e,a,void 0,r,void 0)},te[0]=function(e,t){var r=t.type.resolution;if(!Object(M.Y)(r.sheet))return ue;if(Object(M.F)(r.range)){var n=Ce(e,r.sheet,r.range);return void 0===n?ue:Oe(e,n,t.target)}var a=e.typeContext.available[r.sheet.index];if(void 0===a)return ue;var i=a.usedRange;if(void 0===i)return ue;var o=Object(M.q)(r.range,i);if(void 0===o)return ue;var c=Object(ie.g)(Object(ie.g)(Object(ne.f)(o),ne.b),a.availableCells),u=[];return Object(ne.g)(c,(function(e){return u.push(e),!0})),{kind:3,constraint:{kind:1,cursor:0,index:a.sheetIdx,cells:u,target:t.target},output:void 0}},te[1]=function(e,t){var r=t.cursor,n=t.cells;if(r>=n.length)return ue;var a=n[r],i=Ce(e,t.index,a),o=void 0===i?ue:Oe(e,i,t.target);return t.cursor+=1,{kind:3,constraint:t,output:o}},te);function Ae(e){return e.kind===H.SolvingSimple?e.constraintCursor===e.constraints.length?function(e){var t,r,n=e.context,a=n.apply,i=n.errorUnit,o={kind:H.SolvingFull,context:e.context,stats:e.stats,constraints:e.deferred,constraintCursor:0,unifyNF:function(e,t){var r=a(o.substitution,e);if(r!==i){var n=a(o.substitution,t);if(n!==i){var c=w(a,r,n);1!==c.kind?(o.stats.errorCount+=1,we.LogDNM&&o.stats.enriched.errors.push({error:[a(o.substitution,e),a(o.substitution,t)]})):o.substitution=_(a,c.substitution,o.substitution)}}},substitution:(t=e.context,r=t.symbolContext.getTable(),function(e){var n=r.getValue(e);if(void 0!==n&&void 0!==n.link)return void 0===n.ufSubstitution&&(n.ufSubstitution=t.uf.findWithDescriptor(n.link)[1]),n.ufSubstitution})};return o}(e):function(e){var t=e.constraints,r=e.context,n=e.constraintCursor,a=e.deferred,i=t[n],o=Ee[i.kind](r,i);switch(o.kind){case 2:a.push(o.constraint);break;case 1:e.stats.errorCount+=1,we.LogDNM&&e.stats.enriched.errors.push({error:o.error});break;case 3:if(t[n]=o.constraint,void 0!==o.output)switch(o.output.kind){case 2:a.push(o.output.constraint);break;case 1:e.stats.errorCount+=1,we.LogDNM&&e.stats.enriched.errors.push({error:o.output.error})}return e}return e.constraintCursor+=1,e}(e):function(e){var t=e.constraints,r=e.context,a=e.constraintCursor,o=e.unifyNF,c=t[a];switch(c.kind){case 2:o(c.unit,c.target.unit);break;case 3:var u=ke(r,c.format);if(void 0===u)break;var s=Ce(r,c.cell.sheet,c.cell.range);if(void 0===s)break;o(u,s);break;default:return e.constraintCursor+=1,Object(i.e)(n.Root,c)}return e.constraintCursor+=1,e}(e)}var Ne=r(54),Te=r(18),Re=r(75),Ie=r(29),_e=r(22),Fe=r(70);r.d(t,"a",(function(){return we}));var we=function(){function e(){this.isDone=!1,this.lastStepMessage="before started",e.IgnoreDivMul=Object(Fe.getBooleanFeatureGate)("Microsoft.Office.Excel.UnitExpIgnoreDivMul",!1),e.UnitlessTimeAndDate=Object(Fe.getBooleanFeatureGate)("Microsoft.Office.Excel.UnitlessTimeAndDate",!1),e.LogDNM=Object(Fe.getBooleanFeatureGate)("Microsoft.Office.Excel.UnitExpLogDNM",!1)}return Object.defineProperty(e.prototype,"done",{get:function(){return this.isDone},enumerable:!1,configurable:!0}),e.prototype.freshCheckingState=function(e){var t=this;this.lastStepMessage="freshCheckingState";var r=[],n={};e.getServerAvailableCells().forEach((function(i){var o,c=e.getServerUsedRange(i.sheetIdx);if(c.kind!==ce.b.Success)return t.isDone=!0,void(t.statsMessage="Unit experiment: getServerUsedRange failed");var u=Object(a.__assign)(Object(a.__assign)({},i),{usedRange:null===(o=c.value)||void 0===o?void 0:o.range});n[i.sheetIdx.index]=u,r.push(u)}));var i=void 0===e.getServerDocument()?function(){return Object(ce.c)(void 0)}:function(t){return e.getIformat(e.getServerDocument(),t)};return{kind:H.Checking,locale:e.config.localeInfo,mathpack:e.config.mathpack,resolver:Object(l.a)(e),documentTypeContext:{formats:function(t){return e.getServerFormat(t)},types:{},available:n,getIformat:i,isStringValue:function(t){if(void 0===e.getServerDocument())return!1;var r=e.getServerValue(t);return r.kind===ce.b.Success&&r.value.oper.kind===D.b.String}},constraints:[],stats:{formulaCells:0,referencedFormatCells:0,allFormatCells:0,totalCells:0,errorCount:0,enriched:{errors:[],referencedFormatTypes:{},allFormatTypes:{},referencedCurrencyTypes:{},allCurrencyTypes:{}}},sheets:r,mutableState:{symbolContext:Me.init(),ranges:void 0,cells:void 0,sheetCursor:0,rangeCursor:0,cellCursor:0}}},e.prototype.freshSolvingState=function(e){return this.lastStepMessage="freshSolvingState",{kind:H.SolvingSimple,stats:e.stats,context:ve(e.mutableState.symbolContext,e.documentTypeContext,e.stats),constraints:e.constraints,constraintCursor:0,deferred:[]}},e.prototype.step=function(){if(!this.isDone){if(void 0===this.documentContext)return this.isDone=!0,Object(i.e)("".concat(n.Root,".").concat(n.Initialised),this.documentContext);void 0===this.state&&(this.state=this.freshCheckingState(this.documentContext));try{var e=this.state;switch(e.kind){case H.Checking:return e.mutableState.sheetCursor<e.sheets.length?void(this.state=this.runCheckStep(this.documentContext,e)):void(this.state=this.freshSolvingState(e));case H.SolvingSimple:return this.lastStepMessage="SolvingSimple",void(this.state=Ae(e));case H.SolvingFull:return e.constraintCursor<e.constraints.length?(this.lastStepMessage="SolvingFull",void(this.state=Ae(e))):(this.lastStepMessage="done SolvingFull",this.isDone=!0,void(this.statsMessage=this.statsForLogging(e.stats)))}}catch(e){return this.statsMessage="".concat(n.Root,".").concat(n.Failure,": ").concat(Object(Te.c)(e)),void(this.isDone=!0)}}},e.prototype.setContext=function(e){var t=e.documents;this.documentContext=t},e.prototype.initialiseSheetStep=function(e){this.lastStepMessage="initialiseSheetStep";var t=e.mutableState,r=e.sheets[t.sheetCursor],n=r.usedRange,a=[];if(void 0!==n){var i=Object(ie.g)(r.availableCells,ne.b);Object(ne.i)(i,(function(e){var t=Object(M.q)(e,n);if(void 0!==t){if(Object(M.u)(t)<250)return a.push(t),!0;Object(M.e)(t,15,(function(e){return a.push(e),!0}))}return!0}))}return t.ranges=a,t.rangeCursor=0,e.documentTypeContext.types[r.sheetIdx.index]=Object(Re.a)(),e},e.prototype.initialiseRangeCells=function(e,t){this.lastStepMessage="initialiseRangeCells";var r=t.mutableState,n=t.stats,a=t.sheets,i=r.sheetCursor,c=[],u=a[i],s=r.ranges[r.rangeCursor];return e.forEachServerNonBlankCellInSet(u.sheetIdx,Object(ne.f)(s),(function(r){var a,i=Object(o.p)(u.sheetIdx,r),s=e.getServerFormula(i);s.kind===ce.b.Success&&void 0!==(null===(a=s.value)||void 0===a?void 0:a[1].compiledFmla)&&(c.push(s.value[1]),n.formulaCells+=1);var l=e.getServerFormat(i);return l.kind===ce.b.Success&&je(t.documentTypeContext,l.value)&&ye(t.documentTypeContext,l.value,n,!1),n.totalCells+=1,!0})),r.cells=c,r.cellCursor=0,t},e.prototype.checkCell=function(e,t){this.lastStepMessage="checkCell";var r=t.sheets,a=t.constraints,c=t.stats,u=t.mutableState,s=u.cells,l=u.sheetCursor,d=u.cellCursor,f=r[l],b=s[d],h=b.compiledFmla.getValue();if(h.kind===ce.b.Success){var v=Object(o.p)(f.sheetIdx,b.origin),p=function(e,t,r){var a=e.constraints,o=e.locale,c=e.mathpack,u=e.resolver,s=e.documentTypeContext,l=s.types[t.sheet.index],d=e.mutableState.symbolContext.copy(),f={origin:t,locale:o,mathpack:c,resolver:u,symbolContext:d,pushConstraint:function(e){return void 0!==e&&(a.push(e),!0)}},b=function(e,t){return Object(Ie.n)(new Ve(e),t)}(f,r),h=Le(f,b),v=function e(t,r){switch(r.kind){case 0:if(void 0===r.unit){var a=t.symbolContext.freshSymbol();return P(r.flags,a.unit)}return r;case 2:for(var o=r,c=[];2===o.kind;)c.push(o.dimensions),o=o.elementType;var u=e(t,o);return c.reduceRight(L,u);case 1:case 3:return r;default:return Object(i.e)(n.Root,r)}}(f,void 0===h?Z:h);if(1===v.kind){var p=d.freshSymbol(),m={kind:0,type:v,target:p};v=ee(p.unit),a.push(m)}if(e.mutableState.symbolContext=d,2===v.kind)return l;return l.setValue(t.range,v)}(t,v,h.value);t.documentTypeContext.types[f.sheetIdx.index]=p;var m=e.getServerFormat(v);m.kind===ce.b.Success&&je(t.documentTypeContext,m.value)&&(a.push({kind:3,cell:v,format:m.value}),ye(t.documentTypeContext,m.value,c,!0))}return t.mutableState.cellCursor+=1,t},e.prototype.runCheckStep=function(e,t){if(!function(e){return void 0!==e.mutableState.ranges}(t))return this.initialiseSheetStep(t);var r=t.mutableState;return r.rangeCursor===r.ranges.length?(r.ranges=void 0,r.sheetCursor+=1,t):function(e){return void 0!==e.mutableState.cells}(t)?r.cellCursor<t.mutableState.cells.length?this.checkCell(e,t):(r.cells=void 0,r.rangeCursor+=1,t):this.initialiseRangeCells(e,t)},e.prototype.statsForLogging=function(t){if(e.LogDNM||void 0===t)return JSON.stringify(t);var r=t.formulaCells,n=t.referencedFormatCells,a=t.totalCells,i=t.errorCount;return JSON.stringify({formulaCells:r,referencedFormatCells:n,totalCells:a,errorCount:i})},Object.defineProperty(e.prototype,"resultLogMessage",{get:function(){var e;return null!==(e=this.statsMessage)&&void 0!==e?e:"".concat(n.Root,".").concat(n.Default)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"failedLogMessage",{get:function(){var e,t,r,n,a,i=null===(e=this.state)||void 0===e?void 0:e.kind,o=(null===(t=this.state)||void 0===t?void 0:t.kind)===H.Checking&&0===(null===(r=this.state)||void 0===r?void 0:r.mutableState.cellCursor);return"Units experiment timed out. Last step: ".concat(this.lastStepMessage,". Experiment state: ").concat(void 0!==i?H[i]:"NotStarted",". isCellCursorZero: ").concat(o,". Number of constraints: ").concat(null===(n=this.state)||void 0===n?void 0:n.constraints.length,". Stats: ").concat(this.statsForLogging(null===(a=this.state)||void 0===a?void 0:a.stats))},enumerable:!1,configurable:!0}),e.IgnoreDivMul=!1,e.UnitlessTimeAndDate=!1,e.LogDNM=!1,e}(),Me=function(){function e(e,t){this.seed=e,this.table=t}return e.init=function(){return new e(0,Ne.a.create((function(e,t){return e.localeCompare(t)})))},e.prototype.getTable=function(){return this.table},e.prototype.freshSymbol=function(e){var t="".concat(void 0===e?"gen":e,"@").concat(this.seed+=1),r={unit:j(t),link:void 0,ufSubstitution:void 0};return this.table=this.table.setValue(t,r),r},e.prototype.copy=function(){return new e(this.seed,this.table)},e}();function De(e,t,r){switch(e.kind){case 2:if(1===e.elementType.kind)return;return r?De(e.elementType,t,!1):void 0;case 1:return{kind:0,type:e,target:t};case 0:return void 0===e.unit?void 0:{kind:2,unit:e.unit,target:t};case 3:return;default:return Object(i.e)(n.Root,e)}}function Pe(e,t,r){switch(t.kind){case 2:if(1===t.elementType.kind)return;return r?Pe(e,t.elementType,!1):void 0;case 1:var a=e.symbolContext.freshSymbol(),o={kind:0,type:t,target:a};return[a.unit,o];case 0:return void 0===t.unit?void 0:[t.unit,void 0];case 3:return;default:return Object(i.e)(n.Root,t)}}function xe(e){var t=e.length;if(0===t)return Z;for(var r,n,a=X,i=e[0].length,o=0;o<e.length;o+=1)for(var c=e[o],u=0;u<c.length;u+=1)r=a,n=c[u],a=r===X?n:n===X||r===Z?r:n===Z?n:0===r.kind&&0===n.kind&&void 0===r.unit&&void 0===n.unit?P(r.flags|n.flags):Z;return L(a,{rows:t,columns:i,exact:!0})}function Le(e,t){if(1===t.kind&&void 0===t.resolution){var r=function(e,t){var r=Object(s.k)(e.origin),n=e.resolver.resolveCellRef(r,t.reference).resolution;return!!Object(ce.d)(n)&&(!n.value||n.value)}(e,t);return"object"==typeof r?function(e,t){var r=x(e);return r.resolution=t,r}(t.reference,r):r?J:void 0}if(2===t.kind){var n=Le(e,t.elementType);return void 0===n?n:n===t.elementType?t:L(n,t.dimensions)}return t}function Be(e,t,r,n,a){var i=e.symbolContext.freshSymbol(),o=De(t,i,n),c=De(r,i,n);if(void 0!==o&&void 0!==c||a&&(void 0!==o||void 0!==c))return e.pushConstraint(o),e.pushConstraint(c),i}function Ue(e,t,r){if(r.length<2)return Z;var a=Le(e,r[0][0]),o=Le(e,r[1][0]);if(void 0===a||void 0===o)return Z;var u=G(a,o);if(!1===u)return Z;var s="object"==typeof u;switch(t){case c.a.Add:case c.a.Sub:case c.a.Min:case c.a.Max:var l=Be(e,a,o,s,!0);return V(void 0===l?q:P(D.b.Number,l.unit),u);case c.a.Eq:case c.a.Ne:case c.a.Lt:case c.a.Le:case c.a.Gt:case c.a.Ge:return Be(e,a,o,s,!1),V(W,u);case c.a.Mul:case c.a.Div:if(we.IgnoreDivMul)return q;var d=e.symbolContext.freshSymbol(),f=e.symbolContext.freshSymbol(),h=De(a,d,s),v=De(o,f,s);if(e.pushConstraint(h),e.pushConstraint(v),void 0===h&&void 0===v)return V(q,u);var p=t===c.a.Mul?k(d.unit,f.unit):k(d.unit,function(e){var t=g(),r=e.vars,a=e.consts;for(var i in r)t.vars[i]=-r[i];for(var i in a)t.consts[i]=-a[i];return t.varCount=e.varCount,b(n.Root,t),t}(f.unit));return V(P(D.b.Number,p),u);case c.a.Pow:var m=r[1][1];if(Object(M.L)(m)){var O=e.mathpack.toNumber(m.oper);if(Object(Te.b)(O)){var j=Pe(e,a,"object"==typeof u);return void 0===j?V(q,u):(e.pushConstraint(j[1]),V(P(D.b.Number,function(e,t,r){if(0===t)return r;var a=g(),i=e.vars,o=e.consts;for(var c in i)a.vars[c]=i[c]*t;for(var c in o)a.consts[c]=o[c]*t;return a.varCount=e.varCount,b(n.Root,a),a}(j[0],O,K)),u))}}return Z;case c.a.Range:case c.a.Isect:case c.a.Union:return Z;case c.a.Concat:return V(z,u);case c.a.And:case c.a.Or:case c.a.Xor:return V(W,u);default:return Object(i.e)(n.Root,t)}}function Ge(e,t,r){switch(t){case c.a.Add:case c.a.Sub:case c.a.Mul:case c.a.Div:case c.a.Pow:case c.a.Eq:case c.a.Ne:case c.a.Lt:case c.a.Le:case c.a.Gt:case c.a.Ge:case c.a.Range:case c.a.Isect:case c.a.Union:case c.a.Concat:case c.a.And:case c.a.Or:case c.a.Xor:case c.a.Min:case c.a.Max:return Ue(e,t,r);case c.a.Percent:case c.a.Neg:case c.a.Pos:case c.a.At:case c.a.Pound:return function(e,t,r){if(r.length<1)return Z;var a=Le(e,r[0][0]);if(void 0===a)return Z;var o=U(a);if(!1===o)return Z;switch(t){case c.a.Percent:return V(Y,o);case c.a.Neg:case c.a.Pos:var u=Pe(e,a,"object"==typeof o);return void 0===u?V(q,o):(e.pushConstraint(u[1]),V(P(D.b.Number,u[0]),o));case c.a.At:case c.a.Pound:return Z;default:return Object(i.e)(n.Root,t)}}(e,t,r);default:return Object(i.e)(n.Root,t)}}var Ve=function(){function e(e){var t=this;this.context=e,this.visitFormulaNode=function(e){return Object(Ie.r)(t,e)},this.lazyVisitFormulaNode=function(e){return _e.a.resolve(e).bind(t.visitFormulaNode)}}return e.prototype.literalNode=function(e){return _e.a.resolve(function(e){switch(e.kind){case D.b.Number:return q;case D.b.String:return z;case D.b.Boolean:return W;case D.b.Error:return J;default:return Q}}(e))},e.prototype.arrayNode=function(e){var t=this;return _e.a.all(e.map((function(e){return _e.a.all(e.map(t.lazyVisitFormulaNode))}))).bind(xe)},e.prototype.appNode=function(e,t){var r=this;return e.kind===u.e.Operator?_e.a.all(t.map((function(e){return r.lazyVisitFormulaNode(e).bind((function(t){return[t,e]}))}))).bind((function(t){return Ge(r.context,e.id,t)})):e.kind===u.e.WSF?_e.a.all(t.map(this.lazyVisitFormulaNode)).bind((function(t){return function(e,t,r){switch(t){case c.b.SUM:case c.b.AVERAGE:case c.b.MAX:case c.b.MIN:if(0===r.length)return Z;var n=e.symbolContext.freshSymbol(),a=!0;return r.forEach((function(t){var r=Le(e,t);r&&e.pushConstraint(De(r,n,!0))&&(a=!1)})),a?q:P(D.b.Number,n.unit);case c.b.IF:if(r.length<2)return Z;var i=Le(e,r[0]),o=Le(e,r[1]),u=Le(e,void 0===r[2]?W:r[2]);if(void 0===i)return void 0!==o&&void 0!==u&&Be(e,o,u,!0,!1),Z;var s=U(i),l="object"==typeof s;if(void 0===o||void 0===u)return Z;var d=Be(e,o,u,!0,!0),f=d?ee(d.unit):$;return l?L(f,s):f;default:return Z}}(r.context,e.id,t)})):_e.a.resolve(Z)},e.prototype.letNode=function(e,t,r,n){return _e.a.resolve(Z)},e.prototype.lambdaNode=function(e,t,r,n){return _e.a.resolve(Z)},e.prototype.parenNode=function(e){return this.lazyVisitFormulaNode(e)},e.prototype.nameNode=function(e,t){return _e.a.resolve(Z)},e.prototype.cellRefNode=function(e,t){return _e.a.resolve(x(Object(u.u)(e,t)))},e.prototype.fieldRefNode=function(e,t){return _e.a.resolve(Z)},e.prototype.structRefNode=function(e,t){return _e.a.resolve(Z)},e.prototype.badSequenceNode=function(e,t){return _e.a.resolve(Z)},e.prototype.badStringNode=function(e,t){return _e.a.resolve(Z)},e.prototype.operatorNode=function(e,t){return _e.a.resolve(Object(u.Y)(e,t))},e.prototype.wsfNode=function(e,t,r){return _e.a.resolve(Object(u.mb)(e,t,r))},e}()},function(e,t,r){"use strict";var n=r(25),a=r(5),i=r(15),o=r(7),c=r(60),u=r(61),s=r(10),l=r(2),d=r(23),f=r(18);function b(e,t){var r=t-1;return function(t){if(t<=r){var i="".concat(e,": internal error: no progress made at index ").concat(t);return a.i.ULS.assertTag(595980821,n.LogCategory.msoulscat_ES_EWAJS,!1,i)}r=t}}function h(e,t,r){for(var n=t;n<e.length&&r(e,n);)n+=Object(d.f)(Object(d.i)(e,n));return[e.substring(t,n),n]}function v(e,t,r,n,a){return r(e,t)?1:Object(f.h)(e,n,t)&&t+n.length<e.length&&a(e,t+n.length)?2:0}function p(e,t,r,n,a){for(var i=[],o=t,c=t;c<e.length;){var u=v(e,c,r,n,a);if(0===u)break;2===u&&(o!==c&&i.push(e.substring(o,c)),o=c+n.length,c+=n.length),c+=Object(d.f)(Object(d.i)(e,c))}return o!==c&&i.push(e.substring(o,c)),[i.join(""),c]}var m=r(33),g=r(30);r.d(t,"a",(function(){return Z}));var O,j=m.a,y=m.b,S=m.f,C=m.l,k=m.m,E=m.o,A=m.s,N=m.w,T=m.x,R=m.y,I=m.n,_=m.j,F=m.z,w=m.p,M=m.q;function D(e){if(!O){O=Object(s.i)();for(var t=0,r=Object.getOwnPropertyNames(P);t<r.length;t++){var n=r[t];O[n.charCodeAt(0)]=!0}for(var a=0,i=Object.getOwnPropertyNames(x);a<i.length;a++){var o=i[a];O[o.charCodeAt(0)]=!0}}return!0===O[e]}var P={"+":i.e,"-":i.X,"*":i.I,"/":i.o,"^":i.N,"%":i.L,"&":i.n,"=":i.r,"<":i.H,">":i.u,":":i.P,".":i.p,"@":i.h,"#":i.M},x={"<>":i.J,"<=":i.A,">=":i.t};function L(e,t,r){if(t<e.length-1){var o=x[e.substring(t,t+2)];if(null!=o)return Object(i.f)(2,o(t),r)}var c=P[e.charAt(t)];if(null!=c)return Object(i.f)(1,c(t),r);return a.i.ULS.assertTag(595980822,n.LogCategory.msoulscat_ES_EWAJS,!1,"calc.parse.tokenizeOperator: internal error: expected operator")}function B(e,t,r,n,a){var o=Object(u.b)(e,t,r,n,!1,!1,!1);if(void 0!==o){var c=o.value,s=o.i,l=r.substring(n,s);return Object(i.f)(s-n,Object(i.G)(n,l,null!=c?c:i.j,!0),a),s}}var U=function(e,t){return e.charCodeAt(t)!==C},G=function(e,t){return e.charCodeAt(t)===C};function V(e,t,r){var n=p(e,t+1,U,'"',G),a=n[0],c=n[1],u=e.substring(t,c+1);return c<e.length?Object(i.f)(c+1-t,Object(i.G)(t,u,Object(o.u)(a),!0),r):Object(i.f)(c-t,Object(i.G)(t,u,Object(o.u)(a),!1),r)}function H(e,t,r,n){for(var a=1;a<e.errorNames.length;a+=1){var c=e.errorNames[a];if(null!=c){var u=t.substring(r,r+c.length);if(0===e.stringCompareCI(c,u))return Object(i.f)(c.length,Object(i.G)(r,u,Object(o.h)(a)),n)}}for(var s=r+1,l=!1;s<t.length;){var f=Object(d.i)(t,s);if(s!==r+1||f!==w&&f!==M)if(s>r+1&&f===F&&!l)l=!0,s+=1;else{if(s>r+1&&f===_){(s+=1)<t.length&&t.charCodeAt(s)===k&&(s+=1);break}if(f===k||f===N){s!==r+1&&(s+=1);break}if(!e.isIdentStart(f)&&f!==I)break;s+=Object(d.f)(f)}else s+=1}if(s>r+1){u=t.substring(r,s);return Object(i.f)(s-r,Object(i.G)(r,u,i.i),n)}}function W(e,t,r,n){for(var a=1;a<e.specialRefNames.length;a+=1){var o=e.specialRefNames[a];if(null!=o){var c=t.substring(r,r+o.length);if(0===e.stringCompareCI(o,c))return Object(i.f)(o.length,Object(i.W)(r,c,a),n)}}}function z(e,t,r){var n=t.charCodeAt(r);return!(Object(u.a)(n)||n===R||n===E||n===S||n===y||Object(f.h)(t,e.listSeparator,r)||Object(f.h)(t,e.leftBracket,r)||Object(f.h)(t,e.rightBracket,r))}var q=function(e,t){return Object(u.a)(Object(d.i)(e,t))};function K(e,t,r,n){for(var a=r,o=0,c=function(t,r){return z(e,t,r)},s=function(t,r){return!z(e,t,r)},l=b("calc.parse.tokenizeBracketedRef",a);a<t.length;){l(a);var v=Object(d.i)(t,a);if(n.length>0&&n[n.length-1].kind===i.c.Escape&&s(t,a))a=Object(i.f)(Object(d.f)(v),Object(i.w)(a,Object(d.j)(v)),n);else if(v!==y){if(v===E)if(null!=(g=W(e,t,a,n))){a=g;continue}if(v!==R)if(Object(f.h)(t,e.rightBracket,a)){if(a=Object(i.f)(e.rightBracket.length,Object(i.R)(a,e.rightBracket),n),0===(o-=1))return a}else if(c(t,a)){var p=h(t,a,c),m=p[0],g=p[1];a=Object(i.f)(g-a,Object(i.w)(a,m),n)}else if(Object(u.a)(v)){var O=h(t,a,q);m=O[0],g=O[1];a=Object(i.f)(g-a,Object(i.V)(a,m),n)}else v!==S?Object(f.h)(t,e.listSeparator,a)?a=Object(i.f)(e.listSeparator.length,Object(i.F)(a,e.listSeparator),n):Object(f.h)(t,e.leftBracket,a)&&o<2?(a=Object(i.f)(e.leftBracket.length,Object(i.C)(a,e.leftBracket),n),o+=1):a=Object(i.f)(Object(d.f)(v),Object(i.Y)(a,Object(d.j)(v)),n):a=Object(i.f)(1,Object(i.P)(a),n);else a=Object(i.f)(1,Object(i.s)(a,"'"),n)}else a=Object(i.f)(1,Object(i.h)(a),n)}return a}function Y(e,t,r,n){for(var a=Object(i.f)(1,Object(i.E)(r),n),o=function(t,r){return function(e,t,r){var n=t.charCodeAt(r);return n!==R&&n!==S&&n!==j&&n!==N&&!Object(f.h)(t,e.leftBracket,r)&&!Object(f.h)(t,e.rightBracket,r)}(e,t,r)},c=function(e,t){return e.charCodeAt(t)===R},u=b("calc.parse.tokenizeQuotedQualifier",a);a<t.length;){u(a);var s=Object(d.i)(t,a);if(s===R&&!(a+1<t.length&&t.charCodeAt(a+1)===R))return Object(i.f)(1,Object(i.T)(a),n);if(s!==S)if(Object(f.h)(t,e.leftBracket,a))a=Object(i.f)(e.leftBracket.length,Object(i.C)(a,e.leftBracket),n);else if(Object(f.h)(t,e.rightBracket,a))a=Object(i.f)(e.rightBracket.length,Object(i.R)(a,e.rightBracket),n);else if(v(t,a,o,"'",c)>0){var l=p(t,a,o,"'",c),h=l[0],m=l[1];a=Object(i.f)(m-a,Object(i.w)(a,h),n)}else a=Object(i.f)(Object(d.f)(s),Object(i.Y)(a,Object(d.j)(s)),n);else a=Object(i.f)(1,Object(i.P)(a),n)}return a}function J(e,t,r,n,a,o){var u=Object(c.c)(e,t,r,n,a);if(null!=u){var s=u.i,d=n.substring(s,a),f=u.refStyle===l.h.A1?Object(i.k)(a,d,u.row,u.col):Object(i.l)(a,d,u.row,u.col,u.enLocale);return Object(i.f)(s-a,f,o)}}function Q(e,t,r,n){var a=n[n.length-1];return null==a||(a.kind!==i.c.Sep||a.value!==i.b.Dot)&&(Object(f.h)(t,e.decimalSeparator,r)?a.kind===i.c.Spaces&&null==(a=n[n.length-2])||a.kind!==i.c.Ident&&a.kind!==i.c.CellRef&&a.kind!==i.c.Right&&(a.kind!==i.c.Literal||Object(i.z)(a.oper)):e.isNumeral(Object(d.i)(t,r)))}function X(e,t,r,n){for(var a=e[t],i=t+1;i<e.length;i+=1){var o=e[i];if(o.kind!==r)break;a=n(a,o)}return[a,i]}function Z(e,t,r,n,a,o){for(var c=function(e,t,r,n,a,o){for(var c=[],s=[],l=o,v=b("calc.parse.tokenize",l);l<a.length;){v(l);var p=J(e,r,n,a,l,c);if(null==p){var m=Object(d.i)(a,l);if(Q(e,a,l,c)){var O=B(e,t,a,l,c);if(null!=O){l=O;continue}}if(m!==C)if(e.isIdentContinue(m)){var j=h(a,l,(function(t,r){return e.isIdentContinue(Object(d.i)(t,r))})),y=j[0],S=j[1];l=Object(i.f)(S-l,Object(i.v)(e,l,y),c)}else if(m!==E)if(Object(u.a)(m)){var N=h(a,l,q),I=(y=N[0],N[1]);l=Object(i.f)(I-l,Object(i.V)(l,y),c)}else if(m!==A)if(m!==T)if(Object(f.h)(a,e.leftBrace,l))s.push(i.a.Brace),l=Object(i.f)(e.leftBrace.length,Object(i.B)(l,e.leftBrace),c);else if(Object(f.h)(a,e.rightBrace,l))s.length>0&&s[s.length-1]===i.a.Brace&&s.pop(),l=Object(i.f)(e.rightBrace.length,Object(i.Q)(l,e.rightBrace),c);else if(Object(f.h)(a,e.leftBracket,l))l=K(e,a,l,c);else if(Object(f.h)(a,e.rightBracket,l))l=Object(i.f)(e.rightBracket.length,Object(i.R)(l,e.rightBracket),c);else{if(s.length>0&&s[s.length-1]===i.a.Brace){if(Object(f.h)(a,e.columnSeparator,l)){l=Object(i.f)(e.columnSeparator.length,Object(i.m)(l,e.columnSeparator),c);continue}if(Object(f.h)(a,e.rowSeparator,l)){l=Object(i.f)(e.rowSeparator.length,Object(i.U)(l,e.rowSeparator),c);continue}}if(Object(f.h)(a,e.listSeparator,l))l=Object(i.f)(e.listSeparator.length,Object(i.F)(l,e.listSeparator),c);else if(m!==k)if(m!==R)if(D(m)){if(Object(f.h)(a,":=",l)&&Object(g.e)(g.a.CalcLambdaDefaultParameters)){l=Object(i.f)(2,Object(i.g)(l),c);continue}l=L(a,l,c)}else l=Object(i.f)(Object(d.f)(m),Object(i.Y)(l,Object(d.j)(m)),c);else l=Y(e,a,l,c);else l=Object(i.f)(1,Object(i.O)(l),c)}else s.length>0&&s[s.length-1]===i.a.Paren&&s.pop(),l=Object(i.f)(1,Object(i.S)(l),c);else s.push(i.a.Paren),l=Object(i.f)(1,Object(i.D)(l),c);else{var _=H(e,a,l,c);if(null!=_){l=_;continue}l=L(a,l,c)}else l=V(a,l,c)}else l=p}return c}(e,t,r,n,a,o),s=[],l=0;l<c.length;){var v=c[l];if(v.kind!==i.c.Unexpected)s.push(v),l+=1;else{var p=X(c,l,i.c.Unexpected,(function(e,t){var r=e,n=t;return Object(i.Y)(r.start,r.chars+n.chars)})),m=p[0],O=p[1];s.push(m),l=O}}return s.push(Object(i.q)(a.length)),s}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.anonymizeFormulaString=t.anonymizeMagnitude=t.kindAnonymizers=t.anonymize=void 0;var n=r(132);function a(e){return e}function i(e,r){if("string"==typeof r&&null!=o[r])return e;var n=function(e){if("object"==typeof e&&null!==e){var t=e.kind;if("string"==typeof t)return t}}(e),a=void 0!==n?t.kindAnonymizers[n]:void 0;return void 0===a&&(a=c[function(e){var t=typeof e;if("object"===t){if(null===e)return"null";if(Array.isArray(e))return"Array"}return t}(e)]),void 0!==a?a(e,r):"<unexpected>"}t.anonymize=function(e){try{return String(JSON.stringify(i(e,void 0)))}catch(e){if(null==e||"object"!=typeof e)return"<error: ".concat(String(JSON.stringify(e)),">");var t=String(e.name),r=String(e.message);return r.indexOf(t)>=0?"<error ".concat(r,">"):"<error ".concat(t,": ").concat(r,">")}};var o={kind:!0,type:!0,index:!0,length:!0,row:!0,col:!0,rows:!0,cols:!0},c={boolean:a,symbol:function(e){return"symbol"!=typeof e?"<unexpected>":"<symbol ".concat(String(e),">")},undefined:a,null:a,number:function(e){return"number"!=typeof e?"<unexpected>":isFinite(e)?"<number>":e},bigint:function(e){return"bigint"!=typeof e?"<unexpected>":"<bigint>"},string:function(e){return"string"!=typeof e?"<unexpected>":e.length>0?"<string>":e},function:function(e){if("function"!=typeof e)return"<unexpected>";var t=e.name;return"string"==typeof t&&t.length>0?"<function ".concat(t,">"):"<function>"},object:function(e){if("object"!=typeof e)return"<unexpected>";var t={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=i(e[r],r));return t},Array:function(e){return"object"==typeof e&&Array.isArray(e)?e.map(i):"<unexpected>"}};t.kindAnonymizers=Object.create(null),t.anonymizeMagnitude=function(e){var t=Math.abs(e);return 0===t?-1e4:Math.floor((0,n.mathLog2)(t))};var u=new RegExp("[^=\\[\\]\\.\\\\\\/%@#\\-_\\+,;\\(\\):?\"&<>'!\\{\\}~\\^\\*$¢£¤¥₠₡₢₣₤₥₦₧₨₩₪₫€₭₮₯₰₱₲₳₴₵₶₷₸₹\\sꃂd]","g"),s=/[0-9]/g,l=/d/g;t.anonymizeFormulaString=function(e){return e.toLowerCase().replace(l,"w").replace(s,"d").replace(u,"w")}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isTypedChangeGateEnabled=t.setFeatureGateDictionaryGetter=t.overrideTypedFeatureGates=t.getTypedFeatureGate=t.getFeatures=t.isFeatureEnabled=t.initFeatureConfiguration=t.FeatureName=void 0;var n,a=r(103),i=r(25),o=r(70);!function(e){e.FeatureCheckingEnabled="FeatureCheckingEnabled",e.CalcPreventSpillingHack="CalcPreventSpillingHack",e.CalcLegacyImplicitIntersection="CalcLegacyImplicitIntersection",e.CalcRecordFunctions="CalcRecordFunctions",e.CalcNestedRecordFunction="CalcNestedRecordFunction",e.CalcLetRecFunction="CalcLetRecFunction",e.CalcLambdaFunction="CalcLambdaFunction",e.CalcLambdaBasicFunctions="CalcLambdaBasicFunctions",e.CalcLambdaHelperFunctions="CalcLambdaHelperFunctions",e.CalcLambdaOptionalParameters="CalcLambdaOptionalParameters",e.CalcLambdaDefaultParameters="CalcLambdaDefaultParameters",e.CalcLambdaCellValues="CalcLambdaCellValues",e.CalcLambdaArrayLifting="CalcLambdaArrayLifting",e.CalcWebWorkerTest="CalcWebWorkerTest",e["OfficeVSO:3852168_CalcNFFracFix"]="OfficeVSO:3852168_CalcNFFracFix",e["OfficeVSO:5581754_DisableThrottlingOnArgumentAssistance"]="OfficeVSO:5581754_DisableThrottlingOnArgumentAssistance",e["OfficeVSO:3594447_InvalidQualifier"]="OfficeVSO:3594447_InvalidQualifier",e["OfficeVSO:3594447_InvalidQualifier2"]="OfficeVSO:3594447_InvalidQualifier2",e["OfficeVSO:5607789_FunctionShortDescriptions"]="OfficeVSO:5607789_FunctionShortDescriptions",e["OfficeVSO:3594447_R1C0_Fix"]="OfficeVSO:3594447_R1C0_Fix",e["OfficeVSO:5484395_SafeParseResultHelper"]="OfficeVSO:5484395_SafeParseResultHelper",e["OfficeVSO:3594447_A1_BadDollar"]="OfficeVSO:3594447_A1_BadDollar",e["OfficeVSO:3594447_NameCell_BadQual"]="OfficeVSO:3594447_NameCell_BadQual"}(n=t.FeatureName||(t.FeatureName={}));var c=function(e){var t="calc.common.isFeatureEnabledCallback: called with ".concat(e," before initCalc");return a.ulsLogger.ULS.traceTag(526989323,i.LogCategory.msoulscat_ES_EWAJS,i.TraceLevel.Warning,t),!1},u={};function s(e){return void 0===u[e]&&(u[e]=c(e)),u[e]}t.initFeatureConfiguration=function(e){"function"==typeof e&&(c=e)},t.isFeatureEnabled=s,t.getFeatures=function(){var e={};for(var t in n){var r=n[t];null!=r&&(e[r]=s(r))}return e};t.getTypedFeatureGate=(0,o.makeGetTypedFeatureGate)({"Microsoft.Office.Excel.ProseFormulaRepairExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSDemoFeatureGateString":"DummyStringValue","Microsoft.Office.Excel.CalcTSDemoFeatureGateInt":42,"Microsoft.Office.Excel.CalcTSDemoFeatureGateBoolean":!1,"Microsoft.Office.Excel.CalcTSAutocompleteExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSUnitExperimentIsEnabled":!1,"Microsoft.Office.Excel.CalcTSExceLintExperimentIsEnabled":!1,"Microsoft.Office.Excel.SmartFormulaBarAutocompleteIsEnabled":!1,"Microsoft.Office.Excel.SmartFormulaBarUseDevScheduler":!1,"Microsoft.Office.Excel.x10DoNotThrowOnDoublePluginRegistration":!0,"Microsoft.Office.Excel.ProductSetBugFixFromPR1043532":!0,"Microsoft.Office.ExcelOnline.ArgumentAssistancePlugin":!1,"Microsoft.Office.Excel.x10AutocompletionPrecisionMeasurementsIsEnabled":!1,"Microsoft.Office.Excel.x10AutocompleteGroundTruthMeasurementsIsEnabled":!1,"Microsoft.Office.Excel.x10AutocompleteDataTypesMeasurements":!1,"Microsoft.Office.Excel.CalcTSImportScriptsRetries":!1,TESTING_ONLY_RECALC_SERVICE_IMPORTSCRIPTS_FAIL:!1,TESTING_ONLY_SCHEDULER_IMPORTSCRIPTS_FAIL:!1,TESTING_ONLY_TEST_PLUGIN_IMPORTSCRIPTS_FAIL:!1,"Microsoft.Office.Excel.FormulaAssistanceRedesign":!1,"Microsoft.Office.Excel.ParenthesesCoupling":!1,"Microsoft.Office.Excel.FormulaCollection":!1,"Microsoft.Office.Excel.x10ParserPerformanceMeasurements":!1,"Microsoft.Office.Excel.x10UseDevSyncDataModel":!1});var l=r(70);Object.defineProperty(t,"overrideTypedFeatureGates",{enumerable:!0,get:function(){return l.overrideTypedFeatureGates}}),Object.defineProperty(t,"setFeatureGateDictionaryGetter",{enumerable:!0,get:function(){return l.setFeatureGateDictionaryGetter}}),t.isTypedChangeGateEnabled=(0,o.makeTypedIsChangeGateEnabled)(["OfficeVSO:XXX_TestChangeGate","Microsoft.Office.Excel.ChangeGate.PreciseNowForNodeJS","OfficeVSO:5818445_AttachDataTypesExperiment"])},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setFeatureGateDictionaryGetter=t.getIntFeatureGate=t.getNumberFeatureGate=t.getBooleanFeatureGate=t.getStringFeatureGate=t.getFeatureGateDictionary=void 0;var n=r(134),a={};function i(){return"undefined"==typeof __get_feature_gate_dictionary_variable?a:__get_feature_gate_dictionary_variable()}function o(e,t){var r;return null!==(r=i()[e])&&void 0!==r?r:t}t.getFeatureGateDictionary=i,t.getStringFeatureGate=o,t.getBooleanFeatureGate=function(e,t){var r,n=null===(r=o(e))||void 0===r?void 0:r.trim().toLowerCase();return"true"===n||"false"!==n&&t},t.getNumberFeatureGate=function(e,t){var r,n=null===(r=o(e))||void 0===r?void 0:r.trim().toLowerCase();if(void 0===n)return t;if("infinity"===n||"+infinity"===n)return 1/0;if("-infinity"===n)return-1/0;var a=parseFloat(n);return isNaN(a)?t:a},t.getIntFeatureGate=function(e,t){var r,n=null===(r=o(e))||void 0===r?void 0:r.trim();if(void 0===n)return t;var a=parseInt(n,10);return isNaN(a)?t:a},t.setFeatureGateDictionaryGetter=function(e){var t=n.globalThis.__get_feature_gate_dictionary_variable;return n.globalThis.__get_feature_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setChangeGateDictionaryGetter=t.isChangeGateEnabled=t.getChangeGateDictionary=void 0;var n=r(134);function a(){return"undefined"==typeof __get_change_gate_dictionary_variable?null:__get_change_gate_dictionary_variable()}t.getChangeGateDictionary=a,t.isChangeGateEnabled=function(e){var t,r=a();return null!==r&&(null===(t=r[e])||void 0===t||t)},t.setChangeGateDictionaryGetter=function(e){var t=n.globalThis.__get_change_gate_dictionary_variable;return n.globalThis.__get_change_gate_dictionary_variable=e,t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.logCollision=void 0;var n=r(25),a=r(103),i={},o=0;t.logCollision=function(e){var t=i[e];i[e]=(void 0===t?0:t)+1,(o+=1)%100==0&&(a.ulsLogger.ULS.traceTag(595858520,n.LogCategory.msoulscat_ES_EWAJS,n.TraceLevel.Info,"calc.common.hashUtils.logCollision: ".concat(JSON.stringify(i),".")),i={})}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.isSupported=t.strToPxchar=t.pxcharToStr=t.fastMin=t.Base_LocaleDecimalSeparator=t.Base_LocaleGetOrdinal=t.Base_LocaleIsNumeral=t.setLocale=void 0;var n=r(106),a=void 0;t.setLocale=function(e){a=e};t.Base_LocaleIsNumeral=function(e){return a.isNumeral(e)?1:0},t.Base_LocaleGetOrdinal=function(e){return a.getOrdinal(e)},t.Base_LocaleDecimalSeparator=function(){var e=a.decimalSeparator;return 0===e.length?46:e.charCodeAt(0)},t.fastMin=function(e,t){return e<t?e:t},t.pxcharToStr=function(e,t){for(var r=new Uint16Array(n.memory.buffer),a="",i=0;i<t;i+=1)a+=String.fromCharCode(r[e+(i<<1)>>1]);return a},t.strToPxchar=function(e,t){for(var r=new Uint16Array(n.memory.buffer),a=0;a<t.length;a+=1)r[e+(a<<1)>>1]=t.charCodeAt(a)},t.isSupported=function(){var e=new ArrayBuffer(2);return new Uint16Array(e)[0]=1,1===new Uint8Array(e)[0]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Timer=t.createPerf=void 0;function n(){return"undefined"!=typeof process?{now:function(){var e=process.hrtime();return(1e9*e[0]+e[1])/1e6}}:"undefined"!=typeof performance?performance:Date}t.createPerf=n;var a=function(){function e(e){this.perf=n(),this.name=e,this.start()}return e.prototype.start=function(){this.startTimeMS=this.perf.now(),this.splitTimeMS=this.startTimeMS},e.prototype.split=function(e){var t=this.perf.now(),r=t-this.splitTimeMS;console.warn("timer: "+this.name+" @ "+e+" : = "+this.roundMe(r)+" (total = "+this.roundMe(t-this.startTimeMS)+")"),this.splitTimeMS=t},e.prototype.elapsedTime=function(){return this.perf.now()-this.startTimeMS},e.prototype.roundMe=function(e){return Math.round(100*e)/100},e}();t.Timer=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSF32=void 0;var n=function(e,t){return(e<<t|e>>>32-t)>>>0},a=function(){function e(e){this.x=new Uint32Array([4058668781,e,e,e]);for(var t=0;t<20;t+=1)this.nextU32()}return e.prototype.next=function(){return this.nextU32()*(1/4294967296)},e.prototype.nextU32=function(){var e=this.x[0]-n(this.x[1],27)>>>0;return this.x[0]=(this.x[1]^n(this.x[2],17))>>>0,this.x[1]=this.x[2]+this.x[3]>>>0,this.x[2]=this.x[3]+e>>>0,this.x[3]=e+this.x[0]>>>0},e}();t.JSF32=a},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.mathLog2=void 0,t.mathLog2=null!==(n=Math.log2)&&void 0!==n?n:function(e){return Math.log(e)*Math.LOG2E}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.values=t.prependErrorMessage=t.messageFromError=t.partialArray=t.arrayFill=t.repeat=t.stringEndsWith=t.stringStartsWith=t.isInteger=t.mathLog2=void 0;var n=r(124),a=r(132);Object.defineProperty(t,"mathLog2",{enumerable:!0,get:function(){return a.mathLog2}}),t.isInteger=function(e){return"number"==typeof e&&isFinite(e)&&Math.floor(e)===e},t.stringStartsWith=function(e,t,r){return void 0===r&&(r=0),r+t.length<=e.length&&e.substring(r,r+t.length)===t},t.stringEndsWith=function(e,t){return t.length<=e.length&&e.substring(e.length-t.length,e.length)===t},t.repeat=function(e,t){return Array(t+1).join(e)},t.arrayFill=function(e,t){for(var r=0;r<e.length;r+=1)e[r]=t;return e},t.partialArray=function(e){var t=[];return Object.keys(e).map(Number).forEach((function(r){return t[r]=e[r]})),t},t.messageFromError=function(e){if(null==e||"object"!=typeof e)return(0,n.anonymize)(e);var t=e,r=String(t.name),a=String(t.message);if(null!=t.stack){var i=String(t.stack);return i.indexOf(a)>=0&&i.indexOf(r)>=0?i:"".concat(r,": ").concat(a,"\n").concat(i)}return a.indexOf(r)>=0?a:"".concat(r,": ").concat(a)},t.prependErrorMessage=function(e,t){if(null==e||"object"!=typeof e)return e;var r=e;return r.message="".concat(t," ").concat(String(r.message)),r},t.values=function(e){var t=[];for(var r in e)Object.hasOwnProperty.call(e,r)&&t.push(e[r]);return t}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.globalThis=void 0;var n=r(164);t.globalThis=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BinaryHeap=void 0;var n=function(){function e(e){this.items=[],this.cmp=e}return e.prototype.insert=function(e){this.items.push(e);for(var t=this.getCount()-1;t>0;){var r=t-1>>>1,n=this.items[r];if(!(this.cmp(n,e)>0))break;this.items[t]=n,t=r}this.items[t]=e},e.prototype.peek=function(){return this.items[0]},e.prototype.removeMin=function(){var e=this.peek(),t=this.items.pop(),r=this.getCount()-1;if(r<0||void 0===t)return e;var n=0;for(this.items[0]=t;n<r;){var a=n,i=1+(n<<1),o=2+(n<<1);if(i<=r&&this.cmp(this.items[i],t)<0&&(a=i),o<=r&&this.cmp(this.items[o],a===i?this.items[a]:t)<0&&(a=o),n===a)break;this.items[n]=this.items[a],n=a}return this.items[n]=t,e},e.prototype.getCount=function(){return this.items.length},e.prototype.clear=function(){this.items.length=0},e.prototype.forEach=function(e){for(var t=0,r=this.items;t<r.length;t++){if(!e(r[t]))return}},e}();t.BinaryHeap=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.forEachKeyUntyped=t.forEachKey=t.getNodeCount=t.complement=t.symmetricDiff=t.lazy=t.empty=t.dense=t.compareUntyped=t.combineCmp=t.compare=t.exceptUntyped=t.except=t.meetsUntyped=t.meets=t.intersectUntyped=t.intersect=t.unionUntyped=t.union=t.fromUntyped=t.createFromKey=t.cacheKeySplitting=t.SetKind=void 0;var n,a=r(9),i=r(9).__assign;function o(e,t,r){return void 0===r&&(r=10),function(n){if(void 0!==n.split)return n.split;var a=e(n),i=n===t?0:n.depth;return void 0!==i&&i<r&&(n.split=a,a[0][0].depth=i+1,a[1][0].depth=i+1),a}}function c(e,r){return r===t.empty?t.empty:r===t.dense?t.dense:{setOperations:e,root:r}}function u(e,r){return r===t.empty?e:r===t.dense||e===t.empty?r:e===t.dense?e:c(e.setOperations,s(e.setOperations,e.setOperations.top,e.root,r.root))}function s(e,r,n,a){if(a===t.empty)return n;if(a===t.dense)return a;if(n===t.empty)return a;if(n===t.dense)return n;if(n.isExact&&a.isExact){var i=function(e,r,n,a){var i=n.key,o=a.key,c=e.compare(i,o);if(void 0!==c)return c<0?a:n;var u=e.union(i,o);if(void 0!==u){var s=e.compare(u,r);return void 0!==s&&0===s?t.dense:O(e,r,u,!0)}return}(e,r,n,a);if(void 0!==i)return i}var o=j(e,r,n),c=j(e,r,a),u=e.split(r),l=u[0][0],d=u[1][0];return p(e,l,d,s(e,l,o.left,c.left),s(e,d,o.right,c.right))}function l(e,r,n,a){if(n===t.empty)return n;if(a===t.empty)return a;if(n===t.dense)return a;if(a===t.dense)return n;if(n.isExact&&a.isExact){var i=function(e,r,n,a){var i=n.key,o=a.key;if(!e.meets(i,o))return t.empty;var c=e.compare(i,o);if(void 0!==c)return c<0?n:a;var u=e.intersect(i,o);if(void 0!==u)return O(e,r,u,!0);return}(e,r,n,a);if(void 0!==i)return i}var o=j(e,r,n),c=j(e,r,a),u=e.split(r),s=u[0][0],d=u[1][0];return p(e,s,d,l(e,s,o.left,c.left),l(e,d,o.right,c.right))}function d(e,r,n,a){if(n===t.empty||a===t.empty)return!1;if(n===t.dense||a===t.dense)return!0;if(n.isExact&&a.isExact)return e.meets(n.key,a.key);var i=j(e,r,n),o=j(e,r,a),c=e.split(r),u=c[0][0],s=c[1][0];return d(e,u,i.left,o.left)||d(e,s,i.right,o.right)}function f(e,r){return e===t.empty||r===t.empty?e:r===t.dense?t.empty:e===t.dense?c(r.setOperations,b(r.setOperations,r.setOperations.top,e,r.root)):c(e.setOperations,b(e.setOperations,e.setOperations.top,e.root,r.root))}function b(e,r,n,a){if(n===t.empty)return n;if(a===t.empty)return n;if(a===t.dense)return t.empty;if(n===t.dense){var i=j(e,r,a),o=e.split(r),c=o[0][0],u=o[1][0];return p(e,c,u,b(e,c,t.dense,i.left),b(e,u,t.dense,i.right))}if(n.isExact&&a.isExact){var s=function(e,t,r,n){var a=r.key,i=n.key;if(!e.meets(a,i))return r;var o=e.except(a,i);if(void 0!==o)return O(e,t,o,!0);return}(e,r,n,a);if(void 0!==s)return s}var l=j(e,r,n),d=j(e,r,a),f=e.split(r),h=f[0][0],v=f[1][0];return p(e,h,v,b(e,h,l.left,d.left),b(e,v,l.right,d.right))}function h(e,t){if(void 0!==e&&void 0!==t)return 0===e?t:0===t||e===t?e:void 0}function v(e,r,n,a){if(n===a)return 0;if(n===t.empty)return-1;if(a===t.empty)return 1;if(n===t.dense)return a===t.dense?0:1;if(a===t.dense)return-1;if(n.isExact&&a.isExact)return function(e,t,r){return e.compare(t.key,r.key)}(e,n,a);var i=j(e,r,n),o=j(e,r,a),c=e.split(r),u=c[0][0],s=c[1][0],l=v(e,u,i.left,o.left);if(void 0!==l){var d=v(e,s,i.right,o.right);if(void 0!==d)return h(l,d)}}function p(e,r,n,a,i){return a===t.empty?i===t.empty?t.empty:i===t.dense?m(a,i,void 0,!1,e.infimum(n,n),e.supremum(n,n)):m(a,i,void 0,!1,i.infimum,i.supremum):i===t.empty?a===t.dense?m(a,i,void 0,!1,e.infimum(r,r),e.supremum(r,r)):m(a,i,void 0,!1,a.infimum,a.supremum):a===t.dense?i===t.dense?t.dense:m(a,i,void 0,!1,e.combineInfima(e.infimum(r,r),i.infimum),e.combineSuprema(e.supremum(r,r),i.supremum)):i===t.dense?m(a,i,void 0,!1,e.combineInfima(a.infimum,e.infimum(n,n)),e.combineSuprema(a.supremum,e.supremum(n,n))):m(a,i,void 0,!1,e.combineInfima(a.infimum,i.infimum),e.combineSuprema(a.supremum,i.supremum))}function m(e,t,r,n,a,i){return{key:r,left:e,right:t,isExact:n,infimum:a,supremum:i}}function g(e,r,n){if(!e.meets(r,n))return t.empty;var a=e.compare(r,n);if(void 0!==a)return a<=0?t.dense:O(e,r,n,!0);var i=e.intersect(r,n);return void 0!==i?O(e,r,i,!0):O(e,r,n,!1)}function O(e,t,r,n){return m(void 0,void 0,r,!!n,e.infimum(r,t),e.supremum(r,t))}function j(e,r,n){if(void 0!==n.left)return n;var a=e.split(r),o=a[0][0],c=a[1][0],u=p(e,o,c,g(e,o,n.key),g(e,c,n.key));if(u===t.empty||u===t.dense)throw new Error("incorrect set operations implementation");var s=u;return i(n,{left:s.left,right:s.right})}function y(e,r,n){return function r(a,i){if(i===t.empty)return!0;if(i===t.dense)return n(a);if(i.isExact)return n(i.key);var o=j(e,a,i),c=e.split(a),u=c[0][0],s=c[1][0];return r(u,o.left)&&r(s,o.right)}(e.top,r)}!function(e){e[e.Dense=0]="Dense",e[e.Empty=1]="Empty"}(n=t.SetKind||(t.SetKind={})),t.cacheKeySplitting=o,t.createFromKey=function(e){var t=a.__assign(a.__assign({},e),{split:o(e.split,e.top)});return function(e){return c(t,g(t,t.top,e))}},t.fromUntyped=c,t.union=u,t.unionUntyped=s,t.intersect=function(e,r){return e===t.empty?e:r===t.empty||e===t.dense?r:r===t.dense?e:c(e.setOperations,l(e.setOperations,e.setOperations.top,e.root,r.root))},t.intersectUntyped=l,t.meets=function(e,r){return e!==t.empty&&r!==t.empty&&(e===t.dense||r===t.dense||d(e.setOperations,e.setOperations.top,e.root,r.root))},t.meetsUntyped=d,t.except=f,t.exceptUntyped=b,t.compare=function(e,r){return e===r?0:e===t.empty?-1:r===t.empty?1:e===t.dense?r===t.dense?0:1:r===t.dense?-1:v(e.setOperations,e.setOperations.top,e.root,r.root)},t.combineCmp=h,t.compareUntyped=v,t.dense=n.Dense,t.empty=n.Empty,t.lazy=g,t.symmetricDiff=function(e,t){return u(f(e,t),f(t,e))},t.complement=function(e){return f(t.dense,e)},t.getNodeCount=function(e){return e===t.empty||e===t.dense?0:function e(r){if(void 0===r||r===t.empty||r===t.dense)return 0;return e(r.left)+e(r.right)+1}(e.root)},t.forEachKey=function(e,r){return e===t.empty||y(e.setOperations,e.root,r)},t.forEachKeyUntyped=y},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ivlCompare=t.ivlExcept=t.ivlMeetsOrTouches=t.ivlMeets=t.ivlDistance=t.ivlMeet=t.ivlJoin=void 0;var n=r(95);t.ivlJoin=function(e,t){var r=e[0],a=e[1],i=t[0],o=t[1];return[(0,n.fastMin)(r,i),(0,n.fastMax)(a,o)]},t.ivlMeet=function(e,t){var r=e[0],a=e[1],i=t[0],o=t[1];return[(0,n.fastMax)(r,i),(0,n.fastMin)(a,o)]},t.ivlDistance=function(e,t){var r=e[0],a=e[1],i=t[0],o=t[1];return.5*(0,n.fastAbs)(r+a-(i+o))},t.ivlMeets=function(e,t){var r=e[0],a=e[1],i=t[0],o=t[1];return(0,n.fastMax)(r,i)<(0,n.fastMin)(a,o)},t.ivlMeetsOrTouches=function(e,t){var r=e[0],a=e[1],i=t[0],o=t[1];return(0,n.fastMax)(r,i)<=(0,n.fastMin)(a,o)},t.ivlExcept=function(e,t){var r=e[0],n=e[1],a=t[0],i=t[1];return r<a&&i>=n?[r,a]:r>=a&&i<n?[i,n]:void 0},t.ivlCompare=function(e,t){var r=e[0],n=e[1],a=t[0],i=t[1];return r===a&&n===i?0:r>=a&&n<=i?-1:r<=a&&n>=i?1:void 0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.remove=t.removeUntyped=t.insert=t.insertUntyped=t.forEach=t.forEachUntyped=t.find=t.findUntyped=t.empty=t.emptyUntyped=t.isLeaf=t.fromUntyped=t.Color=void 0;var n,a,i=r(103);!function(e){e[e.Red=0]="Red",e[e.Black=1]="Black"}(n=t.Color||(t.Color={})),function(e){e[e.DoubleBlack=2]="DoubleBlack"}(a||(a={}));var o=n.Red,c=n.Black,u=a.DoubleBlack,s={c:c,l:void 0,r:void 0},l={c:u,l:void 0,r:void 0};function d(e,t){return{ops:e,root:t}}function f(e){return void 0===e.l}function b(e){return e.c===o}function h(e){return e.c===c&&void 0!==e.l}function v(e){return e.c===c&&void 0===e.l}function p(e,t,r,n,a){return{c:e,l:t,key:r,value:n,r:a}}function m(e,t){return p(e,t.l,t.key,t.value,t.r)}function g(e){return f(e)?s:m(c,e)}function O(e,t,r){if(!f(r)){var n=e.keyCompare(t,r.key);return n<0?O(e,t,r.l):n>0?O(e,t,r.r):r}}function j(e,t){return!!f(t)||!!j(e,t.l)&&(!!e(t.key,t.value)&&j(e,t.r))}function y(e,t,r,n,a){if(e===c){if(b(t)&&b(t.l))return p(o,m(c,t.l),t.key,t.value,p(c,t.r,r,n,a));if(b(a)&&b(a.r))return p(o,p(c,t,r,n,a.l),a.key,a.value,m(c,a.r));if(b(t)&&b(t.r))return p(o,p(c,t.l,t.key,t.value,t.r.l),t.r.key,t.r.value,p(c,t.r.r,r,n,a));if(b(a)&&b(a.l))return p(o,p(c,t,r,n,a.l.l),a.l.key,a.l.value,p(c,a.l.r,a.key,a.value,a.r))}if(e===u){if(b(a)&&b(a.l))return p(c,p(c,t,r,n,a.l.l),a.l.key,a.l.value,p(c,a.l.r,a.key,a.value,a.r));if(b(t)&&b(t.r))return p(c,p(c,t.l,t.key,t.value,t.r.l),t.r.key,t.r.value,p(c,t.r.r,r,n,a))}return p(e,t,r,n,a)}function S(e,t,r,n,a){return e===o&&t.c===u&&h(a)?y(c,p(o,g(t),r,n,a.l),a.key,a.value,a.r):e===o&&h(t)&&a.c===u?y(c,t.l,t.key,t.value,p(o,t.r,r,n,g(a))):e===c&&t.c===u&&h(a)?y(u,p(o,g(t),r,n,a.l),a.key,a.value,a.r):e===c&&h(t)&&a.c===u?y(u,t.l,t.key,t.value,p(o,t.r,r,n,g(a))):e===c&&t.c===u&&b(a)&&h(a.l)?p(c,y(c,p(o,g(t),r,n,a.l.l),a.l.key,a.l.value,a.l.r),a.key,a.value,a.r):e===c&&b(t)&&h(t.r)&&a.c===u?p(c,t.l,t.key,t.value,y(c,t.r.l,t.r.key,t.r.value,p(o,t.r.r,r,n,g(a)))):((0,i.assertTrue)("calc.common.rbTree.rotate: expected R|B",t.c!==u&&a.c!==u),p(e,t,r,n,a))}function C(e,t,r,n){return function(e){return!b(e)||e.l.c!==o&&e.r.c!==o?e:m(c,e)}(function e(t,r,n,a){if(f(a))return p(o,s,r,n,s);var i=t.keyCompare(r,a.key);return i<0?y(a.c,e(t,r,n,a.l),a.key,a.value,a.r):i>0?y(a.c,a.l,a.key,a.value,e(t,r,n,a.r)):p(a.c,a.l,r,n,a.r)}(e,t,r,n))}function k(e,t,r){if(f(r))return r;if(r.c===o&&v(r.l)&&v(r.r))return 0===e.keyCompare(t,r.key)?s:r;if(r.c===c&&v(r.l)&&v(r.r))return 0===e.keyCompare(t,r.key)?l:r;if(r.c===c&&b(r.l)&&v(r.l.l)&&v(r.l.r)&&v(r.r)){var n=e.keyCompare(t,r.key);return n<0?p(c,k(e,t,r.l),r.key,r.value,s):n>0?r:p(c,s,r.l.key,r.l.value,s)}var a=e.keyCompare(t,r.key);if(a<0)return S(r.c,k(e,t,r.l),r.key,r.value,r.r);if(a>0)return S(r.c,r.l,r.key,r.value,k(e,t,r.r));(0,i.assertTrue)("calc.common.rbTree.rem: expected node",!f(r.r));var u=function e(t){if(t.c===o&&v(t.l)&&v(t.r))return[t.key,t.value,s];if(t.c===c&&v(t.l)&&v(t.r))return[t.key,t.value,l];if(t.c===c&&v(t.l)&&b(t.r))return[t.key,t.value,m(c,t.r)];(0,i.assertTrue)("calc.common.rbTree.remMin: expected node",!f(t.l));var r=e(t.l),n=r[0],a=r[1],u=r[2];return[n,a,S(t.c,u,t.key,t.value,t.r)]}(r.r),d=u[0],h=u[1],g=u[2];return S(r.c,r.l,d,h,g)}function E(e,t,r){var n=k(e,t,function(e){return h(e)&&e.l.c===c&&e.r.c===c?m(o,e):e}(r));return(0,i.assertTrue)("calc.common.rbTree.remove: expected R|B",n.c===o||n.c===c),n}t.fromUntyped=d,t.isLeaf=f,t.emptyUntyped=s,t.empty=function(e){return d(e,t.emptyUntyped)},t.findUntyped=O,t.find=function(e,t){return O(t.ops,e,t.root)},t.forEachUntyped=j,t.forEach=function(e,t){return j(e,t.root)},t.insertUntyped=C,t.insert=function(e,t,r){return d(r.ops,C(r.ops,e,t,r.root))},t.removeUntyped=E,t.remove=function(e,t){return d(t.ops,E(t.ops,e,t.root))}},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.pack=t.formatScientific=t.formatFixed=t.formatGeneral=t.atan2=t.atan=t.acos=t.asin=t.tan=t.cos=t.sin=t.log=t.ln=t.exp=t.sqrt=t.viewRound=t.cond2=t.cond=t.power=t.add=t.sub=t.mul=t.div=t.compare=t.tenTo=t.roundDown=t.roundUp=t.round=t.sfix=t.lfix=t.fix=t.float=t.neg=t.abs=t.floor=t.ceil=t.trunc=t.equal=t.exp32=t.pi=t.one=t.zero=t.mathError=t.MathErrorNum=void 0;var a,i=r(106),o=r(129);function c(e){return{num:e}}!function(e){e[e.None=0]="None",e[e.Over=1]="Over",e[e.Under=2]="Under",e[e.DivBy0=4]="DivBy0",e[e.Trans=8]="Trans",e[e._NA=16]="_NA",e[e._Val=32]="_Val",e[e._Num=64]="_Num"}(a=t.MathErrorNum||(t.MathErrorNum={}));var u=((n={})[a.Over]=c(a.Over),n[a.Under]=c(a.Under),n[a.DivBy0]=c(a.DivBy0),n[a.Trans]=c(a.Trans),n);function s(e){var t;return null!==(t=u[e])&&void 0!==t?t:c(e)}function l(e){return function(t){var r=e(t),n=(0,i.Mathpack_TakeMathError)();return n===a.None?r:s(n)}}function d(e){return function(t,r){var n=e(t,r),o=(0,i.Mathpack_TakeMathError)();return o===a.None?n:s(o)}}t.mathError=s,t.zero=i.Mathpack_Zero,t.one=i.Mathpack_One,t.pi=i.Mathpack_Pi,t.exp32=i.Mathpack_GetExp32,t.equal=function(e,t){return 0!==(0,i.Mathpack_Equal)(e,t)},t.trunc=i.Mathpack_Trunc,t.ceil=l(i.Mathpack_Ceil),t.floor=l(i.Mathpack_Floor),t.abs=i.Mathpack_Abs,t.neg=i.Mathpack_Neg,t.float=function(e){return e<0?(0,i.Mathpack_SFloat)(e):(0,i.Mathpack_Float)(e)},t.fix=function(e){return(0,i.Mathpack_Fix)(e)>>>0},t.lfix=i.Mathpack_LFix,t.sfix=l(i.Mathpack_SFix),t.round=d(i.Mathpack_Round),t.roundUp=d(i.Mathpack_RoundUp),t.roundDown=d(i.Mathpack_RoundDown),t.tenTo=function(e){if(e<-1e3)return 0;if(e>1e3)return s(a.Over);if(!isFinite(e))return s(a.Over);var t=(0,i.Mathpack_TenTo)(e),r=(0,i.Mathpack_TakeMathError)();return r===a.None?t:s(r)},t.compare=i.Mathpack_Compare,t.div=d(i.Mathpack_Div),t.mul=d(i.Mathpack_Mul),t.sub=d(i.Mathpack_Sub),t.add=d(i.Mathpack_Add),t.power=d(i.Mathpack_Power),t.cond=function(e){var t=(0,i.Mathpack_Cond)(e),r=(0,i.Mathpack_TakeMathError)();return r===a.None?t:s(r)},t.cond2=i.Mathpack_Cond2,t.viewRound=l(i.Mathpack_ViewRound),t.sqrt=l(i.Mathpack_Sqrt),t.exp=l(i.Mathpack_Exp),t.ln=l(i.Mathpack_Ln),t.log=l(i.Mathpack_Log),t.sin=l(i.Mathpack_Sin),t.cos=l(i.Mathpack_Cos),t.tan=l(i.Mathpack_Tan),t.asin=l(i.Mathpack_Asin),t.acos=l(i.Mathpack_Acos),t.atan=l(i.Mathpack_Atan),t.atan2=d(i.Mathpack_Atan2),t.formatGeneral=function(e,t,r){try{(0,o.setLocale)(e);var n=(0,i.Mathpack_FormatGeneral)(t,r);return n<0?s((0,i.Mathpack_TakeMathError)()):(0,o.pxcharToStr)((0,i.Base_StrBuf)(),n)}finally{(0,o.setLocale)(void 0)}},t.formatFixed=function(e,t,r){var n=(0,i.Mathpack_FormatFixed)(e,t,r);if(n<0)return(0,i.Mathpack_TakeMathError)();var a=(0,o.pxcharToStr)((0,i.Base_StrBuf)(),n),c=(0,i.Mathpack_FormatGetExponent)();return{sign:0!==(0,i.Mathpack_FormatGetSign)(),mantissa:a,exponent:c}},t.formatScientific=function(e,t,r){var n=(0,i.Mathpack_FormatScientific)(e,t,r);if(n<0)return(0,i.Mathpack_TakeMathError)();var a=(0,o.pxcharToStr)((0,i.Base_StrBuf)(),n),c=(0,i.Mathpack_FormatGetExponent)();return{sign:0!==(0,i.Mathpack_FormatGetSign)(),mantissa:a,exponent:c}},t.pack=function(e,t,r,n){try{(0,o.setLocale)(e);var c=(0,o.fastMin)(n.length,(0,i.Base_StrBufSize)());(0,o.strToPxchar)((0,i.Base_StrBuf)(),n.substring(0,c));var u=(0,i.Mathpack_Pack)(!!t,r,c),l=(0,i.Mathpack_TakeMathError)();return l!==a.None?s(l):isNaN(u)?s(a.Over):u}finally{(0,o.setLocale)(void 0)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.ExcelUtils=void 0;var n=r(107),a=function(){function e(){}return e.column_name_to_index=function(e){if(1===e.length)return e[0].charCodeAt(0)-"A".charCodeAt(0)+1;for(var t=0,r=0,n=e.split("");r<n.length;r++){t*=26,t+=n[r].charCodeAt(0)-"A".charCodeAt(0)+1}return t},e.column_index_to_name=function(e){for(var t="";e>0;)t+=String.fromCharCode((e-1)%26+65),e=Math.floor((e-1)/26);return t.split("").reverse().join("")},e.cell_dependency=function(t,r,a){(0,n.watchdog)("wd0x1a9bd3");var i;if(i=e.cell_both_absolute.exec(t)){var o=e.column_name_to_index(i[1]),c=Number(i[2]);return i[2][0]>=" "&&(c=Number(i[2].charCodeAt(0)-16384)),[o,c,0]}if((0,n.watchdog)("wd0xa26bda"),i=e.cell_col_absolute.exec(t)){o=e.column_name_to_index(i[1]),c=Number(i[2]);return i[2][0]>=" "&&(c=Number(i[2].charCodeAt(0)-16384)),[o,c-a,0]}if((0,n.watchdog)("wd0x2a23e1"),i=e.cell_row_absolute.exec(t)){o=e.column_name_to_index(i[1]),c=Number(i[2]);return i[2][0]>=" "&&(c=Number(i[2].charCodeAt(0)-16384)),[o-r,c,0]}if((0,n.watchdog)("wd0x3ebc91"),i=e.cell_both_relative.exec(t)){o=e.column_name_to_index(i[1]),c=Number(i[2]);return i[2][0]>=" "&&(c=Number(i[2].charCodeAt(0)-16384)),[o-r,c-a,0]}throw new Error("We should never get here.")},e.toR1C1=function(t,r,n){void 0===n&&(n=!1);var a=e.cell_dependency(t,0,0),i=e.cell_dependency(r,0,0),o="R",c="C";n&&(o="ρ",c="γ");var u=[];i.forEach((function(e,t,r){u.push(e-a[t])}));var s="";return e.cell_both_absolute.exec(r)?s=o+i[1]+c+i[0]:e.cell_col_absolute.exec(r)?(0===u[1]?s+=o:s+=o+"["+u[1]+"]",s+=c+i[0]):e.cell_row_absolute.exec(r)?(0===u[0]?s+=c:s+=c+"["+u[0]+"]",s=o+i[1]+s):(0===u[1]?s+=o:s+=o+"["+u[1]+"]",0===u[0]?s+=c:s+=c+"["+u[0]+"]"),s},e.formulaToR1C1=function(t,r,n){for(var a,i=t.slice(),o=e.column_index_to_name(r)+n;a=e.range_pair.exec(i);)if(a){var c=a[1];a[2];i=i.replace(a[0],e.toR1C1(o,a[1],!0)+":"+e.toR1C1(o,a[2],!0))}for(var u=null;u=e.single_dep.exec(i);)if(u){c=u[1];i=i.replace(u[0],e.toR1C1(o,c,!0))}return i=(i=i.replace(/ρ/g,"R")).replace(/γ/g,"C")},e.extract_sheet_cell=function(t){(0,n.watchdog)("wd0x012630");var r=e.sheet_plus_cell.exec(t);return r?[r[1],r[2],r[2]]:["","",""]},e.all_cell_dependencies=function(t,r,a,i){void 0===i&&(i=!0),(0,n.watchdog)("wd0x2f82fe");var o=null,c=[];if("string"!=typeof t)return null;for(t=(t=(t=(t=(t=(t=(t=t.replace(this.formulas_with_numbers,"_")).replace(this.formulas_with_quoted_sheetnames_2,"_")).replace(this.formulas_with_quoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_2,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_structured_references,"_");o=e.range_pair.exec(t);)if((0,n.watchdog)("wd0x784918"),o){for(var u=o[1],s=e.cell_dependency(u,r,a),l=o[2],d=e.cell_dependency(l,r,a),f=d[0]-s[0]+1,b=d[1]-s[1]+1,h=0;h<f;h++)for(var v=0;v<b;v++)c.push([h+s[0],v+s[1],0]);t=t.replace(o[0],"_")}for(var p=null;p=e.single_dep.exec(t);)if((0,n.watchdog)("wd0x0fb232"),p){u=p[1];var m=e.cell_dependency(u,r,a);c.push(m),t=t.replace(p[0],"_")}if(i)for(var g=null;g=e.number_dep.exec(t);)(0,n.watchdog)("wd0xd82ed1"),g&&(c.push([0,0,1]),t=t.replace(g[0],"_"));return c},e.numeric_constants=function(t){var r=[];if("string"!=typeof(t=t.slice()))return r;t=(t=(t=(t=(t=(t=(t=t.replace(this.formulas_with_numbers,"_")).replace(this.formulas_with_quoted_sheetnames_2,"_")).replace(this.formulas_with_quoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_2,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_unquoted_sheetnames_1,"_")).replace(this.formulas_with_structured_references,"_");for(var n=null;n=e.range_pair.exec(t);)n&&(t=t.replace(n[0],"_"));for(var a=null;a=e.single_dep.exec(t);)a&&(t=t.replace(a[0],"_"));for(var i=null;i=e.number_dep.exec(t);)i&&(r.push(parseFloat(i)),t=t.replace(i[0],"_"));return r},e.baseVector=function(){return[0,0,0]},e.all_dependencies=function(t,r,a,i,o){(0,n.watchdog)("wd0x961028");var c=[];if(t>=o.length||r>=o[0].length||t<0||r<0)return[];var u=o[t][r];return u.length>1&&"="===u[0]&&(c=e.all_cell_dependencies(u,i,a)),c},e.generate_all_references=function(t,r,a){(0,n.watchdog)("wd0x6a6002");for(var i={},o=0;o<t.length;o++)for(var c=t[o],u=0;u<c.length;u++){(0,n.watchdog)("wd0x93d412");var s=c[u];if("="===s[0])for(var l=0,d=e.all_cell_dependencies(s,0,0);l<d.length;l++){var f=d[l];if((0,n.watchdog)("wd0x8a466e"),0===f[0]&&0===f[1]&&0!==f[2]);else{var b=f[0]-r-1,h=f[1]-a-1,v=!1;if(h>=t.length||b>=t[0].length||b<0||h<0)v=!0;else{var p=t[h][b];void 0!==p&&"="!==p[0]&&(v=!0)}v&&(i[f.join(",")]=!0)}}}return i},e.general_re="\\$?[A-Z][A-Z]?\\$?[\\d\\u2000-\\u6000]+",e.sheet_re="[^\\!]+",e.sheet_plus_cell=new RegExp("("+e.sheet_re+")\\!("+e.general_re+")"),e.sheet_plus_range=new RegExp("("+e.sheet_re+")\\!("+e.general_re+"):("+e.general_re+")"),e.single_dep=new RegExp("("+e.general_re+")"),e.range_pair=new RegExp("("+e.general_re+"):("+e.general_re+")","g"),e.number_dep=new RegExp("([0-9]+\\.?[0-9]*)"),e.cell_both_relative=new RegExp("[^\\$A-Z]?([A-Z][A-Z]?)([\\d\\u2000-\\u6000]+)"),e.cell_col_absolute=new RegExp("\\$([A-Z][A-Z]?)([\\d\\u2000-\\u6000]+)"),e.cell_row_absolute=new RegExp("[^\\$A-Z]?([A-Z][A-Z]?)\\$([\\d\\u2000-\\u6000]+)"),e.cell_both_absolute=new RegExp("\\$([A-Z][A-Z]?)\\$([\\d\\u2000-\\u6000]+)"),e.formulas_with_numbers=new RegExp("/ATAN2|BIN2DEC|BIN2HEX|BIN2OCT|DAYS360|DEC2BIN|DEC2HEX|DEC2OCT|HEX2BIN|HEX2DEC|HEX2OCT|IMLOG2|IMLOG10|LOG10|OCT2BIN|OCT2DEC|OCT2HEX|SUNX2MY2|SUMX2PY2|SUMXMY2|T.DIST.2T|T.INV.2T/","g"),e.formulas_with_quoted_sheetnames_1=new RegExp("'[^']*'!\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_quoted_sheetnames_2=new RegExp("'[^']*'!\\$?[A-Z][A-Z]?\\$?\\d+:\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_unquoted_sheetnames_1=new RegExp("[A-Za-z0-9]+!\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_unquoted_sheetnames_2=new RegExp("[A-Za-z0-9]+!\\$?[A-Z][A-Z]?\\$?\\d+:\\$?[A-Z][A-Z]?\\$?\\d+","g"),e.formulas_with_structured_references=new RegExp("\\[([^\\]])*\\]","g"),e.originalSheetSuffix="_EL",e}();t.ExcelUtils=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Colorize=t.tuple=void 0;var n=r(140),a=r(189),i=r(130),o=r(190),c=r(191),u=r(193),s=r(107);function l(e,t){if("number"==typeof e)return e-t;e=e,t=t;for(var r=0;r<e.length;r+=1){var n=l(e[r],t[r]);if(0!==n)return n}return 0}function d(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return e}t.tuple=d;var f=function(){function e(){}return e.setReportingThreshold=function(t){e.reportingThreshold=t},e.getReportingThreshold=function(){return e.reportingThreshold},e.setFormattingDiscount=function(t){e.formattingDiscount=t},e.getFormattingDiscount=function(){return e.formattingDiscount},e.process_formulas=function(t,r,a){(0,s.watchdog)("wd0xea1170");for(var i=JSON.stringify(n.ExcelUtils.baseVector()),o=function(e,t){return[e[0]+t[0],e[1]+t[1],e[2]+t[2]]},c=[],u=0;u<t.length;u++){(0,s.watchdog)("wd0xa1597b");for(var l=t[u],d=0;d<l.length;d++){(0,s.watchdog)("wd0x0d7fc8");var f=l[d].toString();if(f.length>0){var b=n.ExcelUtils.all_dependencies(u,d,a+u,r+d,t),h=d+r+1,v=u+a+1;if(0===b.length)"="===f[0]&&c.push([[h,v,0],e.distinguishedZeroHash]);else{var p=b.reduce(o);if(JSON.stringify(p)===i)c.push([[h,v,0],p.toString()]);else{var m=this.hash_vector(p).toString();c.push([[h,v,0],m])}}}}}return c},e.color_all_data=function(t){for(var r=[],n=0,a=Object.keys(t);n<a.length;n++){var i=a[n];(0,s.watchdog)("wd0xc22046");var o=i.split(","),c=Number(o[0]),u=Number(o[1]);r.push([[c,u,0],e.distinguishedZeroHash])}return r},e.process_values=function(t,r,n,a){for(var i=[],o=0;o<t.length;o++){(0,s.watchdog)("wd0x503d57");for(var c=t[o],u=0;u<c.length;u++){(0,s.watchdog)("wd0x366ad1");var l=c[u].toString();if(l.length>0&&"="!==r[o][u][0])if(Number(l).toString()===l){var d=u+n+1,f=o+a+1;i.push([[d,f,1],e.distinguishedZeroHash])}}}return i},e.identify_ranges=function(e,t){for(var r={},n=0,a=e;n<a.length;n++){var i=a[n];(0,s.watchdog)("wd0x770d8c"),r[i[1]]=r[i[1]]||[],r[i[1]].push(i[0])}for(var o=0,c=Object.keys(r);o<c.length;o++){var u=c[o];(0,s.watchdog)("wd0x84ae4d"),r[u].sort(t)}return r},e.group_ranges=function(e,t){var r={},n=0,a=1;t||(n=1,a=0);for(var i=0,o=Object.keys(e);i<o.length;i++){var c=o[i];(0,s.watchdog)("wd0xa372ae"),r[c]=[];for(var u=e[c].shift(),l=u,d=0,f=e[c];d<f.length;d++){var b=f[d];b[n]===l[n]&&b[a]===l[a]+1||(r[c].push([u,l]),u=b),l=b}r[c].push([u,l])}return r},e.identify_groups=function(e){var t=this.identify_ranges(e,(function(e,t){return e[0]===t[0]?e[1]-t[1]:e[0]-t[0]})),r=this.group_ranges(t,!0),n=o.JSONclone.clone(r);return this.merge_groups(n)},e.processed_to_matrix=function(t,r,n,a,i){for(var o=new Array(t),c=0;c<t;c++)o[c]=new Array(r).fill(0);for(var u=0,s=i;u<s.length;u++){var l=s[u],d=l[0],f=d[0],b=d[1],h=d[2],v=l[1],p=b-a-1,m=f-n-1,g=Number(e.distinguishedZeroHash);1===h||(g=Number(v)),o[p][m]=g}return o},e.stencilize=function(e){return u.Stencil.stencil_computation(e,(function(e,t){return e*t}),1)},e.compute_stencil_probabilities=function(e,t,r){for(var n=new Array(e),a=0;a<e;a++)n[a]=new Array(t).fill(0);var i=0,o={};for(a=0;a<e;a++)for(var c=0;c<t;c++)o[r[a][c]]=o[r[a][c]]+1||1,0!==r[a][c]&&(i+=1);for(a=0;a<e;a++)for(c=0;c<t;c++)n[a][c]=o[r[a][c]]/i;var u=0,s=0;for(a=0;a<e;a++)for(c=0;c<t;c++)r[a][c]>0&&(s+=o[r[a][c]]);for(a=0;a<e;a++)for(c=0;c<t;c++)o[r[a][c]]>0&&(u+=this.entropy(o[r[a][c]]/s));Math.log2(i);return n},e.generate_suspicious_cells=function(e,t,r,n,a,i,o){void 0===o&&(o=.01);for(var c=[],u=0,s=0,l=0;l<e;l++)for(var d=0;d<t;d++){var f=d+r+1,b=l+n+1;i[l][d]>0&&(u+=a[l][d],s+=1,i[l][d]<=o&&0!==a[l][d]&&c.push([f,b,i[l][d]]))}var h=u/s;return c.sort((function(e,t){return Math.abs(t[2]-h)-Math.abs(e[2]-h)})),c},e.process_suspicious=function(t,r,a){(0,s.watchdog)("wd0x72fd38");new i.Timer("process_suspicious");var o=n.ExcelUtils.extract_sheet_cell(t),c=(o[0],o[1]),u=n.ExcelUtils.cell_dependency(c,0,0),l=[];r.length>this.formulasThreshold?console.warn("Too many formulas to perform formula analysis."):l=e.process_formulas(r,u[0]-1,u[1]-1);var f=[],b=[],h=a.length,v=a[0].length;if(a.length>this.valuesThreshold)console.warn("Too many values to perform reference analysis.");else{var p=n.ExcelUtils.generate_all_references(r,u[0]-1,u[1]-1);f=e.color_all_data(p),b=e.process_values(a,r,u[0]-1,u[1]-1)}var m=e.identify_groups(f),g=e.identify_groups(l),O=[];return a.length<1e4&&(O=e.find_suspicious_cells(h,v,u,r,l,b,1)),d(O,g,m,e.generate_proposed_fixes(g))},e.entropy=function(e){return-e*Math.log2(e)},e.entropydiff=function(e,t){var r=e+t;return-((this.entropy(e/r)+this.entropy(t/r))/Math.log2(r))},e.fix_metric=function(e,t,r,n){var i=t[0],o=t[1],c=n[0],u=n[1],s=a.RectangleUtils.area([[i[0],i[1],0],[o[0],o[1],0]]),l=a.RectangleUtils.area([[c[0],c[1],0],[u[0],u[1],0]]),d=Math.min(s,l),f=Math.max(s,l),b=Math.min(r,e),h=Math.max(r,e),v=Math.abs(h-b)/this.Multiplier;v<1&&(v=1);var p=(1+this.entropydiff(d,f))/(v*d);return p=-p},e.count_proposed_fixes=function(e){var t=0;for(var r in e){var n=e[r][1],i=n[0],o=n[1],c=e[r][2],u=c[0],s=c[1];t+=a.RectangleUtils.diagonal([[i[0],i[1],0],[o[0],o[1],0]]),t+=a.RectangleUtils.diagonal([[u[0],u[1],0],[s[0],s[1],0]])}return t},e.fix_proposed_fixes=function(t){var r={},n={};for(var a in t){if(t[a][1]>t[a][2]){var i=t[a][1];t[a][1]=t[a][2],t[a][2]=i}r[JSON.stringify(t[a][1])]=t[a],n[JSON.stringify(t[a][2])]=t[a]}var o=[],c={};for(var a in t){var u=t[a][0];if(!(-u<e.reportingThreshold/100)){var s=JSON.stringify(t[a][1]),l=JSON.stringify(t[a][2]);if(s in n||l in r){if(!c[s]&&s in n){var d=[-u*JSON.parse(n[s][0]),t[a][1],n[s][1]];o.push(d),c[s]=!0,c[l]=!0;continue}if(!c[l]&&l in r){d=[-u*JSON.parse(r[l][0]),t[a][1],r[l][2]];o.push(d),c[l]=!0,c[s]=!0}}else o.push(t[a])}}return o},e.generate_proposed_fixes=function(e){var t=(0,c.find_all_proposed_fixes)(e);return t.sort(l),t},e.merge_groups=function(e){for(var t=0,r=Object.keys(e);t<r.length;t++){var n=r[t];(0,s.watchdog)("wd0x781a33");var a=e[n].slice();e[n]=this.merge_individual_groups(a)}return e},e.merge_individual_groups=function(e){var t=new i.Timer("merge_individual_groups"),r=0;for(e=e.sort();;){(0,s.watchdog)("wd0x0a3668");for(var n=!1,o={},c=[],u=e.slice();u.length>0;)for(var l=u.shift(),d=0;d<u.length;d++)if((0,s.watchdog)("wd0x9cf1d5"),a.RectangleUtils.is_mergeable(l,u[d])){var f=JSON.stringify(l),b=JSON.stringify(u[d]);if(!(f in o)&&!(b in o)){c.push(a.RectangleUtils.bounding_box(l,u[d])),o[f]=!0,o[b]=!0,n=!0;break}}for(d=0;d<e.length;d++)(0,s.watchdog)("wd0x1bc2bb"),JSON.stringify(e[d])in o||c.push(e[d]);if(c.sort(),!n)return c;if(e=c.slice(),++r>2e3)return console.warn("Too many iterations; abandoning this group."),t.split("done, "+r+" iterations."),[[[-1,-1,0],[-1,-1,0]]]}},e.hash_vector=function(e){var t=0,r=0,n=Math.abs(e[0]-t),a=Math.abs(e[1]-r),i=e[2];return this.Multiplier*(n+a+i)},e.adjust_proposed_fixes=function(e,t,r,n){return e.map((function(e){var a=e[0];if(100*-a<1)return null;for(var i=e[1].map((function(e){return e.toString().padStart(10,"0")})),o=e[2].map((function(e){return e.toString().padStart(10,"0")})),c=i<o?e[1]:e[2],u=i<o?e[2]:e[1],s=c[0],l=s[0],f=s[1],b=c[1],h=(b[0],b[1],u[0]),v=(h[0],h[1],u[1]),p=v[0],m=v[1],g=l-r-1,O=f-n-1,j=p-r-1,y=m-n-1,S=!0,C=JSON.stringify(t[O][g]),k=O;k<=y;k++)for(var E=g;E<=j;E++){if(JSON.stringify(t[k][E])!==C){S=!1;break}}return d(a,c,u,S)})).filter((function(e){return null!==e}))},e.find_suspicious_cells=function(e,t,r,n,a,i,o){return(0,s.watchdog)("wd0x8cabd6"),[]},e.reportingThreshold=35,e.suspiciousCellsReportingThreshold=85,e.formattingDiscount=50,e.formulasThreshold=1e4,e.valuesThreshold=1e4,e.Multiplier=1,e.distinguishedZeroHash="12345",e}();t.Colorize=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.detect_errors=void 0;var n=r(188);Object.defineProperty(t,"detect_errors",{enumerable:!0,get:function(){return n.detect_errors}})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PackageName=t.delete_me=void 0;var n=r(194);Object.defineProperty(t,"delete_me",{enumerable:!0,get:function(){return n.delete_me}}),t.PackageName="excel-online-calc-lang"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PackageName=t.delete_me=void 0;var n=r(195);Object.defineProperty(t,"delete_me",{enumerable:!0,get:function(){return n.delete_me}}),t.PackageName="excel-online-calc-syntax"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PackageName=t.delete_me=void 0;var n=r(196);Object.defineProperty(t,"delete_me",{enumerable:!0,get:function(){return n.delete_me}}),t.PackageName="excel-online-calc-numfmt"},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PackageName=t.delete_me=void 0;var n=r(197);Object.defineProperty(t,"delete_me",{enumerable:!0,get:function(){return n.delete_me}}),t.PackageName="excel-online-calc-runtime"},function(e,t,r){"use strict";var n=r(198),a=r(200);function i(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}t.parse=O,t.resolve=function(e,t){return O(e,!1,!0).resolve(t)},t.resolveObject=function(e,t){return e?O(e,!1,!0).resolveObject(t):t},t.format=function(e){a.isString(e)&&(e=O(e));return e instanceof i?e.format():i.prototype.format.call(e)},t.Url=i;var o=/^([a-z0-9.+-]+:)/i,c=/:[0-9]*$/,u=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,s=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),l=["'"].concat(s),d=["%","/","?",";","#"].concat(l),f=["/","?","#"],b=/^[+a-z0-9A-Z_-]{0,63}$/,h=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,v={javascript:!0,"javascript:":!0},p={javascript:!0,"javascript:":!0},m={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},g=r(201);function O(e,t,r){if(e&&a.isObject(e)&&e instanceof i)return e;var n=new i;return n.parse(e,t,r),n}i.prototype.parse=function(e,t,r){if(!a.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var i=e.indexOf("?"),c=-1!==i&&i<e.indexOf("#")?"?":"#",s=e.split(c);s[0]=s[0].replace(/\\/g,"/");var O=e=s.join(c);if(O=O.trim(),!r&&1===e.split("#").length){var j=u.exec(O);if(j)return this.path=O,this.href=O,this.pathname=j[1],j[2]?(this.search=j[2],this.query=t?g.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var y=o.exec(O);if(y){var S=(y=y[0]).toLowerCase();this.protocol=S,O=O.substr(y.length)}if(r||y||O.match(/^\/\/[^@\/]+@[^@\/]+/)){var C="//"===O.substr(0,2);!C||y&&p[y]||(O=O.substr(2),this.slashes=!0)}if(!p[y]&&(C||y&&!m[y])){for(var k,E,A=-1,N=0;N<f.length;N++){-1!==(T=O.indexOf(f[N]))&&(-1===A||T<A)&&(A=T)}-1!==(E=-1===A?O.lastIndexOf("@"):O.lastIndexOf("@",A))&&(k=O.slice(0,E),O=O.slice(E+1),this.auth=decodeURIComponent(k)),A=-1;for(N=0;N<d.length;N++){var T;-1!==(T=O.indexOf(d[N]))&&(-1===A||T<A)&&(A=T)}-1===A&&(A=O.length),this.host=O.slice(0,A),O=O.slice(A),this.parseHost(),this.hostname=this.hostname||"";var R="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!R)for(var I=this.hostname.split(/\./),_=(N=0,I.length);N<_;N++){var F=I[N];if(F&&!F.match(b)){for(var w="",M=0,D=F.length;M<D;M++)F.charCodeAt(M)>127?w+="x":w+=F[M];if(!w.match(b)){var P=I.slice(0,N),x=I.slice(N+1),L=F.match(h);L&&(P.push(L[1]),x.unshift(L[2])),x.length&&(O="/"+x.join(".")+O),this.hostname=P.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),R||(this.hostname=n.toASCII(this.hostname));var B=this.port?":"+this.port:"",U=this.hostname||"";this.host=U+B,this.href+=this.host,R&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==O[0]&&(O="/"+O))}if(!v[S])for(N=0,_=l.length;N<_;N++){var G=l[N];if(-1!==O.indexOf(G)){var V=encodeURIComponent(G);V===G&&(V=escape(G)),O=O.split(G).join(V)}}var H=O.indexOf("#");-1!==H&&(this.hash=O.substr(H),O=O.slice(0,H));var W=O.indexOf("?");if(-1!==W?(this.search=O.substr(W),this.query=O.substr(W+1),t&&(this.query=g.parse(this.query)),O=O.slice(0,W)):t&&(this.search="",this.query={}),O&&(this.pathname=O),m[S]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){B=this.pathname||"";var z=this.search||"";this.path=B+z}return this.href=this.format(),this},i.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",r=this.pathname||"",n=this.hash||"",i=!1,o="";this.host?i=e+this.host:this.hostname&&(i=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&a.isObject(this.query)&&Object.keys(this.query).length&&(o=g.stringify(this.query));var c=this.search||o&&"?"+o||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||m[t])&&!1!==i?(i="//"+(i||""),r&&"/"!==r.charAt(0)&&(r="/"+r)):i||(i=""),n&&"#"!==n.charAt(0)&&(n="#"+n),c&&"?"!==c.charAt(0)&&(c="?"+c),t+i+(r=r.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(c=c.replace("#","%23"))+n},i.prototype.resolve=function(e){return this.resolveObject(O(e,!1,!0)).format()},i.prototype.resolveObject=function(e){if(a.isString(e)){var t=new i;t.parse(e,!1,!0),e=t}for(var r=new i,n=Object.keys(this),o=0;o<n.length;o++){var c=n[o];r[c]=this[c]}if(r.hash=e.hash,""===e.href)return r.href=r.format(),r;if(e.slashes&&!e.protocol){for(var u=Object.keys(e),s=0;s<u.length;s++){var l=u[s];"protocol"!==l&&(r[l]=e[l])}return m[r.protocol]&&r.hostname&&!r.pathname&&(r.path=r.pathname="/"),r.href=r.format(),r}if(e.protocol&&e.protocol!==r.protocol){if(!m[e.protocol]){for(var d=Object.keys(e),f=0;f<d.length;f++){var b=d[f];r[b]=e[b]}return r.href=r.format(),r}if(r.protocol=e.protocol,e.host||p[e.protocol])r.pathname=e.pathname;else{for(var h=(e.pathname||"").split("/");h.length&&!(e.host=h.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==h[0]&&h.unshift(""),h.length<2&&h.unshift(""),r.pathname=h.join("/")}if(r.search=e.search,r.query=e.query,r.host=e.host||"",r.auth=e.auth,r.hostname=e.hostname||e.host,r.port=e.port,r.pathname||r.search){var v=r.pathname||"",g=r.search||"";r.path=v+g}return r.slashes=r.slashes||e.slashes,r.href=r.format(),r}var O=r.pathname&&"/"===r.pathname.charAt(0),j=e.host||e.pathname&&"/"===e.pathname.charAt(0),y=j||O||r.host&&e.pathname,S=y,C=r.pathname&&r.pathname.split("/")||[],k=(h=e.pathname&&e.pathname.split("/")||[],r.protocol&&!m[r.protocol]);if(k&&(r.hostname="",r.port=null,r.host&&(""===C[0]?C[0]=r.host:C.unshift(r.host)),r.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===h[0]?h[0]=e.host:h.unshift(e.host)),e.host=null),y=y&&(""===h[0]||""===C[0])),j)r.host=e.host||""===e.host?e.host:r.host,r.hostname=e.hostname||""===e.hostname?e.hostname:r.hostname,r.search=e.search,r.query=e.query,C=h;else if(h.length)C||(C=[]),C.pop(),C=C.concat(h),r.search=e.search,r.query=e.query;else if(!a.isNullOrUndefined(e.search)){if(k)r.hostname=r.host=C.shift(),(R=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=R.shift(),r.host=r.hostname=R.shift());return r.search=e.search,r.query=e.query,a.isNull(r.pathname)&&a.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.href=r.format(),r}if(!C.length)return r.pathname=null,r.search?r.path="/"+r.search:r.path=null,r.href=r.format(),r;for(var E=C.slice(-1)[0],A=(r.host||e.host||C.length>1)&&("."===E||".."===E)||""===E,N=0,T=C.length;T>=0;T--)"."===(E=C[T])?C.splice(T,1):".."===E?(C.splice(T,1),N++):N&&(C.splice(T,1),N--);if(!y&&!S)for(;N--;N)C.unshift("..");!y||""===C[0]||C[0]&&"/"===C[0].charAt(0)||C.unshift(""),A&&"/"!==C.join("/").substr(-1)&&C.push("");var R,I=""===C[0]||C[0]&&"/"===C[0].charAt(0);k&&(r.hostname=r.host=I?"":C.length?C.shift():"",(R=!!(r.host&&r.host.indexOf("@")>0)&&r.host.split("@"))&&(r.auth=R.shift(),r.host=r.hostname=R.shift()));return(y=y||r.host&&C.length)&&!I&&C.unshift(""),C.length?r.pathname=C.join("/"):(r.pathname=null,r.path=null),a.isNull(r.pathname)&&a.isNull(r.search)||(r.path=(r.pathname?r.pathname:"")+(r.search?r.search:"")),r.auth=e.auth||r.auth,r.slashes=r.slashes||e.slashes,r.href=r.format(),r},i.prototype.parseHost=function(){var e=this.host,t=c.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)}},function(e,t,r){r(149),r(150),e.exports=r(204)},function(e,t,r){
/*!
 * @overview es6-promise - a tiny implementation of Promises/A+.
 * @copyright Copyright (c) 2014 Yehuda Katz, Tom Dale, Stefan Penner and contributors (Conversion to ES6 API by Jake Archibald)
 * @license   Licensed under MIT license
 *            See https://raw.githubusercontent.com/stefanpenner/es6-promise/master/LICENSE
 * @version   v4.2.8+1e68dce6
 */var n;n=function(){"use strict";function e(e){return"function"==typeof e}var t=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},r=0,n=void 0,a=void 0,i=function(e,t){f[r]=e,f[r+1]=t,2===(r+=2)&&(a?a(b):g())},o="undefined"!=typeof window?window:void 0,c=o||{},u=c.MutationObserver||c.WebKitMutationObserver,s="undefined"==typeof self&&"undefined"!=typeof process&&"[object process]"==={}.toString.call(process),l="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function d(){var e=setTimeout;return function(){return e(b,1)}}var f=new Array(1e3);function b(){for(var e=0;e<r;e+=2)(0,f[e])(f[e+1]),f[e]=void 0,f[e+1]=void 0;r=0}var h,v,p,m,g=void 0;function O(e,t){var r=this,n=new this.constructor(S);void 0===n[y]&&F(n);var a=r._state;if(a){var o=arguments[a-1];i((function(){return I(a,n,o,r._result)}))}else T(r,n,e,t);return n}function j(e){if(e&&"object"==typeof e&&e.constructor===this)return e;var t=new this(S);return k(t,e),t}s?g=function(){return process.nextTick(b)}:u?(v=0,p=new u(b),m=document.createTextNode(""),p.observe(m,{characterData:!0}),g=function(){m.data=v=++v%2}):l?((h=new MessageChannel).port1.onmessage=b,g=function(){return h.port2.postMessage(0)}):g=void 0===o?function(){try{var e=Function("return this")().require("vertx");return void 0!==(n=e.runOnLoop||e.runOnContext)?function(){n(b)}:d()}catch(e){return d()}}():d();var y=Math.random().toString(36).substring(2);function S(){}function C(t,r,n){r.constructor===t.constructor&&n===O&&r.constructor.resolve===j?function(e,t){1===t._state?A(e,t._result):2===t._state?N(e,t._result):T(t,void 0,(function(t){return k(e,t)}),(function(t){return N(e,t)}))}(t,r):void 0===n?A(t,r):e(n)?function(e,t,r){i((function(e){var n=!1,a=function(e,t,r,n){try{e.call(t,r,n)}catch(e){return e}}(r,t,(function(r){n||(n=!0,t!==r?k(e,r):A(e,r))}),(function(t){n||(n=!0,N(e,t))}),e._label);!n&&a&&(n=!0,N(e,a))}),e)}(t,r,n):A(t,r)}function k(e,t){if(e===t)N(e,new TypeError("You cannot resolve a promise with itself"));else if(a=typeof(n=t),null===n||"object"!==a&&"function"!==a)A(e,t);else{var r=void 0;try{r=t.then}catch(t){return void N(e,t)}C(e,t,r)}var n,a}function E(e){e._onerror&&e._onerror(e._result),R(e)}function A(e,t){void 0===e._state&&(e._result=t,e._state=1,0!==e._subscribers.length&&i(R,e))}function N(e,t){void 0===e._state&&(e._state=2,e._result=t,i(E,e))}function T(e,t,r,n){var a=e._subscribers,o=a.length;e._onerror=null,a[o]=t,a[o+1]=r,a[o+2]=n,0===o&&e._state&&i(R,e)}function R(e){var t=e._subscribers,r=e._state;if(0!==t.length){for(var n=void 0,a=void 0,i=e._result,o=0;o<t.length;o+=3)n=t[o],a=t[o+r],n?I(r,n,a,i):a(i);e._subscribers.length=0}}function I(t,r,n,a){var i=e(n),o=void 0,c=void 0,u=!0;if(i){try{o=n(a)}catch(e){u=!1,c=e}if(r===o)return void N(r,new TypeError("A promises callback cannot return that same promise."))}else o=a;void 0!==r._state||(i&&u?k(r,o):!1===u?N(r,c):1===t?A(r,o):2===t&&N(r,o))}var _=0;function F(e){e[y]=_++,e._state=void 0,e._result=void 0,e._subscribers=[]}var w=function(){function e(e,r){this._instanceConstructor=e,this.promise=new e(S),this.promise[y]||F(this.promise),t(r)?(this.length=r.length,this._remaining=r.length,this._result=new Array(this.length),0===this.length?A(this.promise,this._result):(this.length=this.length||0,this._enumerate(r),0===this._remaining&&A(this.promise,this._result))):N(this.promise,new Error("Array Methods must be provided an Array"))}return e.prototype._enumerate=function(e){for(var t=0;void 0===this._state&&t<e.length;t++)this._eachEntry(e[t],t)},e.prototype._eachEntry=function(e,t){var r=this._instanceConstructor,n=r.resolve;if(n===j){var a=void 0,i=void 0,o=!1;try{a=e.then}catch(e){o=!0,i=e}if(a===O&&void 0!==e._state)this._settledAt(e._state,t,e._result);else if("function"!=typeof a)this._remaining--,this._result[t]=e;else if(r===M){var c=new r(S);o?N(c,i):C(c,e,a),this._willSettleAt(c,t)}else this._willSettleAt(new r((function(t){return t(e)})),t)}else this._willSettleAt(n(e),t)},e.prototype._settledAt=function(e,t,r){var n=this.promise;void 0===n._state&&(this._remaining--,2===e?N(n,r):this._result[t]=r),0===this._remaining&&A(n,this._result)},e.prototype._willSettleAt=function(e,t){var r=this;T(e,void 0,(function(e){return r._settledAt(1,t,e)}),(function(e){return r._settledAt(2,t,e)}))},e}(),M=function(){function t(e){this[y]=_++,this._result=this._state=void 0,this._subscribers=[],S!==e&&("function"!=typeof e&&function(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof t?function(e,t){try{t((function(t){k(e,t)}),(function(t){N(e,t)}))}catch(t){N(e,t)}}(this,e):function(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return t.prototype.catch=function(e){return this.then(null,e)},t.prototype.finally=function(t){var r=this.constructor;return e(t)?this.then((function(e){return r.resolve(t()).then((function(){return e}))}),(function(e){return r.resolve(t()).then((function(){throw e}))})):this.then(t,t)},t}();return M.prototype.then=O,M.all=function(e){return new w(this,e).promise},M.race=function(e){var r=this;return t(e)?new r((function(t,n){for(var a=e.length,i=0;i<a;i++)r.resolve(e[i]).then(t,n)})):new r((function(e,t){return t(new TypeError("You must pass an array to race."))}))},M.resolve=j,M.reject=function(e){var t=new this(S);return N(t,e),t},M._setScheduler=function(e){a=e},M._setAsap=function(e){i=e},M._asap=i,M.polyfill=function(){var e=void 0;if("undefined"!=typeof global)e=global;else if("undefined"!=typeof self)e=self;else try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var t=e.Promise;if(t){var r=null;try{r=Object.prototype.toString.call(t.resolve())}catch(e){}if("[object Promise]"===r&&!t.cast)return}e.Promise=M},M.Promise=M,M.polyfill(),M},e.exports=n()},function(e,t){!function(e,t){"use strict";if(!e.setImmediate){var r,n,a,i,o,c=1,u={},s=!1,l=e.document,d=Object.getPrototypeOf&&Object.getPrototypeOf(e);d=d&&d.setTimeout?d:e,"[object process]"==={}.toString.call(e.process)?r=function(e){process.nextTick((function(){b(e)}))}:!function(){if(e.postMessage&&!e.importScripts){var t=!0,r=e.onmessage;return e.onmessage=function(){t=!1},e.postMessage("","*"),e.onmessage=r,t}}()?e.MessageChannel?((a=new MessageChannel).port1.onmessage=function(e){b(e.data)},r=function(e){a.port2.postMessage(e)}):l&&"onreadystatechange"in l.createElement("script")?(n=l.documentElement,r=function(e){var t=l.createElement("script");t.onreadystatechange=function(){b(e),t.onreadystatechange=null,n.removeChild(t),t=null},n.appendChild(t)}):r=function(e){setTimeout(b,0,e)}:(i="setImmediate$"+Math.random()+"$",o=function(t){t.source===e&&"string"==typeof t.data&&0===t.data.indexOf(i)&&b(+t.data.slice(i.length))},e.addEventListener?e.addEventListener("message",o,!1):e.attachEvent("onmessage",o),r=function(t){e.postMessage(i+t,"*")}),d.setImmediate=function(e){"function"!=typeof e&&(e=new Function(""+e));for(var t=new Array(arguments.length-1),n=0;n<t.length;n++)t[n]=arguments[n+1];var a={callback:e,args:t};return u[c]=a,r(c),c++},d.clearImmediate=f}function f(e){delete u[e]}function b(e){if(s)setTimeout(b,0,e);else{var t=u[e];if(t){s=!0;try{!function(e){var t=e.callback,r=e.args;switch(r.length){case 0:t();break;case 1:t(r[0]);break;case 2:t(r[0],r[1]);break;case 3:t(r[0],r[1],r[2]);break;default:t.apply(void 0,r)}}(t)}finally{f(e),s=!1}}}}}("undefined"==typeof self?"undefined"==typeof global?this:global:self)},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fnv1a=void 0;t.fnv1a=function(e){for(var t=2166136261,r=e.length,n=0;n<r;n+=1)t^=e.charCodeAt(n),t+=(t<<1)+(t<<4)+(t<<7)+(t<<8)+(t<<24);return t>>>0}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.findIsomorphicSubtrees=void 0,t.findIsomorphicSubtrees=function(e,t,r,n){void 0===r&&(r=function(){return""}),void 0===n&&(n=function(){return 1});for(var a=[e],i=new Set(a),o=0;o<a.length;o+=1)for(var c=0,u=t(a[o]);c<u.length;c++){var s=u[c];i.has(s)||(i.add(s),a.push(s))}i.clear(),a.reverse();var l=new Map,d=[],f=new Map,b=[];a.forEach((function(e,a){var i=t(e).map((function(e){return l.get(e)}));if(i.some((function(e){return void 0===e})))throw new Error("Circular references in the tree");var o=i.map((function(e){return d[e]})),c=function(e){var t=f.get(e);return void 0!==t||(t=f.size,f.set(e,t)),t}(o.join("/")+"/"+r(e));if(d.push(c),void 0===b[c]){var u=o.map((function(e){return b[e]})),s=u.map((function(e){return e.size})).reduce((function(e,t){return e+t}),n(e)),h=u.map((function(e){return e.depth})).reduce((function(e,t){return Math.max(e,t)}),0)+1;b[c]={subtrees:[e],size:s,depth:h}}else b[c].subtrees.push(e);l.set(e,a)}));for(var h=0,v=b;h<v.length;h++){(O=v[h]).subtrees.reverse()}for(var p=new Array(a.length),m=0,g=b;m<g.length;m++){var O=g[m];p[p.length-l.get(O.subtrees[0])-1]=O}return p.filter((function(e){return void 0!==e}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getBoundingRectForText=t.getCharIndexInTextFromPoint=t.calcHashCode=t.decodeHtml=t.getQueryParameterByName=t.chainFallbackPromises=t.retry=t.getPerfWatchMarkName=t.getStringifiedError=t.defaultToJSONResultWhenStringifyFails=t.forEachPromise=void 0,t.forEachPromise=function(e,t,r){return e.reduce((function(e,n){return e.then((function(){return r&&r.stop?Promise.resolve(void 0):t(n,r)}))}),Promise.resolve(void 0))},t.defaultToJSONResultWhenStringifyFails="...",t.getStringifiedError=function(e){if(0===e)return"0";if(!e)return"";try{return JSON.stringify(function e(t,r){void 0===r&&(r=0);if(r<0||r>5)return t;if(null==t||"object"!=typeof t)return t;var n={};Object.getOwnPropertyNames(t).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(n[e]=t[e])}));var a=Object.getPrototypeOf(t);a&&"object"==typeof a&&Object.keys(a).forEach((function(e){"stack"!==e&&e.toUpperCase()!==e&&(n[e]=t[e])}));var i={};return Object.keys(n).forEach((function(t){i[t]=e(n[t],r+1)})),i}(e))}catch(e){return t.defaultToJSONResultWhenStringifyFails}};var n=new RegExp("".concat("\\W","+"),"g");t.getPerfWatchMarkName=function(e){if(!e)return"";var t=e.trim().substring(0,200).trim().replace(n,"_").substring(0,80);return t&&t.length>0&&"_"===t.substr(t.length-1,1)&&(t=t.substr(0,t.length-1)),t&&t.length>0&&"_"===t.substr(0,1)&&(t=t.substr(1)),t},t.retry=function(e,t){if(!e)return Promise.reject(new Error("utils.retry: action can't be null or undefined"));if(t<1)return Promise.reject(new Error("utils.retry: attempts expected to be greater than 0 but got ".concat(t)));for(var r=Promise.reject(),n=function(t){r=r.catch((function(r){return e(t,r)}))},a=1;a<=t;a+=1)n(a);return r},t.chainFallbackPromises=function(e,t){if(!e||0===e.length)return Promise.reject();for(var r=t(e[0]),n=function(n){var a=e[n];r=r.catch((function(){return t(a)}))},a=1;a<e.length;a+=1)n(a);return r},t.getQueryParameterByName=function(e,t){var r=new RegExp("[?&]".concat(t,"(=([^&#]*)|&|#|$)")).exec(e);if(r)return r[2]?decodeURIComponent(r[2].replace(/\+/g," ")):""},t.decodeHtml=function(e){return"string"==typeof e?(new DOMParser).parseFromString(e,"text/html").documentElement.textContent:e},t.calcHashCode=function(e){if(!e)return 0;for(var t=5381,r=t,n=e.length,a=0;a<n&&(t=4294967295&((t<<5)+t^e.charCodeAt(a)),a!==n-1);a+=2)r=4294967295&((r<<5)+r^e.charCodeAt(a+1));var i=t+35685*r+(23896*r<<16)&4294967295;return i<0&&(i+=4294967296),i},t.getCharIndexInTextFromPoint=function(e,t,r){void 0===r&&(r=!1);var n=-1,a=null;if(void 0!==document.caretPositionFromPoint)null!==(i=document.caretPositionFromPoint(e,t))&&(n=i.offset,a=null!=i.offsetNode&&null!=i.offsetNode.parentElement&&"SPAN"===i.offsetNode.parentElement.nodeName?i.offsetNode.parentElement:i.offsetNode);else if(void 0!==document.caretRangeFromPoint){null!==(i=document.caretRangeFromPoint(e,t))&&(n=i.startOffset,a=null!=i.startContainer&&null!=i.startContainer.parentElement&&"SPAN"===i.startContainer.parentElement.nodeName?i.startContainer.parentElement:i.startContainer)}else try{var i;a=document.elementFromPoint(e,t),(i=document.body.createTextRange()).moveToPoint(e,t);var o=document.body.createTextRange();o.moveToElementText(a),o.setEndPoint("EndToStart",i),n=o.text.length}catch(e){return n}if(r)for(var c=!1;null!=a;)null===a.previousSibling&&null!==a.parentNode&&null!==a.parentNode.parentNode&&a.parentNode.parentNode.childNodes.length>1&&!c?(a=a.parentNode,c=!0):null!=(a=a.previousSibling)&&null!=a.textContent&&(n+=a.textContent.length,c&&(n+=1));else for(;null!=a;)null!=(a=a.previousSibling)&&null!=a.textContent&&(n+=a.textContent.length);return n},t.getBoundingRectForText=function(e,t,r,n){function a(e,t,r){if(!e||!e.textContent)return t;if(n&&(t<0||t>e.textContent.length&&(0===e.childNodes.length||"DIV"!==e.childNodes[0].nodeName)))return t-e.textContent.length;if(t<0||t>e.textContent.length)return t-e.textContent.length;if(!e.hasChildNodes())return r(e,t),t-e.textContent.length;for(var i=e.childNodes,o=0;o<i.length&&t>=0;o+=1)t=a(i[o],t,r),n&&"DIV"===i[o].nodeName&&(t-=1);return t}void 0===n&&(n=!1);var i=document.createRange();return a(e,t,(function(e,t){return i.setStart(e,t)})),a(e,r,(function(e,t){return i.setEnd(e,t)})),i.getBoundingClientRect()}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.promises=void 0;var n={};t.promises=function(){return void 0===n.promises&&(n.promises="undefined"!=typeof Promise&&"function"==typeof Promise.resolve&&Promise.resolve(0)&&"function"==typeof Promise.resolve(0).then),n.promises}},function(e,t,r){"use strict";function n(){var e="undefined"!=typeof self?self:window;return e.performance&&e.performance.now?e.performance.now():Date.now()}function a(e,t,r){e[t]=n()-r}Object.defineProperty(t,"__esModule",{value:!0}),t.timeStamp=t.failure=t.success=t.end=t.mark=t.start=void 0,t.start=function(e){var t=n(),r=e,i=t,o={},c=function(e,t,n){return function(e,t,r,n,i,o){a(e,"end",r);var c={sessionName:t,result:n?"success":"failure",message:o,marks:e},u=JSON.stringify(c);i(u)}(o,r,i,e,t,n)};return o.start=0,{mark:function(e){return function(e){return a(o,e,i)}(e)},end:function(e){return c(!0,e)},success:function(e,t){return c(!0,e,t)},failure:function(e,t){return c(!1,e,t)}}},t.mark=function(e,t){void 0!==e&&e.mark(t)},t.end=function(e,t){void 0!==e&&e.end(t)},t.success=function(e,t,r){void 0!==e&&e.success(t,r)},t.failure=function(e,t,r){void 0!==e&&e.failure(t,r)},t.timeStamp=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initEwaUtils=t.ewaUtils=void 0;var n=r(157),a={isChangeGateEnabled:function(e){return!1}};t.ewaUtils=function(){return a},t.initEwaUtils=function(e){if(!e)throw new Error("the 'ewaUtils' argument is missing");(0,n.setChangeGatesManager)({isChangeGateEnabled:e.isChangeGateEnabled}),a=e}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=r(9);n.__exportStar(r(158),t),n.__exportStar(r(159),t)},function(e,t,r){"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),t.isChangeGateEnabled=t.setChangeGatesManager=void 0;t.setChangeGatesManager=function(e){n=e};t.isChangeGateEnabled=function(e){return!n||n.isChangeGateEnabled(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0})},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.initStopwatchFactory=void 0;var n=function(){return Date.now()};t.initStopwatchFactory=function(e,t){return void 0===t&&(t=1),"undefined"!=typeof self&&self.performance&&self.performance.now&&(n=function(){return self.performance.now()}),function(r){var a=n(),i=r;return{reset:function(e){null!=e&&(i=e),a=n()},stop:function(r){var o=n()-a,c=JSON.stringify({Target:i,Duration:o.toFixed(t),StopInfo:r});e(c)}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TelemetryCollector=void 0;var n=function(){function e(){this.counters={},this.timers={},this.events={}}return e.prototype.getJsonForLogging=function(){return'{"Events":'+this.getEventsLoggableString()+',"Counters":'+this.getCountersLoggableString()+',"Timers":'+this.getTimersLoggableString()+"}"},e.prototype.addEvent=function(e,t){null!=e&&null!=t&&(this.events[e]=t)},e.prototype.clearEvents=function(){this.events={}},e.prototype.getEventsLoggableString=function(){return JSON.stringify(this.events)},e.prototype.incrementCounter=function(e){null!=e&&(this.counters.hasOwnProperty(e)?this.counters[e]+=1:this.counters[e]=1)},e.prototype.getCountersLoggableString=function(){return JSON.stringify(this.counters)},e.prototype.clearCounters=function(){this.counters={}},e.prototype.startTimer=function(e){null!=e&&(this.timers[e]={name:e,startTime:Date.now(),endTime:void 0,isRunning:!0,duration:void 0})},e.prototype.endTimer=function(e){null!=e&&this.timers.hasOwnProperty(e)&&(this.timers[e].endTime=Date.now(),this.timers[e].isRunning=!1,this.timers[e].duration=this.timers[e].endTime-this.timers[e].startTime)},e.prototype.getTimerDuration=function(e){return null==e?"-1":this.timers.hasOwnProperty(e)&&void 0!==this.timers[e].duration?this.timers[e].duration:"-1"},e.prototype.getTimersLoggableString=function(){return JSON.stringify(this.timers)},e}();t.TelemetryCollector=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getNewGuid=void 0,t.getNewGuid=function(){var e=new Uint8Array(31),t=function(e){var t={crypto:!1,perfNow:!1,exceptions:[]},r="undefined"!=typeof self?self:window,n=r.crypto||r.msCrypto;if(n){t.crypto=!0;try{return n.getRandomValues(e),t}catch(e){t.exceptions.push("crypto: ".concat(JSON.stringify(e)))}}var a=!1,i=r.performance;try{i&&i.now&&i.now()!==1/0&&(a=!0)}catch(e){t.exceptions.push("perfNow: ".concat(JSON.stringify(e)))}for(var o=0;o<e.length;o+=1){try{if(a){t.perfNow=!0;var c=Math.floor(100*i.now())%10;(c<0||c>9)&&(c=0);for(var u=0;u<c;u+=1)Math.random()}}catch(e){t.exceptions.push("Math.random: ".concat(JSON.stringify(e)))}e[o]=Math.floor(16*Math.random())}return t}(e),r=0;return["xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(t){var n=15&e[r];return r+=1,("x"===t?n:3&n|8).toString(16)})),t]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.TextAreaInputMode=t.TextAreaVirtualKeyboardPolicy=void 0,function(e){e.Auto="auto",e.Manual="manual"}(t.TextAreaVirtualKeyboardPolicy||(t.TextAreaVirtualKeyboardPolicy={})),function(e){e.None="none",e.Text="text",e.Tel="tel",e.Url="url",e.Email="email",e.Numeric="numeric",e.Decimal="decimal",e.Search="search"}(t.TextAreaInputMode||(t.TextAreaInputMode={}))},function(e,t,r){"use strict";e.exports=r(165)()?globalThis:r(166)},function(e,t,r){"use strict";e.exports=function(){return"object"==typeof globalThis&&(!!globalThis&&globalThis.Array===Array)}},function(e,t){var r=function(){if("object"==typeof self&&self)return self;if("object"==typeof window&&window)return window;throw new Error("Unable to resolve global `this`")};e.exports=function(){if(this)return this;try{Object.defineProperty(Object.prototype,"__global__",{get:function(){return this},configurable:!0})}catch(e){return r()}try{return __global__||r()}finally{delete Object.prototype.__global__}}()},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeGetTypedFeatureGate=void 0;var n=r(126);t.makeGetTypedFeatureGate=function(e){return function(t){var r=e[t];switch(typeof r){case"boolean":return(0,n.getBooleanFeatureGate)(t,r);case"number":return(0,n.getNumberFeatureGate)(t,r);case"string":return(0,n.getStringFeatureGate)(t,r);default:throw new Error("Wrong defaultValue type")}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeTypedIsChangeGateEnabled=void 0;var n=r(127);t.makeTypedIsChangeGateEnabled=function(e){return function(e){return(0,n.isChangeGateEnabled)(e)}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedChangeGates=t.overrideChangeGates=void 0;var n=r(9),a=r(127);function i(e){var t=(0,a.setChangeGateDictionaryGetter)(void 0);return void 0===t?(0,a.setChangeGateDictionaryGetter)(void 0):(0,a.setChangeGateDictionaryGetter)((function(){var r=t();return null===r?null:n.__assign(n.__assign({},r),e)})),t}t.overrideChangeGates=i,t.overrideTypedChangeGates=function(e,t){return i(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.overrideTypedFeatureGates=t.overrideFeatureGates=void 0;var n=r(9),a=r(126);function i(e){for(var t,r,i={},o=0,c=Object.keys(e);o<c.length;o++){var u=c[o];i[u]=null===(t=e[u])||void 0===t?void 0:t.toString()}var s=null!==(r=(0,a.setFeatureGateDictionaryGetter)(void 0))&&void 0!==r?r:function(){return{}};return(0,a.setFeatureGateDictionaryGetter)((function(){return n.__assign(n.__assign({},s()),i)})),s}t.overrideFeatureGates=i,t.overrideTypedFeatureGates=function(e,t){return i(t)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.randomElement=t.randomShuffled=t.randomIndex=t.randomFloat=void 0;var n,a,i=r(103),o=r(131),c=(n=.4531024141007942,a=null!=Object({NODE_ENV:"production"}).BUILD_BUILDID?n:Math.random()*Date.now(),new o.JSF32(a));function u(e){return(0,i.assertTrue)("calc.common.randomIndex",e>0),Math.min(e-1,Math.floor(c.next()*e))}t.randomFloat=function(){return c.next()},t.randomIndex=u,t.randomShuffled=function(e){return e.map((function(e){return[c.next(),e]})).sort((function(e,t){return e[0]<t[0]?-1:e[0]===t[0]?0:1})).map((function(e){return e[1]}))},t.randomElement=function(e){return e[u(e.length)]}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.enumerateKeysInOrder=t.enumerateInOrder=t.RootPointer=t.ArrayMapTree=t.floorToPowerOf2=void 0;var n=r(104);function a(e){if(0===e)return 0;var t=e;return t=((t=((t=((t=((t=(t|t>>>1)>>>0)|t>>>2)>>>0)|t>>>4)>>>0)|t>>>8)>>>0)|t>>>16)>>>0,(t+=1)/2}t.floorToPowerOf2=a;var i=function(){function e(e,t,r){this.keyCompare=e,this.keys=t,this.values=r}return e.create=function(t){return new e(t,[],[])},e.prototype.setValue=function(e,t){return this.setValues([[e,t]])},e.prototype.remove=function(e){return void 0===this.getKeyIndex(e)?this:this.filter((function(t){return t!==e}))},e.prototype.getOrSetValue=function(e,t){var r=this.getKeyIndex(e);if(void 0===r){var n=t();return[this.setValue(e,n),n]}return[this,this.values[r]]},e.prototype.filter=function(e){for(var t=[],r=0;r<this.keys.length;r+=1){var n=this.keys[r],a=this.values[r];e(n,a)&&t.push([n,a])}return t.length===this.getCount()?this:this.ofSequence(t)},e.prototype.getCount=function(){return this.keys.length},e.prototype.getValue=function(e){var t=this.getKeyIndex(e);if(void 0!==t)return this.values[t]},e.prototype.getEntry=function(e){var t=this.getKeyIndex(e);if(void 0!==t)return(0,n.entry)(this.keys[t],this.values[t])},e.prototype.contains=function(e){return void 0!==this.getKeyIndex(e)},e.prototype.forEach=function(e){for(var t=0;t<this.keys.length;t+=1)if(!e(this.keys[t],this.values[t]))return!1;return!0},e.prototype.setValues=function(e){var t=this,r=this.keys.map((function(e,r){return[e,t.values[r],r]})),n=r.length;e.forEach((function(e,t){var a=e[0],i=e[1];return r.push([a,i,t+n])})),r.sort((function(e,r){var n=e[0],a=e[2],i=r[0],o=r[2],c=t.keyCompare(n,i);return 0!==c?c:a-o}));for(var a=[],i=void 0,o=0;o<r.length;o+=1){var c=r[o],u=c[0],s=c[1];void 0===i||0!==this.keyCompare(u,i)?(a.push([u,s]),i=u):a[a.length-1]=[u,s]}return this.ofSequence(a)},e.prototype.getKeyIndex=function(e){for(var r=t.RootPointer;r>=0&&r<this.keys.length;){var n=this.keyCompare(e,this.keys[r]);if(0===n)return r;n<0?r=c(r):n>0&&(r=u(r))}},e.prototype.ofSequence=function(r){var n=this,i=r.slice();i.sort((function(e,t){var r=e[0],a=t[0];return n.keyCompare(r,a)}));for(var o=new Array(i.length),s=new Array(i.length),l=function(e){var r=new Array(e);return function e(t,r,n,i){if(t>=r.length)return;var o=function(e){var t=a(e);if(t/2-1<=e-t)return t-1;return e-t/2}(i);r[t]=n+o,e(c(t),r,n,o),e(u(t),r,n+o+1,i-o-1)}(t.RootPointer,r,0,e),r}(i.length),d=0;d<i.length;d+=1){var f=i[l[d]],b=f[0],h=f[1];o[d]=b,s[d]=h}return new e(this.keyCompare,o,s)},e}();function o(e,t){var r=[];return function e(t,r,n){if(r<0||r>=t.keys.length)return;e(t,c(r),n),n.push([t.keys[r],t.values[r]]),e(t,u(r),n)}(e,t,r),r}function c(e){return 2*e+1}function u(e){return 2*e+2}t.ArrayMapTree=i,t.RootPointer=0,t.enumerateInOrder=o,t.enumerateKeysInOrder=function(e,t){return o(e,t).map((function(e){return e[0]}))}},function(e,t,r){"use strict";function n(e,t){return e&t-1}Object.defineProperty(t,"__esModule",{value:!0}),t.Deque=void 0;var a=function(){function e(){this.front=0,this.count=0,this.values=[void 0]}return e.prototype.getCount=function(){return this.count},e.prototype.maybeResize=function(){var e=this.values.length;if(this.count>=e){this.values.length=e<<1;for(var t=0;t<this.front;t+=1)this.values[e+t]=this.values[t],this.values[t]=void 0}else{var r=e>>4;if(r>=1&&this.count<r){for(t=0;t<this.count;t+=1)this.values[n(this.front+t,r)]=this.values[n(this.front+t,e)];this.values.length=r,this.front=n(this.front,r)}}},e.prototype.pushBack=function(e){this.maybeResize(),this.values[n(this.front+this.count,this.values.length)]=e,this.count+=1},e.prototype.pushFront=function(e){this.maybeResize();var t=n(this.front-1,this.values.length);this.values[t]=e,this.front=t,this.count+=1},e.prototype.peekBack=function(){return this.values[n(this.front+this.count-1,this.values.length)]},e.prototype.peekFront=function(){return this.values[this.front]},e.prototype.peekPos=function(e){if(!(e<0||e>=this.count))return this.values[n(this.front+e,this.values.length)]},e.prototype.popBack=function(){var e=n(this.front+this.count-1,this.values.length),t=this.values[e];return void 0!==t&&(this.values[e]=void 0,this.count-=1),t},e.prototype.popFront=function(){var e=this.values[this.front];return void 0!==e&&(this.values[this.front]=void 0,this.front=n(this.front+1,this.values.length),this.count-=1),e},e.prototype.forEach=function(e){for(var t=this.values.length,r=0;r<this.count;r+=1){if(!e(this.values[n(this.front+r,t)]))return!1}return!0},e}();t.Deque=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeNumberDict=t.makeStringDict=t.makeDictionary=void 0;var n=r(104),a=r(95);function i(e){function t(e,t){return Object.prototype.hasOwnProperty.call(e,t)}return{entries:(0,a.makeStringMap)(),keyToString:e,getCount:function(){return Object.keys(this.entries).length},getValue:function(e){var r=this.keyToString(e),n=t(this.entries,r)?this.entries[r]:void 0;return(0,a.isDefined)(n)?n.value:void 0},getEntry:function(e){var t=this.getValue(e);return void 0===t?void 0:(0,n.entry)(e,t)},setValue:function(e,r){var i=this.keyToString(e),o=t(this.entries,i)?this.entries[i]:void 0;(0,a.isDefined)(o)?o.value=r:this.entries[i]=(0,n.entry)(e,r)},contains:function(e){var r=this.keyToString(e),n=t(this.entries,r)?this.entries[r]:void 0;return(0,a.isDefined)(n)},remove:function(e){var r=this.keyToString(e);return!!t(this.entries,r)&&(delete this.entries[r],!0)},getOrSetValue:function(e,r){var i=this.keyToString(e),o=t(this.entries,i)?this.entries[i]:void 0;if((0,a.isDefined)(o))return o.value;var c=r();return delete this.entries[i],this.entries[i]=(0,n.entry)(e,c),c},forEach:function(e){for(var r in this.entries){var n=t(this.entries,r)?this.entries[r]:void 0;if((0,a.isDefined)(n)&&!e(n.key,n.value))return!1}return!0},filter:function(e){var t=[];this.forEach((function(r,n){return e(r,n)||t.push(r),!0}));for(var r=0,n=t;r<n.length;r++){var a=n[r];this.remove(a)}}}}t.makeDictionary=i,t.makeStringDict=function(){return i(a.identity)},t.makeNumberDict=function(){return i((function(e){return String(e)}))}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeHashSet=void 0;var n=r(95),a=r(128);t.makeHashSet=function(e,t){return{map:{},keyToHash:e,keyEquals:t,nelements:0,add:function(e){var t=this.keyToHash(e);if((0,n.isNone)(this.map[t]))this.map[t]=[e],this.nelements+=1;else{for(var r=this.map[t],i=0;i<r.length;i+=1)if(this.keyEquals(e,r[i]))return;(0,a.logCollision)("object"==typeof e?"Object {".concat(Object.keys(e),"}"):typeof e),r.push(e),this.nelements+=1}},contains:function(e){var t=this.keyToHash(e),r=this.map[t];if((0,n.isNone)(r))return!1;for(var i=0;i<r.length;i+=1)if(this.keyEquals(e,r[i]))return!0;return(0,a.logCollision)("object"==typeof e?"Object {".concat(Object.keys(e),"}"):typeof e),!1},forEach:function(e){var t=this;Object.keys(this.map).forEach((function(r){t.map[Number(r)].forEach((function(t){e(t)}))}))},size:function(){return this.nelements},remove:function(e){var t=this,r=this.keyToHash(e),i=this.map[r];if((0,n.isNone)(i))return!1;var o=[],c=!1;return i.forEach((function(r){t.keyEquals(e,r)?(t.nelements-=1,c=!0):o.push(r)})),this.map[r]=o,c||(0,a.logCollision)("object"==typeof e?"Object {".concat(Object.keys(e),"}"):typeof e),c}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.makeHashTable=void 0;var n=r(104),a=r(128),i=r(95);t.makeHashTable=function(e,t){return{map:{},nentries:0,keyToHash:e,keyEquals:t,getCount:function(){return this.nentries},getValue:function(e){var t=this.getEntry(e);return void 0===t?void 0:t.value},getEntry:function(e){var t=this.keyToHash(e),r=this.map[t];if(!(0,i.isNone)(r)){for(var n=0;n<r.length;n+=1){var o=r[n];if(this.keyEquals(e,o.key))return o}(0,a.logCollision)("object"==typeof e?"Object {".concat(Object.keys(e),"}"):typeof e)}},contains:function(e){return void 0!==this.getValue(e)},setValue:function(e,t){var r=this.keyToHash(e),i=this.map[r];if(null==i)this.map[r]=[(0,n.entry)(e,t)],this.nentries+=1;else{for(var o=0;o<i.length;o+=1){var c=i[o];if(this.keyEquals(c.key,e))return void(c.value=t)}i.push((0,n.entry)(e,t)),this.nentries+=1,(0,a.logCollision)("object"==typeof e?"Object {".concat(Object.keys(e),"}"):typeof e)}},remove:function(e){var t=this.keyToHash(e),r=this.map[t];if((0,i.isNone)(r))return!1;for(var n=[],o=!1,c=0;c<r.length;c+=1){var u=r[c];this.keyEquals(e,u.key)?(this.nentries-=1,o=!0):n.push(u)}return this.map[t]=n,o||(0,a.logCollision)("object"==typeof e?"Object {".concat(Object.keys(e),"}"):typeof e),o},getOrSetValue:function(e,t){var r=this.keyToHash(e),o=this.map[r];if((0,i.isNone)(o)){var c=t();return this.map[r]=[(0,n.entry)(e,c)],this.nentries+=1,c}for(var u=0;u<o.length;u+=1){var s=o[u];if(this.keyEquals(e,s.key))return s.value}var l=t();return o.push((0,n.entry)(e,l)),this.nentries+=1,(0,a.logCollision)("object"==typeof e?"Object {".concat(Object.keys(e),"}"):typeof e),l},forEach:function(e){var t=this;return Object.keys(this.map).every((function(r){return t.map[Number(r)].every((function(t){return e(t.key,t.value)}))}))},filter:function(e){var t=[];this.forEach((function(r,n){return e(r,n)||t.push(r),!0}));for(var r=0,n=t;r<n.length;r++){var a=n[r];this.remove(a)}}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.binarySearch=t.exponentialBuckets=t.linearBuckets=t.Histogram=void 0;var n=function(){function e(e){var t,r,n=this;this.buckets=e,this.createSampleCounts=function(){return new Array(n.buckets.length+1).fill(0)},this.sampleCounts=this.createSampleCounts(),this.findBucket=(t=function(e,t){return e-t},r=n.buckets.length,function(e){return a(n.buckets,0,r,e,t)})}return e.prototype.addSample=function(e){var t=this.findBucket(e);t<0&&(t=~t),this.sampleCounts[t]+=1},e.prototype.reset=function(){var e={buckets:this.buckets,sampleCounts:this.sampleCounts};return this.sampleCounts=this.createSampleCounts(),e},e}();function a(e,t,r,n,a){for(var i=t,o=t+r-1;i<=o;){var c=i+(o-i>>>1),u=a(e[c],n);if(0===u)return c;u<0?i=c+1:o=c-1}return~i}t.Histogram=n,t.linearBuckets=function(e,t,r){for(var n=(t-e)/(r-1),a=[],i=e,o=0;o<r;i+=n,o+=1)a.push(i);return a},t.exponentialBuckets=function(e,t,r){for(var n=Math.log(e),a=(Math.log(t)-n)/(r-1),i=[],o=0,c=0;c<r;o+=a,c+=1)i.push(Math.exp(n+o));return i},t.binarySearch=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PriorityQueue=void 0;var n=r(135),a=function(){function e(e){this.min=0,this.max=0,this.heap=new n.BinaryHeap((function(t,r){var n=t[0],a=t[1],i=r[0],o=r[1],c=e(n,i);return 0!==c?c:a-o}))}return e.prototype.peek=function(){var e=this.heap.peek();if(void 0!==e)return e[0]},e.prototype.enqueue=function(e){this.max+=1,this.heap.insert([e,this.max])},e.prototype.push=function(e){this.min-=1,this.heap.insert([e,this.min])},e.prototype.pop=function(){var e=this.heap.removeMin();return void 0===e?(this.min=0,void(this.max=0)):e[0]},e.prototype.getCount=function(){return this.heap.getCount()},e.prototype.clear=function(){this.heap.clear()},e}();t.PriorityQueue=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.productSetSerializer=t.ProductSetSerializer=t.getSubspaceCount=t.forEachProduct=t.getSubspaces=t.symmetricDiffProduct=t.complementProduct=t.meetsProduct=t.compareProduct=t.exceptProduct=t.intersectProduct=t.unionProduct=t.project=t.createFromProduct=void 0;var n=r(9),a=r(136),i=r(125),o=function(e,t){var r,n,a=e[0],i=t[0];return r=String(a),n=String(i),r<n?-1:r>n?1:0},c={};var u=function(e){for(var t=[],r=0,n=Object.keys(e);r<n.length;r++){var a=n[r];t.push([a,e[a].id])}var i=function(e){for(var t="",r=0,n=e;r<n.length;r++){var a=n[r];t+=String(a[0]),t+="\0",t+=String(a[1]),t+="\0"}return t}(t.sort(o)),u=c[i];return void 0===u&&(u={box:{},probabilities:{},depth:1},c[i]=u),u};function s(e){return Object.getOwnPropertyNames(e).length>0}var l=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,i.getTypedFeatureGate)("Microsoft.Office.Excel.ProductSetBugFixFromPR1043532")?d.apply(void 0,e):f.apply(void 0,e)};function d(e){return s(e)?{isSubspace:!0,bounds:e}:a.dense}function f(e){for(var t=!0,r=0,n=Object.keys(e);r<n.length;r++){var i=n[r];if(Object.prototype.hasOwnProperty.call(e,i)){t=!1;break}}return t?a.dense:{isSubspace:!0,bounds:e}}function b(e){return e.isSubspace?1:e.subspaceCount}var h=function(e,t,r){return{isSubspace:!1,left:e,right:t,bounds:r,subspaceCount:b(e)+b(t)}};function v(e,t){if(t===a.dense)return t;if(t.isSubspace){for(var r=!1,n=0,i=Object.keys(t.bounds);n<i.length;n++){var o=i[n];if(Object.prototype.hasOwnProperty.call(e,o)){r=!0;break}}if(!r)return a.dense}return{productOperations:e,root:t}}function p(e){return void 0===e?a.dense:e}var m={unzip:function(e){for(var t={},r={},n=0,i=Object.keys(e);n<i.length;n++){var o=i[n];if(Object.prototype.hasOwnProperty.call(e,o)){var c=e[o];if(c===a.empty)return a.empty;if(c===a.dense)continue;t[o]=c.setOperations,r[o]=c.root}}return v(t,l(r))},combineProduct:function(e,t,r,n){for(var i={},o=0,c=Object.keys(e);o<c.length;o++){var u=c[o];if(Object.prototype.hasOwnProperty.call(e,u)){var s=n(e[u],e[u].top,p(t[u]),p(r[u]));if(s===a.empty)return a.empty;if(s===a.dense)continue;i[u]=s}}return i},restrict:function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];for(var n={},a=0,i=t;a<i.length;a++){var o=i[a];if(Object.prototype.hasOwnProperty.call(e,o)){var c=e[o];n[o]=c}}return n},fromUntypedProduct:function(e,t,r){for(var n={},i=0,o=r;i<o.length;i++){var c=o[i],u=t[c];n[c]=(0,a.fromUntyped)(e[c],void 0!==u?u:a.dense)}return n},denseProduct:function(e){for(var t={},r=0,n=e;r<n.length;r++){t[n[r]]=a.dense}return t}};function g(e,t,r){var n=m.combineProduct(e,t,r,a.unionUntyped);if(n===a.empty)throw new Error("broken invariant: the union of two non-empty products cannot be empty");return n}function O(e,t,r){for(var n=0,i=0,o=Object.keys(e);i<o.length;i++){var c=o[i];if(Object.prototype.hasOwnProperty.call(e,c)){var u=p(t[c]),s=p(r[c]),l=e[c];if(void 0===(n=(0,a.combineCmp)(n,(0,a.compareUntyped)(l,l.top,u,s))))return}}return n}t.createFromProduct=m.unzip.bind(m);var j,y=(j={},function(e,t,r){var i;if(t===j.left&&r===j.right)return j.res;j.left=t,j.right=r;var o,c=O(e,t.bounds,r.bounds);if(void 0!==c)return j.res=c<=0?r:t;for(var u=0,s=Object.keys(e);u<s.length;u++){var d=s[u];if(Object.prototype.hasOwnProperty.call(e,d)&&0!==(0,a.compareUntyped)(e[d],e[d].top,p(t.bounds[d]),p(r.bounds[d]))){if(void 0!==o)return j.res=void 0;o=d}}if(void 0!==o){var f=(0,a.unionUntyped)(e[o],e[o].top,p(t.bounds[o]),p(r.bounds[o]));if(f===a.empty)return j.res=a.empty;if(f===a.dense){var b=t.bounds,h=o,v=(b[h],n.__rest(b,["symbol"==typeof h?h:h+""]));return j.res=l(v)}var m=n.__assign(n.__assign({},t.bounds),((i={})[o]=f,i));return j.res=l(m)}return j.res=void 0});function S(e,t,r){if(r===a.empty)return t;if(r===a.dense)return r;if(t===a.empty)return r;if(t===a.dense)return t;if(!t.isSubspace||!r.isSubspace)return h(t,r,g(e,t.bounds,r.bounds));var n=y(e,t,r);return void 0!==n?n:h(t,r,g(e,t.bounds,r.bounds))}function C(e,t){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];var o=m.restrict.apply(m,n.__spreadArray([t.bounds],r,!1));if(t.isSubspace)return l(o);var c=C.apply(void 0,n.__spreadArray([e,t.left],r,!1));if(c===a.dense)return a.dense;var u=C.apply(void 0,n.__spreadArray([e,t.right],r,!1));return S(e,c,u)}function k(e,t,r){for(var i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];if(t===a.empty||t===a.dense)return t;if(t.isSubspace){var c=m.restrict.apply(m,n.__spreadArray([t.bounds],i,!1));return l(c)}var u=N(e,r),s=u[0],d=u[1],f=T(e,t,s,d),b=f[0],h=f[1],v=k.apply(void 0,n.__spreadArray([e,b,s],i,!1)),p=k.apply(void 0,n.__spreadArray([e,h,d],i,!1));return S(e,v,p)}function E(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(e===a.dense||e===a.empty)return e;var i=m.restrict.apply(m,n.__spreadArray([e.productOperations],t,!1));if(!s(i))return a.dense;var o=k.apply(void 0,n.__spreadArray([i,e.root,u(i)],t,!1));return o===a.empty?o:v(i,o)}function A(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];if(e===a.dense||e===a.empty)return e;var i=m.restrict.apply(m,n.__spreadArray([e.productOperations],t,!1)),o=C.apply(void 0,n.__spreadArray([i,e.root],t,!1));return o===a.empty?o:v(i,o)}function N(e,t){var r,i,o,c;if(void 0!==t.children)return t.children;for(var u,s,l=t.box,d=t.probabilities,f=0,b=0,h=Object.keys(e);b<h.length;b++){var v=h[b];if(Object.prototype.hasOwnProperty.call(e,v)){var m=d[v],g=e[v];if(void 0===m){u=v,s=g.top;break}if(m>f){var O=p(l[v]);if(O===a.empty)throw new Error("the key split can never return empty");var j=g.top;if(O!==a.dense){if(!O.isExact)throw new Error("the key can always be represented exactly");j=O.key}if(!g.canSplit(j))continue;u=v,f=m,s=j}}}if(void 0===u||void 0===s)throw new Error("there has to be at least one dimension");var y=e[u],S=y.split(s),C=S[0],k=C[0],E=C[1],A=S[1],N=A[0],T=A[1],R=[{box:n.__assign(n.__assign({},l),(r={},r[u]=(0,a.lazy)(y,y.top,k),r)),probabilities:n.__assign(n.__assign({},d),(i={},i[u]=E,i)),depth:t.depth+1},{box:n.__assign(n.__assign({},l),(o={},o[u]=(0,a.lazy)(y,y.top,N),o)),probabilities:n.__assign(n.__assign({},d),(c={},c[u]=T,c)),depth:t.depth+1}];return t.depth<10&&(t.children=R),R}t.project=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return(0,i.getTypedFeatureGate)("Microsoft.Office.Excel.ProductSetBugFixFromPR1043532")?E.apply(void 0,e):A.apply(void 0,e)};var T=function(e,t,r,n){return function e(t,r,n,i){if(r===a.empty)return[a.empty,a.empty];if(r===a.dense)return[l(n),l(i)];var o=O(t,r.bounds,n);if(void 0!==o&&o<=0)return[r,a.empty];var c=m.combineProduct(t,r.bounds,n,a.intersectUntyped);if(c===a.empty)return[a.empty,r];var u=m.combineProduct(t,r.bounds,i,a.intersectUntyped);if(r.isSubspace)return[l(c),u===a.empty?a.empty:l(u)];var s=e(t,r.left,n,i),d=s[0],f=s[1],b=e(t,r.right,n,i),h=b[0],v=b[1];return[S(t,d,h),S(t,f,v)]}(e,t,r.box,n.box)};function R(e,t,r,n,i){var o=N(e,n),c=o[0],u=o[1],s=T(e,t,c,u),l=s[0],d=s[1],f=T(e,r,c,u),b=f[0],h=f[1],v=i(e,l,b,c);return v===a.dense?a.dense:S(e,v,i(e,d,h,u))}function I(e,t,r,n){if(r===a.empty)return t;if(t===a.empty)return r;if(t===a.dense)return t;if(r===a.dense)return r;if(t.isSubspace&&r.isSubspace){var i=y(e,t,r);if(void 0!==i)return i}return R(e,t,r,n,I)}function _(e,t){if(t===a.empty)return e;if(t===a.dense)return t;if(e===a.empty)return t;if(e===a.dense)return e;var r=n.__assign(n.__assign({},e.productOperations),t.productOperations),i=I(r,e.root,t.root,u(r));return i===a.empty?i:v(r,i)}function F(e,t,r,n){if(t===a.empty||r===a.empty)return a.empty;if(t===a.dense)return r;if(r===a.dense)return t;if(t.isSubspace&&r.isSubspace){var i=m.combineProduct(e,t.bounds,r.bounds,a.intersectUntyped);return i===a.empty?a.empty:l(i)}return R(e,t,r,n,F)}function w(e,t,r,i){if(t===a.empty)return t;if(r===a.dense)return a.empty;if(r===a.empty)return t;if(t===a.dense)return R(e,t,r,i,w);if(t.isSubspace&&r.isSubspace){var o=function(e,t,r){var i,o,c=O(e,t.bounds,r.bounds);if(0===c||-1===c)return a.empty;for(var u=0,s=Object.keys(e);u<s.length;u++){var d=s[u];if(Object.prototype.hasOwnProperty.call(e,d)){var f=(0,a.compareUntyped)(e[d],e[d].top,p(t.bounds[d]),p(r.bounds[d]));if(void 0===f||f>0){if(void 0!==o)return;o=d}}}if(void 0!==o){var b=(0,a.exceptUntyped)(e[o],e[o].top,p(t.bounds[o]),p(r.bounds[o]));if(b===a.empty)return a.empty;if(b===a.dense){var h=t.bounds,v=o,m=(h[v],n.__rest(h,["symbol"==typeof v?v:v+""]));return l(m)}var g=n.__assign(n.__assign({},t.bounds),((i={})[o]=b,i));return l(g)}}(e,t,r);if(void 0!==o)return o}return R(e,t,r,i,w)}function M(e,t){if(e===a.empty)return e;if(t===a.empty)return e;if(t===a.dense)return a.empty;if(e===a.dense){var r=w(t.productOperations,a.dense,t.root,u(t.productOperations));return r===a.empty?r:v(t.productOperations,r)}var i=n.__assign(n.__assign({},e.productOperations),t.productOperations),o=w(i,e.root,t.root,u(i));return o===a.empty?o:v(i,o)}function D(e,t,r,n){if(t===a.empty||r===a.empty)return!1;if(t===a.dense||r===a.dense)return!0;if(!function(e,t,r){for(var n=0,i=Object.keys(e);n<i.length;n++){var o=i[n];if(Object.prototype.hasOwnProperty.call(e,o)){var c=p(t[o]),u=p(r[o]),s=e[o];if(!(0,a.meetsUntyped)(s,s.top,c,u))return!1}}return!0}(e,t.bounds,r.bounds))return!1;if(t.isSubspace&&r.isSubspace)return!0;var i=N(e,n),o=i[0],c=i[1],u=T(e,t,o,c),s=u[0],l=u[1],d=T(e,r,o,c),f=d[0],b=d[1];return D(e,s,f,o)||D(e,l,b,c)}t.unionProduct=_,t.intersectProduct=function(e,t){if(e===a.empty)return e;if(t===a.empty)return t;if(e===a.dense)return t;if(t===a.dense)return e;var r=n.__assign(n.__assign({},e.productOperations),t.productOperations),i=F(r,e.root,t.root,u(r));return i===a.empty?i:v(r,i)},t.exceptProduct=M,t.compareProduct=function(e,t){if(e===t)return 0;if(e===a.empty)return-1;if(t===a.empty)return 1;if(e===a.dense)return t===a.dense?0:1;if(t===a.dense)return-1;var r=n.__assign(n.__assign({},e.productOperations),t.productOperations);return function e(t,r,n,i){if(r===n)return 0;if(r===a.empty)return-1;if(n===a.empty)return 1;if(r===a.dense)return n===a.dense?0:1;if(n===a.dense)return-1;if(r.isSubspace&&n.isSubspace)return O(t,r.bounds,n.bounds);var o=N(t,i),c=o[0],u=o[1],s=T(t,r,c,u),l=s[0],d=s[1],f=T(t,n,c,u),b=f[0],h=f[1],v=e(t,l,b,c);return void 0!==v?(0,a.combineCmp)(v,e(t,d,h,u)):void 0}(r,e.root,t.root,u(r))},t.meetsProduct=function(e,t){if(e===a.empty||t===a.empty)return!1;if(e===a.dense||t===a.dense)return!0;var r=n.__assign(n.__assign({},e.productOperations),t.productOperations);return D(r,e.root,t.root,u(r))};t.complementProduct=function(e){return M(a.dense,e)};t.symmetricDiffProduct=function(e,t){return _(M(e,t),M(t,e))},t.getSubspaces=function(e){if(e===a.empty||e===a.dense)return[];var t=[];return function e(r){r.isSubspace?t.push(r.bounds):(e(r.left),e(r.right))}(e.root),t},t.forEachProduct=function(e,r){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var c=t.project.apply(void 0,n.__spreadArray([e],i,!1));if(c===a.empty)return!0;if(c===a.dense)return r(m.denseProduct(i));var u=c.productOperations,s=c.root;function l(e){return e.isSubspace?r(m.fromUntypedProduct(u,e.bounds,i)):l(e.left)&&l(e.right)}return l(s)},t.getSubspaceCount=function(e){return e===a.empty||e===a.dense?0:b(e.root)};var P=function(){function e(e){void 0===e&&(e=[]),this.buffer=e,this.cursor=0}return e.prototype.putBack=function(e){this.cursor-=1,this.buffer[this.cursor]=e},e.prototype.pick=function(){return this.buffer[this.cursor]},Object.defineProperty(e.prototype,"length",{get:function(){return this.buffer.length-this.cursor},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"empty",{get:function(){return 0===this.length},enumerable:!1,configurable:!0}),e.prototype.pop=function(){var e=this.pick();return this.cursor+=1,e},e}(),x=function(){var e=this;this.size=0,this.clear=function(){},this.get=function(){},this.set=function(){return e}};function L(e,t){return function(r,a){for(var i=[],o=2;o<arguments.length;o++)i[o-2]=arguments[o];var c=t.get(r);void 0===c?(e.apply(void 0,n.__spreadArray([r,a],i,!1)),t.set(r,t.size)):a.push("__cached__",c)}}function B(e,t){return function(r){for(var a=[],i=1;i<arguments.length;i++)a[i-1]=arguments[i];if("__cached__"===r.pick()){r.pop();var o=r.pop();return t[o]}var c=e.apply(void 0,n.__spreadArray([r],a,!1));return t.push(c),c}}var U=function(){function e(t){var r,n,i,o,c=this;for(var u in this.globalProductOperations=t,this.cached="undefined"!=typeof Map?new Map:new x,this.cache=[],this.serializers={},this.serializeProductSet=function(e,t){if(e!==a.empty&&e!==a.dense){var r=e,n=c.getDims(r.productOperations);t.push(n),c.serializeUntypedSparseProductCached(r.root,t,n)}else t.push(e)},this.deserializeProductSet=function(e){var t=e.pop();if(t===a.empty||t===a.dense)return t;e.putBack(t);for(var r={},n=e.pop(),i=0,o=n;i<o.length;i++){var u=o[i],s=c.globalProductOperations[u];r[u]=s}return{productOperations:r,root:c.deserializeUntypedSparseProductCached(e,n)}},this.serializeUntypedSparse=function(t,r,n){r.push(null==t?void 0:t.isExact),r.push(c.serializers[n].serializeBound(null==t?void 0:t.infimum)),r.push(c.serializers[n].serializeBound(null==t?void 0:t.supremum));var i=e.normalizeKey(null==t?void 0:t.key);r.push(c.serializers[n].serializeKey(i));for(var o=0,u=[null==t?void 0:t.left,null==t?void 0:t.right];o<u.length;o++){var s=u[o];null==s||s===a.empty||s===a.dense?r.push(s):(r.push("us"),c.serializeUntypedSparseCached(s,r,n))}},this.deserializeUntypedSparse=function(e,t){var r=e.pop(),n=c.serializers[t].deserializeBound(e.pop()),a=c.serializers[t].deserializeBound(e.pop()),i=c.serializers[t].deserializeKey(e.pop()),o=["left","right"].map((function(r){var n=e.pop();return"us"===n?c.deserializeUntypedSparseCached(e,t):n}));return{infimum:n,supremum:a,isExact:r,key:i,left:o[0],right:o[1]}},this.serializeUntypedSparseProduct=function(e,t,r){t.push(e.isSubspace);for(var n=0,a=r;n<a.length;n++){var i=a[n],o=e.bounds[i];c.serializeUntypedSparseCached(o,t,i)}e.isSubspace||(c.serializeUntypedSparseProductCached(e.left,t,r),c.serializeUntypedSparseProductCached(e.right,t,r),t.push(e.subspaceCount))},this.deserializeUntypedSparseProduct=function(e,t){for(var r=e.pop(),n={},a=0,i=t;a<i.length;a++){var o=i[a],u=c.deserializeUntypedSparseCached(e,o);n[o]=u}return r?{isSubspace:r,bounds:n}:{isSubspace:r,bounds:n,left:c.deserializeUntypedSparseProductCached(e,t),right:c.deserializeUntypedSparseProductCached(e,t),subspaceCount:e.pop()}},this.serializeUntypedSparseCached=L(this.serializeUntypedSparse,this.cached),this.deserializeUntypedSparseCached=B(this.deserializeUntypedSparse,this.cache),this.serializeProductSetCached=L(this.serializeProductSet,this.cached),this.deserializeProductSetCached=B(this.deserializeProductSet,this.cache),this.serializeUntypedSparseProductCached=L(this.serializeUntypedSparseProduct,this.cached),this.deserializeUntypedSparseProductCached=B(this.deserializeUntypedSparseProduct,this.cache),t){var s={serializeKey:null!==(r=t[u].serializeKey)&&void 0!==r?r:function(e){return JSON.stringify(e)},deserializeKey:null!==(n=t[u].deserializeKey)&&void 0!==n?n:function(e){return JSON.parse(e)},serializeBound:null!==(i=t[u].serializeBound)&&void 0!==i?i:function(e){return JSON.stringify(e)},deserializeBound:null!==(o=t[u].deserializeBound)&&void 0!==o?o:function(e){return JSON.parse(e)}};this.serializers[u]=s}}return e.prototype.getDims=function(e){return Object.keys(e)},e.prototype.serialize=function(e){this.cached.clear();var t=[];t.push(e.length);for(var r=0,n=e;r<n.length;r++){var a=n[r];this.serializeProductSetCached(a,t)}return JSON.stringify(t)},e.prototype.deserialize=function(e){this.cache.length=0;for(var t=new P(JSON.parse(e)),r=t.pop(),n=[],a=0;a<r;a+=1){var i=this.deserializeProductSetCached(t);n.push(i)}return n},e.normalizeKey=function(e){if("object"==typeof e){var t=n.__assign({},e);return delete t.depth,delete t.split,t}return e},e}();t.ProductSetSerializer=U,t.productSetSerializer=function(e){return new U(e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RedBlackMapTree=void 0;var n=r(138),a=function(){function e(e,t,r){this.root=e,this.count=t,this.keyCompare=r}return e.create=function(t){return new e(n.emptyUntyped,0,t)},e.prototype.getCount=function(){return this.count},e.prototype.getValue=function(e){var t=(0,n.findUntyped)(this,e,this.root);return null==t?void 0:t.value},e.prototype.getEntry=function(e){return(0,n.findUntyped)(this,e,this.root)},e.prototype.contains=function(e){return void 0!==this.getValue(e)},e.prototype.forEach=function(e){return(0,n.forEachUntyped)(e,this.root)},e.prototype.setValue=function(t,r){return new e((0,n.insertUntyped)(this,t,r,this.root),this.contains(t)?this.count:this.count+1,this.keyCompare)},e.prototype.remove=function(t){return this.contains(t)?new e((0,n.removeUntyped)(this,t,this.root),this.count-1,this.keyCompare):this},e.prototype.getOrSetValue=function(t,r){var a=this.getValue(t);if(void 0!==a)return[this,a];var i=r();return[new e((0,n.insertUntyped)(this,t,i,this.root),this.count+1,this.keyCompare),i]},e.prototype.filter=function(t){var r=this,a=n.emptyUntyped,i=0;return this.forEach((function(e,o){return t(e,o)&&(a=(0,n.insertUntyped)(r,e,o,a),i+=1),!1})),new e(a,i,this.keyCompare)},e}();t.RedBlackMapTree=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RingBuffer=void 0;var n=function(){function e(e){void 0===e&&(e=1/0),this.list=e<1/0?new Array(e):new Array,this.counter=0,this.capacity=e,this.readIndex=0,this.writeIndex=0}return e.prototype.count=function(){return this.counter},e.prototype.isEmpty=function(){return 0===this.counter},e.prototype.enqueue=function(e){this.list[this.writeIndex]=e,0!==this.counter&&this.writeIndex===this.readIndex?this.readIndex=(this.readIndex+1)%this.capacity:this.counter++,this.writeIndex=(this.writeIndex+1)%this.capacity},e.prototype.dequeue=function(){if(!this.isEmpty()){var e=this.list[this.readIndex];return this.list[this.readIndex]=void 0,this.readIndex=(this.readIndex+1)%this.capacity,this.counter--,e}},e.prototype.executeOnEveryElement=function(e){for(var t=0;t<this.counter;t++){var r=(this.readIndex+t)%this.capacity,n=this.list[r];if(void 0!==n)if(!e(n))return!1}return!0},e}();t.RingBuffer=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RTree=t.RTKind=t.copyExcept=void 0;var n,a=r(9),i=r(95),o=r(104);function c(e,t,r){if(void 0!==r){var n=e.slice();return n[t]=r,n}var a=e.slice(0,-1);return t<e.length-1&&(a[t]=e[e.length-1]),a}function u(e,t,r){return{kind:e,key:t,value:r}}function s(e,t){return u(n.Ptr,e,t)}function l(e,t){return u(n.Leaf,e,t)}function d(e,t){return u(n.Branch,e,t)}t.copyExcept=c,function(e){e[e.Ptr=1]="Ptr",e[e.Leaf=2]="Leaf",e[e.Branch=3]="Branch"}(n=t.RTKind||(t.RTKind={}));var f=function(){function e(e,t,r){this.lattice=e,this.root=t,this.count=r}return e.create=function(t,r,n,a,i){void 0===i&&(i=2);var o=i>1?Math.ceil(i):1;return new e({keyJoin:t,keyMeets:r,keyCompare:n,keyDistance:a,minChildren:o,maxChildren:2*o,keyGe:function(e,t){var r=n(e,t);return void 0!==r&&r>=0},keyLe:function(e,t){var r=n(e,t);return void 0!==r&&r<=0}},void 0,0)},e.prototype.getCount=function(){return this.count},Object.defineProperty(e.prototype,"bounds",{get:function(){var e;return null===(e=this.root)||void 0===e?void 0:e.key},enumerable:!1,configurable:!0}),e.prototype.getValue=function(e){if(void 0!==this.root)return function t(r,a){var i=r.keyCompare(a.key,e);if(a.kind===n.Ptr)return 0===i?a.value:void 0;if(!(void 0===i||i<0))for(var o=0,c=a.value;o<c.length;o++){var u=t(r,c[o]);if(void 0!==u)return u}}(this.lattice,this.root)},e.prototype.getEntry=function(e){var t=this.getValue(e);return void 0===t?void 0:(0,o.entry)(e,t)},e.prototype.setValue=function(t,r,n){void 0===n&&(n=function(e){return!0});var a=g(this.lattice,this.root,t,n,r);return void 0!==a?a===this.root?this:new e(this.lattice,a,this.count):new e(this.lattice,m(this.lattice,this.root,s(t,r)),this.count+1)},e.prototype.filter=function(t){var r=new e(this.lattice,void 0,0);return this.forEach((function(e,n){return t(e,n)&&(r=r.setValue(e,n)),!0})),r},e.prototype.contains=function(e,t){return void 0===t&&(t=function(e){return!0}),void 0!==g(this.lattice,this.root,e,t)},e.prototype.getOrSetValue=function(e,t){var r=this.getValue(e);if(void 0===r){var n=t();return[this.setValue(e,n),n]}return[this,r]},e.prototype.forEach=function(e){return b(this.root,e)},e.prototype.forEachGe=function(e,t){var r=this;return b(this.root,t,(function(t){return r.lattice.keyGe(t,e)}),(function(t){return r.lattice.keyGe(t,e)}))},e.prototype.forEachLe=function(e,t){var r=this;return b(this.root,t,(function(t){return r.lattice.keyMeets(t,e)}),(function(t){return r.lattice.keyLe(t,e)}))},e.prototype.forEachMeets=function(e,t){var r=this;return b(this.root,t,(function(t){return r.lattice.keyMeets(t,e)}),(function(t){return r.lattice.keyMeets(t,e)}))},e.prototype.remove=function(t){var r=this;if(null==this.root)return this;var a=[],o=this.lattice,u=function(e,r){var s=o.keyCompare(e.key,t);if(void 0===s||s<0)return(0,i.pair)(e,1);if(e.kind===n.Leaf){for(var f=e.value,b=0;b<f.length;b+=1)if(0===o.keyCompare(f[b].key,t)){if((O=c(f,b)).length<r){var h=l(e.key,O);return a.push(h),(0,i.pair)(h,3)}return(0,i.pair)(l(v(o,O),O),2)}}else for(f=e.value,b=0;b<f.length;b+=1){var p=u(f[b],o.minChildren),m=p[0],g=p[1];if(3===g){var O;if((O=c(f,b)).length>=r)return(0,i.pair)(d(v(o,O),O),2);h=d(e.key,O);return a.push(h),(0,i.pair)(h,3)}if(2===g)return(0,i.pair)(d(e.key,c(f,b,m)),2)}return(0,i.pair)(e,1)},f=this.root.kind===n.Leaf?1:2,h=u(this.root,f),p=h[0],g=h[1];if(p===this.root)return this;for(var O=3===g?void 0:p,j=0;j<a.length;j+=1)b(a[j],(function(e,t){return O=m(r.lattice,O,s(e,t)),!0}));return new e(this.lattice,O,this.count-1)},e}();function b(e,t,r,a){var i=void 0!==r?r:function(){return!0},o=void 0!==a?a:function(){return!0};if(null==e)return!0;var c=function(e){if(!i(e.key))return!0;if(e.kind===n.Leaf)for(var r=e.value,a=0;a<r.length;a+=1){var u=r[a];if(o(u.key)&&!t(u.key,u.value))return!1}else for(r=e.value,a=0;a<r.length;a+=1)if(!c(r[a]))return!1;return!0};return c(e)}function h(e,t){for(var r=function(e,t){for(var r=0,n=1,a=e.keyDistance(t[0].key,t[1].key),o=2;o<t.length;o+=1)for(var c=0;c<o;c+=1){var u=e.keyDistance(t[c].key,t[o].key);u>a&&(r=c,n=o,a=u)}return(0,i.pair)(r,n)}(e,t),n=r[0],a=r[1],o=t[n].key,c=t[a].key,u=[],s=0;s<t.length;s+=1){var l=t[s];u.push([l,e.keyDistance(o,l.key)-e.keyDistance(c,l.key)])}u.sort((function(e,t){return e[1]-t[1]}));for(var d=e.minChildren;d<t.length-e.minChildren&&u[d][1]<0;d+=1);var f=[],b=[];for(s=0;s<d;s+=1)f.push(u[s][0]);for(s=d;s<t.length;s+=1)b.push(u[s][0]);return(0,i.pair)(f,b)}function v(e,t){for(var r=t[0].key,n=1;n<t.length;n+=1)r=e.keyJoin(r,t[n].key);return r}function p(e,t,r){var n=h(e,r),a=n[0],o=n[1];return(0,i.pair)(u(t,v(e,a),a),u(t,v(e,o),o))}function m(e,t,r){if(null==t)return l(r.key,[r]);var o=function t(o){if(o.kind===n.Leaf){var c=a.__spreadArray(a.__spreadArray([],o.value,!0),[r],!1);if(c.length>e.maxChildren){var u=p(e,o.kind,c),s=u[0],f=u[1];return(0,i.pair)(l(s.key,s.value),f)}return(0,i.pair)(l(e.keyJoin(o.key,r.key),c),void 0)}var b=o.value.slice(),h=function(e,t,r){for(var n=0,a=e.keyDistance(t[0].key,r),i=t[0].value.length,o=1;o<t.length;o+=1){var c=t[o],u=e.keyDistance(c.key,r);(u<a||u===a&&c.value.length<i)&&(n=o,a=u,i=c.value.length)}return n}(e,b,r.key),v=t(b[h]),m=v[0],g=v[1];if(b[h]=m,null!=g&&(b.push(g),b.length>e.maxChildren)){var O=p(e,o.kind,b),j=O[0];f=O[1];return(0,i.pair)(d(j.key,j.value),f)}return(0,i.pair)(d(e.keyJoin(o.key,r.key),b),void 0)}(t),c=o[0],u=o[1];return null!=u?d(e.keyJoin(c.key,u.key),[c,u]):c}function g(e,t,r,a,i){if(void 0!==t)return function t(a){if(a.kind!==n.Leaf)for(i=0;i<a.value.length;i+=1){u=a.value[i];if(e.keyMeets(u.key,r))if(void 0!==(s=t(u)))return d(a.key,c(a.value,i,s))}else for(var i=0;i<a.value.length;i+=1){var u,s;if(void 0!==(s=o(u=a.value[i])))return l(a.key,c(a.value,i,s))}}(t);function o(t){if(0===e.keyCompare(t.key,r))return void 0!==i&&t.value!==i&&a(t.value)?s(t.key,i):t}}t.RTree=f},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.boundedParetoSetOperations=t.boundedParetoSplitter=t.boundedPareto=void 0;var n=r(95),a=r(137);function i(e,t,r){var n=Math.pow(t,e),a=1-Math.pow(t/r,e),i=Math.pow(r,e),o=i*n,c=i-n,u=-1/e;return{cdf:1===e?function(e){return(1-n/e)/a}:function(t){return(1-n*Math.pow(t,-e))/a},invCdf:1===e?function(e){return 1/((i-e*c)/o)}:function(e){return Math.pow((i-e*c)/o,u)}}}function o(e,t,r){var a=i(e,t,r);return{canSplit:function(e){var t=e[0];return e[1]-t>1},split:function(e){var t=e[0],r=e[1],i=a.cdf(r),o=a.cdf(t+1),c=a.invCdf((i+o)/2),u=(0,n.fastMin)((0,n.fastMax)(Math.round(c),t+1),r-1);return[[[t,u],a.cdf(u)-a.cdf(t+1)],[[u,r],a.cdf(r)-a.cdf(u)]]}}}t.boundedPareto=i,t.boundedParetoSplitter=o,t.boundedParetoSetOperations=function(e,t,r,i,c){var u=o(e,t,r);return{id:c,split:function(e){return u.split(e)},canSplit:function(e){return u.canSplit(e)},meets:a.ivlMeets,intersect:a.ivlMeet,union:function(e,t){return(0,a.ivlMeetsOrTouches)(e,t)?(0,a.ivlJoin)(e,t):void 0},except:a.ivlExcept,compare:a.ivlCompare,top:i,infimum:function(e){return e[0]},supremum:function(e){return e[1]},combineInfima:function(e,t){return(0,n.fastMin)(e,t)},combineSuprema:function(e,t){return(0,n.fastMax)(e,t)}}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Math=void 0;const n=function(e){if(e.imul&&e.fround&&e.clz32)return e;const t=new Float32Array(1);return Object.create(e,{imul:{value:function(e,t){var r=(4194303&e)*(t|=0);return 4290772992
/*!== 0*/&e&&(r+=(4290772992&e)*t|0),0|r}},fround:{value:function(e){return t[0]=e,t[0]}},clz32:{value:function(t){var r=t>>>0;return 0===r?32:31-(e.log(r)/e.LN2|0)|0}}})}(Math);t.Math=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),Object.defineProperty(t,"Base_LocaleDecimalSeparator",{enumerable:!0,get:function(){return n.Base_LocaleDecimalSeparator}}),Object.defineProperty(t,"Base_LocaleGetOrdinal",{enumerable:!0,get:function(){return n.Base_LocaleGetOrdinal}}),Object.defineProperty(t,"Base_LocaleIsNumeral",{enumerable:!0,get:function(){return n.Base_LocaleIsNumeral}}),t.Math_tan=t.Math_sqrt=t.Math_sin=t.Math_log10=t.Math_log=t.Math_exp=t.Math_cos=t.Math_atan=void 0;var n=r(129);const a=Math.sqrt;t.Math_sqrt=a;const i=Math.log10||function(e){return Math.log(e)*Math.LOG10E};t.Math_log10=i;const o=Math.log;t.Math_log=o;const c=Math.exp;t.Math_exp=c;const u=Math.sin;t.Math_sin=u;const s=Math.cos;t.Math_cos=s;const l=Math.tan;t.Math_tan=l;const d=Math.atan;t.Math_atan=d},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.proc_exit=function(e){throw new Error("unexpected process termination: "+e)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.utcToLocal=t.toTime=t.TimeDivision=t.toDays=t.toNumWithDuration=t.toNum=t.fromNum=t.dtr=t.Rounding=t.daysPerMonth=void 0;var n=r(106),a=r(139);function i(e,t,r,n,a,i,o,c,u){return{yr:e,mon:t,dom:r,hour:n,min:a,sec:i,wdy:o,fracSec:c,rounding:u}}function o(e){return i((0,n.Dtr_Yr)(e),(0,n.Dtr_Mon)(e),(0,n.Dtr_DOM)(e),(0,n.Dtr_Hour)(e),(0,n.Dtr_Min)(e),(0,n.Dtr_Sec)(e),(0,n.Dtr_Wdy)(e),(0,n.Dtr_FracSec)(e),(0,n.Dtr_Rounding)(e))}function c(e,t){(0,n.Dtr_Write)(t.yr,t.mon,t.dom,t.hour,t.min,t.sec,t.wdy,t.fracSec,t.rounding,e)}t.daysPerMonth=function(e,t,r){return(0,n.Dtr_DaysPerMonth)(e,t,r?1:0)},function(e){e[e.RoundSec=0]="RoundSec",e[e.Round10ths=1]="Round10ths",e[e.Round100ths=2]="Round100ths",e[e.Round1000ths=3]="Round1000ths"}(t.Rounding||(t.Rounding={})),t.dtr=i,t.fromNum=function(e,t,r,a){var i=t;return 0===(0,n.Dtr_FromNum)(e,i,0,r?1:0,a?1:0)&&o(0)},t.toNum=function(e,t,r){c(0,e);var i=(0,n.Dtr_ToNum)(0,t?1:0,r?1:0),o=(0,n.Mathpack_TakeMathError)();return o===a.MathErrorNum.None?i:(0,a.mathError)(o)},t.toNumWithDuration=function(e,t,r,i,o){c(0,e);var u=i,s=(0,n.Dtr_ToNumWithDuration)(0,t?1:0,r?1:0,u,o),l=(0,n.Mathpack_TakeMathError)();return l===a.MathErrorNum.None?s:(0,a.mathError)(l)},t.toDays=function(e,t,r){return c(0,e),0===(0,n.Dtr_ToDays)(0,t?1:0,r?1:0)&&(0,n.Dtr_Days)()},function(e){e[e.Hour=0]="Hour",e[e.Minute=1]="Minute",e[e.Second=2]="Second"}(t.TimeDivision||(t.TimeDivision={})),t.toTime=function(e,t,r){var i=t,o=r,c=(0,n.Dtr_ToTime)(e,i,o);return(0,n.Mathpack_TakeMathError)()===a.MathErrorNum.None&&c},t.utcToLocal=function(e,t,r,a){return c(0,e),null!=t.standardDate&&c(1,t.standardDate),null!=t.daylightDate&&c(2,t.daylightDate),0!==(0,n.Dtr_UtcToLocal)(0,t.bias,null!=t.standardDate?1:-1,t.standardBias,null!=t.daylightDate?2:-1,t.daylightBias,r?1:0,a?1:0)&&o(0)}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.detect_errors=void 0;var n=r(140),a=r(141),i=r(130),o=r(107);function c(e,t){for(var r=e[0],n=e[1],a=t[0],i=t[1],o=[],c=r;c<=a;c++)for(var u=n;u<=i;u++)o.push([c,u,0]);return o}t.detect_errors=function(e,t,r,u){void 0===u&&(u=1/0),t=null!=t?t:a.Colorize.getFormattingDiscount(),r=null!=r?r:a.Colorize.getReportingThreshold(),o.watchdog.arm(u);for(var s={},l=0,d=e.worksheets.map((function(e){if((0,o.watchdog)("wd0x8d98cc"),0===e.formulas.length&&0===e.values.length)return{name:"",out:null};var u=e.usedRangeAddress;u=u.replace(/!(!+)/,"!");var s=new i.Timer("excelint"),l=a.Colorize.process_suspicious(u,e.formulas,e.values),d=(l[0],l[1],l[2],l[3]);(0,o.watchdog)("wd0x7919b4");var f=s.elapsedTime(),b=a.Colorize.adjust_proposed_fixes(d,e.styles,0,0),h=s.elapsedTime(),v=b.map((function(e){(0,o.watchdog)("wd0xfb8f16");var n=e[0],i=e[1],c=e[2],u=e[3],s=-n;return u||(s*=(100-t)/100),100*s>=r?(0,a.tuple)(s,i,c,u):null})).filter((function(e){return null!==e})),p=function(e,t){return(t[0]-e[0]+1)*(t[1]-e[1]+1)*(t[2]-e[2]+1)},m=s.elapsedTime(),g=v.map((function(t){(0,o.watchdog)("wd0x2375dd");for(var r=t[1][0][0]===t[2][0][0]?"vertical":"horizontal",a=[],i=[],c=[],u=[],s=[],l=[],d=[],f=[],b=[],h=t[3],v=[p.apply(void 0,t[1]),p.apply(void 0,t[2])],m=0;m<2;m++){var g=t[m+1][0],O=g[1]-1,j=g[0]-1,y=e.formulas[O][j],S=n.ExcelUtils.numeric_constants(y);s.push(S),l.push(l.reduce((function(e,t){return e+t}),0));var C=n.ExcelUtils.all_cell_dependencies(y,j+1,O+1,!1);d.push(C.length);var k=n.ExcelUtils.formulaToR1C1(y,j+1,O+1),E=n.ExcelUtils.column_index_to_name(j+1)+(O+1)+":",A=E+k;c.push(k),u.push(A),a.push(y),i.push(E+y),f.push((y.match(/\$/g)||[]).length),b.push(C)}var N=Math.abs(l[0]-l[1]),T=[];for(m=0;m<b.length;m++)if(b[m].length>0){if("vertical"===r&&0===b[m][0][0]&&-1===b[m][0][1]){T.push("recurrent-formula");break}if("horizontal"===r&&-1===b[m][0][0]&&0===b[m][0][1]){T.push("recurrent-formula");break}}d[0]!==d[1]&&T.push("different-referent-count"),s[0].length!==s[1].length&&(1===Math.abs(s[0].length-s[1].length)?T.push("one-extra-constant"):T.push("number-of-constants-mismatch")),s[0].length>0&&s[1].length>0&&(d[0]+d[1]===0?T.push("both-constants"):d[0]*d[1]==0&&T.push("one-is-all-constants")),c[0]!==c[1]&&JSON.stringify(b[0].sort())!==JSON.stringify(b[1].sort())&&T.push("r1c1-mismatch"),f[0]!==f[1]&&T.push("absolute-ref-mismatch");for(m=0;m<b.length;m++)if(b[m].length>0&&b[m][0][0]*b[m][0][1]!=0){T.push("off-axis-reference");break}return T===[]&&T.push("unclassified"),{bin:T,direction:r,sameFormat:h,rangeSizes:v,numbers:l,sameConstants:s[0]===s[1],numeric_difference:N,magnitude_numeric_difference:0===N?0:Math.log10(N),formulas:i,r1c1formulas:u,dependence_vectors:b}})),O=s.elapsedTime(),j=e.formulas.flat().filter((function(e){return e.length>0})).length,y=e.values.flat().filter((function(e){return e.length>0})).length,S=e.values[0].length,C=e.values.length,k=C*S,E=v.map((function(e){return e[0]})).reduce((function(e,t){return e+t}),0),A=v.map((function(e){return(0,o.watchdog)("wd0xbcc23c"),e[0]>=r/100?c(e[1][0],e[1][1]).concat(c(e[2][0],e[2][1])):[]})),N=Array.from(new Set(A.flat(1).map((function(e){return JSON.stringify(e)}))));A=N.map((function(e){return JSON.parse(e)}));var T=s.elapsedTime(),R={suspiciousnessThreshold:r,formattingDiscount:t,proposedFixes:v,exampleFixes:g,suspiciousRanges:v.length,weightedSuspiciousRanges:E,suspiciousCells:A.length,elapsedTimeSeconds:T/1e3,proposedFixesTimeSeconds:f/1e3,adjustProposedFixesTimeSeconds:(h-f)/1e3,adjustFormatProposedFixesTimeSeconds:(m-h)/1e3,exampleFixesTimeSeconds:(O-m)/1e3,numCountingTimeSeconds:(T-O)/1e3,columns:S,rows:C,totalCells:k,numFormulaCells:j,numValueCells:y};return{name:e.sheetName,out:R}})).filter((function(e){return null!==e.out}));l<d.length;l++){var f=d[l],b=f.name,h=f.out;s[b]=h}return{workbookName:e.workbookName,worksheets:s}}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.RectangleUtils=void 0;var n=function(){function e(){}return e.is_adjacent=function(e,t){var r=e[0],n=r[0],a=r[1],i=(r[2],e[1]),o=i[0],c=i[1],u=(i[2],t[0]),s=u[0],l=u[1],d=(u[2],t[1]),f=d[0],b=d[1];d[2];return!(n-f>1||s-o>1||a-b>1||l-c>1)},e.bounding_box=function(e,t){var r=e[0],n=r[0],a=r[1],i=(r[2],e[1]),o=i[0],c=i[1],u=(i[2],t[0]),s=u[0],l=u[1],d=(u[2],t[1]),f=d[0],b=d[1];d[2];return[[Math.min(n,s),Math.min(a,l),0],[Math.max(o,f),Math.max(c,b),0]]},e.area=function(e){var t=e[0],r=t[0],n=t[1],a=(t[2],e[1]),i=a[0],o=a[1];a[2];return(i-r+1)*(o-n+1)},e.diagonal=function(e){var t=e[0],r=t[0],n=t[1],a=(t[2],e[1]),i=a[0],o=a[1],c=(a[2],i-r+1),u=o-n+1;return Math.sqrt(c*c+u*u)},e.overlap=function(e,t){var r=e[0],n=r[0],a=r[1],i=(r[2],e[1]),o=i[0],c=i[1],u=(i[2],t[0]),s=u[0],l=u[1],d=(u[2],t[1]),f=d[0],b=d[1];d[2];return(o>f?f-n+1:o-s+1)*(c>b?b-a+1:c-l+1)},e.is_mergeable=function(t,r){return e.is_adjacent(t,r)&&e.area(t)+e.area(r)-e.overlap(t,r)===e.area(e.bounding_box(t,r))},e}();t.RectangleUtils=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.JSONclone=void 0;var n=function(){function e(){}return e.clone=function(t){if(t){if(Array.isArray(t))return t.slice();if(t.constructor===Object){for(var r={},n=0,a=Object.keys(t);n<a.length;n++){var i=a[n];r[i]=e.clone(t[i])}return r}return t}return null},e}();t.JSONclone=n},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.find_all_proposed_fixes=void 0;var n=r(192),a=r(141),i=r(107);function o(e,t){var r=e[0],n=(e[1],t[0]);t[1];return r[0]!==n[0]?r[0]-n[0]:r[1]-n[1]}function c(e,t){for(var r=0;r<3;r++){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1}return 0}function u(e,t,r,i,o,u,s,l,d,f){var b,h,v,p=t[0],m=t[1],g=[],O=(0,n.binsearch)(d,t,(function(e,t){return e[0][0]-t[0][0]})),j=(0,n.binsearch)(f,t,(function(e,t){return e[0][1]-t[0][1]}));O>j?(b=i,v=O,h=0):(b=o,v=j,h=1),v>0&&(v-=1);for(var y=function(r){var i=b[r];if(i===e)return"continue";var o=l[i];if(0===h){if(m[0]+1<o[0][0])return"break"}else if(m[1]+1<o[0][1])return"break";if(m[0]+1<o[0][0]||m[1]+1<o[0][1]||o[1][0]+1<p[0]||o[1][1]+1<p[1]);else{var d=function(e,t,r,a){var i=e[0],o=e[1],u=t[0],s=t[1],l=[i-1,s,0],d=[u,o-1,0],f=[u+1,o,0],b=[i,s+1,0],h=[],v=-1;if(-1!==(v=(0,n.strict_binsearch)(a,l,c))&&r[v][1]===o){var p=[r[v],a[v]];h.push(p)}if(-1!==(v=(0,n.strict_binsearch)(a,d,c))&&r[v][0]===i){p=[r[v],a[v]];h.push(p)}if(-1!==(v=(0,n.strict_binsearch)(r,f,c))&&a[v][1]===s){p=[r[v],a[v]];h.push(p)}if(-1!==(v=(0,n.strict_binsearch)(r,b,c))&&a[v][0]===u){p=[r[v],a[v]];h.push(p)}return h}(p,m,u[i],s[i]);d.length>0&&(g=g.concat(d.map((function(r,n,o){return[a.Colorize.fix_metric(parseFloat(e),t,parseFloat(i),r),t,r]}))))}},S=v;S<b.length;S++){if("break"===y(S))break}return g}function s(e,t){for(var r=e.map((function(e,t){return{item:e,index:t}})).sort((function(e,r){return t(e.item,r.item)||e.index-r.index})).map((function(e){return e.item})),n=0;n<e.length;n+=1)e[n]=r[n];return e}t.find_all_proposed_fixes=function(e){var t=[],r={};!function(e,t){for(var r=0,n=Object.keys(e);r<n.length;r++){var a=n[r];(0,i.watchdog)("wd0xa287cd"),t[a]=e[a].sort(o).map((function(e,t,r){return[e[0].map((function(e,t,r){return Number(e)})),e[1].map((function(e,t,r){return Number(e)}))]}))}}(e,r);for(var n={},a={},l=0,d=Object.keys(e);l<d.length;l++){var f=d[l];(0,i.watchdog)("wd0xb02b87"),n[f]=r[f].map((function(e,t,r){var n=e[0];e[1];return n})),a[f]=r[f].map((function(e,t,r){e[0];return e[1]}))}var b=function(e){for(var t={},r=0,n=Object.keys(e);r<n.length;r++){for(var a=n[r],i=1e6,o=1e6,c=-1e6,u=-1e6,s=0;s<e[a].length;s++){var l=e[a][s][0][0],d=e[a][s][1][0],f=e[a][s][0][1],b=e[a][s][1][1];d>c&&(c=d),l<i&&(i=l),b>u&&(u=b),f<o&&(o=f)}t[a]=[[i,o,0],[c,u,0]]}return t}(e),h=Object.keys(e);s(h,(function(e,t){return b[e][0][0]-b[t][0][0]}));var v=h.map((function(e,t,r){return b[e]})),p=Object.keys(e);s(p,(function(e,t){return b[e][0][1]-b[t][0][1]}));for(var m,g=p.map((function(e,t,r){return b[e]})),O=0,j=Object.keys(e);O<j.length;O++){f=j[O];for(var y=0;y<r[f].length;y++){(0,i.watchdog)("wd0xe37031");var S=u(f,r[f][y],0,h,p,n,a,b,v,g);t=t.concat(S)}}return t=t.map((function(e,t,r){return c(e[1],e[2])<0?[e[0],e[2],e[1]]:[e[0],e[1],e[2]]})),m={},t=t.filter((function(e){return!(m[e]=e in m)}))}},function(e,t,r){"use strict";function n(e,t,r){for(var n=0,a=e.length;n<a;){var i=Math.floor((n+a)/2);r(e[i],t)<0?n=i+1:a=i}return n}Object.defineProperty(t,"__esModule",{value:!0}),t.strict_binsearch=t.binsearch=void 0,t.binsearch=function(e,t,r){return void 0===r&&(r=void 0),void 0===r&&(r=function(e,t){return e===t?0:e<t?-1:1}),n(e,t,r)},t.strict_binsearch=function(e,t,r){void 0===r&&(r=void 0);var a=n(e,t,r);return a===e.length||0!==r(e[a],t)?-1:a}},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Stencil=t.InfoGain=void 0;var n=function(){function e(){}return e.normalized_entropy=function(e){for(var t=e.reduce((function(e,t){return e+t}),0),r=0,n=0;n<e.length;n++){var a=e[n]/t;0!==a&&(r-=a*Math.log2(a))}return r/Math.log2(t)},e}();t.InfoGain=n;var a=function(){function e(){}return e.initialize=function(){if(!e.initialized){if(e.stencil_right=e.stencil.filter((function(e){var t=e[0];e[1];return t<=0})),e.stencil_left=e.stencil.filter((function(e){var t=e[0];e[1];return t>=0})),e.stencil_top=e.stencil.filter((function(e){e[0];return e[1]>=0})),e.stencil_bottom=e.stencil.filter((function(e){e[0];return e[1]<=0})),e.stencil_topleft=e.stencil_top.filter((function(e){var t=e[0];e[1];return t>=0})),e.stencil_topright=e.stencil_top.filter((function(e){var t=e[0];e[1];return t<=0})),e.stencil_bottomleft=e.stencil_bottom.filter((function(e){var t=e[0];e[1];return t>=0})),e.stencil_bottomright=e.stencil_bottom.filter((function(e){var t=e[0];e[1];return t<=0})),e.reflectStencils){var t=void 0;t=e.stencil.filter((function(e){var t=e[0];e[1];return t>0})).map((function(e){return[-e[0],e[1]]})),e.stencil_right=e.stencil_right.concat(t),t=e.stencil.filter((function(e){var t=e[0];e[1];return t<0})).map((function(e){return[-e[0],e[1]]})),e.stencil_left=e.stencil_left.concat(t),t=e.stencil.filter((function(e){e[0];return e[1]<0})).map((function(e){return[e[0],-e[1]]})),e.stencil_top=e.stencil_top.concat(t),t=e.stencil.filter((function(e){e[0];return e[1]>0})).map((function(e){return[e[0],-e[1]]})),e.stencil_bottom=e.stencil_bottom.concat(t),t=e.stencil_top.filter((function(e){var t=e[0];e[1];return t<0})).map((function(e){return[-e[0],e[1]]})),e.stencil_topleft=e.stencil_topleft.concat(t),t=e.stencil_left.filter((function(e){e[0];return e[1]<0})).map((function(e){return[e[0],-e[1]]})),e.stencil_topleft=e.stencil_topleft.concat(t),e.stencil_topleft.splice(e.stencil_topleft.findIndex((function(e){return JSON.stringify(e)===JSON.stringify([1,1])})),1),t=e.stencil_top.filter((function(e){var t=e[0];e[1];return t>0})).map((function(e){return[-e[0],e[1]]})),e.stencil_topright=e.stencil_topright.concat(t),t=e.stencil_right.filter((function(e){e[0];return e[1]<0})).map((function(e){return[e[0],-e[1]]})),e.stencil_topright=e.stencil_topright.concat(t),e.stencil_topright.splice(e.stencil_topright.findIndex((function(e){return JSON.stringify(e)===JSON.stringify([-1,1])})),1),t=e.stencil_bottom.map((function(e){return[-e[0],e[1]]})).filter((function(e){var t=e[0];e[1];return t>0})),e.stencil_bottomleft=e.stencil_bottomleft.concat(t),t=e.stencil_left.map((function(e){return[e[0],-e[1]]})).filter((function(e){e[0];return e[1]<0})),e.stencil_bottomleft=e.stencil_bottomleft.concat(t),e.stencil_bottomleft.splice(e.stencil_bottomleft.findIndex((function(e){return JSON.stringify(e)===JSON.stringify([1,-1])})),1),t=e.stencil_bottom.map((function(e){return[-e[0],e[1]]})).filter((function(e){var t=e[0];e[1];return t<0})),e.stencil_bottomright=e.stencil_bottomright.concat(t),t=e.stencil_right.map((function(e){return[e[0],-e[1]]})).filter((function(e){e[0];return e[1]<0})),e.stencil_bottomright=e.stencil_bottomright.concat(t),e.stencil_bottomright.splice(e.stencil_bottomright.findIndex((function(e){return JSON.stringify(e)===JSON.stringify([-1,-1])})),1)}e.initialized=!0}},e.apply_stencil=function(t,r,n,a,i,o){if(t.length!==e.stencil.length)throw Error("Length mismatched");for(var c=i,u=0;u<t.length;u++){var s=t[u],l=s[0];c=o(c,r[n+s[1]][a+l])}return c},e.stencil_computation=function(t,r,n){e.initialize();for(var a=t.length,i=t[0].length,o=Array(a).fill(0).map((function(){return Array(i).fill(0)})),c=1;c<i-1;c++)for(var u=1;u<a-1;u++)o[u][c]=e.apply_stencil(e.stencil,t,c,u,n,r);for(u=1;u<i-1;u++)o[0][u]=e.apply_stencil(e.stencil_top,t,0,u,n,r),o[a-1][u]=e.apply_stencil(e.stencil_bottom,t,a-1,u,n,r);for(c=1;c<a-1;c++)o[c][0]=e.apply_stencil(e.stencil_left,t,c,0,n,r),o[c][i-1]=e.apply_stencil(e.stencil_right,t,c,i-1,n,r);return o[0][0]=e.apply_stencil(e.stencil_topleft,t,0,0,n,r),o[0][i-1]=e.apply_stencil(e.stencil_topright,t,0,i-1,n,r),o[a-1][0]=e.apply_stencil(e.stencil_bottomleft,t,a-1,0,n,r),o[a-1][i-1]=e.apply_stencil(e.stencil_bottomright,t,a-1,i-1,n,r),o},e.reflectStencils=!0,e.ninePointStencil=[[-1,-1],[-1,0],[-1,1],[0,-1],[0,0],[0,1],[1,-1],[1,0],[1,1]],e.stencil=e.ninePointStencil,e.initialized=!1,e}();t.Stencil=a},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.delete_me=void 0,t.delete_me=!0},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.delete_me=void 0,t.delete_me=!0},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.delete_me=void 0,t.delete_me=!0},function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.delete_me=void 0,t.delete_me=!0},function(e,t,r){(function(e){var n;/*! https://mths.be/punycode v1.3.2 by @mathias */!function(a){t&&t.nodeType,e&&e.nodeType;var i="object"==typeof global&&global;i.global!==i&&i.window!==i&&i.self;var o,c=2147483647,u=/^xn--/,s=/[^\x20-\x7E]/,l=/[\x2E\u3002\uFF0E\uFF61]/g,d={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},f=Math.floor,b=String.fromCharCode;function h(e){throw RangeError(d[e])}function v(e,t){for(var r=e.length,n=[];r--;)n[r]=t(e[r]);return n}function p(e,t){var r=e.split("@"),n="";return r.length>1&&(n=r[0]+"@",e=r[1]),n+v((e=e.replace(l,".")).split("."),t).join(".")}function m(e){for(var t,r,n=[],a=0,i=e.length;a<i;)(t=e.charCodeAt(a++))>=55296&&t<=56319&&a<i?56320==(64512&(r=e.charCodeAt(a++)))?n.push(((1023&t)<<10)+(1023&r)+65536):(n.push(t),a--):n.push(t);return n}function g(e){return v(e,(function(e){var t="";return e>65535&&(t+=b((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=b(e)})).join("")}function O(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function j(e,t,r){var n=0;for(e=r?f(e/700):e>>1,e+=f(e/t);e>455;n+=36)e=f(e/35);return f(n+36*e/(e+38))}function y(e){var t,r,n,a,i,o,u,s,l,d,b,v=[],p=e.length,m=0,O=128,y=72;for((r=e.lastIndexOf("-"))<0&&(r=0),n=0;n<r;++n)e.charCodeAt(n)>=128&&h("not-basic"),v.push(e.charCodeAt(n));for(a=r>0?r+1:0;a<p;){for(i=m,o=1,u=36;a>=p&&h("invalid-input"),((s=(b=e.charCodeAt(a++))-48<10?b-22:b-65<26?b-65:b-97<26?b-97:36)>=36||s>f((c-m)/o))&&h("overflow"),m+=s*o,!(s<(l=u<=y?1:u>=y+26?26:u-y));u+=36)o>f(c/(d=36-l))&&h("overflow"),o*=d;y=j(m-i,t=v.length+1,0==i),f(m/t)>c-O&&h("overflow"),O+=f(m/t),m%=t,v.splice(m++,0,O)}return g(v)}function S(e){var t,r,n,a,i,o,u,s,l,d,v,p,g,y,S,C=[];for(p=(e=m(e)).length,t=128,r=0,i=72,o=0;o<p;++o)(v=e[o])<128&&C.push(b(v));for(n=a=C.length,a&&C.push("-");n<p;){for(u=c,o=0;o<p;++o)(v=e[o])>=t&&v<u&&(u=v);for(u-t>f((c-r)/(g=n+1))&&h("overflow"),r+=(u-t)*g,t=u,o=0;o<p;++o)if((v=e[o])<t&&++r>c&&h("overflow"),v==t){for(s=r,l=36;!(s<(d=l<=i?1:l>=i+26?26:l-i));l+=36)S=s-d,y=36-d,C.push(b(O(d+S%y,0))),s=f(S/y);C.push(b(O(s,0))),i=j(r,g,n==a),r=0,++n}++r,++t}return C.join("")}o={version:"1.3.2",ucs2:{decode:m,encode:g},decode:y,encode:S,toASCII:function(e){return p(e,(function(e){return s.test(e)?"xn--"+S(e):e}))},toUnicode:function(e){return p(e,(function(e){return u.test(e)?y(e.slice(4).toLowerCase()):e}))}},void 0===(n=function(){return o}.call(t,r,t,e))||(e.exports=n)}()}).call(this,r(199)(e))},function(e,t){e.exports=function(e){return e.webpackPolyfill||(e.deprecate=function(){},e.paths=[],e.children||(e.children=[]),Object.defineProperty(e,"loaded",{enumerable:!0,get:function(){return e.l}}),Object.defineProperty(e,"id",{enumerable:!0,get:function(){return e.i}}),e.webpackPolyfill=1),e}},function(e,t,r){"use strict";e.exports={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}}},function(e,t,r){"use strict";t.decode=t.parse=r(202),t.encode=t.stringify=r(203)},function(e,t,r){"use strict";function n(e,t){return Object.prototype.hasOwnProperty.call(e,t)}e.exports=function(e,t,r,a){t=t||"&",r=r||"=";var i={};if("string"!=typeof e||0===e.length)return i;var o=/\+/g;e=e.split(t);var c=1e3;a&&"number"==typeof a.maxKeys&&(c=a.maxKeys);var u=e.length;c>0&&u>c&&(u=c);for(var s=0;s<u;++s){var l,d,f,b,h=e[s].replace(o,"%20"),v=h.indexOf(r);v>=0?(l=h.substr(0,v),d=h.substr(v+1)):(l=h,d=""),f=decodeURIComponent(l),b=decodeURIComponent(d),n(i,f)?Array.isArray(i[f])?i[f].push(b):i[f]=[i[f],b]:i[f]=b}return i}},function(e,t,r){"use strict";var n=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};e.exports=function(e,t,r,a){return t=t||"&",r=r||"=",null===e&&(e=void 0),"object"==typeof e?Object.keys(e).map((function(a){var i=encodeURIComponent(n(a))+r;return Array.isArray(e[a])?e[a].map((function(e){return i+encodeURIComponent(n(e))})).join(t):i+encodeURIComponent(n(e[a]))})).join(t):a?encodeURIComponent(n(a))+r+encodeURIComponent(n(e)):""}},function(e,t,r){"use strict";r.r(t);var n,a,i=r(108),o=r(10),c=r(5),u=r(18),s=r(110),l=r(20),d=r(22);(a=n||(n={})).fastMin=o.c,a.fastMax=o.b,a.fastAbs=o.a,a.identity=o.d,a.numEnumArray=o.l,a.numEnumMap=o.m,a.safePush=o.p,a.safeConcat=o.o,a.isDefined=o.e,a.isNone=o.f,a.makeStringMap=o.i,a.now=o.k,a.staticAssertExtends=o.r,a.staticAssertSame=o.u,a.staticAssertIs=o.s,a.staticAssertIsOptional=o.t,a.JSF32=l.JSF32,a.Pledge=d.a,a.assertNever=c.e,a.assertNatural=c.d,a.assertTrue=c.h,a.assertFalse=c.a,a.assertPositiveLength=c.g,a.assertPositiveInteger=c.f,a.assertIndex=c.b,a.messageFromError=u.c,a.isInteger=u.b,a.stringStartsWith=u.h,a.stringEndsWith=u.g,a.arrayFill=u.a,(a.ds||(a.ds={})).Deque=s.a;var f=r(30),b=r(0),h=r(12),v=r(7),p=r(2),m=r(1),g=r(46),O=r(60),j=r(3),y=r(4),S=r(72),C=r(71),k=r(19),E=r(29),A=r(79),N=r(68),T=r(78),R=r(33),I=r(8),_=r(23);var F=R.j;function w(e){return{kind:I.b.Number,_valueIEEE:e}}var M=w(0),D=w(1),P=w(Math.PI);function x(e){return isFinite(e)?w(e):v.p}function L(e,t){var r=e._valueIEEE,n=t._valueIEEE;return r<n?-1:r>n?1:0}function B(e,t){var r=void 0===t?e.toExponential():e.toExponential(t),n=r.indexOf("e"),a=!Object(u.h)(r,"-"),i=r.substring(a?0:1,n).replace(".",""),o=parseInt(r.substring(n+1),10)+1;return function(e){for(var t=0;t<e.length;t+=1)if(e.charCodeAt(t)!==F)return!1;return!0}(i)?{sign:a,mantissa:"",exponent:0}:{sign:a,mantissa:i,exponent:o}}var U=["0","1","2","3","4","5","6","7","8","9"];function G(e){var t=e._valueIEEE;return w(t<0?Math.ceil(t):Math.floor(t))}function V(e){var t=e._valueIEEE;return w(Math.floor(t))}function H(e){return e.substring(0,1)+"."+e.substring(1)}var W,z,q,K,Y,J,Q,X,Z,$,ee,te,re,ne,ae,ie,oe={zero:M,one:D,pi:P,add:function(e,t){return x(e._valueIEEE+t._valueIEEE)},sub:function(e,t){return x(e._valueIEEE-t._valueIEEE)},mul:function(e,t){return x(e._valueIEEE*t._valueIEEE)},div:function(e,t){var r=e._valueIEEE,n=t._valueIEEE;return 0===n?v.g:x(r/n)},power:function(e,t){var r=e._valueIEEE,n=t._valueIEEE,a=Math.pow(r,n);return isFinite(a)?w(a):isNaN(a)?v.g:v.p},percent:function(e){return w(e._valueIEEE/100)},neg:function(e){return w(-e._valueIEEE)},compare:L,formatGeneral:function(e,t,r){var n=e.decimalSeparator,a=t._valueIEEE,i=String(a).replace("e","E");return"."!==n&&(i=i.replace(".",n)),i},formatFixed:function(e,t,r){var n,a=e._valueIEEE,i=B(a),o=i.sign,c=i.mantissa,u=i.exponent,s=r+(u+t);if(0===s){var l=parseFloat("5e"+String(u-1));if(Math.abs(a)>=l)return Object(T.b)(o,"1",u+t+1)}if(s<1)return Object(T.b)(!0,"",0);s<=21&&(o=(n=B(a,s-1)).sign,c=n.mantissa,s=r+((u=n.exponent)+t));var d=c.substring(0,s);return Object(T.b)(o,d,0===d.length?0:u+t)},formatScientific:function(e,t,r){var n,a=e._valueIEEE,i=B(a),o=i.sign,u=i.mantissa,s=i.exponent,l=Object(T.a)(s,t),d=l+r;if(Object(c.h)("calc.lang.ieeeFormatScientific",d>0),0===d){var f=parseFloat("5e"+String(s-1));if(Math.abs(a)>=f)return Object(T.b)(o,"",s+1)}if(d<1)return Object(T.b)(!0,"",0);d<=21&&(o=(n=B(a,d-1)).sign,u=n.mantissa,s=n.exponent,d=(l=Object(T.a)(s,t))+r);var b=u.substring(0,d);return Object(T.b)(o,b,0===b.length?0:s)},parse:function(e,t,r,n){return w(Number((t?"":"-")+"0."+function(e,t){for(var r=e.getOrdinal,n="",a=0,i=Object(_.b)(t);a<i.length;a++){var o=i[a];n+=U[r(o)]}return n}(e,n)+"E"+String(r)))},trunc:G,ceil:function(e){var t=e._valueIEEE;return w(Math.ceil(t))},floor:V,abs:function(e){return w(Math.abs(e._valueIEEE))},cond:function(e){return L(e,M)},cond2:L,fromNumber:w,toNumber:function(e){return e._valueIEEE},sqrt:function(e){return x(Math.sqrt(e._valueIEEE))},exp:function(e){return x(Math.exp(e._valueIEEE))},ln:function(e){return x(Math.log(e._valueIEEE))},log:function(e){return x(Math.log(e._valueIEEE)/Math.LN10)},sin:function(e){return w(Math.sin(e._valueIEEE))},cos:function(e){return w(Math.cos(e._valueIEEE))},tan:function(e){return w(Math.tan(e._valueIEEE))},asin:function(e){return x(Math.asin(e._valueIEEE))},acos:function(e){return x(Math.acos(e._valueIEEE))},atan:function(e){return x(Math.atan(e._valueIEEE))},atan2:function(e,t){return w(Math.atan2(t._valueIEEE,e._valueIEEE))},round:function(e,t){var r=e._valueIEEE;if(0===r)return M;var n=B(r).exponent,a=G(t)._valueIEEE+n;if(0===a){var i=parseFloat("5e"+String(n-1));if(Math.abs(r)>=i)return x((r<0?-1:1)*parseFloat("10e"+String(n-1)))}return a<1?M:a>21?e:x(parseFloat(r.toExponential(a-1)))},roundUp:function(e,t){var r=e._valueIEEE;if(0===r)return M;var n=B(r),a=n.sign,i=n.mantissa,o=n.exponent,c=G(t)._valueIEEE+o;return c<1?x(parseFloat((a?"":"-")+"10e"+String(o-1-c))):c>21?e:x(parseFloat((a?"":"-")+function(e,t){if(e.length<=t)return H(e);for(var r=e.substring(0,t),n=0,a=r.length-1;a>=0&&r.charCodeAt(a)-F==9;a-=1)n+=1;return n===r.length?"10":H(r.substring(0,r.length-n-1)+String.fromCharCode(r.charCodeAt(r.length-n-1)+1))}(i,c)+"e"+String(o-1)))},roundDown:function(e,t){var r=e._valueIEEE;if(0===r)return M;var n=B(r),a=n.sign,i=n.mantissa,o=n.exponent,c=G(t)._valueIEEE+o;if(c<1)return M;if(c>21)return e;var u=i.substring(0,c);return x(parseFloat((a?"":"-")+H(u)+"e"+String(o-1)))},tenTo:function(e){return Object(c.c)("calc.lang.ieeeTenTo",e),x(Math.pow(10,e))},checkAlmostCancellation:function(e,t){return t},fix:function(e){var t=e._valueIEEE,r=Math.abs(t);return r>=4294967296?4294967295:Math.floor(r)},lfix:function(e){var t=G(e)._valueIEEE;return t<-2147483648||t>2147483647?-2147483648:t},sfix:function(e){var t=V(e)._valueIEEE;return t<-2147483648?-2147483648:t>2147483647?2147483647:t},viewRound:o.d},ce=r(99),ue=r(36),se=r(112);(z=W||(W={})).LexicalKind=h.a,z.NameSource=h.b,z.sheetRows=h.v,z.sheetCols=h.o,z.lexicalSourceCell=h.h,z.lexicalSourceRange=h.k,z.lexicalSourceGrid=h.i,z.lexicalSourceName=h.j,z.documentLoc=h.d,z.structRefColumnLoc=h.w,z.sheetIndex=h.s,z.sheetRange=h.t,z.gridCell=h.f,z.gridRange=h.g,z.allSheetsRange=h.c,z.sheetRangeIndexes=h.u,z.sheetGridCell=h.p,z.sheetGridRange=h.r,z.sheetGridCube=h.q,z.originCell=h.n,z.documentScope=h.e,z.nameLoc=h.l,z.nameScope=h.m,z.userDefinedFuncLoc=h.y,(K=q||(q={})).SpecialPrecs=I.d,K.PrecsBound=v.b,K.OperKind=I.b,K.trueOper=v.v,K.falseOper=v.i,K.ErrorType=v.a,K.precedents=v.q,K.stringOper=v.u,K.booleanOper=v.e,K.errorOper=v.h,K.nullErrorOper=v.o,K.div0ErrorOper=v.g,K.valueErrorOper=v.w,K.refErrorOper=v.t,K.nameErrorOper=v.n,K.numErrorOper=v.p,K.naErrorOper=v.m,K.gettingDataErrorOper=v.k,K.fieldErrorOper=v.j,K.arrayOper=v.c,K.rangeSeqOper=v.s,K.range3DOper=v.r,K.missingOper=v.l,K.blankOper=v.d,(J=Y||(Y={})).RefStyle=p.h,J.QualifierKind=p.g,J.CellRefKind=p.c,J.PosKind=p.f,J.NodeKind=p.e,J.NamePartKind=p.d,J.SpecialRefId=p.i,J.StructRefKind=p.j,J.BadType=p.b,J.errorQualifier=p.B,J.relativeQualifier=p.fb,J.documentQualifier=p.A,J.sheetQualifier=p.gb,J.identQualifier=p.N,J.sheetRangeQualifier=p.hb,J.badQualifier=p.o,J.pos=p.db,J.cellRefError=p.s,J.cellRefSingle=p.x,J.cellRefRange=p.v,J.cellRefRow=p.w,J.cellRefCol=p.r,J.cellRefBad=p.q,J.formula=p.I,J.formulaSpan=p.K,J.literalNode=p.T,J.arrayNode=p.m,J.appNode=p.l,J.flattenLetArgs=p.G,J.indexedArg=p.O,J.letVar=p.S,J.letNode=p.R,J.flattenLambdaArgs=p.F,J.paramName=p.ab,J.paramDefault=p.Z,J.paramNode=p.bb,J.lambdaParam=p.Q,J.lambdaNode=p.P,J.operatorNode=p.Y,J.wsfNode=p.mb,J.parenNode=p.cb,J.nameNode=p.X,J.identNamePart=p.M,J.cellRefNamePart=p.t,J.fieldRefNamePart=p.D,J.cellRefNode=p.u,J.fieldRefNode=p.E,J.fieldRef=p.C,J.structRefNode=p.kb,J.structRef=p.jb,J.specialRef=p.ib,J.columnRef=p.y,J.rangeOpRef=p.eb,J.commaOpRef=p.z,J.thisRowOpRef=p.lb,J.missingRef=p.W,J.badRef=p.p,J.badNode=p.n,J.AnnotationKind=p.a,J.appHeadNameAnnotation=p.k,J.formulaRootAnnotation=p.J,J.localNameUseAnnotation=p.V,J.localNameDeclAnnotation=p.U,(X=Q||(Q={})).SignatureType=I.c,X.FunctionFlags=I.a,X.OperatorId=m.a,X.WorksheetFuncId=m.b,X.SpecialPrecs=I.d,X.functionType=I.e,X.unknownFunctionType=m.h,X.getOperatorType=m.c,X.getWorksheetFuncType=m.e,($=Z||(Z={})).isSheetIndex=j.Y,$.isSheetGridRange=j.W,$.isGridCell=j.F,$.isSheetGridCell=j.U,$.forEachCellInRange=j.d,$.gridRangeJoin=j.s,$.gridRangeJoinOpt=j.t,$.gridRangesJoin=j.v,$.gridRangeIsect=j.q,$.gridRangeIsects=j.r,$.gridCellImplicitIsect=j.l,$.gridRangeCompare=j.o,$.gridRangeExcept=j.p,$.gridRangeSize=j.u,$.isDocumentLocEqual=j.D,$.isSheetIndexEqual=j.Z,$.isNameScopeEqual=j.K,$.isGridCellEqual=j.G,$.isGridRangeEqual=j.H,$.isSheetGridCellEqual=j.V,$.isSheetGridRangeEqual=j.X,$.isWellFormed=j.eb,$.isUnqualifiedNameNode=j.bb,$.isOperatorNode=j.N,$.isWSFNode=j.db,$.gridRangeAnchor=j.n,$.sheetGridRangeAnchor=j.ib,$.gridCellRange=j.m,$.getArguments=j.g,$.getArgType=j.f,$.isValidArgsLength=j.cb,$.isNumberOper=j.M,$.isStringOper=j.ab,$.isBooleanOper=j.z,$.isErrorOper=j.E,$.isRangeOper=j.R,$.isArrayOper=j.x,$.isMissingOper=j.J,$.isBlankOper=j.y,$.isRichOper=j.T,$.isPrimitiveOper=j.O,$.isWriteOper=j.fb,$.isReadOperEqual=j.S,$.ResultKind=b.b,$.success=b.f,$.failure=b.c,$.successUndefined=b.g,$.isSuccess=b.d,$.ReasonKind=j.b,$.notImplemented=j.hb,$.unavailable=j.kb,$.internal=j.w,$.javaScriptError=b.e,$.createFailureErrorClass=j.c,$.columnName=g.b,$.formatRow=g.i,$.formatCol=g.d,$.formatRowRange=g.j,$.formatColRange=g.e,$.formatCellPos=g.c,$.formatGridRangeA1=g.f,$.parseGridCellA1=O.d,$.parseGridRangeA1=O.e,$.getSubExpressionFromPosition=j.i,$.resolveLocalsGrid=k.k,$.ResolveReasonKind=k.d,$.noOriginSheet=k.j,$.invalidQualifier=k.h,$.InvalidQualifierReason=k.b,$.invalidCellRef=k.g,$.InvalidCellRefReason=k.a,$.invalidStructRef=k.i,$.InvalidStructRefReason=k.c,$.emptyIntersection=k.f,$.ResolvedKind=k.e,$.resolvedName=k.o,$.resolvedCellRef=k.l,$.resolvedUserDefinedFunc=k.r,$.resolvedLocalName=k.n,$.resolvedStructRef=k.q,$.resolvedNever=k.p,$.resolvedDottedName=k.m,$.createResolver=C.a,$.visitFormulaNode=E.r,$.visitOperatorNode=E.s,$.visitWSFNode=E.u,$.visitAppHeadNode=E.p,$.visitQualifier=E.t,$.visitCellRef=E.q,$.IdentityVisitor=E.e,$.identityVisitor=E.l,$.ConstVisitor=E.c,$.constVisitor=E.j,$.voidVisitor=E.v,$.DelegatingVisitor=E.d,$.BinaryVisitor=E.a,$.binaryVisitor=E.h,$.ComposeVisitor=E.b,$.composeVisitor=E.i,$.reduceBottomUp=E.m,$.reducePledge=E.n,$.buildAnnotations=se.a,$.createSimplePrintGlobals=N.a,$.printLocalsGrid=N.b,$.printLocalsName=N.c,$.createPrinter=A.b,(te=ee||(ee={})).LogCategory=y.c,te.TraceLevel=y.i,te.NulLogger=y.d,te.ulsLogger=y.B,te.localeInfo=y.z,te.LCID=y.b,te.Country=y.a,te.PictureSpecial=y.h,te.PictureSingle=y.g,te.PictureColor=y.e,te.PictureDbnum=y.f,te.calcConfig=y.j,te.initCalc=S.c,te.getEnglishLocaleInfo=y.s,te.englishWorksheetFuncIdToName=y.r,te.englishErrorTypeToName=y.m,te.englishOperatorIdToName=y.n,te.operatorIdToName=y.A,te.createWorksheetFuncNameCallbacks=y.k,te.isCalcInit=S.g,te.getCalcAbsUrl=S.a,te.FeatureName=f.a,(ne=re||(re={})).numberComponents=T.b,ne.ieeeMathpack=oe,ne.xlMathpack=ce.a,ne.formatScientificLeft=T.a,(ie=ae||(ae={})).TimeDivision=ue.b,ie.Rounding=ue.a,ie.tzData=ue.e,ie.tzUTC=ue.f,ie.dateTime=ue.d,ie.TimeGranularity=ue.c,ie.xlDatepack=ue.g;var le=r(56),de=r(80),fe=r(9);function be(e,t){var r=e[t];return null==r?Object(c.a)("ParseResultHelper.getFormulaSpan: expected span for label ".concat(t," to be defined")):r}function he(e,t,r,n,a,i,u){return void 0===a&&(a=!1),!!Object(b.d)(e)&&(function(e,t,r,n,a,i,u){if(null==e||null==n)return;var s={};null!=r?r.forEach((function(e){s[e]=!0})):s["*"]=!0;var l={},d=0,f=[];f.push(e.node);for(;f.length>0;){var h=f.pop();if(null!=h)switch(h.kind){case p.e.Literal:R("literal")&&n("literal",{label:h.label,value:h});break;case p.e.Array:h.nodes.forEach((function(e){return Object(o.p)(f,e)}));break;case p.e.Let:case p.e.Lambda:case p.e.App:var v=h.head;switch(v.kind){case p.e.Operator:R("operator")&&n("operator",{label:h.label,value:v.id});break;case p.e.WSF:case p.e.Name:R("function")&&n("function",{label:h.label,name:v.whole,isClosed:h.isClosed,args:h.args});break;default:f.push(v)}if(h.kind===p.e.Let){for(var m=0,g=h.vars;m<g.length;m++){var O=g[m].name;l[O.arg.label]=d}d+=1}else if(h.kind===p.e.Lambda){for(var j=0,y=h.params;j<y.length;j++){var S=y[j].name;l[S.arg.label]=d}d+=1}Object(o.p)(f,h.args);break;case p.e.Paren:f.push(h.node);break;case p.e.Name:var C=e.annotations[h.parts.label],k=e.annotations[h.label];if((null==C?void 0:C.kind)===p.a.LocalNameUse)R("letName")&&n("letName",{label:h.label,name:C.name,number:l[C.label],qualifier:void 0});else if((null==k?void 0:k.kind)===p.a.LocalNameDecl)R("letName")&&n("letName",{label:h.label,name:h.whole,number:l[h.label],qualifier:void 0});else if(R("namedRange")){var E=h.whole.split(".");n("namedRange",{label:h.label,name:E[0],names:E.slice(1),qualifier:I(h)})}break;case p.e.Param:var A=e.annotations[h.label];(null==A?void 0:A.kind)===p.a.LocalNameDecl&&R("letName")&&n("letName",{label:h.name.label,name:h.whole,number:l[h.label],qualifier:void 0}),void 0!==h.def&&f.push(h.def.rhs);break;case p.e.CellRef:R("range")&&_(h);break;case p.e.FieldRef:f.push(h.lhs);break;case p.e.StructRef:if(R("structRefRange")){if(null==u||null==i)break;var N=u.resolveStructRef(i,h).resolution;if(!Object(b.d)(N)||void 0===N.value)break;var T=N.value;n("structRefRange",{label:h.label,type:"range",top:Object(p.db)(p.f.Rel,T.range.row),left:Object(p.db)(p.f.Rel,T.range.col),bottom:Object(p.db)(p.f.Rel,T.range.row+T.range.rows-1),right:Object(p.db)(p.f.Rel,T.range.col+T.range.cols-1),span:be(e.spans,h.label),qualifier:void 0!==h.lhs?I(h.lhs):void 0,name:void 0!==h.lhs?h.lhs.whole:void 0})}break;case p.e.Bad:switch(h.type){case p.b.Sequence:case p.b.StructRef:case p.b.FieldRef:Object(o.p)(f,h.contents);break;default:Object(o.u)()}break;default:return Object(c.e)("calc.parse.traverseFormula",h)}}function R(e){return s[e]||s["*"]}function I(e){if(null!=e.qualifier){var t={};switch(e.qualifier.kind){case p.g.Sheet:var r=e.qualifier;t.type=p.g.Sheet,t.sheet=r.sheet,null!=r.document&&(t.document=r.document.document,null!=r.document.path&&(t.documentPath=r.document.path));break;case p.g.SheetRange:var n=e.qualifier;t.type=p.g.SheetRange,t.sheet1=n.sheet1,t.sheet2=n.sheet2;break;case p.g.Ident:var a=e.qualifier;t.type=p.g.Ident,t.name=a.name;break;case p.g.Document:var i=e.qualifier;t.document=i.document,null!=i.path&&(t.documentPath=i.path)}return t}}function _(t){if(null!=e&&null!=n)switch(t.ref.kind){case p.c.Error:break;case p.c.Col:var r=t.ref;n("range",{label:t.label,type:"col",startIndex:r.col1,endIndex:r.col2,span:be(e.spans,r.label),qualifier:I(t)});break;case p.c.Row:var a=t.ref;n("range",{label:t.label,type:"row",startIndex:a.row1,endIndex:a.row2,span:be(e.spans,a.label),qualifier:I(t)});break;case p.c.Single:var i=t.ref;n("range",{label:t.label,type:"cell",row:i.row,col:i.col,span:be(e.spans,i.label),qualifier:I(t)});break;case p.c.Range:var o=t.ref;n("range",{label:t.label,type:"range",top:o.ref1.row,left:o.ref1.col,bottom:o.ref2.row,right:o.ref2.col,topLeftSpan:be(e.spans,o.ref1.label),bottomRightSpan:be(e.spans,o.ref2.label),qualifier:I(t)})}}}(e.value,null!=n||Object(y.s)(),t,r,0,i,u),!0)}function ve(e,t){var r=e[t];return Object(c.h)("ParseResultHelper.getFormulaSpan: expected span to be defined",void 0!==r),r}var pe=function(e){function t(t,r){var n=e.call(this)||this;return n.formula=t,n.caretPosition=r,n.references=[],n}return Object(fe.__extends)(t,e),t.prototype.letNode=function(t,r,n,a,i,o){if(this.caretInNode(null==n?void 0:n.arg))this.pushNames(r);else for(var c=0;c<r.length;c+=1){var u=r[c].binder;if(this.caretInNode(u.arg)){this.pushNames(t.id===m.b.LET?r.slice(0,c):r);break}}return e.prototype.letNode.call(this,t,r,n,a,i,o)},t.prototype.lambdaNode=function(t,r,n,a,i,o){if(this.caretInNode(null==n?void 0:n.arg))this.pushNames(r);else for(var c=0;c<r.length;c+=1){var u=r[c].name;if(void 0!==u.arg.def&&this.caretInNode(u.arg.def.rhs)){this.pushNames(r.slice(0,c));break}}return e.prototype.lambdaNode.call(this,t,r,n,a,i,o)},t.prototype.caretInNode=function(e){if(void 0===e)return!1;var t=this.formula.spans[e.label];return void 0!==t&&this.caretPosition>=t.start&&this.caretPosition<=t.end},t.prototype.pushNames=function(e){Object(o.p)(this.references,e.map((function(e){return e.name.arg.whole})).filter(o.e).reverse())},t}(E.e);function me(e,t,r,n,a,i,o){if(void 0===a&&(a=!1),!Object(b.d)(e))return!1;try{!function(e,t,r,n,a,i,o){if(null==e||null==n)return;var c={};null!=r?r.forEach((function(e){c[e]=!0})):c["*"]=!0;var u={},s=0,l=[],d=Object(fe.__assign)(Object(fe.__assign)({},E.v),{letNode:function(t,r,n,a,i,o){for(var c=0,d=r;c<d.length;c++){var f=d[c].name;u[f.arg.label]=s}l.push({letCount:s,span:ve(e.spans,o)}),s+=1},lambdaNode:function(t,r,n,a,i,o){for(var c=0,d=r;c<d.length;c++){var f=d[c].name;u[f.arg.label]=s}l.push({letCount:s,span:ve(e.spans,o)}),s+=1}});Object(E.m)(d,e),l.sort((function(e,t){return e.span.start-t.span.start}));for(var f={},h=0;h<l.length;h+=1)f[l[h].letCount]=h;for(var v=0,m=Object.keys(u).map(Number);v<m.length;v++){var g=m[v];u[g]=f[u[g]]}var O={literalNode:function(e,t,r){var a=E.l.literalNode(e,t,r);return j("literal")&&n("literal",{label:r,value:a}),a},arrayNode:function(e,t,r){return E.l.arrayNode(e,t,r)},appNode:function(e,t,r,n){var a=E.l.appNode(e,t,r,n);return S(e,t,r,n),a},letNode:function(e,t,r,a,i,o){var c=Object(p.R)(e,t,r,a,i,o);S(e,c.args,i,o);for(var s=0,l=t;s<l.length;s++){var d=l[s].name;j("letName")&&n("letName",{label:d.arg.label,name:d.arg.whole,number:u[d.arg.label],qualifier:void 0})}return c},lambdaNode:function(e,t,r,a,i,o){var c=Object(p.P)(e,t,r,a,i,o);S(e,c.args,i,o);for(var s=0,l=t;s<l.length;s++){var d=l[s].name;j("letName")&&n("letName",{label:d.arg.name.name.label,name:d.arg.whole,number:u[d.arg.label],qualifier:void 0})}return c},parenNode:function(e,t,r){return E.l.parenNode(e,t,r)},nameNode:function(t,r,a){var i=Object(p.X)(t,r,a),o=e.annotations[t.label],c=e.annotations[a];if((null==c?void 0:c.kind)===p.a.AppHeadName);else if((null==o?void 0:o.kind)===p.a.LocalNameUse)j("letName")&&n("letName",{label:a,name:o.name,number:u[o.label],qualifier:void 0});else if(j("namedRange")){var s=i.whole.split(".");n("namedRange",{label:a,name:s[0],names:s.slice(1),qualifier:y(i)})}return i},cellRefNode:function(t,r,a){var i=Object(p.u)(t,r,a);return j("range")&&function(t){if(null==e||null==n)return;switch(t.ref.kind){case p.c.Error:break;case p.c.Col:var r=t.ref;n("range",{label:t.label,type:"col",startIndex:r.col1,endIndex:r.col2,span:ve(e.spans,r.label),qualifier:y(t)});break;case p.c.Row:var a=t.ref;n("range",{label:t.label,type:"row",startIndex:a.row1,endIndex:a.row2,span:ve(e.spans,a.label),qualifier:y(t)});break;case p.c.Single:var i=t.ref;n("range",{label:t.label,type:"cell",row:i.row,col:i.col,span:ve(e.spans,i.label),qualifier:y(t)});break;case p.c.Range:var o=t.ref;n("range",{label:t.label,type:"range",top:o.ref1.row,left:o.ref1.col,bottom:o.ref2.row,right:o.ref2.col,topLeftSpan:ve(e.spans,o.ref1.label),bottomRightSpan:ve(e.spans,o.ref2.label),qualifier:y(t)})}}(i),i},fieldRefNode:function(e,t,r,n){return E.l.fieldRefNode(e,t,r,n)},structRefNode:function(t,r,a){var c=Object(p.kb)(t,r,a);if(j("structRefRange")){if(null==o||null==i)return c;var u=o.resolveStructRef(i,c).resolution;if(!Object(b.d)(u)||void 0===u.value)return c;var s=u.value;n("structRefRange",{label:a,type:"range",top:Object(p.db)(p.f.Rel,s.range.row),left:Object(p.db)(p.f.Rel,s.range.col),bottom:Object(p.db)(p.f.Rel,s.range.row+s.range.rows-1),right:Object(p.db)(p.f.Rel,s.range.col+s.range.cols-1),span:ve(e.spans,a),qualifier:void 0!==t?y(t):void 0,name:void 0!==t?t.whole:void 0})}return c},badSequenceNode:function(e,t,r){return E.l.badSequenceNode(e,t,r)},badStringNode:function(e,t,r){return E.l.badStringNode(e,t,r)},operatorNode:function(e,t){return E.l.operatorNode(e,t)},wsfNode:function(e,t,r){return E.l.wsfNode(e,t,r)}};function j(e){return c[e]||c["*"]}function y(e){if(null!=e.qualifier){var t={};switch(e.qualifier.kind){case p.g.Sheet:var r=e.qualifier;t.type=p.g.Sheet,t.sheet=r.sheet,null!=r.document&&(t.document=r.document.document,null!=r.document.path&&(t.documentPath=r.document.path));break;case p.g.SheetRange:var n=e.qualifier;t.type=p.g.SheetRange,t.sheet1=n.sheet1,t.sheet2=n.sheet2;break;case p.g.Ident:var a=e.qualifier;t.type=p.g.Ident,t.name=a.name;break;case p.g.Document:var i=e.qualifier;t.document=i.document,null!=i.path&&(t.documentPath=i.path)}return t}}function S(e,t,r,a){if(null!=n)switch(e.kind){case p.e.Operator:j("operator")&&n("operator",{label:a,value:e.id});break;case p.e.WSF:case p.e.Name:j("function")&&n("function",{label:a,name:e.whole,isClosed:r,args:t})}}Object(E.m)(O,e)}(e.value,null!=n||Object(y.s)(),t,r,0,i,o)}catch(e){var s="ParseResultHelper.traverse: unhandled error ".concat(Object(u.c)(e));c.i.ULS.traceTag(540645344,y.c.msoulscat_ES_EWAJS,y.i.Warning,s)}return!0}var ge,Oe,je={isSuccess:b.d,traverse:function(e,t,r,n,a,i,o){return Object(f.e)(f.a["OfficeVSO:5484395_SafeParseResultHelper"])?me(e,t,r,n,a,i,o):he(e,t,r,n,a,i,o)},extractReferences:function(e,t,r,n,a){return Object(f.e)(f.a["OfficeVSO:5484395_SafeParseResultHelper"])?function(e,t,r,n,a){if(void 0===r&&(r=!1),Object(b.d)(e)){var i=[];return me(e,["range","namedRange","letName","literal","function","structRefRange"],(function(t,r){var n={kind:t,ref:r,span:ve(e.value.spans,r.label)};i.push(n)}),t,r,n,a),i.sort((function(e,t){var r;return 0!=(r=e.span.start-t.span.start)||0!=(r=t.span.end-e.span.end)?r:0})),i}}(e,t,r,n,a):function(e,t,r,n,a){if(void 0===r&&(r=!1),Object(b.d)(e)){var i=[];return he(e,["range","namedRange","letName","literal","function","structRefRange"],(function(t,r){var n={kind:t,ref:r,span:be(e.value.spans,r.label)};i.push(n)}),t,r,n,a),i.sort((function(e,t){return e.span.start-t.span.start})),i}}(e,t,r,n,a)},extractLetVariables:function(e,t){if(Object(b.d)(e))try{var r=new pe(e.value,t);return Object(E.m)(r,e.value),r.references.reverse()}catch(e){var n="ParseResultHelper.extractLetVariables: unhandled error ".concat(Object(u.c)(e));return c.i.ULS.traceTag(540645343,y.c.msoulscat_ES_EWAJS,y.i.Warning,n),[]}}};(Oe=ge||(ge={})).createParseGlobals=le.b,Oe.ReasonKind=le.a,Oe.parseLocals=le.d,Oe.notFormulaString=le.c,Oe.createParser=de.a,Oe.parseResultHelper=je;var ye,Se,Ce=r(66),ke=r(83);(Se=ye||(ye={})).analyzeLocalsGrid=Ce.a,Se.analyzeLocalsName=Ce.b,Se.diagnostics=Ce.d,Se.summarizeFormulaDiagnostics=Ce.e,Se.createAnalyzeGlobals=Ce.c,Se.createAnalyzer=ke.a;var Ee,Ae,Ne=r(6),Te=r(11),Re=r(48),Ie=r(82),_e=r(90),Fe=r(92),we=r(81);(Ae=Ee||(Ee={})).FormatReasonKind=Ne.g,Ae.ReasonKind=Ne.m,Ae.notValueString=Ne.E,Ae.notFormatString=Ne.D,Ae.noFormatPart=Ne.C,Ae.tooWide=Ne.N,Ae.dateOverflow=Ne.o,Ae.fractionOverflow=Ne.w,Ae.previousFormatFailure=Ne.H,Ae.FormatValueType=Ne.h,Ae.BidiDate=Ne.b,Ae.CultureTag=Ne.d,Ae.FormatCurrency=Ne.f,Ae.NamedColor=Ne.k,Ae.Alignment=Ne.a,Ae.GetTimeKind=Ne.j,Ae.Clip=Ne.c,Ae.FormattedUnitKind=Ne.i,Ae.formattedUnitGeneral=Ne.s,Ae.formattedUnitString=Ne.t,Ae.formattedUnitBlank=Ne.q,Ae.formattedUnitFlexible=Ne.r,Ae.formattedValue=Ne.u,Ae.renderedValue=Ne.K,Ae.hashesValue=Ne.x,Ae.isHashesValue=Ne.z,Ae.renderCallback=Ne.I,Ae.memoizedRenderCallback=Ne.B,Ae.renderInfiniteWidth=Ne.J,Ae.renderedValueToString=Ne.L,Ae.EditKind=Ne.e,Ae.formulaEdit=Ne.v,Ae.stringEdit=Ne.M,Ae.numberEdit=Ne.F,Ae.otherEdit=Ne.G,Ae.NumberFormatSource=Ne.l,Ae.createFormatGlobals=Ne.n,Ae.evalFormatLocalsGrid=Ne.p,Ae.KnownFormat=Te.d,Ae.CurrencyFormat=Te.b,Ae.DateOrder=Te.c,Ae.NumberShape=Te.e,Ae.Calendar=Te.a,Ae.getKnownFormat=Re.h,Ae.isKnownFormatDefined=Re.j,Ae.englishXLSXKnownFormat=Re.g,Ae.RibbonFormat=Ie.a,Ae.getRibbonFormat=Ie.b,Ae.shouldInstallFormat=_e.b,Ae.createNumberFormatter=Fe.a,Ae.getValueEditOperKind=we.c,Ae.applyValueEdit=we.a,Ae.toXLNumber=we.f;var Me,De,Pe,xe=r(28),Le=r(97),Be=r(121),Ue=r(62);function Ge(e,t,r,n){var a=Object(de.a)(Object(le.b)(e)).parseFormula(Object(le.d)(h.a.Cell,n.range),r);if(Object(b.d)(a)){var i=a.value;if(!(t<0||t>=r.length))return{formula:i,subexpression:Object(j.i)(i,t)}}}function Ve(e){return e.formula.spans[e.subexpression.label]}function He(e,t,r){var n=t.formula;return function(e,t,r,n){if((t.kind===p.e.App||t.kind===p.e.Let)&&Object(j.db)(t.head)&&t.head.id===m.b.LET){for(var a=[],i=r.spans[t.label],o=0;o<t.args.length-1;o+=2){var u=0===o?r.spans[t.head.label]:r.spans[t.args[o].label],s=r.spans[t.args[o+1].label];if(i&&u&&s){var l=n.indexOf(e.listSeparator,s.end);l>=0?l+=1:(l=n.indexOf(")",s.end))<0&&(l=s.end);var d=Object(p.K)(0===o?u.end+1:u.start,l,"","");a.push(d)}}return a}if(t.kind===p.e.Name||t.kind===p.e.CellRef&&void 0===t.qualifier&&t.ref.kind===p.c.Bad)return function e(t,r,n,a){switch(r.kind){case p.e.App:case p.e.Let:case p.e.Lambda:if(Object(j.db)(r.head)&&r.head.id===m.b.LET)for(var i=0;i<r.args.length;i+=1)if(i%2==0&&i<r.args.length-1){var o=r.args[i],u=r.args[i+1];if(o.kind===p.e.Name&&a.kind===p.e.Name&&0===t.stringCompareCI(o.whole,a.whole)||o.kind===p.e.CellRef&&a.kind===p.e.CellRef&&void 0===o.qualifier&&void 0===a.qualifier&&o.ref.kind===p.c.Bad&&a.ref.kind===p.c.Bad&&0===t.stringCompareCI(o.ref.chars,a.ref.chars)){var s=[],l=n.spans[o.label],d=n.spans[u.label],f=n.spans[a.label];if(f&&l&&d&&l.start===f.start&&l.end===f.end)return s.push(Object(p.K)(l.start,d.end,"","")),s}}else{if((s=e(t,r.args[i],n,a)).length>0)return s}else for(i=0;i<r.args.length;i+=1){if((s=e(t,r.args[i],n,a)).length>0)return s}return[];case p.e.Array:for(i=0;i<r.nodes.length;i+=1)for(var b=0;b<r.nodes[i].length;b+=1){if((s=e(t,r.nodes[i][b],n,a)).length>0)return s}return[];case p.e.Paren:return e(t,r.node,n,a);case p.e.Bad:case p.e.CellRef:case p.e.FieldRef:case p.e.Literal:case p.e.Name:case p.e.Param:case p.e.StructRef:return[];default:return Object(c.e)("calc.runtime.addLETNameSubspans",r)}}(e,r.node,r,t);return[]}(e,t.subexpression,n,r)}function We(e,t,r,n){var a=r;a.startsWith("=")||(a="="+r);var i=Object(de.a)(Object(le.b)(e)),o=i.parseFormula(Object(le.d)(h.a.Cell,n.range),t),c=i.parseFormula(Object(le.d)(h.a.Cell,n.range),a);if(Object(b.d)(o)&&Object(b.d)(c))return{formula:o.value,subexpression:c.value.node}}function ze(e,t,r,n){var a=qe(e.localeInfo,t.formula,t.formula.node,r,t.subexpression),i=Object(y.j)(Object(y.s)()),o=t.formula,c=o.spans,u=o.annotations,s=o.depthUpperBound,l=Object(A.b)(Object(N.a)(i)).printFormula(Object(N.b)(Object(h.i)(h.a.Cell,n),n,i),Object(p.I)(a,c,u,s));return Object(b.d)(l)?l.value:""}function qe(e,t,r,n,a){switch(r.kind){case p.e.Let:return function(e,t,r,n,a){for(var i=[],o=0;o<r.args.length;o+=1){var c=t.spans[r.args[o].label];if(c&&n.start>=c.start&&n.end<=c.end){var u=r.args[o];if((n.start>c.start||n.end<c.end)&&(u=qe(e,t,r.args[o],n,a)),o===r.args.length-1&&r.args.length%2==1)i.push(u);else if(o%2==1){if(1===o)return u;i.pop(),i.push(u)}else i.push(u),i.push(r.args[o+1]),i.push(u);return Object(p.l)(r.head,i,!0,r.label)}i.push(r.args[o])}return a}(e,t,r,n,a);case p.e.App:case p.e.Lambda:for(var i=0;i<r.args.length;i+=1){var o=t.spans[r.args[i].label];if(o&&n.start>=o.start&&n.end<=o.end)return qe(e,t,r.args[i],n,a)}return a;case p.e.Array:for(i=0;i<r.nodes.length;i+=1)for(var u=0;u<r.nodes[i].length;u+=1){var s=t.spans[r.nodes[i][u].label];if(s&&n.start>=s.start&&n.end<=s.end)return qe(e,t,r.nodes[i][u],n,a)}return a;case p.e.Paren:var l=t.spans[r.node.label];return l&&n.start>=l.start&&n.end<=l.end?qe(e,t,r.node,n,a):a;case p.e.Bad:case p.e.CellRef:case p.e.FieldRef:case p.e.Literal:case p.e.Name:case p.e.Param:case p.e.StructRef:return a;default:return Object(c.e)("calc.runtime.makeSubstitutions",r)}}function Ke(e,t){var r=[];for(r.push(t.subexpression);r.length>0;){var n=r.pop();if(void 0!==n)switch(n.kind){case p.e.App:case p.e.Let:case p.e.Lambda:if(Object(j.db)(n.head)&&0!=(Object(m.e)(n.head.id).staticPrecs&(I.d.Time|I.d.Calc)))return!0;n.args.forEach((function(e){r.push(e)}));break;case p.e.Array:n.nodes.map((function(e){return e.map((function(e){r.push(e)}))}));break;case p.e.FieldRef:r.push(n.lhs);break;case p.e.Paren:r.push(n.node);break;case p.e.Bad:case p.e.CellRef:case p.e.StructRef:case p.e.Literal:case p.e.Name:case p.e.Param:case p.e.Operator:break;default:Object(c.e)("calc.runtime.isVolatile",n)}}return!1}(Pe=Me||(Me={})).ReasonKind=xe.d,Pe.interval=xe.p,Pe.CellKind=xe.a,Pe.Interrupt=xe.b,Pe.finalValue=xe.m,Pe.pendingValue=xe.t,Pe.cellWellFormedFormula=xe.g,Pe.cellFormula=xe.f,Pe.userDefinedFunc=xe.x,Pe.stopped=xe.w,Pe.nameCycle=xe.r,Pe.cellCycle=xe.e,Pe.paused=xe.s,Pe.previousFailure=xe.u,Pe.previousNameFailure=xe.v,Pe.evalGlobals=xe.k,Pe.evalLocals=xe.l,Pe.compileLocalsGrid=xe.h,Pe.compileLocalsName=xe.i,Pe.getEvalFailureReason=xe.n,Pe.illFormedFormula=xe.o,Pe.createCompileGlobals=xe.j,Pe.limitExceeded=xe.q,Pe.LimitKind=xe.c,Pe.createCompiler=Le.b,Pe.createEvaluator=Be.a,(De=Pe.extension||(Pe.extension={})).DerefOperKind=Ue.a,De.machine=Ue.c,Pe.getSubExpressionFromFormulaCharacterIndex=Ge,Pe.getSubExpressionSpan=Ve,Pe.getFormulaSubExpressionObject=We,Pe.getSubstitutedSubExpressionString=ze,Pe.getSubExpressionSubspans=He,Pe.isFormulaSubExpressionVolatile=Ke;var Ye=r(31),Je=r(55),Qe=r(25),Xe=r(84),Ze=r(67),$e=r(58),et=r(14),tt=r(118);function rt(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];var n=t[0],a=t[1];return Object(fe.__awaiter)(this,void 0,void 0,(function(){function t(e){void 0===e&&(e="Requested"),v=e,b.close()}var r,i,s,l,d,b,h,v,p,m,g,O,j,y,C=this;return Object(fe.__generator)(this,(function(k){switch(k.label){case 0:return r="boolean"==typeof n?n?[(new $e.c).instance(),(new $e.b).instance()]:[void 0,void 0]:[n,a],i=r[0],s=r[1],l=-1/0,d={onRecalcResults:function(e){},onUpdateRequest:function(e){},onGC:function(e){l=e}},[4,Je.createWorker({id:"RecalcService",createMode:e},{local:Xe.c,thread:{scriptUrl:Object(S.b)(),insideInitName:"excelOnlineCalc.calc.recalcServiceInsideInit"}},(function(){return d}))];case 1:b=k.sent(),h=[],v="Requested",b.onClose=function(){for(var e=0,t=h;e<t.length;e++){var r=t[e];try{r()}catch(e){c.i.ULS.traceTag(539341771,Qe.LogCategory.msoulscat_ES_EWAJS,Qe.TraceLevel.Warning,"calc.calc.createRecalcService.service.onClose: callback threw ".concat(Object(u.c)(e)))}}var n="calc.calc.createRecalcService.service.onClose: recalc service closed; reason = ".concat(v);c.i.ULS.traceTag(561534148,Qe.LogCategory.msoulscat_ES_EWAJS,"Requested"===v?Qe.TraceLevel.Info:Qe.TraceLevel.Warning,n)},k.label=2;case 2:return k.trys.push([2,5,,6]),"Thread"!==b.createMode?[3,4]:[4,Object(S.f)(b)];case 3:p=k.sent(),h.push((function(){return p.close()})),Object(f.e)(f.a.CalcWebWorkerTest)&&Object(tt.b)(b.call.getMissingJSFeatures),k.label=4;case 4:return b.call.ping.callTimeout=3e4,m=3,g=0,O=function(){},Object(Ze.e)((function(){return Object(fe.__awaiter)(C,void 0,void 0,(function(){var e,r,n,a,i,u,s;return Object(fe.__generator)(this,(function(l){switch(l.label){case 0:return[4,new Promise((function(e){return setTimeout(e,1e3)}))];case 1:if(l.sent(),b.hasBeenClosed())return[2,void 0];e=b.call.ping.callTimeout,r=Object(o.k)(),l.label=2;case 2:return l.trys.push([2,4,,5]),[4,b.call.ping()];case 3:return l.sent(),[3,5];case 4:if(n=l.sent(),!Je.WorkerError.isWorkerError(n)||"Timeout"!==n.info.cause)throw n;return a=Object(o.k)()-r,(g+=1)>=m&&t("Unresponsive"),i=b.hasBeenClosed(),u={timeout:e,waitTime:a,timeoutCount:g,hasBeenClosed:i},s="calc.calc.RecalcService: unresponsive; ".concat(JSON.stringify(u)),c.i.ULS.traceTag(561534149,Qe.LogCategory.msoulscat_ES_EWAJS,Qe.TraceLevel.Warning,s),O(e,a,g,i),[2,!0];case 5:return g=0,[2,!0]}}))}))}),!0).catch((function(e){var t="calc.calc.RecalcService: ping loop threw an error: ".concat(Object(u.c)(e));c.i.ULS.traceTag(561534150,Qe.LogCategory.msoulscat_ES_EWAJS,Qe.TraceLevel.Warning,t)})),b.post.updateRanges.onPostMessageError=Je.dispatchWorkerError,j={setOnRecalcResults:function(e){d.onRecalcResults=e},setOnUpdateRequest:function(e){d.onUpdateRequest=e},setOnUnresponsive:function(e){O=e},setA1ReferenceStyle:function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(e=b.post).setA1ReferenceStyle.apply(e,t),void 0!==i&&i.doNotify(et.a.setA1ReferenceStyle,t)},setLocale:function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(e=b.post).setLocale.apply(e,t),void 0!==i&&i.doNotify(et.a.setLocale,t)},setWorkbookProps:function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(e=b.post).setWorkbookProps.apply(e,t),void 0!==i&&i.doNotify(et.a.setWorkbookProps,t)},updateSheetNames:function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(e=b.post).updateSheetNames.apply(e,t),void 0!==i&&i.doNotify(et.a.updateSheetNames,t)},updateNamedObjects:function(){for(var e,t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];(e=b.post).updateNamedObjects.apply(e,t),void 0!==i&&i.doNotify(et.a.updateNamedObjects,t)},setNumberFormats:b.post.setNumberFormats,updateUnusedCells:b.post.updateUnusedCells,updateRanges:b.post.updateRanges,updateArrays:b.post.updateArrays,editRangeFormulas:b.post.editRangeFormulas,editRangeFormats:b.post.editRangeFormats,editArrayFormulas:b.post.editArrayFormulas,editRangePaste:b.post.editRangePaste,resumeRecalc:b.post.resumeRecalc,reconfigure:function(e){var t,r;b.call.ping.callTimeout=null!==(t=e.responsivenessPingTimeout)&&void 0!==t?t:3e4,m=null!==(r=e.responsivenessPingAttempts)&&void 0!==r?r:3,b.post.reconfigure(e)},clearCache:function(){b.post.clearCache(),l=-1/0},testAdvanceState:b.post.testAdvanceState,testResumeRecalc:b.call.testResumeRecalc,close:t,stateIdAvailable:function(e){return e>=l},evalFormulaRange:b.call.evalFormulaRange,evalOnClonedModel:b.call.evalOnClonedModel,createIGridExportEndpoint:function(e,t){return h.push(t),b.call.createIGridExportEndpoint.transfer([e.port],e)}},void 0!==s&&s.onGridExporterCreated(j),[2,j];case 5:throw y=k.sent(),t("Error"),y;case 6:return[2]}}))}))}var nt,at,it,ot=r(47),ct=r(45),ut=r(16),st=r(59),lt=r(40),dt=r(26),ft=r(63),bt=r(88),ht=r(38),vt=r(32),pt=r(24),mt=r(100),gt=r(75),Ot=r(122),jt=r(87);(it=nt||(nt={})).worksheetFunctionName=Ye.nb,it.errorTypeName=Ye.r,it.localeData=Ye.G,it.numberFormat=Ye.Q,it.sheetName=Ye.fb,it.blankValue=Ye.j,it.errorValue=Ye.s,it.richValue=Ye.cb,it.getCellValueKind=Ye.D,it.getCellFormatKind=Ye.C,it.cellLocation=Ye.o,it.rangeLocation=Ye.V,it.sheetRangeLocation=Ye.gb,it.sheetCellLocation=Ye.eb,it.cellData=Ye.k,it.cellFormulaCellData=Ye.m,it.arrayFormulaCellData=Ye.e,it.valueCellData=Ye.kb,it.rangeUpdate=Ye.Y,it.rangeWrite=Ye.Z,it.rangePromote=Ye.X,it.arrayData=Ye.c,it.arrayUpdate=Ye.h,it.arrayWrite=Ye.i,it.arrayPromote=Ye.g,it.unusedCellsUpdate=Ye.ib,it.namedValueData=Ye.P,it.namedFormulaData=Ye.I,it.namedRangeData=Ye.N,it.namedFailureData=Ye.H,it.namedObject=Ye.J,it.namedObjectsUpdate=Ye.L,it.namedObjectsWrite=Ye.M,it.undefinedNamesWrite=Ye.hb,it.namedObjectsPromote=Ye.K,it.namedTableData=Ye.O,it.columnData=Ye.p,it.rangeFormulaEdit=Ye.U,it.cellFormulaRangeFormulaEdit=Ye.n,it.valueRangeFormulaEdit=Ye.lb,it.inferredRangeFormulaEdit=Ye.F,it.RibbonFormat=Ye.b,it.formatEditOperation=Ye.z,it.formatEditSetFormat=Ye.B,it.formatEditRibbonFormat=Ye.A,it.formatEditChangeDecimals=Ye.y,it.rangeFormatEdit=Ye.T,it.arrayFormulaEdit=Ye.f,it.rangePasteEdit=Ye.W,it.copyPasteRangePasteEdit=Ye.q,it.inferredFormat=Ye.E,it.cellDataDelta=Ye.l,it.rangeDelta=Ye.R,it.arrayDelta=Ye.d,it.rangeFailure=Ye.S,it.recalcResults=Ye.ab,it.evalFormulaData=Ye.t,it.evalFormulaFormat=Ye.u,it.evalFormulaFormatOrigin=Ye.x,it.evalFormulaFormatIformat=Ye.v,it.evalFormulaFormatInferred=Ye.w,it.updateRequest=Ye.jb,it.runExperiment=Ye.db,it.recalcServiceConfig=Ye.bb,it.workbookProps=Ye.mb,it.createRecalcService=rt,it.RecalcServiceCreateMode=Ye.a,it.localeInfoFromData=ot.g,it.cellValueToReadOper=ot.c,it.readOperToCellValue=ot.j,it.recalcServiceInsideInit=Xe.c,it.getEvalResultKind=ct.d,it.getEvalFailureReason=ct.c,it.getTime=ct.e,it.RecalcServiceDataTransformer=jt.a,(at=it.internal||(it.internal={})).PartialWorkbookDocumentCollection=st.a,at.VolatileMode=st.b,at.voidCallback=st.c,at.sheetCellSet=ut.l,at.createSheetCellSetFromRange=ut.h,at.ComputedCellKind=ut.b,at.ComputeKind=ut.a,at.SpecialStyle=ut.g,at.SpecialFormat=ut.f,at.UnavailableKind=lt.d,at.CloningTarget=lt.a,at.PartialWorkbook=lt.c,at.createCellSetFromRange=dt.f,at.bspFactory=dt.d,at.makeGridRangeTable=gt.a,at.namedFormula=ft.g,at.namedTable=ft.i,at.empty=vt.d,at.dense=vt.c,at.union=vt.j,at.unionProduct=pt.j,at.meetsProduct=pt.h,at.exceptProduct=pt.d,at.blankStyleValue=mt.b,at.UnitExperiment=Ot.a,at.ExperimentKind=bt.a,at.registerExperimentFactory=bt.c,at.incrementFailure=Xe.b,at.arrayChecker=ht.a,at.chBoolean=ht.d,at.check=ht.x,at.chFiniteNumber=ht.h,at.chPossiblyInfiniteNumber=ht.n,at.objectChecker=ht.B,at.oneOfChecker=ht.C,at.optChecker=ht.D;var yt,St=r(120);(yt||(yt={})).getWorksheetFunc=St.a;var Ct,kt,Et,At,Nt=r(73);function Tt(){}function Rt(){return Promise.resolve()}(kt=Ct||(Ct={})).FontUnderline=Nt.c,kt.FontVerticalAlignment=Nt.d,kt.FillKind=Nt.b,kt.PatternType=Nt.f,kt.BorderLineType=Nt.a,kt.HorizontalAlignment=Nt.e,kt.VerticalAlignment=Nt.g,(At=Et||(Et={})).runSmokeTest=Rt,At.cancelSmokeTest=Tt;var It=r(117),_t=r(85),Ft=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t]};function wt(){return function(e){return function(e){for(var t=function(e){this.obj=e},r=function(e){t.prototype[e]=function(){for(var t,r=[],n=0;n<arguments.length;n++)r[n]=arguments[n];var a=(t=this.obj)[e].apply(t,r);return Promise.resolve(a)}},n=0,a=e;n<a.length;n++){r(a[n])}return t}(e)}}function Mt(e,t){return new(wt()(t))(e)}var Dt=r(69);function Pt(e){if("object"==typeof e)switch(e.kind){case"Blank":return"";case"Error":return Object(y.s)().errorNames[e.type];case"Rich":return"rich value formulaBarText"}return e.toString()}var xt=function(e){function t(t){var r=this,n=(new(function(e){function t(){var t=e.call(this,Ft,Ft,Ft)||this;return t.interval=void 0,t.calcGrid=t,t}return Object(fe.__extends)(t,e),Object.defineProperty(t.prototype,"calcConfig",{get:function(){return this.calcGrid.dataModel.docs.config},enumerable:!1,configurable:!0}),t.prototype.runTasks=function(){for(;!this.calcGrid.dataModel.step().queueEmpty;);},t.prototype.startRecalc=function(e){void 0===e&&(e=5),this.stopRecalc(),this.interval=setInterval(this.runTasks.bind(this),e)},t.prototype.stopRecalc=function(){void 0!==this.interval&&clearInterval(this.interval),this.interval=void 0},t}(Xe.a))).calcGrid,a=Object($e.f)(t).createRecalcSideGrid(n);return(r=e.call(this,a)||this).calcGrid=n,r.document=n.document,r}return Object(fe.__extends)(t,e),Object.defineProperty(t.prototype,"calcConfig",{get:function(){return this.calcGrid.dataModel.docs.config},enumerable:!1,configurable:!0}),t.prototype.setSheet=function(e,t,r){var n=h.d(void 0,""),a=h.s(n,e);this.calcGrid.updateSheetNames(0,[Object(Ye.fb)(a.index,t)]);for(var i=[],o=0;o<r.length;o+=1){var c=r[o];if(void 0!==c)for(var u=0;u<c.length;u+=1){var s=c[u];if(void 0!==s){var l=Object(Ye.gb)(a.index,o,u),d=Pt(s);d.startsWith("=")?i.push(Object(Ye.Z)(l,Object(Ye.m)(d,s,0))):i.push(Object(Ye.Z)(l,Object(Ye.kb)(d,s,0)))}}}this.calcGrid.updateRanges(0,Object(fe.__spreadArray)([Object(Ye.Z)(Object(Ye.gb)(a.index,0,0))],i,!0)),this.runTasks()},t.prototype.setNamedObjects=function(e){this.calcGrid.updateNamedObjects(0,e),this.runTasks()},t.prototype.runTasks=function(){for(;;){if(this.calcGrid.dataModel.step().queueEmpty)break}},t}(wt()(["getRangeFormats","getRangeFormulae","getRangeValues","getSheetNames","getIntersectingTables","getIformats","discardSnapshot","getHiddenRows","getHiddenCols"]));function Lt(e){var t=new xt(e),r=Object(Dt.e)(t,(function(){return t.calcGrid.resumeRecalc()}));return r.setSheet=t.setSheet.bind(t),r.setNamedObjects=t.setNamedObjects.bind(t),r.document=t.document,Object.defineProperty(r,"calcConfig",{get:function(){return t.calcConfig}}),r}function Bt(e){return{getGrid:function(){return e}}}function Ut(e){return{createIGridExportEndpoint:function(t){return Object(fe.__awaiter)(this,void 0,void 0,(function(){return Object(fe.__generator)(this,(function(r){switch(r.label){case 0:return[4,Je.Endpoint.createInside(t,(function(){return e}))];case 1:return r.sent(),[2]}}))}))}}}var Gt=r(91),Vt=(function(){function e(e){var t=this;this.nowTimes=e,this.setImmediateCalls=[],this.setTimeoutCalls=[],this.clearImmediateCalls=[],this.clearTimeoutCalls=[],this.setImmediate=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];if(void 0!==t.handle)throw"setImmediate called, even though we already have a callback";return t.setImmediateCalls.push(e),t.handle=setImmediate((function(){var r;return t.handle=void 0,e[0].apply(e,null!==(r=e[1])&&void 0!==r?r:[])}))},this.clearImmediate=function(e){if(t.handle!==e)throw"clearImmediate called with a different handle than the one supplied";clearImmediate(t.handle),t.clearImmediateCalls.push([e]),t.handle=void 0},this.setTimeout=function(){for(var e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];if(void 0!==t.handle)throw"setTimeout called, even though we already have a callback";return t.setTimeoutCalls.push(e),t.handle=setImmediate((function(){var r;return t.handle=void 0,e[0].apply(e,null!==(r=e[2])&&void 0!==r?r:[])}))},this.clearTimeout=function(e){if(t.handle!==e)throw"clearTimeout called with a different handle than the one supplied";clearImmediate(t.handle),t.clearTimeoutCalls.push([e]),t.handle=void 0}}e.prototype.now=function(){var e=this.nowTimes.shift();if(void 0===e)throw"now was called too many times";return e}}(),function(){function e(t,r){void 0===t&&(t=1),void 0===r&&(r=0);var n=this;this.precisionMs=t,this.startTime=r,this.setImmediate=function(t){for(var r=[],a=1;a<arguments.length;a++)r[a-1]=arguments[a];var i={delayUntil:-1,callback:t,args:r,isValid:!0};return n.queue.enqueue(i),new e.Immediate(i)},this.clearImmediate=function(t){if(!(t instanceof e.Immediate))throw new TypeError("handle is not a MockFullTimer.Immedate");t.delayedCallback.isValid=!1},this.setTimeout=function(t,r){for(var a=[],i=2;i<arguments.length;i++)a[i-2]=arguments[i];var o=n.time+(r>4?r:4),c={delayUntil:o,callback:t,args:a,isValid:!0};return n.queue.enqueue(c),new e.Timeout(c)},this.clearTimeout=function(t){if(!(t instanceof e.Timeout))throw new TypeError("handle is not a MockFullTimer.Timeout");t.delayedCallback.isValid=!1},this.time=r>0?r:0,this.queue=new Gt.a((function(e,t){return e.delayUntil-t.delayUntil}))}return e.prototype.preciseNow=function(){return this.time},e.prototype.now=function(){return Math.floor(this.time/this.precisionMs)*this.precisionMs},e.prototype.busyWait=function(e){this.time+=e>0?e:0},e.prototype.busyWaitUntil=function(e){this.time=this.time<e?e:this.time},e.prototype.runMacrotasksWhile=function(e){return Object(fe.__awaiter)(this,void 0,void 0,(function(){var t;return Object(fe.__generator)(this,(function(r){switch(r.label){case 0:return[4,new Promise((function(e){return setImmediate((function(){return e()}))}))];case 1:if(r.sent(),!e())return[2];if(!(t=this.queue.pop()))return[2];if(this.busyWaitUntil(t.delayUntil),t.isValid)try{t.callback.apply(t,t.args)}catch(e){dispatchEvent(new ErrorEvent("error",{error:e,message:Object(u.c)(e),filename:"",lineno:0,colno:0}))}return[3,0];case 2:return[2]}}))}))},e.Immediate=function(e){this.delayedCallback=e},e.Timeout=function(e){this.delayedCallback=e},e}()),Ht=r(41),Wt=function(){function e(e){this.config=e,this.tableNameCache={}}return e.prototype.getDocumentLoc=function(e,t){var r,n;return Object(fe.__generator)(this,(function(a){switch(a.label){case 0:return[4,{kind:et.b.GetSheetNames}];case 1:return r=a.sent(),Object(c.h)("calc.x10.GlobalsGeneratorImpl.getDocumentLoc",r.kind===et.b.GetSheetNames),void 0===(n=r.document)||void 0!==e&&e!==n.path||0!==this.config.localeInfo.stringCompareCI(t,n.name)?[2,Object(b.c)(Object(j.kb)(["getDocumentLoc: document"]))]:[2,Object(b.f)(n)]}}))},e.prototype.getSheetIndex=function(e,t){var r,n;return Object(fe.__generator)(this,(function(a){switch(a.label){case 0:return[4,{kind:et.b.GetSheetNames}];case 1:return r=a.sent(),Object(c.h)("calc.x10.GlobalsGeneratorImpl.getSheetIndex",r.kind===et.b.GetSheetNames),Object(j.D)(e,r.document)?(n=r.nameToIndex.getValue(t),[2,Object(b.f)(void 0===n?void 0:r.sheets[n].sheetIndex.index)]):[2,Object(b.c)(Object(j.kb)(["getSheetIndex: document"]))]}}))},e.prototype.getSheetName=function(e,t){var r;return Object(fe.__generator)(this,(function(n){switch(n.label){case 0:return[4,{kind:et.b.GetSheetNames}];case 1:return r=n.sent(),Object(c.h)("calc.x10.GlobalsGeneratorImpl.getSheetName",r.kind===et.b.GetSheetNames),Object(j.D)(e,r.document)?[2,Object(b.f)(r.sheets[r.idToIndex[t]].sheetName)]:[2,Object(b.c)(Object(j.kb)(["getSheetName: document"]))]}}))},e.prototype.getSheetRangeIndexes=function(e){var t,r,n,a,i,u;return Object(fe.__generator)(this,(function(s){switch(s.label){case 0:return[4,{kind:et.b.GetSheetNames}];case 1:return t=s.sent(),Object(c.h)("calc.x10.GlobalsGeneratorImpl.getSheetRangeIndexes",t.kind===et.b.GetSheetNames),Object(j.D)(e.document,t.document)?(r=0,n=t.sheets.length,void 0!==e.index&&(a=t.idToIndex[e.index],i=t.idToIndex[e.index2],r=Object(o.c)(a,i),n=Object(o.b)(a,i)+1),u=t.sheets.slice(r,n).map((function(e){return e.sheetIndex.index})),[2,Object(b.f)(Object(h.u)(u,r))]):[2,Object(b.c)(Object(j.kb)(["getSheetRangeIndexes: document"]))]}}))},e.prototype.getContainingTable=function(e){var t,r;return Object(fe.__generator)(this,(function(n){switch(n.label){case 0:return[4,{kind:et.b.GetContainingTable,cell:e}];case 1:return t=n.sent(),Object(c.h)("calc.x10.GlobalsGeneratorImpl.getContainingTable",t.kind===et.b.GetContainingTable),Object(b.d)(t.result)?void 0===(r=t.result.value)?[2,Object(b.f)(void 0)]:(this.tableNameCache[r.name]=r,[2,Object(b.f)(Object(h.l)(Object(h.e)(e.sheet.document),r.name))]):[2,t.result]}}))},e.prototype.getStructRefColumn=function(e,t){var r,n;return Object(fe.__generator)(this,(function(a){return void 0===(r=this.tableNameCache[e.name])?[2,Object(b.c)(Object(k.i)(k.c.UndefinedTableName))]:void 0===(n="string"==typeof t?r.nameToColumn.getValue(t):r.indexToColumn[t])?[2,Object(b.c)(Object(k.i)(k.c.UndefinedColumnName))]:[2,Object(b.f)(Object(h.w)(n.name,Object(h.r)(r.sheet,Object(h.g)(r.dataRange.row,n.column,r.dataRange.rows,1)),void 0!==r.headersRange,void 0!==r.totalsRange))]}))},e.prototype.getStructRefSpecialRef=function(e,t){var r;return Object(fe.__generator)(this,(function(n){if(void 0===(r=this.tableNameCache[e.name]))return[2,Object(b.c)(Object(k.i)(k.c.UndefinedTableName))];switch(t){case p.i.All:return[2,Object(b.f)(Object(h.r)(r.sheet,r.allRange))];case p.i.Data:return[2,Object(b.f)(Object(h.r)(r.sheet,r.dataRange))];case p.i.Headers:return[2,Object(b.f)(void 0!==r.headersRange?Object(h.r)(r.sheet,r.headersRange):void 0)];case p.i.Totals:return[2,Object(b.f)(void 0!==r.totalsRange?Object(h.r)(r.sheet,r.totalsRange):void 0)];default:return[2,Object(c.e)("calc.x10.GlobalsGeneratorImpl.getStructRefSpecialRef",t)]}return[2]}))},e.prototype.getIntersectingTables=function(e){var t;return Object(fe.__generator)(this,(function(r){switch(r.label){case 0:return[4,{kind:et.b.GetIntersectingTables,range:e}];case 1:return t=r.sent(),Object(c.h)("calc.x10.GlobalsGeneratorImpl.getIntersectingTables",t.kind===et.b.GetIntersectingTables),Object(b.d)(t.result)?[2,Object(b.f)(t.result.value.map((function(t){return Object(h.l)(Object(h.e)(e.sheet.document),t.name)})))]:[2,t.result]}}))},e.prototype.getCellValue=function(e){var t;return Object(fe.__generator)(this,(function(r){switch(r.label){case 0:return[4,{kind:et.b.GetCell,cell:e}];case 1:return t=r.sent(),Object(c.h)("calc.x10.GlobalsGeneratorImpl.getCellValue",t.kind===et.b.GetCell),Object(b.d)(t.result)?[2,Object(b.f)(Object(xe.m)(t.result.value.value))]:[2,t.result]}}))},e.prototype.getCellFormula=function(e){var t,r,n,a;return Object(fe.__generator)(this,(function(i){switch(i.label){case 0:return[4,{kind:et.b.GetCell,cell:e}];case 1:return t=i.sent(),Object(c.h)("calc.x10.GlobalsGeneratorImpl.getCellFormula",t.kind===et.b.GetCell),Object(b.d)(t.result)?(r=t.result.value.formula).kind!==Dt.a.CellFormula?[2,b.g]:(n=r,[4,{kind:et.b.ParseCellFormula,cell:e,formula:n,useEnglishLocaleInfo:!1}]):[2,t.result];case 2:return a=i.sent(),Object(c.h)("calc.x10.GlobalsGeneratorImpl.getCellFormula",a.kind===et.b.ParseCellFormula),Object(b.d)(a.result)?[2,Object(b.f)(Object(xe.g)(Object(h.h)(e),a.result.value))]:[2,Object(b.c)(Object(j.kb)(["getCellFormula: parse/analyze failure"]))]}}))},e.prototype.getHiddenRows=function(e,t,r){var n;return Object(fe.__generator)(this,(function(a){switch(a.label){case 0:return[4,{kind:et.b.GetHiddenRows,sheet:e,start:t,endExclusive:r}];case 1:return n=a.sent(),Object(c.h)("calc.x10.GlobalsGeneratorImpl.getHiddenRows",n.kind===et.b.GetHiddenRows),[2,n.result]}}))},e.prototype.getHiddenCols=function(e,t,r){var n;return Object(fe.__generator)(this,(function(a){switch(a.label){case 0:return[4,{kind:et.b.GetHiddenCols,sheet:e,start:t,endExclusive:r}];case 1:return n=a.sent(),Object(c.h)("calc.x10.GlobalsGeneratorImpl.getHiddenCols",n.kind===et.b.GetHiddenCols),[2,n.result]}}))},e.prototype.getCellFormat=function(e){var t,r,n;return Object(fe.__generator)(this,(function(a){switch(a.label){case 0:return[4,{kind:et.b.GetCell,cell:e}];case 1:return t=a.sent(),Object(c.h)("calc.x10.GlobalsGeneratorImpl.getCellFormat",t.kind===et.b.GetCell),Object(b.d)(t.result)?"number"==typeof(r=t.result.value.format)?[2,Object(b.f)(r)]:[4,{kind:et.b.ParseNumberFormat,formatString:r,builtIn:!1}]:[2,t.result];case 2:return n=a.sent(),Object(c.h)("calc.x10.GlobalsGeneratorImpl.getCellFormat",n.kind===et.b.ParseNumberFormat),Object(b.d)(n.result)?[2,Object(b.f)(n.result.value)]:[2,Object(b.c)(Object(j.kb)(["getCellFormat: parse format failure"]))]}}))},e.prototype.getIformat=function(e,t){var r,n,a,i,o;return Object(fe.__generator)(this,(function(u){switch(u.label){case 0:return[4,{kind:et.b.GetIformat,document:e,iformat:t}];case 1:return r=u.sent(),Object(c.h)("calc.x10.GlobalsGeneratorImpl.getIformat",r.kind===et.b.GetIformat),Object(b.d)(r.result)?(n=r.result.value,a=n.formatString,i=n.builtIn,[4,{kind:et.b.ParseNumberFormat,formatString:a,builtIn:i}]):[2,r.result];case 2:return o=u.sent(),Object(c.h)("calc.x10.GlobalsGeneratorImpl.getIformat",o.kind===et.b.ParseNumberFormat),Object(b.d)(o.result)?[2,Object(b.f)(o.result.value)]:[2,Object(b.c)(Object(j.kb)(["getIformat: parse format failure"]))]}}))},e.prototype.getMergeCell=function(e){return Object(fe.__generator)(this,(function(e){return[2,b.g]}))},e.prototype.getCellStyle=function(e){return Object(fe.__generator)(this,(function(e){return[2,Object(b.f)(mt.b)]}))},e}();function zt(){var e;return Object(fe.__generator)(this,(function(t){switch(t.label){case 0:return[4,{kind:et.b.GetConfig}];case 1:return e=t.sent(),Object(c.h)("calc.x10.GetConfig",e.kind===et.b.GetConfig),[2,new Wt(e.config)]}}))}var qt=new ct.a((function(){var e;return(e={})[m.b.ABS]="=ABS(2)",e[m.b.CUBEMEMBERPROPERTY]='=CUBEMEMBERPROPERTY("'.concat(FormulaAuthoringStrings.Sales,'","[').concat(FormulaAuthoringStrings.Time,"].[").concat(FormulaAuthoringStrings.Fiscal,'].[2014]",$A$3)'),e[m.b.CUBERANKEDMEMBER]='=CUBERANKEDMEMBER("'.concat(FormulaAuthoringStrings.Sales,'",$D$4,1,"').concat(FormulaAuthoringStrings.TopMonth,'")'),e[m.b.BINOM_DIST_RANGE]="=BINOM.DIST.RANGE(60,0.75,48)",e[m.b.NETWORKDAYS_INTL]="=NETWORKDAYS.INTL(DATE(2006,1,1),DATE(2006,1,31))",e[m.b.AVERAGE_WEIGHTED]="=AVERAGE.WEIGHTED(A1:A10, B1:B10, 5, 0.5)",e[m.b.GAMMALN_PRECISE]="=GAMMALN.PRECISE(4)",e[m.b.CONFIDENCE_NORM]="=CONFIDENCE.NORM(0.05,2.5,50)",e[m.b.CEILING_PRECISE]="=CEILING.PRECISE(4.3)",e[m.b.FORECAST_LINEAR]="=FORECAST.LINEAR(30,A2:A6,B2:B6)",e[m.b.PERCENTRANK_EXC]="=PERCENTRANK.EXC(A2:A11,2)",e[m.b.PERCENTRANK_INC]="=PERCENTRANK.INC(A2:A11,2)",e[m.b.PERCENTILE_EXC]="=PERCENTILE.EXC(B2:B10,0.25)",e[m.b.PERCENTILE_INC]="=PERCENTILE.INC(A2:A5,0.3)",e[m.b.CUBEKPIMEMBER]='=CUBEKPIMEMBER("'.concat(FormulaAuthoringStrings.Sales,'","').concat(FormulaAuthoringStrings.MySalesKPI,'",1)'),e[m.b.CHISQ_DIST_RT]="=CHISQ.DIST.RT(18.307,10)",e[m.b.FLOOR_PRECISE]="=FLOOR.PRECISE(-3.2,-1)",e[m.b.NEGBINOM_DIST]="=NEGBINOM.DIST(10,5,0.25,TRUE)",e[m.b.GETPIVOTDATA]='=GETPIVOTDATA("'.concat(FormulaAuthoringStrings.Sales,'", $A$3, "').concat(FormulaAuthoringStrings.Region,'", "').concat(FormulaAuthoringStrings.South,'")'),e[m.b.CUBESETCOUNT]="=CUBESETCOUNT(A3)",e[m.b.ERFC_PRECISE]="=ERFC.PRECISE(1)",e[m.b.CHISQ_INV_RT]="=CHISQ.INV.RT(0.3, 2)",e[m.b.CONFIDENCE_T]="=CONFIDENCE.T(0.05,1,50)",e[m.b.CEILING_MATH]="=CEILING.MATH(24.3,5)",e[m.b.HYPGEOM_DIST]="=HYPGEOM.DIST(1,4,8,20,TRUE)",e[m.b.LOGNORM_DIST]="=LOGNORM.DIST(4,3.5,1.2,TRUE)",e[m.b.NEGBINOMDIST]="=NEGBINOMDIST(10,5,0.25)",e[m.b.PERMUTATIONA]="=PERMUTATIONA(3,2)",e[m.b.POISSON_DIST]="=POISSON.DIST(1, 2, TRUE)",e[m.b.WEIBULL_DIST]="=WEIBULL.DIST(105,20,100,TRUE)",e[m.b.COVARIANCE_P]="=COVARIANCE.P(A2:A6, B2:B6)",e[m.b.COVARIANCE_S]="=COVARIANCE.S(A3:A5,B3:B5)",e[m.b.QUARTILE_EXC]="=QUARTILE.EXC(A2:A12,1)",e[m.b.QUARTILE_INC]="=QUARTILE.INC(A2:A9,1)",e[m.b.ECMA_CEILING]="=ECMA.CEILING(1.5, 0.1)",e[m.b.WORKDAY_INTL]="=WORKDAY.INTL(DATE(2012,1,1),30,0)",e[m.b.STOCKHISTORY]="=STOCKHISTORY(MSFT,1-1-2020)",e[m.b.ERF_PRECISE]="=ERF.PRECISE(0.745)",e[m.b.NUMBERVALUE]="=NUMBERVALUE(0.035)",e[m.b.REGISTER_ID]='=REGISTER.ID(Kernel32, "GetTickCount", "J!")',e[m.b.HYPGEOMDIST]="=HYPGEOMDIST(1,4,8,20)",e[m.b.LOGNORMDIST]="=LOGNORMDIST(4,3.5,1.2)",e[m.b.LOGNORM_INV]="=LOGNORM.INV(0.039084, 3.5, 1.2)",e[m.b.NORM_S_DIST]="=NORM.S.DIST(1.33, TRUE)",e[m.b.STANDARDIZE]="=STANDARDIZE(42,40,1.5)",e[m.b.FORMULATEXT]="=FORMULATEXT(A2)",e[m.b.PERCENTRANK]="=PERCENTRANK(A2:A11,2)",e[m.b.CONCATENATE]='=CONCATENATE("'.concat(FormulaAuthoringStrings.Andreas,'", " ", "').concat(FormulaAuthoringStrings.Hauser,'")'),e[m.b.ISO_CEILING]="=ISO.CEILING(4.3)",e[m.b.VALUETOTEXT]='=VALUETOTEXT("'.concat(FormulaAuthoringStrings.SomeText,'")'),e[m.b.ARRAYTOTEXT]="=ARRAYTOTEXT(B1:B3)",e[m.b.AVERAGEIFS]='=AVERAGEIFS(B2:B5, B2:B5, ">70", B2:B5, "<90")',e[m.b.COUNTBLANK]="=COUNTBLANK(A2:B5)",e[m.b.ERROR_TYPE]="=ERROR.TYPE(#NULL!)",e[m.b.CUBEMEMBER]='=CUBEMEMBER("'.concat(FormulaAuthoringStrings.Sales,'",(B4, C6, D5),"').concat(FormulaAuthoringStrings.SalesFor2004,'")'),e[m.b.ISOWEEKNUM]="=ISOWEEKNUM(40977)",e[m.b.SUBSTITUTE]='=SUBSTITUTE("'.concat(FormulaAuthoringStrings.SalesData,'", "').concat(FormulaAuthoringStrings.Sales,'", "').concat(FormulaAuthoringStrings.Cost,'")'),e[m.b.SUMPRODUCT]="=SUMPRODUCT(C2:C5,D2:D5)",e[m.b.WEBSERVICE]="=WEBSERVICE(".concat(FormulaAuthoringStrings.WebServiceLink,")"),e[m.b.BINOM_DIST]="=BINOM.DIST(6,10,0.5,FALSE)",e[m.b.CHISQ_DIST]="=CHISQ.DIST(0.5,1,TRUE)",e[m.b.CONFIDENCE]="=CONFIDENCE(0.05,2.5,50)",e[m.b.EXPON_DIST]="=EXPON.DIST(0.2,10,TRUE)",e[m.b.FLOOR_MATH]="=FLOOR.MATH(24.3,5)",e[m.b.GAMMA_DIST]="=GAMMA.DIST(4.79, 1.234, 7, TRUE)",e[m.b.NORM_S_INV]="=NORM.S.INV(0.908789)",e[m.b.CHISQ_TEST]="=CHISQ.TEST(A2:B4,A6:B8)",e[m.b.PERCENTILE]="=PERCENTILE(E2:E5,0.3)",e[m.b.FIELDVALUE]='=FIELDVALUE(A2, "'.concat(FormulaAuthoringStrings.Price,'")'),e[m.b.AVERAGEIF]='=AVERAGEIF(B2:B5,"<23000")',e[m.b.BITLSHIFT]="=BITLSHIFT(4,2)",e[m.b.BITRSHIFT]="=BITRSHIFT(13,2)",e[m.b.DATEVALUE]="=DATEVALUE(40685)",e[m.b.FILTERXML]='=FILTERXML(B3,"//rc/@title")',e[m.b.CUBEVALUE]='=CUBEVALUE(Sales,"['.concat(FormulaAuthoringStrings.Measures,"].[").concat(FormulaAuthoringStrings.Profit,']","[').concat(FormulaAuthoringStrings.Time,'].[2004]","[').concat(FormulaAuthoringStrings.AllProduct,"].[").concat(FormulaAuthoringStrings.Beverages,']")'),e[m.b.ENCODEURL]='=ENCODEURL("'.concat(FormulaAuthoringStrings.EncodeURLExmapleLink,'")'),e[m.b.HYPERLINK]='=HYPERLINK("'.concat(FormulaAuthoringStrings.HyperlinkExampleLink,'", "').concat(FormulaAuthoringStrings.ClickForReport,'")'),e[m.b.ISLOGICAL]="=ISLOGICAL(TRUE)",e[m.b.ISNONTEXT]="=ISNONTEXT(A2)",e[m.b.ISFORMULA]="=ISFORMULA(A2)",e[m.b.PDURATION]="=PDURATION(2.5%,2000,2200)",e[m.b.TIMEVALUE]="=TIMEVALUE(0.1)",e[m.b.TRANSPOSE]="=TRANSPOSE(A2:F9)",e[m.b.FREQUENCY]="=FREQUENCY(A2:A20, B2:B5)",e[m.b.BETA_DIST]="=BETA.DIST(2,8,10,TRUE,1,3)",e[m.b.BINOMDIST]="=BINOMDIST(6,10,0.5,FALSE)",e[m.b.BINOM_INV]="=BINOM.INV(6,0.5,0.75)",e[m.b.CHISQ_INV]="=CHISQ.INV(0.3, 2)",e[m.b.CRITBINOM]="=CRITBINOM(6,0.5,0.75)",e[m.b.EXPONDIST]="=EXPONDIST(0.2,10,TRUE)",e[m.b.F_DIST_RT]="=F.DIST.RT(15.2069,6,4)",e[m.b.FISHERINV]="=FISHERINV(0.972955)",e[m.b.GAMMADIST]="=GAMMADIST(10.00001131,9,2,FALSE)",e[m.b.GAMMA_INV]="=GAMMA.INV(0.068094,9,2)",e[m.b.NORM_DIST]="=NORM.DIST(1, 0, 1, TRUE)",e[m.b.T_DIST_2T]="=T.DIST.2T(1.959999998,60)",e[m.b.T_DIST_RT]="=T.DIST.RT(1.959999998,60)",e[m.b.INTERCEPT]="=INTERCEPT(A2:A6, B2:B6)",e[m.b.MODE_MULT]="=MODE.MULT(A2:A13)",e[m.b.MODE_SNGL]="=MODE.SNGL(A2:A7)",e[m.b.AGGREGATE]="=AGGREGATE(12, 6, A1:A11, B1:B11)",e[m.b.RANDARRAY]="=RANDARRAY(5,3,1,100)",e[m.b.COUNTIFS]='=COUNTIFS(A2:A7,"<6",A2:A7,">1")',e[m.b.DAVERAGE]='=DAVERAGE(A4:E10, "'.concat(FormulaAuthoringStrings.Yield,'", A1:B2)'),e[m.b.BAHTTEXT]="=BAHTTEXT(1234)",e[m.b.DPRODUCT]='=DPRODUCT(A5:E11, "'.concat(FormulaAuthoringStrings.Yield,'", A1:F3)'),e[m.b.INDIRECT]="=INDIRECT(B&A)",e[m.b.ISNUMBER]="=ISNUMBER(A2)",e[m.b.MINVERSE]="=MINVERSE(A1:D4)",e[m.b.RANK_AVG]="=RANK.AVG(94,B2:B8)",e[m.b.SUBTOTAL]="=SUBTOTAL(9,A2:A5)",e[m.b.BETADIST]="=BETADIST(2,8,10,1,3)",e[m.b.BETA_INV]="=BETA.INV(0.685470581,8,10,1,3)",e[m.b.F_INV_RT]="=F.INV.RT(0.01,6,4)",e[m.b.GAMMAINV]="=GAMMAINV(0.65, 4, 2)",e[m.b.NORMDIST]="=NORMDIST(42,40,1.5,TRUE)",e[m.b.NORM_INV]="=NORM.INV(0.908789,40,1.5)",e[m.b.NORMSINV]="=NORMSINV(0.9088)",e[m.b.SUMX2MY2]="=SUMX2MY2(A3:A9,B3:B9)",e[m.b.SUMX2PY2]="=SUMX2PY2(A3:A9,B3:B9)",e[m.b.FORECAST]="=FORECAST(30,A2:A6,B2:B6)",e[m.b.QUARTILE]="=QUARTILE(A2:A9,1)",e[m.b.TRIMMEAN]="=TRIMMEAN(A2:A12,0.2)",e[m.b.T_INV_2T]="=T.INV.2T(0.546449,60)",e[m.b.AVERAGEA]="=AVERAGEA(A2:A6)",e[m.b.TEXTJOIN]="=TEXTJOIN(, , TRUE, A2:A8)",e[m.b.SEQUENCE]="=SEQUENCE(4,5)",e[m.b.ADDRESS]='=ADDRESS(2,3,1,FALSE,"['.concat(FormulaAuthoringStrings.Book1,"]").concat(FormulaAuthoringStrings.Sheet1,'")'),e[m.b.AVERAGE]="=AVERAGE(A2:A6)",e[m.b.COLUMNS]="=COLUMNS(C1:E4)",e[m.b.COUNTIF]='=COUNTIF(B2:B5,">55")',e[m.b.DAYS360]="=DAYS360(30-Jan-11,1-Feb-11)",e[m.b.DCOUNTA]='=DCOUNTA(A4:E10, "'.concat(FormulaAuthoringStrings.Profit,'", A1:F2)'),e[m.b.DECIMAL]="=DECIMAL(FF,16)",e[m.b.DEGREES]="=DEGREES(PI())",e[m.b.DSTDEVP]='=DSTDEVP(A5:E11, "'.concat(FormulaAuthoringStrings.Yield,'", A1:A3)'),e[m.b.CUBESET]='=CUBESET("'.concat(FormulaAuthoringStrings.Sales,'","[').concat(FormulaAuthoringStrings.Product,"].[").concat(FormulaAuthoringStrings.AllProducts,"].").concat(FormulaAuthoringStrings.Children,'","').concat(FormulaAuthoringStrings.Products,'",1,"[').concat(FormulaAuthoringStrings.Measures,"].[").concat(FormulaAuthoringStrings.SalesAmount,']")'),e[m.b.HLOOKUP]='=HLOOKUP("'.concat(FormulaAuthoringStrings.Axles,'", A1:C4, 2, TRUE)'),e[m.b.IFERROR]='=IFERROR(55/0, "'.concat(FormulaAuthoringStrings.ErrorInCalculation,'")'),e[m.b.ISBLANK]="=ISBLANK(A2)",e[m.b.ISERROR]="=ISERROR(#REF!)",e[m.b.XLOOKUP]='=XLOOKUP("'.concat(FormulaAuthoringStrings.Tom,'",A2:A9,C2:C9,"').concat(FormulaAuthoringStrings.NotFound,'",0,1)'),e[m.b.MDETERM]="=MDETERM(A2:D5)",e[m.b.PRODUCT]="=PRODUCT(A2:A4)",e[m.b.RADIANS]="=RADIANS(270)",e[m.b.RANK_EQ]="=RANK.EQ(7,A2:A6,1)",e[m.b.REPLACE]='=REPLACE(2009,3,2,"10")',e[m.b.STDEV_S]="=STDEV.S(A2:A11)",e[m.b.STDEV_P]="=STDEV.P(A3:A12)",e[m.b.UNICODE]="=UNICODE(B)",e[m.b.UNICHAR]="=UNICHAR(66)",e[m.b.VLOOKUP]="=VLOOKUP(103, A2:B26, 2, FALSE)",e[m.b.WEEKDAY]="=WEEKDAY(39492)",e[m.b.GAMMALN]="=GAMMALN(4)",e[m.b.BETAINV]="=BETAINV(0.685470581,8,10,1,3)",e[m.b.CHIDIST]="=CHIDIST(18.307,10)",e[m.b.COMBINA]="=COMBINA(4,3)",e[m.b.CEILING]="=CEILING(2.5, 1)",e[m.b.NORMINV]="=NORMINV(0.908789,40,1.5)",e[m.b.POISSON]="=POISSON(1, 2, TRUE)",e[m.b.WEIBULL]="=WEIBULL(105,20,100,TRUE)",e[m.b.SUMXMY2]="=SUMXMY2(A3:A9,B3:B9)",e[m.b.CHITEST]="=CHITEST(A2:B4,A6:B8)",e[m.b.PEARSON]="=PEARSON(A3:A7,B3:B7)",e[m.b.GEOMEAN]="=GEOMEAN(A2:A8)",e[m.b.HARMEAN]="=HARMEAN(A2:A8)",e[m.b.STDEVPA]="=STDEVPA(A3:A12)",e[m.b.DATEDIF]='=DATEDIF(1/1/2001,1/1/2003,"Y")',e[m.b.ARABIC]="=ARABIC(LVII)",e[m.b.CHOOSE]='=CHOOSE(3,"'.concat(FormulaAuthoringStrings.Wide,'",115,"').concat(FormulaAuthoringStrings.World,'",8)'),e[m.b.COLUMN]="=COLUMN(C9)",e[m.b.COUNTA]="=COUNTA(B2:B6)",e[m.b.DCOUNT]='=DCOUNT(A5:E11, "'.concat(FormulaAuthoringStrings.Age,'", A1:F2)'),e[m.b.DOLLAR]="=DOLLAR(1.2351, 4)",e[m.b.DSTDEV]='=DSTDEV(A5:E11, "'.concat(FormulaAuthoringStrings.Yield,'", A1:A3)'),e[m.b.GROWTH]="=GROWTH(#VALUE!)",e[m.b.IMCOSH]='=IMCOSH("4+3i")',e[m.b.IMCSCH]='=IMCSCH("4+3i")',e[m.b.IMSECH]='=IMSECH("4+3i")',e[m.b.IMSINH]='=IMSINH("4+3i")',e[m.b.ISTEXT]='=ISTEXT("'.concat(FormulaAuthoringStrings.Region1,'")'),e[m.b.LINEST]="=LINEST(B2:B10, A2:A10, FALSE, TRUE)",e[m.b.LOGEST]="=LOGEST(B2:B10, A2:A10, TRUE, TRUE)",e[m.b.LOOKUP]="=LOOKUP(4.19, A2:A6, B2:B6)",e[m.b.XMATCH]="=XMATCH(F2,C3:C9,1)",e[m.b.MEDIAN]="=MEDIAN(A2:A6)",e[m.b.MINUTE]="=MINUTE(0.53125)",e[m.b.OFFSET]="=OFFSET(D3,3,-2,1,1)",e[m.b.PROPER]='=PROPER("'.concat(FormulaAuthoringStrings.ThisIsATITLE,'")'),e[m.b.SEARCH]='=SEARCH("'.concat(FormulaAuthoringStrings.E,'","').concat(FormulaAuthoringStrings.Statements,'",6)'),e[m.b.SECOND]="=SECOND(0.700208333333333)",e[m.b.SHEETS]="=SHEETS(".concat(FormulaAuthoringStrings.My3DRef,")"),e[m.b.STDEVP]="=STDEVP(A3:A12)",e[m.b.SUMIFS]='=SUMIFS(A2:A9, B2:B9, "<>'.concat(FormulaAuthoringStrings.Bananas,'", C2:C9, "').concat(FormulaAuthoringStrings.Tom,'")'),e[m.b.AVEDEV]="=AVEDEV(A2:A8)",e[m.b.CHIINV]="=CHIINV(0.3, 2)",e[m.b.COMBIN]="=COMBIN(8,2)",e[m.b.F_DIST]="=F.DIST(15.2069,6,4,TRUE)",e[m.b.FISHER]="=FISHER(0.75)",e[m.b.LOGINV]="=LOGINV(0.039084, 3.5, 1.2)",e[m.b.PERMUT]="=PERMUT(100,3)",e[m.b.T_DIST]="=T.DIST(60,1,TRUE)",e[m.b.CORREL]="=CORREL(A2:A6, B2:B6)",e[m.b.F_TEST]="=F.TEST(A2:A6,B2:B6)",e[m.b.T_TEST]="=T.TEST(A2:A10,B2:B10,2,1)",e[m.b.SKEW_P]="=SKEW.P(A2:A11)",e[m.b.Z_TEST]="=Z.TEST(A2:A11,4)",e[m.b.STDEVA]="=STDEVA(A3:A12)",e[m.b.MAXIFS]='=MAXIFS(A2:A7,B2:B7,"'.concat(FormulaAuthoringStrings.IfsB,'",D2:D7,">100")'),e[m.b.MINIFS]='=MINIFS(A2:A7,B2:B7,"'.concat(FormulaAuthoringStrings.IfsB,'",D2:D7,">100")'),e[m.b.CONCAT]='=CONCAT("'.concat(FormulaAuthoringStrings.Andreas,'"," ", "').concat(FormulaAuthoringStrings.Hauser,'")'),e[m.b.SWITCH]='=SWITCH(WEEKDAY(10/10/2016),1,"'.concat(FormulaAuthoringStrings.Sunday,'",2,"').concat(FormulaAuthoringStrings.Monday,'",3,"').concat(FormulaAuthoringStrings.Tuesday,'","').concat(FormulaAuthoringStrings.NoMatch,'")'),e[m.b.FILTER]='=FILTER(A5:D20,(C5:C20="'.concat(FormulaAuthoringStrings.Apple,'")*(A5:A20="').concat(FormulaAuthoringStrings.East,'"),"")'),e[m.b.UNIQUE]="=UNIQUE(A2:A12)",e[m.b.SORTBY]="=SORTBY(D2:D9,E2:E9,1)",e[m.b.BITAND]="=BITAND(1,5)",e[m.b.BITXOR]="=BITXOR(5,3)",e[m.b.ACOSH]="=ACOSH(10)",e[m.b.ACOTH]="=ACOTH(6)",e[m.b.ATANH]="=ATANH(-0.1)",e[m.b.ATAN2]="=ATAN2(4,0)",e[m.b.CLEAN]="=CLEAN(A2)",e[m.b.COUNT]="=COUNT(A2:A7)",e[m.b.DVARP]='=DVARP(A4:E10, "'.concat(FormulaAuthoringStrings.Yield,'", A1:A3)'),e[m.b.EXACT]='=EXACT("'.concat(FormulaAuthoringStrings.Hello,'", "').concat(FormulaAuthoringStrings.Goodbye,'")'),e[m.b.FALSE]="=FALSE()",e[m.b.FIXED]="=FIXED(-1234.567, -1, TRUE)",e[m.b.IMCOT]='=IMCOT("4+3i")',e[m.b.IMCSC]='=IMCSC("4+3i")',e[m.b.IMSEC]='=IMSEC("4+3i")',e[m.b.IMTAN]='=IMTAN("4+3i")',e[m.b.INDEX]="=INDEX(A2:B3,2,1)",e[m.b.ISERR]="=ISERR(#N/A)",e[m.b.ISREF]="=ISREF(A2)",e[m.b.LOWER]='=LOWER("'.concat(FormulaAuthoringStrings.EECummings,'")'),e[m.b.MATCH]="=MATCH(39,B2:B5,1)",e[m.b.MMULT]="=MMULT(A1:B3, C1:F2)",e[m.b.MONTH]="=MONTH(40648)",e[m.b.RIGHT]='=RIGHT("'.concat(FormulaAuthoringStrings.SalePrice,'",5)'),e[m.b.ROUND]="=ROUND(2.149, 1)",e[m.b.SHEET]="=SHEET(".concat(FormulaAuthoringStrings.Table1,")"),e[m.b.STDEV]="=STDEV(A3:A12)",e[m.b.SUMIF]='=SUMIF(A2:A5,">160000")',e[m.b.TODAY]="=TODAY()",e[m.b.TREND]="=TREND(B2:B10, A2:A10, A11:A13, TRUE)",e[m.b.TRUNC]="=TRUNC(8.9)",e[m.b.UPPER]='=UPPER("'.concat(FormulaAuthoringStrings.KelliXu,'")'),e[m.b.VALUE]="=VALUE(1000)",e[m.b.VAR_S]="=VAR.S(A2:A11)",e[m.b.VAR_P]="=VAR.P(A2:A11)",e[m.b.GAMMA]="=GAMMA(-3.75)",e[m.b.GAUSS]="=GAUSS(2)",e[m.b.FDIST]="=FDIST(15.20686486,6,4)",e[m.b.F_INV]="=F.INV(0.01,6,4)",e[m.b.FLOOR]="=FLOOR(23.25, 0.1)",e[m.b.TDIST]="=TDIST(60, 1, 1)",e[m.b.COVAR]="=COVAR(A2:A6, B2:B6)",e[m.b.FTEST]="=FTEST(A2:A6,B2:B6)",e[m.b.STEYX]="=STEYX(A3:A9,B3:B9)",e[m.b.SLOPE]="=SLOPE(A3:A9,B3:B9)",e[m.b.TTEST]="=TTEST(A2:A10,B2:B10,2,1)",e[m.b.DEVSQ]="=DEVSQ(A2:A8)",e[m.b.SUMSQ]="=SUMSQ(3, 4)",e[m.b.ZTEST]="=ZTEST(A2:A11,6)",e[m.b.LARGE]="=LARGE(A2:B6,7)",e[m.b.SMALL]="=SMALL(A2:A10,4)",e[m.b.MUNIT]="=MUNIT(2)",e[m.b.T_INV]="=T.INV(0.75,2)",e[m.b.ROMAN]="=ROMAN(499,0)",e[m.b.POWER]="=POWER(5,2)",e[m.b.ISPMT]="=ISPMT(10%, 2, 5, 1000)",e[m.b.VARPA]="=VARPA(1, 2)",e[m.b.AREAS]="=AREAS(B2:D4)",e[m.b.ASINH]="=ASINH(10)",e[m.b.BITOR]="=BITOR(23,10)",e[m.b.ACOS]="=ACOS(-0.5)",e[m.b.ACOT]="=ACOT(2)",e[m.b.ATAN]="=ATAN(1)",e[m.b.CALL]="=CALL(A5)",e[m.b.CELL]='=CELL("'.concat(FormulaAuthoringStrings.Address,'", C2)'),e[m.b.CHAR]="=CHAR(65)",e[m.b.COSH]="=COSH(EXP(1))",e[m.b.COTH]="=COTH(2)",e[m.b.CSCH]="=CSCH(2)",e[m.b.DATE]="=DATE(2008,1,2)",e[m.b.DAYS]="=DAYS(3/15/11,2/1/11)",e[m.b.DGET]='=DGET(A5:E11, "'.concat(FormulaAuthoringStrings.Yield,'", A1:A3)'),e[m.b.DMAX]='=DMAX(A5:E11, "'.concat(FormulaAuthoringStrings.Profit,'", A1:F3)'),e[m.b.DMIN]='=DMIN(A5:E11, "'.concat(FormulaAuthoringStrings.Profit,'", A1:F3)'),e[m.b.DSUM]='=DSUM(A4:E10,"'.concat(FormulaAuthoringStrings.Profit,'", A1:F3)'),e[m.b.DVAR]='=DVAR(A4:E10, "'.concat(FormulaAuthoringStrings.Yield,'", A1:A3)'),e[m.b.FACT]="=FACT(5)",e[m.b.FIND]='=FIND("'.concat(FormulaAuthoringStrings.M,'",A2)'),e[m.b.HOUR]="=HOUR(0.75)",e[m.b.IFNA]='=IFNA("'.concat(FormulaAuthoringStrings.NoNAError,'", "').concat(FormulaAuthoringStrings.Error,'")'),e[m.b.IPMT]="=IPMT(10%, 3, 3, 8000)",e[m.b.ISNA]="=ISNA(#REF!)",e[m.b.LEFT]='=LEFT("'.concat(FormulaAuthoringStrings.SalePrice,'",4)'),e[m.b.MIRR]="=MIRR(A2:A7, 0.1, 0.12)",e[m.b.NPER]="=NPER(0.12/12, -100, -1000, 10000, 1)",e[m.b.PPMT]="=PPMT(0.08, 10, 10, 200000)",e[m.b.RAND]="=RAND()",e[m.b.RANK]="=RANK(3.5,A2:A6,1)",e[m.b.RATE]="=RATE(4*12, -200, 8000)",e[m.b.REPT]='=REPT("*-", 3)',e[m.b.ROWS]="=ROWS(C1:E4)",e[m.b.SECH]="=SECH(0)",e[m.b.SIGN]="=SIGN(10)",e[m.b.SINH]="=SINH(2)",e[m.b.SQRT]="=SQRT(16)",e[m.b.TANH]="=TANH(0.5)",e[m.b.TEXT]='=TEXT(1234.567,"$#,##0.00")',e[m.b.TIME]="=TIME(16,48,10)",e[m.b.TRIM]='=TRIM("'.concat(FormulaAuthoringStrings.FirstQuarterEarnings,'")'),e[m.b.TRUE]="=TRUE()",e[m.b.TYPE]='=TYPE("'.concat(FormulaAuthoringStrings.Smith,'")'),e[m.b.VARP]="=VARP(A2:A11)",e[m.b.YEAR]="=YEAR(39634)",e[m.b.INFO]='=INFO("'.concat(FormulaAuthoringStrings.Numfile,'")'),e[m.b.EVEN]="=EVEN(1.5)",e[m.b.FINV]="=FINV(0.42, 2, 3)",e[m.b.PROB]="=PROB(A3:A6,B3:B6,2)",e[m.b.KURT]="=KURT(A2:A11)",e[m.b.SKEW]="=SKEW(A2:A11)",e[m.b.MODE]="=MODE(A2:A7)",e[m.b.MINA]="=MINA(A2:A6)",e[m.b.MAXA]="=MAXA(A2:A6)",e[m.b.VARA]="=VARA(1, 2)",e[m.b.SORT]="=SORT(A2:A17)",e[m.b.ASIN]="=ASIN(-0.5)",e[m.b.BASE]="=BASE(7,2)",e[m.b.CODE]='=CODE("'.concat(FormulaAuthoringStrings.CodeA,'")'),e[m.b.AND]="=AND(A2>1,A2<100)",e[m.b.COS]="=COS(1.047)",e[m.b.COT]="=COT(30)",e[m.b.CSC]="=CSC(15)",e[m.b.DAY]="=DAY(40648)",e[m.b.DDB]="=DDB(2400,300,10*365,1)",e[m.b.RTD]='=RTD(mycomaddin.progid,,"'.concat(FormulaAuthoringStrings.ServerName,'","').concat(FormulaAuthoringStrings.Price,'")'),e[m.b.EXP]="=EXP(1)",e[m.b.INT]="=INT(8.9)",e[m.b.IRR]="=IRR(A2:A4,-10%)",e[m.b.LEN]='=LEN("'.concat(FormulaAuthoringStrings.Excel,'")'),e[m.b.LOG]="=LOG(10)",e[m.b.MAX]="=MAX(A2:A6)",e[m.b.MID]='=MID("'.concat(FormulaAuthoringStrings.FluidFlow,'",1,5)'),e[m.b.MIN]="=MIN(A2:A6)",e[m.b.MOD]="=MOD(3, 2)",e[m.b.NOT]="=NOT(A2>100)",e[m.b.NPV]="=NPV(0.1, -10000, 3000, 4200, 6800)",e[m.b.PMT]="=PMT(0.08/12,10,10000)",e[m.b.ROW]="=ROW(C10)",e[m.b.RRI]="=RRI(96,10000,11000)",e[m.b.SEC]="=SEC(30)",e[m.b.SIN]="=SIN(PI())",e[m.b.SLN]="=SLN(30000, 7500, 10)",e[m.b.SUM]="=SUM(A1:A3)",e[m.b.SYD]="=SYD(30000,7500,10,1)",e[m.b.TAN]="=TAN(0.785)",e[m.b.VAR]="=VAR(A2:A11)",e[m.b.VDB]="=VDB(2400, 300, 10*365, 0, 1)",e[m.b.XOR]="=XOR(3>0,2<9)",e[m.b.ODD]="=ODD(1.5)",e[m.b.PHI]="=PHI(0.75)",e[m.b.RSQ]="=RSQ(A3:A9, B3:B9)",e[m.b.IFS]='=IFS(A2>89,"'.concat(FormulaAuthoringStrings.IfsA,'",A2>79,"').concat(FormulaAuthoringStrings.IfsB,'",A2>69,"').concat(FormulaAuthoringStrings.IfsC,'",A2>59,"').concat(FormulaAuthoringStrings.IfsD,'",TRUE,"').concat(FormulaAuthoringStrings.IfsF,'")'),e[m.b.DB]="=DB(1000000,100000,6,1,7)",e[m.b.FV]="=FV(0.06/12, 10, -200, -500, 1)",e[m.b.IF]='=IF(C2>B2,"'.concat(FormulaAuthoringStrings.OverBudget,'","').concat(FormulaAuthoringStrings.WithinBudget,'")'),e[m.b.LN]="=LN(86)",e[m.b.NA]="=NA()",e[m.b.OR]="=OR(A2>1,A2<100)",e[m.b.PV]="=PV(0.08/12, 12*20, 500, , 0)",e[m.b.N]="=N(".concat(FormulaAuthoringStrings.Even,")"),e[m.b.T]='=T("'.concat(FormulaAuthoringStrings.Hello,'")'),e[m.b.ACCRINT]="=ACCRINT(39508,39691,39569,0.1,1000,2,0)",e[m.b.ACCRINTM]="=ACCRINTM(39539,39614,0.1,1000,3)",e[m.b.AMORDEGRC]="=AMORDEGRC(2400,39679,39813,300,1,0.15,1)",e[m.b.AMORLINC]="=AMORLINC(2400,39679,39813,300,1,0.15,1)",e[m.b.BESSELI]="=BESSELI(1.5,1)",e[m.b.BESSELJ]="=BESSELJ(1.9,2)",e[m.b.BESSELK]="=BESSELK(1.5,1)",e[m.b.BESSELY]="=BESSELY(2.5,1)",e[m.b.BIN2DEC]="=BIN2DEC(1100100)",e[m.b.BIN2HEX]="=BIN2HEX(11111011, 4)",e[m.b.BIN2OCT]="=BIN2OCT(1001, 3)",e[m.b.COMPLEX]='=COMPLEX(3,4,"j")',e[m.b.CONVERT]='=CONVERT(1,"lbm","kg")',e[m.b.COUPDAYBS]="=COUPDAYBS(25-Jan-11,15-Nov-11,2,1)",e[m.b.COUPDAYS]="=COUPDAYS(25-Jan-11,15-Nov-11,2,1)",e[m.b.COUPDAYSNC]="=COUPDAYSNC(25-Jan-11,15-Nov-11,2,1)",e[m.b.COUPNCD]="=COUPNCD(25-Jan-11,15-Nov-11,2,1)",e[m.b.COUPNUM]="=COUPNUM(25-Jan-11,15-Nov-12,2,1)",e[m.b.COUPPCD]="=COUPPCD(25-Jan-11,15-Nov-11,2,1)",e[m.b.CUMIPMT]="=CUMIPMT(A2/12,A3*12,A4,13,24,0)",e[m.b.CUMPRINC]="=CUMPRINC(A2/12,A3*12,A4,13,24,0)",e[m.b.DEC2BIN]="=DEC2BIN(9, 4)",e[m.b.DEC2HEX]="=DEC2HEX(100,4)",e[m.b.DEC2OCT]="=DEC2OCT(58,3)",e[m.b.DELTA]="=DELTA(5,4)",e[m.b.DISC]="=DISC(7/1/2018,1/1/2048,97.975,100,1)",e[m.b.DOLLARDE]="=DOLLARDE(1.02,16)",e[m.b.DOLLARFR]="=DOLLARFR(1.125,16)",e[m.b.DURATION]="=DURATION(7/1/2018,1/1/2048,8%,9%,2,1)",e[m.b.EDATE]="=EDATE(15-Jan-11,1)",e[m.b.EFFECT]="=EFFECT(0.0525,4)",e[m.b.EOMONTH]="=EOMONTH(1-Jan-11,1)",e[m.b.ERF]="=ERF(0.745)",e[m.b.ERFC]="=ERFC(1)",e[m.b.FACTDOUBLE]="=FACTDOUBLE(6)",e[m.b.FORECAST_ETS]="=FORECAST.ETS(A62,$B$4:$B$60,$A$4:$A$60,1,1)",e[m.b.FORECAST_ETS_CONFINT]="=FORECAST.ETS.CONFINT(A62,$B$4:$B$60,$A$4:$A$60,0.95,1,1)",e[m.b.FORECAST_ETS_SEASONALITY]="=FORECAST.ETS.SEASONALITY($B$4:$B$60,$A$4:$A$60,1,1)",e[m.b.FORECAST_ETS_STAT]="=FORECAST.ETS.STAT($B$4:$B$60,$A$4:$A$60,1,J48,1,1)",e[m.b.FVSCHEDULE]="=FVSCHEDULE(1,{0.09,0.11,0.1})",e[m.b.GCD]="=GCD(24,36)",e[m.b.GESTEP]="=GESTEP(5,4)",e[m.b.HEX2BIN]="=HEX2BIN(F,8)",e[m.b.HEX2DEC]="=HEX2DEC(FFFFFFFF5B)",e[m.b.HEX2OCT]="=HEX2OCT(F, 3)",e[m.b.IMABS]='=IMABS("5+12i")',e[m.b.IMAGE]='=IMAGE("https://microsoft.com/abc.jpg", "Microsoft", 0)',e[m.b.IMAGINARY]='=IMAGINARY("3+4i")',e[m.b.IMARGUMENT]='=IMARGUMENT("3+4i")',e[m.b.IMCONJUGATE]='=IMCONJUGATE("3+4i")',e[m.b.IMCOS]='=IMCOS("1+i")',e[m.b.IMDIV]='=IMDIV("-238+240i","10+24i")',e[m.b.IMEXP]='=IMEXP("1+i")',e[m.b.IMLN]='=IMLN("3+4i")',e[m.b.IMLOG10]='=IMLOG10("3+4i")',e[m.b.IMLOG2]='=IMLOG2("3+4i")',e[m.b.IMPOWER]='=IMPOWER("2+3i", 3)',e[m.b.IMPRODUCT]='=IMPRODUCT("3+4i","5-3i")',e[m.b.IMREAL]='=IMREAL("6-9i")',e[m.b.IMSIN]='=IMSIN("4+3i")',e[m.b.IMSQRT]='=IMSQRT("1+i")',e[m.b.IMSUB]='=IMSUB("13+4i","5+3i")',e[m.b.IMSUM]='=IMSUM("3+4i","5-3i")',e[m.b.INTRATE]="=INTRATE(2/15/2008,5/15/2008,1000000,1014420,2)",e[m.b.ISEVEN]="=ISEVEN(2.5)",e[m.b.ISODD]="=ISODD(2.5)",e[m.b.LAMBDA]="=LAMBDA(a, b, SQRT((a^2+b^2)))",e[m.b.LET]="=LET(".concat(FormulaAuthoringStrings.Total,", SUM(A1:A10), ").concat(FormulaAuthoringStrings.Count,", COUNT(A1:A10), ").concat(FormulaAuthoringStrings.Total," / ").concat(FormulaAuthoringStrings.Count,")"),e[m.b.LCM]="=LCM(5,2)",e[m.b.LOG10]="=LOG10(86)",e[m.b.MDURATION]="=MDURATION(1/1/2008,1/1/2016,8%,9%,2,1)",e[m.b.MROUND]="=MROUND(10,3)",e[m.b.MULTINOMIAL]="=MULTINOMIAL(2,3,4)",e[m.b.NETWORKDAYS]="=NETWORKDAYS(10/1/2012,3/1/2013)",e[m.b.NOMINAL]="=NOMINAL(0.053543, 4)",e[m.b.NOW]="=NOW()",e[m.b.OCT2BIN]="=OCT2BIN(3,3)",e[m.b.OCT2DEC]="=OCT2DEC(54)",e[m.b.OCT2HEX]="=OCT2HEX(100,4)",e[m.b.ODDFPRICE]="=ODDFPRICE(11/11/2008,3/1/2021,10/15/2008,3/1/2009,7.85%,6.25%,100,2,1)",e[m.b.ODDFYIELD]="=ODDFYIELD(11/11/2008,3/1/2021,10/15/2008,3/1/2009,5.75%,84.5,100,2,0)",e[m.b.ODDLPRICE]="=ODDLPRICE(2/7/2008,6/15/2008,10/15/2007,3.75%,4.05%,100,2,0)",e[m.b.ODDLYIELD]="=ODDLYIELD(4/20/2008,6/15/2008,12/24/2007,3.75%,99.875,100,2,0)",e[m.b.PI]="=PI()",e[m.b.PRICE]="=PRICE(2/15/2008,11/15/2017,5.75%,6.5%,100,2,0)",e[m.b.PRICEDISC]="=PRICEDISC(2/16/2008,3/1/2008,5.25%,100,2)",e[m.b.PRICEMAT]="=PRICEMAT(2/15/2008,4/13/2008,11/11/2007,6.1%,6.1%,0)",e[m.b.QUOTIENT]="=QUOTIENT(5,2)",e[m.b.RANDBETWEEN]="=RANDBETWEEN(1,100)",e[m.b.RECEIVED]="=RECEIVED(2/15/2008,5/15/2008,1000000,5.75%,2)",e[m.b.RECURSE]="=RECURSE()",e[m.b.ROUNDDOWN]="=ROUNDDOWN(3.14159,3)",e[m.b.ROUNDUP]="=ROUNDUP(3.14159,3)",e[m.b.SERIESSUM]="=SERIESSUM(0.785398163,0,2,A4:A7)",e[m.b.SQRTPI]="=SQRTPI(1)",e[m.b.TBILLEQ]="=TBILLEQ(3/31/2008,6/1/2008,9.14%)",e[m.b.TBILLPRICE]="=TBILLPRICE(3/31/2008,6/1/2008,9%)",e[m.b.TBILLYIELD]="=TBILLYIELD(3/31/2008,6/1/2008,98.45%)",e[m.b.TINV]="=TINV(0.05464,60)",e[m.b.WEEKNUM]="=WEEKNUM(3/9/2012,2)",e[m.b.WORKDAY]="=WORKDAY(10/1/2008,151)",e[m.b.XIRR]="=XIRR(A3:A7, B3:B7, 0.1)",e[m.b.XNPV]="=XNPV(0.09, A2:A6, B2:B6)",e[m.b.YEARFRAC]="=YEARFRAC(1/1/2012,7/30/2012)",e[m.b.YIELD]="=YIELD(2/15/2008,11/15/2016,5.75%,95.04287,100,2,0)",e[m.b.YIELDDISC]="=YIELDDISC(2/16/2008,3/1/2008,99.795,100,2)",e[m.b.YIELDMAT]="=YIELDMAT(3/15/2008,11/3/2008,11/8/2007,6.25%,100.0123,0)",e})),Kt=function(e){function t(t,r){var n=e.call(this)||this;return n.parsedFormulaTree=t,n.caretPosition=r,n.assistedFunctionScopeStart=0,n}return Object(fe.__extends)(t,e),t.prototype.appNode=function(t,r,n,a){return t.kind===p.e.WSF&&this.updateAssistedFunction(t,r),e.prototype.appNode.call(this,t,r,n,a)},t.prototype.letNode=function(t,r,n,a,i,o){var c=e.prototype.letNode.call(this,t,r,n,a,i,o);return this.updateAssistedFunction(t,c.args),c},t.prototype.lambdaNode=function(t,r,n,a,i,o){var c=e.prototype.lambdaNode.call(this,t,r,n,a,i,o);return this.updateAssistedFunction(t,c.args),c},t.prototype.updateAssistedFunction=function(e,t){var r,n,a,i=null===(r=this.parsedFormulaTree.spans[t[0].label])||void 0===r?void 0:r.start,o=null===(n=this.parsedFormulaTree.spans[t[t.length-1].label])||void 0===n?void 0:n.end;void 0!==o&&void 0!==i&&this.caretPosition<=o&&(this.caretPosition>=i||1===(null===(a=this.parsedFormulaTree.spans[e.label])||void 0===a?void 0:a.start))&&(void 0===this.assistedFunctionHead||i>this.assistedFunctionScopeStart)&&void 0!==this.parsedFormulaTree.spans[e.label]&&(this.assistedFunctionHead=e,this.assistedFunctionArgs=t,this.assistedFunctionScopeStart=i)},t}(E.e);function Yt(e,t,r,n,a,i,o,c){var u=function(e,t,r){for(var n,a=0,i=t.length-1;i>=0;i-=1){var o=null===(n=e.spans[t[i].label])||void 0===n?void 0:n.end;void 0!==o&&r<=o&&(a=i)}return a}(t,r,n),s=e.Params.split("!");return{functionName:e.NameDataStrings,functionDescription:e.Help,signatures:s.map((function(t,r){return function(e,t,r,n,a,i,o,c){var u=Object(m.e)(a),s=""!==t?t.split(i+" ").filter((function(e){return"..."!==e})):[],l=function(e,t,r){var n=e.slice(),a=t.headTypes.length,i=t.restTypes.length;if(i>0){for(var o=1+Math.max(Math.floor((r-a)/i),0),c=a;c<n.length;c+=i){for(var u=0;u<i;u+=1){var s=Zt(n[c+u]),l=o>1&&u%i==0?"[":"",d=o>1&&u%i==i-1?"]":"";n[c+u]="".concat(l).concat(s).concat(o).concat(d)}o+=1}n.push("..."),Xt(r,t)&&n.splice(a,0,"...")}return n}(s,u,n),d=function(e,t){if(void 0===e||void 0===t)return null;return t.node.args.map((function(r){var n=t.spans[r.label];return n?e.substring(n.start,n.end):""}))}(o,c),f=function(e,t,r,n){var a=e.split("!");a=0===n?a.slice(0,t.length):a.slice(-1*t.length);if(r.restTypes.length>0){for(var i=r.headTypes.length;i<a.length;i+=1){var o=Zt(t[i]),c="".concat(o,"1,").concat(o,"2,... ");a[i]=c+a[i]}1===r.restTypes.length&&a.push(a[r.headTypes.length])}return a}(e.ParamsHelp,s,u,r),b=function(e,t){return e.filter((function(e){return"..."!==e})).slice(0,t.length).map((function(e){return function(e){if(e.startsWith("[")&&!e.endsWith("]"))return e+"]";if(!e.startsWith("[")&&e.endsWith("]"))return"["+e;return e}(e)}))}(l,f);return{signatureParams:$t(l,Qt(n,s.length,u)),descriptions:f,descriptionParams:$t(b,Jt(n,b.length,u)),exampleParams:null!==d?$t(d,Jt(n,d.length,u,!0)):null,exampleDescription:""}}(e,t,r,u,a,i,o,c)})),activeSignature:0,listSeparator:i,isUDF:e.IsDynamicUdf,helpID:e.HelpId}}function Jt(e,t,r,n){void 0===n&&(n=!1);var a=t-1;if(0===r.restTypes.length||e<r.headTypes.length+r.restTypes.length)return Math.min(e,a);var i=(e-r.headTypes.length)%r.restTypes.length;return n?e<=a-r.tailTypes.length?e:a-r.tailTypes.length-(r.restTypes.length-1)+i:r.headTypes.length+i}function Qt(e,t,r){var n=Jt(e,t,r);return Xt(e,r)&&(n+=1),n}function Xt(e,t){return e>=t.headTypes.length+t.restTypes.length}function Zt(e){return e.match(/[^0-9\[\]]+/)}function $t(e,t){return{params:e,activeParam:Math.min(t,e.length-1)}}var er=r(52),tr=r(89),rr=function(){function e(){this.factoryName=Ht.a.ArgumentAssistancePlugin}return e.prototype.create=function(){return new nr},e}(),nr=function(){function e(){this.timer=tr.b,this.lastRunTime=0,this.runStartTime=0,this.timeStamps=new Map}return e.prototype.run=function(e){var t,r,n,a,i,o,c,u,s,l,d,f,h,v,p,m,g,O,j;return Object(fe.__generator)(this,(function(S){switch(S.label){case 0:return this.lastRunTime=this.timer.now(),this.runStartTime=this.timer.now(),this.timeStamps=new Map,[4,{kind:et.b.GetActiveCell}];case 1:return(t=S.sent()).kind!==et.b.GetActiveCell?(this.logFailure("failed to get active cell"),[2,null]):(this.addTimeStamp("GetActiveCell"),[4,{kind:et.b.ParseActiveCell,formulaText:e.content}]);case 2:return r=S.sent(),this.addTimeStamp("ParseCellContentSync"),void 0!==r&&r.kind===et.b.ParseActiveCell&&Object(b.d)(r.result)?[3,4]:(n=void 0===r||r.kind!==et.b.ParseActiveCell?"parseResultUndefined":r.result,this.logFailure("ParseActiveCellFailed. failReasonKind: ".concat(JSON.stringify(n))),[4,{kind:et.b.ParseEdit,cell:t.activeCell,formulaBarText:e.content}]);case 3:if(r=S.sent(),this.addTimeStamp("ParseCellContentAsync"),r.kind!==et.b.ParseEdit||!Object(b.d)(r.result))return a=r.kind!==et.b.ParseEdit?"parseResultUndefined":r.result,this.logFailure("ParseEditFailed. failResult: ".concat(JSON.stringify(a))),[2,null];S.label=4;case 4:return r.result.value.kind!==Ne.e.Formula?[2,null]:(i=r.result.value.formula,o=new Kt(i,e.caretPosition),Object(E.m)(o,i),this.addTimeStamp("ArgumentAssistanceVisitor"),void 0===o.assistedFunctionHead?(this.logTimeStamp(),[2,null]):[4,{kind:et.b.GetFunctionInfo,functionName:o.assistedFunctionHead.whole}]);case 5:return c=S.sent(),this.addTimeStamp("GetFunctionInfo"),c.kind!==et.b.GetFunctionInfo?(this.logFailure("failed to get function info for ".concat(o.assistedFunctionHead.whole)),[2,null]):[4,{kind:et.b.GetConfig}];case 6:return u=S.sent(),this.addTimeStamp("GetConfig"),s=u.kind===et.b.GetConfig?u.config.localeInfo.listSeparator:",",l=new ct.a((function(){return Yt(c.functionInfo,i,o.assistedFunctionArgs,e.caretPosition,o.assistedFunctionHead.id,s)})),d=qt.getValue()[o.assistedFunctionHead.id],this.addTimeStamp("GetExampleString"),void 0===d?(this.logFailure("no example found for function: ".concat(o.assistedFunctionHead.whole)),this.addTimeStampAndLog("createFunctionRenderingInfoNoExample"),[2,l.getValue()]):[4,{kind:et.b.ParseCellFormula,cell:t.activeCell,formula:{formulaBarText:d,kind:Dt.a.CellFormula},useEnglishLocaleInfo:!0}];case 7:return f=S.sent(),this.addTimeStamp("ParseExample"),f.kind===et.b.ParseCellFormula&&Object(b.d)(f.result)?u.kind===et.b.GetConfig&&u.config.localeInfo.lcid===y.b.USA?(v=Yt(c.functionInfo,i,o.assistedFunctionArgs,e.caretPosition,o.assistedFunctionHead.id,s,d,f.result.value),this.addTimeStampAndLog("createFunctionRenderingInfoEnUs"),[2,v]):[4,{kind:et.b.PrintFormula,formula:f.result.value,origin:t.activeCell}]:(this.logFailure("failed to parse example for function: ".concat(o.assistedFunctionHead.whole)),h=l.getValue(),this.addTimeStampAndLog("createFunctionRenderingInfoFailedToParseExample"),[2,h]);case 8:return p=S.sent(),this.addTimeStamp("localize example string"),p.kind===et.b.PrintFormula&&Object(b.d)(p.result)?[4,{kind:et.b.ParseCellFormula,cell:t.activeCell,formula:{formulaBarText:p.result.value,kind:Dt.a.CellFormula},useEnglishLocaleInfo:!1}]:(this.logFailure("failed to pretty print localized example for function: ".concat(o.assistedFunctionHead.whole)),m=l.getValue(),this.addTimeStampAndLog("createFunctionRenderingInfoFailedToPrintLocalizedExample"),[2,m]);case 9:return g=S.sent(),this.addTimeStamp("parse localized example string"),g.kind===et.b.ParseCellFormula&&Object(b.d)(g.result)?(j=Yt(c.functionInfo,i,o.assistedFunctionArgs,e.caretPosition,o.assistedFunctionHead.id,s,p.result.value,g.result.value),this.addTimeStampAndLog("createFunctionRenderingInfoWithLocalizedExample"),[2,j]):(this.logFailure("failed to parse localized example for function: ".concat(o.assistedFunctionHead.whole)),O=l.getValue(),this.addTimeStampAndLog("createFunctionRenderingInfoFailedToParseLocalizedEexample"),[2,O])}}))},e.prototype.logFailure=function(e){y.B.ULS.traceTag(545388683,y.c.msoulscat_ES_EWAJS,y.i.Warning,"ArgumentAssistancePlugin encountered a failure with msg ".concat(e))},e.prototype.addTimeStampAndLog=function(e){this.addTimeStamp(e),this.logTimeStamp()},e.prototype.logTimeStamp=function(){this.timeStamps.set("Overall",this.timer.now()-this.runStartTime);var e={};this.timeStamps.forEach((function(t,r){e[r]=t})),y.B.ULS.traceTag(540377222,y.c.msoulscat_ES_EWAJS,y.i.Info,"".concat(JSON.stringify(e)))},e.prototype.addTimeStamp=function(e){this.timeStamps.set(e,this.timer.now()-this.lastRunTime),this.lastRunTime=this.timer.now()},e}();Object(Ht.d)(new rr);var ar=Object(ct.b)((function(){return Object(fe.__awaiter)(void 0,void 0,void 0,(function(){return Object(fe.__generator)(this,(function(e){switch(e.label){case 0:return[4,er.d.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(Ht.a.ArgumentAssistancePlugin)];case 2:return e.sent(),[4,er.b.getValue()];case 3:return e.sent(),[2]}}))}))})),ir=function(e){function t(t,r){var n=e.call(this)||this;return n.parsedFormulaTree=t,n.caretPosition=r,n}return Object(fe.__extends)(t,e),t.prototype.nameNode=function(t,r,n){var a,i,o;return t.kind===p.d.IdentNamePart&&(null===(a=this.parsedFormulaTree.spans[n])||void 0===a?void 0:a.end)===this.caretPosition&&(this.autocompleteString=t.asWhole,this.stringStartPosition=null===(i=this.parsedFormulaTree.spans[n])||void 0===i?void 0:i.start,this.stringEndPosition=null===(o=this.parsedFormulaTree.spans[n])||void 0===o?void 0:o.end),e.prototype.nameNode.call(this,t,r,n)},t}(E.e),or=r(101),cr=r(57);function ur(e,t,r,n){void 0===n&&(n=!1);var a=[],i=[],c=e.toLocaleLowerCase();return t.forEach((function(e){var t=r?r(e).toLocaleLowerCase():"string"==typeof e?e.toLocaleLowerCase():void 0;if(void 0!==t)if(t.startsWith(c))a.push(e);else if(n){var u=t.split(" ");Object(o.e)(u.find((function(e){return e.startsWith(c)})))&&i.push(e)}else c.length>2&&t.includes(c)&&i.push(e)})),{prefixedSuggestions:a,notPrefixedSuggestions:i}}var sr=function(){function e(){this.factoryName=Ht.a.AutocompleteFunctionPlugin}return e.prototype.create=function(){return new lr},e}(),lr=function(){function e(){}return e.prototype.run=function(e){var t,r,n,a,i,o,c,u,s,l,d,f,h,v;return Object(fe.__generator)(this,(function(p){switch(p.label){case 0:return[4,{kind:et.b.ParseActiveCell,formulaText:e.content}];case 1:return(t=p.sent()).kind===et.b.ParseActiveCell&&Object(b.d)(t.result)?t.result.value.kind!==Ne.e.Formula?[2,null]:(r=t.result.value.formula,n=new ir(r,e.caretPosition),Object(E.m)(n,r),void 0===n.autocompleteString||void 0===n.stringStartPosition||void 0===n.stringEndPosition?[2,null]:(a=n.autocompleteString.toUpperCase(),i=n.stringStartPosition,o=n.stringEndPosition,[4,{kind:et.b.GetFunctionsInfo}])):(this.logFailure("failed to parse cell content"),[2,null]);case 2:return(c=p.sent()).kind!==et.b.GetFunctionsInfo?(this.logFailure("failed to get functions info"),[2,null]):(u=c.functionsInfo,s=ur(a,u,(function(e){return e.NameDataStrings})),l=s.prefixedSuggestions,d=s.notPrefixedSuggestions,null!==(f=or.b.getValue())&&null!==f.descriptionsMap||this.logFailure("failed to get short descriptions, will show function info help description"),h=this.generateCompletionItems(l,f,i,o,!0),v=this.generateCompletionItems(d,f,i,o,!1),[2,{items:Object(fe.__spreadArray)(Object(fe.__spreadArray)([],h,!0),v,!0)}])}}))},e.prototype.generateCompletionItems=function(e,t,r,n,a){return e.map((function(e){var i,o;return{label:e.NameDataStrings,kind:cr.a.Function,detail:null!==(o=null===(i=t.descriptionsMap)||void 0===i?void 0:i.get(e.FunctionIndexInServer))&&void 0!==o?o:e.Help,textEdit:{newText:e.NameDataStrings+"(",range:{start:{line:0,character:r},end:{line:0,character:n}}},isPrefixed:a}}))},e.prototype.logFailure=function(e){y.B.ULS.traceTag(539083013,y.c.msoulscat_ES_EWAJS,y.i.Warning,"AutocompleteFunctionPlugin encountered a failure with msg ".concat(e))},e}();Object(Ht.d)(new sr);var dr=Object(ct.b)((function(){return Object(fe.__awaiter)(void 0,void 0,void 0,(function(){return Object(fe.__generator)(this,(function(e){switch(e.label){case 0:return[4,er.d.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(Ht.a.AutocompleteFunctionPlugin)];case 2:return e.sent(),[4,er.b.getValue()];case 3:return e.sent(),[2]}}))}))})),fr=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return Object(fe.__extends)(t,e),t.prototype.nameNode=function(t,r,n){var a,i=null===(a=this.formula.spans[n])||void 0===a?void 0:a.end;return void 0!==i&&this.caretPosition===i&&t.asWhole.length>0&&(this.caretNodeText=t.asWhole),e.prototype.nameNode.call(this,t,r,n)},t}(pe),br=function(){function e(){this.factoryName=Ht.a.AutocompleteLetPlugin}return e.prototype.create=function(){return new hr},e}(),hr=function(){function e(){}return e.prototype.run=function(e){var t,r,n,a,i,o,c,u,s,l,d,f,h;return Object(fe.__generator)(this,(function(v){switch(v.label){case 0:return[4,{kind:et.b.ParseActiveCell,formulaText:e.content}];case 1:return(t=v.sent()).kind===et.b.ParseActiveCell&&Object(b.d)(t.result)?t.result.value.kind!==Ne.e.Formula?[2,null]:(r=t.result.value.formula,n=e.caretPosition,a=new fr(r,n),Object(E.m)(a,r),i=a.references.reverse(),void 0===(o=a.caretNodeText)?[2,null]:(u=(c=n)-o.length,s=ur(o,i),l=s.prefixedSuggestions,d=s.notPrefixedSuggestions,f=this.stringsToCompletionItems(l,u,c,!0),h=this.stringsToCompletionItems(d,u,c,!1),[2,{items:Object(fe.__spreadArray)(Object(fe.__spreadArray)([],f,!0),h,!0)}])):(this.logFailure("failed to parse cell content"),[2,null])}}))},e.prototype.stringsToCompletionItems=function(e,t,r,n){return e.map((function(e){return{label:e,kind:cr.a.LetVariable,type:cr.b.Simple,textEdit:{newText:e,range:{start:{line:0,character:t},end:{line:0,character:r}}},isPrefixed:n}}))},e.prototype.logFailure=function(e){y.B.ULS.traceTag(538056603,y.c.msoulscat_ES_EWAJS,y.i.Warning,"AutocompleteLetPlugin encountered a failure with msg ".concat(e))},e}();Object(Ht.d)(new br);var vr=Object(ct.b)((function(){return Object(fe.__awaiter)(void 0,void 0,void 0,(function(){return Object(fe.__generator)(this,(function(e){switch(e.label){case 0:return[4,er.e.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(Ht.a.AutocompleteLetPlugin)];case 2:return e.sent(),[4,er.b.getValue()];case 3:return e.sent(),[2]}}))}))})),pr=function(e){function t(t,r){var n=e.call(this)||this;return n.parsedFormulaTree=t,n.dotNotationIndex=r,n}return Object(fe.__extends)(t,e),t.prototype.cellRefNode=function(t,r,n){var a,i=null===(a=this.parsedFormulaTree.spans[n])||void 0===a?void 0:a.end;return void 0!==i&&this.dotNotationIndex===i&&(this.cellRef=t,this.qualifier=r),e.prototype.cellRefNode.call(this,t,r,n)},t}(E.e),mr=r(96),gr=r(109),Or=function(){function e(){this.factoryName=Ht.a.AutocompleteRichValuePlugin}return e.prototype.create=function(){return new jr},e}(),jr=function(){function e(){}return e.prototype.run=function(t){var r,n,a,i,c,u,s,l,d,f,h,v,m,g,O,y,S,C,k,A,N;return Object(fe.__generator)(this,(function(T){switch(T.label){case 0:return Object(o.f)(t.content)||Object(o.f)(t.caretPosition)||t.caretPosition!==t.content.length?(this.logFailure("missing request arguments"),[2,null]):(r=t.content.lastIndexOf("."),n=-1!==r?r:t.caretPosition,[4,{kind:et.b.ParseActiveCell,formulaText:t.content.slice(0,n)}]);case 1:return(a=T.sent()).kind===et.b.ParseActiveCell&&Object(b.d)(a.result)?a.result.value.kind!==Ne.e.Formula?[2,null]:(i=a.result.value.formula,c=new pr(i,n),Object(E.m)(c,i),u=c.cellRef,Object(o.f)(u)||u.kind!==p.c.Single?[2,null]:(s=e.getRangeStringFromParsedCellRef(i,u,t.content),Object(o.f)(s)?(this.logFailure("failed to parse cellRef"),[2,null]):[4,{kind:et.b.GetActiveCell}])):(this.logFailure("failed to parse cell content"),[2,null]);case 2:return(l=T.sent()).kind!==et.b.GetActiveCell?(this.logFailure("failed to get active cell"),[2,null]):(d="",c.qualifier&&c.qualifier.kind===p.g.Sheet?(d=c.qualifier.sheet,[3,5]):[3,3]);case 3:return[4,{kind:et.b.GetSheetNames}];case 4:if((f=T.sent()).kind!==et.b.GetSheetNames)return this.logFailure("failed to get sheet names"),[2,null];if(!Object(j.D)(l.activeCell.sheet.document,f.document))return this.logFailure("sheet names document is different than that of active cell"),[2,null];d=f.sheets[f.idToIndex[l.activeCell.sheet.index]].sheetName,T.label=5;case 5:return h=u.row.kind===p.f.Rel?u.row.index+l.activeCell.range.row:u.row.index,v=u.col.kind===p.f.Rel?u.col.index+l.activeCell.range.col:u.col.index,m={FirstRow:h,LastRow:h,FirstColumn:v,LastColumn:v,SheetName:d,NamedObjectName:""},[4,{kind:et.b.GetRichValueFieldListContext,rangeToQuery:m,dotNotationPath:s,singleColumn:!1,findRange:!1}];case 6:return(g=T.sent()).kind!==et.b.GetRichValueFieldListContext||Object(o.f)(g.result)?(this.logFailure("failed to get field list context data"),[2,null]):(g.result.length>1&&this.logFailure("fieldListContextRequest results length greater than 1"),O=t.content.slice(n).replace(/[\[\].]+/g,""),y=ur(O,g.result[0].FieldInfoDataList.map((function(e){return e.Name})),void 0,!0),S=y.prefixedSuggestions,C=y.notPrefixedSuggestions,[4,{kind:et.b.GetConfig}]);case 7:return k=T.sent(),A=this.resultsToCompletionItems(S,!0,k,n,t.caretPosition),N=this.resultsToCompletionItems(C,!1,k,n,t.caretPosition),[2,{items:Object(fe.__spreadArray)(Object(fe.__spreadArray)([],A,!0),N,!0)}]}}))},e.getRangeStringFromParsedCellRef=function(e,t,r){var n,a,i=null===(n=e.spans[t.label])||void 0===n?void 0:n.start,c=null===(a=e.spans[t.label])||void 0===a?void 0:a.end;if(Object(o.e)(i)&&Object(o.e)(c)&&i>=0&&c<=r.length)return r.substring(i,c)},e.getTextToCommit=function(e,t){var r=e;r=(r=(r=r.replace("'","''")).replace("[","'[")).replace("]","']");var n=t.kind===et.b.GetConfig?t.config.localeInfo:void 0;return n&&!Object(mr.a)(n,r)?".[".concat(r,"]"):".".concat(r)},e.prototype.resultsToCompletionItems=function(t,r,n,a,i){return t.map((function(t){return{label:t,kind:cr.a.RichEntity,detail:"",textEdit:{newText:e.getTextToCommit(t,n),range:{start:{line:0,character:a},end:{line:0,character:i}}},isPrefixed:r}}))},e.prototype.logFailure=function(e){c.i.ULS.traceTag(529056660,gr.LogCategory.msoulscat_ES_EWAJS,gr.TraceLevel.Warning,"AutocompleteRichValuePlugin encountered a failure with msg ".concat(e))},e}();Object(Ht.d)(new Or);var yr=Object(ct.b)((function(){return Object(fe.__awaiter)(void 0,void 0,void 0,(function(){return Object(fe.__generator)(this,(function(e){switch(e.label){case 0:return[4,er.a.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(Ht.a.AutocompleteRichValuePlugin)];case 2:return e.sent(),[4,er.b.getValue()];case 3:return e.sent(),[2]}}))}))})),Sr=function(){function e(){this.factoryName=Ht.a.AutocompleteNamedObjectsPlugin}return e.prototype.create=function(){return new Cr},e}(),Cr=function(){function e(){}return e.prototype.run=function(e){var t,r,n,a,i,c,u,s,l,d,f,h,v,p;return Object(fe.__generator)(this,(function(m){switch(m.label){case 0:return[4,{kind:et.b.ParseActiveCell,formulaText:e.content}];case 1:return(t=m.sent()).kind===et.b.ParseActiveCell&&Object(b.d)(t.result)?t.result.value.kind!==Ne.e.Formula?[2,null]:(r=t.result.value.formula,[4,{kind:et.b.GetDefinedNamesInfo}]):(this.logFailure("failed to parse cell content"),[2,null]);case 2:return(n=m.sent()).kind!==et.b.GetDefinedNamesInfo?(this.logFailure("failed to get named objects info"),[2,null]):(a=n.definedNamesInfo,i=e.caretPosition,c=new ir(r,i),Object(E.m)(c,r),u=c.autocompleteString,s=c.stringStartPosition,l=c.stringEndPosition,Object(o.e)(u)&&Object(o.e)(l)&&Object(o.e)(s)?(d=ur(u,a,(function(e){return e.name})),f=d.prefixedSuggestions,h=d.notPrefixedSuggestions,v=this.namesToCompletionItems(f,s,l,!0),p=this.namesToCompletionItems(h,s,l,!1),[2,{items:Object(fe.__spreadArray)(Object(fe.__spreadArray)([],v,!0),p,!0)}]):[2,null])}}))},e.prototype.namesToCompletionItems=function(e,t,r,n){return e.filter((function(e){return-1!==e.type})).map((function(e){return{label:e.name,kind:1===e.type?cr.a.NamedRange:cr.a.Table,type:cr.b.Simple,textEdit:{newText:e.name,range:{start:{line:0,character:t},end:{line:0,character:r}}},isPrefixed:n}}))},e.prototype.logFailure=function(e){y.B.ULS.traceTag(528562134,y.c.msoulscat_ES_EWAJS,y.i.Warning,"AutocompleteLetPlugin encountered a failure with msg ".concat(e))},e}();Object(Ht.d)(new Sr);var kr=Object(ct.b)((function(){return Object(fe.__awaiter)(void 0,void 0,void 0,(function(){return Object(fe.__generator)(this,(function(e){switch(e.label){case 0:return[4,er.e.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(Ht.a.AutocompleteNamedObjectsPlugin)];case 2:return e.sent(),[4,er.b.getValue()];case 3:return e.sent(),[2]}}))}))})),Er=function(e){function t(t,r){var n=e.call(this)||this;return n.formula=t,n.caretPosition=r,n.location=null,n}return Object(fe.__extends)(t,e),t.prototype.appNode=function(t,r,n,a){return t.kind!==p.e.Operator&&this.matchFormula(t,n,a),e.prototype.appNode.call(this,t,r,n,a)},t.prototype.parenNode=function(t,r,n){var a=this.formula.spans[n];return r&&a&&this.matchParentheses(a.start,a.end-1),e.prototype.parenNode.call(this,t,r,n)},t.prototype.letNode=function(t,r,n,a,i,o){return this.matchFormula(t,i,o),e.prototype.letNode.call(this,t,r,n,a,i,o)},t.prototype.lambdaNode=function(t,r,n,a,i,o){return this.matchFormula(t,i,o),e.prototype.lambdaNode.call(this,t,r,n,a,i,o)},t.prototype.matchFormula=function(e,t,r){var n=this.formula.spans[r],a=this.formula.spans[e.label];t&&n&&a&&this.matchParentheses(a.end,n.end-1)},t.prototype.matchParentheses=function(e,t){e<this.caretPosition&&this.caretPosition<=t&&(null==this.location||e>this.location.openStart)&&(this.location={openStart:e,closeStart:t})},t}(E.e),Ar=function(){function e(){this.factoryName=Ht.a.ParenthesesCouplingPlugin}return e.prototype.create=function(){return new Nr},e}(),Nr=function(){function e(){}return e.prototype.run=function(e){var t,r,n;return Object(fe.__generator)(this,(function(a){switch(a.label){case 0:return null!=e.selectionLength&&e.selectionLength>0?[2,null]:[4,{kind:et.b.ParseActiveCell,formulaText:e.content}];case 1:return(t=a.sent()).kind===et.b.ParseActiveCell&&Object(b.d)(t.result)&&t.result.value.kind===Ne.e.Formula?(r=t.result.value.formula,n=new Er(r,e.caretPosition),Object(E.m)(n,r),[2,n.location]):(this.logFailure("failed to parse cell content"),[2,null])}}))},e.prototype.logFailure=function(e){c.i.ULS.traceTag(541193944,Qe.LogCategory.msoulscat_ES_EWAJS,Qe.TraceLevel.Warning,"ParenthesesCouplingPlugin encountered a failure with msg ".concat(e))},e}();Object(Ht.d)(new Ar);var Tr=Object(ct.b)((function(){return Object(fe.__awaiter)(void 0,void 0,void 0,(function(){return Object(fe.__generator)(this,(function(e){switch(e.label){case 0:return[4,er.a.getValue()];case 1:return[4,e.sent().createAndAttachSyncPlugin(Ht.a.ParenthesesCouplingPlugin)];case 2:return e.sent(),[4,er.b.getValue()];case 3:return e.sent(),[2]}}))}))})),Rr=r(42),Ir=r(119),_r=Object(ct.b)((function(){return Object(fe.__awaiter)(void 0,void 0,void 0,(function(){var e;return Object(fe.__generator)(this,(function(t){switch(t.label){case 0:return[4,er.e.getValue()];case 1:return[4,(e=t.sent()).loadPluginScript("excelOnlineAutocomplete",!1)];case 2:return t.sent(),[2,e]}}))}))})),Fr=Object(ct.b)((function(){return Object(fe.__awaiter)(void 0,void 0,void 0,(function(){return Object(fe.__generator)(this,(function(e){switch(e.label){case 0:return[4,_r.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(Ht.a.AutocompletePlugin)];case 2:return e.sent(),[4,er.b.getValue()];case 3:return e.sent(),[2]}}))}))})),wr=Object(ct.b)((function(){return Object(fe.__awaiter)(void 0,void 0,void 0,(function(){return Object(fe.__generator)(this,(function(e){switch(e.label){case 0:return e.trys.push([0,3,,4]),[4,_r.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(Ht.a.AutocompletePrecisionMeasurements)];case 2:return e.sent(),[3,4];case 3:return e.sent(),[3,4];case 4:return[2]}}))}))})),Mr=Object(ct.b)((function(){return Object(fe.__awaiter)(void 0,void 0,void 0,(function(){return Object(fe.__generator)(this,(function(e){switch(e.label){case 0:return[4,_r.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(Ht.a.AutocompleteGroundTruthMeasurements)];case 2:return e.sent(),[2]}}))}))})),Dr=Object(ct.b)((function(){return Object(fe.__awaiter)(void 0,void 0,void 0,(function(){return Object(fe.__generator)(this,(function(e){switch(e.label){case 0:return[4,_r.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(Ht.a.AutocompleteDataTypesMeasurements)];case 2:return e.sent(),[2]}}))}))})),Pr=Object(ct.b)((function(){return Object(fe.__awaiter)(void 0,void 0,void 0,(function(){return Object(fe.__generator)(this,(function(e){switch(e.label){case 0:return[4,_r.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(Ht.a.ParserPerformanceMeasurements)];case 2:return e.sent(),[2]}}))}))})),xr=r(123),Lr=r(15),Br=function(){function e(){this.nonLiteralStore=new Map,this.literalStore=new Map}return e.prototype.get=function(e,t,r){var n,a;if(e===Lr.c.Literal){if(void 0===r)throw new Error("Expected subkind");return null===(n=this.literalStore.get(r))||void 0===n?void 0:n.get(t)}return null===(a=this.nonLiteralStore.get(e))||void 0===a?void 0:a.get(t)},e.prototype.set=function(e,t,r,n){var a,i;if(e===Lr.c.Literal){if(void 0===n)throw new Error("Expected subkind");(o=null!==(a=this.literalStore.get(n))&&void 0!==a?a:new Map).set(t,r),this.literalStore.set(n,o)}else{var o;(o=null!==(i=this.nonLiteralStore.get(e))&&void 0!==i?i:new Map).set(t,r),this.nonLiteralStore.set(e,o)}},e}();var Ur=function(){function e(){this.store=new Br,this.counter=1}return e.prototype.getAnonymization=function(e,t,r,n){var a=this.store.get(e,r,t);if(void 0!==a)return a;var i=n(this.counter);return this.counter+=1,this.store.set(e,r,i,t),i},e.prototype.anonymizeIdent=function(e,t,r,n){var a=null!=t?t:e.start;if(void 0!==(null==r?void 0:r.localeInfo.getWorksheetFuncId(e.chars))&&function(e){return void 0!==e&&(e.kind===Lr.c.Left&&e.value===Lr.a.Paren)}(n))return Object(Lr.w)(a,e.chars);var i=this.getAnonymization(e.kind,void 0,e.chars,(function(e){return"ident".concat(e)}));return Object(Lr.w)(a,i)},e.prototype.anonymizeA1CellRef=function(e,t){if(e.refStyle!==p.h.A1)throw new Error("Expected RefStyle.A1");var r=null!=t?t:e.start,n=this.getAnonymization(e.kind,void 0,e.chars,(function(e){return"A".concat(e)}));return Object(Lr.k)(r,n,void 0,void 0)},e.prototype.anonymizeR1C1CellRef=function(e,t){if(e.refStyle!==p.h.R1C1)throw new Error("Expected RefStyle.R1C1");var r=null!=t?t:e.start,n=this.getAnonymization(e.kind,void 0,e.chars,(function(e){return"R".concat(e,"C").concat(e)}));return Object(Lr.l)(r,n,void 0,void 0)},e.prototype.anonymizeCellRef=function(e,t){return e.refStyle===p.h.A1?this.anonymizeA1CellRef(e,t):this.anonymizeR1C1CellRef(e,t)},e.prototype.anonymizeLiteral=function(e,t){var r=null!=t?t:e.start,n=void 0;switch(e.oper.kind){case I.b.Number:n=this.getAnonymization(e.kind,e.oper.kind,e.chars,(function(e){return"".concat(e)}));break;case I.b.String:n=this.getAnonymization(e.kind,e.oper.kind,e.chars,(function(e){return'"s'.concat(e,'"')}));break;case Lr.d.BadNumber:n=this.getAnonymization(e.kind,e.oper.kind,e.chars,(function(e){return"1e".concat(e,"000")}));break;case Lr.d.BadError:n=this.getAnonymization(e.kind,e.oper.kind,e.chars,(function(e){for(var t=["a"],r="a".charCodeAt(0),n=e;n>0;){var a=e%10,i=String.fromCharCode(r+a);t.push(i),n=Math.floor(n/10)}var o=t.join("");return"#".concat(o)}));break;case I.b.Boolean:case I.b.Error:case I.b.Missing:n=e.chars;break;default:Object(c.e)("error",e.oper)}var a=e.oper,i=e.hasRight;return Object(Lr.G)(r,n,a,i)},e.prototype.anonymizeToken=function(e,t,r,n){switch(e.kind){case Lr.c.Ident:return this.anonymizeIdent(e,t,r,n);case Lr.c.CellRef:return this.anonymizeCellRef(e,t);case Lr.c.Literal:return this.anonymizeLiteral(e,t);case Lr.c.Unexpected:return function(e,t){var r=null!=t?t:e.start;return"\t"===e.chars||";"===e.chars?Object(Lr.Y)(r,e.chars):Object(Lr.Y)(r,"\t")}(e,t);case Lr.c.End:case Lr.c.Left:case Lr.c.Right:case Lr.c.Sep:case Lr.c.Operator:case Lr.c.Spaces:case Lr.c.SpecialRef:case Lr.c.Escape:return Object(fe.__assign)(Object(fe.__assign)({},e),{start:t});default:return Object(c.e)("ConsistentAnonymizer.anonymizeToken",e)}},e.prototype.anonymize=function(e,t,r){for(var n=Object(xr.a)(t.localeInfo,t.mathpack,t.refStyle,r,e,0),a=[],i=0,o=0;o<n.length;o+=1){var c=n[o],u=o+1<n.length?n[o+1]:void 0,s=this.anonymizeToken(c,i,t,u);i+=s.chars.length,a.push(s)}return a.map((function(e){return e.chars})).join("")},e}();function Gr(e){for(var t=0,r=function(e){var t=JSON.stringify(e),r=0,n=[];for(;t.length>0;){var a=Kr(t,r,e.i),i=a[0],o=a[1];t=o,r+=1,n.push(i)}return n}(e);t<r.length;t++){var n=qr(r[t]);y.B.ULS.dnmTraceTag(537962336,y.c.msoulscat_ES_EWAJS,y.i.Verbose,n)}}function Vr(e){y.B.ULS.traceTag(537962337,y.c.msoulscat_ES_EWAJS,y.i.Verbose,e)}var Hr,Wr=function(){function e(){this.factoryName=Ht.a.FormulaCollectionPlugin}return e.prototype.create=function(){return new zr},e}(),zr=function(){function e(){this.lastEdit=void 0,this.consistentAnonymizer=new Ur,this.sheetIdAnonymization=new Map}return e.prototype.getEditEntry=function(e,t){var r={content:e,cell:t};if(void 0===this.lastEdit||!Object(j.V)(this.lastEdit.cell,t)||this.lastEdit.content!==e)return this.lastEdit=r,r},e.prototype.anonymizeSheetId=function(e){if(this.sheetIdAnonymization.has(e))return this.sheetIdAnonymization.get(e);var t=Object(Qe.getNewGuid)()[0];return this.sheetIdAnonymization.set(e,t),t},e.prototype.run=function(t){var r,n,a,i,o,c,u,s,l,d,f,v,p,m,g,O,j,y;return Object(fe.__generator)(this,(function(S){switch(S.label){case 0:return[4,{kind:et.b.GetActiveCell}];case 1:return(r=S.sent()).kind!==et.b.GetActiveCell?(Vr(Hr.GetActiveCell),[2,null]):(n=r.activeCell,null==t.content?(Vr(Hr.EmptyContent),[2,null]):t.content.trimLeft().startsWith("=")?void 0===(a=this.getEditEntry(t.content,n))?[2,null]:[4,{kind:et.b.GetConfig}]:[2,null]);case 2:return(i=S.sent()).kind!==et.b.GetConfig?(Vr(Hr.GetConfig),[2,null]):(o=i.config,c=Object(Ce.c)(o),u=Object(h.h)(a.cell),s=Object(Ce.a)(u.kind,u.range),l=Object(ke.a)(c),d=this.consistentAnonymizer.anonymize(a.content,o,n.range),[4,{kind:et.b.ParseEdit,cell:a.cell,formulaBarText:d}]);case 3:return(f=S.sent()).kind===et.b.ParseEdit&&Object(b.d)(f.result)?f.result.value.kind!==Ne.e.Formula?[2,null]:(v=f.result.value.formula,p=v.isWellFormed,m=void 0,p||(g=l.checkFormulaWithDiagnostics(s,v),Object(b.d)(g)&&void 0!==(O=null==g?void 0:g.value[1])&&(m=function(e,t){var r={},n={};return Object.keys(e).forEach((function(a){var i=Number(a),o=e[i];void 0!==o&&(r[a]=o);var c=t.spans[i];void 0!==c&&(n[a]=c)})),{spanDiagnostics:r,spans:n}}(O,v))),[4,{kind:et.b.GetCorrelationId}]):(Vr(Hr.ParseEdit),[2,null]);case 4:return"GetCorrelationId"!==(j=S.sent()).kind||(y=j.correlationId,Gr({v:e.formulaCollectionVersion,f:d,ok:p,d:m,c:{s:this.anonymizeSheetId(a.cell.sheet.index),c:a.cell.range.col,r:a.cell.range.row},i:y})),[2,null]}}))},e.factoryName=Ht.a.FormulaCollectionPlugin,e.formulaCollectionVersion=1,e}();function qr(e){return e.correlationId.toString()+","+e.logPartId.toString()+","+e.partialMessage}function Kr(e,t,r){var n=246-(r.toString().length+t.toString().length+2);return[{correlationId:r,logPartId:t,partialMessage:e.slice(0,n)},e.slice(n)]}!function(e){e.GetActiveCell="GetActiveCell failed",e.GetConfig="GetConfig failed",e.ParseEdit="ParseEdit failed",e.EmptyContent="empty content"}(Hr||(Hr={})),Object(Ht.d)(new Wr);var Yr,Jr=Object(ct.b)((function(){return Object(fe.__awaiter)(void 0,void 0,void 0,(function(){return Object(fe.__generator)(this,(function(e){switch(e.label){case 0:return[4,er.e.getValue()];case 1:return[4,e.sent().createAndAttachPlugin(Ht.a.FormulaCollectionPlugin)];case 2:return e.sent(),[4,er.b.getValue()];case 3:return e.sent(),[2]}}))}))})),Qr=((Yr={})[Ht.a.ArgumentAssistancePlugin]=[ar,"Microsoft.Office.ExcelOnline.ArgumentAssistancePlugin"],Yr[Ht.a.AutocompletePlugin]=[Fr,"Microsoft.Office.Excel.SmartFormulaBarAutocompleteIsEnabled"],Yr[Ht.a.AutocompletePrecisionMeasurements]=[wr,"Microsoft.Office.Excel.x10AutocompletionPrecisionMeasurementsIsEnabled"],Yr[Ht.a.AutocompleteGroundTruthMeasurements]=[Mr,"Microsoft.Office.Excel.x10AutocompleteGroundTruthMeasurementsIsEnabled"],Yr[Ht.a.AutocompleteDataTypesMeasurements]=[Dr,"Microsoft.Office.Excel.x10AutocompleteDataTypesMeasurements","OfficeVSO:5818445_AttachDataTypesExperiment"],Yr[Ht.a.AutocompleteFunctionPlugin]=[dr,"Microsoft.Office.Excel.FormulaAssistanceRedesign"],Yr[Ht.a.ParenthesesCouplingPlugin]=[Tr,"Microsoft.Office.Excel.ParenthesesCoupling"],Yr[Ht.a.AutocompleteLetPlugin]=[vr,"Microsoft.Office.Excel.FormulaAssistanceRedesign"],Yr[Ht.a.AutocompleteRichValuePlugin]=[yr,"Microsoft.Office.Excel.FormulaAssistanceRedesign"],Yr[Ht.a.FormulaCollectionPlugin]=[Jr,"Microsoft.Office.Excel.FormulaCollection"],Yr[Ht.a.AutocompleteNamedObjectsPlugin]=[kr,"Microsoft.Office.Excel.FormulaAssistanceRedesign"],Yr[Ht.a.ParserPerformanceMeasurements]=[Pr,"Microsoft.Office.Excel.x10ParserPerformanceMeasurements"],Yr);function Xr(e,t){return Object(fe.__awaiter)(this,void 0,void 0,(function(){var r,n,a,i;return Object(fe.__generator)(this,(function(o){switch(o.label){case 0:return er.c.resolve(t),void 0===(r=Qr[e])?[2,!1]:(n=r[0],a=r[1],i=r[2],void 0!==a&&!Object(f.c)(a)||void 0!==i&&!Object(f.f)(i)?[3,2]:[4,n.getValue()]);case 1:return o.sent(),[2,!0];case 2:return[2,!1]}}))}))}function Zr(e){return Object(fe.__awaiter)(this,void 0,void 0,(function(){var t,r;return Object(fe.__generator)(this,(function(n){switch(n.label){case 0:t=0,a=Qr,r=Object.keys(a).map((function(e){return parseInt(e,10)})),n.label=1;case 1:return t<r.length?[4,Xr(r[t],e)]:[3,4];case 2:n.sent(),n.label=3;case 3:return t++,[3,1];case 4:return[2]}var a}))}))}var $r,en,tn=r(105);(en=$r||($r={})).defaultPluginResponseWindows=It.a,en.SchedulerVersion=_t.a,en.getSchedulerFactories=$e.f,en.PluginSchedulerSingleton=$e.c,en.FormulaKind=Dt.a,en.SchedulerVersionCompatibility=et.e,en.RecalcSideGrid=tn.a,en.createMockAsyncGrid=Lt,en.createMockGridProvider=Bt,en.createMockGridExporter=Ut,en.MockTimerImmediate=Vt,en.PluginFactoryName=Ht.a,en.registerPluginFactory=Ht.d,en.createDynamicPluginLoader=$e.d,en.DynamicPluginLoader=$e.a,en.devDynamicPluginLoaderInsideInit=$e.e,en.stableDynamicPluginLoaderInsideInit=$e.g,en.PluginRequestKind=et.b,en.typedRequest=et.p,en.awaitPromise=et.f,en.wrapIntoAsync=Mt,en.yieldStarAsyncGenerator=et.q,en.delay=et.g,en.delayRequest=et.h,en.getSheetNamesRequest=et.k,en.getRangeRequest=et.j,en.getCellRequest=et.i,en.parseCellFormulaRequest=et.o,en.RequestKind=et.c,en.NotificationKind=et.a,en.PluginSchedulerResultKind=Rr.b,en.createGlobalsGenerator=zt,en.ArgumentAssistancePluginFactory=rr,en.AutocompleteFunctionPluginFactory=sr,en.AutocompleteLetPluginFactory=br,en.AutocompleteRichValuePluginFactory=Or,en.AutocompleteNamedObjectsPluginFactory=Sr,en.ParenthesesCouplingPluginFactory=Ar,en.spanToLSPRange=Ir.a,en.ensurePluginAttached=Xr,en.ensureAllPluginsAttached=Zr,Object(f.c)("Microsoft.Office.Excel.ProseFormulaRepairExperimentIsEnabled")&&r(205);var rn=new $e.c;r.d(t,"packageVersion",(function(){return i.a})),r.d(t,"PluginSchedulerSingletonGlobal",(function(){return rn})),r.d(t,"common",(function(){return n})),r.d(t,"location",(function(){return W})),r.d(t,"formula",(function(){return Y})),r.d(t,"value",(function(){return q})),r.d(t,"signature",(function(){return Q})),r.d(t,"util",(function(){return Z})),r.d(t,"config",(function(){return ee})),r.d(t,"math",(function(){return re})),r.d(t,"date",(function(){return ae})),r.d(t,"parse",(function(){return ge})),r.d(t,"analyze",(function(){return ye})),r.d(t,"numfmt",(function(){return Ee})),r.d(t,"runtime",(function(){return Me})),r.d(t,"calc",(function(){return nt})),r.d(t,"funcs",(function(){return yt})),r.d(t,"style",(function(){return Ct})),r.d(t,"worker",(function(){return Et})),r.d(t,"x10",(function(){return $r})),r.d(t,"getTypedFeatureGate",(function(){return f.c})),r.d(t,"isTypedChangeGateEnabled",(function(){return f.f}))},function(e,t,r){"use strict";r.r(t);var n,a=r(9),i=r(14),o=r(41),c=r(4),u=r(0),s=r(147),l=r(57),d=r(6),f=r(5),b=r(119),h=function(){function e(){this.factoryName=o.a.FormulaRepairPlugin}return e.prototype.create=function(){return new v},e}(),v=function(){function e(){}return e.prototype.run=function(e){var t,r,o,c,f,h,v;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return t={maxNumberOfRepairs:5,maxLocalEditDistance:5,maxGlobalEditDistance:5},[4,{kind:i.b.GetActiveCell}];case 1:return(r=a.sent()).kind!==i.b.GetActiveCell?(this.logFailure(n.GetActiveCell),[2,null]):[4,{kind:i.b.ParseEdit,cell:r.activeCell,formulaBarText:e.content}];case 2:return(o=a.sent()).kind===i.b.ParseEdit&&Object(u.d)(o.result)?o.result.value.kind!==d.e.Formula?(this.logFailure(n.NotFormula),[2,null]):o.result.value.formula.isWellFormed?(this.logFailure(n.FormulaWellFormed),[2,null]):(c=function(e,t){var r;return Object(s.format)({protocol:"http",hostname:"localhost",port:8080,pathname:"/",query:(r={},r.formula=e,r.k=t.maxNumberOfRepairs,r.max_local_edit_distance=t.maxLocalEditDistance,r.max_global_edit_distance=t.maxGlobalEditDistance,r)})}(e.content,t),f=this.getRepairsFromServer(c),[4,{kind:i.b.AwaitPromise,promise:f}]):(this.logFailure(n.ParseEdit),[2,null]);case 3:return(h=a.sent()).kind!==i.b.AwaitPromise?(this.logFailure(n.AwaitPromise),[2,null]):0===(v=h.result).length?[2,null]:[2,{items:v.map((function(e){return e.repair})).map((function(t){return{label:t,kind:l.a.Function,textEdit:{newText:t,range:Object(b.a)(e.content,0,e.content.length)}}}))}]}}))},e.prototype.logFailure=function(e){c.B.ULS.traceTag(545653663,c.c.msoulscat_ES_EWAJS,c.i.Warning,"FormulaRepairPlugin failed: ".concat(e))},e.prototype.getRepairsFromServer=function(e){return Object(a.__awaiter)(this,void 0,void 0,(function(){var t,r;return Object(a.__generator)(this,(function(a){switch(a.label){case 0:return[4,fetch(e)];case 1:return 200!==(t=a.sent()).status?(this.logFailure(n.GetStatusCode),[2,[]]):(r=t.headers.get("content-type"),Object(f.h)("contentType is not null",null!=r),/^application\/json/.test(r)?[2,t.json()]:(this.logFailure(n.GetContentType),[2,[]]))}}))}))},e}();!function(e){e.GetActiveCell="GetActiveCell failed",e.ParseEdit="ParseEdit failed",e.NotFormula="Not a formula, can't repair",e.FormulaWellFormed="Formula is well formed, no repairs",e.AwaitPromise="Not our promise",e.GetStatusCode="Not 200",e.GetContentType="Not application/json content",e.JsonParse="Failed json parse"}(n||(n={}));var p=r(58);Object(o.d)(new h),p.c.instance().createAndAttachPlugin(new h)}]);
//# sourceMappingURL=excelOnlineCalc.min.js.map